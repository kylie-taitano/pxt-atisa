var __assign=this&&this.__assign||Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},__extends=this&&this.__extends||(()=>{var n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])});return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}})(),ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,debugObjectHost=((e=>{function t(){}var r;(r=e.SyntaxKind||(e.SyntaxKind={}))[r.Unknown=0]="Unknown",r[r.EndOfFileToken=1]="EndOfFileToken",r[r.SingleLineCommentTrivia=2]="SingleLineCommentTrivia",r[r.MultiLineCommentTrivia=3]="MultiLineCommentTrivia",r[r.NewLineTrivia=4]="NewLineTrivia",r[r.WhitespaceTrivia=5]="WhitespaceTrivia",r[r.ShebangTrivia=6]="ShebangTrivia",r[r.ConflictMarkerTrivia=7]="ConflictMarkerTrivia",r[r.NumericLiteral=8]="NumericLiteral",r[r.StringLiteral=9]="StringLiteral",r[r.JsxText=10]="JsxText",r[r.JsxTextAllWhiteSpaces=11]="JsxTextAllWhiteSpaces",r[r.RegularExpressionLiteral=12]="RegularExpressionLiteral",r[r.NoSubstitutionTemplateLiteral=13]="NoSubstitutionTemplateLiteral",r[r.TemplateHead=14]="TemplateHead",r[r.TemplateMiddle=15]="TemplateMiddle",r[r.TemplateTail=16]="TemplateTail",r[r.OpenBraceToken=17]="OpenBraceToken",r[r.CloseBraceToken=18]="CloseBraceToken",r[r.OpenParenToken=19]="OpenParenToken",r[r.CloseParenToken=20]="CloseParenToken",r[r.OpenBracketToken=21]="OpenBracketToken",r[r.CloseBracketToken=22]="CloseBracketToken",r[r.DotToken=23]="DotToken",r[r.DotDotDotToken=24]="DotDotDotToken",r[r.SemicolonToken=25]="SemicolonToken",r[r.CommaToken=26]="CommaToken",r[r.LessThanToken=27]="LessThanToken",r[r.LessThanSlashToken=28]="LessThanSlashToken",r[r.GreaterThanToken=29]="GreaterThanToken",r[r.LessThanEqualsToken=30]="LessThanEqualsToken",r[r.GreaterThanEqualsToken=31]="GreaterThanEqualsToken",r[r.EqualsEqualsToken=32]="EqualsEqualsToken",r[r.ExclamationEqualsToken=33]="ExclamationEqualsToken",r[r.EqualsEqualsEqualsToken=34]="EqualsEqualsEqualsToken",r[r.ExclamationEqualsEqualsToken=35]="ExclamationEqualsEqualsToken",r[r.EqualsGreaterThanToken=36]="EqualsGreaterThanToken",r[r.PlusToken=37]="PlusToken",r[r.MinusToken=38]="MinusToken",r[r.AsteriskToken=39]="AsteriskToken",r[r.AsteriskAsteriskToken=40]="AsteriskAsteriskToken",r[r.SlashToken=41]="SlashToken",r[r.PercentToken=42]="PercentToken",r[r.PlusPlusToken=43]="PlusPlusToken",r[r.MinusMinusToken=44]="MinusMinusToken",r[r.LessThanLessThanToken=45]="LessThanLessThanToken",r[r.GreaterThanGreaterThanToken=46]="GreaterThanGreaterThanToken",r[r.GreaterThanGreaterThanGreaterThanToken=47]="GreaterThanGreaterThanGreaterThanToken",r[r.AmpersandToken=48]="AmpersandToken",r[r.BarToken=49]="BarToken",r[r.CaretToken=50]="CaretToken",r[r.ExclamationToken=51]="ExclamationToken",r[r.TildeToken=52]="TildeToken",r[r.AmpersandAmpersandToken=53]="AmpersandAmpersandToken",r[r.BarBarToken=54]="BarBarToken",r[r.QuestionToken=55]="QuestionToken",r[r.ColonToken=56]="ColonToken",r[r.AtToken=57]="AtToken",r[r.EqualsToken=58]="EqualsToken",r[r.PlusEqualsToken=59]="PlusEqualsToken",r[r.MinusEqualsToken=60]="MinusEqualsToken",r[r.AsteriskEqualsToken=61]="AsteriskEqualsToken",r[r.AsteriskAsteriskEqualsToken=62]="AsteriskAsteriskEqualsToken",r[r.SlashEqualsToken=63]="SlashEqualsToken",r[r.PercentEqualsToken=64]="PercentEqualsToken",r[r.LessThanLessThanEqualsToken=65]="LessThanLessThanEqualsToken",r[r.GreaterThanGreaterThanEqualsToken=66]="GreaterThanGreaterThanEqualsToken",r[r.GreaterThanGreaterThanGreaterThanEqualsToken=67]="GreaterThanGreaterThanGreaterThanEqualsToken",r[r.AmpersandEqualsToken=68]="AmpersandEqualsToken",r[r.BarEqualsToken=69]="BarEqualsToken",r[r.CaretEqualsToken=70]="CaretEqualsToken",r[r.Identifier=71]="Identifier",r[r.BreakKeyword=72]="BreakKeyword",r[r.CaseKeyword=73]="CaseKeyword",r[r.CatchKeyword=74]="CatchKeyword",r[r.ClassKeyword=75]="ClassKeyword",r[r.ConstKeyword=76]="ConstKeyword",r[r.ContinueKeyword=77]="ContinueKeyword",r[r.DebuggerKeyword=78]="DebuggerKeyword",r[r.DefaultKeyword=79]="DefaultKeyword",r[r.DeleteKeyword=80]="DeleteKeyword",r[r.DoKeyword=81]="DoKeyword",r[r.ElseKeyword=82]="ElseKeyword",r[r.EnumKeyword=83]="EnumKeyword",r[r.ExportKeyword=84]="ExportKeyword",r[r.ExtendsKeyword=85]="ExtendsKeyword",r[r.FalseKeyword=86]="FalseKeyword",r[r.FinallyKeyword=87]="FinallyKeyword",r[r.ForKeyword=88]="ForKeyword",r[r.FunctionKeyword=89]="FunctionKeyword",r[r.IfKeyword=90]="IfKeyword",r[r.ImportKeyword=91]="ImportKeyword",r[r.InKeyword=92]="InKeyword",r[r.InstanceOfKeyword=93]="InstanceOfKeyword",r[r.NewKeyword=94]="NewKeyword",r[r.NullKeyword=95]="NullKeyword",r[r.ReturnKeyword=96]="ReturnKeyword",r[r.SuperKeyword=97]="SuperKeyword",r[r.SwitchKeyword=98]="SwitchKeyword",r[r.ThisKeyword=99]="ThisKeyword",r[r.ThrowKeyword=100]="ThrowKeyword",r[r.TrueKeyword=101]="TrueKeyword",r[r.TryKeyword=102]="TryKeyword",r[r.TypeOfKeyword=103]="TypeOfKeyword",r[r.VarKeyword=104]="VarKeyword",r[r.VoidKeyword=105]="VoidKeyword",r[r.WhileKeyword=106]="WhileKeyword",r[r.WithKeyword=107]="WithKeyword",r[r.ImplementsKeyword=108]="ImplementsKeyword",r[r.InterfaceKeyword=109]="InterfaceKeyword",r[r.LetKeyword=110]="LetKeyword",r[r.PackageKeyword=111]="PackageKeyword",r[r.PrivateKeyword=112]="PrivateKeyword",r[r.ProtectedKeyword=113]="ProtectedKeyword",r[r.PublicKeyword=114]="PublicKeyword",r[r.StaticKeyword=115]="StaticKeyword",r[r.YieldKeyword=116]="YieldKeyword",r[r.AbstractKeyword=117]="AbstractKeyword",r[r.AsKeyword=118]="AsKeyword",r[r.AnyKeyword=119]="AnyKeyword",r[r.AsyncKeyword=120]="AsyncKeyword",r[r.AwaitKeyword=121]="AwaitKeyword",r[r.BooleanKeyword=122]="BooleanKeyword",r[r.ConstructorKeyword=123]="ConstructorKeyword",r[r.DeclareKeyword=124]="DeclareKeyword",r[r.GetKeyword=125]="GetKeyword",r[r.IsKeyword=126]="IsKeyword",r[r.KeyOfKeyword=127]="KeyOfKeyword",r[r.ModuleKeyword=128]="ModuleKeyword",r[r.NamespaceKeyword=129]="NamespaceKeyword",r[r.NeverKeyword=130]="NeverKeyword",r[r.ReadonlyKeyword=131]="ReadonlyKeyword",r[r.RequireKeyword=132]="RequireKeyword",r[r.NumberKeyword=133]="NumberKeyword",r[r.ObjectKeyword=134]="ObjectKeyword",r[r.SetKeyword=135]="SetKeyword",r[r.StringKeyword=136]="StringKeyword",r[r.SymbolKeyword=137]="SymbolKeyword",r[r.TypeKeyword=138]="TypeKeyword",r[r.UndefinedKeyword=139]="UndefinedKeyword",r[r.FromKeyword=140]="FromKeyword",r[r.GlobalKeyword=141]="GlobalKeyword",r[r.OfKeyword=142]="OfKeyword",r[r.QualifiedName=143]="QualifiedName",r[r.ComputedPropertyName=144]="ComputedPropertyName",r[r.TypeParameter=145]="TypeParameter",r[r.Parameter=146]="Parameter",r[r.Decorator=147]="Decorator",r[r.PropertySignature=148]="PropertySignature",r[r.PropertyDeclaration=149]="PropertyDeclaration",r[r.MethodSignature=150]="MethodSignature",r[r.MethodDeclaration=151]="MethodDeclaration",r[r.Constructor=152]="Constructor",r[r.GetAccessor=153]="GetAccessor",r[r.SetAccessor=154]="SetAccessor",r[r.CallSignature=155]="CallSignature",r[r.ConstructSignature=156]="ConstructSignature",r[r.IndexSignature=157]="IndexSignature",r[r.TypePredicate=158]="TypePredicate",r[r.TypeReference=159]="TypeReference",r[r.FunctionType=160]="FunctionType",r[r.ConstructorType=161]="ConstructorType",r[r.TypeQuery=162]="TypeQuery",r[r.TypeLiteral=163]="TypeLiteral",r[r.ArrayType=164]="ArrayType",r[r.TupleType=165]="TupleType",r[r.UnionType=166]="UnionType",r[r.IntersectionType=167]="IntersectionType",r[r.ParenthesizedType=168]="ParenthesizedType",r[r.ThisType=169]="ThisType",r[r.TypeOperator=170]="TypeOperator",r[r.IndexedAccessType=171]="IndexedAccessType",r[r.MappedType=172]="MappedType",r[r.LiteralType=173]="LiteralType",r[r.ObjectBindingPattern=174]="ObjectBindingPattern",r[r.ArrayBindingPattern=175]="ArrayBindingPattern",r[r.BindingElement=176]="BindingElement",r[r.ArrayLiteralExpression=177]="ArrayLiteralExpression",r[r.ObjectLiteralExpression=178]="ObjectLiteralExpression",r[r.PropertyAccessExpression=179]="PropertyAccessExpression",r[r.ElementAccessExpression=180]="ElementAccessExpression",r[r.CallExpression=181]="CallExpression",r[r.NewExpression=182]="NewExpression",r[r.TaggedTemplateExpression=183]="TaggedTemplateExpression",r[r.TypeAssertionExpression=184]="TypeAssertionExpression",r[r.ParenthesizedExpression=185]="ParenthesizedExpression",r[r.FunctionExpression=186]="FunctionExpression",r[r.ArrowFunction=187]="ArrowFunction",r[r.DeleteExpression=188]="DeleteExpression",r[r.TypeOfExpression=189]="TypeOfExpression",r[r.VoidExpression=190]="VoidExpression",r[r.AwaitExpression=191]="AwaitExpression",r[r.PrefixUnaryExpression=192]="PrefixUnaryExpression",r[r.PostfixUnaryExpression=193]="PostfixUnaryExpression",r[r.BinaryExpression=194]="BinaryExpression",r[r.ConditionalExpression=195]="ConditionalExpression",r[r.TemplateExpression=196]="TemplateExpression",r[r.YieldExpression=197]="YieldExpression",r[r.SpreadElement=198]="SpreadElement",r[r.ClassExpression=199]="ClassExpression",r[r.OmittedExpression=200]="OmittedExpression",r[r.ExpressionWithTypeArguments=201]="ExpressionWithTypeArguments",r[r.AsExpression=202]="AsExpression",r[r.NonNullExpression=203]="NonNullExpression",r[r.MetaProperty=204]="MetaProperty",r[r.TemplateSpan=205]="TemplateSpan",r[r.SemicolonClassElement=206]="SemicolonClassElement",r[r.Block=207]="Block",r[r.VariableStatement=208]="VariableStatement",r[r.EmptyStatement=209]="EmptyStatement",r[r.ExpressionStatement=210]="ExpressionStatement",r[r.IfStatement=211]="IfStatement",r[r.DoStatement=212]="DoStatement",r[r.WhileStatement=213]="WhileStatement",r[r.ForStatement=214]="ForStatement",r[r.ForInStatement=215]="ForInStatement",r[r.ForOfStatement=216]="ForOfStatement",r[r.ContinueStatement=217]="ContinueStatement",r[r.BreakStatement=218]="BreakStatement",r[r.ReturnStatement=219]="ReturnStatement",r[r.WithStatement=220]="WithStatement",r[r.SwitchStatement=221]="SwitchStatement",r[r.LabeledStatement=222]="LabeledStatement",r[r.ThrowStatement=223]="ThrowStatement",r[r.TryStatement=224]="TryStatement",r[r.DebuggerStatement=225]="DebuggerStatement",r[r.VariableDeclaration=226]="VariableDeclaration",r[r.VariableDeclarationList=227]="VariableDeclarationList",r[r.FunctionDeclaration=228]="FunctionDeclaration",r[r.ClassDeclaration=229]="ClassDeclaration",r[r.InterfaceDeclaration=230]="InterfaceDeclaration",r[r.TypeAliasDeclaration=231]="TypeAliasDeclaration",r[r.EnumDeclaration=232]="EnumDeclaration",r[r.ModuleDeclaration=233]="ModuleDeclaration",r[r.ModuleBlock=234]="ModuleBlock",r[r.CaseBlock=235]="CaseBlock",r[r.NamespaceExportDeclaration=236]="NamespaceExportDeclaration",r[r.ImportEqualsDeclaration=237]="ImportEqualsDeclaration",r[r.ImportDeclaration=238]="ImportDeclaration",r[r.ImportClause=239]="ImportClause",r[r.NamespaceImport=240]="NamespaceImport",r[r.NamedImports=241]="NamedImports",r[r.ImportSpecifier=242]="ImportSpecifier",r[r.ExportAssignment=243]="ExportAssignment",r[r.ExportDeclaration=244]="ExportDeclaration",r[r.NamedExports=245]="NamedExports",r[r.ExportSpecifier=246]="ExportSpecifier",r[r.MissingDeclaration=247]="MissingDeclaration",r[r.ExternalModuleReference=248]="ExternalModuleReference",r[r.JsxElement=249]="JsxElement",r[r.JsxSelfClosingElement=250]="JsxSelfClosingElement",r[r.JsxOpeningElement=251]="JsxOpeningElement",r[r.JsxClosingElement=252]="JsxClosingElement",r[r.JsxAttribute=253]="JsxAttribute",r[r.JsxAttributes=254]="JsxAttributes",r[r.JsxSpreadAttribute=255]="JsxSpreadAttribute",r[r.JsxExpression=256]="JsxExpression",r[r.CaseClause=257]="CaseClause",r[r.DefaultClause=258]="DefaultClause",r[r.HeritageClause=259]="HeritageClause",r[r.CatchClause=260]="CatchClause",r[r.PropertyAssignment=261]="PropertyAssignment",r[r.ShorthandPropertyAssignment=262]="ShorthandPropertyAssignment",r[r.SpreadAssignment=263]="SpreadAssignment",r[r.EnumMember=264]="EnumMember",r[r.SourceFile=265]="SourceFile",r[r.Bundle=266]="Bundle",r[r.JSDocTypeExpression=267]="JSDocTypeExpression",r[r.JSDocAllType=268]="JSDocAllType",r[r.JSDocUnknownType=269]="JSDocUnknownType",r[r.JSDocNullableType=270]="JSDocNullableType",r[r.JSDocNonNullableType=271]="JSDocNonNullableType",r[r.JSDocOptionalType=272]="JSDocOptionalType",r[r.JSDocFunctionType=273]="JSDocFunctionType",r[r.JSDocVariadicType=274]="JSDocVariadicType",r[r.JSDocComment=275]="JSDocComment",r[r.JSDocTag=276]="JSDocTag",r[r.JSDocAugmentsTag=277]="JSDocAugmentsTag",r[r.JSDocClassTag=278]="JSDocClassTag",r[r.JSDocParameterTag=279]="JSDocParameterTag",r[r.JSDocReturnTag=280]="JSDocReturnTag",r[r.JSDocTypeTag=281]="JSDocTypeTag",r[r.JSDocTemplateTag=282]="JSDocTemplateTag",r[r.JSDocTypedefTag=283]="JSDocTypedefTag",r[r.JSDocPropertyTag=284]="JSDocPropertyTag",r[r.JSDocTypeLiteral=285]="JSDocTypeLiteral",r[r.SyntaxList=286]="SyntaxList",r[r.NotEmittedStatement=287]="NotEmittedStatement",r[r.PartiallyEmittedExpression=288]="PartiallyEmittedExpression",r[r.CommaListExpression=289]="CommaListExpression",r[r.MergeDeclarationMarker=290]="MergeDeclarationMarker",r[r.EndOfDeclarationMarker=291]="EndOfDeclarationMarker",r[r.Count=292]="Count",r[r.FirstAssignment=58]="FirstAssignment",r[r.LastAssignment=70]="LastAssignment",r[r.FirstCompoundAssignment=59]="FirstCompoundAssignment",r[r.LastCompoundAssignment=70]="LastCompoundAssignment",r[r.FirstReservedWord=72]="FirstReservedWord",r[r.LastReservedWord=107]="LastReservedWord",r[r.FirstKeyword=72]="FirstKeyword",r[r.LastKeyword=142]="LastKeyword",r[r.FirstFutureReservedWord=108]="FirstFutureReservedWord",r[r.LastFutureReservedWord=116]="LastFutureReservedWord",r[r.FirstTypeNode=158]="FirstTypeNode",r[r.LastTypeNode=173]="LastTypeNode",r[r.FirstPunctuation=17]="FirstPunctuation",r[r.LastPunctuation=70]="LastPunctuation",r[r.FirstToken=0]="FirstToken",r[r.LastToken=142]="LastToken",r[r.FirstTriviaToken=2]="FirstTriviaToken",r[r.LastTriviaToken=7]="LastTriviaToken",r[r.FirstLiteralToken=8]="FirstLiteralToken",r[r.LastLiteralToken=13]="LastLiteralToken",r[r.FirstTemplateToken=13]="FirstTemplateToken",r[r.LastTemplateToken=16]="LastTemplateToken",r[r.FirstBinaryOperator=27]="FirstBinaryOperator",r[r.LastBinaryOperator=70]="LastBinaryOperator",r[r.FirstNode=143]="FirstNode",r[r.FirstJSDocNode=267]="FirstJSDocNode",r[r.LastJSDocNode=285]="LastJSDocNode",r[r.FirstJSDocTagNode=276]="FirstJSDocTagNode",r[r.LastJSDocTagNode=285]="LastJSDocTagNode",(r=e.NodeFlags||(e.NodeFlags={}))[r.None=0]="None",r[r.Let=1]="Let",r[r.Const=2]="Const",r[r.NestedNamespace=4]="NestedNamespace",r[r.Synthesized=8]="Synthesized",r[r.Namespace=16]="Namespace",r[r.ExportContext=32]="ExportContext",r[r.ContainsThis=64]="ContainsThis",r[r.HasImplicitReturn=128]="HasImplicitReturn",r[r.HasExplicitReturn=256]="HasExplicitReturn",r[r.GlobalAugmentation=512]="GlobalAugmentation",r[r.HasAsyncFunctions=1024]="HasAsyncFunctions",r[r.DisallowInContext=2048]="DisallowInContext",r[r.YieldContext=4096]="YieldContext",r[r.DecoratorContext=8192]="DecoratorContext",r[r.AwaitContext=16384]="AwaitContext",r[r.ThisNodeHasError=32768]="ThisNodeHasError",r[r.JavaScriptFile=65536]="JavaScriptFile",r[r.ThisNodeOrAnySubNodesHasError=131072]="ThisNodeOrAnySubNodesHasError",r[r.HasAggregatedChildData=262144]="HasAggregatedChildData",r[r.PossiblyContainsDynamicImport=524288]="PossiblyContainsDynamicImport",r[r.JSDoc=1048576]="JSDoc",r[r.BlockScoped=3]="BlockScoped",r[r.ReachabilityCheckFlags=384]="ReachabilityCheckFlags",r[r.ReachabilityAndEmitFlags=1408]="ReachabilityAndEmitFlags",r[r.ContextFlags=96256]="ContextFlags",r[r.TypeExcludesFlags=20480]="TypeExcludesFlags",(r=e.ModifierFlags||(e.ModifierFlags={}))[r.None=0]="None",r[r.Export=1]="Export",r[r.Ambient=2]="Ambient",r[r.Public=4]="Public",r[r.Private=8]="Private",r[r.Protected=16]="Protected",r[r.Static=32]="Static",r[r.Readonly=64]="Readonly",r[r.Abstract=128]="Abstract",r[r.Async=256]="Async",r[r.Default=512]="Default",r[r.Const=2048]="Const",r[r.HasComputedFlags=536870912]="HasComputedFlags",r[r.AccessibilityModifier=28]="AccessibilityModifier",r[r.ParameterPropertyModifier=92]="ParameterPropertyModifier",r[r.NonPublicAccessibilityModifier=24]="NonPublicAccessibilityModifier",r[r.TypeScriptModifier=2270]="TypeScriptModifier",r[r.ExportDefault=513]="ExportDefault",(r=e.JsxFlags||(e.JsxFlags={}))[r.None=0]="None",r[r.IntrinsicNamedElement=1]="IntrinsicNamedElement",r[r.IntrinsicIndexedElement=2]="IntrinsicIndexedElement",r[r.IntrinsicElement=3]="IntrinsicElement",(r=e.RelationComparisonResult||(e.RelationComparisonResult={}))[r.Succeeded=1]="Succeeded",r[r.Failed=2]="Failed",r[r.FailedAndReported=3]="FailedAndReported",(r=e.GeneratedIdentifierKind||(e.GeneratedIdentifierKind={}))[r.None=0]="None",r[r.Auto=1]="Auto",r[r.Loop=2]="Loop",r[r.Unique=3]="Unique",r[r.Node=4]="Node",(r=e.NumericLiteralFlags||(e.NumericLiteralFlags={}))[r.None=0]="None",r[r.Scientific=2]="Scientific",r[r.Octal=4]="Octal",r[r.HexSpecifier=8]="HexSpecifier",r[r.BinarySpecifier=16]="BinarySpecifier",r[r.OctalSpecifier=32]="OctalSpecifier",r[r.BinaryOrOctalSpecifier=48]="BinaryOrOctalSpecifier",(r=e.FlowFlags||(e.FlowFlags={}))[r.Unreachable=1]="Unreachable",r[r.Start=2]="Start",r[r.BranchLabel=4]="BranchLabel",r[r.LoopLabel=8]="LoopLabel",r[r.Assignment=16]="Assignment",r[r.TrueCondition=32]="TrueCondition",r[r.FalseCondition=64]="FalseCondition",r[r.SwitchClause=128]="SwitchClause",r[r.ArrayMutation=256]="ArrayMutation",r[r.Referenced=512]="Referenced",r[r.Shared=1024]="Shared",r[r.PreFinally=2048]="PreFinally",r[r.AfterFinally=4096]="AfterFinally",r[r.Label=12]="Label",r[r.Condition=96]="Condition",e.OperationCanceledException=t,(r=e.StructureIsReused||(e.StructureIsReused={}))[r.Not=0]="Not",r[r.SafeModules=1]="SafeModules",r[r.Completely=2]="Completely",(r=e.ExitStatus||(e.ExitStatus={}))[r.Success=0]="Success",r[r.DiagnosticsPresent_OutputsSkipped=1]="DiagnosticsPresent_OutputsSkipped",r[r.DiagnosticsPresent_OutputsGenerated=2]="DiagnosticsPresent_OutputsGenerated",(r=e.NodeBuilderFlags||(e.NodeBuilderFlags={}))[r.None=0]="None",r[r.NoTruncation=1]="NoTruncation",r[r.WriteArrayAsGenericType=2]="WriteArrayAsGenericType",r[r.WriteTypeArgumentsOfSignature=32]="WriteTypeArgumentsOfSignature",r[r.UseFullyQualifiedType=64]="UseFullyQualifiedType",r[r.SuppressAnyReturnType=256]="SuppressAnyReturnType",r[r.WriteTypeParametersInQualifiedName=512]="WriteTypeParametersInQualifiedName",r[r.AllowThisInObjectLiteral=1024]="AllowThisInObjectLiteral",r[r.AllowQualifedNameInPlaceOfIdentifier=2048]="AllowQualifedNameInPlaceOfIdentifier",r[r.AllowAnonymousIdentifier=8192]="AllowAnonymousIdentifier",r[r.AllowEmptyUnionOrIntersection=16384]="AllowEmptyUnionOrIntersection",r[r.AllowEmptyTuple=32768]="AllowEmptyTuple",r[r.IgnoreErrors=60416]="IgnoreErrors",r[r.InObjectTypeLiteral=1048576]="InObjectTypeLiteral",r[r.InTypeAlias=8388608]="InTypeAlias",(r=e.TypeFormatFlags||(e.TypeFormatFlags={}))[r.None=0]="None",r[r.WriteArrayAsGenericType=1]="WriteArrayAsGenericType",r[r.UseTypeOfFunction=4]="UseTypeOfFunction",r[r.NoTruncation=8]="NoTruncation",r[r.WriteArrowStyleSignature=16]="WriteArrowStyleSignature",r[r.WriteOwnNameForAnyLike=32]="WriteOwnNameForAnyLike",r[r.WriteTypeArgumentsOfSignature=64]="WriteTypeArgumentsOfSignature",r[r.InElementType=128]="InElementType",r[r.UseFullyQualifiedType=256]="UseFullyQualifiedType",r[r.InFirstTypeArgument=512]="InFirstTypeArgument",r[r.InTypeAlias=1024]="InTypeAlias",r[r.SuppressAnyReturnType=4096]="SuppressAnyReturnType",r[r.AddUndefined=8192]="AddUndefined",r[r.WriteClassExpressionAsTypeLiteral=16384]="WriteClassExpressionAsTypeLiteral",r[r.InArrayType=32768]="InArrayType",r[r.UseAliasDefinedOutsideCurrentScope=65536]="UseAliasDefinedOutsideCurrentScope",(r=e.SymbolFormatFlags||(e.SymbolFormatFlags={}))[r.None=0]="None",r[r.WriteTypeParametersOrArguments=1]="WriteTypeParametersOrArguments",r[r.UseOnlyExternalAliasing=2]="UseOnlyExternalAliasing",(r=e.SymbolAccessibility||(e.SymbolAccessibility={}))[r.Accessible=0]="Accessible",r[r.NotAccessible=1]="NotAccessible",r[r.CannotBeNamed=2]="CannotBeNamed",(r=e.SyntheticSymbolKind||(e.SyntheticSymbolKind={}))[r.UnionOrIntersection=0]="UnionOrIntersection",r[r.Spread=1]="Spread",(r=e.TypePredicateKind||(e.TypePredicateKind={}))[r.This=0]="This",r[r.Identifier=1]="Identifier",(r=e.TypeReferenceSerializationKind||(e.TypeReferenceSerializationKind={}))[r.Unknown=0]="Unknown",r[r.TypeWithConstructSignatureAndValue=1]="TypeWithConstructSignatureAndValue",r[r.VoidNullableOrNeverType=2]="VoidNullableOrNeverType",r[r.NumberLikeType=3]="NumberLikeType",r[r.StringLikeType=4]="StringLikeType",r[r.BooleanType=5]="BooleanType",r[r.ArrayLikeType=6]="ArrayLikeType",r[r.ESSymbolType=7]="ESSymbolType",r[r.Promise=8]="Promise",r[r.TypeWithCallSignature=9]="TypeWithCallSignature",r[r.ObjectType=10]="ObjectType",(r=e.SymbolFlags||(e.SymbolFlags={}))[r.None=0]="None",r[r.FunctionScopedVariable=1]="FunctionScopedVariable",r[r.BlockScopedVariable=2]="BlockScopedVariable",r[r.Property=4]="Property",r[r.EnumMember=8]="EnumMember",r[r.Function=16]="Function",r[r.Class=32]="Class",r[r.Interface=64]="Interface",r[r.ConstEnum=128]="ConstEnum",r[r.RegularEnum=256]="RegularEnum",r[r.ValueModule=512]="ValueModule",r[r.NamespaceModule=1024]="NamespaceModule",r[r.TypeLiteral=2048]="TypeLiteral",r[r.ObjectLiteral=4096]="ObjectLiteral",r[r.Method=8192]="Method",r[r.Constructor=16384]="Constructor",r[r.GetAccessor=32768]="GetAccessor",r[r.SetAccessor=65536]="SetAccessor",r[r.Signature=131072]="Signature",r[r.TypeParameter=262144]="TypeParameter",r[r.TypeAlias=524288]="TypeAlias",r[r.ExportValue=1048576]="ExportValue",r[r.Alias=2097152]="Alias",r[r.Prototype=4194304]="Prototype",r[r.ExportStar=8388608]="ExportStar",r[r.Optional=16777216]="Optional",r[r.Transient=33554432]="Transient",r[r.Enum=384]="Enum",r[r.Variable=3]="Variable",r[r.Value=107455]="Value",r[r.Type=793064]="Type",r[r.Namespace=1920]="Namespace",r[r.Module=1536]="Module",r[r.Accessor=98304]="Accessor",r[r.FunctionScopedVariableExcludes=107454]="FunctionScopedVariableExcludes",r[r.BlockScopedVariableExcludes=107455]="BlockScopedVariableExcludes",r[r.ParameterExcludes=107455]="ParameterExcludes",r[r.PropertyExcludes=0]="PropertyExcludes",r[r.EnumMemberExcludes=900095]="EnumMemberExcludes",r[r.FunctionExcludes=106927]="FunctionExcludes",r[r.ClassExcludes=899519]="ClassExcludes",r[r.InterfaceExcludes=792968]="InterfaceExcludes",r[r.RegularEnumExcludes=899327]="RegularEnumExcludes",r[r.ConstEnumExcludes=899967]="ConstEnumExcludes",r[r.ValueModuleExcludes=106639]="ValueModuleExcludes",r[r.NamespaceModuleExcludes=0]="NamespaceModuleExcludes",r[r.MethodExcludes=99263]="MethodExcludes",r[r.GetAccessorExcludes=41919]="GetAccessorExcludes",r[r.SetAccessorExcludes=74687]="SetAccessorExcludes",r[r.TypeParameterExcludes=530920]="TypeParameterExcludes",r[r.TypeAliasExcludes=793064]="TypeAliasExcludes",r[r.AliasExcludes=2097152]="AliasExcludes",r[r.ModuleMember=2623475]="ModuleMember",r[r.ExportHasLocal=944]="ExportHasLocal",r[r.HasExports=1952]="HasExports",r[r.HasMembers=6240]="HasMembers",r[r.BlockScoped=418]="BlockScoped",r[r.PropertyOrAccessor=98308]="PropertyOrAccessor",r[r.ClassMember=106500]="ClassMember",r[r.Classifiable=788448]="Classifiable",(r=e.EnumKind||(e.EnumKind={}))[r.Numeric=0]="Numeric",r[r.Literal=1]="Literal",(r=e.CheckFlags||(e.CheckFlags={}))[r.Instantiated=1]="Instantiated",r[r.SyntheticProperty=2]="SyntheticProperty",r[r.SyntheticMethod=4]="SyntheticMethod",r[r.Readonly=8]="Readonly",r[r.Partial=16]="Partial",r[r.HasNonUniformType=32]="HasNonUniformType",r[r.ContainsPublic=64]="ContainsPublic",r[r.ContainsProtected=128]="ContainsProtected",r[r.ContainsPrivate=256]="ContainsPrivate",r[r.ContainsStatic=512]="ContainsStatic",r[r.Synthetic=6]="Synthetic",(r=e.InternalSymbolName||(e.InternalSymbolName={})).Call="__call",r.Constructor="__constructor",r.New="__new",r.Index="__index",r.ExportStar="__export",r.Global="__global",r.Missing="__missing",r.Type="__type",r.Object="__object",r.JSXAttributes="__jsxAttributes",r.Class="__class",r.Function="__function",r.Computed="__computed",r.Resolving="__resolving__",r.ExportEquals="export=",r.Default="default",(r=e.NodeCheckFlags||(e.NodeCheckFlags={}))[r.TypeChecked=1]="TypeChecked",r[r.LexicalThis=2]="LexicalThis",r[r.CaptureThis=4]="CaptureThis",r[r.CaptureNewTarget=8]="CaptureNewTarget",r[r.SuperInstance=256]="SuperInstance",r[r.SuperStatic=512]="SuperStatic",r[r.ContextChecked=1024]="ContextChecked",r[r.AsyncMethodWithSuper=2048]="AsyncMethodWithSuper",r[r.AsyncMethodWithSuperBinding=4096]="AsyncMethodWithSuperBinding",r[r.CaptureArguments=8192]="CaptureArguments",r[r.EnumValuesComputed=16384]="EnumValuesComputed",r[r.LexicalModuleMergesWithClass=32768]="LexicalModuleMergesWithClass",r[r.LoopWithCapturedBlockScopedBinding=65536]="LoopWithCapturedBlockScopedBinding",r[r.CapturedBlockScopedBinding=131072]="CapturedBlockScopedBinding",r[r.BlockScopedBindingInLoop=262144]="BlockScopedBindingInLoop",r[r.ClassWithBodyScopedClassBinding=524288]="ClassWithBodyScopedClassBinding",r[r.BodyScopedClassBinding=1048576]="BodyScopedClassBinding",r[r.NeedsLoopOutParameter=2097152]="NeedsLoopOutParameter",r[r.AssignmentsMarked=4194304]="AssignmentsMarked",r[r.ClassWithConstructorReference=8388608]="ClassWithConstructorReference",r[r.ConstructorReferenceInClass=16777216]="ConstructorReferenceInClass",(r=e.TypeFlags||(e.TypeFlags={}))[r.Any=1]="Any",r[r.String=2]="String",r[r.Number=4]="Number",r[r.Boolean=8]="Boolean",r[r.Enum=16]="Enum",r[r.StringLiteral=32]="StringLiteral",r[r.NumberLiteral=64]="NumberLiteral",r[r.BooleanLiteral=128]="BooleanLiteral",r[r.EnumLiteral=256]="EnumLiteral",r[r.ESSymbol=512]="ESSymbol",r[r.Void=1024]="Void",r[r.Undefined=2048]="Undefined",r[r.Null=4096]="Null",r[r.Never=8192]="Never",r[r.TypeParameter=16384]="TypeParameter",r[r.Object=32768]="Object",r[r.Union=65536]="Union",r[r.Intersection=131072]="Intersection",r[r.Index=262144]="Index",r[r.IndexedAccess=524288]="IndexedAccess",r[r.FreshLiteral=1048576]="FreshLiteral",r[r.ContainsWideningType=2097152]="ContainsWideningType",r[r.ContainsObjectLiteral=4194304]="ContainsObjectLiteral",r[r.ContainsAnyFunctionType=8388608]="ContainsAnyFunctionType",r[r.NonPrimitive=16777216]="NonPrimitive",r[r.JsxAttributes=33554432]="JsxAttributes",r[r.MarkerType=67108864]="MarkerType",r[r.Nullable=6144]="Nullable",r[r.Literal=224]="Literal",r[r.Unit=6368]="Unit",r[r.StringOrNumberLiteral=96]="StringOrNumberLiteral",r[r.DefinitelyFalsy=7392]="DefinitelyFalsy",r[r.PossiblyFalsy=7406]="PossiblyFalsy",r[r.Intrinsic=16793231]="Intrinsic",r[r.Primitive=8190]="Primitive",r[r.StringLike=262178]="StringLike",r[r.NumberLike=84]="NumberLike",r[r.BooleanLike=136]="BooleanLike",r[r.EnumLike=272]="EnumLike",r[r.UnionOrIntersection=196608]="UnionOrIntersection",r[r.StructuredType=229376]="StructuredType",r[r.StructuredOrTypeVariable=1032192]="StructuredOrTypeVariable",r[r.TypeVariable=540672]="TypeVariable",r[r.Narrowable=17810175]="Narrowable",r[r.NotUnionOrUnit=16810497]="NotUnionOrUnit",r[r.RequiresWidening=6291456]="RequiresWidening",r[r.PropagatingFlags=14680064]="PropagatingFlags",(r=e.ObjectFlags||(e.ObjectFlags={}))[r.Class=1]="Class",r[r.Interface=2]="Interface",r[r.Reference=4]="Reference",r[r.Tuple=8]="Tuple",r[r.Anonymous=16]="Anonymous",r[r.Mapped=32]="Mapped",r[r.Instantiated=64]="Instantiated",r[r.ObjectLiteral=128]="ObjectLiteral",r[r.EvolvingArray=256]="EvolvingArray",r[r.ObjectLiteralPatternWithComputedProperties=512]="ObjectLiteralPatternWithComputedProperties",r[r.ClassOrInterface=3]="ClassOrInterface",(r=e.Variance||(e.Variance={}))[r.Invariant=0]="Invariant",r[r.Covariant=1]="Covariant",r[r.Contravariant=2]="Contravariant",r[r.Bivariant=3]="Bivariant",r[r.Independent=4]="Independent",(r=e.SignatureKind||(e.SignatureKind={}))[r.Call=0]="Call",r[r.Construct=1]="Construct",(r=e.IndexKind||(e.IndexKind={}))[r.String=0]="String",r[r.Number=1]="Number",(r=e.InferencePriority||(e.InferencePriority={}))[r.Contravariant=1]="Contravariant",r[r.NakedTypeVariable=2]="NakedTypeVariable",r[r.MappedType=4]="MappedType",r[r.ReturnType=8]="ReturnType",(r=e.InferenceFlags||(e.InferenceFlags={}))[r.InferUnionTypes=1]="InferUnionTypes",r[r.NoDefault=2]="NoDefault",r[r.AnyDefault=4]="AnyDefault",(r=e.Ternary||(e.Ternary={}))[r.False=0]="False",r[r.Maybe=1]="Maybe",r[r.True=-1]="True",(r=e.SpecialPropertyAssignmentKind||(e.SpecialPropertyAssignmentKind={}))[r.None=0]="None",r[r.ExportsProperty=1]="ExportsProperty",r[r.ModuleExports=2]="ModuleExports",r[r.PrototypeProperty=3]="PrototypeProperty",r[r.ThisProperty=4]="ThisProperty",r[r.Property=5]="Property",(r=e.DiagnosticCategory||(e.DiagnosticCategory={}))[r.Warning=0]="Warning",r[r.Error=1]="Error",r[r.Message=2]="Message",(r=e.ModuleResolutionKind||(e.ModuleResolutionKind={}))[r.Classic=1]="Classic",r[r.NodeJs=2]="NodeJs",(r=e.ModuleKind||(e.ModuleKind={}))[r.None=0]="None",r[r.CommonJS=1]="CommonJS",r[r.AMD=2]="AMD",r[r.UMD=3]="UMD",r[r.System=4]="System",r[r.ES2015=5]="ES2015",r[r.ESNext=6]="ESNext",(r=e.JsxEmit||(e.JsxEmit={}))[r.None=0]="None",r[r.Preserve=1]="Preserve",r[r.React=2]="React",r[r.ReactNative=3]="ReactNative",(r=e.NewLineKind||(e.NewLineKind={}))[r.CarriageReturnLineFeed=0]="CarriageReturnLineFeed",r[r.LineFeed=1]="LineFeed",(r=e.ScriptKind||(e.ScriptKind={}))[r.Unknown=0]="Unknown",r[r.JS=1]="JS",r[r.JSX=2]="JSX",r[r.TS=3]="TS",r[r.TSX=4]="TSX",r[r.External=5]="External",r[r.JSON=6]="JSON",(r=e.ScriptTarget||(e.ScriptTarget={}))[r.ES3=0]="ES3",r[r.ES5=1]="ES5",r[r.ES2015=2]="ES2015",r[r.ES2016=3]="ES2016",r[r.ES2017=4]="ES2017",r[r.ESNext=5]="ESNext",r[r.Latest=5]="Latest",(r=e.LanguageVariant||(e.LanguageVariant={}))[r.Standard=0]="Standard",r[r.JSX=1]="JSX",(r=e.DiagnosticStyle||(e.DiagnosticStyle={}))[r.Simple=0]="Simple",r[r.Pretty=1]="Pretty",(r=e.WatchDirectoryFlags||(e.WatchDirectoryFlags={}))[r.None=0]="None",r[r.Recursive=1]="Recursive",(r=e.CharacterCodes||(e.CharacterCodes={}))[r.nullCharacter=0]="nullCharacter",r[r.maxAsciiCharacter=127]="maxAsciiCharacter",r[r.lineFeed=10]="lineFeed",r[r.carriageReturn=13]="carriageReturn",r[r.lineSeparator=8232]="lineSeparator",r[r.paragraphSeparator=8233]="paragraphSeparator",r[r.nextLine=133]="nextLine",r[r.space=32]="space",r[r.nonBreakingSpace=160]="nonBreakingSpace",r[r.enQuad=8192]="enQuad",r[r.emQuad=8193]="emQuad",r[r.enSpace=8194]="enSpace",r[r.emSpace=8195]="emSpace",r[r.threePerEmSpace=8196]="threePerEmSpace",r[r.fourPerEmSpace=8197]="fourPerEmSpace",r[r.sixPerEmSpace=8198]="sixPerEmSpace",r[r.figureSpace=8199]="figureSpace",r[r.punctuationSpace=8200]="punctuationSpace",r[r.thinSpace=8201]="thinSpace",r[r.hairSpace=8202]="hairSpace",r[r.zeroWidthSpace=8203]="zeroWidthSpace",r[r.narrowNoBreakSpace=8239]="narrowNoBreakSpace",r[r.ideographicSpace=12288]="ideographicSpace",r[r.mathematicalSpace=8287]="mathematicalSpace",r[r.ogham=5760]="ogham",r[r._=95]="_",r[r.$=36]="$",r[r._0=48]="_0",r[r._1=49]="_1",r[r._2=50]="_2",r[r._3=51]="_3",r[r._4=52]="_4",r[r._5=53]="_5",r[r._6=54]="_6",r[r._7=55]="_7",r[r._8=56]="_8",r[r._9=57]="_9",r[r.a=97]="a",r[r.b=98]="b",r[r.c=99]="c",r[r.d=100]="d",r[r.e=101]="e",r[r.f=102]="f",r[r.g=103]="g",r[r.h=104]="h",r[r.i=105]="i",r[r.j=106]="j",r[r.k=107]="k",r[r.l=108]="l",r[r.m=109]="m",r[r.n=110]="n",r[r.o=111]="o",r[r.p=112]="p",r[r.q=113]="q",r[r.r=114]="r",r[r.s=115]="s",r[r.t=116]="t",r[r.u=117]="u",r[r.v=118]="v",r[r.w=119]="w",r[r.x=120]="x",r[r.y=121]="y",r[r.z=122]="z",r[r.A=65]="A",r[r.B=66]="B",r[r.C=67]="C",r[r.D=68]="D",r[r.E=69]="E",r[r.F=70]="F",r[r.G=71]="G",r[r.H=72]="H",r[r.I=73]="I",r[r.J=74]="J",r[r.K=75]="K",r[r.L=76]="L",r[r.M=77]="M",r[r.N=78]="N",r[r.O=79]="O",r[r.P=80]="P",r[r.Q=81]="Q",r[r.R=82]="R",r[r.S=83]="S",r[r.T=84]="T",r[r.U=85]="U",r[r.V=86]="V",r[r.W=87]="W",r[r.X=88]="X",r[r.Y=89]="Y",r[r.Z=90]="Z",r[r.ampersand=38]="ampersand",r[r.asterisk=42]="asterisk",r[r.at=64]="at",r[r.backslash=92]="backslash",r[r.backtick=96]="backtick",r[r.bar=124]="bar",r[r.caret=94]="caret",r[r.closeBrace=125]="closeBrace",r[r.closeBracket=93]="closeBracket",r[r.closeParen=41]="closeParen",r[r.colon=58]="colon",r[r.comma=44]="comma",r[r.dot=46]="dot",r[r.doubleQuote=34]="doubleQuote",r[r.equals=61]="equals",r[r.exclamation=33]="exclamation",r[r.greaterThan=62]="greaterThan",r[r.hash=35]="hash",r[r.lessThan=60]="lessThan",r[r.minus=45]="minus",r[r.openBrace=123]="openBrace",r[r.openBracket=91]="openBracket",r[r.openParen=40]="openParen",r[r.percent=37]="percent",r[r.plus=43]="plus",r[r.question=63]="question",r[r.semicolon=59]="semicolon",r[r.singleQuote=39]="singleQuote",r[r.slash=47]="slash",r[r.tilde=126]="tilde",r[r.backspace=8]="backspace",r[r.formFeed=12]="formFeed",r[r.byteOrderMark=65279]="byteOrderMark",r[r.tab=9]="tab",r[r.verticalTab=11]="verticalTab",(r=e.Extension||(e.Extension={})).Ts=".ts",r.Tsx=".tsx",r.Dts=".d.ts",r.Js=".js",r.Jsx=".jsx",r.Json=".json",(r=e.TransformFlags||(e.TransformFlags={}))[r.None=0]="None",r[r.TypeScript=1]="TypeScript",r[r.ContainsTypeScript=2]="ContainsTypeScript",r[r.ContainsJsx=4]="ContainsJsx",r[r.ContainsESNext=8]="ContainsESNext",r[r.ContainsES2017=16]="ContainsES2017",r[r.ContainsES2016=32]="ContainsES2016",r[r.ES2015=64]="ES2015",r[r.ContainsES2015=128]="ContainsES2015",r[r.Generator=256]="Generator",r[r.ContainsGenerator=512]="ContainsGenerator",r[r.DestructuringAssignment=1024]="DestructuringAssignment",r[r.ContainsDestructuringAssignment=2048]="ContainsDestructuringAssignment",r[r.ContainsDecorators=4096]="ContainsDecorators",r[r.ContainsPropertyInitializer=8192]="ContainsPropertyInitializer",r[r.ContainsLexicalThis=16384]="ContainsLexicalThis",r[r.ContainsCapturedLexicalThis=32768]="ContainsCapturedLexicalThis",r[r.ContainsLexicalThisInComputedPropertyName=65536]="ContainsLexicalThisInComputedPropertyName",r[r.ContainsDefaultValueAssignments=131072]="ContainsDefaultValueAssignments",r[r.ContainsParameterPropertyAssignments=262144]="ContainsParameterPropertyAssignments",r[r.ContainsSpread=524288]="ContainsSpread",r[r.ContainsObjectSpread=1048576]="ContainsObjectSpread",r[r.ContainsRest=524288]="ContainsRest",r[r.ContainsObjectRest=1048576]="ContainsObjectRest",r[r.ContainsComputedPropertyName=2097152]="ContainsComputedPropertyName",r[r.ContainsBlockScopedBinding=4194304]="ContainsBlockScopedBinding",r[r.ContainsBindingPattern=8388608]="ContainsBindingPattern",r[r.ContainsYield=16777216]="ContainsYield",r[r.ContainsHoistedDeclarationOrCompletion=33554432]="ContainsHoistedDeclarationOrCompletion",r[r.ContainsDynamicImport=67108864]="ContainsDynamicImport",r[r.HasComputedFlags=536870912]="HasComputedFlags",r[r.AssertTypeScript=3]="AssertTypeScript",r[r.AssertJsx=4]="AssertJsx",r[r.AssertESNext=8]="AssertESNext",r[r.AssertES2017=16]="AssertES2017",r[r.AssertES2016=32]="AssertES2016",r[r.AssertES2015=192]="AssertES2015",r[r.AssertGenerator=768]="AssertGenerator",r[r.AssertDestructuringAssignment=3072]="AssertDestructuringAssignment",r[r.NodeExcludes=536872257]="NodeExcludes",r[r.ArrowFunctionExcludes=601249089]="ArrowFunctionExcludes",r[r.FunctionExcludes=601281857]="FunctionExcludes",r[r.ConstructorExcludes=601015617]="ConstructorExcludes",r[r.MethodOrAccessorExcludes=601015617]="MethodOrAccessorExcludes",r[r.ClassExcludes=539358529]="ClassExcludes",r[r.ModuleExcludes=574674241]="ModuleExcludes",r[r.TypeExcludes=-3]="TypeExcludes",r[r.ObjectLiteralExcludes=540087617]="ObjectLiteralExcludes",r[r.ArrayLiteralOrCallOrNewExcludes=537396545]="ArrayLiteralOrCallOrNewExcludes",r[r.VariableDeclarationListExcludes=546309441]="VariableDeclarationListExcludes",r[r.ParameterExcludes=536872257]="ParameterExcludes",r[r.CatchClauseExcludes=537920833]="CatchClauseExcludes",r[r.BindingPatternExcludes=537396545]="BindingPatternExcludes",r[r.TypeScriptClassSyntaxMask=274432]="TypeScriptClassSyntaxMask",r[r.ES2015FunctionSyntaxMask=163840]="ES2015FunctionSyntaxMask",(r=e.EmitFlags||(e.EmitFlags={}))[r.SingleLine=1]="SingleLine",r[r.AdviseOnEmitNode=2]="AdviseOnEmitNode",r[r.NoSubstitution=4]="NoSubstitution",r[r.CapturesThis=8]="CapturesThis",r[r.NoLeadingSourceMap=16]="NoLeadingSourceMap",r[r.NoTrailingSourceMap=32]="NoTrailingSourceMap",r[r.NoSourceMap=48]="NoSourceMap",r[r.NoNestedSourceMaps=64]="NoNestedSourceMaps",r[r.NoTokenLeadingSourceMaps=128]="NoTokenLeadingSourceMaps",r[r.NoTokenTrailingSourceMaps=256]="NoTokenTrailingSourceMaps",r[r.NoTokenSourceMaps=384]="NoTokenSourceMaps",r[r.NoLeadingComments=512]="NoLeadingComments",r[r.NoTrailingComments=1024]="NoTrailingComments",r[r.NoComments=1536]="NoComments",r[r.NoNestedComments=2048]="NoNestedComments",r[r.HelperName=4096]="HelperName",r[r.ExportName=8192]="ExportName",r[r.LocalName=16384]="LocalName",r[r.InternalName=32768]="InternalName",r[r.Indented=65536]="Indented",r[r.NoIndentation=131072]="NoIndentation",r[r.AsyncFunctionBody=262144]="AsyncFunctionBody",r[r.ReuseTempVariableScope=524288]="ReuseTempVariableScope",r[r.CustomPrologue=1048576]="CustomPrologue",r[r.NoHoisting=2097152]="NoHoisting",r[r.HasEndOfDeclarationMarker=4194304]="HasEndOfDeclarationMarker",r[r.Iterator=8388608]="Iterator",r[r.NoAsciiEscaping=16777216]="NoAsciiEscaping",r[r.TypeScriptClassWrapper=33554432]="TypeScriptClassWrapper",(r=e.ExternalEmitHelpers||(e.ExternalEmitHelpers={}))[r.Extends=1]="Extends",r[r.Assign=2]="Assign",r[r.Rest=4]="Rest",r[r.Decorate=8]="Decorate",r[r.Metadata=16]="Metadata",r[r.Param=32]="Param",r[r.Awaiter=64]="Awaiter",r[r.Generator=128]="Generator",r[r.Values=256]="Values",r[r.Read=512]="Read",r[r.Spread=1024]="Spread",r[r.Await=2048]="Await",r[r.AsyncGenerator=4096]="AsyncGenerator",r[r.AsyncDelegator=8192]="AsyncDelegator",r[r.AsyncValues=16384]="AsyncValues",r[r.ExportStar=32768]="ExportStar",r[r.MakeTemplateObject=65536]="MakeTemplateObject",r[r.FirstEmitHelper=1]="FirstEmitHelper",r[r.LastEmitHelper=65536]="LastEmitHelper",r[r.ForOfIncludes=256]="ForOfIncludes",r[r.ForAwaitOfIncludes=16384]="ForAwaitOfIncludes",r[r.AsyncGeneratorIncludes=6144]="AsyncGeneratorIncludes",r[r.AsyncDelegatorIncludes=26624]="AsyncDelegatorIncludes",r[r.SpreadIncludes=1536]="SpreadIncludes",(r=e.EmitHint||(e.EmitHint={}))[r.SourceFile=0]="SourceFile",r[r.Expression=1]="Expression",r[r.IdentifierName=2]="IdentifierName",r[r.MappedTypeParameter=3]="MappedTypeParameter",r[r.Unspecified=4]="Unspecified"})(ts=ts||{}),(ts||(ts={})).timestamp="undefined"!=typeof performance&&performance.now?function(){return performance.now()}:Date.now||function(){return+new Date},(n=>{var e,t,i,s,r,a,o;e=n.performance||(n.performance={}),r="function"==typeof onProfilerEvent&&!0===onProfilerEvent.profiler?onProfilerEvent:function(e){},a=!1,o=0,e.mark=function(e){a&&(i.set(e,n.timestamp()),t.set(e,(t.get(e)||0)+1),r(e))},e.measure=function(e,t,r){a&&(r=r&&i.get(r)||n.timestamp(),t=t&&i.get(t)||o,s.set(e,(s.get(e)||0)+(r-t)))},e.getCount=function(e){return t&&t.get(e)||0},e.getDuration=function(e){return s&&s.get(e)||0},e.forEachMeasure=function(r){s.forEach(function(e,t){r(t,e)})},e.enable=function(){t=n.createMap(),i=n.createMap(),s=n.createMap(),a=!0,o=n.timestamp()},e.disable=function(){a=!1}})(ts=ts||{}),(e=>{e.versionMajorMinor="2.6",e.version=e.versionMajorMinor+".1"})(ts=ts||{}),(t=>{t.isExternalModuleNameRelative=function(e){return t.pathIsRelative(e)||t.isRootedDiskPath(e)}})(ts=ts||{}),(f=>{function M(){var e=Object.create(null);return e.__=void 0,delete e.__,e}function _(){return new n}f.collator="object"==typeof Intl&&"function"==typeof Intl.Collator?new Intl.Collator(void 0,{usage:"sort",sensitivity:"accent"}):void 0,f.localeCompareIsCorrect=f.collator&&f.collator.compare("a","B")<0,f.createMap=_,f.createUnderscoreEscapedMap=function(){return new n},f.createSymbolTable=function(e){var t=_();if(e)for(var r=0,n=e;r<n.length;r++){var i=n[r];t.set(i.escapedName,i)}return t},f.createMapFromTemplate=function(e){var t,r=new n;for(t in e)l.call(e,t)&&r.set(t,e[t]);return r};var e,n="undefined"!=typeof Map&&"entries"in Map.prototype?Map:(e=(()=>{function e(e,t){this.index=0,this.data=e,this.selector=t,this.keys=Object.keys(e)}return e.prototype.next=function(){var e=this.index;return e<this.keys.length?(this.index++,{value:this.selector(this.data,this.keys[e]),done:!1}):{value:void 0,done:!0}},e})(),t.prototype.get=function(e){return this.data[e]},t.prototype.set=function(e,t){return this.has(e)||this.size++,this.data[e]=t,this},t.prototype.has=function(e){return e in this.data},t.prototype.delete=function(e){return!!this.has(e)&&(this.size--,delete this.data[e],!0)},t.prototype.clear=function(){this.data=M(),this.size=0},t.prototype.keys=function(){return new e(this.data,function(e,t){return t})},t.prototype.values=function(){return new e(this.data,function(e,t){return e[t]})},t.prototype.entries=function(){return new e(this.data,function(e,t){return[t,e[t]]})},t.prototype.forEach=function(e){for(var t in this.data)e(this.data[t],t)},t);function t(){this.data=M(),this.size=0}function r(e,t){if(e)for(var r=0;r<e.length;r++){var n=t(e[r],r);if(n)return n}}function i(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(t(n,r))return n}}function F(e,t){for(var r=0;r<e.length;r++)if(t(e[r],r))return r;return-1}function s(e,t){if(e)for(var r=0,n=e;r<n.length;r++)if(n[r]===t)return!0;return!1}function B(e,t,r){for(var n=r||0;n<e.length;n++)if(s(t,e.charCodeAt(n)))return n;return-1}function $(e,t){for(var r=0,n=0;n<e.length;n++)t(e[n],n,e)&&(e[r]=e[n],r++);e.length=r}function y(e,t){if(e)for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}function U(e){if(e)for(var t=[],r=0,n=e;r<n.length;r++){var i=n[r];i&&(c(i)?o(t,i):t.push(i))}return t}function V(e,t){if(e)for(var r=[],n=0;n<e.length;n++){var i=t(e[n],n);i&&(c(i)?o(r,i):r.push(i))}return r}function b(e,t){if(e){if(!t)return 0<e.length;for(var r=0,n=e;r<n.length;r++)if(t(n[r]))return!0}return!1}function H(e,t){var r;if(e){r=[];e:for(var n=0,i=e;n<i.length;n++){for(var s=i[n],a=0,o=r;a<o.length;a++){var l=o[a];if(t?t(l,s):l===s)continue e}r.push(s)}}return r}function a(e,t,r){if(!e||!t)return e===t;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!(r?r(e[n],t[n]):e[n]===t[n]))return!1;return!0}function G(e,t){return t<0?e.length+t:t}function o(e,t,r,n){if(void 0!==t&&0!==t.length){if(void 0===e)return t.slice(r,n);r=void 0===r?0:G(t,r),n=void 0===n?t.length:G(t,n);for(var i=r;i<n&&i<t.length;i++)void 0!==t[i]&&e.push(t[i])}return e}function j(e,t){return!s(e,t)&&(e.push(t),!0)}function K(e,t){if(e&&(t=G(e,t))<e.length)return e[t]}function g(e){return K(e,-1)}function z(e,t,r,n,i){if(e&&0<e.length){var s=e.length;if(0<s){var a=void 0===n||n<0?0:n,o=void 0===i||s-1<a+i?s-1:a+i,l=void 0;for(arguments.length<=2?(l=e[a],a++):l=r;a<=o;)l=t(l,e[a],a),a++;return l}}return r}f.toPath=function(e,t,r){return r(E(e)?x(e):me(e,t))},(N=f.Comparison||(f.Comparison={}))[N.LessThan=-1]="LessThan",N[N.EqualTo=0]="EqualTo",N[N.GreaterThan=1]="GreaterThan",f.length=function(e){return e?e.length:0},f.forEach=r,f.firstDefined=function(e,t){for(var r=0;r<e.length;r++){var n=t(e[r],r);if(void 0!==n)return n}},f.findAncestor=function(e,t){for(;e;){var r=t(e);if("quit"===r)return;if(r)return e;e=e.parent}},f.zipWith=function(e,t,r){var n=[];O.assert(e.length===t.length);for(var i=0;i<e.length;i++)n.push(r(e[i],t[i],i));return n},f.zipToMap=function(e,t){O.assert(e.length===t.length);for(var r=_(),n=0;n<e.length;++n)r.set(e[n],t[n]);return r},f.every=function(e,t){if(e)for(var r=0;r<e.length;r++)if(!t(e[r],r))return!1;return!0},f.find=i,f.findLast=function(e,t){for(var r=e.length-1;0<=r;r--){var n=e[r];if(t(n,r))return n}},f.findIndex=F,f.findMap=function(e,t){for(var r=0;r<e.length;r++){var n=t(e[r],r);if(n)return n}O.fail()},f.contains=s,f.indexOf=function(e,t){if(e)for(var r=0;r<e.length;r++)if(e[r]===t)return r;return-1},f.indexOfAnyCharCode=B,f.countWhere=function(e,t){var r=0;if(e)for(var n=0;n<e.length;n++)t(e[n],n)&&r++;return r},f.filter=function(e,t){if(e){for(var r=e.length,n=0;n<r&&t(e[n]);)n++;if(n<r){var i=e.slice(0,n);for(n++;n<r;){var s=e[n];t(s)&&i.push(s),n++}return i}}return e},f.filterMutate=$,f.clear=function(e){e.length=0},f.map=y,f.sameMap=function(e,t){var r;if(e)for(var n,i=0;i<e.length;i++)r?r.push(t(e[i],i)):(n=e[i])!==(n=t(n,i))&&(r=e.slice(0,i)).push(n);return r||e},f.flatten=U,f.flatMap=V,f.flatMapIter=function(e,t){for(var r=[];;){var n=e.next(),i=n.value;if(n.done)break;n=t(i);n&&(c(n)?r.push.apply(r,n):r.push(n))}return r},f.sameFlatMap=function(e,t){var r;if(e)for(var n=0;n<e.length;n++){var i=e[n],s=t(i,n);(r||i!==s||c(s))&&(r=r||e.slice(0,n),c(s)?o(r,s):r.push(s))}return r||e},f.mapDefined=function(e,t){var r=[];if(e)for(var n=0;n<e.length;n++){var i=t(e[n],n);void 0!==i&&r.push(i)}return r},f.mapDefinedIter=function(e,t){for(var r=[];;){var n=e.next(),i=n.value;if(n.done)break;n=t(i);void 0!==n&&r.push(n)}return r},f.span=function(e,t){if(e){for(var r=0;r<e.length;r++)if(!t(e[r],r))return[e.slice(0,r),e.slice(r)];return[e.slice(0),[]]}},f.spanMap=function(e,t,r){if(e)for(var n,i=[],s=e.length,a=void 0,o=void 0,l=0,c=0;l<s;){for(;c<s;){o=t(e[c],c);if(0===c)a=o;else if(o!==a)break;c++}l<c&&((n=r(e.slice(l,c),a,l,c))&&i.push(n),l=c),a=o,c++}return i},f.mapEntries=function(e,r){var n;if(e)return n=_(),e.forEach(function(e,t){t=r(t,e),e=t[0];n.set(e,t[1])}),n},f.some=b,f.concatenate=function(e,t){return b(t)?b(e)?e.concat(t):t:e},f.deduplicate=H,f.arrayIsEqualTo=a,f.changesAffectModuleResolution=function(e,t){return!(e&&e.module===t.module&&e.moduleResolution===t.moduleResolution&&e.noResolve===t.noResolve&&e.target===t.target&&e.noLib===t.noLib&&e.jsx===t.jsx&&e.allowJs===t.allowJs&&e.rootDir===t.rootDir&&e.configFilePath===t.configFilePath&&e.baseUrl===t.baseUrl&&e.maxNodeModuleJsDepth===t.maxNodeModuleJsDepth&&a(e.lib,t.lib)&&a(e.typeRoots,t.typeRoots)&&a(e.rootDirs,t.rootDirs)&&J(e.paths,t.paths))},f.compact=function(e){var t;if(e)for(var r=0;r<e.length;r++){var n=e[r];!t&&n||(t=t||e.slice(0,r),n&&t.push(n))}return t||e},f.relativeComplement=function(e,t,r,n,i){if(void 0===r&&(r=m),void 0===n&&(n=0),void 0===i&&(i=0),!t||!e||0===t.length||0===e.length)return t;var s=[];e:for(;i<t.length;i++){t:for(;n<e.length;n++)switch(r(t[i],e[n])){case-1:break t;case 0:continue e;case 1:continue}s.push(t[i])}return s},f.sum=function(e,t){for(var r=0,n=0,i=e;n<i.length;n++)r+=i[n][t];return r},f.append=function(e,t){if(void 0!==t){if(void 0===e)return[t];e.push(t)}return e},f.addRange=o,f.pushIfUnique=j,f.appendIfUnique=function(e,t){return e?(j(e,t),e):[t]},f.stableSort=function(r,n){return void 0===n&&(n=m),r.map(function(e,t){return t}).sort(function(e,t){return n(r[e],r[t])||m(e,t)}).map(function(e){return r[e]})},f.rangeEquals=function(e,t,r,n){for(;r<n;){if(e[r]!==t[r])return!1;r++}return!0},f.elementAt=K,f.firstOrUndefined=function(e){return K(e,0)},f.first=function(e){return O.assert(0!==e.length),e[0]},f.lastOrUndefined=g,f.last=function(e){return O.assert(0!==e.length),e[e.length-1]},f.singleOrUndefined=function(e){return e&&1===e.length?e[0]:void 0},f.singleOrMany=function(e){return e&&1===e.length?e[0]:e},f.replaceElement=function(e,t,r){return(e=e.slice(0))[t]=r,e},f.binarySearch=function(e,t,r,n){if(!e||0===e.length)return-1;var i=n||0,s=e.length-1;for(r=void 0!==r?r:function(e,t){return e<t?-1:t<e?1:0};i<=s;){var a=i+(s-i>>1),o=e[a];if(0===r(o,t))return a;0<r(o,t)?s=a-1:i=a+1}return~i},f.reduceLeft=z,f.reduceRight=function(e,t,r,n,i){if(e){var s=e.length;if(0<s){var a=void 0===n||s-1<n?s-1:n,o=void 0===i||a-i<0?0:a-i,l=void 0;for(arguments.length<=2?(l=e[a],a--):l=r;o<=a;)l=t(l,e[a],a),a--;return l}}return r};var l=Object.prototype.hasOwnProperty;function W(e,t){return l.call(e,t)}function q(e,r){e.forEach(function(e,t){r.set(t,e)})}function J(e,t,r){if(e!==t){if(!e||!t)return!1;for(var n in e)if(l.call(e,n)&&(l.call(t,n),r?!r(e[n],t[n]):e[n]!==t[n]))return!1;for(var n in t)if(l.call(t,n)&&!l.call(e,n))return!1}return!0}function Y(e,t,r){for(var n=_(),i=0,s=e;i<s.length;i++){var a=s[i];n.set(t(a),r?r(a):a)}return n}function X(e,t){var r=this.get(e);return r?r.push(t):this.set(e,r=[t]),r}function Z(e,t){var r=this.get(e);r&&(Ye(r,t),r.length||this.delete(e))}function c(e){return Array.isArray?Array.isArray(e):e instanceof Array}function u(e){return"string"==typeof e}function Q(e){var t;return function(){return e&&(t=e(),e=void 0),t}}function d(t,r,n,i,e){if(e){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];return function(e){return z(s,function(e,t){return t(e)},e)}}return i?function(e){return i(n(r(t(e))))}:n?function(e){return n(r(t(e)))}:r?function(e){return r(t(e))}:t?function(e){return t(e)}:function(e){return e}}function p(e,r,n){return n=n||0,e.replace(/{(\d+)}/g,function(e,t){return r[+t+n]})}function h(e){return f.localizedDiagnosticMessages&&f.localizedDiagnosticMessages[e.key]||e.message}function m(e,t){return e===t?0:void 0===e||void 0!==t&&e<t?-1:1}function T(e,t,r){if(e===t)return 0;if(void 0===e)return-1;if(void 0===t)return 1;if(r){if(f.collator)return(r=f.localeCompareIsCorrect?f.collator.compare(e,t):e.localeCompare(t,void 0,{usage:"sort",sensitivity:"accent"}))<0?-1:0<r?1:0;if((e=e.toUpperCase())===(t=t.toUpperCase()))return 0}return e<t?-1:1}function ee(e,t){return T(e,t,!0)}function te(e){return e.file?e.file.fileName:void 0}function re(e,t){return m(te(e),te(t))||m(e.start,t.start)||m(e.length,t.length)||m(e.code,t.code)||((e,t)=>{for(;e&&t;){var r=u(e)?e:e.messageText,n=u(t)?t:t.messageText,r=m(r,n);if(r)return r;e=u(e)?void 0:e.next,t=u(t)?void 0:t.next}return e||t?e?1:-1:0})(e.messageText,t.messageText)||0}function ne(e){if(e.length<2)return e;for(var t=[e[0]],r=e[0],n=1;n<e.length;n++){var i=e[n];0===re(i,r)||(t.push(i),r=i)}return t}function v(e){return e.replace(/\\/g,"/")}function k(e){var t,r;return 47===e.charCodeAt(0)?47!==e.charCodeAt(1)?1:(r=e.indexOf("/",2))<0?2:(t=e.indexOf("/",r+1))<0?r+1:t+1:58===e.charCodeAt(1)?47===e.charCodeAt(2)?3:2:0===e.lastIndexOf("file:///",0)?"file:///".length:-1!==(r=e.indexOf("://"))?r+"://".length:0}f.hasProperty=W,f.getProperty=function(e,t){return l.call(e,t)?e[t]:void 0},f.getOwnKeys=function(e){var t,r=[];for(t in e)l.call(e,t)&&r.push(t);return r},f.getOwnValues=function(e){var t,r=[];for(t in e)l.call(e,t)&&r.push(e[t]);return r},f.arrayFrom=function(e,t){for(var r,n=[],i=e.next(),s=i.value,a=i.done;!a;s=(r=e.next()).value,a=r.done)n.push(t?t(s):s);return n},f.forEachEntry=function(e,t){for(var r=e.entries(),n=(e=r.next()).value,i=e.done;!i;n=(s=r.next()).value,i=s.done){var s=n[0],s=t(n[1],s);if(s)return s}},f.forEachKey=function(e,t){for(var r=e.keys(),n=(e=r.next()).value,i=e.done;!i;n=(s=r.next()).value,i=s.done){var s=t(n);if(s)return s}},f.copyEntries=q,f.assign=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n=0,i=t;n<i.length;n++){var s,a=i[n];for(s in a)W(a,s)&&(e[s]=a[s])}return e},f.equalOwnProperties=J,f.arrayToMap=Y,f.arrayToNumericMap=function(e,t){for(var r=[],n=0,i=e;n<i.length;n++){var s=i[n];r[t(s)]=s}return r},f.arrayToSet=function(e,t){return Y(e,t||function(e){return e},function(){return!0})},f.cloneMap=function(e){var t=_();return q(e,t),t},f.clone=function(e){var t,r={};for(t in e)l.call(e,t)&&(r[t]=e[t]);return r},f.extend=function(e,t){var r,n={};for(r in t)l.call(t,r)&&(n[r]=t[r]);for(r in e)l.call(e,r)&&(n[r]=e[r]);return n},f.createMultiMap=function(){var e=_();return e.add=X,e.remove=Z,e},f.isArray=c,f.isString=u,f.tryCast=function(e,t){return void 0!==e&&t(e)?e:void 0},f.cast=function(e,t){if(void 0!==e&&t(e))return e;O.fail("Invalid cast. The supplied value did not pass the test '"+O.getFunctionName(t)+"'.")},f.noop=function(){},f.returnFalse=function(){return!1},f.returnTrue=function(){return!0},f.identity=function(e){return e},f.notImplemented=function(){throw new Error("Not implemented")},f.memoize=Q,f.chain=function(t,r,n,i,e){if(e){for(var s=[],a=0;a<arguments.length;a++)s[a]=arguments[a];return function(t){return d.apply(void 0,y(s,function(e){return e(t)}))}}return i?function(e){return d(t(e),r(e),n(e),i(e))}:n?function(e){return d(t(e),r(e),n(e))}:r?function(e){return d(t(e),r(e))}:t?function(e){return d(t(e))}:function(e){return function(e){return e}}},f.compose=d,f.formatStringFromArgs=p,f.localizedDiagnosticMessages=void 0,f.getLocaleSpecificMessage=h,f.createFileDiagnostic=function(e,t,r,n){O.assertGreaterThanOrEqual(t,0),O.assertGreaterThanOrEqual(r,0),e&&(O.assertLessThanOrEqual(t,e.text.length),O.assertLessThanOrEqual(t+r,e.text.length));var i=h(n);return{file:e,start:t,length:r,messageText:i=4<arguments.length?p(i,arguments,4):i,category:n.category,code:n.code}},f.formatMessage=function(e,t){return t=h(t),t=2<arguments.length?p(t,arguments,2):t},f.createCompilerDiagnostic=function(e){var t=h(e);return{file:void 0,start:void 0,length:void 0,messageText:t=1<arguments.length?p(t,arguments,1):t,category:e.category,code:e.code}},f.createCompilerDiagnosticFromMessageChain=function(e){return{file:void 0,start:void 0,length:void 0,code:e.code,category:e.category,messageText:e.next?e:e.messageText}},f.chainDiagnosticMessages=function(e,t){var r=h(t);return{messageText:r=2<arguments.length?p(r,arguments,2):r,category:t.category,code:t.code,next:e}},f.concatenateDiagnosticMessageChains=function(e,t){for(var r=e;r.next;)r=r.next;return r.next=t,e},f.compareValues=m,f.compareStrings=T,f.compareStringsCaseInsensitive=ee,f.compareDiagnostics=re,f.sortAndDeduplicateDiagnostics=function(e){return ne(e.sort(re))},f.deduplicateSortedDiagnostics=ne,f.normalizeSlashes=v,f.getRootLength=k,f.directorySeparator="/";var ie=47;function se(e,t){for(var r=[],n=0,i=e.substr(t).split(f.directorySeparator);n<i.length;n++){var s=i[n];"."!==s&&(".."===s&&0<r.length&&".."!==g(r)?r.pop():s&&r.push(s))}return r}function x(e){return ae(e).path}function ae(e){var t,r=k(e=v(e)),n=e.substr(0,r),r=se(e,r);return r.length?(t=n+r.join(f.directorySeparator),{path:oe(e)?t+f.directorySeparator:t,parts:r}):{path:n,parts:r}}function oe(e){return e.charCodeAt(e.length-1)===ie}function le(e){return e.substr(0,Math.max(k(e),e.lastIndexOf(f.directorySeparator)))}function ce(e){return e&&!E(e)&&Te(e,"://")}function ue(e){return e.target||0}function de(e){return"number"==typeof e.module?e.module:2<=ue(e)?f.ModuleKind.ES2015:f.ModuleKind.CommonJS}function pe(e){for(var t=!1,r=0;r<e.length;r++)if(42===e.charCodeAt(r)){if(t)return!1;t=!0}return!0}function E(e){return e&&0!==k(e)}function he(e,t){var r=se(e,t);return[e.substr(0,t)].concat(r)}function S(e,t){var r=k(e=v(e));return 0===r&&(r=k(e=w(v(t),e))),he(e,r)}function me(e,t){return ge(S(e,t))}function ge(e){if(e&&e.length)return e[0]+e.slice(1).join(f.directorySeparator)}function fe(e,t){if(ce(e)){for(var r,n=e,i=n.length,s=n.indexOf("://")+"://".length;s<i&&47===n.charCodeAt(s);)s++;return s===i?[n]:-1!==(r=n.indexOf(f.directorySeparator,s))?he(n,s=r+1):[n+f.directorySeparator]}return S(e,t)}function _e(e,t,r,n,i){var s,a=fe(t,r),o=fe(e,r);for(1<o.length&&""===g(o)&&o.pop(),s=0;s<a.length&&s<o.length&&n(o[s])===n(a[s]);s++);if(s){for(var l="",t=a.slice(s,a.length);s<o.length;s++)""!==o[s]&&(l=l+".."+f.directorySeparator);return l+t.join(f.directorySeparator)}e=ge(a);return e=i&&E(e)?"file:///"+e:e}function C(e){var t;if(void 0!==e)return(t=e.lastIndexOf(f.directorySeparator))<0?e:e.substring(t+1)}function w(e,t){return e&&e.length?t&&t.length?0!==k(t)?t:e.charAt(e.length-1)===f.directorySeparator?e+t:e+f.directorySeparator+t:e:t}function I(e){return e.charAt(e.length-1)===f.directorySeparator?e.substr(0,e.length-1):e}function ye(e,t,r,n){if(void 0===e||void 0===t)return!1;if(e!==t&&(e=I(e))!==(t=I(t))){var i=S(e,r),s=S(t,r);if(s.length<i.length)return!1;for(var a=0;a<i.length;a++)if(0!==T(i[a],s[a],n))return!1}return!0}function be(e,t){return 0===e.lastIndexOf(t,0)}function ve(e,t){var r=e.length-t.length;return 0<=r&&e.indexOf(t,r)===r}function Te(e,t){return-1!==e.indexOf(t)}function ke(e){return Te(C(e),".")}function A(e,t){return e.length>t.length&&ve(e,t)}function xe(e,t){for(var r=0,n=t;r<n.length;r++)if(A(e,n[r]))return!0;return!1}f.normalizePath=x,f.normalizePathAndParts=ae,f.pathEndsWithDirectorySeparator=oe,f.getDirectoryPath=le,f.isUrl=ce,f.pathIsRelative=function(e){return/^\.\.?($|[\\/])/.test(e)},f.moduleHasNonRelativeName=function(e){return!f.isExternalModuleNameRelative(e)},f.getEmitScriptTarget=ue,f.getEmitModuleKind=de,f.getEmitModuleResolutionKind=function(e){var t=e.moduleResolution;return t=void 0===t?de(e)===f.ModuleKind.CommonJS?f.ModuleResolutionKind.NodeJs:f.ModuleResolutionKind.Classic:t},f.hasZeroOrOneAsteriskCharacter=pe,f.isRootedDiskPath=E,f.convertToRelativePath=function(e,t,r){return E(e)?_e(t,e,t,r,!1):e},f.getNormalizedPathComponents=S,f.getNormalizedAbsolutePath=me,f.getNormalizedPathFromPathComponents=ge,f.getRelativePathToDirectoryOrUrl=_e,f.getBaseFileName=C,f.combinePaths=w,f.removeTrailingDirectorySeparator=I,f.ensureTrailingDirectorySeparator=function(e){return e.charAt(e.length-1)!==f.directorySeparator?e+f.directorySeparator:e},f.comparePaths=function(e,t,r,n){if(e===t)return 0;if(void 0===e)return-1;if(void 0===t)return 1;e=I(e),t=I(t);for(var i=S(e,r),s=S(t,r),a=Math.min(i.length,s.length),o=0;o<a;o++){var l=T(i[o],s[o],n);if(0!==l)return l}return m(i.length,s.length)},f.containsPath=ye,f.startsWith=be,f.removePrefix=function(e,t){return be(e,t)?e.substr(t.length):e},f.endsWith=ve,f.stringContains=Te,f.hasExtension=ke,f.fileExtensionIs=A,f.fileExtensionIsOneOf=xe;var Ee=/[^\w\s\/]/g,Se=[42,63],Ce=(f.commonPackageFolders=["node_modules","bower_components","jspm_packages"],"(?!("+f.commonPackageFolders.join("|")+")(/|$))"),we={singleAsteriskRegexFragment:"([^./]|(\\.(?!min\\.js$))?)*",doubleAsteriskRegexFragment:"(/"+Ce+"[^/.][^/]*)*?",replaceWildcardCharacter:function(e){return Re(e,we.singleAsteriskRegexFragment)}},Ie={singleAsteriskRegexFragment:"[^/]*",doubleAsteriskRegexFragment:"(/"+Ce+"[^/.][^/]*)*?",replaceWildcardCharacter:function(e){return Re(e,Ie.singleAsteriskRegexFragment)}},Ae={singleAsteriskRegexFragment:"[^/]*",doubleAsteriskRegexFragment:"(/.+?)?",replaceWildcardCharacter:function(e){return Re(e,Ae.singleAsteriskRegexFragment)}},De={files:we,directories:Ie,exclude:Ae};function D(e,t,r){e=Ne(e,t,r);if(e&&e.length)return"^("+e.map(function(e){return"("+e+")"}).join("|")+")"+("exclude"===r?"($|/)":"$")}function Ne(e,t,r){if(void 0!==e&&0!==e.length)return V(e,function(e){return e&&((e,t,r,n)=>{var i=n.singleAsteriskRegexFragment,s=n.doubleAsteriskRegexFragment,a=n.replaceWildcardCharacter,o="",l=!1,c=!1,e=g(n=S(e,t));if("exclude"===r||"**"!==e){n[0]=I(n[0]),Oe(e)&&n.push("**","*");for(var u=0,d=0,p=n;d<p.length;d++){var h,m=p[d];if("**"===m){if(l)return;o+=s,l=!0}else"directories"===r&&(o+="(",u++),c&&(o+=f.directorySeparator),"exclude"!==r?(h="",42===m.charCodeAt(0)?(h+="([^./]"+i+")?",m=m.substr(1)):63===m.charCodeAt(0)&&(h+="[^./]",m=m.substr(1)),(h+=m.replace(Ee,a))!==m&&(o+=Ce),o+=h):o+=m.replace(Ee,a);c=!0}for(;0<u;)o+=")?",u--;return o}})(e,t,r,De[r])})}function Oe(e){return!/[.*?]/.test(e)}function Re(e,t){return"*"===e?t:"?"===e?"[^/]":"\\"+e}function Le(e,t,r,n,i){e=x(e);i=w(i=x(i),e);return{includeFilePatterns:y(Ne(r,i,"files"),function(e){return"^"+e+"$"}),includeFilePattern:D(r,i,"files"),includeDirectoryPattern:D(r,i,"directories"),excludePattern:D(t,i,"exclude"),basePaths:((r,e,n)=>{var i=[r];if(e){for(var t=[],s=0,a=e;s<a.length;s++){var o=a[s],o=E(o)?o:x(w(r,o));t.push((e=>{var t=B(e,Se);return t<0?ke(e)?I(le(e)):e:e.substring(0,e.lastIndexOf(f.directorySeparator,t))})(o))}t.sort(n?T:ee);for(var l=0,c=t;l<c.length;l++)(t=>{f.every(i,function(e){return!ye(e,t,r,!n)})&&i.push(t)})(c[l])}return i})(e,r,n)}}function Pe(e,m,t,r,n,i,s,g){for(var e=Le(e=x(e),t,r,n,i=x(i)),a=n?"":"i",f=e.includeFilePatterns&&e.includeFilePatterns.map(function(e){return new RegExp(e,a)}),_=e.includeDirectoryPattern&&new RegExp(e.includeDirectoryPattern,a),y=e.excludePattern&&new RegExp(e.excludePattern,a),b=f?f.map(function(){return[]}):[[]],v=n?T:ee,o=0,l=e.basePaths;o<l.length;o++){var c=l[o];!function e(n,i,t){var r=g(n),s=r.files,r=r.directories;s=s.slice().sort(v);var a=function(e){var t=w(n,e),r=w(i,e);return m&&!xe(t,m)||y&&y.test(r)?"continue":void(f?-1!==(e=F(f,function(e){return e.test(r)}))&&b[e].push(t):b[0].push(t))};for(var o=0,l=s;o<l.length;o++){var c=l[o];a(c)}if(void 0!==t&&0===--t)return;r=r.slice().sort(v);for(var u=0,d=r;u<d.length;u++){var c=d[u],p=w(n,c),h=w(i,c);_&&!_.test(h)||y&&y.test(h)||e(p,h,t)}}(c,w(i,c),s)}return U(b)}function Me(e){switch(e.substr(e.lastIndexOf(".")).toLowerCase()){case".js":return 1;case".jsx":return 2;case".ts":return 3;case".tsx":return 4;case".json":return 6;default:return 0}}f.getRegularExpressionForWildcard=D,f.isImplicitGlob=Oe,f.getFileMatcherPatterns=Le,f.matchFiles=Pe,f.ensureScriptKind=function(e,t){return t||Me(e)||3},f.getScriptKindFromFileName=Me,f.supportedTypeScriptExtensions=[".ts",".tsx",".d.ts"],f.supportedTypescriptExtensionsForExtractExtension=[".d.ts",".ts",".tsx"],f.supportedJavascriptExtensions=[".js",".jsx"];var Fe=f.supportedTypeScriptExtensions.concat(f.supportedJavascriptExtensions);function Be(e,t){e=e&&e.allowJs;return t&&0!==t.length&&e?H(Fe.concat(t.map(function(e){return e.extension}))):e?Fe:f.supportedTypeScriptExtensions}function $e(e,t){return e<2?0:e<t.length?2:t.length}f.getSupportedExtensions=Be,f.hasJavaScriptFileExtension=function(t){return r(f.supportedJavascriptExtensions,function(e){return A(t,e)})},f.hasTypeScriptFileExtension=function(t){return r(f.supportedTypeScriptExtensions,function(e){return A(t,e)})},f.isSupportedSourceFileName=function(e,t,r){if(e)for(var n=0,i=Be(t,r);n<i.length;n++)if(A(e,i[n]))return!0;return!1},(N=f.ExtensionPriority||(f.ExtensionPriority={}))[N.TypeScriptFiles=0]="TypeScriptFiles",N[N.DeclarationAndJavaScriptFiles=2]="DeclarationAndJavaScriptFiles",N[N.Highest=0]="Highest",N[N.Lowest=2]="Lowest",f.getExtensionPriority=function(e,t){for(var r=t.length-1;0<=r;r--)if(A(e,t[r]))return $e(r,t);return 0},f.adjustExtensionPriority=$e,f.getNextLowestExtensionPriority=function(e,t){return e<2?2:t.length};var N,O,R,Ue=[".d.ts",".ts",".js",".tsx",".jsx"];function Ve(e){for(var t=0,r=Ue;t<r.length;t++){var n=He(e,r[t]);if(void 0!==n)return n}return e}function He(e,t){return A(e,t)?Ge(e,t):void 0}function Ge(e,t){return e.substring(0,e.length-t.length)}function je(e,t){this.flags=e,this.escapedName=t,this.declarations=void 0}function Ke(e,t){this.flags=t,O.isDebugging&&(this.checker=e)}function ze(){}function L(e,t,r){this.id=0,this.kind=e,this.pos=t,this.end=r,this.flags=0,this.modifierFlagsCache=0,this.transformFlags=0,this.parent=void 0,this.original=void 0}function We(e,t,r){this.fileName=e,this.text=t,this.skipTrivia=r||function(e){return e}}function P(e,t){e=new Error(e?"Debug Failure. "+e:"Debug Failure.");throw Error.captureStackTrace&&Error.captureStackTrace(e,t||P),e}function qe(e,t){for(var r=t;r<e.length-1;r++)e[r]=e[r+1];e.pop()}function Je(e,t){e[t]=e[e.length-1],e.pop()}function Ye(e,t){for(var r=e,n=function(e){return e===t},i=0;i<r.length;i++)if(n(r[i])){Je(r,i);break}}function Xe(e){return e?function(e){return e}:function(e){return e.toLowerCase()}}function Ze(e,t,r){for(var n=void 0,i=-1,s=0,a=e;s<a.length;s++){var o=a[s],l=t(o);Qe(l,r)&&l.prefix.length>i&&(i=l.prefix.length,n=o)}return n}function Qe(e,t){var r=e.prefix,e=e.suffix;return t.length>=r.length+e.length&&be(t,r)&&ve(t,e)}function et(e){O.assert(pe(e));var t=e.indexOf("*");return-1===t?void 0:{prefix:e.substr(0,t),suffix:e.substr(t+1)}}function tt(t){return i(f.supportedTypescriptExtensionsForExtractExtension,function(e){return A(t,e)})||i(f.supportedJavascriptExtensions,function(e){return A(t,e)})}f.removeFileExtension=Ve,f.tryRemoveExtension=He,f.removeExtension=Ge,f.changeExtension=function(e,t){return Ve(e)+t},f.objectAllocator={getNodeConstructor:function(){return L},getTokenConstructor:function(){return L},getIdentifierConstructor:function(){return L},getSourceFileConstructor:function(){return L},getSymbolConstructor:function(){return je},getTypeConstructor:function(){return Ke},getSignatureConstructor:function(){return ze},getSourceMapSourceConstructor:function(){return We}},(N=f.AssertionLevel||(f.AssertionLevel={}))[N.None=0]="None",N[N.Normal=1]="Normal",N[N.Aggressive=2]="Aggressive",N[N.VeryAggressive=3]="VeryAggressive",(R=O=f.Debug||(f.Debug={})).currentAssertionLevel=0,R.isDebugging=!1,R.shouldAssert=function(e){return R.currentAssertionLevel>=e},R.assert=function e(t,r,n,i){t||(n&&(r+="\r\nVerbose Debug Information: "+("string"==typeof n?n:n())),P(r?"False expression: "+r:"False expression.",i||e))},R.assertEqual=function(e,t,r,n){e!==t&&P("Expected "+e+" === "+t+". "+(r?n?r+" "+n:r:""))},R.assertLessThan=function(e,t,r){t<=e&&P("Expected "+e+" < "+t+". "+(r||""))},R.assertLessThanOrEqual=function(e,t){t<e&&P("Expected "+e+" <= "+t)},R.assertGreaterThanOrEqual=function(e,t){e<t&&P("Expected "+e+" >= "+t)},R.fail=P,R.assertNever=function e(t,r,n){return P(r||"Illegal value: "+t,n||e)},R.getFunctionName=function(e){return"function"!=typeof e?"":e.hasOwnProperty("name")?e.name:(e=Function.prototype.toString.call(e),(e=/^function\s+([\w\$]+)\s*\(/.exec(e))?e[1]:"")},f.orderedRemoveItem=function(e,t){for(var r=0;r<e.length;r++)if(e[r]===t)return qe(e,r),!0;return!1},f.orderedRemoveItemAt=qe,f.unorderedRemoveItemAt=Je,f.unorderedRemoveItem=Ye,f.createGetCanonicalFileName=Xe,f.matchPatternOrExact=function(e,t){for(var r=[],n=0,i=e;n<i.length;n++){var s=i[n],a=et(s);if(a)r.push(a);else if(s===t)return s}return Ze(r,function(e){return e},t)},f.patternText=function(e){return e.prefix+"*"+e.suffix},f.matchedText=function(e,t){return O.assert(Qe(e,t)),t.substr(e.prefix.length,t.length-e.suffix.length)},f.findBestPatternMatch=Ze,f.tryParsePattern=et,f.positionIsSynthesized=function(e){return!(0<=e)},f.extensionIsTypeScript=function(e){return".ts"===e||".tsx"===e||".d.ts"===e},f.extensionFromPath=function(e){var t=tt(e);if(void 0!==t)return t;O.fail("File "+e+" has unknown extension.")},f.isAnySupportedFileExtension=function(e){return void 0!==tt(e)},f.tryGetExtensionFromPath=tt,f.getAnyExtensionFromPath=function(e){var t=(e=C(e)).lastIndexOf(".");if(0<=t)return e.substring(t)},f.isCheckJsEnabledForFile=function(e,t){return e.checkJsDirective?e.checkJsDirective.enabled:t.checkJs},f.and=function(t,r){return function(e){return t(e)&&r(e)}},f.assertTypeIsNever=function(e){},f.createCachedDirectoryStructureHost=function(o){var n=_(),l=Q(function(){return o.getCurrentDirectory()}),r=Xe(o.useCaseSensitiveFileNames);return{useCaseSensitiveFileNames:o.useCaseSensitiveFileNames,newLine:o.newLine,readFile:function(e,t){return o.readFile(e,t)},write:function(e){return o.write(e)},writeFile:function(e,t,r){var n=i(c(e));n&&g(n,s(e),!0);return o.writeFile(e,t,r)},fileExists:function(e){var t=i(c(e));return t&&h(t.files,s(e))||o.fileExists(e)},directoryExists:function(e){var t=c(e);return n.has(t)||o.directoryExists(e)},createDirectory:function(e){var t=i(c(e)),r=s(e);t&&m(t.directories,r,!0);o.createDirectory(e)},getCurrentDirectory:l,getDirectories:function(e){var t=c(e),t=p(e,t);if(t)return t.directories.slice();return o.getDirectories(e)},readDirectory:function(e,t,r,n,i){var s=c(e),a=p(e,s);if(a)return Pe(e,t,r,n,o.useCaseSensitiveFileNames,l(),i,function(e){var t=c(e);return t!==s?u(t)||d(e,t):a});return o.readDirectory(e,t,r,n,i)},addOrDeleteFileOrDirectory:function(e,t){if(u(t))o.directoryExists(e)||n.delete(t);else{var r=i(t);if(r){e=s(e);if(r)return t={fileExists:o.fileExists(t),directoryExists:o.directoryExists(t)},g(r,e,t.fileExists),m(r.directories,e,t.directoryExists),t}}},addOrDeleteFile:function(e,t,r){r!==f.FileWatcherEventKind.Changed&&(t=i(t))&&g(t,s(e),r===f.FileWatcherEventKind.Created)},clearCache:function(){n.clear()},exit:function(e){return o.exit(e)}};function c(e){return f.toPath(e,l(),r)}function u(e){return n.get(e)}function i(e){return u(le(e))}function s(e){return C(x(e))}function d(e,t){e={files:y(o.readDirectory(e,void 0,void 0,["*.*"]),s)||[],directories:o.getDirectories(e)||[]};return n.set(t,e),e}function p(e,t){var r=u(t);if(r)return r;try{return d(e,t)}catch(e){O.assert(!n.has(t))}}function a(e,t){return r(e)===r(t)}function h(e,t){return b(e,function(e){return a(e,t)})}function m(e,t,r){h(e,t)?r||$(e,function(e){return!a(e,t)}):r&&e.push(t)}function g(e,t,r){m(e.files,t,r)}}})(ts=ts||{}),(y=>{var b,e,i,s;function v(){if("undefined"!=typeof process){var e=process.version;if(e){var t=e.indexOf(".");if(-1!==t)return parseInt(e.substring(1,t))}}}function t(){var c=require("fs"),t=require("path"),e=require("os"),r=require("crypto"),i=process.env.TSC_NONPOLLING_WATCHER;n=y.createMap(),o=y.createMultiMap();var n,o,s={addFile:function(e,t){return((e,t)=>{o.add(e,t)})(e,t),(a=>{var e=n.get(a);e?e.referenceCount+=1:((e=p(a||".",function(e,t){var r=a,n=y.isString(t)?y.getNormalizedAbsolutePath(t,r):void 0;if("change"===e||"rename"===e){t=o.get(n);if(t)for(var i=0,s=t;i<s.length;i++)(0,s[i])(n,b.Changed)}})).referenceCount=1,n.set(a,e))})(y.getDirectoryPath(e)),{fileName:e,callback:t}},removeFile:function(e){((e,t)=>{o.remove(e,t)})(e.fileName,e.callback),(e=>{var e=y.getDirectoryPath(e),t=n.get(e);t&&(--t.referenceCount,t.referenceCount<=0)&&(t.close(),n.delete(e))})(e.fileName)}},l=4<=v();var a=e.platform(),u="win32"!==a&&"win64"!==a&&!g(__filename.replace(/\w/g,function(e){var t=e.toUpperCase();return e===t?e.toLowerCase():t}));function d(i,s,e){return c.watchFile(i,{persistent:!0,interval:e||250},t),{close:function(){return c.unwatchFile(i,t)}};function t(e,t){var r=0==+e.mtime,n=0==+t.mtime,r=!r&&n?b.Created:r&&!n?b.Deleted:b.Changed;r===b.Changed&&+e.mtime<=+t.mtime||s(i,r)}}function p(r,n,t){var i,s=(f(r)?a:o)();return{close:function(){s.close()}};function a(){void 0===i&&(i=!l||"win32"!==process.platform&&"darwin"!==process.platform?{persistent:!0}:{persistent:!0,recursive:!!t});var e=c.watch(r,i,n);return e.on("error",function(){f(r)||(s=o(),n("rename",""))}),e}function o(){return d(r,function(e,t){t===b.Created&&f(r)&&(s.close(),s=a(),n("rename",""))})}}function h(e){try{for(var t=c.readdirSync(e||".").sort(),r=[],n=[],i=0,s=t;i<s.length;i++){var a=s[i];if("."!==a&&".."!==a){var o=y.combinePaths(e,a),l=void 0;try{l=c.statSync(o)}catch(e){continue}l.isFile()?r.push(a):l.isDirectory()&&n.push(a)}}return{files:r,directories:n}}catch(e){return{files:[],directories:[]}}}function m(e,t){try{var r=c.statSync(e);switch(t){case 0:return r.isFile();case 1:return r.isDirectory()}}catch(e){return!1}}function g(e){return m(e,0)}function f(e){return m(e,1)}var _={args:process.argv.slice(2),newLine:e.EOL,useCaseSensitiveFileNames:u,write:function(e){process.stdout.write(e)},readFile:function(e,t){if(g(e)){var r=c.readFileSync(e),n=r.length;if(2<=n&&254===r[0]&&255===r[1]){n&=-2;for(var i=0;i<n;i+=2){var s=r[i];r[i]=r[i+1],r[i+1]=s}return r.toString("utf16le",2)}return 2<=n&&255===r[0]&&254===r[1]?r.toString("utf16le",2):3<=n&&239===r[0]&&187===r[1]&&191===r[2]?r.toString("utf8",3):r.toString("utf8")}},writeFile:function(e,t,r){var n;r&&(t="\ufeff"+t);try{n=c.openSync(e,"w"),c.writeSync(n,t,void 0,"utf8")}finally{void 0!==n&&c.closeSync(n)}},watchFile:function(e,t,r){var n;return i?(n=s.addFile(e,t),{close:function(){return s.removeFile(n)}}):d(e,t,r)},watchDirectory:function(r,n,e){return p(r,function(e,t){"rename"===e&&n(t&&y.normalizePath(y.combinePaths(r,t)))},e)},resolvePath:function(e){return t.resolve(e)},fileExists:g,directoryExists:f,createDirectory:function(e){_.directoryExists(e)||c.mkdirSync(e)},getExecutingFilePath:function(){return __filename},getCurrentDirectory:function(){return process.cwd()},getDirectories:function(t){return y.filter(c.readdirSync(t),function(e){return m(y.combinePaths(t,e),1)})},getEnvironmentVariable:function(e){return process.env[e]||""},readDirectory:function(e,t,r,n,i){return y.matchFiles(e,t,r,n,u,process.cwd(),i,h)},getModifiedTime:function(e){try{return c.statSync(e).mtime}catch(e){}},createHash:function(e){var t=r.createHash("md5");return t.update(e),t.digest("hex")},getMemoryUsage:function(){return global.gc&&global.gc(),process.memoryUsage().heapUsed},getFileSize:function(e){try{var t=c.statSync(e);if(t.isFile())return t.size}catch(e){}return 0},exit:function(e){process.exit(e)},realpath:function(e){return c.realpathSync(e)},debugMode:y.some(process.execArgv,function(e){return/^--(inspect|debug)(-brk)?(=\d+)?$/i.test(e)}),tryEnableSourceMapsForHost:function(){try{require("source-map-support").install()}catch(e){}},setTimeout:setTimeout,clearTimeout:clearTimeout};return _}y.setStackTraceLimit=function(){Error.stackTraceLimit<100&&(Error.stackTraceLimit=100)},(e=b=y.FileWatcherEventKind||(y.FileWatcherEventKind={}))[e.Created=0]="Created",e[e.Changed=1]="Changed",e[e.Deleted=2]="Deleted",y.getNodeMajorVersion=v,y.sys=("undefined"!=typeof ChakraHost?i={newLine:ChakraHost.newLine||"\r\n",args:ChakraHost.args,useCaseSensitiveFileNames:!!ChakraHost.useCaseSensitiveFileNames,write:ChakraHost.echo,readFile:function(e,t){return ChakraHost.readFile(e)},writeFile:function(e,t,r){r&&(t="\ufeff"+t),ChakraHost.writeFile(e,t)},resolvePath:ChakraHost.resolvePath,fileExists:ChakraHost.fileExists,directoryExists:ChakraHost.directoryExists,createDirectory:ChakraHost.createDirectory,getExecutingFilePath:function(){return ChakraHost.executingFile},getCurrentDirectory:function(){return ChakraHost.currentDirectory},getDirectories:ChakraHost.getDirectories,getEnvironmentVariable:ChakraHost.getEnvironmentVariable||function(){return""},readDirectory:function(e,t,r,n,i){r=y.getFileMatcherPatterns(e,r,n,!!ChakraHost.useCaseSensitiveFileNames,ChakraHost.currentDirectory);return ChakraHost.readDirectory(e,t,r.basePaths,r.excludePattern,r.includeFilePattern,r.includeDirectoryPattern)},exit:ChakraHost.quit,realpath:ChakraHost.realpath&&function(e){return ChakraHost.realpath(e)}}:"undefined"!=typeof process&&process.nextTick&&!process.browser&&"undefined"!=typeof require&&(i=t()),i&&(s=i.writeFile,i.writeFile=function(e,t,r){var n=y.getDirectoryPath(y.normalizeSlashes(e));n&&!i.directoryExists(n)&&!function e(t,r){var n=y.getDirectoryPath(t),i=""!==n&&t!==n&&!r.directoryExists(n);i&&e(n,r),!i&&r.directoryExists(t)||r.createDirectory(t)}(n,i),s.call(i,e,t,r)}),i),y.sys&&y.sys.getEnvironmentVariable&&(y.Debug.currentAssertionLevel=/^development$/i.test(y.sys.getEnvironmentVariable("NODE_ENV"))?1:0),y.sys&&y.sys.debugMode&&(y.Debug.isDebugging=!0)})(ts=ts||{}),(e=>{function t(e,t,r,n){return{code:e,category:t,key:r,message:n}}e.Diagnostics={Unterminated_string_literal:t(1002,e.DiagnosticCategory.Error,"Unterminated_string_literal_1002","Unterminated string literal."),Identifier_expected:t(1003,e.DiagnosticCategory.Error,"Identifier_expected_1003","Identifier expected."),_0_expected:t(1005,e.DiagnosticCategory.Error,"_0_expected_1005","'{0}' expected."),A_file_cannot_have_a_reference_to_itself:t(1006,e.DiagnosticCategory.Error,"A_file_cannot_have_a_reference_to_itself_1006","A file cannot have a reference to itself."),Trailing_comma_not_allowed:t(1009,e.DiagnosticCategory.Error,"Trailing_comma_not_allowed_1009","Trailing comma not allowed."),Asterisk_Slash_expected:t(1010,e.DiagnosticCategory.Error,"Asterisk_Slash_expected_1010","'*/' expected."),Unexpected_token:t(1012,e.DiagnosticCategory.Error,"Unexpected_token_1012","Unexpected token."),A_rest_parameter_must_be_last_in_a_parameter_list:t(1014,e.DiagnosticCategory.Error,"A_rest_parameter_must_be_last_in_a_parameter_list_1014","A rest parameter must be last in a parameter list."),Parameter_cannot_have_question_mark_and_initializer:t(1015,e.DiagnosticCategory.Error,"Parameter_cannot_have_question_mark_and_initializer_1015","Parameter cannot have question mark and initializer."),A_required_parameter_cannot_follow_an_optional_parameter:t(1016,e.DiagnosticCategory.Error,"A_required_parameter_cannot_follow_an_optional_parameter_1016","A required parameter cannot follow an optional parameter."),An_index_signature_cannot_have_a_rest_parameter:t(1017,e.DiagnosticCategory.Error,"An_index_signature_cannot_have_a_rest_parameter_1017","An index signature cannot have a rest parameter."),An_index_signature_parameter_cannot_have_an_accessibility_modifier:t(1018,e.DiagnosticCategory.Error,"An_index_signature_parameter_cannot_have_an_accessibility_modifier_1018","An index signature parameter cannot have an accessibility modifier."),An_index_signature_parameter_cannot_have_a_question_mark:t(1019,e.DiagnosticCategory.Error,"An_index_signature_parameter_cannot_have_a_question_mark_1019","An index signature parameter cannot have a question mark."),An_index_signature_parameter_cannot_have_an_initializer:t(1020,e.DiagnosticCategory.Error,"An_index_signature_parameter_cannot_have_an_initializer_1020","An index signature parameter cannot have an initializer."),An_index_signature_must_have_a_type_annotation:t(1021,e.DiagnosticCategory.Error,"An_index_signature_must_have_a_type_annotation_1021","An index signature must have a type annotation."),An_index_signature_parameter_must_have_a_type_annotation:t(1022,e.DiagnosticCategory.Error,"An_index_signature_parameter_must_have_a_type_annotation_1022","An index signature parameter must have a type annotation."),An_index_signature_parameter_type_must_be_string_or_number:t(1023,e.DiagnosticCategory.Error,"An_index_signature_parameter_type_must_be_string_or_number_1023","An index signature parameter type must be 'string' or 'number'."),readonly_modifier_can_only_appear_on_a_property_declaration_or_index_signature:t(1024,e.DiagnosticCategory.Error,"readonly_modifier_can_only_appear_on_a_property_declaration_or_index_signature_1024","'readonly' modifier can only appear on a property declaration or index signature."),Accessibility_modifier_already_seen:t(1028,e.DiagnosticCategory.Error,"Accessibility_modifier_already_seen_1028","Accessibility modifier already seen."),_0_modifier_must_precede_1_modifier:t(1029,e.DiagnosticCategory.Error,"_0_modifier_must_precede_1_modifier_1029","'{0}' modifier must precede '{1}' modifier."),_0_modifier_already_seen:t(1030,e.DiagnosticCategory.Error,"_0_modifier_already_seen_1030","'{0}' modifier already seen."),_0_modifier_cannot_appear_on_a_class_element:t(1031,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_class_element_1031","'{0}' modifier cannot appear on a class element."),super_must_be_followed_by_an_argument_list_or_member_access:t(1034,e.DiagnosticCategory.Error,"super_must_be_followed_by_an_argument_list_or_member_access_1034","'super' must be followed by an argument list or member access."),Only_ambient_modules_can_use_quoted_names:t(1035,e.DiagnosticCategory.Error,"Only_ambient_modules_can_use_quoted_names_1035","Only ambient modules can use quoted names."),Statements_are_not_allowed_in_ambient_contexts:t(1036,e.DiagnosticCategory.Error,"Statements_are_not_allowed_in_ambient_contexts_1036","Statements are not allowed in ambient contexts."),A_declare_modifier_cannot_be_used_in_an_already_ambient_context:t(1038,e.DiagnosticCategory.Error,"A_declare_modifier_cannot_be_used_in_an_already_ambient_context_1038","A 'declare' modifier cannot be used in an already ambient context."),Initializers_are_not_allowed_in_ambient_contexts:t(1039,e.DiagnosticCategory.Error,"Initializers_are_not_allowed_in_ambient_contexts_1039","Initializers are not allowed in ambient contexts."),_0_modifier_cannot_be_used_in_an_ambient_context:t(1040,e.DiagnosticCategory.Error,"_0_modifier_cannot_be_used_in_an_ambient_context_1040","'{0}' modifier cannot be used in an ambient context."),_0_modifier_cannot_be_used_with_a_class_declaration:t(1041,e.DiagnosticCategory.Error,"_0_modifier_cannot_be_used_with_a_class_declaration_1041","'{0}' modifier cannot be used with a class declaration."),_0_modifier_cannot_be_used_here:t(1042,e.DiagnosticCategory.Error,"_0_modifier_cannot_be_used_here_1042","'{0}' modifier cannot be used here."),_0_modifier_cannot_appear_on_a_data_property:t(1043,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_data_property_1043","'{0}' modifier cannot appear on a data property."),_0_modifier_cannot_appear_on_a_module_or_namespace_element:t(1044,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_module_or_namespace_element_1044","'{0}' modifier cannot appear on a module or namespace element."),A_0_modifier_cannot_be_used_with_an_interface_declaration:t(1045,e.DiagnosticCategory.Error,"A_0_modifier_cannot_be_used_with_an_interface_declaration_1045","A '{0}' modifier cannot be used with an interface declaration."),A_declare_modifier_is_required_for_a_top_level_declaration_in_a_d_ts_file:t(1046,e.DiagnosticCategory.Error,"A_declare_modifier_is_required_for_a_top_level_declaration_in_a_d_ts_file_1046","A 'declare' modifier is required for a top level declaration in a .d.ts file."),A_rest_parameter_cannot_be_optional:t(1047,e.DiagnosticCategory.Error,"A_rest_parameter_cannot_be_optional_1047","A rest parameter cannot be optional."),A_rest_parameter_cannot_have_an_initializer:t(1048,e.DiagnosticCategory.Error,"A_rest_parameter_cannot_have_an_initializer_1048","A rest parameter cannot have an initializer."),A_set_accessor_must_have_exactly_one_parameter:t(1049,e.DiagnosticCategory.Error,"A_set_accessor_must_have_exactly_one_parameter_1049","A 'set' accessor must have exactly one parameter."),A_set_accessor_cannot_have_an_optional_parameter:t(1051,e.DiagnosticCategory.Error,"A_set_accessor_cannot_have_an_optional_parameter_1051","A 'set' accessor cannot have an optional parameter."),A_set_accessor_parameter_cannot_have_an_initializer:t(1052,e.DiagnosticCategory.Error,"A_set_accessor_parameter_cannot_have_an_initializer_1052","A 'set' accessor parameter cannot have an initializer."),A_set_accessor_cannot_have_rest_parameter:t(1053,e.DiagnosticCategory.Error,"A_set_accessor_cannot_have_rest_parameter_1053","A 'set' accessor cannot have rest parameter."),A_get_accessor_cannot_have_parameters:t(1054,e.DiagnosticCategory.Error,"A_get_accessor_cannot_have_parameters_1054","A 'get' accessor cannot have parameters."),Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Promise_compatible_constructor_value:t(1055,e.DiagnosticCategory.Error,"Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Prom_1055","Type '{0}' is not a valid async function return type in ES5/ES3 because it does not refer to a Promise-compatible constructor value."),Accessors_are_only_available_when_targeting_ECMAScript_5_and_higher:t(1056,e.DiagnosticCategory.Error,"Accessors_are_only_available_when_targeting_ECMAScript_5_and_higher_1056","Accessors are only available when targeting ECMAScript 5 and higher."),An_async_function_or_method_must_have_a_valid_awaitable_return_type:t(1057,e.DiagnosticCategory.Error,"An_async_function_or_method_must_have_a_valid_awaitable_return_type_1057","An async function or method must have a valid awaitable return type."),The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member:t(1058,e.DiagnosticCategory.Error,"The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_t_1058","The return type of an async function must either be a valid promise or must not contain a callable 'then' member."),A_promise_must_have_a_then_method:t(1059,e.DiagnosticCategory.Error,"A_promise_must_have_a_then_method_1059","A promise must have a 'then' method."),The_first_parameter_of_the_then_method_of_a_promise_must_be_a_callback:t(1060,e.DiagnosticCategory.Error,"The_first_parameter_of_the_then_method_of_a_promise_must_be_a_callback_1060","The first parameter of the 'then' method of a promise must be a callback."),Enum_member_must_have_initializer:t(1061,e.DiagnosticCategory.Error,"Enum_member_must_have_initializer_1061","Enum member must have initializer."),Type_is_referenced_directly_or_indirectly_in_the_fulfillment_callback_of_its_own_then_method:t(1062,e.DiagnosticCategory.Error,"Type_is_referenced_directly_or_indirectly_in_the_fulfillment_callback_of_its_own_then_method_1062","Type is referenced directly or indirectly in the fulfillment callback of its own 'then' method."),An_export_assignment_cannot_be_used_in_a_namespace:t(1063,e.DiagnosticCategory.Error,"An_export_assignment_cannot_be_used_in_a_namespace_1063","An export assignment cannot be used in a namespace."),The_return_type_of_an_async_function_or_method_must_be_the_global_Promise_T_type:t(1064,e.DiagnosticCategory.Error,"The_return_type_of_an_async_function_or_method_must_be_the_global_Promise_T_type_1064","The return type of an async function or method must be the global Promise<T> type."),In_ambient_enum_declarations_member_initializer_must_be_constant_expression:t(1066,e.DiagnosticCategory.Error,"In_ambient_enum_declarations_member_initializer_must_be_constant_expression_1066","In ambient enum declarations member initializer must be constant expression."),Unexpected_token_A_constructor_method_accessor_or_property_was_expected:t(1068,e.DiagnosticCategory.Error,"Unexpected_token_A_constructor_method_accessor_or_property_was_expected_1068","Unexpected token. A constructor, method, accessor, or property was expected."),_0_modifier_cannot_appear_on_a_type_member:t(1070,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_type_member_1070","'{0}' modifier cannot appear on a type member."),_0_modifier_cannot_appear_on_an_index_signature:t(1071,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_an_index_signature_1071","'{0}' modifier cannot appear on an index signature."),A_0_modifier_cannot_be_used_with_an_import_declaration:t(1079,e.DiagnosticCategory.Error,"A_0_modifier_cannot_be_used_with_an_import_declaration_1079","A '{0}' modifier cannot be used with an import declaration."),Invalid_reference_directive_syntax:t(1084,e.DiagnosticCategory.Error,"Invalid_reference_directive_syntax_1084","Invalid 'reference' directive syntax."),Octal_literals_are_not_available_when_targeting_ECMAScript_5_and_higher_Use_the_syntax_0:t(1085,e.DiagnosticCategory.Error,"Octal_literals_are_not_available_when_targeting_ECMAScript_5_and_higher_Use_the_syntax_0_1085","Octal literals are not available when targeting ECMAScript 5 and higher. Use the syntax '{0}'."),An_accessor_cannot_be_declared_in_an_ambient_context:t(1086,e.DiagnosticCategory.Error,"An_accessor_cannot_be_declared_in_an_ambient_context_1086","An accessor cannot be declared in an ambient context."),_0_modifier_cannot_appear_on_a_constructor_declaration:t(1089,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_constructor_declaration_1089","'{0}' modifier cannot appear on a constructor declaration."),_0_modifier_cannot_appear_on_a_parameter:t(1090,e.DiagnosticCategory.Error,"_0_modifier_cannot_appear_on_a_parameter_1090","'{0}' modifier cannot appear on a parameter."),Only_a_single_variable_declaration_is_allowed_in_a_for_in_statement:t(1091,e.DiagnosticCategory.Error,"Only_a_single_variable_declaration_is_allowed_in_a_for_in_statement_1091","Only a single variable declaration is allowed in a 'for...in' statement."),Type_parameters_cannot_appear_on_a_constructor_declaration:t(1092,e.DiagnosticCategory.Error,"Type_parameters_cannot_appear_on_a_constructor_declaration_1092","Type parameters cannot appear on a constructor declaration."),Type_annotation_cannot_appear_on_a_constructor_declaration:t(1093,e.DiagnosticCategory.Error,"Type_annotation_cannot_appear_on_a_constructor_declaration_1093","Type annotation cannot appear on a constructor declaration."),An_accessor_cannot_have_type_parameters:t(1094,e.DiagnosticCategory.Error,"An_accessor_cannot_have_type_parameters_1094","An accessor cannot have type parameters."),A_set_accessor_cannot_have_a_return_type_annotation:t(1095,e.DiagnosticCategory.Error,"A_set_accessor_cannot_have_a_return_type_annotation_1095","A 'set' accessor cannot have a return type annotation."),An_index_signature_must_have_exactly_one_parameter:t(1096,e.DiagnosticCategory.Error,"An_index_signature_must_have_exactly_one_parameter_1096","An index signature must have exactly one parameter."),_0_list_cannot_be_empty:t(1097,e.DiagnosticCategory.Error,"_0_list_cannot_be_empty_1097","'{0}' list cannot be empty."),Type_parameter_list_cannot_be_empty:t(1098,e.DiagnosticCategory.Error,"Type_parameter_list_cannot_be_empty_1098","Type parameter list cannot be empty."),Type_argument_list_cannot_be_empty:t(1099,e.DiagnosticCategory.Error,"Type_argument_list_cannot_be_empty_1099","Type argument list cannot be empty."),Invalid_use_of_0_in_strict_mode:t(1100,e.DiagnosticCategory.Error,"Invalid_use_of_0_in_strict_mode_1100","Invalid use of '{0}' in strict mode."),with_statements_are_not_allowed_in_strict_mode:t(1101,e.DiagnosticCategory.Error,"with_statements_are_not_allowed_in_strict_mode_1101","'with' statements are not allowed in strict mode."),delete_cannot_be_called_on_an_identifier_in_strict_mode:t(1102,e.DiagnosticCategory.Error,"delete_cannot_be_called_on_an_identifier_in_strict_mode_1102","'delete' cannot be called on an identifier in strict mode."),A_for_await_of_statement_is_only_allowed_within_an_async_function_or_async_generator:t(1103,e.DiagnosticCategory.Error,"A_for_await_of_statement_is_only_allowed_within_an_async_function_or_async_generator_1103","A 'for-await-of' statement is only allowed within an async function or async generator."),A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement:t(1104,e.DiagnosticCategory.Error,"A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement_1104","A 'continue' statement can only be used within an enclosing iteration statement."),A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement:t(1105,e.DiagnosticCategory.Error,"A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement_1105","A 'break' statement can only be used within an enclosing iteration or switch statement."),Jump_target_cannot_cross_function_boundary:t(1107,e.DiagnosticCategory.Error,"Jump_target_cannot_cross_function_boundary_1107","Jump target cannot cross function boundary."),A_return_statement_can_only_be_used_within_a_function_body:t(1108,e.DiagnosticCategory.Error,"A_return_statement_can_only_be_used_within_a_function_body_1108","A 'return' statement can only be used within a function body."),Expression_expected:t(1109,e.DiagnosticCategory.Error,"Expression_expected_1109","Expression expected."),Type_expected:t(1110,e.DiagnosticCategory.Error,"Type_expected_1110","Type expected."),A_default_clause_cannot_appear_more_than_once_in_a_switch_statement:t(1113,e.DiagnosticCategory.Error,"A_default_clause_cannot_appear_more_than_once_in_a_switch_statement_1113","A 'default' clause cannot appear more than once in a 'switch' statement."),Duplicate_label_0:t(1114,e.DiagnosticCategory.Error,"Duplicate_label_0_1114","Duplicate label '{0}'."),A_continue_statement_can_only_jump_to_a_label_of_an_enclosing_iteration_statement:t(1115,e.DiagnosticCategory.Error,"A_continue_statement_can_only_jump_to_a_label_of_an_enclosing_iteration_statement_1115","A 'continue' statement can only jump to a label of an enclosing iteration statement."),A_break_statement_can_only_jump_to_a_label_of_an_enclosing_statement:t(1116,e.DiagnosticCategory.Error,"A_break_statement_can_only_jump_to_a_label_of_an_enclosing_statement_1116","A 'break' statement can only jump to a label of an enclosing statement."),An_object_literal_cannot_have_multiple_properties_with_the_same_name_in_strict_mode:t(1117,e.DiagnosticCategory.Error,"An_object_literal_cannot_have_multiple_properties_with_the_same_name_in_strict_mode_1117","An object literal cannot have multiple properties with the same name in strict mode."),An_object_literal_cannot_have_multiple_get_Slashset_accessors_with_the_same_name:t(1118,e.DiagnosticCategory.Error,"An_object_literal_cannot_have_multiple_get_Slashset_accessors_with_the_same_name_1118","An object literal cannot have multiple get/set accessors with the same name."),An_object_literal_cannot_have_property_and_accessor_with_the_same_name:t(1119,e.DiagnosticCategory.Error,"An_object_literal_cannot_have_property_and_accessor_with_the_same_name_1119","An object literal cannot have property and accessor with the same name."),An_export_assignment_cannot_have_modifiers:t(1120,e.DiagnosticCategory.Error,"An_export_assignment_cannot_have_modifiers_1120","An export assignment cannot have modifiers."),Octal_literals_are_not_allowed_in_strict_mode:t(1121,e.DiagnosticCategory.Error,"Octal_literals_are_not_allowed_in_strict_mode_1121","Octal literals are not allowed in strict mode."),A_tuple_type_element_list_cannot_be_empty:t(1122,e.DiagnosticCategory.Error,"A_tuple_type_element_list_cannot_be_empty_1122","A tuple type element list cannot be empty."),Variable_declaration_list_cannot_be_empty:t(1123,e.DiagnosticCategory.Error,"Variable_declaration_list_cannot_be_empty_1123","Variable declaration list cannot be empty."),Digit_expected:t(1124,e.DiagnosticCategory.Error,"Digit_expected_1124","Digit expected."),Hexadecimal_digit_expected:t(1125,e.DiagnosticCategory.Error,"Hexadecimal_digit_expected_1125","Hexadecimal digit expected."),Unexpected_end_of_text:t(1126,e.DiagnosticCategory.Error,"Unexpected_end_of_text_1126","Unexpected end of text."),Invalid_character:t(1127,e.DiagnosticCategory.Error,"Invalid_character_1127","Invalid character."),Declaration_or_statement_expected:t(1128,e.DiagnosticCategory.Error,"Declaration_or_statement_expected_1128","Declaration or statement expected."),Statement_expected:t(1129,e.DiagnosticCategory.Error,"Statement_expected_1129","Statement expected."),case_or_default_expected:t(1130,e.DiagnosticCategory.Error,"case_or_default_expected_1130","'case' or 'default' expected."),Property_or_signature_expected:t(1131,e.DiagnosticCategory.Error,"Property_or_signature_expected_1131","Property or signature expected."),Enum_member_expected:t(1132,e.DiagnosticCategory.Error,"Enum_member_expected_1132","Enum member expected."),Variable_declaration_expected:t(1134,e.DiagnosticCategory.Error,"Variable_declaration_expected_1134","Variable declaration expected."),Argument_expression_expected:t(1135,e.DiagnosticCategory.Error,"Argument_expression_expected_1135","Argument expression expected."),Property_assignment_expected:t(1136,e.DiagnosticCategory.Error,"Property_assignment_expected_1136","Property assignment expected."),Expression_or_comma_expected:t(1137,e.DiagnosticCategory.Error,"Expression_or_comma_expected_1137","Expression or comma expected."),Parameter_declaration_expected:t(1138,e.DiagnosticCategory.Error,"Parameter_declaration_expected_1138","Parameter declaration expected."),Type_parameter_declaration_expected:t(1139,e.DiagnosticCategory.Error,"Type_parameter_declaration_expected_1139","Type parameter declaration expected."),Type_argument_expected:t(1140,e.DiagnosticCategory.Error,"Type_argument_expected_1140","Type argument expected."),String_literal_expected:t(1141,e.DiagnosticCategory.Error,"String_literal_expected_1141","String literal expected."),Line_break_not_permitted_here:t(1142,e.DiagnosticCategory.Error,"Line_break_not_permitted_here_1142","Line break not permitted here."),or_expected:t(1144,e.DiagnosticCategory.Error,"or_expected_1144","'{' or ';' expected."),Declaration_expected:t(1146,e.DiagnosticCategory.Error,"Declaration_expected_1146","Declaration expected."),Import_declarations_in_a_namespace_cannot_reference_a_module:t(1147,e.DiagnosticCategory.Error,"Import_declarations_in_a_namespace_cannot_reference_a_module_1147","Import declarations in a namespace cannot reference a module."),Cannot_use_imports_exports_or_module_augmentations_when_module_is_none:t(1148,e.DiagnosticCategory.Error,"Cannot_use_imports_exports_or_module_augmentations_when_module_is_none_1148","Cannot use imports, exports, or module augmentations when '--module' is 'none'."),File_name_0_differs_from_already_included_file_name_1_only_in_casing:t(1149,e.DiagnosticCategory.Error,"File_name_0_differs_from_already_included_file_name_1_only_in_casing_1149","File name '{0}' differs from already included file name '{1}' only in casing."),new_T_cannot_be_used_to_create_an_array_Use_new_Array_T_instead:t(1150,e.DiagnosticCategory.Error,"new_T_cannot_be_used_to_create_an_array_Use_new_Array_T_instead_1150","'new T[]' cannot be used to create an array. Use 'new Array<T>()' instead."),const_declarations_must_be_initialized:t(1155,e.DiagnosticCategory.Error,"const_declarations_must_be_initialized_1155","'const' declarations must be initialized."),const_declarations_can_only_be_declared_inside_a_block:t(1156,e.DiagnosticCategory.Error,"const_declarations_can_only_be_declared_inside_a_block_1156","'const' declarations can only be declared inside a block."),let_declarations_can_only_be_declared_inside_a_block:t(1157,e.DiagnosticCategory.Error,"let_declarations_can_only_be_declared_inside_a_block_1157","'let' declarations can only be declared inside a block."),Unterminated_template_literal:t(1160,e.DiagnosticCategory.Error,"Unterminated_template_literal_1160","Unterminated template literal."),Unterminated_regular_expression_literal:t(1161,e.DiagnosticCategory.Error,"Unterminated_regular_expression_literal_1161","Unterminated regular expression literal."),An_object_member_cannot_be_declared_optional:t(1162,e.DiagnosticCategory.Error,"An_object_member_cannot_be_declared_optional_1162","An object member cannot be declared optional."),A_yield_expression_is_only_allowed_in_a_generator_body:t(1163,e.DiagnosticCategory.Error,"A_yield_expression_is_only_allowed_in_a_generator_body_1163","A 'yield' expression is only allowed in a generator body."),Computed_property_names_are_not_allowed_in_enums:t(1164,e.DiagnosticCategory.Error,"Computed_property_names_are_not_allowed_in_enums_1164","Computed property names are not allowed in enums."),A_computed_property_name_in_an_ambient_context_must_directly_refer_to_a_built_in_symbol:t(1165,e.DiagnosticCategory.Error,"A_computed_property_name_in_an_ambient_context_must_directly_refer_to_a_built_in_symbol_1165","A computed property name in an ambient context must directly refer to a built-in symbol."),A_computed_property_name_in_a_class_property_declaration_must_directly_refer_to_a_built_in_symbol:t(1166,e.DiagnosticCategory.Error,"A_computed_property_name_in_a_class_property_declaration_must_directly_refer_to_a_built_in_symbol_1166","A computed property name in a class property declaration must directly refer to a built-in symbol."),A_computed_property_name_in_a_method_overload_must_directly_refer_to_a_built_in_symbol:t(1168,e.DiagnosticCategory.Error,"A_computed_property_name_in_a_method_overload_must_directly_refer_to_a_built_in_symbol_1168","A computed property name in a method overload must directly refer to a built-in symbol."),A_computed_property_name_in_an_interface_must_directly_refer_to_a_built_in_symbol:t(1169,e.DiagnosticCategory.Error,"A_computed_property_name_in_an_interface_must_directly_refer_to_a_built_in_symbol_1169","A computed property name in an interface must directly refer to a built-in symbol."),A_computed_property_name_in_a_type_literal_must_directly_refer_to_a_built_in_symbol:t(1170,e.DiagnosticCategory.Error,"A_computed_property_name_in_a_type_literal_must_directly_refer_to_a_built_in_symbol_1170","A computed property name in a type literal must directly refer to a built-in symbol."),A_comma_expression_is_not_allowed_in_a_computed_property_name:t(1171,e.DiagnosticCategory.Error,"A_comma_expression_is_not_allowed_in_a_computed_property_name_1171","A comma expression is not allowed in a computed property name."),extends_clause_already_seen:t(1172,e.DiagnosticCategory.Error,"extends_clause_already_seen_1172","'extends' clause already seen."),extends_clause_must_precede_implements_clause:t(1173,e.DiagnosticCategory.Error,"extends_clause_must_precede_implements_clause_1173","'extends' clause must precede 'implements' clause."),Classes_can_only_extend_a_single_class:t(1174,e.DiagnosticCategory.Error,"Classes_can_only_extend_a_single_class_1174","Classes can only extend a single class."),implements_clause_already_seen:t(1175,e.DiagnosticCategory.Error,"implements_clause_already_seen_1175","'implements' clause already seen."),Interface_declaration_cannot_have_implements_clause:t(1176,e.DiagnosticCategory.Error,"Interface_declaration_cannot_have_implements_clause_1176","Interface declaration cannot have 'implements' clause."),Binary_digit_expected:t(1177,e.DiagnosticCategory.Error,"Binary_digit_expected_1177","Binary digit expected."),Octal_digit_expected:t(1178,e.DiagnosticCategory.Error,"Octal_digit_expected_1178","Octal digit expected."),Unexpected_token_expected:t(1179,e.DiagnosticCategory.Error,"Unexpected_token_expected_1179","Unexpected token. '{' expected."),Property_destructuring_pattern_expected:t(1180,e.DiagnosticCategory.Error,"Property_destructuring_pattern_expected_1180","Property destructuring pattern expected."),Array_element_destructuring_pattern_expected:t(1181,e.DiagnosticCategory.Error,"Array_element_destructuring_pattern_expected_1181","Array element destructuring pattern expected."),A_destructuring_declaration_must_have_an_initializer:t(1182,e.DiagnosticCategory.Error,"A_destructuring_declaration_must_have_an_initializer_1182","A destructuring declaration must have an initializer."),An_implementation_cannot_be_declared_in_ambient_contexts:t(1183,e.DiagnosticCategory.Error,"An_implementation_cannot_be_declared_in_ambient_contexts_1183","An implementation cannot be declared in ambient contexts."),Modifiers_cannot_appear_here:t(1184,e.DiagnosticCategory.Error,"Modifiers_cannot_appear_here_1184","Modifiers cannot appear here."),Merge_conflict_marker_encountered:t(1185,e.DiagnosticCategory.Error,"Merge_conflict_marker_encountered_1185","Merge conflict marker encountered."),A_rest_element_cannot_have_an_initializer:t(1186,e.DiagnosticCategory.Error,"A_rest_element_cannot_have_an_initializer_1186","A rest element cannot have an initializer."),A_parameter_property_may_not_be_declared_using_a_binding_pattern:t(1187,e.DiagnosticCategory.Error,"A_parameter_property_may_not_be_declared_using_a_binding_pattern_1187","A parameter property may not be declared using a binding pattern."),Only_a_single_variable_declaration_is_allowed_in_a_for_of_statement:t(1188,e.DiagnosticCategory.Error,"Only_a_single_variable_declaration_is_allowed_in_a_for_of_statement_1188","Only a single variable declaration is allowed in a 'for...of' statement."),The_variable_declaration_of_a_for_in_statement_cannot_have_an_initializer:t(1189,e.DiagnosticCategory.Error,"The_variable_declaration_of_a_for_in_statement_cannot_have_an_initializer_1189","The variable declaration of a 'for...in' statement cannot have an initializer."),The_variable_declaration_of_a_for_of_statement_cannot_have_an_initializer:t(1190,e.DiagnosticCategory.Error,"The_variable_declaration_of_a_for_of_statement_cannot_have_an_initializer_1190","The variable declaration of a 'for...of' statement cannot have an initializer."),An_import_declaration_cannot_have_modifiers:t(1191,e.DiagnosticCategory.Error,"An_import_declaration_cannot_have_modifiers_1191","An import declaration cannot have modifiers."),Module_0_has_no_default_export:t(1192,e.DiagnosticCategory.Error,"Module_0_has_no_default_export_1192","Module '{0}' has no default export."),An_export_declaration_cannot_have_modifiers:t(1193,e.DiagnosticCategory.Error,"An_export_declaration_cannot_have_modifiers_1193","An export declaration cannot have modifiers."),Export_declarations_are_not_permitted_in_a_namespace:t(1194,e.DiagnosticCategory.Error,"Export_declarations_are_not_permitted_in_a_namespace_1194","Export declarations are not permitted in a namespace."),Catch_clause_variable_cannot_have_a_type_annotation:t(1196,e.DiagnosticCategory.Error,"Catch_clause_variable_cannot_have_a_type_annotation_1196","Catch clause variable cannot have a type annotation."),Catch_clause_variable_cannot_have_an_initializer:t(1197,e.DiagnosticCategory.Error,"Catch_clause_variable_cannot_have_an_initializer_1197","Catch clause variable cannot have an initializer."),An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive:t(1198,e.DiagnosticCategory.Error,"An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive_1198","An extended Unicode escape value must be between 0x0 and 0x10FFFF inclusive."),Unterminated_Unicode_escape_sequence:t(1199,e.DiagnosticCategory.Error,"Unterminated_Unicode_escape_sequence_1199","Unterminated Unicode escape sequence."),Line_terminator_not_permitted_before_arrow:t(1200,e.DiagnosticCategory.Error,"Line_terminator_not_permitted_before_arrow_1200","Line terminator not permitted before arrow."),Import_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_import_Asterisk_as_ns_from_mod_import_a_from_mod_import_d_from_mod_or_another_module_format_instead:t(1202,e.DiagnosticCategory.Error,"Import_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_import_Asterisk_as_1202","Import assignment cannot be used when targeting ECMAScript modules. Consider using 'import * as ns from \"mod\"', 'import {a} from \"mod\"', 'import d from \"mod\"', or another module format instead."),Export_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_export_default_or_another_module_format_instead:t(1203,e.DiagnosticCategory.Error,"Export_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_export_default_or__1203","Export assignment cannot be used when targeting ECMAScript modules. Consider using 'export default' or another module format instead."),Cannot_re_export_a_type_when_the_isolatedModules_flag_is_provided:t(1205,e.DiagnosticCategory.Error,"Cannot_re_export_a_type_when_the_isolatedModules_flag_is_provided_1205","Cannot re-export a type when the '--isolatedModules' flag is provided."),Decorators_are_not_valid_here:t(1206,e.DiagnosticCategory.Error,"Decorators_are_not_valid_here_1206","Decorators are not valid here."),Decorators_cannot_be_applied_to_multiple_get_Slashset_accessors_of_the_same_name:t(1207,e.DiagnosticCategory.Error,"Decorators_cannot_be_applied_to_multiple_get_Slashset_accessors_of_the_same_name_1207","Decorators cannot be applied to multiple get/set accessors of the same name."),Cannot_compile_namespaces_when_the_isolatedModules_flag_is_provided:t(1208,e.DiagnosticCategory.Error,"Cannot_compile_namespaces_when_the_isolatedModules_flag_is_provided_1208","Cannot compile namespaces when the '--isolatedModules' flag is provided."),Ambient_const_enums_are_not_allowed_when_the_isolatedModules_flag_is_provided:t(1209,e.DiagnosticCategory.Error,"Ambient_const_enums_are_not_allowed_when_the_isolatedModules_flag_is_provided_1209","Ambient const enums are not allowed when the '--isolatedModules' flag is provided."),Invalid_use_of_0_Class_definitions_are_automatically_in_strict_mode:t(1210,e.DiagnosticCategory.Error,"Invalid_use_of_0_Class_definitions_are_automatically_in_strict_mode_1210","Invalid use of '{0}'. Class definitions are automatically in strict mode."),A_class_declaration_without_the_default_modifier_must_have_a_name:t(1211,e.DiagnosticCategory.Error,"A_class_declaration_without_the_default_modifier_must_have_a_name_1211","A class declaration without the 'default' modifier must have a name."),Identifier_expected_0_is_a_reserved_word_in_strict_mode:t(1212,e.DiagnosticCategory.Error,"Identifier_expected_0_is_a_reserved_word_in_strict_mode_1212","Identifier expected. '{0}' is a reserved word in strict mode."),Identifier_expected_0_is_a_reserved_word_in_strict_mode_Class_definitions_are_automatically_in_strict_mode:t(1213,e.DiagnosticCategory.Error,"Identifier_expected_0_is_a_reserved_word_in_strict_mode_Class_definitions_are_automatically_in_stric_1213","Identifier expected. '{0}' is a reserved word in strict mode. Class definitions are automatically in strict mode."),Identifier_expected_0_is_a_reserved_word_in_strict_mode_Modules_are_automatically_in_strict_mode:t(1214,e.DiagnosticCategory.Error,"Identifier_expected_0_is_a_reserved_word_in_strict_mode_Modules_are_automatically_in_strict_mode_1214","Identifier expected. '{0}' is a reserved word in strict mode. Modules are automatically in strict mode."),Invalid_use_of_0_Modules_are_automatically_in_strict_mode:t(1215,e.DiagnosticCategory.Error,"Invalid_use_of_0_Modules_are_automatically_in_strict_mode_1215","Invalid use of '{0}'. Modules are automatically in strict mode."),Identifier_expected_esModule_is_reserved_as_an_exported_marker_when_transforming_ECMAScript_modules:t(1216,e.DiagnosticCategory.Error,"Identifier_expected_esModule_is_reserved_as_an_exported_marker_when_transforming_ECMAScript_modules_1216","Identifier expected. '__esModule' is reserved as an exported marker when transforming ECMAScript modules."),Export_assignment_is_not_supported_when_module_flag_is_system:t(1218,e.DiagnosticCategory.Error,"Export_assignment_is_not_supported_when_module_flag_is_system_1218","Export assignment is not supported when '--module' flag is 'system'."),Experimental_support_for_decorators_is_a_feature_that_is_subject_to_change_in_a_future_release_Set_the_experimentalDecorators_option_to_remove_this_warning:t(1219,e.DiagnosticCategory.Error,"Experimental_support_for_decorators_is_a_feature_that_is_subject_to_change_in_a_future_release_Set_t_1219","Experimental support for decorators is a feature that is subject to change in a future release. Set the 'experimentalDecorators' option to remove this warning."),Generators_are_only_available_when_targeting_ECMAScript_2015_or_higher:t(1220,e.DiagnosticCategory.Error,"Generators_are_only_available_when_targeting_ECMAScript_2015_or_higher_1220","Generators are only available when targeting ECMAScript 2015 or higher."),Generators_are_not_allowed_in_an_ambient_context:t(1221,e.DiagnosticCategory.Error,"Generators_are_not_allowed_in_an_ambient_context_1221","Generators are not allowed in an ambient context."),An_overload_signature_cannot_be_declared_as_a_generator:t(1222,e.DiagnosticCategory.Error,"An_overload_signature_cannot_be_declared_as_a_generator_1222","An overload signature cannot be declared as a generator."),_0_tag_already_specified:t(1223,e.DiagnosticCategory.Error,"_0_tag_already_specified_1223","'{0}' tag already specified."),Signature_0_must_be_a_type_predicate:t(1224,e.DiagnosticCategory.Error,"Signature_0_must_be_a_type_predicate_1224","Signature '{0}' must be a type predicate."),Cannot_find_parameter_0:t(1225,e.DiagnosticCategory.Error,"Cannot_find_parameter_0_1225","Cannot find parameter '{0}'."),Type_predicate_0_is_not_assignable_to_1:t(1226,e.DiagnosticCategory.Error,"Type_predicate_0_is_not_assignable_to_1_1226","Type predicate '{0}' is not assignable to '{1}'."),Parameter_0_is_not_in_the_same_position_as_parameter_1:t(1227,e.DiagnosticCategory.Error,"Parameter_0_is_not_in_the_same_position_as_parameter_1_1227","Parameter '{0}' is not in the same position as parameter '{1}'."),A_type_predicate_is_only_allowed_in_return_type_position_for_functions_and_methods:t(1228,e.DiagnosticCategory.Error,"A_type_predicate_is_only_allowed_in_return_type_position_for_functions_and_methods_1228","A type predicate is only allowed in return type position for functions and methods."),A_type_predicate_cannot_reference_a_rest_parameter:t(1229,e.DiagnosticCategory.Error,"A_type_predicate_cannot_reference_a_rest_parameter_1229","A type predicate cannot reference a rest parameter."),A_type_predicate_cannot_reference_element_0_in_a_binding_pattern:t(1230,e.DiagnosticCategory.Error,"A_type_predicate_cannot_reference_element_0_in_a_binding_pattern_1230","A type predicate cannot reference element '{0}' in a binding pattern."),An_export_assignment_can_only_be_used_in_a_module:t(1231,e.DiagnosticCategory.Error,"An_export_assignment_can_only_be_used_in_a_module_1231","An export assignment can only be used in a module."),An_import_declaration_can_only_be_used_in_a_namespace_or_module:t(1232,e.DiagnosticCategory.Error,"An_import_declaration_can_only_be_used_in_a_namespace_or_module_1232","An import declaration can only be used in a namespace or module."),An_export_declaration_can_only_be_used_in_a_module:t(1233,e.DiagnosticCategory.Error,"An_export_declaration_can_only_be_used_in_a_module_1233","An export declaration can only be used in a module."),An_ambient_module_declaration_is_only_allowed_at_the_top_level_in_a_file:t(1234,e.DiagnosticCategory.Error,"An_ambient_module_declaration_is_only_allowed_at_the_top_level_in_a_file_1234","An ambient module declaration is only allowed at the top level in a file."),A_namespace_declaration_is_only_allowed_in_a_namespace_or_module:t(1235,e.DiagnosticCategory.Error,"A_namespace_declaration_is_only_allowed_in_a_namespace_or_module_1235","A namespace declaration is only allowed in a namespace or module."),The_return_type_of_a_property_decorator_function_must_be_either_void_or_any:t(1236,e.DiagnosticCategory.Error,"The_return_type_of_a_property_decorator_function_must_be_either_void_or_any_1236","The return type of a property decorator function must be either 'void' or 'any'."),The_return_type_of_a_parameter_decorator_function_must_be_either_void_or_any:t(1237,e.DiagnosticCategory.Error,"The_return_type_of_a_parameter_decorator_function_must_be_either_void_or_any_1237","The return type of a parameter decorator function must be either 'void' or 'any'."),Unable_to_resolve_signature_of_class_decorator_when_called_as_an_expression:t(1238,e.DiagnosticCategory.Error,"Unable_to_resolve_signature_of_class_decorator_when_called_as_an_expression_1238","Unable to resolve signature of class decorator when called as an expression."),Unable_to_resolve_signature_of_parameter_decorator_when_called_as_an_expression:t(1239,e.DiagnosticCategory.Error,"Unable_to_resolve_signature_of_parameter_decorator_when_called_as_an_expression_1239","Unable to resolve signature of parameter decorator when called as an expression."),Unable_to_resolve_signature_of_property_decorator_when_called_as_an_expression:t(1240,e.DiagnosticCategory.Error,"Unable_to_resolve_signature_of_property_decorator_when_called_as_an_expression_1240","Unable to resolve signature of property decorator when called as an expression."),Unable_to_resolve_signature_of_method_decorator_when_called_as_an_expression:t(1241,e.DiagnosticCategory.Error,"Unable_to_resolve_signature_of_method_decorator_when_called_as_an_expression_1241","Unable to resolve signature of method decorator when called as an expression."),abstract_modifier_can_only_appear_on_a_class_method_or_property_declaration:t(1242,e.DiagnosticCategory.Error,"abstract_modifier_can_only_appear_on_a_class_method_or_property_declaration_1242","'abstract' modifier can only appear on a class, method, or property declaration."),_0_modifier_cannot_be_used_with_1_modifier:t(1243,e.DiagnosticCategory.Error,"_0_modifier_cannot_be_used_with_1_modifier_1243","'{0}' modifier cannot be used with '{1}' modifier."),Abstract_methods_can_only_appear_within_an_abstract_class:t(1244,e.DiagnosticCategory.Error,"Abstract_methods_can_only_appear_within_an_abstract_class_1244","Abstract methods can only appear within an abstract class."),Method_0_cannot_have_an_implementation_because_it_is_marked_abstract:t(1245,e.DiagnosticCategory.Error,"Method_0_cannot_have_an_implementation_because_it_is_marked_abstract_1245","Method '{0}' cannot have an implementation because it is marked abstract."),An_interface_property_cannot_have_an_initializer:t(1246,e.DiagnosticCategory.Error,"An_interface_property_cannot_have_an_initializer_1246","An interface property cannot have an initializer."),A_type_literal_property_cannot_have_an_initializer:t(1247,e.DiagnosticCategory.Error,"A_type_literal_property_cannot_have_an_initializer_1247","A type literal property cannot have an initializer."),A_class_member_cannot_have_the_0_keyword:t(1248,e.DiagnosticCategory.Error,"A_class_member_cannot_have_the_0_keyword_1248","A class member cannot have the '{0}' keyword."),A_decorator_can_only_decorate_a_method_implementation_not_an_overload:t(1249,e.DiagnosticCategory.Error,"A_decorator_can_only_decorate_a_method_implementation_not_an_overload_1249","A decorator can only decorate a method implementation, not an overload."),Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5:t(1250,e.DiagnosticCategory.Error,"Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_1250","Function declarations are not allowed inside blocks in strict mode when targeting 'ES3' or 'ES5'."),Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Class_definitions_are_automatically_in_strict_mode:t(1251,e.DiagnosticCategory.Error,"Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Class_d_1251","Function declarations are not allowed inside blocks in strict mode when targeting 'ES3' or 'ES5'. Class definitions are automatically in strict mode."),Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Modules_are_automatically_in_strict_mode:t(1252,e.DiagnosticCategory.Error,"Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Modules_1252","Function declarations are not allowed inside blocks in strict mode when targeting 'ES3' or 'ES5'. Modules are automatically in strict mode."),_0_tag_cannot_be_used_independently_as_a_top_level_JSDoc_tag:t(1253,e.DiagnosticCategory.Error,"_0_tag_cannot_be_used_independently_as_a_top_level_JSDoc_tag_1253","'{0}' tag cannot be used independently as a top level JSDoc tag."),A_const_initializer_in_an_ambient_context_must_be_a_string_or_numeric_literal:t(1254,e.DiagnosticCategory.Error,"A_const_initializer_in_an_ambient_context_must_be_a_string_or_numeric_literal_1254","A 'const' initializer in an ambient context must be a string or numeric literal."),with_statements_are_not_allowed_in_an_async_function_block:t(1300,e.DiagnosticCategory.Error,"with_statements_are_not_allowed_in_an_async_function_block_1300","'with' statements are not allowed in an async function block."),await_expression_is_only_allowed_within_an_async_function:t(1308,e.DiagnosticCategory.Error,"await_expression_is_only_allowed_within_an_async_function_1308","'await' expression is only allowed within an async function."),can_only_be_used_in_an_object_literal_property_inside_a_destructuring_assignment:t(1312,e.DiagnosticCategory.Error,"can_only_be_used_in_an_object_literal_property_inside_a_destructuring_assignment_1312","'=' can only be used in an object literal property inside a destructuring assignment."),The_body_of_an_if_statement_cannot_be_the_empty_statement:t(1313,e.DiagnosticCategory.Error,"The_body_of_an_if_statement_cannot_be_the_empty_statement_1313","The body of an 'if' statement cannot be the empty statement."),Global_module_exports_may_only_appear_in_module_files:t(1314,e.DiagnosticCategory.Error,"Global_module_exports_may_only_appear_in_module_files_1314","Global module exports may only appear in module files."),Global_module_exports_may_only_appear_in_declaration_files:t(1315,e.DiagnosticCategory.Error,"Global_module_exports_may_only_appear_in_declaration_files_1315","Global module exports may only appear in declaration files."),Global_module_exports_may_only_appear_at_top_level:t(1316,e.DiagnosticCategory.Error,"Global_module_exports_may_only_appear_at_top_level_1316","Global module exports may only appear at top level."),A_parameter_property_cannot_be_declared_using_a_rest_parameter:t(1317,e.DiagnosticCategory.Error,"A_parameter_property_cannot_be_declared_using_a_rest_parameter_1317","A parameter property cannot be declared using a rest parameter."),An_abstract_accessor_cannot_have_an_implementation:t(1318,e.DiagnosticCategory.Error,"An_abstract_accessor_cannot_have_an_implementation_1318","An abstract accessor cannot have an implementation."),A_default_export_can_only_be_used_in_an_ECMAScript_style_module:t(1319,e.DiagnosticCategory.Error,"A_default_export_can_only_be_used_in_an_ECMAScript_style_module_1319","A default export can only be used in an ECMAScript-style module."),Type_of_await_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member:t(1320,e.DiagnosticCategory.Error,"Type_of_await_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member_1320","Type of 'await' operand must either be a valid promise or must not contain a callable 'then' member."),Type_of_yield_operand_in_an_async_generator_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member:t(1321,e.DiagnosticCategory.Error,"Type_of_yield_operand_in_an_async_generator_must_either_be_a_valid_promise_or_must_not_contain_a_cal_1321","Type of 'yield' operand in an async generator must either be a valid promise or must not contain a callable 'then' member."),Type_of_iterated_elements_of_a_yield_Asterisk_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member:t(1322,e.DiagnosticCategory.Error,"Type_of_iterated_elements_of_a_yield_Asterisk_operand_must_either_be_a_valid_promise_or_must_not_con_1322","Type of iterated elements of a 'yield*' operand must either be a valid promise or must not contain a callable 'then' member."),Dynamic_import_cannot_be_used_when_targeting_ECMAScript_2015_modules:t(1323,e.DiagnosticCategory.Error,"Dynamic_import_cannot_be_used_when_targeting_ECMAScript_2015_modules_1323","Dynamic import cannot be used when targeting ECMAScript 2015 modules."),Dynamic_import_must_have_one_specifier_as_an_argument:t(1324,e.DiagnosticCategory.Error,"Dynamic_import_must_have_one_specifier_as_an_argument_1324","Dynamic import must have one specifier as an argument."),Specifier_of_dynamic_import_cannot_be_spread_element:t(1325,e.DiagnosticCategory.Error,"Specifier_of_dynamic_import_cannot_be_spread_element_1325","Specifier of dynamic import cannot be spread element."),Dynamic_import_cannot_have_type_arguments:t(1326,e.DiagnosticCategory.Error,"Dynamic_import_cannot_have_type_arguments_1326","Dynamic import cannot have type arguments"),String_literal_with_double_quotes_expected:t(1327,e.DiagnosticCategory.Error,"String_literal_with_double_quotes_expected_1327","String literal with double quotes expected."),Property_value_can_only_be_string_literal_numeric_literal_true_false_null_object_literal_or_array_literal:t(1328,e.DiagnosticCategory.Error,"Property_value_can_only_be_string_literal_numeric_literal_true_false_null_object_literal_or_array_li_1328","Property value can only be string literal, numeric literal, 'true', 'false', 'null', object literal or array literal."),_0_accepts_too_few_arguments_to_be_used_as_a_decorator_here_Did_you_mean_to_call_it_first_and_write_0:t(1329,e.DiagnosticCategory.Error,"_0_accepts_too_few_arguments_to_be_used_as_a_decorator_here_Did_you_mean_to_call_it_first_and_write__1329","'{0}' accepts too few arguments to be used as a decorator here. Did you mean to call it first and write '@{0}()'?"),Duplicate_identifier_0:t(2300,e.DiagnosticCategory.Error,"Duplicate_identifier_0_2300","Duplicate identifier '{0}'."),Initializer_of_instance_member_variable_0_cannot_reference_identifier_1_declared_in_the_constructor:t(2301,e.DiagnosticCategory.Error,"Initializer_of_instance_member_variable_0_cannot_reference_identifier_1_declared_in_the_constructor_2301","Initializer of instance member variable '{0}' cannot reference identifier '{1}' declared in the constructor."),Static_members_cannot_reference_class_type_parameters:t(2302,e.DiagnosticCategory.Error,"Static_members_cannot_reference_class_type_parameters_2302","Static members cannot reference class type parameters."),Circular_definition_of_import_alias_0:t(2303,e.DiagnosticCategory.Error,"Circular_definition_of_import_alias_0_2303","Circular definition of import alias '{0}'."),Cannot_find_name_0:t(2304,e.DiagnosticCategory.Error,"Cannot_find_name_0_2304","Cannot find name '{0}'."),Module_0_has_no_exported_member_1:t(2305,e.DiagnosticCategory.Error,"Module_0_has_no_exported_member_1_2305","Module '{0}' has no exported member '{1}'."),File_0_is_not_a_module:t(2306,e.DiagnosticCategory.Error,"File_0_is_not_a_module_2306","File '{0}' is not a module."),Cannot_find_module_0:t(2307,e.DiagnosticCategory.Error,"Cannot_find_module_0_2307","Cannot find module '{0}'."),Module_0_has_already_exported_a_member_named_1_Consider_explicitly_re_exporting_to_resolve_the_ambiguity:t(2308,e.DiagnosticCategory.Error,"Module_0_has_already_exported_a_member_named_1_Consider_explicitly_re_exporting_to_resolve_the_ambig_2308","Module {0} has already exported a member named '{1}'. Consider explicitly re-exporting to resolve the ambiguity."),An_export_assignment_cannot_be_used_in_a_module_with_other_exported_elements:t(2309,e.DiagnosticCategory.Error,"An_export_assignment_cannot_be_used_in_a_module_with_other_exported_elements_2309","An export assignment cannot be used in a module with other exported elements."),Type_0_recursively_references_itself_as_a_base_type:t(2310,e.DiagnosticCategory.Error,"Type_0_recursively_references_itself_as_a_base_type_2310","Type '{0}' recursively references itself as a base type."),A_class_may_only_extend_another_class:t(2311,e.DiagnosticCategory.Error,"A_class_may_only_extend_another_class_2311","A class may only extend another class."),An_interface_may_only_extend_a_class_or_another_interface:t(2312,e.DiagnosticCategory.Error,"An_interface_may_only_extend_a_class_or_another_interface_2312","An interface may only extend a class or another interface."),Type_parameter_0_has_a_circular_constraint:t(2313,e.DiagnosticCategory.Error,"Type_parameter_0_has_a_circular_constraint_2313","Type parameter '{0}' has a circular constraint."),Generic_type_0_requires_1_type_argument_s:t(2314,e.DiagnosticCategory.Error,"Generic_type_0_requires_1_type_argument_s_2314","Generic type '{0}' requires {1} type argument(s)."),Type_0_is_not_generic:t(2315,e.DiagnosticCategory.Error,"Type_0_is_not_generic_2315","Type '{0}' is not generic."),Global_type_0_must_be_a_class_or_interface_type:t(2316,e.DiagnosticCategory.Error,"Global_type_0_must_be_a_class_or_interface_type_2316","Global type '{0}' must be a class or interface type."),Global_type_0_must_have_1_type_parameter_s:t(2317,e.DiagnosticCategory.Error,"Global_type_0_must_have_1_type_parameter_s_2317","Global type '{0}' must have {1} type parameter(s)."),Cannot_find_global_type_0:t(2318,e.DiagnosticCategory.Error,"Cannot_find_global_type_0_2318","Cannot find global type '{0}'."),Named_property_0_of_types_1_and_2_are_not_identical:t(2319,e.DiagnosticCategory.Error,"Named_property_0_of_types_1_and_2_are_not_identical_2319","Named property '{0}' of types '{1}' and '{2}' are not identical."),Interface_0_cannot_simultaneously_extend_types_1_and_2:t(2320,e.DiagnosticCategory.Error,"Interface_0_cannot_simultaneously_extend_types_1_and_2_2320","Interface '{0}' cannot simultaneously extend types '{1}' and '{2}'."),Excessive_stack_depth_comparing_types_0_and_1:t(2321,e.DiagnosticCategory.Error,"Excessive_stack_depth_comparing_types_0_and_1_2321","Excessive stack depth comparing types '{0}' and '{1}'."),Type_0_is_not_assignable_to_type_1:t(2322,e.DiagnosticCategory.Error,"Type_0_is_not_assignable_to_type_1_2322","Type '{0}' is not assignable to type '{1}'."),Cannot_redeclare_exported_variable_0:t(2323,e.DiagnosticCategory.Error,"Cannot_redeclare_exported_variable_0_2323","Cannot redeclare exported variable '{0}'."),Property_0_is_missing_in_type_1:t(2324,e.DiagnosticCategory.Error,"Property_0_is_missing_in_type_1_2324","Property '{0}' is missing in type '{1}'."),Property_0_is_private_in_type_1_but_not_in_type_2:t(2325,e.DiagnosticCategory.Error,"Property_0_is_private_in_type_1_but_not_in_type_2_2325","Property '{0}' is private in type '{1}' but not in type '{2}'."),Types_of_property_0_are_incompatible:t(2326,e.DiagnosticCategory.Error,"Types_of_property_0_are_incompatible_2326","Types of property '{0}' are incompatible."),Property_0_is_optional_in_type_1_but_required_in_type_2:t(2327,e.DiagnosticCategory.Error,"Property_0_is_optional_in_type_1_but_required_in_type_2_2327","Property '{0}' is optional in type '{1}' but required in type '{2}'."),Types_of_parameters_0_and_1_are_incompatible:t(2328,e.DiagnosticCategory.Error,"Types_of_parameters_0_and_1_are_incompatible_2328","Types of parameters '{0}' and '{1}' are incompatible."),Index_signature_is_missing_in_type_0:t(2329,e.DiagnosticCategory.Error,"Index_signature_is_missing_in_type_0_2329","Index signature is missing in type '{0}'."),Index_signatures_are_incompatible:t(2330,e.DiagnosticCategory.Error,"Index_signatures_are_incompatible_2330","Index signatures are incompatible."),this_cannot_be_referenced_in_a_module_or_namespace_body:t(2331,e.DiagnosticCategory.Error,"this_cannot_be_referenced_in_a_module_or_namespace_body_2331","'this' cannot be referenced in a module or namespace body."),this_cannot_be_referenced_in_current_location:t(2332,e.DiagnosticCategory.Error,"this_cannot_be_referenced_in_current_location_2332","'this' cannot be referenced in current location."),this_cannot_be_referenced_in_constructor_arguments:t(2333,e.DiagnosticCategory.Error,"this_cannot_be_referenced_in_constructor_arguments_2333","'this' cannot be referenced in constructor arguments."),this_cannot_be_referenced_in_a_static_property_initializer:t(2334,e.DiagnosticCategory.Error,"this_cannot_be_referenced_in_a_static_property_initializer_2334","'this' cannot be referenced in a static property initializer."),super_can_only_be_referenced_in_a_derived_class:t(2335,e.DiagnosticCategory.Error,"super_can_only_be_referenced_in_a_derived_class_2335","'super' can only be referenced in a derived class."),super_cannot_be_referenced_in_constructor_arguments:t(2336,e.DiagnosticCategory.Error,"super_cannot_be_referenced_in_constructor_arguments_2336","'super' cannot be referenced in constructor arguments."),Super_calls_are_not_permitted_outside_constructors_or_in_nested_functions_inside_constructors:t(2337,e.DiagnosticCategory.Error,"Super_calls_are_not_permitted_outside_constructors_or_in_nested_functions_inside_constructors_2337","Super calls are not permitted outside constructors or in nested functions inside constructors."),super_property_access_is_permitted_only_in_a_constructor_member_function_or_member_accessor_of_a_derived_class:t(2338,e.DiagnosticCategory.Error,"super_property_access_is_permitted_only_in_a_constructor_member_function_or_member_accessor_of_a_der_2338","'super' property access is permitted only in a constructor, member function, or member accessor of a derived class."),Property_0_does_not_exist_on_type_1:t(2339,e.DiagnosticCategory.Error,"Property_0_does_not_exist_on_type_1_2339","Property '{0}' does not exist on type '{1}'."),Only_public_and_protected_methods_of_the_base_class_are_accessible_via_the_super_keyword:t(2340,e.DiagnosticCategory.Error,"Only_public_and_protected_methods_of_the_base_class_are_accessible_via_the_super_keyword_2340","Only public and protected methods of the base class are accessible via the 'super' keyword."),Property_0_is_private_and_only_accessible_within_class_1:t(2341,e.DiagnosticCategory.Error,"Property_0_is_private_and_only_accessible_within_class_1_2341","Property '{0}' is private and only accessible within class '{1}'."),An_index_expression_argument_must_be_of_type_string_number_symbol_or_any:t(2342,e.DiagnosticCategory.Error,"An_index_expression_argument_must_be_of_type_string_number_symbol_or_any_2342","An index expression argument must be of type 'string', 'number', 'symbol', or 'any'."),This_syntax_requires_an_imported_helper_named_1_but_module_0_has_no_exported_member_1:t(2343,e.DiagnosticCategory.Error,"This_syntax_requires_an_imported_helper_named_1_but_module_0_has_no_exported_member_1_2343","This syntax requires an imported helper named '{1}', but module '{0}' has no exported member '{1}'."),Type_0_does_not_satisfy_the_constraint_1:t(2344,e.DiagnosticCategory.Error,"Type_0_does_not_satisfy_the_constraint_1_2344","Type '{0}' does not satisfy the constraint '{1}'."),Argument_of_type_0_is_not_assignable_to_parameter_of_type_1:t(2345,e.DiagnosticCategory.Error,"Argument_of_type_0_is_not_assignable_to_parameter_of_type_1_2345","Argument of type '{0}' is not assignable to parameter of type '{1}'."),Call_target_does_not_contain_any_signatures:t(2346,e.DiagnosticCategory.Error,"Call_target_does_not_contain_any_signatures_2346","Call target does not contain any signatures."),Untyped_function_calls_may_not_accept_type_arguments:t(2347,e.DiagnosticCategory.Error,"Untyped_function_calls_may_not_accept_type_arguments_2347","Untyped function calls may not accept type arguments."),Value_of_type_0_is_not_callable_Did_you_mean_to_include_new:t(2348,e.DiagnosticCategory.Error,"Value_of_type_0_is_not_callable_Did_you_mean_to_include_new_2348","Value of type '{0}' is not callable. Did you mean to include 'new'?"),Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures:t(2349,e.DiagnosticCategory.Error,"Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatur_2349","Cannot invoke an expression whose type lacks a call signature. Type '{0}' has no compatible call signatures."),Only_a_void_function_can_be_called_with_the_new_keyword:t(2350,e.DiagnosticCategory.Error,"Only_a_void_function_can_be_called_with_the_new_keyword_2350","Only a void function can be called with the 'new' keyword."),Cannot_use_new_with_an_expression_whose_type_lacks_a_call_or_construct_signature:t(2351,e.DiagnosticCategory.Error,"Cannot_use_new_with_an_expression_whose_type_lacks_a_call_or_construct_signature_2351","Cannot use 'new' with an expression whose type lacks a call or construct signature."),Type_0_cannot_be_converted_to_type_1:t(2352,e.DiagnosticCategory.Error,"Type_0_cannot_be_converted_to_type_1_2352","Type '{0}' cannot be converted to type '{1}'."),Object_literal_may_only_specify_known_properties_and_0_does_not_exist_in_type_1:t(2353,e.DiagnosticCategory.Error,"Object_literal_may_only_specify_known_properties_and_0_does_not_exist_in_type_1_2353","Object literal may only specify known properties, and '{0}' does not exist in type '{1}'."),This_syntax_requires_an_imported_helper_but_module_0_cannot_be_found:t(2354,e.DiagnosticCategory.Error,"This_syntax_requires_an_imported_helper_but_module_0_cannot_be_found_2354","This syntax requires an imported helper but module '{0}' cannot be found."),A_function_whose_declared_type_is_neither_void_nor_any_must_return_a_value:t(2355,e.DiagnosticCategory.Error,"A_function_whose_declared_type_is_neither_void_nor_any_must_return_a_value_2355","A function whose declared type is neither 'void' nor 'any' must return a value."),An_arithmetic_operand_must_be_of_type_any_number_or_an_enum_type:t(2356,e.DiagnosticCategory.Error,"An_arithmetic_operand_must_be_of_type_any_number_or_an_enum_type_2356","An arithmetic operand must be of type 'any', 'number' or an enum type."),The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access:t(2357,e.DiagnosticCategory.Error,"The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access_2357","The operand of an increment or decrement operator must be a variable or a property access."),The_left_hand_side_of_an_instanceof_expression_must_be_of_type_any_an_object_type_or_a_type_parameter:t(2358,e.DiagnosticCategory.Error,"The_left_hand_side_of_an_instanceof_expression_must_be_of_type_any_an_object_type_or_a_type_paramete_2358","The left-hand side of an 'instanceof' expression must be of type 'any', an object type or a type parameter."),The_right_hand_side_of_an_instanceof_expression_must_be_of_type_any_or_of_a_type_assignable_to_the_Function_interface_type:t(2359,e.DiagnosticCategory.Error,"The_right_hand_side_of_an_instanceof_expression_must_be_of_type_any_or_of_a_type_assignable_to_the_F_2359","The right-hand side of an 'instanceof' expression must be of type 'any' or of a type assignable to the 'Function' interface type."),The_left_hand_side_of_an_in_expression_must_be_of_type_any_string_number_or_symbol:t(2360,e.DiagnosticCategory.Error,"The_left_hand_side_of_an_in_expression_must_be_of_type_any_string_number_or_symbol_2360","The left-hand side of an 'in' expression must be of type 'any', 'string', 'number', or 'symbol'."),The_right_hand_side_of_an_in_expression_must_be_of_type_any_an_object_type_or_a_type_parameter:t(2361,e.DiagnosticCategory.Error,"The_right_hand_side_of_an_in_expression_must_be_of_type_any_an_object_type_or_a_type_parameter_2361","The right-hand side of an 'in' expression must be of type 'any', an object type or a type parameter."),The_left_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type:t(2362,e.DiagnosticCategory.Error,"The_left_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type_2362","The left-hand side of an arithmetic operation must be of type 'any', 'number' or an enum type."),The_right_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type:t(2363,e.DiagnosticCategory.Error,"The_right_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type_2363","The right-hand side of an arithmetic operation must be of type 'any', 'number' or an enum type."),The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access:t(2364,e.DiagnosticCategory.Error,"The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access_2364","The left-hand side of an assignment expression must be a variable or a property access."),Operator_0_cannot_be_applied_to_types_1_and_2:t(2365,e.DiagnosticCategory.Error,"Operator_0_cannot_be_applied_to_types_1_and_2_2365","Operator '{0}' cannot be applied to types '{1}' and '{2}'."),Function_lacks_ending_return_statement_and_return_type_does_not_include_undefined:t(2366,e.DiagnosticCategory.Error,"Function_lacks_ending_return_statement_and_return_type_does_not_include_undefined_2366","Function lacks ending return statement and return type does not include 'undefined'."),Type_parameter_name_cannot_be_0:t(2368,e.DiagnosticCategory.Error,"Type_parameter_name_cannot_be_0_2368","Type parameter name cannot be '{0}'."),A_parameter_property_is_only_allowed_in_a_constructor_implementation:t(2369,e.DiagnosticCategory.Error,"A_parameter_property_is_only_allowed_in_a_constructor_implementation_2369","A parameter property is only allowed in a constructor implementation."),A_rest_parameter_must_be_of_an_array_type:t(2370,e.DiagnosticCategory.Error,"A_rest_parameter_must_be_of_an_array_type_2370","A rest parameter must be of an array type."),A_parameter_initializer_is_only_allowed_in_a_function_or_constructor_implementation:t(2371,e.DiagnosticCategory.Error,"A_parameter_initializer_is_only_allowed_in_a_function_or_constructor_implementation_2371","A parameter initializer is only allowed in a function or constructor implementation."),Parameter_0_cannot_be_referenced_in_its_initializer:t(2372,e.DiagnosticCategory.Error,"Parameter_0_cannot_be_referenced_in_its_initializer_2372","Parameter '{0}' cannot be referenced in its initializer."),Initializer_of_parameter_0_cannot_reference_identifier_1_declared_after_it:t(2373,e.DiagnosticCategory.Error,"Initializer_of_parameter_0_cannot_reference_identifier_1_declared_after_it_2373","Initializer of parameter '{0}' cannot reference identifier '{1}' declared after it."),Duplicate_string_index_signature:t(2374,e.DiagnosticCategory.Error,"Duplicate_string_index_signature_2374","Duplicate string index signature."),Duplicate_number_index_signature:t(2375,e.DiagnosticCategory.Error,"Duplicate_number_index_signature_2375","Duplicate number index signature."),A_super_call_must_be_the_first_statement_in_the_constructor_when_a_class_contains_initialized_properties_or_has_parameter_properties:t(2376,e.DiagnosticCategory.Error,"A_super_call_must_be_the_first_statement_in_the_constructor_when_a_class_contains_initialized_proper_2376","A 'super' call must be the first statement in the constructor when a class contains initialized properties or has parameter properties."),Constructors_for_derived_classes_must_contain_a_super_call:t(2377,e.DiagnosticCategory.Error,"Constructors_for_derived_classes_must_contain_a_super_call_2377","Constructors for derived classes must contain a 'super' call."),A_get_accessor_must_return_a_value:t(2378,e.DiagnosticCategory.Error,"A_get_accessor_must_return_a_value_2378","A 'get' accessor must return a value."),Getter_and_setter_accessors_do_not_agree_in_visibility:t(2379,e.DiagnosticCategory.Error,"Getter_and_setter_accessors_do_not_agree_in_visibility_2379","Getter and setter accessors do not agree in visibility."),get_and_set_accessor_must_have_the_same_type:t(2380,e.DiagnosticCategory.Error,"get_and_set_accessor_must_have_the_same_type_2380","'get' and 'set' accessor must have the same type."),A_signature_with_an_implementation_cannot_use_a_string_literal_type:t(2381,e.DiagnosticCategory.Error,"A_signature_with_an_implementation_cannot_use_a_string_literal_type_2381","A signature with an implementation cannot use a string literal type."),Specialized_overload_signature_is_not_assignable_to_any_non_specialized_signature:t(2382,e.DiagnosticCategory.Error,"Specialized_overload_signature_is_not_assignable_to_any_non_specialized_signature_2382","Specialized overload signature is not assignable to any non-specialized signature."),Overload_signatures_must_all_be_exported_or_non_exported:t(2383,e.DiagnosticCategory.Error,"Overload_signatures_must_all_be_exported_or_non_exported_2383","Overload signatures must all be exported or non-exported."),Overload_signatures_must_all_be_ambient_or_non_ambient:t(2384,e.DiagnosticCategory.Error,"Overload_signatures_must_all_be_ambient_or_non_ambient_2384","Overload signatures must all be ambient or non-ambient."),Overload_signatures_must_all_be_public_private_or_protected:t(2385,e.DiagnosticCategory.Error,"Overload_signatures_must_all_be_public_private_or_protected_2385","Overload signatures must all be public, private or protected."),Overload_signatures_must_all_be_optional_or_required:t(2386,e.DiagnosticCategory.Error,"Overload_signatures_must_all_be_optional_or_required_2386","Overload signatures must all be optional or required."),Function_overload_must_be_static:t(2387,e.DiagnosticCategory.Error,"Function_overload_must_be_static_2387","Function overload must be static."),Function_overload_must_not_be_static:t(2388,e.DiagnosticCategory.Error,"Function_overload_must_not_be_static_2388","Function overload must not be static."),Function_implementation_name_must_be_0:t(2389,e.DiagnosticCategory.Error,"Function_implementation_name_must_be_0_2389","Function implementation name must be '{0}'."),Constructor_implementation_is_missing:t(2390,e.DiagnosticCategory.Error,"Constructor_implementation_is_missing_2390","Constructor implementation is missing."),Function_implementation_is_missing_or_not_immediately_following_the_declaration:t(2391,e.DiagnosticCategory.Error,"Function_implementation_is_missing_or_not_immediately_following_the_declaration_2391","Function implementation is missing or not immediately following the declaration."),Multiple_constructor_implementations_are_not_allowed:t(2392,e.DiagnosticCategory.Error,"Multiple_constructor_implementations_are_not_allowed_2392","Multiple constructor implementations are not allowed."),Duplicate_function_implementation:t(2393,e.DiagnosticCategory.Error,"Duplicate_function_implementation_2393","Duplicate function implementation."),Overload_signature_is_not_compatible_with_function_implementation:t(2394,e.DiagnosticCategory.Error,"Overload_signature_is_not_compatible_with_function_implementation_2394","Overload signature is not compatible with function implementation."),Individual_declarations_in_merged_declaration_0_must_be_all_exported_or_all_local:t(2395,e.DiagnosticCategory.Error,"Individual_declarations_in_merged_declaration_0_must_be_all_exported_or_all_local_2395","Individual declarations in merged declaration '{0}' must be all exported or all local."),Duplicate_identifier_arguments_Compiler_uses_arguments_to_initialize_rest_parameters:t(2396,e.DiagnosticCategory.Error,"Duplicate_identifier_arguments_Compiler_uses_arguments_to_initialize_rest_parameters_2396","Duplicate identifier 'arguments'. Compiler uses 'arguments' to initialize rest parameters."),Declaration_name_conflicts_with_built_in_global_identifier_0:t(2397,e.DiagnosticCategory.Error,"Declaration_name_conflicts_with_built_in_global_identifier_0_2397","Declaration name conflicts with built-in global identifier '{0}'."),Duplicate_identifier_this_Compiler_uses_variable_declaration_this_to_capture_this_reference:t(2399,e.DiagnosticCategory.Error,"Duplicate_identifier_this_Compiler_uses_variable_declaration_this_to_capture_this_reference_2399","Duplicate identifier '_this'. Compiler uses variable declaration '_this' to capture 'this' reference."),Expression_resolves_to_variable_declaration_this_that_compiler_uses_to_capture_this_reference:t(2400,e.DiagnosticCategory.Error,"Expression_resolves_to_variable_declaration_this_that_compiler_uses_to_capture_this_reference_2400","Expression resolves to variable declaration '_this' that compiler uses to capture 'this' reference."),Duplicate_identifier_super_Compiler_uses_super_to_capture_base_class_reference:t(2401,e.DiagnosticCategory.Error,"Duplicate_identifier_super_Compiler_uses_super_to_capture_base_class_reference_2401","Duplicate identifier '_super'. Compiler uses '_super' to capture base class reference."),Expression_resolves_to_super_that_compiler_uses_to_capture_base_class_reference:t(2402,e.DiagnosticCategory.Error,"Expression_resolves_to_super_that_compiler_uses_to_capture_base_class_reference_2402","Expression resolves to '_super' that compiler uses to capture base class reference."),Subsequent_variable_declarations_must_have_the_same_type_Variable_0_must_be_of_type_1_but_here_has_type_2:t(2403,e.DiagnosticCategory.Error,"Subsequent_variable_declarations_must_have_the_same_type_Variable_0_must_be_of_type_1_but_here_has_t_2403","Subsequent variable declarations must have the same type.  Variable '{0}' must be of type '{1}', but here has type '{2}'."),The_left_hand_side_of_a_for_in_statement_cannot_use_a_type_annotation:t(2404,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_in_statement_cannot_use_a_type_annotation_2404","The left-hand side of a 'for...in' statement cannot use a type annotation."),The_left_hand_side_of_a_for_in_statement_must_be_of_type_string_or_any:t(2405,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_in_statement_must_be_of_type_string_or_any_2405","The left-hand side of a 'for...in' statement must be of type 'string' or 'any'."),The_left_hand_side_of_a_for_in_statement_must_be_a_variable_or_a_property_access:t(2406,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_in_statement_must_be_a_variable_or_a_property_access_2406","The left-hand side of a 'for...in' statement must be a variable or a property access."),The_right_hand_side_of_a_for_in_statement_must_be_of_type_any_an_object_type_or_a_type_parameter:t(2407,e.DiagnosticCategory.Error,"The_right_hand_side_of_a_for_in_statement_must_be_of_type_any_an_object_type_or_a_type_parameter_2407","The right-hand side of a 'for...in' statement must be of type 'any', an object type or a type parameter."),Setters_cannot_return_a_value:t(2408,e.DiagnosticCategory.Error,"Setters_cannot_return_a_value_2408","Setters cannot return a value."),Return_type_of_constructor_signature_must_be_assignable_to_the_instance_type_of_the_class:t(2409,e.DiagnosticCategory.Error,"Return_type_of_constructor_signature_must_be_assignable_to_the_instance_type_of_the_class_2409","Return type of constructor signature must be assignable to the instance type of the class."),The_with_statement_is_not_supported_All_symbols_in_a_with_block_will_have_type_any:t(2410,e.DiagnosticCategory.Error,"The_with_statement_is_not_supported_All_symbols_in_a_with_block_will_have_type_any_2410","The 'with' statement is not supported. All symbols in a 'with' block will have type 'any'."),Property_0_of_type_1_is_not_assignable_to_string_index_type_2:t(2411,e.DiagnosticCategory.Error,"Property_0_of_type_1_is_not_assignable_to_string_index_type_2_2411","Property '{0}' of type '{1}' is not assignable to string index type '{2}'."),Property_0_of_type_1_is_not_assignable_to_numeric_index_type_2:t(2412,e.DiagnosticCategory.Error,"Property_0_of_type_1_is_not_assignable_to_numeric_index_type_2_2412","Property '{0}' of type '{1}' is not assignable to numeric index type '{2}'."),Numeric_index_type_0_is_not_assignable_to_string_index_type_1:t(2413,e.DiagnosticCategory.Error,"Numeric_index_type_0_is_not_assignable_to_string_index_type_1_2413","Numeric index type '{0}' is not assignable to string index type '{1}'."),Class_name_cannot_be_0:t(2414,e.DiagnosticCategory.Error,"Class_name_cannot_be_0_2414","Class name cannot be '{0}'."),Class_0_incorrectly_extends_base_class_1:t(2415,e.DiagnosticCategory.Error,"Class_0_incorrectly_extends_base_class_1_2415","Class '{0}' incorrectly extends base class '{1}'."),Class_static_side_0_incorrectly_extends_base_class_static_side_1:t(2417,e.DiagnosticCategory.Error,"Class_static_side_0_incorrectly_extends_base_class_static_side_1_2417","Class static side '{0}' incorrectly extends base class static side '{1}'."),Class_0_incorrectly_implements_interface_1:t(2420,e.DiagnosticCategory.Error,"Class_0_incorrectly_implements_interface_1_2420","Class '{0}' incorrectly implements interface '{1}'."),A_class_may_only_implement_another_class_or_interface:t(2422,e.DiagnosticCategory.Error,"A_class_may_only_implement_another_class_or_interface_2422","A class may only implement another class or interface."),Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_accessor:t(2423,e.DiagnosticCategory.Error,"Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_access_2423","Class '{0}' defines instance member function '{1}', but extended class '{2}' defines it as instance member accessor."),Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_property:t(2424,e.DiagnosticCategory.Error,"Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_proper_2424","Class '{0}' defines instance member function '{1}', but extended class '{2}' defines it as instance member property."),Class_0_defines_instance_member_property_1_but_extended_class_2_defines_it_as_instance_member_function:t(2425,e.DiagnosticCategory.Error,"Class_0_defines_instance_member_property_1_but_extended_class_2_defines_it_as_instance_member_functi_2425","Class '{0}' defines instance member property '{1}', but extended class '{2}' defines it as instance member function."),Class_0_defines_instance_member_accessor_1_but_extended_class_2_defines_it_as_instance_member_function:t(2426,e.DiagnosticCategory.Error,"Class_0_defines_instance_member_accessor_1_but_extended_class_2_defines_it_as_instance_member_functi_2426","Class '{0}' defines instance member accessor '{1}', but extended class '{2}' defines it as instance member function."),Interface_name_cannot_be_0:t(2427,e.DiagnosticCategory.Error,"Interface_name_cannot_be_0_2427","Interface name cannot be '{0}'."),All_declarations_of_0_must_have_identical_type_parameters:t(2428,e.DiagnosticCategory.Error,"All_declarations_of_0_must_have_identical_type_parameters_2428","All declarations of '{0}' must have identical type parameters."),Interface_0_incorrectly_extends_interface_1:t(2430,e.DiagnosticCategory.Error,"Interface_0_incorrectly_extends_interface_1_2430","Interface '{0}' incorrectly extends interface '{1}'."),Enum_name_cannot_be_0:t(2431,e.DiagnosticCategory.Error,"Enum_name_cannot_be_0_2431","Enum name cannot be '{0}'."),In_an_enum_with_multiple_declarations_only_one_declaration_can_omit_an_initializer_for_its_first_enum_element:t(2432,e.DiagnosticCategory.Error,"In_an_enum_with_multiple_declarations_only_one_declaration_can_omit_an_initializer_for_its_first_enu_2432","In an enum with multiple declarations, only one declaration can omit an initializer for its first enum element."),A_namespace_declaration_cannot_be_in_a_different_file_from_a_class_or_function_with_which_it_is_merged:t(2433,e.DiagnosticCategory.Error,"A_namespace_declaration_cannot_be_in_a_different_file_from_a_class_or_function_with_which_it_is_merg_2433","A namespace declaration cannot be in a different file from a class or function with which it is merged."),A_namespace_declaration_cannot_be_located_prior_to_a_class_or_function_with_which_it_is_merged:t(2434,e.DiagnosticCategory.Error,"A_namespace_declaration_cannot_be_located_prior_to_a_class_or_function_with_which_it_is_merged_2434","A namespace declaration cannot be located prior to a class or function with which it is merged."),Ambient_modules_cannot_be_nested_in_other_modules_or_namespaces:t(2435,e.DiagnosticCategory.Error,"Ambient_modules_cannot_be_nested_in_other_modules_or_namespaces_2435","Ambient modules cannot be nested in other modules or namespaces."),Ambient_module_declaration_cannot_specify_relative_module_name:t(2436,e.DiagnosticCategory.Error,"Ambient_module_declaration_cannot_specify_relative_module_name_2436","Ambient module declaration cannot specify relative module name."),Module_0_is_hidden_by_a_local_declaration_with_the_same_name:t(2437,e.DiagnosticCategory.Error,"Module_0_is_hidden_by_a_local_declaration_with_the_same_name_2437","Module '{0}' is hidden by a local declaration with the same name."),Import_name_cannot_be_0:t(2438,e.DiagnosticCategory.Error,"Import_name_cannot_be_0_2438","Import name cannot be '{0}'."),Import_or_export_declaration_in_an_ambient_module_declaration_cannot_reference_module_through_relative_module_name:t(2439,e.DiagnosticCategory.Error,"Import_or_export_declaration_in_an_ambient_module_declaration_cannot_reference_module_through_relati_2439","Import or export declaration in an ambient module declaration cannot reference module through relative module name."),Import_declaration_conflicts_with_local_declaration_of_0:t(2440,e.DiagnosticCategory.Error,"Import_declaration_conflicts_with_local_declaration_of_0_2440","Import declaration conflicts with local declaration of '{0}'."),Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module:t(2441,e.DiagnosticCategory.Error,"Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module_2441","Duplicate identifier '{0}'. Compiler reserves name '{1}' in top level scope of a module."),Types_have_separate_declarations_of_a_private_property_0:t(2442,e.DiagnosticCategory.Error,"Types_have_separate_declarations_of_a_private_property_0_2442","Types have separate declarations of a private property '{0}'."),Property_0_is_protected_but_type_1_is_not_a_class_derived_from_2:t(2443,e.DiagnosticCategory.Error,"Property_0_is_protected_but_type_1_is_not_a_class_derived_from_2_2443","Property '{0}' is protected but type '{1}' is not a class derived from '{2}'."),Property_0_is_protected_in_type_1_but_public_in_type_2:t(2444,e.DiagnosticCategory.Error,"Property_0_is_protected_in_type_1_but_public_in_type_2_2444","Property '{0}' is protected in type '{1}' but public in type '{2}'."),Property_0_is_protected_and_only_accessible_within_class_1_and_its_subclasses:t(2445,e.DiagnosticCategory.Error,"Property_0_is_protected_and_only_accessible_within_class_1_and_its_subclasses_2445","Property '{0}' is protected and only accessible within class '{1}' and its subclasses."),Property_0_is_protected_and_only_accessible_through_an_instance_of_class_1:t(2446,e.DiagnosticCategory.Error,"Property_0_is_protected_and_only_accessible_through_an_instance_of_class_1_2446","Property '{0}' is protected and only accessible through an instance of class '{1}'."),The_0_operator_is_not_allowed_for_boolean_types_Consider_using_1_instead:t(2447,e.DiagnosticCategory.Error,"The_0_operator_is_not_allowed_for_boolean_types_Consider_using_1_instead_2447","The '{0}' operator is not allowed for boolean types. Consider using '{1}' instead."),Block_scoped_variable_0_used_before_its_declaration:t(2448,e.DiagnosticCategory.Error,"Block_scoped_variable_0_used_before_its_declaration_2448","Block-scoped variable '{0}' used before its declaration."),Class_0_used_before_its_declaration:t(2449,e.DiagnosticCategory.Error,"Class_0_used_before_its_declaration_2449","Class '{0}' used before its declaration."),Enum_0_used_before_its_declaration:t(2450,e.DiagnosticCategory.Error,"Enum_0_used_before_its_declaration_2450","Enum '{0}' used before its declaration."),Cannot_redeclare_block_scoped_variable_0:t(2451,e.DiagnosticCategory.Error,"Cannot_redeclare_block_scoped_variable_0_2451","Cannot redeclare block-scoped variable '{0}'."),An_enum_member_cannot_have_a_numeric_name:t(2452,e.DiagnosticCategory.Error,"An_enum_member_cannot_have_a_numeric_name_2452","An enum member cannot have a numeric name."),The_type_argument_for_type_parameter_0_cannot_be_inferred_from_the_usage_Consider_specifying_the_type_arguments_explicitly:t(2453,e.DiagnosticCategory.Error,"The_type_argument_for_type_parameter_0_cannot_be_inferred_from_the_usage_Consider_specifying_the_typ_2453","The type argument for type parameter '{0}' cannot be inferred from the usage. Consider specifying the type arguments explicitly."),Variable_0_is_used_before_being_assigned:t(2454,e.DiagnosticCategory.Error,"Variable_0_is_used_before_being_assigned_2454","Variable '{0}' is used before being assigned."),Type_argument_candidate_1_is_not_a_valid_type_argument_because_it_is_not_a_supertype_of_candidate_0:t(2455,e.DiagnosticCategory.Error,"Type_argument_candidate_1_is_not_a_valid_type_argument_because_it_is_not_a_supertype_of_candidate_0_2455","Type argument candidate '{1}' is not a valid type argument because it is not a supertype of candidate '{0}'."),Type_alias_0_circularly_references_itself:t(2456,e.DiagnosticCategory.Error,"Type_alias_0_circularly_references_itself_2456","Type alias '{0}' circularly references itself."),Type_alias_name_cannot_be_0:t(2457,e.DiagnosticCategory.Error,"Type_alias_name_cannot_be_0_2457","Type alias name cannot be '{0}'."),An_AMD_module_cannot_have_multiple_name_assignments:t(2458,e.DiagnosticCategory.Error,"An_AMD_module_cannot_have_multiple_name_assignments_2458","An AMD module cannot have multiple name assignments."),Type_0_has_no_property_1_and_no_string_index_signature:t(2459,e.DiagnosticCategory.Error,"Type_0_has_no_property_1_and_no_string_index_signature_2459","Type '{0}' has no property '{1}' and no string index signature."),Type_0_has_no_property_1:t(2460,e.DiagnosticCategory.Error,"Type_0_has_no_property_1_2460","Type '{0}' has no property '{1}'."),Type_0_is_not_an_array_type:t(2461,e.DiagnosticCategory.Error,"Type_0_is_not_an_array_type_2461","Type '{0}' is not an array type."),A_rest_element_must_be_last_in_a_destructuring_pattern:t(2462,e.DiagnosticCategory.Error,"A_rest_element_must_be_last_in_a_destructuring_pattern_2462","A rest element must be last in a destructuring pattern."),A_binding_pattern_parameter_cannot_be_optional_in_an_implementation_signature:t(2463,e.DiagnosticCategory.Error,"A_binding_pattern_parameter_cannot_be_optional_in_an_implementation_signature_2463","A binding pattern parameter cannot be optional in an implementation signature."),A_computed_property_name_must_be_of_type_string_number_symbol_or_any:t(2464,e.DiagnosticCategory.Error,"A_computed_property_name_must_be_of_type_string_number_symbol_or_any_2464","A computed property name must be of type 'string', 'number', 'symbol', or 'any'."),this_cannot_be_referenced_in_a_computed_property_name:t(2465,e.DiagnosticCategory.Error,"this_cannot_be_referenced_in_a_computed_property_name_2465","'this' cannot be referenced in a computed property name."),super_cannot_be_referenced_in_a_computed_property_name:t(2466,e.DiagnosticCategory.Error,"super_cannot_be_referenced_in_a_computed_property_name_2466","'super' cannot be referenced in a computed property name."),A_computed_property_name_cannot_reference_a_type_parameter_from_its_containing_type:t(2467,e.DiagnosticCategory.Error,"A_computed_property_name_cannot_reference_a_type_parameter_from_its_containing_type_2467","A computed property name cannot reference a type parameter from its containing type."),Cannot_find_global_value_0:t(2468,e.DiagnosticCategory.Error,"Cannot_find_global_value_0_2468","Cannot find global value '{0}'."),The_0_operator_cannot_be_applied_to_type_symbol:t(2469,e.DiagnosticCategory.Error,"The_0_operator_cannot_be_applied_to_type_symbol_2469","The '{0}' operator cannot be applied to type 'symbol'."),Symbol_reference_does_not_refer_to_the_global_Symbol_constructor_object:t(2470,e.DiagnosticCategory.Error,"Symbol_reference_does_not_refer_to_the_global_Symbol_constructor_object_2470","'Symbol' reference does not refer to the global Symbol constructor object."),A_computed_property_name_of_the_form_0_must_be_of_type_symbol:t(2471,e.DiagnosticCategory.Error,"A_computed_property_name_of_the_form_0_must_be_of_type_symbol_2471","A computed property name of the form '{0}' must be of type 'symbol'."),Spread_operator_in_new_expressions_is_only_available_when_targeting_ECMAScript_5_and_higher:t(2472,e.DiagnosticCategory.Error,"Spread_operator_in_new_expressions_is_only_available_when_targeting_ECMAScript_5_and_higher_2472","Spread operator in 'new' expressions is only available when targeting ECMAScript 5 and higher."),Enum_declarations_must_all_be_const_or_non_const:t(2473,e.DiagnosticCategory.Error,"Enum_declarations_must_all_be_const_or_non_const_2473","Enum declarations must all be const or non-const."),In_const_enum_declarations_member_initializer_must_be_constant_expression:t(2474,e.DiagnosticCategory.Error,"In_const_enum_declarations_member_initializer_must_be_constant_expression_2474","In 'const' enum declarations member initializer must be constant expression."),const_enums_can_only_be_used_in_property_or_index_access_expressions_or_the_right_hand_side_of_an_import_declaration_or_export_assignment:t(2475,e.DiagnosticCategory.Error,"const_enums_can_only_be_used_in_property_or_index_access_expressions_or_the_right_hand_side_of_an_im_2475","'const' enums can only be used in property or index access expressions or the right hand side of an import declaration or export assignment."),A_const_enum_member_can_only_be_accessed_using_a_string_literal:t(2476,e.DiagnosticCategory.Error,"A_const_enum_member_can_only_be_accessed_using_a_string_literal_2476","A const enum member can only be accessed using a string literal."),const_enum_member_initializer_was_evaluated_to_a_non_finite_value:t(2477,e.DiagnosticCategory.Error,"const_enum_member_initializer_was_evaluated_to_a_non_finite_value_2477","'const' enum member initializer was evaluated to a non-finite value."),const_enum_member_initializer_was_evaluated_to_disallowed_value_NaN:t(2478,e.DiagnosticCategory.Error,"const_enum_member_initializer_was_evaluated_to_disallowed_value_NaN_2478","'const' enum member initializer was evaluated to disallowed value 'NaN'."),Property_0_does_not_exist_on_const_enum_1:t(2479,e.DiagnosticCategory.Error,"Property_0_does_not_exist_on_const_enum_1_2479","Property '{0}' does not exist on 'const' enum '{1}'."),let_is_not_allowed_to_be_used_as_a_name_in_let_or_const_declarations:t(2480,e.DiagnosticCategory.Error,"let_is_not_allowed_to_be_used_as_a_name_in_let_or_const_declarations_2480","'let' is not allowed to be used as a name in 'let' or 'const' declarations."),Cannot_initialize_outer_scoped_variable_0_in_the_same_scope_as_block_scoped_declaration_1:t(2481,e.DiagnosticCategory.Error,"Cannot_initialize_outer_scoped_variable_0_in_the_same_scope_as_block_scoped_declaration_1_2481","Cannot initialize outer scoped variable '{0}' in the same scope as block scoped declaration '{1}'."),The_left_hand_side_of_a_for_of_statement_cannot_use_a_type_annotation:t(2483,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_of_statement_cannot_use_a_type_annotation_2483","The left-hand side of a 'for...of' statement cannot use a type annotation."),Export_declaration_conflicts_with_exported_declaration_of_0:t(2484,e.DiagnosticCategory.Error,"Export_declaration_conflicts_with_exported_declaration_of_0_2484","Export declaration conflicts with exported declaration of '{0}'."),The_left_hand_side_of_a_for_of_statement_must_be_a_variable_or_a_property_access:t(2487,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_of_statement_must_be_a_variable_or_a_property_access_2487","The left-hand side of a 'for...of' statement must be a variable or a property access."),Type_must_have_a_Symbol_iterator_method_that_returns_an_iterator:t(2488,e.DiagnosticCategory.Error,"Type_must_have_a_Symbol_iterator_method_that_returns_an_iterator_2488","Type must have a '[Symbol.iterator]()' method that returns an iterator."),An_iterator_must_have_a_next_method:t(2489,e.DiagnosticCategory.Error,"An_iterator_must_have_a_next_method_2489","An iterator must have a 'next()' method."),The_type_returned_by_the_next_method_of_an_iterator_must_have_a_value_property:t(2490,e.DiagnosticCategory.Error,"The_type_returned_by_the_next_method_of_an_iterator_must_have_a_value_property_2490","The type returned by the 'next()' method of an iterator must have a 'value' property."),The_left_hand_side_of_a_for_in_statement_cannot_be_a_destructuring_pattern:t(2491,e.DiagnosticCategory.Error,"The_left_hand_side_of_a_for_in_statement_cannot_be_a_destructuring_pattern_2491","The left-hand side of a 'for...in' statement cannot be a destructuring pattern."),Cannot_redeclare_identifier_0_in_catch_clause:t(2492,e.DiagnosticCategory.Error,"Cannot_redeclare_identifier_0_in_catch_clause_2492","Cannot redeclare identifier '{0}' in catch clause."),Tuple_type_0_with_length_1_cannot_be_assigned_to_tuple_with_length_2:t(2493,e.DiagnosticCategory.Error,"Tuple_type_0_with_length_1_cannot_be_assigned_to_tuple_with_length_2_2493","Tuple type '{0}' with length '{1}' cannot be assigned to tuple with length '{2}'."),Using_a_string_in_a_for_of_statement_is_only_supported_in_ECMAScript_5_and_higher:t(2494,e.DiagnosticCategory.Error,"Using_a_string_in_a_for_of_statement_is_only_supported_in_ECMAScript_5_and_higher_2494","Using a string in a 'for...of' statement is only supported in ECMAScript 5 and higher."),Type_0_is_not_an_array_type_or_a_string_type:t(2495,e.DiagnosticCategory.Error,"Type_0_is_not_an_array_type_or_a_string_type_2495","Type '{0}' is not an array type or a string type."),The_arguments_object_cannot_be_referenced_in_an_arrow_function_in_ES3_and_ES5_Consider_using_a_standard_function_expression:t(2496,e.DiagnosticCategory.Error,"The_arguments_object_cannot_be_referenced_in_an_arrow_function_in_ES3_and_ES5_Consider_using_a_stand_2496","The 'arguments' object cannot be referenced in an arrow function in ES3 and ES5. Consider using a standard function expression."),Module_0_resolves_to_a_non_module_entity_and_cannot_be_imported_using_this_construct:t(2497,e.DiagnosticCategory.Error,"Module_0_resolves_to_a_non_module_entity_and_cannot_be_imported_using_this_construct_2497","Module '{0}' resolves to a non-module entity and cannot be imported using this construct."),Module_0_uses_export_and_cannot_be_used_with_export_Asterisk:t(2498,e.DiagnosticCategory.Error,"Module_0_uses_export_and_cannot_be_used_with_export_Asterisk_2498","Module '{0}' uses 'export =' and cannot be used with 'export *'."),An_interface_can_only_extend_an_identifier_Slashqualified_name_with_optional_type_arguments:t(2499,e.DiagnosticCategory.Error,"An_interface_can_only_extend_an_identifier_Slashqualified_name_with_optional_type_arguments_2499","An interface can only extend an identifier/qualified-name with optional type arguments."),A_class_can_only_implement_an_identifier_Slashqualified_name_with_optional_type_arguments:t(2500,e.DiagnosticCategory.Error,"A_class_can_only_implement_an_identifier_Slashqualified_name_with_optional_type_arguments_2500","A class can only implement an identifier/qualified-name with optional type arguments."),A_rest_element_cannot_contain_a_binding_pattern:t(2501,e.DiagnosticCategory.Error,"A_rest_element_cannot_contain_a_binding_pattern_2501","A rest element cannot contain a binding pattern."),_0_is_referenced_directly_or_indirectly_in_its_own_type_annotation:t(2502,e.DiagnosticCategory.Error,"_0_is_referenced_directly_or_indirectly_in_its_own_type_annotation_2502","'{0}' is referenced directly or indirectly in its own type annotation."),Cannot_find_namespace_0:t(2503,e.DiagnosticCategory.Error,"Cannot_find_namespace_0_2503","Cannot find namespace '{0}'."),Type_must_have_a_Symbol_asyncIterator_method_that_returns_an_async_iterator:t(2504,e.DiagnosticCategory.Error,"Type_must_have_a_Symbol_asyncIterator_method_that_returns_an_async_iterator_2504","Type must have a '[Symbol.asyncIterator]()' method that returns an async iterator."),A_generator_cannot_have_a_void_type_annotation:t(2505,e.DiagnosticCategory.Error,"A_generator_cannot_have_a_void_type_annotation_2505","A generator cannot have a 'void' type annotation."),_0_is_referenced_directly_or_indirectly_in_its_own_base_expression:t(2506,e.DiagnosticCategory.Error,"_0_is_referenced_directly_or_indirectly_in_its_own_base_expression_2506","'{0}' is referenced directly or indirectly in its own base expression."),Type_0_is_not_a_constructor_function_type:t(2507,e.DiagnosticCategory.Error,"Type_0_is_not_a_constructor_function_type_2507","Type '{0}' is not a constructor function type."),No_base_constructor_has_the_specified_number_of_type_arguments:t(2508,e.DiagnosticCategory.Error,"No_base_constructor_has_the_specified_number_of_type_arguments_2508","No base constructor has the specified number of type arguments."),Base_constructor_return_type_0_is_not_a_class_or_interface_type:t(2509,e.DiagnosticCategory.Error,"Base_constructor_return_type_0_is_not_a_class_or_interface_type_2509","Base constructor return type '{0}' is not a class or interface type."),Base_constructors_must_all_have_the_same_return_type:t(2510,e.DiagnosticCategory.Error,"Base_constructors_must_all_have_the_same_return_type_2510","Base constructors must all have the same return type."),Cannot_create_an_instance_of_the_abstract_class_0:t(2511,e.DiagnosticCategory.Error,"Cannot_create_an_instance_of_the_abstract_class_0_2511","Cannot create an instance of the abstract class '{0}'."),Overload_signatures_must_all_be_abstract_or_non_abstract:t(2512,e.DiagnosticCategory.Error,"Overload_signatures_must_all_be_abstract_or_non_abstract_2512","Overload signatures must all be abstract or non-abstract."),Abstract_method_0_in_class_1_cannot_be_accessed_via_super_expression:t(2513,e.DiagnosticCategory.Error,"Abstract_method_0_in_class_1_cannot_be_accessed_via_super_expression_2513","Abstract method '{0}' in class '{1}' cannot be accessed via super expression."),Classes_containing_abstract_methods_must_be_marked_abstract:t(2514,e.DiagnosticCategory.Error,"Classes_containing_abstract_methods_must_be_marked_abstract_2514","Classes containing abstract methods must be marked abstract."),Non_abstract_class_0_does_not_implement_inherited_abstract_member_1_from_class_2:t(2515,e.DiagnosticCategory.Error,"Non_abstract_class_0_does_not_implement_inherited_abstract_member_1_from_class_2_2515","Non-abstract class '{0}' does not implement inherited abstract member '{1}' from class '{2}'."),All_declarations_of_an_abstract_method_must_be_consecutive:t(2516,e.DiagnosticCategory.Error,"All_declarations_of_an_abstract_method_must_be_consecutive_2516","All declarations of an abstract method must be consecutive."),Cannot_assign_an_abstract_constructor_type_to_a_non_abstract_constructor_type:t(2517,e.DiagnosticCategory.Error,"Cannot_assign_an_abstract_constructor_type_to_a_non_abstract_constructor_type_2517","Cannot assign an abstract constructor type to a non-abstract constructor type."),A_this_based_type_guard_is_not_compatible_with_a_parameter_based_type_guard:t(2518,e.DiagnosticCategory.Error,"A_this_based_type_guard_is_not_compatible_with_a_parameter_based_type_guard_2518","A 'this'-based type guard is not compatible with a parameter-based type guard."),An_async_iterator_must_have_a_next_method:t(2519,e.DiagnosticCategory.Error,"An_async_iterator_must_have_a_next_method_2519","An async iterator must have a 'next()' method."),Duplicate_identifier_0_Compiler_uses_declaration_1_to_support_async_functions:t(2520,e.DiagnosticCategory.Error,"Duplicate_identifier_0_Compiler_uses_declaration_1_to_support_async_functions_2520","Duplicate identifier '{0}'. Compiler uses declaration '{1}' to support async functions."),Expression_resolves_to_variable_declaration_0_that_compiler_uses_to_support_async_functions:t(2521,e.DiagnosticCategory.Error,"Expression_resolves_to_variable_declaration_0_that_compiler_uses_to_support_async_functions_2521","Expression resolves to variable declaration '{0}' that compiler uses to support async functions."),The_arguments_object_cannot_be_referenced_in_an_async_function_or_method_in_ES3_and_ES5_Consider_using_a_standard_function_or_method:t(2522,e.DiagnosticCategory.Error,"The_arguments_object_cannot_be_referenced_in_an_async_function_or_method_in_ES3_and_ES5_Consider_usi_2522","The 'arguments' object cannot be referenced in an async function or method in ES3 and ES5. Consider using a standard function or method."),yield_expressions_cannot_be_used_in_a_parameter_initializer:t(2523,e.DiagnosticCategory.Error,"yield_expressions_cannot_be_used_in_a_parameter_initializer_2523","'yield' expressions cannot be used in a parameter initializer."),await_expressions_cannot_be_used_in_a_parameter_initializer:t(2524,e.DiagnosticCategory.Error,"await_expressions_cannot_be_used_in_a_parameter_initializer_2524","'await' expressions cannot be used in a parameter initializer."),Initializer_provides_no_value_for_this_binding_element_and_the_binding_element_has_no_default_value:t(2525,e.DiagnosticCategory.Error,"Initializer_provides_no_value_for_this_binding_element_and_the_binding_element_has_no_default_value_2525","Initializer provides no value for this binding element and the binding element has no default value."),A_this_type_is_available_only_in_a_non_static_member_of_a_class_or_interface:t(2526,e.DiagnosticCategory.Error,"A_this_type_is_available_only_in_a_non_static_member_of_a_class_or_interface_2526","A 'this' type is available only in a non-static member of a class or interface."),The_inferred_type_of_0_references_an_inaccessible_this_type_A_type_annotation_is_necessary:t(2527,e.DiagnosticCategory.Error,"The_inferred_type_of_0_references_an_inaccessible_this_type_A_type_annotation_is_necessary_2527","The inferred type of '{0}' references an inaccessible 'this' type. A type annotation is necessary."),A_module_cannot_have_multiple_default_exports:t(2528,e.DiagnosticCategory.Error,"A_module_cannot_have_multiple_default_exports_2528","A module cannot have multiple default exports."),Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module_containing_async_functions:t(2529,e.DiagnosticCategory.Error,"Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module_containing_async_func_2529","Duplicate identifier '{0}'. Compiler reserves name '{1}' in top level scope of a module containing async functions."),Property_0_is_incompatible_with_index_signature:t(2530,e.DiagnosticCategory.Error,"Property_0_is_incompatible_with_index_signature_2530","Property '{0}' is incompatible with index signature."),Object_is_possibly_null:t(2531,e.DiagnosticCategory.Error,"Object_is_possibly_null_2531","Object is possibly 'null'."),Object_is_possibly_undefined:t(2532,e.DiagnosticCategory.Error,"Object_is_possibly_undefined_2532","Object is possibly 'undefined'."),Object_is_possibly_null_or_undefined:t(2533,e.DiagnosticCategory.Error,"Object_is_possibly_null_or_undefined_2533","Object is possibly 'null' or 'undefined'."),A_function_returning_never_cannot_have_a_reachable_end_point:t(2534,e.DiagnosticCategory.Error,"A_function_returning_never_cannot_have_a_reachable_end_point_2534","A function returning 'never' cannot have a reachable end point."),Enum_type_0_has_members_with_initializers_that_are_not_literals:t(2535,e.DiagnosticCategory.Error,"Enum_type_0_has_members_with_initializers_that_are_not_literals_2535","Enum type '{0}' has members with initializers that are not literals."),Type_0_cannot_be_used_to_index_type_1:t(2536,e.DiagnosticCategory.Error,"Type_0_cannot_be_used_to_index_type_1_2536","Type '{0}' cannot be used to index type '{1}'."),Type_0_has_no_matching_index_signature_for_type_1:t(2537,e.DiagnosticCategory.Error,"Type_0_has_no_matching_index_signature_for_type_1_2537","Type '{0}' has no matching index signature for type '{1}'."),Type_0_cannot_be_used_as_an_index_type:t(2538,e.DiagnosticCategory.Error,"Type_0_cannot_be_used_as_an_index_type_2538","Type '{0}' cannot be used as an index type."),Cannot_assign_to_0_because_it_is_not_a_variable:t(2539,e.DiagnosticCategory.Error,"Cannot_assign_to_0_because_it_is_not_a_variable_2539","Cannot assign to '{0}' because it is not a variable."),Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property:t(2540,e.DiagnosticCategory.Error,"Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property_2540","Cannot assign to '{0}' because it is a constant or a read-only property."),The_target_of_an_assignment_must_be_a_variable_or_a_property_access:t(2541,e.DiagnosticCategory.Error,"The_target_of_an_assignment_must_be_a_variable_or_a_property_access_2541","The target of an assignment must be a variable or a property access."),Index_signature_in_type_0_only_permits_reading:t(2542,e.DiagnosticCategory.Error,"Index_signature_in_type_0_only_permits_reading_2542","Index signature in type '{0}' only permits reading."),Duplicate_identifier_newTarget_Compiler_uses_variable_declaration_newTarget_to_capture_new_target_meta_property_reference:t(2543,e.DiagnosticCategory.Error,"Duplicate_identifier_newTarget_Compiler_uses_variable_declaration_newTarget_to_capture_new_target_me_2543","Duplicate identifier '_newTarget'. Compiler uses variable declaration '_newTarget' to capture 'new.target' meta-property reference."),Expression_resolves_to_variable_declaration_newTarget_that_compiler_uses_to_capture_new_target_meta_property_reference:t(2544,e.DiagnosticCategory.Error,"Expression_resolves_to_variable_declaration_newTarget_that_compiler_uses_to_capture_new_target_meta__2544","Expression resolves to variable declaration '_newTarget' that compiler uses to capture 'new.target' meta-property reference."),A_mixin_class_must_have_a_constructor_with_a_single_rest_parameter_of_type_any:t(2545,e.DiagnosticCategory.Error,"A_mixin_class_must_have_a_constructor_with_a_single_rest_parameter_of_type_any_2545","A mixin class must have a constructor with a single rest parameter of type 'any[]'."),Property_0_has_conflicting_declarations_and_is_inaccessible_in_type_1:t(2546,e.DiagnosticCategory.Error,"Property_0_has_conflicting_declarations_and_is_inaccessible_in_type_1_2546","Property '{0}' has conflicting declarations and is inaccessible in type '{1}'."),The_type_returned_by_the_next_method_of_an_async_iterator_must_be_a_promise_for_a_type_with_a_value_property:t(2547,e.DiagnosticCategory.Error,"The_type_returned_by_the_next_method_of_an_async_iterator_must_be_a_promise_for_a_type_with_a_value__2547","The type returned by the 'next()' method of an async iterator must be a promise for a type with a 'value' property."),Type_0_is_not_an_array_type_or_does_not_have_a_Symbol_iterator_method_that_returns_an_iterator:t(2548,e.DiagnosticCategory.Error,"Type_0_is_not_an_array_type_or_does_not_have_a_Symbol_iterator_method_that_returns_an_iterator_2548","Type '{0}' is not an array type or does not have a '[Symbol.iterator]()' method that returns an iterator."),Type_0_is_not_an_array_type_or_a_string_type_or_does_not_have_a_Symbol_iterator_method_that_returns_an_iterator:t(2549,e.DiagnosticCategory.Error,"Type_0_is_not_an_array_type_or_a_string_type_or_does_not_have_a_Symbol_iterator_method_that_returns__2549","Type '{0}' is not an array type or a string type or does not have a '[Symbol.iterator]()' method that returns an iterator."),Generic_type_instantiation_is_excessively_deep_and_possibly_infinite:t(2550,e.DiagnosticCategory.Error,"Generic_type_instantiation_is_excessively_deep_and_possibly_infinite_2550","Generic type instantiation is excessively deep and possibly infinite."),Property_0_does_not_exist_on_type_1_Did_you_mean_2:t(2551,e.DiagnosticCategory.Error,"Property_0_does_not_exist_on_type_1_Did_you_mean_2_2551","Property '{0}' does not exist on type '{1}'. Did you mean '{2}'?"),Cannot_find_name_0_Did_you_mean_1:t(2552,e.DiagnosticCategory.Error,"Cannot_find_name_0_Did_you_mean_1_2552","Cannot find name '{0}'. Did you mean '{1}'?"),Computed_values_are_not_permitted_in_an_enum_with_string_valued_members:t(2553,e.DiagnosticCategory.Error,"Computed_values_are_not_permitted_in_an_enum_with_string_valued_members_2553","Computed values are not permitted in an enum with string valued members."),Expected_0_arguments_but_got_1:t(2554,e.DiagnosticCategory.Error,"Expected_0_arguments_but_got_1_2554","Expected {0} arguments, but got {1}."),Expected_at_least_0_arguments_but_got_1:t(2555,e.DiagnosticCategory.Error,"Expected_at_least_0_arguments_but_got_1_2555","Expected at least {0} arguments, but got {1}."),Expected_0_arguments_but_got_a_minimum_of_1:t(2556,e.DiagnosticCategory.Error,"Expected_0_arguments_but_got_a_minimum_of_1_2556","Expected {0} arguments, but got a minimum of {1}."),Expected_at_least_0_arguments_but_got_a_minimum_of_1:t(2557,e.DiagnosticCategory.Error,"Expected_at_least_0_arguments_but_got_a_minimum_of_1_2557","Expected at least {0} arguments, but got a minimum of {1}."),Expected_0_type_arguments_but_got_1:t(2558,e.DiagnosticCategory.Error,"Expected_0_type_arguments_but_got_1_2558","Expected {0} type arguments, but got {1}."),Type_0_has_no_properties_in_common_with_type_1:t(2559,e.DiagnosticCategory.Error,"Type_0_has_no_properties_in_common_with_type_1_2559","Type '{0}' has no properties in common with type '{1}'."),Value_of_type_0_has_no_properties_in_common_with_type_1_Did_you_mean_to_call_it:t(2560,e.DiagnosticCategory.Error,"Value_of_type_0_has_no_properties_in_common_with_type_1_Did_you_mean_to_call_it_2560","Value of type '{0}' has no properties in common with type '{1}'. Did you mean to call it?"),Object_literal_may_only_specify_known_properties_but_0_does_not_exist_in_type_1_Did_you_mean_to_write_2:t(2561,e.DiagnosticCategory.Error,"Object_literal_may_only_specify_known_properties_but_0_does_not_exist_in_type_1_Did_you_mean_to_writ_2561","Object literal may only specify known properties, but '{0}' does not exist in type '{1}'. Did you mean to write '{2}'?"),Base_class_expressions_cannot_reference_class_type_parameters:t(2562,e.DiagnosticCategory.Error,"Base_class_expressions_cannot_reference_class_type_parameters_2562","Base class expressions cannot reference class type parameters."),The_containing_function_or_module_body_is_too_large_for_control_flow_analysis:t(2563,e.DiagnosticCategory.Error,"The_containing_function_or_module_body_is_too_large_for_control_flow_analysis_2563","The containing function or module body is too large for control flow analysis."),JSX_element_attributes_type_0_may_not_be_a_union_type:t(2600,e.DiagnosticCategory.Error,"JSX_element_attributes_type_0_may_not_be_a_union_type_2600","JSX element attributes type '{0}' may not be a union type."),The_return_type_of_a_JSX_element_constructor_must_return_an_object_type:t(2601,e.DiagnosticCategory.Error,"The_return_type_of_a_JSX_element_constructor_must_return_an_object_type_2601","The return type of a JSX element constructor must return an object type."),JSX_element_implicitly_has_type_any_because_the_global_type_JSX_Element_does_not_exist:t(2602,e.DiagnosticCategory.Error,"JSX_element_implicitly_has_type_any_because_the_global_type_JSX_Element_does_not_exist_2602","JSX element implicitly has type 'any' because the global type 'JSX.Element' does not exist."),Property_0_in_type_1_is_not_assignable_to_type_2:t(2603,e.DiagnosticCategory.Error,"Property_0_in_type_1_is_not_assignable_to_type_2_2603","Property '{0}' in type '{1}' is not assignable to type '{2}'."),JSX_element_type_0_does_not_have_any_construct_or_call_signatures:t(2604,e.DiagnosticCategory.Error,"JSX_element_type_0_does_not_have_any_construct_or_call_signatures_2604","JSX element type '{0}' does not have any construct or call signatures."),JSX_element_type_0_is_not_a_constructor_function_for_JSX_elements:t(2605,e.DiagnosticCategory.Error,"JSX_element_type_0_is_not_a_constructor_function_for_JSX_elements_2605","JSX element type '{0}' is not a constructor function for JSX elements."),Property_0_of_JSX_spread_attribute_is_not_assignable_to_target_property:t(2606,e.DiagnosticCategory.Error,"Property_0_of_JSX_spread_attribute_is_not_assignable_to_target_property_2606","Property '{0}' of JSX spread attribute is not assignable to target property."),JSX_element_class_does_not_support_attributes_because_it_does_not_have_a_0_property:t(2607,e.DiagnosticCategory.Error,"JSX_element_class_does_not_support_attributes_because_it_does_not_have_a_0_property_2607","JSX element class does not support attributes because it does not have a '{0}' property."),The_global_type_JSX_0_may_not_have_more_than_one_property:t(2608,e.DiagnosticCategory.Error,"The_global_type_JSX_0_may_not_have_more_than_one_property_2608","The global type 'JSX.{0}' may not have more than one property."),JSX_spread_child_must_be_an_array_type:t(2609,e.DiagnosticCategory.Error,"JSX_spread_child_must_be_an_array_type_2609","JSX spread child must be an array type."),Cannot_augment_module_0_with_value_exports_because_it_resolves_to_a_non_module_entity:t(2649,e.DiagnosticCategory.Error,"Cannot_augment_module_0_with_value_exports_because_it_resolves_to_a_non_module_entity_2649","Cannot augment module '{0}' with value exports because it resolves to a non-module entity."),A_member_initializer_in_a_enum_declaration_cannot_reference_members_declared_after_it_including_members_defined_in_other_enums:t(2651,e.DiagnosticCategory.Error,"A_member_initializer_in_a_enum_declaration_cannot_reference_members_declared_after_it_including_memb_2651","A member initializer in a enum declaration cannot reference members declared after it, including members defined in other enums."),Merged_declaration_0_cannot_include_a_default_export_declaration_Consider_adding_a_separate_export_default_0_declaration_instead:t(2652,e.DiagnosticCategory.Error,"Merged_declaration_0_cannot_include_a_default_export_declaration_Consider_adding_a_separate_export_d_2652","Merged declaration '{0}' cannot include a default export declaration. Consider adding a separate 'export default {0}' declaration instead."),Non_abstract_class_expression_does_not_implement_inherited_abstract_member_0_from_class_1:t(2653,e.DiagnosticCategory.Error,"Non_abstract_class_expression_does_not_implement_inherited_abstract_member_0_from_class_1_2653","Non-abstract class expression does not implement inherited abstract member '{0}' from class '{1}'."),Exported_external_package_typings_file_cannot_contain_tripleslash_references_Please_contact_the_package_author_to_update_the_package_definition:t(2654,e.DiagnosticCategory.Error,"Exported_external_package_typings_file_cannot_contain_tripleslash_references_Please_contact_the_pack_2654","Exported external package typings file cannot contain tripleslash references. Please contact the package author to update the package definition."),Exported_external_package_typings_file_0_is_not_a_module_Please_contact_the_package_author_to_update_the_package_definition:t(2656,e.DiagnosticCategory.Error,"Exported_external_package_typings_file_0_is_not_a_module_Please_contact_the_package_author_to_update_2656","Exported external package typings file '{0}' is not a module. Please contact the package author to update the package definition."),JSX_expressions_must_have_one_parent_element:t(2657,e.DiagnosticCategory.Error,"JSX_expressions_must_have_one_parent_element_2657","JSX expressions must have one parent element."),Type_0_provides_no_match_for_the_signature_1:t(2658,e.DiagnosticCategory.Error,"Type_0_provides_no_match_for_the_signature_1_2658","Type '{0}' provides no match for the signature '{1}'."),super_is_only_allowed_in_members_of_object_literal_expressions_when_option_target_is_ES2015_or_higher:t(2659,e.DiagnosticCategory.Error,"super_is_only_allowed_in_members_of_object_literal_expressions_when_option_target_is_ES2015_or_highe_2659","'super' is only allowed in members of object literal expressions when option 'target' is 'ES2015' or higher."),super_can_only_be_referenced_in_members_of_derived_classes_or_object_literal_expressions:t(2660,e.DiagnosticCategory.Error,"super_can_only_be_referenced_in_members_of_derived_classes_or_object_literal_expressions_2660","'super' can only be referenced in members of derived classes or object literal expressions."),Cannot_export_0_Only_local_declarations_can_be_exported_from_a_module:t(2661,e.DiagnosticCategory.Error,"Cannot_export_0_Only_local_declarations_can_be_exported_from_a_module_2661","Cannot export '{0}'. Only local declarations can be exported from a module."),Cannot_find_name_0_Did_you_mean_the_static_member_1_0:t(2662,e.DiagnosticCategory.Error,"Cannot_find_name_0_Did_you_mean_the_static_member_1_0_2662","Cannot find name '{0}'. Did you mean the static member '{1}.{0}'?"),Cannot_find_name_0_Did_you_mean_the_instance_member_this_0:t(2663,e.DiagnosticCategory.Error,"Cannot_find_name_0_Did_you_mean_the_instance_member_this_0_2663","Cannot find name '{0}'. Did you mean the instance member 'this.{0}'?"),Invalid_module_name_in_augmentation_module_0_cannot_be_found:t(2664,e.DiagnosticCategory.Error,"Invalid_module_name_in_augmentation_module_0_cannot_be_found_2664","Invalid module name in augmentation, module '{0}' cannot be found."),Invalid_module_name_in_augmentation_Module_0_resolves_to_an_untyped_module_at_1_which_cannot_be_augmented:t(2665,e.DiagnosticCategory.Error,"Invalid_module_name_in_augmentation_Module_0_resolves_to_an_untyped_module_at_1_which_cannot_be_augm_2665","Invalid module name in augmentation. Module '{0}' resolves to an untyped module at '{1}', which cannot be augmented."),Exports_and_export_assignments_are_not_permitted_in_module_augmentations:t(2666,e.DiagnosticCategory.Error,"Exports_and_export_assignments_are_not_permitted_in_module_augmentations_2666","Exports and export assignments are not permitted in module augmentations."),Imports_are_not_permitted_in_module_augmentations_Consider_moving_them_to_the_enclosing_external_module:t(2667,e.DiagnosticCategory.Error,"Imports_are_not_permitted_in_module_augmentations_Consider_moving_them_to_the_enclosing_external_mod_2667","Imports are not permitted in module augmentations. Consider moving them to the enclosing external module."),export_modifier_cannot_be_applied_to_ambient_modules_and_module_augmentations_since_they_are_always_visible:t(2668,e.DiagnosticCategory.Error,"export_modifier_cannot_be_applied_to_ambient_modules_and_module_augmentations_since_they_are_always__2668","'export' modifier cannot be applied to ambient modules and module augmentations since they are always visible."),Augmentations_for_the_global_scope_can_only_be_directly_nested_in_external_modules_or_ambient_module_declarations:t(2669,e.DiagnosticCategory.Error,"Augmentations_for_the_global_scope_can_only_be_directly_nested_in_external_modules_or_ambient_module_2669","Augmentations for the global scope can only be directly nested in external modules or ambient module declarations."),Augmentations_for_the_global_scope_should_have_declare_modifier_unless_they_appear_in_already_ambient_context:t(2670,e.DiagnosticCategory.Error,"Augmentations_for_the_global_scope_should_have_declare_modifier_unless_they_appear_in_already_ambien_2670","Augmentations for the global scope should have 'declare' modifier unless they appear in already ambient context."),Cannot_augment_module_0_because_it_resolves_to_a_non_module_entity:t(2671,e.DiagnosticCategory.Error,"Cannot_augment_module_0_because_it_resolves_to_a_non_module_entity_2671","Cannot augment module '{0}' because it resolves to a non-module entity."),Cannot_assign_a_0_constructor_type_to_a_1_constructor_type:t(2672,e.DiagnosticCategory.Error,"Cannot_assign_a_0_constructor_type_to_a_1_constructor_type_2672","Cannot assign a '{0}' constructor type to a '{1}' constructor type."),Constructor_of_class_0_is_private_and_only_accessible_within_the_class_declaration:t(2673,e.DiagnosticCategory.Error,"Constructor_of_class_0_is_private_and_only_accessible_within_the_class_declaration_2673","Constructor of class '{0}' is private and only accessible within the class declaration."),Constructor_of_class_0_is_protected_and_only_accessible_within_the_class_declaration:t(2674,e.DiagnosticCategory.Error,"Constructor_of_class_0_is_protected_and_only_accessible_within_the_class_declaration_2674","Constructor of class '{0}' is protected and only accessible within the class declaration."),Cannot_extend_a_class_0_Class_constructor_is_marked_as_private:t(2675,e.DiagnosticCategory.Error,"Cannot_extend_a_class_0_Class_constructor_is_marked_as_private_2675","Cannot extend a class '{0}'. Class constructor is marked as private."),Accessors_must_both_be_abstract_or_non_abstract:t(2676,e.DiagnosticCategory.Error,"Accessors_must_both_be_abstract_or_non_abstract_2676","Accessors must both be abstract or non-abstract."),A_type_predicate_s_type_must_be_assignable_to_its_parameter_s_type:t(2677,e.DiagnosticCategory.Error,"A_type_predicate_s_type_must_be_assignable_to_its_parameter_s_type_2677","A type predicate's type must be assignable to its parameter's type."),Type_0_is_not_comparable_to_type_1:t(2678,e.DiagnosticCategory.Error,"Type_0_is_not_comparable_to_type_1_2678","Type '{0}' is not comparable to type '{1}'."),A_function_that_is_called_with_the_new_keyword_cannot_have_a_this_type_that_is_void:t(2679,e.DiagnosticCategory.Error,"A_function_that_is_called_with_the_new_keyword_cannot_have_a_this_type_that_is_void_2679","A function that is called with the 'new' keyword cannot have a 'this' type that is 'void'."),A_0_parameter_must_be_the_first_parameter:t(2680,e.DiagnosticCategory.Error,"A_0_parameter_must_be_the_first_parameter_2680","A '{0}' parameter must be the first parameter."),A_constructor_cannot_have_a_this_parameter:t(2681,e.DiagnosticCategory.Error,"A_constructor_cannot_have_a_this_parameter_2681","A constructor cannot have a 'this' parameter."),get_and_set_accessor_must_have_the_same_this_type:t(2682,e.DiagnosticCategory.Error,"get_and_set_accessor_must_have_the_same_this_type_2682","'get' and 'set' accessor must have the same 'this' type."),this_implicitly_has_type_any_because_it_does_not_have_a_type_annotation:t(2683,e.DiagnosticCategory.Error,"this_implicitly_has_type_any_because_it_does_not_have_a_type_annotation_2683","'this' implicitly has type 'any' because it does not have a type annotation."),The_this_context_of_type_0_is_not_assignable_to_method_s_this_of_type_1:t(2684,e.DiagnosticCategory.Error,"The_this_context_of_type_0_is_not_assignable_to_method_s_this_of_type_1_2684","The 'this' context of type '{0}' is not assignable to method's 'this' of type '{1}'."),The_this_types_of_each_signature_are_incompatible:t(2685,e.DiagnosticCategory.Error,"The_this_types_of_each_signature_are_incompatible_2685","The 'this' types of each signature are incompatible."),_0_refers_to_a_UMD_global_but_the_current_file_is_a_module_Consider_adding_an_import_instead:t(2686,e.DiagnosticCategory.Error,"_0_refers_to_a_UMD_global_but_the_current_file_is_a_module_Consider_adding_an_import_instead_2686","'{0}' refers to a UMD global, but the current file is a module. Consider adding an import instead."),All_declarations_of_0_must_have_identical_modifiers:t(2687,e.DiagnosticCategory.Error,"All_declarations_of_0_must_have_identical_modifiers_2687","All declarations of '{0}' must have identical modifiers."),Cannot_find_type_definition_file_for_0:t(2688,e.DiagnosticCategory.Error,"Cannot_find_type_definition_file_for_0_2688","Cannot find type definition file for '{0}'."),Cannot_extend_an_interface_0_Did_you_mean_implements:t(2689,e.DiagnosticCategory.Error,"Cannot_extend_an_interface_0_Did_you_mean_implements_2689","Cannot extend an interface '{0}'. Did you mean 'implements'?"),An_import_path_cannot_end_with_a_0_extension_Consider_importing_1_instead:t(2691,e.DiagnosticCategory.Error,"An_import_path_cannot_end_with_a_0_extension_Consider_importing_1_instead_2691","An import path cannot end with a '{0}' extension. Consider importing '{1}' instead."),_0_is_a_primitive_but_1_is_a_wrapper_object_Prefer_using_0_when_possible:t(2692,e.DiagnosticCategory.Error,"_0_is_a_primitive_but_1_is_a_wrapper_object_Prefer_using_0_when_possible_2692","'{0}' is a primitive, but '{1}' is a wrapper object. Prefer using '{0}' when possible."),_0_only_refers_to_a_type_but_is_being_used_as_a_value_here:t(2693,e.DiagnosticCategory.Error,"_0_only_refers_to_a_type_but_is_being_used_as_a_value_here_2693","'{0}' only refers to a type, but is being used as a value here."),Namespace_0_has_no_exported_member_1:t(2694,e.DiagnosticCategory.Error,"Namespace_0_has_no_exported_member_1_2694","Namespace '{0}' has no exported member '{1}'."),Left_side_of_comma_operator_is_unused_and_has_no_side_effects:t(2695,e.DiagnosticCategory.Error,"Left_side_of_comma_operator_is_unused_and_has_no_side_effects_2695","Left side of comma operator is unused and has no side effects."),The_Object_type_is_assignable_to_very_few_other_types_Did_you_mean_to_use_the_any_type_instead:t(2696,e.DiagnosticCategory.Error,"The_Object_type_is_assignable_to_very_few_other_types_Did_you_mean_to_use_the_any_type_instead_2696","The 'Object' type is assignable to very few other types. Did you mean to use the 'any' type instead?"),An_async_function_or_method_must_return_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_include_ES2015_in_your_lib_option:t(2697,e.DiagnosticCategory.Error,"An_async_function_or_method_must_return_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_in_2697","An async function or method must return a 'Promise'. Make sure you have a declaration for 'Promise' or include 'ES2015' in your `--lib` option."),Spread_types_may_only_be_created_from_object_types:t(2698,e.DiagnosticCategory.Error,"Spread_types_may_only_be_created_from_object_types_2698","Spread types may only be created from object types."),Static_property_0_conflicts_with_built_in_property_Function_0_of_constructor_function_1:t(2699,e.DiagnosticCategory.Error,"Static_property_0_conflicts_with_built_in_property_Function_0_of_constructor_function_1_2699","Static property '{0}' conflicts with built-in property 'Function.{0}' of constructor function '{1}'."),Rest_types_may_only_be_created_from_object_types:t(2700,e.DiagnosticCategory.Error,"Rest_types_may_only_be_created_from_object_types_2700","Rest types may only be created from object types."),The_target_of_an_object_rest_assignment_must_be_a_variable_or_a_property_access:t(2701,e.DiagnosticCategory.Error,"The_target_of_an_object_rest_assignment_must_be_a_variable_or_a_property_access_2701","The target of an object rest assignment must be a variable or a property access."),_0_only_refers_to_a_type_but_is_being_used_as_a_namespace_here:t(2702,e.DiagnosticCategory.Error,"_0_only_refers_to_a_type_but_is_being_used_as_a_namespace_here_2702","'{0}' only refers to a type, but is being used as a namespace here."),The_operand_of_a_delete_operator_must_be_a_property_reference:t(2703,e.DiagnosticCategory.Error,"The_operand_of_a_delete_operator_must_be_a_property_reference_2703","The operand of a delete operator must be a property reference."),The_operand_of_a_delete_operator_cannot_be_a_read_only_property:t(2704,e.DiagnosticCategory.Error,"The_operand_of_a_delete_operator_cannot_be_a_read_only_property_2704","The operand of a delete operator cannot be a read-only property."),An_async_function_or_method_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declaration_for_the_Promise_constructor_or_include_ES2015_in_your_lib_option:t(2705,e.DiagnosticCategory.Error,"An_async_function_or_method_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_de_2705","An async function or method in ES5/ES3 requires the 'Promise' constructor.  Make sure you have a declaration for the 'Promise' constructor or include 'ES2015' in your `--lib` option."),Required_type_parameters_may_not_follow_optional_type_parameters:t(2706,e.DiagnosticCategory.Error,"Required_type_parameters_may_not_follow_optional_type_parameters_2706","Required type parameters may not follow optional type parameters."),Generic_type_0_requires_between_1_and_2_type_arguments:t(2707,e.DiagnosticCategory.Error,"Generic_type_0_requires_between_1_and_2_type_arguments_2707","Generic type '{0}' requires between {1} and {2} type arguments."),Cannot_use_namespace_0_as_a_value:t(2708,e.DiagnosticCategory.Error,"Cannot_use_namespace_0_as_a_value_2708","Cannot use namespace '{0}' as a value."),Cannot_use_namespace_0_as_a_type:t(2709,e.DiagnosticCategory.Error,"Cannot_use_namespace_0_as_a_type_2709","Cannot use namespace '{0}' as a type."),_0_are_specified_twice_The_attribute_named_0_will_be_overwritten:t(2710,e.DiagnosticCategory.Error,"_0_are_specified_twice_The_attribute_named_0_will_be_overwritten_2710","'{0}' are specified twice. The attribute named '{0}' will be overwritten."),A_dynamic_import_call_returns_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_include_ES2015_in_your_lib_option:t(2711,e.DiagnosticCategory.Error,"A_dynamic_import_call_returns_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_include_ES20_2711","A dynamic import call returns a 'Promise'. Make sure you have a declaration for 'Promise' or include 'ES2015' in your `--lib` option."),A_dynamic_import_call_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declaration_for_the_Promise_constructor_or_include_ES2015_in_your_lib_option:t(2712,e.DiagnosticCategory.Error,"A_dynamic_import_call_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declarat_2712","A dynamic import call in ES5/ES3 requires the 'Promise' constructor.  Make sure you have a declaration for the 'Promise' constructor or include 'ES2015' in your `--lib` option."),Cannot_access_0_1_because_0_is_a_type_but_not_a_namespace_Did_you_mean_to_retrieve_the_type_of_the_property_1_in_0_with_0_1:t(2713,e.DiagnosticCategory.Error,"Cannot_access_0_1_because_0_is_a_type_but_not_a_namespace_Did_you_mean_to_retrieve_the_type_of_the_p_2713","Cannot access '{0}.{1}' because '{0}' is a type, but not a namespace. Did you mean to retrieve the type of the property '{1}' in '{0}' with '{0}[\"{1}\"]'?"),The_expression_of_an_export_assignment_must_be_an_identifier_or_qualified_name_in_an_ambient_context:t(2714,e.DiagnosticCategory.Error,"The_expression_of_an_export_assignment_must_be_an_identifier_or_qualified_name_in_an_ambient_context_2714","The expression of an export assignment must be an identifier or qualified name in an ambient context."),Type_parameter_0_has_a_circular_default:t(2716,e.DiagnosticCategory.Error,"Type_parameter_0_has_a_circular_default_2716","Type parameter '{0}' has a circular default."),Import_declaration_0_is_using_private_name_1:t(4e3,e.DiagnosticCategory.Error,"Import_declaration_0_is_using_private_name_1_4000","Import declaration '{0}' is using private name '{1}'."),Type_parameter_0_of_exported_class_has_or_is_using_private_name_1:t(4002,e.DiagnosticCategory.Error,"Type_parameter_0_of_exported_class_has_or_is_using_private_name_1_4002","Type parameter '{0}' of exported class has or is using private name '{1}'."),Type_parameter_0_of_exported_interface_has_or_is_using_private_name_1:t(4004,e.DiagnosticCategory.Error,"Type_parameter_0_of_exported_interface_has_or_is_using_private_name_1_4004","Type parameter '{0}' of exported interface has or is using private name '{1}'."),Type_parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1:t(4006,e.DiagnosticCategory.Error,"Type_parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1_4006","Type parameter '{0}' of constructor signature from exported interface has or is using private name '{1}'."),Type_parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1:t(4008,e.DiagnosticCategory.Error,"Type_parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1_4008","Type parameter '{0}' of call signature from exported interface has or is using private name '{1}'."),Type_parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1:t(4010,e.DiagnosticCategory.Error,"Type_parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1_4010","Type parameter '{0}' of public static method from exported class has or is using private name '{1}'."),Type_parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1:t(4012,e.DiagnosticCategory.Error,"Type_parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1_4012","Type parameter '{0}' of public method from exported class has or is using private name '{1}'."),Type_parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1:t(4014,e.DiagnosticCategory.Error,"Type_parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1_4014","Type parameter '{0}' of method from exported interface has or is using private name '{1}'."),Type_parameter_0_of_exported_function_has_or_is_using_private_name_1:t(4016,e.DiagnosticCategory.Error,"Type_parameter_0_of_exported_function_has_or_is_using_private_name_1_4016","Type parameter '{0}' of exported function has or is using private name '{1}'."),Implements_clause_of_exported_class_0_has_or_is_using_private_name_1:t(4019,e.DiagnosticCategory.Error,"Implements_clause_of_exported_class_0_has_or_is_using_private_name_1_4019","Implements clause of exported class '{0}' has or is using private name '{1}'."),extends_clause_of_exported_class_0_has_or_is_using_private_name_1:t(4020,e.DiagnosticCategory.Error,"extends_clause_of_exported_class_0_has_or_is_using_private_name_1_4020","'extends' clause of exported class '{0}' has or is using private name '{1}'."),extends_clause_of_exported_interface_0_has_or_is_using_private_name_1:t(4022,e.DiagnosticCategory.Error,"extends_clause_of_exported_interface_0_has_or_is_using_private_name_1_4022","'extends' clause of exported interface '{0}' has or is using private name '{1}'."),Exported_variable_0_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4023,e.DiagnosticCategory.Error,"Exported_variable_0_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named_4023","Exported variable '{0}' has or is using name '{1}' from external module {2} but cannot be named."),Exported_variable_0_has_or_is_using_name_1_from_private_module_2:t(4024,e.DiagnosticCategory.Error,"Exported_variable_0_has_or_is_using_name_1_from_private_module_2_4024","Exported variable '{0}' has or is using name '{1}' from private module '{2}'."),Exported_variable_0_has_or_is_using_private_name_1:t(4025,e.DiagnosticCategory.Error,"Exported_variable_0_has_or_is_using_private_name_1_4025","Exported variable '{0}' has or is using private name '{1}'."),Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4026,e.DiagnosticCategory.Error,"Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot__4026","Public static property '{0}' of exported class has or is using name '{1}' from external module {2} but cannot be named."),Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2:t(4027,e.DiagnosticCategory.Error,"Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2_4027","Public static property '{0}' of exported class has or is using name '{1}' from private module '{2}'."),Public_static_property_0_of_exported_class_has_or_is_using_private_name_1:t(4028,e.DiagnosticCategory.Error,"Public_static_property_0_of_exported_class_has_or_is_using_private_name_1_4028","Public static property '{0}' of exported class has or is using private name '{1}'."),Public_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4029,e.DiagnosticCategory.Error,"Public_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_name_4029","Public property '{0}' of exported class has or is using name '{1}' from external module {2} but cannot be named."),Public_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2:t(4030,e.DiagnosticCategory.Error,"Public_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2_4030","Public property '{0}' of exported class has or is using name '{1}' from private module '{2}'."),Public_property_0_of_exported_class_has_or_is_using_private_name_1:t(4031,e.DiagnosticCategory.Error,"Public_property_0_of_exported_class_has_or_is_using_private_name_1_4031","Public property '{0}' of exported class has or is using private name '{1}'."),Property_0_of_exported_interface_has_or_is_using_name_1_from_private_module_2:t(4032,e.DiagnosticCategory.Error,"Property_0_of_exported_interface_has_or_is_using_name_1_from_private_module_2_4032","Property '{0}' of exported interface has or is using name '{1}' from private module '{2}'."),Property_0_of_exported_interface_has_or_is_using_private_name_1:t(4033,e.DiagnosticCategory.Error,"Property_0_of_exported_interface_has_or_is_using_private_name_1_4033","Property '{0}' of exported interface has or is using private name '{1}'."),Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_name_1_from_private_module_2:t(4034,e.DiagnosticCategory.Error,"Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_name_1_from_private_4034","Parameter '{0}' of public static property setter from exported class has or is using name '{1}' from private module '{2}'."),Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_private_name_1:t(4035,e.DiagnosticCategory.Error,"Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_private_name_1_4035","Parameter '{0}' of public static property setter from exported class has or is using private name '{1}'."),Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_name_1_from_private_module_2:t(4036,e.DiagnosticCategory.Error,"Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_name_1_from_private_module_4036","Parameter '{0}' of public property setter from exported class has or is using name '{1}' from private module '{2}'."),Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_private_name_1:t(4037,e.DiagnosticCategory.Error,"Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_private_name_1_4037","Parameter '{0}' of public property setter from exported class has or is using private name '{1}'."),Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:t(4038,e.DiagnosticCategory.Error,"Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_externa_4038","Return type of public static property getter from exported class has or is using name '{0}' from external module {1} but cannot be named."),Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_private_module_1:t(4039,e.DiagnosticCategory.Error,"Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_private_4039","Return type of public static property getter from exported class has or is using name '{0}' from private module '{1}'."),Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_private_name_0:t(4040,e.DiagnosticCategory.Error,"Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_private_name_0_4040","Return type of public static property getter from exported class has or is using private name '{0}'."),Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:t(4041,e.DiagnosticCategory.Error,"Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_external_modul_4041","Return type of public property getter from exported class has or is using name '{0}' from external module {1} but cannot be named."),Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_private_module_1:t(4042,e.DiagnosticCategory.Error,"Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_private_module_4042","Return type of public property getter from exported class has or is using name '{0}' from private module '{1}'."),Return_type_of_public_property_getter_from_exported_class_has_or_is_using_private_name_0:t(4043,e.DiagnosticCategory.Error,"Return_type_of_public_property_getter_from_exported_class_has_or_is_using_private_name_0_4043","Return type of public property getter from exported class has or is using private name '{0}'."),Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:t(4044,e.DiagnosticCategory.Error,"Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_name_0_from_private_mod_4044","Return type of constructor signature from exported interface has or is using name '{0}' from private module '{1}'."),Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_0:t(4045,e.DiagnosticCategory.Error,"Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_0_4045","Return type of constructor signature from exported interface has or is using private name '{0}'."),Return_type_of_call_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:t(4046,e.DiagnosticCategory.Error,"Return_type_of_call_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1_4046","Return type of call signature from exported interface has or is using name '{0}' from private module '{1}'."),Return_type_of_call_signature_from_exported_interface_has_or_is_using_private_name_0:t(4047,e.DiagnosticCategory.Error,"Return_type_of_call_signature_from_exported_interface_has_or_is_using_private_name_0_4047","Return type of call signature from exported interface has or is using private name '{0}'."),Return_type_of_index_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:t(4048,e.DiagnosticCategory.Error,"Return_type_of_index_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1_4048","Return type of index signature from exported interface has or is using name '{0}' from private module '{1}'."),Return_type_of_index_signature_from_exported_interface_has_or_is_using_private_name_0:t(4049,e.DiagnosticCategory.Error,"Return_type_of_index_signature_from_exported_interface_has_or_is_using_private_name_0_4049","Return type of index signature from exported interface has or is using private name '{0}'."),Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:t(4050,e.DiagnosticCategory.Error,"Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_external_module__4050","Return type of public static method from exported class has or is using name '{0}' from external module {1} but cannot be named."),Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_private_module_1:t(4051,e.DiagnosticCategory.Error,"Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_private_module_1_4051","Return type of public static method from exported class has or is using name '{0}' from private module '{1}'."),Return_type_of_public_static_method_from_exported_class_has_or_is_using_private_name_0:t(4052,e.DiagnosticCategory.Error,"Return_type_of_public_static_method_from_exported_class_has_or_is_using_private_name_0_4052","Return type of public static method from exported class has or is using private name '{0}'."),Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:t(4053,e.DiagnosticCategory.Error,"Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_c_4053","Return type of public method from exported class has or is using name '{0}' from external module {1} but cannot be named."),Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_private_module_1:t(4054,e.DiagnosticCategory.Error,"Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_private_module_1_4054","Return type of public method from exported class has or is using name '{0}' from private module '{1}'."),Return_type_of_public_method_from_exported_class_has_or_is_using_private_name_0:t(4055,e.DiagnosticCategory.Error,"Return_type_of_public_method_from_exported_class_has_or_is_using_private_name_0_4055","Return type of public method from exported class has or is using private name '{0}'."),Return_type_of_method_from_exported_interface_has_or_is_using_name_0_from_private_module_1:t(4056,e.DiagnosticCategory.Error,"Return_type_of_method_from_exported_interface_has_or_is_using_name_0_from_private_module_1_4056","Return type of method from exported interface has or is using name '{0}' from private module '{1}'."),Return_type_of_method_from_exported_interface_has_or_is_using_private_name_0:t(4057,e.DiagnosticCategory.Error,"Return_type_of_method_from_exported_interface_has_or_is_using_private_name_0_4057","Return type of method from exported interface has or is using private name '{0}'."),Return_type_of_exported_function_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:t(4058,e.DiagnosticCategory.Error,"Return_type_of_exported_function_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named_4058","Return type of exported function has or is using name '{0}' from external module {1} but cannot be named."),Return_type_of_exported_function_has_or_is_using_name_0_from_private_module_1:t(4059,e.DiagnosticCategory.Error,"Return_type_of_exported_function_has_or_is_using_name_0_from_private_module_1_4059","Return type of exported function has or is using name '{0}' from private module '{1}'."),Return_type_of_exported_function_has_or_is_using_private_name_0:t(4060,e.DiagnosticCategory.Error,"Return_type_of_exported_function_has_or_is_using_private_name_0_4060","Return type of exported function has or is using private name '{0}'."),Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4061,e.DiagnosticCategory.Error,"Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_can_4061","Parameter '{0}' of constructor from exported class has or is using name '{1}' from external module {2} but cannot be named."),Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_private_module_2:t(4062,e.DiagnosticCategory.Error,"Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_private_module_2_4062","Parameter '{0}' of constructor from exported class has or is using name '{1}' from private module '{2}'."),Parameter_0_of_constructor_from_exported_class_has_or_is_using_private_name_1:t(4063,e.DiagnosticCategory.Error,"Parameter_0_of_constructor_from_exported_class_has_or_is_using_private_name_1_4063","Parameter '{0}' of constructor from exported class has or is using private name '{1}'."),Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:t(4064,e.DiagnosticCategory.Error,"Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_name_1_from_private_mod_4064","Parameter '{0}' of constructor signature from exported interface has or is using name '{1}' from private module '{2}'."),Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1:t(4065,e.DiagnosticCategory.Error,"Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1_4065","Parameter '{0}' of constructor signature from exported interface has or is using private name '{1}'."),Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:t(4066,e.DiagnosticCategory.Error,"Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2_4066","Parameter '{0}' of call signature from exported interface has or is using name '{1}' from private module '{2}'."),Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1:t(4067,e.DiagnosticCategory.Error,"Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1_4067","Parameter '{0}' of call signature from exported interface has or is using private name '{1}'."),Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4068,e.DiagnosticCategory.Error,"Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_external_module__4068","Parameter '{0}' of public static method from exported class has or is using name '{1}' from external module {2} but cannot be named."),Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_private_module_2:t(4069,e.DiagnosticCategory.Error,"Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_private_module_2_4069","Parameter '{0}' of public static method from exported class has or is using name '{1}' from private module '{2}'."),Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1:t(4070,e.DiagnosticCategory.Error,"Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1_4070","Parameter '{0}' of public static method from exported class has or is using private name '{1}'."),Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4071,e.DiagnosticCategory.Error,"Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_c_4071","Parameter '{0}' of public method from exported class has or is using name '{1}' from external module {2} but cannot be named."),Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_private_module_2:t(4072,e.DiagnosticCategory.Error,"Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_private_module_2_4072","Parameter '{0}' of public method from exported class has or is using name '{1}' from private module '{2}'."),Parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1:t(4073,e.DiagnosticCategory.Error,"Parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1_4073","Parameter '{0}' of public method from exported class has or is using private name '{1}'."),Parameter_0_of_method_from_exported_interface_has_or_is_using_name_1_from_private_module_2:t(4074,e.DiagnosticCategory.Error,"Parameter_0_of_method_from_exported_interface_has_or_is_using_name_1_from_private_module_2_4074","Parameter '{0}' of method from exported interface has or is using name '{1}' from private module '{2}'."),Parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1:t(4075,e.DiagnosticCategory.Error,"Parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1_4075","Parameter '{0}' of method from exported interface has or is using private name '{1}'."),Parameter_0_of_exported_function_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:t(4076,e.DiagnosticCategory.Error,"Parameter_0_of_exported_function_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named_4076","Parameter '{0}' of exported function has or is using name '{1}' from external module {2} but cannot be named."),Parameter_0_of_exported_function_has_or_is_using_name_1_from_private_module_2:t(4077,e.DiagnosticCategory.Error,"Parameter_0_of_exported_function_has_or_is_using_name_1_from_private_module_2_4077","Parameter '{0}' of exported function has or is using name '{1}' from private module '{2}'."),Parameter_0_of_exported_function_has_or_is_using_private_name_1:t(4078,e.DiagnosticCategory.Error,"Parameter_0_of_exported_function_has_or_is_using_private_name_1_4078","Parameter '{0}' of exported function has or is using private name '{1}'."),Exported_type_alias_0_has_or_is_using_private_name_1:t(4081,e.DiagnosticCategory.Error,"Exported_type_alias_0_has_or_is_using_private_name_1_4081","Exported type alias '{0}' has or is using private name '{1}'."),Default_export_of_the_module_has_or_is_using_private_name_0:t(4082,e.DiagnosticCategory.Error,"Default_export_of_the_module_has_or_is_using_private_name_0_4082","Default export of the module has or is using private name '{0}'."),Type_parameter_0_of_exported_type_alias_has_or_is_using_private_name_1:t(4083,e.DiagnosticCategory.Error,"Type_parameter_0_of_exported_type_alias_has_or_is_using_private_name_1_4083","Type parameter '{0}' of exported type alias has or is using private name '{1}'."),Conflicting_definitions_for_0_found_at_1_and_2_Consider_installing_a_specific_version_of_this_library_to_resolve_the_conflict:t(4090,e.DiagnosticCategory.Message,"Conflicting_definitions_for_0_found_at_1_and_2_Consider_installing_a_specific_version_of_this_librar_4090","Conflicting definitions for '{0}' found at '{1}' and '{2}'. Consider installing a specific version of this library to resolve the conflict."),Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:t(4091,e.DiagnosticCategory.Error,"Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2_4091","Parameter '{0}' of index signature from exported interface has or is using name '{1}' from private module '{2}'."),Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_private_name_1:t(4092,e.DiagnosticCategory.Error,"Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_private_name_1_4092","Parameter '{0}' of index signature from exported interface has or is using private name '{1}'."),Property_0_of_exported_class_expression_may_not_be_private_or_protected:t(4094,e.DiagnosticCategory.Error,"Property_0_of_exported_class_expression_may_not_be_private_or_protected_4094","Property '{0}' of exported class expression may not be private or protected."),The_current_host_does_not_support_the_0_option:t(5001,e.DiagnosticCategory.Error,"The_current_host_does_not_support_the_0_option_5001","The current host does not support the '{0}' option."),Cannot_find_the_common_subdirectory_path_for_the_input_files:t(5009,e.DiagnosticCategory.Error,"Cannot_find_the_common_subdirectory_path_for_the_input_files_5009","Cannot find the common subdirectory path for the input files."),File_specification_cannot_end_in_a_recursive_directory_wildcard_Asterisk_Asterisk_Colon_0:t(5010,e.DiagnosticCategory.Error,"File_specification_cannot_end_in_a_recursive_directory_wildcard_Asterisk_Asterisk_Colon_0_5010","File specification cannot end in a recursive directory wildcard ('**'): '{0}'."),File_specification_cannot_contain_multiple_recursive_directory_wildcards_Asterisk_Asterisk_Colon_0:t(5011,e.DiagnosticCategory.Error,"File_specification_cannot_contain_multiple_recursive_directory_wildcards_Asterisk_Asterisk_Colon_0_5011","File specification cannot contain multiple recursive directory wildcards ('**'): '{0}'."),Cannot_read_file_0_Colon_1:t(5012,e.DiagnosticCategory.Error,"Cannot_read_file_0_Colon_1_5012","Cannot read file '{0}': {1}."),Failed_to_parse_file_0_Colon_1:t(5014,e.DiagnosticCategory.Error,"Failed_to_parse_file_0_Colon_1_5014","Failed to parse file '{0}': {1}."),Unknown_compiler_option_0:t(5023,e.DiagnosticCategory.Error,"Unknown_compiler_option_0_5023","Unknown compiler option '{0}'."),Compiler_option_0_requires_a_value_of_type_1:t(5024,e.DiagnosticCategory.Error,"Compiler_option_0_requires_a_value_of_type_1_5024","Compiler option '{0}' requires a value of type {1}."),Could_not_write_file_0_Colon_1:t(5033,e.DiagnosticCategory.Error,"Could_not_write_file_0_Colon_1_5033","Could not write file '{0}': {1}."),Option_project_cannot_be_mixed_with_source_files_on_a_command_line:t(5042,e.DiagnosticCategory.Error,"Option_project_cannot_be_mixed_with_source_files_on_a_command_line_5042","Option 'project' cannot be mixed with source files on a command line."),Option_isolatedModules_can_only_be_used_when_either_option_module_is_provided_or_option_target_is_ES2015_or_higher:t(5047,e.DiagnosticCategory.Error,"Option_isolatedModules_can_only_be_used_when_either_option_module_is_provided_or_option_target_is_ES_5047","Option 'isolatedModules' can only be used when either option '--module' is provided or option 'target' is 'ES2015' or higher."),Option_0_can_only_be_used_when_either_option_inlineSourceMap_or_option_sourceMap_is_provided:t(5051,e.DiagnosticCategory.Error,"Option_0_can_only_be_used_when_either_option_inlineSourceMap_or_option_sourceMap_is_provided_5051","Option '{0} can only be used when either option '--inlineSourceMap' or option '--sourceMap' is provided."),Option_0_cannot_be_specified_without_specifying_option_1:t(5052,e.DiagnosticCategory.Error,"Option_0_cannot_be_specified_without_specifying_option_1_5052","Option '{0}' cannot be specified without specifying option '{1}'."),Option_0_cannot_be_specified_with_option_1:t(5053,e.DiagnosticCategory.Error,"Option_0_cannot_be_specified_with_option_1_5053","Option '{0}' cannot be specified with option '{1}'."),A_tsconfig_json_file_is_already_defined_at_Colon_0:t(5054,e.DiagnosticCategory.Error,"A_tsconfig_json_file_is_already_defined_at_Colon_0_5054","A 'tsconfig.json' file is already defined at: '{0}'."),Cannot_write_file_0_because_it_would_overwrite_input_file:t(5055,e.DiagnosticCategory.Error,"Cannot_write_file_0_because_it_would_overwrite_input_file_5055","Cannot write file '{0}' because it would overwrite input file."),Cannot_write_file_0_because_it_would_be_overwritten_by_multiple_input_files:t(5056,e.DiagnosticCategory.Error,"Cannot_write_file_0_because_it_would_be_overwritten_by_multiple_input_files_5056","Cannot write file '{0}' because it would be overwritten by multiple input files."),Cannot_find_a_tsconfig_json_file_at_the_specified_directory_Colon_0:t(5057,e.DiagnosticCategory.Error,"Cannot_find_a_tsconfig_json_file_at_the_specified_directory_Colon_0_5057","Cannot find a tsconfig.json file at the specified directory: '{0}'."),The_specified_path_does_not_exist_Colon_0:t(5058,e.DiagnosticCategory.Error,"The_specified_path_does_not_exist_Colon_0_5058","The specified path does not exist: '{0}'."),Invalid_value_for_reactNamespace_0_is_not_a_valid_identifier:t(5059,e.DiagnosticCategory.Error,"Invalid_value_for_reactNamespace_0_is_not_a_valid_identifier_5059","Invalid value for '--reactNamespace'. '{0}' is not a valid identifier."),Option_paths_cannot_be_used_without_specifying_baseUrl_option:t(5060,e.DiagnosticCategory.Error,"Option_paths_cannot_be_used_without_specifying_baseUrl_option_5060","Option 'paths' cannot be used without specifying '--baseUrl' option."),Pattern_0_can_have_at_most_one_Asterisk_character:t(5061,e.DiagnosticCategory.Error,"Pattern_0_can_have_at_most_one_Asterisk_character_5061","Pattern '{0}' can have at most one '*' character."),Substitution_0_in_pattern_1_in_can_have_at_most_one_Asterisk_character:t(5062,e.DiagnosticCategory.Error,"Substitution_0_in_pattern_1_in_can_have_at_most_one_Asterisk_character_5062","Substitution '{0}' in pattern '{1}' in can have at most one '*' character."),Substitutions_for_pattern_0_should_be_an_array:t(5063,e.DiagnosticCategory.Error,"Substitutions_for_pattern_0_should_be_an_array_5063","Substitutions for pattern '{0}' should be an array."),Substitution_0_for_pattern_1_has_incorrect_type_expected_string_got_2:t(5064,e.DiagnosticCategory.Error,"Substitution_0_for_pattern_1_has_incorrect_type_expected_string_got_2_5064","Substitution '{0}' for pattern '{1}' has incorrect type, expected 'string', got '{2}'."),File_specification_cannot_contain_a_parent_directory_that_appears_after_a_recursive_directory_wildcard_Asterisk_Asterisk_Colon_0:t(5065,e.DiagnosticCategory.Error,"File_specification_cannot_contain_a_parent_directory_that_appears_after_a_recursive_directory_wildca_5065","File specification cannot contain a parent directory ('..') that appears after a recursive directory wildcard ('**'): '{0}'."),Substitutions_for_pattern_0_shouldn_t_be_an_empty_array:t(5066,e.DiagnosticCategory.Error,"Substitutions_for_pattern_0_shouldn_t_be_an_empty_array_5066","Substitutions for pattern '{0}' shouldn't be an empty array."),Invalid_value_for_jsxFactory_0_is_not_a_valid_identifier_or_qualified_name:t(5067,e.DiagnosticCategory.Error,"Invalid_value_for_jsxFactory_0_is_not_a_valid_identifier_or_qualified_name_5067","Invalid value for 'jsxFactory'. '{0}' is not a valid identifier or qualified-name."),Concatenate_and_emit_output_to_single_file:t(6001,e.DiagnosticCategory.Message,"Concatenate_and_emit_output_to_single_file_6001","Concatenate and emit output to single file."),Generates_corresponding_d_ts_file:t(6002,e.DiagnosticCategory.Message,"Generates_corresponding_d_ts_file_6002","Generates corresponding '.d.ts' file."),Specify_the_location_where_debugger_should_locate_map_files_instead_of_generated_locations:t(6003,e.DiagnosticCategory.Message,"Specify_the_location_where_debugger_should_locate_map_files_instead_of_generated_locations_6003","Specify the location where debugger should locate map files instead of generated locations."),Specify_the_location_where_debugger_should_locate_TypeScript_files_instead_of_source_locations:t(6004,e.DiagnosticCategory.Message,"Specify_the_location_where_debugger_should_locate_TypeScript_files_instead_of_source_locations_6004","Specify the location where debugger should locate TypeScript files instead of source locations."),Watch_input_files:t(6005,e.DiagnosticCategory.Message,"Watch_input_files_6005","Watch input files."),Redirect_output_structure_to_the_directory:t(6006,e.DiagnosticCategory.Message,"Redirect_output_structure_to_the_directory_6006","Redirect output structure to the directory."),Do_not_erase_const_enum_declarations_in_generated_code:t(6007,e.DiagnosticCategory.Message,"Do_not_erase_const_enum_declarations_in_generated_code_6007","Do not erase const enum declarations in generated code."),Do_not_emit_outputs_if_any_errors_were_reported:t(6008,e.DiagnosticCategory.Message,"Do_not_emit_outputs_if_any_errors_were_reported_6008","Do not emit outputs if any errors were reported."),Do_not_emit_comments_to_output:t(6009,e.DiagnosticCategory.Message,"Do_not_emit_comments_to_output_6009","Do not emit comments to output."),Do_not_emit_outputs:t(6010,e.DiagnosticCategory.Message,"Do_not_emit_outputs_6010","Do not emit outputs."),Allow_default_imports_from_modules_with_no_default_export_This_does_not_affect_code_emit_just_typechecking:t(6011,e.DiagnosticCategory.Message,"Allow_default_imports_from_modules_with_no_default_export_This_does_not_affect_code_emit_just_typech_6011","Allow default imports from modules with no default export. This does not affect code emit, just typechecking."),Skip_type_checking_of_declaration_files:t(6012,e.DiagnosticCategory.Message,"Skip_type_checking_of_declaration_files_6012","Skip type checking of declaration files."),Do_not_resolve_the_real_path_of_symlinks:t(6013,e.DiagnosticCategory.Message,"Do_not_resolve_the_real_path_of_symlinks_6013","Do not resolve the real path of symlinks."),Specify_ECMAScript_target_version_Colon_ES3_default_ES5_ES2015_ES2016_ES2017_or_ESNEXT:t(6015,e.DiagnosticCategory.Message,"Specify_ECMAScript_target_version_Colon_ES3_default_ES5_ES2015_ES2016_ES2017_or_ESNEXT_6015","Specify ECMAScript target version: 'ES3' (default), 'ES5', 'ES2015', 'ES2016', 'ES2017', or 'ESNEXT'."),Specify_module_code_generation_Colon_none_commonjs_amd_system_umd_es2015_or_ESNext:t(6016,e.DiagnosticCategory.Message,"Specify_module_code_generation_Colon_none_commonjs_amd_system_umd_es2015_or_ESNext_6016","Specify module code generation: 'none', 'commonjs', 'amd', 'system', 'umd', 'es2015', or 'ESNext'."),Print_this_message:t(6017,e.DiagnosticCategory.Message,"Print_this_message_6017","Print this message."),Print_the_compiler_s_version:t(6019,e.DiagnosticCategory.Message,"Print_the_compiler_s_version_6019","Print the compiler's version."),Compile_the_project_given_the_path_to_its_configuration_file_or_to_a_folder_with_a_tsconfig_json:t(6020,e.DiagnosticCategory.Message,"Compile_the_project_given_the_path_to_its_configuration_file_or_to_a_folder_with_a_tsconfig_json_6020","Compile the project given the path to its configuration file, or to a folder with a 'tsconfig.json'."),Syntax_Colon_0:t(6023,e.DiagnosticCategory.Message,"Syntax_Colon_0_6023","Syntax: {0}"),options:t(6024,e.DiagnosticCategory.Message,"options_6024","options"),file:t(6025,e.DiagnosticCategory.Message,"file_6025","file"),Examples_Colon_0:t(6026,e.DiagnosticCategory.Message,"Examples_Colon_0_6026","Examples: {0}"),Options_Colon:t(6027,e.DiagnosticCategory.Message,"Options_Colon_6027","Options:"),Version_0:t(6029,e.DiagnosticCategory.Message,"Version_0_6029","Version {0}"),Insert_command_line_options_and_files_from_a_file:t(6030,e.DiagnosticCategory.Message,"Insert_command_line_options_and_files_from_a_file_6030","Insert command line options and files from a file."),File_change_detected_Starting_incremental_compilation:t(6032,e.DiagnosticCategory.Message,"File_change_detected_Starting_incremental_compilation_6032","File change detected. Starting incremental compilation..."),KIND:t(6034,e.DiagnosticCategory.Message,"KIND_6034","KIND"),FILE:t(6035,e.DiagnosticCategory.Message,"FILE_6035","FILE"),VERSION:t(6036,e.DiagnosticCategory.Message,"VERSION_6036","VERSION"),LOCATION:t(6037,e.DiagnosticCategory.Message,"LOCATION_6037","LOCATION"),DIRECTORY:t(6038,e.DiagnosticCategory.Message,"DIRECTORY_6038","DIRECTORY"),STRATEGY:t(6039,e.DiagnosticCategory.Message,"STRATEGY_6039","STRATEGY"),FILE_OR_DIRECTORY:t(6040,e.DiagnosticCategory.Message,"FILE_OR_DIRECTORY_6040","FILE OR DIRECTORY"),Compilation_complete_Watching_for_file_changes:t(6042,e.DiagnosticCategory.Message,"Compilation_complete_Watching_for_file_changes_6042","Compilation complete. Watching for file changes."),Generates_corresponding_map_file:t(6043,e.DiagnosticCategory.Message,"Generates_corresponding_map_file_6043","Generates corresponding '.map' file."),Compiler_option_0_expects_an_argument:t(6044,e.DiagnosticCategory.Error,"Compiler_option_0_expects_an_argument_6044","Compiler option '{0}' expects an argument."),Unterminated_quoted_string_in_response_file_0:t(6045,e.DiagnosticCategory.Error,"Unterminated_quoted_string_in_response_file_0_6045","Unterminated quoted string in response file '{0}'."),Argument_for_0_option_must_be_Colon_1:t(6046,e.DiagnosticCategory.Error,"Argument_for_0_option_must_be_Colon_1_6046","Argument for '{0}' option must be: {1}."),Locale_must_be_of_the_form_language_or_language_territory_For_example_0_or_1:t(6048,e.DiagnosticCategory.Error,"Locale_must_be_of_the_form_language_or_language_territory_For_example_0_or_1_6048","Locale must be of the form <language> or <language>-<territory>. For example '{0}' or '{1}'."),Unsupported_locale_0:t(6049,e.DiagnosticCategory.Error,"Unsupported_locale_0_6049","Unsupported locale '{0}'."),Unable_to_open_file_0:t(6050,e.DiagnosticCategory.Error,"Unable_to_open_file_0_6050","Unable to open file '{0}'."),Corrupted_locale_file_0:t(6051,e.DiagnosticCategory.Error,"Corrupted_locale_file_0_6051","Corrupted locale file {0}."),Raise_error_on_expressions_and_declarations_with_an_implied_any_type:t(6052,e.DiagnosticCategory.Message,"Raise_error_on_expressions_and_declarations_with_an_implied_any_type_6052","Raise error on expressions and declarations with an implied 'any' type."),File_0_not_found:t(6053,e.DiagnosticCategory.Error,"File_0_not_found_6053","File '{0}' not found."),File_0_has_unsupported_extension_The_only_supported_extensions_are_1:t(6054,e.DiagnosticCategory.Error,"File_0_has_unsupported_extension_The_only_supported_extensions_are_1_6054","File '{0}' has unsupported extension. The only supported extensions are {1}."),Suppress_noImplicitAny_errors_for_indexing_objects_lacking_index_signatures:t(6055,e.DiagnosticCategory.Message,"Suppress_noImplicitAny_errors_for_indexing_objects_lacking_index_signatures_6055","Suppress noImplicitAny errors for indexing objects lacking index signatures."),Do_not_emit_declarations_for_code_that_has_an_internal_annotation:t(6056,e.DiagnosticCategory.Message,"Do_not_emit_declarations_for_code_that_has_an_internal_annotation_6056","Do not emit declarations for code that has an '@internal' annotation."),Specify_the_root_directory_of_input_files_Use_to_control_the_output_directory_structure_with_outDir:t(6058,e.DiagnosticCategory.Message,"Specify_the_root_directory_of_input_files_Use_to_control_the_output_directory_structure_with_outDir_6058","Specify the root directory of input files. Use to control the output directory structure with --outDir."),File_0_is_not_under_rootDir_1_rootDir_is_expected_to_contain_all_source_files:t(6059,e.DiagnosticCategory.Error,"File_0_is_not_under_rootDir_1_rootDir_is_expected_to_contain_all_source_files_6059","File '{0}' is not under 'rootDir' '{1}'. 'rootDir' is expected to contain all source files."),Specify_the_end_of_line_sequence_to_be_used_when_emitting_files_Colon_CRLF_dos_or_LF_unix:t(6060,e.DiagnosticCategory.Message,"Specify_the_end_of_line_sequence_to_be_used_when_emitting_files_Colon_CRLF_dos_or_LF_unix_6060","Specify the end of line sequence to be used when emitting files: 'CRLF' (dos) or 'LF' (unix)."),NEWLINE:t(6061,e.DiagnosticCategory.Message,"NEWLINE_6061","NEWLINE"),Option_0_can_only_be_specified_in_tsconfig_json_file:t(6064,e.DiagnosticCategory.Error,"Option_0_can_only_be_specified_in_tsconfig_json_file_6064","Option '{0}' can only be specified in 'tsconfig.json' file."),Enables_experimental_support_for_ES7_decorators:t(6065,e.DiagnosticCategory.Message,"Enables_experimental_support_for_ES7_decorators_6065","Enables experimental support for ES7 decorators."),Enables_experimental_support_for_emitting_type_metadata_for_decorators:t(6066,e.DiagnosticCategory.Message,"Enables_experimental_support_for_emitting_type_metadata_for_decorators_6066","Enables experimental support for emitting type metadata for decorators."),Enables_experimental_support_for_ES7_async_functions:t(6068,e.DiagnosticCategory.Message,"Enables_experimental_support_for_ES7_async_functions_6068","Enables experimental support for ES7 async functions."),Specify_module_resolution_strategy_Colon_node_Node_js_or_classic_TypeScript_pre_1_6:t(6069,e.DiagnosticCategory.Message,"Specify_module_resolution_strategy_Colon_node_Node_js_or_classic_TypeScript_pre_1_6_6069","Specify module resolution strategy: 'node' (Node.js) or 'classic' (TypeScript pre-1.6)."),Initializes_a_TypeScript_project_and_creates_a_tsconfig_json_file:t(6070,e.DiagnosticCategory.Message,"Initializes_a_TypeScript_project_and_creates_a_tsconfig_json_file_6070","Initializes a TypeScript project and creates a tsconfig.json file."),Successfully_created_a_tsconfig_json_file:t(6071,e.DiagnosticCategory.Message,"Successfully_created_a_tsconfig_json_file_6071","Successfully created a tsconfig.json file."),Suppress_excess_property_checks_for_object_literals:t(6072,e.DiagnosticCategory.Message,"Suppress_excess_property_checks_for_object_literals_6072","Suppress excess property checks for object literals."),Stylize_errors_and_messages_using_color_and_context_experimental:t(6073,e.DiagnosticCategory.Message,"Stylize_errors_and_messages_using_color_and_context_experimental_6073","Stylize errors and messages using color and context (experimental)."),Do_not_report_errors_on_unused_labels:t(6074,e.DiagnosticCategory.Message,"Do_not_report_errors_on_unused_labels_6074","Do not report errors on unused labels."),Report_error_when_not_all_code_paths_in_function_return_a_value:t(6075,e.DiagnosticCategory.Message,"Report_error_when_not_all_code_paths_in_function_return_a_value_6075","Report error when not all code paths in function return a value."),Report_errors_for_fallthrough_cases_in_switch_statement:t(6076,e.DiagnosticCategory.Message,"Report_errors_for_fallthrough_cases_in_switch_statement_6076","Report errors for fallthrough cases in switch statement."),Do_not_report_errors_on_unreachable_code:t(6077,e.DiagnosticCategory.Message,"Do_not_report_errors_on_unreachable_code_6077","Do not report errors on unreachable code."),Disallow_inconsistently_cased_references_to_the_same_file:t(6078,e.DiagnosticCategory.Message,"Disallow_inconsistently_cased_references_to_the_same_file_6078","Disallow inconsistently-cased references to the same file."),Specify_library_files_to_be_included_in_the_compilation_Colon:t(6079,e.DiagnosticCategory.Message,"Specify_library_files_to_be_included_in_the_compilation_Colon_6079","Specify library files to be included in the compilation: "),Specify_JSX_code_generation_Colon_preserve_react_native_or_react:t(6080,e.DiagnosticCategory.Message,"Specify_JSX_code_generation_Colon_preserve_react_native_or_react_6080","Specify JSX code generation: 'preserve', 'react-native', or 'react'."),File_0_has_an_unsupported_extension_so_skipping_it:t(6081,e.DiagnosticCategory.Message,"File_0_has_an_unsupported_extension_so_skipping_it_6081","File '{0}' has an unsupported extension, so skipping it."),Only_amd_and_system_modules_are_supported_alongside_0:t(6082,e.DiagnosticCategory.Error,"Only_amd_and_system_modules_are_supported_alongside_0_6082","Only 'amd' and 'system' modules are supported alongside --{0}."),Base_directory_to_resolve_non_absolute_module_names:t(6083,e.DiagnosticCategory.Message,"Base_directory_to_resolve_non_absolute_module_names_6083","Base directory to resolve non-absolute module names."),Deprecated_Use_jsxFactory_instead_Specify_the_object_invoked_for_createElement_when_targeting_react_JSX_emit:t(6084,e.DiagnosticCategory.Message,"Deprecated_Use_jsxFactory_instead_Specify_the_object_invoked_for_createElement_when_targeting_react__6084","[Deprecated] Use '--jsxFactory' instead. Specify the object invoked for createElement when targeting 'react' JSX emit"),Enable_tracing_of_the_name_resolution_process:t(6085,e.DiagnosticCategory.Message,"Enable_tracing_of_the_name_resolution_process_6085","Enable tracing of the name resolution process."),Resolving_module_0_from_1:t(6086,e.DiagnosticCategory.Message,"Resolving_module_0_from_1_6086","======== Resolving module '{0}' from '{1}'. ========"),Explicitly_specified_module_resolution_kind_Colon_0:t(6087,e.DiagnosticCategory.Message,"Explicitly_specified_module_resolution_kind_Colon_0_6087","Explicitly specified module resolution kind: '{0}'."),Module_resolution_kind_is_not_specified_using_0:t(6088,e.DiagnosticCategory.Message,"Module_resolution_kind_is_not_specified_using_0_6088","Module resolution kind is not specified, using '{0}'."),Module_name_0_was_successfully_resolved_to_1:t(6089,e.DiagnosticCategory.Message,"Module_name_0_was_successfully_resolved_to_1_6089","======== Module name '{0}' was successfully resolved to '{1}'. ========"),Module_name_0_was_not_resolved:t(6090,e.DiagnosticCategory.Message,"Module_name_0_was_not_resolved_6090","======== Module name '{0}' was not resolved. ========"),paths_option_is_specified_looking_for_a_pattern_to_match_module_name_0:t(6091,e.DiagnosticCategory.Message,"paths_option_is_specified_looking_for_a_pattern_to_match_module_name_0_6091","'paths' option is specified, looking for a pattern to match module name '{0}'."),Module_name_0_matched_pattern_1:t(6092,e.DiagnosticCategory.Message,"Module_name_0_matched_pattern_1_6092","Module name '{0}', matched pattern '{1}'."),Trying_substitution_0_candidate_module_location_Colon_1:t(6093,e.DiagnosticCategory.Message,"Trying_substitution_0_candidate_module_location_Colon_1_6093","Trying substitution '{0}', candidate module location: '{1}'."),Resolving_module_name_0_relative_to_base_url_1_2:t(6094,e.DiagnosticCategory.Message,"Resolving_module_name_0_relative_to_base_url_1_2_6094","Resolving module name '{0}' relative to base url '{1}' - '{2}'."),Loading_module_as_file_Slash_folder_candidate_module_location_0_target_file_type_1:t(6095,e.DiagnosticCategory.Message,"Loading_module_as_file_Slash_folder_candidate_module_location_0_target_file_type_1_6095","Loading module as file / folder, candidate module location '{0}', target file type '{1}'."),File_0_does_not_exist:t(6096,e.DiagnosticCategory.Message,"File_0_does_not_exist_6096","File '{0}' does not exist."),File_0_exist_use_it_as_a_name_resolution_result:t(6097,e.DiagnosticCategory.Message,"File_0_exist_use_it_as_a_name_resolution_result_6097","File '{0}' exist - use it as a name resolution result."),Loading_module_0_from_node_modules_folder_target_file_type_1:t(6098,e.DiagnosticCategory.Message,"Loading_module_0_from_node_modules_folder_target_file_type_1_6098","Loading module '{0}' from 'node_modules' folder, target file type '{1}'."),Found_package_json_at_0:t(6099,e.DiagnosticCategory.Message,"Found_package_json_at_0_6099","Found 'package.json' at '{0}'."),package_json_does_not_have_a_0_field:t(6100,e.DiagnosticCategory.Message,"package_json_does_not_have_a_0_field_6100","'package.json' does not have a '{0}' field."),package_json_has_0_field_1_that_references_2:t(6101,e.DiagnosticCategory.Message,"package_json_has_0_field_1_that_references_2_6101","'package.json' has '{0}' field '{1}' that references '{2}'."),Allow_javascript_files_to_be_compiled:t(6102,e.DiagnosticCategory.Message,"Allow_javascript_files_to_be_compiled_6102","Allow javascript files to be compiled."),Option_0_should_have_array_of_strings_as_a_value:t(6103,e.DiagnosticCategory.Error,"Option_0_should_have_array_of_strings_as_a_value_6103","Option '{0}' should have array of strings as a value."),Checking_if_0_is_the_longest_matching_prefix_for_1_2:t(6104,e.DiagnosticCategory.Message,"Checking_if_0_is_the_longest_matching_prefix_for_1_2_6104","Checking if '{0}' is the longest matching prefix for '{1}' - '{2}'."),Expected_type_of_0_field_in_package_json_to_be_string_got_1:t(6105,e.DiagnosticCategory.Message,"Expected_type_of_0_field_in_package_json_to_be_string_got_1_6105","Expected type of '{0}' field in 'package.json' to be 'string', got '{1}'."),baseUrl_option_is_set_to_0_using_this_value_to_resolve_non_relative_module_name_1:t(6106,e.DiagnosticCategory.Message,"baseUrl_option_is_set_to_0_using_this_value_to_resolve_non_relative_module_name_1_6106","'baseUrl' option is set to '{0}', using this value to resolve non-relative module name '{1}'."),rootDirs_option_is_set_using_it_to_resolve_relative_module_name_0:t(6107,e.DiagnosticCategory.Message,"rootDirs_option_is_set_using_it_to_resolve_relative_module_name_0_6107","'rootDirs' option is set, using it to resolve relative module name '{0}'."),Longest_matching_prefix_for_0_is_1:t(6108,e.DiagnosticCategory.Message,"Longest_matching_prefix_for_0_is_1_6108","Longest matching prefix for '{0}' is '{1}'."),Loading_0_from_the_root_dir_1_candidate_location_2:t(6109,e.DiagnosticCategory.Message,"Loading_0_from_the_root_dir_1_candidate_location_2_6109","Loading '{0}' from the root dir '{1}', candidate location '{2}'."),Trying_other_entries_in_rootDirs:t(6110,e.DiagnosticCategory.Message,"Trying_other_entries_in_rootDirs_6110","Trying other entries in 'rootDirs'."),Module_resolution_using_rootDirs_has_failed:t(6111,e.DiagnosticCategory.Message,"Module_resolution_using_rootDirs_has_failed_6111","Module resolution using 'rootDirs' has failed."),Do_not_emit_use_strict_directives_in_module_output:t(6112,e.DiagnosticCategory.Message,"Do_not_emit_use_strict_directives_in_module_output_6112","Do not emit 'use strict' directives in module output."),Enable_strict_null_checks:t(6113,e.DiagnosticCategory.Message,"Enable_strict_null_checks_6113","Enable strict null checks."),Unknown_option_excludes_Did_you_mean_exclude:t(6114,e.DiagnosticCategory.Error,"Unknown_option_excludes_Did_you_mean_exclude_6114","Unknown option 'excludes'. Did you mean 'exclude'?"),Raise_error_on_this_expressions_with_an_implied_any_type:t(6115,e.DiagnosticCategory.Message,"Raise_error_on_this_expressions_with_an_implied_any_type_6115","Raise error on 'this' expressions with an implied 'any' type."),Resolving_type_reference_directive_0_containing_file_1_root_directory_2:t(6116,e.DiagnosticCategory.Message,"Resolving_type_reference_directive_0_containing_file_1_root_directory_2_6116","======== Resolving type reference directive '{0}', containing file '{1}', root directory '{2}'. ========"),Resolving_using_primary_search_paths:t(6117,e.DiagnosticCategory.Message,"Resolving_using_primary_search_paths_6117","Resolving using primary search paths..."),Resolving_from_node_modules_folder:t(6118,e.DiagnosticCategory.Message,"Resolving_from_node_modules_folder_6118","Resolving from node_modules folder..."),Type_reference_directive_0_was_successfully_resolved_to_1_primary_Colon_2:t(6119,e.DiagnosticCategory.Message,"Type_reference_directive_0_was_successfully_resolved_to_1_primary_Colon_2_6119","======== Type reference directive '{0}' was successfully resolved to '{1}', primary: {2}. ========"),Type_reference_directive_0_was_not_resolved:t(6120,e.DiagnosticCategory.Message,"Type_reference_directive_0_was_not_resolved_6120","======== Type reference directive '{0}' was not resolved. ========"),Resolving_with_primary_search_path_0:t(6121,e.DiagnosticCategory.Message,"Resolving_with_primary_search_path_0_6121","Resolving with primary search path '{0}'."),Root_directory_cannot_be_determined_skipping_primary_search_paths:t(6122,e.DiagnosticCategory.Message,"Root_directory_cannot_be_determined_skipping_primary_search_paths_6122","Root directory cannot be determined, skipping primary search paths."),Resolving_type_reference_directive_0_containing_file_1_root_directory_not_set:t(6123,e.DiagnosticCategory.Message,"Resolving_type_reference_directive_0_containing_file_1_root_directory_not_set_6123","======== Resolving type reference directive '{0}', containing file '{1}', root directory not set. ========"),Type_declaration_files_to_be_included_in_compilation:t(6124,e.DiagnosticCategory.Message,"Type_declaration_files_to_be_included_in_compilation_6124","Type declaration files to be included in compilation."),Looking_up_in_node_modules_folder_initial_location_0:t(6125,e.DiagnosticCategory.Message,"Looking_up_in_node_modules_folder_initial_location_0_6125","Looking up in 'node_modules' folder, initial location '{0}'."),Containing_file_is_not_specified_and_root_directory_cannot_be_determined_skipping_lookup_in_node_modules_folder:t(6126,e.DiagnosticCategory.Message,"Containing_file_is_not_specified_and_root_directory_cannot_be_determined_skipping_lookup_in_node_mod_6126","Containing file is not specified and root directory cannot be determined, skipping lookup in 'node_modules' folder."),Resolving_type_reference_directive_0_containing_file_not_set_root_directory_1:t(6127,e.DiagnosticCategory.Message,"Resolving_type_reference_directive_0_containing_file_not_set_root_directory_1_6127","======== Resolving type reference directive '{0}', containing file not set, root directory '{1}'. ========"),Resolving_type_reference_directive_0_containing_file_not_set_root_directory_not_set:t(6128,e.DiagnosticCategory.Message,"Resolving_type_reference_directive_0_containing_file_not_set_root_directory_not_set_6128","======== Resolving type reference directive '{0}', containing file not set, root directory not set. ========"),Resolving_real_path_for_0_result_1:t(6130,e.DiagnosticCategory.Message,"Resolving_real_path_for_0_result_1_6130","Resolving real path for '{0}', result '{1}'."),Cannot_compile_modules_using_option_0_unless_the_module_flag_is_amd_or_system:t(6131,e.DiagnosticCategory.Error,"Cannot_compile_modules_using_option_0_unless_the_module_flag_is_amd_or_system_6131","Cannot compile modules using option '{0}' unless the '--module' flag is 'amd' or 'system'."),File_name_0_has_a_1_extension_stripping_it:t(6132,e.DiagnosticCategory.Message,"File_name_0_has_a_1_extension_stripping_it_6132","File name '{0}' has a '{1}' extension - stripping it."),_0_is_declared_but_its_value_is_never_read:t(6133,e.DiagnosticCategory.Error,"_0_is_declared_but_its_value_is_never_read_6133","'{0}' is declared but its value is never read."),Report_errors_on_unused_locals:t(6134,e.DiagnosticCategory.Message,"Report_errors_on_unused_locals_6134","Report errors on unused locals."),Report_errors_on_unused_parameters:t(6135,e.DiagnosticCategory.Message,"Report_errors_on_unused_parameters_6135","Report errors on unused parameters."),The_maximum_dependency_depth_to_search_under_node_modules_and_load_JavaScript_files:t(6136,e.DiagnosticCategory.Message,"The_maximum_dependency_depth_to_search_under_node_modules_and_load_JavaScript_files_6136","The maximum dependency depth to search under node_modules and load JavaScript files."),Cannot_import_type_declaration_files_Consider_importing_0_instead_of_1:t(6137,e.DiagnosticCategory.Error,"Cannot_import_type_declaration_files_Consider_importing_0_instead_of_1_6137","Cannot import type declaration files. Consider importing '{0}' instead of '{1}'."),Property_0_is_declared_but_its_value_is_never_read:t(6138,e.DiagnosticCategory.Error,"Property_0_is_declared_but_its_value_is_never_read_6138","Property '{0}' is declared but its value is never read."),Import_emit_helpers_from_tslib:t(6139,e.DiagnosticCategory.Message,"Import_emit_helpers_from_tslib_6139","Import emit helpers from 'tslib'."),Auto_discovery_for_typings_is_enabled_in_project_0_Running_extra_resolution_pass_for_module_1_using_cache_location_2:t(6140,e.DiagnosticCategory.Error,"Auto_discovery_for_typings_is_enabled_in_project_0_Running_extra_resolution_pass_for_module_1_using__6140","Auto discovery for typings is enabled in project '{0}'. Running extra resolution pass for module '{1}' using cache location '{2}'."),Parse_in_strict_mode_and_emit_use_strict_for_each_source_file:t(6141,e.DiagnosticCategory.Message,"Parse_in_strict_mode_and_emit_use_strict_for_each_source_file_6141",'Parse in strict mode and emit "use strict" for each source file.'),Module_0_was_resolved_to_1_but_jsx_is_not_set:t(6142,e.DiagnosticCategory.Error,"Module_0_was_resolved_to_1_but_jsx_is_not_set_6142","Module '{0}' was resolved to '{1}', but '--jsx' is not set."),Module_0_was_resolved_as_locally_declared_ambient_module_in_file_1:t(6144,e.DiagnosticCategory.Message,"Module_0_was_resolved_as_locally_declared_ambient_module_in_file_1_6144","Module '{0}' was resolved as locally declared ambient module in file '{1}'."),Module_0_was_resolved_as_ambient_module_declared_in_1_since_this_file_was_not_modified:t(6145,e.DiagnosticCategory.Message,"Module_0_was_resolved_as_ambient_module_declared_in_1_since_this_file_was_not_modified_6145","Module '{0}' was resolved as ambient module declared in '{1}' since this file was not modified."),Specify_the_JSX_factory_function_to_use_when_targeting_react_JSX_emit_e_g_React_createElement_or_h:t(6146,e.DiagnosticCategory.Message,"Specify_the_JSX_factory_function_to_use_when_targeting_react_JSX_emit_e_g_React_createElement_or_h_6146","Specify the JSX factory function to use when targeting 'react' JSX emit, e.g. 'React.createElement' or 'h'."),Resolution_for_module_0_was_found_in_cache:t(6147,e.DiagnosticCategory.Message,"Resolution_for_module_0_was_found_in_cache_6147","Resolution for module '{0}' was found in cache."),Directory_0_does_not_exist_skipping_all_lookups_in_it:t(6148,e.DiagnosticCategory.Message,"Directory_0_does_not_exist_skipping_all_lookups_in_it_6148","Directory '{0}' does not exist, skipping all lookups in it."),Show_diagnostic_information:t(6149,e.DiagnosticCategory.Message,"Show_diagnostic_information_6149","Show diagnostic information."),Show_verbose_diagnostic_information:t(6150,e.DiagnosticCategory.Message,"Show_verbose_diagnostic_information_6150","Show verbose diagnostic information."),Emit_a_single_file_with_source_maps_instead_of_having_a_separate_file:t(6151,e.DiagnosticCategory.Message,"Emit_a_single_file_with_source_maps_instead_of_having_a_separate_file_6151","Emit a single file with source maps instead of having a separate file."),Emit_the_source_alongside_the_sourcemaps_within_a_single_file_requires_inlineSourceMap_or_sourceMap_to_be_set:t(6152,e.DiagnosticCategory.Message,"Emit_the_source_alongside_the_sourcemaps_within_a_single_file_requires_inlineSourceMap_or_sourceMap__6152","Emit the source alongside the sourcemaps within a single file; requires '--inlineSourceMap' or '--sourceMap' to be set."),Transpile_each_file_as_a_separate_module_similar_to_ts_transpileModule:t(6153,e.DiagnosticCategory.Message,"Transpile_each_file_as_a_separate_module_similar_to_ts_transpileModule_6153","Transpile each file as a separate module (similar to 'ts.transpileModule')."),Print_names_of_generated_files_part_of_the_compilation:t(6154,e.DiagnosticCategory.Message,"Print_names_of_generated_files_part_of_the_compilation_6154","Print names of generated files part of the compilation."),Print_names_of_files_part_of_the_compilation:t(6155,e.DiagnosticCategory.Message,"Print_names_of_files_part_of_the_compilation_6155","Print names of files part of the compilation."),The_locale_used_when_displaying_messages_to_the_user_e_g_en_us:t(6156,e.DiagnosticCategory.Message,"The_locale_used_when_displaying_messages_to_the_user_e_g_en_us_6156","The locale used when displaying messages to the user (e.g. 'en-us')"),Do_not_generate_custom_helper_functions_like_extends_in_compiled_output:t(6157,e.DiagnosticCategory.Message,"Do_not_generate_custom_helper_functions_like_extends_in_compiled_output_6157","Do not generate custom helper functions like '__extends' in compiled output."),Do_not_include_the_default_library_file_lib_d_ts:t(6158,e.DiagnosticCategory.Message,"Do_not_include_the_default_library_file_lib_d_ts_6158","Do not include the default library file (lib.d.ts)."),Do_not_add_triple_slash_references_or_imported_modules_to_the_list_of_compiled_files:t(6159,e.DiagnosticCategory.Message,"Do_not_add_triple_slash_references_or_imported_modules_to_the_list_of_compiled_files_6159","Do not add triple-slash references or imported modules to the list of compiled files."),Deprecated_Use_skipLibCheck_instead_Skip_type_checking_of_default_library_declaration_files:t(6160,e.DiagnosticCategory.Message,"Deprecated_Use_skipLibCheck_instead_Skip_type_checking_of_default_library_declaration_files_6160","[Deprecated] Use '--skipLibCheck' instead. Skip type checking of default library declaration files."),List_of_folders_to_include_type_definitions_from:t(6161,e.DiagnosticCategory.Message,"List_of_folders_to_include_type_definitions_from_6161","List of folders to include type definitions from."),Disable_size_limitations_on_JavaScript_projects:t(6162,e.DiagnosticCategory.Message,"Disable_size_limitations_on_JavaScript_projects_6162","Disable size limitations on JavaScript projects."),The_character_set_of_the_input_files:t(6163,e.DiagnosticCategory.Message,"The_character_set_of_the_input_files_6163","The character set of the input files."),Emit_a_UTF_8_Byte_Order_Mark_BOM_in_the_beginning_of_output_files:t(6164,e.DiagnosticCategory.Message,"Emit_a_UTF_8_Byte_Order_Mark_BOM_in_the_beginning_of_output_files_6164","Emit a UTF-8 Byte Order Mark (BOM) in the beginning of output files."),Do_not_truncate_error_messages:t(6165,e.DiagnosticCategory.Message,"Do_not_truncate_error_messages_6165","Do not truncate error messages."),Output_directory_for_generated_declaration_files:t(6166,e.DiagnosticCategory.Message,"Output_directory_for_generated_declaration_files_6166","Output directory for generated declaration files."),A_series_of_entries_which_re_map_imports_to_lookup_locations_relative_to_the_baseUrl:t(6167,e.DiagnosticCategory.Message,"A_series_of_entries_which_re_map_imports_to_lookup_locations_relative_to_the_baseUrl_6167","A series of entries which re-map imports to lookup locations relative to the 'baseUrl'."),List_of_root_folders_whose_combined_content_represents_the_structure_of_the_project_at_runtime:t(6168,e.DiagnosticCategory.Message,"List_of_root_folders_whose_combined_content_represents_the_structure_of_the_project_at_runtime_6168","List of root folders whose combined content represents the structure of the project at runtime."),Show_all_compiler_options:t(6169,e.DiagnosticCategory.Message,"Show_all_compiler_options_6169","Show all compiler options."),Deprecated_Use_outFile_instead_Concatenate_and_emit_output_to_single_file:t(6170,e.DiagnosticCategory.Message,"Deprecated_Use_outFile_instead_Concatenate_and_emit_output_to_single_file_6170","[Deprecated] Use '--outFile' instead. Concatenate and emit output to single file"),Command_line_Options:t(6171,e.DiagnosticCategory.Message,"Command_line_Options_6171","Command-line Options"),Basic_Options:t(6172,e.DiagnosticCategory.Message,"Basic_Options_6172","Basic Options"),Strict_Type_Checking_Options:t(6173,e.DiagnosticCategory.Message,"Strict_Type_Checking_Options_6173","Strict Type-Checking Options"),Module_Resolution_Options:t(6174,e.DiagnosticCategory.Message,"Module_Resolution_Options_6174","Module Resolution Options"),Source_Map_Options:t(6175,e.DiagnosticCategory.Message,"Source_Map_Options_6175","Source Map Options"),Additional_Checks:t(6176,e.DiagnosticCategory.Message,"Additional_Checks_6176","Additional Checks"),Experimental_Options:t(6177,e.DiagnosticCategory.Message,"Experimental_Options_6177","Experimental Options"),Advanced_Options:t(6178,e.DiagnosticCategory.Message,"Advanced_Options_6178","Advanced Options"),Provide_full_support_for_iterables_in_for_of_spread_and_destructuring_when_targeting_ES5_or_ES3:t(6179,e.DiagnosticCategory.Message,"Provide_full_support_for_iterables_in_for_of_spread_and_destructuring_when_targeting_ES5_or_ES3_6179","Provide full support for iterables in 'for-of', spread, and destructuring when targeting 'ES5' or 'ES3'."),Enable_all_strict_type_checking_options:t(6180,e.DiagnosticCategory.Message,"Enable_all_strict_type_checking_options_6180","Enable all strict type-checking options."),List_of_language_service_plugins:t(6181,e.DiagnosticCategory.Message,"List_of_language_service_plugins_6181","List of language service plugins."),Scoped_package_detected_looking_in_0:t(6182,e.DiagnosticCategory.Message,"Scoped_package_detected_looking_in_0_6182","Scoped package detected, looking in '{0}'"),Reusing_resolution_of_module_0_to_file_1_from_old_program:t(6183,e.DiagnosticCategory.Message,"Reusing_resolution_of_module_0_to_file_1_from_old_program_6183","Reusing resolution of module '{0}' to file '{1}' from old program."),Reusing_module_resolutions_originating_in_0_since_resolutions_are_unchanged_from_old_program:t(6184,e.DiagnosticCategory.Message,"Reusing_module_resolutions_originating_in_0_since_resolutions_are_unchanged_from_old_program_6184","Reusing module resolutions originating in '{0}' since resolutions are unchanged from old program."),Disable_strict_checking_of_generic_signatures_in_function_types:t(6185,e.DiagnosticCategory.Message,"Disable_strict_checking_of_generic_signatures_in_function_types_6185","Disable strict checking of generic signatures in function types."),Enable_strict_checking_of_function_types:t(6186,e.DiagnosticCategory.Message,"Enable_strict_checking_of_function_types_6186","Enable strict checking of function types."),Variable_0_implicitly_has_an_1_type:t(7005,e.DiagnosticCategory.Error,"Variable_0_implicitly_has_an_1_type_7005","Variable '{0}' implicitly has an '{1}' type."),Parameter_0_implicitly_has_an_1_type:t(7006,e.DiagnosticCategory.Error,"Parameter_0_implicitly_has_an_1_type_7006","Parameter '{0}' implicitly has an '{1}' type."),Member_0_implicitly_has_an_1_type:t(7008,e.DiagnosticCategory.Error,"Member_0_implicitly_has_an_1_type_7008","Member '{0}' implicitly has an '{1}' type."),new_expression_whose_target_lacks_a_construct_signature_implicitly_has_an_any_type:t(7009,e.DiagnosticCategory.Error,"new_expression_whose_target_lacks_a_construct_signature_implicitly_has_an_any_type_7009","'new' expression, whose target lacks a construct signature, implicitly has an 'any' type."),_0_which_lacks_return_type_annotation_implicitly_has_an_1_return_type:t(7010,e.DiagnosticCategory.Error,"_0_which_lacks_return_type_annotation_implicitly_has_an_1_return_type_7010","'{0}', which lacks return-type annotation, implicitly has an '{1}' return type."),Function_expression_which_lacks_return_type_annotation_implicitly_has_an_0_return_type:t(7011,e.DiagnosticCategory.Error,"Function_expression_which_lacks_return_type_annotation_implicitly_has_an_0_return_type_7011","Function expression, which lacks return-type annotation, implicitly has an '{0}' return type."),Construct_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type:t(7013,e.DiagnosticCategory.Error,"Construct_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type_7013","Construct signature, which lacks return-type annotation, implicitly has an 'any' return type."),Element_implicitly_has_an_any_type_because_index_expression_is_not_of_type_number:t(7015,e.DiagnosticCategory.Error,"Element_implicitly_has_an_any_type_because_index_expression_is_not_of_type_number_7015","Element implicitly has an 'any' type because index expression is not of type 'number'."),Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type:t(7016,e.DiagnosticCategory.Error,"Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type_7016","Could not find a declaration file for module '{0}'. '{1}' implicitly has an 'any' type."),Element_implicitly_has_an_any_type_because_type_0_has_no_index_signature:t(7017,e.DiagnosticCategory.Error,"Element_implicitly_has_an_any_type_because_type_0_has_no_index_signature_7017","Element implicitly has an 'any' type because type '{0}' has no index signature."),Object_literal_s_property_0_implicitly_has_an_1_type:t(7018,e.DiagnosticCategory.Error,"Object_literal_s_property_0_implicitly_has_an_1_type_7018","Object literal's property '{0}' implicitly has an '{1}' type."),Rest_parameter_0_implicitly_has_an_any_type:t(7019,e.DiagnosticCategory.Error,"Rest_parameter_0_implicitly_has_an_any_type_7019","Rest parameter '{0}' implicitly has an 'any[]' type."),Call_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type:t(7020,e.DiagnosticCategory.Error,"Call_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type_7020","Call signature, which lacks return-type annotation, implicitly has an 'any' return type."),_0_implicitly_has_type_any_because_it_does_not_have_a_type_annotation_and_is_referenced_directly_or_indirectly_in_its_own_initializer:t(7022,e.DiagnosticCategory.Error,"_0_implicitly_has_type_any_because_it_does_not_have_a_type_annotation_and_is_referenced_directly_or__7022","'{0}' implicitly has type 'any' because it does not have a type annotation and is referenced directly or indirectly in its own initializer."),_0_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_referenced_directly_or_indirectly_in_one_of_its_return_expressions:t(7023,e.DiagnosticCategory.Error,"_0_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_reference_7023","'{0}' implicitly has return type 'any' because it does not have a return type annotation and is referenced directly or indirectly in one of its return expressions."),Function_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_referenced_directly_or_indirectly_in_one_of_its_return_expressions:t(7024,e.DiagnosticCategory.Error,"Function_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_ref_7024","Function implicitly has return type 'any' because it does not have a return type annotation and is referenced directly or indirectly in one of its return expressions."),Generator_implicitly_has_type_0_because_it_does_not_yield_any_values_Consider_supplying_a_return_type:t(7025,e.DiagnosticCategory.Error,"Generator_implicitly_has_type_0_because_it_does_not_yield_any_values_Consider_supplying_a_return_typ_7025","Generator implicitly has type '{0}' because it does not yield any values. Consider supplying a return type."),JSX_element_implicitly_has_type_any_because_no_interface_JSX_0_exists:t(7026,e.DiagnosticCategory.Error,"JSX_element_implicitly_has_type_any_because_no_interface_JSX_0_exists_7026","JSX element implicitly has type 'any' because no interface 'JSX.{0}' exists."),Unreachable_code_detected:t(7027,e.DiagnosticCategory.Error,"Unreachable_code_detected_7027","Unreachable code detected."),Unused_label:t(7028,e.DiagnosticCategory.Error,"Unused_label_7028","Unused label."),Fallthrough_case_in_switch:t(7029,e.DiagnosticCategory.Error,"Fallthrough_case_in_switch_7029","Fallthrough case in switch."),Not_all_code_paths_return_a_value:t(7030,e.DiagnosticCategory.Error,"Not_all_code_paths_return_a_value_7030","Not all code paths return a value."),Binding_element_0_implicitly_has_an_1_type:t(7031,e.DiagnosticCategory.Error,"Binding_element_0_implicitly_has_an_1_type_7031","Binding element '{0}' implicitly has an '{1}' type."),Property_0_implicitly_has_type_any_because_its_set_accessor_lacks_a_parameter_type_annotation:t(7032,e.DiagnosticCategory.Error,"Property_0_implicitly_has_type_any_because_its_set_accessor_lacks_a_parameter_type_annotation_7032","Property '{0}' implicitly has type 'any', because its set accessor lacks a parameter type annotation."),Property_0_implicitly_has_type_any_because_its_get_accessor_lacks_a_return_type_annotation:t(7033,e.DiagnosticCategory.Error,"Property_0_implicitly_has_type_any_because_its_get_accessor_lacks_a_return_type_annotation_7033","Property '{0}' implicitly has type 'any', because its get accessor lacks a return type annotation."),Variable_0_implicitly_has_type_1_in_some_locations_where_its_type_cannot_be_determined:t(7034,e.DiagnosticCategory.Error,"Variable_0_implicitly_has_type_1_in_some_locations_where_its_type_cannot_be_determined_7034","Variable '{0}' implicitly has type '{1}' in some locations where its type cannot be determined."),Try_npm_install_types_Slash_0_if_it_exists_or_add_a_new_declaration_d_ts_file_containing_declare_module_0:t(7035,e.DiagnosticCategory.Error,"Try_npm_install_types_Slash_0_if_it_exists_or_add_a_new_declaration_d_ts_file_containing_declare_mod_7035","Try `npm install @types/{0}` if it exists or add a new declaration (.d.ts) file containing `declare module '{0}';`"),Dynamic_import_s_specifier_must_be_of_type_string_but_here_has_type_0:t(7036,e.DiagnosticCategory.Error,"Dynamic_import_s_specifier_must_be_of_type_string_but_here_has_type_0_7036","Dynamic import's specifier must be of type 'string', but here has type '{0}'."),You_cannot_rename_this_element:t(8e3,e.DiagnosticCategory.Error,"You_cannot_rename_this_element_8000","You cannot rename this element."),You_cannot_rename_elements_that_are_defined_in_the_standard_TypeScript_library:t(8001,e.DiagnosticCategory.Error,"You_cannot_rename_elements_that_are_defined_in_the_standard_TypeScript_library_8001","You cannot rename elements that are defined in the standard TypeScript library."),import_can_only_be_used_in_a_ts_file:t(8002,e.DiagnosticCategory.Error,"import_can_only_be_used_in_a_ts_file_8002","'import ... =' can only be used in a .ts file."),export_can_only_be_used_in_a_ts_file:t(8003,e.DiagnosticCategory.Error,"export_can_only_be_used_in_a_ts_file_8003","'export=' can only be used in a .ts file."),type_parameter_declarations_can_only_be_used_in_a_ts_file:t(8004,e.DiagnosticCategory.Error,"type_parameter_declarations_can_only_be_used_in_a_ts_file_8004","'type parameter declarations' can only be used in a .ts file."),implements_clauses_can_only_be_used_in_a_ts_file:t(8005,e.DiagnosticCategory.Error,"implements_clauses_can_only_be_used_in_a_ts_file_8005","'implements clauses' can only be used in a .ts file."),interface_declarations_can_only_be_used_in_a_ts_file:t(8006,e.DiagnosticCategory.Error,"interface_declarations_can_only_be_used_in_a_ts_file_8006","'interface declarations' can only be used in a .ts file."),module_declarations_can_only_be_used_in_a_ts_file:t(8007,e.DiagnosticCategory.Error,"module_declarations_can_only_be_used_in_a_ts_file_8007","'module declarations' can only be used in a .ts file."),type_aliases_can_only_be_used_in_a_ts_file:t(8008,e.DiagnosticCategory.Error,"type_aliases_can_only_be_used_in_a_ts_file_8008","'type aliases' can only be used in a .ts file."),_0_can_only_be_used_in_a_ts_file:t(8009,e.DiagnosticCategory.Error,"_0_can_only_be_used_in_a_ts_file_8009","'{0}' can only be used in a .ts file."),types_can_only_be_used_in_a_ts_file:t(8010,e.DiagnosticCategory.Error,"types_can_only_be_used_in_a_ts_file_8010","'types' can only be used in a .ts file."),type_arguments_can_only_be_used_in_a_ts_file:t(8011,e.DiagnosticCategory.Error,"type_arguments_can_only_be_used_in_a_ts_file_8011","'type arguments' can only be used in a .ts file."),parameter_modifiers_can_only_be_used_in_a_ts_file:t(8012,e.DiagnosticCategory.Error,"parameter_modifiers_can_only_be_used_in_a_ts_file_8012","'parameter modifiers' can only be used in a .ts file."),non_null_assertions_can_only_be_used_in_a_ts_file:t(8013,e.DiagnosticCategory.Error,"non_null_assertions_can_only_be_used_in_a_ts_file_8013","'non-null assertions' can only be used in a .ts file."),enum_declarations_can_only_be_used_in_a_ts_file:t(8015,e.DiagnosticCategory.Error,"enum_declarations_can_only_be_used_in_a_ts_file_8015","'enum declarations' can only be used in a .ts file."),type_assertion_expressions_can_only_be_used_in_a_ts_file:t(8016,e.DiagnosticCategory.Error,"type_assertion_expressions_can_only_be_used_in_a_ts_file_8016","'type assertion expressions' can only be used in a .ts file."),Octal_literal_types_must_use_ES2015_syntax_Use_the_syntax_0:t(8017,e.DiagnosticCategory.Error,"Octal_literal_types_must_use_ES2015_syntax_Use_the_syntax_0_8017","Octal literal types must use ES2015 syntax. Use the syntax '{0}'."),Octal_literals_are_not_allowed_in_enums_members_initializer_Use_the_syntax_0:t(8018,e.DiagnosticCategory.Error,"Octal_literals_are_not_allowed_in_enums_members_initializer_Use_the_syntax_0_8018","Octal literals are not allowed in enums members initializer. Use the syntax '{0}'."),Report_errors_in_js_files:t(8019,e.DiagnosticCategory.Message,"Report_errors_in_js_files_8019","Report errors in .js files."),JSDoc_types_can_only_be_used_inside_documentation_comments:t(8020,e.DiagnosticCategory.Error,"JSDoc_types_can_only_be_used_inside_documentation_comments_8020","JSDoc types can only be used inside documentation comments."),JSDoc_typedef_tag_should_either_have_a_type_annotation_or_be_followed_by_property_or_member_tags:t(8021,e.DiagnosticCategory.Error,"JSDoc_typedef_tag_should_either_have_a_type_annotation_or_be_followed_by_property_or_member_tags_8021","JSDoc '@typedef' tag should either have a type annotation or be followed by '@property' or '@member' tags."),JSDoc_0_is_not_attached_to_a_class:t(8022,e.DiagnosticCategory.Error,"JSDoc_0_is_not_attached_to_a_class_8022","JSDoc '@{0}' is not attached to a class."),JSDoc_0_1_does_not_match_the_extends_2_clause:t(8023,e.DiagnosticCategory.Error,"JSDoc_0_1_does_not_match_the_extends_2_clause_8023","JSDoc '@{0} {1}' does not match the 'extends {2}' clause."),JSDoc_param_tag_has_name_0_but_there_is_no_parameter_with_that_name:t(8024,e.DiagnosticCategory.Error,"JSDoc_param_tag_has_name_0_but_there_is_no_parameter_with_that_name_8024","JSDoc '@param' tag has name '{0}', but there is no parameter with that name."),Class_declarations_cannot_have_more_than_one_augments_or_extends_tag:t(8025,e.DiagnosticCategory.Error,"Class_declarations_cannot_have_more_than_one_augments_or_extends_tag_8025","Class declarations cannot have more than one `@augments` or `@extends` tag."),Only_identifiers_Slashqualified_names_with_optional_type_arguments_are_currently_supported_in_a_class_extends_clause:t(9002,e.DiagnosticCategory.Error,"Only_identifiers_Slashqualified_names_with_optional_type_arguments_are_currently_supported_in_a_clas_9002","Only identifiers/qualified-names with optional type arguments are currently supported in a class 'extends' clause."),class_expressions_are_not_currently_supported:t(9003,e.DiagnosticCategory.Error,"class_expressions_are_not_currently_supported_9003","'class' expressions are not currently supported."),Language_service_is_disabled:t(9004,e.DiagnosticCategory.Error,"Language_service_is_disabled_9004","Language service is disabled."),JSX_attributes_must_only_be_assigned_a_non_empty_expression:t(17e3,e.DiagnosticCategory.Error,"JSX_attributes_must_only_be_assigned_a_non_empty_expression_17000","JSX attributes must only be assigned a non-empty 'expression'."),JSX_elements_cannot_have_multiple_attributes_with_the_same_name:t(17001,e.DiagnosticCategory.Error,"JSX_elements_cannot_have_multiple_attributes_with_the_same_name_17001","JSX elements cannot have multiple attributes with the same name."),Expected_corresponding_JSX_closing_tag_for_0:t(17002,e.DiagnosticCategory.Error,"Expected_corresponding_JSX_closing_tag_for_0_17002","Expected corresponding JSX closing tag for '{0}'."),JSX_attribute_expected:t(17003,e.DiagnosticCategory.Error,"JSX_attribute_expected_17003","JSX attribute expected."),Cannot_use_JSX_unless_the_jsx_flag_is_provided:t(17004,e.DiagnosticCategory.Error,"Cannot_use_JSX_unless_the_jsx_flag_is_provided_17004","Cannot use JSX unless the '--jsx' flag is provided."),A_constructor_cannot_contain_a_super_call_when_its_class_extends_null:t(17005,e.DiagnosticCategory.Error,"A_constructor_cannot_contain_a_super_call_when_its_class_extends_null_17005","A constructor cannot contain a 'super' call when its class extends 'null'."),An_unary_expression_with_the_0_operator_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_expression_Consider_enclosing_the_expression_in_parentheses:t(17006,e.DiagnosticCategory.Error,"An_unary_expression_with_the_0_operator_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_ex_17006","An unary expression with the '{0}' operator is not allowed in the left-hand side of an exponentiation expression. Consider enclosing the expression in parentheses."),A_type_assertion_expression_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_expression_Consider_enclosing_the_expression_in_parentheses:t(17007,e.DiagnosticCategory.Error,"A_type_assertion_expression_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_expression_Con_17007","A type assertion expression is not allowed in the left-hand side of an exponentiation expression. Consider enclosing the expression in parentheses."),JSX_element_0_has_no_corresponding_closing_tag:t(17008,e.DiagnosticCategory.Error,"JSX_element_0_has_no_corresponding_closing_tag_17008","JSX element '{0}' has no corresponding closing tag."),super_must_be_called_before_accessing_this_in_the_constructor_of_a_derived_class:t(17009,e.DiagnosticCategory.Error,"super_must_be_called_before_accessing_this_in_the_constructor_of_a_derived_class_17009","'super' must be called before accessing 'this' in the constructor of a derived class."),Unknown_type_acquisition_option_0:t(17010,e.DiagnosticCategory.Error,"Unknown_type_acquisition_option_0_17010","Unknown type acquisition option '{0}'."),super_must_be_called_before_accessing_a_property_of_super_in_the_constructor_of_a_derived_class:t(17011,e.DiagnosticCategory.Error,"super_must_be_called_before_accessing_a_property_of_super_in_the_constructor_of_a_derived_class_17011","'super' must be called before accessing a property of 'super' in the constructor of a derived class."),_0_is_not_a_valid_meta_property_for_keyword_1_Did_you_mean_2:t(17012,e.DiagnosticCategory.Error,"_0_is_not_a_valid_meta_property_for_keyword_1_Did_you_mean_2_17012","'{0}' is not a valid meta-property for keyword '{1}'. Did you mean '{2}'?"),Meta_property_0_is_only_allowed_in_the_body_of_a_function_declaration_function_expression_or_constructor:t(17013,e.DiagnosticCategory.Error,"Meta_property_0_is_only_allowed_in_the_body_of_a_function_declaration_function_expression_or_constru_17013","Meta-property '{0}' is only allowed in the body of a function declaration, function expression, or constructor."),Circularity_detected_while_resolving_configuration_Colon_0:t(18e3,e.DiagnosticCategory.Error,"Circularity_detected_while_resolving_configuration_Colon_0_18000","Circularity detected while resolving configuration: {0}"),A_path_in_an_extends_option_must_be_relative_or_rooted_but_0_is_not:t(18001,e.DiagnosticCategory.Error,"A_path_in_an_extends_option_must_be_relative_or_rooted_but_0_is_not_18001","A path in an 'extends' option must be relative or rooted, but '{0}' is not."),The_files_list_in_config_file_0_is_empty:t(18002,e.DiagnosticCategory.Error,"The_files_list_in_config_file_0_is_empty_18002","The 'files' list in config file '{0}' is empty."),No_inputs_were_found_in_config_file_0_Specified_include_paths_were_1_and_exclude_paths_were_2:t(18003,e.DiagnosticCategory.Error,"No_inputs_were_found_in_config_file_0_Specified_include_paths_were_1_and_exclude_paths_were_2_18003","No inputs were found in config file '{0}'. Specified 'include' paths were '{1}' and 'exclude' paths were '{2}'."),Add_missing_super_call:t(90001,e.DiagnosticCategory.Message,"Add_missing_super_call_90001","Add missing 'super()' call."),Make_super_call_the_first_statement_in_the_constructor:t(90002,e.DiagnosticCategory.Message,"Make_super_call_the_first_statement_in_the_constructor_90002","Make 'super()' call the first statement in the constructor."),Change_extends_to_implements:t(90003,e.DiagnosticCategory.Message,"Change_extends_to_implements_90003","Change 'extends' to 'implements'."),Remove_declaration_for_Colon_0:t(90004,e.DiagnosticCategory.Message,"Remove_declaration_for_Colon_0_90004","Remove declaration for: '{0}'."),Implement_interface_0:t(90006,e.DiagnosticCategory.Message,"Implement_interface_0_90006","Implement interface '{0}'."),Implement_inherited_abstract_class:t(90007,e.DiagnosticCategory.Message,"Implement_inherited_abstract_class_90007","Implement inherited abstract class."),Add_this_to_unresolved_variable:t(90008,e.DiagnosticCategory.Message,"Add_this_to_unresolved_variable_90008","Add 'this.' to unresolved variable."),Adding_a_tsconfig_json_file_will_help_organize_projects_that_contain_both_TypeScript_and_JavaScript_files_Learn_more_at_https_Colon_Slash_Slashaka_ms_Slashtsconfig:t(90009,e.DiagnosticCategory.Error,"Adding_a_tsconfig_json_file_will_help_organize_projects_that_contain_both_TypeScript_and_JavaScript__90009","Adding a tsconfig.json file will help organize projects that contain both TypeScript and JavaScript files. Learn more at https://aka.ms/tsconfig."),Type_0_is_not_assignable_to_type_1_Two_different_types_with_this_name_exist_but_they_are_unrelated:t(90010,e.DiagnosticCategory.Error,"Type_0_is_not_assignable_to_type_1_Two_different_types_with_this_name_exist_but_they_are_unrelated_90010","Type '{0}' is not assignable to type '{1}'. Two different types with this name exist, but they are unrelated."),Import_0_from_1:t(90013,e.DiagnosticCategory.Message,"Import_0_from_1_90013","Import '{0}' from \"{1}\"."),Change_0_to_1:t(90014,e.DiagnosticCategory.Message,"Change_0_to_1_90014","Change '{0}' to '{1}'."),Add_0_to_existing_import_declaration_from_1:t(90015,e.DiagnosticCategory.Message,"Add_0_to_existing_import_declaration_from_1_90015","Add '{0}' to existing import declaration from \"{1}\"."),Declare_property_0:t(90016,e.DiagnosticCategory.Message,"Declare_property_0_90016","Declare property '{0}'."),Add_index_signature_for_property_0:t(90017,e.DiagnosticCategory.Message,"Add_index_signature_for_property_0_90017","Add index signature for property '{0}'."),Disable_checking_for_this_file:t(90018,e.DiagnosticCategory.Message,"Disable_checking_for_this_file_90018","Disable checking for this file."),Ignore_this_error_message:t(90019,e.DiagnosticCategory.Message,"Ignore_this_error_message_90019","Ignore this error message."),Initialize_property_0_in_the_constructor:t(90020,e.DiagnosticCategory.Message,"Initialize_property_0_in_the_constructor_90020","Initialize property '{0}' in the constructor."),Initialize_static_property_0:t(90021,e.DiagnosticCategory.Message,"Initialize_static_property_0_90021","Initialize static property '{0}'."),Change_spelling_to_0:t(90022,e.DiagnosticCategory.Message,"Change_spelling_to_0_90022","Change spelling to '{0}'."),Declare_method_0:t(90023,e.DiagnosticCategory.Message,"Declare_method_0_90023","Declare method '{0}'."),Declare_static_method_0:t(90024,e.DiagnosticCategory.Message,"Declare_static_method_0_90024","Declare static method '{0}'."),Prefix_0_with_an_underscore:t(90025,e.DiagnosticCategory.Message,"Prefix_0_with_an_underscore_90025","Prefix '{0}' with an underscore."),Rewrite_as_the_indexed_access_type_0:t(90026,e.DiagnosticCategory.Message,"Rewrite_as_the_indexed_access_type_0_90026","Rewrite as the indexed access type '{0}'."),Declare_static_property_0:t(90027,e.DiagnosticCategory.Message,"Declare_static_property_0_90027","Declare static property '{0}'."),Call_decorator_expression:t(90028,e.DiagnosticCategory.Message,"Call_decorator_expression_90028","Call decorator expression."),Convert_function_to_an_ES2015_class:t(95001,e.DiagnosticCategory.Message,"Convert_function_to_an_ES2015_class_95001","Convert function to an ES2015 class"),Convert_function_0_to_class:t(95002,e.DiagnosticCategory.Message,"Convert_function_0_to_class_95002","Convert function '{0}' to class"),Extract_symbol:t(95003,e.DiagnosticCategory.Message,"Extract_symbol_95003","Extract symbol"),Extract_to_0_in_1:t(95004,e.DiagnosticCategory.Message,"Extract_to_0_in_1_95004","Extract to {0} in {1}"),Extract_function:t(95005,e.DiagnosticCategory.Message,"Extract_function_95005","Extract function"),Extract_constant:t(95006,e.DiagnosticCategory.Message,"Extract_constant_95006","Extract constant"),Extract_to_0_in_enclosing_scope:t(95007,e.DiagnosticCategory.Message,"Extract_to_0_in_enclosing_scope_95007","Extract to {0} in enclosing scope"),Extract_to_0_in_1_scope:t(95008,e.DiagnosticCategory.Message,"Extract_to_0_in_1_scope_95008","Extract to {0} in {1} scope"),Annotate_with_type_from_JSDoc:t(95009,e.DiagnosticCategory.Message,"Annotate_with_type_from_JSDoc_95009","Annotate with type from JSDoc"),Annotate_with_types_from_JSDoc:t(95010,e.DiagnosticCategory.Message,"Annotate_with_types_from_JSDoc_95010","Annotate with types from JSDoc"),Infer_type_of_0_from_usage:t(95011,e.DiagnosticCategory.Message,"Infer_type_of_0_from_usage_95011","Infer type of '{0}' from usage."),Infer_parameter_types_from_usage:t(95012,e.DiagnosticCategory.Message,"Infer_parameter_types_from_usage_95012","Infer parameter types from usage.")}})(ts=ts||{}),(P=>{function e(e){return 71<=e}P.tokenIsIdentifierOrKeyword=e;var M=P.createMapFromTemplate({abstract:117,any:119,as:118,boolean:122,break:72,case:73,catch:74,class:75,continue:77,const:76,constructor:123,debugger:78,declare:124,default:79,delete:80,do:81,else:82,enum:83,export:84,extends:85,false:86,finally:87,for:88,from:140,function:89,get:125,if:90,implements:108,import:91,in:92,instanceof:93,interface:109,is:126,keyof:127,let:110,module:128,namespace:129,never:130,new:94,null:95,number:133,object:134,package:111,private:112,protected:113,public:114,readonly:131,require:132,global:141,return:96,set:135,static:115,string:136,super:97,switch:98,symbol:137,this:99,throw:100,true:101,try:102,type:138,typeof:103,undefined:139,var:104,void:105,while:106,with:107,yield:116,async:120,await:121,of:142,"{":17,"}":18,"(":19,")":20,"[":21,"]":22,".":23,"...":24,";":25,",":26,"<":27,">":29,"<=":30,">=":31,"==":32,"!=":33,"===":34,"!==":35,"=>":36,"+":37,"-":38,"**":40,"*":39,"/":41,"%":42,"++":43,"--":44,"<<":45,"</":28,">>":46,">>>":47,"&":48,"|":49,"^":50,"!":51,"~":52,"&&":53,"||":54,"?":55,":":56,"=":58,"+=":59,"-=":60,"*=":61,"**=":62,"/=":63,"%=":64,"<<=":65,">>=":66,">>>=":67,"&=":68,"|=":69,"^=":70,"@":57}),r=[170,170,181,181,186,186,192,214,216,246,248,543,546,563,592,685,688,696,699,705,720,721,736,740,750,750,890,890,902,902,904,906,908,908,910,929,931,974,976,983,986,1011,1024,1153,1164,1220,1223,1224,1227,1228,1232,1269,1272,1273,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1569,1594,1600,1610,1649,1747,1749,1749,1765,1766,1786,1788,1808,1808,1810,1836,1920,1957,2309,2361,2365,2365,2384,2384,2392,2401,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2699,2701,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2784,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2870,2873,2877,2877,2908,2909,2911,2913,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,2997,2999,3001,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3294,3294,3296,3297,3333,3340,3342,3344,3346,3368,3370,3385,3424,3425,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3805,3840,3840,3904,3911,3913,3946,3976,3979,4096,4129,4131,4135,4137,4138,4176,4181,4256,4293,4304,4342,4352,4441,4447,4514,4520,4601,4608,4614,4616,4678,4680,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4742,4744,4744,4746,4749,4752,4782,4784,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4814,4816,4822,4824,4846,4848,4878,4880,4880,4882,4885,4888,4894,4896,4934,4936,4954,5024,5108,5121,5740,5743,5750,5761,5786,5792,5866,6016,6067,6176,6263,6272,6312,7680,7835,7840,7929,7936,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8319,8319,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8497,8499,8505,8544,8579,12293,12295,12321,12329,12337,12341,12344,12346,12353,12436,12445,12446,12449,12538,12540,12542,12549,12588,12593,12686,12704,12727,13312,19893,19968,40869,40960,42124,44032,55203,63744,64045,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65138,65140,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500],n=[170,170,181,181,186,186,192,214,216,246,248,543,546,563,592,685,688,696,699,705,720,721,736,740,750,750,768,846,864,866,890,890,902,902,904,906,908,908,910,929,931,974,976,983,986,1011,1024,1153,1155,1158,1164,1220,1223,1224,1227,1228,1232,1269,1272,1273,1329,1366,1369,1369,1377,1415,1425,1441,1443,1465,1467,1469,1471,1471,1473,1474,1476,1476,1488,1514,1520,1522,1569,1594,1600,1621,1632,1641,1648,1747,1749,1756,1759,1768,1770,1773,1776,1788,1808,1836,1840,1866,1920,1968,2305,2307,2309,2361,2364,2381,2384,2388,2392,2403,2406,2415,2433,2435,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2492,2492,2494,2500,2503,2504,2507,2509,2519,2519,2524,2525,2527,2531,2534,2545,2562,2562,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2620,2620,2622,2626,2631,2632,2635,2637,2649,2652,2654,2654,2662,2676,2689,2691,2693,2699,2701,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2748,2757,2759,2761,2763,2765,2768,2768,2784,2784,2790,2799,2817,2819,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2870,2873,2876,2883,2887,2888,2891,2893,2902,2903,2908,2909,2911,2913,2918,2927,2946,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,2997,2999,3001,3006,3010,3014,3016,3018,3021,3031,3031,3047,3055,3073,3075,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3134,3140,3142,3144,3146,3149,3157,3158,3168,3169,3174,3183,3202,3203,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3262,3268,3270,3272,3274,3277,3285,3286,3294,3294,3296,3297,3302,3311,3330,3331,3333,3340,3342,3344,3346,3368,3370,3385,3390,3395,3398,3400,3402,3405,3415,3415,3424,3425,3430,3439,3458,3459,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3530,3530,3535,3540,3542,3542,3544,3551,3570,3571,3585,3642,3648,3662,3664,3673,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3769,3771,3773,3776,3780,3782,3782,3784,3789,3792,3801,3804,3805,3840,3840,3864,3865,3872,3881,3893,3893,3895,3895,3897,3897,3902,3911,3913,3946,3953,3972,3974,3979,3984,3991,3993,4028,4038,4038,4096,4129,4131,4135,4137,4138,4140,4146,4150,4153,4160,4169,4176,4185,4256,4293,4304,4342,4352,4441,4447,4514,4520,4601,4608,4614,4616,4678,4680,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4742,4744,4744,4746,4749,4752,4782,4784,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4814,4816,4822,4824,4846,4848,4878,4880,4880,4882,4885,4888,4894,4896,4934,4936,4954,4969,4977,5024,5108,5121,5740,5743,5750,5761,5786,5792,5866,6016,6099,6112,6121,6160,6169,6176,6263,6272,6313,7680,7835,7840,7929,7936,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8255,8256,8319,8319,8400,8412,8417,8417,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8497,8499,8505,8544,8579,12293,12295,12321,12335,12337,12341,12344,12346,12353,12436,12441,12442,12445,12446,12449,12542,12549,12588,12593,12686,12704,12727,13312,19893,19968,40869,40960,42124,44032,55203,63744,64045,64256,64262,64275,64279,64285,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65056,65059,65075,65076,65101,65103,65136,65138,65140,65140,65142,65276,65296,65305,65313,65338,65343,65343,65345,65370,65381,65470,65474,65479,65482,65487,65490,65495,65498,65500],i=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,880,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1162,1319,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1568,1610,1646,1647,1649,1747,1749,1749,1765,1766,1774,1775,1786,1788,1791,1791,1808,1808,1810,1839,1869,1957,1969,1969,1994,2026,2036,2037,2042,2042,2048,2069,2074,2074,2084,2084,2088,2088,2112,2136,2208,2208,2210,2220,2308,2361,2365,2365,2384,2384,2392,2401,2417,2423,2425,2431,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2493,2493,2510,2510,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2785,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2877,2877,2908,2909,2911,2913,2929,2929,2947,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3024,3024,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3133,3160,3161,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3261,3261,3294,3294,3296,3297,3313,3314,3333,3340,3342,3344,3346,3386,3389,3389,3406,3406,3424,3425,3450,3455,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3807,3840,3840,3904,3911,3913,3948,3976,3980,4096,4138,4159,4159,4176,4181,4186,4189,4193,4193,4197,4198,4206,4208,4213,4225,4238,4238,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5905,5920,5937,5952,5969,5984,5996,5998,6e3,6016,6067,6103,6103,6108,6108,6176,6263,6272,6312,6314,6314,6320,6389,6400,6428,6480,6509,6512,6516,6528,6571,6593,6599,6656,6678,6688,6740,6823,6823,6917,6963,6981,6987,7043,7072,7086,7087,7098,7141,7168,7203,7245,7247,7258,7293,7401,7404,7406,7409,7413,7414,7424,7615,7680,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8305,8305,8319,8319,8336,8348,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11502,11506,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11648,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11823,11823,12293,12295,12321,12329,12337,12341,12344,12348,12353,12438,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42527,42538,42539,42560,42606,42623,42647,42656,42735,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43009,43011,43013,43015,43018,43020,43042,43072,43123,43138,43187,43250,43255,43259,43259,43274,43301,43312,43334,43360,43388,43396,43442,43471,43471,43520,43560,43584,43586,43588,43595,43616,43638,43642,43642,43648,43695,43697,43697,43701,43702,43705,43709,43712,43712,43714,43714,43739,43741,43744,43754,43762,43764,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44002,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500],s=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,768,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1155,1159,1162,1319,1329,1366,1369,1369,1377,1415,1425,1469,1471,1471,1473,1474,1476,1477,1479,1479,1488,1514,1520,1522,1552,1562,1568,1641,1646,1747,1749,1756,1759,1768,1770,1788,1791,1791,1808,1866,1869,1969,1984,2037,2042,2042,2048,2093,2112,2139,2208,2208,2210,2220,2276,2302,2304,2403,2406,2415,2417,2423,2425,2431,2433,2435,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2492,2500,2503,2504,2507,2510,2519,2519,2524,2525,2527,2531,2534,2545,2561,2563,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2620,2620,2622,2626,2631,2632,2635,2637,2641,2641,2649,2652,2654,2654,2662,2677,2689,2691,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2748,2757,2759,2761,2763,2765,2768,2768,2784,2787,2790,2799,2817,2819,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2876,2884,2887,2888,2891,2893,2902,2903,2908,2909,2911,2915,2918,2927,2929,2929,2946,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3006,3010,3014,3016,3018,3021,3024,3024,3031,3031,3046,3055,3073,3075,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3140,3142,3144,3146,3149,3157,3158,3160,3161,3168,3171,3174,3183,3202,3203,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3260,3268,3270,3272,3274,3277,3285,3286,3294,3294,3296,3299,3302,3311,3313,3314,3330,3331,3333,3340,3342,3344,3346,3386,3389,3396,3398,3400,3402,3406,3415,3415,3424,3427,3430,3439,3450,3455,3458,3459,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3530,3530,3535,3540,3542,3542,3544,3551,3570,3571,3585,3642,3648,3662,3664,3673,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3769,3771,3773,3776,3780,3782,3782,3784,3789,3792,3801,3804,3807,3840,3840,3864,3865,3872,3881,3893,3893,3895,3895,3897,3897,3902,3911,3913,3948,3953,3972,3974,3991,3993,4028,4038,4038,4096,4169,4176,4253,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4957,4959,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5908,5920,5940,5952,5971,5984,5996,5998,6e3,6002,6003,6016,6099,6103,6103,6108,6109,6112,6121,6155,6157,6160,6169,6176,6263,6272,6314,6320,6389,6400,6428,6432,6443,6448,6459,6470,6509,6512,6516,6528,6571,6576,6601,6608,6617,6656,6683,6688,6750,6752,6780,6783,6793,6800,6809,6823,6823,6912,6987,6992,7001,7019,7027,7040,7155,7168,7223,7232,7241,7245,7293,7376,7378,7380,7414,7424,7654,7676,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8204,8205,8255,8256,8276,8276,8305,8305,8319,8319,8336,8348,8400,8412,8417,8417,8421,8432,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11647,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11744,11775,11823,11823,12293,12295,12321,12335,12337,12341,12344,12348,12353,12438,12441,12442,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42539,42560,42607,42612,42621,42623,42647,42655,42737,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43047,43072,43123,43136,43204,43216,43225,43232,43255,43259,43259,43264,43309,43312,43347,43360,43388,43392,43456,43471,43481,43520,43574,43584,43597,43600,43609,43616,43638,43642,43643,43648,43714,43739,43741,43744,43759,43762,43766,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44010,44012,44013,44016,44025,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65024,65039,65056,65062,65075,65076,65101,65103,65136,65140,65142,65276,65296,65305,65313,65338,65343,65343,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500];function a(e,t){if(!(e<t[0]))for(var r,n=0,i=t.length;n+1<i;){if(r=n+(i-n)/2,t[r-=r%2]<=e&&e<=t[1+r])return!0;e<t[r]?i=r:n=2+r}return!1}function o(e,t){return a(e,1<=t?i:r)}P.isUnicodeIdentifierStart=o,l=[],M.forEach(function(e,t){l[e]=t});var l,t=l;function c(e){for(var t=new Array,r=0,n=0;r<e.length;){var i=e.charCodeAt(r);switch(r++,i){case 13:10===e.charCodeAt(r)&&r++;case 10:t.push(n),n=r;break;default:127<i&&$(i)&&(t.push(n),n=r)}}return t.push(n),t}function u(e,t,r,n){P.Debug.assert(0<=t&&t<e.length);r=e[t]+r;return t<e.length-1?P.Debug.assert(r<e[t+1]):void 0!==n&&P.Debug.assert(r<=n.length),r}function d(e){return e.lineMap||(e.lineMap=c(e.text))}function p(e,t){var r=P.binarySearch(e,t);return r<0&&P.Debug.assert(-1!==(r=~r-1),"position cannot precede the beginning of the file"),{line:r,character:t-e[r]}}function F(e){return B(e)||$(e)}function B(e){return 32===e||9===e||11===e||12===e||160===e||133===e||5760===e||8192<=e&&e<=8203||8239===e||8287===e||12288===e||65279===e}function $(e){return 10===e||13===e||8232===e||8233===e}function U(e){return 48<=e&&e<=57}function V(e){return 48<=e&&e<=55}P.tokenToString=function(e){return t[e]},P.stringToToken=function(e){return M.get(e)},P.computeLineStarts=c,P.getPositionOfLineAndCharacter=function(e,t,r){return u(d(e),t,r,e.text)},P.computePositionOfLineAndCharacter=u,P.getLineStarts=d,P.computeLineAndCharacterOfPosition=p,P.getLineAndCharacterOfPosition=function(e,t){return p(d(e),t)},P.isWhiteSpaceLike=F,P.isWhiteSpaceSingleLine=B,P.isLineBreak=$,P.isOctalDigit=V,P.couldStartTrivia=function(e,t){var r=e.charCodeAt(t);switch(r){case 13:case 10:case 9:case 11:case 12:case 32:case 47:case 60:case 124:case 61:case 62:return!0;case 35:return 0===t;default:return 127<r}},P.skipTrivia=function(e,t,r,n){if(void 0===n&&(n=!1),P.positionIsSynthesized(t))return t;for(;;){var i=e.charCodeAt(t);switch(i){case 13:10===e.charCodeAt(t+1)&&t++;case 10:if(t++,r)return t;continue;case 9:case 11:case 12:case 32:t++;continue;case 47:if(n)break;if(47===e.charCodeAt(t+1)){for(t+=2;t<e.length&&!$(e.charCodeAt(t));)t++;continue}if(42!==e.charCodeAt(t+1))break;for(t+=2;t<e.length;){if(42===e.charCodeAt(t)&&47===e.charCodeAt(t+1)){t+=2;break}t++}continue;case 60:case 124:case 61:case 62:if(H(e,t)){t=G(e,t);continue}break;case 35:if(0===t&&j(e,t)){t=K(e,t);continue}break;default:if(127<i&&F(i)){t++;continue}}return t}};var h="<<<<<<<".length;function H(e,t){if(P.Debug.assert(0<=t),0===t||$(e.charCodeAt(t-1))){var r=e.charCodeAt(t);if(t+h<e.length){for(var n=0;n<h;n++)if(e.charCodeAt(t+n)!==r)return;return 61===r||32===e.charCodeAt(t+h)}}}function G(e,t,r){r&&r(P.Diagnostics.Merge_conflict_marker_encountered,h);var n=e.charCodeAt(t),i=e.length;if(60===n||62===n)for(;t<i&&!$(e.charCodeAt(t));)t++;else for(P.Debug.assert(124===n||61===n);t<i;){var s=e.charCodeAt(t);if((61===s||62===s)&&s!==n&&H(e,t))break;t++}return t}var m=/^#!.*/;function j(e,t){return P.Debug.assert(0===t),m.test(e)}function K(e,t){return t+=m.exec(e)[0].length}function g(e,t,r,n,i,s,a){var o,l,c,u,d=!1,p=n||0===r,h=a;e:for(;0<=r&&r<t.length;){var m=t.charCodeAt(r);switch(m){case 13:10===t.charCodeAt(r+1)&&r++;case 10:if(r++,n)break e;p=!0,d&&(u=!0);continue;case 9:case 11:case 12:case 32:r++;continue;case 47:var g=t.charCodeAt(r+1),f=!1;if(47!==g&&42!==g)break e;var _=47===g?2:3,y=r;if(r+=2,47===g)for(;r<t.length;){if($(t.charCodeAt(r))){f=!0;break}r++}else for(;r<t.length;){if(42===t.charCodeAt(r)&&47===t.charCodeAt(r+1)){r+=2;break}r++}if(p){if(d){if(h=i(o,l,c,u,s,h),!e&&h)return h;d=!1}o=y,l=r,c=_,u=f,d=!0}continue;default:if(127<m&&F(m)){d&&$(m)&&(u=!0),r++;continue}break e}}return h=d?i(o,l,c,u,s,h):h}function f(e,t,r,n,i){return g(!0,e,t,!1,r,n,i)}function _(e,t,r,n,i){return g(!0,e,t,!0,r,n,i)}function y(e,t,r,n,i,s){return(s=s||[]).push({kind:r,pos:e,end:t,hasTrailingNewLine:n}),s}function z(e,t){return 65<=e&&e<=90||97<=e&&e<=122||36===e||95===e||127<e&&o(e,t)}function W(e,t){return 65<=e&&e<=90||97<=e&&e<=122||48<=e&&e<=57||36===e||95===e||127<e&&a(e,1<=t?s:n)}P.forEachLeadingCommentRange=function(e,t,r,n){return g(!1,e,t,!1,r,n)},P.forEachTrailingCommentRange=function(e,t,r,n){return g(!1,e,t,!0,r,n)},P.reduceEachLeadingCommentRange=f,P.reduceEachTrailingCommentRange=_,P.getLeadingCommentRanges=function(e,t){return f(e,t,y,void 0,void 0)},P.getTrailingCommentRanges=function(e,t){return _(e,t,y,void 0,void 0)},P.getShebang=function(e){if(e=m.exec(e))return e[0]},P.isIdentifierStart=z,P.isIdentifierPart=W,P.isIdentifierText=function(e,t){if(!z(e.charCodeAt(0),t))return!1;for(var r=1;r<e.length;r++)if(!W(e.charCodeAt(r),t))return!1;return!0},P.createScanner=function(s,a,o,p,r,e,t){var h,m,g,f,_,y,b,v,T,l;return void 0===o&&(o=0),R(p,e,t),{getStartPos:function(){return g},getTextPos:function(){return h},getToken:function(){return _},getTokenPos:function(){return f},getTokenText:function(){return p.substring(f,h)},getTokenValue:function(){return y},hasExtendedUnicodeEscape:function(){return v},hasPrecedingLineBreak:function(){return b},isIdentifier:function(){return 71===_||107<_},isReservedWord:function(){return 72<=_&&_<=107},isUnterminated:function(){return T},getNumericLiteralFlags:function(){return l},reScanGreaterToken:function(){if(29===_){if(62===p.charCodeAt(h))return _=62===p.charCodeAt(h+1)?61===p.charCodeAt(h+2)?(h+=3,67):(h+=2,47):61===p.charCodeAt(h+1)?(h+=2,66):(h++,46);if(61===p.charCodeAt(h))return h++,_=31}return _},reScanSlashToken:function(){if(41===_||63===_){for(var e=f+1,t=!1,r=!1;;){if(m<=e){T=!0,c(P.Diagnostics.Unterminated_regular_expression_literal);break}var n=p.charCodeAt(e);if($(n)){T=!0,c(P.Diagnostics.Unterminated_regular_expression_literal);break}if(t)t=!1;else{if(47===n&&!r){e++;break}91===n?r=!0:92===n?t=!0:93===n&&(r=!1)}e++}for(;e<m&&W(p.charCodeAt(e),s);)e++;h=e,y=p.substring(f,h),_=12}return _},reScanTemplateToken:function(){return P.Debug.assert(18===_,"'reScanTemplateToken' should only be called on a '}'"),h=f,_=x()},scanJsxIdentifier:function(){if(71<=_){for(var e=h;h<m;){var t=p.charCodeAt(h);if(45!==t&&!(e===h?z:W)(t,s))break;h++}y+=p.substr(e,h-e)}return _},scanJsxAttributeValue:function(){switch(g=h,p.charCodeAt(h)){case 34:case 39:return y=k(!1),_=9;default:return D()}},reScanJsxToken:function(){return h=f=g,_=N()},scanJsxToken:N,scanJSDocToken:function(){if(m<=h)return _=1;f=g=h;var e=p.charCodeAt(h);switch(e){case 9:case 11:case 12:case 32:for(;h<m&&B(p.charCodeAt(h));)h++;return _=5;case 64:return h++,_=57;case 10:case 13:return h++,_=4;case 42:return h++,_=39;case 123:return h++,_=17;case 125:return h++,_=18;case 91:return h++,_=21;case 93:return h++,_=22;case 60:return h++,_=27;case 62:return h++,_=29;case 61:return h++,_=58;case 44:return h++,_=26;case 46:return h++,_=23}{if(z(e,5)){for(h++;W(p.charCodeAt(h),5)&&h<m;)h++;return _=71}return h+=1,_=0}},scan:D,getText:function(){return p},setText:R,setScriptTarget:function(e){s=e},setLanguageVariant:function(e){o=e},setOnError:function(e){r=e},setTextPos:L,tryScan:function(e){return O(e,!1)},lookAhead:function(e){return O(e,!0)},scanRange:function(e,t,r){var n=m,i=h,s=g,a=f,o=_,l=b,c=y,u=v,d=T,e=(R(p,e,t),r());return m=n,h=i,g=s,f=a,_=o,b=l,y=c,v=u,T=d,e}};function c(e,t){r&&r(e,t||0)}function u(){for(var e=h;U(p.charCodeAt(h));)h++;if(46===p.charCodeAt(h))for(h++;U(p.charCodeAt(h));)h++;var t=h;if(69===p.charCodeAt(h)||101===p.charCodeAt(h))if(h++,l=2,43!==p.charCodeAt(h)&&45!==p.charCodeAt(h)||h++,U(p.charCodeAt(h))){for(h++;U(p.charCodeAt(h));)h++;t=h}else c(P.Diagnostics.Digit_expected);return""+ +p.substring(e,t)}function n(e){return i(e,!1)}function d(e){return i(e,!0)}function i(e,t){for(var r=0,n=0;r<e||t;){var i=p.charCodeAt(h);if(48<=i&&i<=57)n=16*n+i-48;else if(65<=i&&i<=70)n=16*n+i-65+10;else{if(!(97<=i&&i<=102))break;n=16*n+i-97+10}h++,r++}return n=r<e?-1:n}function k(e){void 0===e&&(e=!0);for(var t=p.charCodeAt(h),r="",n=++h;;){if(m<=h){r+=p.substring(n,h),T=!0,c(P.Diagnostics.Unterminated_string_literal);break}var i=p.charCodeAt(h);if(i===t){r+=p.substring(n,h),h++;break}if(92===i&&e)r=(r+=p.substring(n,h))+E(),n=h;else{if($(i)){r+=p.substring(n,h),T=!0,c(P.Diagnostics.Unterminated_string_literal);break}h++}}return r}function x(){for(var e,t=96===p.charCodeAt(h),r=++h,n="";;){if(m<=h){n+=p.substring(r,h),T=!0,c(P.Diagnostics.Unterminated_template_literal),e=t?13:16;break}var i=p.charCodeAt(h);if(96===i){n+=p.substring(r,h),h++,e=t?13:16;break}if(36===i&&h+1<m&&123===p.charCodeAt(h+1)){n+=p.substring(r,h),h+=2,e=t?14:15;break}92===i?(n=(n+=p.substring(r,h))+E(),r=h):13===i?(n+=p.substring(r,h),++h<m&&10===p.charCodeAt(h)&&h++,n+="\n",r=h):h++}return P.Debug.assert(void 0!==e),y=n,e}function E(){if(m<=++h)return c(P.Diagnostics.Unexpected_end_of_text),"";var e,t,r=p.charCodeAt(h);switch(h++,r){case 48:return"\0";case 98:return"\b";case 116:return"\t";case 110:return"\n";case 118:return"\v";case 102:return"\f";case 114:return"\r";case 39:return"'";case 34:return'"';case 117:return h<m&&123===p.charCodeAt(h)?(v=!0,h++,e=d(1),t=!1,e<0?(c(P.Diagnostics.Hexadecimal_digit_expected),t=!0):1114111<e&&(c(P.Diagnostics.An_extended_Unicode_escape_value_must_be_between_0x0_and_0x10FFFF_inclusive),t=!0),m<=h?(c(P.Diagnostics.Unexpected_end_of_text),t=!0):125===p.charCodeAt(h)?h++:(c(P.Diagnostics.Unterminated_Unicode_escape_sequence),t=!0),t?"":(t=e,P.Debug.assert(0<=t&&t<=1114111),t<=65535?String.fromCharCode(t):(e=Math.floor((t-65536)/1024)+55296,t=(t-65536)%1024+56320,String.fromCharCode(e,t)))):S(4);case 120:return S(2);case 13:h<m&&10===p.charCodeAt(h)&&h++;case 10:case 8232:case 8233:return"";default:return String.fromCharCode(r)}}function S(e){e=n(e);return 0<=e?String.fromCharCode(e):(c(P.Diagnostics.Hexadecimal_digit_expected),"")}function C(){var e,t;return h+5<m&&117===p.charCodeAt(h+1)?(e=h,h+=2,t=n(4),h=e,t):-1}function w(){for(var e="",t=h;h<m;){var r=p.charCodeAt(h);if(W(r,s))h++;else{if(92!==r)break;if(!(0<=(r=C())&&W(r,s)))break;e=(e+=p.substring(t,h))+String.fromCharCode(r),t=h+=6}}return e+=p.substring(t,h)}function I(){var e=y.length;if(2<=e&&e<=11){e=y.charCodeAt(0);if(97<=e&&e<=122&&void 0!==(_=M.get(y)))return _}return _=71}function A(e){P.Debug.assert(2===e||8===e,"Expected either base 2 or base 8");for(var t=0,r=0;;){var n=p.charCodeAt(h),i=n-48;if(!U(n)||e<=i)break;t=t*e+i,h++,r++}return 0===r?-1:t}function D(){for(g=h,T=b=v=!1,l=0;;){if(m<=(f=h))return _=1;var e,t=p.charCodeAt(h);if(35===t&&0===h&&j(p,h)){if(h=K(p,h),a)continue;return _=6}switch(t){case 10:case 13:if(b=!0,a){h++;continue}return 13===t&&h+1<m&&10===p.charCodeAt(h+1)?h+=2:h++,_=4;case 9:case 11:case 12:case 32:if(a){h++;continue}for(;h<m&&B(p.charCodeAt(h));)h++;return _=5;case 33:return 61===p.charCodeAt(h+1)?_=61===p.charCodeAt(h+2)?(h+=3,35):(h+=2,33):(h++,_=51);case 34:case 39:return y=k(),_=9;case 96:return _=x();case 37:return 61===p.charCodeAt(h+1)?(h+=2,_=64):(h++,_=42);case 38:return 38===p.charCodeAt(h+1)?(h+=2,_=53):_=61===p.charCodeAt(h+1)?(h+=2,68):(h++,48);case 40:return h++,_=19;case 41:return h++,_=20;case 42:return 61===p.charCodeAt(h+1)?(h+=2,_=61):_=42===p.charCodeAt(h+1)?61===p.charCodeAt(h+2)?(h+=3,62):(h+=2,40):(h++,39);case 43:return 43===p.charCodeAt(h+1)?(h+=2,_=43):_=61===p.charCodeAt(h+1)?(h+=2,59):(h++,37);case 44:return h++,_=26;case 45:return 45===p.charCodeAt(h+1)?(h+=2,_=44):_=61===p.charCodeAt(h+1)?(h+=2,60):(h++,38);case 46:return U(p.charCodeAt(h+1))?(y=u(),_=8):_=46===p.charCodeAt(h+1)&&46===p.charCodeAt(h+2)?(h+=3,24):(h++,23);case 47:if(47===p.charCodeAt(h+1)){for(h+=2;h<m&&!$(p.charCodeAt(h));)h++;if(a)continue;return _=2}if(42!==p.charCodeAt(h+1))return _=61===p.charCodeAt(h+1)?(h+=2,63):(h++,41);h+=2;for(var r=!1;h<m;){var n=p.charCodeAt(h);if(42===n&&47===p.charCodeAt(h+1)){h+=2,r=!0;break}$(n)&&(b=!0),h++}if(r||c(P.Diagnostics.Asterisk_Slash_expected),a)continue;return T=!r,_=3;case 48:if(h+2<m&&(88===p.charCodeAt(h+1)||120===p.charCodeAt(h+1)))return h+=2,(e=d(1))<0&&(c(P.Diagnostics.Hexadecimal_digit_expected),e=0),y=""+e,_=l=8;if(h+2<m&&(66===p.charCodeAt(h+1)||98===p.charCodeAt(h+1)))return h+=2,(e=A(2))<0&&(c(P.Diagnostics.Binary_digit_expected),e=0),y=""+e,l=16,_=8;if(h+2<m&&(79===p.charCodeAt(h+1)||111===p.charCodeAt(h+1)))return h+=2,(e=A(8))<0&&(c(P.Diagnostics.Octal_digit_expected),e=0),y=""+e,l=32,_=8;if(h+1<m&&V(p.charCodeAt(h+1)))return y=""+(()=>{for(var e=h;V(p.charCodeAt(h));)h++;return+p.substring(e,h)})(),l=4,_=8;case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return y=u(),_=8;case 58:return h++,_=56;case 59:return h++,_=25;case 60:if(H(p,h)){if(h=G(p,h,c),a)continue;return _=7}return 60===p.charCodeAt(h+1)?_=61===p.charCodeAt(h+2)?(h+=3,65):(h+=2,45):_=61===p.charCodeAt(h+1)?(h+=2,30):1===o&&47===p.charCodeAt(h+1)&&42!==p.charCodeAt(h+2)?(h+=2,28):(h++,27);case 61:if(H(p,h)){if(h=G(p,h,c),a)continue;return _=7}return 61===p.charCodeAt(h+1)?_=61===p.charCodeAt(h+2)?(h+=3,34):(h+=2,32):_=62===p.charCodeAt(h+1)?(h+=2,36):(h++,58);case 62:if(H(p,h)){if(h=G(p,h,c),a)continue;return _=7}return h++,_=29;case 63:return h++,_=55;case 91:return h++,_=21;case 93:return h++,_=22;case 94:return 61===p.charCodeAt(h+1)?(h+=2,_=70):(h++,_=50);case 123:return h++,_=17;case 124:if(H(p,h)){if(h=G(p,h,c),a)continue;return _=7}return 124===p.charCodeAt(h+1)?(h+=2,_=54):_=61===p.charCodeAt(h+1)?(h+=2,69):(h++,49);case 125:return h++,_=18;case 126:return h++,_=52;case 64:return h++,_=57;case 92:var i=C();return 0<=i&&z(i,s)?(h+=6,y=String.fromCharCode(i)+w(),_=I()):(c(P.Diagnostics.Invalid_character),h++,_=0);default:if(z(t,s)){for(h++;h<m&&W(t=p.charCodeAt(h),s);)h++;return y=p.substring(f,h),92===t&&(y+=w()),_=I()}if(B(t)){h++;continue}if($(t)){b=!0,h++;continue}return c(P.Diagnostics.Invalid_character),h++,_=0}}}function N(){if(g=f=h,m<=h)return _=1;var e=p.charCodeAt(h);if(60===e)return _=47===p.charCodeAt(h+1)?(h+=2,28):(h++,27);if(123===e)return h++,_=17;for(var t=0;h<m&&123!==(e=p.charCodeAt(h));){if(60===e){if(H(p,h))return h=G(p,h,c),_=7;break}$(e)&&0===t?t=-1:F(e)||(t=h),h++}return-1===t?11:10}function O(e,t){var r=h,n=g,i=f,s=_,a=y,o=b,e=e();return e&&!t||(h=r,g=n,f=i,_=s,y=a,b=o),e}function R(e,t,r){p=e||"",m=void 0===r?p.length:t+r,L(t||0)}function L(e){P.Debug.assert(0<=e),f=g=h=e,y=void(_=0),T=v=b=!1}}})(ts=ts||{}),(b=>{b.emptyArray=[],b.emptyMap=b.createMap(),b.externalHelpersModuleNameText="tslib",b.getDeclarationOfKind=function(e,t){if(e=e.declarations)for(var r=0,n=e;r<n.length;r++){var i=n[r];if(i.kind===t)return i}},t="";var t,r={string:function(){return t},writeKeyword:e,writeOperator:e,writePunctuation:e,writeSpace:e,writeStringLiteral:e,writeParameter:e,writeProperty:e,writeSymbol:e,writeLine:function(){return t+=" "},increaseIndent:b.noop,decreaseIndent:b.noop,clear:function(){return t=""},trackSymbol:b.noop,reportInaccessibleThisError:b.noop,reportPrivateInBaseOfClassExpression:b.noop};function e(e){return t+=e}function n(e){return e.end-e.pos}function M(e){var t;return 262144&(t=e).flags||(0==(32768&t.flags)&&!b.forEachChild(t,M)||(t.flags|=131072),t.flags|=262144),0!=(131072&e.flags)}function s(e){for(;e&&265!==e.kind;)e=e.parent;return e}function F(e,t){b.Debug.assert(0<=e);var r=b.getLineStarts(t),n=t.text;if(e+1===r.length)return n.length-1;var i=r[e],s=r[e+1]-1;for(b.Debug.assert(b.isLineBreak(n.charCodeAt(s)));i<=s&&b.isLineBreak(n.charCodeAt(s));)s--;return s}function l(e){return void 0===e||e.pos===e.end&&0<=e.pos&&1!==e.kind}function B(e){return!l(e)}function $(e,t){return 42===e.charCodeAt(t.pos+1)&&33===e.charCodeAt(t.pos+2)}function i(e,t,r){return l(e)?e.pos:b.isJSDocNode(e)?b.skipTrivia((t||s(e)).text,e.pos,!1,!0):r&&b.hasJSDocNodes(e)?i(e.jsDoc[0]):286===e.kind&&0<e._children.length?i(e._children[0],t,r):b.skipTrivia((t||s(e)).text,e.pos)}function a(e,t,r){return void 0===r&&(r=!1),l(t)?"":(e=e.text).substring(r?t.pos:b.skipTrivia(e,t.pos),t.end)}function U(e,t){return l(t)?"":e.substring(b.skipTrivia(e,t.pos),t.end)}function o(e,t){return void 0===t&&(t=!1),a(s(e),e,t)}function V(e,t){e=e.pos,t=t.pos;return e<t?-1:t<e?1:0}function H(e){e=e.emitNode;return e&&e.flags}function c(e){return 2<=e.length&&95===e.charCodeAt(0)&&95===e.charCodeAt(1)?"_"+e:e}function G(e){e=ke(e);return 226===e.kind&&260===e.parent.kind}function u(e){return e&&233===e.kind&&(9===e.name.kind||K(e))}function j(e){return b.isModuleDeclaration(e)&&9===e.name.kind}function K(e){return!!(512&e.flags)}function z(e,t){switch(e.kind){case 265:case 235:case 260:case 233:case 214:case 215:case 216:case 152:case 151:case 153:case 154:case 228:case 186:case 187:return!0;case 207:return t&&!b.isFunctionLike(t)}return!1}function W(e){return 0===n(e)?"(Missing)":o(e)}function q(e){switch(e.kind){case 71:return e.escapedText;case 9:case 8:return c(e.text);case 144:if(ge(e.expression))return c(e.expression.text)}}function J(e,t,r,n,i,s){t=p(e,t);return b.createFileDiagnostic(e,t.start,t.length,r,n,i,s)}function d(e,t){e=b.createScanner(e.languageVersion,!0,e.languageVariant,e.text,void 0,t),e.scan(),t=e.getTokenPos();return b.createTextSpanFromBounds(t,e.getTextPos())}function p(e,t){var r,n=t;switch(t.kind){case 265:var i=b.skipTrivia(e.text,0,!1);return i===e.text.length?b.createTextSpan(0,0):d(e,i);case 226:case 176:case 229:case 199:case 230:case 233:case 232:case 264:case 228:case 186:case 151:case 153:case 154:case 231:n=t.name;break;case 187:var i=e,s=t,a=b.skipTrivia(i.text,s.pos);if(s.body&&207===s.body.kind){var o=b.getLineAndCharacterOfPosition(i,s.body.pos).line;if(o<b.getLineAndCharacterOfPosition(i,s.body.end).line)return b.createTextSpan(a,F(o,i)-a+1)}return b.createTextSpanFromBounds(a,s.end)}return void 0===n?d(e,t.pos):(r=l(n)?n.pos:b.skipTrivia(e.text,n.pos),b.createTextSpanFromBounds(r,n.end))}function Y(e){return!!(2&b.getCombinedNodeFlags(e))||!!(2048&b.getCombinedModifierFlags(e))}b.usingSingleLineStringWriter=function(e){var t=r.string();try{return e(r),r.string()}finally{r.clear(),r.writeKeyword(t)}},b.getFullWidth=n,b.getResolvedModule=function(e,t){return e&&e.resolvedModules&&e.resolvedModules.get(t)},b.setResolvedModule=function(e,t,r){e.resolvedModules||(e.resolvedModules=b.createMap()),e.resolvedModules.set(t,r)},b.setResolvedTypeReferenceDirective=function(e,t,r){e.resolvedTypeReferenceDirectiveNames||(e.resolvedTypeReferenceDirectiveNames=b.createMap()),e.resolvedTypeReferenceDirectiveNames.set(t,r)},b.moduleResolutionIsEqualTo=function(e,t){return e.isExternalLibraryImport===t.isExternalLibraryImport&&e.extension===t.extension&&e.resolvedFileName===t.resolvedFileName&&(e=e.packageId,t=t.packageId,e===t||e&&t&&e.name===t.name&&e.subModuleName===t.subModuleName&&e.version===t.version)},b.typeDirectiveIsEqualTo=function(e,t){return e.resolvedFileName===t.resolvedFileName&&e.primary===t.primary},b.hasChangesInResolutions=function(e,t,r,n){b.Debug.assert(e.length===t.length);for(var i=0;i<e.length;i++){var s=t[i],a=r&&r.get(e[i]);if(a?!s||!n(a,s):s)return!0}return!1},b.containsParseError=M,b.getSourceFileOfNode=s,b.isStatementWithLocals=function(e){switch(e.kind){case 207:case 235:case 214:case 215:case 216:return!0}return!1},b.getStartPositionOfLine=function(e,t){return b.Debug.assert(0<=e),b.getLineStarts(t)[e]},b.nodePosToString=function(e){var t=s(e),e=b.getLineAndCharacterOfPosition(t,e.pos);return t.fileName+"("+(e.line+1)+","+(e.character+1)+")"},b.getEndLinePosition=F,b.nodeIsMissing=l,b.nodeIsPresent=B,b.isRecognizedTripleSlashComment=function(e,t,r){return 47===e.charCodeAt(t+1)&&t+2<r&&47===e.charCodeAt(t+2)&&!!((e=e.substring(t,r)).match(b.fullTripleSlashReferencePathRegEx)||e.match(b.fullTripleSlashAMDReferencePathRegEx)||e.match(X)||e.match(Z))},b.isPinnedComment=$,b.getTokenPosOfNode=i,b.getNonDecoratorTokenPosOfNode=function(e,t){return l(e)||!e.decorators?i(e,t):b.skipTrivia((t||s(e)).text,e.decorators.end)},b.getSourceTextOfNodeFromSourceFile=a,b.getTextOfNodeFromSourceText=U,b.getTextOfNode=o,b.indexOfNode=function(e,t){return b.binarySearch(e,t,V)},b.getEmitFlags=H,b.getLiteralText=function(e,t){if(!xe(e)&&e.parent)return a(t,e);var r=16777216&H(e)?Oe:Fe;switch(e.kind){case 9:return e.singleQuote?"'"+r(e.text,39)+"'":'"'+r(e.text,34)+'"';case 13:return"`"+r(e.text,96)+"`";case 14:return"`"+r(e.text,96)+"${";case 15:return"}"+r(e.text,96)+"${";case 16:return"}"+r(e.text,96)+"`";case 8:case 12:return e.text}b.Debug.fail("Literal kind '"+e.kind+"' not accounted for.")},b.getTextOfConstantValue=function(e){return b.isString(e)?'"'+Fe(e)+'"':""+e},b.escapeLeadingUnderscores=c,b.escapeIdentifier=function(e){return e},b.makeIdentifierFromModuleName=function(e){return b.getBaseFileName(e).replace(/^(\d)/,"_$1").replace(/\W/g,"_")},b.isBlockOrCatchScoped=function(e){return 0!=(3&b.getCombinedNodeFlags(e))||G(e)},b.isCatchClauseVariableDeclarationOrBindingElement=G,b.isAmbientModule=u,b.isModuleWithStringLiteralName=j,b.isNonGlobalAmbientModule=function(e){return b.isModuleDeclaration(e)&&b.isStringLiteral(e.name)},b.isShorthandAmbientModuleSymbol=function(e){return(e=e.valueDeclaration)&&233===e.kind&&!e.body},b.isBlockScopedContainerTopLevel=function(e){return 265===e.kind||233===e.kind||b.isFunctionLike(e)},b.isGlobalScopeAugmentation=K,b.isExternalModuleAugmentation=function(e){if(e&&u(e))switch(e.parent.kind){case 265:return b.isExternalModule(e.parent);case 234:return u(e.parent.parent)&&!b.isExternalModule(e.parent.parent.parent)}return!1},b.isEffectiveExternalModule=function(e,t){return b.isExternalModule(e)||t.isolatedModules},b.isBlockScope=z,b.isDeclarationWithTypeParameters=function(e){switch(e.kind){case 155:case 156:case 150:case 157:case 160:case 161:case 273:case 229:case 199:case 230:case 231:case 282:case 228:case 151:case 152:case 153:case 154:case 186:case 187:return!0;default:return b.assertTypeIsNever(e),!1}},b.isAnyImportSyntax=function(e){switch(e.kind){case 238:case 237:return!0;default:return!1}},b.getEnclosingBlockScopeContainer=function(e){for(var t=e.parent;t;){if(z(t,t.parent))return t;t=t.parent}},b.declarationNameToString=W,b.getNameFromIndexInfo=function(e){return e.declaration?W(e.declaration.parameters[0].name):void 0},b.getTextOfPropertyName=q,b.entityNameToString=function e(t){switch(t.kind){case 71:return 0===n(t)?b.idText(t):o(t);case 143:return e(t.left)+"."+e(t.right);case 179:return e(t.expression)+"."+e(t.name)}},b.createDiagnosticForNode=function(e,t,r,n,i){return J(s(e),e,t,r,n,i)},b.createDiagnosticForNodeInSourceFile=J,b.createDiagnosticForNodeFromMessageChain=function(e,t){var r=s(e),e=p(r,e);return{file:r,start:e.start,length:e.length,code:t.code,category:t.category,messageText:t.next?t:t.messageText}},b.getSpanOfTokenAtPosition=d,b.getErrorSpanForNode=p,b.isExternalOrCommonJsModule=function(e){return void 0!==(e.externalModuleIndicator||e.commonJsModuleIndicator)},b.isConstEnumDeclaration=function(e){return 232===e.kind&&Y(e)},b.isConst=Y,b.isLet=function(e){return!!(1&b.getCombinedNodeFlags(e))},b.isSuperCall=function(e){return 181===e.kind&&97===e.expression.kind},b.isImportCall=function(e){return 181===e.kind&&91===e.expression.kind},b.isPrologueDirective=function(e){return 210===e.kind&&9===e.expression.kind},b.getLeadingCommentRangesOfNode=function(e,t){return 10!==e.kind?b.getLeadingCommentRanges(t.text,e.pos):void 0},b.getJSDocCommentRanges=function(e,r,t){let n=146===e.kind||145===e.kind||186===e.kind||187===e.kind||185===e.kind?b.concatenate(b.getTrailingCommentRanges(r,e.pos),b.getLeadingCommentRanges(r,e.pos)):b.getLeadingCommentRanges(r,e.pos),i=t?.emitBlockCommentsAsJsDocs;return b.filter(n,function(e){return t=e,42===r.charCodeAt(t.pos+1)&&42===r.charCodeAt(t.pos+2)&&47!==r.charCodeAt(t.pos+3)||i&&(t=e,47===r.charCodeAt(t.pos+0))&&47===r.charCodeAt(t.pos+1)&&37===r.charCodeAt(t.pos+2);var t})},b.fullTripleSlashReferencePathRegEx=/^(\/\/\/\s*<reference\s+path\s*=\s*)('|")(.+?)\2.*?\/>/;var h,X=/^(\/\/\/\s*<reference\s+types\s*=\s*)('|")(.+?)\2.*?\/>/,Z=(b.fullTripleSlashAMDReferencePathRegEx=/^(\/\/\/\s*<amd-dependency\s+path\s*=\s*)('|")(.+?)\2.*?\/>/,/^(\/\/\/\s*<reference\s+no-default-lib\s*=\s*)('|")(.+?)\2\s*\/>/);function Q(e){if(158<=e.kind&&e.kind<=173)return!0;switch(e.kind){case 119:case 133:case 136:case 122:case 137:case 139:case 130:return!0;case 105:return 190!==e.parent.kind;case 201:return!A(e);case 71:(143===e.parent.kind&&e.parent.right===e||179===e.parent.kind&&e.parent.name===e)&&(e=e.parent),b.Debug.assert(71===e.kind||143===e.kind||179===e.kind,"'node' was expected to be a qualified name, identifier or property access in 'isPartOfTypeNode'.");case 143:case 179:case 99:var t=e.parent;if(162===t.kind)return!1;if(158<=t.kind&&t.kind<=173)return!0;switch(t.kind){case 201:return!A(t);case 145:return e===t.constraint;case 149:case 148:case 146:case 226:return e===t.type;case 228:case 186:case 187:case 152:case 151:case 150:case 153:case 154:return e===t.type;case 155:case 156:case 157:case 184:return e===t.type;case 181:case 182:return t.typeArguments&&0<=b.indexOf(t.typeArguments,e);case 183:return!1}}return!1}function ee(e){if(e)switch(e.kind){case 176:case 264:case 146:case 261:case 149:case 148:case 262:case 226:return!0}return!1}function te(e,t){for(;;){if(!(e=e.parent))return;switch(e.kind){case 144:if(b.isClassLike(e.parent.parent))return e;e=e.parent;break;case 147:146===e.parent.kind&&b.isClassElement(e.parent.parent)?e=e.parent.parent:b.isClassElement(e.parent)&&(e=e.parent);break;case 187:if(!t)continue;case 228:case 186:case 233:case 149:case 148:case 151:case 150:case 152:case 153:case 154:case 155:case 156:case 157:case 232:case 265:return e}}}function re(e){switch(e.kind){case 229:return!0;case 149:return 229===e.parent.kind;case 153:case 154:case 151:return void 0!==e.body&&229===e.parent.kind;case 146:return void 0!==e.parent.body&&(152===e.parent.kind||151===e.parent.kind||154===e.parent.kind)&&229===e.parent.parent.kind}return!1}function m(e){return void 0!==e.decorators&&re(e)}function ne(e){return m(e)||ie(e)}function ie(e){switch(e.kind){case 229:return b.forEach(e.members,ne);case 151:case 154:return b.forEach(e.parameters,m)}}function g(e){var t=e.parent;return(251===t.kind||250===t.kind||252===t.kind)&&t.tagName===e}function se(e){switch(e.kind){case 97:case 95:case 101:case 86:case 12:case 177:case 178:case 179:case 180:case 181:case 182:case 183:case 202:case 184:case 203:case 185:case 186:case 199:case 187:case 190:case 188:case 189:case 192:case 193:case 194:case 195:case 198:case 196:case 13:case 200:case 249:case 250:case 197:case 191:case 204:return!0;case 143:for(;143===e.parent.kind;)e=e.parent;return 162===e.parent.kind||g(e);case 71:if(162===e.parent.kind||g(e))return!0;case 8:case 9:case 99:return ae(e);default:return!1}}function ae(e){var t=e.parent;switch(t.kind){case 226:case 146:case 149:case 148:case 264:case 261:case 176:return t.initializer===e;case 210:case 211:case 212:case 213:case 219:case 220:case 221:case 257:case 223:return t.expression===e;case 214:return t.initializer===e&&227!==t.initializer.kind||t.condition===e||t.incrementor===e;case 215:case 216:return t.initializer===e&&227!==t.initializer.kind||t.expression===e;case 184:case 202:case 205:case 144:return e===t.expression;case 147:case 256:case 255:case 263:return!0;case 201:return t.expression===e&&A(t);default:return se(t)}}function oe(e){return 237===e.kind&&248===e.moduleReference.kind}function le(e){return f(e)}function f(e){return e&&!!(65536&e.flags)}function ce(e){if(f(e)&&58===e.operatorToken.kind&&179===e.left.kind){e=e.left;if(71===e.expression.kind)return"exports"===(t=e.expression).escapedText?1:"module"===t.escapedText&&"exports"===e.name.escapedText?2:5;if(99===e.expression.kind)return 4;if(179===e.expression.kind){var t=e.expression;if(71===t.expression.kind){if("module"===t.expression.escapedText&&"exports"===t.name.escapedText)return 1;if("prototype"===t.name.escapedText)return 3}}}return 0}function _(e){return b.isExpressionStatement(e)&&e.expression&&b.isBinaryExpression(e.expression)&&58===e.expression.operatorToken.kind&&e.expression.right}function y(e,t){return b.isVariableStatement(e)&&0<e.declarationList.declarations.length&&(!t||e.declarationList.declarations[0].initializer===t)&&e.declarationList.declarations[0].initializer}function v(e,t){return b.isVariableStatement(e)&&0<e.declarationList.declarations.length&&(!t||e.declarationList.declarations[0]===t)&&e.declarationList.declarations[0]}function T(e){return 233===e.kind&&e.body&&233===e.body.kind&&e.body}function ue(e){var n;return function e(t){var r=t.parent;r&&(261===r.kind||T(r))&&e(r);r&&r.parent&&(v(r.parent,t)||_(r.parent))&&e(r.parent);r&&r.parent&&r.parent.parent&&y(r.parent.parent,t)&&e(r.parent.parent);146===t.kind&&(n=b.addRange(n,b.getJSDocParameterTags(t)));ee(t)&&t.initializer&&b.hasJSDocNodes(t.initializer)&&(n=b.addRange(n,t.initializer.jsDoc));b.hasJSDocNodes(t)&&(n=b.addRange(n,t.jsDoc))}(e),n||b.emptyArray}function de(e){return b.Debug.assert(275===e.parent.kind),e.parent.parent}function pe(e){return void 0!==e.dotDotDotToken}function he(e){for(var t=e.parent;;){switch(t.kind){case 194:var r=t.operatorToken.kind;return I(r)&&t.left===e?58===r?1:2:0;case 192:case 193:r=t.operator;return 43===r||44===r?2:0;case 215:case 216:return t.initializer===e?1:0;case 185:case 177:case 198:e=t;break;case 262:if(t.name!==e)return 0;e=t.parent;break;case 261:if(t.name===e)return 0;e=t.parent;break;default:return 0}t=e.parent}}function me(e){return D(e.expression)}function k(e,t){if(e)for(var r=0,n=e;r<n.length;r++){var i=n[r];if(i.token===t)return i}}function ge(e){e=e.kind;return 9===e||8===e}function fe(e){e=b.getNameOfDeclaration(e);return e&&_e(e)}function _e(e){return 144===e.kind&&!ge(e.expression)&&!ye(e.expression)}function ye(e){return b.isPropertyAccessExpression(e)&&Te(e.expression)}function be(e){if(71===e.kind)return e.escapedText;if(9===e.kind||8===e.kind)return c(e.text);if(144===e.kind){e=e.expression;if(ye(e))return ve(b.idText(e.name));if(9===e.kind||8===e.kind)return c(e.text)}}function ve(e){return"__@"+e}function Te(e){return 71===e.kind&&"Symbol"===e.escapedText}function ke(e){for(;176===e.kind;)e=e.parent.parent;return e}function xe(e){return b.positionIsSynthesized(e.pos)||b.positionIsSynthesized(e.end)}function Ee(e,t,r){switch(e){case 182:return r?0:1;case 192:case 189:case 190:case 188:case 191:case 195:case 197:return 1;case 194:switch(t){case 40:case 58:case 59:case 60:case 62:case 61:case 63:case 64:case 65:case 66:case 67:case 68:case 70:case 69:return 1}}return 0}function Se(e){return 194===e.kind?e.operatorToken.kind:192===e.kind||193===e.kind?e.operator:e.kind}function Ce(e,t,r){switch(e){case 99:case 97:case 71:case 95:case 101:case 86:case 8:case 9:case 177:case 178:case 186:case 187:case 199:case 249:case 250:case 12:case 13:case 196:case 185:case 200:return 19;case 183:case 179:case 180:return 18;case 182:return r?18:17;case 181:return 17;case 193:return 16;case 192:case 189:case 190:case 188:case 191:return 15;case 194:switch(t){case 51:case 52:return 15;case 40:case 39:case 41:case 42:return 14;case 37:case 38:return 13;case 45:case 46:case 47:return 12;case 27:case 30:case 29:case 31:case 92:case 93:return 11;case 32:case 34:case 33:case 35:return 10;case 48:return 9;case 50:return 8;case 49:return 7;case 53:return 6;case 54:return 5;case 58:case 59:case 60:case 62:case 61:case 63:case 64:case 65:case 66:case 67:case 68:case 70:case 69:return 3;case 26:return 0;default:return-1}case 195:return 4;case 197:return 2;case 198:return 1;case 289:return 0;default:return-1}}b.isPartOfTypeNode=Q,b.isChildOfNodeWithKind=function(e,t){for(;e;){if(e.kind===t)return!0;e=e.parent}return!1},b.forEachReturnStatement=function(e,r){return function e(t){switch(t.kind){case 219:return r(t);case 235:case 207:case 211:case 212:case 213:case 214:case 215:case 216:case 220:case 221:case 257:case 258:case 222:case 224:case 260:return b.forEachChild(t,e)}}(e)},b.forEachYieldExpression=function(e,n){return function e(t){switch(t.kind){case 197:n(t);var r=t.expression;return void(r&&e(r));case 232:case 230:case 233:case 231:case 229:case 199:return;default:b.isFunctionLike(t)?(r=t.name)&&144===r.kind&&e(r.expression):Q(t)||b.forEachChild(t,e)}}(e)},b.getRestParameterElementType=function(e){return e&&164===e.kind?e.elementType:e&&159===e.kind?b.singleOrUndefined(e.typeArguments):void 0},b.isVariableLike=ee,b.introducesArgumentsExoticObject=function(e){switch(e.kind){case 151:case 150:case 152:case 153:case 154:case 228:case 186:return!0}return!1},b.unwrapInnermostStatementOfLabel=function(e,t){for(;;){if(t&&t(e),222!==e.statement.kind)return e.statement;e=e.statement}},b.isFunctionBlock=function(e){return e&&207===e.kind&&b.isFunctionLike(e.parent)},b.isObjectLiteralMethod=function(e){return e&&151===e.kind&&178===e.parent.kind},b.isObjectLiteralOrClassExpressionMethod=function(e){return 151===e.kind&&(178===e.parent.kind||199===e.parent.kind)},b.isIdentifierTypePredicate=function(e){return e&&1===e.kind},b.isThisTypePredicate=function(e){return e&&0===e.kind},b.getPropertyAssignment=function(e,t,r){return b.filter(e.properties,function(e){if(261===e.kind)return e=q(e.name),t===e||r&&r===e})},b.getContainingFunction=function(e){return b.findAncestor(e.parent,b.isFunctionLike)},b.getContainingClass=function(e){return b.findAncestor(e.parent,b.isClassLike)},b.getThisContainer=te,b.getNewTargetContainer=function(e){var t=te(e,!1);if(t)switch(t.kind){case 152:case 228:case 186:return t}},b.getSuperContainer=function(e,t){for(;;){if(!(e=e.parent))return e;switch(e.kind){case 144:e=e.parent;break;case 228:case 186:case 187:if(!t)continue;case 149:case 148:case 151:case 150:case 152:case 153:case 154:return e;case 147:146===e.parent.kind&&b.isClassElement(e.parent.parent)?e=e.parent.parent:b.isClassElement(e.parent)&&(e=e.parent)}}},b.getImmediatelyInvokedFunctionExpression=function(e){if(186===e.kind||187===e.kind){for(var t=e,r=e.parent;185===r.kind;)r=(t=r).parent;if(181===r.kind&&r.expression===t)return r}},b.isSuperProperty=function(e){var t=e.kind;return(179===t||180===t)&&97===e.expression.kind},b.getEntityNameFromTypeNode=function(e){switch(e.kind){case 159:return e.typeName;case 201:return D(e.expression)?e.expression:void 0;case 71:case 143:return e}},b.getInvokedExpression=function(e){return 183===e.kind?e.tag:b.isJsxOpeningLikeElement(e)?e.tagName:e.expression},b.nodeCanBeDecorated=re,b.nodeIsDecorated=m,b.nodeOrChildIsDecorated=ne,b.childIsDecorated=ie,b.isJSXTagName=g,b.isPartOfExpression=se,b.isInExpressionContext=ae,b.isExternalModuleImportEqualsDeclaration=oe,b.getExternalModuleImportEqualsDeclarationExpression=function(e){return b.Debug.assert(oe(e)),e.moduleReference.expression},b.isInternalModuleImportEqualsDeclaration=function(e){return 237===e.kind&&248!==e.moduleReference.kind},b.isSourceFileJavaScript=le,b.isInJavaScriptFile=f,b.isInJSDoc=function(e){return e&&!!(1048576&e.flags)},b.isJSDocIndexSignature=function(e){return b.isTypeReferenceNode(e)&&b.isIdentifier(e.typeName)&&"Object"===e.typeName.escapedText&&e.typeArguments&&2===e.typeArguments.length&&(136===e.typeArguments[0].kind||133===e.typeArguments[0].kind)},b.isRequireCall=function(e,t){var r;return 181===e.kind&&(r=e.expression,e=e.arguments,71===r.kind)&&"require"===r.escapedText&&1===e.length&&(r=e[0],!t||9===r.kind||13===r.kind)},b.isSingleOrDoubleQuote=function(e){return 39===e||34===e},b.isStringDoubleQuoted=function(e,t){return 34===a(t,e).charCodeAt(0)},b.isDeclarationOfFunctionOrClassExpression=function(e){return!(!e.valueDeclaration||226!==e.valueDeclaration.kind)&&(e=e.valueDeclaration).initializer&&(186===e.initializer.kind||199===e.initializer.kind)},b.getRightMostAssignedExpression=function(e){for(;nt(e,!0);)e=e.right;return e},b.isExportsIdentifier=function(e){return b.isIdentifier(e)&&"exports"===e.escapedText},b.isModuleExportsPropertyAccessExpression=function(e){return b.isPropertyAccessExpression(e)&&b.isIdentifier(e.expression)&&"module"===e.expression.escapedText&&"exports"===e.name.escapedText},b.getSpecialPropertyAssignmentKind=ce,b.getExternalModuleName=function(e){if(238===e.kind)return e.moduleSpecifier;if(237===e.kind){var t=e.moduleReference;if(248===t.kind)return t.expression}return 244===e.kind?e.moduleSpecifier:j(e)?e.name:void 0},b.getNamespaceDeclarationNode=function(e){return 237===e.kind?e:(e=e.importClause)&&e.namedBindings&&240===e.namedBindings.kind?e.namedBindings:void 0},b.isDefaultImport=function(e){return 238===e.kind&&e.importClause&&!!e.importClause.name},b.hasQuestionToken=function(e){if(e)switch(e.kind){case 146:case 151:case 150:case 262:case 261:case 149:case 148:return void 0!==e.questionToken}return!1},b.isJSDocConstructSignature=function(e){return 273===e.kind&&0<e.parameters.length&&e.parameters[0].name&&"new"===e.parameters[0].name.escapedText},b.getAllJSDocs=function(e){return b.isJSDocTypedefTag(e)?[e.parent]:ue(e)},b.getSourceOfAssignment=_,b.getSingleInitializerOfVariableStatement=y,b.getSingleVariableOfVariableStatement=v,b.getNestedModuleDeclaration=T,b.getJSDocCommentsAndTags=ue,b.getParameterSymbolFromJSDoc=function(e){var t;return e.symbol||(b.isIdentifier(e.name)&&(t=e.name.escapedText,e=_(e=de(e))||y(e)||v(e)||T(e)||e)&&b.isFunctionLike(e)?(e=b.find(e.parameters,function(e){return 71===e.name.kind&&e.name.escapedText===t}))&&e.symbol:void 0)},b.getJSDocHost=de,b.getTypeParameterFromJsDoc=function(e){var t=e.name.escapedText,e=e.parent.parent.parent.typeParameters;return b.find(e,function(e){return e.name.escapedText===t})},b.hasRestParameter=function(e){return(e=b.lastOrUndefined(e.parameters))&&pe(e)},b.isRestParameter=pe,(h=b.AssignmentKind||(b.AssignmentKind={}))[h.None=0]="None",h[h.Definite=1]="Definite",h[h.Compound=2]="Compound",b.getAssignmentTargetKind=he,b.isAssignmentTarget=function(e){return 0!==he(e)},b.isDeleteTarget=function(e){if(179!==e.kind&&180!==e.kind)return!1;for(e=e.parent;e&&185===e.kind;)e=e.parent;return e&&188===e.kind},b.isNodeDescendantOf=function(e,t){for(;e;){if(e===t)return!0;e=e.parent}return!1},b.isInAmbientContext=function(e){for(;e;){if(w(e,2)||265===e.kind&&e.isDeclarationFile)return!0;e=e.parent}return!1},b.isDeclarationName=function(e){switch(e.kind){case 71:case 9:case 8:return b.isDeclaration(e.parent)&&e.parent.name===e;default:return!1}},b.isAnyDeclarationName=function(e){switch(e.kind){case 71:case 9:case 8:var t;return b.isDeclaration(e.parent)?e.parent.name===e:(t=e.parent.parent,b.isBinaryExpression(t)&&0!==ce(t)&&b.getNameOfDeclaration(t)===e);default:return!1}},b.isLiteralComputedPropertyDeclarationName=function(e){return(9===e.kind||8===e.kind)&&144===e.parent.kind&&b.isDeclaration(e.parent.parent)},b.isIdentifierName=function(e){var t=e.parent;switch(t.kind){case 149:case 148:case 151:case 150:case 153:case 154:case 264:case 261:case 179:return t.name===e;case 143:if(t.right!==e)return!1;for(;143===t.kind;)t=t.parent;return 162===t.kind;case 176:case 242:return t.propertyName===e;case 246:case 253:return!0}return!1},b.isAliasSymbolDeclaration=function(e){return 237===e.kind||236===e.kind||239===e.kind&&!!e.name||240===e.kind||242===e.kind||246===e.kind||243===e.kind&&me(e)},b.exportAssignmentIsAlias=me,b.getClassExtendsHeritageClauseElement=function(e){return(e=k(e.heritageClauses,85))&&0<e.types.length?e.types[0]:void 0},b.getClassImplementsHeritageClauseElements=function(e){return(e=k(e.heritageClauses,108))?e.types:void 0},b.getInterfaceBaseTypeNodes=function(e){return(e=k(e.heritageClauses,85))?e.types:void 0},b.getHeritageClause=k,b.tryResolveScriptReference=function(e,t,r){if(!e.getCompilerOptions().noResolve)return t=b.isRootedDiskPath(r.fileName)?r.fileName:b.combinePaths(b.getDirectoryPath(t.fileName),r.fileName),e.getSourceFile(t)},b.getAncestor=function(e,t){for(;e;){if(e.kind===t)return e;e=e.parent}},b.getFileReferenceFromReferencePath=function(e,t){var r=new RegExp(Z.source,"gim");if(/^\/\/\/\s*<reference\s+/gim.test(e))return r.test(e)?{isNoDefaultLib:!0}:(e=!(r=b.fullTripleSlashReferencePathRegEx.exec(e))&&X.exec(e),(r=r||e)?{fileReference:{pos:t=t.pos+r[1].length+r[2].length,end:t+r[3].length,fileName:r[3]},isNoDefaultLib:!1,isTypeReferenceDirective:!!e}:{diagnosticMessage:b.Diagnostics.Invalid_reference_directive_syntax,isNoDefaultLib:!1})},b.isKeyword=function(e){return 72<=e&&e<=142},b.isTrivia=function(e){return 2<=e&&e<=7},(h=b.FunctionFlags||(b.FunctionFlags={}))[h.Normal=0]="Normal",h[h.Generator=1]="Generator",h[h.Async=2]="Async",h[h.Invalid=4]="Invalid",h[h.AsyncGenerator=3]="AsyncGenerator",b.getFunctionFlags=function(e){if(!e)return 4;var t=0;switch(e.kind){case 228:case 186:case 151:e.asteriskToken&&(t|=1);case 187:w(e,256)&&(t|=2)}return e.body||(t|=4),t},b.isAsyncFunction=function(e){switch(e.kind){case 228:case 186:case 187:case 151:return void 0!==e.body&&void 0===e.asteriskToken&&w(e,256)}return!1},b.isStringOrNumericLiteral=ge,b.hasDynamicName=fe,b.isDynamicName=_e,b.isWellKnownSymbolSyntactically=ye,b.getPropertyNameForPropertyNameNode=be,b.getTextOfIdentifierOrLiteral=function(e){if(e){if(71===e.kind)return b.idText(e);if(9===e.kind||8===e.kind)return e.text}},b.getEscapedTextOfIdentifierOrLiteral=function(e){if(e){if(71===e.kind)return e.escapedText;if(9===e.kind||8===e.kind)return c(e.text)}},b.getPropertyNameForKnownSymbolName=ve,b.isESSymbolIdentifier=Te,b.isPushOrUnshiftIdentifier=function(e){return"push"===e.escapedText||"unshift"===e.escapedText},b.isParameterDeclaration=function(e){return 146===ke(e).kind},b.getRootDeclaration=ke,b.nodeStartsNewLexicalEnvironment=function(e){return 152===(e=e.kind)||186===e||228===e||187===e||151===e||153===e||154===e||233===e||265===e},b.nodeIsSynthesized=xe,b.getOriginalSourceFile=function(e){return b.getParseTreeNode(e,b.isSourceFile)||e},(h=b.Associativity||(b.Associativity={}))[h.Left=0]="Left",h[h.Right=1]="Right",b.getExpressionAssociativity=function(e){var t=Se(e),r=182===e.kind&&void 0!==e.arguments;return Ee(e.kind,t,r)},b.getOperatorAssociativity=Ee,b.getExpressionPrecedence=function(e){var t=Se(e),r=182===e.kind&&void 0!==e.arguments;return Ce(e.kind,t,r)},b.getOperator=Se,b.getOperatorPrecedence=Ce,b.createDiagnosticCollection=function(){var n=[],i=b.createMap(),r=!1,s=0;return{add:function(e){var t;e.file?(t=i.get(e.file.fileName))||(t=[],i.set(e.file.fileName,t)):t=n;t.push(e),r=!0,s++},getGlobalDiagnostics:function(){return a(),n},getDiagnostics:function(e){if(a(),e)return i.get(e)||[];var t=[];function r(e){t.push(e)}return b.forEach(n,r),i.forEach(function(e){b.forEach(e,r)}),b.sortAndDeduplicateDiagnostics(t)},getModificationCount:function(){return s},reattachFileDiagnostics:function(t){b.forEach(i.get(t.fileName),function(e){return e.file=t})}};function a(){r&&(r=!1,n=b.sortAndDeduplicateDiagnostics(n),i.forEach(function(e,t){i.set(t,b.sortAndDeduplicateDiagnostics(e))}))}};var we=/[\\\"\u0000-\u001f\t\v\f\b\r\n\u2028\u2029\u0085]/g,Ie=/[\\\'\u0000-\u001f\t\v\f\b\r\n\u2028\u2029\u0085]/g,Ae=/[\\\`\u0000-\u001f\t\v\f\b\r\n\u2028\u2029\u0085]/g,De=b.createMapFromTemplate({"\0":"\\0","\t":"\\t","\v":"\\v","\f":"\\f","\b":"\\b","\r":"\\r","\n":"\\n","\\":"\\\\",'"':'\\"',"'":"\\'","`":"\\`","\u2028":"\\u2028","\u2029":"\\u2029","":"\\u0085"}),Ne=/\\0[0-9]/g;function Oe(e,t){return e.replace(96===t?Ae:39===t?Ie:we,Le).replace(Ne,Re)}function Re(e){return"\\x00"+e.charAt(e.length-1)}function Le(e){return De.get(e)||Pe(e.charCodeAt(0))}function Pe(e){return"\\u"+("0000"+e.toString(16).toUpperCase()).slice(-4)}b.escapeString=Oe,b.isIntrinsicJsxName=function(e){return(e=e.substr(0,1)).toLowerCase()===e};var Me=/[^\u0000-\u007F]/g;function Fe(e,t){return e=Oe(e,t),Me.test(e)?e.replace(Me,function(e){return Pe(e.charCodeAt(0))}):e}b.escapeNonAsciiString=Fe;var x=["","    "];function E(e){return void 0===x[e]&&(x[e]=E(e-1)+x[1]),x[e]}function S(){return x[1].length}function Be(e,t){return t.moduleName||$e(e,t.fileName)}function $e(t,e){function r(e){return t.getCanonicalFileName(e)}var n=b.toPath(t.getCommonSourceDirectory(),t.getCurrentDirectory(),r),e=b.getNormalizedAbsolutePath(e,t.getCurrentDirectory()),e=b.getRelativePathToDirectoryOrUrl(n,e,n,r,!1);return b.removeFileExtension(e)}function Ue(e,t,r){return!(t.noEmitForJsFiles&&le(e)||e.isDeclarationFile||r(e))}function Ve(e,t,r){var e=b.getNormalizedAbsolutePath(e.fileName,t.getCurrentDirectory()),n=t.getCommonSourceDirectory(),e=0===t.getCanonicalFileName(e).indexOf(t.getCanonicalFileName(n))?e.substring(n.length):e;return b.combinePaths(r,e)}function He(e,t){return b.getLineAndCharacterOfPosition(e,t).line}function C(e,t){return b.computeLineAndCharacterOfPosition(e,t).line}function Ge(e){var t;if(e&&0<e.parameters.length)return t=2===e.parameters.length&&je(e.parameters[0]),e.parameters[t?1:0]}function je(e){return Ke(e.name)}function Ke(e){return e&&71===e.kind&&ze(e)}function ze(e){return 99===e.originalKeywordKind}function We(e,t){return e.type||(t||f(e)?b.getJSDocType(e):void 0)}function qe(e,t,r,n){Je(e,t,r.pos,n)}function Je(e,t,r,n){n&&n.length&&r!==n[0].pos&&C(e,r)!==C(e,n[0].pos)&&t.writeLine()}function Ye(e,t,r,n,i,s,a,o){if(n&&0<n.length){i&&r.write(" ");for(var l=!1,c=0,u=n;c<u.length;c++){var d=u[c];l&&(r.write(" "),l=!1),o(e,t,r,d.pos,d.end,a),d.hasTrailingNewLine?r.writeLine():l=!0}l&&s&&r.write(" ")}}function Xe(e,t,r){for(var n=0;t<r&&b.isWhiteSpaceSingleLine(e.charCodeAt(t));t++)9===e.charCodeAt(t)?n+=S()-n%S():n++;return n}function w(e,t){return!!Ze(e,t)}function Ze(e,t){return Qe(e)&t}function Qe(e){var t;return 536870912&e.modifierFlagsCache?-536870913&e.modifierFlagsCache:(t=et(e),e.modifierFlagsCache=536870912|t,t)}function et(e){var t=0;if(e.modifiers)for(var r=0,n=e.modifiers;r<n.length;r++)t|=tt(n[r].kind);return(4&e.flags||71===e.kind&&e.isInJSDocNamespace)&&(t|=1),t}function tt(e){switch(e){case 115:return 32;case 114:return 4;case 113:return 16;case 112:return 8;case 117:return 128;case 84:return 1;case 124:return 2;case 76:return 2048;case 79:return 512;case 120:return 256;case 131:return 64}return 0}function I(e){return 58<=e&&e<=70}function rt(e){if(201===e.kind&&85===e.parent.token&&b.isClassLike(e.parent.parent))return e.parent.parent}function nt(e,t){return b.isBinaryExpression(e)&&(t?58===e.operatorToken.kind:I(e.operatorToken.kind))&&b.isLeftHandSideExpression(e.left)}function A(e){return void 0!==rt(e)}function D(e){return 71===e.kind||179===e.kind&&D(e.expression)}b.getIndentString=E,b.getIndentSize=S,b.createTextWriter=function(e){var r,t,n,i,s;function a(e){e&&e.length&&(n&&(r+=E(t),n=!1),r+=e)}function o(){r="",n=!(t=0),s=i=0}return o(),{write:a,rawWrite:function(e){void 0!==e&&(n=n&&!1,r+=e)},writeTextOfNode:function(e,t){a(U(e,t))},writeLiteral:function(e){var t;e&&e.length&&(a(e),1<(t=b.computeLineStarts(e)).length)&&(i=i+t.length-1,s=r.length-e.length+b.lastOrUndefined(t))},writeLine:function(){n||(i++,s=(r+=e).length,n=!0)},increaseIndent:function(){t++},decreaseIndent:function(){t--},getIndent:function(){return t},getTextPos:function(){return r.length},getLine:function(){return i+1},getColumn:function(){return n?t*S()+1:r.length-s+1},getText:function(){return r},isAtStartOfLine:function(){return n},reset:o}},b.getResolvedExternalModuleName=Be,b.getExternalModuleNameFromDeclaration=function(e,t,r){if((t=t.getExternalModuleFileFromDeclaration(r))&&!t.isDeclarationFile)return Be(e,t)},b.getExternalModuleNameFromPath=$e,b.getOwnEmitOutputFilePath=function(e,t,r){var n=t.getCompilerOptions();return(t=n.outDir?b.removeFileExtension(Ve(e,t,n.outDir)):b.removeFileExtension(e.fileName))+r},b.getDeclarationEmitOutputFilePath=function(e,t){var r=t.getCompilerOptions(),t=(r=r.declarationDir||r.outDir)?Ve(e,t,r):e.fileName;return b.removeFileExtension(t)+".d.ts"},b.getSourceFilesToEmit=function(t,e){function r(e){return t.isSourceFileFromExternalLibrary(e)}var n,i,s=t.getCompilerOptions();return s.outFile||s.out?(i=b.getEmitModuleKind(s),n=i===b.ModuleKind.AMD||i===b.ModuleKind.System,b.filter(t.getSourceFiles(),function(e){return(n||!b.isExternalModule(e))&&Ue(e,s,r)})):(i=void 0===e?t.getSourceFiles():[e],b.filter(i,function(e){return Ue(e,s,r)}))},b.sourceFileMayBeEmitted=Ue,b.getSourceFilePathInNewDir=Ve,b.writeFile=function(e,t,r,n,i,s){e.writeFile(r,n,i,function(e){t.add(b.createCompilerDiagnostic(b.Diagnostics.Could_not_write_file_0_Colon_1,r,e))},s)},b.getLineOfLocalPosition=He,b.getLineOfLocalPositionFromLineMap=C,b.getFirstConstructorWithBody=function(e){return b.forEach(e.members,function(e){if(152===e.kind&&B(e.body))return e})},b.getSetAccessorTypeAnnotationNode=function(e){return(e=Ge(e))&&e.type},b.getThisParameter=function(e){if(e.parameters.length){e=e.parameters[0];if(je(e))return e}},b.parameterIsThisKeyword=je,b.isThisIdentifier=Ke,b.identifierIsThisKeyword=ze,b.getAllAccessorDeclarations=function(e,t){var r,n,i,s;return fe(t)?153===(r=t).kind?i=t:154===t.kind?s=t:b.Debug.fail("Accessor has wrong kind"):b.forEach(e,function(e){153!==e.kind&&154!==e.kind||w(e,32)!==w(t,32)||be(e.name)===be(t.name)&&(r?n=n||e:r=e,153===e.kind&&(i=i||e),154===e.kind)&&(s=s||e)}),{firstAccessor:r,secondAccessor:n,getAccessor:i,setAccessor:s}},b.getEffectiveTypeAnnotationNode=We,b.getEffectiveReturnTypeNode=function(e,t){return e.type||(t||f(e)?b.getJSDocReturnType(e):void 0)},b.getEffectiveTypeParameterDeclarations=function(e,t){return e.typeParameters||(t||f(e)?(t=b.getJSDocTemplateTag(e))&&t.typeParameters:void 0)},b.getEffectiveSetAccessorTypeAnnotationNode=function(e,t){return(e=Ge(e))&&We(e,t)},b.emitNewLineBeforeLeadingComments=qe,b.emitNewLineBeforeLeadingCommentsOfPosition=Je,b.emitNewLineBeforeLeadingCommentOfPosition=function(e,t,r,n){r!==n&&C(e,r)!==C(e,n)&&t.writeLine()},b.emitComments=Ye,b.emitDetachedComments=function(t,e,r,n,i,s,a){var o,l;if(a?0===i.pos&&(o=b.filter(b.getLeadingCommentRanges(t,i.pos),function(e){return $(t,e)})):o=b.getLeadingCommentRanges(t,i.pos),o){for(var c=[],u=void 0,d=0,p=o;d<p.length;d++){var h=p[d];if(u)if(C(e,u.end)+2<=C(e,h.pos))break;c.push(h),u=h}c.length&&C(e,b.lastOrUndefined(c).end)+2<=C(e,b.skipTrivia(t,i.pos))&&(qe(e,r,i,o),Ye(t,e,r,c,!1,!0,s,n),l={nodePos:i.pos,detachedCommentEndPos:b.lastOrUndefined(c).end})}return l},b.writeCommentRange=function(e,t,r,n,i,s){if(42===e.charCodeAt(n+1))for(var a=b.computeLineAndCharacterOfPosition(t,n),o=t.length,l=void 0,c=n,u=a.line;c<i;u++){var d=u+1===o?e.length+1:t[u+1];if(c!==n){void 0===l&&(l=Xe(e,t[a.line],n));var p=r.getIndent()*S()-l+Xe(e,c,d);if(0<p){var h=p%S(),p=E((p-h)/S());for(r.rawWrite(p);h;)r.rawWrite(" "),h--}else r.rawWrite("")}y=_=f=g=m=p=void 0;var p=e,m=i,g=r,f=s,_=c,y=d;y=Math.min(m,y-1),(p=p.substring(_,y).replace(/^\s+|\s+$/g,""))?(g.write(p),y!==m&&g.writeLine()):g.writeLiteral(f),c=d}else r.write(e.substring(n,i))},b.hasModifiers=function(e){return 0!==Qe(e)},b.hasModifier=w,b.getSelectedModifierFlags=Ze,b.getModifierFlags=Qe,b.getModifierFlagsNoCache=et,b.modifierToFlag=tt,b.isLogicalOperator=function(e){return 54===e||53===e||51===e},b.isAssignmentOperator=I,b.tryGetClassExtendingExpressionWithTypeArguments=rt,b.isAssignmentExpression=nt,b.isDestructuringAssignment=function(e){return!!nt(e,!0)&&(178===(e=e.left.kind)||177===e)},b.isExpressionWithTypeArgumentsInClassExtendsClause=A,b.isExpressionWithTypeArgumentsInClassImplementsClause=function(e){return 201===e.kind&&D(e.expression)&&e.parent&&108===e.parent.token&&e.parent.parent&&b.isClassLike(e.parent.parent)},b.isEntityNameExpression=D,b.isRightSideOfQualifiedNameOrPropertyAccess=function(e){return 143===e.parent.kind&&e.parent.right===e||179===e.parent.kind&&e.parent.name===e},b.isEmptyObjectLiteral=function(e){return 178===e.kind&&0===e.properties.length},b.isEmptyArrayLiteral=function(e){return 177===e.kind&&0===e.elements.length},b.getLocalSymbolForExportDefault=function(e){return(t=e)&&0<b.length(t.declarations)&&w(t.declarations[0],512)?e.declarations[0].localSymbol:void 0;var t},b.tryExtractTypeScriptExtension=function(t){return b.find(b.supportedTypescriptExtensionsForExtractExtension,function(e){return b.fileExtensionIs(t,e)})};var N="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function O(e,t,r){void 0===e&&(e=0);var n=(e=>{var t,r=[];for(t in e){var n=e[t];"number"==typeof n&&r.push([n,t])}return b.stableSort(r,function(e,t){return b.compareValues(e[0],t[0])})})(t);if(0===e)return 0<n.length&&0===n[0][0]?n[0][1]:"0";if(r){for(var i="",s=e,a=n.length-1;0<=a&&0!==s;a--){var o=n[a],l=o[0],c=o[1];0!==l&&(s&l)===l&&(s&=~l,i=c+(i?", ":"")+i)}if(0===s)return i}else for(var u=0,d=n;u<d.length;u++){var p=d[u],l=p[0],c=p[1];if(l===e)return c}return e.toString()}function R(e,t){return{pos:e,end:t}}function it(e,t){return R(t,e.end)}function st(e){return e.decorators&&0<e.decorators.length?it(e,e.decorators.end):e}function at(e,t,r){return L(P(e,r),t.end,r)}function L(e,t,r){return e===t||He(r,e)===He(r,t)}function P(e,t){return b.positionIsSynthesized(e.pos)?-1:b.skipTrivia(t.text,e.pos)}function ot(e){return void 0!==e.initializer}function lt(e){return 33554432&e.flags?e.checkFlags:0}function ct(e){var t=e.parent;if(!t)return 0;switch(t.kind){case 193:case 192:var r=t.operator;return 43===r||44===r?n():0;case 194:return t.left===e&&I(t.operatorToken.kind)?n():0;case 179:return t.name!==e?0:ct(t);default:return 0}function n(){return t.parent&&210===t.parent.kind?1:2}}b.convertToBase64=function(e){for(var t,r,n,i,s="",a=(e=>{for(var t=[],r=e.length,n=0;n<r;n++){var i=e.charCodeAt(n);i<128?t.push(i):i<2048?(t.push(i>>6|192),t.push(63&i|128)):i<65536?(t.push(i>>12|224),t.push(i>>6&63|128),t.push(63&i|128)):i<131072?(t.push(i>>18|240),t.push(i>>12&63|128),t.push(i>>6&63|128),t.push(63&i|128)):b.Debug.assert(!1,"Unexpected code point")}return t})(e),o=0,l=a.length;o<l;)t=a[o]>>2,r=(3&a[o])<<4|a[o+1]>>4,n=(15&a[o+1])<<2|a[o+2]>>6,i=63&a[o+2],l<=o+1?n=i=64:l<=o+2&&(i=64),s+=N.charAt(t)+N.charAt(r)+N.charAt(n)+N.charAt(i),o+=3;return s},b.getNewLineCharacter=function(e,t){switch(e.newLine){case 0:return"\r\n";case 1:return"\n"}return t?t.newLine:b.sys?b.sys.newLine:"\r\n"},b.formatSyntaxKind=function(e){return O(e,b.SyntaxKind,!1)},b.formatModifierFlags=function(e){return O(e,b.ModifierFlags,!0)},b.formatTransformFlags=function(e){return O(e,b.TransformFlags,!0)},b.formatEmitFlags=function(e){return O(e,b.EmitFlags,!0)},b.formatSymbolFlags=function(e){return O(e,b.SymbolFlags,!0)},b.formatTypeFlags=function(e){return O(e,b.TypeFlags,!0)},b.formatObjectFlags=function(e){return O(e,b.ObjectFlags,!0)},b.createRange=R,b.moveRangeEnd=function(e,t){return R(e.pos,t)},b.moveRangePos=it,b.moveRangePastDecorators=st,b.moveRangePastModifiers=function(e){return e.modifiers&&0<e.modifiers.length?it(e,e.modifiers.end):st(e)},b.isCollapsedRange=function(e){return e.pos===e.end},b.createTokenRange=function(e,t){return R(e,e+b.tokenToString(t).length)},b.rangeIsOnSingleLine=function(e,t){return at(e,e,t)},b.rangeStartPositionsAreOnSameLine=function(e,t,r){return L(P(e,r),P(t,r),r)},b.rangeEndPositionsAreOnSameLine=function(e,t,r){return L(e.end,t.end,r)},b.rangeStartIsOnSameLineAsRangeEnd=at,b.rangeEndIsOnSameLineAsRangeStart=function(e,t,r){return L(e.end,P(t,r),r)},b.positionsAreOnSameLine=L,b.getStartPositionOfRange=P,b.isDeclarationNameOfEnumOrNamespace=function(e){var t=b.getParseTreeNode(e);if(t)switch(t.parent.kind){case 232:case 233:return t===t.parent.name}return!1},b.getInitializedVariables=function(e){return b.filter(e.declarations,ot)},b.isWatchSet=function(e){return e.watch&&e.hasOwnProperty("watch")},b.getCheckFlags=lt,b.getDeclarationModifierFlagsFromSymbol=function(e){var t;return e.valueDeclaration?(t=b.getCombinedModifierFlags(e.valueDeclaration),e.parent&&32&e.parent.flags?t:-29&t):6&lt(e)?(256&(t=e.checkFlags)?8:64&t?4:16)|(512&t?32:0):4194304&e.flags?36:0},b.levenshtein=function(e,t){for(var r=new Array(t.length+1),n=new Array(t.length+1),i=0;i<t.length+1;i++)n[r[i]=i]=-1;for(i=1;i<e.length+1;i++){n[0]=i;for(var s=1;s<t.length+1;s++)n[s]=Math.min(r[s]+1,n[s-1]+1,r[s-1]+(e[i-1]===t[s-1]?0:2));var a=r,r=n,n=a}return r[r.length-1]},b.skipAlias=function(e,t){return 2097152&e.flags?t.getAliasedSymbol(e):e},b.getCombinedLocalAndExportSymbolFlags=function(e){return e.exportSymbol?e.exportSymbol.flags|e.flags:e.flags},b.isWriteOnlyAccess=function(e){return 1===ct(e)},b.isWriteAccess=function(e){return 0!==ct(e)},b.compareDataObjects=function e(t,r){if(!t||!r||Object.keys(t).length!==Object.keys(r).length)return!1;for(var n in t)if("object"==typeof t[n]){if(!e(t[n],r[n]))return!1}else if("function"!=typeof t[n]&&t[n]!==r[n])return!1;return!0},b.clearMap=function(e,t){e.forEach(t),e.clear()},b.mutateMap=function(n,i,e){var r=e.createNewValue,s=e.onDeleteValue,a=e.onExistingValue;n.forEach(function(e,t){var r=i.get(t);void 0===r?(n.delete(t),s(e,t)):a&&a(e,r,t)}),i.forEach(function(e,t){n.has(t)||n.set(t,r(t,e))})},b.forEachAncestorDirectory=function(e,t){for(;;){var r=t(e);if(void 0!==r)return r;r=b.getDirectoryPath(e);if(r===e)return;e=r}}})(ts=ts||{}),(p=>{function h(e){return e.start+e.length}function t(e){return 0===e.length}function r(e,t){if(e<0)throw new Error("start < 0");if(t<0)throw new Error("length < 0");return{start:e,length:t}}function m(e,t){return r(e,t-e)}function g(e,t){if(t<0)throw new Error("newLength < 0");return{span:e,newLength:t}}function n(e){return!!p.isBindingPattern(e)&&p.every(e.elements,i)}function i(e){return!!p.isOmittedExpression(e)||n(e.name)}function s(e){for(;e&&(176===e.kind||p.isBindingPattern(e));)e=e.parent;return e}function a(e,t){if(e)for(;void 0!==e.original;)e=e.original;return!t||t(e)?e:void 0}function o(e){return 0==(8&e.flags)}function l(e){return 3<=e.length&&95===e.charCodeAt(0)&&95===e.charCodeAt(1)&&95===e.charCodeAt(2)?e.substr(1):e}function c(e){e=d(e);return p.isIdentifier(e)?e:void 0}function u(e){return e.name||(e=>{var t=e.parent.parent;if(t){if(p.isDeclaration(t))return c(t);switch(t.kind){case 208:return t.declarationList&&t.declarationList.declarations[0]?c(t.declarationList.declarations[0]):void 0;case 210:var r=t.expression;switch(r.kind){case 179:return r.name;case 180:var n=r.argumentExpression;if(p.isIdentifier(n))return n}return;case 1:return;case 185:return c(t.expression);case 222:return p.isDeclaration(t.statement)||p.isExpression(t.statement)?c(t.statement):void 0;default:p.Debug.assertNever(t,"Found typedef tag attached to node which it should not be!")}}})(e)}function d(e){if(e){switch(e.kind){case 284:case 279:var t=e.name;if(143===t.kind)return t.right;break;case 194:var r=e;switch(p.getSpecialPropertyAssignmentKind(r)){case 1:case 4:case 5:case 3:return r.left.name;default:return}case 283:return u(e);case 243:t=e.expression;return p.isIdentifier(t)?t:void 0}return e.name}}function f(e){var t;if(e.name&&p.isIdentifier(e.name))return t=e.name.escapedText,y(e.parent).filter(function(e){return p.isJSDocParameterTag(e)&&p.isIdentifier(e.name)&&e.name.escapedText===t})}function _(e){return b(e,280)}function y(e){var t=e.jsDocCache;return void 0===t&&(e.jsDocCache=t=p.flatMap(p.getJSDocCommentsAndTags(e),function(e){return p.isJSDoc(e)?e.tags:e})),t}function b(e,t){e=y(e);return p.find(e,function(e){return e.kind===t})}p.getDefaultLibFileName=function(e){switch(e.target){case 5:return"lib.esnext.full.d.ts";case 4:return"lib.es2017.full.d.ts";case 3:return"lib.es2016.full.d.ts";case 2:return"lib.es6.d.ts";default:return"lib.d.ts"}},p.textSpanEnd=h,p.textSpanIsEmpty=t,p.textSpanContainsPosition=function(e,t){return t>=e.start&&t<h(e)},p.textSpanContainsTextSpan=function(e,t){return t.start>=e.start&&h(t)<=h(e)},p.textSpanOverlapsWith=function(e,t){return Math.max(e.start,t.start)<Math.min(h(e),h(t))},p.textSpanOverlap=function(e,t){var r=Math.max(e.start,t.start),e=Math.min(h(e),h(t));if(r<e)return m(r,e)},p.textSpanIntersectsWithTextSpan=function(e,t){return t.start<=h(e)&&h(t)>=e.start},p.textSpanIntersectsWith=function(e,t,r){return t<=h(e)&&t+r>=e.start},p.decodedTextSpanIntersectsWith=function(e,t,r,n){return r<=e+t&&e<=r+n},p.textSpanIntersectsWithPosition=function(e,t){return t<=h(e)&&t>=e.start},p.textSpanIntersection=function(e,t){var r=Math.max(e.start,t.start),e=Math.min(h(e),h(t));if(r<=e)return m(r,e)},p.createTextSpan=r,p.createTextSpanFromBounds=m,p.textChangeRangeNewSpan=function(e){return r(e.span.start,e.newLength)},p.textChangeRangeIsUnchanged=function(e){return t(e.span)&&0===e.newLength},p.createTextChangeRange=g,p.unchangedTextChangeRange=g(r(0,0),0),p.collapseTextChangeRangesAcrossMultipleVersions=function(e){if(0===e.length)return p.unchangedTextChangeRange;if(1===e.length)return e[0];for(var t=e[0],r=t.span.start,n=h(t.span),i=r+t.newLength,s=1;s<e.length;s++)var a=r,o=n,l=i,c=(d=e[s]).span.start,u=h(d.span),d=c+d.newLength,r=Math.min(a,c),n=Math.max(o,o+(u-l)),i=Math.max(d,d+(l-u));return g(m(r,n),i-r)},p.getTypeParameterOwner=function(e){if(e&&145===e.kind)for(var t=e;t;t=t.parent)if(p.isFunctionLike(t)||p.isClassLike(t)||230===t.kind)return t},p.isParameterPropertyDeclaration=function(e){return p.hasModifier(e,92)&&152===e.parent.kind&&p.isClassLike(e.parent.parent)},p.isEmptyBindingPattern=n,p.isEmptyBindingElement=i,p.getCombinedModifierFlags=function(e){e=s(e);var t=p.getModifierFlags(e);return(e=226===e.kind?e.parent:e)&&227===e.kind&&(t|=p.getModifierFlags(e),e=e.parent),e&&208===e.kind&&(t|=p.getModifierFlags(e)),t},p.getCombinedNodeFlags=function(e){var t=(e=s(e)).flags;return(e=226===e.kind?e.parent:e)&&227===e.kind&&(t|=e.flags,e=e.parent),e&&208===e.kind&&(t|=e.flags),t},p.validateLocaleAndSetLanguage=function(e,i,t){var r;function n(e,t,r){var n=p.normalizePath(i.getExecutingFilePath()),n=p.getDirectoryPath(n),n=p.combinePaths(n,e),n=i.resolvePath(p.combinePaths(n=t?n+"-"+t:n,"diagnosticMessages.generated.json"));if(i.fileExists(n)){e="";try{e=i.readFile(n)}catch(e){return void(r&&r.push(p.createCompilerDiagnostic(p.Diagnostics.Unable_to_open_file_0,n)))}try{p.localizedDiagnosticMessages=JSON.parse(e)}catch(e){return void(r&&r.push(p.createCompilerDiagnostic(p.Diagnostics.Corrupted_locale_file_0,n)))}return 1}}(e=/^([a-z]+)([_\-]([a-z]+))?$/.exec(e.toLowerCase()))?n(r=e[1],e[3],t)||n(r,void 0,t):t&&t.push(p.createCompilerDiagnostic(p.Diagnostics.Locale_must_be_of_the_form_language_or_language_territory_For_example_0_or_1,"en","ja-jp"))},p.getOriginalNode=a,p.isParseTreeNode=o,p.getParseTreeNode=function(e,t){return void 0!==e&&!o(e)&&(!o(e=a(e))||t&&!t(e))?void 0:e},p.unescapeLeadingUnderscores=l,p.idText=function(e){return l(e.escapedText)},p.symbolName=function(e){return l(e.escapedName)},p.unescapeIdentifier=function(e){return e},p.getNameOfJSDocTypedef=u,p.getNameOfDeclaration=d,p.getJSDocParameterTags=f,p.hasJSDocParameterTags=function(e){return!!b(e,279)},p.getJSDocAugmentsTag=function(e){return b(e,277)},p.getJSDocClassTag=function(e){return b(e,278)},p.getJSDocReturnTag=_,p.getJSDocTemplateTag=function(e){return b(e,282)},p.getJSDocTypeTag=function(e){if((e=b(e,281))&&e.typeExpression&&e.typeExpression.type)return e},p.getJSDocType=function(e){var t=b(e,281);return t||146!==e.kind||(e=f(e))&&(t=p.find(e,function(e){return!!e.typeExpression})),t&&t.typeExpression&&t.typeExpression.type},p.getJSDocReturnType=function(e){return(e=_(e))&&e.typeExpression&&e.typeExpression.type},p.getJSDocTags=y,p.getAllJSDocTagsOfKind=function(e,t){return e=y(e),p.filter(e,function(e){return e.kind===t})}})(ts=ts||{}),(e=>{e.isNumericLiteral=function(e){return 8===e.kind},e.isStringLiteral=function(e){return 9===e.kind},e.isJsxText=function(e){return 10===e.kind},e.isRegularExpressionLiteral=function(e){return 12===e.kind},e.isNoSubstitutionTemplateLiteral=function(e){return 13===e.kind},e.isTemplateHead=function(e){return 14===e.kind},e.isTemplateMiddle=function(e){return 15===e.kind},e.isTemplateTail=function(e){return 16===e.kind},e.isIdentifier=function(e){return 71===e.kind},e.isQualifiedName=function(e){return 143===e.kind},e.isComputedPropertyName=function(e){return 144===e.kind},e.isTypeParameterDeclaration=function(e){return 145===e.kind},e.isParameter=function(e){return 146===e.kind},e.isDecorator=function(e){return 147===e.kind},e.isPropertySignature=function(e){return 148===e.kind},e.isPropertyDeclaration=function(e){return 149===e.kind},e.isMethodSignature=function(e){return 150===e.kind},e.isMethodDeclaration=function(e){return 151===e.kind},e.isConstructorDeclaration=function(e){return 152===e.kind},e.isGetAccessorDeclaration=function(e){return 153===e.kind},e.isSetAccessorDeclaration=function(e){return 154===e.kind},e.isCallSignatureDeclaration=function(e){return 155===e.kind},e.isConstructSignatureDeclaration=function(e){return 156===e.kind},e.isIndexSignatureDeclaration=function(e){return 157===e.kind},e.isTypePredicateNode=function(e){return 158===e.kind},e.isTypeReferenceNode=function(e){return 159===e.kind},e.isFunctionTypeNode=function(e){return 160===e.kind},e.isConstructorTypeNode=function(e){return 161===e.kind},e.isTypeQueryNode=function(e){return 162===e.kind},e.isTypeLiteralNode=function(e){return 163===e.kind},e.isArrayTypeNode=function(e){return 164===e.kind},e.isTupleTypeNode=function(e){return 165===e.kind},e.isUnionTypeNode=function(e){return 166===e.kind},e.isIntersectionTypeNode=function(e){return 167===e.kind},e.isParenthesizedTypeNode=function(e){return 168===e.kind},e.isThisTypeNode=function(e){return 169===e.kind},e.isTypeOperatorNode=function(e){return 170===e.kind},e.isIndexedAccessTypeNode=function(e){return 171===e.kind},e.isMappedTypeNode=function(e){return 172===e.kind},e.isLiteralTypeNode=function(e){return 173===e.kind},e.isObjectBindingPattern=function(e){return 174===e.kind},e.isArrayBindingPattern=function(e){return 175===e.kind},e.isBindingElement=function(e){return 176===e.kind},e.isArrayLiteralExpression=function(e){return 177===e.kind},e.isObjectLiteralExpression=function(e){return 178===e.kind},e.isPropertyAccessExpression=function(e){return 179===e.kind},e.isElementAccessExpression=function(e){return 180===e.kind},e.isCallExpression=function(e){return 181===e.kind},e.isNewExpression=function(e){return 182===e.kind},e.isTaggedTemplateExpression=function(e){return 183===e.kind},e.isTypeAssertion=function(e){return 184===e.kind},e.isParenthesizedExpression=function(e){return 185===e.kind},e.skipPartiallyEmittedExpressions=function(e){for(;288===e.kind;)e=e.expression;return e},e.isFunctionExpression=function(e){return 186===e.kind},e.isArrowFunction=function(e){return 187===e.kind},e.isDeleteExpression=function(e){return 188===e.kind},e.isTypeOfExpression=function(e){return 191===e.kind},e.isVoidExpression=function(e){return 190===e.kind},e.isAwaitExpression=function(e){return 191===e.kind},e.isPrefixUnaryExpression=function(e){return 192===e.kind},e.isPostfixUnaryExpression=function(e){return 193===e.kind},e.isBinaryExpression=function(e){return 194===e.kind},e.isConditionalExpression=function(e){return 195===e.kind},e.isTemplateExpression=function(e){return 196===e.kind},e.isYieldExpression=function(e){return 197===e.kind},e.isSpreadElement=function(e){return 198===e.kind},e.isClassExpression=function(e){return 199===e.kind},e.isOmittedExpression=function(e){return 200===e.kind},e.isExpressionWithTypeArguments=function(e){return 201===e.kind},e.isAsExpression=function(e){return 202===e.kind},e.isNonNullExpression=function(e){return 203===e.kind},e.isMetaProperty=function(e){return 204===e.kind},e.isTemplateSpan=function(e){return 205===e.kind},e.isSemicolonClassElement=function(e){return 206===e.kind},e.isBlock=function(e){return 207===e.kind},e.isVariableStatement=function(e){return 208===e.kind},e.isEmptyStatement=function(e){return 209===e.kind},e.isExpressionStatement=function(e){return 210===e.kind},e.isIfStatement=function(e){return 211===e.kind},e.isDoStatement=function(e){return 212===e.kind},e.isWhileStatement=function(e){return 213===e.kind},e.isForStatement=function(e){return 214===e.kind},e.isForInStatement=function(e){return 215===e.kind},e.isForOfStatement=function(e){return 216===e.kind},e.isContinueStatement=function(e){return 217===e.kind},e.isBreakStatement=function(e){return 218===e.kind},e.isReturnStatement=function(e){return 219===e.kind},e.isWithStatement=function(e){return 220===e.kind},e.isSwitchStatement=function(e){return 221===e.kind},e.isLabeledStatement=function(e){return 222===e.kind},e.isThrowStatement=function(e){return 223===e.kind},e.isTryStatement=function(e){return 224===e.kind},e.isDebuggerStatement=function(e){return 225===e.kind},e.isVariableDeclaration=function(e){return 226===e.kind},e.isVariableDeclarationList=function(e){return 227===e.kind},e.isFunctionDeclaration=function(e){return 228===e.kind},e.isClassDeclaration=function(e){return 229===e.kind},e.isInterfaceDeclaration=function(e){return 230===e.kind},e.isTypeAliasDeclaration=function(e){return 231===e.kind},e.isEnumDeclaration=function(e){return 232===e.kind},e.isModuleDeclaration=function(e){return 233===e.kind},e.isModuleBlock=function(e){return 234===e.kind},e.isCaseBlock=function(e){return 235===e.kind},e.isNamespaceExportDeclaration=function(e){return 236===e.kind},e.isImportEqualsDeclaration=function(e){return 237===e.kind},e.isImportDeclaration=function(e){return 238===e.kind},e.isImportClause=function(e){return 239===e.kind},e.isNamespaceImport=function(e){return 240===e.kind},e.isNamedImports=function(e){return 241===e.kind},e.isImportSpecifier=function(e){return 242===e.kind},e.isExportAssignment=function(e){return 243===e.kind},e.isExportDeclaration=function(e){return 244===e.kind},e.isNamedExports=function(e){return 245===e.kind},e.isExportSpecifier=function(e){return 246===e.kind},e.isMissingDeclaration=function(e){return 247===e.kind},e.isExternalModuleReference=function(e){return 248===e.kind},e.isJsxElement=function(e){return 249===e.kind},e.isJsxSelfClosingElement=function(e){return 250===e.kind},e.isJsxOpeningElement=function(e){return 251===e.kind},e.isJsxClosingElement=function(e){return 252===e.kind},e.isJsxAttribute=function(e){return 253===e.kind},e.isJsxAttributes=function(e){return 254===e.kind},e.isJsxSpreadAttribute=function(e){return 255===e.kind},e.isJsxExpression=function(e){return 256===e.kind},e.isCaseClause=function(e){return 257===e.kind},e.isDefaultClause=function(e){return 258===e.kind},e.isHeritageClause=function(e){return 259===e.kind},e.isCatchClause=function(e){return 260===e.kind},e.isPropertyAssignment=function(e){return 261===e.kind},e.isShorthandPropertyAssignment=function(e){return 262===e.kind},e.isSpreadAssignment=function(e){return 263===e.kind},e.isEnumMember=function(e){return 264===e.kind},e.isSourceFile=function(e){return 265===e.kind},e.isBundle=function(e){return 266===e.kind},e.isJSDocTypeExpression=function(e){return 267===e.kind},e.isJSDocAllType=function(e){return 268===e.kind},e.isJSDocUnknownType=function(e){return 269===e.kind},e.isJSDocNullableType=function(e){return 270===e.kind},e.isJSDocNonNullableType=function(e){return 271===e.kind},e.isJSDocOptionalType=function(e){return 272===e.kind},e.isJSDocFunctionType=function(e){return 273===e.kind},e.isJSDocVariadicType=function(e){return 274===e.kind},e.isJSDoc=function(e){return 275===e.kind},e.isJSDocAugmentsTag=function(e){return 277===e.kind},e.isJSDocParameterTag=function(e){return 279===e.kind},e.isJSDocReturnTag=function(e){return 280===e.kind},e.isJSDocTypeTag=function(e){return 281===e.kind},e.isJSDocTemplateTag=function(e){return 282===e.kind},e.isJSDocTypedefTag=function(e){return 283===e.kind},e.isJSDocPropertyTag=function(e){return 284===e.kind},e.isJSDocPropertyLikeTag=function(e){return 284===e.kind||279===e.kind},e.isJSDocTypeLiteral=function(e){return 285===e.kind}})(ts=ts||{}),(r=>{function t(e){return 143<=e}function n(e){return 8<=e&&e<=13}function i(e){switch(e){case 117:case 120:case 76:case 124:case 79:case 84:case 114:case 112:case 113:case 131:case 115:return!0}return!1}function s(e){return e&&o(e.kind)}function a(e){switch(e){case 228:case 151:case 152:case 153:case 154:case 186:case 187:return!0;default:return!1}}function o(e){switch(e){case 150:case 155:case 156:case 157:case 160:case 273:case 161:return!0;default:return a(e)}}function l(e){switch(e.kind){case 174:case 178:return!0}return!1}function c(e){switch(e.kind){case 175:case 177:return!0}return!1}function u(e){switch(e){case 179:case 180:case 182:case 181:case 249:case 250:case 183:case 177:case 185:case 178:case 199:case 186:case 71:case 12:case 8:case 9:case 13:case 196:case 86:case 95:case 99:case 101:case 97:case 203:case 204:case 91:return!0;default:return!1}}function d(e){switch(e){case 192:case 193:case 188:case 189:case 190:case 191:case 184:return!0;default:return u(e)}}function p(e){var t=r.skipPartiallyEmittedExpressions(e).kind;switch(t){case 195:case 197:case 187:case 194:case 198:case 202:case 200:case 289:case 288:return!0;default:return d(t)}}function h(e){return 288===e.kind}function m(e){return 287===e.kind}function g(e){return 228===e||247===e||229===e||230===e||231===e||232===e||233===e||238===e||237===e||244===e||243===e||236===e}function f(e){return 218===e||217===e||225===e||212===e||210===e||209===e||215===e||216===e||214===e||211===e||222===e||219===e||221===e||223===e||224===e||208===e||213===e||220===e||287===e||291===e||290===e}function _(e){return 276<=e.kind&&e.kind<=285}r.isSyntaxList=function(e){return 286===e.kind},r.isNode=function(e){return t(e.kind)},r.isNodeKind=t,r.isToken=function(e){return 0<=e.kind&&e.kind<=142},r.isNodeArray=function(e){return e.hasOwnProperty("pos")&&e.hasOwnProperty("end")},r.isLiteralKind=n,r.isLiteralExpression=function(e){return n(e.kind)},r.isTemplateLiteralKind=function(e){return 13<=e&&e<=16},r.isTemplateMiddleOrTemplateTail=function(e){return 15===(e=e.kind)||16===e},r.isStringTextContainingNode=function(e){switch(e.kind){case 9:case 14:case 15:case 16:case 13:return!0;default:return!1}},r.isGeneratedIdentifier=function(e){return r.isIdentifier(e)&&0<e.autoGenerateKind},r.isModifierKind=i,r.isModifier=function(e){return i(e.kind)},r.isEntityName=function(e){return 143===(e=e.kind)||71===e},r.isPropertyName=function(e){return 71===(e=e.kind)||9===e||8===e||144===e},r.isBindingName=function(e){return 71===(e=e.kind)||174===e||175===e},r.isFunctionLike=s,r.isFunctionLikeDeclaration=function(e){return e&&a(e.kind)},r.isFunctionLikeKind=o,r.isFunctionOrModuleBlock=function(e){return r.isSourceFile(e)||r.isModuleBlock(e)||r.isBlock(e)&&s(e.parent)},r.isClassElement=function(e){return 152===(e=e.kind)||149===e||151===e||153===e||154===e||157===e||206===e||247===e},r.isClassLike=function(e){return e&&(229===e.kind||199===e.kind)},r.isAccessor=function(e){return e&&(153===e.kind||154===e.kind)},r.isTypeElement=function(e){return 156===(e=e.kind)||155===e||148===e||150===e||157===e||247===e},r.isObjectLiteralElementLike=function(e){return 261===(e=e.kind)||262===e||263===e||151===e||153===e||154===e||247===e},r.isTypeNode=function(e){return 158<=(e=e.kind)&&e<=173||119===e||133===e||134===e||122===e||136===e||137===e||99===e||105===e||139===e||95===e||130===e||201===e||268===e||269===e||270===e||271===e||272===e||273===e||274===e},r.isFunctionOrConstructorTypeNode=function(e){switch(e.kind){case 160:case 161:return!0}return!1},r.isBindingPattern=function(e){return!!e&&(175===(e=e.kind)||174===e)},r.isAssignmentPattern=function(e){return 177===(e=e.kind)||178===e},r.isArrayBindingElement=function(e){return 176===(e=e.kind)||200===e},r.isDeclarationBindingElement=function(e){switch(e.kind){case 226:case 146:case 176:return!0}return!1},r.isBindingOrAssignmentPattern=function(e){return l(e)||c(e)},r.isObjectBindingOrAssignmentPattern=l,r.isArrayBindingOrAssignmentPattern=c,r.isPropertyAccessOrQualifiedName=function(e){return 179===(e=e.kind)||143===e},r.isCallLikeExpression=function(e){switch(e.kind){case 251:case 250:case 181:case 182:case 183:case 147:return!0;default:return!1}},r.isCallOrNewExpression=function(e){return 181===e.kind||182===e.kind},r.isTemplateLiteral=function(e){return 196===(e=e.kind)||13===e},r.isLeftHandSideExpression=function(e){return u(r.skipPartiallyEmittedExpressions(e).kind)},r.isUnaryExpression=function(e){return d(r.skipPartiallyEmittedExpressions(e).kind)},r.isUnaryExpressionWithWrite=function(e){switch(e.kind){case 193:return!0;case 192:return 43===e.operator||44===e.operator;default:return!1}},r.isExpression=p,r.isAssertionExpression=function(e){return 184===(e=e.kind)||202===e},r.isPartiallyEmittedExpression=h,r.isNotEmittedStatement=m,r.isNotEmittedOrPartiallyEmittedNode=function(e){return m(e)||h(e)},r.isIterationStatement=function e(t,r){switch(t.kind){case 214:case 215:case 216:case 212:case 213:return!0;case 222:return r&&e(t.statement,r)}return!1},r.isForInOrOfStatement=function(e){return 215===e.kind||216===e.kind},r.isConciseBody=function(e){return r.isBlock(e)||p(e)},r.isFunctionBody=function(e){return r.isBlock(e)},r.isForInitializer=function(e){return r.isVariableDeclarationList(e)||p(e)},r.isModuleBody=function(e){return 234===(e=e.kind)||233===e||71===e},r.isNamespaceBody=function(e){return 234===(e=e.kind)||233===e},r.isJSDocNamespaceBody=function(e){return 71===(e=e.kind)||233===e},r.isNamedImportBindings=function(e){return 241===(e=e.kind)||240===e},r.isModuleOrEnumDeclaration=function(e){return 233===e.kind||232===e.kind},r.isDeclaration=function(e){return 145===e.kind?282!==e.parent.kind||r.isInJavaScriptFile(e):187===(e=e.kind)||176===e||229===e||199===e||152===e||232===e||264===e||246===e||228===e||186===e||153===e||239===e||237===e||242===e||230===e||253===e||151===e||150===e||233===e||236===e||240===e||146===e||261===e||149===e||148===e||154===e||262===e||231===e||145===e||226===e||283===e},r.isDeclarationStatement=function(e){return g(e.kind)},r.isStatementButNotDeclaration=function(e){return f(e.kind)},r.isStatement=function(e){var t=e.kind;return f(t)||g(t)||(e=>207===e.kind&&(void 0===e.parent||224!==e.parent.kind&&260!==e.parent.kind)&&!r.isFunctionBlock(e))(e)},r.isModuleReference=function(e){return 248===(e=e.kind)||143===e||71===e},r.isJsxTagNameExpression=function(e){return 99===(e=e.kind)||71===e||179===e},r.isJsxChild=function(e){return 249===(e=e.kind)||256===e||250===e||10===e},r.isJsxAttributeLike=function(e){return 253===(e=e.kind)||255===e},r.isStringLiteralOrJsxExpression=function(e){return 9===(e=e.kind)||256===e},r.isJsxOpeningLikeElement=function(e){return 251===(e=e.kind)||250===e},r.isCaseOrDefaultClause=function(e){return 257===(e=e.kind)||258===e},r.isJSDocNode=function(e){return 267<=e.kind&&e.kind<=285},r.isJSDocCommentContainingNode=function(e){return 275===e.kind||_(e)},r.isJSDocTag=_,r.isSetAccessor=function(e){return 154===e.kind},r.isGetAccessor=function(e){return 153===e.kind},r.hasJSDocNodes=function(e){return!!e.jsDoc&&0<e.jsDoc.length}})(ts=ts||{}),(D=>{var n,i,d,p,k,e,h,m,g,f,_,y,z,N,O,W,q,J,l,b,Y,R,X,o,Z;function s(e,t){return t&&e(t)}function a(e,t,r){if(r){if(t)return t(r);for(var n=0,i=r;n<i.length;n++){var s=e(i[n]);if(s)return s}}}function x(e,t,r){if(e&&!(e.kind<=142))switch(e.kind){case 143:return s(t,e.left)||s(t,e.right);case 145:return s(t,e.name)||s(t,e.constraint)||s(t,e.default)||s(t,e.expression);case 262:return a(t,r,e.decorators)||a(t,r,e.modifiers)||s(t,e.name)||s(t,e.questionToken)||s(t,e.equalsToken)||s(t,e.objectAssignmentInitializer);case 263:return s(t,e.expression);case 146:case 149:case 148:case 261:case 226:case 176:return a(t,r,e.decorators)||a(t,r,e.modifiers)||s(t,e.propertyName)||s(t,e.dotDotDotToken)||s(t,e.name)||s(t,e.questionToken)||s(t,e.type)||s(t,e.initializer);case 160:case 161:case 155:case 156:case 157:return a(t,r,e.decorators)||a(t,r,e.modifiers)||a(t,r,e.typeParameters)||a(t,r,e.parameters)||s(t,e.type);case 151:case 150:case 152:case 153:case 154:case 186:case 228:case 187:return a(t,r,e.decorators)||a(t,r,e.modifiers)||s(t,e.asteriskToken)||s(t,e.name)||s(t,e.questionToken)||a(t,r,e.typeParameters)||a(t,r,e.parameters)||s(t,e.type)||s(t,e.equalsGreaterThanToken)||s(t,e.body);case 159:return s(t,e.typeName)||a(t,r,e.typeArguments);case 158:return s(t,e.parameterName)||s(t,e.type);case 162:return s(t,e.exprName);case 163:return a(t,r,e.members);case 164:return s(t,e.elementType);case 165:return a(t,r,e.elementTypes);case 166:case 167:return a(t,r,e.types);case 168:case 170:return s(t,e.type);case 171:return s(t,e.objectType)||s(t,e.indexType);case 172:return s(t,e.readonlyToken)||s(t,e.typeParameter)||s(t,e.questionToken)||s(t,e.type);case 173:return s(t,e.literal);case 174:case 175:case 177:return a(t,r,e.elements);case 178:return a(t,r,e.properties);case 179:return s(t,e.expression)||s(t,e.name);case 180:return s(t,e.expression)||s(t,e.argumentExpression);case 181:case 182:return s(t,e.expression)||a(t,r,e.typeArguments)||a(t,r,e.arguments);case 183:return s(t,e.tag)||s(t,e.template);case 184:return s(t,e.type)||s(t,e.expression);case 185:case 188:case 189:case 190:return s(t,e.expression);case 192:return s(t,e.operand);case 197:return s(t,e.asteriskToken)||s(t,e.expression);case 191:return s(t,e.expression);case 193:return s(t,e.operand);case 194:return s(t,e.left)||s(t,e.operatorToken)||s(t,e.right);case 202:return s(t,e.expression)||s(t,e.type);case 203:return s(t,e.expression);case 204:return s(t,e.name);case 195:return s(t,e.condition)||s(t,e.questionToken)||s(t,e.whenTrue)||s(t,e.colonToken)||s(t,e.whenFalse);case 198:return s(t,e.expression);case 207:case 234:return a(t,r,e.statements);case 265:return a(t,r,e.statements)||s(t,e.endOfFileToken);case 208:return a(t,r,e.decorators)||a(t,r,e.modifiers)||s(t,e.declarationList);case 227:return a(t,r,e.declarations);case 210:return s(t,e.expression);case 211:return s(t,e.expression)||s(t,e.thenStatement)||s(t,e.elseStatement);case 212:return s(t,e.statement)||s(t,e.expression);case 213:return s(t,e.expression)||s(t,e.statement);case 214:return s(t,e.initializer)||s(t,e.condition)||s(t,e.incrementor)||s(t,e.statement);case 215:return s(t,e.initializer)||s(t,e.expression)||s(t,e.statement);case 216:return s(t,e.awaitModifier)||s(t,e.initializer)||s(t,e.expression)||s(t,e.statement);case 217:case 218:return s(t,e.label);case 219:return s(t,e.expression);case 220:return s(t,e.expression)||s(t,e.statement);case 221:return s(t,e.expression)||s(t,e.caseBlock);case 235:return a(t,r,e.clauses);case 257:return s(t,e.expression)||a(t,r,e.statements);case 258:return a(t,r,e.statements);case 222:return s(t,e.label)||s(t,e.statement);case 223:return s(t,e.expression);case 224:return s(t,e.tryBlock)||s(t,e.catchClause)||s(t,e.finallyBlock);case 260:return s(t,e.variableDeclaration)||s(t,e.block);case 147:return s(t,e.expression);case 229:case 199:case 230:return a(t,r,e.decorators)||a(t,r,e.modifiers)||s(t,e.name)||a(t,r,e.typeParameters)||a(t,r,e.heritageClauses)||a(t,r,e.members);case 231:return a(t,r,e.decorators)||a(t,r,e.modifiers)||s(t,e.name)||a(t,r,e.typeParameters)||s(t,e.type);case 232:return a(t,r,e.decorators)||a(t,r,e.modifiers)||s(t,e.name)||a(t,r,e.members);case 264:return s(t,e.name)||s(t,e.initializer);case 233:return a(t,r,e.decorators)||a(t,r,e.modifiers)||s(t,e.name)||s(t,e.body);case 237:return a(t,r,e.decorators)||a(t,r,e.modifiers)||s(t,e.name)||s(t,e.moduleReference);case 238:return a(t,r,e.decorators)||a(t,r,e.modifiers)||s(t,e.importClause)||s(t,e.moduleSpecifier);case 239:return s(t,e.name)||s(t,e.namedBindings);case 236:case 240:return s(t,e.name);case 241:case 245:return a(t,r,e.elements);case 244:return a(t,r,e.decorators)||a(t,r,e.modifiers)||s(t,e.exportClause)||s(t,e.moduleSpecifier);case 242:case 246:return s(t,e.propertyName)||s(t,e.name);case 243:return a(t,r,e.decorators)||a(t,r,e.modifiers)||s(t,e.expression);case 196:return s(t,e.head)||a(t,r,e.templateSpans);case 205:return s(t,e.expression)||s(t,e.literal);case 144:return s(t,e.expression);case 259:return a(t,r,e.types);case 201:return s(t,e.expression)||a(t,r,e.typeArguments);case 248:return s(t,e.expression);case 247:return a(t,r,e.decorators);case 289:return a(t,r,e.elements);case 249:return s(t,e.openingElement)||a(t,r,e.children)||s(t,e.closingElement);case 250:case 251:return s(t,e.tagName)||s(t,e.attributes);case 254:return a(t,r,e.properties);case 253:return s(t,e.name)||s(t,e.initializer);case 255:return s(t,e.expression);case 256:return s(t,e.dotDotDotToken)||s(t,e.expression);case 252:return s(t,e.tagName);case 267:case 271:case 270:case 272:return s(t,e.type);case 273:return a(t,r,e.parameters)||s(t,e.type);case 274:return s(t,e.type);case 275:return a(t,r,e.tags);case 279:case 284:return e.isNameFirst?s(t,e.name)||s(t,e.typeExpression):s(t,e.typeExpression)||s(t,e.name);case 280:case 281:return s(t,e.typeExpression);case 277:return s(t,e.class);case 282:return a(t,r,e.typeParameters);case 283:return e.typeExpression&&267===e.typeExpression.kind?s(t,e.typeExpression)||s(t,e.fullName):s(t,e.fullName)||s(t,e.typeExpression);case 285:if(e.jsDocPropertyTags)for(var n=0,i=e.jsDocPropertyTags;n<i.length;n++)s(t,i[n]);return;case 288:return s(t,e.expression)}}function Q(e){return 4===e||2===e||1===e||6===e?1:0}function ee(e,t,r,n){h=D.objectAllocator.getNodeConstructor(),m=D.objectAllocator.getTokenConstructor(),g=D.objectAllocator.getIdentifierConstructor(),f=D.objectAllocator.getSourceFileConstructor(),O=e,z=r,y=[],l=0,q=D.createMap(),W=J=0,b=1===n||2===n||6===n?65536:0,o=!1,R.setText(O),R.setOnError(_e),R.setScriptTarget(t),R.setLanguageVariant(Q(n))}function te(){R.setText(""),R.setOnError(void 0),O=z=q=_=y=void 0}function E(e){var t=D.getJSDocCommentRanges(e,_.text,_.compileOptions);if(t)for(var r=0,n=t;r<n.length;r++){var i=n[r],i=Y.parseJSDocComment(e,i.pos,i.end-i.pos,_.compileOptions);i&&(e.jsDoc||(e.jsDoc=[]),e.jsDoc.push(i))}return e}function re(e){var a=e;x(e,function e(t){if(t.parent!==a){var r=t.parent=a;if(x(a=t,e),D.hasJSDocNodes(t))for(var n=0,i=t.jsDoc;n<i.length;n++){var s=i[n];s.parent=t,x(a=s,e)}a=r}})}function ne(e,t,r,n){var i=new f(265,0,O.length);return W++,i.text=O,i.bindDiagnostics=[],i.languageVersion=t,i.fileName=D.normalizePath(e),i.languageVariant=Q(r),i.isDeclarationFile=D.fileExtensionIs(i.fileName,".d.ts"),i.scriptKind=r,i.compileOptions=n,i}function ie(e,t){e?b|=t:b&=~t}function se(e){ie(e,2048)}function ae(e){ie(e,4096)}function oe(e){ie(e,8192)}function le(e){ie(e,16384)}function ce(e,t){var r,e=e&b;return e?(ie(!1,e),r=t(),ie(!0,e),r):t()}function ue(e,t){var r,e=e&~b;return e?(ie(!0,e),r=t(),ie(!1,e),r):t()}function c(e){return ce(2048,e)}function de(e){return ue(16384,e)}function t(e){return 0!=(b&e)}function pe(){return t(4096)}function he(){return t(2048)}function me(){return t(8192)}function ge(){return t(16384)}function fe(e,t){var r=R.getTokenPos();L(r,R.getTextPos()-r,e,t)}function L(e,t,r,n){var i=D.lastOrUndefined(y);i&&e===i.start||y.push(D.createFileDiagnostic(_,e,t,r,n)),o=!0}function _e(e,t){L(R.getTextPos(),t||0,e)}function P(){return R.getStartPos()}function S(){return N=R.scan()}function ye(){return N=R.reScanGreaterToken()}function r(){N=R.scanJsxIdentifier()}function be(){N=R.scanJsxToken()}function ve(e,t){var r=N,n=y.length,i=o,s=b,e=t?R.lookAhead(e):R.tryScan(e);return D.Debug.assert(s===b),e&&!t||(N=r,y.length=n,o=i),e}function C(e){return ve(e,!0)}function M(e){return ve(e,!1)}function w(){return 71===N||!(116===N&&pe()||121===N&&ge())&&107<N}function F(e,t,r){return void 0===r&&(r=!0),N===e?(r&&S(),!0):(t?fe(t):fe(D.Diagnostics._0_expected,D.tokenToString(e)),!1)}function B(e){return N===e&&(S(),!0)}function u(e){if(N===e)return v()}function Te(e,t,r,n){return u(e)||xe(e,t,r,n)}function v(){var e=$(N);return S(),V(e)}function ke(){return 25===N||18===N||1===N||R.hasPrecedingLineBreak()}function I(){ke()?25===N&&S():F(25)}function $(e,t){return W++,0<=t||(t=R.getStartPos()),new(D.isNodeKind(e)?h:71===e?g:m)(e,t,t)}function U(e,t,r){var n=e.length,n=1<=n&&n<=4?e.slice():e;return n.pos=t,n.end=void 0===r?R.getStartPos():r,n}function V(e,t){return e.end=void 0===t?R.getStartPos():t,b&&(e.flags|=b),o&&(o=!1,e.flags|=32768),e}function xe(e,t,r,n){t?L(R.getStartPos(),0,r,n):fe(r,n);t=$(e,R.getStartPos());return 71===e?t.escapedText="":(D.isLiteralKind(e)||D.isTemplateLiteralKind(e))&&(t.text=""),V(t)}function Ee(e){var t=q.get(e);return void 0===t&&q.set(e,t=e),t}function Se(e,t){return J++,e?(e=$(71),71!==N&&(e.originalKeywordKind=N),e.escapedText=D.escapeLeadingUnderscores(Ee(R.getTokenValue())),S(),V(e)):xe(71,1===N,t||D.Diagnostics.Identifier_expected)}function A(e){return Se(w(),e)}function Ce(e){return Se(D.tokenIsIdentifierOrKeyword(N),e)}function we(){return D.tokenIsIdentifierOrKeyword(N)||9===N||8===N}function Ie(e){var t;return 9===N||8===N?((t=Ze()).text=Ee(t.text),t):e&&21===N?(t=$(144),F(21),t.expression=c(j),F(22),V(t)):Ce()}function Ae(){return Ie(!0)}function De(e){return N===e&&M(Oe)}function Ne(){return S(),!R.hasPrecedingLineBreak()&&Re()}function Oe(){return 76===N?83===S():84===N?(S(),79===N?C(Le):39!==N&&118!==N&&17!==N&&Re()):(79===N?Le:115===N?(S(),Re):Ne)()}function Re(){return 21===N||17===N||39===N||24===N||we()}function Le(){return S(),75===N||89===N||109===N||117===N&&C(Tr)||120===N&&C(kr)}function Pe(e,t){if(je(e))return 1;switch(e){case 0:case 1:case 3:return(25!==N||!t)&&Cr();case 2:return 73===N||79===N;case 4:return C(mt);case 5:return C(Gr)||25===N&&!t;case 6:return 21===N||we();case 12:return 21===N||39===N||24===N||we();case 17:return we();case 9:return 21===N||24===N||we();case 7:return 17===N?C(Me):t?w()&&!$e():Pt()&&!$e();case 8:return Or();case 10:return 26===N||24===N||Or();case 18:return w();case 11:case 15:return 26===N||24===N||Mt();case 16:return at();case 19:case 20:return 26===N||St();case 21:return en();case 22:return D.tokenIsIdentifierOrKeyword(N);case 13:return D.tokenIsIdentifierOrKeyword(N)||17===N;case 14:return 1}D.Debug.fail("Non-exhaustive case in 'isListElement'.")}function Me(){var e;return D.Debug.assert(17===N),18!==S()||26===(e=S())||17===e||85===e||108===e}function Fe(){return S(),w()}function Be(){return S(),D.tokenIsIdentifierOrKeyword(N)}function $e(){return(108===N||85===N)&&C(Ue)}function Ue(){return S(),Mt()}function Ve(e){if(1===N)return 1;switch(e){case 1:case 2:case 4:case 5:case 6:case 12:case 9:case 22:return 18===N;case 3:return 18===N||73===N||79===N;case 7:return 17===N||85===N||108===N;case 8:return ke()||Kt(N)||36===N;case 18:return 29===N||19===N||17===N||85===N||108===N;case 11:return 20===N||25===N;case 15:case 20:case 10:return 22===N;case 16:case 17:return 20===N||22===N;case 19:return 26!==N;case 21:return 17===N||18===N;case 13:return 29===N||41===N;case 14:return 27===N&&C(an)}}function He(e,t){for(var r=l,n=(l|=1<<e,[]),i=P();!Ve(e);)if(Pe(e,!1)){var s=Ge(e,t);n.push(s)}else if(Ke(e))break;return l=r,U(n,i)}function Ge(e,t){var e=je(e);return e?(e=e,R.setTextPos(e.end),S(),e):t()}function je(e){if(!o&&z){var t=z.currentNode(R.getStartPos());if(!D.nodeIsMissing(t)&&!t.intersectsChange&&!D.containsParseError(t)){var r=96256&t.flags;if(r===b&&((e,t)=>{switch(t){case 5:return(e=>{if(e)switch(e.kind){case 152:case 157:case 153:case 154:case 149:case 206:return 1;case 151:var t=e;return!(71===t.name.kind&&123===t.name.originalKeywordKind)}})(e);case 2:return(e=>{if(e)switch(e.kind){case 257:case 258:return 1}})(e);case 0:case 1:case 3:return(e=>{if(e)switch(e.kind){case 228:case 208:case 207:case 211:case 210:case 223:case 219:case 221:case 218:case 217:case 215:case 216:case 214:case 213:case 220:case 209:case 224:case 222:case 212:case 225:case 238:case 237:case 244:case 243:case 233:case 229:case 230:case 232:case 231:return 1}})(e);case 6:return 264===e.kind;case 4:return(e=>{if(e)switch(e.kind){case 156:case 150:case 157:case 148:case 155:return 1}})(e);case 8:return(e=>226===e.kind&&void 0===e.initializer)(e);case 16:return(e=>146===e.kind&&void 0===e.initializer)(e);case 17:return}})(t,e))return t}}}function Ke(e){if(fe((e=>{switch(e){case 0:case 1:return D.Diagnostics.Declaration_or_statement_expected;case 2:return D.Diagnostics.case_or_default_expected;case 3:return D.Diagnostics.Statement_expected;case 17:case 4:return D.Diagnostics.Property_or_signature_expected;case 5:return D.Diagnostics.Unexpected_token_A_constructor_method_accessor_or_property_was_expected;case 6:return D.Diagnostics.Enum_member_expected;case 7:return D.Diagnostics.Expression_expected;case 8:return D.Diagnostics.Variable_declaration_expected;case 9:return D.Diagnostics.Property_destructuring_pattern_expected;case 10:return D.Diagnostics.Array_element_destructuring_pattern_expected;case 11:return D.Diagnostics.Argument_expression_expected;case 12:return D.Diagnostics.Property_assignment_expected;case 15:return D.Diagnostics.Expression_or_comma_expected;case 16:return D.Diagnostics.Parameter_declaration_expected;case 18:return D.Diagnostics.Type_parameter_declaration_expected;case 19:return D.Diagnostics.Type_argument_expected;case 20:return D.Diagnostics.Type_expected;case 21:return D.Diagnostics.Unexpected_token_expected;case 22:case 13:case 14:return D.Diagnostics.Identifier_expected}})(e)),(()=>{for(var e=0;e<23;e++)if(l&1<<e&&(Pe(e,!0)||Ve(e)))return 1})())return 1;S()}function H(e,t,r){for(var n=l,i=(l|=1<<e,[]),s=P(),a=-1;;)if(Pe(e,!1)){var o=R.getStartPos();if(i.push(Ge(e,t)),a=R.getTokenPos(),!B(26)){if(a=-1,Ve(e))break;F(26),r&&25===N&&!R.hasPrecedingLineBreak()&&S(),o===R.getStartPos()&&S()}}else{if(Ve(e))break;if(Ke(e))break}l=n;n=U(i,s);return 0<=a&&(n.hasTrailingComma=!0),n}function ze(){return U([],P())}function We(e,t,r,n){return F(r)?(r=H(e,t),F(n),r):ze()}function qe(e,t){for(var r=(e?Ce:A)(t),n=R.getStartPos();B(23);){if(27===N){r.jsdocDotPos=n;break}n=R.getStartPos(),r=Je(r,Ye(e))}return r}function Je(e,t){var r=$(143,e.pos);return r.left=e,r.right=t,V(r)}function Ye(e){if(R.hasPrecedingLineBreak()&&D.tokenIsIdentifierOrKeyword(N)&&C(vr))return xe(71,!0,D.Diagnostics.Identifier_expected);return(e?Ce:A)()}function Xe(){for(var e=$(196),t=(e.head=(r=Qe(N),D.Debug.assert(14===r.kind,"Template head has wrong token kind"),r),D.Debug.assert(14===e.head.kind,"Template head has wrong token kind"),[]),r=P();t.push((()=>{var e,t=$(205);return t.expression=c(j),e=18===N?(N=R.reScanTemplateToken(),(()=>{var e=Qe(N);return D.Debug.assert(15===e.kind||16===e.kind,"Template fragment has wrong token kind"),e})()):Te(16,!1,D.Diagnostics._0_expected,D.tokenToString(18)),t.literal=e,V(t)})()),15===D.lastOrUndefined(t).literal.kind;);return e.templateSpans=U(t,r),V(e)}function Ze(){return Qe(N)}function Qe(e){var e=$(e),t=R.getTokenValue();return e.text=t,R.hasExtendedUnicodeEscape()&&(e.hasExtendedUnicodeEscape=!0),R.isUnterminated()&&(e.isUnterminated=!0),8===e.kind&&(e.numericLiteralFlags=R.getNumericLiteralFlags()),S(),V(e),e}function et(){var e=$(159);return e.typeName=qe(!0,D.Diagnostics.Type_expected),R.hasPrecedingLineBreak()||27!==N||(e.typeArguments=We(19,G,27,29)),V(e)}function tt(){var e=$(146);return 99!==N&&94!==N||(e.name=Ce(),F(56)),e.type=G(),V(e)}function rt(e){e=$(e);return S(),e.type=Et(),V(e)}function nt(){var e=$(145);return e.name=A(),B(85)&&(St()||!Mt()?e.constraint=G():e.expression=Jt()),B(58)&&(e.default=G()),V(e)}function it(){if(27===N)return We(18,nt,27,29)}function st(){if(B(56))return G()}function at(){return 24===N||Or()||D.isModifierKind(N)||57===N||St(!0)}function ot(e){var t=$(146);return 99===N?(t.name=Se(!0),t.type=st(),V(t)):(t.decorators=jr(),t.modifiers=Kr(),t.dotDotDotToken=u(24),t.name=Rr(),0===D.getFullWidth(t.name)&&!D.hasModifiers(t)&&D.isModifierKind(N)&&S(),t.questionToken=u(55),t.type=st(),t.initializer=Ft(!0,e),E(V(t)))}function lt(e,t,r){32&t||(r.typeParameters=it()),r.parameters=(e=>{var t,r,n;return F(19)?(t=pe(),r=ge(),ae(!!(1&e)),le(!!(2&e)),n=H(16,32&e?tt:function(){return ot(!!(8&e))}),ae(t),le(r),!F(20)&&8&e?void 0:n):8&e?void 0:ze()})(t),r.type=((e,t)=>36===e?(F(e),1):B(56)||t&&36===N&&(fe(D.Diagnostics._0_expected,D.tokenToString(56)),S(),1))(e,!!(4&t))?(()=>{var e,t=w()&&M(Ot),r=G();return t?((e=$(158,t.pos)).parameterName=t,e.type=r,V(e)):r})():void 0}function ct(){B(26)||I()}function ut(e){var t=$(e);return 156===e&&F(94),lt(56,4,t),ct(),E(V(t))}function dt(){return 21===N&&C(pt)}function pt(){if(S(),24===N||22===N)return!0;if(D.isModifierKind(N)){if(S(),w())return!0}else{if(!w())return!1;S()}return 56===N||26===N||55===N&&(S(),56===N||26===N||22===N)}function ht(e,t,r){e=$(157,e);return e.decorators=t,e.modifiers=r,e.parameters=We(16,ot,21,22),e.type=Lt(),ct(),E(V(e))}function mt(){if(19===N||27===N)return!0;for(var e;D.isModifierKind(N);)e=!0,S();return 21===N||(we()&&(e=!0,S()),!!e&&(19===N||27===N||55===N||56===N||26===N||ke()))}function gt(){var e,t,r,n,i;return 19===N||27===N?ut(155):94===N&&C(ft)?ut(156):(e=P(),t=Kr(),dt()?ht(e,void 0,t):(e=e,t=t,n=Ae(),i=u(55),19===N||27===N?((r=$(150,e)).modifiers=t,r.name=n,r.questionToken=i,lt(56,4,r),ct(),E(V(r))):((r=$(148,e)).modifiers=t,r.name=n,r.questionToken=i,r.type=Lt(),58===N&&(r.initializer=Vr()),ct(),E(V(r)))))}function ft(){return S(),19===N||27===N}function _t(){var e;return F(17)?(e=He(4,gt),F(18)):e=ze(),e}function yt(){return S(),131===N&&S(),21===N&&Fe()&&92===S()}function bt(){var e,t=$(172);return F(17),t.readonlyToken=u(131),F(21),t.typeParameter=((e=$(145)).name=A(),F(92),e.constraint=G(),V(e)),F(22),t.questionToken=u(55),t.type=Lt(),I(),F(18),V(t)}function vt(e){var t=$(e);return 161===e&&F(94),lt(36,4,t),E(V(t))}function Tt(){var e=v();return 23===N?void 0:e}function kt(e){var t,r=$(173),n=(e&&((t=$(192)).operator=38,S()),101===N||86===N?v():Qe(N));return e&&(t.operand=n,V(t),n=t),r.literal=n,V(r)}function xt(){return 8===S()}function Et(){switch(N){case 119:case 136:case 133:case 122:case 137:case 139:case 130:case 134:return M(Tt)||et();case 39:return s=$(268),S(),V(s);case 55:return s=R.getStartPos(),S(),26===N||18===N||20===N||29===N||58===N||49===N?V(i=$(269,s)):((i=$(270,s)).type=G(),V(i));case 89:return C(sn)?(n=$(273),S(),lt(56,36,n),E(V(n))):((n=$(159)).typeName=Ce(),V(n));case 24:return rt(274);case 51:return rt(271);case 13:case 9:case 8:case 101:case 86:return kt();case 38:return C(xt)?kt(!0):et();case 105:case 95:return v();case 99:i=$(169),S();n=V(i);return 126!==N||R.hasPrecedingLineBreak()?n:(t=n,S(),(r=$(158,t.pos)).parameterName=t,r.type=G(),V(r));case 103:return t=$(162),F(103),t.exprName=qe(!0),V(t);case 17:return C(yt)?bt():((r=$(163)).members=_t(),V(r));case 21:return(e=$(165)).elementTypes=We(20,G,21,22),V(e);case 19:return e=$(168),F(19),e.type=G(),F(20),V(e);default:return et()}var e,t,r,n,i,s}function St(e){switch(N){case 119:case 136:case 133:case 122:case 137:case 105:case 139:case 95:case 99:case 103:case 130:case 17:case 21:case 27:case 49:case 48:case 94:case 9:case 8:case 101:case 86:case 134:case 39:case 55:case 51:case 24:return!0;case 38:return!e&&C(xt);case 19:return!e&&C(Ct);default:return w()}}function Ct(){return S(),20===N||at()||St()}function wt(e,t){S();e=$(e,t.pos);return e.type=t,V(e)}function It(){if(127===N)return e=127,t=$(170),F(e),t.operator=e,t.type=It(),V(t);for(var e,t,r,n=Et();!R.hasPrecedingLineBreak();)switch(N){case 58:if(!(1048576&b))return n;n=wt(272,n);break;case 51:n=wt(271,n);break;case 55:n=wt(270,n);break;case 21:F(21),n=(St()?((r=$(171,n.pos)).objectType=n,r.indexType=G()):(r=$(164,n.pos)).elementType=n,F(22),V(r));break;default:return n}return n}function At(e,t,r){B(r);var n=t();if(N===r){for(var i=[n];B(r);)i.push(t());e=$(e,n.pos);e.types=U(i,n.pos),n=V(e)}return n}function Dt(){return At(167,It,48)}function Nt(){if(S(),20===N||24===N)return!0;if(D.isModifierKind(N)&&Kr(),w()||99===N?(S(),1):21===N||17===N?(e=y.length,Rr(),e===y.length):void 0){if(56===N||26===N||55===N||58===N)return!0;if(20===N&&(S(),36===N))return!0}var e;return!1}function Ot(){var e=A();if(126===N&&!R.hasPrecedingLineBreak())return S(),e}function G(){return ce(20480,Rt)}function Rt(){return 27===N||19===N&&C(Nt)?vt(160):94===N?vt(161):At(166,Dt,49)}function Lt(){return B(56)?G():void 0}function Pt(){switch(N){case 99:case 97:case 95:case 101:case 86:case 8:case 9:case 13:case 14:case 19:case 21:case 17:case 89:case 75:case 94:case 41:case 63:case 71:return!0;case 91:return C(ft);default:return w()}}function Mt(){if(Pt())return!0;switch(N){case 37:case 38:case 52:case 51:case 80:case 103:case 105:case 43:case 44:case 27:case 121:case 116:return!0;default:return(()=>(!he()||92!==N)&&0<Wt())()?!0:w()}}function j(){for(var e,t=me(),r=(t&&oe(!1),K());e=u(26);)r=qt(r,e,K());return t&&oe(!0),r}function Ft(e,t){if(58!==N){if(R.hasPrecedingLineBreak()||e&&17===N||!Mt())return;if(e&&t)return(e=xe(71,!0,D.Diagnostics._0_expected,"=")).escapedText="= not found",e}return F(58),K()}function K(){var e,t,r,n;return(()=>116===N&&(pe()||C(xr)))()?(e=$(197),S(),R.hasPrecedingLineBreak()||39!==N&&!Mt()||(e.asteriskToken=u(39),e.expression=K()),V(e)):(()=>{var e,t,r=19!==N&&27!==N&&120!==N?36!==N?0:1:C($t);return 0!==r&&(r=1===r?Ht(!0):M(Ut))?(e=D.hasModifier(r,256),t=N,r.equalsGreaterThanToken=Te(36,!1,D.Diagnostics._0_expected,"=>"),r.body=36===t||17===t?Gt(e):A(),E(V(r))):void 0})()||(()=>{var e;if(120===N&&1===C(Vt))return e=zr(),Bt(jt(0),e)})()||(71===(e=jt(0)).kind&&36===N?Bt(e):D.isLeftHandSideExpression(e)&&D.isAssignmentOperator(ye())?qt(e,v(),K()):(t=e,(n=u(55))?((r=$(195,t.pos)).condition=t,r.questionToken=n,r.whenTrue=ce(X,K),r.colonToken=Te(56,!1,D.Diagnostics._0_expected,D.tokenToString(56)),r.whenFalse=K(),V(r)):t))}function Bt(e,t){D.Debug.assert(36===N,"parseSimpleArrowFunctionExpression should only have been called if we had a =>"),t?(r=$(187,t.pos)).modifiers=t:r=$(187,e.pos);var r,n=$(146,e.pos);return n.name=e,V(n),r.parameters=U([n],n.pos,n.end),r.equalsGreaterThanToken=Te(36,!1,D.Diagnostics._0_expected,"=>"),r.body=Gt(!!t),E(V(r))}function $t(){if(120===N){if(S(),R.hasPrecedingLineBreak())return 0;if(19!==N&&27!==N)return 0}var e=N,t=S();if(19!==e)return D.Debug.assert(27===e),w()?1===_.languageVariant?C(function(){var e=S();if(85===e)switch(S()){case 58:case 29:return!1;default:return!0}else if(26===e)return!0;return!1})?1:0:2:0;if(20===t)switch(S()){case 36:case 56:case 17:return 1;default:return 0}return 21===t||17===t?2:24===t?1:w()?56===S()?1:2:0}function Ut(){return Ht(!1)}function Vt(){if(120===N){if(S(),R.hasPrecedingLineBreak()||36===N)return 0;var e=jt(0);if(!R.hasPrecedingLineBreak()&&71===e.kind&&36===N)return 1}return 0}function Ht(e){var t=$(187),r=(t.modifiers=zr(),D.hasModifier(t,256)?2:0);if(lt(56,r|(e?0:8),t),t.parameters&&(e||!(36!==N&&17!==N||D.find(t.parameters,function(e){return e.initializer&&D.isIdentifier(e.initializer)&&"= not found"===e.initializer.escapedText}))))return t}function Gt(e){return 17===N?gr(e?2:0):25===N||89===N||75===N||!Cr()||17!==N&&89!==N&&75!==N&&57!==N&&Mt()?e?de(K):ce(16384,K):gr(16|(e?2:0))}function jt(e){return zt(e,Jt())}function Kt(e){return 92===e||142===e}function zt(e,t){for(;;){ye();var r=Wt();if(!(40===N?e<=r:e<r))break;if(92===N&&he())break;if(118===N){if(R.hasPrecedingLineBreak())break;S(),n=t,i=G(),s=void 0,(s=$(202,n.pos)).expression=n,s.type=i,t=V(s)}else t=qt(t,v(),jt(r))}var n,i,s;return t}function Wt(){switch(N){case 54:return 1;case 53:return 2;case 49:return 3;case 50:return 4;case 48:return 5;case 32:case 33:case 34:case 35:return 6;case 27:case 29:case 30:case 31:case 93:case 92:case 118:return 7;case 45:case 46:case 47:return 8;case 37:case 38:return 9;case 39:case 41:case 42:return 10;case 40:return 11}return-1}function qt(e,t,r){var n=$(194,e.pos);return n.left=e,n.operatorToken=t,n.right=r,V(n)}function Jt(){var e,t,r;return(()=>{switch(N){case 37:case 38:case 52:case 51:case 80:case 103:case 105:case 121:return;case 27:if(1!==_.languageVariant)return;default:return 1}})()?(e=Xt(),40===N?zt(Wt(),e):e):(e=N,t=Yt(),40===N&&(r=D.skipTrivia(O,t.pos),184===t.kind?L(r,t.end-r,D.Diagnostics.A_type_assertion_expression_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_expression_Consider_enclosing_the_expression_in_parentheses):L(r,t.end-r,D.Diagnostics.An_unary_expression_with_the_0_operator_is_not_allowed_in_the_left_hand_side_of_an_exponentiation_expression_Consider_enclosing_the_expression_in_parentheses,D.tokenToString(e))),t)}function Yt(){switch(N){case 37:case 38:case 52:case 51:return(r=$(192)).operator=N,S(),r.operand=Yt(),V(r);case 80:return r=$(188),S(),r.expression=Yt(),V(r);case 103:return t=$(189),S(),t.expression=Yt(),V(t);case 105:return t=$(190),S(),t.expression=Yt(),V(t);case 27:return e=$(184),F(27),e.type=G(),F(29),e.expression=Yt(),V(e);case 121:if(121===N&&(ge()||C(xr)))return e=$(191),S(),e.expression=Yt(),V(e);default:return Xt()}var e,t,r}function Xt(){var e,t;return 43===N||44===N?((t=$(192)).operator=N,S(),t.operand=Zt(),V(t)):1===_.languageVariant&&27===N&&C(Be)?er(!0):(e=Zt(),D.Debug.assert(D.isLeftHandSideExpression(e)),43!==N&&44!==N||R.hasPrecedingLineBreak()?e:((t=$(193,e.pos)).operand=e,t.operator=N,S(),V(t)))}function Zt(){for(var e,t=(91===N&&C(ft)?(_.flags|=524288,v):97===N?()=>{var e,t=v();return 19===N||23===N||21===N?t:((e=$(179,t.pos)).expression=t,Te(23,!1,D.Diagnostics.super_must_be_followed_by_an_argument_list_or_member_access),e.name=Ye(!0),V(e))}:Qt)(),r=t;;){if(r=ir(r),27===N){var n=M(ar);if(!n)return r;(e=$(181,r.pos)).expression=r,e.typeArguments=n}else{if(19!==N)return r;(e=$(181,r.pos)).expression=r}e.arguments=sr(),r=V(e)}}function Qt(){return ir((()=>{switch(N){case 8:case 9:case 13:return Ze();case 99:case 97:case 95:case 101:case 86:return v();case 19:return(()=>{var e=$(185);return F(19),e.expression=c(j),F(20),E(V(e))})();case 21:return(()=>{var e=$(177);return F(21),R.hasPrecedingLineBreak()&&(e.multiLine=!0),e.elements=H(15,or),F(22),V(e)})();case 17:return dr();case 120:if(C(kr))return pr();break;case 75:return Jr(R.getStartPos(),void 0,void 0,199);case 89:return pr();case 94:return(()=>{var e,t=R.getStartPos();return(F(94),B(23))?((e=$(204,t)).keywordToken=94,e.name=Ce()):((e=$(182,t)).expression=Qt(),e.typeArguments=M(ar),!e.typeArguments&&19!==N||(e.arguments=sr())),V(e)})();case 41:case 63:if(12===(N=R.reScanSlashToken()))return Ze();break;case 14:return Xe()}return A(D.Diagnostics.Expression_expected)})())}function er(e){var t=(e=>{var t,r=R.getStartPos(),n=(F(27),tr()),i=(()=>{var e=$(254);return e.properties=He(13,nr),V(e)})();return 29===N?(t=$(251,r),be()):(F(41),e?F(29):(F(29,void 0,!1),be()),t=$(250,r)),t.tagName=n,t.attributes=i,V(t)})(e),r=251===t.kind?((r=$(249,t.pos)).openingElement=t,r.children=(e=>{var t=[],r=P(),n=l;for(l|=16384;;){if(28===(N=R.reScanJsxToken()))break;if(1===N){L(e.pos,e.end-e.pos,D.Diagnostics.JSX_element_0_has_no_corresponding_closing_tag,D.getTextOfNodeFromSourceText(O,e));break}if(7===N)break;var i=(()=>{switch(N){case 10:case 11:return(()=>{var e=$(10,R.getStartPos());return e.containsOnlyWhiteSpaces=11===N,N=R.scanJsxToken(),V(e)})();case 17:return rr(!1);case 27:return er(!1)}D.Debug.fail("Unknown JSX child kind "+N)})();i&&t.push(i)}return l=n,U(t,r)})(r.openingElement.tagName),r.closingElement=(e=>{var t=$(252);return F(28),t.tagName=tr(),e?F(29):(F(29,void 0,!1),be()),V(t)})(e),function e(t,r){return t.kind===r.kind&&(71===t.kind?t.escapedText===r.escapedText:99===t.kind||t.name.escapedText===r.name.escapedText&&e(t.expression,r.expression))}(r.openingElement.tagName,r.closingElement.tagName)||L(r.closingElement.pos,r.closingElement.end-r.closingElement.pos,D.Diagnostics.Expected_corresponding_JSX_closing_tag_for_0,D.getTextOfNodeFromSourceText(O,r.openingElement.tagName)),V(r)):(D.Debug.assert(250===t.kind),t);if(e&&27===N){t=M(function(){return er(!0)});if(t)return fe(D.Diagnostics.JSX_expressions_must_have_one_parent_element),(e=$(194,r.pos)).end=t.end,e.left=r,e.right=t,e.operatorToken=xe(26,!1,void 0),e.operatorToken.pos=e.operatorToken.end=e.right.pos,e}return r}function tr(){r();for(var e=(99===N?v:Ce)();B(23);){var t=$(179,e.pos);t.expression=e,t.name=Ye(!0),e=V(t)}return e}function rr(e){var t=$(256);return F(17),18!==N&&(t.dotDotDotToken=u(24),t.expression=K()),e?F(18):(F(18,void 0,!1),be()),V(t)}function nr(){var e;return 17===N?(e=$(255),F(17),F(24),e.expression=j(),F(18)):(r(),(e=$(253)).name=Ce(),58===N&&(9===(N=R.scanJsxAttributeValue())?e.initializer=Ze():e.initializer=rr(!0))),V(e)}function ir(e){for(;;)if(u(23)){var t=$(179,e.pos);t.expression=e,t.name=Ye(!0),e=V(t)}else if(51!==N||R.hasPrecedingLineBreak())if(!me()&&B(21)){t=$(180,e.pos);t.expression=e,22!==N&&(t.argumentExpression=c(j),9!==t.argumentExpression.kind&&8!==t.argumentExpression.kind||((r=t.argumentExpression).text=Ee(r.text))),F(22),e=V(t)}else{if(13!==N&&14!==N)return e;var r=$(183,e.pos);r.tag=e,r.template=(13===N?Ze:Xe)(),e=V(r)}else{S();var n=$(203,e.pos);n.expression=e,e=V(n)}}function sr(){F(19);var e=H(11,lr);return F(20),e}function ar(){var e;if(B(27))return e=H(19,G),F(29)&&e&&(()=>{switch(N){case 19:case 23:case 20:case 22:case 56:case 25:case 55:case 32:case 34:case 33:case 35:case 53:case 54:case 50:case 48:case 49:case 18:case 1:return 1;default:return}})()?e:void 0}function or(){return 24===N?(e=$(198),F(24),e.expression=K(),V(e)):26===N?$(200):K();var e}function lr(){return ce(X,or)}function cr(e,t,r){return De(125)?Hr(153,e,t,r):De(135)?Hr(154,e,t,r):void 0}function ur(){var e,t,r,n,i,s,a=R.getStartPos();return u(24)?((n=$(263,a)).expression=K(),E(V(n))):cr(a,n=jr(),e=Kr())||(i=u(39),s=w(),t=Ae(),r=u(55),i||19===N||27===N?$r(a,n,e,i,t,r):s&&(26===N||18===N||58===N)?((n=$(262,a)).name=t,n.questionToken=r,(i=u(58))&&(n.equalsToken=i,n.objectAssignmentInitializer=c(K)),E(V(n))):((s=$(261,a)).modifiers=e,s.name=t,s.questionToken=r,F(56),s.initializer=c(K),E(V(s))))}function dr(){var e=$(178);return F(17),R.hasPrecedingLineBreak()&&(e.multiLine=!0),e.properties=H(12,ur,!0),F(18),V(e)}function pr(){var e=me(),t=(e&&oe(!1),$(186)),r=(t.modifiers=Kr(),F(89),t.asteriskToken=u(39),t.asteriskToken?1:0),n=D.hasModifier(t,256)?2:0;return t.name=r&&n?ue(20480,hr):r?ue(4096,hr):n?de(hr):hr(),lt(56,r|n,t),t.body=gr(r|n),e&&oe(!0),E(V(t))}function hr(){return w()?A():void 0}function mr(e,t){var r=$(207);return F(17,t)||e?(R.hasPrecedingLineBreak()&&(r.multiLine=!0),r.statements=He(1,T),F(18)):r.statements=ze(),V(r)}function gr(e,t){var r=pe(),n=(ae(!!(1&e)),ge()),i=(le(!!(2&e)),me()),e=(i&&oe(!1),mr(!!(16&e),t));return i&&oe(!0),ae(r),le(n),e}function fr(){var e,t=P(),r=(F(88),u(121)),n=(F(19),void 0);return 25!==N&&(n=104===N||110===N||76===N?Pr(!0):ue(2048,j)),(r=(r?F:B)(142)?((e=$(216,t)).awaitModifier=r,e.initializer=n,e.expression=c(K),F(20),e):B(92)?((r=$(215,t)).initializer=n,r.expression=c(j),F(20),r):((e=$(214,t)).initializer=n,F(25),25!==N&&20!==N&&(e.condition=c(j)),F(25),20!==N&&(e.incrementor=c(j)),F(20),e)).statement=T(),V(r)}function _r(e){var t=$(e);return F(218===e?72:77),ke()||(t.label=A()),I(),V(t)}function yr(){return 73===N?(e=$(257),F(73),e.expression=c(j),F(56),e.statements=He(3,T),V(e)):(e=$(258),F(79),F(56),e.statements=He(3,T),V(e));var e}function br(){var e=$(224);return F(102),e.tryBlock=mr(!1),e.catchClause=74===N?(()=>{var e=$(260);return F(74),B(19)?(e.variableDeclaration=Lr(),F(20)):e.variableDeclaration=void 0,e.block=mr(!1),V(e)})():void 0,e.catchClause&&87!==N||(F(87),e.finallyBlock=mr(!1)),V(e)}function vr(){return S(),D.tokenIsIdentifierOrKeyword(N)&&!R.hasPrecedingLineBreak()}function Tr(){return S(),75===N&&!R.hasPrecedingLineBreak()}function kr(){return S(),89===N&&!R.hasPrecedingLineBreak()}function xr(){return S(),(D.tokenIsIdentifierOrKeyword(N)||8===N||9===N)&&!R.hasPrecedingLineBreak()}function Er(){for(;;)switch(N){case 104:case 110:case 76:case 89:case 75:case 83:return!0;case 109:case 138:return S(),!R.hasPrecedingLineBreak()&&w();case 128:case 129:return S(),!R.hasPrecedingLineBreak()&&(w()||9===N);case 117:case 120:case 124:case 112:case 113:case 114:case 131:if(S(),R.hasPrecedingLineBreak())return!1;continue;case 141:return S(),17===N||71===N||84===N;case 91:return S(),9===N||39===N||17===N||D.tokenIsIdentifierOrKeyword(N);case 84:if(S(),58===N||39===N||17===N||79===N||118===N)return!0;continue;case 115:S();continue;default:return!1}}function Sr(){return C(Er)}function Cr(){switch(N){case 57:case 25:case 17:case 104:case 110:case 89:case 75:case 83:case 90:case 81:case 106:case 88:case 77:case 72:case 96:case 107:case 98:case 100:case 102:case 78:case 74:case 87:return!0;case 91:return Sr()||C(ft);case 76:case 84:return Sr();case 120:case 124:case 109:case 128:case 129:case 138:case 141:return!0;case 114:case 112:case 113:case 115:case 131:return Sr()||!C(vr);default:return Mt()}}function wr(){return S(),w()||17===N||21===N}function T(){switch(N){case 25:return i=$(209),F(25),V(i);case 17:return mr(!1);case 104:return Fr(R.getStartPos(),void 0,void 0);case 110:if(C(wr))return Fr(R.getStartPos(),void 0,void 0);break;case 89:return Br(R.getStartPos(),void 0,void 0);case 75:return qr(R.getStartPos(),void 0,void 0);case 90:return i=$(211),F(90),F(19),i.expression=c(j),F(20),i.thenStatement=T(),i.elseStatement=B(82)?T():void 0,V(i);case 81:return n=$(212),F(81),n.statement=T(),F(106),F(19),n.expression=c(j),F(20),B(25),V(n);case 106:return n=$(213),F(106),F(19),n.expression=c(j),F(20),n.statement=T(),V(n);case 88:return fr();case 77:return _r(217);case 72:return _r(218);case 96:return r=$(219),F(96),ke()||(r.expression=c(j)),I(),V(r);case 107:return r=$(220),F(107),F(19),r.expression=c(j),F(20),r.statement=T(),V(r);case 98:return e=$(221),F(98),F(19),e.expression=c(j),F(20),t=$(235,R.getStartPos()),F(17),t.clauses=He(2,yr),F(18),e.caseBlock=V(t),V(e);case 100:return t=$(223),F(100),t.expression=R.hasPrecedingLineBreak()?void 0:c(j),I(),V(t);case 102:case 74:case 87:return br();case 78:return e=$(225),F(78),I(),V(e);case 57:return Ir();case 120:case 109:case 138:case 128:case 129:case 124:case 76:case 83:case 84:case 91:case 112:case 113:case 114:case 117:case 115:case 131:case 141:if(Sr())return Ir()}var e,t,r,n,i,s,a,o;return a=R.getStartPos(),71===(o=c(j)).kind&&B(56)?((s=$(222,a)).label=o,s.statement=T(),E(V(s))):((s=$(210,a)).expression=o,I(),E(V(s)))}function Ir(){var e=P(),t=jr(),r=Kr();switch(N){case 104:case 110:case 76:return Fr(e,t,r);case 89:return Br(e,t,r);case 75:return qr(e,t,r);case 109:var n=e,i=t,s=r;return(n=$(230,n)).decorators=i,n.modifiers=s,F(109),n.name=A(),n.typeParameters=it(),n.heritageClauses=Yr(),n.members=_t(),E(V(n));case 138:i=e,s=t,n=r;return(i=$(231,i)).decorators=s,i.modifiers=n,F(138),i.name=A(),i.typeParameters=it(),F(58),i.type=G(),I(),E(V(i));case 83:var a=e,o=t,l=r;return(a=$(232,a)).decorators=o,a.modifiers=l,F(83),a.name=A(),F(17)?(a.members=H(6,tn),F(18)):a.members=ze(),E(V(a));case 141:case 128:case 129:var o=e,l=t,a=r,c=0;if(141===N)return nn(o,l,a);if(B(129))c|=16;else if(F(128),9===N)return nn(o,l,a);return function e(t,r,n,i){t=$(233,t);var s=16&i;t.decorators=r;t.modifiers=n;t.flags|=i;t.name=A();t.body=B(23)?e(P(),void 0,void 0,4|s):rn();return E(V(t))}(o,l,a,c);case 91:var c=e,u=t,d=r;F(91);var p,h,m,g,f,_=R.getStartPos();return w()&&(p=A(),26!==N)&&140!==N?(m=u,g=d,f=p,(h=$(237,h=c)).decorators=m,h.modifiers=g,h.name=f,F(58),h.moduleReference=132===N&&C(sn)?(()=>{var e=$(248);return F(132),F(19),e.expression=on(),F(20),V(e)})():qe(!1),I(),E(V(h))):((c=$(238,c)).decorators=u,c.modifiers=d,!p&&39!==N&&17!==N||(c.importClause=((e,t)=>(t=$(239,t),e&&(t.name=e),t.name&&!B(26)||(t.namedBindings=39===N?(()=>{var e=$(240);return F(39),F(118),e.name=A(),V(e)})():ln(241)),V(t)))(p,_),F(140)),c.moduleSpecifier=on(),I(),V(c));case 84:switch(S(),N){case 79:case 58:var y=e,b=t,v=r;return(y=$(243,y)).decorators=b,y.modifiers=v,B(58)?y.isExportEquals=!0:F(79),y.expression=K(),I(),V(y);case 118:b=e,v=t,y=r;return(b=$(236,b)).decorators=v,b.modifiers=y,F(118),F(129),b.name=A(),I(),V(b);default:var T=e,k=t,x=r;return(T=$(244,T)).decorators=k,T.modifiers=x,(B(39)||(T.exportClause=ln(245),140===N)||9===N&&!R.hasPrecedingLineBreak())&&(F(140),T.moduleSpecifier=on()),I(),V(T)}default:if(t||r)return(m=xe(247,!0,D.Diagnostics.Declaration_expected)).pos=e,m.decorators=t,m.modifiers=r,V(m)}}function Ar(e,t){if(17===N||!ke())return gr(e,t);I()}function Dr(){var e;return 26===N?$(200):((e=$(176)).dotDotDotToken=u(24),e.name=Rr(),e.initializer=Ft(!1),V(e))}function Nr(){var e=$(176),t=(e.dotDotDotToken=u(24),w()),r=Ae();return t&&56!==N?e.name=r:(F(56),e.propertyName=r,e.name=Rr()),e.initializer=Ft(!1),V(e)}function Or(){return 17===N||21===N||w()}function Rr(){var e;return 21===N?(e=$(175),F(21),e.elements=H(10,Dr),F(22),V(e)):17===N?(e=$(174),F(17),e.elements=H(9,Nr),F(18),V(e)):A()}function Lr(){var e=$(226);return e.name=Rr(),e.type=Lt(),Kt(N)||(e.initializer=Vr()),V(e)}function Pr(e){var t,r=$(227);switch(N){case 104:break;case 110:r.flags|=1;break;case 76:r.flags|=2;break;default:D.Debug.fail()}return S(),142===N&&C(Mr)?r.declarations=ze():(t=he(),se(e),r.declarations=H(8,Lr),se(t)),V(r)}function Mr(){return Fe()&&20===S()}function Fr(e,t,r){e=$(208,e);return e.decorators=t,e.modifiers=r,e.declarationList=Pr(!1),I(),E(V(e))}function Br(e,t,r){e=$(228,e),e.decorators=t,e.modifiers=r,F(89),e.asteriskToken=u(39),e.name=(D.hasModifier(e,512)?hr:A)(),t=e.asteriskToken?1:0,r=D.hasModifier(e,256)?2:0;return lt(56,t|r,e),e.body=Ar(t|r,D.Diagnostics.or_expected),E(V(e))}function $r(e,t,r,n,i,s,a){e=$(151,e),e.decorators=t,e.modifiers=r,e.asteriskToken=n,e.name=i,e.questionToken=s,t=n?1:0,r=D.hasModifier(e,256)?2:0;return lt(56,t|r,e),e.body=Ar(t|r,a),E(V(e))}function Ur(e,t,r,n,i){e=$(149,e);return e.decorators=t,e.modifiers=r,e.name=n,e.questionToken=i,e.type=Lt(),e.initializer=D.hasModifier(e,32)?c(Vr):ce(6144,Vr),I(),E(V(e))}function Vr(){return Ft(!1)}function Hr(e,t,r,n){e=$(e,t);return e.decorators=r,e.modifiers=n,e.name=Ae(),lt(56,0,e),e.body=Ar(0),E(V(e))}function Gr(){var e;if(57===N)return!0;for(;D.isModifierKind(N);){if((e=>{switch(e){case 114:case 112:case 113:case 115:case 131:return 1;default:return}})(e=N))return!0;S()}if(39===N)return!0;if(we()&&(e=N,S()),21===N)return!0;if(void 0!==e){if(!D.isKeyword(e)||135===e||125===e)return!0;switch(N){case 19:case 27:case 56:case 58:case 55:return!0;default:return ke()}}return!1}function jr(){for(var e,t=P();;){var r=P();if(!B(57))break;r=$(147,r);r.expression=ue(8192,Zt),V(r),(e=e||[]).push(r)}return e&&U(e,t)}function Kr(e){for(var t,r=P();;){var n=R.getStartPos(),i=N;if(76===N&&e){if(!M(Ne))break}else if(!D.isModifierKind(N)||!M(Oe))break;i=V($(i,n));(t=t||[]).push(i)}return t&&U(t,r)}function zr(){var e,t;return 120===N&&(e=R.getStartPos(),t=N,S(),t=U([V($(t,e))],e)),t}function Wr(){var e,t,r,n,i,s,a,o,l;return 25===N?(e=$(206),S(),V(e)):(e=P(),t=jr(),r=Kr(!0),cr(e,t,r)||(123===N?(n=t,i=r,(s=$(152,s=e)).decorators=n,s.modifiers=i,F(123),lt(56,0,s),s.body=Ar(0,D.Diagnostics.or_expected),E(V(s))):dt()?ht(e,t,r):D.tokenIsIdentifierOrKeyword(N)||9===N||8===N||39===N||21===N?(n=e,i=t,s=r,l=u(39),a=Ae(),o=u(55),l||19===N||27===N?$r(n,i,s,l,a,o,D.Diagnostics.or_expected):Ur(n,i,s,a,o)):t||r?(l=xe(71,!0,D.Diagnostics.Declaration_expected),Ur(e,t,r,l,void 0)):void D.Debug.fail("Should not have attempted to parse class member declaration.")))}function qr(e,t,r){return Jr(e,t,r,229)}function Jr(e,t,r,n){n=$(n,e);return n.decorators=t,n.modifiers=r,F(75),n.name=!w()||108===N&&C(Be)?void 0:A(),n.typeParameters=it(),n.heritageClauses=Yr(),F(17)?(n.members=He(5,Wr),F(18)):n.members=ze(),E(V(n))}function Yr(){if(en())return He(21,Xr)}function Xr(){var e,t=N;if(85===t||108===t)return(e=$(259)).token=t,S(),e.types=H(7,Zr),V(e)}function Zr(){var e=$(201);return e.expression=Zt(),e.typeArguments=Qr(),V(e)}function Qr(){return 27===N?We(19,G,27,29):void 0}function en(){return 85===N||108===N}function tn(){var e=$(264,R.getStartPos());return e.name=Ae(),e.initializer=c(Vr),E(V(e))}function rn(){var e=$(234,R.getStartPos());return F(17)?(e.statements=He(1,T),F(18)):e.statements=ze(),V(e)}function nn(e,t,r){e=$(233,e);return e.decorators=t,e.modifiers=r,141===N?(e.name=A(),e.flags|=512):(e.name=Ze(),e.name.text=Ee(e.name.text)),17===N?e.body=rn():I(),V(e)}function sn(){return 19===S()}function an(){return 41===S()}function on(){var e;return 9===N?((e=Ze()).text=Ee(e.text),e):j()}function ln(e){var t=$(e);return t.elements=We(22,241===e?un:cn,17,18),V(t)}function cn(){return dn(246)}function un(){return dn(242)}function dn(e){var t=$(e),r=D.isKeyword(N)&&!w(),n=R.getTokenPos(),i=R.getTextPos(),s=Ce();return 118===N?(t.propertyName=s,F(118),r=D.isKeyword(N)&&!w(),n=R.getTokenPos(),i=R.getTextPos(),t.name=Ce()):t.name=s,242===e&&r&&L(n,i-n,D.Diagnostics.Identifier_expected),V(t)}function pn(e){var t=$(267,R.getTokenPos());if(F(17)||!e)return t.type=ue(1048576,G),F(18),re(t),V(t)}function hn(d,e,t){var p,h,m,g,r,f=O,_=(d=d||0,void 0===e?f.length:d+e),y=(e=_-d,D.Debug.assert(0<=d),D.Debug.assert(d<=_),D.Debug.assert(_<=f.length),[]);return t?.emitBlockCommentsAsJsDocs&&(t=d,47==(r=f).charCodeAt(t))&&47==r.charCodeAt(t+1)&&37==r.charCodeAt(t+2)?R.scanRange(d,e,function(){for(;1!==N&&4!==N;)y.push(R.getTokenText()),I();var e;b(y),v(y),(e=$(275,d)).tags=p&&U(p,h,m),e.comment=y.length?y.join(""):void 0,g=V(e,_)}):(r=d,47===(t=f).charCodeAt(r)&&42===t.charCodeAt(r+1)&&42===t.charCodeAt(r+2)&&42!==t.charCodeAt(r+3)&&R.scanRange(d+3,e-5,function(){var e,t=!0,r=1,n=void 0,i=d-Math.max(f.lastIndexOf("\n",d),0)+4;function s(e){n=n||i,y.push(e),i+=e.length}for(I();5===N;)I();for(4===N&&(i=r=0,I());1!==N;){switch(N){case 57:if(0===r||1===r){v(y),o=c=l=a=void 0;var a=i;D.Debug.assert(57===N);var o,l=$(57,R.getTokenPos()),c=(l.end=R.getTextPos(),I(),A());if(T(),c){if(c)switch(c.escapedText){case"augments":case"extends":o=((e,t)=>{var r=$(277,e.pos);return r.atToken=e,r.tagName=t,r.class=(()=>{var e=B(17),t=((t=$(201)).expression=(()=>{for(var e=A(!0);B(23);){var t=$(179,e.pos);t.expression=e,t.name=A(),e=V(t)}return e})(),t.typeArguments=Qr(),V(t));return e&&F(18),t})(),V(r)})(l,c);break;case"class":case"constructor":o=((e,t)=>{var r=$(278,e.pos);return r.atToken=e,r.tagName=t,V(r)})(l,c);break;case"arg":case"argument":case"param":o=S(l,c,1);break;case"return":case"returns":o=((e,t)=>{D.forEach(p,function(e){return 280===e.kind})&&L(t.pos,R.getTokenPos()-t.pos,D.Diagnostics._0_tag_already_specified,t.escapedText);var r=$(280,e.pos);return r.atToken=e,r.tagName=t,r.typeExpression=x(),V(r)})(l,c);break;case"template":o=((e,t)=>{D.forEach(p,function(e){return 282===e.kind})&&L(t.pos,R.getTokenPos()-t.pos,D.Diagnostics._0_tag_already_specified,t.escapedText);for(var r=[],n=P();;){var i=A();if(T(),!i)return void L(R.getStartPos(),0,D.Diagnostics.Identifier_expected);var s=$(145,i.pos);if(s.name=i,V(s),r.push(s),26!==N)break;I(),T()}var a=$(282,e.pos);return a.atToken=e,a.tagName=t,a.typeParameters=U(r,n),V(a),a})(l,c);break;case"type":o=C(l,c);break;case"typedef":o=((e,t)=>{var r=x(),n=(T(),$(283,e.pos));if(n.atToken=e,n.tagName=t,n.fullName=function e(t){var r=R.getTokenPos();var n=A();if(n&&B(23))return(r=$(233,r)).flags|=t,r.name=n,r.body=e(4),V(r);n&&4&t&&(n.isInJSDocNamespace=!0);return n}(0),n.fullName)for(var i=n.fullName;;){if(71===i.kind||!i.body){n.name=71===i.kind?i:i.name;break}i=i.body}if(T(),!(n.typeExpression=r)||E(r.type)){for(var s=void 0,a=void 0,o=void 0,l=R.getStartPos();s=M(function(){return w(0)});)if(a=a||$(285,l),281===s.kind){if(o)break;o=s}else a.jsDocPropertyTags||(a.jsDocPropertyTags=[]),a.jsDocPropertyTags.push(s);a&&(r&&164===r.type.kind&&(a.isArrayType=!0),n.typeExpression=o&&o.typeExpression&&!E(o.typeExpression.type)?o.typeExpression:V(a))}return V(n)})(l,c);break;default:o=k(l,c)}else o=k(l,c);o&&((e,t)=>{e.comment=t.join(""),p?p.push(e):(p=[e],h=e.pos),m=e.end})(o,(t=>{var r,e,n=[],i=0;function s(e){r=r||t,n.push(e),t+=e.length}for(;57!==N&&1!==N;){switch(N){case 4:1<=i&&(i=0,n.push(R.getTokenText())),t=0;break;case 57:break;case 5:2===i?s(R.getTokenText()):(e=R.getTokenText(),void 0!==r&&t+e.length>r&&n.push(e.slice(r-t-1)),t+=e.length);break;case 39:if(0===i){i=1,t+=R.getTokenText().length;break}default:i=2,s(R.getTokenText())}if(57===N)break;I()}return b(n),v(n),n})(a+o.end-o.pos))}t=!1,n=void(r=0),i++}else s(R.getTokenText());break;case 4:y.push(R.getTokenText()),i=r=0;break;case 39:a=R.getTokenText();1===r||2===r?(r=2,s(a)):(r=1,i+=a.length);break;case 71:s(R.getTokenText()),r=2;break;case 5:var u=R.getTokenText();2===r?y.push(u):void 0!==n&&i+u.length>n&&y.push(u.slice(n-i-1)),i+=u.length;break;case 1:break;default:r=2,s(R.getTokenText())}t?I():t=!0}b(y),v(y),(e=$(275,d)).tags=p&&U(p,h,m),e.comment=y.length?y.join(""):void 0,g=V(e,_)})),g;function b(e){for(;e.length&&("\n"===e[0]||"\r"===e[0]);)e.shift()}function v(e){for(;e.length&&("\n"===e[e.length-1]||"\r"===e[e.length-1]);)e.pop()}function T(){for(;5===N||4===N;)I()}function k(e,t){var r=$(276,e.pos);return r.atToken=e,r.tagName=t,V(r)}function x(){return T(),17===N?pn():void 0}function l(){var e=B(21),t=(()=>{var e=A(!0);for(B(21)&&F(22);B(23);){var t=A(!0);B(21)&&F(22),e=Je(e,t)}return e})();return e&&(T(),u(58)&&j(),F(22)),{name:t,isBracketed:e}}function E(e){switch(e.kind){case 134:return!0;case 164:return E(e.elementType);default:return D.isTypeReferenceNode(e)&&D.isIdentifier(e.typeName)&&"Object"===e.typeName.escapedText}}function S(e,t,r){var n=x(),i=!n,s=(T(),l()),a=s.name,s=s.isBracketed,r=(T(),i&&(n=x()),$(1===r?279:284,e.pos)),o=((e,t)=>{if(e&&E(e.type)){for(var r=$(267,R.getTokenPos()),n=void 0,i=void 0,s=R.getStartPos(),a=void 0;n=M(function(){return w(1,t)});)(a=a||[]).push(n);if(a)return(i=$(285,s)).jsDocPropertyTags=a,164===e.type.kind&&(i.isArrayType=!0),r.type=V(i),V(r)}})(n,a);return o&&(n=o,i=!0),r.atToken=e,r.tagName=t,r.typeExpression=n,r.name=a,r.isNameFirst=i,r.isBracketed=s,V(r)}function C(e,t){D.forEach(p,function(e){return 281===e.kind})&&L(t.pos,R.getTokenPos()-t.pos,D.Diagnostics._0_tag_already_specified,t.escapedText);var r=$(281,e.pos);return r.atToken=e,r.tagName=t,r.typeExpression=pn(!0),V(r)}function w(e,t){for(var r,n=!0,i=!1;;)switch(I(),N){case 57:if(n)return!((r=(e=>{D.Debug.assert(57===N);var t=$(57,R.getStartPos()),r=(t.end=R.getTextPos(),I(),A());if(T(),r)switch(r.escapedText){case"type":return 0===e&&C(t,r);case"prop":case"property":return 0===e&&S(t,r,e);case"arg":case"argument":case"param":return 1===e&&S(t,r,e)}return!1})(e))&&279===r.kind&&(D.isIdentifier(r.name)||!((e,t)=>{for(;!D.isIdentifier(e)||!D.isIdentifier(t);){if(D.isIdentifier(e)||D.isIdentifier(t)||e.right.escapedText!==t.right.escapedText)return;e=e.left,t=t.left}return e.escapedText===t.escapedText})(t,r.name.left)))&&r;i=!1;break;case 4:i=!(n=!0);break;case 39:i&&(n=!1),i=!0;break;case 71:n=!1;break;case 1:return!1}}function I(){N=R.scanJSDocToken()}function A(e){var t,r,n;return void 0===e&&(e=!1),D.tokenIsIdentifierOrKeyword(N)?(t=R.getTokenPos(),r=R.getTextPos(),(n=$(71,t)).escapedText=D.escapeLeadingUnderscores(f.substring(t,r)),V(n,r),I(),n):e?xe(71,!0,D.Diagnostics.Identifier_expected):void fe(D.Diagnostics.Identifier_expected)}}function mn(e,t,i,s,a,o){function l(e){var t="";if(o&&gn(e)&&(t=s.substring(e.pos,e.end)),e._children&&(e._children=void 0),e.pos+=i,e.end+=i,o&&gn(e)&&D.Debug.assert(t===a.substring(e.pos,e.end)),x(e,l,c),D.hasJSDocNodes(e))for(var r=0,n=e.jsDoc;r<n.length;r++)x(n[r],l,c);_n(e,o)}function c(e){e._children=void 0,e.pos+=i,e.end+=i;for(var t=0,r=e;t<r.length;t++)l(r[t])}(t?c:l)(e)}function gn(e){switch(e.kind){case 9:case 8:case 71:return 1}}function fn(e,t,r,n,i){D.Debug.assert(e.end>=t,"Adjusting an element that was entirely before the change range"),D.Debug.assert(e.pos<=r,"Adjusting an element that was entirely after the change range"),D.Debug.assert(e.pos<=e.end),e.pos=Math.min(e.pos,n),e.end>=r?e.end+=i:e.end=Math.min(e.end,n),D.Debug.assert(e.pos<=e.end),e.parent&&(D.Debug.assert(e.pos>=e.parent.pos),D.Debug.assert(e.end<=e.parent.end))}function _n(e,t){var r;t&&(r=e.pos,x(e,function(e){D.Debug.assert(e.pos>=r),r=e.end}),D.Debug.assert(r<=e.end))}function yn(e,t,r,n){var i,e=e.text;r&&(D.Debug.assert(e.length-r.span.length+r.newLength===t.length),n||D.Debug.shouldAssert(3))&&(n=e.substr(0,r.span.start),i=t.substr(0,r.span.start),D.Debug.assert(n===i),n=e.substring(D.textSpanEnd(r.span),e.length),i=t.substring(D.textSpanEnd(D.textChangeRangeNewSpan(r)),t.length),D.Debug.assert(n===i))}D.createNode=function(e,t,r){return new(265===e?p=p||D.objectAllocator.getSourceFileConstructor():71===e?d=d||D.objectAllocator.getIdentifierConstructor():D.isNodeKind(e)?n=n||D.objectAllocator.getNodeConstructor():i=i||D.objectAllocator.getTokenConstructor())(e,t,r)},D.forEachChild=x,D.createSourceFile=function(e,t,r,n,i,s){return void 0===n&&(n=!1),D.performance.mark("beforeParse"),e=k.parseSourceFile(e,t,r,void 0,n,i,s),D.performance.mark("afterParse"),D.performance.measure("Parse","beforeParse","afterParse"),e},D.parseIsolatedEntityName=function(e,t){return k.parseIsolatedEntityName(e,t)},D.parseJsonText=function(e,t){return k.parseJsonText(e,t)},D.isExternalModule=function(e){return void 0!==e.externalModuleIndicator},D.updateSourceFile=function(e,t,r,n){return(t=Z.updateSourceFile(e,t,r,n)).flags|=524288&e.flags,t},D.parseIsolatedJSDocComment=function(e,t,r){return(e=k.JSDocParser.parseIsolatedJSDocComment(e,t,r))&&e.jsDoc&&k.fixupParentReferences(e.jsDoc),e},D.parseJSDocTypeExpressionForTests=function(e,t,r){return k.JSDocParser.parseJSDocTypeExpressionForTests(e,t,r)},e=k=k||{},R=D.createScanner(5,!0),o=!(X=10240),e.parseSourceFile=function(e,t,r,n,i,s,a){return ee(t,r,n,s=D.ensureScriptKind(e,s)),t=((e,t,r,n,i)=>{(_=ne(e,t,n,i)).flags=b,S();for(var s,a=_,o=D.createScanner(a.languageVersion,!1,0,O),l=[],c=[],u=[],d=void 0;;){var p=o.scan();if(2!==p){if(D.isTrivia(p))continue;break}var h,m,p={kind:o.getToken(),pos:o.getTokenPos(),end:o.getTextPos()},g=O.substring(p.pos,p.end),f=D.getFileReferenceFromReferencePath(g,p);f?(h=f.fileReference,a.hasNoDefaultLib=f.isNoDefaultLib,m=f.diagnosticMessage,h&&(f.isTypeReferenceDirective?c:l).push(h),m&&y.push(D.createFileDiagnostic(a,p.pos,p.end-p.pos,m))):((f=/^\/\/\/\s*<amd-module\s+name\s*=\s*('|")(.+?)\1/gim.exec(g))&&(s&&y.push(D.createFileDiagnostic(a,p.pos,p.end-p.pos,D.Diagnostics.An_AMD_module_cannot_have_multiple_name_assignments)),s=f[2]),/^\/\/\/\s*<amd-dependency\s/gim.exec(g)&&(h=/\spath\s*=\s*('|")(.+?)\1/gim.exec(g),m=/\sname\s*=\s*('|")(.+?)\1/gim.exec(g),h)&&(f={path:h[2],name:m?m[2]:void 0},u.push(f)),(f=/^\/\/\/?\s*(@ts-check|@ts-nocheck)\s*$/gim.exec(g))&&(d={enabled:0===D.compareStrings(f[1],"@ts-check",!0),end:p.end,pos:p.pos}))}a.referencedFiles=l,a.typeReferenceDirectives=c,a.amdDependencies=u,a.moduleName=s,a.checkJsDirective=d,_.statements=He(0,T),D.Debug.assert(1===N),_.endOfFileToken=E(v());e=_;return e.externalModuleIndicator=D.forEach(e.statements,function(e){return D.hasModifier(e,1)||237===e.kind&&248===e.moduleReference.kind||238===e.kind||243===e.kind||244===e.kind?e:void 0}),_.nodeCount=W,_.identifierCount=J,_.identifiers=q,_.parseDiagnostics=y,r&&re(_),_})(e,r,i,s,a),te(),t},e.parseIsolatedEntityName=function(e,t){return ee(e,t,void 0,1),S(),e=qe(!0),t=1===N&&!y.length,te(),t?e:void 0},e.parseJsonText=function(e,t){return ee(t,2,void 0,6),t=_=ne(e,2,6),S(),1===N?_.endOfFileToken=v():17===N||C(function(){return 9===N})?(t.jsonObject=dr(),_.endOfFileToken=Te(1,!1,D.Diagnostics.Unexpected_token)):F(17),_.parseDiagnostics=y,te(),t},e.fixupParentReferences=re,(e=Y=e.JSDocParser||(e.JSDocParser={})).parseJSDocTypeExpressionForTests=function(e,t,r){return ee(e,5,void 0,1),_=ne("file.js",5,1),R.setText(e,t,r),N=R.scan(),e=pn(),t=y,te(),e?{jsDocTypeExpression:e,diagnostics:t}:void 0},e.parseJSDocTypeExpression=pn,e.parseIsolatedJSDocComment=function(e,t,r){return ee(e,5,void 0,1),_={languageVariant:0,text:e},e=hn(t,r),t=y,te(),e?{jsDoc:e,diagnostics:t}:void 0},e.parseJSDocComment=function(e,t,r,n){var i=N,s=y.length,a=o;return(t=hn(t,r,n))&&(t.parent=e),D.isInJavaScriptFile(e)&&(_.jsDocDiagnostics||(_.jsDocDiagnostics=[]),(r=_.jsDocDiagnostics).push.apply(r,y)),N=i,y.length=s,o=a,t},e.parseJSDocCommentWorker=hn,(Z||(Z={})).updateSourceFile=function(e,t,r,n){var i,s,a,o,l,c,u,d,p,h,m,g,f,_,y,b;return n=n||D.Debug.shouldAssert(2),yn(e,t,r,n),D.textChangeRangeIsUnchanged(r)?e:0===e.statements.length?k.parseSourceFile(e.fileName,t,e.languageVersion,void 0,!0,e.scriptKind):(D.Debug.assert(!(p=e).hasBeenIncrementallyParsed),p.hasBeenIncrementallyParsed=!0,i=e.text,o=(a=e).statements,l=0,D.Debug.assert(l<o.length),c=o[l],u=-1,s={currentNode:function(e){function n(e){return s>=e.pos&&s<e.end&&(x(e,n,i),!0)}function i(e){if(s>=e.pos&&s<e.end)for(var t=0;t<e.length;t++){var r=e[t];if(r){if(r.pos===s)return o=e,l=t,c=r,!0;if(r.pos<s&&s<r.end)return x(r,n,i),!0}}return!1}var s;return e===u||(c=c&&c.end===e&&l<o.length-1?o[++l]:c)&&c.pos===e||(s=e,l=-1,c=o=void 0,x(a,n,i)),u=e,D.Debug.assert(!c||c.pos===e),c}},d=((e,t)=>{for(var r=t.span.start,n=0;0<r&&n<=1;n++){var i=((e,r)=>{var n,i=e;return x(e,function e(t){if(D.nodeIsMissing(t))return;{if(!(t.pos<=r))return D.Debug.assert(t.pos>r),!0;{if(t.pos>=i.pos&&(i=t),r<t.end)return x(t,e),!0;D.Debug.assert(t.end<=r),n=t}}}),i=n&&(e=(e=>{for(;;){var t=(e=>{var t=void 0;return x(e,function(e){D.nodeIsPresent(e)&&(t=e)}),t})(e);if(!t)return e;e=t}})(n)).pos>i.pos?e:i})(e,r),i=(D.Debug.assert(i.pos<=r),i.pos);r=Math.max(0,i-1)}var s=D.createTextSpanFromBounds(r,D.textSpanEnd(t.span)),t=t.newLength+(t.span.start-r);return D.createTextChangeRange(s,t)})(e,r),yn(e,t,d,n),D.Debug.assert(d.span.start<=r.span.start),D.Debug.assert(D.textSpanEnd(d.span)===D.textSpanEnd(r.span)),D.Debug.assert(D.textSpanEnd(D.textChangeRangeNewSpan(d))===D.textSpanEnd(D.textChangeRangeNewSpan(r))),r=D.textChangeRangeNewSpan(d).length-d.span.length,p=p,h=d.span.start,m=D.textSpanEnd(d.span),g=D.textSpanEnd(D.textChangeRangeNewSpan(d)),f=r,_=i,y=t,b=n,v(p),k.parseSourceFile(e.fileName,t,e.languageVersion,s,!0,e.scriptKind));function v(e){var t;D.Debug.assert(e.pos<=e.end),e.pos>m?mn(e,!1,f,_,y,b):h<=(t=e.end)?(e.intersectsChange=!0,e._children=void 0,fn(e,h,m,g,f),x(e,v,T),_n(e,b)):D.Debug.assert(t<h)}function T(e){if(D.Debug.assert(e.pos<=e.end),e.pos>m)mn(e,!0,f,_,y,b);else{var t=e.end;if(h<=t){e.intersectsChange=!0,e._children=void 0,fn(e,h,m,g,f);for(var r=0,n=e;r<n.length;r++)v(n[r])}else D.Debug.assert(t<h)}}}})(ts=ts||{}),(K=>{var e;function le(e){var t,r;return 230===e.kind||231===e.kind?0:K.isConstEnumDeclaration(e)?2:238!==e.kind&&237!==e.kind||K.hasModifier(e,1)?234===e.kind?(t=0,K.forEachChild(e,function(e){switch(le(e)){case 0:return!1;case 2:return!(t=2);case 1:return t=1,!0}}),t):233===e.kind?(r=e.body)?le(r):1:71===e.kind&&e.isInJSDocNamespace?0:1:0}(e=K.ModuleInstanceState||(K.ModuleInstanceState={}))[e.NonInstantiated=0]="NonInstantiated",e[e.Instantiated=1]="Instantiated",e[e.ConstEnumOnly=2]="ConstEnumOnly",K.getModuleInstanceState=le,X={flags:1},ce={flags:1},Z=s=0;var $,U,r,T,k,x,n,R,V,H,G,j,z,W,q,J,Y,L,E,i,P,S,s,X,ce,Z,a=function(e,t){$=e,U=t,r=K.getEmitScriptTarget(U),e=$,E=!((void 0===(t=t).alwaysStrict?!t.strict:!t.alwaysStrict)||e.isDeclarationFile)||!!e.externalModuleIndicator,P=K.createUnderscoreEscapedMap(),s=0,S=$.isDeclarationFile,i=K.objectAllocator.getSymbolConstructor(),$.locals||(oe($),$.symbolCount=s,$.classifiableNames=P),J=W=z=j=G=H=V=n=x=k=T=r=U=$=void 0,Y=R=!1,Z=L=0};function Q(e,t,r,n,i){return K.createDiagnosticForNodeInSourceFile(K.getSourceFileOfNode(e)||$,e,t,r,n,i)}function C(e,t){return s++,new i(e,t)}function M(e,t,r){e.flags|=r,(t.symbol=e).declarations?e.declarations.push(t):e.declarations=[t],1952&r&&!e.exports&&(e.exports=K.createSymbolTable()),6240&r&&!e.members&&(e.members=K.createSymbolTable()),107455&r&&((r=e.valueDeclaration)&&(r.kind===t.kind||233!==r.kind)||(e.valueDeclaration=t))}function F(e){if(243===e.kind)return e.isExportEquals?"export=":"default";var t,r=K.getNameOfDeclaration(e);if(r)return K.isAmbientModule(e)?(t=K.getTextOfIdentifierOrLiteral(r),K.isGlobalScopeAugmentation(e)?"__global":'"'+t+'"'):144===r.kind?(t=r.expression,K.isStringOrNumericLiteral(t)?K.escapeLeadingUnderscores(t.text):(K.Debug.assert(K.isWellKnownSymbolSyntactically(t)),K.getPropertyNameForKnownSymbolName(K.idText(t.name)))):K.getEscapedTextOfIdentifierOrLiteral(r);switch(e.kind){case 152:return"__constructor";case 160:case 155:return"__call";case 161:case 156:return"__new";case 157:return"__index";case 244:return"__export";case 194:if(2===K.getSpecialPropertyAssignmentKind(e))return"export=";K.Debug.fail("Unknown binary declaration kind");break;case 228:case 229:return K.hasModifier(e,512)?"default":void 0;case 273:return K.isJSDocConstructSignature(e)?"__new":"__call";case 146:K.Debug.assert(273===e.parent.kind);var n=e.parent;return"arg"+K.indexOf(n.parameters,e);case 283:n=K.getNameOfJSDocTypedef(e);return void 0!==n?n.escapedText:void 0}}function u(e){return e.name?K.declarationNameToString(e.name):K.unescapeLeadingUnderscores(F(e))}function w(e,t,r,n,i,s){K.Debug.assert(!K.hasDynamicName(r));var a,o,l=K.hasModifier(r,512),c=l&&t?"default":F(r);if(void 0===c)a=C(0,"__missing");else if(a=e.get(c),788448&n&&P.set(c,!0),a){if(s&&!a.isReplaceableByMethod)return a;a.flags&i&&(a.isReplaceableByMethod?e.set(c,a=C(0,c)):(r.name&&(r.name.parent=r),o=2&a.flags?K.Diagnostics.Cannot_redeclare_block_scoped_variable_0:K.Diagnostics.Duplicate_identifier_0,a.declarations&&a.declarations.length&&(l||a.declarations&&a.declarations.length&&(l||243===r.kind&&!r.isExportEquals))&&(o=K.Diagnostics.A_module_cannot_have_multiple_default_exports),K.forEach(a.declarations,function(e){$.bindDiagnostics.push(Q(K.getNameOfDeclaration(e)||e,o,u(e)))}),$.bindDiagnostics.push(Q(K.getNameOfDeclaration(r)||r,o,u(r))),a=C(0,c)))}else e.set(c,a=C(0,c)),s&&(a.isReplaceableByMethod=!0);return M(a,r,n),a.parent=t,a}function o(e,t,r){var n,i=1&K.getCombinedModifierFlags(e);return 2097152&t?246===e.kind||237===e.kind&&i?w(k.symbol.exports,k.symbol,e,t,r):w(k.locals,void 0,e,t,r):(283===e.kind&&K.Debug.assert(K.isInJavaScriptFile(e)),n=283===e.kind&&e.name&&71===e.name.kind&&e.name.isInJSDocNamespace,!K.isAmbientModule(e)&&(i||32&k.flags)||n?((i=w(k.locals,void 0,e,107455&t?1048576:0,r)).exportSymbol=w(k.symbol.exports,k.symbol,e,t,r),e.localSymbol=i):w(k.locals,void 0,e,t,r))}function B(e){var t;S?l(e):536870912&e.transformFlags?(S=!0,l(e),S=!1,Z|=e.transformFlags&~f(e.kind)):(t=Z,Z=0,l(e),Z=t|Pe(e,Z))}function ue(e){if(void 0!==e)if(S)K.forEach(e,oe);else{for(var t=Z,r=Z=0,n=0,i=e;n<i.length;n++){var s=i[n];oe(s),r|=-536870913&s.transformFlags}e.transformFlags=536870912|r,Z|=t}}function ee(e){K.forEachChild(e,oe,ue)}function l(e){if(K.hasJSDocNodes(e))if(K.isInJavaScriptFile(e))for(var t=0,r=e.jsDoc;t<r.length;t++)oe(r[t]);else for(var n=0,M=e.jsDoc;n<M.length;n++)!function t(e,r){r.parent=e;K.forEachChild(r,function(e){return t(r,e)})}(e,M[n]);var i,s,a,o,l,c,u;if((e=>1&V.flags&&(V===X&&(K.isStatementButNotDeclaration(e)&&209!==e.kind||229===e.kind||233===e.kind&&(e=>1===(e=le(e))||2===e&&U.preserveConstEnums)(e)||232===e.kind&&(!K.isConstEnumDeclaration(e)||U.preserveConstEnums))&&(V=ce,!U.allowUnreachableCode)&&!K.isInAmbientContext(e)&&(208!==e.kind||3&K.getCombinedNodeFlags(e.declarationList)||K.forEach(e.declarationList.declarations,function(e){return e.initializer}))&&Se(e,K.Diagnostics.Unreachable_code_detected),1))(e))ee(e);else switch(e.kind){case 213:o=e,l=de(),c=re(),u=re(),ne(l,V),V=l,se(o.expression,c,u),V=ie(c),fe(o.statement,u,l),ne(l,V),V=ie(u);break;case 212:c=e,o=de(),l=222===c.parent.kind?K.lastOrUndefined(J):void 0,u=l?l.continueTarget:re(),l=l?l.breakTarget:re(),ne(o,V),V=o,fe(c.statement,l,u),ne(u,V),V=ie(u),se(c.expression,o,l),V=ie(l);break;case 214:p=e,h=de(),d=re(),a=re(),oe(p.initializer),ne(h,V),V=h,se(p.condition,d,a),V=ie(d),fe(p.statement,a,h),oe(p.incrementor),ne(h,V),V=ie(a);break;case 215:case 216:var d=e,p=de(),h=re();ne(p,V),V=p,216===d.kind&&oe(d.awaitModifier),oe(d.expression),ne(h,V),oe(d.initializer),227!==d.initializer.kind&&ae(d.initializer),fe(d.statement,h,p),ne(p,V),V=ie(h);break;case 211:a=e,m=re(),f=re(),g=re(),se(a.expression,m,f),V=ie(m),oe(a.thenStatement),ne(g,V),V=ie(f),oe(a.elseStatement),ne(g,V),V=ie(g);break;case 219:case 223:var m=e;oe(m.expression),219===m.kind&&(Y=!0,j)&&ne(j,V),V=X;break;case 218:case 217:var g,f=e;oe(f.label),f.label?(g=(e=>{if(J)for(var t=0,r=J;t<r.length;t++){var n=r[t];if(n.name===e)return n}})(f.label.escapedText))&&(g.referenced=!0,_e(f,g.breakTarget,g.continueTarget)):_e(f,H,G);break;case 224:var _=e,y=re(),b=V,v=(oe(_.tryBlock),ne(y,V),V),T=X;_.catchClause&&(V=b,oe(_.catchClause),ne(y,V),T=V),_.finallyBlock?(ne(y,b={flags:2048,antecedent:b,lock:{}}),V=ie(y),oe(_.finallyBlock),1&V.flags||1&v.flags&&1&T.flags&&(V=v===ce||T===ce?ce:X),1&V.flags||(_={flags:4096,antecedent:V},b.lock=_,V=_)):V=ie(y);break;case 221:v=e,T=re(),b=(oe(v.expression),H),_=q,y=(H=T,q=V,oe(v.caseBlock),ne(T,V),K.forEach(v.caseBlock.clauses,function(e){return 258===e.kind}));v.possiblyExhaustive=!y&&!T.antecedents,y||ne(T,pe(q,v,0,0)),H=b,q=_,V=ie(T);break;case 235:for(var F=e,k=Z,x=(Z=0,F.clauses),B=X,E=0;E<x.length;E++){for(var S=E;!x[E].statements.length&&E+1<x.length;)oe(x[E]),E++;var C=re(),S=(ne(C,pe(q,F.parent,S,E+1)),ne(C,B),V=ie(C),x[E]);oe(S),1&(B=V).flags||E===x.length-1||!U.noFallthroughCasesInSwitch||Se(S,K.Diagnostics.Fallthrough_case_in_switch)}x.transformFlags=536870912|Z,Z|=k;break;case 257:k=V,V=q,oe((w=e).expression),V=k,ue(w.statements);break;case 222:var w=e,I=de(),A=re(),I=(oe(w.label),ne(I,V),((e,t,r)=>((J=J||[]).push(e={name:e,breakTarget:t,continueTarget:r,referenced:!1}),e))(w.label.escapedText,A,I));oe(w.statement),J.pop(),I.referenced||U.allowUnusedLabels||$.bindDiagnostics.push(Q(w.label,K.Diagnostics.Unused_label)),w.statement&&212===w.statement.kind||(ne(A,V),V=ie(A));break;case 192:I=e;51===I.operator?(A=z,z=W,W=A,ee(I),W=z,z=A):(ee(I),43!==I.operator&&44!==I.operator||ae(I.operand));break;case 193:ee(N=e),43!==N.operator&&44!==N.operator||ae(N.operand);break;case 194:var D,N=e,O=N.operatorToken.kind;53===O||54===O?(e=>{for(;185===e.parent.kind||192===e.parent.kind&&51===e.parent.operator;)e=e.parent;return!(e=>{var t=e.parent;switch(t.kind){case 211:case 213:case 212:return t.expression===e;case 214:case 195:return t.condition===e}})(e)&&!ge(e.parent)})(N)?(D=re(),ye(N,D,D),V=ie(D)):ye(N,z,W):(ee(N),K.isAssignmentOperator(O)&&!K.isAssignmentTarget(N)&&(ae(N.left),58===O)&&180===N.left.kind&&te(N.left.expression)&&(V=me(V,N)));break;case 188:ee(D=e),179===D.expression.kind&&ae(D.expression);break;case 195:O=e,s=re(),L=re(),R=re(),se(O.condition,s,L),V=ie(s),oe(O.questionToken),oe(O.whenTrue),ne(R,V),V=ie(L),oe(O.colonToken),oe(O.whenFalse),ne(R,V),V=ie(R);break;case 226:ee(s=e),(s.initializer||K.isForInOrOfStatement(s.parent.parent))&&function e(t){var r=K.isOmittedExpression(t)?void 0:t.name;if(K.isBindingPattern(r))for(var n=0,i=r.elements;n<i.length;n++){var s=i[n];e(s)}else V=he(V,t)}(s);break;case 181:for(var R,L=e,P=L.expression;185===P.kind;)P=P.expression;186===P.kind||187===P.kind?(ue(L.typeArguments),ue(L.arguments),oe(L.expression)):ee(L),179===L.expression.kind&&te((R=L.expression).expression)&&K.isPushOrUnshiftIdentifier(R.name)&&(V=me(V,L));break;case 275:K.forEachChild(e,function(e){283!==e.kind&&oe(e)});break;case 283:i=e,K.forEachChild(i,function(e){i.fullName&&e===i.name&&71!==i.fullName.kind||oe(e)});break;default:ee(e)}}function c(e){switch(e.kind){case 71:case 99:case 179:return I(e);case 181:var t=e;if(t.arguments)for(var r=0,n=t.arguments;r<n.length;r++)if(I(n[r]))return!0;return!(179!==t.expression.kind||!I(t.expression.expression));case 185:return c(e.expression);case 194:var i=e;switch(i.operatorToken.kind){case 58:return I(i.left);case 32:case 33:case 34:case 35:return te(i.left)||te(i.right)||d(i.right,i.left)||d(i.left,i.right);case 93:return te(i.left);case 26:return c(i.right)}return!1;case 192:return 51===e.operator&&c(e.operand)}return!1}function I(e){return 71===e.kind||99===e.kind||97===e.kind||179===e.kind&&I(e.expression)}function d(e,t){return 189===e.kind&&te(e.expression)&&9===t.kind}function te(e){switch(e.kind){case 185:return te(e.expression);case 194:switch(e.operatorToken.kind){case 58:return te(e.left);case 26:return te(e.right)}}return I(e)}function re(){return{flags:4,antecedents:void 0}}function de(){return{flags:8,antecedents:void 0}}function p(e){e.flags|=512&e.flags?1024:512}function ne(e,t){1&t.flags||K.contains(e.antecedents,t)||((e.antecedents||(e.antecedents=[])).push(t),p(t))}function h(e,t,r){return 1&t.flags?t:r?101===r.kind&&64&e||86===r.kind&&32&e?X:c(r)?(p(t),{flags:e,expression:r,antecedent:t}):t:32&e?t:X}function pe(e,t,r,n){return c(t.expression)?(p(e),{flags:128,switchStatement:t,clauseStart:r,clauseEnd:n,antecedent:e}):e}function he(e,t){return p(e),{flags:16,antecedent:e,node:t}}function me(e,t){return p(e),{flags:256,antecedent:e,node:t}}function ie(e){var t=e.antecedents;return t?1===t.length?t[0]:e:X}function ge(e){for(;;)if(185===e.kind)e=e.expression;else{if(192!==e.kind||51!==e.operator)return 194===e.kind&&(53===e.operatorToken.kind||54===e.operatorToken.kind);e=e.operand}}function se(e,t,r){var n=z,i=W;z=t,W=r,oe(e),z=n,W=i,e&&ge(e)||(ne(t,h(32,V,e)),ne(r,h(64,V,e)))}function fe(e,t,r){var n=H,i=G;H=t,G=r,oe(e),H=n,G=i}function _e(e,t,r){e=218===e.kind?t:r;e&&(ne(e,V),V=X)}function m(e){194===e.kind&&58===e.operatorToken.kind?ae(e.left):ae(e)}function ae(e){if(I(e))V=he(V,e);else if(177===e.kind)for(var t=0,r=e.elements;t<r.length;t++){var n=r[t];198===n.kind?ae(n.expression):m(n)}else if(178===e.kind)for(var i=0,s=e.properties;i<s.length;i++){var a=s[i];261===a.kind?m(a.initializer):262===a.kind?ae(a.name):263===a.kind&&ae(a.expression)}}function ye(e,t,r){var n=re();53===e.operatorToken.kind?se(e.left,n,r):se(e.left,t,n),V=ie(n),oe(e.operatorToken),se(e.right,t,r)}function be(e){n&&(n.nextContainer=e),n=e}function A(e,t,r){switch(k.kind){case 233:return o(e,t,r);case 265:return n=e,i=t,s=r,K.isExternalModule($)?o(n,i,s):w($.locals,void 0,n,i,s);case 199:case 229:return n=e,i=t,s=r,K.hasModifier(n,32)?w(k.symbol.exports,k.symbol,n,i,s):w(k.symbol.members,k.symbol,n,i,s);case 232:return w(k.symbol.exports,k.symbol,e,t,r);case 163:case 285:case 178:case 230:case 254:return w(k.symbol.members,k.symbol,e,t,r);case 160:case 161:case 155:case 156:case 157:case 151:case 150:case 152:case 153:case 154:case 228:case 186:case 187:case 273:case 231:case 172:return w(k.locals,void 0,e,t,r)}var n,i,s}function ve(e){K.isInAmbientContext(e)&&!(e=>{if((e=265===e.kind?e:e.body)&&(265===e.kind||234===e.kind))for(var t=0,r=e.statements;t<r.length;t++){var n=r[t];if(244===n.kind||243===n.kind)return 1}})(e)?e.flags|=32:e.flags&=-33}function Te(e){var t=le(e),r=0!==t;return A(e,r?512:1024,r?106639:0),t}function D(e,t,r){r=C(t,r);8&t&&(r.parent=k.symbol),M(r,e,t)}function N(e,t,r){switch(x.kind){case 233:o(e,t,r);break;case 265:if(K.isExternalModule(k)){o(e,t,r);break}default:x.locals||(x.locals=K.createSymbolTable(),be(x)),w(x.locals,void 0,e,t,r)}}function ke(e){!(E&&108<=e.originalKeywordKind&&e.originalKeywordKind<=116)||K.isIdentifierName(e)||K.isInAmbientContext(e)||$.parseDiagnostics.length||$.bindDiagnostics.push(Q(e,(e=>K.getContainingClass(e)?K.Diagnostics.Identifier_expected_0_is_a_reserved_word_in_strict_mode_Class_definitions_are_automatically_in_strict_mode:$.externalModuleIndicator?K.Diagnostics.Identifier_expected_0_is_a_reserved_word_in_strict_mode_Modules_are_automatically_in_strict_mode:K.Diagnostics.Identifier_expected_0_is_a_reserved_word_in_strict_mode)(e),K.declarationNameToString(e)))}function O(e,t){var r,n;t&&71===t.kind&&(n=r=t,!K.isIdentifier(n)||"eval"!==n.escapedText&&"arguments"!==n.escapedText||(n=K.getErrorSpanForNode($,t),$.bindDiagnostics.push(K.createFileDiagnostic($,n.start,n.length,(e=>K.getContainingClass(e)?K.Diagnostics.Invalid_use_of_0_Class_definitions_are_automatically_in_strict_mode:$.externalModuleIndicator?K.Diagnostics.Invalid_use_of_0_Modules_are_automatically_in_strict_mode:K.Diagnostics.Invalid_use_of_0_in_strict_mode)(e),K.idText(r)))))}function xe(e){E&&O(e,e.name)}function Ee(e){var t;r<2&&(265===x.kind||233===x.kind||K.isFunctionLike(x)||(t=K.getErrorSpanForNode($,e),$.bindDiagnostics.push(K.createFileDiagnostic($,t.start,t.length,K.getContainingClass(e)?K.Diagnostics.Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Class_definitions_are_automatically_in_strict_mode:$.externalModuleIndicator?K.Diagnostics.Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5_Modules_are_automatically_in_strict_mode:K.Diagnostics.Function_declarations_are_not_allowed_inside_blocks_in_strict_mode_when_targeting_ES3_or_ES5))))}function Se(e,t,r,n,i){e=K.getSpanOfTokenAtPosition($,e.pos);$.bindDiagnostics.push(K.createFileDiagnostic($,e.start,e.length,t,r,n,i))}function oe(e){if(e){e.parent=T;var t,r,n,i,s,a,o,l,c,u,d,p=E;if(K.isInJavaScriptFile(e)){var h=e;if(K.hasJSDocNodes(h))for(var m=0,g=h.jsDoc;m<g.length;m++){var f=g[m];if(f.tags)for(var _=0,y=f.tags;_<y.length;_++){var b,v=y[_];283===v.kind&&(b=T,T=f,oe(v),T=b)}}}(e=>{switch(e.kind){case 71:if(e.isInJSDocNamespace){for(var t=e.parent;t&&283!==t.kind;)t=t.parent;N(t,524288,793064);break}case 99:return V&&(K.isExpression(e)||262===T.kind)&&(e.flowNode=V),ke(e);case 179:V&&I(e)&&(e.flowNode=V);break;case 194:switch(K.getSpecialPropertyAssignmentKind(e)){case 1:Ae(e);break;case 2:(e=>{var t=K.getRightMostAssignedExpression(e.right);K.isEmptyObjectLiteral(t)||De(t)?Ie(e):(Ie(e),w($.symbol.exports,$.symbol,e,1049092,0))})(e);break;case 3:(e=>{var t=e.left,r=t.expression,n=r.expression;t.parent=e,n.parent=r,Oe(n.escapedText,r.parent=t,!0)})(e);break;case 4:(e=>{K.Debug.assert(K.isInJavaScriptFile(e));var t=K.getThisContainer(e,!1);switch(t.kind){case 228:case 186:t.symbol.members=t.symbol.members||K.createSymbolTable(),w(t.symbol.members,t.symbol,e,4,0);break;case 152:case 149:case 151:case 153:case 154:var r=t.parent;w(K.hasModifier(t,32)?r.symbol.exports:r.symbol.members,r.symbol,e,4,0,!0)}})(e);break;case 5:(e=>{var t=e.left,r=t.expression;K.isIdentifier(r)&&(t.parent=e,r.parent=t,Ne(r)?Ae(e):Oe(r.escapedText,t,!1))})(e);break;case 0:break;default:K.Debug.fail("Unknown special property assignment kind")}return(e=>{E&&K.isLeftHandSideExpression(e.left)&&K.isAssignmentOperator(e.operatorToken.kind)&&O(e,e.left)})(e);case 260:return(e=>{E&&e.variableDeclaration&&O(e,e.variableDeclaration.name)})(e);case 188:return(e=>{E&&71===e.expression.kind&&(e=K.getErrorSpanForNode($,e.expression),$.bindDiagnostics.push(K.createFileDiagnostic($,e.start,e.length,K.Diagnostics.delete_cannot_be_called_on_an_identifier_in_strict_mode)))})(e);case 8:return(e=>{E&&4&e.numericLiteralFlags&&$.bindDiagnostics.push(Q(e,K.Diagnostics.Octal_literals_are_not_allowed_in_strict_mode))})(e);case 193:return(e=>{E&&O(e,e.operand)})(e);case 192:return(e=>{!E||43!==e.operator&&44!==e.operator||O(e,e.operand)})(e);case 220:return(e=>{E&&Se(e,K.Diagnostics.with_statements_are_not_allowed_in_strict_mode)})(e);case 169:return R=!0;case 158:return(e=>{var t=e.parameterName,e=e.type;t&&71===t.kind&&ke(t),t&&169===t.kind&&(R=!0),oe(e)})(e);case 145:return A(e,262144,530920);case 146:return(e=>{var t;E&&!K.isInAmbientContext(e)&&O(e,e.name),K.isBindingPattern(e.name)?D(e,1,"__"+K.indexOf(e.parent.parameters,e)):A(e,1,107455),K.isParameterPropertyDeclaration(e)&&w((t=e.parent.parent).symbol.members,t.symbol,e,4|(e.questionToken?16777216:0),0)})(e);case 226:return Re(e);case 176:return e.flowNode=V,Re(e);case 149:case 148:return(e=>Le(e,4|(e.questionToken?16777216:0),0))(e);case 261:case 262:return Le(e,4,0);case 264:return Le(e,8,900095);case 155:case 156:case 157:return A(e,131072,0);case 151:case 150:return Le(e,8192|(e.questionToken?16777216:0),K.isObjectLiteralMethod(e)?0:99263);case 228:return(e=>{$.isDeclarationFile||K.isInAmbientContext(e)||K.isAsyncFunction(e)&&(L|=1024),xe(e),(E?(Ee(e),N):A)(e,16,106927)})(e);case 152:return A(e,16384,0);case 153:return Le(e,32768,41919);case 154:return Le(e,65536,74687);case 160:case 273:case 161:return(e=>{var t=C(131072,F(e)),r=(M(t,e,131072),C(2048,"__type"));M(r,e,2048),r.members=K.createSymbolTable(),r.members.set(t.escapedName,t)})(e);case 163:case 285:case 172:return(e=>D(e,2048,"__type"))(e);case 178:return(e=>{if(0,E)for(var t=K.createUnderscoreEscapedMap(),r=0,n=e.properties;r<n.length;r++){var i,s,a=n[r];263!==a.kind&&71===a.name.kind&&(i=261===a.kind||262===a.kind||151===a.kind?1:2,(s=t.get((a=a.name).escapedText))?1==i&&1===s&&(s=K.getErrorSpanForNode($,a),$.bindDiagnostics.push(K.createFileDiagnostic($,s.start,s.length,K.Diagnostics.An_object_literal_cannot_have_multiple_properties_with_the_same_name_in_strict_mode))):t.set(a.escapedText,i))}D(e,4096,"__object")})(e);case 186:case 187:return(e=>{$.isDeclarationFile||K.isInAmbientContext(e)||K.isAsyncFunction(e)&&(L|=1024),V&&(e.flowNode=V),xe(e);var t=e.name?e.name.escapedText:"__function";D(e,16,t)})(e);case 181:K.isInJavaScriptFile(e)&&(e=>{!$.commonJsModuleIndicator&&K.isRequireCall(e,!1)&&Ie(e)})(e);break;case 199:case 229:return E=!0,(e=>{229===e.kind?N(e,32,899519):(t=e.name?e.name.escapedText:"__class",D(e,32,t),e.name&&P.set(e.name.escapedText,!0));var t=e.symbol,r=C(4194308,"prototype"),n=t.exports.get(r.escapedName);n&&(e.name&&(e.name.parent=e),$.bindDiagnostics.push(Q(n.declarations[0],K.Diagnostics.Duplicate_identifier_0,K.symbolName(r)))),t.exports.set(r.escapedName,r),r.parent=t})(e);case 230:return N(e,64,792968);case 231:return N(e,524288,793064);case 232:return(e=>K.isConst(e)?N(e,128,899967):N(e,256,899327))(e);case 233:return(e=>{var t,r;ve(e),K.isAmbientModule(e)?(K.hasModifier(e,1)&&Se(e,K.Diagnostics.export_modifier_cannot_be_applied_to_ambient_modules_and_module_augmentations_since_they_are_always_visible),K.isExternalModuleAugmentation(e)?Te(e):(t=void 0,9===e.name.kind&&(r=e.name.text,K.hasZeroOrOneAsteriskCharacter(r)?t=K.tryParsePattern(r):Se(e.name,K.Diagnostics.Pattern_0_can_have_at_most_one_Asterisk_character,r)),r=A(e,512,106639),t&&($.patternAmbientModules||($.patternAmbientModules=[])).push({pattern:t,symbol:r}))):0!==(t=Te(e))&&(304&e.symbol.flags?e.symbol.constEnumOnlyModule=!1:(r=2===t,void 0===e.symbol.constEnumOnlyModule?e.symbol.constEnumOnlyModule=r:e.symbol.constEnumOnlyModule=e.symbol.constEnumOnlyModule&&r))})(e);case 254:return(e=>D(e,4096,"__jsxAttributes"))(e);case 253:return A(e,4,0);case 237:case 240:case 242:case 246:return A(e,2097152,2097152);case 236:return(e=>{var t;e.modifiers&&e.modifiers.length&&$.bindDiagnostics.push(Q(e,K.Diagnostics.Modifiers_cannot_appear_here)),265!==e.parent.kind?$.bindDiagnostics.push(Q(e,K.Diagnostics.Global_module_exports_may_only_appear_at_top_level)):(t=e.parent,K.isExternalModule(t)?t.isDeclarationFile?($.symbol.globalExports=$.symbol.globalExports||K.createSymbolTable(),w($.symbol.globalExports,$.symbol,e,2097152,2097152)):$.bindDiagnostics.push(Q(e,K.Diagnostics.Global_module_exports_may_only_appear_in_declaration_files)):$.bindDiagnostics.push(Q(e,K.Diagnostics.Global_module_exports_may_only_appear_in_module_files)))})(e);case 239:return(e=>{e.name&&A(e,2097152,2097152)})(e);case 244:return(e=>{k.symbol&&k.symbol.exports?e.exportClause||w(k.symbol.exports,k.symbol,e,8388608,0):D(e,8388608,F(e))})(e);case 243:return(e=>{var t;k.symbol&&k.symbol.exports?(t=243===e.kind&&K.exportAssignmentIsAlias(e)?2097152:4,w(k.symbol.exports,k.symbol,e,t,2097204)):D(e,2097152,F(e))})(e);case 265:return Ce(e.statements),ve($),K.isExternalModule($)&&we();case 207:if(!K.isFunctionLike(e.parent))return;case 234:return Ce(e.statements);case 279:if(285!==e.parent.kind)break;case 284:var r=e,n=r.isBracketed||r.typeExpression&&272===r.typeExpression.type.kind?16777220:4;return A(r,n,0);case 283:r=e.fullName;if(!r||71===r.kind)N(e,524288,793064)}})(e),142<e.kind?(h=T,0===(r=(e=>{switch(e.kind){case 199:case 229:case 232:case 178:case 163:case 285:case 254:return 1;case 230:return 65;case 233:case 231:case 172:return 33;case 265:return 37;case 151:if(K.isObjectLiteralOrClassExpressionMethod(e))return 173;case 152:case 228:case 150:case 153:case 154:case 155:case 273:case 160:case 156:case 157:case 161:return 45;case 186:case 187:return 61;case 234:return 4;case 149:return e.initializer?4:0;case 260:case 214:case 215:case 216:case 235:return 2;case 207:return K.isFunctionLike(e.parent)?0:2}return 0})(T=e))?B(e):(t=e,u=k,d=x,1&(r=r)?(k=x=t,32&r&&(k.locals=K.createSymbolTable()),be(k)):2&r&&((x=t).locals=void 0),4&r?(n=V,i=H,s=G,a=j,o=J,l=Y,c=16&r&&!K.hasModifier(t,256)&&!!K.getImmediatelyInvokedFunctionExpression(t),j=c?re():(V={flags:2},void(144&r&&(V.container=t))),J=G=H=void 0,Y=!1,B(t),t.flags&=-1409,!(1&V.flags)&&8&r&&K.nodeIsPresent(t.body)&&(t.flags|=128,Y)&&(t.flags|=256),265===t.kind&&(t.flags|=L),V=c?(ne(j,V),ie(j)):n,H=i,G=s,j=a,J=o,Y=l):64&r?(R=!1,B(t),t.flags=R?64|t.flags:-65&t.flags):B(t),k=u,x=d),T=h):S||0!=(536870912&e.transformFlags)||(Z|=Pe(e,0)),E=p}}function Ce(e){if(!E)for(var t=0,r=e;t<r.length;t++){var n=r[t];if(!K.isPrologueDirective(n))return;if((e=>'"use strict"'===(e=K.getTextOfNodeFromSourceText($.text,e.expression))||"'use strict'"===e)(n))return void(E=!0)}}function we(){D($,512,'"'+K.removeFileExtension($.fileName)+'"')}function Ie(e){$.commonJsModuleIndicator||($.commonJsModuleIndicator=e,$.externalModuleIndicator)||we()}function Ae(e){Ie(e),w($.symbol.exports,$.symbol,e.left,1048580,0)}function De(e){return K.isExportsIdentifier(e)||K.isModuleExportsPropertyAccessExpression(e)||K.isIdentifier(e)&&Ne(e)}function Ne(e){e=g(e.escapedText);return e&&e.valueDeclaration&&K.isVariableDeclaration(e.valueDeclaration)&&e.valueDeclaration.initializer&&function e(t){return De(t)||K.isAssignmentExpression(t,!0)&&(e(t.left)||e(t.right))}(e.valueDeclaration.initializer)}function g(e){return k.symbol&&k.symbol.exports&&k.symbol.exports.get(e)||k.locals&&k.locals.get(e)}function Oe(e,t,r){e=g(e);(e=e&&K.isDeclarationOfFunctionOrClassExpression(e)?e.valueDeclaration.initializer.symbol:e)&&48&e.flags&&w(r?e.members||(e.members=K.createSymbolTable()):e.exports||(e.exports=K.createSymbolTable()),e,t,4,0)}function Re(e){E&&O(e,e.name),K.isBindingPattern(e.name)||(K.isBlockOrCatchScoped(e)?N(e,2,107455):K.isParameterDeclaration(e)?A(e,1,107455):A(e,1,107454))}function Le(e,t,r){return $.isDeclarationFile||K.isInAmbientContext(e)||!K.isAsyncFunction(e)||(L|=1024),V&&K.isObjectLiteralOrClassExpressionMethod(e)&&(e.flowNode=V),K.hasDynamicName(e)?D(e,t,"__computed"):A(e,t,r)}function Pe(e,t){var M=e.kind;switch(M){case 181:var r=e,n=t,i=n,s=r.expression,F=s.kind;return r.typeArguments&&(i|=3),(524288&n||((e,t)=>{switch(t){case 97:return 1;case 179:case 180:return 97===e.expression.kind}})(s,F))&&(i|=192),91===s.kind&&(i|=67108864,16384&n)&&(i|=32768),r.transformFlags=536870912|i,-537396546&i;case 182:F=e,s=t,n=s;return F.typeArguments&&(n|=3),524288&s&&(n|=192),F.transformFlags=536870912|n,-537396546&n;case 233:var r=e,i=t,a=3;return 0==(2&K.getModifierFlags(r))&&(a|=i),r.transformFlags=536870912|a,-574674242&a;case 185:var a=e,o=t,l=a.expression,c=l.kind;return 202!==c&&184!==c||(o|=3),1024&l.transformFlags&&(o|=1024),a.transformFlags=536870912|o,-536872258&o;case 194:var c=e,l=t,o=c.operatorToken.kind,B=c.left.kind;return 58===o&&178===B?l|=3272:58===o&&177===B?l|=3264:40!==o&&62!==o||(l|=32),c.transformFlags=536870912|l,-536872258&l;case 210:var B=e,u=t;return 1024&B.expression.transformFlags&&(u|=192),B.transformFlags=536870912|u,-536872258&u;case 146:var u=e,d=t,p=d,h=u.name,m=u.initializer,g=u.dotDotDotToken;return(u.questionToken||u.type||4096&d||K.isThisIdentifier(h))&&(p|=3),K.hasModifier(u,92)&&(p|=262147),1048576&d&&(p|=8),(8388608&d||m||g)&&(p|=131264),u.transformFlags=536870912|p,-536872258&p;case 187:h=e,d=t,m=192|d;return(K.hasModifier(h,2270)||h.typeParameters||h.type)&&(m|=3),K.hasModifier(h,256)&&(m|=16),1048576&d&&(m|=8),16384&d&&(m|=32768),h.transformFlags=536870912|m,-601249090&m;case 186:var g=e,p=t,f=p;return(K.hasModifier(g,2270)||g.typeParameters||g.type)&&(f|=3),K.hasModifier(g,256)&&(f|=g.asteriskToken?8:16),1048576&p&&(f|=8),163840&p&&(f|=192),g.asteriskToken&&(f|=768),g.transformFlags=536870912|f,-601281858&f;case 228:var f=e,_=t,y=K.getModifierFlags(f);return!f.body||2&y?b=3:(b=33554432|_,(2270&y||f.typeParameters||f.type)&&(b|=3),256&y&&(b|=f.asteriskToken?8:16),1048576&_&&(b|=8),163840&_&&(b|=192),f.asteriskToken&&(b|=768)),f.transformFlags=536870912|b,-601281858&b;case 226:y=e,_=t;return _|=8388800,1048576&t&&(_|=8),y.type&&(_|=3),y.transformFlags=536870912|_,-536872258&_;case 227:var b=e,v=33554432|t;return 8388608&t&&(v|=192),3&b.flags&&(v|=4194496),b.transformFlags=536870912|v,-546309442&v;case 208:var v=e,$=t,T=v.declarationList.transformFlags;return K.hasModifier(v,2)?k=3:(k=$,8388608&T&&(k|=192)),v.transformFlags=536870912|k,-536872258&k;case 222:$=e,T=t;return 4194304&t&&K.isIterationStatement($,!0)&&(T|=192),$.transformFlags=536870912|T,-536872258&T;case 229:var k=e,x=t;return K.hasModifier(k,2)?E=3:(E=192|x,(274432&x||k.typeParameters)&&(E|=3),65536&x&&(E|=16384)),k.transformFlags=536870912|E,-539358530&E;case 199:var x=e,E=t,S=192|E;return(274432&E||x.typeParameters)&&(S|=3),65536&E&&(S|=16384),x.transformFlags=536870912|S,-539358530&S;case 259:var S=e,U=t;switch(S.token){case 85:U|=192;break;case 108:U|=3;break;default:K.Debug.fail("Unexpected token for heritage clause")}return S.transformFlags=536870912|U,-536872258&U;case 260:var C=e,w=t;return C.variableDeclaration?K.isBindingPattern(C.variableDeclaration.name)&&(w|=192):w|=8,C.transformFlags=536870912|w,-537920834&w;case 201:C=e,w=t;return w|=192,C.typeArguments&&(w|=3),C.transformFlags=536870912|w,-536872258&w;case 152:var I=e,V=t,A=V;return!K.hasModifier(I,2270)&&I.body||(A|=3),1048576&V&&(A|=8),I.transformFlags=536870912|A,-601015618&A;case 149:V=e,I=t;return I|=3,V.initializer&&(I|=8192),V.transformFlags=536870912|I,-536872258&I;case 151:var A=e,D=t,N=192|D;return(A.decorators||K.hasModifier(A,2270)||A.typeParameters||A.type||!A.body)&&(N|=3),1048576&D&&(N|=8),K.hasModifier(A,256)&&(N|=A.asteriskToken?8:16),A.asteriskToken&&(N|=768),A.transformFlags=536870912|N,-601015618&N;case 153:case 154:var D=e,N=t,O=N;return(D.decorators||K.hasModifier(D,2270)||D.type||!D.body)&&(O|=3),1048576&N&&(O|=8),D.transformFlags=536870912|O,-601015618&O;case 237:var O=e,H=t;return K.isExternalModuleImportEqualsDeclaration(O)||(H|=3),O.transformFlags=536870912|H,-536872258&H;case 179:var H=e,G=t;return 97===H.expression.kind&&(G|=16384),H.transformFlags=536870912|G,-536872258&G;default:var j=e,R=t,L=R,P=536872257;switch(M){case 120:case 191:L|=24;break;case 114:case 112:case 113:case 117:case 124:case 76:case 232:case 264:case 184:case 202:case 203:case 131:L|=3;break;case 249:case 250:case 251:case 10:case 252:case 253:case 254:case 255:case 256:L|=4;break;case 13:case 14:case 15:case 16:case 196:case 183:case 262:case 115:case 204:L|=192;break;case 9:j.hasExtendedUnicodeEscape&&(L|=192);break;case 8:48&j.numericLiteralFlags&&(L|=192);break;case 216:j.awaitModifier&&(L|=8),L|=192;break;case 197:L|=16777416;break;case 119:case 133:case 130:case 134:case 136:case 122:case 137:case 105:case 145:case 148:case 150:case 155:case 156:case 157:case 158:case 159:case 160:case 161:case 162:case 163:case 164:case 165:case 166:case 167:case 168:case 230:case 231:case 169:case 170:case 171:case 172:case 173:case 236:P=-(L=3);break;case 144:L|=2097152,16384&R&&(L|=65536);break;case 198:L|=524480;break;case 263:L|=1048584;break;case 97:L|=192;break;case 99:L|=16384;break;case 174:L|=8388800,524288&R&&(L|=1048584),P=537396545;break;case 175:L|=8388800,P=537396545;break;case 176:L|=192,j.dotDotDotToken&&(L|=524288);break;case 147:L|=4099;break;case 178:P=540087617,2097152&R&&(L|=192),65536&R&&(L|=16384),1048576&R&&(L|=8);break;case 177:case 182:P=537396545,524288&R&&(L|=192);break;case 212:case 213:case 214:case 215:4194304&R&&(L|=192);break;case 265:32768&R&&(L|=192);break;case 219:case 217:case 218:L|=33554432}return j.transformFlags=536870912|L,L&~P}}function f(e){if(158<=e&&e<=173)return-3;switch(e){case 181:case 182:case 177:return 537396545;case 233:return 574674241;case 146:return 536872257;case 187:return 601249089;case 186:case 228:return 601281857;case 227:return 546309441;case 229:case 199:return 539358529;case 152:return 601015617;case 151:case 153:case 154:return 601015617;case 119:case 133:case 130:case 136:case 134:case 122:case 137:case 105:case 145:case 148:case 150:case 155:case 156:case 157:case 230:case 231:return-3;case 178:return 540087617;case 260:return 537920833;case 174:case 175:return 537396545;default:return 536872257}}K.bindSourceFile=function(e,t){K.performance.mark("beforeBind"),a(e,t),K.performance.mark("afterBind"),K.performance.measure("Bind","beforeBind","afterBind")},K.computeTransformFlagsForNode=Pe,K.getTransformFlagsSubtreeExclusions=f})(ts=ts||{}),(y=>{y.createGetSymbolWalker=function(i,o,d,p,h,m,g,f,_){return function(r){void 0===r&&(r=function(){return!0});var s=[],n=[];return{walkType:function(e){try{return l(e),{visitedTypes:y.getOwnValues(s),visitedSymbols:y.getOwnValues(n)}}finally{y.clear(s),y.clear(n)}},walkSymbol:function(e){try{return u(e),{visitedTypes:y.getOwnValues(s),visitedSymbols:y.getOwnValues(n)}}finally{y.clear(s),y.clear(n)}}};function l(e){var t,r,n,i;!e||s[e.id]||u((s[e.id]=e).symbol)||(32768&e.flags&&(4&(r=(t=e).objectFlags)&&(l((n=e).target),y.forEach(n.typeArguments,l)),32&r&&(l((n=e).typeParameter),l(n.constraintType),l(n.templateType),l(n.modifiersType)),3&r&&(a(i=e),y.forEach(i.typeParameters,l),y.forEach(d(i),l),l(i.thisType)),24&r)&&a(t),16384&e.flags&&l(f(e)),196608&e.flags&&y.forEach(e.types,l),262144&e.flags&&l(e.type),524288&e.flags&&(l((i=e).objectType),l(i.indexType),l(i.constraint)))}function c(e){e.typePredicate&&l(e.typePredicate.type),y.forEach(e.typeParameters,l);for(var t=0,r=e.parameters;t<r.length;t++)u(r[t]);l(i(e)),l(o(e))}function a(e){l(g(e,0));for(var t=g(e,1),t=(l(t),p(e)),r=0,n=t.callSignatures;r<n.length;r++)c(n[r]);for(var i=0,s=t.constructSignatures;i<s.length;i++)c(s[i]);for(var a=0,o=t.properties;a<o.length;a++)u(o[a])}function u(e){if(e){var t=y.getSymbolId(e);if(!n[t]){if(n[t]=e,!r(e))return!0;l(h(e)),1952&e.flags&&e.exports.forEach(u),y.forEach(e.declarations,function(e){e.type&&162===e.type.kind&&(e=e.type,u(m(_(e.exprName))))})}}}}}})(ts=ts||{}),(A=>{function D(e){e.trace(A.formatMessage.apply(void 0,arguments))}function d(e,t){return e.traceResolution&&void 0!==t.trace}function u(e,t){return t&&{path:t.path,extension:t.ext,packageId:e}}function N(e){return u(void 0,e)}var p,e;function h(e){if(e)return A.Debug.assert(A.extensionIsTypeScript(e.extension)),{fileName:e.path,packageId:e.packageId}}function m(e,t,r){return{resolvedModule:e&&{resolvedFileName:e.path,extension:e.extension,isExternalLibraryImport:t,packageId:e.packageId},failedLookupLocations:r}}function g(e,t){try{var r=t.readFile(e);return r?JSON.parse(r):{}}catch(e){return{}}}function f(e,t){var r,n,i;return e.typeRoots||(e.configFilePath?r=A.getDirectoryPath(e.configFilePath):t.getCurrentDirectory&&(r=t.getCurrentDirectory()),void 0!==r?(e=r,(n=t).directoryExists?(A.forEachAncestorDirectory(A.normalizePath(e),function(e){e=A.combinePaths(e,s);n.directoryExists(e)&&(i=i||[]).push(e)}),i):[A.combinePaths(e,s)]):void 0)}A.trace=D,A.isTraceEnabled=d,(e=p=p||{})[e.TypeScript=0]="TypeScript",e[e.JavaScript=1]="JavaScript",e[e.DtsOnly=2]="DtsOnly",A.getEffectiveTypeRoots=f;var s=A.combinePaths("node_modules","@types");function _(e,t,r,n,i,s){if(A.isExternalModuleNameRelative(t)){var a=e,o=t,l=n,c=i,u=s;if(u.compilerOptions.rootDirs){u.traceEnabled&&D(u.host,A.Diagnostics.rootDirs_option_is_set_using_it_to_resolve_relative_module_name_0,o);for(var d,p,h=A.normalizePath(A.combinePaths(r,o)),m=0,g=u.compilerOptions.rootDirs;m<g.length;m++){var f=g[m],_=A.normalizePath(f),y=(A.endsWith(_,A.directorySeparator)||(_+=A.directorySeparator),A.startsWith(h,_)&&(void 0===p||p.length<_.length));u.traceEnabled&&D(u.host,A.Diagnostics.Checking_if_0_is_the_longest_matching_prefix_for_1_2,_,h,y),y&&(p=_,d=f)}if(p){u.traceEnabled&&D(u.host,A.Diagnostics.Longest_matching_prefix_for_0_is_1,h,p);var b=h.substr(p.length),o=(u.traceEnabled&&D(u.host,A.Diagnostics.Loading_0_from_the_root_dir_1_candidate_location_2,b,p,h),l(a,h,c,!O(r,u.host),u));if(o)return o;u.traceEnabled&&D(u.host,A.Diagnostics.Trying_other_entries_in_rootDirs);for(var v=0,T=u.compilerOptions.rootDirs;v<T.length;v++){f=T[v];if(f!==d){var k=A.combinePaths(A.normalizePath(f),b),x=(u.traceEnabled&&D(u.host,A.Diagnostics.Loading_0_from_the_root_dir_1_candidate_location_2,b,f,k),A.getDirectoryPath(k)),k=l(a,k,c,!O(x,u.host),u);if(k)return k}}u.traceEnabled&&D(u.host,A.Diagnostics.Module_resolution_using_rootDirs_has_failed)}}}else{var E,S=e,r=t,C=n,w=i,I=s;if(I.compilerOptions.baseUrl)return I.traceEnabled&&D(I.host,A.Diagnostics.baseUrl_option_is_set_to_0_using_this_value_to_resolve_non_relative_module_name_1,I.compilerOptions.baseUrl,r),o=void 0,I.compilerOptions.paths&&(I.traceEnabled&&D(I.host,A.Diagnostics.paths_option_is_specified_looking_for_a_pattern_to_match_module_name_0,r),o=A.matchPatternOrExact(A.getOwnKeys(I.compilerOptions.paths),r)),o?(E=A.isString(o)?void 0:A.matchedText(o,r),o=A.isString(o)?o:A.patternText(o),I.traceEnabled&&D(I.host,A.Diagnostics.Module_name_0_matched_pattern_1,r,o),A.forEach(I.compilerOptions.paths[o],function(e){var t=E?e.replace("*",E):e,r=A.normalizePath(A.combinePaths(I.compilerOptions.baseUrl,t)),e=(I.traceEnabled&&D(I.host,A.Diagnostics.Trying_substitution_0_candidate_module_location_Colon_1,e,t),A.tryGetExtensionFromPath(r));if(void 0!==e){t=R(r,w,!1,I);if(void 0!==t)return N({path:t,ext:e})}return C(S,r,w,!O(A.getDirectoryPath(r),I.host),I)})):(o=A.normalizePath(A.combinePaths(I.compilerOptions.baseUrl,r)),I.traceEnabled&&D(I.host,A.Diagnostics.Resolving_module_name_0_relative_to_base_url_1_2,r,I.compilerOptions.baseUrl,o),C(S,o,w,!O(A.getDirectoryPath(o),I.host),I))}}function y(e,t,r,n,i){return a(e,A.getDirectoryPath(t),r,n,i,!1)}function a(n,i,s,a,o,e){var l=d(s,a),c=[],u={compilerOptions:s,host:a,traceEnabled:l},e=!e&&t(p.TypeScript)||t(p.JavaScript);return e&&e.value?m((e=e.value).resolved,e.isExternalLibraryImport,c):{resolvedModule:void 0,failedLookupLocations:c};function t(e){var t=_(e,n,i,function(e,t,r,n,i){return v(e,t,r,n,i,!0)},c,u);if(t)return B({resolved:t,isExternalLibraryImport:!1});if(A.isExternalModuleNameRelative(n))return r=(t=A.normalizePathAndParts(A.combinePaths(i,n))).path,t=t.parts,(r=v(e,r,c,!1,u,!0))&&B({resolved:r,isExternalLibraryImport:A.contains(t,"node_modules")});l&&D(a,A.Diagnostics.Loading_module_0_from_node_modules_folder_target_file_type_1,n,p[e]);var r=I(e,n,i,c,u,o);return r?(t=r.value,{value:(t=s.preserveSymlinks?t:t&&__assign({},r.value,{path:b(r.value.path,a,l),extension:r.value.extension}))&&{resolved:t,isExternalLibraryImport:!0}}):void 0}}function b(e,t,r){var n;return t.realpath?(n=A.normalizePath(t.realpath(e)),r&&D(t,A.Diagnostics.Resolving_real_path_for_0_result_1,e,n),n):e}function v(e,t,r,n,i,s){if(i.traceEnabled&&D(i.host,A.Diagnostics.Loading_module_as_file_Slash_folder_candidate_module_location_0_target_file_type_1,t,p[e]),!A.pathEndsWithDirectorySeparator(t)){n||O(a=A.getDirectoryPath(t),i.host)||(i.traceEnabled&&D(i.host,A.Diagnostics.Directory_0_does_not_exist_skipping_all_lookups_in_it,a),n=!0);var a=k(e,t,r,n,i);if(a)return N(a)}return n||O(t,i.host)||(i.traceEnabled&&D(i.host,A.Diagnostics.Directory_0_does_not_exist_skipping_all_lookups_in_it,t),n=!0),x(e,t,r,n,i,s)}function O(e,t){return!t.directoryExists||t.directoryExists(e)}function T(e,t,r,n,i){return N(k(e,t,r,n,i))}function k(e,t,r,n,i){var s,a=o(t,e,r,n,i);return a||(A.hasJavaScriptFileExtension(t)?(a=A.removeFileExtension(t),i.traceEnabled&&(s=t.substring(a.length),D(i.host,A.Diagnostics.File_name_0_has_a_1_extension_stripping_it,t,s)),o(a,e,r,n,i)):void 0)}function o(r,e,n,i,s){var t;switch(i||(t=A.getDirectoryPath(r))&&(i=!O(t,s.host)),e){case p.DtsOnly:return a(".d.ts");case p.TypeScript:return a(".ts")||a(".tsx")||a(".d.ts");case p.JavaScript:return a(".js")||a(".jsx")}function a(e){var t=R(r+e,n,i,s);return t&&{path:t,ext:e}}}function R(e,t,r,n){if(!r){if(n.host.fileExists(e))return n.traceEnabled&&D(n.host,A.Diagnostics.File_0_exist_use_it_as_a_name_resolution_result,e),e;n.traceEnabled&&D(n.host,A.Diagnostics.File_0_does_not_exist,e)}t.push(e)}function x(e,t,r,n,i,s){var s=(s=void 0===s?!0:s)?S(t,"",r,n,i):{packageJsonContent:void 0,packageId:void 0},a=s.packageJsonContent;return u(s.packageId,E(e,t,r,n,i,a))}function E(e,t,r,n,i,s){var s=s&&((e,t,r,n,i)=>{if(e=((e,n,i,s)=>{return e?t("typings")||t("types"):t("main");function t(e){if(A.hasProperty(n,e)){var t,r=n[e];if(A.isString(r))return t=A.normalizePath(A.combinePaths(i,r)),s.traceEnabled&&D(s.host,A.Diagnostics.package_json_has_0_field_1_that_references_2,e,r,t),t;s.traceEnabled&&D(s.host,A.Diagnostics.Expected_type_of_0_field_in_package_json_to_be_string_got_1,e,typeof r)}else s.traceEnabled&&D(s.host,A.Diagnostics.package_json_does_not_have_a_0_field,e)}})(t!==p.JavaScript,e,r,i)){var r=!O(A.getDirectoryPath(e),i.host),s=R(e,n,r,i);if(s){var a=s&&((e,t)=>{var r=A.tryGetExtensionFromPath(t);return void 0!==r&&((e,t)=>{switch(e){case p.JavaScript:return".js"===t||".jsx"===t;case p.TypeScript:return".ts"===t||".tsx"===t||".d.ts"===t;case p.DtsOnly:return".d.ts"===t}})(e,r)?{path:t,ext:r}:void 0})(t,s);if(a)return a;i.traceEnabled&&D(i.host,A.Diagnostics.File_0_has_an_unsupported_extension_so_skipping_it,s)}return(a=v(t===p.DtsOnly?p.TypeScript:t,e,n,r,i,!1))?(A.Debug.assert(void 0===a.packageId),{path:a.path,ext:a.extension}):void 0}})(s,e,t,r,i);return s||(s=!n&&O(t,i.host),k(e,A.combinePaths(t,"index"),r,!s,i))}function S(e,t,r,n,i){var s,a=i.host,i=i.traceEnabled,n=!n&&O(e,a),e=C(e);return n&&a.fileExists(e)?(i&&D(a,A.Diagnostics.Found_package_json_at_0,e),{found:!0,packageJsonContent:s=g(e,a),packageId:"string"==typeof s.name&&"string"==typeof s.version?{name:s.name,subModuleName:t,version:s.version}:void 0}):(n&&i&&D(a,A.Diagnostics.File_0_does_not_exist,e),r.push(e),{found:!1,packageJsonContent:void 0,packageId:void 0})}function C(e){return A.combinePaths(e,"package.json")}function l(e,t,r,n,i,s){var a,o,l=A.normalizePath(A.combinePaths(r,t)),c=S(l,"",i,!n,s),r=(c.found?(a=c.packageJsonContent,o=c.packageId):(t=(c=w(t)).packageName,""!==(c=c.rest)&&(o=S(A.combinePaths(r,t),c,i,!n,s).packageId)),k(e,l,i,!n,s)||E(e,l,i,!n,s,a));return u(o,r)}function w(e){var t=e.indexOf(A.directorySeparator);return-1===(t="@"===e[0]?e.indexOf(A.directorySeparator,t+1):t)?{packageName:e,rest:""}:{packageName:e.slice(0,t),rest:e.slice(t+1)}}function I(e,t,r,n,i,s){return L(e,t,r,n,i,!1,s)}function L(t,r,e,n,i,s,a){var o=a&&a.getOrCreateCacheForModuleName(r);return A.forEachAncestorDirectory(A.normalizeSlashes(e),function(e){if("node_modules"!==A.getBaseFileName(e))return M(o,r,e,i.traceEnabled,i.host)||B(c(t,r,e,n,i,s))})}function c(e,t,r,n,i,s){void 0===s&&(s=!1);var r=A.combinePaths(r,"node_modules"),a=O(r,i.host),s=(!a&&i.traceEnabled&&D(i.host,A.Diagnostics.Directory_0_does_not_exist_skipping_all_lookups_in_it,r),s?void 0:l(e,t,r,a,n,i));return s||(e!==p.JavaScript?(s=A.combinePaths(r,"@types"),(e=a)&&!O(s,i.host)&&(i.traceEnabled&&D(i.host,A.Diagnostics.Directory_0_does_not_exist_skipping_all_lookups_in_it,s),e=!1),l(p.DtsOnly,((e,t)=>{var r=P(e);return t.traceEnabled&&r!==e&&D(t.host,A.Diagnostics.Scoped_package_detected_looking_in_0,r),r})(t,i),s,e,n,i)):void 0)}A.resolveTypeReferenceDirective=function(n,t,e,i){var r,s=d(e,i),a={compilerOptions:e,host:i,traceEnabled:s},o=f(e,i),l=(s&&(void 0===t?void 0===o?D(i,A.Diagnostics.Resolving_type_reference_directive_0_containing_file_not_set_root_directory_not_set,n):D(i,A.Diagnostics.Resolving_type_reference_directive_0_containing_file_not_set_root_directory_1,n,o):void 0===o?D(i,A.Diagnostics.Resolving_type_reference_directive_0_containing_file_1_root_directory_not_set,n,t):D(i,A.Diagnostics.Resolving_type_reference_directive_0_containing_file_1_root_directory_2,n,t,o)),[]),c=(()=>{if(o&&o.length)return s&&D(i,A.Diagnostics.Resolving_with_primary_search_path_0,o.join(", ")),A.forEach(o,function(e){var e=A.combinePaths(e,n),t=A.getDirectoryPath(e),r=O(t,i);return!r&&s&&D(i,A.Diagnostics.Directory_0_does_not_exist_skipping_all_lookups_in_it,t),h(x(p.DtsOnly,e,l,!r,a))});s&&D(i,A.Diagnostics.Root_directory_cannot_be_determined_skipping_primary_search_paths)})(),u=!0;return c||(c=(()=>{var e=t&&A.getDirectoryPath(t);if(void 0!==e)return s&&D(i,A.Diagnostics.Looking_up_in_node_modules_folder_initial_location_0,e),!(e=h((e=I(p.DtsOnly,n,e,l,a,void 0))&&e.value))&&s&&D(i,A.Diagnostics.Type_reference_directive_0_was_not_resolved,n),e;s&&D(i,A.Diagnostics.Containing_file_is_not_specified_and_root_directory_cannot_be_determined_skipping_lookup_in_node_modules_folder)})(),u=!1),c&&(e.preserveSymlinks||(c=__assign({},c,{fileName:b(c.fileName,i,s)})),s&&D(i,A.Diagnostics.Type_reference_directive_0_was_successfully_resolved_to_1_primary_Colon_2,n,c.fileName,u),r={primary:u,resolvedFileName:c.fileName,packageId:c.packageId}),{resolvedTypeReferenceDirective:r,failedLookupLocations:l}},A.getAutomaticTypeDirectiveNames=function(e,t){if(e.types)return e.types;var r=[];if(t.directoryExists&&t.getDirectories){e=f(e,t);if(e)for(var n=0,i=e;n<i.length;n++){var s=i[n];if(t.directoryExists(s))for(var a=0,o=t.getDirectories(s);a<o.length;a++){var l=o[a],l=A.normalizePath(l),c=C(A.combinePaths(s,l));t.fileExists(c)&&null===g(c,t).typings||r.push(A.getBaseFileName(l))}}}return r},A.createModuleResolutionCache=function(o,l){var r=A.createMap(),n=A.createMap();return{getOrCreateCacheForDirectory:function(e){var e=A.toPath(e,o,l),t=r.get(e);t||(t=A.createMap(),r.set(e,t));return t},getOrCreateCacheForModuleName:function(e){if(A.isExternalModuleNameRelative(e))return;var t=n.get(e);t||(t=(()=>{var a=A.createMap();return{get:function(e){return a.get(A.toPath(e,o,l))},set:function(e,t){e=A.toPath(e,o,l);if(!a.has(e)){a.set(e,t);for(var r=t.resolvedModule&&t.resolvedModule.resolvedFileName,n=((e,t)=>{if(void 0!==t){for(var r=A.toPath(A.getDirectoryPath(t),o,l),n=0;n<Math.min(e.length,r.length)&&e.charCodeAt(n)===r.charCodeAt(n);)n++;if(!((t=e.lastIndexOf(A.directorySeparator,n))<0))return e.substr(0,t)}})(e,r),i=e;;){var s=A.getDirectoryPath(i);if(s===i||a.has(s))break;if(a.set(s,t),(i=s)===n)break}}}}})(),n.set(e,t));return t}}},A.resolveModuleName=function(e,t,r,n,i){var s=d(r,n),a=(s&&D(n,A.Diagnostics.Resolving_module_0_from_1,e,t),A.getDirectoryPath(t)),o=i&&i.getOrCreateCacheForDirectory(a),l=o&&o.get(e);if(l)s&&D(n,A.Diagnostics.Resolution_for_module_0_was_found_in_cache,e);else{var c=r.moduleResolution;switch(void 0===c?(c=A.getEmitModuleKind(r)===A.ModuleKind.CommonJS?A.ModuleResolutionKind.NodeJs:A.ModuleResolutionKind.Classic,s&&D(n,A.Diagnostics.Module_resolution_kind_is_not_specified_using_0,A.ModuleResolutionKind[c])):s&&D(n,A.Diagnostics.Explicitly_specified_module_resolution_kind_Colon_0,A.ModuleResolutionKind[c]),c){case A.ModuleResolutionKind.NodeJs:l=y(e,t,r,n,i);break;case A.ModuleResolutionKind.Classic:l=F(e,t,r,n,i);break;default:A.Debug.fail("Unexpected moduleResolution: "+c)}o&&(o.set(e,l),o=i.getOrCreateCacheForModuleName(e))&&o.set(a,l)}return s&&(l.resolvedModule?D(n,A.Diagnostics.Module_name_0_was_successfully_resolved_to_1,e,l.resolvedModule.resolvedFileName):D(n,A.Diagnostics.Module_name_0_was_not_resolved,e)),l},A.nodeModuleNameResolver=y,A.resolveJavaScriptModule=function(e,t,r){var n=(r=a(e,t,{moduleResolution:A.ModuleResolutionKind.NodeJs,allowJs:!0},r,void 0,!0)).resolvedModule,r=r.failedLookupLocations;if(n)return n.resolvedFileName;throw new Error("Could not resolve JS module '"+e+"' starting at '"+t+"'. Looked in: "+r.join(", "))},A.directoryProbablyExists=O,A.getPackageName=w;var r="__";function P(e){if(A.startsWith(e,"@")){var t=e.replace(A.directorySeparator,r);if(t!==e)return t.slice(1)}return e}function M(e,t,r,n,i){e=e&&e.get(r);if(e)return n&&D(i,A.Diagnostics.Resolution_for_module_0_was_found_in_cache,t),{value:e.resolvedModule&&{path:e.resolvedModule.resolvedFileName,extension:e.resolvedModule.extension,packageId:e.resolvedModule.packageId}}}function F(i,e,t,s,a){var o=d(t,s),l={compilerOptions:t,host:s,traceEnabled:o},c=[],u=A.getDirectoryPath(e),t=r(p.TypeScript)||r(p.JavaScript);return m(t&&t.value,!1,c);function r(r){var n,e=_(r,i,u,T,c,l);return e?{value:e}:(n=a&&a.getOrCreateCacheForModuleName(i),A.isExternalModuleNameRelative(i)?(e=A.normalizePath(A.combinePaths(u,i)),B(T(r,e,c,!1,l))):A.forEachAncestorDirectory(u,function(e){var t=M(n,i,e,o,s);return t||(t=A.normalizePath(A.combinePaths(e,i)),B(T(r,t,c,!1,l)))})||(r===p.TypeScript?L(p.DtsOnly,i,u,c,l,!0,void 0):void 0))}}function B(e){return void 0!==e?{value:e}:void 0}A.getTypesPackageName=function(e){return"@types/"+P(e)},A.getPackageNameFromAtTypesDirectory=function(e){var t=A.removePrefix(e,"@types/");return t!==e?A.stringContains(t,r)?"@"+t.replace(r,A.directorySeparator):t:e},A.classicNameResolver=F,A.loadModuleFromGlobalCache=function(e,t,r,n,i){var s=d(r,n);return s&&D(n,A.Diagnostics.Auto_discovery_for_typings_is_enabled_in_project_0_Running_extra_resolution_pass_for_module_1_using_cache_location_2,t,e,i),t=[],m(c(p.DtsOnly,e,i,t,{compilerOptions:r,host:n,traceEnabled:s}),!0,t)}})(ts=ts||{}),(Jm=>{var Ym=/^".+"$/,t=1,r=1,Xm=1,Zm=1;function Qm(e){return e.id||(e.id=r,r++),e.id}function eg(e){return e.id||(e.id=t,t++),e.id}function tg(e,t){e=Jm.getModuleInstanceState(e);return 1===e||t&&2===e}function rg(e){switch(e.parent.kind){case 242:case 246:return 1;default:return Jm.isDeclarationName(e)}}function ng(e){switch(e.kind){case 239:case 237:case 240:case 242:return!0;case 71:return 242===e.parent.kind;default:return!1}}Jm.getNodeId=Qm,Jm.getSymbolId=eg,Jm.isInstantiatedModule=tg,Jm.createTypeChecker=function(c,G){var se,o,l,r=Jm.objectAllocator.getSymbolConstructor(),t=Jm.objectAllocator.getTypeConstructor(),u=Jm.objectAllocator.getSignatureConstructor(),n=0,i=0,p=0,a=0,m=Jm.createSymbolTable(),T=Jm.identity,M=c.getCompilerOptions(),j=Jm.getEmitScriptTarget(M),ae=Jm.getEmitModuleKind(M),k=!!M.noUnusedLocals||!!M.noUnusedParameters,h=void 0!==M.allowSyntheticDefaultImports?M.allowSyntheticDefaultImports:ae===Jm.ModuleKind.System,F=void 0===M.strictNullChecks?M.strict:M.strictNullChecks,oe=void 0===M.strictFunctionTypes?M.strict:M.strictFunctionTypes,_=void 0===M.noImplicitAny?M.strict:M.noImplicitAny,g=void 0===M.noImplicitThis?M.strict:M.noImplicitThis,s=(()=>{var a,e=c.getResolvedTypeReferenceDirectives();return e&&(a=Jm.createMap(),e.forEach(function(e,t){e&&(e=c.getSourceFile(e.resolvedFileName),a.set(e.path,t))})),{getReferencedExportContainer:Qh,getReferencedImportDeclaration:em,getReferencedDeclarationWithCollidingName:rm,isDeclarationWithCollidingName:nm,isValueAliasDeclaration:function(e){return!(e=Jm.getParseTreeNode(e))||im(e)},hasGlobalName:bm,isReferencedAliasDeclaration:function(e,t){return!(e=Jm.getParseTreeNode(e))||function t(e,r){if(Jm.isAliasSymbolDeclaration(e)){var n=W(e);if(n&&d(n).referenced)return!0}if(r)return Jm.forEachChild(e,function(e){return t(e,r)});return!1}(e,t)},getNodeCheckFlags:function(e){return(e=Jm.getParseTreeNode(e))?dm(e):void 0},isTopLevelValueImportEqualsWithEntityName:sm,isDeclarationVisible:Xn,isImplementationOfOverload:lm,isRequiredInitializedParameter:cm,isOptionalUninitializedParameterProperty:um,writeTypeOfDeclaration:fm,writeReturnTypeOfSignatureDeclaration:_m,writeTypeOfExpression:ym,isSymbolAccessible:Fn,isEntityNameVisible:Un,getConstantValue:function(e){return(e=Jm.getParseTreeNode(e,hm))?mm(e):void 0},collectLinkedAliases:Zn,getReferencedValueDeclaration:Tm,getTypeReferenceSerializationKind:gm,isOptionalParameter:Ms,moduleExportsSomeValue:Zh,isArgumentsLocalBinding:Xh,getExternalModuleFileFromDeclaration:Em,getTypeReferenceDirectivesForEntityName:function(e){var t;if(a)return t=179===e.kind||71===e.kind&&Hl(e)?1156031:794600,(e=cn(e,t,!0))&&e!==B?r(e,t):void 0},getTypeReferenceDirectivesForSymbol:r,isLiteralConstDeclaration:km,writeLiteralConstValue:xm,getJsxFactoryEntity:function(){return Ke}};function r(e,t){if(a&&(e=>{if(e.declarations){for(var t=e;;){var r=kn(t);if(!r)break;t=r}if(!(t.valueDeclaration&&265===t.valueDeclaration.kind&&512&t.flags))for(var n=0,i=e.declarations;n<i.length;n++){var s=i[n],s=Jm.getSourceFileOfNode(s);if(a.has(s.path))return 1}}})(e)){for(var r,n=0,i=e.declarations;n<i.length;n++){var s=i[n];if(s.symbol&&s.symbol.flags&t){s=Jm.getSourceFileOfNode(s),s=a.get(s.path);if(!s)return;(r=r||[]).push(s)}}return r}}})(),f={typeToTypeNode:function(e,t,r){t=y(t,r),r=E(e,t);return t.encounteredError?void 0:r},indexInfoToIndexSignatureDeclaration:function(e,t,r,n){r=y(r,n),n=w(e,t,r);return r.encounteredError?void 0:n},signatureToSignatureDeclaration:function(e,t,r,n){r=y(r,n),n=le(e,t,r);return r.encounteredError?void 0:n}};function y(e,t){return{enclosingDeclaration:e,flags:t,encounteredError:!1,symbolStack:void 0}}function E(e,_){var t=_.flags&Jm.NodeBuilderFlags.InTypeAlias;if(_.flags&=~Jm.NodeBuilderFlags.InTypeAlias,e){if(1&e.flags)return Jm.createKeywordTypeNode(119);if(2&e.flags)return Jm.createKeywordTypeNode(136);if(4&e.flags)return Jm.createKeywordTypeNode(133);if(8&e.flags)return Jm.createKeywordTypeNode(122);if(256&e.flags&&!(65536&e.flags))return a=ue(o=kn(e.symbol),_,793064,!1),o=X(o)===e?a:Jm.createQualifiedName(a,Jn(e.symbol,_)),Jm.createTypeReferenceNode(o,void 0);if(272&e.flags)return i=ue(e.symbol,_,793064,!1),Jm.createTypeReferenceNode(i,void 0);if(32&e.flags)return Jm.createLiteralTypeNode(Jm.setEmitFlags(Jm.createLiteral(e.value),16777216));if(64&e.flags)return Jm.createLiteralTypeNode(Jm.createLiteral(e.value));if(128&e.flags)return"true"===e.intrinsicName?Jm.createTrue():Jm.createFalse();if(1024&e.flags)return Jm.createKeywordTypeNode(105);if(2048&e.flags)return Jm.createKeywordTypeNode(139);if(4096&e.flags)return Jm.createKeywordTypeNode(95);if(8192&e.flags)return Jm.createKeywordTypeNode(130);if(512&e.flags)return Jm.createKeywordTypeNode(137);if(16777216&e.flags)return Jm.createKeywordTypeNode(134);if(16384&e.flags&&e.isThisType)return _.flags&Jm.NodeBuilderFlags.InObjectTypeLiteral&&(_.encounteredError||_.flags&Jm.NodeBuilderFlags.AllowThisInObjectLiteral||(_.encounteredError=!0)),Jm.createThis();var r,n,i,s,a=O(e);if(4&a){Jm.Debug.assert(!!(32768&e.flags));var o=e,l=o.typeArguments||Jm.emptyArray;if(o.target===fe)return _.flags&Jm.NodeBuilderFlags.WriteArrayAsGenericType?(f=E(l[0],_),Jm.createTypeReferenceNode("Array",[f])):(f=E(l[0],_),Jm.createArrayTypeNode(f));if(!(8&o.target.objectFlags)){var c=o.target.outerTypeParameters,u=0,d=void 0;if(c)for(var p=c.length;u<p;){for(var h,m=u,g=ea(c[u]);++u<p&&ea(c[u])===g;);Jm.rangeEquals(c,l,m,u)||(m=S(l.slice(m,u),_),m=m&&Jm.createNodeArray(m),(71===(h=T(g)).kind?h:h.right).typeArguments=m,d=d?(Jm.Debug.assert(!d.right),d=k(d,h),Jm.createQualifiedName(d,void 0)):Jm.createQualifiedName(h,void 0))}var f=void 0,y=T(o.symbol),y=(f=d?(Jm.Debug.assert(!d.right),d=k(d,y)):y,void 0);return 0<l.length&&(b=(o.target.typeParameters||Jm.emptyArray).length,y=S(l.slice(u,b),_)),y&&((71===f.kind?f:f.right).typeArguments=void 0),Jm.createTypeReferenceNode(f,y)}if(0<l.length){var b=S(l.slice(0,sa(o)),_);if(b&&0<b.length)return Jm.createTupleTypeNode(b)}return _.encounteredError||_.flags&Jm.NodeBuilderFlags.AllowEmptyTuple?Jm.createTupleTypeNode([]):void(_.encounteredError=!0)}return 16384&e.flags||3&a?(i=e.symbol?ue(e.symbol,_,793064,!1):Jm.createIdentifier("?"),Jm.createTypeReferenceNode(i,void 0)):!t&&e.aliasSymbol&&Mn(e.aliasSymbol,_.enclosingDeclaration)?(i=T(e.aliasSymbol),f=S(e.aliasTypeArguments,_),Jm.createTypeReferenceNode(i,f)):196608&e.flags?(y=S(65536&e.flags?jn(e.types):e.types,_))&&0<y.length?Jm.createUnionOrIntersectionTypeNode(65536&e.flags?166:167,y):void(_.encounteredError||_.flags&Jm.NodeBuilderFlags.AllowEmptyUnionOrIntersection||(_.encounteredError=!0)):48&a?(Jm.Debug.assert(!!(32768&e.flags)),(n=(b=e).symbol)?32&n.flags&&!vi(n)||896&n.flags||(()=>{var e=!!(8192&n.flags)&&Jm.some(n.declarations,function(e){return Jm.hasModifier(e,32)}),t=!!(16&n.flags)&&(n.parent||Jm.forEach(n.declarations,function(e){return 265===e.parent.kind||234===e.parent.kind}));return(e||t)&&Jm.contains(_.symbolStack,n)})()?(t=ue(t=n,_,107455,!1),Jm.createTypeQueryNode(t)):Jm.contains(_.symbolStack,n)?(r=zn(b))?(r=ue(r,_,793064,!1),Jm.createTypeReferenceNode(r,void 0)):Jm.createKeywordTypeNode(119):(_.symbolStack||(_.symbolStack=[]),_.symbolStack.push(n),r=v(b),_.symbolStack.pop(),r):v(b)):262144&e.flags?(s=E(e.type,_),Jm.createTypeOperatorNode(s)):524288&e.flags?(i=E(e.objectType,_),s=E(e.indexType,_),Jm.createIndexedAccessTypeNode(i,s)):void Jm.Debug.fail("Should be unreachable.")}function v(e){if(ms(e))return n=e,Jm.Debug.assert(!!(32768&n.flags)),i=n.declaration&&n.declaration.readonlyToken?Jm.createToken(131):void 0,r=n.declaration&&n.declaration.questionToken?Jm.createToken(55):void 0,t=ce(ds(n),_),n=E(hs(n),_),i=Jm.createMappedTypeNode(i,t,r,n),Jm.setEmitFlags(i,1);var t=gs(e);if(!t.properties.length&&!t.stringIndexInfo&&!t.numberIndexInfo){if(!t.callSignatures.length&&!t.constructSignatures.length)return Jm.setEmitFlags(Jm.createTypeLiteralNode(void 0),1);if(1===t.callSignatures.length&&!t.constructSignatures.length)return le(t.callSignatures[0],160,_);if(1===t.constructSignatures.length&&!t.callSignatures.length)return le(t.constructSignatures[0],161,_)}var r=_.flags,n=(_.flags|=Jm.NodeBuilderFlags.InObjectTypeLiteral,(e=>{for(var t=[],r=0,n=e.callSignatures;r<n.length;r++){var i=n[r];t.push(le(i,155,_))}for(var s=0,a=e.constructSignatures;s<a.length;s++){i=a[s];t.push(le(i,156,_))}if(e.stringIndexInfo&&t.push(w(e.stringIndexInfo,0,_)),e.numberIndexInfo&&t.push(w(e.numberIndexInfo,1,_)),!(e=e.properties))return t;for(var o=0,l=e;o<l.length;o++){var c=l[o],u=Y(c),d=_.enclosingDeclaration,p=(_.enclosingDeclaration=void 0,ue(c,_,107455,!0)),h=(_.enclosingDeclaration=d,16777216&c.flags?Jm.createToken(55):void 0);if(8208&c.flags&&!fs(u).length)for(var d=ee(u,0),m=0,g=d;m<g.length;m++){var f=le(i=g[m],150,_);f.name=p,f.questionToken=h,t.push(f)}else{d=u?E(u,_):Jm.createKeywordTypeNode(119),u=Bd(c)?[Jm.createToken(131)]:void 0,c=Jm.createPropertySignature(u,p,h,d,void 0);t.push(c)}}return t.length?t:void 0})(t)),i=(_.flags=r,Jm.createTypeLiteralNode(n));return Jm.setEmitFlags(i,1)}function T(e){return 32&e.flags||!In(e.escapedName)?ue(e,_,793064,!1):Jm.createIdentifier("")}function k(e,t){if(Jm.Debug.assert(void 0===e.right),71===t.kind)return e.right=t,e;for(var r=t;71!==r.left.kind;)r=r.left;return e.right=r.left,r.left=e,t}_.encounteredError=!0}function S(e,t){if(Jm.some(e)){for(var r=[],n=0;n<e.length;++n){var i=E(e[n],t);i&&r.push(i)}return r}}function w(e,t,r){var n=Jm.getNameFromIndexInfo(e)||"x",t=Jm.createKeywordTypeNode(0===t?136:133),n=Jm.createParameter(void 0,void 0,void 0,n,void 0,t,void 0),t=E(e.type,r);return Jm.createIndexSignature(void 0,e.isReadonly?[Jm.createToken(131)]:void 0,[n],t)}function le(e,t,r){var n,i,s=e.typeParameters&&e.typeParameters.map(function(e){return ce(e,r)}),a=e.parameters.map(function(e){return v(e,r)});return e.thisParameter&&(n=v(e.thisParameter,r),a.unshift(n)),n=e.typePredicate?(i=1===(n=e.typePredicate).kind?Jm.setEmitFlags(Jm.createIdentifier(n.parameterName),16777216):Jm.createThisTypeNode(),n=E(n.type,r),Jm.createTypePredicateNode(i,n)):(i=te(e))&&E(i,r),r.flags&Jm.NodeBuilderFlags.SuppressAnyReturnType?n&&119===n.kind&&(n=void 0):n=n||Jm.createKeywordTypeNode(119),Jm.createSignatureDeclaration(t,s,a,n)}function ce(e,t){var r=ue(e.symbol,t,793064,!0),n=Qs(e),n=n&&E(n,t),e=Es(e),e=e&&E(e,t);return Jm.createTypeParameterDeclaration(r,n,e)}function v(e,t){var r,n,i,s,a=Jm.getDeclarationOfKind(e,146);return Fr(e)&&e.isRestParameter?Jm.createParameter(void 0,void 0,e.isRestParameter?Jm.createToken(24):void 0,"args",void 0,E(xe,t),void 0):(r=a.modifiers&&a.modifiers.map(Jm.getSynthesizedClone),n=Jm.isRestParameter(a)?Jm.createToken(24):void 0,i=a.name?71===a.name.kind?Jm.setEmitFlags(Jm.getSynthesizedClone(a.name),16777216):function e(t){t=Jm.visitEachChild(t,e,Jm.nullTransformationContext,void 0,e);t=Jm.nodeIsSynthesized(t)?t:Jm.getSynthesizedClone(t);176===t.kind&&(t.initializer=void 0);return Jm.setEmitFlags(t,16777217)}(a.name):Jm.symbolName(e),s=Ms(a)?Jm.createToken(55):void 0,e=Y(e),a=E(e=cm(a)?yl(e,2048):e,t),Jm.createParameter(void 0,r,n,i,s,a,void 0))}function ue(e,o,t,r){var n;return!(262144&e.flags)&&(o.enclosingDeclaration||o.flags&Jm.NodeBuilderFlags.UseFullyQualifiedType)?(n=function e(t,r,n){var i=Ln(t,o.enclosingDeclaration,r,!1);var s;{var a;i&&!Pn(i[0],o.enclosingDeclaration,1===i.length?r:Rn(r))||(a=kn(i?i[0]:t))&&(r=e(a,Rn(r),!1))&&(s=a,i=r.concat(i||[t]))}if(i)return i;if(n||(s||!Jm.forEach(t.declarations,Bn))&&!(6144&t.flags))return[t]}(e,t,!0),Jm.Debug.assert(n&&0<n.length)):n=[e],!r||1===n.length||o.encounteredError||o.flags&Jm.NodeBuilderFlags.AllowQualifedNameInPlaceOfIdentifier||(o.encounteredError=!0),function e(t,r){Jm.Debug.assert(t&&0<=r&&r<t.length);var n=t[r];{var i;o.flags&Jm.NodeBuilderFlags.WriteTypeParametersInQualifiedName&&0<r&&(i=t[r-1],s=void 0,1&Jm.getCheckFlags(n)?s=Ai(i):524384&Th(i).flags&&(s=Ii(n)),i=S(s,o))}var s=Jn(n,o);n=Jm.setEmitFlags(Jm.createIdentifier(s,i),16777216);return 0<r?Jm.createQualifiedName(e(t,r-1),n):n}(n,n.length-1)}var de,pe,he,me,ge,fe,_e,ye,be,ve,Te,ke,xe,Ee,Se,Ce,we,Ie,Ae,De,Ne,Oe,Re,Le,Pe,Me,Fe,Be,$e,Ue,Ve,He,Ge,je,Ke,ze,We,qe,Je,Ye=Mr(4,"undefined"),Xe=(Ye.declarations=[],Mr(4,"arguments")),Ze={getNodeCount:function(){return Jm.sum(c.getSourceFiles(),"nodeCount")},getIdentifierCount:function(){return Jm.sum(c.getSourceFiles(),"identifierCount")},getSymbolCount:function(){return Jm.sum(c.getSourceFiles(),"symbolCount")+i},getTypeCount:function(){return n},isUndefinedSymbol:function(e){return e===Ye},isArgumentsSymbol:function(e){return e===Xe},isUnknownSymbol:function(e){return e===B},getMergedSymbol:Tn,getDiagnostics:$h,getGlobalDiagnostics:function(){return Uh(),sr.getGlobalDiagnostics()},getTypeOfSymbolAtLocation:function(e,t){if(t=Jm.getParseTreeNode(t)){if(e=e.exportSymbol||e,71===t.kind&&(Jm.isRightSideOfQualifiedNameOrPropertyAccess(t)&&(t=t.parent),Jm.isPartOfExpression(t))&&!Jm.isAssignmentTarget(t)){var r=op(t);if(xn(b(t).resolvedSymbol)===e)return r}return Y(e)}return K},getSymbolsOfParameterPropertyDeclaration:function(e,t){e=Jm.getParseTreeNode(e,Jm.isParameter),Jm.Debug.assert(void 0!==e,"Cannot get symbols of a synthetic parameter that cannot be resolved to a parse-tree node.");var t=Jm.escapeLeadingUnderscores(t),r=e.parent,e=e.parent.parent,r=Gr(r.locals,t,107455),e=Gr(e.symbol.members,t,107455);if(r&&e)return[r,e];Jm.Debug.fail("There should exist two symbols, one as property declaration and one as parameter declaration")},getDeclaredTypeOfSymbol:X,getPropertiesOfType:Z,getPropertyOfType:function(e,t){return R(e,Jm.escapeLeadingUnderscores(t))},getIndexInfoOfType:L,getSignaturesOfType:ee,getIndexTypeOfType:Ns,getBaseTypes:Mi,getBaseTypeOfLiteralType:dl,getWidenedType:Sl,getTypeFromTypeNode:function(e){return(e=Jm.getParseTreeNode(e,Jm.isTypeNode))?re(e):K},getParameterType:Cd,getReturnTypeOfSignature:te,getNullableType:yl,getNonNullableType:bl,typeToTypeNode:f.typeToTypeNode,indexInfoToIndexSignatureDeclaration:f.indexInfoToIndexSignatureDeclaration,signatureToSignatureDeclaration:f.signatureToSignatureDeclaration,getSymbolsInScope:function(e,t){if(!(e=Jm.getParseTreeNode(e)))return[];var r,n,i=e,s=t;if(Vh(i))return[];for(r=Jm.createSymbolTable(),n=!1;i;){switch(i.locals&&!Hr(i)&&o(i.locals,s),i.kind){case 233:o(W(i).exports,2623475&s);break;case 232:o(W(i).exports,8&s);break;case 199:i.name&&a(i.symbol,s);case 229:case 230:n||o(W(i).members,793064&s);break;case 186:i.name&&a(i.symbol,s)}Jm.introducesArgumentsExoticObject(i)&&a(Xe,s),n=Jm.hasModifier(i,32),i=i.parent}return o(Pt,s),Rs(r);function a(e,t){Jm.getCombinedLocalAndExportSymbolFlags(e)&t&&(t=e.escapedName,r.has(t)||r.set(t,e))}function o(e,t){t&&e.forEach(function(e){a(e,t)})}},getSymbolAtLocation:function(e){return(e=Jm.getParseTreeNode(e))?qh(e):void 0},getShorthandAssignmentValueSymbol:function(e){if(e=Jm.getParseTreeNode(e))if(e&&262===e.kind)return cn(e.name,2204607)},getExportSpecifierLocalTargetSymbol:function(e){return(e=Jm.getParseTreeNode(e,Jm.isExportSpecifier))?(e=e).parent.parent.moduleSpecifier?Zr(e.parent.parent,e):cn(e.propertyName||e.name,2998271):void 0},getExportSymbolOfSymbol:function(e){return Tn(e.exportSymbol||e)},getTypeAtLocation:function(e){return(e=Jm.getParseTreeNode(e))?Jh(e):K},getPropertySymbolOfDestructuringAssignment:function(e){return(e=Jm.getParseTreeNode(e,Jm.isIdentifier))?(t=function e(t){Jm.Debug.assert(178===t.kind||177===t.kind);if(216===t.parent.kind)return r=ah(t.parent.expression,t.parent.awaitModifier),qd(t,r||K);if(194===t.parent.kind)return r=op(t.parent.right),qd(t,r||K);if(261===t.parent.kind)return zd(e(t.parent.parent)||K,t.parent);Jm.Debug.assert(177===t.parent.kind);var r=e(t.parent);var n=oh(r||K,t.parent,!1,!1)||K;return Wd(t.parent,r,Jm.indexOf(t.parent.elements,t),n||K)}((e=e).parent.parent))&&R(t,e.escapedText):void 0;var t},signatureToString:function(e,t,r,n){return Hn(e,Jm.getParseTreeNode(t),r,n)},typeToString:function(e,t,r){return J(e,Jm.getParseTreeNode(t),r)},getSymbolDisplayBuilder:Yn,symbolToString:function(e,t,r){return q(e,Jm.getParseTreeNode(t),r)},getAugmentedPropertiesOfType:function(e){e=Q(e);var t=Jm.createSymbolTable(Z(e));(ee(e,0).length||ee(e,1).length)&&Jm.forEach(Z(ge),function(e){t.has(e.escapedName)||t.set(e.escapedName,e)});return An(t)},getRootSymbols:function e(t){{var r,n;if(6&Jm.getCheckFlags(t))return r=[],n=t.escapedName,Jm.forEach(d(t).containingType.types,function(e){e=R(e,n);e&&r.push(e)}),r;if(33554432&t.flags){var i=t;if(i.leftSpread)return e(i.leftSpread).concat(e(i.rightSpread));if(i.syntheticOrigin)return e(i.syntheticOrigin);for(var s=void 0,a=t;a=d(a).target;)s=a;if(s)return[s]}}return[t]},getContextualType:function(e){return(e=Jm.getParseTreeNode(e,Jm.isExpression))?eu(e):void 0},getFullyQualifiedName:ln,getResolvedSignature:function(e,t,r){e=Jm.getParseTreeNode(e,Jm.isCallLikeExpression),de=r;r=e?_d(e,t):void 0;return de=void 0,r},getConstantValue:function(e){return(e=Jm.getParseTreeNode(e,hm))?mm(e):void 0},isValidPropertyAccess:function(e,t){return!!(e=Jm.getParseTreeNode(e,Jm.isPropertyAccessOrQualifiedName))&&(e=e,t=Jm.escapeLeadingUnderscores(t),r=179===e.kind?e.expression:e.left,function e(t,r,n,i){if(i!==K&&!D(i)){var s=R(i,n);if(s)return Lu(t,r,i,s);if(Jm.isInJavaScriptFile(r)&&65536&i.flags)for(var a=0,o=i.types;a<o.length;a++){var l=o[a];if(e(t,r,n,l))return!0}return!1}return!0}(e,r,t,Sl(V(r))));var r},getSignatureFromDeclaration:function(e){return(e=Jm.getParseTreeNode(e,Jm.isFunctionLike))?Us(e):void 0},isImplementationOfOverload:function(e){e=Jm.getParseTreeNode(e,Jm.isFunctionLike);return e?lm(e):void 0},getImmediateAliasedSymbol:function(e){Jm.Debug.assert(0!=(2097152&e.flags),"Should only get Alias here.");var t=d(e);return t.immediateTarget||(e=Xr(e),Jm.Debug.assert(!!e),t.immediateTarget=en(e,!0)),t.immediateTarget},getAliasedSymbol:nn,getEmitResolver:function(e,t){return $h(e,t),s},getExportsOfModule:fn,getExportsAndPropertiesOfModule:function(e){var t=fn(e),r=hn(e);r!==e&&Jm.addRange(t,Z(Y(r)));return t},getSymbolWalker:Jm.createGetSymbolWalker(Gs,te,Mi,gs,Y,Vl,Ds,Qs,Ih),getAmbientModules:function(){pe||(pe=[],Pt.forEach(function(e,t){Ym.test(t)&&pe.push(e)}));return pe},getAllAttributesTypeFromJsxOpeningLikeElement:function(e){return(e=Jm.getParseTreeNode(e,Jm.isJsxOpeningLikeElement))?fu((e=e).tagName)?Su(e):Cu(e,!0):void 0},getJsxIntrinsicTagNames:function(){var e=yu(hr.IntrinsicElements);return e?Z(e):Jm.emptyArray},isOptionalParameter:function(e){return!!(e=Jm.getParseTreeNode(e,Jm.isParameter))&&Ms(e)},tryGetMemberInModuleExports:function(e,t){return _n(Jm.escapeLeadingUnderscores(e),t)},tryGetMemberInModuleExportsAndProperties:function(e,t){var e=Jm.escapeLeadingUnderscores(e),r=_n(e,t);if(!r){var n=hn(t);if(n!==t)return R(Y(n),e)}return r},tryFindAmbientModuleWithoutAugmentations:function(e){return Ps(e,!1)},getApparentType:Q,getUnionType:P,createAnonymousType:Nn,createSignature:es,createSymbol:Mr,createIndexInfo:Xs,getAnyType:function(){return C},getStringType:function(){return $},getNumberType:function(){return dt},createPromiseType:Ad,createArrayType:Pa,getBooleanType:function(){return mt},getVoidType:function(){return ft},getUndefinedType:function(){return ot},getNullType:function(){return ct},getESSymbolType:function(){return gt},getNeverType:function(){return _t},isSymbolAccessible:Fn,isArrayLikeType:ol,getAllPossiblePropertiesOfTypes:function(e){var t=P(e);if(!(65536&t.flags))return Z(t);for(var r=Jm.createSymbolTable(),n=0,i=e;n<i.length;n++)for(var s=i[n],a=0,o=Z(s);a<o.length;a++){var l=o[a].escapedName;r.has(l)||r.set(l,Ss(t,l))}return Jm.arrayFrom(r.values())},getSuggestionForNonexistentProperty:Uu,getSuggestionForNonexistentSymbol:function(e,t,r){return Vu(e,Jm.escapeLeadingUnderscores(t),r)},getBaseConstraintOfType:vs,resolveName:function(e,t,r){return Kr(t,Jm.escapeLeadingUnderscores(e),r,void 0,void 0,!1)},getJsxNamespace:function(){return Jm.unescapeLeadingUnderscores(Pr())}},Qe=[],et=Jm.createMap(),tt=Jm.createMap(),rt=Jm.createMap(),nt=Jm.createMap(),it=[],B=Mr(4,"unknown"),st=Mr(0,"__resolving__"),C=Cn(1,"any"),at=Cn(1,"any"),K=Cn(1,"unknown"),ot=Cn(2048,"undefined"),lt=F?ot:Cn(2099200,"undefined"),ct=Cn(4096,"null"),ut=F?ct:Cn(2101248,"null"),$=Cn(2,"string"),dt=Cn(4,"number"),pt=Cn(128,"true"),ht=Cn(128,"false"),mt=(e=>((e=P(e)).flags|=8,e.intrinsicName="boolean",e))([pt,ht]),gt=Cn(512,"symbol"),ft=Cn(1024,"void"),_t=Cn(8192,"never"),yt=Cn(8192,"never"),bt=Cn(16777216,"object"),N=Nn(void 0,m,Jm.emptyArray,Jm.emptyArray,void 0,void 0),e=Mr(2048,"__type"),vt=(e.members=Jm.createSymbolTable(),Nn(e,m,Jm.emptyArray,Jm.emptyArray,void 0,void 0)),Tt=Nn(void 0,m,Jm.emptyArray,Jm.emptyArray,void 0,void 0),kt=(Tt.instantiations=Jm.createMap(),Nn(void 0,m,Jm.emptyArray,Jm.emptyArray,void 0,void 0)),xt=(kt.flags|=8388608,Nn(void 0,m,Jm.emptyArray,Jm.emptyArray,void 0,void 0)),Et=Nn(void 0,m,Jm.emptyArray,Jm.emptyArray,void 0,void 0),St=Nn(void 0,m,Jm.emptyArray,Jm.emptyArray,void 0,void 0),Ct=Sn(16384),wt=Sn(16384),It=(wt.constraint=Ct,Sn(16384)),At=es(void 0,void 0,void 0,Jm.emptyArray,C,void 0,0,!1,!1),Dt=es(void 0,void 0,void 0,Jm.emptyArray,K,void 0,0,!1,!1),Nt=es(void 0,void 0,void 0,Jm.emptyArray,C,void 0,0,!1,!1),Ot=es(void 0,void 0,void 0,Jm.emptyArray,yt,void 0,0,!1,!1),Rt=Xs($,!0),Lt=Xs(C,!1),Pt=Jm.createSymbolTable(),Mt=0,Ft=0,Bt=0,$t=!1,Ut=ho(""),Vt=ho(0),Ht=[],Gt=[],jt=[],Kt=0,zt=10,Wt=[],qt=[],Jt=[],Yt=[],Xt=[],Zt=[],Qt=[],er=[],tr=[],rr=[],nr=[],ir=[],sr=Jm.createDiagnosticCollection(),ar=((e={None:0,0:"None",TypeofEQString:1,1:"TypeofEQString",TypeofEQNumber:2,2:"TypeofEQNumber",TypeofEQBoolean:4,4:"TypeofEQBoolean",TypeofEQSymbol:8,8:"TypeofEQSymbol",TypeofEQObject:16,16:"TypeofEQObject",TypeofEQFunction:32,32:"TypeofEQFunction",TypeofEQHostObject:64,64:"TypeofEQHostObject",TypeofNEString:128,128:"TypeofNEString",TypeofNENumber:256,256:"TypeofNENumber",TypeofNEBoolean:512,512:"TypeofNEBoolean",TypeofNESymbol:1024,1024:"TypeofNESymbol",TypeofNEObject:2048,2048:"TypeofNEObject",TypeofNEFunction:4096,4096:"TypeofNEFunction",TypeofNEHostObject:8192,8192:"TypeofNEHostObject",EQUndefined:16384,16384:"EQUndefined",EQNull:32768,32768:"EQNull",EQUndefinedOrNull:65536,65536:"EQUndefinedOrNull",NEUndefined:131072,131072:"NEUndefined",NENull:262144,262144:"NENull",NEUndefinedOrNull:524288,524288:"NEUndefinedOrNull",Truthy:1048576,1048576:"Truthy",Falsy:2097152,2097152:"Falsy",Discriminatable:4194304,4194304:"Discriminatable",All:8388607,8388607:"All",BaseStringStrictFacts:933633,933633:"BaseStringStrictFacts",BaseStringFacts:3145473,3145473:"BaseStringFacts",StringStrictFacts:4079361,4079361:"StringStrictFacts",StringFacts:4194049,4194049:"StringFacts",EmptyStringStrictFacts:3030785,3030785:"EmptyStringStrictFacts",EmptyStringFacts:3145473})[3145473]="EmptyStringFacts",e[e.NonEmptyStringStrictFacts=1982209]="NonEmptyStringStrictFacts",e[e.NonEmptyStringFacts=4194049]="NonEmptyStringFacts",e[e.BaseNumberStrictFacts=933506]="BaseNumberStrictFacts",e[e.BaseNumberFacts=3145346]="BaseNumberFacts",e[e.NumberStrictFacts=4079234]="NumberStrictFacts",e[e.NumberFacts=4193922]="NumberFacts",e[e.ZeroStrictFacts=3030658]="ZeroStrictFacts",e[e.ZeroFacts=3145346]="ZeroFacts",e[e.NonZeroStrictFacts=1982082]="NonZeroStrictFacts",e[e.NonZeroFacts=4193922]="NonZeroFacts",e[e.BaseBooleanStrictFacts=933252]="BaseBooleanStrictFacts",e[e.BaseBooleanFacts=3145092]="BaseBooleanFacts",e[e.BooleanStrictFacts=4078980]="BooleanStrictFacts",e[e.BooleanFacts=4193668]="BooleanFacts",e[e.FalseStrictFacts=3030404]="FalseStrictFacts",e[e.FalseFacts=3145092]="FalseFacts",e[e.TrueStrictFacts=1981828]="TrueStrictFacts",e[e.TrueFacts=4193668]="TrueFacts",e[e.SymbolStrictFacts=1981320]="SymbolStrictFacts",e[e.SymbolFacts=4193160]="SymbolFacts",e[e.ObjectStrictFacts=6166480]="ObjectStrictFacts",e[e.ObjectFacts=8378320]="ObjectFacts",e[e.FunctionStrictFacts=6164448]="FunctionStrictFacts",e[e.FunctionFacts=8376288]="FunctionFacts",e[e.UndefinedFacts=2457472]="UndefinedFacts",e[e.NullFacts=2340752]="NullFacts",Jm.createMapFromTemplate({string:1,number:2,boolean:4,symbol:8,undefined:16384,object:16,function:32})),or=Jm.createMapFromTemplate({string:128,number:256,boolean:512,symbol:1024,undefined:131072,object:2048,function:4096}),lr=Jm.createMapFromTemplate({string:$,number:dt,boolean:mt,symbol:gt,undefined:ot}),cr=P(Jm.arrayFrom(ar.keys(),ho)),ur=!1,dr=!1,pr=Jm.createUnderscoreEscapedMap(),hr={JSX:"JSX",IntrinsicElements:"IntrinsicElements",ElementClass:"ElementClass",ElementAttributesPropertyNameContainer:"ElementAttributesProperty",ElementChildrenAttributeNameContainer:"ElementChildrenAttribute",Element:"Element",IntrinsicAttributes:"IntrinsicAttributes",IntrinsicClassAttributes:"IntrinsicClassAttributes"},mr=Jm.createMap(),gr=Jm.createMap(),fr=Jm.createMap(),_r=Jm.createMap(),yr=Jm.createMap();(e=Jm.createSymbolTable()).set(Ye.escapedName,Ye);for(var br=Jm.and(Ph,function(e){return!Jm.isAccessor(e)}),vr=0,Tr=c.getSourceFiles();vr<Tr.length;vr++){var kr=Tr[vr];Jm.bindSourceFile(kr,M)}for(var xr=0,Er=c.getSourceFiles();xr<Er.length;xr++){kr=Er[xr];Jm.isExternalOrCommonJsModule(kr)||Vr(Pt,kr.locals),kr.patternAmbientModules&&kr.patternAmbientModules.length&&(he=Jm.concatenate(he,kr.patternAmbientModules)),kr.moduleAugmentations.length&&(Je=Je||[]).push(kr.moduleAugmentations),kr.symbol&&kr.symbol.globalExports&&kr.symbol.globalExports.forEach(function(e,t){Pt.has(t)||Pt.set(t,e)})}if(Je)for(var Sr=0,Cr=Je;Sr<Cr.length;Sr++)for(var wr=Cr[Sr],Ir=0,Ar=wr;Ir<Ar.length;Ir++){Dr=void 0;Or=void 0;Nr=void 0;var Dr=Ar[Ir];var Nr,Or=Dr.parent;Or.symbol.declarations[0]!==Or?Jm.Debug.assert(1<Or.symbol.declarations.length):Jm.isGlobalScopeAugmentation(Or)?Vr(Pt,Or.symbol.exports):(Nr=Jm.isInAmbientContext(Dr.parent.parent)?void 0:Jm.Diagnostics.Invalid_module_name_in_augmentation_module_0_cannot_be_found,(Nr=dn(Dr,Dr,Nr,!0))&&(1920&(Nr=hn(Nr)).flags?Ur(Nr=33554432&Nr.flags?Nr:$r(Nr),Or.symbol):z(Dr,Jm.Diagnostics.Cannot_augment_module_0_because_it_resolves_to_a_non_module_entity,Dr.text)))}var Rr=Pt,Lr=Jm.Diagnostics.Declaration_name_conflicts_with_built_in_global_identifier_0;return e.forEach(function(e,t){var r,n,i=Rr.get(t);i?Jm.forEach(i.declarations,(r=Jm.unescapeLeadingUnderscores(t),n=Lr,function(e){return sr.add(Jm.createDiagnosticForNode(e,n,r))})):Rr.set(t,e)}),d(Ye).type=lt,d(Xe).type=ya("IArguments",0,!0),d(B).type=K,fe=ya("Array",1,!0),me=ya("Object",0,!0),ge=ya("Function",0,!0),ye=ya("String",0,!0),be=ya("Number",0,!0),ve=ya("Boolean",0,!0),Te=ya("RegExp",0,!0),xe=Pa(C),Ee=Pa(at),_e=Ia("ReadonlyArray",1),Se=_e?Da(_e,[C]):xe,ke=Ia("ThisType",1),Ze;function Pr(){return je||(je="React",M.jsxFactory?(Ke=Jm.parseIsolatedEntityName(M.jsxFactory,j))&&(je=Ih(Ke).escapedText):M.reactNamespace&&(je=Jm.escapeLeadingUnderscores(M.reactNamespace))),je}function z(e,t,r,n,i){e=e?Jm.createDiagnosticForNode(e,t,r,n,i):Jm.createCompilerDiagnostic(t,r,n,i);sr.add(e)}function Mr(e,t){i++;e=new r(33554432|e,t);return e.checkFlags=0,e}function Fr(e){return 0!=(33554432&e.flags)}function Br(e,t){t.mergeId||(t.mergeId=Xm,Xm++),Wt[t.mergeId]=e}function $r(e){var t=Mr(e.flags,e.escapedName);return t.declarations=e.declarations?e.declarations.slice():[],t.parent=e.parent,e.valueDeclaration&&(t.valueDeclaration=e.valueDeclaration),e.constEnumOnlyModule&&(t.constEnumOnlyModule=!0),e.members&&(t.members=Jm.cloneMap(e.members)),e.exports&&(t.exports=Jm.cloneMap(e.exports)),Br(t,e),t}function Ur(e,t){var r,n,i;e.flags&(n=t.flags,i=0,2&n&&(i|=107455),1&n&&(i|=107454),4&n&&(i|=0),8&n&&(i|=900095),16&n&&(i|=106927),32&n&&(i|=899519),64&n&&(i|=792968),256&n&&(i|=899327),128&n&&(i|=899967),512&n&&(i|=106639),8192&n&&(i|=99263),32768&n&&(i|=41919),65536&n&&(i|=74687),262144&n&&(i|=530920),524288&n&&(i|=793064),2097152&n&&(i|=2097152),i)?1024&e.flags?z(Jm.getNameOfDeclaration(t.declarations[0]),Jm.Diagnostics.Cannot_augment_module_0_with_value_exports_because_it_resolves_to_a_non_module_entity,q(e)):(r=2&e.flags||2&t.flags?Jm.Diagnostics.Cannot_redeclare_block_scoped_variable_0:Jm.Diagnostics.Duplicate_identifier_0,Jm.forEach(t.declarations,function(e){z(Jm.getNameOfDeclaration(e)||e,r,q(t))}),Jm.forEach(e.declarations,function(e){z(Jm.getNameOfDeclaration(e)||e,r,q(t))})):(512&t.flags&&512&e.flags&&e.constEnumOnlyModule&&!t.constEnumOnlyModule&&(e.constEnumOnlyModule=!1),e.flags|=t.flags,t.valueDeclaration&&(!e.valueDeclaration||233===e.valueDeclaration.kind&&233!==t.valueDeclaration.kind)&&(e.valueDeclaration=t.valueDeclaration),Jm.addRange(e.declarations,t.declarations),t.members&&(e.members||(e.members=Jm.createSymbolTable()),Vr(e.members,t.members)),t.exports&&(e.exports||(e.exports=Jm.createSymbolTable()),Vr(e.exports,t.exports)),Br(e,t))}function Vr(n,e){e.forEach(function(e,t){var r=n.get(t);r?(33554432&r.flags||(r=$r(r),n.set(t,r)),Ur(r,e)):n.set(t,e)})}function d(e){return 33554432&e.flags?e:(e=eg(e),qt[e]||(qt[e]={}))}function b(e){e=Qm(e);return Jt[e]||(Jt[e]={flags:0})}function O(e){return 32768&e.flags?e.objectFlags:0}function Hr(e){return 265===e.kind&&!Jm.isExternalOrCommonJsModule(e)}function Gr(e,t,r){if(r){e=e.get(t);if(e){if(Jm.Debug.assert(0==(1&Jm.getCheckFlags(e)),"Should never get an instantiated symbol here."),e.flags&r)return e;if(2097152&e.flags){t=nn(e);if(t===B||t.flags&r)return e}}}}function jr(e,t){var r,n=Jm.getSourceFileOfNode(e),i=Jm.getSourceFileOfNode(t);if(n!==i)return!!(ae&&(n.externalModuleIndicator||i.externalModuleIndicator)||!M.outFile&&!M.out||Hl(t)||Jm.isInAmbientContext(e))||!!l(t,e)||(r=c.getSourceFiles(),Jm.indexOf(r,n)<=Jm.indexOf(r,i));if(e.pos<=t.pos){if(176===e.kind)return(n=Jm.getAncestor(t,176))?Jm.findAncestor(n,Jm.isBindingElement)!==Jm.findAncestor(e,Jm.isBindingElement)||e.pos<n.pos:jr(Jm.getAncestor(e,226),t);if(226!==e.kind)return!0;var s=e,a=t,o=Jm.getEnclosingBlockScopeContainer(s);switch(s.parent.parent.kind){case 208:case 214:case 216:if(Jr(a,s,o))return!1}return!(Jm.isForInOrOfStatement(s.parent.parent)&&Jr(a,s.parent.parent.expression,o))}return!!(246===t.parent.kind||243===t.parent.kind&&t.parent.isExportEquals)||!(243!==t.kind||!t.isExportEquals)||(r=Jm.getEnclosingBlockScopeContainer(e),Hl(t))||l(t,e,r);function l(r,n,i){return!!Jm.findAncestor(r,function(e){if(e===i)return"quit";if(Jm.isFunctionLike(e))return!0;var t=e.parent&&149===e.parent.kind&&e.parent.initializer===e;if(t)if(Jm.hasModifier(e.parent,32)){if(151===n.kind)return!0}else if(!(149===n.kind&&!Jm.hasModifier(n,32))||Jm.getContainingClass(r)!==Jm.getContainingClass(n))return!0})}}function Kr(e,t,r,n,i,s,a){return zr(e,t,r,n,i,s,Gr,a)}function zr(e,t,r,n,i,s,a,o){var l,c,u,d,p,h,m=e,g=e,f=!1;e:for(;e;){if(e.locals&&!Hr(e)&&(l=a(e.locals,t,r))){var _=!0;if(_=Jm.isFunctionLike(e)&&c&&c!==e.body&&(r&l.flags&793064&&275!==c.kind&&(_=!!(262144&l.flags)&&(c===e.type||146===c.kind||145===c.kind)),107455&r)&&1&l.flags?146===c.kind||c===e.type&&146===l.valueDeclaration.kind:_)break;l=void 0}switch(e.kind){case 265:if(!Jm.isExternalOrCommonJsModule(e))break;f=!0;case 233:var y=W(e).exports;if(265===e.kind||Jm.isAmbientModule(e)){if(l=y.get("default")){var b=Jm.getLocalSymbolForExportDefault(l);if(b&&l.flags&r&&b.escapedName===t)break e;l=void 0}b=y.get(t);if(b&&2097152===b.flags&&Jm.getDeclarationOfKind(b,246))break}if(l=a(y,t,2623475&r))break e;break;case 232:if(l=a(W(e).exports,t,8&r))break e;break;case 149:case 148:Jm.isClassLike(e.parent)&&!Jm.hasModifier(e,32)&&(y=(e=>{for(var e=e.members,t=0,r=e;t<r.length;t++){var n=r[t];if(152===n.kind&&Jm.nodeIsPresent(n.body))return n}})(e.parent))&&y.locals&&a(y.locals,t,107455&r)&&(d=e);break;case 229:case 199:case 230:if(l=a(W(e).members,t,793064&r)){if(!((e,t)=>{for(var r=0,n=e.declarations;r<n.length;r++){var i=n[r];if(145===i.kind&&i.parent===t)return 1}})(l,e)){l=void 0;break}if(c&&Jm.hasModifier(c,32))return void z(g,Jm.Diagnostics.Static_members_cannot_reference_class_type_parameters);break e}if(199===e.kind&&32&r){var v=e.name;if(v&&t===v.escapedText){l=e.symbol;break e}}break;case 201:if(c===e.expression&&85===e.parent.token){v=e.parent.parent;if(Jm.isClassLike(v)&&(l=a(W(v).members,t,793064&r)))return void(n&&z(g,Jm.Diagnostics.Base_class_expressions_cannot_reference_class_type_parameters))}break;case 144:if(T=e.parent.parent,(Jm.isClassLike(T)||230===T.kind)&&(l=a(W(T).members,t,793064&r)))return void z(g,Jm.Diagnostics.A_computed_property_name_cannot_reference_a_type_parameter_from_its_containing_type);break;case 151:case 150:case 152:case 153:case 154:case 228:case 187:if(3&r&&"arguments"===t){l=Xe;break e}break;case 186:if(3&r&&"arguments"===t){l=Xe;break e}if(16&r){var T=e.name;if(T&&t===T.escapedText){l=e.symbol;break e}}break;case 147:(e=e.parent&&146===e.parent.kind?e.parent:e).parent&&Jm.isClassElement(e.parent)&&(e=e.parent)}207!==e.kind&&(u=e),e=(c=e).parent}if(s&&l&&n&&k&&l!==u.symbol&&(l.isReferenced=!0),!l){if(c&&(Jm.Debug.assert(265===c.kind),c.commonJsModuleIndicator)&&"exports"===t)return c.symbol;l=a(Pt,t,r)}if(l){if(n){if(d)return s=d.name,void z(g,Jm.Diagnostics.Initializer_of_instance_member_variable_0_cannot_reference_identifier_1_declared_in_the_constructor,Jm.declarationNameToString(s),Wr(i));g&&(2&r||(32&r||384&r)&&107455==(107455&r))&&(2&(s=xn(l)).flags||32&s.flags||384&s.flags)&&(s=s,p=g,Jm.Debug.assert(!!(2&s.flags||32&s.flags||384&s.flags)),h=Jm.forEach(s.declarations,function(e){return Jm.isBlockOrCatchScoped(e)||Jm.isClassLike(e)||232===e.kind?e:void 0}),Jm.Debug.assert(void 0!==h,"Declaration to checkResolvedBlockScopedVariable is undefined"),Jm.isInAmbientContext(h)||jr(h,p)||(2&s.flags?z(p,Jm.Diagnostics.Block_scoped_variable_0_used_before_its_declaration,Jm.declarationNameToString(Jm.getNameOfDeclaration(h))):32&s.flags?z(p,Jm.Diagnostics.Class_0_used_before_its_declaration,Jm.declarationNameToString(Jm.getNameOfDeclaration(h))):256&s.flags&&z(p,Jm.Diagnostics.Enum_0_used_before_its_declaration,Jm.declarationNameToString(Jm.getNameOfDeclaration(h))))),l&&f&&107455==(107455&r)&&(s=l.declarations)&&1===s.length&&236===s[0].kind&&z(g,Jm.Diagnostics._0_refers_to_a_UMD_global_but_the_current_file_is_a_module_Consider_adding_an_import_instead,Jm.unescapeLeadingUnderscores(t))}return l}!n||g&&(((e,t,r)=>{if(!(71===e.kind&&Gh(e)||Hl(e)))for(var n=Jm.getThisContainer(e,!0),i=n;i;){if(Jm.isClassLike(i.parent)){var s=W(i.parent);if(!s)break;if(R(Y(s),t))return z(e,Jm.Diagnostics.Cannot_find_name_0_Did_you_mean_the_static_member_1_0,Wr(r),q(s)),1;if(i===n&&!Jm.hasModifier(i,32))if(R(X(s).thisType,t))return z(e,Jm.Diagnostics.Cannot_find_name_0_Did_you_mean_the_instance_member_this_0,Wr(r)),1}i=i.parent}})(g,t,i)||qr(g)||((e,t,r)=>{if(1920===r){var r=rn(Kr(e,t,792640,void 0,void 0,!1)),n=e.parent;if(r){if(Jm.isQualifiedName(n)){Jm.Debug.assert(n.left===e,"Should only be resolving left side of qualified name as a namespace");var i=n.right.escapedText;if(R(X(r),i))return z(n,Jm.Diagnostics.Cannot_access_0_1_because_0_is_a_type_but_not_a_namespace_Did_you_mean_to_retrieve_the_type_of_the_property_1_in_0_with_0_1,Jm.unescapeLeadingUnderscores(t),Jm.unescapeLeadingUnderscores(i)),1}return z(e,Jm.Diagnostics._0_only_refers_to_a_type_but_is_being_used_as_a_namespace_here,Jm.unescapeLeadingUnderscores(t)),1}}})(g,t,r)||((e,t,r)=>{if(107455&r){if("any"===t||"string"===t||"number"===t||"boolean"===t||"never"===t)return z(e,Jm.Diagnostics._0_only_refers_to_a_type_but_is_being_used_as_a_value_here,Jm.unescapeLeadingUnderscores(t)),1;r=rn(Kr(e,t,792640,void 0,void 0,!1));if(r&&!(1024&r.flags))return z(e,Jm.Diagnostics._0_only_refers_to_a_type_but_is_being_used_as_a_value_here,Jm.unescapeLeadingUnderscores(t)),1}})(g,t,r)||((e,t,r)=>{if(107031&r){if(rn(Kr(e,t,1024,void 0,void 0,!1)))return z(e,Jm.Diagnostics.Cannot_use_namespace_0_as_a_value,Jm.unescapeLeadingUnderscores(t)),1}else if(792640&r)if(rn(Kr(e,t,1024,void 0,void 0,!1)))return z(e,Jm.Diagnostics.Cannot_use_namespace_0_as_a_type,Jm.unescapeLeadingUnderscores(t)),1})(g,t,r))||(p=void 0,o&&Kt<zt&&(p=Vu(m,t,r))&&z(g,o,Wr(i),p),p||z(g,n,Wr(i)),Kt++)}function Wr(e){return Jm.isString(e)?Jm.unescapeLeadingUnderscores(e):Jm.declarationNameToString(e)}function qr(e){var t=function e(t){switch(t.kind){case 71:case 179:return t.parent?e(t.parent):void 0;case 201:if(Jm.isEntityNameExpression(t.expression))return t.expression;default:return}}(e),r=!(!t||!cn(t,64,!0));return r&&z(e,Jm.Diagnostics.Cannot_extend_an_interface_0_Did_you_mean_implements,Jm.getTextOfNode(t)),r}function Jr(e,t,r){return t&&!!Jm.findAncestor(e,function(e){return e===r||Jm.isFunctionLike(e)?"quit":e===t})}function Yr(e){switch(e.kind){case 237:return e;case 239:return e.parent;case 240:return e.parent.parent;case 242:return e.parent.parent.parent;default:return}}function Xr(e){return Jm.find(e.declarations,Jm.isAliasSymbolDeclaration)}function Zr(e,t,r){var n,i,s=un(e,e.moduleSpecifier),e=mn(s,e.moduleSpecifier,r);if(e){var a,t=t.propertyName||t.name;if(t.escapedText)return Jm.isShorthandAmbientModuleSymbol(s)?s:(a=void 0,a=s&&s.exports&&s.exports.get("export=")?R(Y(e),t.escapedText):((e,t)=>{if(3&e.flags){e=e.valueDeclaration.type;if(e)return rn(R(re(e),t))}})(e,t.escapedText),a=rn(a,r),(r=(e=!(e=((e,t,r)=>{if(1536&e.flags)return rn(yn(e).get(t),r)})(e,t.escapedText,r))&&h&&"default"===t.escapedText?hn(s,r)||rn(s,r):e)&&a?(r=e,(n=a)===B&&r===B?B:794600&n.flags?n:((i=Mr(n.flags|r.flags,n.escapedName)).declarations=Jm.concatenate(n.declarations,r.declarations),i.parent=n.parent||r.parent,n.valueDeclaration&&(i.valueDeclaration=n.valueDeclaration),r.members&&(i.members=r.members),n.exports&&(i.exports=n.exports),i)):e||a)||z(t,Jm.Diagnostics.Module_0_has_no_exported_member_1,ln(s),Jm.declarationNameToString(t)),r)}}function Qr(e,t,r){return e.parent.parent.moduleSpecifier?Zr(e.parent.parent,e,r):cn(e.propertyName||e.name,t,!1,r)}function en(e,t){switch(e.kind){case 237:return n=t,248===(r=e).moduleReference.kind?hn(un(r,Jm.getExternalModuleImportEqualsDeclarationExpression(r))):on(r.moduleReference,n);case 239:var r=e,n=t,i=un(r,r.parent.moduleSpecifier);if(i){var s=void 0;if((s=Jm.isShorthandAmbientModuleSymbol(i)?i:(a=i.exports.get("export="))?R(Y(a),"default"):rn(i.exports.get("default"),n))||h){if(!s&&h)return hn(i,n)||rn(i,n)}else z(r.name,Jm.Diagnostics.Module_0_has_no_default_export,q(i));return s}return;case 240:return a=t,i=e.parent.parent.moduleSpecifier,mn(un(e,i),i,a);case 242:return Zr(e.parent.parent.parent,e,t);case 246:return Qr(e,901119,t);case 243:return cn(e.expression,901119,!1,t);case 236:return hn(e.parent.symbol,t)}var a,r,n}function tn(e,t){return void 0===t&&(t=901119),e&&2097152==(e.flags&(2097152|t))}function rn(e,t){return!t&&tn(e)?nn(e):e}function nn(e){Jm.Debug.assert(0!=(2097152&e.flags),"Should only get Alias here.");var t,r,n=d(e);return n.target?n.target===st&&(n.target=B):(n.target=st,t=Xr(e),Jm.Debug.assert(!!t),r=en(t),n.target===st?n.target=r||B:z(t,Jm.Diagnostics.Circular_definition_of_import_alias_0,q(e))),n.target}function sn(e){var e=W(e),t=nn(e);t&&(t===B||107455&t.flags&&!om(t))&&an(e)}function an(e){var t=d(e);t.referenced||(t.referenced=!0,t=Xr(e),Jm.Debug.assert(!!t),243===t.kind?tp(t.expression):246===t.kind?tp(t.propertyName||t.name):Jm.isInternalModuleImportEqualsDeclaration(t)&&tp(t.moduleReference))}function on(e,t){return 71===(e=71===e.kind&&Jm.isRightSideOfQualifiedNameOrPropertyAccess(e)?e.parent:e).kind||143===e.parent.kind?cn(e,1920,!1,t):(Jm.Debug.assert(237===e.parent.kind),cn(e,901119,!1,t))}function ln(e){return e.parent?ln(e.parent)+"."+q(e):q(e)}function cn(e,t,r,n,i){if(!Jm.nodeIsMissing(e)){if(71===e.kind){var s=1920===t?Jm.Diagnostics.Cannot_find_namespace_0:Jm.Diagnostics.Cannot_find_name_0;if(!(s=Kr(i||e,e.escapedText,t,r?void 0:s,e,!0)))return}else if(143===e.kind||179===e.kind){var a=void 0;if(143===e.kind)a=e.left;else{if(179!==e.kind||185!==e.expression.kind&&!Jm.isEntityNameExpression(e.expression))return;a=e.expression}var o=143===e.kind?e.right:e.name,a=cn(a,1920,r,!1,i);if(!a||Jm.nodeIsMissing(o))return;if(a===B)return a;if(!(s=Gr(yn(a),o.escapedText,t)))return void(r||z(o,Jm.Diagnostics.Namespace_0_has_no_exported_member_1,ln(a),Jm.declarationNameToString(o)))}else{if(185===e.kind)return Jm.isEntityNameExpression(e.expression)?cn(e.expression,t,r,n,i):void 0;Jm.Debug.assertNever(e,"Unknown entity name kind.")}return Jm.Debug.assert(0==(1&Jm.getCheckFlags(s)),"Should never get an instantiated symbol here."),s.flags&t||n?s:nn(s)}}function un(e,t){return dn(e,t,Jm.Diagnostics.Cannot_find_module_0)}function dn(e,t,r,n){if(void 0===n&&(n=!1),9===t.kind||13===t.kind)return pn(e,t.text,r,t,n)}function pn(e,t,r,n,i){if(void 0===i&&(i=!1),void 0!==t){Jm.startsWith(t,"@types/")&&z(n,Jm.Diagnostics.Cannot_import_type_declaration_files_Consider_importing_0_instead_of_1,Jm.removePrefix(t,"@types/"),t);var s=Ps(t,!0);if(s)return s;var s=Jm.getResolvedModule(Jm.getSourceFileOfNode(e),t),e=s&&Jm.getResolutionDiagnostic(M,s),a=s&&!e&&c.getSourceFile(s.resolvedFileName);if(a)return a.symbol?Tn(a.symbol):void(r&&z(n,Jm.Diagnostics.File_0_is_not_a_module,a.fileName));if(he){var a=Jm.findBestPatternMatch(he,function(e){return e.pattern},t);if(a)return Tn(a.symbol)}s&&!Jm.extensionIsTypeScript(s.extension)&&void 0===e||e===Jm.Diagnostics.Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type?i?z(n,Jm.Diagnostics.Invalid_module_name_in_augmentation_Module_0_resolves_to_an_untyped_module_at_1_which_cannot_be_augmented,t,s.resolvedFileName):_&&r&&(a=s.isExternalLibraryImport?Jm.chainDiagnosticMessages(void 0,Jm.Diagnostics.Try_npm_install_types_Slash_0_if_it_exists_or_add_a_new_declaration_d_ts_file_containing_declare_module_0,t):void 0,a=Jm.chainDiagnosticMessages(a,Jm.Diagnostics.Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type,t,s.resolvedFileName),sr.add(Jm.createDiagnosticForNodeFromMessageChain(n,a))):r&&(e?z(n,e,t,s.resolvedFileName):(i=Jm.tryExtractTypeScriptExtension(t))?z(n,Jm.Diagnostics.An_import_path_cannot_end_with_a_0_extension_Consider_importing_1_instead,i,Jm.removeExtension(t,i)):z(n,r,t))}}function hn(e,t){return e&&Tn(rn(e.exports.get("export="),t))||e}function mn(e,t,r){var n=hn(e,r);return r||!n||1539&n.flags||z(t,Jm.Diagnostics.Module_0_resolves_to_a_non_module_entity_and_cannot_be_imported_using_this_construct,q(e)),n}function gn(e){return void 0!==e.exports.get("export=")}function fn(e){return Rs(bn(e))}function _n(e,t){t=bn(t);if(t)return t.get(e)}function yn(e){return 1536&e.flags?bn(e):e.exports||m}function bn(e){var c,t=d(e);return t.resolvedExports||(t.resolvedExports=(c=[],function e(t){if(!(t&&1952&t.flags&&Jm.pushIfUnique(c,t)))return;var s=Jm.cloneMap(t.exports);t=t.exports.get("__export");if(t){for(var r=Jm.createSymbolTable(),a=Jm.createMap(),n=0,i=t.declarations;n<i.length;n++){var o=i[n],l=un(o,o.moduleSpecifier),l=e(l);vn(r,l,a,o)}a.forEach(function(e,t){e=e.exportsWithDuplicate;if("export="!==t&&e&&e.length&&!s.has(t))for(var r=0,n=e;r<n.length;r++){var i=n[r];sr.add(Jm.createDiagnosticForNode(i,Jm.Diagnostics.Module_0_has_already_exported_a_member_named_1_Consider_explicitly_re_exporting_to_resolve_the_ambiguity,a.get(t).specifierText,Jm.unescapeLeadingUnderscores(t)))}}),vn(s,r)}return s}(hn(e))||m))}function vn(n,e,i,s){e&&e.forEach(function(e,t){var r;"default"!==t&&((r=n.get(t))?i&&s&&r&&rn(r)!==rn(e)&&((r=i.get(t)).exportsWithDuplicate?r.exportsWithDuplicate.push(s):r.exportsWithDuplicate=[s]):(n.set(t,e),i&&s&&i.set(t,{specifierText:Jm.getTextOfNode(s.moduleSpecifier)})))})}function Tn(e){var t;return e&&e.mergeId&&(t=Wt[e.mergeId])?t:e}function W(e){return Tn(e.symbol)}function kn(e){return Tn(e.parent)}function xn(e){return e&&0!=(1048576&e.flags)?Tn(e.exportSymbol):e}function En(e){return 107455&e.flags||2097152&e.flags&&107455&nn(e).flags}function Sn(e){e=new t(Ze,e);return n++,e.id=n,e}function Cn(e,t){e=Sn(e);return e.intrinsicName=t,e}function wn(e,t){var r=Sn(32768);return r.objectFlags=e,r.symbol=t,r}function In(e){return 95===e.charCodeAt(0)&&95===e.charCodeAt(1)&&95!==e.charCodeAt(2)&&64!==e.charCodeAt(2)}function An(e){var r;return e.forEach(function(e,t){In(t)||(r=r||[],En(e)&&r.push(e))}),r||Jm.emptyArray}function Dn(e,t,r,n,i,s){return e.members=t,e.properties=An(t),e.callSignatures=r,e.constructSignatures=n,i&&(e.stringIndexInfo=i),s&&(e.numberIndexInfo=s),e}function Nn(e,t,r,n,i,s){return Dn(wn(16,e),t,r,n,i,s)}function On(e,t){for(var r,n=e;n;n=n.parent){if(n.locals&&!Hr(n)&&(r=t(n.locals)))return r;switch(n.kind){case 265:if(!Jm.isExternalOrCommonJsModule(n))break;case 233:if(r=t(W(n).exports))return r}}return t(Pt)}function Rn(e){return 107455===e?107455:1920}function Ln(r,n,i,s){var t;if(r&&!(e=>{if(e.declarations&&e.declarations.length){for(var t=0,r=e.declarations;t<r.length;t++)switch(r[t].kind){case 149:case 151:case 153:case 154:continue;default:return}return 1}})(r))return t=[],On(n,a);function a(e){if(Jm.pushIfUnique(t,e))return e=(e=>l(e.get(r.escapedName))?[r]:Jm.forEachEntry(e,function(e){var t;if(2097152&e.flags&&"export="!==e.escapedName&&!Jm.getDeclarationOfKind(e,246)&&!((t=e)&&t.declarations&&t.declarations[0]&&Jm.isNamespaceExportDeclaration(t.declarations[0])&&n&&Jm.isExternalModule(Jm.getSourceFileOfNode(n)))&&(!s||Jm.some(e.declarations,Jm.isExternalModuleImportEqualsDeclaration)))return l(e,t=nn(e))?[e]:(t=t.exports?a(t.exports):void 0)&&o(e,Rn(i))?[e].concat(t):void 0}))(e),t.pop(),e}function o(e,t){return!Pn(e,n,t)||!!Ln(e.parent,n,Rn(t),s)}function l(e,t){return r===(t||e)&&!Jm.some(e.declarations,Bn)&&o(e,i)}}function Pn(t,e,r){var n=!1;return On(e,function(e){e=e.get(t.escapedName);return!!e&&(e===t||!!((2097152&e.flags&&!Jm.getDeclarationOfKind(e,246)?nn(e):e).flags&r)&&(n=!0))}),n}function Mn(e,t){return 0===Fn(e,t,793064,!1).accessibility}function Fn(e,t,r,n){if(!e||!t||262144&e.flags)return{accessibility:0};for(var i=e,s=r;e;){var a=Ln(e,t,s,!1);if(a)return $n(a[0],n)||{accessibility:1,errorSymbolName:q(i,t,r),errorModuleName:e!==i?q(e,t,1920):void 0};s=Rn(r),e=kn(e)}var o=Jm.forEach(i.declarations,l);if(o&&o!==l(t))return{accessibility:2,errorSymbolName:q(i,t,r),errorModuleName:q(o)};return{accessibility:1,errorSymbolName:q(i,t,r)};function l(e){e=Jm.findAncestor(e,Bn);return e&&W(e)}}function Bn(e){return Jm.isAmbientModule(e)||265===e.kind&&Jm.isExternalOrCommonJsModule(e)}function $n(e,r){var n;if(!Jm.forEach(e.declarations,function(e){var t;return!(Xn(e)||(t=Yr(e))&&!Jm.hasModifier(t,1)&&Xn(t.parent)&&(r&&(b(e).isVisible=!0,n=Jm.appendIfUnique(n,t)),1))}))return{accessibility:0,aliasesToMakeVisible:n}}function Un(e,t){var r=162===e.parent.kind||Jm.isExpressionWithTypeArgumentsInClassExtendsClause(e.parent)?1156031:143===e.kind||179===e.kind||237===e.parent.kind?1920:793064,e=Ih(e),t=Kr(t,e.escapedText,r,void 0,void 0,!1);return t&&$n(t,!0)||{accessibility:1,errorSymbolName:Jm.getTextOfNode(e),errorNode:e}}function Vn(e,t){e.writeKeyword(Jm.tokenToString(t))}function I(e,t){e.writePunctuation(Jm.tokenToString(t))}function A(e){e.writeSpace(" ")}function q(t,r,n){return Jm.usingSingleLineStringWriter(function(e){Yn().buildSymbolDisplay(t,e,r,n)})}function Hn(t,r,n,i){return Jm.usingSingleLineStringWriter(function(e){Yn().buildSignatureDisplay(t,e,r,n,i)})}function J(e,t,r){var e=f.typeToTypeNode(e,t,(e=r,n=Jm.NodeBuilderFlags.None,e&&(8&e&&(n|=Jm.NodeBuilderFlags.NoTruncation),256&e&&(n|=Jm.NodeBuilderFlags.UseFullyQualifiedType),4096&e&&(n|=Jm.NodeBuilderFlags.SuppressAnyReturnType),1&e&&(n|=Jm.NodeBuilderFlags.WriteArrayAsGenericType),64&e)&&(n|=Jm.NodeBuilderFlags.WriteTypeArgumentsOfSignature),n|Jm.NodeBuilderFlags.IgnoreErrors|Jm.NodeBuilderFlags.WriteTypeParametersInQualifiedName)),n=(Jm.Debug.assert(void 0!==e,"should always get typenode"),Jm.createTextWriter("")),i=Jm.createPrinter({removeComments:!0}),t=t&&Jm.getSourceFileOfNode(t),i=(i.writeNode(4,e,t,n),n.getText()),e=M.noErrorTruncation||8&r?void 0:100;return e&&i.length>=e?i.substr(0,e-"...".length)+"...":i}function Gn(t,r,n){return Jm.usingSingleLineStringWriter(function(e){Yn().buildTypePredicateDisplay(t,e,r,n)})}function jn(e){for(var t=[],r=0,n=0;n<e.length;n++){var i=e[n];if(r|=i.flags,!(6144&i.flags)){if(384&i.flags){var s=128&i.flags?mt:Vi(i);if(65536&s.flags){var a=s.types.length;if(n+a<=e.length&&e[n+a-1]===s.types[a-1]){t.push(s),n+=a-1;continue}}}t.push(i)}}return 4096&r&&t.push(ct),2048&r&&t.push(ot),t||e}function Kn(e){return 8===e?"private":16===e?"protected":"public"}function zn(e){if(e.symbol&&2048&e.symbol.flags){e=Jm.findAncestor(e.symbol.declarations[0].parent,function(e){return 168!==e.kind});if(231===e.kind)return W(e)}}function Wn(e){return e&&e.parent&&234===e.parent.kind&&Jm.isExternalModuleAugmentation(e.parent.parent)}function qn(e){return 32&e.flags?'"'+Jm.escapeString(e.value)+'"':""+e.value}function Jn(e,t){if(e.declarations&&e.declarations.length){var r=e.declarations[0],n=Jm.getNameOfDeclaration(r);if(n)return Jm.declarationNameToString(n);if(r.parent&&226===r.parent.kind)return Jm.declarationNameToString(r.parent.name);switch(!t||t.encounteredError||t.flags&Jm.NodeBuilderFlags.AllowAnonymousIdentifier||(t.encounteredError=!0),r.kind){case 199:return"(Anonymous class)";case 186:case 187:return"(Anonymous function)"}}if(e.syntheticLiteralTypeOrigin){n=e.syntheticLiteralTypeOrigin.value;if(!Jm.isIdentifierText(n,M.target))return'"'+Jm.escapeString(n,34)+'"'}return Jm.symbolName(e)}function Yn(){function E(e,t){t.writeSymbol(Jn(e),e)}function S(e,s,l,t,c,r){var u;function d(e){var t,r,n,i;u?(1&c&&(1&Jm.getCheckFlags(e)?h(Ai(2097152&u.flags?nn(u):u),e.mapper,s,l):o(u,s,l)),r=s,n=Jn(t=e),i=n.charCodeAt(0),!Jm.isIdentifierStart(i,j)?(I(r,21),Jm.isSingleOrDoubleQuote(i)?r.writeStringLiteral(n):r.writeSymbol(n,t),I(r,22)):(I(r,23),r.writeSymbol(n,t))):E(e,s),u=e}s.trackSymbol(e,l,t),262144&e.flags||!l&&!(256&r)?d(e):function e(t,r,n){var i,s=Ln(t,l,r,!!(2&c));if(s&&!Pn(s[0],l,1===s.length?r:Rn(r))||(i=kn(s?s[0]:t))&&e(i,Rn(r),!1),s)for(var a=0,o=s;a<o.length;a++)d(o[a]);else!n&&(!u&&Jm.forEach(t.declarations,Bn)||6144&t.flags)||d(t)}(e,t,!0)}function a(e,f,_,y,b){var v=16416&y,T=!1;return k(e,y);function k(e,t){var r,n=-1025&t;if(16793231&e.flags)f.writeKeyword(32&y||!D(e)?e.intrinsicName:"any");else if(16384&e.flags&&e.isThisType)T&&f.reportInaccessibleThisError(),f.writeKeyword("this");else if(4&O(e)){var i=e,s=n,a=i.typeArguments||Jm.emptyArray;if(i.target!==fe||1&s)if(8&i.target.objectFlags)I(f,21),h(i.typeArguments.slice(0,sa(i)),26),I(f,22);else if(16384&s&&i.symbol.valueDeclaration&&199===i.symbol.valueDeclaration.kind)g(i,s);else{var o=i.target.outerTypeParameters,l=0;if(o)for(var c=o.length;l<c;){for(var u=l,d=ea(o[l]);++l<c&&ea(o[l])===d;);Jm.rangeEquals(o,a,u,l)||(m(d,a,u,l,s),I(f,23))}var p=(i.target.typeParameters||Jm.emptyArray).length;m(i.symbol,a,l,p,s)}else k(a[0],32896),I(f,21),I(f,22)}else 256&e.flags&&!(65536&e.flags)?(S(i=kn(e.symbol),f,_,793064,0,n),X(i)!==e&&(I(f,23),E(e.symbol,f))):3&O(e)||16656&e.flags?S(e.symbol,f,_,793064,0,n):1024&t||!e.aliasSymbol||!(65536&t||Mn(e.aliasSymbol,_))?196608&e.flags?(p=e,128&(r=n)&&I(f,19),65536&p.flags?h(jn(p.types),49):h(p.types,48),128&r&&I(f,20)):48&O(e)?g(e,n):96&e.flags?f.writeStringLiteral(qn(e)):262144&e.flags?(128&t&&I(f,19),f.writeKeyword("keyof"),A(f),k(e.type,128),128&t&&I(f,20)):524288&e.flags?(k(e.objectType,128),I(f,21),k(e.indexType,0),I(f,22)):(I(f,17),A(f),I(f,24),A(f),I(f,18)):(r=e.aliasTypeArguments,m(e.aliasSymbol,r,0,Jm.length(r),n))}function h(e,t){for(var r=0;r<e.length;r++)0<r&&(26!==t&&A(f),I(f,t),A(f)),k(e[r],26===t?0:128)}function m(e,t,r,n,i){if((32&e.flags||!In(e.escapedName))&&S(e,f,_,793064,0,i),r<n){for(I(f,27),k(t[r],512),r++;r<n;)I(f,26),A(f),k(t[r],0),r++;I(f,29)}}function g(e,r){var t,n=e.symbol;n?32&n.flags&&!vi(n)&&!(199===n.valueDeclaration.kind&&16384&r)||896&n.flags||(()=>{var e=!!(8192&n.flags)&&Jm.some(n.declarations,function(e){return Jm.hasModifier(e,32)}),t=!!(16&n.flags)&&(n.parent||Jm.some(n.declarations,function(e){return 265===e.parent.kind||234===e.parent.kind}));return(e||t)&&(4&r||Jm.contains(b,n))})()?i(e,r):Jm.contains(b,n)?(t=zn(e))?S(t,f,_,793064,0,r):Vn(f,119):(b=b||[],16&e.objectFlags&&e.symbol&&32&e.symbol.flags?s(e,r):(b.push(n),s(e,r),b.pop())):s(e,r)}function i(e,t){32768&t&&I(f,19),Vn(f,103),A(f),S(e.symbol,f,_,107455,0,t),32768&t&&I(f,20)}function x(e){Bd(e)&&(Vn(f,131),A(f)),S(e,f),16777216&e.flags&&I(f,55)}function s(e,t){if(ms(e))r=e,I(f,17),f.writeLine(),f.increaseIndent(),r.declaration.readonlyToken&&(Vn(f,131),A(f)),I(f,21),E(ds(r).symbol,f),A(f),Vn(f,92),A(f),k(ps(r),0),I(f,22),r.declaration.questionToken&&I(f,55),I(f,56),A(f),k(hs(r),0),I(f,25),f.writeLine(),f.decreaseIndent(),I(f,18);else{var r=gs(e);if(!r.properties.length&&!r.stringIndexInfo&&!r.numberIndexInfo){if(!r.callSignatures.length&&!r.constructSignatures.length)return I(f,17),void I(f,18);if(1===r.callSignatures.length&&!r.constructSignatures.length)return e=r.callSignatures[0],(e=!!(128&(n=t))||!!(512&n)&&(n=(e.target&&64&n?e.target:e).typeParameters)&&0!==n.length)&&I(f,19),C(r.callSignatures[0],f,_,16|v,void 0,b),void(e&&I(f,20));if(1===r.constructSignatures.length&&!r.callSignatures.length)return 128&t&&I(f,19),Vn(f,94),A(f),C(r.constructSignatures[0],f,_,16|v,void 0,b),void(128&t&&I(f,20))}for(var n=T,e=(T=!0,I(f,17),f.writeLine(),f.increaseIndent(),r),i=0,s=e.callSignatures;i<s.length;i++)C(g=s[i],f,_,v,void 0,b),I(f,25),f.writeLine();for(var a=0,o=e.constructSignatures;a<o.length;a++)C(g=o[a],f,_,v,1,b),I(f,25),f.writeLine();w(e.stringIndexInfo,f,0,_,y,b),w(e.numberIndexInfo,f,1,_,y,b);for(var l=0,c=e.properties;l<c.length;l++){var u=c[l];if(16384&y){if(4194304&u.flags)continue;24&Jm.getDeclarationModifierFlagsFromSymbol(u)&&f.reportPrivateInBaseOfClassExpression(Jm.symbolName(u))}var d=Y(u);if(8208&u.flags&&!fs(d).length)for(var p=ee(d,0),h=0,m=p;h<m.length;h++){var g=m[h];x(u),C(g,f,_,v,void 0,b),I(f,25),f.writeLine()}else x(u),I(f,56),A(f),k(d,16384&y),I(f,25),f.writeLine()}f.decreaseIndent(),I(f,18),T=n}}}function o(e,t,r,n){var i=Th(e);(32&i.flags||64&i.flags||524288&i.flags)&&d(Ii(e),t,r,n)}function s(e,t,r,n,i){E(e.symbol,t);var s=ys(e),s=(s&&(A(t),Vn(t,85),A(t),a(s,t,r,n,i)),Es(e));s&&(A(t),I(t,58),A(t),a(s,t,r,n,i))}function l(e,t,r,n,i){var s=e.valueDeclaration,e=((s?Jm.isRestParameter(s):Fr(e)&&e.isRestParameter)&&I(t,24),s&&Jm.isBindingPattern(s.name)?c(s.name,t,r,n,i):E(e,t),s&&Ms(s)&&I(t,55),I(t,56),A(t),Y(e));a(e=s&&cm(s)?yl(e,2048):e,t,r,n,i)}function c(e,t,r,n,i){174===e.kind?(I(t,17),p(e.elements,t,function(e){u(e,t,r,n,i)}),I(t,18)):175===e.kind&&(I(t,21),p(e=e.elements,t,function(e){u(e,t,r,n,i)}),e&&e.hasTrailingComma&&I(t,26),I(t,22))}function u(e,t,r,n,i){Jm.isOmittedExpression(e)||(Jm.Debug.assert(176===e.kind),e.propertyName&&(t.writeProperty(Jm.getTextOfNode(e.propertyName)),I(t,56),A(t)),Jm.isBindingPattern(e.name)?c(e.name,t,r,n,i):(e.dotDotDotToken&&I(t,24),E(e.symbol,t)))}function d(e,t,r,n,i){e&&e.length&&(I(t,27),p(e,t,function(e){s(e,t,r,n,i)}),I(t,29))}function p(e,t,r){for(var n=0;n<e.length;n++)0<n&&(I(t,26),A(t)),r(e[n])}function h(e,t,r,n){if(e&&e.length){I(r,27);for(var i=512,s=0;s<e.length;s++)0<s&&(I(r,26),A(r),i=0),a(t(e[s]),r,n,i);I(r,29)}}function m(e,t,r,n,i,s){I(r,19),e&&l(e,r,n,i,s);for(var a=0;a<t.length;a++)(0<a||e)&&(I(r,26),A(r)),l(t[a],r,n,i,s);I(r,20)}function g(e,t,r,n,i){Jm.isIdentifierTypePredicate(e)?t.writeParameter(e.parameterName):Vn(t,99),A(t),Vn(t,126),A(t),a(e.type,t,r,n,i)}function f(e,t,r,n,i){var s=te(e);4096&n&&D(s)||(16&n?(A(t),I(t,36)):I(t,56),A(t),e.typePredicate?g(e.typePredicate,t,r,n,i):a(s,t,r,n,i))}function C(e,t,r,n,i,s){1===i&&(Vn(t,94),A(t)),e.target&&64&n?h(e.target.typeParameters,e.mapper,t,r):d(e.typeParameters,t,r,n,s),m(e.thisParameter,e.parameters,t,r,n,s),f(e,t,r,n,s)}function w(e,t,r,n,i,s){if(e){switch(e.isReadonly&&(Vn(t,131),A(t)),I(t,21),t.writeParameter(e.declaration?Jm.declarationNameToString(e.declaration.parameters[0].name):"x"),I(t,56),A(t),r){case 1:Vn(t,133);break;case 0:Vn(t,136)}I(t,22),I(t,56),A(t),a(e.type,t,n,i,s),I(t,25),t.writeLine()}}return qe=qe||{buildSymbolDisplay:S,buildTypeDisplay:a,buildTypeParameterDisplay:s,buildTypePredicateDisplay:g,buildParameterDisplay:l,buildDisplayForParametersAndDelimiters:m,buildDisplayForTypeParametersAndDelimiters:d,buildTypeParameterDisplayFromSymbol:o,buildSignatureDisplay:C,buildIndexSignatureDisplay:w,buildReturnTypeDisplay:f}}function Xn(t){var e;return!!t&&(void 0===(e=b(t)).isVisible&&(e.isVisible=!!(()=>{switch(t.kind){case 176:return Xn(t.parent.parent);case 226:if(Jm.isBindingPattern(t.name)&&!t.name.elements.length)return;case 233:case 229:case 230:case 231:case 228:case 232:case 237:var e;return Jm.isExternalModuleAugmentation(t)?1:(e=ri(t),(1&Jm.getCombinedModifierFlags(t)||237!==t.kind&&265!==e.kind&&Jm.isInAmbientContext(e)?Xn:Hr)(e));case 149:case 148:case 153:case 154:case 151:case 150:if(Jm.hasModifier(t,24))return;case 152:case 156:case 155:case 157:case 146:case 234:case 160:case 161:case 163:case 159:case 164:case 165:case 166:case 167:case 168:return Xn(t.parent);case 239:case 240:case 242:return;case 145:case 265:case 236:return 1;default:return}})()),e.isVisible)}function Zn(e){e.parent&&243===e.parent.kind?t=Kr(e.parent,e.escapedText,2998271,Jm.Diagnostics.Cannot_find_name_0,e,!1):246===e.parent.kind&&(t=Qr(e.parent,2998271));var t,n=[];return t&&function r(e){Jm.forEach(e,function(e){b(e).isVisible=!0;var t=Yr(e)||e;Jm.pushIfUnique(n,t),Jm.isInternalModuleImportEqualsDeclaration(e)&&(t=e.moduleReference,t=Ih(t),e=Kr(e,t.escapedText,901119,void 0,void 0,!1))&&r(e.declarations)})}(t.declarations),n}function Qn(e,t){var r=ei(e,t);if(!(0<=r))return Ht.push(e),Gt.push(!0),jt.push(t),1;for(var n=Ht.length,i=r;i<n;i++)Gt[i]=!1}function ei(e,t){for(var r=Ht.length-1;0<=r;r--){if(((e,t)=>0===t?d(e).type:2===t?d(e).declaredType:1===t?e.resolvedBaseConstructorType:3===t?e.resolvedReturnType:void Jm.Debug.fail("Unhandled TypeSystemPropertyName "+t))(Ht[r],jt[r]))return-1;if(Ht[r]===e&&jt[r]===t)return r}return-1}function ti(){return Ht.pop(),jt.pop(),Gt.pop()}function ri(e){return(e=Jm.findAncestor(Jm.getRootDeclaration(e),function(e){switch(e.kind){case 226:case 227:case 242:case 241:case 240:case 239:return!1;default:return!0}}))&&e.parent}function ni(e,t){e=R(e,t);return e?Y(e):void 0}function D(e){return e&&0!=(1&e.flags)}function ii(e){var t=W(e);return t&&d(t).type||di(e,!1)}function si(e){return 144===e.kind&&!Jm.isStringOrNumericLiteral(e.expression)}function ai(e,t,r){if(8192&(e=pc(e,function(e){return!(6144&e.flags)})).flags)return N;if(65536&e.flags)return hc(e,function(e){return ai(e,t,r)});for(var n=Jm.createSymbolTable(),i=Jm.createUnderscoreEscapedMap(),s=0,a=t;s<a.length;s++){var o=a[s];i.set(Jm.getTextOfPropertyName(o),!0)}for(var l=0,c=Z(e);l<c.length;l++){var u=c[l],d=i.has(u.escapedName),p=24&Jm.getDeclarationModifierFlagsFromSymbol(u),h=65536&u.flags&&!(32768&u.flags);d||p||lo(u)||h||n.set(u.escapedName,u)}var m=L(e,0),e=L(e,1);return Nn(r,n,Jm.emptyArray,Jm.emptyArray,m,e)}function oi(e){var t=e.parent,r=ii(t.parent);if(r===K)return K;if(!r)return e.initializer?np(e):r;if(D(r))return r;if(174===t.kind)if(e.dotDotDotToken){if(!mu(r))return z(e,Jm.Diagnostics.Rest_types_may_only_be_created_from_object_types),K;for(var n=[],i=0,s=t.elements;i<s.length;i++){var a=s[i];a.dotDotDotToken||n.push(a.propertyName||a.name)}l=ai(r,n,e.symbol)}else{var o=e.propertyName||e.name;if(si(o))return C;var l,c=Jm.getTextOfPropertyName(o),u=ni(r,c);if(!(l=u&&wc(e,u)||uu(c)&&Ns(r,1)||Ns(r,0)))return z(o,Jm.Diagnostics.Type_0_has_no_property_1_and_no_string_index_signature,J(r),Jm.declarationNameToString(o)),K}else{u=oh(r,t,!1,!1);if(e.dotDotDotToken)l=Pa(u);else{c=""+Jm.indexOf(t.elements,e);if(!(l=ll(r)?ni(r,c):u))return hl(r)?z(e,Jm.Diagnostics.Tuple_type_0_with_length_1_cannot_be_assigned_to_tuple_with_length_2,J(r),sa(r),t.elements.length):z(e,Jm.Diagnostics.Type_0_has_no_property_1,J(r),c),K}}return!F||!e.initializer||2048&gl(tp(e.initializer))||(l=Xl(l,131072)),e.initializer?P([l,tp(e.initializer)],!0):l}function li(e){e=Jm.getJSDocType(e);if(e)return re(e)}function ci(e){e=Jm.skipParentheses(e);return 177===e.kind&&0===e.elements.length}function ui(e,t){return F&&t?yl(e,2048):e}function di(e,t){if(215===e.parent.parent.kind)return 278528&(r=qa(Pu(e.parent.parent.expression))).flags?r:$;if(216===e.parent.parent.kind)return ah((r=e.parent.parent).expression,r.awaitModifier)||C;if(Jm.isBindingPattern(e.parent))return oi(e);var r=Jm.getEffectiveTypeAnnotationNode(e);if(r)return ui(re(r),e.questionToken&&t);if((_||Jm.isInJavaScriptFile(e))&&226===e.kind&&!Jm.isBindingPattern(e.name)&&!(1&Jm.getCombinedModifierFlags(e))&&!Jm.isInAmbientContext(e)){if(!(2&Jm.getCombinedNodeFlags(e)||e.initializer&&(r=e.initializer,95!==(r=Jm.skipParentheses(r)).kind)&&(71!==r.kind||Vl(r)!==Ye)))return at;if(e.initializer&&ci(e.initializer))return Ee}if(146===e.kind){var n=e.parent;if(154===n.kind&&!Jm.hasDynamicName(n)){var i=Jm.getDeclarationOfKind(e.parent.symbol,153);if(i)return i=Us(i),(s=Um(n))&&e===s?(Jm.Debug.assert(!s.type),Y(i.thisParameter)):te(i)}var s=void 0;if(s="this"===e.symbol.escapedName?jc(n):Kc(e))return ui(s,e.questionToken&&t)}return e.initializer?ui(s=np(e),e.questionToken&&t):Jm.isJsxAttribute(e)?pt:262===e.kind?Lc(e.name):Jm.isBindingPattern(e.name)?hi(e.name,!1,!0):void 0}function pi(e,t,r){return e.initializer?np(e):Jm.isBindingPattern(e.name)?hi(e.name,t,r):(r&&_&&!gi(e)&&Cl(e,C),C)}function hi(e,t,r){return 174===e.kind?(s=e,a=t,o=r,c=Jm.createSymbolTable(),u=!1,Jm.forEach(s.elements,function(e){var t=e.propertyName||e.name;si(t)?u=!0:e.dotDotDotToken?l=Xs(C,!1):(t=Jm.getTextOfPropertyName(t),(t=Mr(4|(e.initializer?16777216:0),t)).type=pi(e,a,o),t.bindingElement=e,c.set(t.escapedName,t))}),d=Nn(void 0,c,Jm.emptyArray,Jm.emptyArray,l,void 0),a&&(d.pattern=s),u&&(d.objectFlags|=512),d):(n=t,i=r,d=(s=e).elements,t=Jm.lastOrUndefined(d),0===d.length||!Jm.isOmittedExpression(t)&&t.dotDotDotToken?2<=j?Ra(C):xe:(t=Fa(Jm.map(d,function(e){return Jm.isOmittedExpression(e)?C:pi(e,n,i)})),n&&((t=ia(t)).pattern=s),t));var n,i,s,a,o,l,c,u,d}function mi(e,t){var r=di(e,!0);return r?(t&&wl(e,r),261===e.kind?r:Sl(r)):(r=e.dotDotDotToken?xe:C,t&&_&&(gi(e)||Cl(e,r)),r)}function gi(e){e=Jm.getRootDeclaration(e);return Tp(146===e.kind?e.parent:e)}function fi(e){var t=d(e);if(!t.type){if(4194304&e.flags)return t.type=(r=X(kn(r=e))).typeParameters?na(r,Jm.map(r.typeParameters,function(e){return C})):r;var r=e.valueDeclaration;if(Jm.isCatchClauseVariableDeclarationOrBindingElement(r))return t.type=C;if(243===r.kind)return t.type=V(r.expression);if(Jm.isInJavaScriptFile(r)&&Jm.isJSDocPropertyLikeTag(r)&&r.typeExpression)return t.type=re(r.typeExpression.type);if(!Qn(e,0))return K;var n=void 0,n=194===r.kind||179===r.kind&&194===r.parent.kind?(e=>{for(var t,r=[],n=!1,i=!1,s=0,a=e.declarations;s<a.length;s++){var o=a[s],l=194===o.kind?o:179===o.kind?Jm.getAncestor(o,194):void 0;if(!l)return K;Jm.isPropertyAccessExpression(l.left)&&99===l.left.expression.kind&&(152===Jm.getThisContainer(l,!1).kind?n=!0:i=!0);var c=li(l.parent);c?(c=Sl(c),t?t===K||c===K||Do(t,c)||z(o=Jm.getNameOfDeclaration(o),Jm.Diagnostics.Subsequent_variable_declarations_must_have_the_same_type_Variable_0_must_be_of_type_1_but_here_has_type_2,Jm.declarationNameToString(o),J(t),J(c)):t=c):t||r.push(pl(tp(l.right)))}return Sl(ui(t||P(r,!0),i&&!n))})(e):mi(r,!0);ti()||(n=Ti(e)),t.type=n}return t.type}function _i(e){var t;if(e)return 153===e.kind?(t=Jm.getEffectiveReturnTypeNode(e))&&re(t):(t=Jm.getEffectiveSetAccessorTypeAnnotationNode(e))&&re(t)}function yi(e){return Hs(Us(e))}function bi(e){var t=d(e);if(!t.type){var r=Jm.getDeclarationOfKind(e,153),n=Jm.getDeclarationOfKind(e,154);if(r&&Jm.isInJavaScriptFile(r)){var i=li(r);if(i)return t.type=i}if(!Qn(e,0))return K;var i=void 0,s=_i(r);i=s||_i(n)||(r&&r.body?Nd(r):(_&&(n?z(n,Jm.Diagnostics.Property_0_implicitly_has_type_any_because_its_set_accessor_lacks_a_parameter_type_annotation,q(e)):(Jm.Debug.assert(!!r,"there must existed getter as we are current checking either setter or getter in this function"),z(r,Jm.Diagnostics.Property_0_implicitly_has_type_any_because_its_get_accessor_lacks_a_return_type_annotation,q(e)))),C)),ti()||(i=C,_&&z(Jm.getDeclarationOfKind(e,153),Jm.Diagnostics._0_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_referenced_directly_or_indirectly_in_one_of_its_return_expressions,q(e))),t.type=i}return t.type}function vi(e){e=Pi(Bi(e));return 540672&e.flags?e:void 0}function Ti(e){return Jm.getEffectiveTypeAnnotationNode(e.valueDeclaration)?(z(e.valueDeclaration,Jm.Diagnostics._0_is_referenced_directly_or_indirectly_in_its_own_type_annotation,q(e)),K):(_&&z(e.valueDeclaration,Jm.Diagnostics._0_implicitly_has_type_any_because_it_does_not_have_a_type_annotation_and_is_referenced_directly_or_indirectly_in_its_own_initializer,q(e)),C)}function Y(e){if(1&Jm.getCheckFlags(e)){var t=e,r=d(t);if(!r.type)if(100===a)z(t.valueDeclaration,Jm.Diagnostics.Generic_type_instantiation_is_excessively_deep_and_possibly_infinite),r.type=K;else{if(!Qn(t,0))return K;a++;var n=U(Y(r.target),r.mapper);a--,ti()||(n=Ti(t)),r.type=n}return r.type}var i,s;return 7&e.flags?fi(e):9136&e.flags?((n=d(t=e)).type||(1536&t.flags&&Jm.isShorthandAmbientModuleSymbol(t)?n.type=C:(r=wn(16,t),32&t.flags?(i=vi(t),n.type=i?za([r,i]):r):n.type=F&&16777216&t.flags?yl(r,2048):r)),n.type):8&e.flags?((s=d(i=e)).type||(s.type=Gi(i)),s.type):98304&e.flags?bi(e):2097152&e.flags?((e=d(s=e)).type||(s=nn(s),e.type=107455&s.flags?Y(s):K),e.type):K}function ki(e,t){return void 0!==e&&void 0!==t&&0!=(4&O(e))&&e.target===t}function xi(e){return 4&O(e)?e.target:e}function Ei(e,n){return function e(t){{var r;return 7&O(t)?(r=xi(t))===n||Jm.forEach(Mi(r),e):131072&t.flags?Jm.forEach(t.types,e):void 0}}(e)}function Si(e,t){for(var r=0,n=t;r<n.length;r++){var i=ji(W(n[r]));e=Jm.appendIfUnique(e,i)}return e}function Ci(e,t){for(;;){if(!(e=e.parent))return;switch(e.kind){case 229:case 199:case 230:case 155:case 156:case 150:case 160:case 161:case 273:case 228:case 151:case 186:case 187:case 231:case 282:case 172:var r,n=Ci(e,t);return 172===e.kind?Jm.append(n,ji(W(e.typeParameter))):(n=Si(n,Jm.getEffectiveTypeParameterDeclarations(e)||Jm.emptyArray),(r=t&&(229===e.kind||199===e.kind||230===e.kind)&&Bi(W(e)).thisType)?Jm.append(n,r):n)}}}function wi(e){return Ci(32&e.flags?e.valueDeclaration:Jm.getDeclarationOfKind(e,230))}function Ii(e){for(var t,r=0,n=e.declarations;r<n.length;r++){var i=n[r];230!==i.kind&&229!==i.kind&&199!==i.kind&&231!==i.kind||i.typeParameters&&(t=Si(t,i.typeParameters))}return t}function Ai(e){return Jm.concatenate(wi(e),Ii(e))}function Di(e){var e=ee(e,1);return 1===e.length&&!(e=e[0]).typeParameters&&1===e.parameters.length&&e.hasRestParameter&&Sd(e.parameters[0])===xe}function Ni(e){return Fi(e)&&0<ee(e,1).length||(540672&e.flags?(e=vs(e))&&Fi(e)&&Di(e):void 0)}function Oi(e){e=e.symbol.valueDeclaration;if(Jm.isInJavaScriptFile(e)){var t=Jm.getJSDocAugmentsTag(e);if(t)return t.class}return Jm.getClassExtendsHeritageClauseElement(e)}function Ri(e,t,r){var n=Jm.length(t),i=Jm.isInJavaScriptFile(r);return Jm.filter(ee(e,1),function(e){return(i||n>=Bs(e.typeParameters))&&n<=Jm.length(e.typeParameters)})}function Li(e,t,r){var e=Ri(e,t,r),n=Jm.map(t,re);return Jm.sameMap(e,function(e){return Jm.some(e.typeParameters)?js(e,n,Jm.isInJavaScriptFile(r)):e})}function Pi(e){if(!e.resolvedBaseConstructorType){var t=e.symbol.valueDeclaration,t=Jm.getClassExtendsHeritageClauseElement(t),r=Oi(e);if(!r)return e.resolvedBaseConstructorType=ot;if(!Qn(e,1))return K;var n=V(r.expression);if(t&&r!==t&&(Jm.Debug.assert(!t.typeArguments),V(t.expression)),163840&n.flags&&gs(n),!ti())return z(e.symbol.valueDeclaration,Jm.Diagnostics._0_is_referenced_directly_or_indirectly_in_its_own_base_expression,q(e.symbol)),e.resolvedBaseConstructorType=K;if(!(1&n.flags||n===ut||Ni(n)))return z(r.expression,Jm.Diagnostics.Type_0_is_not_a_constructor_function_type,J(n)),e.resolvedBaseConstructorType=K;e.resolvedBaseConstructorType=n}return e.resolvedBaseConstructorType}function Mi(e){if(!e.resolvedBaseTypes)if(8&e.objectFlags)e.resolvedBaseTypes=[Pa(P(e.typeParameters))];else if(96&e.symbol.flags){if(32&e.symbol.flags&&(e=>{e.resolvedBaseTypes=Jm.emptyArray;var t=Q(Pi(e));if(163841&t.flags){var r,n=Oi(e),i=ha(n),s=t&&t.symbol?X(t.symbol):void 0;if(t.symbol&&32&t.symbol.flags&&(e=>{var t,r=e.outerTypeParameters;return!r||(t=r.length-1,e=e.typeArguments,r[t].symbol!==e[t].symbol)})(s))r=aa(n,t.symbol,i);else if(1&t.flags)r=t;else{s=Li(t,n.typeArguments,n);if(!s.length)return z(n.expression,Jm.Diagnostics.No_base_constructor_has_the_specified_number_of_type_arguments);r=te(s[0])}r!==K&&(Fi(r)?e===r||Ei(r,e)?z(e.symbol.valueDeclaration,Jm.Diagnostics.Type_0_recursively_references_itself_as_a_base_type,J(e,void 0,1)):e.resolvedBaseTypes=[r]:z(n.expression,Jm.Diagnostics.Base_constructor_return_type_0_is_not_a_class_or_interface_type,J(r)))}})(e),64&e.symbol.flags){var t=e;t.resolvedBaseTypes=t.resolvedBaseTypes||Jm.emptyArray;for(var r=0,n=t.symbol.declarations;r<n.length;r++){var i=n[r];if(230===i.kind&&Jm.getInterfaceBaseTypeNodes(i))for(var s=0,a=Jm.getInterfaceBaseTypeNodes(i);s<a.length;s++){var o=a[s],l=re(o);l!==K&&(Fi(l)?t===l||Ei(l,t)?z(i,Jm.Diagnostics.Type_0_recursively_references_itself_as_a_base_type,J(t,void 0,1)):t.resolvedBaseTypes===Jm.emptyArray?t.resolvedBaseTypes=[l]:t.resolvedBaseTypes.push(l):z(o,Jm.Diagnostics.An_interface_may_only_extend_a_class_or_another_interface))}}}}else Jm.Debug.fail("type must be class or interface");return e.resolvedBaseTypes}function Fi(e){return 16809985&e.flags&&!ms(e)||131072&e.flags&&!Jm.forEach(e.types,function(e){return!Fi(e)})}function Bi(e){var t,r,n,i,s=d(e);return!s.declaredType&&(t=32&e.flags?1:2,r=s.declaredType=wn(t,e),n=wi(e),i=Ii(e),n||i||1==t||!(e=>{for(var t=0,r=e.declarations;t<r.length;t++){var n=r[t];if(230===n.kind){if(64&n.flags)return;n=Jm.getInterfaceBaseTypeNodes(n);if(n)for(var i=0,s=n;i<s.length;i++){var a=s[i];if(Jm.isEntityNameExpression(a.expression)){a=cn(a.expression,793064,!0);if(!a||!(64&a.flags)||Bi(a).thisType)return}}}}return 1})(e))&&(r.objectFlags|=4,r.typeParameters=Jm.concatenate(n,i),r.outerTypeParameters=n,r.localTypeParameters=i,r.instantiations=Jm.createMap(),r.instantiations.set(ta(r.typeParameters),r),(r.target=r).typeArguments=r.typeParameters,r.thisType=Sn(16384),r.thisType.isThisType=!0,r.thisType.symbol=e,r.thisType.constraint=r),s.declaredType}function $i(e){var t=e.initializer;if(!t)return!Jm.isInAmbientContext(e);switch(t.kind){case 9:case 8:return 1;case 192:return 38===t.operator&&8===t.operand.kind;case 71:return Jm.nodeIsMissing(t)||W(e.parent).exports.get(t.escapedText);default:return}}function Ui(e){var t=d(e);if(void 0!==t.enumKind)return t.enumKind;for(var r=!1,n=0,i=e.declarations;n<i.length;n++){var s=i[n];if(232===s.kind)for(var a=0,o=s.members;a<o.length;a++){var l=o[a];if(l.initializer&&9===l.initializer.kind)return t.enumKind=1;$i(l)||(r=!0)}}return t.enumKind=r?0:1}function Vi(e){return 256&e.flags&&!(65536&e.flags)?X(kn(e.symbol)):e}function Hi(e){var t=d(e);if(t.declaredType)return t.declaredType;if(1===Ui(e)){p++;for(var r=[],n=0,i=e.declarations;n<i.length;n++){var s=i[n];if(232===s.kind)for(var a=0,o=s.members;a<o.length;a++){var l=o[a],c=ho(pm(l),p,W(l));d(W(l)).declaredType=c,r.push(c)}}if(r.length)return 65536&(u=P(r,!1,e,void 0)).flags&&(u.flags|=256,u.symbol=e),t.declaredType=u}var u=Sn(16);return u.symbol=e,t.declaredType=u}function Gi(e){var t=d(e);return t.declaredType||(e=Hi(kn(e)),t.declaredType)||(t.declaredType=e),t.declaredType}function ji(e){var t,r=d(e);return r.declaredType||((t=Sn(16384)).symbol=e,r.declaredType=t),r.declaredType}function X(e){return Ki(e)||K}function Ki(e){if(96&e.flags)return Bi(e);if(524288&e.flags){var t=e,r=d(t);if(!r.declaredType){if(!Qn(t,2))return K;var n=Jm.find(t.declarations,function(e){return 283===e.kind||231===e.kind}),i=283===n.kind?n.typeExpression:n.type,i=i?re(i):K;ti()?(s=Ii(t))&&(r.typeParameters=s,r.instantiations=Jm.createMap(),r.instantiations.set(ta(s),i)):(i=K,z(n.name,Jm.Diagnostics.Type_alias_0_circularly_references_itself,q(t))),r.declaredType=i}return r.declaredType}return 262144&e.flags?ji(e):384&e.flags?Hi(e):8&e.flags?Gi(e):2097152&e.flags?((n=d(s=e)).declaredType||(n.declaredType=X(nn(s))),n.declaredType):void 0;var s}function zi(e){switch(e.kind){case 119:case 136:case 133:case 122:case 137:case 134:case 105:case 139:case 95:case 130:case 173:return!0;case 164:return zi(e.elementType);case 159:var t=e;if(t.typeArguments)for(var r=0,n=t.typeArguments;r<n.length;r++)if(!zi(n[r]))return!1;return!0}return!1}function Wi(e){var t=Jm.getEffectiveTypeAnnotationNode(e);return t?zi(t):!e.initializer}function qi(e){if(e.declarations&&1===e.declarations.length){var t=e.declarations[0];if(t)switch(t.kind){case 149:case 148:return Wi(t);case 151:case 150:case 152:var r=t;if(152!==r.kind){var n=Jm.getEffectiveReturnTypeNode(r);if(!n||!zi(n))return}for(var i=0,s=r.parameters;i<s.length;i++)if(!Wi(s[i]))return;return 1}}}function Ji(e,t,r){for(var n=Jm.createSymbolTable(),i=0,s=e;i<s.length;i++){var a=s[i];n.set(a.escapedName,r&&qi(a)?a:ko(a,t))}return n}function Yi(e,t){for(var r=0,n=t;r<n.length;r++){var i=n[r];e.has(i.escapedName)||e.set(i.escapedName,i)}}function Xi(e){var t;return e.declaredProperties||(t=e.symbol,e.declaredProperties=An(t.members),e.declaredCallSignatures=Vs(t.members.get("__call")),e.declaredConstructSignatures=Vs(t.members.get("__new")),e.declaredStringIndexInfo=Zs(t,0),e.declaredNumberIndexInfo=Zs(t,1)),e}function Zi(e,t){if(4&O(e)){var r=e.target,n=e.typeArguments;if(Jm.length(r.typeParameters)===Jm.length(n))return na(r,Jm.concatenate(n,[t||r.thisType]))}else if(131072&e.flags)return za(Jm.map(e.types,function(e){return Zi(e,t)}));return e}function Qi(e,t,r,n){var i,s,a,o,l,c=Jm.rangeEquals(r,n,0,r.length)?(i=T,s=t.symbol?t.symbol.members:Jm.createSymbolTable(t.declaredProperties),a=t.declaredCallSignatures,o=t.declaredConstructSignatures,l=t.declaredStringIndexInfo,t.declaredNumberIndexInfo):(i=yo(r,n),s=Ji(t.declaredProperties,i,1===r.length),a=_o(t.declaredCallSignatures,i),o=_o(t.declaredConstructSignatures,i),l=So(t.declaredStringIndexInfo,i),So(t.declaredNumberIndexInfo,i)),r=Mi(t);if(r.length){t.symbol&&s===t.symbol.members&&(s=Jm.createSymbolTable(t.declaredProperties));for(var u=Jm.lastOrUndefined(n),d=0,p=r;d<p.length;d++){var h=p[d],h=u?Zi(U(h,i),u):h;Yi(s,Z(h)),a=Jm.concatenate(a,ee(h,0)),o=Jm.concatenate(o,ee(h,1)),l=l||(h===C?Xs(C,!1):L(h,0)),c=c||L(h,1)}}Dn(e,s,a,o,l,c)}function es(e,t,r,n,i,s,a,o,l){var c=new u(Ze);return c.declaration=e,c.typeParameters=t,c.parameters=n,c.thisParameter=r,c.resolvedReturnType=i,c.typePredicate=s,c.minArgumentCount=a,c.hasRestParameter=o,c.hasLiteralTypes=l,c}function ts(e){return es(e.declaration,e.typeParameters,e.thisParameter,e.parameters,e.resolvedReturnType,e.typePredicate,e.minArgumentCount,e.hasRestParameter,e.hasLiteralTypes)}function rs(e,t,r,n,i){for(var s=0,a=e;s<a.length;s++){var o=a[s];if(nl(o,t,r,n,i,No))return o}}function ns(e,t){for(var r=Jm.map(e,function(e){return ee(e,t)}),n=void 0,i=0;i<r.length;i++)for(var s=0,a=r[i];s<a.length;s++){var o,l,c,u=a[s];n&&rs(n,u,!1,!0,!0)||(o=((e,t,r)=>{if(t.typeParameters){if(0<r)return;for(var n=1;n<e.length;n++)if(!rs(e[n],t,!1,!1,!1))return;return[t]}for(var i=void 0,n=0;n<e.length;n++){var s=n===r?t:rs(e[n],t,!0,!0,!0);if(!s)return;i=Jm.appendIfUnique(i,s)}return i})(r,u,i))&&(c=u,1<o.length&&(c=ts(u),Jm.forEach(o,function(e){return e.thisParameter})&&(l=P(Jm.map(o,function(e){return Y(e.thisParameter)||C}),!0),c.thisParameter=Tl(u.thisParameter,l)),c.resolvedReturnType=void 0,c.unionSignatures=o),(n=n||[]).push(c))}return n||Jm.emptyArray}function is(e,t){for(var r=[],n=!1,i=0,s=e;i<s.length;i++){var a=L(s[i],t);if(!a)return;r.push(a.type),n=n||a.isReadonly}return Xs(P(r,!0),n)}function ss(e,t){return e?t?za([e,t]):e:t}function as(e,t){return e?t?Xs(za([e.type,t.type]),e.isReadonly&&t.isReadonly):e:t}function os(e,t){return e&&t&&Xs(P([e.type,t.type]),e.isReadonly||t.isReadonly)}function ls(n){for(var i,s,a=Jm.emptyArray,o=Jm.emptyArray,l=n.types,c=Jm.countWhere(l,Di),e=function(r){var e,t=n.types[r];0!==c&&(c!==l.length||0!==r)&&Di(t)||((e=ee(t,1)).length&&0<c&&(e=Jm.map(e,function(e){var t=ts(e);return t.resolvedReturnType=((e,t,r)=>{for(var n=[],i=0;i<t.length;i++)i===r?n.push(e):Di(t[i])&&n.push(te(ee(t[i],1)[0]));return za(n)})(te(e),l,r),t})),o=Jm.concatenate(o,e)),a=Jm.concatenate(a,ee(t,0)),i=as(i,L(t,0)),s=as(s,L(t,1))},t=0;t<l.length;t++)e(t);Dn(n,m,a,o,i,s)}function cs(e){var t,r,n,i,s,a,o=e.symbol;e.target?Dn(e,t=Ji(fs(e.target),e.mapper,!1),n=_o(ee(e.target,0),e.mapper),a=_o(ee(e.target,1),e.mapper),r=So(L(e.target,0),e.mapper),i=So(L(e.target,1),e.mapper)):2048&o.flags?(n=Vs((t=o.members).get("__call")),a=Vs(t.get("__new")),Dn(e,t,n,a,r=Zs(o,0),i=Zs(o,1))):(t=m,r=void 0,o.exports&&(t=yn(o)),32&o.flags&&(704512&(n=Pi(s=Bi(o))).flags?Yi(t=Jm.createSymbolTable(An(t)),Z(n)):n===C&&(r=Xs(C,!1))),i=384&o.flags?Rt:void 0,Dn(e,t,Jm.emptyArray,Jm.emptyArray,r,i),8208&o.flags&&(e.callSignatures=Vs(o)),32&o.flags&&(s=Bi(o),(a=Vs(o.members.get("__constructor"))).length||(a=(e=>{var t=ee(Pi(e),1);if(0===t.length)return[es(void 0,e.localTypeParameters,void 0,Jm.emptyArray,e,void 0,0,!1,!1)];for(var r=Oi(e),n=Jm.isInJavaScriptFile(r),i=ha(r),s=Jm.length(i),a=[],o=0,l=t;o<l.length;o++){var c=l[o],u=Bs(c.typeParameters),d=Jm.length(c.typeParameters);(n||u<=s)&&s<=d&&((d=d?Ks(c,$s(i,c.typeParameters,u,n)):ts(c)).typeParameters=e.localTypeParameters,d.resolvedReturnType=e,a.push(d))}return a})(s)),e.constructSignatures=a))}function us(a){var o,l=Jm.createSymbolTable(),c=(Dn(a,m,Jm.emptyArray,Jm.emptyArray,void 0,void 0),ds(a)),e=ps(a),u=hs(a),d=Q((e=>{var t;return e.modifiersType||(170===(t=e.declaration.typeParameter.constraint).kind?e.modifiersType=U(re(t.type),e.mapper||T):(t=(t=ps(ro(e.declaration)))&&16384&t.flags?ys(t):t,e.modifiersType=t&&262144&t.flags?U(t.type,e.mapper||T):N)),e.modifiersType})(a)),p=!!a.declaration.readonlyToken,h=!!a.declaration.questionToken;if(170===a.declaration.typeParameter.constraint.kind){for(var t=0,r=Z(d);t<r.length;t++){var n=r[t];i(Wa(n),n)}(1&d.flags||L(d,0))&&i($)}else{e=540672&e.flags?Q(e):e;dc(262144&e.flags?qa(Q(e.type)):e,i)}function i(e,t){"object"==typeof t&&(r=t);var r,n,i,s,t=yo([c],[e]),t=a.mapper?bo(a.mapper,t):t,t=U(u,t);32&e.flags?(n=Jm.escapeLeadingUnderscores(e.value),i=R(d,n),(s=Mr(4|(h||!!(i&&16777216&i.flags)?16777216:0),n)).checkFlags=p||i&&Bd(i)?8:0,s.type=t,r&&(s.syntheticOrigin=r,s.declarations=r.declarations),s.syntheticLiteralTypeOrigin=e,l.set(n,s)):3&e.flags&&(o=Xs(t,p))}Dn(a,l,Jm.emptyArray,Jm.emptyArray,o,void 0)}function ds(e){return e.typeParameter||(e.typeParameter=ji(W(e.declaration.typeParameter)))}function ps(e){return e.constraintType||(e.constraintType=U(ys(ds(e)),e.mapper||T)||K)}function hs(e){return e.templateType||(e.templateType=e.declaration.type?U(ui(re(e.declaration.type),!!e.declaration.questionToken),e.mapper||T):K)}function ms(e){return 32&O(e)&&Xa(ps(e))}function gs(e){var t,r,n,i,s;return e.members||(32768&e.flags?4&e.objectFlags?(i=Xi((n=e).target),s=Jm.concatenate(i.typeParameters,[i.thisType]),Qi(n,i,s,n.typeArguments&&n.typeArguments.length===s.length?n.typeArguments:Jm.concatenate(n.typeArguments,[n]))):3&e.objectFlags?Qi(e,Xi(e),Jm.emptyArray,Jm.emptyArray):16&e.objectFlags?cs(e):32&e.objectFlags&&us(e):65536&e.flags?(s=ns((i=e).types,0),n=ns(i.types,1),t=is(i.types,0),r=is(i.types,1),Dn(i,m,s,n,t,r)):131072&e.flags&&ls(e)),e}function fs(e){return 32768&e.flags?gs(e).properties:Jm.emptyArray}function _s(e,t){if(32768&e.flags){e=gs(e).members.get(t);if(e&&En(e))return e}}function Z(e){return(196608&(e=Q(e)).flags?e=>{if(!e.resolvedProperties){for(var t=Jm.createSymbolTable(),r=0,n=e.types;r<n.length;r++){for(var i=0,s=Z(n[r]);i<s.length;i++){var a,o=s[i];t.has(o.escapedName)||(a=ws(e,o.escapedName))&&t.set(o.escapedName,a)}if(65536&e.flags)break}e.resolvedProperties=An(t)}return e.resolvedProperties}:fs)(e)}function ys(e){return Ts(e)?Qs(e):void 0}function bs(e){var t,r=Qa(e);return r||(r=vs(e.objectType),t=vs(e.indexType),r||t?eo(r||e.objectType,t||e.indexType):void 0)}function vs(e){if(737280&e.flags){var t=ks(e);if(t!==xt&&t!==Et)return t}else if(262144&e.flags)return $}function Ts(e){return ks(e)!==Et}function ks(e){var t,r,n;return e.resolvedBaseConstraint||(r=[],n=o(e),e.resolvedBaseConstraint=t?Et:Zi(n||xt,e)),e.resolvedBaseConstraint;function o(e){if(!Jm.contains(r,e))return r.push(e),e=(e=>{if(16384&e.flags)return t=Qs(e),e.isThisType?t:t?o(t):void 0;if(196608&e.flags){for(var t=e.types,r=[],n=0,i=t;n<i.length;n++){var s=o(i[n]);s&&r.push(s)}return 65536&e.flags&&r.length===t.length?P(r):131072&e.flags&&r.length?za(r):void 0}var a;return 262144&e.flags?$:524288&e.flags?(t=Qa(e))?o(t):(t=o(e.objectType),a=o(e.indexType),(t=t&&a?eo(t,a):void 0)&&t!==K?o(t):void 0):ms(e)?N:e})(e),r.pop(),e;t=!0}}function xs(e){var t;return e.default?e.default===St&&(e.default=Et):e.target?(t=xs(e.target),e.default=t?U(t,e.mapper):xt):(e.default=St,t=(t=e.symbol&&Jm.forEach(e.symbol.declarations,function(e){return Jm.isTypeParameterDeclaration(e)&&e.default}))?re(t):xt,e.default===St&&(e.default=t)),e.default}function Es(e){e=xs(e);return e!==xt&&e!==Et?e:void 0}function Q(e){var t,e=540672&e.flags?vs(e)||N:e;return 131072&e.flags?(t=e).resolvedApparentType||(t.resolvedApparentType=Zi(t,t)):262178&e.flags?ye:84&e.flags?be:136&e.flags?ve:512&e.flags?ba(2<=j):16777216&e.flags?N:e}function Ss(e,t){for(var r,n,i=e.types,s=65536&e.flags,a=s?24:0,o=s?0:16777216,l=4,c=0,u=0,d=i;u<d.length;u++)(y=Q(d[u]))!==K&&(n=(_=R(y,t))?Jm.getDeclarationModifierFlagsFromSymbol(_):0,!_||n&a?s&&(c|=16):(o&=_.flags,r=Jm.appendIfUnique(r,_),c|=(Bd(_)?8:0)|(24&n?0:64)|(16&n?128:0)|(8&n?256:0)|(32&n?512:0),Ru(_)||(l=2)));if(r){if(1===r.length&&!(16&c))return r[0];for(var p=[],h=[],m=void 0,g=0,f=r;g<f.length;g++){(_=f[g]).declarations&&Jm.addRange(h,_.declarations);var _,y=Y(_);m?y!==m&&(c|=32):m=y,p.push(y)}i=Mr(4|o,t);return i.checkFlags=l|c,i.containingType=e,i.declarations=h,i.type=(s?P:za)(p),i}}function Cs(e,t){var r=e.propertyCache||(e.propertyCache=Jm.createSymbolTable()),n=r.get(t);return n||(n=Ss(e,t))&&r.set(t,n),n}function ws(e,t){e=Cs(e,t);return!e||16&Jm.getCheckFlags(e)?void 0:e}function R(e,t){if(32768&(e=Q(e)).flags){var r=gs(e),n=r.members.get(t);if(n&&En(n))return n;if(r===kt||r.callSignatures.length||r.constructSignatures.length){n=_s(ge,t);if(n)return n}return _s(me,t)}if(196608&e.flags)return ws(e,t)}function Is(e,t){return 229376&e.flags?(e=gs(e),0===t?e.callSignatures:e.constructSignatures):Jm.emptyArray}function ee(e,t){return Is(Q(e),t)}function As(e,t){if(229376&e.flags)return e=gs(e),0===t?e.stringIndexInfo:e.numberIndexInfo}function Ds(e,t){e=As(e,t);return e&&e.type}function L(e,t){return As(Q(e),t)}function Ns(e,t){return Ds(Q(e),t)}function Os(e,t){if(vl(e)){for(var r=[],n=0,i=Z(e);n<i.length;n++){var s=i[n];0!==t&&!uu(s.escapedName)||r.push(Y(s))}if(r.length)return P(r,!0)}}function Rs(e){var r=[];return e.forEach(function(e,t){In(t)||r.push(e)}),r}function Ls(e){if(Jm.isInJavaScriptFile(e)){if(e.type&&272===e.type.kind)return!0;e=Jm.getJSDocParameterTags(e);if(e)for(var t=0,r=e;t<r.length;t++){var n=r[t];if(n.isBracketed)return!0;if(n.typeExpression)return 272===n.typeExpression.type.kind}}}function Ps(e,t){if(!Jm.isExternalModuleNameRelative(e))return(e=Gr(Pt,'"'+e+'"',512))&&t?Tn(e):e}function Ms(e){var t,r;return!(!Jm.hasQuestionToken(e)&&!Ls(e))||(e.initializer?(t=Us(r=e.parent),r=Jm.indexOf(r.parameters,e),Jm.Debug.assert(0<=r),r>=t.minArgumentCount):!!(r=Jm.getImmediatelyInvokedFunctionExpression(e.parent))&&!e.type&&!e.dotDotDotToken&&Jm.indexOf(e.parent.parameters,e)>=r.arguments.length)}function Fs(e){var t=e.parameterName;return 71===t.kind?{kind:1,parameterName:t?t.escapedText:void 0,parameterIndex:t?((e,t)=>{if(e)for(var r=0;r<e.length;r++){var n=e[r];if(71===n.name.kind&&n.name.escapedText===t.escapedText)return r}return-1})(e.parent.parameters,t):void 0,type:re(e.type)}:{kind:0,type:re(e.type)}}function Bs(e){var t,r=0;if(e)for(var n=0;n<e.length;n++)(t=e[n]).symbol&&Jm.forEach(t.symbol.declarations,function(e){return Jm.isTypeParameterDeclaration(e)&&e.default})||(r=n+1);return r}function $s(e,t,r,n){var i=Jm.length(t);if(i){var s=Jm.length(e);if((n||r<=s)&&s<=i){e=e||[];for(var a=s;a<i;a++)e[a]=$l(n);for(a=s;a<i;a++){var o=yo(t,e),l=Es(t[a]);e[a]=l?U(l,o):$l(n)}}}return e}function Us(e){var t,r=b(e);if(!r.resolvedSignature){for(var n=[],i=!1,s=0,a=void 0,o=void 0,l=Jm.getImmediatelyInvokedFunctionExpression(e),c=Jm.isJSDocConstructSignature(e),u=!l&&!c&&Jm.isInJavaScriptFile(e)&&!Jm.hasJSDocParameterTags(e),d=c?1:0;d<e.parameters.length;d++){var p=e.parameters[d],h=p.symbol;h&&4&h.flags&&!Jm.isBindingPattern(p.name)&&(h=Kr(p,h.escapedName,107455,void 0,void 0,!1)),0===d&&"this"===h.escapedName?(o=!0,a=p.symbol):n.push(h),p.type&&173===p.type.kind&&(i=!0),p.initializer||p.questionToken||p.dotDotDotToken||l&&n.length>l.arguments.length&&!p.type||Ls(p)||u||(s=n.length)}153!==e.kind&&154!==e.kind||Jm.hasDynamicName(e)||o&&a||(g=153===e.kind?154:153,(g=Jm.getDeclarationOfKind(e.symbol,g))&&(a=(g=Um(g=g))&&g.symbol));var m,g=152===e.kind?Bi(Tn(e.parent.symbol)):void 0,f=g?g.localTypeParameters:(Jm.forEach(Jm.getEffectiveTypeParameterDeclarations(e),function(e){e=ji(e.symbol);t=Jm.appendIfUnique(t,e)}),t),c=((e,t,r)=>t?re(e.parameters[0].type):r||((t=Jm.getEffectiveReturnTypeNode(e))?re(t):153!==e.kind||Jm.hasDynamicName(e)?Jm.nodeIsMissing(e.body)?C:void 0:_i(Jm.getDeclarationOfKind(e.symbol,154))))(e,c,g),_=e.type&&158===e.type.kind?Fs(e.type):void 0,y=Jm.hasRestParameter(e);!y&&Jm.isInJavaScriptFile(e)&&(e=>{var t=b(e);return void 0===t.containsArgumentsReference&&(8192&t.flags?t.containsArgumentsReference=!0:t.containsArgumentsReference=function e(t){if(!t)return!1;switch(t.kind){case 71:return"arguments"===t.escapedText&&Jm.isPartOfExpression(t);case 149:case 151:case 153:case 154:return 144===t.name.kind&&e(t.name);default:return!Jm.nodeStartsNewLexicalEnvironment(t)&&!Jm.isPartOfTypeNode(t)&&Jm.forEachChild(t,e)}}(e.body)),t.containsArgumentsReference})(e)&&(y=!0,(m=Mr(3,"args")).type=xe,m.isRestParameter=!0,n.push(m)),r.resolvedSignature=es(e,f,a,n,c,_,s,y,i)}return r.resolvedSignature}function Vs(e){if(!e)return Jm.emptyArray;for(var t=[],r=0;r<e.declarations.length;r++){var n=e.declarations[r];switch(n.kind){case 160:case 161:case 228:case 151:case 150:case 152:case 155:case 156:case 157:case 153:case 154:case 186:case 187:case 273:if(0<r&&n.body){var i=e.declarations[r-1];if(n.parent===i.parent&&n.kind===i.kind&&n.pos===i.end)break}t.push(Us(n))}}return t}function Hs(e){if(e.thisParameter)return Y(e.thisParameter)}function te(e){if(!e.resolvedReturnType){if(!Qn(e,3))return K;var t,r,n=void 0;n=e.target?U(te(e.target),e.mapper):e.unionSignatures?P(Jm.map(e.unionSignatures,te),!0):Nd(e.declaration),ti()||(n=C,_&&(t=e.declaration,(r=Jm.getNameOfDeclaration(t))?z(r,Jm.Diagnostics._0_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_referenced_directly_or_indirectly_in_one_of_its_return_expressions,Jm.declarationNameToString(r)):z(t,Jm.Diagnostics.Function_implicitly_has_return_type_any_because_it_does_not_have_a_return_type_annotation_and_is_referenced_directly_or_indirectly_in_one_of_its_return_expressions))),e.resolvedReturnType=n}return e.resolvedReturnType}function Gs(e){if(e.hasRestParameter){e=Y(Jm.lastOrUndefined(e.parameters));if(4&O(e)&&e.target===fe)return e.typeArguments[0]}return C}function js(e,t,r){t=$s(t,e.typeParameters,Bs(e.typeParameters),r);var r=e.instantiations||(e.instantiations=Jm.createMap()),n=ta(t),i=r.get(n);return i||r.set(n,i=Ks(e,t)),i}function Ks(e,t){return To(e,yo(e.typeParameters,t),!0)}function zs(e){return e.typeParameters?e.erasedSignatureCache||(e.erasedSignatureCache=To(e,(e=>yo(e,void 0))(e.typeParameters),!0)):e}function Ws(e){return e.typeParameters?e.canonicalSignatureCache||(e.canonicalSignatureCache=js(t=e,Jm.map(t.typeParameters,function(e){return e.target&&!ys(e.target)?e.target:e}),Jm.isInJavaScriptFile(t.declaration))):e;var t}function qs(e){var t,r;return e.isolatedSignatureType||(t=152===e.declaration.kind||156===e.declaration.kind,(r=wn(16)).members=m,r.properties=Jm.emptyArray,r.callSignatures=t?Jm.emptyArray:[e],r.constructSignatures=t?[e]:Jm.emptyArray,e.isolatedSignatureType=r),e.isolatedSignatureType}function Js(e){return e.members.get("__index")}function Ys(e,t){var r=1===t?133:136,t=Js(e);if(t)for(var n=0,i=t.declarations;n<i.length;n++){var s=i[n];if(1===s.parameters.length){var a=s.parameters[0];if(a&&a.type&&a.type.kind===r)return s}}}function Xs(e,t,r){return{type:e,isReadonly:t,declaration:r}}function Zs(e,t){e=Ys(e,t);if(e)return Xs(e.type?re(e.type):C,Jm.hasModifier(e,64),e)}function Qs(e){var t,r;return e.constraint||(e.target?(r=ys(e.target),e.constraint=r?U(r,e.mapper):xt):(t=(r=e).symbol&&Jm.getDeclarationOfKind(r.symbol,145).constraint,e.constraint=t?re(t):xt)),e.constraint===xt?void 0:e.constraint}function ea(e){return W(Jm.getDeclarationOfKind(e.symbol,145).parent)}function ta(e){var t="";if(e)for(var r=e.length,n=0;n<r;){for(var i=e[n].id,s=1;n+s<r&&e[n+s].id===i+s;)s++;t.length&&(t+=","),t+=i,1<s&&(t+=":"+s),n+=s}return t}function ra(e,t){for(var r=0,n=0,i=e;n<i.length;n++){var s=i[n];s.flags&t||(r|=s.flags)}return 14680064&r}function na(e,t){var r=ta(t),n=e.instantiations.get(r);return n||(n=wn(4,e.symbol),e.instantiations.set(r,n),n.flags|=t?ra(t,0):0,n.target=e,n.typeArguments=t),n}function ia(e){var t=Sn(e.flags);return t.symbol=e.symbol,t.objectFlags=e.objectFlags,t.target=e.target,t.typeArguments=e.typeArguments,t}function sa(e){return Jm.length(e.target.typeParameters)}function aa(e,t,r){var n,i,s,t=X(Tn(t)),a=t.localTypeParameters;return a?(n=Jm.length(e.typeArguments),i=Bs(a),!(s=Jm.isInJavaScriptFile(e))&&(n<i||n>a.length)?(z(e,i===a.length?Jm.Diagnostics.Generic_type_0_requires_1_type_argument_s:Jm.Diagnostics.Generic_type_0_requires_between_1_and_2_type_arguments,J(t,void 0,1),i,a.length),K):na(t,Jm.concatenate(t.outerTypeParameters,$s(r,a,i,s)))):e.typeArguments?(z(e,Jm.Diagnostics.Type_0_is_not_generic,J(t)),K):t}function oa(e,t,r){var n,i,s,a,o,l=X(t),c=d(t).typeParameters;return c?(i=Jm.length(e.typeArguments))<(n=Bs(c))||i>c.length?(z(e,n===c.length?Jm.Diagnostics.Generic_type_0_requires_1_type_argument_s:Jm.Diagnostics.Generic_type_0_requires_between_1_and_2_type_arguments,q(t),n,c.length),K):(i=r,c=X(n=t),r=d(n),s=r.typeParameters,a=ta(i),(o=r.instantiations.get(a))||r.instantiations.set(a,o=U(c,yo(s,$s(i,s,Bs(s),Jm.isInJavaScriptFile(n.valueDeclaration))))),o):e.typeArguments?(z(e,Jm.Diagnostics.Type_0_is_not_generic,q(t)),K):l}function la(e){switch(e.kind){case 159:return e.typeName;case 201:var t=e.expression;if(Jm.isEntityNameExpression(t))return t}}function ca(e,t){return e&&cn(e,t)||B}function ua(e,t,r){return 96&t.flags?aa(e,t,r):524288&t.flags?oa(e,t,r):16&t.flags&&da(e)&&(t.members||Jm.getJSDocClassTag(t.valueDeclaration))?bd(t):void 0}function da(e){return 1048576&e.flags&&159===e.kind}function pa(e){var t,r,n,i=b(e);return i.resolvedType||(r=t=void 0,n=793064,da(e)&&(r=(e=>{if(Jm.isIdentifier(e.typeName)){var t,r;if("Object"===e.typeName.escapedText)return Jm.isJSDocIndexSignature(e)?(t=re(e.typeArguments[0]),r=Xs(re(e.typeArguments[1]),!1),Nn(void 0,m,Jm.emptyArray,Jm.emptyArray,t===$&&r,t===dt&&r)):C;switch(e.typeName.escapedText){case"String":return $;case"Number":return dt;case"Boolean":return mt;case"Void":return ft;case"Undefined":return ot;case"Null":return ct;case"Function":case"function":return ge;case"Array":case"array":return e.typeArguments&&e.typeArguments.length?void 0:xe;case"Promise":case"promise":return e.typeArguments&&e.typeArguments.length?void 0:Ad(C)}}})(e),n|=107455),r=r||((e,t)=>{var r=ha(e);if(t===B)return K;var n=ua(e,t,r);if(!n){if(void 0!==(n=Ki(t)))return r?(z(e,Jm.Diagnostics.Type_0_is_not_generic,q(t)),K):n;if(!(107455&t.flags&&da(e)))return K;if((n=Y(t)).symbol&&!vd(n)){t=ua(e,n.symbol,r);if(t)return t}ca(la(e),793064)}return n})(e,t=ca(la(e),n)),i.resolvedSymbol=t,i.resolvedType=r),i.resolvedType}function ha(e){return Jm.map(e.typeArguments,re)}function ma(e){var t=b(e);return t.resolvedType||(t.resolvedType=Sl(V(e.exprName))),t.resolvedType}function ga(e,t){function r(e){for(var t=0,r=e.declarations;t<r.length;t++){var n=r[t];switch(n.kind){case 229:case 230:case 232:return n}}}var n;return e?32768&(n=X(e)).flags?Jm.length(n.typeParameters)!==t?(z(r(e),Jm.Diagnostics.Global_type_0_must_have_1_type_parameter_s,Jm.symbolName(e),t),t?Tt:N):n:(z(r(e),Jm.Diagnostics.Global_type_0_must_be_a_class_or_interface_type,Jm.symbolName(e)),t?Tt:N):t?Tt:N}function fa(e,t){return _a(e,107455,t?Jm.Diagnostics.Cannot_find_global_value_0:void 0)}function _a(e,t,r){return Kr(void 0,e,t,r,e,!1)}function ya(e,t,r){e=_a(e,793064,r?Jm.Diagnostics.Cannot_find_global_type_0:void 0);return e||r?ga(e,t):void 0}function ba(e){return(we=we||ya("Symbol",0,e))||N}function va(e){return(Ae=Ae||ya("Promise",1,e))||Tt}function Ta(e){return De=De||fa("Promise",e)}function ka(e){return(Pe=Pe||ya("AsyncIterable",1,e))||Tt}function xa(e){return(Me=Me||ya("AsyncIterator",1,e))||Tt}function Ea(e){return(Fe=Fe||ya("AsyncIterableIterator",1,e))||Tt}function Sa(e){return(Oe=Oe||ya("Iterable",1,e))||Tt}function Ca(e){return(Re=Re||ya("Iterator",1,e))||Tt}function wa(e){return(Le=Le||ya("IterableIterator",1,e))||Tt}function Ia(e,t){void 0===t&&(t=0);e=_a(e,793064,void 0);return e&&ga(e,t)}function Aa(e,t){e=_a(e,1920,void 0),e=e&&Gr(e.exports,t,793064);return e&&X(e)}function Da(e,t){return e!==Tt?na(e,t):N}function Na(e){return Da((Ie=Ie||ya("TypedPropertyDescriptor",1,!0))||Tt,[e])}function Oa(e){return Da(Ea(!0),[e])}function Ra(e){return Da(Sa(!0),[e])}function La(e){return Da(wa(!0),[e])}function Pa(e){return Da(fe,[e])}function Ma(e){return Qe[e]||(Qe[e]=(e=>{for(var t=[],r=[],n=0;n<e;n++){var i=Sn(16384),s=(t.push(i),Mr(4,""+n));s.type=i,r.push(s)}var a=wn(12);return a.typeParameters=t,a.outerTypeParameters=void 0,a.localTypeParameters=t,a.instantiations=Jm.createMap(),a.instantiations.set(ta(a.typeParameters),a),(a.target=a).typeArguments=a.typeParameters,a.thisType=Sn(16384),a.thisType.isThisType=!0,(a.thisType.constraint=a).declaredProperties=r,a.declaredCallSignatures=Jm.emptyArray,a.declaredConstructSignatures=Jm.emptyArray,a.declaredStringIndexInfo=void 0,a.declaredNumberIndexInfo=void 0,a})(e))}function Fa(e){return na(Ma(e.length),e)}function Ba(e,t){for(var r=0,n=e.length-1,i=t.id;r<=n;){var s=r+(n-r>>1),a=e[s].id;if(a===i)return s;i<a?n=s-1:r=s+1}return~r}function $a(e,t){return 0<=Ba(e,t)}function Ua(e,t){var r,n=t.flags;65536&n?Va(e,t.types):1&n?e.containsAny=!0:!F&&6144&n?(2048&n&&(e.containsUndefined=!0),4096&n&&(e.containsNull=!0),2097152&n||(e.containsNonWideningType=!0)):8192&n||131072&n&&(e=>{for(var t=0,r=0,n=e.types;r<n.length;r++){var i=n[r];if(6368&i.flags&&6368&t)return 1;if(6144&(t|=i.flags)&&16809984&t)return 1}})(t)||(2&n&&(e.containsString=!0),4&n&&(e.containsNumber=!0),96&n&&(e.containsStringOrNumberLiteral=!0),(r=(r=e.length)&&t.id>e[r-1].id?~r:Ba(e,t))<0&&(32768&n&&16&t.objectFlags&&t.symbol&&8208&t.symbol.flags&&Ha(e,t)||e.splice(~r,0,t)))}function Va(e,t){for(var r=0,n=t;r<n.length;r++)Ua(e,n[r])}function Ha(e,t){for(var r=0,n=e;r<n.length;r++)if(Do(n[r],t))return 1}function Ga(e){if(0!==e.length&&!(e=>{var t=e[0];if(256&t.flags){for(var r=kn(t.symbol),n=1;n<e.length;n++){var i=e[n];if(!(256&i.flags)||r!==kn(i.symbol))return}return 1}})(e))for(var t=e.length;0<t;)((e,t)=>{for(var r=0,n=t;r<n.length;r++){var i=n[r];if(e!==i&&Ro(e,i))return 1}})(e[--t],e)&&Jm.orderedRemoveItemAt(e,t)}function P(e,t,r,n){if(0===e.length)return _t;if(1===e.length)return e[0];var i=[];if(Va(i,e),i.containsAny)return C;if(t)Ga(i);else if(i.containsStringOrNumberLiteral)for(var s=i,a=s.length;0<a;){var o=s[--a];(32&o.flags&&s.containsString||64&o.flags&&s.containsNumber||96&o.flags&&1048576&o.flags&&$a(s,o.regularType))&&Jm.orderedRemoveItemAt(s,a)}return 0===i.length?i.containsNull?i.containsNonWideningType?ct:ut:i.containsUndefined?i.containsNonWideningType?ot:lt:_t:ja(i,r,n)}function ja(e,t,r){var n,i;return 0===e.length?_t:1===e.length?e[0]:(n=ta(e),(i=et.get(n))||(i=Sn(65536|ra(e,6144)),et.set(n,i),i.types=e,i.aliasSymbol=t,i.aliasTypeArguments=r),i)}function Ka(e,t){for(var r,n=0,i=t;n<i.length;n++){var s=i[n];r=e,131072&(s=s).flags?Ka(r,s.types):1&s.flags?r.containsAny=!0:8192&s.flags?r.containsNever=!0:16&O(s)&&Vo(s)?r.containsEmptyObject=!0:!F&&6144&s.flags||Jm.contains(r,s)||(32768&s.flags&&(r.containsObjectType=!0),65536&s.flags&&void 0===r.unionIndex&&(r.unionIndex=r.length),32768&s.flags&&16&s.objectFlags&&s.symbol&&8208&s.symbol.flags&&Ha(r,s))||r.push(s)}}function za(e,t,r){var n,i,s;return 0===e.length?N:(Ka(n=[],e),n.containsNever?_t:n.containsAny?C:(n.containsEmptyObject&&!n.containsObjectType&&n.push(N),1===n.length?n[0]:void 0!==(i=n.unionIndex)?(e=n[i],P(Jm.map(e.types,function(e){return za(Jm.replaceElement(n,i,e))}),!1,t,r)):(e=ta(n),(s=tt.get(e))||(s=Sn(131072|ra(n,6144)),tt.set(e,s),s.types=n,s.aliasSymbol=t,s.aliasTypeArguments=r),s)))}function Wa(e){return 24&Jm.getDeclarationModifierFlagsFromSymbol(e)||Jm.startsWith(e.escapedName,"__@")?_t:ho(Jm.symbolName(e))}function qa(e){return Hd(e,540672)?((t=e).resolvedIndexType||(t.resolvedIndexType=Sn(262144),t.resolvedIndexType.type=t),t.resolvedIndexType):32&O(e)?ps(e):1&e.flags||L(e,0)?$:P(Jm.map(Z(e),Wa));var t}function Ja(e,t,r,n){var i=r&&180===r.kind?r:void 0,s=96&t.flags?Jm.escapeLeadingUnderscores(""+t.value):i&&Ku(i.argumentExpression,t,!1)?Jm.getPropertyNameForKnownSymbolName(Jm.idText(i.argumentExpression.name)):void 0;if(void 0!==s){var s=R(e,s);if(s){if(i){if(Jm.isAssignmentTarget(i)&&($d(i,s)||Ud(i)))return z(i.argumentExpression,Jm.Diagnostics.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,q(s)),K;n&&(b(r).resolvedSymbol=s)}return Y(s)}}if(!(6144&t.flags)&&Gd(t,262774)){if(D(e))return C;n=Gd(t,84)&&L(e,1)||L(e,0)||void 0;if(n)return i&&n.isReadonly&&(Jm.isAssignmentTarget(i)||Jm.isDeleteTarget(i))&&z(i,Jm.Diagnostics.Index_signature_in_type_0_only_permits_reading,J(e)),n.type;if(i&&!jd(e))return _&&!M.suppressImplicitAnyIndexErrors&&(Ns(e,1)?z(i.argumentExpression,Jm.Diagnostics.Element_implicitly_has_an_any_type_because_index_expression_is_not_of_type_number):z(i,Jm.Diagnostics.Element_implicitly_has_an_any_type_because_type_0_has_no_index_signature,J(e))),C}return r?(s=180===r.kind?r.argumentExpression:r.indexType,96&t.flags?z(s,Jm.Diagnostics.Property_0_does_not_exist_on_type_1,""+t.value,J(e)):6&t.flags?z(s,Jm.Diagnostics.Type_0_has_no_matching_index_signature_for_type_1,J(e),J(t)):z(s,Jm.Diagnostics.Type_0_cannot_be_used_as_an_index_type,J(t)),K):C}function Ya(e){return!!(540672&e.flags)||(32&O(e)?Xa(ps(e)):!!(196608&e.flags)&&Jm.forEach(e.types,Ya))}function Xa(e){return!!(802816&e.flags)||!!(196608&e.flags)&&Jm.forEach(e.types,Xa)}function Za(e){return!(!(32768&e.flags)||ms(e))&&0===(e=gs(e)).properties.length&&0===e.callSignatures.length&&0===e.constructSignatures.length&&e.stringIndexInfo&&!e.numberIndexInfo}function Qa(e){var t,r=e.objectType;if(131072&r.flags&&Ya(r)&&Jm.some(r.types,Za)){for(var n=[],i=[],s=0,a=r.types;s<a.length;s++){var o=a[s];Za(o)?i.push(Ns(o,0)):n.push(o)}return P([eo(za(n),e.indexType),za(i)])}if(ms(r))return e=yo([ds(r)],[e.indexType]),t=(t=r.mapper)?bo(t,e):e,U(hs(r),t)}function eo(e,t,r){var n,i,s,a;if(Xa(t)||(!r||180!==r.kind)&&Ya(e))return 1&e.flags?e:(i=e.id+","+t.id,(n=nt.get(i))||nt.set(i,(i=e,s=t,(a=Sn(524288)).objectType=i,a.indexType=s,n=a)),n);var o=Q(e);if(!(65536&t.flags)||8&t.flags)return Ja(o,t,r,!0);for(var l=[],c=0,u=t.types;c<u.length;c++){var d=Ja(o,u[c],r,!1);if(d===K)return K;l.push(d)}return P(l)}function to(e){var t=b(e);return t.resolvedType||(t.resolvedType=eo(re(e.objectType),re(e.indexType),e)),t.resolvedType}function ro(e){var t,r=b(e);return r.resolvedType||((t=wn(32,e.symbol)).declaration=e,t.aliasSymbol=io(e),t.aliasTypeArguments=so(e),ps(r.resolvedType=t)),r.resolvedType}function no(e){var t,r,n=b(e);return n.resolvedType||(t=io(e),0!==e.symbol.members.size||t?((r=wn(16,e.symbol)).aliasSymbol=t,r.aliasTypeArguments=so(e),Jm.isJSDocTypeLiteral(e)&&e.isArrayType&&(r=Pa(r)),n.resolvedType=r):n.resolvedType=vt),n.resolvedType}function io(e){return 231===e.parent.kind?W(e.parent):void 0}function so(e){e=io(e);return e?Ii(e):void 0}function ao(t,r,n,i){if(1&t.flags||1&r.flags)return C;if(8192&t.flags)return r;if(8192&r.flags)return t;if(65536&t.flags)return hc(t,function(e){return ao(e,r,n,i)});if(65536&r.flags)return hc(r,function(e){return ao(t,e,n,i)});if(16777216&r.flags)return bt;if(262654&r.flags)return t;for(var e=Jm.createSymbolTable(),s=Jm.createUnderscoreEscapedMap(),a=t===N?(_=L(r,0),L(r,1)):(_=os(L(t,0),L(r,0)),os(L(t,1),L(r,1))),o=0,l=Z(r);o<l.length;o++){var c=65536&(p=l[o]).flags&&!(32768&p.flags);24&Jm.getDeclarationModifierFlagsFromSymbol(p)?s.set(p.escapedName,!0):lo(p)||c||e.set(p.escapedName,oo(p))}for(var u=0,d=Z(t);u<d.length;u++){var p,h,m,g,f=d[u];65536&f.flags&&!(32768&f.flags)||s.has(f.escapedName)||lo(f)||(e.has(f.escapedName)?(h=Y(p=e.get(f.escapedName)),16777216&p.flags&&(m=Jm.concatenate(f.declarations,p.declarations),(g=Mr(4|16777216&f.flags,f.escapedName)).type=P([Y(f),Xl(h,131072)]),g.leftSpread=f,g.rightSpread=p,g.declarations=m,e.set(f.escapedName,g))):e.set(f.escapedName,oo(f)))}var _=Nn(void 0,e,Jm.emptyArray,Jm.emptyArray,_,a);return _.flags|=i,_.flags|=5242880,_.objectFlags|=128,_.symbol=n,_}function oo(e){var t;return Bd(e)?((t=Mr(4|16777216&e.flags,e.escapedName)).type=Y(e),t.declarations=e.declarations,t.syntheticOrigin=e,t):e}function lo(e){return 8192&e.flags&&Jm.find(e.declarations,function(e){return Jm.isClassLike(e.parent)})}function co(e,t,r){e=Sn(e);return e.symbol=r,e.value=t,e}function uo(e){var t;return 96&e.flags&&!(1048576&e.flags)?(e.freshType||(((t=co(1048576|e.flags,e.value,e.symbol)).regularType=e).freshType=t),e.freshType):e}function po(e){return 96&e.flags&&1048576&e.flags?e.regularType:e}function ho(e,t,r){var n="number"==typeof e?"#":"@",n=t?t+n+e:n+e,i=rt.get(n);return i||rt.set(n,i=co(("number"==typeof e?64:32)|(t?256:0),e,r)),i}function mo(e){var t,r,n=b(e);return n.resolvedType||(n.resolvedType=(e=e,t=Jm.getThisContainer(e,!1),!(r=t&&t.parent)||!Jm.isClassLike(r)&&230!==r.kind||Jm.hasModifier(t,32)||152===t.kind&&!Jm.isNodeDescendantOf(e,t.body)?(z(e,Jm.Diagnostics.A_this_type_is_available_only_in_a_non_static_member_of_a_class_or_interface),K):Bi(W(r)).thisType)),n.resolvedType}function re(e){switch(e.kind){case 119:case 268:case 269:return C;case 136:return $;case 133:return dt;case 122:return mt;case 137:return gt;case 105:return ft;case 139:return ot;case 95:return ct;case 130:return _t;case 134:return 65536&e.flags?C:bt;case 169:case 99:return mo(e);case 173:return(c=b(l=e)).resolvedType||(c.resolvedType=po(V(l.literal))),c.resolvedType;case 159:return pa(e);case 158:return mt;case 201:return pa(e);case 162:return ma(e);case 164:return(c=b(l=e)).resolvedType||(c.resolvedType=Pa(re(l.elementType))),c.resolvedType;case 165:return(o=b(a=e)).resolvedType||(o.resolvedType=Fa(Jm.map(a.elementTypes,re))),o.resolvedType;case 166:return(o=b(a=e)).resolvedType||(o.resolvedType=P(Jm.map(a.types,re),!1,io(a),so(a))),o.resolvedType;case 167:return(s=b(i=e)).resolvedType||(s.resolvedType=za(Jm.map(i.types,re),io(i),so(i))),s.resolvedType;case 270:return i=re((i=e).type),F?P([i,ct]):i;case 168:case 271:case 272:case 267:return re(e.type);case 160:case 161:case 163:case 285:case 273:return no(e);case 170:return(n=b(s=e)).resolvedType||(n.resolvedType=qa(re(s.type))),n.resolvedType;case 171:return to(e);case 172:return ro(e);case 71:case 143:n=qh(e);return n&&X(n);case 274:return(r=b(t=e)).resolvedType||(t=re(t.type),r.resolvedType=t?Pa(t):K),r.resolvedType;default:return K}var t,r,n,i,s,a,o,l,c}function go(e,t,r){if(e&&e.length){for(var n=[],i=0,s=e;i<s.length;i++){var a=s[i];n.push(r(a,t))}return n}return e}function fo(e,t){return go(e,t,U)}function _o(e,t){return go(e,t,To)}function yo(e,t){return Jm.Debug.assert(void 0===t||e.length===t.length),1===e.length?(l=e[0],c=t?t[0]:C,function(e){return e===l?c:e}):2===e.length?(i=e[0],s=t?t[0]:C,a=e[1],o=t?t[1]:C,function(e){return e===i?s:e===a?o:e}):(r=e,n=t,function(e){for(var t=0;t<r.length;t++)if(e===r[t])return n?n[t]:C;return e});var r,n,i,s,a,o,l,c}function bo(t,r){return function(e){return U(t(e),r)}}function vo(e){var t=Sn(16384);return t.symbol=e.symbol,t.target=e,t}function To(e,t,r){var n,i;if(e.typeParameters&&!r){n=Jm.map(e.typeParameters,vo),t=bo(yo(e.typeParameters,n),t);for(var s=0,a=n;s<a.length;s++)a[s].mapper=t}e.typePredicate&&(r=e.typePredicate,i=t,i=Jm.isIdentifierTypePredicate(r)?{kind:1,parameterName:r.parameterName,parameterIndex:r.parameterIndex,type:U(r.type,i)}:{kind:0,type:U(r.type,i)});r=es(e.declaration,n,e.thisParameter&&ko(e.thisParameter,t),go(e.parameters,t,ko),void 0,i,e.minArgumentCount,e.hasRestParameter,e.hasLiteralTypes);return r.target=e,r.mapper=t,r}function ko(e,t){1&Jm.getCheckFlags(e)&&(e=(r=d(e)).target,t=bo(r.mapper,t));var r=Mr(e.flags,e.escapedName);return r.checkFlags=1,r.declarations=e.declarations,r.parent=e.parent,r.target=e,r.mapper=t,e.valueDeclaration&&(r.valueDeclaration=e.valueDeclaration),e.isRestParameter&&(r.isRestParameter=e.isRestParameter),r}function xo(e,t){var n,r,i=64&e.objectFlags?e.target:e,s=i.symbol,a=d(s),o=a.typeParameters;return o||(r=Ci(n=s.declarations[0],!0)||Jm.emptyArray,o=2048&s.flags&&!i.aliasTypeArguments?Jm.filter(r,function(e){var r=e,e=n;if(r.symbol&&r.symbol.declarations&&1===r.symbol.declarations.length){var t=r.symbol.declarations[0].parent;if(Jm.findAncestor(e,function(e){return 207===e.kind?"quit":e===t}))return Jm.forEachChild(e,function e(t){switch(t.kind){case 169:return r.isThisType;case 71:return!r.isThisType&&Jm.isPartOfTypeNode(t)&&re(t)===r;case 162:return!0}return Jm.forEachChild(t,e)})}return!0}):r,(a.typeParameters=o).length&&(a.instantiations=Jm.createMap(),a.instantiations.set(ta(o),i))),o.length?(s=64&e.objectFlags?bo(e.mapper,t):t,t=ta(r=Jm.map(o,s)),(s=a.instantiations.get(t))||(o=yo(o,r),s=(32&i.objectFlags?(i,s)=>{var e=ps(i);if(262144&e.flags){var a=e.type;if(16384&a.flags){e=U(a,s);if(a!==e)return hc(e,function(e){var t,r,n;return 704513&e.flags?Eo(i,(t=a,r=e,n=s,function(e){return e===t?r:n(e)})):e})}}return Eo(i,s)}:Eo)(i,o),a.instantiations.set(t,s)),s):e}function Eo(e,t){var r=wn(64|e.objectFlags,e.symbol);return 32&e.objectFlags&&(r.declaration=e.declaration),r.target=e,r.mapper=t,r.aliasSymbol=e.aliasSymbol,r.aliasTypeArguments=fo(e.aliasTypeArguments,t),r}function U(e,t){if(e&&t!==T){if(16384&e.flags)return t(e);if(32768&e.flags){if(16&e.objectFlags)return e.symbol&&14384&e.symbol.flags&&e.symbol.declarations?xo(e,t):e;if(32&e.objectFlags)return xo(e,t);if(4&e.objectFlags)return na(e.target,fo(e.typeArguments,t))}if(65536&e.flags&&!(8190&e.flags))return P(fo(e.types,t),!1,e.aliasSymbol,fo(e.aliasTypeArguments,t));if(131072&e.flags)return za(fo(e.types,t),e.aliasSymbol,fo(e.aliasTypeArguments,t));if(262144&e.flags)return qa(U(e.type,t));if(524288&e.flags)return eo(U(e.objectType,t),U(e.indexType,t))}return e}function So(e,t){return e&&Xs(U(e.type,t),e.isReadonly,e.declaration)}function Co(e){switch(Jm.Debug.assert(151!==e.kind||Jm.isObjectLiteralMethod(e)),e.kind){case 186:case 187:case 151:return wo(e);case 178:return Jm.forEach(e.properties,Co);case 177:return Jm.forEach(e.elements,Co);case 195:return Co(e.whenTrue)||Co(e.whenFalse);case 194:return 54===e.operatorToken.kind&&(Co(e.left)||Co(e.right));case 261:return Co(e.initializer);case 185:return Co(e.expression);case 254:return Jm.forEach(e.properties,Co);case 253:return e.initializer&&Co(e.initializer);case 256:return e.expression&&Co(e.expression)}return!1}function wo(e){if(e.typeParameters)return!1;if(Jm.forEach(e.parameters,function(e){return!Jm.getEffectiveTypeAnnotationNode(e)}))return!0;if(187!==e.kind){var t=Jm.firstOrUndefined(e.parameters);if(!t||!Jm.parameterIsThisKeyword(t))return!0}return 207!==e.body.kind&&Co(e.body)}function Io(e){return(nu(e)||Jm.isObjectLiteralMethod(e))&&wo(e)}function Ao(e){if(32768&e.flags){var t,r=gs(e);if(r.constructSignatures.length)return(t=wn(16,e.symbol)).members=r.members,t.properties=r.properties,t.callSignatures=Jm.emptyArray,t.constructSignatures=Jm.emptyArray,t}else if(131072&e.flags)return za(Jm.map(e.types,Ao));return e}function Do(e,t){return jo(e,t,_r)}function No(e,t){return jo(e,t,_r)?-1:0}function Oo(e,t){return jo(e,t,gr)?-1:0}function Ro(e,t){return jo(e,t,mr)}function x(e,t){return jo(e,t,gr)}function Lo(e,t){return xi(e)===xi(t)||Ro(e,t)&&!Do(e,t)}function Po(e,t){return jo(e,t,fr)}function Mo(e,t,r,n,i){return Ko(e,t,gr,r,n,i)}function Fo(e,t,r,n,i){Ko(e,t,fr,r,n,i)}function Bo(e,t,r,n,i,s,a){if(e===t)return-1;if(!t.hasRestParameter&&e.minArgumentCount>t.parameters.length)return 0;e.typeParameters&&e.typeParameters!==t.typeParameters&&(e=Zu(e,t=Ws(t),void 0,a));var o=t.declaration?t.declaration.kind:0,l=!r&&oe&&151!==o&&150!==o&&152!==o,c=-1,o=Hs(e);if(o&&o!==ft){var u=Hs(t);if(u){if(!(y=!l&&a(o,u,!1)||a(u,o,i)))return i&&s(Jm.Diagnostics.The_this_types_of_each_signature_are_incompatible),0;c&=y}}for(var d,p=Uo(e),h=Uo(t),m=(u=p,o=t,d=h,(x=e).hasRestParameter===o.hasRestParameter?x.hasRestParameter?Math.max(u,d)+1:Math.min(u,d):x.hasRestParameter?d:u),g=e.parameters,f=t.parameters,_=0;_<m;_++){var y,b=_<p?Sd(g[_]):Gs(e),v=_<h?Sd(f[_]):Gs(t),T=r?void 0:Xu(bl(b)),k=r?void 0:Xu(bl(v));if(!(y=T&&k&&!T.typePredicate&&!k.typePredicate&&(6144&gl(b))==(6144&gl(v))?Bo(k,T,l?2:1,!1,i,s,a):!r&&!l&&a(b,v,!1)||a(v,b,i)))return i&&s(Jm.Diagnostics.Types_of_parameters_0_and_1_are_incompatible,Jm.symbolName(g[_<p?_:p]),Jm.symbolName(f[_<h?_:h])),0;c&=y}if(!n){o=te(t);if(o===ft)return c;var x=te(e);if(t.typePredicate){if(e.typePredicate)c&=((e,t,r,n,i,s,a)=>{if(e.kind!==t.kind)return i&&(s(Jm.Diagnostics.A_this_based_type_guard_is_not_compatible_with_a_parameter_based_type_guard),s(Jm.Diagnostics.Type_predicate_0_is_not_assignable_to_1,Gn(e),Gn(t))),0;if(1===e.kind){var o=e,l=t,r=o.parameterIndex-(Jm.getThisParameter(r)?1:0),n=l.parameterIndex-(Jm.getThisParameter(n)?1:0);if(r!=n)return i&&(s(Jm.Diagnostics.Parameter_0_is_not_in_the_same_position_as_parameter_1,o.parameterName,l.parameterName),s(Jm.Diagnostics.Type_predicate_0_is_not_assignable_to_1,Gn(e),Gn(t))),0}return 0===(r=a(e.type,t.type,i))&&i&&s(Jm.Diagnostics.Type_predicate_0_is_not_assignable_to_1,Gn(e),Gn(t)),r})(e.typePredicate,t.typePredicate,e.declaration,t.declaration,i,s,a);else if(Jm.isIdentifierTypePredicate(t.typePredicate))return i&&s(Jm.Diagnostics.Signature_0_must_be_a_type_predicate,Hn(e)),0}else c&=1===r&&a(o,x,!1)||a(x,o,i)}return c}function $o(e,t){var e=zs(e),t=zs(t),r=te(e),n=te(t);return(n===ft||jo(n,r,gr)||jo(r,n,gr))&&0!==Bo(e,t,0,!0,!1,void 0,Oo)}function Uo(e){var t=e.parameters.length;return e.hasRestParameter?t-1:t}function Vo(e){return 32768&e.flags?0===(t=gs(e)).properties.length&&0===t.callSignatures.length&&0===t.constructSignatures.length&&!t.stringIndexInfo&&!t.numberIndexInfo:!!(16777216&e.flags)||(65536&e.flags?Jm.forEach(e.types,Vo):!!(131072&e.flags)&&!Jm.forEach(e.types,function(e){return!Vo(e)}));var t}function Ho(e,t,r){if(e===t)return 1;var n=eg(e)+","+eg(t),i=yr.get(n);if(void 0!==i)return i;if(e.escapedName===t.escapedName&&256&e.flags&&256&t.flags){for(var s=Y(t),a=0,o=Z(Y(e));a<o.length;a++){var l=o[a];if(8&l.flags){var c=R(s,l.escapedName);if(!(c&&8&c.flags))return r&&r(Jm.Diagnostics.Property_0_is_missing_in_type_1,Jm.symbolName(l),J(X(t),void 0,256)),void yr.set(n,!1)}}return yr.set(n,!0),1}yr.set(n,!1)}function Go(e,t,r,n){var i=e.flags,s=t.flags;if(!(8192&s)){if(1&s||8192&i)return 1;if(262178&i&&2&s)return 1;if(32&i&&256&i&&32&s&&!(256&s)&&e.value===t.value)return 1;if(84&i&&4&s)return 1;if(64&i&&256&i&&64&s&&!(256&s)&&e.value===t.value)return 1;if(136&i&&8&s)return 1;if(16&i&&16&s&&Ho(e.symbol,t.symbol,n))return 1;if(256&i&&256&s){if(65536&i&&65536&s&&Ho(e.symbol,t.symbol,n))return 1;if(224&i&&224&s&&e.value===t.value&&Ho(kn(e.symbol),kn(t.symbol),n))return 1}if(2048&i&&(!F||3072&s))return 1;if(4096&i&&(!F||4096&s))return 1;if(32768&i&&16777216&s)return 1;if(r===gr||r===fr){if(1&i)return 1;if(68&i&&!(256&i)&&(16&s||64&s&&256&s))return 1}}}function jo(e,t,r){if((e=96&e.flags&&1048576&e.flags?e.regularType:e)===(t=96&t.flags&&1048576&t.flags?t.regularType:t)||r!==_r&&Go(e,t,r))return!0;if(32768&e.flags&&32768&t.flags){var n=r.get(Xo(e,t,r));if(void 0!==n)return 1===n}return!!(1032192&e.flags||1032192&t.flags)&&Ko(e,t,r,void 0)}function Ko(e,t,x,d,r,n){var E,o,l,c,u=0,p=0,h=(0,0),m=!1,g=!1,r=(Jm.Debug.assert(x!==_r||!d,"no error reporting in identity checking"),C(e,t,!!d,r));return m?z(d,Jm.Diagnostics.Excessive_stack_depth_comparing_types_0_and_1,J(e),J(t)):E&&(n&&(E=Jm.concatenateDiagnosticMessageChains(n,E)),sr.add(Jm.createDiagnosticForNodeFromMessageChain(d,E))),0!==r;function S(e,t,r,n){Jm.Debug.assert(!!d),E=Jm.chainDiagnosticMessages(E,e,t,r,n)}function f(e,t,r){var n=J(t),i=J(r);n===i&&(n=J(t,void 0,256),i=J(r,void 0,256)),S(e=e||(x===fr?Jm.Diagnostics.Type_0_is_not_comparable_to_type_1:n===i?Jm.Diagnostics.Type_0_is_not_assignable_to_type_1_Two_different_types_with_this_name_exist_but_they_are_unrelated:Jm.Diagnostics.Type_0_is_not_assignable_to_type_1),n,i)}function C(e,t,r,n){if(96&e.flags&&1048576&e.flags&&(e=e.regularType),96&t.flags&&1048576&t.flags&&(t=t.regularType),e===t)return-1;var i,s,a,o,l,c,u;if(x===_r)return i=t,32768&(s=e).flags&&32768&i.flags?T(s,i,!1):(65536&s.flags&&65536&i.flags||131072&s.flags&&131072&i.flags)&&(a=_(s,i))&&(a&=_(i,s))?a:0;if(Go(e,t,x,r?S:void 0))return-1;if(128&O(e)&&1048576&e.flags){if(function e(i,s,a){if(Hd(s,32768)&&!(512&O(s))){var o=!!(33554432&i.flags);if((x===gr||x===fr)&&(uc(me,s)||!o&&Vo(s)))return!1;if(65536&s.flags){var t=b(i,s);if(t)return e(i,t,a)}for(var r=function(e){var t,r,n;if(!Nu(s,e.escapedName,o))return a&&(Jm.Debug.assert(!!d),Jm.isJsxAttributes(d)||Jm.isJsxOpeningLikeElement(d)?S(Jm.Diagnostics.Property_0_does_not_exist_on_type_1,q(e),J(s)):(t=i.symbol&&Jm.firstOrUndefined(i.symbol.declarations),(r=void 0)!==(r=e.valueDeclaration&&Jm.findAncestor(e.valueDeclaration,function(e){return e===t})&&(n=e.valueDeclaration,Jm.Debug.assertNode(n,Jm.isObjectLiteralElementLike),d=n,Jm.isIdentifier(n.name))?Uu(n.name,s):r)?S(Jm.Diagnostics.Object_literal_may_only_specify_known_properties_but_0_does_not_exist_in_type_1_Did_you_mean_to_write_2,q(e),J(s),r):S(Jm.Diagnostics.Object_literal_may_only_specify_known_properties_and_0_does_not_exist_in_type_1,q(e),J(s)))),{value:!0}},n=0,l=fs(i);n<l.length;n++){var c=l[n],c=r(c);if("object"==typeof c)return c.value}}return!1}(e,t,r))return r&&f(n,e,t),0;(e=>{if(196608&e.flags)for(var t=!1,r=0,n=e.types;r<n.length;r++){var i=n[r];if(!(6144&i.flags)){if(t)return 1;t=!0}}})(t)&&(e=kl(e))}return x===fr||196608&e.flags||65536&t.flags||g||e===me||!(0<Z(e).length||0<ee(e,0).length||0<ee(e,1).length)||!k(t)||((e,t)=>{for(var r=!!(33554432&e.flags),n=0,i=Z(e);n<i.length;n++){var s=i[n];if(Nu(t,s.escapedName,r))return 1}})(e,t)?(i=0,s=E,a=g,g=!1,65536&e.flags?i=(x===fr?v:(e,t,r)=>{for(var n=-1,e=e.types,i=0,s=e;i<s.length;i++){var a=C(s[i],t,r);if(!a)return 0;n&=a}return n})(e,t,r&&!(8190&e.flags)):(65536&t.flags?i=y(e,t,r&&!(8190&e.flags)&&!(8190&t.flags)):131072&t.flags?(g=!0,i=((e,t,r)=>{for(var n=-1,t=t.types,i=0,s=t;i<s.length;i++){var a=s[i],a=C(e,a,r);if(!a)return 0;n&=a}return n})(e,t,r)):131072&e.flags&&(i=v(e,t,!1)),!i&&(1032192&e.flags||1032192&t.flags)&&(i=T(e,t,r))&&(E=s)),g=a,!i&&r&&(32768&e.flags&&8190&t.flags?(l=t,c=J(o=e),u=J(l),(ye===o&&$===l||be===o&&dt===l||ve===o&&mt===l||ba(!1)===o&&gt===l)&&S(Jm.Diagnostics._0_is_a_primitive_but_1_is_a_wrapper_object_Prefer_using_0_when_possible,u,c)):e.symbol&&32768&e.flags&&me===e&&S(Jm.Diagnostics.The_Object_type_is_assignable_to_very_few_other_types_Did_you_mean_to_use_the_any_type_instead),f(n,e,t)),i):(r&&(o=ee(e,0),l=ee(e,1),0<o.length&&C(te(o[0]),t,!1)||0<l.length&&C(te(l[0]),t,!1)?S(Jm.Diagnostics.Value_of_type_0_has_no_properties_in_common_with_type_1_Did_you_mean_to_call_it,J(e),J(t)):S(Jm.Diagnostics.Type_0_has_no_properties_in_common_with_type_1,J(e),J(t))),0)}function _(e,t){for(var r=-1,n=0,i=e.types;n<i.length;n++){var s=y(i[n],t,!1);if(!s)return 0;r&=s}return r}function y(e,t,r){var n=t.types;if(65536&t.flags&&$a(n,e))return-1;for(var i=0,s=n;i<s.length;i++){var a=C(e,s[i],!1);if(a)return a}return r&&C(e,b(e,t)||n[n.length-1],!0),0}function b(e,t){var r,e=fs(e);if(e){var n=((e,t)=>{for(var r,n=0,i=e;n<i.length;n++){var s=i[n];if(Wl(t,s.escapedName)){if(r)return;r=s}}return r})(e,t);if(n)for(var i=Y(n),s=0,a=t.types;s<a.length;s++){var o=a[s],l=ni(o,n.escapedName);if(l&&C(i,l)){if(r)return;r=o}}}return r}function v(e,t,r){var n=e.types;if(65536&e.flags&&$a(n,t))return-1;for(var i=n.length,s=0;s<i;s++){var a=C(n[s],t,r&&s===i-1);if(a)return a}return 0}function T(e,t,r){if(m)return 0;var n=Xo(e,t,x),i=x.get(n);if(void 0!==i){if(!r||2!==i)return 1===i?-1:0;x.set(n,3)}if(o){for(var s=0;s<u;s++)if(n===o[s])return 1;if(100===p)return m=!0,0}else o=[],l=[],c=[];var i=u,a=(o[u]=n,u++,l[p]=e,c[p]=t,p++,h),e=(1&h||!tl(e,l,p)||(h|=1),2&h||!tl(t,c,p)||(h|=2),3!==h?((e,t,r)=>{var n,i=E;if(16384&t.flags){if(32&O(e)&&ps(e)===qa(t)&&!e.declaration.questionToken){var s=hs(e),a=eo(t,ds(e));if(n=C(s,a,r))return n}}else if(262144&t.flags){if(262144&e.flags&&(n=C(t.type,e.type,!1)))return n;var o=(e=>(16384&e.flags?ys:524288&e.flags?bs:vs)(e))(t.type);if(o&&(n=C(e,qa(o),r)))return n}else if(524288&t.flags){o=bs(t);if(o&&(n=C(e,o,r)))return E=i,n}if(16384&e.flags)if(32&O(t)&&ps(t)===qa(e)){a=eo(e,ds(t)),s=hs(t);if(n=C(a,s,r))return E=i,n}else{o=ys(e);if(o||!(16777216&t.flags))if((!o||1&o.flags)&&(o=N),n=C(o,t,r&&o!==N))return E=i,n}else if(524288&e.flags){if(o=bs(e)){if(n=C(o,t,r))return E=i,n}else if(524288&t.flags&&e.indexType===t.indexType&&(n=C(e.objectType,t.objectType,r)))return n}else{if(4&O(e)&&4&O(t)&&e.target===t.target&&!(67108864&e.flags||67108864&t.flags)){a=Wo(e.target);if(n=((e,t,r,n)=>{var i=e.typeArguments||Jm.emptyArray,s=t.typeArguments||Jm.emptyArray;if(i.length!==s.length&&x===_r)return 0;for(var a=(i.length<=s.length?i:s).length,o=-1,l=0;l<a;l++){var c=l<r.length?r[l]:1;if(4!==c){var u=i[l],d=s[l],p=-1;if(1===c?p=C(u,d,n):2===c?p=C(d,u,n):3===c?p=(p=C(d,u,!1))||C(u,d,n):(p=C(u,d,n))&&(p&=C(d,u,n)),!p)return 0;o&=p}}return o})(e,t,a,r))return n;if(a!==Jm.emptyArray&&!((e,t)=>{for(var r=0;r<t.length;r++)if(1===t[r]&&1024&e.typeArguments[r].flags)return 1})(t,a)){if(!r||!Jm.some(a,function(e){return 0===e}))return 0;E=i}}s=!!(8190&e.flags);if(163840&(e=x!==_r?Q(e):e).flags&&32768&t.flags){o=r&&E===i&&!s;if((e=>32&O(e)&&e.declaration.questionToken)(t)&&!ms(e)&&Vo(e)?n=-1:ms(t)?n=ms(e)?((e,t,r)=>{var n=!!e.declaration.readonlyToken,i=!!e.declaration.questionToken,s=!!t.declaration.readonlyToken,a=!!t.declaration.questionToken,n=x===_r?n==s&&i==a:x===fr||!i||a;if(n)if(s=C(ps(t),ps(e),r))return i=yo([ds(e)],[ds(t)]),s&C(U(hs(e),i),hs(t),r);return 0})(e,t,o):0:(n=((e,t,r)=>{if(x===_r){var n=t;if(!(32768&(i=e).flags&&32768&n.flags))return 0;var i=fs(i),s=fs(n);if(i.length!==s.length)return 0;for(var a=-1,o=0,l=i;o<l.length;o++){var c=l[o],u=_s(n,c.escapedName);if(!u)return 0;c=rl(c,u,C);if(!c)return 0;a&=c}return a}var d=x===mr&&!(128&O(e));if(d=Ll(e,t,d))return r&&S(Jm.Diagnostics.Property_0_is_missing_in_type_1,q(d),J(e)),0;for(var p=-1,d=fs(t),h=0,m=d;h<m.length;h++){var g=m[h];if(!(4194304&g.flags)){var f=R(e,g.escapedName);if(f&&f!==g){var _=Jm.getDeclarationModifierFlagsFromSymbol(f),y=Jm.getDeclarationModifierFlagsFromSymbol(g);if(8&_||8&y){if(256&Jm.getCheckFlags(f))return r&&S(Jm.Diagnostics.Property_0_has_conflicting_declarations_and_is_inaccessible_in_type_1,q(f),J(e)),0;if(f.valueDeclaration!==g.valueDeclaration)return r&&(8&_&&8&y?S(Jm.Diagnostics.Types_have_separate_declarations_of_a_private_property_0,q(g)):S(Jm.Diagnostics.Property_0_is_private_in_type_1_but_not_in_type_2,q(g),J(8&_?e:t),J(8&_?t:e))),0}else if(16&y){if(!((n,e)=>!Zo(e,function(e){return!!(16&Jm.getDeclarationModifierFlagsFromSymbol(e))&&(t=n,r=Qo(e),!Zo(t,function(e){e=Qo(e);return!!e&&Ei(e,r)}));var t,r}))(f,g))return r&&S(Jm.Diagnostics.Property_0_is_protected_but_type_1_is_not_a_class_derived_from_2,q(g),J(Qo(f)||e),J(Qo(g)||t)),0}else if(16&_)return r&&S(Jm.Diagnostics.Property_0_is_protected_in_type_1_but_public_in_type_2,q(g),J(e),J(t)),0;y=C(Y(f),Y(g),r);if(!y)return r&&S(Jm.Diagnostics.Types_of_property_0_are_incompatible,q(g)),0;if(p&=y,x!==fr&&16777216&f.flags&&!(16777216&g.flags))return r&&S(Jm.Diagnostics.Property_0_is_optional_in_type_1_but_required_in_type_2,q(g),J(e),J(t)),0}}}return p})(e,t,o))&&(n&=w(e,t,0,o))&&(n&=w(e,t,1,o))&&(n&=D(e,t,0,s,o))&&(n&=D(e,t,1,s,o)),n)return E=i,n}}return 0})(e,t,r):1);if(h=a,p--,e){if(-1===e||0===p){for(s=i;s<u;s++)x.set(o[s],1);u=i}}else x.set(n,r?3:2),u=i;return e}function k(e){var t;return 32768&e.flags?0===(t=gs(e)).callSignatures.length&&0===t.constructSignatures.length&&!t.stringIndexInfo&&!t.numberIndexInfo&&0<t.properties.length&&Jm.every(t.properties,function(e){return!!(16777216&e.flags)}):!!(131072&e.flags)&&Jm.every(e.types,k)}function w(e,t,r,n){if(x===_r){var i=t,s=r,a=ee(e,s),o=ee(i,s);if(a.length!==o.length)return 0;for(var l=-1,c=0;c<a.length;c++){var u=nl(a[c],o[c],!1,!1,!1,C);if(!u)return 0;l&=u}return l}if(t===kt||e===kt)return-1;var d=ee(e,r),p=ee(t,r);if(1===r&&d.length&&p.length){if(el(e)&&!el(t))return n&&S(Jm.Diagnostics.Cannot_assign_an_abstract_constructor_type_to_a_non_abstract_constructor_type),0;if(!((e,t,r)=>!e.declaration||!t.declaration||(e=Jm.getSelectedModifierFlags(e.declaration,24),8===(t=Jm.getSelectedModifierFlags(t.declaration,24)))||16===t&&8!==e||16!==t&&!e||void(r&&S(Jm.Diagnostics.Cannot_assign_a_0_constructor_type_to_a_1_constructor_type,Kn(e),Kn(t))))(d[0],p[0],n))return 0}var h=-1,m=E;if(64&O(e)&&64&O(t)&&e.symbol===t.symbol)for(var g=0;g<p.length;g++){if(!(y=I(d[g],p[g],!0,n)))return 0;h&=y}else if(1===d.length&&1===p.length)i=x===fr||M.noStrictGenericChecks,h=I(d[0],p[0],i,n);else e:for(var f=0,_=p;f<_.length;f++){for(var y,b=_[f],v=n,T=0,k=d;T<k.length;T++){if(y=I(k[T],b,!0,v)){h&=y,E=m;continue e}v=!1}return v&&S(Jm.Diagnostics.Type_0_provides_no_match_for_the_signature_1,J(e),Hn(b,void 0,void 0,r)),0}return h}function I(e,t,r,n){return Bo(r?zs(e):e,r?zs(t):t,0,!1,n,S,C)}function A(e,t,r){e=C(e.type,t.type,r);return!e&&r&&S(Jm.Diagnostics.Index_signatures_are_incompatible),e}function D(e,t,r,n,i){var s,a,o;return x===_r?(a=e,o=L(o=t,s=r),(a=L(a,s))||o?a&&o&&a.isReadonly===o.isReadonly?C(a.type,o.type):0:-1):!(s=L(t,r))||1&s.type.flags&&!n?-1:(a=L(e,r)||1===r&&L(e,0))?A(a,s,i):ms(e)?0===r&&C(hs(e),s.type,i):vl(e)?(o=-1,(o=0===r&&(t=L(e,1))?A(t,s,i):o)&&(o&=((e,t,r,n)=>{for(var i=-1,s=0,a=fs(e);s<a.length;s++){var o=a[s];if(0===r||uu(o.escapedName)){var l=C(Y(o),t,n);if(!l)return n&&S(Jm.Diagnostics.Property_0_is_incompatible_with_index_signature,q(o)),0;i&=l}}return i})(e,s.type,r,i)),o):(i&&S(Jm.Diagnostics.Index_signature_is_missing_in_type_0,J(e)),0)}}function zo(e,t,r){e=na(e,Jm.map(e.typeParameters,function(e){return e===t?r:e}));return e.flags|=67108864,e}function Wo(e){if(!oe)return Jm.emptyArray;var t=e.typeParameters||Jm.emptyArray;if(!(r=e.variances)){if(e===fe||e===_e)r=[1];else{e.variances=Jm.emptyArray;for(var r=[],n=0,i=t;n<i.length;n++){var s=i[n],a=zo(e,s,Ct),o=zo(e,s,wt),o=(x(o,a)?1:0)|(x(a,o)?2:0);3===o&&x(zo(e,s,It),a)&&(o=4),r.push(o)}}e.variances=r}return r}function qo(e){return 16384&e.flags&&!Qs(e)}function Jo(e){return 4&O(e)&&Jm.some(e.typeArguments,function(e){return qo(e)||Jo(e)})}function Yo(e,t,r){void 0===r&&(r=0);for(var n=""+e.target.id,i=0,s=e.typeArguments;i<s.length;i++){var a,o=s[i];qo(o)?((a=Jm.indexOf(t,o))<0&&(a=t.length,t.push(o)),n+="="+a):r<4&&Jo(o)?n+="<"+Yo(o,t,r+1)+">":n+="-"+o.id}return n}function Xo(e,t,r){return r===_r&&e.id>t.id&&(r=e,e=t,t=r),Jo(e)&&Jo(t)?Yo(e,r=[])+","+Yo(t,r):e.id+","+t.id}function Zo(e,t){if(!(6&Jm.getCheckFlags(e)))return t(e);for(var r=0,n=e.containingType.types;r<n.length;r++){var i=R(n[r],e.escapedName),i=i&&Zo(i,t);if(i)return i}}function Qo(e){return e.parent&&32&e.parent.flags?X(kn(e)):void 0}function el(e){if(16&O(e)){e=e.symbol;if(e&&32&e.flags){e=kh(e);if(e&&Jm.hasModifier(e,128))return 1}}}function tl(e,t,r){if(5<=r&&32768&e.flags){var n=e.symbol;if(n)for(var i=0,s=0;s<r;s++){var a=t[s];if(32768&a.flags&&a.symbol===n&&5<=++i)return 1}}}function rl(e,t,r){if(e===t)return-1;var n=24&Jm.getDeclarationModifierFlagsFromSymbol(e);if(n!=(24&Jm.getDeclarationModifierFlagsFromSymbol(t)))return 0;if(n){if(Th(e)!==Th(t))return 0}else if((16777216&e.flags)!=(16777216&t.flags))return 0;return Bd(e)!==Bd(t)?0:r(Y(e),Y(t))}function nl(e,t,r,n,i,s){if(e===t)return-1;if(o=t,r=r,((a=e).parameters.length!==o.parameters.length||a.minArgumentCount!==o.minArgumentCount||a.hasRestParameter!==o.hasRestParameter)&&(u=a.hasRestParameter?1:0,l=o.hasRestParameter?1:0,!(r&&a.minArgumentCount<=o.minArgumentCount&&(l<u||u==l&&a.parameters.length>=o.parameters.length))))return 0;var a,o,l;if(Jm.length(e.typeParameters)!==Jm.length(t.typeParameters))return 0;e=zs(e),t=zs(t);var c=-1;if(!n){r=Hs(e);if(r){var u=Hs(t);if(u){if(!(d=s(r,u)))return 0;c&=d}}}for(var d,p=t.parameters.length,h=0;h<p;h++){if(!(d=s(il(e,h)?Gs(e):Sd(e.parameters[h]),il(t,h)?Gs(t):Sd(t.parameters[h]))))return 0;c&=d}return i||(c&=s(te(e),te(t))),c}function il(e,t){return e.hasRestParameter&&t>=e.parameters.length-1}function sl(e){return(e=>{for(var t=0,r=e;t<r.length;t++){var n=r[t],i=dl(n),s=s||i;if(i===n||i!==s)return}return 1})(e)?P(e):Jm.reduceLeft(e,function(e,t){return Ro(e,t)?t:e})}function al(e){return 4&O(e)&&e.target===fe}function ol(e){return 4&O(e)&&(e.target===fe||e.target===_e)||!(6144&e.flags)&&x(e,Se)}function ll(e){return!!R(e,"0")}function cl(e){return!!(6368&e.flags)}function ul(e){return!!(8&e.flags)||(65536&e.flags?!!(256&e.flags)||!Jm.forEach(e.types,function(e){return!cl(e)}):cl(e))}function dl(e){return 256&e.flags?Vi(e):32&e.flags?$:64&e.flags?dt:128&e.flags?mt:65536&e.flags?P(Jm.sameMap(e.types,dl)):e}function pl(e){return 256&e.flags?Vi(e):32&e.flags&&1048576&e.flags?$:64&e.flags&&1048576&e.flags?dt:128&e.flags?mt:65536&e.flags?P(Jm.sameMap(e.types,pl)):e}function hl(e){return 4&O(e)&&8&e.target.objectFlags}function ml(e){for(var t=0,r=0,n=e;r<n.length;r++)t|=gl(n[r]);return t}function gl(e){return 65536&e.flags?ml(e.types):32&e.flags?""===e.value?32:0:64&e.flags?0===e.value?64:0:128&e.flags?e===ht?128:0:7406&e.flags}function fl(e){return 7392&gl(e)?pc(e,function(e){return!(7392&gl(e))}):e}function _l(e){return 2&e.flags?Ut:4&e.flags?Vt:8&e.flags||e===ht?ht:7168&e.flags||32&e.flags&&""===e.value||64&e.flags&&0===e.value?e:_t}function yl(e,t){t=t&~e.flags&6144;return 0==t?e:P(2048==t?[e,ot]:4096==t?[e,ct]:[e,ot,ct])}function bl(e){return F?Xl(e,524288):e}function vl(e){return e.symbol&&0!=(6656&e.symbol.flags)&&0===ee(e,0).length&&0===ee(e,1).length}function Tl(e,t){var r=Mr(e.flags,e.escapedName);return r.declarations=e.declarations,r.parent=e.parent,r.type=t,(r.target=e).valueDeclaration&&(r.valueDeclaration=e.valueDeclaration),r}function kl(e){var t,r;return 128&O(e)&&1048576&e.flags?e.regularType||(r=((e,t)=>{for(var r=Jm.createSymbolTable(),n=0,i=fs(e);n<i.length;n++){var s=i[n],a=Y(s),o=t(a);r.set(s.escapedName,o===a?s:Tl(s,o))}return r})(t=e,kl),(r=Nn(t.symbol,r,t.callSignatures,t.constructSignatures,t.stringIndexInfo,t.numberIndexInfo)).flags=-1048577&t.flags,r.objectFlags|=128,e.regularType=r):e}function xl(e){for(var t,r,n,i=Jm.createSymbolTable(),s=0,a=fs(e);s<a.length;s++){var o=a[s];i.set(o.escapedName,4&o.flags?(n=r=void 0,r=Y(t=o),(n=Sl(r))===r?t:Tl(t,n)):o)}var l=L(e,0),c=L(e,1);return Nn(e.symbol,i,Jm.emptyArray,Jm.emptyArray,l&&Xs(Sl(l.type),l.isReadonly),c&&Xs(Sl(c.type),c.isReadonly))}function El(e){return 6144&e.flags?e:Sl(e)}function Sl(e){if(6291456&e.flags){if(6144&e.flags)return C;if(128&O(e))return xl(e);if(65536&e.flags)return P(Jm.sameMap(e.types,El));if(al(e)||hl(e))return na(e.target,Jm.sameMap(e.typeArguments,Sl))}return e}function Cl(e,t){var r,n=J(Sl(t));switch(e.kind){case 149:case 148:r=Jm.Diagnostics.Member_0_implicitly_has_an_1_type;break;case 146:r=e.dotDotDotToken?Jm.Diagnostics.Rest_parameter_0_implicitly_has_an_any_type:Jm.Diagnostics.Parameter_0_implicitly_has_an_1_type;break;case 176:r=Jm.Diagnostics.Binding_element_0_implicitly_has_an_1_type;break;case 228:case 151:case 150:case 153:case 154:case 186:case 187:if(!e.name)return void z(e,Jm.Diagnostics.Function_expression_which_lacks_return_type_annotation_implicitly_has_an_0_return_type,n);r=Jm.Diagnostics._0_which_lacks_return_type_annotation_implicitly_has_an_1_return_type;break;default:r=Jm.Diagnostics.Variable_0_implicitly_has_an_1_type}z(e,r,Jm.declarationNameToString(Jm.getNameOfDeclaration(e)),n)}function wl(e,t){G&&_&&2097152&t.flags&&!function e(t){var r=!1;if(65536&t.flags)for(var n=0,i=t.types;n<i.length;n++)e(c=i[n])&&(r=!0);if(al(t)||hl(t))for(var s=0,a=t.typeArguments;s<a.length;s++)e(c=a[s])&&(r=!0);if(128&O(t))for(var o=0,l=fs(t);o<l.length;o++){var c,u=l[o];2097152&(c=Y(u)).flags&&(e(c)||z(u.valueDeclaration,Jm.Diagnostics.Object_literal_s_property_0_implicitly_has_an_1_type,Jm.symbolName(u),J(Sl(c))),r=!0)}return r}(t)&&Cl(e,t)}function Il(e,t,r){for(var n=e.parameters.length,i=t.parameters.length,s=e.hasRestParameter&&t.hasRestParameter?Math.max(n,i):e.hasRestParameter?i:t.hasRestParameter?n:Math.min(n,i),a=0;a<s;a++)r(Cd(e,a),Cd(t,a))}function Al(e,t,r,n){var i=n?Jm.map(n,Nl):Jm.map(e.typeParameters,Dl),s=function(e){for(var t=0;t<i.length;t++)if(e===i[t].typeParameter)return i[t].isFixed=!0,Bl(s,t);return e};return s.signature=e,s.inferences=i,s.flags=t,s.compareTypes=r||Oo,s}function Dl(e){return{typeParameter:e,candidates:void 0,inferredType:void 0,priority:void 0,topLevel:!0,isFixed:!1}}function Nl(e){return{typeParameter:e.typeParameter,candidates:e.candidates&&e.candidates.slice(),inferredType:e.inferredType,priority:e.priority,topLevel:e.topLevel,isFixed:e.isFixed}}function Ol(e){var t=O(e);return!!(802816&e.flags||4&t&&Jm.forEach(e.typeArguments,Ol)||16&t&&e.symbol&&10288&e.symbol.flags||32&t||196608&e.flags&&(e=>(void 0===e.couldContainTypeVariables&&(e.couldContainTypeVariables=Jm.forEach(e.types,Ol)),e.couldContainTypeVariables))(e))}function Rl(e,t){return e===t||196608&e.flags&&Jm.forEach(e.types,function(e){return Rl(e,t)})}function Ll(e,t,r){for(var n=0,i=fs(t);n<i.length;n++){var s=i[n];if(r||!(16777216&s.flags))if(!R(e,s.escapedName))return s}}function Pl(i,e,T,k){var x,E;function S(e,t){if(Ol(t))if(e.aliasSymbol&&e.aliasTypeArguments&&e.aliasSymbol===t.aliasSymbol)for(var r=e.aliasTypeArguments,n=t.aliasTypeArguments,i=0;i<r.length;i++)S(r[i],n[i]);else{if(65536&e.flags&&65536&t.flags&&!(256&e.flags&&256&t.flags)||131072&e.flags&&131072&t.flags){if(e===t){for(var s=0,a=e.types;s<a.length;s++)S(h=a[s],h);return}for(var o,l=void 0,c=0,u=e.types;c<u.length;c++)Ml(h=u[c],t.types)?((l=l||[]).push(h),S(h,h)):96&h.flags&&Ml(o=dl(h),t.types)&&(l=l||[]).push(h,o);l&&(e=Fl(e,l),t=Fl(t,l))}if(540672&t.flags)8388608&e.flags||e===yt||!(m=w(t))||m.isFixed||(!m.candidates||k<m.priority?(m.candidates=[e],m.priority=k):k===m.priority&&m.candidates.push(e),8&k)||!(16384&t.flags)||Rl(T,t)||(m.topLevel=!1);else if(4&O(e)&&4&O(t)&&e.target===t.target)for(var r=e.typeArguments||Jm.emptyArray,n=t.typeArguments||Jm.emptyArray,d=(r.length<n.length?r:n).length,p=Wo(e.target),i=0;i<d;i++)(i<p.length&&2===p[i]?C:S)(r[i],n[i]);else if(262144&e.flags&&262144&t.flags)S(e.type,t.type);else if(524288&e.flags&&524288&t.flags)S(e.objectType,t.objectType),S(e.indexType,t.indexType);else if(196608&t.flags){for(var h,m,g=0,f=void 0,_=0,y=n=t.types;_<y.length;_++)w(h=y[_])?(f=h,g++):S(e,h);1===g&&(m=k,k|=2,S(e,f),k=m)}else if(65536&e.flags)for(var b=0,v=r=e.types;b<v.length;b++)S(v[b],t);else 163840&(e=Q(e)).flags&&(m=e.id+","+t.id,E&&E.get(m)||((E=E||Jm.createMap()).set(m,!0),(m=32768&t.flags&&!(16&O(t)&&t.symbol&&32&t.symbol.flags)?t.symbol:void 0)?Jm.contains(x,m)||((x=x||[]).push(m),I(e,t),x.pop()):I(e,t)))}}function C(e,t){oe?(k^=1,S(e,t),k^=1):S(e,t)}function w(e){if(540672&e.flags)for(var t=0,r=i;t<r.length;t++){var n=r[t];if(e===n.typeParameter)return n}}function I(e,t){if(ms(e)&&ms(t)&&(S(ps(e),ps(t)),S(hs(e),hs(t))),32&O(t)){var r=ps(t);if(262144&r.flags)return void((u=w(r.type))&&!u.isFixed&&(i=((e,t)=>{var r=Z(e),e=L(e,0);if(0!==r.length||e){for(var n=Dl(eo(ps(t).type,ds(t))),i=[n],s=hs(t),a=!t.declaration.readonlyToken,o=t.declaration.questionToken?0:16777216,l=Jm.createSymbolTable(),c=0,u=r;c<u.length;c++){var d=u[c],p=m(Y(d));if(!p)return;var h=Mr(4|d.flags&o,d.escapedName);h.checkFlags=a&&Bd(d)?8:0,h.declarations=d.declarations,h.type=p,l.set(d.escapedName,h)}if(e){t=m(e.type);if(!t)return;e=Xs(t,a&&e.isReadonly)}return Nn(void 0,l,Jm.emptyArray,Jm.emptyArray,e,void 0)}function m(e){return n.candidates=void 0,Pl(i,e,s),n.candidates&&P(n.candidates,!0)}})(e,t))&&(d=k,k|=4,S(i,u.typeParameter),k=d));if(16384&r.flags)return S(qa(e),r),void S(P(Jm.map(Z(e),Y)),hs(t))}if(!Ll(e,t,!1)||!Ll(t,e,!1)){for(var n=e,i=fs(i=t),s=0,a=i;s<a.length;s++){var o=a[s],l=R(n,o.escapedName);l&&S(Y(l),Y(o))}p(e,t,0),p(e,t,1);var c,u=e,d=t,r=Ns(d,0);r&&(c=Ns(u,0)||Os(u,0))&&S(c,r),(r=Ns(d,1))&&(c=Ns(u,1)||Ns(u,0)||Os(u,1))&&S(c,r)}}function p(e,t,r){for(var n,i,s=ee(e,r),a=ee(t,r),o=s.length,l=a.length,c=o<l?o:l,u=0;u<c;u++)n=zs(s[o-c+u]),i=zs(a[l-c+u]),Il(n,i,C),n.typePredicate&&i.typePredicate&&n.typePredicate.kind===i.typePredicate.kind?S(n.typePredicate.type,i.typePredicate.type):S(te(n),te(i))}void 0===k&&(k=0),S(e,T)}function Ml(e,t){for(var r=0,n=t;r<n.length;r++)if(Do(n[r],e))return 1}function Fl(e,t){for(var r=[],n=0,i=e.types;n<i.length;n++){var s=i[n];Ml(s,t)||r.push(s)}return(65536&e.flags?P:za)(r)}function Bl(e,t){var r,n,i,s,a,o=e.inferences[t],l=o.inferredType;return!l&&(l=o.candidates?(i=e.signature,a=o.topLevel&&!((a=ys(a=o.typeParameter))&&Hd(a,270334))&&(o.isFixed||!Rl(te(i),o.typeParameter))?Jm.sameMap(o.candidates,pl):o.candidates,Sl(1&o.priority?Jm.reduceLeft(a,function(e,t){return Ro(t,e)?t:e}):1&e.flags||8&o.priority?P(a,!0):(i=a,F?(s=Jm.filter(i,function(e){return!(6144&e.flags)})).length?yl(sl(s),6144&ml(i)):P(i,!0):sl(i)))):2&e.flags?yt:(s=Es(o.typeParameter))?U(s,bo((r=e.signature.typeParameters,n=t,function(e){return Jm.indexOf(r,e)>=n?N:e}),e)):$l(!!(4&e.flags)),o.inferredType=l,i=ys(e.signature.typeParameters[t]))&&(t=U(i,e),e.compareTypes(l,Zi(t,l))||(o.inferredType=l=t)),l}function $l(e){return e?C:N}function Ul(e){for(var t=[],r=0;r<e.inferences.length;r++)t.push(Bl(e,r));return t}function Vl(e){var t=b(e);return t.resolvedSymbol||(t.resolvedSymbol=!Jm.nodeIsMissing(e)&&Kr(e,e.escapedText,1156031,Jm.Diagnostics.Cannot_find_name_0,e,!Jm.isWriteOnlyAccess(e),Jm.Diagnostics.Cannot_find_name_0_Did_you_mean_1)||B),t.resolvedSymbol}function Hl(e){return!!Jm.findAncestor(e,function(e){return 162===e.kind||71!==e.kind&&143!==e.kind&&"quit"})}function Gl(e){if(174!==e.parent.kind)return""+e.parent.elements.indexOf(e);var t=e.propertyName||e.name;switch(t.kind){case 71:return Jm.idText(t);case 144:return Jm.isStringOrNumericLiteral(t.expression)?t.expression.text:void 0;case 9:case 8:return t.text;default:Jm.Debug.fail("Unexpected name kind for binding element name")}}function jl(e,t){switch(e.kind){case 71:return 71===t.kind&&Vl(e)===Vl(t)||(226===t.kind||176===t.kind)&&xn(Vl(e))===W(t);case 99:return 99===t.kind;case 97:return 97===t.kind;case 179:return 179===t.kind&&e.name.escapedText===t.name.escapedText&&jl(e.expression,t.expression);case 176:if(179!==t.kind)return!1;var r,n=t;if(n.name.escapedText!==Gl(e))return!1;if(176===e.parent.parent.kind&&jl(e.parent.parent,n.expression))return!0;if(226===e.parent.parent.kind)return(r=e.parent.parent.initializer)&&jl(r,n.expression)}return!1}function Kl(e,t){for(;179===e.kind;)if(jl(e=e.expression,t))return!0;return!1}function zl(e,t){return 179===t.kind&&Kl(e,t.expression)&&Wl(function e(t){if(71===t.kind)return Y(Vl(t));{var r;if(179===t.kind)return(r=e(t.expression))&&ni(r,t.name.escapedText)}return}(t.expression),t.name.escapedText)}function Wl(e,t){if(e&&65536&e.flags){e=Cs(e,t);if(e&&2&Jm.getCheckFlags(e))return void 0===e.isDiscriminantProperty&&(e.isDiscriminantProperty=32&e.checkFlags&&ul(Y(e))),e.isDiscriminantProperty}return!1}function ql(e,t){return jl(e,t)||Kl(e,t)}function Jl(e,s){if(e!==s){if(8192&s.flags)return s;var t=pc(e,function(e){var t=s,r=e;if(!(65536&t.flags))return x(t,r);for(var n=0,i=t.types;n<i.length;n++)if(x(i[n],r))return!0;return!1});if(!(8192&t.flags))return t}return e}function Yl(e){var t,r=e.flags;if(2&r)return F?4079361:4194049;if(32&r)return t=""===e.value,F?t?3030785:1982209:t?3145473:4194049;if(20&r)return F?4079234:4193922;if(64&r)return t=0===e.value,F?t?3030658:1982082:t?3145346:4193922;if(8&r)return F?4078980:4193668;if(136&r)return F?e===ht?3030404:1981828:e===ht?3145092:4193668;if(32768&r)return(n=gs(t=e)).callSignatures.length||n.constructSignatures.length||n.members.get("bind")&&Ro(t,ge)?F?6164448:8376288:F?6166480:8378320;if(3072&r)return 2457472;if(4096&r)return 2340752;if(512&r)return F?1981320:4193160;if(16777216&r)return F?6166480:8378320;if(540672&r)return Yl(vs(e)||N);if(196608&r){for(var n=e.types,i=0,s=0,a=n;s<a.length;s++)i|=Yl(a[s]);return i}return 8388607}function Xl(e,t){var r,n;return 524288&e.flags?(n=pc(r=vs(e)||N,function(e){return 0!=(Yl(e)&t)}))!==r?n:e:pc(e,function(e){return 0!=(Yl(e)&t)})}function Zl(e,t){return t?(t=op(t),P([Xl(e,131072),t])):e}function Ql(e,t){t=Jm.getTextOfPropertyName(t);return ni(e,t)||uu(t)&&Ns(e,1)||Ns(e,0)||K}function ec(e,t){return ll(e)&&ni(e,""+t)||oh(e,void 0,!1,!1)||K}function tc(e){return Pa(oh(e,void 0,!1,!1)||K)}function rc(e){return 194===e.parent.kind&&e.parent.left===e||216===e.parent.kind&&e.parent.initializer===e}function nc(e){return Ql(ic(e.parent),e.name)}function ic(e){var t,r,n=e.parent;switch(n.kind){case 215:return $;case 216:return ah(n.expression,n.awaitModifier)||K;case 194:return 177===(r=n).parent.kind&&rc(r.parent)||261===r.parent.kind&&rc(r.parent.parent)?Zl(ic(r),r.right):op(r.right);case 188:return ot;case 177:return r=e,ec(ic(t=n),Jm.indexOf(t.elements,r));case 198:return tc(ic(n.parent));case 261:return nc(n);case 262:return Zl(nc(t=n),t.objectAssignmentInitializer)}return K}function sc(e){var t;return e.initializer?b(t=e.initializer).resolvedType||op(t):215===e.parent.parent.kind?$:216===e.parent.parent.kind&&ah(e.parent.parent.expression,e.parent.parent.awaitModifier)||K}function ac(e){return 226===e.kind?sc(e):(t=(e=e).parent,r=ac(t.parent),Zl(174===t.kind?Ql(r,e.propertyName||e.name):e.dotDotDotToken?tc(r):ec(r,Jm.indexOf(t.elements,e)),e.initializer));var t,r}function oc(e){return(226===e.kind||176===e.kind?ac:ic)(e)}function lc(e){switch(e.kind){case 185:return lc(e.expression);case 194:switch(e.operatorToken.kind){case 58:return lc(e.left);case 26:return lc(e.right)}}return e}function cc(e){var t=b(e);if(!t.switchTypes){t.switchTypes=[];for(var r=0,n=e.caseBlock.clauses;r<n.length;r++){var i=n[r],i=257===(i=i).kind?cl(i=po(op(i.expression)))?i:void 0:_t;if(void 0===i)return t.switchTypes=Jm.emptyArray;t.switchTypes.push(i)}}return t.switchTypes}function uc(e,t){return e===t||65536&t.flags&&((e,t)=>{if(65536&e.flags){for(var r=0,n=e.types;r<n.length;r++){var i=n[r];if(!$a(t.types,i))return!1}return!0}return!!(256&e.flags&&Vi(e)===t)||$a(t.types,e)})(e,t)}function dc(e,t){return 65536&e.flags?Jm.forEach(e.types,t):t(e)}function pc(e,t){var r,n;return 65536&e.flags?(r=e.types,(n=Jm.filter(r,t))===r?e:ja(n)):t(e)?e:_t}function hc(e,t){if(!(65536&e.flags))return t(e);for(var r,n,i=0,s=e.types;i<s.length;i++){var a=t(s[i]);a&&(r?n?n.push(a):n=[r,a]:r=a)}return n?P(n):r}function mc(e,t){return pc(e,function(e){return 0!=(e.flags&t)})}function gc(e,t){return uc($,e)&&Hd(t,32)||uc(dt,e)&&Hd(t,64)?hc(e,function(e){return 2&e.flags?mc(t,34):4&e.flags?mc(t,68):e}):e}function fc(e){return 0===e.flags}function _c(e){return 0===e.flags?e.type:e}function yc(e,t){return t?{flags:0,type:e}:e}function bc(e){return it[e.id]||(it[e.id]=(e=e,(t=wn(256)).elementType=e,t));var t}function vc(e,t){var r,n,t=dl((r=(t=t).contextualType,t.contextualType=C,n=op(t),t.contextualType=r,n));return uc(t,e.elementType)?e:bc(P([e.elementType,t]))}function Tc(e){return e.finalArrayType||(e.finalArrayType=8192&(e=e.elementType).flags?Ee:Pa(65536&e.flags?P(e.types,!0):e))}function kc(e){return 256&O(e)?Tc(e):e}function xc(e){return 256&O(e)?e.elementType:_t}function Ec(e,t){return(e=>{for(var t=!1,r=0,n=e;r<n.length;r++){var i=n[r];if(!(8192&i.flags)){if(!(256&O(i)))return;t=!0}}return t})(e)?bc(P(Jm.map(e,xc))):P(Jm.sameMap(e,kc),t)}function Sc(e){var e=function e(t){var r=t.parent;return 185===r.kind||194===r.kind&&58===r.operatorToken.kind&&r.left===t||194===r.kind&&26===r.operatorToken.kind&&r.right===t?e(r):t}(e),t=e.parent,r=179===t.kind&&("length"===t.name.escapedText||181===t.parent.kind&&Jm.isPushOrUnshiftIdentifier(t.name)),e=180===t.kind&&t.expression===e&&194===t.parent.kind&&58===t.parent.operatorToken.kind&&t.parent.left===t&&!Jm.isAssignmentTarget(t.parent)&&Gd(op(t.argumentExpression),84);return r||e}function Cc(e){var t=b(e);return void 0===t.maybeTypePredicate&&(t.maybeTypePredicate=(e=>{if(97!==e.expression.kind){e=Pu(e.expression);if(e!==yt){var e=Q(e);if(e!==K)return e=ee(e,0),!!Jm.forEach(e,function(e){return e.typePredicate})}}return!1})(e)),t.maybeTypePredicate}function wc(p,h,l,o,e){void 0===l&&(l=h);var d,c,u=0;return $t?K:!p.flowNode||!(e||17810175&h.flags)||(c=Bt,e=_c(m(p.flowNode)),Bt=c,e=256&O(e)&&Sc(p)?xe:kc(e),203===p.parent.kind&&8192&Xl(e,524288).flags)?h:e;function m(e){if(2500===u)return $t=!0,t=p,r=Jm.findAncestor(t,Jm.isFunctionOrModuleBlock),t=Jm.getSourceFileOfNode(t),r=Jm.getSpanOfTokenAtPosition(t,r.statements.pos),sr.add(Jm.createFileDiagnostic(t,r.start,r.length,Jm.Diagnostics.The_containing_function_or_module_body_is_too_large_for_control_flow_analysis)),K;var t,r;for(u++;;){var n=e.flags;if(1024&n)for(var i=c;i<Bt;i++)if(er[i]===e)return u--,tr[i];var s=void 0;if(4096&n)e.locked=!0,s=m(e.antecedent),e.locked=!1;else{if(2048&n){e=e.antecedent;continue}if(16&n){if(!(s=(e=>{var t=e.node;return jl(p,t)?2===Jm.getAssignmentTargetKind(t)?yc(dl(_c(e=m(e.antecedent))),fc(e)):h===at||h===Ee?(e=>226===e.kind&&e.initializer&&ci(e.initializer)||176!==e.kind&&194===e.parent.kind&&ci(e.parent.right))(t)?bc(_t):x(e=dl(oc(t)),h)?e:xe:65536&h.flags?Jl(h,oc(t)):h:Kl(p,t)?h:void 0})(e))){e=e.antecedent;continue}}else if(96&n)s=(e=>{var t,r,n=m(e.antecedent);return 8192&(r=_c(n)).flags||(t=0!=(32&e.flags),r=kc(r),(e=k(r,e.expression,t))===r)?n:yc((t=fc(n))&&8192&e.flags?yt:e,t)})(e);else if(128&n)s=(t=>{var e=m(t.antecedent),r=_c(e),n=t.switchStatement.expression;return jl(p,n)?r=v(r,t.switchStatement,t.clauseStart,t.clauseEnd):g(n,r)&&(r=f(r,n,function(e){return v(e,t.switchStatement,t.clauseStart,t.clauseEnd)})),yc(r,fc(e))})(e);else if(12&n){if(1===e.antecedents.length){e=e.antecedents[0];continue}s=(4&n?e=>{for(var t=[],r=!1,n=!1,i=0,s=e.antecedents;i<s.length;i++){var a=s[i];if(!(2048&a.flags&&a.lock.locked)){var a=m(a),o=_c(a);if(o===h&&h===l)return o;Jm.pushIfUnique(t,o),uc(o,h)||(r=!0),fc(a)&&(n=!0)}}return yc(Ec(t,r),n)}:e=>{var t=(e=>(e.id||(e.id=Zm,Zm++),e.id))(e),r=Yt[t]||(Yt[t]=Jm.createMap());if(!d&&!(d=function e(t){var r,n;return 71===t.kind?(n=Vl(t))!==B?(Nc(t)?"@":"")+eg(n):void 0:99===t.kind?"0":179===t.kind?(r=e(t.expression))&&r+"."+Jm.idText(t.name):176===t.kind?(r=176===(n=t.parent.parent).kind?e(n):n.initializer&&e(n.initializer),n=Gl(t),r&&n&&r+"."+n):void 0}(p)))return h;if(t=r.get(d))return t;for(var n=Mt;n<Ft;n++)if(Xt[n]===e&&Zt[n]===d&&Qt[n].length)return yc(Ec(Qt[n],!1),!0);var i,s=[],a=!1;Xt[Ft]=e,Zt[Ft]=d,Qt[Ft]=s;for(var o=0,l=e.antecedents;o<l.length;o++){var c=l[o],c=(Ft++,m(c)),c=(Ft--,i=i||c,_c(c)),u=r.get(d);if(u)return u;if(Jm.pushIfUnique(s,c),uc(c,h)||(a=!0),c===h)break}return t=Ec(s,a),fc(i)?yc(t,!0):(r.set(d,t),t)})(e)}else if(256&n){if(!(s=(e=>{if(h===at||h===Ee){var t=e.node,r=(181===t.kind?t.expression:t.left).expression;if(jl(p,lc(r))){r=m(e.antecedent),e=_c(r);if(256&O(e)){var n=e;if(181===t.kind)for(var i=0,s=t.arguments;i<s.length;i++){var a=s[i];n=vc(n,a)}else Gd(op(t.left.argumentExpression),84)&&(n=vc(n,t.right));return n===e?r:yc(n,fc(r))}return r}}})(e))){e=e.antecedent;continue}}else if(2&n){var a=e.container;if(a&&a!==o&&179!==p.kind&&99!==p.kind){e=a.flowNode;continue}s=l}else s=Qp(h)}return 1024&n&&(er[Bt]=e,tr[Bt]=s,Bt++),u--,s}}function g(e,t){return 179===e.kind&&65536&t.flags&&jl(p,e.expression)&&Wl(t,e.name.escapedText)}function f(e,t,r){var n=t.name.escapedText,t=ni(e,n),i=t&&r(t);return t===i?e:pc(e,function(e){return Po(ni(e,n),i)})}function _(e,t,r){return jl(p,t)?Xl(e,r?1048576:2097152):g(t,h)?f(e,t,function(e){return Xl(e,r?1048576:2097152)}):zl(p,t)?h:e}function n(e,t,r){switch(t.operatorToken.kind){case 58:return _(e,t.left,r);case 32:case 33:case 34:case 35:var n=t.operatorToken.kind,i=lc(t.left),s=lc(t.right);if(189===i.kind&&9===s.kind)return b(e,i,n,s,r);if(189===s.kind&&9===i.kind)return b(e,s,n,i,r);if(jl(p,i))return y(e,n,s,r);if(jl(p,s))return y(e,n,i,r);if(g(i,h))return f(e,i,function(e){return y(e,n,s,r)});if(g(s,h))return f(e,s,function(e){return y(e,n,i,r)});if(zl(p,i)||zl(p,s))return h;break;case 93:var a=e,o=t,l=r,c=lc(o.left);if(jl(p,c)){o=op(o.right);if(Ro(o,ge)){var u,d=R(o,"prototype");if(!d||D(d=Y(d))||(u=d),!D(a)||u!==me&&u!==ge)if(u||(d=void 0,2&O(o)?d=Xi(o).declaredConstructSignatures:16&O(o)&&(d=ee(o,1)),d&&d.length&&(u=P(Jm.map(d,function(e){return te(zs(e))})))),u)return T(a,u,l,Lo)}}else if(Kl(p,c))return h;return a;case 26:return k(e,t.right,r)}return e}function y(e,t,r,n){if(1&e.flags)return e;33!==t&&35!==t||(n=!n);var i,s=op(r);return 6144&s.flags?F?Xl(e,32===t||33===t?n?65536:524288:95===r.kind?n?32768:262144:n?16384:131072):e:16810497&e.flags?e:n?8192&(t=pc(e,function(e){return Po(e=e,t=s)||Po(t,e);var t})).flags?e:gc(t,s):cl(s)?(i=po(s),pc(e,function(e){return po(e)!==i})):e}function b(e,t,r,n,i){t=lc(t.expression);if(!jl(p,t))return Kl(p,t)?h:e;if((i=33!==r&&35!==r?i:!i)&&!(65536&e.flags)){t=lr.get(n.text);if(t){if(Ro(t,e))return t;if(540672&e.flags)if(Ro(t,vs(e)||C))return za([e,t])}}return Xl(e,i?ar.get(n.text)||64:or.get(n.text)||8192)}function v(e,t,r,n){var i,s=cc(t);return s.length?(t=s.slice(r,n),r=r===n||Jm.contains(t,_t),n=8192&(i=P(t)).flags?_t:gc(pc(e,function(e){return Po(i,e)}),i),r?(t=pc(e,function(e){return!(cl(e)&&Jm.contains(s,po(e)))}),8192&n.flags?t:P([n,t])):n):e}function T(e,t,r,n){if(!r)return pc(e,function(e){return!n(e,t)});if(65536&e.flags){r=pc(e,function(e){return n(e,t)});if(!(8192&r.flags))return r}return Ro(t,e)?t:x(e,t)?e:x(t,e)?t:za([e,t])}function i(e,t,r){if(((e,t)=>{if(e.arguments)for(var r=0,n=e.arguments;r<n.length;r++)if(ql(t,n[r]))return 1;return!(179!==e.expression.kind||!ql(t,e.expression.expression))})(t,p)&&Cc(t)){var n=_d(t),i=n.typePredicate;if(i&&(!D(e)||i.type!==me&&i.type!==ge))if(Jm.isIdentifierTypePredicate(i)){n=t.arguments[i.parameterIndex-(n.thisParameter?1:0)];if(n){if(jl(p,n))return T(e,i.type,r,Ro);if(Kl(p,n))return h}}else{n=Jm.skipParentheses(t.expression);if(180===n.kind||179===n.kind){t=Jm.skipParentheses(n.expression);if(jl(p,t))return T(e,i.type,r,Ro);if(Kl(p,t))return h}}}return e}function k(e,t,r){switch(t.kind){case 71:case 99:case 97:case 179:return _(e,t,r);case 181:return i(e,t,r);case 185:return k(e,t.expression,r);case 194:return n(e,t,r);case 192:if(51===t.operator)return k(e,t.operand,!r)}return e}}function Ic(e){return Jm.findAncestor(e.parent,function(e){return Jm.isFunctionLike(e)&&!Jm.getImmediatelyInvokedFunctionExpression(e)||234===e.kind||265===e.kind||149===e.kind})}function Ac(e){var t=Jm.getRootDeclaration(e.valueDeclaration).parent,r=b(t);return 4194304&r.flags||(r.flags|=4194304,Jm.findAncestor(t.parent,function(e){return Jm.isFunctionLike(e)&&!!(4194304&b(e).flags)}))||Dc(t),e.isAssigned}function Dc(e){var t;71===e.kind?Jm.isAssignmentTarget(e)&&(t=Vl(e)).valueDeclaration&&146===Jm.getRootDeclaration(t.valueDeclaration).kind&&(t.isAssigned=!0):Jm.forEachChild(e,Dc)}function Nc(e){var t=e.parent;return 179===t.kind||181===t.kind&&t.expression===e||180===t.kind&&t.expression===e}function Oc(e){return 540672&e.flags&&Hd(vs(e)||N,6144)}function Rc(e,t){e=Y(e);return Nc(t)&&dc(e,Oc)?hc(Sl(e),Q):e}function Lc(e){var t=Vl(e);if(t===B)return K;if(t===Xe)return i=Jm.getContainingFunction(e),j<2&&(187===i.kind?z(e,Jm.Diagnostics.The_arguments_object_cannot_be_referenced_in_an_arrow_function_in_ES3_and_ES5_Consider_using_a_standard_function_expression):Jm.hasModifier(i,256)&&z(e,Jm.Diagnostics.The_arguments_object_cannot_be_referenced_in_an_async_function_or_method_in_ES3_and_ES5_Consider_using_a_standard_function_or_method)),b(i).flags|=8192,Y(t);!tn(t,107455)||Hl(e)||om(nn(t))||an(t);var r=xn(t),n=r.valueDeclaration;if(32&r.flags)if(229===n.kind&&Jm.nodeIsDecorated(n))for(var i=Jm.getContainingClass(e);void 0!==i;){if(i===n&&i.name!==e){b(n).flags|=8388608,b(e).flags|=16777216;break}i=Jm.getContainingClass(i)}else if(199===n.kind)for(i=Jm.getThisContainer(e,!1);void 0!==i;){if(i.parent===n){149===i.kind&&Jm.hasModifier(i,32)&&(b(n).flags|=8388608,b(e).flags|=16777216);break}i=Jm.getThisContainer(i,!1)}Jp(e,e),Kp(e,e),zp(e,e);var s=e,a=t;if(!(2<=j||0==(34&a.flags)||260===a.valueDeclaration.parent.kind)){for(var o=Jm.getEnclosingBlockScopeContainer(a.valueDeclaration),l=((e,t)=>!!Jm.findAncestor(e,function(e){return e===t?"quit":Jm.isFunctionLike(e)}))(s.parent,o),c=o,u=!1;c&&!Jm.nodeStartsNewLexicalEnvironment(c);){if(Jm.isIterationStatement(c,!1)){u=!0;break}c=c.parent}u&&(l&&(b(c).flags|=65536),214===o.kind&&Jm.getAncestor(a.valueDeclaration,227).parent===o&&((e,t)=>{for(var r,n=e;185===n.parent.kind;)n=n.parent;return e=!1,Jm.isAssignmentTarget(n)?e=!0:192!==n.parent.kind&&193!==n.parent.kind||(r=n.parent,e=43===r.operator||44===r.operator),e&&!!Jm.findAncestor(n,function(e){return e===t?"quit":e===t.statement})})(s,o)&&(b(a.valueDeclaration).flags|=2097152),b(a.valueDeclaration).flags|=262144),l&&(b(a.valueDeclaration).flags|=131072)}s=Rc(r,e),o=Jm.getAssignmentTargetKind(e);if(o){if(!(3&r.flags))return z(e,Jm.Diagnostics.Cannot_assign_to_0_because_it_is_not_a_variable,q(t)),K;if(Bd(r))return z(e,Jm.Diagnostics.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,q(t)),K}l=2097152&r.flags;if(3&r.flags){if(1===o)return s}else{if(!l)return s;n=Jm.find(t.declarations,ng)}if(!n)return s;for(var d,p=146===Jm.getRootDeclaration(n).kind,h=Ic(n),m=Ic(e),a=m!==h;m!==h&&(186===m.kind||187===m.kind||Jm.isObjectLiteralOrClassExpressionMethod(m))&&(3&(d=r).flags&&0!=(2&Ou(d))&&Y(d)!==Ee||p&&!Ac(r));)m=Ic(m);var g,a=p||l||a||s!==at&&s!==Ee&&(!F||0!=(1&s.flags)||Hl(e)||246===e.parent.kind)||203===e.parent.kind||Jm.isInAmbientContext(n),f=wc(e,s,a?p?(g=s,f=Jm.getRootDeclaration(n),F&&146===f.kind&&f.initializer&&2048&gl(g)&&!(2048&gl(V(f.initializer)))?Xl(g,131072):g):s:s===at||s===Ee?ot:yl(s,2048),m,!a);if(s===at||s===Ee){if(f===at||f===Ee)return _&&(z(Jm.getNameOfDeclaration(n),Jm.Diagnostics.Variable_0_implicitly_has_type_1_in_some_locations_where_its_type_cannot_be_determined,q(t),J(f)),z(e,Jm.Diagnostics.Variable_0_implicitly_has_an_1_type,q(t),J(f))),Qp(f)}else if(!a&&!(2048&gl(s))&&2048&gl(f))return z(e,Jm.Diagnostics.Variable_0_is_used_before_being_assigned,q(t)),s;return o?dl(f):f}function Pc(e,t){b(e).flags|=2,149===t.kind||152===t.kind?b(t.parent).flags|=4:b(t).flags|=4}function Mc(e){return Jm.isSuperCall(e)?e:Jm.isFunctionLike(e)?void 0:Jm.forEachChild(e,Mc)}function Fc(e){var t=b(e);return void 0===t.hasSuperCall&&(t.superCall=Mc(e.body),t.hasSuperCall=!!t.superCall),t.superCall}function Bc(e){return Pi(X(W(e)))===ut}function $c(e,t,r){var n=t.parent;Jm.getClassExtendsHeritageClauseElement(n)&&!Bc(n)&&(!(n=Fc(t))||n.end>e.pos)&&z(e,r)}function Uc(e){var t,r=Jm.getThisContainer(e,!0),n=!1;switch(152===r.kind&&$c(e,r,Jm.Diagnostics.super_must_be_called_before_accessing_this_in_the_constructor_of_a_derived_class),187===r.kind&&(r=Jm.getThisContainer(r,!1),n=j<2),r.kind){case 233:z(e,Jm.Diagnostics.this_cannot_be_referenced_in_a_module_or_namespace_body);break;case 232:z(e,Jm.Diagnostics.this_cannot_be_referenced_in_current_location);break;case 152:Vc(e,r)&&z(e,Jm.Diagnostics.this_cannot_be_referenced_in_constructor_arguments);break;case 149:case 148:Jm.hasModifier(r,32)&&z(e,Jm.Diagnostics.this_cannot_be_referenced_in_a_static_property_initializer);break;case 144:z(e,Jm.Diagnostics.this_cannot_be_referenced_in_a_computed_property_name)}if(n&&Pc(e,r),Jm.isFunctionLike(r)&&(!zc(e)||Jm.getThisParameter(r))){if(186===r.kind&&194===r.parent.kind&&3===Jm.getSpecialPropertyAssignmentKind(r.parent)){var n=V(r.parent.left.expression.expression).symbol;if(n&&n.members&&16&n.flags)return bd(n)}n=yi(r)||jc(r);if(n)return n}if(Jm.isClassLike(r.parent))return n=W(r.parent),wc(e,t=Jm.hasModifier(r,32)?Y(n):X(n).thisType);if(Jm.isInJavaScriptFile(e)&&((t=(e=>{if((e=Jm.getJSDocType(e))&&273===e.kind)if(0<e.parameters.length&&e.parameters[0].name&&"this"===e.parameters[0].name.escapedText)return re(e.parameters[0].type)})(r))&&t!==K))return t;return g&&z(e,Jm.Diagnostics.this_implicitly_has_type_any_because_it_does_not_have_a_type_annotation),C}function Vc(e,t){return Jm.findAncestor(e,function(e){return e===t?"quit":146===e.kind})}function Hc(e){var t=181===e.parent.kind&&e.parent.expression===e,r=Jm.getSuperContainer(e,!0),n=!1;if(!t)for(;r&&187===r.kind;)r=Jm.getSuperContainer(r,!0),n=j<2;var i,s,a,o=0;return(e=>{if(e){if(t)return 152===e.kind;if(Jm.isClassLike(e.parent)||178===e.parent.kind)return Jm.hasModifier(e,32)?151===e.kind||150===e.kind||153===e.kind||154===e.kind:151===e.kind||150===e.kind||153===e.kind||154===e.kind||149===e.kind||148===e.kind||152===e.kind}return!1})(r)?(t||152!==r.kind||$c(e,r,Jm.Diagnostics.super_must_be_called_before_accessing_a_property_of_super_in_the_constructor_of_a_derived_class),o=Jm.hasModifier(r,32)||t?512:256,b(e).flags|=o,151===r.kind&&Jm.hasModifier(r,256)&&(Jm.isSuperProperty(e.parent)&&Jm.isAssignmentTarget(e.parent)?b(r).flags|=4096:b(r).flags|=2048),n&&Pc(e.parent,r),178===r.parent.kind?j<2?(z(e,Jm.Diagnostics.super_is_only_allowed_in_members_of_object_literal_expressions_when_option_target_is_ES2015_or_higher),K):C:(a=(s=X(W(i=r.parent)))&&Mi(s)[0])?152===r.kind&&Vc(e,r)?(z(e,Jm.Diagnostics.super_cannot_be_referenced_in_constructor_arguments),K):512===o?Pi(s):Zi(a,s.thisType):(Jm.getClassExtendsHeritageClauseElement(i)||z(e,Jm.Diagnostics.super_can_only_be_referenced_in_a_derived_class),K)):((o=Jm.findAncestor(e,function(e){return e===r?"quit":144===e.kind}))&&144===o.kind?z(e,Jm.Diagnostics.super_cannot_be_referenced_in_a_computed_property_name):t?z(e,Jm.Diagnostics.Super_calls_are_not_permitted_outside_constructors_or_in_nested_functions_inside_constructors):r&&r.parent&&(Jm.isClassLike(r.parent)||178===r.parent.kind)?z(e,Jm.Diagnostics.super_property_access_is_permitted_only_in_a_constructor_member_function_or_member_accessor_of_a_derived_class):z(e,Jm.Diagnostics.super_can_only_be_referenced_in_members_of_derived_classes_or_object_literal_expressions),K)}function Gc(e){return 4&O(e)&&e.target===ke?e.typeArguments[0]:void 0}function jc(e){if(187!==e.kind){if(Io(e)){var t=au(e);if(t){t=t.thisParameter;if(t)return Y(t)}}t=Jm.isInJavaScriptFile(e);if(g||t){var r=151!==(n=e).kind&&153!==n.kind&&154!==n.kind||178!==n.parent.kind?186===n.kind&&261===n.parent.kind?n.parent.parent:void 0:n.parent;if(r){for(var n=Qc(r),i=r,s=n;s;){var a=hc(s,function(e){return 131072&e.flags?Jm.forEach(e.types,Gc):Gc(e)});if(a)return U(a,tu(r));if(261!==i.parent.kind)break;s=Qc(i=i.parent.parent)}return n?bl(n):tp(r)}n=e.parent;if(194===n.kind&&58===n.operatorToken.kind){e=n.left;if(179===e.kind||180===e.kind){e=e.expression;if(t&&Jm.isIdentifier(e)){t=Jm.getSourceFileOfNode(n);if(t.commonJsModuleIndicator&&Vl(e)===t.symbol)return}return tp(e)}}}}}function Kc(e){var t=e.parent;if(Io(t)){var r=Jm.getImmediatelyInvokedFunctionExpression(t);if(r&&r.arguments){var n=Jm.indexOf(t.parameters,e);if(e.dotDotDotToken){for(var i=[],s=n;s<r.arguments.length;s++)i.push(pl(V(r.arguments[s])));return i.length?Pa(P(i)):void 0}var a=b(r),o=a.resolvedSignature,l=(a.resolvedSignature=At,n<r.arguments.length?pl(V(r.arguments[n])):e.initializer?void 0:lt);return a.resolvedSignature=o,l}a=au(t);if(a){o=Jm.hasRestParameter(t),l=t.parameters.length-(o?1:0),n=Jm.indexOf(t.parameters,e);if(void 0===Jm.getThisParameter(t)||a.thisParameter||(Jm.Debug.assert(0!==n),--n),n<l)return Cd(a,n);if(o&&n===t.parameters.length-1&&il(a,t.parameters.length-1))return Y(Jm.lastOrUndefined(a.parameters))}}}function zc(e){for(;e.parent&&!Jm.isFunctionLike(e.parent);){if(146===e.parent.kind&&e.parent.initializer===e)return 1;e=e.parent}}function Wc(e){var t;return 152===e.kind||Jm.getEffectiveReturnTypeNode(e)||hh(e)?te(Us(e)):!(e=iu(e))||!(t=e).resolvedReturnType&&0<=ei(t,3)?void 0:te(e)}function qc(e,t){var r=nd(e),r=Jm.indexOf(r,t);if(0<=r)return Cd(b(e).resolvedSignature===Nt?Nt:_d(e),r)}function Jc(e,t){return hc(e,function(e){e=229376&e.flags?R(e,t):void 0;return e?Y(e):void 0})}function Yc(e,t){return hc(e,function(e){return Ds(e,t)})}function Xc(e){var t=Qc(e.parent);if(t){if(!Jm.hasDynamicName(e)){var r=Jc(t,W(e).escapedName);if(r)return r}return cu(e.name)&&Yc(t,1)||Yc(t,0)}}function Zc(e,t){return e&&(Jc(e,""+t)||Yc(e,1)||lh(e,void 0,!1,!1,!1))}function Qc(e){e=eu(e);return e&&Q(e)}function eu(e){if(!Vh(e)){if(e.contextualType)return e.contextualType;var t=e.parent;switch(t.kind){case 226:case 146:case 149:case 148:case 176:var r=e,n=r.parent;if(r===n.initializer){r=Jm.getEffectiveTypeAnnotationNode(n);if(r)return re(r);if(146===n.kind){r=Kc(n);if(r)return r}if(Jm.isBindingPattern(n.name))return hi(n.name,!0,!1);if(Jm.isBindingPattern(n.parent)){r=n.parent.parent,n=n.propertyName||n.name;if(176!==r.kind){r=Jm.getEffectiveTypeAnnotationNode(r);if(r&&!Jm.isBindingPattern(n)){n=Jm.getTextOfPropertyName(n);if(n)return ni(re(r),n)}}}}return;case 187:case 219:return r=e,!(r=Jm.getContainingFunction(r))||1&(n=Jm.getFunctionFlags(r))?void 0:(r=Wc(r),2&n?r&&Sp(r):r);case 197:var i=t;if(a=Jm.getContainingFunction(i)){var s=Jm.getFunctionFlags(a),a=Wc(a);if(a)return i.asteriskToken?a:dh(a,0!=(2&s))}return;case 181:case 182:return qc(t,e);case 184:case 202:return re(t.type);case 194:var i=e,o=i.parent,a=o.operatorToken.kind;if(Jm.isAssignmentOperator(a)){if(i===o.right){switch(Jm.getSpecialPropertyAssignmentKind(o)){case 0:break;case 5:if(!o.left.symbol)break;case 1:case 2:case 3:case 4:return}return op(o.left)}}else{if(54===a)return(s=eu(o))||i!==o.right?s:op(o.left,!0);if((53===a||26===a)&&i===o.right)return eu(o)}return;case 261:case 262:return Xc(t);case 263:return Qc(t.parent);case 177:var l=t;return Zc(Qc(l),Jm.indexOfNode(l.elements,e));case 195:return c=(l=e).parent,l===c.whenTrue||l===c.whenFalse?eu(c):void 0;case 205:Jm.Debug.assert(196===t.parent.kind);var c=t.parent,u=e;return 183===c.parent.kind?qc(c.parent,u):void 0;case 185:u=Jm.isInJavaScriptFile(t)?Jm.getJSDocTypeTag(t):void 0;return u?re(u.typeExpression.type):eu(t);case 256:var d=t,p=eu(Jm.isJsxAttributeLike(d.parent)?d.parent.parent:d.parent.openingElement.attributes);return p&&!D(p)?Jm.isJsxAttribute(d.parent)?Jc(p,d.parent.name.escapedText):249===d.parent.kind?(d=ku())&&""!==d?Jc(p,d):C:p:void 0;case 253:case 255:return p=eu((d=t).parent),Jm.isJsxAttribute(d)?p&&!D(p)?Jc(p,d.name.escapedText):void 0:p;case 251:case 250:return wu(t)}}}function tu(e){return(e=Jm.findAncestor(e,function(e){return!!e.contextualMapper}))?e.contextualMapper:T}function ru(e,t){e=Is(e,0);if(1===e.length){e=e[0];if(!((e,t)=>{for(var r=0;r<t.parameters.length;r++){var n=t.parameters[r];if(n.initializer||n.questionToken||n.dotDotDotToken||Ls(n))break}return t.parameters.length&&Jm.parameterIsThisKeyword(t.parameters[0])&&r--,(e.hasRestParameter?Number.MAX_VALUE:e.parameters.length)<r})(e,t))return e}}function nu(e){return 186===e.kind||187===e.kind}function iu(e){return nu(e)||Jm.isObjectLiteralMethod(e)?au(e):void 0}function su(e){return(Jm.isObjectLiteralMethod(e)?e=>{if(Jm.Debug.assert(Jm.isObjectLiteralMethod(e)),!Vh(e))return Xc(e)}:Qc)(e)}function au(e){Jm.Debug.assert(151!==e.kind||Jm.isObjectLiteralMethod(e));var t=su(e);if(t){if(!(65536&t.flags))return ru(t,e);for(var r,n,i=0,s=t.types;i<s.length;i++){var a=ru(s[i],e);if(a)if(r){if(!nl(r[0],a,!1,!0,!0,No))return;r.push(a)}else r=[a]}return r&&((n=ts(r[0])).resolvedReturnType=void 0,n.unionSignatures=r),n}}function ou(e){return 176===e.kind&&!!e.initializer||194===e.kind&&58===e.operatorToken.kind}function lu(e,t){for(var r=e.elements,n=!1,i=[],s=Jm.isAssignmentTarget(e),a=Qc(e),o=0;o<r.length;o++){var l,c,u=r[o];s&&198===u.kind?(l=Ns(l=V(u.expression,t),1)||lh(l,void 0,!1,!1,!1))&&i.push(l):(c=sp(u,t,Zc(a,o)),i.push(c)),n=n||198===u.kind}if(!n){if(s&&i.length)return(c=ia(Fa(i))).pattern=e,c;var d=Qc(e);if(d&&(65536&(e=d).flags?Jm.forEach(e.types,ll):ll(e))){e=d.pattern;if(e&&(175===e.kind||177===e.kind))for(var p=e.elements,h=i.length;h<p.length;h++){var m=p[h];ou(m)?i.push(d.typeArguments[h]):(200!==m.kind&&z(m,Jm.Diagnostics.Initializer_provides_no_value_for_this_binding_element_and_the_binding_element_has_no_default_value),i.push(K))}if(i.length)return Fa(i)}}return Pa(i.length?P(i,!0):F?_t:lt)}function cu(e){switch(e.kind){case 144:return Gd(du(e),84);case 71:return uu(e.escapedText);case 8:case 9:return uu(e.text);default:return!1}}function uu(e){return(+e).toString()===e}function du(e){var t=b(e.expression);return t.resolvedType||(t.resolvedType=V(e.expression),6144&t.resolvedType.flags||!Gd(t.resolvedType,262774)&&!x(t.resolvedType,P([$,dt,gt]))?z(e,Jm.Diagnostics.A_computed_property_name_must_be_of_type_string_number_symbol_or_any):Ku(e.expression,t.resolvedType,!0)),t.resolvedType}function pu(e,t,r,n){for(var i=[],s=0;s<r.length;s++)0!==n&&!cu(e[s+t].name)||i.push(Y(r[s]));return Xs(i.length?P(i,!0):ot,!1)}function hu(r,e){for(var t,n=Jm.isAssignmentTarget(r),i=(((e,t)=>{for(var r=Jm.createUnderscoreEscapedMap(),n=0,i=e.properties;n<i.length;n++){var s=i[n];if(263!==s.kind){var a=s.name;if(144===a.kind&&Mm(a),262===s.kind&&!t&&s.objectAssignmentInitializer)return H(s.equalsToken,Jm.Diagnostics.can_only_be_used_in_an_object_literal_property_inside_a_destructuring_assignment);if(s.modifiers)for(var o=0,l=s.modifiers;o<l.length;o++){var c=l[o];120===c.kind&&151===s.kind||H(c,Jm.Diagnostics._0_modifier_cannot_be_used_here,Jm.getTextOfNode(c))}var u=void 0,d=(261===s.kind||262===s.kind?(Bm(s.questionToken,Jm.Diagnostics.An_object_member_cannot_be_declared_optional),8===a.kind&&qm(a),u=1):151===s.kind?u=1:153===s.kind?u=2:154===s.kind?u=4:Jm.Debug.assertNever(s,"Unexpected syntax kind:"+s.kind),Jm.getPropertyNameForPropertyNameNode(a));if(void 0!==d){var p=r.get(d);if(p)if(1===u&&1===p)H(a,Jm.Diagnostics.Duplicate_identifier_0,Jm.getTextOfNode(a));else{if(!(6&u&&6&p))return H(a,Jm.Diagnostics.An_object_literal_cannot_have_property_and_accessor_with_the_same_name);if(6===p||u===p)return H(a,Jm.Diagnostics.An_object_literal_cannot_have_multiple_get_Slashset_accessors_with_the_same_name);r.set(d,u|p)}else r.set(d,u)}}}})(r,n),Jm.createSymbolTable()),s=[],a=N,o=0,l=Qc(r),c=l&&l.pattern&&(174===l.pattern.kind||178===l.pattern.kind),u=!l&&Jm.isInJavaScriptFile(r),d=0,p=!1,h=!1,m=!1,g=Jm.isInJavaScriptFile(r),f=0,_=0;_<r.properties.length;_++){var y=r.properties[_],b=y.symbol,v=void 0;if(261===y.kind||262===y.kind||Jm.isObjectLiteralMethod(y)){var T,k,x=void 0,E=(g&&(x=li(y)),void 0),S=(E=261===y.kind?(144===y.name.kind&&224&(T=du(y.name)).flags&&(v=Jm.escapeLeadingUnderscores(""+T.value)),((e,t)=>(144===e.name.kind&&du(e.name),sp(e.initializer,t)))(y,e)):151===y.kind?(T=e,t=void 0,Hm(k=y),144===k.name.kind&&du(k.name),t=Md(k,T),ap(k,t,T)):(Jm.Debug.assert(262===y.kind),sp(y.name,e)),x&&(Mo(E,x,y),E=x),d|=E.flags,Mr(4|b.flags,v||b.escapedName));n?((261===y.kind&&ou(y.initializer)||262===y.kind&&y.objectAssignmentInitializer)&&(S.flags|=16777216),!v&&Jm.hasDynamicName(y)&&(p=!0)):!c||512&O(l)||((k=R(l,b.escapedName))?S.flags|=16777216&k.flags:M.suppressExcessPropertyErrors||L(l,0)||z(y.name,Jm.Diagnostics.Object_literal_may_only_specify_known_properties_and_0_does_not_exist_in_type_1,q(b),J(l))),S.declarations=b.declarations,S.parent=b.parent,b.valueDeclaration&&(S.valueDeclaration=b.valueDeclaration),S.type=E,S.target=b,b=S}else{if(263===y.kind){if(j<2&&Sm(y,2),0<s.length&&(a=ao(a,I(),r.symbol,o),s=[],i=Jm.createSymbolTable(),m=h=!1,d=0),!mu(E=V(y.expression)))return z(y,Jm.Diagnostics.Spread_types_may_only_be_created_from_object_types),K;a=ao(a,E,r.symbol,o),f=_+1;continue}Jm.Debug.assert(153===y.kind||154===y.kind),Mh(y)}!v&&Jm.hasDynamicName(y)?cu(y.name)?m=!0:h=!0:i.set(b.escapedName,b),s.push(b)}if(c)for(var C=0,w=Z(l);C<w.length;C++){S=w[C];i.get(S.escapedName)||(16777216&S.flags||z(S.valueDeclaration||S.bindingElement,Jm.Diagnostics.Initializer_provides_no_value_for_this_binding_element_and_the_binding_element_has_no_default_value),i.set(S.escapedName,S),s.push(S))}return a!==N?0<s.length?ao(a,I(),r.symbol,o):a:I();function I(){var e=u?Lt:h?pu(r.properties,f,s,0):void 0,t=m&&!u?pu(r.properties,f,s,1):void 0,e=Nn(r.symbol,i,Jm.emptyArray,Jm.emptyArray,e,t),t=M.suppressExcessPropertyErrors?0:1048576;return e.flags|=4194304|t|14680064&d,e.objectFlags|=128,p&&(e.objectFlags|=512),n&&(e.pattern=r),6144&e.flags||(o|=14680064&e.flags),e}}function mu(e){return 16777217&e.flags||7392&gl(e)&&mu(fl(e))||32768&e.flags&&!ms(e)||196608&e.flags&&!Jm.forEach(e.types,function(e){return!mu(e)})}function gu(e){return!Jm.stringContains(e,"-")}function fu(e){switch(e.kind){case 179:case 99:return!1;case 71:return Jm.isIntrinsicJsxName(e.escapedText);default:Jm.Debug.fail()}}function _u(e,t,r){for(var n,i=e.attributes,s=Jm.createSymbolTable(),a=N,o=[],l=!1,c=!1,u=ku(),d=0,p=i.properties;d<p.length;d++){var h,m,g=p[d],f=g.symbol;Jm.isJsxAttribute(g)?(m=g.initializer?V(g.initializer,r):pt,(h=Mr(33554436|f.flags,f.escapedName)).declarations=f.declarations,h.parent=f.parent,f.valueDeclaration&&(h.valueDeclaration=f.valueDeclaration),h.type=m,h.target=f,s.set(h.escapedName,h),o.push(h),g.name.escapedText===u&&(c=!0)):(Jm.Debug.assert(255===g.kind),0<o.length&&(a=ao(a,S(i.symbol,s),e.symbol,0),o=[],s=Jm.createSymbolTable()),D(m=V(g.expression))&&(l=!0),mu(m)?a=ao(a,m,e.symbol,0):n=n?za([n,m]):m)}if(!l){a!==N&&(o=Z(a=0<o.length?ao(a,S(i.symbol,s),e.symbol,0):a));for(var s=Jm.createSymbolTable(),_=0,y=o;_<y.length;_++){var b=y[_];t&&!t(b)||s.set(b.escapedName,b)}}var v=249===e.parent.kind?e.parent:void 0;if(v&&v.openingElement===e&&0<v.children.length){for(var T=[],k=0,x=v.children;k<x.length;k++){var E=x[k];10===E.kind?E.containsOnlyWhiteSpaces||T.push($):T.push(V(E,r))}!l&&u&&""!==u&&(c&&z(i,Jm.Diagnostics._0_are_specified_twice_The_attribute_named_0_will_be_overwritten,Jm.unescapeLeadingUnderscores(u)),(v=Mr(33554436,u)).type=1===T.length?T[0]:Pa(P(T,!1)),s.set(u,v))}return l?C:(v=S(i.symbol,s),n&&s.size?za([n,v]):n||v);function S(e,t){e=Nn(e,t,Jm.emptyArray,Jm.emptyArray,void 0,void 0);return e.flags|=37748736,e.objectFlags|=128,e}}function yu(e){var t=pr.get(e);return void 0===t&&pr.set(e,t=Aa(hr.JSX,e)||K),t}function bu(e){var t=b(e);if(t.resolvedSymbol)return t.resolvedSymbol;var r,n=yu(hr.IntrinsicElements);if(n===K)return _&&z(e,Jm.Diagnostics.JSX_element_implicitly_has_type_any_because_no_interface_JSX_0_exists,Jm.unescapeLeadingUnderscores(hr.IntrinsicElements)),t.resolvedSymbol=B;if(Jm.isIdentifier(e.tagName))return(r=R(n,e.tagName.escapedText))?(t.jsxFlags|=1,t.resolvedSymbol=r):Ns(n,0)?(t.jsxFlags|=2,t.resolvedSymbol=n.symbol):(z(e,Jm.Diagnostics.Property_0_does_not_exist_on_type_1,Jm.idText(e.tagName),"JSX."+hr.IntrinsicElements),t.resolvedSymbol=B);throw Jm.Debug.fail()}function vu(e){var t=_a(hr.JSX,1920,void 0),t=t&&Gr(t.exports,e,793064),r=t&&X(t),r=r&&Z(r);if(r){if(0===r.length)return"";if(1===r.length)return r[0].escapedName;1<r.length&&z(t.declarations[0],Jm.Diagnostics.The_global_type_JSX_0_may_not_have_more_than_one_property,Jm.unescapeLeadingUnderscores(e))}}function Tu(){return ur||(ur=!0,ze=vu(hr.ElementAttributesPropertyNameContainer)),ze}function ku(){return dr||(dr=!0,We=vu(hr.ElementChildrenAttributeNameContainer)),We}function xu(e){if(e){if(131072&e.flags){for(var t=[],r=0,n=e.types;r<n.length;r++){var i=n[r];t.push(Q(i))}return za(t)}return Q(e)}}function Eu(t,r,e,n){if(65536&(e=void 0===e?V(t.tagName):e).flags)return P(e.types.map(function(e){return Eu(t,r,e,n)}),!0);if(2&e.flags)return C;if(32&e.flags){var i=yu(hr.IntrinsicElements);if(i!==K){var s=e.value,a=R(i,Jm.escapeLeadingUnderscores(s));if(a)return Y(a);a=Ns(i,0);if(a)return a;z(t,Jm.Diagnostics.Property_0_does_not_exist_on_type_1,s,"JSX."+hr.IntrinsicElements)}return C}var o,i=((e,t)=>{if(Jm.Debug.assert(!(65536&t.flags)),D(t))return C;var r=ee(t,1);if(0===r.length&&0===(r=ee(t,0)).length)return z(e.tagName,Jm.Diagnostics.JSX_element_type_0_does_not_have_any_construct_or_call_signatures,Jm.getTextOfNode(e.tagName)),K;for(var n=[],i=0,s=r;i<s.length;i++){var a,o,l=s[i];l.typeParameters?(a=Jm.isInJavaScriptFile(e),o=$s(void 0,l.typeParameters,0,a),n.push(js(l,o,a))):n.push(l)}return P(Jm.map(n,te),!0)})(t,e),a=(r?(e,t,r,n)=>{if(Jm.Debug.assert(!(65536&t.flags)),!n||!x(r,n)){var i=Au();if(i){for(var r=[],s=(md(e,t,r),void 0),a=void 0,o=0,l=r;o<l.length;o++){var c=l[o],u=te(c),d=xu(u&&(0===c.parameters.length?N:Y(c.parameters[0])));if(u&&x(u,i)){for(var p=!0,h=0,m=e.attributes.properties;h<m.length;h++){var g=m[h];if(Jm.isJsxAttribute(g)&&gu(g.name.escapedText)&&!R(d,g.name.escapedText)){p=!1;break}}p&&(s=ss(s,d)),a=ss(a,d)}}s=s||a,n=yu(hr.IntrinsicAttributes);return s=n!==K?ss(n,s):s}}}:(e,t,r,n)=>{if(Jm.Debug.assert(!(65536&t.flags)),!n||!x(r,n)){r=Au();if(r){n=md(e,t,void 0);if(n!==Dt){e=n&&te(n),t=xu(t=e&&(0===n.parameters.length?N:Y(n.parameters[0])));if(e&&x(e,r))return(n=yu(hr.IntrinsicAttributes))!==K?ss(n,t):t}}}})(t,e,i,n);return a||(n&&Ko(i,n,gr,t,Jm.Diagnostics.JSX_element_type_0_is_not_a_constructor_function_for_JSX_elements),D(i)?i:void 0===(s=Tu())?C:""===s?i:(e=ni(i,s))?D(e)||e===K?e:(a=e,(s=yu(hr.IntrinsicClassAttributes))!==K&&((o=Ii(s.symbol))?1===o.length&&(a=ss(na(s,[i]),a)):a=ss(e,s)),(o=yu(hr.IntrinsicAttributes))!==K?ss(o,a):a):N)}function Su(e){Jm.Debug.assert(fu(e.tagName));var t=b(e);return t.resolvedJsxElementAttributesType||(e=bu(e),1&t.jsxFlags?t.resolvedJsxElementAttributesType=Y(e):2&t.jsxFlags?t.resolvedJsxElementAttributesType=Zs(e,0).type:t.resolvedJsxElementAttributesType=K)}function Cu(e,t){var r,n=b(e),i=t?"resolvedJsxElementAllAttributesType":"resolvedJsxElementAttributesType";return n[i]||(r=(()=>$e=$e||Aa(hr.JSX,hr.ElementClass))(),n[i]=Eu(e,t,void 0,r))}function wu(e){return fu(e.tagName)?Su(e):Cu(e,!1)}function Iu(){return Ue=Ue||Aa(hr.JSX,hr.Element)}function Au(){var e;return Ve||(e=Iu())&&(Ve=P([e,ct])),Ve}function Du(e){(e=>{for(var t=Jm.createUnderscoreEscapedMap(),r=0,n=e.attributes.properties;r<n.length;r++){var i=n[r];if(255!==i.kind){var s=i.name;if(t.get(s.escapedText))return H(s,Jm.Diagnostics.JSX_elements_cannot_have_multiple_attributes_with_the_same_name);t.set(s.escapedText,!0);s=i.initializer;if(s&&256===s.kind&&!s.expression)return H(i.initializer,Jm.Diagnostics.JSX_attributes_must_only_be_assigned_a_non_empty_expression)}}})(e),t=e,0===(M.jsx||0)&&z(t,Jm.Diagnostics.Cannot_use_JSX_unless_the_jsx_flag_is_provided),void 0===Iu()&&_&&z(t,Jm.Diagnostics.JSX_element_implicitly_has_type_any_because_the_global_type_JSX_Element_does_not_exist);var t=sr&&2===M.jsx?Jm.Diagnostics.Cannot_find_name_0:void 0,r=Pr(),t=Kr(e.tagName,r,107455,t,r,!0),r=(t&&(t.isReferenced=!0,2097152&t.flags)&&!om(nn(t))&&an(t),e),n=fu(r.tagName)?Su(r):Cu(r,!1),t=_u(r,function(e){return gu(e.escapedName)||!!R(n,e.escapedName)});if(n===N&&(D(t)||0<t.properties.length))z(r,Jm.Diagnostics.JSX_element_class_does_not_support_attributes_because_it_does_not_have_a_0_property,Jm.unescapeLeadingUnderscores(Tu()));else if(Mo(t,n,0<r.attributes.properties.length?r.attributes:r)&&!D(t)&&!D(n))for(var i=0,s=r.attributes.properties;i<s.length;i++){var a=s[i];if(Jm.isJsxAttribute(a)&&!Nu(n,a.name.escapedText,!0)){z(a,Jm.Diagnostics.Property_0_does_not_exist_on_type_1,Jm.idText(a.name),J(n));break}}}function Nu(e,t,r){if(32768&e.flags){var n=gs(e);if(n.stringIndexInfo||n.numberIndexInfo&&uu(t)||_s(e,t)||r&&!gu(t))return!0}else if(196608&e.flags)for(var i=0,s=e.types;i<s.length;i++)if(Nu(s[i],t,r))return!0;return!1}function Ou(e){return e.valueDeclaration?Jm.getCombinedNodeFlags(e.valueDeclaration):0}function Ru(e){return 8192&e.flags||4&Jm.getCheckFlags(e)}function Lu(e,t,r,n){var i=Jm.getDeclarationModifierFlagsFromSymbol(n),s=179===e.kind||226===e.kind?e.name:e.right;if(256&Jm.getCheckFlags(n))return z(s,Jm.Diagnostics.Property_0_has_conflicting_declarations_and_is_inaccessible_in_type_1,q(n),J(r)),!1;if(97===t.kind){if(j<2)if(Zo(n,function(e){e=(e=e).valueDeclaration?e.valueDeclaration.kind:149;return 151!==e&&150!==e}))return z(s,Jm.Diagnostics.Only_public_and_protected_methods_of_the_base_class_are_accessible_via_the_super_keyword),!1;if(128&i)return z(s,Jm.Diagnostics.Abstract_method_0_in_class_1_cannot_be_accessed_via_super_expression,q(n),J(Qo(n))),!1}return!(24&i&&(8&i?!Kh(e,kh(kn(n)))&&(z(s,Jm.Diagnostics.Property_0_is_private_and_only_accessible_within_class_1,q(n),J(Qo(n))),1):97!==t.kind&&((t=jh(e,function(e){var t,e=X(W(e));return t=e,!Zo(n,function(e){return!!(16&Jm.getDeclarationModifierFlagsFromSymbol(e))&&!Ei(t,Qo(e))})&&t?e:void 0}))?!(32&i)&&!(3&O(xi(r=16384&r.flags&&r.isThisType?ys(r):r))&&Ei(r,t))&&(z(s,Jm.Diagnostics.Property_0_is_protected_and_only_accessible_through_an_instance_of_class_1,q(n),J(t)),1):(z(s,Jm.Diagnostics.Property_0_is_protected_and_only_accessible_within_class_1_and_its_subclasses,q(n),J(Qo(n)||r)),1))))}function Pu(e){return Mu(V(e),e)}function Mu(e,t){var r=6144&(F?gl(e):e.flags);return r?(z(t,2048&r?4096&r?Jm.Diagnostics.Object_is_possibly_null_or_undefined:Jm.Diagnostics.Object_is_possibly_undefined:Jm.Diagnostics.Object_is_possibly_null),14336&(t=bl(e)).flags?K:t):e}function Fu(e){return $u(e,e.expression,e.name)}function Bu(e){return $u(e,e.left,e.right)}function $u(e,t,r){var n=Pu(t);if(D(n)||n===yt)return n;var i=Q(Sl(n));if(i===K||16384&n.flags&&D(i))return i;var s=R(i,r.escapedText);if(!s){var a=L(i,0);if(a&&a.type)return a.isReadonly&&(Jm.isAssignmentTarget(e)||Jm.isDeleteTarget(e))&&z(e,Jm.Diagnostics.Index_signature_in_type_0_only_permits_reading,J(i)),a.type;if(r.escapedText&&!qr(e)){var o,l=r,a=16384&n.flags&&n.isThisType?i:n;if(65536&a.flags&&!(8190&a.flags))for(var c=0,u=a.types;c<u.length;c++){var d=u[c];if(!R(d,l.escapedText)){o=Jm.chainDiagnosticMessages(o,Jm.Diagnostics.Property_0_does_not_exist_on_type_1,Jm.declarationNameToString(l),J(d));break}}var n=Uu(l,a);o=void 0!==n?Jm.chainDiagnosticMessages(o,Jm.Diagnostics.Property_0_does_not_exist_on_type_1_Did_you_mean_2,Jm.declarationNameToString(l),J(a),n):Jm.chainDiagnosticMessages(o,Jm.Diagnostics.Property_0_does_not_exist_on_type_1,Jm.declarationNameToString(l),J(a)),sr.add(Jm.createDiagnosticForNodeFromMessageChain(l,o))}return K}n=e,a=r,(p=(h=s).valueDeclaration)&&(!(e=>Jm.findAncestor(e,function(e){switch(e.kind){case 149:return!0;case 261:return!1;default:return!Jm.isPartOfExpression(e)&&"quit"}}))(n)||jr(p,a)||(e=>{for(var t=Y(e.parent);;){if(!(t=(e=>{if(0!==(e=Mi(e)).length)return Jm.Debug.assert(1===e.length),e[0]})(t)))return;var r=_s(t,e.escapedName);if(r&&r.valueDeclaration)return 1}})(h)?229!==p.kind||159===n.parent.kind||Jm.isInAmbientContext(p)||jr(p,a)||z(a,Jm.Diagnostics.Class_0_used_before_its_declaration,Jm.idText(a)):z(a,Jm.Diagnostics.Block_scoped_variable_0_used_before_its_declaration,Jm.idText(a))),Gu(s,e,99===t.kind),Lu(e,t,i,b(e).resolvedSymbol=s);var p,h=Rc(s,e),n=Jm.getAssignmentTargetKind(e);return n&&($d(e,s)||Ud(e))?(z(r,Jm.Diagnostics.Cannot_assign_to_0_because_it_is_a_constant_or_a_read_only_property,Jm.idText(r)),K):179===e.kind&&1!==n&&(98311&s.flags||8192&s.flags&&65536&h.flags)?(p=wc(e,h),n?dl(p):p):h}function Uu(e,t){e=Hu(Jm.idText(e),Z(t),107455);return e&&Jm.symbolName(e)}function Vu(e,t,r){e=zr(e,t,r,void 0,t,!1,function(e,t,r){return Gr(e,t,r)||Hu(Jm.unescapeLeadingUnderscores(t),Jm.arrayFrom(e.values()),r)});return e&&Jm.symbolName(e)}function Hu(e,t,r){var n=.4*e.length,i=Math.min(3,.34*e.length),s=Number.MAX_VALUE,a=void 0,o=!1;if(!(30<e.length)){e=e.toLowerCase();for(var l=0,c=t;l<c.length;l++){var u=c[l],d=Jm.symbolName(u);if(u.flags&r&&d&&Math.abs(d.length-e.length)<i){if((d=d.toLowerCase())===e)return u;o||d.length<3||e.length<3||"eval"===d||"intl"===d||"undefined"===d||"map"===d||"nan"===d||"set"===d||n<(d=Jm.levenshtein(e,d))||(d<3?(o=!0,a=u):d<s&&(s=d,a=u))}}return a}}function Gu(e,t,r){if(e&&k&&106500&e.flags&&e.valueDeclaration&&Jm.hasModifier(e.valueDeclaration,8)&&(!t||!Jm.isWriteOnlyAccess(t))){if(r){r=Jm.findAncestor(t,Jm.isFunctionLikeDeclaration);if(r&&r.symbol===e)return}1&Jm.getCheckFlags(e)?d(e).target.isReferenced=!0:e.isReferenced=!0}}function ju(e){var t,r=Jm.skipParentheses(e);if(71===r.kind){var n=Vl(r);if(3&n.flags)for(var i=e,s=e.parent;s;){if(215===s.kind&&i===s.statement&&(e=>{if(227===(e=e.initializer).kind){var t=e.declarations[0];if(t&&!Jm.isBindingPattern(t.name))return W(t)}else if(71===e.kind)return Vl(e)})(s)===n&&Ns(t=op(s.expression),1)&&!Ns(t,0))return 1;s=(i=s).parent}}}function Ku(e,t,r){if(t!==K&&Jm.isWellKnownSymbolSyntactically(e))if(0==(512&t.flags))r&&z(e,Jm.Diagnostics.A_computed_property_name_of_the_form_0_must_be_of_type_symbol,Jm.getTextOfNode(e));else{t=e.expression,e=Vl(t);if(e){var n=Ce=Ce||fa("Symbol",!0);if(n){if(e===n)return 1;r&&z(t,Jm.Diagnostics.Symbol_reference_does_not_refer_to_the_global_Symbol_constructor_object)}}}}function zu(e){return Jm.isCallOrNewExpression(e)}function Wu(e){return zu(e)&&Jm.forEach(e.typeArguments,ne),183===e.kind?V(e.template):147!==e.kind&&Jm.forEach(e.arguments,function(e){V(e)}),At}function qu(e){return Wu(e),Dt}function Ju(e){for(var t=0;t<e.length;t++){var r=e[t];if(r&&198===r.kind)return t}return-1}function Yu(e,t,r,n){void 0===n&&(n=!1);var i=-1;if(Jm.isJsxOpeningLikeElement(e))return 1;if(183===e.kind)var s=e,a=t.length,o=void 0,s=196===s.template.kind?(l=s.template,l=Jm.lastOrUndefined(l.templateSpans),Jm.Debug.assert(void 0!==l),Jm.nodeIsMissing(l.literal)||!!l.literal.isUnterminated):(l=s.template,Jm.Debug.assert(13===l.kind),!!l.isUnterminated);else if(147===e.kind)a=id(e,o=void 0,r);else{var l=e;if(!l.arguments)return Jm.Debug.assert(182===l.kind),0===r.minArgumentCount;a=n?t.length+1:t.length,s=l.arguments.end===l.end,o=l.typeArguments,i=Ju(t)}e=Jm.length(r.typeParameters),n=Bs(r.typeParameters);return(!o||o.length>=n&&o.length<=e)&&(0<=i?il(r,i)||i>=r.minArgumentCount:(r.hasRestParameter||!(a>r.parameters.length))&&(s||r.minArgumentCount<=a))}function Xu(e){if(32768&e.flags){e=gs(e);if(1===e.callSignatures.length&&0===e.constructSignatures.length&&0===e.properties.length&&!e.stringIndexInfo&&!e.numberIndexInfo)return e.callSignatures[0]}}function Zu(e,t,r,n){var i=Al(e,1,n);return Il(t,e,function(e,t){Pl(i.inferences,U(e,r||T),t)}),r||Pl(i.inferences,te(t),te(e),8),js(e,Ul(i),Jm.isInJavaScriptFile(t.declaration))}function Qu(e,t,r,n,i){for(var s=0,a=i.inferences;s<a.length;s++){var o=a[s];o.isFixed||(o.inferredType=void 0)}147!==e.kind&&(l=eu(e))&&(u=(u=Xu(l=U(l,(l=tu(e))&&l.signature?Al(l.signature,2|l.flags,l.compareTypes,l.inferences):l)))&&u.typeParameters?qs(js(u,u.typeParameters,Jm.isInJavaScriptFile(e))):l,l=te(t),Pl(i.inferences,u,l,8));for(var l,c,u=Hs(t),d=(u&&(l=(l=rd(e))?V(l):ft,Pl(i.inferences,l,u)),id(e,r,t)),p=0;p<d;p++)void 0!==(h=ld(e,r,p))&&200===h.kind||(m=Cd(t,p),void 0===(c=od(e,p))&&(c=ep(h,m,n&&void 0!==n[p]?T:i)),Pl(i.inferences,c,m));if(n)for(var h,m,p=0;p<d;p++)!1===n[p]&&(h=r[p],m=Cd(t,p),Pl(i.inferences,ep(h,m,i),m));return Ul(i)}function ed(e,t,r,n){for(var i=Jm.isInJavaScriptFile(e.declaration),s=e.typeParameters,a=$s(Jm.map(t,re),s,Bs(s),i),o=0;o<t.length;o++){Jm.Debug.assert(void 0!==s[o],"Should not call checkTypeArguments with too many type arguments");var l=ys(s[o]);if(l){var c=r&&n&&Jm.chainDiagnosticMessages(void 0,Jm.Diagnostics.Type_0_does_not_satisfy_the_constraint_1),u=n||Jm.Diagnostics.Type_0_does_not_satisfy_the_constraint_1,d=d||yo(s,a),p=a[o];if(!Mo(p,Zi(U(l,d),p),r?t[o]:void 0,u,c))return!1}}return a}function td(e,t,r,n,i,s){if(Jm.isJsxOpeningLikeElement(e)){var a=e,o=r,l=n;if(a.attributes.end===a.end)return 1;for(var c=Jm.Diagnostics.Argument_of_type_0_is_not_assignable_to_parameter_of_type_1,u=Cd(o,0),o=ep(a.attributes,u,void 0),d=0,p=Z(o);d<p.length;d++){var h=p[d];if(!R(u,h.escapedName)&&gu(h.escapedName))return}return Ko(o,u,l,void 0,c)}a=Hs(r);if(a&&a!==ft&&182!==e.kind){var o=rd(e),l=o?V(o):ft,m=s?o||e:void 0,c=Jm.Diagnostics.The_this_context_of_type_0_is_not_assignable_to_method_s_this_of_type_1;if(!Ko(l,Hs(r),n,m,c))return}for(var g=Jm.Diagnostics.Argument_of_type_0_is_not_assignable_to_parameter_of_type_1,f=id(e,t,r),_=0;_<f;_++){var y=ld(e,t,_);if(void 0===y||200!==y.kind){var b=Cd(r,_),v=od(e,_)||ep(y,b,i&&i[_]?T:void 0);if(!Ko(i?kl(v):v,b,n,m=s?(v=_,b=y,147===(y=e).kind?y.expression:0===v&&183===y.kind?y.template:b):void 0,g))return}}return 1}function rd(e){return 181===e.kind&&(179===(e=e.expression).kind||180===e.kind)?e.expression:void 0}function nd(e){var t,r;return 183===e.kind?(t=e.template,r=[void 0],196===t.kind&&Jm.forEach(t.templateSpans,function(e){r.push(e.expression)}),r):147!==e.kind?Jm.isJsxOpeningLikeElement(e)?0<e.attributes.properties.length?[e.attributes]:Jm.emptyArray:e.arguments||Jm.emptyArray:void 0}function id(e,t,r){if(147!==e.kind)return t.length;switch(e.parent.kind){case 229:case 199:return 1;case 149:return 2;case 151:case 153:case 154:return 0===j?2:3<=r.parameters.length?3:2;case 146:return 3}}function sd(e){var t;if(229===e.kind)return Y(W(e));if(146===e.kind&&152===(e=e.parent).kind)return Y(W(e));return 149===e.kind||151===e.kind||153===e.kind||154===e.kind?(t=W((e=e).parent),(Jm.hasModifier(e,32)?Y:X)(t)):(Jm.Debug.fail("Unsupported decorator target."),K)}function ad(e,t){if(0===t)return sd(e.parent);if(1===t){var r=e.parent;if(229===r.kind)Jm.Debug.fail("Class decorators should not have a second synthetic argument.");else{if(146===r.kind&&152===(r=r.parent).kind)return C;if(149===r.kind||151===r.kind||153===r.kind||154===r.kind){var n=r;switch(n.name.kind){case 71:return ho(Jm.idText(n.name));case 8:case 9:return ho(n.name.text);case 144:var i=du(n.name);return Gd(i,512)?i:$;default:return Jm.Debug.fail("Unsupported property name."),K}}Jm.Debug.fail("Unsupported decorator target.")}}else if(2===t){r=e.parent;if(229===r.kind)Jm.Debug.fail("Class decorators should not have a third synthetic argument.");else{if(146===r.kind)return dt;if(149===r.kind)Jm.Debug.fail("Property decorators should not have a third synthetic argument.");else{if(151===r.kind||153===r.kind||154===r.kind)return Na(Jh(r));Jm.Debug.fail("Unsupported decorator target.")}}}else Jm.Debug.fail("Decorators should not have a fourth synthetic argument.");return K}function od(e,t){return 147===e.kind?ad(e,t):0===t&&183===e.kind?(Be=Be||ya("TemplateStringsArray",0,!0))||N:void 0}function ld(e,t,r){if(147!==e.kind&&(0!==r||183!==e.kind))return t[r]}function cd(c,e,t,r){var u,n,i,s,a,o=183===c.kind,l=147===c.kind,d=Jm.isJsxOpeningLikeElement(c),p=(o||l||d||(u=c.typeArguments,97!==c.expression.kind&&Jm.forEach(u,ne)),t||[]),h=e,m=p,g=0,M=-1;Jm.Debug.assert(!m.length);for(var f=0,_=h;f<_.length;f++){var y=_[f],b=y.declaration&&W(y.declaration),v=y.declaration&&y.declaration.parent;i&&b!==i?(s=g=m.length,n=v):n&&v===n?s++:(n=v,s=g),i=b,y.hasLiteralTypes?(a=++M,g++):a=s,m.splice(a,0,y)}if(!p.length)return sr.add(Jm.createDiagnosticForNode(c,Jm.Diagnostics.Call_target_does_not_contain_any_signatures)),qu(c);var T,k,x,E=nd(c),F=1===p.length&&!p[0].typeParameters,S=0;if(!l&&!F)for(var C=o?1:0;C<E.length;C++)Co(E[C])&&((T=T||new Array(E.length))[C]=!0,S++);h=t&&181===c.kind&&c.arguments.hasTrailingComma;if(R=(R=1<p.length?U(p,mr,h):R)||U(p,gr,h))return R;if(k){if(d)return k;td(c,E,k,gr,void 0,!0)}else if(x)ed(x,c.typeArguments,!0,r);else if(u&&Jm.every(e,function(e){return Jm.length(e.typeParameters)!==u.length})){for(var w=Number.POSITIVE_INFINITY,I=Number.NEGATIVE_INFINITY,A=0,B=e;A<B.length;A++){var D=B[A];w=Math.min(w,Bs(D.typeParameters)),I=Math.max(I,Jm.length(D.typeParameters))}var N=w<I?w+"-"+I:w;sr.add(Jm.createDiagnosticForNode(c,Jm.Diagnostics.Expected_0_type_arguments_but_got_1,N,u.length))}else if(E){for(var w=Number.POSITIVE_INFINITY,I=Number.NEGATIVE_INFINITY,O=0,$=e;O<$.length;O++){D=$[O];w=Math.min(w,D.minArgumentCount),I=Math.max(I,D.parameters.length)}l=Jm.some(e,function(e){return e.hasRestParameter}),o=-1<Ju(E),N=!l&&w<I?w+"-"+I:w,t=E.length-(o?1:0),h=l&&o?Jm.Diagnostics.Expected_at_least_0_arguments_but_got_a_minimum_of_1:l?Jm.Diagnostics.Expected_at_least_0_arguments_but_got_1:o?Jm.Diagnostics.Expected_0_arguments_but_got_a_minimum_of_1:Jm.Diagnostics.Expected_0_arguments_but_got_1;sr.add(Jm.createDiagnosticForNode(c,h,N,t))}else r&&sr.add(Jm.createDiagnosticForNode(c,r));if(G)return qu(c);Jm.Debug.assert(0<p.length);var R=((e,t)=>{for(var r=-1,n=-1,i=0;i<e.length;i++){var s=e[i];if(s.hasRestParameter||s.parameters.length>=t)return i;s.parameters.length>n&&(n=s.parameters.length,r=i)}return r})(p,void 0===de?E.length:de),d=p[R],L=d.typeParameters;if(L&&zu(c)&&c.typeArguments){for(var P=c.typeArguments.map(Jh);P.length>L.length;)P.pop();for(;P.length<L.length;)P.push($l(Jm.isInJavaScriptFile(c)));e=Ks(d,P);return p[R]=e}return d;function U(e,t,r){if(void 0===r&&(r=!1),x=k=void 0,F)return s=e[0],Yu(c,E,s,r)?td(c,E,s,t,T,!1)?s:void(k=s):void 0;for(var n=0;n<e.length;n++){var i=e[n];if(Yu(c,E,i,r))for(var s=void 0,a=i.typeParameters?Al(i,Jm.isInJavaScriptFile(c)?4:0):void 0;;){if((s=i).typeParameters){var o=void 0;if(u){var l=ed(s,u,!1);if(!l){x=i;break}o=l}else o=Qu(c,s,E,T,a);s=js(s,o,Jm.isInJavaScriptFile(s.declaration))}if(!td(c,E,s,t,T,!1)){k=s;break}if(0===S)return e[n]=s;0<--S?T[Jm.indexOf(T,!0)]=!1:T=void 0}}}}function ud(e,t,r,n){return D(e)||D(t)&&16384&e.flags||!(r||n||65536&e.flags)&&x(e,ge)}function dd(e,t){e.arguments&&j<1&&0<=(r=Ju(e.arguments))&&z(e.arguments[r],Jm.Diagnostics.Spread_operator_in_new_expressions_is_only_available_when_targeting_ECMAScript_5_and_higher);var r=Pu(e.expression);if(r===yt)return Ot;if((r=Q(r))!==K){if(D(r))return e.typeArguments&&z(e,Jm.Diagnostics.Untyped_function_calls_may_not_accept_type_arguments),Wu(e);var n=ee(r,1);if(n.length)return((e,t)=>{if(!t||!t.declaration)return 1;var r=t.declaration,n=Jm.getSelectedModifierFlags(r,24);if(!n)return 1;var t=kh(r.parent.symbol),i=X(r.parent.symbol);if(Kh(e,t))return 1;if(t=Jm.getContainingClass(e))for(var s=Mi(Jh(t));s.length;){var a=s[0];if(16&n&&a.symbol===r.parent.symbol)return 1;s=Mi(a)}8&n&&z(e,Jm.Diagnostics.Constructor_of_class_0_is_private_and_only_accessible_within_the_class_declaration,J(i)),16&n&&z(e,Jm.Diagnostics.Constructor_of_class_0_is_protected_and_only_accessible_within_the_class_declaration,J(i))})(e,n[0])?(i=r.symbol&&kh(r.symbol))&&Jm.hasModifier(i,128)?(z(e,Jm.Diagnostics.Cannot_create_an_instance_of_the_abstract_class_0,Jm.declarationNameToString(Jm.getNameOfDeclaration(i))),qu(e)):cd(e,n,t):qu(e);var i=ee(r,0);if(i.length)return yd((n=cd(e,i,t)).declaration)||te(n)===ft||z(e,Jm.Diagnostics.Only_a_void_function_can_be_called_with_the_new_keyword),Hs(n)===ft&&z(e,Jm.Diagnostics.A_function_that_is_called_with_the_new_keyword_cannot_have_a_this_type_that_is_void),n;z(e,Jm.Diagnostics.Cannot_use_new_with_an_expression_whose_type_lacks_a_call_or_construct_signature)}return qu(e)}function pd(e){switch(e.parent.kind){case 229:case 199:return Jm.Diagnostics.Unable_to_resolve_signature_of_class_decorator_when_called_as_an_expression;case 146:return Jm.Diagnostics.Unable_to_resolve_signature_of_parameter_decorator_when_called_as_an_expression;case 149:return Jm.Diagnostics.Unable_to_resolve_signature_of_property_decorator_when_called_as_an_expression;case 151:case 153:case 154:return Jm.Diagnostics.Unable_to_resolve_signature_of_method_decorator_when_called_as_an_expression}}function hd(e,t){var r,n,i,s=V(e.expression),a=Q(s);return a===K?qu(e):(r=ee(a,0),i=ee(a,1),ud(s,a,r.length,i.length)?Wu(e):(n=e,(s=r).length&&Jm.every(s,function(e){return 0===e.minArgumentCount&&!e.hasRestParameter&&e.parameters.length<id(n,void 0,e)})?(i=Jm.getTextOfNode(e.expression,!1),z(e,Jm.Diagnostics._0_accepts_too_few_arguments_to_be_used_as_a_decorator_here_Did_you_mean_to_call_it_first_and_write_0,i),qu(e)):(s=pd(e),r.length?cd(e,r,t,s):(i=Jm.chainDiagnosticMessages(i=void 0,Jm.Diagnostics.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,J(a)),i=Jm.chainDiagnosticMessages(i,s),sr.add(Jm.createDiagnosticForNodeFromMessageChain(e,i)),qu(e)))))}function md(e,t,r){return Jm.Debug.assert(!(65536&t.flags)),gd(e,t,r)}function gd(e,t,r){if(65536&t.flags){for(var n=void 0,i=0,s=t.types;i<s.length;i++)var a=s[i],n=n||gd(e,a,r);return n}t=t&&ee(t,0);if(t&&0<t.length)return cd(e,t,r)}function fd(e,t){switch(e.kind){case 181:var r=e,n=t;if(97!==r.expression.kind)return(i=Pu(r.expression))===yt?Ot:(s=Q(i))===K?qu(r):(o=ee(s,0),a=ee(s,1),ud(i,s,o.length,a.length)?(i!==K&&r.typeArguments&&z(r,Jm.Diagnostics.Untyped_function_calls_may_not_accept_type_arguments),Wu(r)):o.length?cd(r,o,n):(a.length?z(r,Jm.Diagnostics.Value_of_type_0_is_not_callable_Did_you_mean_to_include_new,J(i)):z(r,Jm.Diagnostics.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,J(s)),qu(r)));var i=Hc(r.expression);if(i!==K){var s=Jm.getClassExtendsHeritageClauseElement(Jm.getContainingClass(r));if(s)return cd(r,Li(i,s.typeArguments,s),n)}return Wu(r);case 182:return dd(e,t);case 183:return o=t,i=V((a=e).tag),(s=Q(i))===K?qu(a):(n=ee(s,0),r=ee(s,1),ud(i,s,n.length,r.length)?Wu(a):n.length?cd(a,n,o):(z(a,Jm.Diagnostics.Cannot_invoke_an_expression_whose_type_lacks_a_call_signature_Type_0_has_no_compatible_call_signatures,J(s)),qu(a)));case 147:return hd(e,t);case 251:case 250:return gd(e,V(e.tagName),t)||Dt}var a,o;Jm.Debug.assertNever(e,"Branch in 'resolveSignature' should be unreachable.")}function _d(e,t){var r=b(e),n=r.resolvedSignature;if(n&&n!==Nt&&!t)return n;r.resolvedSignature=Nt;e=fd(e,t);return r.resolvedSignature=Mt===Ft?e:n,e}function yd(e){return e&&Jm.isInJavaScriptFile(e)&&(Jm.getJSDocClassTag(e)||(e=Jm.isFunctionDeclaration(e)||Jm.isFunctionExpression(e)?W(e):Jm.isVariableDeclaration(e)&&e.initializer&&Jm.isFunctionExpression(e.initializer)?W(e.initializer):void 0)&&void 0!==e.members)}function bd(e){var t=d(e);return t.inferredClassType||(t.inferredClassType=Nn(e,e.members||m,Jm.emptyArray,Jm.emptyArray,void 0,void 0)),t.inferredClassType}function vd(e){return e.symbol&&16&O(e)&&d(e.symbol).inferredClassType===e}function Td(e){Om(e,e.typeArguments)||Rm(e.arguments);var t=_d(e);if(97===e.expression.kind)return ft;if(182===e.kind){var r=t.declaration;if(r&&152!==r.kind&&156!==r.kind&&161!==r.kind&&!Jm.isJSDocConstructSignature(r))return(r=(r=V(e.expression).symbol)||71!==e.expression.kind?r:Vl(e.expression))&&(e=>{if(yd((e=Jm.isDeclarationOfFunctionOrClassExpression(e)?W(e.valueDeclaration.initializer):e).valueDeclaration))return bd(e);if(3&e.flags){e=Y(e);if(e.symbol&&!vd(e)&&yd(e.symbol.valueDeclaration))return bd(e.symbol)}})(r)||(_&&z(e,Jm.Diagnostics.new_expression_whose_target_lacks_a_construct_signature_implicitly_has_an_any_type),C)}if(Jm.isInJavaScriptFile(e)&&(e=>{if(Jm.isRequireCall(e,!0)){var t;if(Jm.isIdentifier(e.expression))return!(e=Kr(e.expression,e.expression.escapedText,107455,void 0,void 0,!0))||(2097152&e.flags?void 0:0!=(t=16&e.flags?228:3&e.flags?226:0)&&(e=Jm.getDeclarationOfKind(e,t),Jm.isInAmbientContext(e)));throw Jm.Debug.fail()}})(e)){r=e.arguments[0];if(r=un(r,r)){r=hn(r);if(r)return Y(r)}return C}return te(t)}function kd(e){if(Rm(e.arguments)||(t=e,ae===Jm.ModuleKind.ES2015?H(t,Jm.Diagnostics.Dynamic_import_cannot_be_used_when_targeting_ECMAScript_2015_modules):t.typeArguments?H(t,Jm.Diagnostics.Dynamic_import_cannot_have_type_arguments):1!==(r=t.arguments).length?H(t,Jm.Diagnostics.Dynamic_import_must_have_one_specifier_as_an_argument):Jm.isSpreadElement(r[0])&&H(r[0],Jm.Diagnostics.Specifier_of_dynamic_import_cannot_be_spread_element)),0!==e.arguments.length){for(var t=e.arguments[0],r=tp(t),n=1;n<e.arguments.length;++n)tp(e.arguments[n]);(2048&r.flags||4096&r.flags||!x(r,$))&&z(t,Jm.Diagnostics.Dynamic_import_s_specifier_must_be_of_type_string_but_here_has_type_0,J(r));var i=un(e,t);if(i){i=mn(i,t,!0);if(i)return Dd(e,((e,t)=>{var r,n,i;return h&&e&&e!==K?((r=e).syntheticType||(R(e,"default")?r.syntheticType=e:(n=Jm.createSymbolTable(),(i=Mr(2097152,"default")).target=rn(t),n.set("default",i),t=Mr(2048,"__type"),i=Nn(t,n,Jm.emptyArray,Jm.emptyArray,void 0,void 0),t.type=i,r.syntheticType=za([e,i]))),r.syntheticType):e})(Y(i),i))}}return Dd(e,C)}function xd(e,t,r,n){r=kl(dl(V(r,n))),ne(t),n=re(t);return G&&n!==K&&!Po(n,Sl(r))&&Fo(r,n,e,Jm.Diagnostics.Type_0_cannot_be_converted_to_type_1),n}function Ed(e){var t=e;if(94===t.keywordToken&&"target"!==t.name.escapedText)H(t.name,Jm.Diagnostics._0_is_not_a_valid_meta_property_for_keyword_1_Did_you_mean_2,t.name.escapedText,Jm.tokenToString(t.keywordToken),"target");t=Jm.getNewTargetContainer(e);return t?152===t.kind?Y(W(t.parent)):Y(W(t)):(z(e,Jm.Diagnostics.Meta_property_0_is_only_allowed_in_the_body_of_a_function_declaration_function_expression_or_constructor,"new.target"),K)}function Sd(e){var t=Y(e);if(F){e=e.valueDeclaration;if(e&&e.initializer)return yl(t,2048)}return t}function Cd(e,t){return e.hasRestParameter?t<e.parameters.length-1?Sd(e.parameters[t]):Gs(e):t<e.parameters.length?Sd(e.parameters[t]):C}function wd(e){return 0<e.parameters.length?Cd(e,0):_t}function Id(e,t){var r=d(e);r.type||(r.type=t,71!==(t=e.valueDeclaration).name.kind&&(r.type===N&&(r.type=hi(t.name)),function e(t){for(var r=0,n=t.elements;r<n.length;r++){var i=n[r];Jm.isOmittedExpression(i)||(71===i.name.kind?d(W(i)).type=oi(i):e(i.name))}}(t.name)))}function Ad(e){var t=va(!0);return t!==Tt?na(t,[e=Ip(e)||N]):N}function Dd(e,t){t=Ad(t);return t===N?(z(e,Jm.isImportCall(e)?Jm.Diagnostics.A_dynamic_import_call_returns_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_include_ES2015_in_your_lib_option:Jm.Diagnostics.An_async_function_or_method_must_return_a_Promise_Make_sure_you_have_a_declaration_for_Promise_or_include_ES2015_in_your_lib_option),K):(Ta(!0)||z(e,Jm.isImportCall(e)?Jm.Diagnostics.A_dynamic_import_call_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declaration_for_the_Promise_constructor_or_include_ES2015_in_your_lib_option:Jm.Diagnostics.An_async_function_or_method_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declaration_for_the_Promise_constructor_or_include_ES2015_in_your_lib_option),t)}function Nd(e,t){var r=iu(e);if(!e.body)return K;var n,i,s,a,o=Jm.getFunctionFlags(e);if(207!==e.body.kind)n=tp(e.body,t),2&o&&(n=wp(n,e,Jm.Diagnostics.The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member));else{var l=void 0;if(1&o){if(!(l=Jm.concatenate((c=e,i=t,s=[],a=Jm.getFunctionFlags(c),Jm.forEachYieldExpression(c.body,function(e){var t,r=e.expression;r&&(t=tp(r,i),e.asteriskToken&&(t=oh(t,e.expression,!1,0!=(2&a))),2&a&&(t=wp(t,r,e.asteriskToken?Jm.Diagnostics.Type_of_iterated_elements_of_a_yield_Asterisk_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member:Jm.Diagnostics.Type_of_yield_operand_in_an_async_generator_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member)),Jm.pushIfUnique(s,t))}),s),Ld(e,t)))||0===l.length)return c=(2&o?Oa:La)(C),_&&z(e.asteriskToken,Jm.Diagnostics.Generator_implicitly_has_type_0_because_it_does_not_yield_any_values_Consider_supplying_a_return_type,J(c)),c}else{if(!(l=Ld(e,t)))return 2&o?Dd(e,_t):_t;if(0===l.length)return 2&o?Dd(e,ft):ft}n=P(l,!0),1&o&&(n=(2&o?Oa:La)(n))}r||wl(e,n);var c=Sl(n=!cl(n)||r&&ip(r===Us(e)?n:te(r))?n:pl(n));return 2==(3&o)?Dd(e,c):c}function Od(e){var t,r;return e.possiblyExhaustive&&ul(t=op(e.expression))&&(e=cc(e)).length?(t=hc(t,po),r=e,65536&t.flags?!Jm.forEach(t.types,function(e){return!Jm.contains(r,e)}):Jm.contains(r,t)):void 0}function Rd(e){return!(!(128&e.flags)||(e=Jm.lastOrUndefined(e.body.statements))&&221===e.kind&&Od(e))}function Ld(t,r){var n=Jm.getFunctionFlags(t),i=[],s=Rd(t),a=!1;if(Jm.forEachReturnStatement(t.body,function(e){var e=e.expression;e?(e=tp(e,r),8192&(e=2&n?wp(e,t,Jm.Diagnostics.The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member):e).flags&&(a=!0),Jm.pushIfUnique(i,e)):s=!0}),0!==i.length||s||!a&&186!==t.kind&&187!==t.kind)return F&&i.length&&s&&Jm.pushIfUnique(i,ot),i}function Pd(e,t){if(G&&(!t||!Hd(t,1025))&&!Jm.nodeIsMissing(e.body)&&207===e.body.kind&&Rd(e)){var r=256&e.flags;if(t&&8192&t.flags)z(Jm.getEffectiveReturnTypeNode(e),Jm.Diagnostics.A_function_returning_never_cannot_have_a_reachable_end_point);else if(t&&!r)z(Jm.getEffectiveReturnTypeNode(e),Jm.Diagnostics.A_function_whose_declared_type_is_neither_void_nor_any_must_return_a_value);else if(t&&F&&!x(ot,t))z(Jm.getEffectiveReturnTypeNode(e),Jm.Diagnostics.Function_lacks_ending_return_statement_and_return_type_does_not_include_undefined);else if(M.noImplicitReturns){if(!t){if(!r)return;if(mh(e,te(Us(e))))return}z(Jm.getEffectiveReturnTypeNode(e)||e,Jm.Diagnostics.Not_all_code_paths_return_a_value)}}}function Md(e,t){if(Jm.Debug.assert(151!==e.kind||Jm.isObjectLiteralMethod(e)),1===t&&Co(e))return Mh(e),kt;Nm(e)||186!==e.kind||Fm(e);var r=b(e),n=Y(e.symbol);if(!(1024&r.flags)){var i=au(e);if(!(1024&r.flags)){if(r.flags|=1024,i){r=ee(n,0)[0];if(Co(e)){var s=tu(e);if(2===t)for(var a=r,o=i,l=s,c=a.parameters.length-(a.hasRestParameter?1:0),u=0;u<c;u++){var d=a.parameters[u].valueDeclaration;d.type&&(d=Jm.getEffectiveTypeAnnotationNode(d))&&Pl(l.inferences,re(d),Cd(o,u))}var i=s===T?i:To(i,s),p=r,h=i;p.typeParameters=h.typeParameters,h.thisParameter&&(!(f=p.thisParameter)||f.valueDeclaration&&!f.valueDeclaration.type)&&(f||(p.thisParameter=Tl(h.thisParameter,void 0)),Id(p.thisParameter,Y(h.thisParameter)));for(var m=p.parameters.length-(p.hasRestParameter?1:0),g=0;g<m;g++){var f=p.parameters[g];Jm.getEffectiveTypeAnnotationNode(f.valueDeclaration)||Id(f,Cd(h,g))}p.hasRestParameter&&il(h,p.parameters.length-1)&&(!Fr(f=Jm.lastOrUndefined(p.parameters))&&Jm.getEffectiveTypeAnnotationNode(f.valueDeclaration)||Id(f,Y(Jm.lastOrUndefined(h.parameters))))}Jm.getEffectiveReturnTypeNode(e)||r.resolvedReturnType||(s=Nd(e,t),r.resolvedReturnType)||(r.resolvedReturnType=s)}dp(e),Mh(e)}}return G&&151!==e.kind&&(Jp(e,e.name),Kp(e,e.name),zp(e,e.name)),n}function Fd(e,t,r){return!!Gd(t,84)||(z(e,r),!1)}function Bd(e){return!!(8&Jm.getCheckFlags(e)||4&e.flags&&64&Jm.getDeclarationModifierFlagsFromSymbol(e)||3&e.flags&&2&Ou(e)||98304&e.flags&&!(65536&e.flags)||8&e.flags)}function $d(e,t){return Bd(t)&&(4&t.flags&&(179===e.kind||180===e.kind)&&99===e.expression.kind&&(e=Jm.getContainingFunction(e))&&152===e.kind?e.parent!==t.valueDeclaration.parent&&e!==t.valueDeclaration.parent:1)}function Ud(e){if(179===e.kind||180===e.kind){e=Jm.skipParentheses(e.expression);if(71===e.kind){var e=b(e).resolvedSymbol;if(2097152&e.flags)return(e=Xr(e))&&240===e.kind}}}function Vd(e,t){var r=Jm.skipOuterExpressions(e,3);if(71===r.kind||179===r.kind||180===r.kind)return 1;z(e,t)}function Hd(e,t){if(e.flags&t)return!0;if(196608&e.flags)for(var r=0,n=e.types;r<n.length;r++)if(Hd(n[r],t))return!0;return!1}function Gd(e,t,r){return!!(e.flags&t)||!(r&&7169&e.flags)&&(84&t&&x(e,dt)||262178&t&&x(e,$)||136&t&&x(e,mt)||1024&t&&x(e,ft)||8192&t&&x(e,_t)||4096&t&&x(e,ct)||2048&t&&x(e,ot)||512&t&&x(e,gt)||16777216&t&&x(e,bt))}function jd(e){return 16&O(e)&&e.symbol&&Kd(e.symbol)}function Kd(e){return 0!=(128&e.flags)}function zd(e,t,r){if(261===t.kind||262===t.kind){var n=t.name;if(144===n.kind&&du(n),!si(n))return a=Jm.getTextOfPropertyName(n),(a=D(e)?e:ni(e,a)||uu(a)&&Ns(e,1)||Ns(e,0))?262===t.kind?qd(t,a):qd(t.initializer,a):void z(n,Jm.Diagnostics.Type_0_has_no_property_1_and_no_string_index_signature,J(e),Jm.declarationNameToString(n))}else{if(263===t.kind){j<5&&Sm(t,4);var i=[];if(r)for(var s=0;s<r.length-1;s++)i.push(r[s].name);var a=ai(e,i,e.symbol);return qd(t.expression,a)}z(t,Jm.Diagnostics.Property_assignment_expected)}}function Wd(e,t,r,n,i){var e=e.elements,s=e[r];if(200!==s.kind)if(198!==s.kind){var a=""+r,o=D(t)?t:ll(t)?ni(t,a):n;if(o)return qd(s,o,i);V(s),hl(t)?z(s,Jm.Diagnostics.Tuple_type_0_with_length_1_cannot_be_assigned_to_tuple_with_length_2,J(t),sa(t),e.length):z(s,Jm.Diagnostics.Type_0_has_no_property_1,J(t),a)}else if(r<e.length-1)z(s,Jm.Diagnostics.A_rest_element_must_be_last_in_a_destructuring_pattern);else{o=s.expression;if(194!==o.kind||58!==o.operatorToken.kind)return qd(o,Pa(n),i);z(o.operatorToken,Jm.Diagnostics.A_rest_element_cannot_have_an_initializer)}}function qd(e,t,r){var n,i,s,a=262===e.kind?((a=e).objectAssignmentInitializer&&(!F||2048&gl(V(a.objectAssignmentInitializer))||(t=Xl(t,131072)),Zd(a.name,a.equalsToken,a.objectAssignmentInitializer,r)),e.name):e;if(194===a.kind&&58===a.operatorToken.kind&&(Xd(a,r),a=a.left),178===a.kind){for(var o=t,l=a.properties,c=0,u=l;c<u.length;c++)zd(o,u[c],l);return o}if(177!==a.kind)return e=t,i=V(n=a,i=r),s=263===n.parent.kind?Jm.Diagnostics.The_target_of_an_object_rest_assignment_must_be_a_variable_or_a_property_access:Jm.Diagnostics.The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access,Vd(n,s)&&Mo(e,i,n,void 0),e;var d=a,p=t,h=r;j<2&&M.downlevelIteration&&Sm(d,512);for(var m=oh(p,d,!1,!1)||K,g=d.elements,f=0;f<g.length;f++)Wd(d,p,f,m,h);return p}function Jd(e,t){return 0!=(6144&t.flags)||Po(e,t)}function Yd(e,t){var r=x(e,t),n=x(t,e);return n&&!r?e:r&&!n?t:P([e,t],!0)}function Xd(e,t){return Zd(e.left,e.operatorToken,e.right,t,e)}function Zd(r,e,n,t,i){var s=e.kind;if(58===s&&(178===r.kind||177===r.kind))return qd(r,V(n,t),t);var a,o,l,c,u=V(r,t),d=V(n,t);switch(s){case 39:case 40:case 61:case 62:case 41:case 63:case 42:case 64:case 38:case 60:case 45:case 65:case 46:case 66:case 47:case 67:case 49:case 69:case 50:case 70:case 48:case 68:return u===yt||d===yt?yt:(u=Mu(u,r),d=Mu(d,n),p=void 0,136&u.flags&&136&d.flags&&void 0!==(p=(e=>{switch(e){case 49:case 69:return 54;case 50:case 70:return 35;case 48:case 68:return 53;default:return}})(e.kind))?z(i||e,Jm.Diagnostics.The_0_operator_is_not_allowed_for_boolean_types_Consider_using_1_instead,Jm.tokenToString(e.kind),Jm.tokenToString(p)):(p=Fd(r,u,Jm.Diagnostics.The_left_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type),h=Fd(n,d,Jm.Diagnostics.The_right_hand_side_of_an_arithmetic_operation_must_be_of_type_any_number_or_an_enum_type),p&&h&&g(dt)),dt);case 37:case 59:if(u===yt||d===yt)return yt;Gd(u,262178)||Gd(d,262178)||(u=Mu(u,r),d=Mu(d,n));var p=void 0;if(Gd(u,84,!0)&&Gd(d,84,!0)?p=dt:Gd(u,262178,!0)||Gd(d,262178,!0)?p=$:(D(u)||D(d))&&(p=u===K||d===K?K:C),!p||m(s)){if(!p)return f(),C;59===s&&g(p)}return p;case 27:case 29:case 30:case 31:return m(s)&&(u=dl(Mu(u,r)),d=dl(Mu(d,n)),Po(u,d)||Po(d,u)||f()),mt;case 32:case 33:case 34:case 35:var h=ul(u),p=ul(d);return h&&p||(u=h?dl(u):u,d=p?dl(d):d),Jd(u,d)||Jd(d,u)||f(),mt;case 93:return h=r,p=n,c=d,(l=u)===yt||c===yt?yt:(!D(l)&&Gd(l,8190)&&z(h,Jm.Diagnostics.The_left_hand_side_of_an_instanceof_expression_must_be_of_type_any_an_object_type_or_a_type_parameter),D(c)||ee(c,0).length||ee(c,1).length||Ro(c,ge)||z(p,Jm.Diagnostics.The_right_hand_side_of_an_instanceof_expression_must_be_of_type_any_or_of_a_type_assignable_to_the_Function_interface_type),mt);case 92:return l=r,c=n,o=d,(a=u)===yt||o===yt?yt:(a=Mu(a,l),o=Mu(o,c),Po(a,$)||Gd(a,596)||z(l,Jm.Diagnostics.The_left_hand_side_of_an_in_expression_must_be_of_type_any_string_number_or_symbol),Gd(o,17317888)||z(c,Jm.Diagnostics.The_right_hand_side_of_an_in_expression_must_be_of_type_any_an_object_type_or_a_type_parameter),mt);case 53:return 1048576&Yl(u)?P([hc(F?u:dl(d),_l),d]):u;case 54:return 2097152&Yl(u)?Yd(fl(u),d):u;case 58:return g(d),kl(d);case 26:return M.allowUnreachableCode||!function e(t){switch((t=Jm.skipParentheses(t)).kind){case 71:case 9:case 12:case 183:case 196:case 13:case 8:case 101:case 86:case 95:case 139:case 186:case 199:case 187:case 177:case 178:case 189:case 203:case 250:case 249:return!0;case 195:return e(t.whenTrue)&&e(t.whenFalse);case 194:return!Jm.isAssignmentOperator(t.operatorToken.kind)&&e(t.left)&&e(t.right);case 192:case 193:switch(t.operator){case 51:case 37:case 38:case 52:return!0}return!1;default:return!1}}(r)||71===(a=n).kind&&"eval"===a.escapedText||z(r,Jm.Diagnostics.Left_side_of_comma_operator_is_unused_and_has_no_side_effects),d}function m(e){var t=Hd(u,512)?r:Hd(d,512)?n:void 0;if(!t)return 1;z(t,Jm.Diagnostics.The_0_operator_cannot_be_applied_to_type_symbol,Jm.tokenToString(e))}function g(e){G&&Jm.isAssignmentOperator(s)&&Vd(r,Jm.Diagnostics.The_left_hand_side_of_an_assignment_expression_must_be_a_variable_or_a_property_access)&&Mo(e,u,r,void 0)}function f(){z(i||e,Jm.Diagnostics.Operator_0_cannot_be_applied_to_types_1_and_2,Jm.tokenToString(e.kind),J(u),J(d))}}function Qd(e){var t,r,n,i,s;return G&&(4096&e.flags&&!(e=>{for(var t=e,r=e.parent;r;){if(Jm.isFunctionLike(r)&&t===r.body)return;if(Jm.isClassLike(t))return 1;r=(t=r).parent}})(e)||ie(e,Jm.Diagnostics.A_yield_expression_is_only_allowed_in_a_generator_body),zc(e))&&z(e,Jm.Diagnostics.yield_expressions_cannot_be_used_in_a_parameter_initializer),e.expression&&(t=(s=Jm.getContainingFunction(e))&&Jm.getFunctionFlags(s),e.asteriskToken&&(3==(3&t)&&j<5&&Sm(e,26624),1==(3&t))&&j<2&&M.downlevelIteration&&Sm(e,256),1&t)&&(r=tp(e.expression),n=void 0,(i=!!e.asteriskToken)&&(n=oh(r,e.expression,!1,0!=(2&t))),s=Jm.getEffectiveReturnTypeNode(s))&&(s=dh(re(s),0!=(2&t))||C,Mo(i?2&t?Ip(n,e.expression,Jm.Diagnostics.Type_of_iterated_elements_of_a_yield_Asterisk_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member):n:2&t?Ip(r,e.expression,Jm.Diagnostics.Type_of_yield_operand_in_an_async_generator_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member):r,s,e.expression,void 0)),C}function ep(e,t,r){var n=e.contextualType,i=e.contextualMapper,t=(e.contextualType=t,(e.contextualMapper=r)===T?1:r?2:0),r=V(e,t);return e.contextualType=n,e.contextualMapper=i,r}function tp(e,t){var r,n=b(e);return n.resolvedType||(r=Mt,Mt=Ft,n.resolvedType=V(e,t),Mt=r),n.resolvedType}function rp(e){return 184===(e=Jm.skipParentheses(e)).kind||202===e.kind}function np(e){var t=op(e.initializer,!0);return 2&Jm.getCombinedNodeFlags(e)||64&Jm.getCombinedModifierFlags(e)&&!Jm.isParameterPropertyDeclaration(e)||rp(e.initializer)?t:pl(t)}function ip(e){if(e){if(540672&e.flags){var t=vs(e)||N;if(30&t.flags)return!0;e=t}return Hd(e,262368)}return!1}function sp(e,t,r){2===arguments.length&&(r=eu(e));t=V(e,t);return rp(e)||ip(r)?t:pl(t)}function ap(e,t,r){if(2===r){r=Xu(t);if(r&&r.typeParameters){var n=Qc(e);if(n){n=Xu(bl(n));if(n&&!n.typeParameters)return qs(Zu(r,n,tu(e)))}}}return t}function op(e,t){if(181===e.kind&&97!==e.expression.kind&&!Jm.isRequireCall(e,!0)){var r=Xu(Pu(e.expression));if(r&&!r.typeParameters)return te(r)}return(t?tp:V)(e)}function V(e,t){return t=143===e.kind?Bu(e):ap(e,((e,t)=>{switch(e.kind){case 71:return Lc(e);case 99:return Uc(e);case 97:return Hc(e);case 95:return ut;case 13:case 9:return uo(ho(e.text));case 8:return qm(e),uo(ho(+e.text));case 101:return pt;case 86:return ht;case 196:return(e=>(Jm.forEach(e.templateSpans,function(e){V(e.expression)}),$))(e);case 12:return Te;case 177:return lu(e,t);case 178:return hu(e,t);case 179:return Fu(e);case 180:return(e=>{var t,r,n=Pu(e.expression),i=e.argumentExpression;return i?(r=ju(i)?dt:V(i),n===K||n===yt?n:jd(n)&&9!==i.kind?(z(i,Jm.Diagnostics.A_const_enum_member_can_only_be_accessed_using_a_string_literal),K):vp(eo(n,r,e),e)):(i=Jm.getSourceFileOfNode(e),182===e.parent.kind&&e.parent.expression===e?zm(i,t=Jm.skipTrivia(i.text,e.expression.end),e.end-t,Jm.Diagnostics.new_T_cannot_be_used_to_create_an_array_Use_new_Array_T_instead):zm(i,t=e.end-"]".length,e.end-t,Jm.Diagnostics.Expression_expected),K)})(e);case 181:if(91===e.expression.kind)return kd(e);case 182:return Td(e);case 183:return(e=>(j<2&&Sm(e,65536),te(_d(e))))(e);case 185:return((e,t)=>{var r=Jm.isInJavaScriptFile(e)?Jm.getJSDocTypeTag(e):void 0;return r?xd(r,r.typeExpression.type,e.expression,t):V(e.expression,t)})(e,t);case 199:return(e=>(vh(e),Mh(e),Y(W(e))))(e);case 186:case 187:return Md(e,t);case 189:return(e=>(V(e.expression),cr))(e);case 184:case 202:return(e=>xd(e,e.type,e.expression))(e);case 203:return(e=>bl(V(e.expression)))(e);case 204:return Ed(e);case 188:return(e=>{var t;return V(e.expression),179!==(e=Jm.skipParentheses(e.expression)).kind&&180!==e.kind?z(e,Jm.Diagnostics.The_operand_of_a_delete_operator_must_be_a_property_reference):(t=xn(b(e).resolvedSymbol))&&Bd(t)&&z(e,Jm.Diagnostics.The_operand_of_a_delete_operator_cannot_be_a_read_only_property),mt})(e);case 190:return(e=>(V(e.expression),lt))(e);case 191:return(e=>(G&&(16384&e.flags||ie(e,Jm.Diagnostics.await_expression_is_only_allowed_within_an_async_function),zc(e))&&z(e,Jm.Diagnostics.await_expressions_cannot_be_used_in_a_parameter_initializer),wp(V(e.expression),e,Jm.Diagnostics.Type_of_await_operand_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member)))(e);case 192:return(e=>{var t=V(e.operand);if(t===yt)return yt;if(8===e.operand.kind){if(38===e.operator)return uo(ho(-e.operand.text));if(37===e.operator)return uo(ho(+e.operand.text))}switch(e.operator){case 37:case 38:case 52:return Mu(t,e.operand),Hd(t,512)&&z(e.operand,Jm.Diagnostics.The_0_operator_cannot_be_applied_to_type_symbol,Jm.tokenToString(e.operator)),dt;case 51:var r=3145728&Yl(t);return 1048576==r?ht:2097152==r?pt:mt;case 43:case 44:return Fd(e.operand,Mu(t,e.operand),Jm.Diagnostics.An_arithmetic_operand_must_be_of_type_any_number_or_an_enum_type)&&Vd(e.operand,Jm.Diagnostics.The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access),dt}return K})(e);case 193:return(e=>{var t=V(e.operand);return t===yt?yt:(Fd(e.operand,Mu(t,e.operand),Jm.Diagnostics.An_arithmetic_operand_must_be_of_type_any_number_or_an_enum_type)&&Vd(e.operand,Jm.Diagnostics.The_operand_of_an_increment_or_decrement_operator_must_be_a_variable_or_a_property_access),dt)})(e);case 194:return Xd(e,t);case 195:return((e,t)=>(V(e.condition),Yd(V(e.whenTrue,t),V(e.whenFalse,t))))(e,t);case 198:return((e,t)=>(j<2&&M.downlevelIteration&&Sm(e,1536),oh(V(e.expression,t),e.expression,!1,!1)))(e,t);case 200:return lt;case 197:return Qd(e);case 256:return((e,t)=>e.expression?(t=V(e.expression,t),e.dotDotDotToken&&t!==C&&!al(t)&&z(e,Jm.Diagnostics.JSX_spread_child_must_be_an_array_type),t):K)(e,t);case 249:return(e=>(Du(e.openingElement),fu(e.closingElement.tagName)?bu(e.closingElement):V(e.closingElement.tagName),Iu()||C))(e);case 250:return(e=>(Du(e),Iu()||C))(e);case 254:return((e,t)=>_u(e.parent,void 0,t))(e,t);case 251:Jm.Debug.fail("Shouldn't ever directly check a JsxOpeningElement")}return K})(e,t),t),!jd(t)||179===e.parent.kind&&e.parent.expression===e||180===e.parent.kind&&e.parent.expression===e||(71===e.kind||143===e.kind)&&zh(e)||z(e,Jm.Diagnostics.const_enums_can_only_be_used_in_property_or_index_access_expressions_or_the_right_hand_side_of_an_import_declaration_or_export_assignment),t}function lp(e){e.expression&&ie(e.expression,Jm.Diagnostics.Type_expected),ne(e.constraint),ne(e.default);var t=ji(W(e)),r=(Ts(t)||z(e.constraint,Jm.Diagnostics.Type_parameter_0_has_a_circular_constraint,J(t)),xs(t)===Et&&z(e.default,Jm.Diagnostics.Type_parameter_0_has_a_circular_default,J(t)),ys(t)),t=Es(t);r&&t&&Mo(t,Zi(r,t),e.default,Jm.Diagnostics.Type_0_does_not_satisfy_the_constraint_1),G&&_h(e.name,Jm.Diagnostics.Type_parameter_name_cannot_be_0)}function cp(e){Cm(e)||wm(e),eh(e);var t=Jm.getContainingFunction(e);!Jm.hasModifier(e,92)||152===t.kind&&Jm.nodeIsPresent(t.body)||z(e,Jm.Diagnostics.A_parameter_property_is_only_allowed_in_a_constructor_implementation),e.questionToken&&Jm.isBindingPattern(e.name)&&t.body&&z(e,Jm.Diagnostics.A_binding_pattern_parameter_cannot_be_optional_in_an_implementation_signature),e.name&&Jm.isIdentifier(e.name)&&("this"===e.name.escapedText||"new"===e.name.escapedText)&&(0!==Jm.indexOf(t.parameters,e)&&z(e,Jm.Diagnostics.A_0_parameter_must_be_the_first_parameter,e.name.escapedText),152!==t.kind&&156!==t.kind&&161!==t.kind||z(e,Jm.Diagnostics.A_constructor_cannot_have_a_this_parameter)),!e.dotDotDotToken||Jm.isBindingPattern(e.name)||al(Y(e.symbol))||z(e,Jm.Diagnostics.A_rest_parameter_must_be_of_an_array_type)}function up(e){var t=(e=>{switch(e.parent.kind){case 187:case 155:case 228:case 186:case 160:case 151:case 150:var t=e.parent;if(e===t.type)return t}})(e);if(t){var r=Us(t).typePredicate;if(r){ne(e.type);var n,i=e.parameterName;if(Jm.isThisTypePredicate(r))mo(i);else if(0<=r.parameterIndex)t.parameters[r.parameterIndex].dotDotDotToken?z(i,Jm.Diagnostics.A_type_predicate_cannot_reference_a_rest_parameter):(n=Jm.chainDiagnosticMessages(void 0,Jm.Diagnostics.A_type_predicate_s_type_must_be_assignable_to_its_parameter_s_type),Mo(r.type,Jh(t.parameters[r.parameterIndex]),e.type,void 0,n));else if(i){for(var s=!1,a=0,o=t.parameters;a<o.length;a++){var l=o[a].name;if(Jm.isBindingPattern(l)&&function e(t,r,n){for(var i=0,s=t.elements;i<s.length;i++){var a=s[i];if(!Jm.isOmittedExpression(a)){a=a.name;if(71===a.kind&&a.escapedText===n)return z(r,Jm.Diagnostics.A_type_predicate_cannot_reference_element_0_in_a_binding_pattern,n),!0;if((175===a.kind||174===a.kind)&&e(a,r,n))return!0}}}(l,i,r.parameterName)){s=!0;break}}s||z(e.parameterName,Jm.Diagnostics.Cannot_find_parameter_0,r.parameterName)}}}else z(e,Jm.Diagnostics.A_type_predicate_is_only_allowed_in_return_type_position_for_functions_and_methods)}function dp(e){if(157===e.kind){if(!Cm(r=e)&&!wm(r)){var t=r.parameters[0];1!==r.parameters.length?H(t?t.name:r,Jm.Diagnostics.An_index_signature_must_have_exactly_one_parameter):t.dotDotDotToken?H(t.dotDotDotToken,Jm.Diagnostics.An_index_signature_cannot_have_a_rest_parameter):Jm.hasModifiers(t)?H(t.name,Jm.Diagnostics.An_index_signature_parameter_cannot_have_an_accessibility_modifier):t.questionToken?H(t.questionToken,Jm.Diagnostics.An_index_signature_parameter_cannot_have_a_question_mark):t.initializer?H(t.name,Jm.Diagnostics.An_index_signature_parameter_cannot_have_an_initializer):t.type?136!==t.type.kind&&133!==t.type.kind?H(t.name,Jm.Diagnostics.An_index_signature_parameter_type_must_be_string_or_number):r.type||H(r,Jm.Diagnostics.An_index_signature_must_have_a_type_annotation):H(t.name,Jm.Diagnostics.An_index_signature_parameter_must_have_a_type_annotation)}}else 160!==e.kind&&228!==e.kind&&161!==e.kind&&155!==e.kind&&152!==e.kind&&156!==e.kind||Nm(e);var r=Jm.getFunctionFlags(e);if(4&r||(3==(3&r)&&j<5&&Sm(e,6144),2==(3&r)&&j<4&&Sm(e,64),0!=(3&r)&&j<2&&Sm(e,128)),yh(e.typeParameters),Jm.forEach(e.parameters,cp),e.type&&ne(e.type),G){t=e,!Jm.hasRestParameter(t)||Jm.isInAmbientContext(t)||Jm.nodeIsMissing(t.body)||Jm.forEach(t.parameters,function(e){e.name&&!Jm.isBindingPattern(e.name)&&e.name.escapedText===Xe.escapedName&&z(e,Jm.Diagnostics.Duplicate_identifier_arguments_Compiler_uses_arguments_to_initialize_rest_parameters)});var n,i,s=Jm.getEffectiveReturnTypeNode(e);if(_&&!s)switch(e.kind){case 156:z(e,Jm.Diagnostics.Construct_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type);break;case 155:z(e,Jm.Diagnostics.Call_signature_which_lacks_return_type_annotation_implicitly_has_an_any_return_type)}s&&(1==(5&(n=Jm.getFunctionFlags(e)))?(i=re(s))===ft?z(s,Jm.Diagnostics.A_generator_cannot_have_a_void_type_annotation):Mo((2&n?Oa:La)(dh(i,0!=(2&n))||C),i,s):2==(3&n)&&Ap(e)),k&&!e.body&&Hp(e)}}function pp(e){for(var t=Jm.createMap(),r=0,n=e.members;r<n.length;r++){var i=n[r];if(148===i.kind){var s=void 0;switch(i.name.kind){case 9:case 8:s=i.name.text;break;case 71:s=Jm.idText(i.name);break;default:continue}t.get(s)?(z(Jm.getNameOfDeclaration(i.symbol.valueDeclaration),Jm.Diagnostics.Duplicate_identifier_0,s),z(i.name,Jm.Diagnostics.Duplicate_identifier_0,s)):t.set(s,!0)}}}function hp(e){if(230===e.kind){var t=W(e);if(0<t.declarations.length&&t.declarations[0]!==e)return}t=Js(W(e));if(t)for(var r=!1,n=!1,i=0,s=t.declarations;i<s.length;i++){var a=s[i];if(1===a.parameters.length&&a.parameters[0].type)switch(a.parameters[0].type.kind){case 136:n?z(a,Jm.Diagnostics.Duplicate_string_index_signature):n=!0;break;case 133:r?z(a,Jm.Diagnostics.Duplicate_number_index_signature):r=!0}}}function mp(e){Cm(e)||wm(e)||(e=>{if(Jm.isClassLike(e.parent)){if(Vm(e.name,Jm.Diagnostics.A_computed_property_name_in_a_class_property_declaration_must_directly_refer_to_a_built_in_symbol))return 1}else if(230===e.parent.kind){if(Vm(e.name,Jm.Diagnostics.A_computed_property_name_in_an_interface_must_directly_refer_to_a_built_in_symbol))return 1;if(e.initializer)return H(e.initializer,Jm.Diagnostics.An_interface_property_cannot_have_an_initializer)}else if(163===e.parent.kind){if(Vm(e.name,Jm.Diagnostics.A_computed_property_name_in_a_type_literal_must_directly_refer_to_a_built_in_symbol))return 1;if(e.initializer)return H(e.initializer,Jm.Diagnostics.A_type_literal_property_cannot_have_an_initializer)}return Jm.isInAmbientContext(e)&&e.initializer&&ie(e.initializer,Jm.Diagnostics.Initializers_are_not_allowed_in_ambient_contexts)})(e)||Mm(e.name),eh(e)}function gp(e){if(dp(e),!(e=>e.typeParameters&&zm(e,e.typeParameters.pos,e.typeParameters.end-e.typeParameters.pos,Jm.Diagnostics.Type_parameters_cannot_appear_on_a_constructor_declaration))(e)){var t;if((t=e).type)H(t.type,Jm.Diagnostics.Type_annotation_cannot_appear_on_a_constructor_declaration)}ne(e.body),Fp(e);var t=W(e),r=Jm.getDeclarationOfKind(t,e.kind);if(e===r&&xp(t),!Jm.nodeIsMissing(e.body)&&G){r=e.parent;if(Jm.getClassExtendsHeritageClauseElement(r)){Pc(e.parent,r);var r=Bc(r),n=Fc(e);if(n){if(r&&z(n,Jm.Diagnostics.A_constructor_cannot_contain_a_super_call_when_its_class_extends_null),Jm.some(e.parent.members,function(e){return 149===e.kind&&!Jm.hasModifier(e,32)&&!!e.initializer})||Jm.some(e.parameters,function(e){return Jm.hasModifier(e,92)})){for(var i=void 0,s=0,a=e.body.statements;s<a.length;s++){var o=a[s];if(210===o.kind&&Jm.isSuperCall(o.expression)){i=o;break}if(!Jm.isPrologueDirective(o))break}i||z(e,Jm.Diagnostics.A_super_call_must_be_the_first_statement_in_the_constructor_when_a_class_contains_initialized_properties_or_has_parameter_properties)}}else r||z(e,Jm.Diagnostics.Constructors_for_derived_classes_must_contain_a_super_call)}}}function fp(e){var t,r,n;G&&(Nm(e)||(e=>{var t,r=e.kind;return j<1?H(e.name,Jm.Diagnostics.Accessors_are_only_available_when_targeting_ECMAScript_5_and_higher):Jm.isInAmbientContext(e)?H(e.name,Jm.Diagnostics.An_accessor_cannot_be_declared_in_an_ambient_context):void 0!==e.body||Jm.hasModifier(e,128)?e.body&&Jm.hasModifier(e,128)?H(e,Jm.Diagnostics.An_abstract_accessor_cannot_have_an_implementation):e.typeParameters?H(e.name,Jm.Diagnostics.An_accessor_cannot_have_type_parameters):(e=>Um(e)||e.parameters.length===(153===e.kind?0:1))(e)?154===r&&(e.type?H(e.name,Jm.Diagnostics.A_set_accessor_cannot_have_a_return_type_annotation):(t=e.parameters[0]).dotDotDotToken?H(t.dotDotDotToken,Jm.Diagnostics.A_set_accessor_cannot_have_rest_parameter):t.questionToken?H(t.questionToken,Jm.Diagnostics.A_set_accessor_cannot_have_an_optional_parameter):t.initializer&&H(e.name,Jm.Diagnostics.A_set_accessor_parameter_cannot_have_an_initializer)):H(e.name,153===r?Jm.Diagnostics.A_get_accessor_cannot_have_parameters:Jm.Diagnostics.A_set_accessor_must_have_exactly_one_parameter):zm(e,e.end-1,";".length,Jm.Diagnostics._0_expected,"{")})(e)||Mm(e.name),Lp(e),dp(e),153===e.kind&&!Jm.isInAmbientContext(e)&&Jm.nodeIsPresent(e.body)&&128&e.flags&&(256&e.flags||z(e.name,Jm.Diagnostics.A_get_accessor_must_return_a_value)),144===e.name.kind&&du(e.name),!Jm.hasDynamicName(e)&&(t=153===e.kind?154:153,t=Jm.getDeclarationOfKind(e.symbol,t))&&((28&(n=Jm.getModifierFlags(e)))!=(28&(r=Jm.getModifierFlags(t)))&&z(e.name,Jm.Diagnostics.Getter_and_setter_accessors_do_not_agree_in_visibility),(128&n)!=(128&r)&&z(e.name,Jm.Diagnostics.Accessors_must_both_be_abstract_or_non_abstract),_p(e,t,_i,Jm.Diagnostics.get_and_set_accessor_must_have_the_same_type),_p(e,t,yi,Jm.Diagnostics.get_and_set_accessor_must_have_the_same_this_type)),n=bi(W(e)),153===e.kind)&&Pd(e,n),ne(e.body),Fp(e)}function _p(e,t,r,n){var i=r(e),r=r(t);i&&r&&!Do(i,r)&&z(e,n)}function yp(e,t){for(var r,n,i=Bs(e),s=!0,a=0;a<e.length;a++){var o,l=ys(e[a]);l&&(r||(n=yo(e,r=$s(Jm.map(t,re),e,i,Jm.isInJavaScriptFile(t[a])))),o=r[a],s=s&&Mo(o,U(l,n),t[a],Jm.Diagnostics.Type_0_does_not_satisfy_the_constraint_1))}return s}function bp(e){Om(e,e.typeArguments),159!==e.kind||void 0===e.typeName.jsdocDotPos||Jm.isInJavaScriptFile(e)||Jm.isInJSDoc(e)||zm(e,e.typeName.jsdocDotPos,1,Jm.Diagnostics.JSDoc_types_can_only_be_used_inside_documentation_comments);var t=pa(e);if(t!==K){if(e.typeArguments&&(Jm.forEach(e.typeArguments,ne),G)){var r=b(e).resolvedSymbol;if(!r)return void(Jm.isJSDocIndexSignature(e)||z(e,Jm.Diagnostics.Type_0_is_not_generic,J(t)));r=524288&r.flags&&d(r).typeParameters;yp(r=!r&&4&O(t)?t.target.localTypeParameters:r,e.typeArguments)}16&t.flags&&8&b(e).resolvedSymbol.flags&&z(e,Jm.Diagnostics.Enum_type_0_has_members_with_initializers_that_are_not_literals,J(t))}}function vp(e,t){var r,n;return 524288&e.flags&&(x(n=e.indexType,qa(r=e.objectType))?180===t.kind&&Jm.isAssignmentTarget(t)&&32&O(r)&&r.declaration.readonlyToken&&z(t,Jm.Diagnostics.Index_signature_in_type_0_only_permits_reading,J(r)):L(Q(r),1)&&Gd(n,84)||z(t,Jm.Diagnostics.Type_0_cannot_be_used_to_index_type_1,J(n),J(r))),e}function Tp(e){return Jm.hasModifier(e,8)&&Jm.isInAmbientContext(e)}function kp(e,t){var r=Jm.getCombinedModifierFlags(e);return 230!==e.parent.kind&&229!==e.parent.kind&&199!==e.parent.kind&&Jm.isInAmbientContext(e)&&(2&r||(r|=1),r|=2),r&t}function xp(e){if(G){for(var t,r,n,i,s,a,o,l,c=0,u=155,d=!1,p=!0,h=!1,m=e.declarations,g=0!=(16384&e.flags),f=!1,_=!1,y=0,b=m;y<b.length;y++){var v,T=b[y],k=Jm.isInAmbientContext(T),k=230===T.parent.kind||163===T.parent.kind||k;k&&(n=void 0),228!==T.kind&&151!==T.kind&&150!==T.kind&&152!==T.kind||(c|=v=kp(T,155),u&=v,d=d||Jm.hasQuestionToken(T),p=p&&Jm.hasQuestionToken(T),Jm.nodeIsPresent(T.body)&&t?g?_=!0:f=!0:n&&n.parent===T.parent&&n.end!==T.pos&&I(n),Jm.nodeIsPresent(T.body)?t=t||T:h=!0,n=T,k)||(r=T)}if(_&&Jm.forEach(m,function(e){z(e,Jm.Diagnostics.Multiple_constructor_implementations_are_not_allowed)}),f&&Jm.forEach(m,function(e){z(Jm.getNameOfDeclaration(e),Jm.Diagnostics.Duplicate_function_implementation)}),!r||r.body||Jm.hasModifier(r,128)||r.questionToken||I(r),h&&(s=m,a=t,o=155,0!=(c^u)&&(l=kp(w(s,a),o),Jm.forEach(s,function(e){var t=kp(e,o)^l;1&t?z(Jm.getNameOfDeclaration(e),Jm.Diagnostics.Overload_signatures_must_all_be_exported_or_non_exported):2&t?z(Jm.getNameOfDeclaration(e),Jm.Diagnostics.Overload_signatures_must_all_be_ambient_or_non_ambient):24&t?z(Jm.getNameOfDeclaration(e)||e,Jm.Diagnostics.Overload_signatures_must_all_be_public_private_or_protected):128&t&&z(Jm.getNameOfDeclaration(e),Jm.Diagnostics.Overload_signatures_must_all_be_abstract_or_non_abstract)})),a=m,s=t,d!==p&&(i=Jm.hasQuestionToken(w(a,s)),Jm.forEach(a,function(e){Jm.hasQuestionToken(e)!==i&&z(Jm.getNameOfDeclaration(e),Jm.Diagnostics.Overload_signatures_must_all_be_optional_or_required)})),t))for(var m=Vs(e),x=Us(t),E=0,S=m;E<S.length;E++){var C=S[E];if(!$o(x,C)){z(C.declaration,Jm.Diagnostics.Overload_signature_is_not_compatible_with_function_implementation);break}}}function w(e,t){return void 0!==t&&t.parent===e[0].parent?t:e[0]}function I(t){if(!t.name||!Jm.nodeIsMissing(t.name)){var r=!1,e=Jm.forEachChild(t.parent,function(e){if(r)return e;r=e===t});if(e&&e.pos===t.end&&e.kind===t.kind){var n=e.name||e,i=e.name;if(t.name&&i&&(Jm.isComputedPropertyName(t.name)&&Jm.isComputedPropertyName(i)||!Jm.isComputedPropertyName(t.name)&&!Jm.isComputedPropertyName(i)&&Jm.getEscapedTextOfIdentifierOrLiteral(t.name)===Jm.getEscapedTextOfIdentifierOrLiteral(i)))return void((151===t.kind||150===t.kind)&&Jm.hasModifier(t,32)!==Jm.hasModifier(e,32)&&z(n,Jm.hasModifier(t,32)?Jm.Diagnostics.Function_overload_must_be_static:Jm.Diagnostics.Function_overload_must_not_be_static));if(Jm.nodeIsPresent(e.body))return void z(n,Jm.Diagnostics.Function_implementation_name_must_be_0,Jm.declarationNameToString(t.name))}i=t.name||t;g?z(i,Jm.Diagnostics.Constructor_implementation_is_missing):Jm.hasModifier(t,128)?z(i,Jm.Diagnostics.All_declarations_of_an_abstract_method_must_be_consecutive):z(i,Jm.Diagnostics.Function_implementation_is_missing_or_not_immediately_following_the_declaration)}}}function Ep(e){if(G){var t=e.localSymbol;if((t||(t=W(e)).exportSymbol)&&Jm.getDeclarationOfKind(t,e.kind)===e){for(var r=0,n=0,i=0,s=0,a=t.declarations;s<a.length;s++){var o=g(h=a[s]),l=kp(h,513);1&l?512&l?i|=o:r|=o:n|=o}var c=r&n,u=i&(r|n);if(c||u)for(var d=0,p=t.declarations;d<p.length;d++){var h,o=g(h=p[d]),m=Jm.getNameOfDeclaration(h);o&u?z(m,Jm.Diagnostics.Merged_declaration_0_cannot_include_a_default_export_declaration_Consider_adding_a_separate_export_default_0_declaration_instead,Jm.declarationNameToString(m)):o&c&&z(m,Jm.Diagnostics.Individual_declarations_in_merged_declaration_0_must_be_all_exported_or_all_local,Jm.declarationNameToString(m))}0}}function g(e){switch(e.kind){case 230:case 231:case 283:return 2;case 233:return Jm.isAmbientModule(e)||0!==Jm.getModuleInstanceState(e)?5:4;case 229:case 232:return 3;case 237:case 240:case 239:var t=0,r=nn(W(e));return Jm.forEach(r.declarations,function(e){t|=g(e)}),t;case 226:case 176:case 228:case 242:return 1;default:Jm.Debug.fail(Jm.SyntaxKind[e.kind])}}}function Sp(e,t,r){e=Cp(e,t);return e&&Ip(e,t,r)}function Cp(e,t){if(!D(e)){var r=e;if(r.promisedTypeOfPromise)return r.promisedTypeOfPromise;if(ki(e,va(!1)))return r.promisedTypeOfPromise=e.typeArguments[0];e=ni(e,"then");if(!D(e)){e=e?ee(e,0):Jm.emptyArray;if(0===e.length)t&&z(t,Jm.Diagnostics.A_promise_must_have_a_then_method);else{e=Xl(P(Jm.map(e,wd)),524288);if(!D(e)){e=ee(e,0);if(0!==e.length)return r.promisedTypeOfPromise=P(Jm.map(e,wd),!0);t&&z(t,Jm.Diagnostics.The_first_parameter_of_the_then_method_of_a_promise_must_be_a_callback)}}}}}function wp(e,t,r){return Ip(e,t,r)||K}function Ip(e,t,r){var n=e;if(n.awaitedTypeOfType)return n.awaitedTypeOfType;if(D(e))return n.awaitedTypeOfType=e;if(65536&e.flags){for(var i=void 0,s=0,a=e.types;s<a.length;s++)var o=a[s],i=Jm.append(i,Ip(o,t,r));return i?n.awaitedTypeOfType=P(i):void 0}var l=Cp(e);if(l){if(e.id===l.id||0<=Jm.indexOf(ir,l.id))return void(t&&z(t,Jm.Diagnostics.Type_is_referenced_directly_or_indirectly_in_the_fulfillment_callback_of_its_own_then_method));ir.push(e.id);l=Ip(l,t,r);return(ir.pop(),l)?n.awaitedTypeOfType=l:void 0}l=ni(e,"then");if(!(l&&0<ee(l,0).length))return n.awaitedTypeOfType=e;t&&(Jm.Debug.assert(!!r),z(t,r))}function Ap(e){var t=Jm.getEffectiveReturnTypeNode(e),r=re(t);if(2<=j){if(r===K)return K;var n=va(!0);if(n!==Tt&&!ki(r,n))return z(t,Jm.Diagnostics.The_return_type_of_an_async_function_or_method_must_be_the_global_Promise_T_type),K}else{if(Np((n=t)&&Jm.getEntityNameFromTypeNode(n)),r===K)return K;var i=Jm.getEntityNameFromTypeNode(t);if(void 0===i)return z(t,Jm.Diagnostics.Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Promise_compatible_constructor_value,J(r)),K;var s=cn(i,107455,!0),s=s?Y(s):K;if(s===K)return 71===i.kind&&"Promise"===i.escapedText&&xi(r)===va(!1)?z(t,Jm.Diagnostics.An_async_function_or_method_in_ES5_SlashES3_requires_the_Promise_constructor_Make_sure_you_have_a_declaration_for_the_Promise_constructor_or_include_ES2015_in_your_lib_option):z(t,Jm.Diagnostics.Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Promise_compatible_constructor_value,Jm.entityNameToString(i)),K;var a=(Ne=Ne||ya("PromiseConstructorLike",0,!0))||N;if(a===N)return z(t,Jm.Diagnostics.Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Promise_compatible_constructor_value,Jm.entityNameToString(i)),K;if(!Mo(s,a,t,Jm.Diagnostics.Type_0_is_not_a_valid_async_function_return_type_in_ES5_SlashES3_because_it_does_not_refer_to_a_Promise_compatible_constructor_value))return K;s=i&&Ih(i),a=Gr(e.locals,s.escapedText,107455);if(a)return z(a.valueDeclaration,Jm.Diagnostics.Duplicate_identifier_0_Compiler_uses_declaration_1_to_support_async_functions,Jm.idText(s),Jm.entityNameToString(i)),K}return wp(r,e,Jm.Diagnostics.The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member)}function Dp(e){var t=te(_d(e));if(!(1&t.flags)){var r,n=pd(e);switch(e.parent.kind){case 229:var i=P([Y(W(e.parent)),ft]);break;case 146:i=ft,r=Jm.chainDiagnosticMessages(r,Jm.Diagnostics.The_return_type_of_a_parameter_decorator_function_must_be_either_void_or_any);break;case 149:i=ft,r=Jm.chainDiagnosticMessages(r,Jm.Diagnostics.The_return_type_of_a_property_decorator_function_must_be_either_void_or_any);break;case 151:case 153:case 154:i=P([Na(Jh(e.parent)),ft])}Mo(t,i,e,n,r)}}function Np(e){var t;e&&(t=Ih(e),e=2097152|(71===e.kind?793064:1920),t=Kr(t,t.escapedText,e,void 0,void 0,!0))&&2097152&t.flags&&En(t)&&!om(nn(t))&&an(t)}function Op(e){e=function e(t){if(t)switch(t.kind){case 167:case 166:for(var r=void 0,n=0,i=t.types;n<i.length;n++){var s=i[n],s=e(s);if(!s)return;if(r){if(!Jm.isIdentifier(r)||!Jm.isIdentifier(s)||r.escapedText!==s.escapedText)return}else r=s}return r;case 168:return e(t.type);case 159:return t.typeName}}(e);e&&Jm.isEntityName(e)&&Np(e)}function Rp(e){var t=Jm.getEffectiveTypeAnnotationNode(e);return Jm.isRestParameter(e)?Jm.getRestParameterElementType(t):t}function Lp(e){if(e.decorators&&Jm.nodeCanBeDecorated(e)){M.experimentalDecorators||z(e,Jm.Diagnostics.Experimental_support_for_decorators_is_a_feature_that_is_subject_to_change_in_a_future_release_Set_the_experimentalDecorators_option_to_remove_this_warning);var t=e.decorators[0];if(Sm(t,8),146===e.kind&&Sm(t,32),M.emitDecoratorMetadata)switch(Sm(t,16),e.kind){case 229:var r=Jm.getFirstConstructorWithBody(e);if(r)for(var n=0,i=r.parameters;n<i.length;n++)Op(Rp(i[n]));break;case 151:case 153:case 154:for(var s=0,a=e.parameters;s<a.length;s++)Op(Rp(a[s]));Op(Jm.getEffectiveReturnTypeNode(e));break;case 149:Op(Jm.getEffectiveTypeAnnotationNode(e));break;case 146:Op(Rp(e))}Jm.forEach(e.decorators,Dp)}}function Pp(e){switch(e.kind){case 71:return e;case 179:return e.name;default:return}}function Mp(t){Lp(t),dp(t);var e,r,n=Jm.getFunctionFlags(t),i=(t.name&&144===t.name.kind&&du(t.name),Jm.hasDynamicName(t)||(e=W(t),r=t.localSymbol||e,i=Jm.find(r.declarations,function(e){return e.kind===t.kind&&!(65536&e.flags)}),t===i&&xp(r),e.parent&&Jm.getDeclarationOfKind(e,t.kind)===t&&xp(e)),ne(t.body),Jm.getEffectiveReturnTypeNode(t));0==(1&n)&&(r=i&&(2&n?Ap(t):re(i)),Pd(t,r)),G&&!i&&(_&&Jm.nodeIsMissing(t.body)&&!Tp(t)&&Cl(t,C),1&n)&&Jm.nodeIsPresent(t.body)&&te(Us(t)),Fp(t)}function Fp(e){Ge&&Ge.push(e)}function Bp(){if(Ge)for(var e=0,t=Ge;e<t.length;e++){var r=t[e];switch(r.kind){case 265:case 233:c=r,M.noUnusedLocals&&!Jm.isInAmbientContext(c)&&c.locals.forEach(function(e){if(!e.isReferenced&&!e.exportSymbol)for(var t=0,r=e.declarations;t<r.length;t++){var n=r[t];Jm.isAmbientModule(n)||Up(n,Jm.symbolName(e))}});break;case 229:case 199:l=o=a=s=i=n=c=void 0;c=r;if(M.noUnusedLocals&&!Jm.isInAmbientContext(c)&&c.members)for(var n=0,i=c.members;n<i.length;n++){var s=i[n];if(151===s.kind||149===s.kind)!s.symbol.isReferenced&&Jm.hasModifier(s,8)&&z(s.name,Jm.Diagnostics._0_is_declared_but_its_value_is_never_read,Jm.symbolName(s.symbol));else if(152===s.kind)for(var a=0,o=s.parameters;a<o.length;a++){var l=o[a];!l.symbol.isReferenced&&Jm.hasModifier(l,8)&&z(l.name,Jm.Diagnostics.Property_0_is_declared_but_its_value_is_never_read,Jm.symbolName(l.symbol))}}Hp(r);break;case 230:Hp(r);break;case 207:case 235:case 214:case 215:case 216:$p(r);break;case 152:case 186:case 228:case 187:case 151:case 153:case 154:r.body&&$p(r),Hp(r);break;case 150:case 155:case 156:case 157:case 160:case 161:case 231:Hp(r)}}var c}function $p(e){230!==e.parent.kind&&k&&!Jm.isInAmbientContext(e)&&e.locals.forEach(function(t){var e,r;t.isReferenced||(t.valueDeclaration&&146===Jm.getRootDeclaration(t.valueDeclaration).kind?(r=Jm.getRootDeclaration(t.valueDeclaration),e=Jm.getNameOfDeclaration(t.valueDeclaration),!M.noUnusedParameters||Jm.isParameterPropertyDeclaration(r)||Jm.parameterIsThisKeyword(r)||(r=e)&&Vp(r)||z(e,Jm.Diagnostics._0_is_declared_but_its_value_is_never_read,Jm.symbolName(t))):M.noUnusedLocals&&Jm.forEach(t.declarations,function(e){return Up(e,Jm.symbolName(t))}))})}function Up(e,t){e=Jm.getNameOfDeclaration(e)||e;if(Vp(e)){var r=Jm.getRootDeclaration(e.parent);if(226===r.kind&&Jm.isForInOrOfStatement(r.parent.parent)||145===r.kind)return}(e=>{var t;return Jm.isBindingElement(e)&&Jm.isObjectBindingPattern(e.parent)&&(t=Jm.lastOrUndefined(e.parent.elements))!==e&&t.dotDotDotToken})(71===e.kind?e.parent:e)||z(e,Jm.Diagnostics._0_is_declared_but_its_value_is_never_read,t)}function Vp(e){return 71===e.kind&&95===Jm.idText(e).charCodeAt(0)}function Hp(e){if(M.noUnusedLocals&&!Jm.isInAmbientContext(e)&&e.typeParameters){var t=W(e),t=t&&t.declarations&&Jm.lastOrUndefined(t.declarations);if(t===e)for(var r=0,n=e.typeParameters;r<n.length;r++){var i=n[r];Tn(i.symbol).isReferenced||Vp(i.name)||z(i.name,Jm.Diagnostics._0_is_declared_but_its_value_is_never_read,Jm.symbolName(i.symbol))}}}function Gp(e){var t;207===e.kind&&Wm(e),Jm.isFunctionOrModuleBlock(e)?(t=$t,Jm.forEach(e.statements,ne),$t=t):Jm.forEach(e.statements,ne),e.locals&&Fp(e)}function jp(e,t,r){return!t||t.escapedText!==r||149===e.kind||148===e.kind||151===e.kind||150===e.kind||153===e.kind||154===e.kind||Jm.isInAmbientContext(e)||146===(t=Jm.getRootDeclaration(e)).kind&&Jm.nodeIsMissing(t.parent.body)?void 0:1}function Kp(e,t){jp(e,t,"_this")&&rr.push(e)}function zp(e,t){jp(e,t,"_newTarget")&&nr.push(e)}function Wp(t){Jm.findAncestor(t,function(e){if(4&dm(e))return 71!==t.kind?z(Jm.getNameOfDeclaration(t),Jm.Diagnostics.Duplicate_identifier_this_Compiler_uses_variable_declaration_this_to_capture_this_reference):z(t,Jm.Diagnostics.Expression_resolves_to_variable_declaration_this_that_compiler_uses_to_capture_this_reference),!0})}function qp(t){Jm.findAncestor(t,function(e){if(8&dm(e))return 71!==t.kind?z(Jm.getNameOfDeclaration(t),Jm.Diagnostics.Duplicate_identifier_newTarget_Compiler_uses_variable_declaration_newTarget_to_capture_new_target_meta_property_reference):z(t,Jm.Diagnostics.Expression_resolves_to_variable_declaration_newTarget_that_compiler_uses_to_capture_new_target_meta_property_reference),!0})}function Jp(e,t){jp(e,t,"_super")&&(t=Jm.getContainingClass(e))&&!Jm.isInAmbientContext(t)&&Jm.getClassExtendsHeritageClauseElement(t)&&z(e,71!==e.kind?Jm.Diagnostics.Duplicate_identifier_super_Compiler_uses_super_to_capture_base_class_reference:Jm.Diagnostics.Expression_resolves_to_super_that_compiler_uses_to_capture_base_class_reference)}function Yp(e,t){ae>=Jm.ModuleKind.ES2015||!jp(e,t,"require")&&!jp(e,t,"exports")||233===e.kind&&1!==Jm.getModuleInstanceState(e)||265===(e=ri(e)).kind&&Jm.isExternalOrCommonJsModule(e)&&z(t,Jm.Diagnostics.Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module,Jm.declarationNameToString(t),Jm.declarationNameToString(t))}function Xp(e,t){4<=j||!jp(e,t,"Promise")||233===e.kind&&1!==Jm.getModuleInstanceState(e)||265===(e=ri(e)).kind&&Jm.isExternalOrCommonJsModule(e)&&1024&e.flags&&z(t,Jm.Diagnostics.Duplicate_identifier_0_Compiler_reserves_name_1_in_top_level_scope_of_a_module_containing_async_functions,Jm.declarationNameToString(t),Jm.declarationNameToString(t))}function Zp(i){var s;146===Jm.getRootDeclaration(i).kind&&(s=Jm.getContainingFunction(i),function e(t){if(Jm.isTypeNode(t)||Jm.isDeclarationName(t))return;{if(179===t.kind)return e(t.expression);if(71!==t.kind)return Jm.forEachChild(t,e);var r=Kr(t,t.escapedText,2204607,void 0,void 0,!1);if(r&&r!==B&&r.valueDeclaration)if(r.valueDeclaration===i)z(t,Jm.Diagnostics.Parameter_0_cannot_be_referenced_in_its_initializer,Jm.declarationNameToString(i.name));else{var n=Jm.getEnclosingBlockScopeContainer(r.valueDeclaration);if(n===s){if(146===r.valueDeclaration.kind||176===r.valueDeclaration.kind){if(r.valueDeclaration.pos<i.pos)return;if(Jm.findAncestor(t,function(e){return e===i.initializer?"quit":Jm.isFunctionLike(e.parent)||149===e.parent.kind&&!Jm.hasModifier(e.parent,32)&&Jm.isClassLike(e.parent.parent)}))return}z(t,Jm.Diagnostics.Initializer_of_parameter_0_cannot_reference_identifier_1_declared_after_it,Jm.declarationNameToString(i.name),Jm.declarationNameToString(t))}}}}(i.initializer))}function Qp(e){return e===at?C:e===Ee?xe:e}function eh(e){if(Lp(e),ne(e.type),e.name)if(144===e.name.kind&&(du(e.name),e.initializer)&&tp(e.initializer),176===e.kind&&(174===e.parent.kind&&j<5&&Sm(e,4),e.propertyName&&144===e.propertyName.kind&&du(e.propertyName),r=ii(t=e.parent.parent),n=e.propertyName||e.name,Gu(n=R(r,Jm.getTextOfPropertyName(n)),void 0,!1),t.initializer)&&n&&Lu(t,t.initializer,r,n),Jm.isBindingPattern(e.name)&&(175===e.name.kind&&j<2&&M.downlevelIteration&&Sm(e,512),Jm.forEach(e.name.elements,ne)),e.initializer&&146===Jm.getRootDeclaration(e).kind&&Jm.nodeIsMissing(Jm.getContainingFunction(e).body))z(e,Jm.Diagnostics.A_parameter_initializer_is_only_allowed_in_a_function_or_constructor_implementation);else if(Jm.isBindingPattern(e.name))e.initializer&&215!==e.parent.parent.kind&&(Mo(tp(e.initializer),mi(e),e,void 0),Zp(e));else{var t=W(e),r=Qp(fi(t));if(e===t.valueDeclaration?e.initializer&&215!==e.parent.parent.kind&&(Mo(tp(e.initializer),r,e,void 0),Zp(e)):(n=Qp(mi(e)),r===K||n===K||Do(r,n)||z(e.name,Jm.Diagnostics.Subsequent_variable_declarations_must_have_the_same_type_Variable_0_must_be_of_type_1_but_here_has_type_2,Jm.declarationNameToString(e.name),J(r),J(n)),e.initializer&&Mo(tp(e.initializer),n,e,void 0),((e,t)=>146===e.kind&&226===t.kind||226===e.kind&&146===t.kind||Jm.hasQuestionToken(e)===Jm.hasQuestionToken(t)&&Jm.getSelectedModifierFlags(e,504)===Jm.getSelectedModifierFlags(t,504))(e,t.valueDeclaration)||(z(Jm.getNameOfDeclaration(t.valueDeclaration),Jm.Diagnostics.All_declarations_of_0_must_have_identical_modifiers,Jm.declarationNameToString(e.name)),z(e.name,Jm.Diagnostics.All_declarations_of_0_must_have_identical_modifiers,Jm.declarationNameToString(e.name)))),149!==e.kind&&148!==e.kind){if(Ep(e),226===e.kind||176===e.kind){r=e;if(0==(3&Jm.getCombinedNodeFlags(r))&&!Jm.isParameterDeclaration(r)&&(226!==r.kind||r.initializer)){var n=W(r);if(1&n.flags){if(!Jm.isIdentifier(r.name))throw Jm.Debug.fail();t=Kr(r,r.name.escapedText,3,void 0,void 0,!1);t&&t!==n&&2&t.flags&&3&Ou(t)&&((n=208===(n=Jm.getAncestor(t.valueDeclaration,227)).parent.kind&&n.parent.parent?n.parent.parent:void 0)&&(207===n.kind&&Jm.isFunctionLike(n.parent)||234===n.kind||233===n.kind||265===n.kind)||(n=q(t),z(r,Jm.Diagnostics.Cannot_initialize_outer_scoped_variable_0_in_the_same_scope_as_block_scoped_declaration_1,n,n)))}}}Jp(e,e.name),Kp(e,e.name),zp(e,e.name),Yp(e,e.name),Xp(e,e.name)}}}function th(e){return(e=>{if(215!==e.parent.parent.kind&&216!==e.parent.parent.kind)if(Jm.isInAmbientContext(e)){if(e.initializer){if(!Jm.isConst(e)||e.type)return t="=".length,zm(e,e.initializer.pos-t,t,Jm.Diagnostics.Initializers_are_not_allowed_in_ambient_contexts);if(!Gm(e.initializer))return H(e.initializer,Jm.Diagnostics.A_const_initializer_in_an_ambient_context_must_be_a_string_or_numeric_literal)}var t;if(e.initializer&&(!Jm.isConst(e)||!Gm(e.initializer)))return t="=".length,zm(e,e.initializer.pos-t,t,Jm.Diagnostics.Initializers_are_not_allowed_in_ambient_contexts)}else if(!e.initializer){if(Jm.isBindingPattern(e.name)&&!Jm.isBindingPattern(e.parent))return H(e,Jm.Diagnostics.A_destructuring_declaration_must_have_an_initializer);if(Jm.isConst(e))return H(e,Jm.Diagnostics.const_declarations_must_be_initialized)}M.module===Jm.ModuleKind.ES2015||M.module===Jm.ModuleKind.ESNext||M.module===Jm.ModuleKind.System||M.noEmit||Jm.isInAmbientContext(e.parent.parent)||!Jm.hasModifier(e.parent.parent,1)||function e(t){if(71===t.kind){if("__esModule"===Jm.idText(t))return H(t,Jm.Diagnostics.Identifier_expected_esModule_is_reserved_as_an_exported_marker_when_transforming_ECMAScript_modules)}else for(var t=t.elements,r=0,n=t;r<n.length;r++){var i=n[r];if(!Jm.isOmittedExpression(i))return e(i.name)}}(e.name),(Jm.isLet(e)||Jm.isConst(e))&&function e(t){if(71===t.kind){if(110===t.originalKeywordKind)return H(t,Jm.Diagnostics.let_is_not_allowed_to_be_used_as_a_name_in_let_or_const_declarations)}else for(var t=t.elements,r=0,n=t;r<n.length;r++){var i=n[r];Jm.isOmittedExpression(i)||e(i.name)}}(e.name)})(e),eh(e)}function rh(e){var t,r=e;if(r.dotDotDotToken)t=r.parent.elements,r!==Jm.lastOrUndefined(t)?H(r,Jm.Diagnostics.A_rest_element_must_be_last_in_a_destructuring_pattern):175===r.name.kind||174===r.name.kind?H(r.name,Jm.Diagnostics.A_rest_element_cannot_contain_a_binding_pattern):r.initializer&&zm(r,r.initializer.pos-1,1,Jm.Diagnostics.A_rest_element_cannot_have_an_initializer);return eh(e)}function nh(e){if(!(Cm(e)||wm(e)||jm(e.declarationList))){var t=e;if(!function e(t){switch(t.kind){case 211:case 212:case 213:case 220:case 214:case 215:case 216:return!1;case 222:return e(t.parent)}return!0}(t.parent))Jm.isLet(t.declarationList)?H(t,Jm.Diagnostics.let_declarations_can_only_be_declared_inside_a_block):Jm.isConst(t.declarationList)&&H(t,Jm.Diagnostics.const_declarations_can_only_be_declared_inside_a_block)}Jm.forEach(e.declarationList.declarations,ne)}function ih(e){$m(e);var t,r,n,i=Pu(e.expression);227===e.initializer.kind?((t=e.initializer.declarations[0])&&Jm.isBindingPattern(t.name)&&z(t.name,Jm.Diagnostics.The_left_hand_side_of_a_for_in_statement_cannot_be_a_destructuring_pattern),sh(e)):(r=V(t=e.initializer),177===t.kind||178===t.kind?z(t,Jm.Diagnostics.The_left_hand_side_of_a_for_in_statement_cannot_be_a_destructuring_pattern):x((n=qa(n=i))!==_t?n:$,r)?Vd(t,Jm.Diagnostics.The_left_hand_side_of_a_for_in_statement_must_be_a_variable_or_a_property_access):z(t,Jm.Diagnostics.The_left_hand_side_of_a_for_in_statement_must_be_of_type_string_or_any)),Gd(i,17317888)||z(e.expression,Jm.Diagnostics.The_right_hand_side_of_a_for_in_statement_must_be_of_type_any_an_object_type_or_a_type_parameter),ne(e.statement),e.locals&&Fp(e)}function sh(e){e=e.initializer;1<=e.declarations.length&&th(e.declarations[0])}function ah(e,t){return oh(Pu(e),e,!0,void 0!==t)}function oh(e,t,r,n){return D(e)?e:lh(e,t,r,n,!0)||C}function lh(e,t,r,n,i){var s=2<=j,a=!s&&M.downlevelIteration;if(s||a||n){n=ch(e,s?t:void 0,n,!0,i);if(n||s)return n}var o,l,i=e,s=!1,n=!1;if(r&&(65536&i.flags?(l=e.types,(o=Jm.filter(l,function(e){return!(262178&e.flags)}))!==l&&(i=P(o,!0))):262178&i.flags&&(i=_t),(n=i!==e)&&(j<1&&t&&(z(t,Jm.Diagnostics.Using_a_string_in_a_for_of_statement_is_only_supported_in_ECMAScript_5_and_higher),s=!0),8192&i.flags)))return $;return ol(i)?(l=Ns(i,1),n&&l?262178&l.flags?$:P([l,$],!0):l):(t&&!s&&z(t,!r||n?a?Jm.Diagnostics.Type_0_is_not_an_array_type_or_does_not_have_a_Symbol_iterator_method_that_returns_an_iterator:Jm.Diagnostics.Type_0_is_not_an_array_type:a?Jm.Diagnostics.Type_0_is_not_an_array_type_or_a_string_type_or_does_not_have_a_Symbol_iterator_method_that_returns_an_iterator:Jm.Diagnostics.Type_0_is_not_an_array_type_or_a_string_type,J(i)),n?$:void 0)}function ch(e,i,s,a,o){if(!D(e))return hc(e,function(e){var t=e;if(s){if(t.iteratedTypeOfAsyncIterable)return t.iteratedTypeOfAsyncIterable;if(ki(e,ka(!1))||ki(e,Ea(!1)))return t.iteratedTypeOfAsyncIterable=e.typeArguments[0]}if(a){if(t.iteratedTypeOfIterable)return t.iteratedTypeOfIterable;if(ki(e,Sa(!1))||ki(e,wa(!1)))return t.iteratedTypeOfIterable=e.typeArguments[0]}var r=s&&ni(e,Jm.getPropertyNameForKnownSymbolName("asyncIterator")),n=r||a&&ni(e,Jm.getPropertyNameForKnownSymbolName("iterator"));if(D(n))return;n=n&&ee(n,0);if(!Jm.some(n))return void(i&&(z(i,s?Jm.Diagnostics.Type_must_have_a_Symbol_asyncIterator_method_that_returns_an_async_iterator:Jm.Diagnostics.Type_must_have_a_Symbol_iterator_method_that_returns_an_iterator),i=void 0));n=uh(P(Jm.map(n,te),!0),i,!!r);o&&i&&n&&Mo(e,(r?e=>Da(ka(!0),[e]):Ra)(n),i);return r?t.iteratedTypeOfAsyncIterable=n:t.iteratedTypeOfIterable=n})}function uh(e,t,r){if(!D(e)){var n=e;if(r?n.iteratedTypeOfAsyncIterator:n.iteratedTypeOfIterator)return r?n.iteratedTypeOfAsyncIterator:n.iteratedTypeOfIterator;if(ki(e,(r?xa:Ca)(!1)))return r?n.iteratedTypeOfAsyncIterator=e.typeArguments[0]:n.iteratedTypeOfIterator=e.typeArguments[0];e=ni(e,"next");if(!D(e)){e=e?ee(e,0):Jm.emptyArray;if(0===e.length)t&&z(t,r?Jm.Diagnostics.An_async_iterator_must_have_a_next_method:Jm.Diagnostics.An_iterator_must_have_a_next_method);else{e=P(Jm.map(e,te),!0);if(!(D(e)||r&&D(e=Sp(e,t,Jm.Diagnostics.The_type_returned_by_the_next_method_of_an_async_iterator_must_be_a_promise_for_a_type_with_a_value_property)))){e=e&&ni(e,"value");if(e)return r?n.iteratedTypeOfAsyncIterator=e:n.iteratedTypeOfIterator=e;t&&z(t,r?Jm.Diagnostics.The_type_returned_by_the_next_method_of_an_async_iterator_must_be_a_promise_for_a_type_with_a_value_property:Jm.Diagnostics.The_type_returned_by_the_next_method_of_an_iterator_must_have_a_value_property)}}}}}function dh(e,t){if(!D(e))return ch(e,void 0,t,!t,!1)||uh(e,void 0,t)}function ph(e){if(!Wm(e)){for(var t=e,r=t;r;){if(Jm.isFunctionLike(r))return void H(t,Jm.Diagnostics.Jump_target_cannot_cross_function_boundary);switch(r.kind){case 222:if(t.label&&r.label.escapedText===t.label.escapedText)return void(217!==t.kind||Jm.isIterationStatement(r.statement,!0)||H(t,Jm.Diagnostics.A_continue_statement_can_only_jump_to_a_label_of_an_enclosing_iteration_statement));break;case 221:if(218!==t.kind||t.label)break;return;default:if(Jm.isIterationStatement(r,!1)&&!t.label)return}r=r.parent}e=t.label?218===t.kind?Jm.Diagnostics.A_break_statement_can_only_jump_to_a_label_of_an_enclosing_statement:Jm.Diagnostics.A_continue_statement_can_only_jump_to_a_label_of_an_enclosing_iteration_statement:218===t.kind?Jm.Diagnostics.A_break_statement_can_only_be_used_within_an_enclosing_iteration_or_switch_statement:Jm.Diagnostics.A_continue_statement_can_only_be_used_within_an_enclosing_iteration_statement,H(t,e)}}function hh(e){return 153===e.kind&&void 0!==Jm.getEffectiveSetAccessorTypeAnnotationNode(Jm.getDeclarationOfKind(e.symbol,154))}function mh(e,t){e=2==(3&Jm.getFunctionFlags(e))?Cp(t):t;return e&&Hd(e,1025)}function gh(e){if(!Wm(e)&&void 0===e.expression){var t=e,r=Jm.Diagnostics.Line_break_not_permitted_here,n=void 0,i=void 0,s=void 0,a=Jm.getSourceFileOfNode(t);if(!Km(a))t=Jm.getSpanOfTokenAtPosition(a,t.pos),sr.add(Jm.createFileDiagnostic(a,Jm.textSpanEnd(t),0,r,n,i,s))}e.expression&&V(e.expression)}function fh(r){var e,n=Ys(r.symbol,1),i=Ys(r.symbol,0),s=Ns(r,0),a=Ns(r,1);if((s||a)&&(Jm.forEach(fs(r),function(e){var t=Y(e);u(e,t,r,i,s,0),u(e,t,r,n,a,1)}),1&O(r))&&Jm.isClassLike(r.symbol.valueDeclaration))for(var t=0,o=r.symbol.valueDeclaration.members;t<o.length;t++){var l,c=o[t];!Jm.hasModifier(c,32)&&Jm.hasDynamicName(c)&&(l=Y(c.symbol),u(c.symbol,l,r,i,s,0),u(c.symbol,l,r,n,a,1))}function u(t,e,r,n,i,s){var a,o;i&&(a=t.valueDeclaration,1!==s||(a?cu(Jm.getNameOfDeclaration(a)):uu(t.escapedName)))&&(!a||194!==a.kind&&144!==Jm.getNameOfDeclaration(a).kind&&t.parent!==r.symbol?n?o=n:2&O(r)&&(o=Jm.forEach(Mi(r),function(e){return _s(e,t.escapedName)&&Ns(e,s)})?void 0:r.symbol.declarations[0]):o=a,o)&&!x(e,i)&&z(o,0===s?Jm.Diagnostics.Property_0_of_type_1_is_not_assignable_to_string_index_type_2:Jm.Diagnostics.Property_0_of_type_1_is_not_assignable_to_numeric_index_type_2,q(t),J(e),J(i))}(e=s&&a&&!(e=n||i)&&2&O(r)?Jm.forEach(Mi(r),function(e){return Ns(e,0)&&Ns(e,1)})?void 0:r.symbol.declarations[0]:e)&&!x(a,s)&&z(e,Jm.Diagnostics.Numeric_index_type_0_is_not_assignable_to_string_index_type_1,J(a),J(s))}function _h(e,t){switch(e.escapedText){case"any":case"number":case"boolean":case"string":case"symbol":case"void":case"object":z(e,t,e.escapedText)}}function yh(e){if(e)for(var t=!1,r=0;r<e.length;r++){var n=e[r];if(lp(n),G){n.default?t=!0:t&&z(n,Jm.Diagnostics.Required_type_parameters_may_not_follow_optional_type_parameters);for(var i=0;i<r;i++)e[i].symbol===n.symbol&&z(n.name,Jm.Diagnostics.Duplicate_identifier_0,Jm.declarationNameToString(n.name))}}}function bh(e){if(1!==e.declarations.length){var t=d(e);if(!t.typeParametersChecked){t.typeParametersChecked=!0;t=Jm.filter(e.declarations,function(e){return 229===e.kind||230===e.kind});if(!(t.length<=1))if(!((e,t)=>{for(var r=Jm.length(t),n=Bs(t),i=0,s=e;i<s.length;i++){var a=s[i],o=Jm.length(a.typeParameters);if(o<n||r<o)return;for(var l=0;l<o;l++){var c=a.typeParameters[l],u=t[l];if(c.name.escapedText!==u.symbol.escapedName)return;var d=c.constraint&&re(c.constraint),p=Qs(u);if((d||p)&&(!d||!p||!Do(d,p)))return;d=c.default&&re(c.default),p=Es(u);if(d&&p&&!Do(d,p))return}}return 1})(t,X(e).localTypeParameters))for(var r=q(e),n=0,i=t;n<i.length;n++)z(i[n].name,Jm.Diagnostics.All_declarations_of_0_must_have_identical_type_parameters,r)}}}function vh(e){t=e,i=Jm.getSourceFileOfNode(t),(e=>{var t=!1,r=!1;if(!Cm(e)&&!wm(e)&&e.heritageClauses)for(var n=0,i=e.heritageClauses;n<i.length;n++){var s=i[n];if(85===s.token){if(t)return ie(s,Jm.Diagnostics.extends_clause_already_seen);if(r)return ie(s,Jm.Diagnostics.extends_clause_must_precede_implements_clause);if(1<s.types.length)return ie(s.types[1],Jm.Diagnostics.Classes_can_only_extend_a_single_class);t=!0}else{if(Jm.Debug.assert(108===s.token),r)return ie(s,Jm.Diagnostics.implements_clause_already_seen);r=!0}Lm(s)}})(t)||Dm(t.typeParameters,i),Lp(e),e.name&&(_h(e.name,Jm.Diagnostics.Class_name_cannot_be_0),Kp(e,e.name),zp(e,e.name),Yp(e,e.name),Xp(e,e.name)),yh(e.typeParameters),Ep(e);for(var t=W(e),r=X(t),n=Zi(r),i=Y(t),t=(bh(t),e),s=Jm.createUnderscoreEscapedMap(),M=Jm.createUnderscoreEscapedMap(),a=0,o=t.members;a<o.length;a++){var l=o[a];if(152===l.kind)for(var c=0,u=l.parameters;c<u.length;c++){var d=u[c];Jm.isParameterPropertyDeclaration(d)&&!Jm.isBindingPattern(d.name)&&m(s,d.name,d.name.escapedText,3)}else{var p=Jm.hasModifier(l,32)?M:s,h=l.name&&Jm.getPropertyNameForPropertyNameNode(l.name);if(h)switch(l.kind){case 153:m(p,l.name,h,1);break;case 154:m(p,l.name,h,2);break;case 149:m(p,l.name,h,3);break;case 151:m(p,l.name,h,4)}}}function m(e,t,r,n){var i=e.get(r);i?4&i?4!==n&&z(t,Jm.Diagnostics.Duplicate_identifier_0,Jm.getTextOfNode(t)):i&n?z(t,Jm.Diagnostics.Duplicate_identifier_0,Jm.getTextOfNode(t)):e.set(r,i|n):e.set(r,n)}if(!Jm.isInAmbientContext(e))for(var g=e,f=0,F=g.members;f<F.length;f++){var B=F[f],_=B.name;if(Jm.hasModifier(B,32)&&_){var $=Jm.getPropertyNameForPropertyNameNode(_);switch($){case"name":case"length":case"caller":case"arguments":case"prototype":z(_,Jm.Diagnostics.Static_property_0_conflicts_with_built_in_property_Function_0_of_constructor_function_1,$,Jn(W(g)))}}}var y=Jm.getClassExtendsHeritageClauseElement(e);if(y){j<2&&Sm(y.parent,1);t=Mi(r);if(t.length&&G){var b,v=t[0],t=Pi(r),T=Q(t);if(S=y,(b=ee(O=T,1)).length&&(b=b[0].declaration)&&Jm.hasModifier(b,8)&&(b=kh(O.symbol),Kh(S,b)||z(S,Jm.Diagnostics.Cannot_extend_a_class_0_Class_constructor_is_marked_as_private,ln(O.symbol))),ne(y.expression),Jm.some(y.typeArguments)){Jm.forEach(y.typeArguments,ne);for(var k=0,U=Ri(T,y.typeArguments,y);k<U.length;k++)if(!yp(U[k].typeParameters,y.typeArguments))break}Mo(n,Zi(v,r.thisType),e.name||e,Jm.Diagnostics.Class_0_incorrectly_extends_base_class_1),Mo(i,Ao(T),e.name||e,Jm.Diagnostics.Class_static_side_0_incorrectly_extends_base_class_static_side_1),540672&t.flags&&!Di(i)&&z(e.name||e,Jm.Diagnostics.A_mixin_class_must_have_a_constructor_with_a_single_rest_parameter_of_type_any),T.symbol&&32&T.symbol.flags||540672&t.flags||(b=Li(T,y.typeArguments,y),Jm.forEach(b,function(e){return te(e)!==v})&&z(y.expression,Jm.Diagnostics.Base_constructors_must_all_have_the_same_return_type));for(var x=r,E=v,S=Z(E),C=0,V=S;C<V.length;C++){var w,I,A,D=V[C],N=Th(D);4194304&N.flags||(w=Th(_s(x,N.escapedName)),I=Jm.getDeclarationModifierFlagsFromSymbol(N),Jm.Debug.assert(!!w,"derived should point to something, even if it is the base class' declaration."),w&&(w===N?(A=kh(x.symbol),!(128&I)||A&&Jm.hasModifier(A,128)||(199===A.kind?z(A,Jm.Diagnostics.Non_abstract_class_expression_does_not_implement_inherited_abstract_member_0_from_class_1,q(D),J(E)):z(A,Jm.Diagnostics.Non_abstract_class_0_does_not_implement_inherited_abstract_member_1_from_class_2,J(x),q(D),J(E)))):(A=Jm.getDeclarationModifierFlagsFromSymbol(w),8&I||8&A||Ru(N)&&Ru(w)||98308&N.flags&&98308&w.flags||(D=void 0,D=Ru(N)?98304&w.flags?Jm.Diagnostics.Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_accessor:Jm.Diagnostics.Class_0_defines_instance_member_function_1_but_extended_class_2_defines_it_as_instance_member_property:4&N.flags?Jm.Diagnostics.Class_0_defines_instance_member_property_1_but_extended_class_2_defines_it_as_instance_member_function:Jm.Diagnostics.Class_0_defines_instance_member_accessor_1_but_extended_class_2_defines_it_as_instance_member_function,z(Jm.getNameOfDeclaration(w.valueDeclaration)||w.valueDeclaration,D,J(E),q(N),J(x))))))}}}var O=Jm.getClassImplementsHeritageClauseElements(e);if(O)for(var R=0,H=O;R<H.length;R++){var L,P=H[R];Jm.isEntityNameExpression(P.expression)||z(P.expression,Jm.Diagnostics.A_class_can_only_implement_an_identifier_Slashqualified_name_with_optional_type_arguments),bp(P),G&&(L=re(P))!==K&&(Fi(L)?Mo(n,Zi(L,r.thisType),e.name||e,Jm.Diagnostics.Class_0_incorrectly_implements_interface_1):z(P,Jm.Diagnostics.A_class_may_only_implement_another_class_or_interface))}G&&(fh(r),hp(e))}function Th(e){return 1&Jm.getCheckFlags(e)?e.target:e}function kh(e){return Jm.forEach(e.declarations,function(e){return Jm.isClassLike(e)?e:void 0})}function xh(t,e){var r=Mi(t);if(r.length<2)return 1;for(var n=Jm.createUnderscoreEscapedMap(),i=(Jm.forEach(Xi(t).declaredProperties,function(e){n.set(e.escapedName,{prop:e,containingType:t})}),!0),s=0,a=r;s<a.length;s++)for(var o=a[s],l=0,c=Z(Zi(o,t.thisType));l<c.length;l++){var u,d,p=c[l],h=n.get(p.escapedName);h?h.containingType!==t&&0===rl(h.prop,p,No)&&(i=!1,h=J(h.containingType),u=J(o),d=Jm.chainDiagnosticMessages(void 0,Jm.Diagnostics.Named_property_0_of_types_1_and_2_are_not_identical,q(p),h,u),d=Jm.chainDiagnosticMessages(d,Jm.Diagnostics.Interface_0_cannot_simultaneously_extend_types_1_and_2,J(t),h,u),sr.add(Jm.createDiagnosticForNodeFromMessageChain(e,d))):n.set(p.escapedName,{prop:p,containingType:o})}return i}function Eh(e){if(Cm(e)||wm(e)||(e=>{var t=!1;if(e.heritageClauses)for(var r=0,n=e.heritageClauses;r<n.length;r++){var i=n[r];if(85!==i.token)return Jm.Debug.assert(108===i.token),ie(i,Jm.Diagnostics.Interface_declaration_cannot_have_implements_clause);if(t)return ie(i,Jm.Diagnostics.extends_clause_already_seen);t=!0,Lm(i)}})(e),yh(e.typeParameters),G){_h(e.name,Jm.Diagnostics.Interface_name_cannot_be_0),Ep(e);var t=W(e);if(bh(t),e===Jm.getDeclarationOfKind(t,230)){var r=X(t),n=Zi(r);if(xh(r,e.name)){for(var i=0,s=Mi(r);i<s.length;i++)Mo(n,Zi(s[i],r.thisType),e.name,Jm.Diagnostics.Interface_0_incorrectly_extends_interface_1);fh(r)}}pp(e)}Jm.forEach(Jm.getInterfaceBaseTypeNodes(e),function(e){Jm.isEntityNameExpression(e.expression)||z(e.expression,Jm.Diagnostics.An_interface_can_only_extend_an_identifier_Slashqualified_name_with_optional_type_arguments),bp(e)}),Jm.forEach(e.members,ne),G&&(hp(e),Fp(e))}function Sh(e){var t=b(e);if(!(16384&t.flags)){t.flags|=16384;for(var r=0,n=0,i=e.members;n<i.length;n++)var s=i[n],a=((e,t)=>{if(si(e.name)?z(e.name,Jm.Diagnostics.Computed_property_names_are_not_allowed_in_enums):uu(r=Jm.getTextOfPropertyName(e.name))&&!(e=>"Infinity"===e||"-Infinity"===e||"NaN"===e)(r)&&z(e.name,Jm.Diagnostics.An_enum_member_cannot_have_a_numeric_name),e.initializer){var l=e,r=Ui(W(l.parent)),n=Jm.isConst(l.parent),i=l.initializer,s=1!==r||$i(l)?function e(t){switch(t.kind){case 192:var r=e(t.operand);if("number"==typeof r)switch(t.operator){case 37:return r;case 38:return-r;case 52:return~r}break;case 194:var n=e(t.left),i=e(t.right);if("number"==typeof n&&"number"==typeof i)switch(t.operatorToken.kind){case 49:return n|i;case 48:return n&i;case 46:return n>>i;case 47:return n>>>i;case 45:return n<<i;case 50:return n^i;case 39:return n*i;case 41:return n/i;case 37:return n+i;case 38:return n-i;case 42:return n%i}break;case 9:return t.text;case 8:return qm(t),+t.text;case 185:return e(t.expression);case 71:return Jm.nodeIsMissing(t)?0:c(t,W(l.parent),t.escapedText);case 180:case 179:var s=t;if(Ch(s)){var a,o=op(s.expression);if(o.symbol&&384&o.symbol.flags)return a=void 0,a=179===s.kind?s.name.escapedText:(s=s.argumentExpression,Jm.Debug.assert(Jm.isLiteralExpression(s)),Jm.escapeLeadingUnderscores(s.text)),c(t,o.symbol,a)}}return}(i):void 0;if(void 0!==s)n&&"number"==typeof s&&!isFinite(s)&&z(i,isNaN(s)?Jm.Diagnostics.const_enum_member_initializer_was_evaluated_to_disallowed_value_NaN:Jm.Diagnostics.const_enum_member_initializer_was_evaluated_to_a_non_finite_value);else{if(1===r)return z(i,Jm.Diagnostics.Computed_values_are_not_permitted_in_an_enum_with_string_valued_members),0;n?z(i,Jm.Diagnostics.In_const_enum_declarations_member_initializer_must_be_constant_expression):Jm.isInAmbientContext(l.parent)?z(i,Jm.Diagnostics.In_ambient_enum_declarations_member_initializer_must_be_constant_expression):Mo(V(i),X(W(l.parent)),i,void 0)}return s;function c(e,t,r){t=t.exports.get(r);if(t){r=t.valueDeclaration;if(r!==l)return jr(r,l)?b(r).enumMemberValue:(z(e,Jm.Diagnostics.A_member_initializer_in_a_enum_declaration_cannot_reference_members_declared_after_it_including_members_defined_in_other_enums),0)}}}else if(!Jm.isInAmbientContext(e.parent)||Jm.isConst(e.parent)){if(void 0!==t)return t;z(e.name,Jm.Diagnostics.Enum_member_must_have_initializer)}})(s,r),r="number"==typeof(b(s).enumMemberValue=a)?a+1:void 0}}function Ch(e){return 71===e.kind||179===e.kind&&Ch(e.expression)||180===e.kind&&Ch(e.expression)&&9===e.argumentExpression.kind}function wh(e){if(G){var t=Jm.isGlobalScopeAugmentation(e),r=Jm.isInAmbientContext(e),n=(t&&!r&&z(e.name,Jm.Diagnostics.Augmentations_for_the_global_scope_should_have_declare_modifier_unless_they_appear_in_already_ambient_context),Jm.isAmbientModule(e));if(Oh(e,n?Jm.Diagnostics.An_ambient_module_declaration_is_only_allowed_at_the_top_level_in_a_file:Jm.Diagnostics.A_namespace_declaration_is_only_allowed_in_a_namespace_or_module))return;Cm(e)||wm(e)||r||9!==e.name.kind||H(e.name,Jm.Diagnostics.Only_ambient_modules_can_use_quoted_names),Jm.isIdentifier(e.name)&&(Kp(e,e.name),Yp(e,e.name),Xp(e,e.name)),Ep(e);var i=W(e);if(512&i.flags&&1<i.declarations.length&&!r&&tg(e,M.preserveConstEnums||M.isolatedModules)&&((r=(e=>{for(var t=0,r=e.declarations;t<r.length;t++){var n=r[t];if((229===n.kind||228===n.kind&&Jm.nodeIsPresent(n.body))&&!Jm.isInAmbientContext(n))return n}})(i))&&(Jm.getSourceFileOfNode(e)!==Jm.getSourceFileOfNode(r)?z(e.name,Jm.Diagnostics.A_namespace_declaration_cannot_be_in_a_different_file_from_a_class_or_function_with_which_it_is_merged):e.pos<r.pos&&z(e.name,Jm.Diagnostics.A_namespace_declaration_cannot_be_located_prior_to_a_class_or_function_with_which_it_is_merged)),r=Jm.getDeclarationOfKind(i,229))&&(i=e,r=r,i=Jm.getEnclosingBlockScopeContainer(i),r=Jm.getEnclosingBlockScopeContainer(r),Hr(i)?Hr(r):!Hr(r)&&i===r)&&(b(e).flags|=32768),n)if(Jm.isExternalModuleAugmentation(e)){if((t||33554432&W(e).flags)&&e.body)for(var s=0,a=e.body.statements;s<a.length;s++)!function e(t,r){switch(t.kind){case 208:for(var n=0,i=t.declarationList.declarations;n<i.length;n++){var s=i[n];e(s,r)}break;case 243:case 244:ie(t,Jm.Diagnostics.Exports_and_export_assignments_are_not_permitted_in_module_augmentations);break;case 237:case 238:ie(t,Jm.Diagnostics.Imports_are_not_permitted_in_module_augmentations_Consider_moving_them_to_the_enclosing_external_module);break;case 176:case 226:var a=t.name;if(Jm.isBindingPattern(a)){for(var o=0,l=a.elements;o<l.length;o++){var c=l[o];e(c,r)}break}case 229:case 232:case 228:case 230:case 233:case 231:r||(a=W(t))&&(!(33554432&a.flags)||Jm.isExternalModuleAugmentation(a.parent.declarations[0]))}}(a[s],t)}else Hr(e.parent)?t?z(e.name,Jm.Diagnostics.Augmentations_for_the_global_scope_can_only_be_directly_nested_in_external_modules_or_ambient_module_declarations):Jm.isExternalModuleNameRelative(Jm.getTextOfIdentifierOrLiteral(e.name))&&z(e.name,Jm.Diagnostics.Ambient_module_declaration_cannot_specify_relative_module_name):z(e.name,t?Jm.Diagnostics.Augmentations_for_the_global_scope_can_only_be_directly_nested_in_external_modules_or_ambient_module_declarations:Jm.Diagnostics.Ambient_modules_cannot_be_nested_in_other_modules_or_namespaces)}e.body&&(ne(e.body),Jm.isGlobalScopeAugmentation(e)||Fp(e))}function Ih(e){switch(e.kind){case 71:return e;case 143:for(;71!==(e=e.left).kind;);return e;case 179:for(;71!==(e=e.expression).kind;);return e}}function Ah(e){var t=Jm.getExternalModuleName(e);if(Jm.nodeIsMissing(t)||9===t.kind){var r=234===e.parent.kind&&Jm.isAmbientModule(e.parent.parent);if(265===e.parent.kind||r){if(!r||!Jm.isExternalModuleNameRelative(Jm.getTextOfIdentifierOrLiteral(t))||Wn(e))return 1;z(e,Jm.Diagnostics.Import_or_export_declaration_in_an_ambient_module_declaration_cannot_reference_module_through_relative_module_name)}else z(t,244===e.kind?Jm.Diagnostics.Export_declarations_are_not_permitted_in_a_namespace:Jm.Diagnostics.Import_declarations_in_a_namespace_cannot_reference_a_module)}else z(t,Jm.Diagnostics.String_literal_expected)}function Dh(e){var t,r=W(e),n=nn(r);n!==B&&(t=(1156031&r.flags?107455:0)|(793064&r.flags?793064:0)|(1920&r.flags?1920:0),n.flags&t&&z(e,246===e.kind?Jm.Diagnostics.Export_declaration_conflicts_with_exported_declaration_of_0:Jm.Diagnostics.Import_declaration_conflicts_with_local_declaration_of_0,q(r)),!M.isolatedModules||246!==e.kind||107455&n.flags||Jm.isInAmbientContext(e)||z(e,Jm.Diagnostics.Cannot_re_export_a_type_when_the_isolatedModules_flag_is_provided))}function Nh(e){Kp(e,e.name),Yp(e,e.name),Xp(e,e.name),Dh(e)}function Oh(e,t){var r=265===e.parent.kind||234===e.parent.kind||233===e.parent.kind;return r||ie(e,t),!r}function Rh(e){var t,r;Dh(e),e.parent.parent.moduleSpecifier||((r=Kr(t=e.propertyName||e.name,t.escapedText,2998271,void 0,void 0,!0))&&(r===Ye||Hr(ri(r.declarations[0])))?z(t,Jm.Diagnostics.Cannot_export_0_Only_local_declarations_can_be_exported_from_a_module,Jm.idText(t)):sn(e))}function Lh(e){var t,e=W(e),r=d(e);r.exportsChecked||((t=e.exports.get("export="))&&Jm.forEachEntry(e.exports,function(e,t){return"export="!==t})&&(Wn(t=Xr(t)||t.valueDeclaration)||z(t,Jm.Diagnostics.An_export_assignment_cannot_be_used_in_a_module_with_other_exported_elements)),(t=bn(e))&&t.forEach(function(e,t){var r=e.declarations,e=e.flags;if("__export"!==t&&!(1984&e)){var n=Jm.countWhere(r,br);if(!(524288&e&&n<=2)&&1<n)for(var i=0,s=r;i<s.length;i++){var a=s[i];Ph(a)&&sr.add(Jm.createDiagnosticForNode(a,Jm.Diagnostics.Cannot_redeclare_exported_variable_0,Jm.unescapeLeadingUnderscores(t)))}}}),r.exportsChecked=!0)}function Ph(e){return 228!==e.kind&&151!==e.kind||!!e.body}function ne(e){if(e){if(Jm.isInJavaScriptFile(e)&&e.jsDoc)for(var t=0,r=e.jsDoc;t<r.length;t++){var n=r[t].tags;Jm.forEach(n,ne)}var i,s,a,o,l,c,u,d,p,h,m,g,f,_,y,b,v,T,k,x,E,S,C,w,I,A,D,N,O,R,L,P=e.kind;if(se)switch(P){case 233:case 229:case 230:case 228:se.throwIfCancellationRequested()}switch(P){case 145:return lp(e);case 146:return cp(e);case 149:case 148:return mp(e);case 160:case 161:case 155:case 156:case 157:return dp(e);case 151:case 150:return Hm(L=e)||Mm(L.name),Mp(L),void(Jm.hasModifier(L,128)&&L.body&&z(L,Jm.Diagnostics.Method_0_cannot_have_an_implementation_because_it_is_marked_abstract,Jm.declarationNameToString(L.name)));case 152:return gp(e);case 153:case 154:return fp(e);case 159:return bp(e);case 158:return up(e);case 162:return void ma(e);case 163:return L=e,Jm.forEach(L.members,ne),void(G&&(fh(no(L)),hp(L),pp(L)));case 164:return void ne(e.elementType);case 165:return Am((R=e).elementTypes)||0!==R.elementTypes.length||H(R,Jm.Diagnostics.A_tuple_type_element_list_cannot_be_empty),void Jm.forEach(R.elementTypes,ne);case 166:case 167:return void Jm.forEach(e.types,ne);case 168:case 170:return ne(e.type);case 277:return R=e,O=Jm.getJSDocHost(R),void(Jm.isClassDeclaration(O)||Jm.isClassExpression(O)?(D=Jm.getAllJSDocTagsOfKind(O,277),Jm.Debug.assert(0<D.length),1<D.length&&z(D[1],Jm.Diagnostics.Class_declarations_cannot_have_more_than_one_augments_or_extends_tag),D=Pp(R.class.expression),(N=Jm.getClassExtendsHeritageClauseElement(O))&&(N=Pp(N.expression))&&D.escapedText!==N.escapedText&&z(D,Jm.Diagnostics.JSDoc_0_1_does_not_match_the_extends_2_clause,Jm.idText(R.tagName),Jm.idText(D),Jm.idText(N))):z(O,Jm.Diagnostics.JSDoc_0_is_not_attached_to_a_class,Jm.idText(R.tagName)));case 283:return void((D=e).typeExpression||z(D.name,Jm.Diagnostics.JSDoc_typedef_tag_should_either_have_a_type_annotation_or_be_followed_by_property_or_member_tags));case 279:return ne((N=e).typeExpression),void(Jm.getParameterSymbolFromJSDoc(N)||z(N.name,Jm.Diagnostics.JSDoc_param_tag_has_name_0_but_there_is_no_parameter_with_that_name,Jm.idText(143===N.name.kind?N.name.right:N.name)));case 273:dp(e);case 274:case 271:case 270:case 268:case 269:return void(Jm.isInJavaScriptFile(e)||Jm.isInJSDoc(e)||H(e,Jm.Diagnostics.JSDoc_types_can_only_be_used_inside_documentation_comments));case 267:return ne(e.type);case 171:return ne((O=e).objectType),ne(O.indexType),void vp(to(O),O);case 172:return ne((A=e).typeParameter),ne(A.type),void Mo(ps(ro(A)),$,A.typeParameter.constraint);case 228:return A=e,void(G&&(Mp(A),Fm(A),Jp(A,A.name),Kp(A,A.name),zp(A,A.name),Yp(A,A.name),Xp(A,A.name)));case 207:case 234:return Gp(e);case 208:return nh(e);case 210:return Wm(I=e),void V(I.expression);case 211:return Wm(I=e),V(I.expression),ne(I.thenStatement),209===I.thenStatement.kind&&z(I.thenStatement,Jm.Diagnostics.The_body_of_an_if_statement_cannot_be_the_empty_statement),void ne(I.elseStatement);case 212:return Wm(w=e),ne(w.statement),void V(w.expression);case 213:return Wm(w=e),V(w.expression),void ne(w.statement);case 214:return Wm(C=e)||C.initializer&&227===C.initializer.kind&&jm(C.initializer),C.initializer&&(227===C.initializer.kind?Jm.forEach(C.initializer.declarations,th):V(C.initializer)),C.condition&&V(C.condition),C.incrementor&&V(C.incrementor),ne(C.statement),void(C.locals&&Fp(C));case 215:return ih(e);case 216:return $m(C=e),216===C.kind&&(C.awaitModifier?2==(6&Jm.getFunctionFlags(Jm.getContainingFunction(C)))&&j<5&&Sm(C,16384):M.downlevelIteration&&j<2&&Sm(C,256)),227===C.initializer.kind?sh(C):(x=C.initializer,E=ah(C.expression,C.awaitModifier),177===x.kind||178===x.kind?qd(x,E||K):(S=V(x),Vd(x,Jm.Diagnostics.The_left_hand_side_of_a_for_of_statement_must_be_a_variable_or_a_property_access),E&&Mo(E,S,x,void 0))),ne(C.statement),void(C.locals&&Fp(C));case 217:case 218:return ph(e);case 219:return Wm(E=e)||Jm.getContainingFunction(E)||ie(E,Jm.Diagnostics.A_return_statement_can_only_be_used_within_a_function_body),void((S=Jm.getContainingFunction(E))&&(x=te(Us(S)),F||E.expression||8192&x.flags?(v=E.expression?tp(E.expression):ot,1&(T=Jm.getFunctionFlags(S))||(154===S.kind?E.expression&&z(E,Jm.Diagnostics.Setters_cannot_return_a_value):152===S.kind?E.expression&&!Mo(v,x,E)&&z(E,Jm.Diagnostics.Return_type_of_constructor_signature_must_be_assignable_to_the_instance_type_of_the_class):(Jm.getEffectiveReturnTypeNode(S)||hh(S))&&(2&T?(T=Cp(x),k=wp(v,E,Jm.Diagnostics.The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member),T&&Mo(k,T,E)):Mo(v,x,E)))):152!==S.kind&&M.noImplicitReturns&&!mh(S,x)&&z(E,Jm.Diagnostics.Not_all_code_paths_return_a_value)));case 220:return Wm(k=e)||16384&k.flags&&ie(k,Jm.Diagnostics.with_statements_are_not_allowed_in_an_async_function_block),V(k.expression),void(Km(T=Jm.getSourceFileOfNode(k))||zm(T,T=Jm.getSpanOfTokenAtPosition(T,k.pos).start,k.statement.pos-T,Jm.Diagnostics.The_with_statement_is_not_supported_All_symbols_in_a_with_block_will_have_type_any));case 221:return Wm(g=e),_=!1,y=V(g.expression),b=ul(y),Jm.forEach(g.caseBlock.clauses,function(e){var t,r,n,i;258!==e.kind||_||(void 0===f?f=e:(zm(t=Jm.getSourceFileOfNode(g),t=Jm.skipTrivia(t.text,e.pos),(0<e.statements.length?e.statements[0].pos:e.end)-t,Jm.Diagnostics.A_default_clause_cannot_appear_more_than_once_in_a_switch_statement),_=!0)),G&&257===e.kind&&(n=ul(r=V((t=e).expression)),i=y,n&&b||(r=n?dl(r):r,i=dl(y)),Jd(i,r)||Fo(r,i,t.expression,void 0)),Jm.forEach(e.statements,ne)}),void(g.caseBlock.locals&&Fp(g.caseBlock));case 222:return Wm(m=e)||Jm.findAncestor(m.parent,function(e){return Jm.isFunctionLike(e)?"quit":222===e.kind&&e.label.escapedText===m.label.escapedText?(e=Jm.getSourceFileOfNode(m),H(m.label,Jm.Diagnostics.Duplicate_label_0,Jm.getTextOfNodeFromSourceText(e.text,m.label)),!0):void 0}),void ne(m.statement);case 223:return gh(e);case 224:return Wm(v=e),Gp(v.tryBlock),(h=v.catchClause)&&(h.variableDeclaration&&(h.variableDeclaration.type?ie(h.variableDeclaration.type,Jm.Diagnostics.Catch_clause_variable_cannot_have_a_type_annotation):h.variableDeclaration.initializer?ie(h.variableDeclaration.initializer,Jm.Diagnostics.Catch_clause_variable_cannot_have_an_initializer):(p=h.block.locals)&&Jm.forEachKey(h.locals,function(e){var t=p.get(e);t&&0!=(2&t.flags)&&H(t.valueDeclaration,Jm.Diagnostics.Cannot_redeclare_identifier_0_in_catch_clause,e)})),Gp(h.block)),void(v.finallyBlock&&Gp(v.finallyBlock));case 226:return th(e);case 176:return rh(e);case 229:return(h=e).name||Jm.hasModifier(h,512)||ie(h,Jm.Diagnostics.A_class_declaration_without_the_default_modifier_must_have_a_name),vh(h),Jm.forEach(h.members,ne),void Fp(h);case 230:return Eh(e);case 231:return Cm(d=e)||wm(d),_h(d.name,Jm.Diagnostics.Type_alias_name_cannot_be_0),yh(d.typeParameters),ne(d.type),void Fp(d);case 232:return d=e,void(G&&(Cm(d)||wm(d),_h(d.name,Jm.Diagnostics.Enum_name_cannot_be_0),Kp(d,d.name),zp(d,d.name),Yp(d,d.name),Xp(d,d.name),Ep(d),Sh(d),l=Jm.isConst(d),M.isolatedModules&&l&&Jm.isInAmbientContext(d)&&z(d.name,Jm.Diagnostics.Ambient_const_enums_are_not_allowed_when_the_isolatedModules_flag_is_provided),c=W(d),d===Jm.getDeclarationOfKind(c,d.kind))&&(1<c.declarations.length&&Jm.forEach(c.declarations,function(e){Jm.isConstEnumDeclaration(e)!==l&&z(Jm.getNameOfDeclaration(e),Jm.Diagnostics.Enum_declarations_must_all_be_const_or_non_const)}),u=!1,Jm.forEach(c.declarations,function(e){return 232===e.kind&&!!e.members.length&&void((e=e.members[0]).initializer||(u?z(e.name,Jm.Diagnostics.In_an_enum_with_multiple_declarations_only_one_declaration_can_omit_an_initializer_for_its_first_enum_element):u=!0))})));case 233:return wh(e);case 238:return void(Oh(c=e,Jm.Diagnostics.An_import_declaration_can_only_be_used_in_a_namespace_or_module)||(Cm(c)||wm(c)||!Jm.hasModifiers(c)||ie(c,Jm.Diagnostics.An_import_declaration_cannot_have_modifiers),Ah(c)&&(c=c.importClause)&&(c.name&&Nh(c),c.namedBindings)&&(240===c.namedBindings.kind?Nh(c.namedBindings):Jm.forEach(c.namedBindings.elements,Nh))));case 237:return void(!Oh(s=e,Jm.Diagnostics.An_import_declaration_can_only_be_used_in_a_namespace_or_module)&&(Cm(s)||wm(s),Jm.isInternalModuleImportEqualsDeclaration(s)||Ah(s))&&(Nh(s),Jm.hasModifier(s,1)&&sn(s),Jm.isInternalModuleImportEqualsDeclaration(s)?(a=nn(W(s)))!==B&&(107455&a.flags&&(1920&cn(o=Ih(s.moduleReference),108479).flags||z(o,Jm.Diagnostics.Module_0_is_hidden_by_a_local_declaration_with_the_same_name,Jm.declarationNameToString(o))),793064&a.flags)&&_h(s.name,Jm.Diagnostics.Import_name_cannot_be_0):ae>=Jm.ModuleKind.ES2015&&!Jm.isInAmbientContext(s)&&H(s,Jm.Diagnostics.Import_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_import_Asterisk_as_ns_from_mod_import_a_from_mod_import_d_from_mod_or_another_module_format_instead)));case 244:return void(Oh(o=e,Jm.Diagnostics.An_export_declaration_can_only_be_used_in_a_module)||(Cm(o)||wm(o)||!Jm.hasModifiers(o)||ie(o,Jm.Diagnostics.An_export_declaration_cannot_have_modifiers),o.moduleSpecifier&&!Ah(o))||(o.exportClause?(Jm.forEach(o.exportClause.elements,Rh),a=!(i=234===o.parent.kind&&Jm.isAmbientModule(o.parent.parent))&&234===o.parent.kind&&!o.moduleSpecifier&&Jm.isInAmbientContext(o),265===o.parent.kind||i||a||z(o,Jm.Diagnostics.Export_declarations_are_not_permitted_in_a_namespace)):((i=un(o,o.moduleSpecifier))&&gn(i)&&z(o.moduleSpecifier,Jm.Diagnostics.Module_0_uses_export_and_cannot_be_used_with_export_Asterisk,q(i)),ae!==Jm.ModuleKind.System&&ae!==Jm.ModuleKind.ES2015&&ae!==Jm.ModuleKind.ESNext&&Sm(o,32768))));case 243:return void(Oh(s=e,Jm.Diagnostics.An_export_assignment_can_only_be_used_in_a_module)||(233!==(i=(265===s.parent.kind?s:s.parent).parent).kind||Jm.isAmbientModule(i)?(Cm(s)||wm(s)||!Jm.hasModifiers(s)||ie(s,Jm.Diagnostics.An_export_assignment_cannot_have_modifiers),71===s.expression.kind?sn(s):tp(s.expression),Lh(i),Jm.isInAmbientContext(s)&&!Jm.isEntityNameExpression(s.expression)&&H(s.expression,Jm.Diagnostics.The_expression_of_an_export_assignment_must_be_an_identifier_or_qualified_name_in_an_ambient_context),s.isExportEquals&&!Jm.isInAmbientContext(s)&&(ae>=Jm.ModuleKind.ES2015?H(s,Jm.Diagnostics.Export_assignment_cannot_be_used_when_targeting_ECMAScript_modules_Consider_using_export_default_or_another_module_format_instead):ae===Jm.ModuleKind.System&&H(s,Jm.Diagnostics.Export_assignment_is_not_supported_when_module_flag_is_system))):s.isExportEquals?z(s,Jm.Diagnostics.An_export_assignment_cannot_be_used_in_a_namespace):z(s,Jm.Diagnostics.A_default_export_can_only_be_used_in_an_ECMAScript_style_module)));case 209:case 225:return void Wm(e);case 247:return void Lp(e)}}}function Mh(e){He&&He.push(e)}function Fh(){for(var e,t,r,n,i=0,s=He;i<s.length;i++){var a=s[i];switch(a.kind){case 186:case 187:case 151:case 150:e=a,n=r=t=void 0,Jm.Debug.assert(151!==e.kind||Jm.isObjectLiteralMethod(e)),t=Jm.getFunctionFlags(e),r=Jm.getEffectiveReturnTypeNode(e),n=r&&(2==(3&t)?Ap(e):re(r)),0==(1&t)&&Pd(e,n),e.body&&(r||te(Us(e)),207===e.body.kind?ne(e.body):(r=V(e.body),n&&Mo(2==(3&t)?wp(r,e.body,Jm.Diagnostics.The_return_type_of_an_async_function_must_either_be_a_valid_promise_or_must_not_contain_a_callable_then_member):r,n,e.body)),Fp(e));break;case 153:case 154:fp(a);break;case 199:t=a,Jm.forEach(t.members,ne),Fp(t)}}}function Bh(e){var t;Jm.performance.mark("beforeCheck"),1&(t=b(e=e)).flags||M.skipLibCheck&&e.isDeclarationFile||M.skipDefaultLibCheck&&e.hasNoDefaultLib||((e=>Jm.isInAmbientContext(e)&&(e=>{for(var t=0,r=e.statements;t<r.length;t++){var n=r[t];if((Jm.isDeclaration(n)||208===n.kind)&&(e=>230!==e.kind&&231!==e.kind&&238!==e.kind&&237!==e.kind&&244!==e.kind&&243!==e.kind&&236!==e.kind&&!Jm.hasModifier(e,515)&&ie(e,Jm.Diagnostics.A_declare_modifier_is_required_for_a_top_level_declaration_in_a_d_ts_file))(n))return}})(e))(e),Jm.clear(rr),Jm.clear(nr),Ge=G&&k?[]:void 0,$t=!(He=[]),Jm.forEach(e.statements,ne),Fh(),Jm.isExternalModule(e)&&Fp(e),e.isDeclarationFile||Bp(),Ge=He=void 0,Jm.isExternalOrCommonJsModule(e)&&Lh(e),rr.length&&(Jm.forEach(rr,Wp),Jm.clear(rr)),nr.length&&(Jm.forEach(nr,qp),Jm.clear(nr)),t.flags|=1),Jm.performance.mark("afterCheck"),Jm.performance.measure("Check","beforeCheck","afterCheck")}function $h(e,t){try{se=t;var r,n,i,s=e;return Uh(),s?(i=sr.getGlobalDiagnostics(),r=i.length,Bh(s),s=sr.getDiagnostics(s.fileName),(n=sr.getGlobalDiagnostics())!==i?(i=Jm.relativeComplement(i,n,Jm.compareDiagnostics),Jm.concatenate(i,s)):0===r&&0<n.length?Jm.concatenate(n,s):s):(Jm.forEach(c.getSourceFiles(),Bh),sr.getDiagnostics())}finally{se=void 0}}function Uh(){if(!G)throw new Error("Trying to get diagnostics from a type checker that does not produce them.")}function Vh(e){if(e)for(;e.parent;){if(220===e.parent.kind&&e.parent.statement===e)return 1;e=e.parent}}function Hh(e){switch(e.kind){case 145:case 229:case 230:case 231:case 232:return!0}}function Gh(e){for(var t=e;t.parent&&143===t.parent.kind;)t=t.parent;return t.parent&&159===t.parent.kind}function jh(e,t){for(var r;(e=Jm.getContainingClass(e))&&!(r=t(e)););return r}function Kh(e,t){return jh(e,function(e){return e===t})}function zh(e){return void 0!==(e=>{for(;143===e.parent.kind;)e=e.parent;return 237===e.parent.kind?e.parent.moduleReference===e&&e.parent:243===e.parent.kind?e.parent.expression===e&&e.parent:void 0})(e)}function Wh(e){if(Jm.isDeclarationName(e))return W(e.parent);if(Jm.isInJavaScriptFile(e)&&179===e.parent.kind&&e.parent===e.parent.parent.left){var t=(e=>{switch(Jm.getSpecialPropertyAssignmentKind(e.parent.parent)){case 1:case 3:return W(e.parent);case 4:case 2:case 5:return W(e.parent.parent)}})(e);if(t)return t}if(243===e.parent.kind&&Jm.isEntityNameExpression(e))return cn(e,2998271);if(179!==e.kind&&zh(e))return t=Jm.getAncestor(e,237),Jm.Debug.assert(void 0!==t),on(e,!0);if((e=>{for(var t=e;t.parent&&179===t.parent.kind;)t=t.parent;return t.parent&&201===t.parent.kind})(e=Jm.isRightSideOfQualifiedNameOrPropertyAccess(e)?e.parent:e)){var r=0,t=(201===e.parent.kind?(r=793064,Jm.isExpressionWithTypeArgumentsInClassExtendsClause(e.parent)&&(r|=107455)):r=1920,cn(e,r|=2097152));if(t)return t}if(279===e.parent.kind)return Jm.getParameterSymbolFromJSDoc(e.parent);if(145===e.parent.kind&&282===e.parent.parent.kind)return Jm.Debug.assert(!Jm.isInJavaScriptFile(e)),(t=Jm.getTypeParameterFromJsDoc(e.parent))&&t.symbol;if(Jm.isPartOfExpression(e)){if(Jm.nodeIsMissing(e))return;if(71===e.kind)return Jm.isJSXTagName(e)&&fu(e)?bu(e.parent):cn(e,107455,!1,!0);if(179===e.kind||143===e.kind)return(t=b(e)).resolvedSymbol||(179===e.kind?Fu:Bu)(e),t.resolvedSymbol}else{if(Gh(e))return cn(e,r=159===e.parent.kind?793064:1920,!1,!0);if(253===e.parent.kind)return R(wu((t=e.parent).parent.parent),t.name.escapedText)||B}return 158===e.parent.kind?cn(e,1):void 0}function qh(e){if(265===e.kind)return Jm.isExternalModule(e)?Tn(e.symbol):void 0;if(!Vh(e)){if(rg(e))return W(e.parent);if(Jm.isLiteralComputedPropertyDeclarationName(e))return W(e.parent.parent);if(71===e.kind){if(zh(e))return Wh(e);if(176===e.parent.kind&&174===e.parent.parent.kind&&e===e.parent.propertyName){var t=Jh(e.parent.parent),t=t&&R(t,e.escapedText);if(t)return t}}switch(e.kind){case 71:case 179:case 143:return Wh(e);case 99:var r=Jm.getThisContainer(e,!1);if(Jm.isFunctionLike(r)){r=Us(r);if(r.thisParameter)return r.thisParameter}if(Jm.isInExpressionContext(e))return V(e).symbol;case 169:return mo(e).symbol;case 97:return V(e).symbol;case 123:r=e.parent;return r&&152===r.kind?r.parent.symbol:void 0;case 9:if(Jm.isExternalModuleImportEqualsDeclaration(e.parent.parent)&&Jm.getExternalModuleImportEqualsDeclarationExpression(e.parent.parent)===e||(238===e.parent.kind||244===e.parent.kind)&&e.parent.moduleSpecifier===e||Jm.isInJavaScriptFile(e)&&Jm.isRequireCall(e.parent,!1)||Jm.isImportCall(e.parent))return un(e,e);case 8:r=Jm.isElementAccessExpression(e.parent)?e.parent.argumentExpression===e?op(e.parent.expression):void 0:Jm.isLiteralTypeNode(e.parent)&&Jm.isIndexedAccessTypeNode(e.parent.parent)?re(e.parent.parent.objectType):void 0;return r&&R(r,Jm.escapeLeadingUnderscores(e.text));case 79:return W(e.parent);default:return}}}function Jh(e){var t,r,n;return Vh(e)?K:Jm.isPartOfTypeNode(e)?(t=re(e))&&Jm.isExpressionWithTypeArgumentsInClassImplementsClause(e)?Zi(t,(n=Jh(Jm.getContainingClass(e))).thisType):t:Jm.isPartOfExpression(e)?Yh(e):Jm.isExpressionWithTypeArgumentsInClassExtendsClause(e)?(t=Mi(n=X(W(Jm.getContainingClass(e))))[0])&&Zi(t,n.thisType):Hh(e)?X(r=W(e)):71===(t=e).kind&&Hh(t.parent)&&t.parent.name===t?(r=qh(e))&&X(r):Jm.isDeclaration(e)?Y(r=W(e)):rg(e)?(r=qh(e))&&Y(r):Jm.isBindingPattern(e)?di(e.parent,!0):zh(e)?(n=(r=qh(e))&&X(r))!==K?n:Y(r):K}function Yh(e){return po(op(e=Jm.isRightSideOfQualifiedNameOrPropertyAccess(e)?e.parent:e))}function Xh(e){if(!Jm.isGeneratedIdentifier(e)&&(e=Jm.getParseTreeNode(e,Jm.isIdentifier)))return!(179===e.parent.kind&&e.parent.name===e)&&vm(e)===Xe;return!1}function Zh(e){var t,r,e=un(e.parent,e);return!(e&&!Jm.isShorthandAmbientModuleSymbol(e))||(t=gn(e),void 0===(r=d(e=hn(e))).exportsSomeValue&&(r.exportsSomeValue=t?!!(107455&e.flags):Jm.forEachEntry(bn(e),function(e){return(e=rn(e))&&!!(107455&e.flags)})),r.exportsSomeValue)}function Qh(e,t){if(e=Jm.getParseTreeNode(e,Jm.isIdentifier)){n=vm(e,(i=(n=e).parent)&&Jm.isModuleOrEnumDeclaration(i)&&n===i.name);if(n){if(1048576&n.flags){i=Tn(n.exportSymbol);if(!t&&944&i.flags)return;n=i}var r=kn(n);if(r)return 512&r.flags&&265===r.valueDeclaration.kind?(t=r.valueDeclaration)!==Jm.getSourceFileOfNode(e)?void 0:t:Jm.findAncestor(e.parent,function(e){return Jm.isModuleOrEnumDeclaration(e)&&W(e)===r})}}var n,i}function em(e){if(e=Jm.getParseTreeNode(e,Jm.isIdentifier)){e=vm(e);if(tn(e,107455))return Xr(e)}}function tm(e){var t,r,n,i;return!!(418&e.flags)&&(void 0===(t=d(e)).isDeclarationWithCollidingName&&(r=Jm.getEnclosingBlockScopeContainer(e.valueDeclaration),Jm.isStatementWithLocals(r))&&(n=b(e.valueDeclaration),Kr(r.parent,e.escapedName,107455,void 0,void 0,!1)?t.isDeclarationWithCollidingName=!0:131072&n.flags?(e=262144&n.flags,n=Jm.isIterationStatement(r,!1),i=207===r.kind&&Jm.isIterationStatement(r.parent,!1),t.isDeclarationWithCollidingName=!(Jm.isBlockScopedContainerTopLevel(r)||e&&(n||i))):t.isDeclarationWithCollidingName=!1),t.isDeclarationWithCollidingName)}function rm(e){if(!Jm.isGeneratedIdentifier(e)&&(e=Jm.getParseTreeNode(e,Jm.isIdentifier))){e=vm(e);if(e&&tm(e))return e.valueDeclaration}}function nm(e){if(e=Jm.getParseTreeNode(e,Jm.isDeclaration)){e=W(e);if(e)return tm(e)}return!1}function im(e){switch(e.kind){case 237:case 239:case 240:case 242:case 246:return am(W(e)||B);case 244:var t=e.exportClause;return t&&Jm.forEach(t.elements,im);case 243:return!e.expression||71!==e.expression.kind||am(W(e)||B)}return!1}function sm(e){return!(void 0===(e=Jm.getParseTreeNode(e,Jm.isImportEqualsDeclaration))||265!==e.parent.kind||!Jm.isInternalModuleImportEqualsDeclaration(e))&&am(W(e))&&e.moduleReference&&!Jm.nodeIsMissing(e.moduleReference)}function am(e){e=nn(e);return e===B||107455&e.flags&&(M.preserveConstEnums||!om(e))}function om(e){return Kd(e)||e.constEnumOnlyModule}function lm(e){var t;return!!Jm.nodeIsPresent(e.body)&&(1<(t=Vs(W(e))).length||1===t.length&&t[0].declaration!==e)}function cm(e){return F&&!Ms(e)&&e.initializer&&!Jm.hasModifier(e,92)}function um(e){return F&&Ms(e)&&!e.initializer&&Jm.hasModifier(e,92)}function dm(e){return b(e).flags}function pm(e){return Sh(e.parent),b(e).enumMemberValue}function hm(e){switch(e.kind){case 264:case 179:case 180:return!0}return!1}function mm(e){return 264===e.kind?pm(e):(e=b(e).resolvedSymbol)&&8&e.flags&&Jm.isConstEnumDeclaration(e.valueDeclaration.parent)?pm(e.valueDeclaration):void 0}function gm(e,t){if(!(e=Jm.getParseTreeNode(e,Jm.isEntityName)))return Jm.TypeReferenceSerializationKind.Unknown;if(t&&!(t=Jm.getParseTreeNode(t)))return Jm.TypeReferenceSerializationKind.Unknown;var r=cn(e,107455,!0,!1,t),e=cn(e,793064,!0,!1,t);if(r&&r===e){var t=Ta(!1);if(t&&r===t)return Jm.TypeReferenceSerializationKind.Promise;t=Y(r);if(t&&Ni(t))return Jm.TypeReferenceSerializationKind.TypeWithConstructSignatureAndValue}return e?(r=X(e))===K?Jm.TypeReferenceSerializationKind.Unknown:1&r.flags?Jm.TypeReferenceSerializationKind.ObjectType:Gd(r,15360)?Jm.TypeReferenceSerializationKind.VoidNullableOrNeverType:Gd(r,136)?Jm.TypeReferenceSerializationKind.BooleanType:Gd(r,84)?Jm.TypeReferenceSerializationKind.NumberLikeType:Gd(r,262178)?Jm.TypeReferenceSerializationKind.StringLikeType:hl(r)?Jm.TypeReferenceSerializationKind.ArrayLikeType:Gd(r,512)?Jm.TypeReferenceSerializationKind.ESSymbolType:32768&(t=r).flags&&0<ee(t,0).length?Jm.TypeReferenceSerializationKind.TypeWithCallSignature:al(r)?Jm.TypeReferenceSerializationKind.ArrayLikeType:Jm.TypeReferenceSerializationKind.ObjectType:Jm.TypeReferenceSerializationKind.ObjectType}function fm(e,t,r,n){e=W(e),e=!e||133120&e.flags?K:pl(Y(e));8192&r&&(e=yl(e,2048)),Yn().buildTypeDisplay(e,n,t,r)}function _m(e,t,r,n){e=Us(e);Yn().buildTypeDisplay(te(e),n,t,r)}function ym(e,t,r,n){e=Sl(Yh(e));Yn().buildTypeDisplay(e,n,t,r)}function bm(e){return Pt.has(Jm.escapeLeadingUnderscores(e))}function vm(e,t){var r=b(e).resolvedSymbol;return r||(r=e,Kr(r=t&&(t=e.parent,Jm.isDeclaration(t))&&e===t.name?ri(t):r,e.escapedText,3253183,void 0,void 0,!0))}function Tm(e){if(!Jm.isGeneratedIdentifier(e)&&(e=Jm.getParseTreeNode(e,Jm.isIdentifier))){e=vm(e);if(e)return xn(e).valueDeclaration}}function km(e){return!!Jm.isConst(e)&&!!(96&(e=Y(W(e))).flags&&1048576&e.flags)}function xm(e,t){e=Y(W(e));t.writeStringLiteral(qn(e))}function Em(e){e=Jm.getExternalModuleName(e),e=dn(e,e,void 0);if(e)return Jm.getDeclarationOfKind(e,265)}function Sm(e,t){if((o&t)!==t&&M.importHelpers){var r=Jm.getSourceFileOfNode(e);if(Jm.isEffectiveExternalModule(r,M)&&!Jm.isInAmbientContext(e)){var n=((e,t)=>l=l||pn(e,Jm.externalHelpersModuleNameText,Jm.Diagnostics.This_syntax_requires_an_imported_helper_but_module_0_cannot_be_found,t)||B)(r,e);if(n!==B)for(var i,s=t&~o,a=1;a<=65536;a<<=1)s&a&&(i=(e=>{switch(e){case 1:return"__extends";case 2:return"__assign";case 4:return"__rest";case 8:return"__decorate";case 16:return"__metadata";case 32:return"__param";case 64:return"__awaiter";case 128:return"__generator";case 256:return"__values";case 512:return"__read";case 1024:return"__spread";case 2048:return"__await";case 4096:return"__asyncGenerator";case 8192:return"__asyncDelegator";case 16384:return"__asyncValues";case 32768:return"__exportStar";case 65536:return"__makeTemplateObject";default:Jm.Debug.fail("Unrecognized helper")}})(a),Gr(n.exports,Jm.escapeLeadingUnderscores(i),107455)||z(e,Jm.Diagnostics.This_syntax_requires_an_imported_helper_named_1_but_module_0_has_no_exported_member_1,Jm.externalHelpersModuleNameText,i));o|=t}}}function Cm(e){if(e.decorators){if(!Jm.nodeCanBeDecorated(e))return 151!==e.kind||Jm.nodeIsPresent(e.body)?ie(e,Jm.Diagnostics.Decorators_are_not_valid_here):ie(e,Jm.Diagnostics.A_decorator_can_only_decorate_a_method_implementation_not_an_overload);if(153===e.kind||154===e.kind){var t=Jm.getAllAccessorDeclarations(e.parent.members,e);if(t.firstAccessor.decorators&&e===t.secondAccessor)return ie(e,Jm.Diagnostics.Decorators_cannot_be_applied_to_multiple_get_Slashset_accessors_of_the_same_name)}}return!1}function wm(e){var t,r,n,i,s=!!(s=e).modifiers&&((e=>{switch(e.kind){case 153:case 154:case 152:case 149:case 148:case 151:case 150:case 157:case 233:case 238:case 237:case 244:case 243:case 186:case 187:case 146:return;default:if(234===e.parent.kind||265===e.parent.kind)return;switch(e.kind){case 228:return Im(e,120);case 229:return Im(e,117);case 230:case 208:case 231:return 1;case 232:return Im(e,76);default:return void Jm.Debug.fail()}}})(s)?ie(s,Jm.Diagnostics.Modifiers_cannot_appear_here):void 0);if(void 0!==s)return s;for(var a=0,o=0,l=e.modifiers;o<l.length;o++){var c=l[o];if(131!==c.kind){if(148===e.kind||150===e.kind)return H(c,Jm.Diagnostics._0_modifier_cannot_appear_on_a_type_member,Jm.tokenToString(c.kind));if(157===e.kind)return H(c,Jm.Diagnostics._0_modifier_cannot_appear_on_an_index_signature,Jm.tokenToString(c.kind))}switch(c.kind){case 76:if(232!==e.kind&&229===e.parent.kind)return H(e,Jm.Diagnostics.A_class_member_cannot_have_the_0_keyword,Jm.tokenToString(76));break;case 114:case 113:case 112:var u=Kn(Jm.modifierToFlag(c.kind));if(28&a)return H(c,Jm.Diagnostics.Accessibility_modifier_already_seen);if(32&a)return H(c,Jm.Diagnostics._0_modifier_must_precede_1_modifier,u,"static");if(64&a)return H(c,Jm.Diagnostics._0_modifier_must_precede_1_modifier,u,"readonly");if(256&a)return H(c,Jm.Diagnostics._0_modifier_must_precede_1_modifier,u,"async");if(234===e.parent.kind||265===e.parent.kind)return H(c,Jm.Diagnostics._0_modifier_cannot_appear_on_a_module_or_namespace_element,u);if(128&a)return 112===c.kind?H(c,Jm.Diagnostics._0_modifier_cannot_be_used_with_1_modifier,u,"abstract"):H(c,Jm.Diagnostics._0_modifier_must_precede_1_modifier,u,"abstract");a|=Jm.modifierToFlag(c.kind);break;case 115:if(32&a)return H(c,Jm.Diagnostics._0_modifier_already_seen,"static");if(64&a)return H(c,Jm.Diagnostics._0_modifier_must_precede_1_modifier,"static","readonly");if(256&a)return H(c,Jm.Diagnostics._0_modifier_must_precede_1_modifier,"static","async");if(234===e.parent.kind||265===e.parent.kind)return H(c,Jm.Diagnostics._0_modifier_cannot_appear_on_a_module_or_namespace_element,"static");if(146===e.kind)return H(c,Jm.Diagnostics._0_modifier_cannot_appear_on_a_parameter,"static");if(128&a)return H(c,Jm.Diagnostics._0_modifier_cannot_be_used_with_1_modifier,"static","abstract");a|=32,t=c;break;case 131:if(64&a)return H(c,Jm.Diagnostics._0_modifier_already_seen,"readonly");if(149!==e.kind&&148!==e.kind&&157!==e.kind&&146!==e.kind)return H(c,Jm.Diagnostics.readonly_modifier_can_only_appear_on_a_property_declaration_or_index_signature);a|=64,i=c;break;case 84:if(1&a)return H(c,Jm.Diagnostics._0_modifier_already_seen,"export");if(2&a)return H(c,Jm.Diagnostics._0_modifier_must_precede_1_modifier,"export","declare");if(128&a)return H(c,Jm.Diagnostics._0_modifier_must_precede_1_modifier,"export","abstract");if(256&a)return H(c,Jm.Diagnostics._0_modifier_must_precede_1_modifier,"export","async");if(229===e.parent.kind)return H(c,Jm.Diagnostics._0_modifier_cannot_appear_on_a_class_element,"export");if(146===e.kind)return H(c,Jm.Diagnostics._0_modifier_cannot_appear_on_a_parameter,"export");a|=1;break;case 79:u=(265===e.parent.kind?e:e.parent).parent;if(233===u.kind&&!Jm.isAmbientModule(u))return H(c,Jm.Diagnostics.A_default_export_can_only_be_used_in_an_ECMAScript_style_module);a|=512;break;case 124:if(2&a)return H(c,Jm.Diagnostics._0_modifier_already_seen,"declare");if(256&a)return H(c,Jm.Diagnostics._0_modifier_cannot_be_used_in_an_ambient_context,"async");if(229===e.parent.kind)return H(c,Jm.Diagnostics._0_modifier_cannot_appear_on_a_class_element,"declare");if(146===e.kind)return H(c,Jm.Diagnostics._0_modifier_cannot_appear_on_a_parameter,"declare");if(Jm.isInAmbientContext(e.parent)&&234===e.parent.kind)return H(c,Jm.Diagnostics.A_declare_modifier_cannot_be_used_in_an_already_ambient_context);a|=2,r=c;break;case 117:if(128&a)return H(c,Jm.Diagnostics._0_modifier_already_seen,"abstract");if(229!==e.kind){if(151!==e.kind&&149!==e.kind&&153!==e.kind&&154!==e.kind)return H(c,Jm.Diagnostics.abstract_modifier_can_only_appear_on_a_class_method_or_property_declaration);if(229!==e.parent.kind||!Jm.hasModifier(e.parent,128))return H(c,Jm.Diagnostics.Abstract_methods_can_only_appear_within_an_abstract_class);if(32&a)return H(c,Jm.Diagnostics._0_modifier_cannot_be_used_with_1_modifier,"static","abstract");if(8&a)return H(c,Jm.Diagnostics._0_modifier_cannot_be_used_with_1_modifier,"private","abstract")}a|=128;break;case 120:if(256&a)return H(c,Jm.Diagnostics._0_modifier_already_seen,"async");if(2&a||Jm.isInAmbientContext(e.parent))return H(c,Jm.Diagnostics._0_modifier_cannot_be_used_in_an_ambient_context,"async");if(146===e.kind)return H(c,Jm.Diagnostics._0_modifier_cannot_appear_on_a_parameter,"async");a|=256,n=c}}if(152===e.kind)return 32&a?H(t,Jm.Diagnostics._0_modifier_cannot_appear_on_a_constructor_declaration,"static"):128&a?H(t,Jm.Diagnostics._0_modifier_cannot_appear_on_a_constructor_declaration,"abstract"):256&a?H(n,Jm.Diagnostics._0_modifier_cannot_appear_on_a_constructor_declaration,"async"):64&a?H(i,Jm.Diagnostics._0_modifier_cannot_appear_on_a_constructor_declaration,"readonly"):void 0;if((238===e.kind||237===e.kind)&&2&a)return H(r,Jm.Diagnostics.A_0_modifier_cannot_be_used_with_an_import_declaration,"declare");if(146===e.kind&&92&a&&Jm.isBindingPattern(e.name))return H(e,Jm.Diagnostics.A_parameter_property_may_not_be_declared_using_a_binding_pattern);if(146===e.kind&&92&a&&e.dotDotDotToken)return H(e,Jm.Diagnostics.A_parameter_property_cannot_be_declared_using_a_rest_parameter);if(256&a){s=n;switch(e.kind){case 151:case 228:case 186:case 187:return!1}return H(s,Jm.Diagnostics._0_modifier_cannot_be_used_here,"async")}}function Im(e,t){return 1<e.modifiers.length||e.modifiers[0].kind!==t}function Am(e){var t;if(e&&e.hasTrailingComma)return t=e.end-",".length,zm(e[0],t,e.end-t,Jm.Diagnostics.Trailing_comma_not_allowed)}function Dm(e,t){var r;return!!Am(e)||(e&&0===e.length?zm(t,r=e.pos-"<".length,Jm.skipTrivia(t.text,e.end)+">".length-r,Jm.Diagnostics.Type_parameter_list_cannot_be_empty):void 0)}function Nm(e){var t=Jm.getSourceFileOfNode(e);return Cm(e)||wm(e)||Dm(e.typeParameters,t)||(e=>{for(var t=!1,r=e.length,n=0;n<r;n++){var i=e[n];if(i.dotDotDotToken){if(n!==r-1)return H(i.dotDotDotToken,Jm.Diagnostics.A_rest_parameter_must_be_last_in_a_parameter_list);if(Jm.isBindingPattern(i.name))return H(i.name,Jm.Diagnostics.A_rest_element_cannot_contain_a_binding_pattern);if(i.questionToken)return H(i.questionToken,Jm.Diagnostics.A_rest_parameter_cannot_be_optional);if(i.initializer)return H(i.name,Jm.Diagnostics.A_rest_parameter_cannot_have_an_initializer)}else if(i.questionToken){if(t=!0,i.initializer)return H(i.name,Jm.Diagnostics.Parameter_cannot_have_question_mark_and_initializer)}else if(t&&!i.initializer)return H(i.name,Jm.Diagnostics.A_required_parameter_cannot_follow_an_optional_parameter)}})(e.parameters)||((e,t)=>{if(187===e.kind){var r=Jm.getLineAndCharacterOfPosition(t,e.equalsGreaterThanToken.pos).line,t=Jm.getLineAndCharacterOfPosition(t,e.equalsGreaterThanToken.end).line;if(r!==t)return H(e.equalsGreaterThanToken,Jm.Diagnostics.Line_terminator_not_permitted_before_arrow)}return!1})(e,t)}function Om(e,t){return Am(t)||((e,t)=>{var r;if(t&&0===t.length)return zm(e=Jm.getSourceFileOfNode(e),r=t.pos-"<".length,Jm.skipTrivia(e.text,t.end)+">".length-r,Jm.Diagnostics.Type_argument_list_cannot_be_empty)})(e,t)}function Rm(e){if(e)for(var t=0,r=e;t<r.length;t++){var n=r[t];if(200===n.kind)return zm(n,n.pos,0,Jm.Diagnostics.Argument_expression_expected)}}function Lm(e){var t,r=e.types;if(!Am(r))return r&&0===r.length?(t=Jm.tokenToString(e.token),zm(e,r.pos,0,Jm.Diagnostics._0_list_cannot_be_empty,t)):void Jm.forEach(r,Pm)}function Pm(e){return Om(e,e.typeArguments)}function Mm(e){144===e.kind&&194===e.expression.kind&&26===e.expression.operatorToken.kind&&H(e.expression,Jm.Diagnostics.A_comma_expression_is_not_allowed_in_a_computed_property_name)}function Fm(e){return e.asteriskToken&&(Jm.Debug.assert(228===e.kind||186===e.kind||151===e.kind),Jm.isInAmbientContext(e)?H(e.asteriskToken,Jm.Diagnostics.Generators_are_not_allowed_in_an_ambient_context):!e.body&&H(e.asteriskToken,Jm.Diagnostics.An_overload_signature_cannot_be_declared_as_a_generator))}function Bm(e,t){return e&&H(e,t)}function $m(e){if(!Wm(e)){if(216===e.kind&&e.awaitModifier&&0==(16384&e.flags))return H(e.awaitModifier,Jm.Diagnostics.A_for_await_of_statement_is_only_allowed_within_an_async_function_or_async_generator);if(227===e.initializer.kind){var t=e.initializer;if(!jm(t)){var r=t.declarations;if(!r.length)return;if(1<r.length)return n=215===e.kind?Jm.Diagnostics.Only_a_single_variable_declaration_is_allowed_in_a_for_in_statement:Jm.Diagnostics.Only_a_single_variable_declaration_is_allowed_in_a_for_of_statement,ie(t.declarations[1],n);var n,t=r[0];if(t.initializer)return n=215===e.kind?Jm.Diagnostics.The_variable_declaration_of_a_for_in_statement_cannot_have_an_initializer:Jm.Diagnostics.The_variable_declaration_of_a_for_of_statement_cannot_have_an_initializer,H(t.name,n);if(t.type)return H(t,n=215===e.kind?Jm.Diagnostics.The_left_hand_side_of_a_for_in_statement_cannot_use_a_type_annotation:Jm.Diagnostics.The_left_hand_side_of_a_for_of_statement_cannot_use_a_type_annotation)}}}}function Um(e){if(e.parameters.length===(153===e.kind?1:2))return Jm.getThisParameter(e)}function Vm(e,t){if(Jm.isDynamicName(e))return H(e,t)}function Hm(e){if((t=e).modifiers&&178===t.parent.kind&&(!(2&Jm.getFunctionFlags(t))||1<t.modifiers.length)&&ie(t,Jm.Diagnostics.Modifiers_cannot_appear_here)||Nm(e)||Fm(e))return 1;var t;if(178===e.parent.kind){if(Bm(e.questionToken,Jm.Diagnostics.An_object_member_cannot_be_declared_optional))return 1;if(void 0===e.body)return zm(e,e.end-1,";".length,Jm.Diagnostics._0_expected,"{")}return Jm.isClassLike(e.parent)?Jm.isInAmbientContext(e)?Vm(e.name,Jm.Diagnostics.A_computed_property_name_in_an_ambient_context_must_directly_refer_to_a_built_in_symbol):!e.body&&Vm(e.name,Jm.Diagnostics.A_computed_property_name_in_a_method_overload_must_directly_refer_to_a_built_in_symbol):230===e.parent.kind?Vm(e.name,Jm.Diagnostics.A_computed_property_name_in_an_interface_must_directly_refer_to_a_built_in_symbol):163===e.parent.kind&&Vm(e.name,Jm.Diagnostics.A_computed_property_name_in_a_type_literal_must_directly_refer_to_a_built_in_symbol)}function Gm(e){return 9===e.kind||8===e.kind||192===e.kind&&38===e.operator&&8===e.operand.kind}function jm(e){var t=e.declarations;return Am(e.declarations)||!e.declarations.length&&zm(e,t.pos,t.end-t.pos,Jm.Diagnostics.Variable_declaration_list_cannot_be_empty)}function Km(e){return 0<e.parseDiagnostics.length}function ie(e,t,r,n,i){var s=Jm.getSourceFileOfNode(e);if(!Km(s))return e=Jm.getSpanOfTokenAtPosition(s,e.pos),sr.add(Jm.createFileDiagnostic(s,e.start,e.length,t,r,n,i)),!0}function zm(e,t,r,n,i,s,a){e=Jm.getSourceFileOfNode(e);if(!Km(e))return sr.add(Jm.createFileDiagnostic(e,t,r,n,i,s,a)),!0}function H(e,t,r,n,i){if(!Km(Jm.getSourceFileOfNode(e)))return sr.add(Jm.createDiagnosticForNode(e,t,r,n,i)),!0}function Wm(e){var t;return Jm.isInAmbientContext(e)&&(Jm.isAccessor(e.parent)?b(e).hasReportedStatementInAmbientContext=!0:!b(e).hasReportedStatementInAmbientContext&&Jm.isFunctionLike(e.parent)?b(e).hasReportedStatementInAmbientContext=ie(e,Jm.Diagnostics.An_implementation_cannot_be_declared_in_ambient_contexts):207!==e.parent.kind&&234!==e.parent.kind&&265!==e.parent.kind||(t=b(e.parent)).hasReportedStatementInAmbientContext?void 0:t.hasReportedStatementInAmbientContext=ie(e,Jm.Diagnostics.Statements_are_not_allowed_in_ambient_contexts))}function qm(e){if(4&e.numericLiteralFlags){var t,r,n=void 0;if(1<=j?n=Jm.Diagnostics.Octal_literals_are_not_available_when_targeting_ECMAScript_5_and_higher_Use_the_syntax_0:Jm.isChildOfNodeWithKind(e,173)?n=Jm.Diagnostics.Octal_literal_types_must_use_ES2015_syntax_Use_the_syntax_0:Jm.isChildOfNodeWithKind(e,264)&&(n=Jm.Diagnostics.Octal_literals_are_not_allowed_in_enums_members_initializer_Use_the_syntax_0),n)return r=((t=Jm.isPrefixUnaryExpression(e.parent)&&38===e.parent.operator)?"-":"")+"0o"+e.text,H(t?e.parent:e,n,r)}}}})(ts=ts||{}),(c=>{function u(e){e=c.createNode(e,-1,-1);return e.flags|=8,e}function d(e,t){return e!==t&&(M(e,t),L(e,t),t.startsOnNewLine&&(e.startsOnNewLine=!0),c.aggregateTransformFlags(e)),e}function p(e,t){if(e){if(c.isNodeArray(e))return e}else e=[];return e.pos=-1,e.end=-1,e.hasTrailingComma=t,e}function r(e){if(void 0!==e){var t,r=u(e.kind);for(t in r.flags|=e.flags,M(r,e),e)!r.hasOwnProperty(t)&&e.hasOwnProperty(t)&&(r[t]=e[t]);return r}}function n(e){return"number"==typeof e?i(e+""):"boolean"==typeof e?(e?m:F)():c.isString(e)?s(e):(e=e,(t=s(c.getTextOfIdentifierOrLiteral(e))).textSourceNode=e,t);var t}function i(e){var t=u(8);return t.text=e,t.numericLiteralFlags=0,t}function s(e){var t=u(9);return t.text=e,t}function a(e,t){var r=u(71);return r.escapedText=c.escapeLeadingUnderscores(e),r.originalKeywordKind=e?c.stringToToken(e):0,r.autoGenerateKind=0,r.autoGenerateId=0,t&&(r.typeArguments=p(t)),r}c.updateNode=d,c.createNodeArray=p,c.getSynthesizedClone=r,c.createLiteral=n,c.createNumericLiteral=i,c.createIdentifier=a,c.updateIdentifier=function(e,t){return e.typeArguments!==t?d(a(c.idText(e),t),e):e};var o,l=0;function h(e){return u(e)}function m(){return u(101)}function F(){return u(86)}function B(e,t){var r=u(143);return r.left=e,r.right=N(t),r}function $(e){var t=u(144);return t.expression=e,t}function U(e,t,r){var n=u(145);return n.name=N(e),n.constraint=t,n.default=r,n}function V(e,t,r,n,i,s,a){var o=u(146);return o.decorators=O(e),o.modifiers=O(t),o.dotDotDotToken=r,o.name=N(n),o.questionToken=i,o.type=s,o.initializer=a?c.parenthesizeExpressionForList(a):void 0,o}function H(e){var t=u(147);return t.expression=c.parenthesizeForAccess(e),t}function G(e,t,r,n,i){var s=u(148);return s.modifiers=O(e),s.name=N(t),s.questionToken=r,s.type=n,s.initializer=i,s}function j(e,t,r,n,i,s){var a=u(149);return a.decorators=O(e),a.modifiers=O(t),a.name=N(r),a.questionToken=n,a.type=i,a.initializer=s,a}function K(e,t,r,n,i){e=g(150,e,t,r);return e.name=N(n),e.questionToken=i,e}function z(e,t,r,n,i,s,a,o,l){var c=u(151);return c.decorators=O(e),c.modifiers=O(t),c.asteriskToken=r,c.name=N(n),c.questionToken=i,c.typeParameters=O(s),c.parameters=p(a),c.type=o,c.body=l,c}function W(e,t,r,n){var i=u(152);return i.decorators=O(e),i.modifiers=O(t),i.typeParameters=void 0,i.parameters=p(r),i.type=void 0,i.body=n,i}function q(e,t,r,n,i,s){var a=u(153);return a.decorators=O(e),a.modifiers=O(t),a.name=N(r),a.typeParameters=void 0,a.parameters=p(n),a.type=i,a.body=s,a}function J(e,t,r,n,i){var s=u(154);return s.decorators=O(e),s.modifiers=O(t),s.name=N(r),s.typeParameters=void 0,s.parameters=p(n),s.body=i,s}function Y(e,t,r,n){var i=u(157);return i.decorators=O(e),i.modifiers=O(t),i.parameters=p(r),i.type=n,i}function g(e,t,r,n){e=u(e);return e.typeParameters=O(t),e.parameters=O(r),e.type=n,e}function e(e,t,r,n){return e.typeParameters!==t||e.parameters!==r||e.type!==n?d(g(e.kind,t,r,n),e):e}function X(e,t){var r=u(158);return r.parameterName=N(e),r.type=t,r}function Z(e,t){var r=u(159);return r.typeName=N(e),r.typeArguments=t&&c.parenthesizeTypeParameters(t),r}function Q(e){var t=u(162);return t.exprName=e,t}function ee(e){var t=u(163);return t.members=p(e),t}function te(e){var t=u(164);return t.elementType=c.parenthesizeArrayTypeMember(e),t}function re(e){var t=u(165);return t.elementTypes=p(e),t}function f(e,t){e=u(e);return e.types=c.parenthesizeElementTypeMembers(t),e}function t(e,t){return e.types!==t?d(f(e.kind,t),e):e}function ne(e){var t=u(168);return t.type=e,t}function ie(e){var t=u(170);return t.operator=127,t.type=c.parenthesizeElementTypeMember(e),t}function se(e,t){var r=u(171);return r.objectType=c.parenthesizeElementTypeMember(e),r.indexType=t,r}function ae(e,t,r,n){var i=u(172);return i.readonlyToken=e,i.typeParameter=t,i.questionToken=r,i.type=n,i}function oe(e){var t=u(173);return t.literal=e,t}function le(e){var t=u(174);return t.elements=p(e),t}function ce(e){var t=u(175);return t.elements=p(e),t}function ue(e,t,r,n){var i=u(176);return i.dotDotDotToken=e,i.propertyName=N(t),i.name=N(r),i.initializer=n,i}function de(e,t){var r=u(177);return r.elements=c.parenthesizeListElements(p(e)),t&&(r.multiLine=!0),r}function pe(e,t){var r=u(178);return r.properties=p(e),t&&(r.multiLine=!0),r}function he(e,t){var r=u(179);return r.expression=c.parenthesizeForAccess(e),r.name=N(t),P(r,131072),r}function me(e,t){var r=u(180);return r.expression=c.parenthesizeForAccess(e),r.argumentExpression=(e=t,c.isString(e)||"number"==typeof e?n(e):e),r}function _(e,t,r){var n=u(181);return n.expression=c.parenthesizeForAccess(e),n.typeArguments=O(t),n.arguments=c.parenthesizeListElements(p(r)),n}function ge(e,t,r){var n=u(182);return n.expression=c.parenthesizeForNew(e),n.typeArguments=O(t),n.arguments=r?c.parenthesizeListElements(p(r)):void 0,n}function fe(e,t){var r=u(183);return r.tag=c.parenthesizeForAccess(e),r.template=t,r}function _e(e,t){var r=u(184);return r.type=e,r.expression=c.parenthesizePrefixOperand(t),r}function ye(e){var t=u(185);return t.expression=e,t}function y(e,t,r,n,i,s,a){var o=u(186);return o.modifiers=O(e),o.asteriskToken=t,o.name=N(r),o.typeParameters=O(n),o.parameters=p(i),o.type=s,o.body=a,o}function b(e,t,r,n,i,s){var a=u(187);return a.modifiers=O(e),a.typeParameters=O(t),a.parameters=p(r),a.type=n,a.equalsGreaterThanToken=i||u(36),a.body=c.parenthesizeConciseBody(s),a}function be(e){var t=u(188);return t.expression=c.parenthesizePrefixOperand(e),t}function ve(e){var t=u(189);return t.expression=c.parenthesizePrefixOperand(e),t}function v(e){var t=u(190);return t.expression=c.parenthesizePrefixOperand(e),t}function Te(e){var t=u(191);return t.expression=c.parenthesizePrefixOperand(e),t}function T(e,t){var r=u(192);return r.operator=e,r.operand=c.parenthesizePrefixOperand(t),r}function k(e,t){var r=u(193);return r.operand=c.parenthesizePostfixOperand(e),r.operator=t,r}function x(e,t,r){var n=u(194),t="number"==typeof(t=t)?h(t):t,i=t.kind;return n.left=c.parenthesizeBinaryOperand(i,e,!0,void 0),n.operatorToken=t,n.right=c.parenthesizeBinaryOperand(i,r,!1,n.left),n}function ke(e,t,r,n,i){var s=u(195);return s.condition=c.parenthesizeForConditionalHead(e),s.questionToken=i?t:u(55),s.whenTrue=c.parenthesizeSubexpressionOfConditionalExpression(i?r:t),s.colonToken=i?n:u(56),s.whenFalse=c.parenthesizeSubexpressionOfConditionalExpression(i||r),s}function xe(e,t){var r=u(196);return r.head=e,r.templateSpans=p(t),r}function Ee(e,t){var r=u(197);return r.asteriskToken=e&&39===e.kind?e:void 0,r.expression=e&&39!==e.kind?e:t,r}function Se(e){var t=u(198);return t.expression=c.parenthesizeExpressionForList(e),t}function Ce(e,t,r,n,i){var s=u(199);return s.decorators=void 0,s.modifiers=O(e),s.name=N(t),s.typeParameters=O(r),s.heritageClauses=O(n),s.members=p(i),s}function we(e,t){var r=u(201);return r.expression=c.parenthesizeForAccess(t),r.typeArguments=O(e),r}function Ie(e,t){var r=u(202);return r.expression=e,r.type=t,r}function Ae(e){var t=u(203);return t.expression=c.parenthesizeForAccess(e),t}function De(e,t){var r=u(204);return r.keywordToken=e,r.name=t,r}function Ne(e,t){var r=u(205);return r.expression=e,r.literal=t,r}function E(e,t){var r=u(207);return r.statements=p(e),t&&(r.multiLine=t),r}function Oe(e,t){var r=u(208);return r.decorators=void 0,r.modifiers=O(e),r.declarationList=c.isArray(t)?C(t):t,r}function Re(e){var t=u(210);return t.expression=c.parenthesizeExpressionForExpressionStatement(e),t}function Le(e,t,r){var n=u(211);return n.expression=e,n.thenStatement=t,n.elseStatement=r,n}function Pe(e,t){var r=u(212);return r.statement=e,r.expression=t,r}function Me(e,t){var r=u(213);return r.expression=e,r.statement=t,r}function Fe(e,t,r,n){var i=u(214);return i.initializer=e,i.condition=t,i.incrementor=r,i.statement=n,i}function Be(e,t,r){var n=u(215);return n.initializer=e,n.expression=t,n.statement=r,n}function $e(e,t,r,n){var i=u(216);return i.awaitModifier=e,i.initializer=t,i.expression=r,i.statement=n,i}function Ue(e){var t=u(217);return t.label=N(e),t}function Ve(e){var t=u(218);return t.label=N(e),t}function He(e){var t=u(219);return t.expression=e,t}function Ge(e,t){var r=u(220);return r.expression=e,r.statement=t,r}function je(e,t){var r=u(221);return r.expression=c.parenthesizeExpressionForList(e),r.caseBlock=t,r}function Ke(e,t){var r=u(222);return r.label=N(e),r.statement=t,r}function ze(e){var t=u(223);return t.expression=e,t}function We(e,t,r){var n=u(224);return n.tryBlock=e,n.catchClause=t,n.finallyBlock=r,n}function S(e,t,r){var n=u(226);return n.name=N(e),n.type=t,n.initializer=void 0!==r?c.parenthesizeExpressionForList(r):void 0,n}function C(e,t){var r=u(227);return r.flags|=3&t,r.declarations=p(e),r}function qe(e,t,r,n,i,s,a,o){var l=u(228);return l.decorators=O(e),l.modifiers=O(t),l.asteriskToken=r,l.name=N(n),l.typeParameters=O(i),l.parameters=p(s),l.type=a,l.body=o,l}function Je(e,t,r,n,i,s){var a=u(229);return a.decorators=O(e),a.modifiers=O(t),a.name=N(r),a.typeParameters=O(n),a.heritageClauses=O(i),a.members=p(s),a}function Ye(e,t,r,n,i,s){var a=u(230);return a.decorators=O(e),a.modifiers=O(t),a.name=N(r),a.typeParameters=O(n),a.heritageClauses=O(i),a.members=p(s),a}function Xe(e,t,r,n,i){var s=u(231);return s.decorators=O(e),s.modifiers=O(t),s.name=N(r),s.typeParameters=O(n),s.type=i,s}function Ze(e,t,r,n){var i=u(232);return i.decorators=O(e),i.modifiers=O(t),i.name=N(r),i.members=p(n),i}function Qe(e,t,r,n,i){var s=u(233);return s.flags|=532&i,s.decorators=O(e),s.modifiers=O(t),s.name=r,s.body=n,s}function et(e){var t=u(234);return t.statements=p(e),t}function tt(e){var t=u(235);return t.clauses=p(e),t}function rt(e){var t=u(236);return t.name=N(e),t}function nt(e,t,r,n){var i=u(237);return i.decorators=O(e),i.modifiers=O(t),i.name=N(r),i.moduleReference=n,i}function it(e,t,r,n){var i=u(238);return i.decorators=O(e),i.modifiers=O(t),i.importClause=r,i.moduleSpecifier=n,i}function st(e,t){var r=u(239);return r.name=e,r.namedBindings=t,r}function at(e){var t=u(240);return t.name=e,t}function ot(e){var t=u(241);return t.elements=p(e),t}function lt(e,t){var r=u(242);return r.propertyName=e,r.name=t,r}function w(e,t,r,n){var i=u(243);return i.decorators=O(e),i.modifiers=O(t),i.isExportEquals=r,i.expression=n,i}function I(e,t,r,n){var i=u(244);return i.decorators=O(e),i.modifiers=O(t),i.exportClause=r,i.moduleSpecifier=n,i}function A(e){var t=u(245);return t.elements=p(e),t}function D(e,t){var r=u(246);return r.propertyName=N(e),r.name=N(t),r}function ct(e){var t=u(248);return t.expression=e,t}function ut(e,t,r){var n=u(249);return n.openingElement=e,n.children=p(t),n.closingElement=r,n}function dt(e,t){var r=u(250);return r.tagName=e,r.attributes=t,r}function pt(e,t){var r=u(251);return r.tagName=e,r.attributes=t,r}function ht(e){var t=u(252);return t.tagName=e,t}function mt(e,t){var r=u(253);return r.name=e,r.initializer=t,r}function gt(e){var t=u(254);return t.properties=p(e),t}function ft(e){var t=u(255);return t.expression=e,t}function _t(e,t){var r=u(256);return r.dotDotDotToken=e,r.expression=t,r}function yt(e,t){var r=u(257);return r.expression=c.parenthesizeExpressionForList(e),r.statements=p(t),r}function bt(e){var t=u(258);return t.statements=p(e),t}function vt(e,t){var r=u(259);return r.token=e,r.types=p(t),r}function Tt(e,t){var r=u(260);return r.variableDeclaration=c.isString(e)?S(e):e,r.block=t,r}function kt(e,t){var r=u(261);return r.name=N(e),r.questionToken=void 0,r.initializer=void 0!==t?c.parenthesizeExpressionForList(t):void 0,r}function xt(e,t){var r=u(262);return r.name=N(e),r.objectAssignmentInitializer=void 0!==t?c.parenthesizeExpressionForList(t):void 0,r}function Et(e){var t=u(263);return t.expression=void 0!==e?c.parenthesizeExpressionForList(e):void 0,t}function St(e,t){var r=u(264);return r.name=N(e),r.initializer=t&&c.parenthesizeExpressionForList(t),r}function Ct(e,t){var r=u(288);return r.expression=e,r.original=t,L(r,t),r}function wt(e){if(c.nodeIsSynthesized(e)&&!c.isParseTreeNode(e)&&!e.original&&!e.emitNode&&!e.id){if(289===e.kind)return e.elements;if(c.isBinaryExpression(e)&&26===e.operatorToken.kind)return[e.left,e.right]}return e}function It(e){var t=u(289);return t.elements=p(c.sameFlatMap(e,wt)),t}function At(e){var t=c.createNode(266);return t.sourceFiles=e,t}function N(e){return c.isString(e)?a(e):e}function O(e){return e?p(e):void 0}function R(e){if(!e.emitNode){if(c.isParseTreeNode(e)){if(265===e.kind)return e.emitNode={annotatedNodes:[e]};R(c.getSourceFileOfNode(e)).annotatedNodes.push(e)}e.emitNode={}}return e.emitNode}function L(e,t){return t&&(e.pos=t.pos,e.end=t.end),e}function P(e,t){return R(e).flags=t,e}function Dt(e){e=e.emitNode;return e&&e.leadingComments}function Nt(e,t){return R(e).leadingComments=t,e}function Ot(e){e=e.emitNode;return e&&e.trailingComments}function Rt(e,t){return R(e).trailingComments=t,e}function M(e,t){return(e.original=t)&&(t=t.emitNode)&&(e.emitNode=((e,t)=>{var r=e.flags,n=e.leadingComments,i=e.trailingComments,s=e.commentRange,a=e.sourceMapRange,o=e.tokenSourceMapRanges,l=e.constantValue,e=e.helpers;return t=t||{},n&&(t.leadingComments=c.addRange(n.slice(),t.leadingComments)),i&&(t.trailingComments=c.addRange(i.slice(),t.trailingComments)),r&&(t.flags=r),s&&(t.commentRange=s),a&&(t.sourceMapRange=a),o&&(t.tokenSourceMapRanges=((e,t)=>{for(var r in t=t||[],e)t[r]=e[r];return t})(o,t.tokenSourceMapRanges)),void 0!==l&&(t.constantValue=l),e&&(t.helpers=c.addRange(t.helpers,e)),t})(t,e.emitNode)),e}c.createTempVariable=function(e){var t=a("");return t.autoGenerateKind=1,t.autoGenerateId=l,l++,e&&e(t),t},c.createLoopVariable=function(){var e=a("");return e.autoGenerateKind=2,e.autoGenerateId=l,l++,e},c.createUniqueName=function(e){return(e=a(e)).autoGenerateKind=3,e.autoGenerateId=l,l++,e},c.getGeneratedNameForNode=function(e){var t=a("");return t.autoGenerateKind=4,t.autoGenerateId=l,t.original=e,l++,t},c.createToken=h,c.createSuper=function(){return u(97)},c.createThis=function(){return u(99)},c.createNull=function(){return u(95)},c.createTrue=m,c.createFalse=F,c.createQualifiedName=B,c.updateQualifiedName=function(e,t,r){return e.left!==t||e.right!==r?d(B(t,r),e):e},c.createComputedPropertyName=$,c.updateComputedPropertyName=function(e,t){return e.expression!==t?d($(t),e):e},c.createTypeParameterDeclaration=U,c.updateTypeParameterDeclaration=function(e,t,r,n){return e.name!==t||e.constraint!==r||e.default!==n?d(U(t,r,n),e):e},c.createParameter=V,c.updateParameter=function(e,t,r,n,i,s,a,o){return e.decorators!==t||e.modifiers!==r||e.dotDotDotToken!==n||e.name!==i||e.questionToken!==s||e.type!==a||e.initializer!==o?d(V(t,r,n,i,s,a,o),e):e},c.createDecorator=H,c.updateDecorator=function(e,t){return e.expression!==t?d(H(t),e):e},c.createPropertySignature=G,c.updatePropertySignature=function(e,t,r,n,i,s){return e.modifiers!==t||e.name!==r||e.questionToken!==n||e.type!==i||e.initializer!==s?d(G(t,r,n,i,s),e):e},c.createProperty=j,c.updateProperty=function(e,t,r,n,i,s,a){return e.decorators!==t||e.modifiers!==r||e.name!==n||e.questionToken!==i||e.type!==s||e.initializer!==a?d(j(t,r,n,i,s,a),e):e},c.createMethodSignature=K,c.updateMethodSignature=function(e,t,r,n,i,s){return e.typeParameters!==t||e.parameters!==r||e.type!==n||e.name!==i||e.questionToken!==s?d(K(t,r,n,i,s),e):e},c.createMethod=z,c.updateMethod=function(e,t,r,n,i,s,a,o,l,c){return e.decorators!==t||e.modifiers!==r||e.asteriskToken!==n||e.name!==i||e.questionToken!==s||e.typeParameters!==a||e.parameters!==o||e.type!==l||e.body!==c?d(z(t,r,n,i,s,a,o,l,c),e):e},c.createConstructor=W,c.updateConstructor=function(e,t,r,n,i){return e.decorators!==t||e.modifiers!==r||e.parameters!==n||e.body!==i?d(W(t,r,n,i),e):e},c.createGetAccessor=q,c.updateGetAccessor=function(e,t,r,n,i,s,a){return e.decorators!==t||e.modifiers!==r||e.name!==n||e.parameters!==i||e.type!==s||e.body!==a?d(q(t,r,n,i,s,a),e):e},c.createSetAccessor=J,c.updateSetAccessor=function(e,t,r,n,i,s){return e.decorators!==t||e.modifiers!==r||e.name!==n||e.parameters!==i||e.body!==s?d(J(t,r,n,i,s),e):e},c.createCallSignature=function(e,t,r){return g(155,e,t,r)},c.updateCallSignature=e,c.createConstructSignature=function(e,t,r){return g(156,e,t,r)},c.updateConstructSignature=e,c.createIndexSignature=Y,c.updateIndexSignature=function(e,t,r,n,i){return e.parameters!==n||e.type!==i||e.decorators!==t||e.modifiers!==r?d(Y(t,r,n,i),e):e},c.createSignatureDeclaration=g,c.createKeywordTypeNode=u,c.createTypePredicateNode=X,c.updateTypePredicateNode=function(e,t,r){return e.parameterName!==t||e.type!==r?d(X(t,r),e):e},c.createTypeReferenceNode=Z,c.updateTypeReferenceNode=function(e,t,r){return e.typeName!==t||e.typeArguments!==r?d(Z(t,r),e):e},c.createFunctionTypeNode=function(e,t,r){return g(160,e,t,r)},c.updateFunctionTypeNode=e,c.createConstructorTypeNode=function(e,t,r){return g(161,e,t,r)},c.updateConstructorTypeNode=e,c.createTypeQueryNode=Q,c.updateTypeQueryNode=function(e,t){return e.exprName!==t?d(Q(t),e):e},c.createTypeLiteralNode=ee,c.updateTypeLiteralNode=function(e,t){return e.members!==t?d(ee(t),e):e},c.createArrayTypeNode=te,c.updateArrayTypeNode=function(e,t){return e.elementType!==t?d(te(t),e):e},c.createTupleTypeNode=re,c.updateTypleTypeNode=function(e,t){return e.elementTypes!==t?d(re(t),e):e},c.createUnionTypeNode=function(e){return f(166,e)},c.updateUnionTypeNode=t,c.createIntersectionTypeNode=function(e){return f(167,e)},c.updateIntersectionTypeNode=t,c.createUnionOrIntersectionTypeNode=f,c.createParenthesizedType=ne,c.updateParenthesizedType=function(e,t){return e.type!==t?d(ne(t),e):e},c.createThisTypeNode=function(){return u(169)},c.createTypeOperatorNode=ie,c.updateTypeOperatorNode=function(e,t){return e.type!==t?d(ie(t),e):e},c.createIndexedAccessTypeNode=se,c.updateIndexedAccessTypeNode=function(e,t,r){return e.objectType!==t||e.indexType!==r?d(se(t,r),e):e},c.createMappedTypeNode=ae,c.updateMappedTypeNode=function(e,t,r,n,i){return e.readonlyToken!==t||e.typeParameter!==r||e.questionToken!==n||e.type!==i?d(ae(t,r,n,i),e):e},c.createLiteralTypeNode=oe,c.updateLiteralTypeNode=function(e,t){return e.literal!==t?d(oe(t),e):e},c.createObjectBindingPattern=le,c.updateObjectBindingPattern=function(e,t){return e.elements!==t?d(le(t),e):e},c.createArrayBindingPattern=ce,c.updateArrayBindingPattern=function(e,t){return e.elements!==t?d(ce(t),e):e},c.createBindingElement=ue,c.updateBindingElement=function(e,t,r,n,i){return e.propertyName!==r||e.dotDotDotToken!==t||e.name!==n||e.initializer!==i?d(ue(t,r,n,i),e):e},c.createArrayLiteral=de,c.updateArrayLiteral=function(e,t){return e.elements!==t?d(de(t,e.multiLine),e):e},c.createObjectLiteral=pe,c.updateObjectLiteral=function(e,t){return e.properties!==t?d(pe(t,e.multiLine),e):e},c.createPropertyAccess=he,c.updatePropertyAccess=function(e,t,r){return e.expression!==t||e.name!==r?d(P(he(t,r),c.getEmitFlags(e)),e):e},c.createElementAccess=me,c.updateElementAccess=function(e,t,r){return e.expression!==t||e.argumentExpression!==r?d(me(t,r),e):e},c.createCall=_,c.updateCall=function(e,t,r,n){return e.expression!==t||e.typeArguments!==r||e.arguments!==n?d(_(t,r,n),e):e},c.createNew=ge,c.updateNew=function(e,t,r,n){return e.expression!==t||e.typeArguments!==r||e.arguments!==n?d(ge(t,r,n),e):e},c.createTaggedTemplate=fe,c.updateTaggedTemplate=function(e,t,r){return e.tag!==t||e.template!==r?d(fe(t,r),e):e},c.createTypeAssertion=_e,c.updateTypeAssertion=function(e,t,r){return e.type!==t||e.expression!==r?d(_e(t,r),e):e},c.createParen=ye,c.updateParen=function(e,t){return e.expression!==t?d(ye(t),e):e},c.createFunctionExpression=y,c.updateFunctionExpression=function(e,t,r,n,i,s,a,o){return e.name!==n||e.modifiers!==t||e.asteriskToken!==r||e.typeParameters!==i||e.parameters!==s||e.type!==a||e.body!==o?d(y(t,r,n,i,s,a,o),e):e},c.createArrowFunction=b,c.updateArrowFunction=function(e,t,r,n,i,s,a){var o,s=void 0===a?(o=e.equalsGreaterThanToken,c.cast(s,c.isConciseBody)):(o=c.cast(s,function(e){return 36===e.kind}),a);return e.modifiers!==t||e.typeParameters!==r||e.parameters!==n||e.type!==i||e.equalsGreaterThanToken!==o||e.body!==s?d(b(t,r,n,i,o,s),e):e},c.createDelete=be,c.updateDelete=function(e,t){return e.expression!==t?d(be(t),e):e},c.createTypeOf=ve,c.updateTypeOf=function(e,t){return e.expression!==t?d(ve(t),e):e},c.createVoid=v,c.updateVoid=function(e,t){return e.expression!==t?d(v(t),e):e},c.createAwait=Te,c.updateAwait=function(e,t){return e.expression!==t?d(Te(t),e):e},c.createPrefix=T,c.updatePrefix=function(e,t){return e.operand!==t?d(T(e.operator,t),e):e},c.createPostfix=k,c.updatePostfix=function(e,t){return e.operand!==t?d(k(t,e.operator),e):e},c.createBinary=x,c.updateBinary=function(e,t,r,n){return e.left!==t||e.right!==r?d(x(t,n||e.operatorToken,r),e):e},c.createConditional=ke,c.updateConditional=function e(t,r){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(2===n.length)return e(t,r,t.questionToken,n[0],t.colonToken,n[1]);c.Debug.assert(4===n.length);var s=n[0],a=n[1],o=n[2],l=n[3];return t.condition!==r||t.questionToken!==s||t.whenTrue!==a||t.colonToken!==o||t.whenFalse!==l?d(ke(r,s,a,o,l),t):t},c.createTemplateExpression=xe,c.updateTemplateExpression=function(e,t,r){return e.head!==t||e.templateSpans!==r?d(xe(t,r),e):e},c.createTemplateHead=function(e){var t=u(14);return t.text=e,t},c.createTemplateMiddle=function(e){var t=u(15);return t.text=e,t},c.createTemplateTail=function(e){var t=u(16);return t.text=e,t},c.createNoSubstitutionTemplateLiteral=function(e){var t=u(13);return t.text=e,t},c.createYield=Ee,c.updateYield=function(e,t,r){return e.expression!==r||e.asteriskToken!==t?d(Ee(t,r),e):e},c.createSpread=Se,c.updateSpread=function(e,t){return e.expression!==t?d(Se(t),e):e},c.createClassExpression=Ce,c.updateClassExpression=function(e,t,r,n,i,s){return e.modifiers!==t||e.name!==r||e.typeParameters!==n||e.heritageClauses!==i||e.members!==s?d(Ce(t,r,n,i,s),e):e},c.createOmittedExpression=function(){return u(200)},c.createExpressionWithTypeArguments=we,c.updateExpressionWithTypeArguments=function(e,t,r){return e.typeArguments!==t||e.expression!==r?d(we(t,r),e):e},c.createAsExpression=Ie,c.updateAsExpression=function(e,t,r){return e.expression!==t||e.type!==r?d(Ie(t,r),e):e},c.createNonNullExpression=Ae,c.updateNonNullExpression=function(e,t){return e.expression!==t?d(Ae(t),e):e},c.createMetaProperty=De,c.updateMetaProperty=function(e,t){return e.name!==t?d(De(e.keywordToken,t),e):e},c.createTemplateSpan=Ne,c.updateTemplateSpan=function(e,t,r){return e.expression!==t||e.literal!==r?d(Ne(t,r),e):e},c.createSemicolonClassElement=function(){return u(206)},c.createBlock=E,c.updateBlock=function(e,t){return e.statements!==t?d(E(t,e.multiLine),e):e},c.createVariableStatement=Oe,c.updateVariableStatement=function(e,t,r){return e.modifiers!==t||e.declarationList!==r?d(Oe(t,r),e):e},c.createEmptyStatement=function(){return u(209)},c.createStatement=Re,c.updateStatement=function(e,t){return e.expression!==t?d(Re(t),e):e},c.createIf=Le,c.updateIf=function(e,t,r,n){return e.expression!==t||e.thenStatement!==r||e.elseStatement!==n?d(Le(t,r,n),e):e},c.createDo=Pe,c.updateDo=function(e,t,r){return e.statement!==t||e.expression!==r?d(Pe(t,r),e):e},c.createWhile=Me,c.updateWhile=function(e,t,r){return e.expression!==t||e.statement!==r?d(Me(t,r),e):e},c.createFor=Fe,c.updateFor=function(e,t,r,n,i){return e.initializer!==t||e.condition!==r||e.incrementor!==n||e.statement!==i?d(Fe(t,r,n,i),e):e},c.createForIn=Be,c.updateForIn=function(e,t,r,n){return e.initializer!==t||e.expression!==r||e.statement!==n?d(Be(t,r,n),e):e},c.createForOf=$e,c.updateForOf=function(e,t,r,n,i){return e.awaitModifier!==t||e.initializer!==r||e.expression!==n||e.statement!==i?d($e(t,r,n,i),e):e},c.createContinue=Ue,c.updateContinue=function(e,t){return e.label!==t?d(Ue(t),e):e},c.createBreak=Ve,c.updateBreak=function(e,t){return e.label!==t?d(Ve(t),e):e},c.createReturn=He,c.updateReturn=function(e,t){return e.expression!==t?d(He(t),e):e},c.createWith=Ge,c.updateWith=function(e,t,r){return e.expression!==t||e.statement!==r?d(Ge(t,r),e):e},c.createSwitch=je,c.updateSwitch=function(e,t,r){return e.expression!==t||e.caseBlock!==r?d(je(t,r),e):e},c.createLabel=Ke,c.updateLabel=function(e,t,r){return e.label!==t||e.statement!==r?d(Ke(t,r),e):e},c.createThrow=ze,c.updateThrow=function(e,t){return e.expression!==t?d(ze(t),e):e},c.createTry=We,c.updateTry=function(e,t,r,n){return e.tryBlock!==t||e.catchClause!==r||e.finallyBlock!==n?d(We(t,r,n),e):e},c.createDebuggerStatement=function(){return u(225)},c.createVariableDeclaration=S,c.updateVariableDeclaration=function(e,t,r,n){return e.name!==t||e.type!==r||e.initializer!==n?d(S(t,r,n),e):e},c.createVariableDeclarationList=C,c.updateVariableDeclarationList=function(e,t){return e.declarations!==t?d(C(t,e.flags),e):e},c.createFunctionDeclaration=qe,c.updateFunctionDeclaration=function(e,t,r,n,i,s,a,o,l){return e.decorators!==t||e.modifiers!==r||e.asteriskToken!==n||e.name!==i||e.typeParameters!==s||e.parameters!==a||e.type!==o||e.body!==l?d(qe(t,r,n,i,s,a,o,l),e):e},c.createClassDeclaration=Je,c.updateClassDeclaration=function(e,t,r,n,i,s,a){return e.decorators!==t||e.modifiers!==r||e.name!==n||e.typeParameters!==i||e.heritageClauses!==s||e.members!==a?d(Je(t,r,n,i,s,a),e):e},c.createInterfaceDeclaration=Ye,c.updateInterfaceDeclaration=function(e,t,r,n,i,s,a){return e.decorators!==t||e.modifiers!==r||e.name!==n||e.typeParameters!==i||e.heritageClauses!==s||e.members!==a?d(Ye(t,r,n,i,s,a),e):e},c.createTypeAliasDeclaration=Xe,c.updateTypeAliasDeclaration=function(e,t,r,n,i,s){return e.decorators!==t||e.modifiers!==r||e.name!==n||e.typeParameters!==i||e.type!==s?d(Xe(t,r,n,i,s),e):e},c.createEnumDeclaration=Ze,c.updateEnumDeclaration=function(e,t,r,n,i){return e.decorators!==t||e.modifiers!==r||e.name!==n||e.members!==i?d(Ze(t,r,n,i),e):e},c.createModuleDeclaration=Qe,c.updateModuleDeclaration=function(e,t,r,n,i){return e.decorators!==t||e.modifiers!==r||e.name!==n||e.body!==i?d(Qe(t,r,n,i,e.flags),e):e},c.createModuleBlock=et,c.updateModuleBlock=function(e,t){return e.statements!==t?d(et(t),e):e},c.createCaseBlock=tt,c.updateCaseBlock=function(e,t){return e.clauses!==t?d(tt(t),e):e},c.createNamespaceExportDeclaration=rt,c.updateNamespaceExportDeclaration=function(e,t){return e.name!==t?d(rt(t),e):e},c.createImportEqualsDeclaration=nt,c.updateImportEqualsDeclaration=function(e,t,r,n,i){return e.decorators!==t||e.modifiers!==r||e.name!==n||e.moduleReference!==i?d(nt(t,r,n,i),e):e},c.createImportDeclaration=it,c.updateImportDeclaration=function(e,t,r,n,i){return e.decorators!==t||e.modifiers!==r||e.importClause!==n||e.moduleSpecifier!==i?d(it(t,r,n,i),e):e},c.createImportClause=st,c.updateImportClause=function(e,t,r){return e.name!==t||e.namedBindings!==r?d(st(t,r),e):e},c.createNamespaceImport=at,c.updateNamespaceImport=function(e,t){return e.name!==t?d(at(t),e):e},c.createNamedImports=ot,c.updateNamedImports=function(e,t){return e.elements!==t?d(ot(t),e):e},c.createImportSpecifier=lt,c.updateImportSpecifier=function(e,t,r){return e.propertyName!==t||e.name!==r?d(lt(t,r),e):e},c.createExportAssignment=w,c.updateExportAssignment=function(e,t,r,n){return e.decorators!==t||e.modifiers!==r||e.expression!==n?d(w(t,r,e.isExportEquals,n),e):e},c.createExportDeclaration=I,c.updateExportDeclaration=function(e,t,r,n,i){return e.decorators!==t||e.modifiers!==r||e.exportClause!==n||e.moduleSpecifier!==i?d(I(t,r,n,i),e):e},c.createNamedExports=A,c.updateNamedExports=function(e,t){return e.elements!==t?d(A(t),e):e},c.createExportSpecifier=D,c.updateExportSpecifier=function(e,t,r){return e.propertyName!==t||e.name!==r?d(D(t,r),e):e},c.createExternalModuleReference=ct,c.updateExternalModuleReference=function(e,t){return e.expression!==t?d(ct(t),e):e},c.createJsxElement=ut,c.updateJsxElement=function(e,t,r,n){return e.openingElement!==t||e.children!==r||e.closingElement!==n?d(ut(t,r,n),e):e},c.createJsxSelfClosingElement=dt,c.updateJsxSelfClosingElement=function(e,t,r){return e.tagName!==t||e.attributes!==r?d(dt(t,r),e):e},c.createJsxOpeningElement=pt,c.updateJsxOpeningElement=function(e,t,r){return e.tagName!==t||e.attributes!==r?d(pt(t,r),e):e},c.createJsxClosingElement=ht,c.updateJsxClosingElement=function(e,t){return e.tagName!==t?d(ht(t),e):e},c.createJsxAttribute=mt,c.updateJsxAttribute=function(e,t,r){return e.name!==t||e.initializer!==r?d(mt(t,r),e):e},c.createJsxAttributes=gt,c.updateJsxAttributes=function(e,t){return e.properties!==t?d(gt(t),e):e},c.createJsxSpreadAttribute=ft,c.updateJsxSpreadAttribute=function(e,t){return e.expression!==t?d(ft(t),e):e},c.createJsxExpression=_t,c.updateJsxExpression=function(e,t){return e.expression!==t?d(_t(e.dotDotDotToken,t),e):e},c.createCaseClause=yt,c.updateCaseClause=function(e,t,r){return e.expression!==t||e.statements!==r?d(yt(t,r),e):e},c.createDefaultClause=bt,c.updateDefaultClause=function(e,t){return e.statements!==t?d(bt(t),e):e},c.createHeritageClause=vt,c.updateHeritageClause=function(e,t){return e.types!==t?d(vt(e.token,t),e):e},c.createCatchClause=Tt,c.updateCatchClause=function(e,t,r){return e.variableDeclaration!==t||e.block!==r?d(Tt(t,r),e):e},c.createPropertyAssignment=kt,c.updatePropertyAssignment=function(e,t,r){return e.name!==t||e.initializer!==r?d(kt(t,r),e):e},c.createShorthandPropertyAssignment=xt,c.updateShorthandPropertyAssignment=function(e,t,r){return e.name!==t||e.objectAssignmentInitializer!==r?d(xt(t,r),e):e},c.createSpreadAssignment=Et,c.updateSpreadAssignment=function(e,t){return e.expression!==t?d(Et(t),e):e},c.createEnumMember=St,c.updateEnumMember=function(e,t,r){return e.name!==t||e.initializer!==r?d(St(t,r),e):e},c.updateSourceFileNode=function(e,t){var r;return e.statements!==t?((r=u(265)).flags|=e.flags,r.statements=p(t),r.endOfFileToken=e.endOfFileToken,r.fileName=e.fileName,r.path=e.path,r.text=e.text,void 0!==e.amdDependencies&&(r.amdDependencies=e.amdDependencies),void 0!==e.moduleName&&(r.moduleName=e.moduleName),void 0!==e.referencedFiles&&(r.referencedFiles=e.referencedFiles),void 0!==e.typeReferenceDirectives&&(r.typeReferenceDirectives=e.typeReferenceDirectives),void 0!==e.languageVariant&&(r.languageVariant=e.languageVariant),void 0!==e.isDeclarationFile&&(r.isDeclarationFile=e.isDeclarationFile),void 0!==e.renamedDependencies&&(r.renamedDependencies=e.renamedDependencies),void 0!==e.hasNoDefaultLib&&(r.hasNoDefaultLib=e.hasNoDefaultLib),void 0!==e.languageVersion&&(r.languageVersion=e.languageVersion),void 0!==e.scriptKind&&(r.scriptKind=e.scriptKind),void 0!==e.externalModuleIndicator&&(r.externalModuleIndicator=e.externalModuleIndicator),void 0!==e.commonJsModuleIndicator&&(r.commonJsModuleIndicator=e.commonJsModuleIndicator),void 0!==e.identifiers&&(r.identifiers=e.identifiers),void 0!==e.nodeCount&&(r.nodeCount=e.nodeCount),void 0!==e.identifierCount&&(r.identifierCount=e.identifierCount),void 0!==e.symbolCount&&(r.symbolCount=e.symbolCount),void 0!==e.parseDiagnostics&&(r.parseDiagnostics=e.parseDiagnostics),void 0!==e.bindDiagnostics&&(r.bindDiagnostics=e.bindDiagnostics),void 0!==e.lineMap&&(r.lineMap=e.lineMap),void 0!==e.classifiableNames&&(r.classifiableNames=e.classifiableNames),void 0!==e.resolvedModules&&(r.resolvedModules=e.resolvedModules),void 0!==e.resolvedTypeReferenceDirectiveNames&&(r.resolvedTypeReferenceDirectiveNames=e.resolvedTypeReferenceDirectiveNames),void 0!==e.imports&&(r.imports=e.imports),void 0!==e.moduleAugmentations&&(r.moduleAugmentations=e.moduleAugmentations),d(r,e)):e},c.getMutableClone=function(e){var t=r(e);return t.pos=e.pos,t.end=e.end,t.parent=e.parent,t},c.createNotEmittedStatement=function(e){var t=u(287);return t.original=e,L(t,e),t},c.createEndOfDeclarationMarker=function(e){var t=u(291);return t.emitNode={},t.original=e,t},c.createMergeDeclarationMarker=function(e){var t=u(290);return t.emitNode={},t.original=e,t},c.createPartiallyEmittedExpression=Ct,c.updatePartiallyEmittedExpression=function(e,t){return e.expression!==t?d(Ct(t,e.original),e):e},c.createCommaList=It,c.updateCommaList=function(e,t){return e.elements!==t?d(It(t),e):e},c.createBundle=At,c.updateBundle=function(e,t){return e.sourceFiles!==t?At(t):e},c.createImmediatelyInvokedFunctionExpression=function(e,t,r){return _(y(void 0,void 0,void 0,void 0,t?[t]:[],void 0,E(e,!0)),void 0,r?[r]:[])},c.createImmediatelyInvokedArrowFunction=function(e,t,r){return _(b(void 0,void 0,t?[t]:[],void 0,void 0,E(e,!0)),void 0,r?[r]:[])},c.createComma=function(e,t){return x(e,26,t)},c.createLessThan=function(e,t){return x(e,27,t)},c.createAssignment=function(e,t){return x(e,58,t)},c.createStrictEquality=function(e,t){return x(e,34,t)},c.createStrictInequality=function(e,t){return x(e,35,t)},c.createAdd=function(e,t){return x(e,37,t)},c.createSubtract=function(e,t){return x(e,38,t)},c.createPostfixIncrement=function(e){return k(e,43)},c.createLogicalAnd=function(e,t){return x(e,53,t)},c.createLogicalOr=function(e,t){return x(e,54,t)},c.createLogicalNot=function(e){return T(51,e)},c.createVoidZero=function(){return v(n(0))},c.createExportDefault=function(e){return w(void 0,void 0,!1,e)},c.createExternalModuleExport=function(e){return I(void 0,void 0,A([D(void 0,e)]))},c.disposeEmitNodes=function(e){if(e=(e=(e=c.getSourceFileOfNode(c.getParseTreeNode(e)))&&e.emitNode)&&e.annotatedNodes)for(var t=0,r=e;t<r.length;t++)r[t].emitNode=void 0},c.getOrCreateEmitNode=R,c.setTextRange=L,c.setEmitFlags=P,c.addEmitFlags=function(e,t){var r=R(e);return r.flags=r.flags|t,e},c.getSourceMapRange=function(e){var t=e.emitNode;return t&&t.sourceMapRange||e},c.setSourceMapRange=function(e,t){return R(e).sourceMapRange=t,e},c.createSourceMapSource=function(e,t,r){return new(o=o||c.objectAllocator.getSourceMapSourceConstructor())(e,t,r)},c.getTokenSourceMapRange=function(e,t){return(e=(e=e.emitNode)&&e.tokenSourceMapRanges)&&e[t]},c.setTokenSourceMapRange=function(e,t,r){var n=R(e);return(n.tokenSourceMapRanges||(n.tokenSourceMapRanges=[]))[t]=r,e},c.getCommentRange=function(e){var t=e.emitNode;return t&&t.commentRange||e},c.setCommentRange=function(e,t){return R(e).commentRange=t,e},c.getSyntheticLeadingComments=Dt,c.setSyntheticLeadingComments=Nt,c.addSyntheticLeadingComment=function(e,t,r,n){return Nt(e,c.append(Dt(e),{kind:t,pos:-1,end:-1,hasTrailingNewLine:n,text:r}))},c.getSyntheticTrailingComments=Ot,c.setSyntheticTrailingComments=Rt,c.addSyntheticTrailingComment=function(e,t,r,n){return Rt(e,c.append(Ot(e),{kind:t,pos:-1,end:-1,hasTrailingNewLine:n,text:r}))},c.getConstantValue=function(e){return(e=e.emitNode)&&e.constantValue},c.setConstantValue=function(e,t){return R(e).constantValue=t,e},c.addEmitHelper=function(e,t){var r=R(e);return r.helpers=c.append(r.helpers,t),e},c.addEmitHelpers=function(e,t){if(c.some(t))for(var r=R(e),n=0,i=t;n<i.length;n++){var s=i[n];r.helpers=c.appendIfUnique(r.helpers,s)}return e},c.removeEmitHelper=function(e,t){if(e=e.emitNode){e=e.helpers;if(e)return c.orderedRemoveItem(e,t)}return!1},c.getEmitHelpers=function(e){return(e=e.emitNode)&&e.helpers},c.moveEmitHelpers=function(e,t,r){var n=(e=e.emitNode)&&e.helpers;if(c.some(n)){for(var i=R(t),s=0,a=0;a<n.length;a++){var o=n[a];r(o)?(s++,i.helpers=c.appendIfUnique(i.helpers,o)):0<s&&(n[a-s]=o)}0<s&&(n.length-=s)}},c.compareEmitHelpers=function(e,t){return e===t||e.priority===t.priority?0:void 0===e.priority?1:void 0===t.priority?-1:c.compareValues(e.priority,t.priority)},c.setOriginalNode=M})(ts=ts||{}),(d=>{function p(e,t,r){return d.isComputedPropertyName(t)?d.setTextRange(d.createElementAccess(e,t.expression),r):(r=d.setTextRange(d.isIdentifier(t)?d.createPropertyAccess(e,t):d.createElementAccess(e,t),t),d.getOrCreateEmitNode(r).flags|=64,r)}function s(e,t){e=d.createIdentifier(e||"React");return e.flags&=-9,e.parent=d.getParseTreeNode(t),e}function h(e,t,r){return e?function e(t,r){var n,i;return d.isQualifiedName(t)?(n=e(t.left,r),(i=d.createIdentifier(d.idText(t.right))).escapedText=t.right.escapedText,d.createPropertyAccess(n,i)):s(d.idText(t),r)}(e,r):d.createPropertyAccess(s(t,r),"createElement")}function i(e){return d.setEmitFlags(d.createIdentifier(e),4098)}d.nullTransformationContext={enableEmitNotification:d.noop,enableSubstitution:d.noop,endLexicalEnvironment:function(){},getCompilerOptions:d.notImplemented,getEmitHost:d.notImplemented,getEmitResolver:d.notImplemented,hoistFunctionDeclaration:d.noop,hoistVariableDeclaration:d.noop,isEmitNotificationEnabled:d.notImplemented,isSubstitutionEnabled:d.notImplemented,onEmitNode:d.noop,onSubstituteNode:d.notImplemented,readEmitHelpers:d.notImplemented,requestEmitHelper:d.noop,resumeLexicalEnvironment:d.noop,startLexicalEnvironment:d.noop,suspendLexicalEnvironment:d.noop},d.createTypeCheck=function(e,t){return"undefined"===t?d.createStrictEquality(e,d.createVoidZero()):d.createStrictEquality(d.createTypeOf(e),d.createLiteral(t))},d.createMemberAccessForPropertyName=p,d.createFunctionCall=function(e,t,r,n){return d.setTextRange(d.createCall(d.createPropertyAccess(e,"call"),void 0,[t].concat(r)),n)},d.createFunctionApply=function(e,t,r,n){return d.setTextRange(d.createCall(d.createPropertyAccess(e,"apply"),void 0,[t,r]),n)},d.createArraySlice=function(e,t){var r=[];return void 0!==t&&r.push("number"==typeof t?d.createLiteral(t):t),d.createCall(d.createPropertyAccess(e,"slice"),void 0,r)},d.createArrayConcat=function(e,t){return d.createCall(d.createPropertyAccess(e,"concat"),void 0,t)},d.createMathPow=function(e,t,r){return d.setTextRange(d.createCall(d.createPropertyAccess(d.createIdentifier("Math"),"pow"),void 0,[e,t]),r)},d.createExpressionForJsxElement=function(e,t,r,n,i,s,a){var o=[r];if(n&&o.push(n),i&&0<i.length)if(n||o.push(d.createNull()),1<i.length)for(var l=0,c=i;l<c.length;l++){var u=c[l];u.startsOnNewLine=!0,o.push(u)}else o.push(i[0]);return d.setTextRange(d.createCall(h(e,t,s),void 0,o),a)},d.getHelperName=i;var e,n={name:"typescript:values",scoped:!1,text:'\n            var __values = (this && this.__values) || function (o) {\n                var m = typeof Symbol === "function" && o[Symbol.iterator], i = 0;\n                if (m) return m.call(o);\n                return {\n                    next: function () {\n                        if (o && i >= o.length) o = void 0;\n                        return { value: o && o[i++], done: !o };\n                    }\n                };\n            };\n        '},a={name:"typescript:read",scoped:!(d.createValuesHelper=function(e,t,r){return e.requestEmitHelper(n),d.setTextRange(d.createCall(i("__values"),void 0,[t]),r)}),text:'\n            var __read = (this && this.__read) || function (o, n) {\n                var m = typeof Symbol === "function" && o[Symbol.iterator];\n                if (!m) return o;\n                var i = m.call(o), r, ar = [], e;\n                try {\n                    while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n                }\n                catch (error) { e = { error: error }; }\n                finally {\n                    try {\n                        if (r && !r.done && (m = i["return"])) m.call(i);\n                    }\n                    finally { if (e) throw e.error; }\n                }\n                return ar;\n            };\n        '},M={name:"typescript:spread",scoped:!(d.createReadHelper=function(e,t,r,n){return e.requestEmitHelper(a),d.setTextRange(d.createCall(i("__read"),void 0,void 0!==r?[t,d.createLiteral(r)]:[t]),n)}),text:"\n            var __spread = (this && this.__spread) || function () {\n                for (var ar = [], i = 0; i < arguments.length; i++) ar = ar.concat(__read(arguments[i]));\n                return ar;\n            };"};function o(e,t){var r=E(e);switch(r.kind){case 71:return t;case 99:case 8:case 9:return;case 177:return 0===r.elements.length?void 0:1;case 178:return 0<r.properties.length;default:return 1}}function m(e){return d.isIdentifier(e)?d.createLiteral(e):d.isComputedPropertyName(e)?d.getMutableClone(e.expression):d.getMutableClone(e)}function l(e,t,r){return c(e,t,r,8192)}function c(e,t,r,n){var i,s=d.getNameOfDeclaration(e);return s&&d.isIdentifier(s)&&!d.isGeneratedIdentifier(s)?(i=d.getMutableClone(s),n|=d.getEmitFlags(s),r||(n|=48),t||(n|=1536),n&&d.setEmitFlags(i,n),i):d.getGeneratedNameForNode(e)}function u(e,t,r,n){var i,e=d.createPropertyAccess(e,d.nodeIsSynthesized(t)?t:d.getSynthesizedClone(t));return d.setTextRange(e,t),n||(i|=48),r||(i|=1536),i&&d.setEmitFlags(e,i),e}function g(e){return d.isStringLiteral(e.expression)&&"use strict"===e.expression.text}function f(e,t,r){d.Debug.assert(0===e.length,"Prologue directives should be at the first statement in the target statements array");for(var n=!1,i=0,s=t.length;i<s;){var a=t[i];if(!d.isPrologueDirective(a))break;g(a)&&(n=!0),e.push(a),i++}return r&&!n&&e.push(w(d.createStatement(d.createLiteral("use strict")))),i}function _(e,t,r,n){for(var i=t.length;r<i;){var s=t[r];if(!(1048576&d.getEmitFlags(s)))break;e.push(n?d.visitNode(s,n,d.isStatement):s),r++}return r}function y(e){var t;return e=d.skipPartiallyEmittedExpressions(e),d.isLiteralKind(e.kind)?e.kind:194===e.kind&&37===e.operatorToken.kind?void 0!==e.cachedLiteralKind?e.cachedLiteralKind:(t=y(e.left),t=d.isLiteralKind(t)&&t===y(e.right)?t:0,e.cachedLiteralKind=t):0}function b(e){var t=d.skipPartiallyEmittedExpressions(e);return d.isLeftHandSideExpression(t)&&(182!==t.kind||t.arguments)?e:d.setTextRange(d.createParen(e),e)}function v(e){var t=d.skipPartiallyEmittedExpressions(e),t=d.getExpressionPrecedence(t);return d.getOperatorPrecedence(194,26)<t?e:d.setTextRange(d.createParen(e),e)}function t(e){switch(e.kind){case 166:case 167:case 160:case 161:return d.createParenthesizedType(e)}return e}function T(e,t){for(;;){switch(e.kind){case 193:e=e.operand;continue;case 194:e=e.left;continue;case 195:e=e.condition;continue;case 181:if(t)return e;case 180:case 179:case 288:e=e.expression;continue}return e}}function k(e,t){switch(void 0===t&&(t=7),e.kind){case 185:return 0!=(1&t);case 184:case 202:case 203:return 0!=(2&t);case 288:return 0!=(4&t)}return!1}function x(e,t){var r;for(void 0===t&&(t=7);r=e,1&t&&(e=E(e)),2&t&&(e=S(e)),r!==(e=4&t?d.skipPartiallyEmittedExpressions(e):e););return e}function E(e){for(;185===e.kind;)e=e.expression;return e}function S(e){for(;d.isAssertionExpression(e)||203===e.kind;)e=e.expression;return e}function C(e,t,r){if(void 0===r&&(r=7),!e||!k(e,r)||185===(r=e).kind&&d.nodeIsSynthesized(r)&&d.nodeIsSynthesized(d.getSourceMapRange(r))&&d.nodeIsSynthesized(d.getCommentRange(r))&&!d.some(d.getSyntheticLeadingComments(r))&&!d.some(d.getSyntheticTrailingComments(r)))return t;var n=e,i=C(e.expression,t);switch(n.kind){case 185:return d.updateParen(n,i);case 184:return d.updateTypeAssertion(n,n.type,i);case 202:return d.updateAsExpression(n,i,n.type);case 203:return d.updateNonNullExpression(n,i);case 288:return d.updatePartiallyEmittedExpression(n,i)}}function w(e){return e.startsOnNewLine=!0,e}function I(e){e=d.getOriginalNode(e,d.isSourceFile),e=e&&e.emitNode;return e&&e.externalHelpersModuleName}function A(e,t,r){if(e)return e.moduleName?d.createLiteral(e.moduleName):e.isDeclarationFile||!r.out&&!r.outFile?void 0:d.createLiteral(d.getExternalModuleNameFromPath(t,e.fileName))}function D(e){if(d.isDeclarationBindingElement(e))return e.name;if(!d.isObjectLiteralElementLike(e))return d.isAssignmentExpression(e,!0)?D(e.left):d.isSpreadElement(e)?D(e.expression):e;switch(e.kind){case 261:return D(e.initializer);case 262:return e.name;case 263:return D(e.expression)}}function r(e){var t;return d.isBindingElement(e)?e.dotDotDotToken?(d.Debug.assertNode(e.name,d.isIdentifier),d.setOriginalNode(d.setTextRange(d.createSpread(e.name),e),e)):(t=P(e.name),e.initializer?d.setOriginalNode(d.setTextRange(d.createAssignment(t,e.initializer),e),e):t):(d.Debug.assertNode(e,d.isExpression),e)}function N(e){var t;return d.isBindingElement(e)?e.dotDotDotToken?(d.Debug.assertNode(e.name,d.isIdentifier),d.setOriginalNode(d.setTextRange(d.createSpreadAssignment(e.name),e),e)):e.propertyName?(t=P(e.name),d.setOriginalNode(d.setTextRange(d.createPropertyAssignment(e.propertyName,e.initializer?d.createAssignment(t,e.initializer):t),e),e)):(d.Debug.assertNode(e.name,d.isIdentifier),d.setOriginalNode(d.setTextRange(d.createShorthandPropertyAssignment(e.name,e.initializer),e),e)):(d.Debug.assertNode(e,d.isObjectLiteralElementLike),e)}function O(e){switch(e.kind){case 175:case 177:return L(e);case 174:case 178:return R(e)}}function R(e){return d.isObjectBindingPattern(e)?d.setOriginalNode(d.setTextRange(d.createObjectLiteral(d.map(e.elements,N)),e),e):(d.Debug.assertNode(e,d.isObjectLiteralExpression),e)}function L(e){return d.isArrayBindingPattern(e)?d.setOriginalNode(d.setTextRange(d.createArrayLiteral(d.map(e.elements,r)),e),e):(d.Debug.assertNode(e,d.isArrayLiteralExpression),e)}function P(e){return d.isBindingPattern(e)?O(e):(d.Debug.assertNode(e,d.isExpression),e)}d.createSpreadHelper=function(e,t,r){return e.requestEmitHelper(a),e.requestEmitHelper(M),d.setTextRange(d.createCall(i("__spread"),void 0,t),r)},d.createForOfBindingStatement=function(e,t){var r;return d.isVariableDeclarationList(e)?(r=d.firstOrUndefined(e.declarations),r=d.updateVariableDeclaration(r,r.name,void 0,t),d.setTextRange(d.createVariableStatement(void 0,d.updateVariableDeclarationList(e,[r])),e)):(r=d.setTextRange(d.createAssignment(e,t),e),d.setTextRange(d.createStatement(r),e))},d.insertLeadingStatement=function(e,t){return d.isBlock(e)?d.updateBlock(e,d.setTextRange(d.createNodeArray([t].concat(e.statements)),e.statements)):d.createBlock(d.createNodeArray([e,t]),!0)},d.restoreEnclosingLabel=function e(t,r,n){var i;return r?(i=d.updateLabel(r,r.label,222===r.statement.kind?e(t,r.statement):t),n&&n(r),i):t},d.createCallBinding=function(e,t,r,n){var i,s,a=x(e,7);if(d.isSuperProperty(a))i=d.createThis(),s=a;else if(97===a.kind)i=d.createThis(),s=r<2?d.setTextRange(d.createIdentifier("_super"),a):a;else if(4096&d.getEmitFlags(a))i=d.createVoidZero(),s=b(a);else switch(a.kind){case 179:o(a.expression,n)?(i=d.createTempVariable(t),s=d.createPropertyAccess(d.setTextRange(d.createAssignment(i,a.expression),a.expression),a.name),d.setTextRange(s,a)):(i=a.expression,s=a);break;case 180:o(a.expression,n)?(i=d.createTempVariable(t),s=d.createElementAccess(d.setTextRange(d.createAssignment(i,a.expression),a.expression),a.argumentExpression),d.setTextRange(s,a)):(i=a.expression,s=a);break;default:i=d.createVoidZero(),s=b(e)}return{target:s,thisArg:i}},d.inlineExpressions=function(e){return 10<e.length?d.createCommaList(e):d.reduceLeft(e,d.createComma)},d.createExpressionFromEntityName=function e(t){var r,n;return d.isQualifiedName(t)?(r=e(t.left),n=d.getMutableClone(t.right),d.setTextRange(d.createPropertyAccess(r,n),t)):d.getMutableClone(t)},d.createExpressionForPropertyName=m,d.createExpressionForObjectLiteralElementLike=function(e,t,r){switch(t.kind){case 153:case 154:var n,i=e.properties,s=t,a=r,o=e.multiLine,l=(i=d.getAllAccessorDeclarations(i,s)).firstAccessor,c=i.getAccessor,i=i.setAccessor;return s===l?(n=[],c&&(u=d.createFunctionExpression(c.modifiers,void 0,void 0,void 0,c.parameters,void 0,c.body),d.setTextRange(u,c),d.setOriginalNode(u,c),c=d.createPropertyAssignment("get",u),n.push(c)),i&&(u=d.createFunctionExpression(i.modifiers,void 0,void 0,void 0,i.parameters,void 0,i.body),d.setTextRange(u,i),d.setOriginalNode(u,i),c=d.createPropertyAssignment("set",u),n.push(c)),n.push(d.createPropertyAssignment("enumerable",d.createTrue())),n.push(d.createPropertyAssignment("configurable",d.createTrue())),i=d.setTextRange(d.createCall(d.createPropertyAccess(d.createIdentifier("Object"),"defineProperty"),void 0,[a,m(s.name),d.createObjectLiteral(n,o)]),l),d.aggregateTransformFlags(i)):void 0;case 261:return u=t,d.aggregateTransformFlags(d.setOriginalNode(d.setTextRange(d.createAssignment(p(r,u.name,u.name),u.initializer),u),u));case 262:return c=t,d.aggregateTransformFlags(d.setOriginalNode(d.setTextRange(d.createAssignment(p(r,c.name,c.name),d.getSynthesizedClone(c.name)),c),c));case 151:return a=t,d.aggregateTransformFlags(d.setOriginalNode(d.setTextRange(d.createAssignment(p(r,a.name,a.name),d.setOriginalNode(d.setTextRange(d.createFunctionExpression(a.modifiers,a.asteriskToken,void 0,void 0,a.parameters,void 0,a.body),a),a)),a),a))}var u},d.getInternalName=function(e,t,r){return c(e,t,r,49152)},d.isInternalName=function(e){return 0!=(32768&d.getEmitFlags(e))},d.getLocalName=function(e,t,r){return c(e,t,r,16384)},d.isLocalName=function(e){return 0!=(16384&d.getEmitFlags(e))},d.getExportName=l,d.isExportName=function(e){return 0!=(8192&d.getEmitFlags(e))},d.getDeclarationName=function(e,t,r){return c(e,t,r)},d.getExternalModuleOrNamespaceExportName=function(e,t,r,n){return e&&d.hasModifier(t,1)?u(e,c(t),r,n):l(t,r,n)},d.getNamespaceMemberName=u,d.convertToFunctionBody=function(e,t){return d.isBlock(e)?e:d.setTextRange(d.createBlock([d.setTextRange(d.createReturn(e),e)],t),e)},d.convertFunctionDeclarationToExpression=function(e){d.Debug.assert(!!e.body);var t=d.createFunctionExpression(e.modifiers,e.asteriskToken,e.name,e.typeParameters,e.parameters,e.type,e.body);return d.setOriginalNode(t,e),d.setTextRange(t,e),e.startsOnNewLine&&(t.startsOnNewLine=!0),d.aggregateTransformFlags(t),t},d.addPrologue=function(e,t,r,n){return _(e,t,f(e,t,r),n)},d.addStandardPrologue=f,d.addCustomPrologue=_,d.startsWithUseStrict=function(e){return void 0!==(e=d.firstOrUndefined(e))&&d.isPrologueDirective(e)&&g(e)},d.ensureUseStrict=function(e){for(var t=!1,r=0,n=e;r<n.length;r++){var i=n[r];if(!d.isPrologueDirective(i))break;if(g(i)){t=!0;break}}return t?e:d.setTextRange(d.createNodeArray([w(d.createStatement(d.createLiteral("use strict")))].concat(e)),e)},d.parenthesizeBinaryOperand=function(e,t,r,n){return 185!==d.skipPartiallyEmittedExpressions(t).kind&&((e,t,r,n)=>{var i=d.getOperatorPrecedence(194,e),s=d.getOperatorAssociativity(194,e),a=d.skipPartiallyEmittedExpressions(t),o=d.getExpressionPrecedence(a);switch(d.compareValues(o,i)){case-1:return r||1!==s||197!==t.kind?1:void 0;case 1:return;case 0:if(r)return 1===s;if(d.isBinaryExpression(a)&&a.operatorToken.kind===e){if((e=>39===e||49===e||48===e||50===e)(e))return;if(37===e){var l=n?y(n):0;if(d.isLiteralKind(l)&&l===y(a))return}}return 0===d.getExpressionAssociativity(a)}})(e,t,r,n)?d.createParen(t):t},d.parenthesizeForConditionalHead=function(e){var t=d.getOperatorPrecedence(195,55),r=d.skipPartiallyEmittedExpressions(e),r=d.getExpressionPrecedence(r);return-1===d.compareValues(r,t)?d.createParen(e):e},d.parenthesizeSubexpressionOfConditionalExpression=function(e){return 194===e.kind&&26===e.operatorToken.kind?d.createParen(e):e},d.parenthesizeForNew=function(e){var t=T(e,!0);switch(t.kind){case 181:return d.createParen(e);case 182:return t.arguments?e:d.createParen(e)}return b(e)},d.parenthesizeForAccess=b,d.parenthesizePostfixOperand=function(e){return d.isLeftHandSideExpression(e)?e:d.setTextRange(d.createParen(e),e)},d.parenthesizePrefixOperand=function(e){return d.isUnaryExpression(e)?e:d.setTextRange(d.createParen(e),e)},d.parenthesizeListElements=function(e){for(var t,r=0;r<e.length;r++){var n=v(e[r]);void 0===t&&n===e[r]||(t=void 0===t?e.slice(0,r):t).push(n)}return void 0!==t?d.setTextRange(d.createNodeArray(t,e.hasTrailingComma),e):e},d.parenthesizeExpressionForList=v,d.parenthesizeExpressionForExpressionStatement=function(e){var t=d.skipPartiallyEmittedExpressions(e);if(d.isCallExpression(t)){var r=t.expression,n=d.skipPartiallyEmittedExpressions(r).kind;if(186===n||187===n)return(n=d.getMutableClone(t)).expression=d.setTextRange(d.createParen(r),r),C(e,n,4)}return 178===(r=T(t,!1).kind)||186===r?d.setTextRange(d.createParen(e),e):e},d.parenthesizeElementTypeMember=t,d.parenthesizeArrayTypeMember=function(e){switch(e.kind){case 162:case 170:return d.createParenthesizedType(e)}return t(e)},d.parenthesizeElementTypeMembers=function(e){return d.createNodeArray(d.sameMap(e,t))},d.parenthesizeTypeParameters=function(e){if(d.some(e)){for(var t=[],r=0;r<e.length;++r){var n=e[r];t.push(0===r&&d.isFunctionOrConstructorTypeNode(n)&&n.typeParameters?d.createParenthesizedType(n):n)}return d.createNodeArray(t)}},d.parenthesizeConciseBody=function(e){return d.isBlock(e)||178!==T(e,!1).kind?e:d.setTextRange(d.createParen(e),e)},(e=d.OuterExpressionKinds||(d.OuterExpressionKinds={}))[e.Parentheses=1]="Parentheses",e[e.Assertions=2]="Assertions",e[e.PartiallyEmittedExpressions=4]="PartiallyEmittedExpressions",e[e.All=7]="All",d.isOuterExpression=k,d.skipOuterExpressions=x,d.skipParentheses=E,d.skipAssertions=S,d.recreateOuterExpressions=C,d.startOnNewLine=w,d.getExternalHelpersModuleName=I,d.getOrCreateExternalHelpersModuleNameIfNeeded=function(e,t,r){if(t.importHelpers&&d.isEffectiveExternalModule(e,t)){var n=I(e);if(n)return n;var n=d.getEmitModuleKind(t),i=r&&n!==d.ModuleKind.System&&n!==d.ModuleKind.ES2015&&n!==d.ModuleKind.ESNext;if(!i){t=d.getEmitHelpers(e);if(t)for(var s=0,a=t;s<a.length;s++)if(!a[s].scoped){i=!0;break}}return i?(r=d.getOriginalNode(e,d.isSourceFile),(n=d.getOrCreateEmitNode(r)).externalHelpersModuleName||(n.externalHelpersModuleName=d.createUniqueName(d.externalHelpersModuleNameText))):void 0}},d.getLocalNameForExternalImport=function(e,t){var r,n=d.getNamespaceDeclarationNode(e);return n&&!d.isDefaultImport(e)?(r=n.name,d.isGeneratedIdentifier(r)?r:d.createIdentifier(d.getSourceTextOfNodeFromSourceFile(t,n.name))):238===e.kind&&e.importClause||244===e.kind&&e.moduleSpecifier?d.getGeneratedNameForNode(e):void 0},d.getExternalModuleNameLiteral=function(e,t,r,n,i){var s=d.getExternalModuleName(e);if(9===s.kind)return r=r,i=i,A(n.getExternalModuleFileFromDeclaration(e),r,i)||((e,t)=>(t=t.renamedDependencies&&t.renamedDependencies.get(e.text))&&d.createLiteral(t))(s,t)||d.getSynthesizedClone(s)},d.tryGetModuleNameFromFile=A,d.getInitializerOfBindingOrAssignmentElement=function e(t){return d.isDeclarationBindingElement(t)?t.initializer:d.isPropertyAssignment(t)?d.isAssignmentExpression(t.initializer,!0)?t.initializer.right:void 0:d.isShorthandPropertyAssignment(t)?t.objectAssignmentInitializer:d.isAssignmentExpression(t,!0)?t.right:d.isSpreadElement(t)?e(t.expression):void 0},d.getTargetOfBindingOrAssignmentElement=D,d.getRestIndicatorOfBindingOrAssignmentElement=function(e){switch(e.kind){case 146:case 176:return e.dotDotDotToken;case 198:case 263:return e}},d.getPropertyNameOfBindingOrAssignmentElement=function(e){switch(e.kind){case 176:if(e.propertyName)return t=e.propertyName,d.isComputedPropertyName(t)&&d.isStringOrNumericLiteral(t.expression)?t.expression:t;break;case 261:var t;if(e.name)return t=e.name,d.isComputedPropertyName(t)&&d.isStringOrNumericLiteral(t.expression)?t.expression:t;break;case 263:return e.name}var r=D(e);if(r&&d.isPropertyName(r))return d.isComputedPropertyName(r)&&d.isStringOrNumericLiteral(r.expression)?r.expression:r;d.Debug.fail("Invalid property name for binding element.")},d.getElementsOfBindingOrAssignmentPattern=function(e){switch(e.kind){case 174:case 175:case 177:return e.elements;case 178:return e.properties}},d.convertToArrayAssignmentElement=r,d.convertToObjectAssignmentElement=N,d.convertToAssignmentPattern=O,d.convertToObjectAssignmentPattern=R,d.convertToArrayAssignmentPattern=L,d.convertToAssignmentElementTarget=P})(ts=ts||{}),(h=>{function a(e,t,r,n){if(void 0===e||void 0===t)return e;h.aggregateTransformFlags(e);t=t(e);return t===e?e:void 0!==t?(e=h.isArray(t)?(n||i)(t):t,h.Debug.assertNode(e,r),h.aggregateTransformFlags(e),e):void 0}function o(e,t,r,n,i){if(void 0===e||void 0===t)return e;var s,a=e.length;(void 0===n||n<0)&&(n=0),(void 0===i||a-n<i)&&(i=a-n),(0<n||i<a)&&(s=h.createNodeArray([],e.hasTrailingComma&&n+i===a));for(var o=0;o<i;o++){var l=e[o+n],c=(h.aggregateTransformFlags(l),void 0!==l?t(l):void 0);if((void 0!==s||void 0===c||c!==l)&&(void 0===s&&(s=h.createNodeArray(e.slice(0,o),e.hasTrailingComma),h.setTextRange(s,e)),c))if(h.isArray(c))for(var u=0,d=c;u<d.length;u++){var p=d[u];h.Debug.assertNode(p,r),h.aggregateTransformFlags(p),s.push(p)}else h.Debug.assertNode(c,r),h.aggregateTransformFlags(c),s.push(c)}return s||e}function l(e,t,r,n,i){r.startLexicalEnvironment(),e=o(e,t,h.isStatement,n),i&&!h.startsWithUseStrict(e)&&(e=h.setTextRange(h.createNodeArray([h.createStatement(h.createLiteral("use strict"))].concat(e)),e));t=r.endLexicalEnvironment();return h.setTextRange(h.createNodeArray(h.concatenate(e,t)),e)}function c(e,t,r,n){void 0===n&&(n=o),r.startLexicalEnvironment();n=n(e,t,h.isParameterDeclaration);return r.suspendLexicalEnvironment(),n}function u(e,t,r){r.resumeLexicalEnvironment();var e=a(e,t,h.isConciseBody),t=r.endLexicalEnvironment();return h.some(t)?(r=h.convertToFunctionBody(e),t=h.mergeLexicalEnvironment(r.statements,t),h.updateBlock(r,t)):e}function i(e){return h.Debug.assert(e.length<=1,"Too many nodes written to output."),h.singleOrUndefined(e)}h.visitNode=a,h.visitNodes=o,h.visitLexicalEnvironment=l,h.visitParameterList=c,h.visitFunctionBody=u,h.visitEachChild=function(e,t,r,n,i){if(void 0===n&&(n=o),void 0!==e){var s=e.kind;if(0<s&&s<=142||169===s)return e;switch(s){case 71:return h.updateIdentifier(e,n(e.typeArguments,t,h.isTypeNode));case 143:return h.updateQualifiedName(e,a(e.left,t,h.isEntityName),a(e.right,t,h.isIdentifier));case 144:return h.updateComputedPropertyName(e,a(e.expression,t,h.isExpression));case 145:return h.updateTypeParameterDeclaration(e,a(e.name,t,h.isIdentifier),a(e.constraint,t,h.isTypeNode),a(e.default,t,h.isTypeNode));case 146:return h.updateParameter(e,n(e.decorators,t,h.isDecorator),n(e.modifiers,t,h.isModifier),a(e.dotDotDotToken,i,h.isToken),a(e.name,t,h.isBindingName),a(e.questionToken,i,h.isToken),a(e.type,t,h.isTypeNode),a(e.initializer,t,h.isExpression));case 147:return h.updateDecorator(e,a(e.expression,t,h.isExpression));case 148:return h.updatePropertySignature(e,n(e.modifiers,t,h.isToken),a(e.name,t,h.isPropertyName),a(e.questionToken,i,h.isToken),a(e.type,t,h.isTypeNode),a(e.initializer,t,h.isExpression));case 149:return h.updateProperty(e,n(e.decorators,t,h.isDecorator),n(e.modifiers,t,h.isModifier),a(e.name,t,h.isPropertyName),a(e.questionToken,i,h.isToken),a(e.type,t,h.isTypeNode),a(e.initializer,t,h.isExpression));case 150:return h.updateMethodSignature(e,n(e.typeParameters,t,h.isTypeParameterDeclaration),n(e.parameters,t,h.isParameterDeclaration),a(e.type,t,h.isTypeNode),a(e.name,t,h.isPropertyName),a(e.questionToken,i,h.isToken));case 151:return h.updateMethod(e,n(e.decorators,t,h.isDecorator),n(e.modifiers,t,h.isModifier),a(e.asteriskToken,i,h.isToken),a(e.name,t,h.isPropertyName),a(e.questionToken,i,h.isToken),n(e.typeParameters,t,h.isTypeParameterDeclaration),c(e.parameters,t,r,n),a(e.type,t,h.isTypeNode),u(e.body,t,r));case 152:return h.updateConstructor(e,n(e.decorators,t,h.isDecorator),n(e.modifiers,t,h.isModifier),c(e.parameters,t,r,n),u(e.body,t,r));case 153:return h.updateGetAccessor(e,n(e.decorators,t,h.isDecorator),n(e.modifiers,t,h.isModifier),a(e.name,t,h.isPropertyName),c(e.parameters,t,r,n),a(e.type,t,h.isTypeNode),u(e.body,t,r));case 154:return h.updateSetAccessor(e,n(e.decorators,t,h.isDecorator),n(e.modifiers,t,h.isModifier),a(e.name,t,h.isPropertyName),c(e.parameters,t,r,n),u(e.body,t,r));case 155:return h.updateCallSignature(e,n(e.typeParameters,t,h.isTypeParameterDeclaration),n(e.parameters,t,h.isParameterDeclaration),a(e.type,t,h.isTypeNode));case 156:return h.updateConstructSignature(e,n(e.typeParameters,t,h.isTypeParameterDeclaration),n(e.parameters,t,h.isParameterDeclaration),a(e.type,t,h.isTypeNode));case 157:return h.updateIndexSignature(e,n(e.decorators,t,h.isDecorator),n(e.modifiers,t,h.isModifier),n(e.parameters,t,h.isParameterDeclaration),a(e.type,t,h.isTypeNode));case 158:return h.updateTypePredicateNode(e,a(e.parameterName,t),a(e.type,t,h.isTypeNode));case 159:return h.updateTypeReferenceNode(e,a(e.typeName,t,h.isEntityName),n(e.typeArguments,t,h.isTypeNode));case 160:return h.updateFunctionTypeNode(e,n(e.typeParameters,t,h.isTypeParameterDeclaration),n(e.parameters,t,h.isParameterDeclaration),a(e.type,t,h.isTypeNode));case 161:return h.updateConstructorTypeNode(e,n(e.typeParameters,t,h.isTypeParameterDeclaration),n(e.parameters,t,h.isParameterDeclaration),a(e.type,t,h.isTypeNode));case 162:return h.updateTypeQueryNode(e,a(e.exprName,t,h.isEntityName));case 163:return h.updateTypeLiteralNode(e,n(e.members,t,h.isTypeElement));case 164:return h.updateArrayTypeNode(e,a(e.elementType,t,h.isTypeNode));case 165:return h.updateTypleTypeNode(e,n(e.elementTypes,t,h.isTypeNode));case 166:return h.updateUnionTypeNode(e,n(e.types,t,h.isTypeNode));case 167:return h.updateIntersectionTypeNode(e,n(e.types,t,h.isTypeNode));case 168:return h.updateParenthesizedType(e,a(e.type,t,h.isTypeNode));case 170:return h.updateTypeOperatorNode(e,a(e.type,t,h.isTypeNode));case 171:return h.updateIndexedAccessTypeNode(e,a(e.objectType,t,h.isTypeNode),a(e.indexType,t,h.isTypeNode));case 172:return h.updateMappedTypeNode(e,a(e.readonlyToken,i,h.isToken),a(e.typeParameter,t,h.isTypeParameterDeclaration),a(e.questionToken,i,h.isToken),a(e.type,t,h.isTypeNode));case 173:return h.updateLiteralTypeNode(e,a(e.literal,t,h.isExpression));case 174:return h.updateObjectBindingPattern(e,n(e.elements,t,h.isBindingElement));case 175:return h.updateArrayBindingPattern(e,n(e.elements,t,h.isArrayBindingElement));case 176:return h.updateBindingElement(e,a(e.dotDotDotToken,i,h.isToken),a(e.propertyName,t,h.isPropertyName),a(e.name,t,h.isBindingName),a(e.initializer,t,h.isExpression));case 177:return h.updateArrayLiteral(e,n(e.elements,t,h.isExpression));case 178:return h.updateObjectLiteral(e,n(e.properties,t,h.isObjectLiteralElementLike));case 179:return h.updatePropertyAccess(e,a(e.expression,t,h.isExpression),a(e.name,t,h.isIdentifier));case 180:return h.updateElementAccess(e,a(e.expression,t,h.isExpression),a(e.argumentExpression,t,h.isExpression));case 181:return h.updateCall(e,a(e.expression,t,h.isExpression),n(e.typeArguments,t,h.isTypeNode),n(e.arguments,t,h.isExpression));case 182:return h.updateNew(e,a(e.expression,t,h.isExpression),n(e.typeArguments,t,h.isTypeNode),n(e.arguments,t,h.isExpression));case 183:return h.updateTaggedTemplate(e,a(e.tag,t,h.isExpression),a(e.template,t,h.isTemplateLiteral));case 184:return h.updateTypeAssertion(e,a(e.type,t,h.isTypeNode),a(e.expression,t,h.isExpression));case 185:return h.updateParen(e,a(e.expression,t,h.isExpression));case 186:return h.updateFunctionExpression(e,n(e.modifiers,t,h.isModifier),a(e.asteriskToken,i,h.isToken),a(e.name,t,h.isIdentifier),n(e.typeParameters,t,h.isTypeParameterDeclaration),c(e.parameters,t,r,n),a(e.type,t,h.isTypeNode),u(e.body,t,r));case 187:return h.updateArrowFunction(e,n(e.modifiers,t,h.isModifier),n(e.typeParameters,t,h.isTypeParameterDeclaration),c(e.parameters,t,r,n),a(e.type,t,h.isTypeNode),a(e.equalsGreaterThanToken,t,h.isToken),u(e.body,t,r));case 188:return h.updateDelete(e,a(e.expression,t,h.isExpression));case 189:return h.updateTypeOf(e,a(e.expression,t,h.isExpression));case 190:return h.updateVoid(e,a(e.expression,t,h.isExpression));case 191:return h.updateAwait(e,a(e.expression,t,h.isExpression));case 192:return h.updatePrefix(e,a(e.operand,t,h.isExpression));case 193:return h.updatePostfix(e,a(e.operand,t,h.isExpression));case 194:return h.updateBinary(e,a(e.left,t,h.isExpression),a(e.right,t,h.isExpression),a(e.operatorToken,t,h.isToken));case 195:return h.updateConditional(e,a(e.condition,t,h.isExpression),a(e.questionToken,t,h.isToken),a(e.whenTrue,t,h.isExpression),a(e.colonToken,t,h.isToken),a(e.whenFalse,t,h.isExpression));case 196:return h.updateTemplateExpression(e,a(e.head,t,h.isTemplateHead),n(e.templateSpans,t,h.isTemplateSpan));case 197:return h.updateYield(e,a(e.asteriskToken,i,h.isToken),a(e.expression,t,h.isExpression));case 198:return h.updateSpread(e,a(e.expression,t,h.isExpression));case 199:return h.updateClassExpression(e,n(e.modifiers,t,h.isModifier),a(e.name,t,h.isIdentifier),n(e.typeParameters,t,h.isTypeParameterDeclaration),n(e.heritageClauses,t,h.isHeritageClause),n(e.members,t,h.isClassElement));case 201:return h.updateExpressionWithTypeArguments(e,n(e.typeArguments,t,h.isTypeNode),a(e.expression,t,h.isExpression));case 202:return h.updateAsExpression(e,a(e.expression,t,h.isExpression),a(e.type,t,h.isTypeNode));case 203:return h.updateNonNullExpression(e,a(e.expression,t,h.isExpression));case 204:return h.updateMetaProperty(e,a(e.name,t,h.isIdentifier));case 205:return h.updateTemplateSpan(e,a(e.expression,t,h.isExpression),a(e.literal,t,h.isTemplateMiddleOrTemplateTail));case 207:return h.updateBlock(e,n(e.statements,t,h.isStatement));case 208:return h.updateVariableStatement(e,n(e.modifiers,t,h.isModifier),a(e.declarationList,t,h.isVariableDeclarationList));case 210:return h.updateStatement(e,a(e.expression,t,h.isExpression));case 211:return h.updateIf(e,a(e.expression,t,h.isExpression),a(e.thenStatement,t,h.isStatement,h.liftToBlock),a(e.elseStatement,t,h.isStatement,h.liftToBlock));case 212:return h.updateDo(e,a(e.statement,t,h.isStatement,h.liftToBlock),a(e.expression,t,h.isExpression));case 213:return h.updateWhile(e,a(e.expression,t,h.isExpression),a(e.statement,t,h.isStatement,h.liftToBlock));case 214:return h.updateFor(e,a(e.initializer,t,h.isForInitializer),a(e.condition,t,h.isExpression),a(e.incrementor,t,h.isExpression),a(e.statement,t,h.isStatement,h.liftToBlock));case 215:return h.updateForIn(e,a(e.initializer,t,h.isForInitializer),a(e.expression,t,h.isExpression),a(e.statement,t,h.isStatement,h.liftToBlock));case 216:return h.updateForOf(e,e.awaitModifier,a(e.initializer,t,h.isForInitializer),a(e.expression,t,h.isExpression),a(e.statement,t,h.isStatement,h.liftToBlock));case 217:return h.updateContinue(e,a(e.label,t,h.isIdentifier));case 218:return h.updateBreak(e,a(e.label,t,h.isIdentifier));case 219:return h.updateReturn(e,a(e.expression,t,h.isExpression));case 220:return h.updateWith(e,a(e.expression,t,h.isExpression),a(e.statement,t,h.isStatement,h.liftToBlock));case 221:return h.updateSwitch(e,a(e.expression,t,h.isExpression),a(e.caseBlock,t,h.isCaseBlock));case 222:return h.updateLabel(e,a(e.label,t,h.isIdentifier),a(e.statement,t,h.isStatement,h.liftToBlock));case 223:return h.updateThrow(e,a(e.expression,t,h.isExpression));case 224:return h.updateTry(e,a(e.tryBlock,t,h.isBlock),a(e.catchClause,t,h.isCatchClause),a(e.finallyBlock,t,h.isBlock));case 226:return h.updateVariableDeclaration(e,a(e.name,t,h.isBindingName),a(e.type,t,h.isTypeNode),a(e.initializer,t,h.isExpression));case 227:return h.updateVariableDeclarationList(e,n(e.declarations,t,h.isVariableDeclaration));case 228:return h.updateFunctionDeclaration(e,n(e.decorators,t,h.isDecorator),n(e.modifiers,t,h.isModifier),a(e.asteriskToken,i,h.isToken),a(e.name,t,h.isIdentifier),n(e.typeParameters,t,h.isTypeParameterDeclaration),c(e.parameters,t,r,n),a(e.type,t,h.isTypeNode),u(e.body,t,r));case 229:return h.updateClassDeclaration(e,n(e.decorators,t,h.isDecorator),n(e.modifiers,t,h.isModifier),a(e.name,t,h.isIdentifier),n(e.typeParameters,t,h.isTypeParameterDeclaration),n(e.heritageClauses,t,h.isHeritageClause),n(e.members,t,h.isClassElement));case 230:return h.updateInterfaceDeclaration(e,n(e.decorators,t,h.isDecorator),n(e.modifiers,t,h.isModifier),a(e.name,t,h.isIdentifier),n(e.typeParameters,t,h.isTypeParameterDeclaration),n(e.heritageClauses,t,h.isHeritageClause),n(e.members,t,h.isTypeElement));case 231:return h.updateTypeAliasDeclaration(e,n(e.decorators,t,h.isDecorator),n(e.modifiers,t,h.isModifier),a(e.name,t,h.isIdentifier),n(e.typeParameters,t,h.isTypeParameterDeclaration),a(e.type,t,h.isTypeNode));case 232:return h.updateEnumDeclaration(e,n(e.decorators,t,h.isDecorator),n(e.modifiers,t,h.isModifier),a(e.name,t,h.isIdentifier),n(e.members,t,h.isEnumMember));case 233:return h.updateModuleDeclaration(e,n(e.decorators,t,h.isDecorator),n(e.modifiers,t,h.isModifier),a(e.name,t,h.isIdentifier),a(e.body,t,h.isModuleBody));case 234:return h.updateModuleBlock(e,n(e.statements,t,h.isStatement));case 235:return h.updateCaseBlock(e,n(e.clauses,t,h.isCaseOrDefaultClause));case 236:return h.updateNamespaceExportDeclaration(e,a(e.name,t,h.isIdentifier));case 237:return h.updateImportEqualsDeclaration(e,n(e.decorators,t,h.isDecorator),n(e.modifiers,t,h.isModifier),a(e.name,t,h.isIdentifier),a(e.moduleReference,t,h.isModuleReference));case 238:return h.updateImportDeclaration(e,n(e.decorators,t,h.isDecorator),n(e.modifiers,t,h.isModifier),a(e.importClause,t,h.isImportClause),a(e.moduleSpecifier,t,h.isExpression));case 239:return h.updateImportClause(e,a(e.name,t,h.isIdentifier),a(e.namedBindings,t,h.isNamedImportBindings));case 240:return h.updateNamespaceImport(e,a(e.name,t,h.isIdentifier));case 241:return h.updateNamedImports(e,n(e.elements,t,h.isImportSpecifier));case 242:return h.updateImportSpecifier(e,a(e.propertyName,t,h.isIdentifier),a(e.name,t,h.isIdentifier));case 243:return h.updateExportAssignment(e,n(e.decorators,t,h.isDecorator),n(e.modifiers,t,h.isModifier),a(e.expression,t,h.isExpression));case 244:return h.updateExportDeclaration(e,n(e.decorators,t,h.isDecorator),n(e.modifiers,t,h.isModifier),a(e.exportClause,t,h.isNamedExports),a(e.moduleSpecifier,t,h.isExpression));case 245:return h.updateNamedExports(e,n(e.elements,t,h.isExportSpecifier));case 246:return h.updateExportSpecifier(e,a(e.propertyName,t,h.isIdentifier),a(e.name,t,h.isIdentifier));case 248:return h.updateExternalModuleReference(e,a(e.expression,t,h.isExpression));case 249:return h.updateJsxElement(e,a(e.openingElement,t,h.isJsxOpeningElement),n(e.children,t,h.isJsxChild),a(e.closingElement,t,h.isJsxClosingElement));case 250:return h.updateJsxSelfClosingElement(e,a(e.tagName,t,h.isJsxTagNameExpression),a(e.attributes,t,h.isJsxAttributes));case 251:return h.updateJsxOpeningElement(e,a(e.tagName,t,h.isJsxTagNameExpression),a(e.attributes,t,h.isJsxAttributes));case 252:return h.updateJsxClosingElement(e,a(e.tagName,t,h.isJsxTagNameExpression));case 253:return h.updateJsxAttribute(e,a(e.name,t,h.isIdentifier),a(e.initializer,t,h.isStringLiteralOrJsxExpression));case 254:return h.updateJsxAttributes(e,n(e.properties,t,h.isJsxAttributeLike));case 255:return h.updateJsxSpreadAttribute(e,a(e.expression,t,h.isExpression));case 256:return h.updateJsxExpression(e,a(e.expression,t,h.isExpression));case 257:return h.updateCaseClause(e,a(e.expression,t,h.isExpression),n(e.statements,t,h.isStatement));case 258:return h.updateDefaultClause(e,n(e.statements,t,h.isStatement));case 259:return h.updateHeritageClause(e,n(e.types,t,h.isExpressionWithTypeArguments));case 260:return h.updateCatchClause(e,a(e.variableDeclaration,t,h.isVariableDeclaration),a(e.block,t,h.isBlock));case 261:return h.updatePropertyAssignment(e,a(e.name,t,h.isPropertyName),a(e.initializer,t,h.isExpression));case 262:return h.updateShorthandPropertyAssignment(e,a(e.name,t,h.isIdentifier),a(e.objectAssignmentInitializer,t,h.isExpression));case 263:return h.updateSpreadAssignment(e,a(e.expression,t,h.isExpression));case 264:return h.updateEnumMember(e,a(e.name,t,h.isPropertyName),a(e.initializer,t,h.isExpression));case 265:return h.updateSourceFileNode(e,l(e.statements,t,r));case 288:return h.updatePartiallyEmittedExpression(e,a(e.expression,t,h.isExpression));case 289:return h.updateCommaList(e,n(e.elements,t,h.isExpression));default:return e}}}})(ts=ts||{}),(o=>{function l(e,t,r){return e?t(r,e):r}function c(e,t,r){return e?t(r,e):r}function r(e,t,r,n){if(void 0===e)return t;var i=n?c:o.reduceLeft,s=n||r,n=e.kind;if(0<n&&n<=142)return t;if(158<=n&&n<=173)return t;var a=t;switch(e.kind){case 206:case 209:case 200:case 225:case 287:break;case 143:a=l(e.left,r,a),a=l(e.right,r,a);break;case 144:a=l(e.expression,r,a);break;case 146:a=i(e.decorators,s,a),a=i(e.modifiers,s,a),a=l(e.name,r,a),a=l(e.type,r,a),a=l(e.initializer,r,a);break;case 147:a=l(e.expression,r,a);break;case 148:a=i(e.modifiers,s,a),a=l(e.name,r,a),a=l(e.questionToken,r,a),a=l(e.type,r,a),a=l(e.initializer,r,a);break;case 149:a=i(e.decorators,s,a),a=i(e.modifiers,s,a),a=l(e.name,r,a),a=l(e.type,r,a),a=l(e.initializer,r,a);break;case 151:a=i(e.decorators,s,a),a=i(e.modifiers,s,a),a=l(e.name,r,a),a=i(e.typeParameters,s,a),a=i(e.parameters,s,a),a=l(e.type,r,a),a=l(e.body,r,a);break;case 152:a=i(e.modifiers,s,a),a=i(e.parameters,s,a),a=l(e.body,r,a);break;case 153:a=i(e.decorators,s,a),a=i(e.modifiers,s,a),a=l(e.name,r,a),a=i(e.parameters,s,a),a=l(e.type,r,a),a=l(e.body,r,a);break;case 154:a=i(e.decorators,s,a),a=i(e.modifiers,s,a),a=l(e.name,r,a),a=i(e.parameters,s,a),a=l(e.body,r,a);break;case 174:case 175:a=i(e.elements,s,a);break;case 176:a=l(e.propertyName,r,a),a=l(e.name,r,a),a=l(e.initializer,r,a);break;case 177:a=i(e.elements,s,a);break;case 178:a=i(e.properties,s,a);break;case 179:a=l(e.expression,r,a),a=l(e.name,r,a);break;case 180:a=l(e.expression,r,a),a=l(e.argumentExpression,r,a);break;case 181:case 182:a=l(e.expression,r,a),a=i(e.typeArguments,s,a),a=i(e.arguments,s,a);break;case 183:a=l(e.tag,r,a),a=l(e.template,r,a);break;case 184:a=l(e.type,r,a),a=l(e.expression,r,a);break;case 186:a=i(e.modifiers,s,a),a=l(e.name,r,a),a=i(e.typeParameters,s,a),a=i(e.parameters,s,a),a=l(e.type,r,a),a=l(e.body,r,a);break;case 187:a=i(e.modifiers,s,a),a=i(e.typeParameters,s,a),a=i(e.parameters,s,a),a=l(e.type,r,a),a=l(e.body,r,a);break;case 185:case 188:case 189:case 190:case 191:case 197:case 198:case 203:a=l(e.expression,r,a);break;case 192:case 193:a=l(e.operand,r,a);break;case 194:a=l(e.left,r,a),a=l(e.right,r,a);break;case 195:a=l(e.condition,r,a),a=l(e.whenTrue,r,a),a=l(e.whenFalse,r,a);break;case 196:a=l(e.head,r,a),a=i(e.templateSpans,s,a);break;case 199:a=i(e.modifiers,s,a),a=l(e.name,r,a),a=i(e.typeParameters,s,a),a=i(e.heritageClauses,s,a),a=i(e.members,s,a);break;case 201:a=l(e.expression,r,a),a=i(e.typeArguments,s,a);break;case 202:a=l(e.expression,r,a),a=l(e.type,r,a);break;case 205:a=l(e.expression,r,a),a=l(e.literal,r,a);break;case 207:a=i(e.statements,s,a);break;case 208:a=i(e.modifiers,s,a),a=l(e.declarationList,r,a);break;case 210:a=l(e.expression,r,a);break;case 211:a=l(e.expression,r,a),a=l(e.thenStatement,r,a),a=l(e.elseStatement,r,a);break;case 212:a=l(e.statement,r,a),a=l(e.expression,r,a);break;case 213:case 220:a=l(e.expression,r,a),a=l(e.statement,r,a);break;case 214:a=l(e.initializer,r,a),a=l(e.condition,r,a),a=l(e.incrementor,r,a),a=l(e.statement,r,a);break;case 215:case 216:a=l(e.initializer,r,a),a=l(e.expression,r,a),a=l(e.statement,r,a);break;case 219:case 223:a=l(e.expression,r,a);break;case 221:a=l(e.expression,r,a),a=l(e.caseBlock,r,a);break;case 222:a=l(e.label,r,a),a=l(e.statement,r,a);break;case 224:a=l(e.tryBlock,r,a),a=l(e.catchClause,r,a),a=l(e.finallyBlock,r,a);break;case 226:a=l(e.name,r,a),a=l(e.type,r,a),a=l(e.initializer,r,a);break;case 227:a=i(e.declarations,s,a);break;case 228:a=i(e.decorators,s,a),a=i(e.modifiers,s,a),a=l(e.name,r,a),a=i(e.typeParameters,s,a),a=i(e.parameters,s,a),a=l(e.type,r,a),a=l(e.body,r,a);break;case 229:a=i(e.decorators,s,a),a=i(e.modifiers,s,a),a=l(e.name,r,a),a=i(e.typeParameters,s,a),a=i(e.heritageClauses,s,a),a=i(e.members,s,a);break;case 232:a=i(e.decorators,s,a),a=i(e.modifiers,s,a),a=l(e.name,r,a),a=i(e.members,s,a);break;case 233:a=i(e.decorators,s,a),a=i(e.modifiers,s,a),a=l(e.name,r,a),a=l(e.body,r,a);break;case 234:a=i(e.statements,s,a);break;case 235:a=i(e.clauses,s,a);break;case 237:a=i(e.decorators,s,a),a=i(e.modifiers,s,a),a=l(e.name,r,a),a=l(e.moduleReference,r,a);break;case 238:a=i(e.decorators,s,a),a=i(e.modifiers,s,a),a=l(e.importClause,r,a),a=l(e.moduleSpecifier,r,a);break;case 239:a=l(e.name,r,a),a=l(e.namedBindings,r,a);break;case 240:a=l(e.name,r,a);break;case 241:case 245:a=i(e.elements,s,a);break;case 242:case 246:a=l(e.propertyName,r,a),a=l(e.name,r,a);break;case 243:a=o.reduceLeft(e.decorators,r,a),a=o.reduceLeft(e.modifiers,r,a),a=l(e.expression,r,a);break;case 244:a=o.reduceLeft(e.decorators,r,a),a=o.reduceLeft(e.modifiers,r,a),a=l(e.exportClause,r,a),a=l(e.moduleSpecifier,r,a);break;case 248:a=l(e.expression,r,a);break;case 249:a=l(e.openingElement,r,a),a=o.reduceLeft(e.children,r,a),a=l(e.closingElement,r,a);break;case 250:case 251:a=l(e.tagName,r,a),a=l(e.attributes,r,a);break;case 254:a=i(e.properties,s,a);break;case 252:a=l(e.tagName,r,a);break;case 253:a=l(e.name,r,a),a=l(e.initializer,r,a);break;case 255:case 256:a=l(e.expression,r,a);break;case 257:a=l(e.expression,r,a);case 258:a=i(e.statements,s,a);break;case 259:a=i(e.types,s,a);break;case 260:a=l(e.variableDeclaration,r,a),a=l(e.block,r,a);break;case 261:a=l(e.name,r,a),a=l(e.initializer,r,a);break;case 262:a=l(e.name,r,a),a=l(e.objectAssignmentInitializer,r,a);break;case 263:a=l(e.expression,r,a);break;case 264:a=l(e.name,r,a),a=l(e.initializer,r,a);break;case 265:a=i(e.statements,s,a);break;case 288:a=l(e.expression,r,a);break;case 289:a=i(e.elements,s,a)}return a}function a(e){var t;return void 0===e?0:536870912&e.transformFlags?e.transformFlags&~o.getTransformFlagsSubtreeExclusions(e.kind):(t=(e=>o.hasModifier(e,2)||o.isTypeNode(e)&&201!==e.kind?0:r(e,0,n,i))(e),o.computeTransformFlagsForNode(e,t))}function n(e,t){return e|a(t)}function i(e,t){return e|(e=>{if(void 0===e)return 0;for(var t=0,r=0,n=0,i=e;n<i.length;n++){var s=i[n];t|=a(s),r|=-536870913&s.transformFlags}return e.transformFlags=536870912|r,t})(t)}var t,s,u;o.reduceEachChild=r,o.mergeLexicalEnvironment=function(e,t){return o.some(t)?o.isNodeArray(e)?o.setTextRange(o.createNodeArray(o.concatenate(e,t)),e):o.addRange(e,t):e},o.liftToBlock=function(e){return t.assert(o.every(e,o.isStatement),"Cannot lift nodes to a Block."),o.singleOrUndefined(e)||o.createBlock(e)},o.aggregateTransformFlags=function(e){return a(e),e},s=t=o.Debug||(o.Debug={}),u=!1,s.failBadSyntaxKind=s.shouldAssert(1)?function(e,t){return s.fail((t||"Unexpected node.")+"\r\nNode "+o.formatSyntaxKind(e.kind)+" was unexpected.",s.failBadSyntaxKind)}:o.noop,s.assertEachNode=s.shouldAssert(1)?function(e,t,r){return s.assert(void 0===t||o.every(e,t),r||"Unexpected node.",function(){return"Node array did not pass test '"+s.getFunctionName(t)+"'."},s.assertEachNode)}:o.noop,s.assertNode=s.shouldAssert(1)?function(e,t,r){return s.assert(void 0===t||t(e),r||"Unexpected node.",function(){return"Node "+o.formatSyntaxKind(e.kind)+" did not pass test '"+s.getFunctionName(t)+"'."},s.assertNode)}:o.noop,s.assertOptionalNode=s.shouldAssert(1)?function(e,t,r){return s.assert(void 0===t||void 0===e||t(e),r||"Unexpected node.",function(){return"Node "+o.formatSyntaxKind(e.kind)+" did not pass test '"+s.getFunctionName(t)+"'."},s.assertOptionalNode)}:o.noop,s.assertOptionalToken=s.shouldAssert(1)?function(e,t,r){return s.assert(void 0===t||void 0===e||e.kind===t,r||"Unexpected node.",function(){return"Node "+o.formatSyntaxKind(e.kind)+" was not a '"+o.formatSyntaxKind(t)+"' token."},s.assertOptionalToken)}:o.noop,s.assertMissingNode=s.shouldAssert(1)?function(e,t){return s.assert(void 0===e,t||"Unexpected node.",function(){return"Node "+o.formatSyntaxKind(e.kind)+" was unexpected'."},s.assertMissingNode)}:o.noop,s.enableDebugInfo=function(){if(!u){Object.defineProperties(o.objectAllocator.getSymbolConstructor().prototype,{__debugFlags:{get:function(){return o.formatSymbolFlags(this.flags)}}}),Object.defineProperties(o.objectAllocator.getTypeConstructor().prototype,{__debugFlags:{get:function(){return o.formatTypeFlags(this.flags)}},__debugObjectFlags:{get:function(){return 32768&this.flags?o.formatObjectFlags(this.objectFlags):""}},__debugTypeToString:{value:function(){return this.checker.typeToString(this)}}});for(var e=0,t=[o.objectAllocator.getNodeConstructor(),o.objectAllocator.getIdentifierConstructor(),o.objectAllocator.getTokenConstructor(),o.objectAllocator.getSourceFileConstructor()];e<t.length;e++){var r=t[e];r.prototype.hasOwnProperty("__debugKind")||Object.defineProperties(r.prototype,{__debugKind:{get:function(){return o.formatSyntaxKind(this.kind)}},__debugModifierFlags:{get:function(){return o.formatModifierFlags(o.getModifierFlagsNoCache(this))}},__debugTransformFlags:{get:function(){return o.formatTransformFlags(this.transformFlags)}},__debugEmitFlags:{get:function(){return o.formatEmitFlags(o.getEmitFlags(this))}},__debugGetText:{value:function(e){var t,r;return!o.nodeIsSynthesized(this)&&(r=(t=o.getParseTreeNode(this))&&o.getSourceFileOfNode(t))?o.getSourceTextOfNodeFromSourceFile(r,t,e):""}}})}u=!0}}})(ts=ts||{}),(T=>{function k(e){return(e=T.getOriginalNode(e))?T.getNodeId(e):0}function x(e,t,r){var n=e[t];n?n.push(r):e[t]=n=[r]}T.getOriginalNodeId=k,T.collectExternalModuleInfo=function(e,t,r){for(var n=[],i=T.createMultiMap(),s=[],a=T.createMap(),o=!1,l=void 0,c=!1,u=0,d=e.statements;u<d.length;u++){var p=d[u];switch(p.kind){case 238:n.push(p);break;case 237:248===p.moduleReference.kind&&n.push(p);break;case 244:if(p.moduleSpecifier)p.exportClause?n.push(p):(n.push(p),c=!0);else for(var h=0,m=p.exportClause.elements;h<m.length;h++){var g,f=m[h];a.get(T.idText(f.name))||(g=f.propertyName||f.name,i.add(T.idText(g),f),(b=t.getReferencedImportDeclaration(g)||t.getReferencedValueDeclaration(g))&&x(s,k(b),f.name),a.set(T.idText(f.name),!0),v=T.append(v,f.name))}break;case 243:p.isExportEquals&&!l&&(l=p);break;case 208:if(T.hasModifier(p,1))for(var _=0,y=p.declarationList.declarations;_<y.length;_++)var b,v=function e(t,r,n){if(T.isBindingPattern(t.name))for(var i=0,s=t.name.elements;i<s.length;i++){var a=s[i];T.isOmittedExpression(a)||(n=e(a,r,n))}else{var o;T.isGeneratedIdentifier(t.name)||(o=T.idText(t.name),r.get(o))||(r.set(o,!0),n=T.append(n,t.name))}return n}(b=y[_],a,v);break;case 228:T.hasModifier(p,1)&&(T.hasModifier(p,512)?o||(x(s,k(p),T.getDeclarationName(p)),o=!0):(g=p.name,a.get(T.idText(g))||(x(s,k(p),g),a.set(T.idText(g),!0),v=T.append(v,g))));break;case 229:T.hasModifier(p,1)&&(T.hasModifier(p,512)?o||(x(s,k(p),T.getDeclarationName(p)),o=!0):(g=p.name)&&!a.get(T.idText(g))&&(x(s,k(p),g),a.set(T.idText(g),!0),v=T.append(v,g)))}}return e=T.getOrCreateExternalHelpersModuleNameIfNeeded(e,r,c),(r=e&&T.createImportDeclaration(void 0,void 0,T.createImportClause(void 0,T.createNamespaceImport(e)),T.createLiteral(T.externalHelpersModuleNameText)))&&n.unshift(r),{externalImports:n,exportSpecifiers:i,exportEquals:l,hasExportStarsToExportValues:c,exportedBindings:s,exportedNames:v,externalHelpersImportDeclaration:r}},T.isSimpleCopiableExpression=function(e){return 9===e.kind||8===e.kind||13===e.kind||T.isKeyword(e.kind)||T.isIdentifier(e)}})(ts=ts||{}),(P=>{var e;function M(e,t,r,n,i){i||(i=P.visitNode(P.getInitializerOfBindingOrAssignmentElement(t),e.visitor,P.isExpression),r=i?r?(s=i,c=F(e,c=r,!0,n),P.createConditional(P.createTypeCheck(c,"undefined"),s,c)):i:r||P.createVoidZero());var s=P.getTargetOfBindingOrAssignmentElement(t);if(P.isObjectBindingOrAssignmentPattern(s)){var a,o,l=e,c=t,u=s,d=r,p=n,h=P.getElementsOfBindingOrAssignmentPattern(u),m=h.length;1!==m&&(c=!P.isDeclarationBindingElement(c)||0!==m,d=F(l,d,c,p));for(var g=0;g<m;g++){var f,_,y=h[g];P.getRestIndicatorOfBindingOrAssignmentElement(y)?g===m-1&&(a&&(l.emitBindingOrAssignment(l.createObjectBindingOrAssignmentPattern(a),d,p,u),a=void 0),_=((e,t,r,n,i)=>{e.requestEmitHelper(B);for(var s=[],a=0,o=0;o<r.length-1;o++){var l,c=P.getPropertyNameOfBindingOrAssignmentElement(r[o]);c&&(P.isComputedPropertyName(c)?(l=n[a],a++,s.push(P.createConditional(P.createTypeCheck(l,"symbol"),l,P.createAdd(l,P.createLiteral(""))))):s.push(P.createLiteral(c)))}return P.createCall(P.getHelperName("__rest"),void 0,[t,P.setTextRange(P.createArrayLiteral(s),i)])})(l.context,d,h,o,u),M(l,y,_,y)):(f=P.getPropertyNameOfBindingOrAssignmentElement(y),!(1<=l.level)||1572864&y.transformFlags||1572864&P.getTargetOfBindingOrAssignmentElement(y).transformFlags||P.isComputedPropertyName(f)?(a&&(l.emitBindingOrAssignment(l.createObjectBindingOrAssignmentPattern(a),d,p,u),a=void 0),_=((e,t,r)=>{var n;return P.isComputedPropertyName(r)?(n=F(e,P.visitNode(r.expression,e.visitor),!1,r),P.createElementAccess(t,n)):P.isStringOrNumericLiteral(r)?((n=P.getSynthesizedClone(r)).text=n.text,P.createElementAccess(t,n)):(e=P.createIdentifier(P.idText(r)),P.createPropertyAccess(t,e))})(l,d,f),P.isComputedPropertyName(f)&&(o=P.append(o,_.argumentExpression)),M(l,y,_,y)):a=P.append(a,y))}a&&l.emitBindingOrAssignment(l.createObjectBindingOrAssignmentPattern(a),d,p,u)}else if(P.isArrayBindingOrAssignmentPattern(s)){var b,v,T=e,i=t,k=s,x=r,E=n,S=P.getElementsOfBindingOrAssignmentPattern(k),C=S.length;T.level<1&&T.downlevelIteration?x=F(T,P.createReadHelper(T.context,x,0<C&&P.getRestIndicatorOfBindingOrAssignmentElement(S[C-1])?void 0:C,E),!1,E):(1!==C&&(T.level<1||0===C)||P.every(S,P.isOmittedExpression))&&(i=!P.isDeclarationBindingElement(i)||0!==C,x=F(T,x,i,E));for(var w=0;w<C;w++){var I,A,D=S[w];1<=T.level?b=1048576&D.transformFlags?(I=P.createTempVariable(void 0),T.hoistTempVariables&&T.context.hoistVariableDeclaration(I),v=P.append(v,[I,D]),P.append(b,T.createArrayBindingOrAssignmentElement(I))):P.append(b,D):P.isOmittedExpression(D)||(P.getRestIndicatorOfBindingOrAssignmentElement(D)?w===C-1&&(A=P.createArraySlice(x,w),M(T,D,A,D)):(A=P.createElementAccess(x,w),M(T,D,A,D)))}if(b&&T.emitBindingOrAssignment(T.createArrayBindingOrAssignmentPattern(b),x,E,k),v)for(var N=0,O=v;N<O.length;N++){var R=O[N],L=R[0];M(T,D=R[1],L,D)}}else e.emitBindingOrAssignment(s,r,n,t)}function F(e,t,r,n){return P.isIdentifier(t)&&r?t:(r=P.createTempVariable(void 0),e.hoistTempVariables?(e.context.hoistVariableDeclaration(r),e.emitExpression(P.setTextRange(P.createAssignment(r,t),n))):e.emitBindingOrAssignment(r,t,n,void 0),r)}function y(e){return P.Debug.assertEachNode(e,P.isArrayBindingElement),P.createArrayBindingPattern(e)}function u(e){return P.createArrayLiteral(P.map(e,P.convertToArrayAssignmentElement))}function b(e){return P.Debug.assertEachNode(e,P.isBindingElement),P.createObjectBindingPattern(e)}function d(e){return P.createObjectLiteral(P.map(e,P.convertToObjectAssignmentElement))}function v(e){return P.createBindingElement(void 0,void 0,e)}function p(e){return e}(e=P.FlattenLevel||(P.FlattenLevel={}))[e.All=0]="All",e[e.ObjectRest=1]="ObjectRest",P.flattenDestructuringAssignment=function(e,i,t,r,n,s){var a,o,l=e;if(P.isDestructuringAssignment(e))for(a=e.right;P.isEmptyArrayLiteral(e.left)||P.isEmptyObjectLiteral(e.left);){if(!P.isDestructuringAssignment(a))return a;l=e=a,a=e.right}if(r={context:t,level:r,downlevelIteration:t.getCompilerOptions().downlevelIteration,hoistTempVariables:!0,emitExpression:c,emitBindingOrAssignment:function(e,t,r,n){P.Debug.assertNode(e,s?P.isIdentifier:P.isExpression);e=s?s(e,t,r):P.setTextRange(P.createAssignment(P.visitNode(e,i,P.isExpression),t),r);e.original=n,c(e)},createArrayBindingOrAssignmentPattern:u,createObjectBindingOrAssignmentPattern:d,createArrayBindingOrAssignmentElement:p,visitor:i},a&&(a=P.visitNode(a,i,P.isExpression),n?a=F(r,a,!0,l):P.nodeIsSynthesized(e)&&(l=a)),M(r,e,a,l,P.isDestructuringAssignment(e)),a&&n){if(!P.some(o))return a;o.push(a)}return P.aggregateTransformFlags(P.inlineExpressions(o))||P.createOmittedExpression();function c(e){P.setEmitFlags(e,64),P.aggregateTransformFlags(e),o=P.append(o,e)}};var B={name:"typescript:rest",scoped:!(P.flattenDestructuringBinding=function(e,t,r,n,i,s,a){var o,l=[],c=[];M({context:r,level:n,downlevelIteration:r.getCompilerOptions().downlevelIteration,hoistTempVariables:s,emitExpression:function(e){o=P.append(o,e)},emitBindingOrAssignment:_,createArrayBindingOrAssignmentPattern:y,createObjectBindingOrAssignmentPattern:b,createArrayBindingOrAssignmentElement:v,visitor:t},e,i,e,a),o&&(n=P.createTempVariable(void 0),s?_(n,g=P.inlineExpressions(o),o=void 0,void 0):(r.hoistVariableDeclaration(n),(t=P.lastOrUndefined(l)).pendingExpressions=P.append(t.pendingExpressions,P.createAssignment(n,t.value)),P.addRange(t.pendingExpressions,o),t.value=n));for(var u=0,d=l;u<d.length;u++){var p=d[u],h=p.pendingExpressions,m=p.name,g=p.value,f=p.location,p=p.original,h=P.createVariableDeclaration(m,void 0,h?P.inlineExpressions(P.append(h,g)):g);h.original=p,P.setTextRange(h,f),P.isIdentifier(m)&&P.setEmitFlags(h,64),P.aggregateTransformFlags(h),c.push(h)}return c;function _(e,t,r,n){P.Debug.assertNode(e,P.isBindingName),o&&(t=P.inlineExpressions(P.append(o,t)),o=void 0),l.push({pendingExpressions:o,name:e,value:t,location:r,original:n})}}),text:'\n            var __rest = (this && this.__rest) || function (s, e) {\n                var t = {};\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n                    t[p] = s[p];\n                if (s != null && typeof Object.getOwnPropertySymbols === "function")\n                    for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\n                        t[p[i]] = s[p[i]];\n                return t;\n            };'}})(ts=ts||{}),(Me=>{function Fe(e,t,r,n,i,s){var a=[];return a.push(Me.createArrayLiteral(t,!0)),a.push(r),n&&(a.push(n),i)&&a.push(i),e.requestEmitHelper(o),Me.setTextRange(Me.createCall(Me.getHelperName("__decorate"),void 0,a),s)}var o={name:"typescript:decorate",scoped:!(Me.transformTypeScript=function(C){var w,I,A,D,c,o,N,s,O=C.startLexicalEnvironment,h=C.resumeLexicalEnvironment,R=C.endLexicalEnvironment,L=C.hoistVariableDeclaration,P=C.getEmitResolver(),M=C.getCompilerOptions(),m=void 0===M.strictNullChecks?M.strict:M.strictNullChecks,F=Me.getEmitScriptTarget(M),B=Me.getEmitModuleKind(M),a=C.onEmitNode,g=C.onSubstituteNode;return C.onEmitNode=function(e,t,r){var n=s,i=w;Me.isSourceFile(t)&&(w=t);2&o&&(e=>233===Me.getOriginalNode(e).kind)(t)&&(s|=2);8&o&&(e=>232===Me.getOriginalNode(e).kind)(t)&&(s|=8);a(e,t,r),s=n,w=i},C.onSubstituteNode=function(e,t){{if(t=g(e,t),1===e)return(e=>{switch(e.kind){case 71:return(e=>(e=>{if(1&o&&16777216&P.getNodeCheckFlags(e)){var t=P.getReferencedValueDeclaration(e);if(t){var t=N[t.id];if(t)return t=Me.getSynthesizedClone(t),Me.setSourceMapRange(t,e),Me.setCommentRange(t,e),t}}})(e)||Le(e)||e)(e);case 179:case 180:return Pe(e)}return e})(t);if(Me.isShorthandPropertyAssignment(t))return(e=>{if(2&o){var t,r=e.name,n=Le(r);if(n)return e.objectAssignmentInitializer?(t=Me.createAssignment(n,e.objectAssignmentInitializer),Me.setTextRange(Me.createPropertyAssignment(r,t),e)):Me.setTextRange(Me.createPropertyAssignment(r,n),e)}return e})(t)}return t},C.enableSubstitution(179),C.enableSubstitution(180),function(e){if(e.isDeclarationFile)return e;e=u(w=e,k);return Me.addEmitHelpers(e,C.readEmitHelpers()),w=void 0,e};function u(e,t){var r=D,n=c,i=e;switch(i.kind){case 265:case 235:case 234:case 207:D=i,c=void 0;break;case 229:case 228:Me.hasModifier(i,2)||(i.name?fe(i):Me.Debug.assert(229===i.kind||Me.hasModifier(i,512)))}t=t(e);return D!==r&&(c=n),D=r,t}function $(e){return u(e,r)}function r(e){return 1&e.transformFlags?t(e):2&e.transformFlags?Me.visitEachChild(e,$,C):e}function f(e){return u(e,_)}function _(e){switch(e.kind){case 238:case 237:case 243:case 244:var t=e;if(Me.getParseTreeNode(t)!==t)return t;switch(t.kind){case 238:return(e=>{var t;return e.importClause?(t=Me.visitNode(e.importClause,ve,Me.isImportClause))?Me.updateImportDeclaration(e,void 0,void 0,t,e.moduleSpecifier):void 0:e})(t);case 237:return Se(t);case 243:return(e=>P.isValueAliasDeclaration(e)?Me.visitEachChild(e,$,C):void 0)(t);case 244:return(e=>{var t;return e.exportClause?P.isValueAliasDeclaration(e)&&(t=Me.visitNode(e.exportClause,xe,Me.isNamedExports))?Me.updateExportDeclaration(e,void 0,void 0,t,e.moduleSpecifier):void 0:M.isolatedModules||P.moduleExportsSomeValue(e.moduleSpecifier)?e:void 0})(t);default:Me.Debug.fail("Unhandled ellided statement")}return;default:return r(e)}}function y(e){return u(e,b)}function b(e){if(244!==e.kind&&238!==e.kind&&239!==e.kind&&(237!==e.kind||248!==e.moduleReference.kind))return 1&e.transformFlags||Me.hasModifier(e,1)?t(e):2&e.transformFlags?Me.visitEachChild(e,$,C):e}function v(e){return u(e,T)}function T(e){switch(e.kind){case 152:return;case 149:case 157:case 153:case 154:case 151:return r(e);case 206:return e;default:return void Me.Debug.failBadSyntaxKind(e)}}function U(e){if(!(2270&Me.modifierToFlag(e.kind)||I&&84===e.kind))return e}function t(e){if(Me.hasModifier(e,2)&&Me.isStatement(e))return Me.createNotEmittedStatement(e);switch(e.kind){case 84:case 79:return I?void 0:e;case 114:case 112:case 113:case 117:case 76:case 124:case 131:case 164:case 165:case 163:case 158:case 145:case 119:case 122:case 136:case 133:case 130:case 105:case 137:case 161:case 160:case 162:case 159:case 166:case 167:case 168:case 169:case 170:case 171:case 172:case 173:case 157:case 147:case 231:case 149:case 236:return;case 152:var t=e;return q(t)?Me.updateConstructor(t,Me.visitNodes(t.decorators,$,Me.isDecorator),Me.visitNodes(t.modifiers,$,Me.isModifier),Me.visitParameterList(t.parameters,$,C),Me.visitFunctionBody(t.body,$,C)):void 0;case 230:return Me.createNotEmittedStatement(e);case 229:var t=e,r=H(t,!0),n=((e,t)=>{var r=0;return Me.some(t)&&(r|=1),(t=Me.getClassExtendsHeritageClauseElement(e))&&95!==Me.skipOuterExpressions(t.expression).kind&&(r|=64),(e=>e.decorators&&0<e.decorators.length||(e=Me.getFirstConstructorWithBody(e))&&Me.forEach(e.parameters,X))(e)&&(r|=2),Me.childIsDecorated(e)&&(r|=4),J(e)?r|=8:(e=>Y(e)&&Me.hasModifier(e,512))(e)?r|=32:Ce(e)&&(r|=16),F<=1&&7&r&&(r|=128),r})(t,r),i=(128&n&&C.startLexicalEnvironment(),t.name||(5&n?Me.getGeneratedNameForNode(t):void 0)),s=[i=(2&n?(e,t,r)=>{var n=Me.moveRangePastDecorators(e),i=(e=>{var t;if(8388608&P.getNodeCheckFlags(e))return Re(),t=Me.createUniqueName(e.name&&!Me.isGeneratedIdentifier(e.name)?Me.idText(e.name):"default"),N[Me.getOriginalNodeId(e)]=t,L(t),t})(e),s=Me.getLocalName(e,!1,!0),a=Me.visitNodes(e.heritageClauses,$,Me.isHeritageClause),r=V(e,0!=(64&r)),t=Me.createClassExpression(void 0,t,void 0,a,r),a=(Me.setOriginalNode(t,e),Me.setTextRange(t,n),Me.createVariableStatement(void 0,Me.createVariableDeclarationList([Me.createVariableDeclaration(s,void 0,i?Me.createAssignment(i,t):t)],1)));return Me.setOriginalNode(a,e),Me.setTextRange(a,n),Me.setCommentRange(a,e),a}:(e,t,r)=>{var n=128&r?void 0:Me.visitNodes(e.modifiers,U,Me.isModifier),n=Me.createClassDeclaration(void 0,n,t,void 0,Me.visitNodes(e.heritageClauses,$,Me.isHeritageClause),V(e,0!=(64&r))),t=Me.getEmitFlags(e);return 1&r&&(t|=32),Me.setTextRange(n,e),Me.setOriginalNode(n,e),Me.setEmitFlags(n,t),n})(t,i,n)],a=(1&n&&G(s,r,128&n?Me.getInternalName(t):Me.getLocalName(t)),te(s,t,!1),te(s,t,!0),s),o=t,l=(e=>{var t,r,n=(e=>{var t=e.decorators,e=K(Me.getFirstConstructorWithBody(e));if(t||e)return{decorators:t,parameters:e}})(e);if(n=z(e,e,n))return t=N&&N[Me.getOriginalNodeId(e)],r=Me.getLocalName(e,!1,!0),n=Fe(C,n,r),r=Me.createAssignment(r,t?Me.createAssignment(t,n):n),Me.setEmitFlags(r,1536),Me.setSourceMapRange(r,Me.moveRangePastDecorators(e)),r})(o);return l&&a.push(Me.setOriginalNode(Me.createStatement(l),o)),128&n&&(r=Me.createTokenRange(Me.skipTrivia(w.text,t.members.end),18),a=Me.getInternalName(t),(a=Me.createPartiallyEmittedExpression(a)).end=r.end,Me.setEmitFlags(a,1536),(a=Me.createReturn(a)).pos=r.pos,Me.setEmitFlags(a,1920),s.push(a),Me.addRange(s,C.endLexicalEnvironment()),r=Me.createImmediatelyInvokedArrowFunction(s),Me.setEmitFlags(r,33554432),a=Me.createVariableStatement(void 0,Me.createVariableDeclarationList([Me.createVariableDeclaration(Me.getLocalName(t,!1,!1),void 0,r)])),Me.setOriginalNode(a,t),Me.setCommentRange(a,t),Me.setSourceMapRange(a,Me.moveRangePastDecorators(t)),Me.startOnNewLine(a),s=[a]),8&n?Ie(s,t):(128&n||2&n)&&(32&n?s.push(Me.createExportDefault(Me.getLocalName(t,!1,!0))):16&n&&s.push(Me.createExternalModuleExport(Me.getLocalName(t,!1,!0)))),1<s.length&&(s.push(Me.createEndOfDeclarationMarker(t)),Me.setEmitFlags(i,4194304|Me.getEmitFlags(i))),Me.singleOrMany(s);case 199:l=e,o=H(l,!0),r=Me.visitNodes(l.heritageClauses,$,Me.isHeritageClause),a=V(l,Me.some(r,function(e){return 85===e.token})),r=Me.createClassExpression(void 0,l.name,void 0,r,a);return Me.setOriginalNode(r,l),Me.setTextRange(r,l),0<o.length?(a=[],n=Me.createTempVariable(L),8388608&P.getNodeCheckFlags(l)&&(Re(),N[Me.getOriginalNodeId(l)]=Me.getSynthesizedClone(n)),Me.setEmitFlags(r,65536|Me.getEmitFlags(r)),a.push(Me.startOnNewLine(Me.createAssignment(n,r))),Me.addRange(a,((e,t)=>{for(var r=[],n=0,i=e;n<i.length;n++){var s=i[n],a=j(s,t);a.startsOnNewLine=!0,Me.setSourceMapRange(a,Me.moveRangePastModifiers(s)),Me.setCommentRange(a,s),r.push(a)}return r})(o,n)),a.push(Me.startOnNewLine(n)),Me.inlineExpressions(a)):r;case 259:i=e;return 85===i.token?(s=Me.visitNodes(i.types,$,Me.isExpressionWithTypeArguments,0,1),Me.setTextRange(Me.createHeritageClause(85,s),i)):void 0;case 201:return Me.updateExpressionWithTypeArguments(e,void 0,Me.visitNode(e.expression,$,Me.isLeftHandSideExpression));case 151:var c=e;return q(c)?((u=Me.updateMethod(c,void 0,Me.visitNodes(c.modifiers,U,Me.isModifier),c.asteriskToken,W(c),void 0,void 0,Me.visitParameterList(c.parameters,$,C),void 0,Me.visitFunctionBody(c.body,$,C)))!==c&&(Me.setCommentRange(u,c),Me.setSourceMapRange(u,Me.moveRangePastDecorators(c))),u):void 0;case 153:var u,c=e;return pe(c)?((u=Me.updateGetAccessor(c,void 0,Me.visitNodes(c.modifiers,U,Me.isModifier),W(c),Me.visitParameterList(c.parameters,$,C),void 0,Me.visitFunctionBody(c.body,$,C)||Me.createBlock([])))!==c&&(Me.setCommentRange(u,c),Me.setSourceMapRange(u,Me.moveRangePastDecorators(c))),u):void 0;case 154:var d=e;return pe(d)?((p=Me.updateSetAccessor(d,void 0,Me.visitNodes(d.modifiers,U,Me.isModifier),W(d),Me.visitParameterList(d.parameters,$,C),Me.visitFunctionBody(d.body,$,C)||Me.createBlock([])))!==d&&(Me.setCommentRange(p,d),Me.setSourceMapRange(p,Me.moveRangePastDecorators(d))),p):void 0;case 228:var p,d=e;return q(d)?(p=Me.updateFunctionDeclaration(d,void 0,Me.visitNodes(d.modifiers,U,Me.isModifier),d.asteriskToken,d.name,void 0,Me.visitParameterList(d.parameters,$,C),void 0,Me.visitFunctionBody(d.body,$,C)||Me.createBlock([])),J(d)?(Ie(S=[p],d),S):p):Me.createNotEmittedStatement(d);case 186:return q(S=e)?Me.updateFunctionExpression(S,Me.visitNodes(S.modifiers,U,Me.isModifier),S.asteriskToken,S.name,void 0,Me.visitParameterList(S.parameters,$,C),void 0,Me.visitFunctionBody(S.body,$,C)||Me.createBlock([])):Me.createOmittedExpression();case 187:return E=e,Me.updateArrowFunction(E,Me.visitNodes(E.modifiers,U,Me.isModifier),void 0,Me.visitParameterList(E.parameters,$,C),void 0,E.equalsGreaterThanToken,Me.visitFunctionBody(E.body,$,C));case 146:E=e;return Me.parameterIsThisKeyword(E)?void 0:(h=Me.createParameter(void 0,void 0,E.dotDotDotToken,Me.visitNode(E.name,$,Me.isBindingName),void 0,void 0,Me.visitNode(E.initializer,$,Me.isExpression)),Me.setOriginalNode(h,E),Me.setTextRange(h,Me.moveRangePastModifiers(E)),Me.setCommentRange(h,E),Me.setSourceMapRange(h,Me.moveRangePastModifiers(E)),Me.setEmitFlags(h.name,32),h);case 185:var h=e,m=Me.skipOuterExpressions(h.expression,-3);return Me.isAssertionExpression(m)?(m=Me.visitNode(h.expression,$,Me.isExpression),Me.createPartiallyEmittedExpression(m,h)):Me.visitEachChild(h,$,C);case 184:case 202:return m=e,x=Me.visitNode(m.expression,$,Me.isExpression),Me.createPartiallyEmittedExpression(x,m);case 181:return x=e,Me.updateCall(x,Me.visitNode(x.expression,$,Me.isExpression),void 0,Me.visitNodes(x.arguments,$,Me.isExpression));case 182:return k=e,Me.updateNew(k,Me.visitNode(k.expression,$,Me.isExpression),void 0,Me.visitNodes(k.arguments,$,Me.isExpression));case 203:return k=e,y=Me.visitNode(k.expression,$,Me.isLeftHandSideExpression),Me.createPartiallyEmittedExpression(y,k);case 232:var g,f,_,y=e;return(e=>!Me.isConst(e)||M.preserveConstEnums||M.isolatedModules)(y)?(f=2,!ye(g=[],y)||B===Me.ModuleKind.System&&D===w||(f|=512),v=Ne(y),b=Oe(y),T=Me.hasModifier(y,1)?Me.getExternalModuleOrNamespaceExportName(A,y,!1,!0):Me.getLocalName(y,!1,!0),T=Me.createLogicalOr(T,Me.createAssignment(T,Me.createObjectLiteral())),ge(y)&&(_=Me.getLocalName(y,!1,!0),T=Me.createAssignment(_,T)),_=Me.createStatement(Me.createCall(Me.createFunctionExpression(void 0,void 0,void 0,void 0,[Me.createParameter(void 0,void 0,void 0,v)],void 0,((e,t)=>{var r=A,t=(A=t,[]);return O(),Me.addRange(t,Me.map(e.members,me)),Me.addRange(t,R()),A=r,Me.createBlock(Me.setTextRange(Me.createNodeArray(t),e.members),!0)})(y,b)),void 0,[T])),Me.setOriginalNode(_,y),Me.setTextRange(_,y),Me.setEmitFlags(_,f),g.push(_),g.push(Me.createEndOfDeclarationMarker(y)),g):void 0;case 208:var b,v=e;return J(v)?0!==(b=Me.getInitializedVariables(v.declarationList)).length?Me.setTextRange(Me.createStatement(Me.inlineExpressions(Me.map(b,he))),v):void 0:Me.visitEachChild(v,$,C);case 226:return T=e,Me.updateVariableDeclaration(T,Me.visitNode(T.name,$,Me.isBindingName),void 0,Me.visitNode(T.initializer,$,Me.isExpression));case 233:return be(e);case 237:return Se(e);default:return Me.Debug.failBadSyntaxKind(e),Me.visitEachChild(e,$,C)}var T,y,k,x,E,S}function k(e){var t=(void 0===M.alwaysStrict?M.strict:M.alwaysStrict)&&!(Me.isExternalModule(e)&&B>=Me.ModuleKind.ES2015);return Me.updateSourceFileNode(e,Me.visitLexicalEnvironment(e.statements,f,C,0,t))}function X(e){return void 0!==e.decorators&&0<e.decorators.length}function V(e,t){var r,n,i,s,a=[],t=(r=e,t=t,n=Me.forEach(r.members,l),i=262144&r.transformFlags,s=Me.getFirstConstructorWithBody(r),n||i?(n=(e=>Me.visitParameterList(e&&e.parameters,$,C)||[])(s),i=((e,t,r)=>{var n=[],i=0,s=(h(),t?(i=((e,t)=>{var r;return e.body?(e=e.body.statements,(r=Me.addPrologue(t,e,!1,$))!==e.length&&210===(e=e[r]).kind&&Me.isSuperCall(e.expression)?(t.push(Me.visitNode(e,$,Me.isStatement)),r+1):r):0})(t,n),s=(e=>Me.filter(e.parameters,x))(t),Me.addRange(n,Me.map(s,E))):r&&n.push(Me.createStatement(Me.createCall(Me.createSuper(),void 0,[Me.createSpread(Me.createIdentifier("arguments"))]))),H(e,!1));return G(n,s,Me.createThis()),t&&Me.addRange(n,Me.visitNodes(t.body.statements,$,Me.isStatement,i)),n=Me.mergeLexicalEnvironment(n,R()),Me.setTextRange(Me.createBlock(Me.setTextRange(Me.createNodeArray(n),t?t.body.statements:e.members),!0),t?t.body:void 0)})(r,s,t),Me.startOnNewLine(Me.setOriginalNode(Me.setTextRange(Me.createConstructor(void 0,void 0,n,i),s||r),s))):Me.visitEachChild(s,$,C));return t&&a.push(t),Me.addRange(a,Me.visitNodes(e.members,v,Me.isClassElement)),Me.setTextRange(Me.createNodeArray(a),e.members)}function x(e){return Me.hasModifier(e,92)&&Me.isIdentifier(e.name)}function E(e){Me.Debug.assert(Me.isIdentifier(e.name));var t=e.name,r=Me.getMutableClone(t),t=(Me.setEmitFlags(r,1584),Me.getMutableClone(t));return Me.setEmitFlags(t,1536),Me.startOnNewLine(Me.setTextRange(Me.createStatement(Me.createAssignment(Me.setTextRange(Me.createPropertyAccess(Me.createThis(),r),e.name),t)),Me.moveRangePos(e,-1)))}function H(e,t){return Me.filter(e.members,t?S:l)}function S(e){return n(e,!0)}function l(e){return n(e,!1)}function n(e,t){return 149===e.kind&&t===Me.hasModifier(e,32)&&void 0!==e.initializer}function G(e,t,r){for(var n=0,i=t;n<i.length;n++){var s=i[n],a=Me.createStatement(j(s,r));Me.setSourceMapRange(a,Me.moveRangePastModifiers(s)),Me.setCommentRange(a,s),e.push(a)}}function j(e,t){var r=W(e),e=Me.visitNode(e.initializer,$,Me.isExpression),t=Me.createMemberAccessForPropertyName(t,r,r);return Me.createAssignment(t,e)}function Z(e){return i(e,!0)}function Q(e){return i(e,!1)}function i(e,t){return Me.nodeOrChildIsDecorated(e)&&t===Me.hasModifier(e,32)}function K(e){var t;if(e)for(var r=e.parameters,n=0;n<r.length;n++){var i=r[n];(t||i.decorators)&&((t=t||new Array(r.length))[n]=i.decorators)}return t}function ee(e,t){switch(t.kind){case 153:case 154:var r=e,n=t;if(n.body){var i=(r=Me.getAllAccessorDeclarations(r.members,n)).firstAccessor,s=r.secondAccessor,r=r.setAccessor;if((i=i.decorators?i:s&&s.decorators?s:void 0)&&n===i)return s=i.decorators,n=K(r),s||n?{decorators:s,parameters:n}:void 0}return;case 151:i=t;return i.body?(r=i.decorators,i=K(i),r||i?{decorators:r,parameters:i}:void 0):void 0;case 149:s=t;return(s=s.decorators)?{decorators:s}:void 0;default:return}}function z(e,t,r){var n;if(r)return Me.addRange(n=[],Me.map(r.decorators,re)),Me.addRange(n,Me.flatMap(r.parameters,ne)),r=e,e=t,t=n,M.emitDecoratorMetadata&&(ie(r)&&t.push(Be(C,"design:type",oe(r))),ae(r)&&t.push(Be(C,"design:paramtypes",le(r,e))),se(r))&&t.push(Be(C,"design:returntype",ce(r))),n}function te(e,t,r){Me.addRange(e,Me.map(((e,t)=>{for(var r,t=((e,t)=>Me.filter(e.members,t?Z:Q))(e,t),n=0,i=t;n<i.length;n++){var s=i[n],s=((e,t)=>{var r,n,i=ee(e,t);if(i=z(t,e,i))return e=((e,t)=>Me.hasModifier(t,32)?Me.getDeclarationName(e):Me.createPropertyAccess(Me.getDeclarationName(e),"prototype"))(e,t),r=de(t,!0),n=0<F?149===t.kind?Me.createVoidZero():Me.createNull():void 0,i=Fe(C,i,e,r,n,Me.moveRangePastDecorators(t)),Me.setEmitFlags(i,1536),i})(e,s);s&&(r?r.push(s):r=[s])}return r})(t,r),we))}function re(e){return Me.visitNode(e.expression,$,Me.isExpression)}function ne(e,t){var r,n;if(e)for(var i=[],s=0,a=e;s<a.length;s++){var o=a[s],l=(l=C,r=re(o),n=t,o=o.expression,l.requestEmitHelper($e),Me.setTextRange(Me.createCall(Me.getHelperName("__param"),void 0,[Me.createLiteral(n),r]),o));Me.setEmitFlags(l,1536),i.push(l)}return i}function ie(e){e=e.kind;return 151===e||153===e||154===e||149===e}function se(e){return 151===e.kind}function ae(e){switch(e.kind){case 229:case 199:return void 0!==Me.getFirstConstructorWithBody(e);case 151:case 153:case 154:return 1}}function oe(e){switch(e.kind){case 149:case 146:case 153:return d(e.type);case 154:return d(Me.getSetAccessorTypeAnnotationNode(e));case 229:case 199:case 151:return Me.createIdentifier("Function");default:return Me.createVoidZero()}}function le(e,t){var e=Me.isClassLike(e)?Me.getFirstConstructorWithBody(e):Me.isFunctionLike(e)&&Me.nodeIsPresent(e.body)?e:void 0,r=[];if(e)for(var n=((e,t)=>{if(t&&153===e.kind){t=Me.getAllAccessorDeclarations(t.members,e).setAccessor;if(t)return t.parameters}return e.parameters})(e,t),i=n.length,s=0;s<i;s++){var a=n[s];0===s&&Me.isIdentifier(a.name)&&"this"===a.name.escapedText||(a.dotDotDotToken?r.push(d(Me.getRestParameterElementType(a.type))):r.push(oe(a)))}return Me.createArrayLiteral(r)}function ce(e){return Me.isFunctionLike(e)&&e.type?d(e.type):Me.isAsyncFunction(e)?Me.createIdentifier("Promise"):Me.createVoidZero()}function d(e){if(void 0!==e)switch(e.kind){case 105:case 139:case 95:case 130:return Me.createVoidZero();case 168:return d(e.type);case 160:case 161:return Me.createIdentifier("Function");case 164:case 165:return Me.createIdentifier("Array");case 158:case 122:return Me.createIdentifier("Boolean");case 136:return Me.createIdentifier("String");case 134:return Me.createIdentifier("Object");case 173:switch(e.literal.kind){case 9:return Me.createIdentifier("String");case 8:return Me.createIdentifier("Number");case 101:case 86:return Me.createIdentifier("Boolean");default:Me.Debug.failBadSyntaxKind(e.literal)}break;case 133:return Me.createIdentifier("Number");case 137:return F<2?ue():Me.createIdentifier("Symbol");case 159:var t=e;switch(P.getTypeReferenceSerializationKind(t.typeName,D)){case Me.TypeReferenceSerializationKind.Unknown:var r=p(t.typeName,!0),n=Me.createTempVariable(L);return Me.createLogicalOr(Me.createLogicalAnd(Me.createTypeCheck(Me.createAssignment(n,r),"function"),n),Me.createIdentifier("Object"));case Me.TypeReferenceSerializationKind.TypeWithConstructSignatureAndValue:return p(t.typeName,!1);case Me.TypeReferenceSerializationKind.VoidNullableOrNeverType:return Me.createVoidZero();case Me.TypeReferenceSerializationKind.BooleanType:return Me.createIdentifier("Boolean");case Me.TypeReferenceSerializationKind.NumberLikeType:return Me.createIdentifier("Number");case Me.TypeReferenceSerializationKind.StringLikeType:return Me.createIdentifier("String");case Me.TypeReferenceSerializationKind.ArrayLikeType:return Me.createIdentifier("Array");case Me.TypeReferenceSerializationKind.ESSymbolType:return F<2?ue():Me.createIdentifier("Symbol");case Me.TypeReferenceSerializationKind.TypeWithCallSignature:return Me.createIdentifier("Function");case Me.TypeReferenceSerializationKind.Promise:return Me.createIdentifier("Promise");default:Me.TypeReferenceSerializationKind.ObjectType;return Me.createIdentifier("Object")}return;case 167:case 166:for(var i,s=0,a=e.types;s<a.length;s++){for(var o=a[s];168===o.kind;)o=o.type;if(130!==o.kind&&(m||95!==o.kind&&139!==o.kind)){var l=d(o);if(Me.isIdentifier(l)&&"Object"===l.escapedText)return l;if(i){if(!Me.isIdentifier(i)||!Me.isIdentifier(l)||i.escapedText!==l.escapedText)return Me.createIdentifier("Object")}else i=l}}return i||Me.createVoidZero();case 162:case 170:case 171:case 172:case 163:case 119:case 169:break;default:Me.Debug.failBadSyntaxKind(e)}return Me.createIdentifier("Object")}function p(e,t){switch(e.kind){case 71:var r=Me.getMutableClone(e);return r.flags&=-9,r.original=void 0,r.parent=Me.getParseTreeNode(D),t?Me.createLogicalAnd(Me.createStrictInequality(Me.createTypeOf(r),Me.createLiteral("undefined")),r):r;case 143:var r=e,n=t;return n=71===r.left.kind?p(r.left,n):n?(n=Me.createTempVariable(L),Me.createLogicalAnd(Me.createAssignment(n,p(r.left,!0)),n)):p(r.left,!1),Me.createPropertyAccess(n,r.right)}}function ue(){return Me.createConditional(Me.createTypeCheck(Me.createIdentifier("Symbol"),"function"),Me.createIdentifier("Symbol"),Me.createIdentifier("Object"))}function de(e,t){e=e.name;return Me.isComputedPropertyName(e)?t?Me.getGeneratedNameForNode(e):e.expression:Me.isIdentifier(e)?Me.createLiteral(Me.idText(e)):Me.getSynthesizedClone(e)}function W(e){var t,r=e.name;return Me.isComputedPropertyName(r)?(t=Me.visitNode(r.expression,$,Me.isExpression),e.decorators&&(e=Me.getGeneratedNameForNode(r),L(e),t=Me.createAssignment(e,t)),Me.updateComputedPropertyName(r,t)):r}function q(e){return!Me.nodeIsMissing(e.body)}function pe(e){return!Me.nodeIsMissing(e.body)||!Me.hasModifier(e,128)}function he(e){var t=e.name;return Me.isBindingPattern(t)?Me.flattenDestructuringAssignment(e,$,C,0,!1,Ae):Me.setTextRange(Me.createAssignment(De(t),Me.visitNode(e.initializer,$,Me.isExpression)),e)}function me(e){var t=de(e,!1),r=(n=e,void 0!==(r=P.getConstantValue(n))?Me.createLiteral(r):(0==(8&o)&&(o|=8,C.enableSubstitution(71)),n.initializer?Me.visitNode(n.initializer,$,Me.isExpression):Me.createVoidZero())),n=Me.createAssignment(Me.createElementAccess(A,t),r),r=9===r.kind?n:Me.createAssignment(Me.createElementAccess(A,n),t);return Me.setTextRange(Me.createStatement(Me.setTextRange(r,e)),e)}function ge(e){return J(e)||Y(e)&&B!==Me.ModuleKind.ES2015&&B!==Me.ModuleKind.ESNext&&B!==Me.ModuleKind.System}function fe(e){c=c||Me.createUnderscoreEscapedMap();var t=_e(e);c.has(t)||c.set(t,e)}function _e(e){return Me.Debug.assertNode(e.name,Me.isIdentifier),e.name.escapedText}function ye(e,t){var r=Me.createVariableStatement(Me.visitNodes(t.modifiers,U,Me.isModifier),Me.createVariableDeclarationList([Me.createVariableDeclaration(Me.getLocalName(t,!1,!0))],265===D.kind?0:1));if(Me.setOriginalNode(r,t),fe(t),n=t,!c||(i=_e(n),c.get(i)===n))return 232===t.kind?Me.setSourceMapRange(r.declarationList,t):Me.setSourceMapRange(r,t),Me.setCommentRange(r,t),Me.setEmitFlags(r,4195328),e.push(r),1;var n,i=Me.createMergeDeclarationMarker(r);Me.setEmitFlags(i,4195840),e.push(i)}function be(e){var t,r,n,i,s,a;return Me.isInstantiatedModule(e,M.preserveConstEnums||M.isolatedModules)?(Me.Debug.assertNode(e.name,Me.isIdentifier,"A TypeScript namespace should have an Identifier name."),0==(2&o)&&(o|=2,C.enableSubstitution(71),C.enableSubstitution(262),C.enableEmitNotification(233)),r=2,!ye(t=[],e)||B===Me.ModuleKind.System&&D===w||(r|=512),n=Ne(e),i=Oe(e),s=Me.hasModifier(e,1)?Me.getExternalModuleOrNamespaceExportName(A,e,!1,!0):Me.getLocalName(e,!1,!0),s=Me.createLogicalOr(s,Me.createAssignment(s,Me.createObjectLiteral())),ge(e)&&(a=Me.getLocalName(e,!1,!0),s=Me.createAssignment(a,s)),a=Me.createStatement(Me.createCall(Me.createFunctionExpression(void 0,void 0,void 0,void 0,[Me.createParameter(void 0,void 0,void 0,n)],void 0,((e,t)=>{var r,n,i,s=A,a=I,o=c,l=(A=t,I=e,c=void 0,[]);return O(),234===(t=e.body).kind?(u(t,function(e){return Me.addRange(l,Me.visitNodes(e.statements,y,Me.isStatement))}),r=t.statements,n=t):((i=be(t))&&(Me.isArray(i)?Me.addRange(l,i):l.push(i)),i=function e(t){if(233===t.body.kind)return e(t.body)||t.body}(e).body,r=Me.moveRangePos(i.statements,-1)),Me.addRange(l,R()),A=s,I=a,c=o,e=Me.createBlock(Me.setTextRange(Me.createNodeArray(l),r),!0),Me.setTextRange(e,n),234!==t.kind&&Me.setEmitFlags(e,1536|Me.getEmitFlags(e)),e})(e,i)),void 0,[s])),Me.setOriginalNode(a,e),Me.setTextRange(a,e),Me.setEmitFlags(a,r),t.push(a),t.push(Me.createEndOfDeclarationMarker(e)),t):Me.createNotEmittedStatement(e)}function ve(e){var t=P.isReferencedAliasDeclaration(e)?e.name:void 0,r=Me.visitNode(e.namedBindings,Te,Me.isNamedImportBindings);return t||r?Me.updateImportClause(e,t,r):void 0}function Te(e){var t;return 240===e.kind?P.isReferencedAliasDeclaration(e)?e:void 0:(t=Me.visitNodes(e.elements,ke,Me.isImportSpecifier),Me.some(t)?Me.updateNamedImports(e,t):void 0)}function ke(e){return P.isReferencedAliasDeclaration(e)?e:void 0}function xe(e){var t=Me.visitNodes(e.elements,Ee,Me.isExportSpecifier);return Me.some(t)?Me.updateNamedExports(e,t):void 0}function Ee(e){return P.isValueAliasDeclaration(e)?e:void 0}function Se(e){var t,r,n;return Me.isExternalModuleImportEqualsDeclaration(e)?P.isReferencedAliasDeclaration(e)?Me.visitEachChild(e,$,C):void 0:(r=e,P.isReferencedAliasDeclaration(r)||!Me.isExternalModule(w)&&P.isTopLevelValueImportEqualsWithEntityName(r)?(r=Me.createExpressionFromEntityName(e.moduleReference),Me.setEmitFlags(r,3584),Ce(e)||!J(e)?Me.setOriginalNode(Me.setTextRange(Me.createVariableStatement(Me.visitNodes(e.modifiers,U,Me.isModifier),Me.createVariableDeclarationList([Me.setOriginalNode(Me.createVariableDeclaration(e.name,void 0,r),e)])),e),e):Me.setOriginalNode((t=e.name,r=r,n=e,Me.setTextRange(Me.createStatement(Me.createAssignment(Me.getNamespaceMemberName(A,t,!1,!0),r)),n)),e)):void 0)}function J(e){return void 0!==I&&Me.hasModifier(e,1)}function Y(e){return void 0===I&&Me.hasModifier(e,1)}function Ce(e){return Y(e)&&!Me.hasModifier(e,512)}function we(e){return Me.createStatement(e)}function Ie(e,t){var r=Me.createAssignment(Me.getExternalModuleOrNamespaceExportName(A,t,!1,!0),Me.getLocalName(t)),r=(Me.setSourceMapRange(r,Me.createRange((t.name||t).pos,t.end)),Me.createStatement(r));Me.setSourceMapRange(r,Me.createRange(-1,t.end)),e.push(r)}function Ae(e,t,r){return Me.setTextRange(Me.createAssignment(De(e),t),r)}function De(e){return Me.getNamespaceMemberName(A,e,!1,!0)}function Ne(e){var t=Me.getGeneratedNameForNode(e);return Me.setSourceMapRange(t,e.name),t}function Oe(e){return Me.getGeneratedNameForNode(e)}function Re(){0==(1&o)&&(o|=1,C.enableSubstitution(71),N=[])}function Le(e){if(o&s&&!Me.isGeneratedIdentifier(e)&&!Me.isLocalName(e)){var t=P.getReferencedExportContainer(e,!1);if(t&&265!==t.kind)if(2&s&&233===t.kind||8&s&&232===t.kind)return Me.setTextRange(Me.createPropertyAccess(Me.getGeneratedNameForNode(t),e),e)}}function Pe(e){var t,r=(e=>!M.isolatedModules&&(Me.isPropertyAccessExpression(e)||Me.isElementAccessExpression(e))?P.getConstantValue(e):void 0)(e);return void 0!==r?(Me.setConstantValue(e,r),r=Me.createLiteral(r),M.removeComments||(t=Me.isPropertyAccessExpression(e)?Me.declarationNameToString(e.name):Me.getTextOfNode(e.argumentExpression),Me.addSyntheticTrailingComment(r,3," "+t+" ")),r):e}}),priority:2,text:'\n            var __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n                var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n                if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);\n                else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n                return c > 3 && r && Object.defineProperty(target, key, r), r;\n            };'};function Be(e,t,r){return e.requestEmitHelper(n),Me.createCall(Me.getHelperName("__metadata"),void 0,[Me.createLiteral(t),r])}var n={name:"typescript:metadata",scoped:!1,priority:3,text:'\n            var __metadata = (this && this.__metadata) || function (k, v) {\n                if (typeof Reflect === "object" && typeof Reflect.metadata === "function") return Reflect.metadata(k, v);\n            };'},$e={name:"typescript:param",scoped:!1,priority:4,text:"\n            var __param = (this && this.__param) || function (paramIndex, decorator) {\n                return function (target, key) { decorator(target, key, paramIndex); }\n            };"}})(ts=ts||{}),(y=>{var i={name:"typescript:awaiter",scoped:!(y.transformES2017=function(a){var s,r=a.startLexicalEnvironment,o=a.resumeLexicalEnvironment,l=a.endLexicalEnvironment,c=a.getEmitResolver(),e=a.getCompilerOptions(),u=y.getEmitScriptTarget(e),d=0,p=a.onEmitNode,n=a.onSubstituteNode;return a.onEmitNode=function(e,t,r){if(1&s&&(e=>229===(e=e.kind)||152===e||151===e||153===e||154===e)(t)){var n,i=6144&c.getNodeCheckFlags(t);if(i!==d)return n=d,d=i,p(e,t,r),void(d=n)}p(e,t,r)},a.onSubstituteNode=function(e,t){if(t=n(e,t),1===e&&d)return(e=>{switch(e.kind){case 179:return f(e);case 180:return _(e);case 181:return(e=>{var t=e.expression;return y.isSuperProperty(t)?(t=(y.isPropertyAccessExpression(t)?f:_)(t),y.createCall(y.createPropertyAccess(t,"call"),void 0,[y.createThis()].concat(e.arguments))):e})(e)}return e})(t);return t},function(e){if(e.isDeclarationFile)return e;e=y.visitEachChild(e,h,a);return y.addEmitHelpers(e,a.readEmitHelpers()),e};function h(e){if(0==(16&e.transformFlags))return e;switch(e.kind){case 120:return;case 191:return n=e,y.setOriginalNode(y.setTextRange(y.createYield(void 0,y.visitNode(n.expression,h,y.isExpression)),n),n);case 151:return n=e,y.updateMethod(n,void 0,y.visitNodes(n.modifiers,h,y.isModifier),n.asteriskToken,n.name,void 0,void 0,y.visitParameterList(n.parameters,h,a),void 0,2&y.getFunctionFlags(n)?i(n):y.visitFunctionBody(n.body,h,a));case 228:return r=e,y.updateFunctionDeclaration(r,void 0,y.visitNodes(r.modifiers,h,y.isModifier),r.asteriskToken,r.name,void 0,y.visitParameterList(r.parameters,h,a),void 0,2&y.getFunctionFlags(r)?i(r):y.visitFunctionBody(r.body,h,a));case 186:return r=e,y.updateFunctionExpression(r,y.visitNodes(r.modifiers,h,y.isModifier),r.asteriskToken,r.name,void 0,y.visitParameterList(r.parameters,h,a),void 0,2&y.getFunctionFlags(r)?i(r):y.visitFunctionBody(r.body,h,a));case 187:return t=e,y.updateArrowFunction(t,y.visitNodes(t.modifiers,h,y.isModifier),void 0,y.visitParameterList(t.parameters,h,a),void 0,t.equalsGreaterThanToken,2&y.getFunctionFlags(t)?i(t):y.visitFunctionBody(t.body,h,a));default:return y.visitEachChild(e,h,a)}var t,r,n}function i(e){o();var t,r,n=y.getOriginalNode(e,y.isFunctionLike).type,n=u<2?(e=>{if((e=e&&y.getEntityNameFromTypeNode(e))&&y.isEntityName(e)){var t=c.getTypeReferenceSerializationKind(e);if(t===y.TypeReferenceSerializationKind.TypeWithConstructSignatureAndValue||t===y.TypeReferenceSerializationKind.Unknown)return e}})(n):void 0,i=187===e.kind,s=0!=(8192&c.getNodeCheckFlags(e));return i?(i=b(a,s,n,m(e.body)),t=l(),y.some(t)?(r=y.convertToFunctionBody(i),y.updateBlock(r,y.setTextRange(y.createNodeArray(y.concatenate(r.statements,t)),r.statements))):i):(i=y.addPrologue(t=[],e.body.statements,!1,h),t.push(y.createReturn(b(a,s,n,m(e.body,i)))),y.addRange(t,l()),r=y.createBlock(t,!0),y.setTextRange(r,e.body),2<=u&&(4096&c.getNodeCheckFlags(e)?(g(),y.addEmitHelper(r,y.advancedAsyncSuperHelper)):2048&c.getNodeCheckFlags(e)&&(g(),y.addEmitHelper(r,y.asyncSuperHelper))),r)}function m(e,t){return y.isBlock(e)?y.updateBlock(e,y.visitLexicalEnvironment(e.statements,h,a,t)):(r(),t=y.convertToFunctionBody(y.visitNode(e,h,y.isConciseBody)),e=l(),y.updateBlock(t,y.setTextRange(y.createNodeArray(y.concatenate(t.statements,e)),t.statements)))}function g(){0==(1&s)&&(s|=1,a.enableSubstitution(181),a.enableSubstitution(179),a.enableSubstitution(180),a.enableEmitNotification(229),a.enableEmitNotification(151),a.enableEmitNotification(153),a.enableEmitNotification(154),a.enableEmitNotification(152))}function f(e){return 97===e.expression.kind?t(y.createLiteral(y.idText(e.name)),e):e}function _(e){return 97===e.expression.kind?t(e.argumentExpression,e):e}function t(e,t){return 4096&d?y.setTextRange(y.createPropertyAccess(y.createCall(y.createIdentifier("_super"),void 0,[e]),"value"),t):y.setTextRange(y.createCall(y.createIdentifier("_super"),void 0,[e]),t)}}),priority:5,text:'\n            var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n                return new (P || (P = Promise))(function (resolve, reject) {\n                    function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n                    function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }\n                    function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n                    step((generator = generator.apply(thisArg, _arguments || [])).next());\n                });\n            };'};function b(e,t,r,n){e.requestEmitHelper(i);e=y.createFunctionExpression(void 0,y.createToken(39),void 0,void 0,[],void 0,n);return(e.emitNode||(e.emitNode={})).flags|=786432,y.createCall(y.getHelperName("__awaiter"),void 0,[y.createThis(),t?y.createIdentifier("arguments"):y.createVoidZero(),r?y.createExpressionFromEntityName(r):y.createVoidZero(),e])}y.asyncSuperHelper={name:"typescript:async-super",scoped:!0,text:"\n            const _super = name => super[name];\n        "},y.advancedAsyncSuperHelper={name:"typescript:advanced-async-super",scoped:!0,text:"\n            const _super = (function (geti, seti) {\n                const cache = Object.create(null);\n                return name => cache[name] || (cache[name] = { get value() { return geti(name); }, set value(v) { seti(name, v); } });\n            })(name => super[name], (name, value) => super[name] = value);\n        "}})(ts=ts||{}),(S=>{var r={name:"typescript:assign",scoped:!(S.transformESNext=function(f){var s,_,a=f.resumeLexicalEnvironment,o=f.endLexicalEnvironment,m=f.hoistVariableDeclaration,l=f.getEmitResolver(),e=f.getCompilerOptions(),i=S.getEmitScriptTarget(e),c=f.onEmitNode,r=(f.onEmitNode=function(e,t,r){if(1&s&&(e=>229===(e=e.kind)||152===e||151===e||153===e||154===e)(t)){var n,i=6144&l.getNodeCheckFlags(t);if(i!==u)return n=u,u=i,c(e,t,r),void(u=n)}c(e,t,r)},f.onSubstituteNode),u=(f.onSubstituteNode=function(e,t){if(t=r(e,t),1===e&&u)return(e=>{switch(e.kind){case 179:return n(e);case 180:return h(e);case 181:return(e=>{var t=e.expression;return S.isSuperProperty(t)?(t=(S.isPropertyAccessExpression(t)?n:h)(t),S.createCall(S.createPropertyAccess(t,"call"),void 0,[S.createThis()].concat(e.arguments))):e})(e)}return e})(t);return t},0);return function(e){if(e.isDeclarationFile)return e;e=S.visitEachChild(e,y,f);return S.addEmitHelpers(e,f.readEmitHelpers()),e};function y(e){return t(e,!1)}function b(e){return t(e,!0)}function v(e){if(120!==e.kind)return e}function t(e,t){if(0==(8&e.transformFlags))return e;switch(e.kind){case 191:var r=e;return 2&_&&1&_?S.setOriginalNode(S.setTextRange(S.createYield(I(f,S.visitNode(r.expression,y,S.isExpression))),r),r):S.visitEachChild(r,y,f);case 197:r=e;return 2&_&&1&_&&r.asteriskToken?(n=S.visitNode(r.expression,y,S.isExpression),S.setOriginalNode(S.setTextRange(S.createYield(I(f,S.updateYield(r,r.asteriskToken,((e,t,r)=>(e.requestEmitHelper(w),e.requestEmitHelper(D),S.setTextRange(S.createCall(S.getHelperName("__asyncDelegator"),void 0,[t]),r)))(f,N(f,n,n),n)))),r),r)):S.visitEachChild(r,y,f);case 222:var n=e;return 2&_&&1&_?216===(i=S.unwrapInnermostStatementOfLabel(n)).kind&&i.awaitModifier?T(i,n):S.restoreEnclosingLabel(S.visitEachChild(n,y,f),n):S.visitEachChild(n,y,f);case 178:var i=e;return 1048576&i.transformFlags?((s=(e=>{for(var t,r=[],n=0,i=e;n<i.length;n++){var s,a=i[n];263===a.kind?(t&&(r.push(S.createObjectLiteral(t)),t=void 0),s=a.expression,r.push(S.visitNode(s,y,S.isExpression))):(t=t||[],261===a.kind?t.push(S.createPropertyAssignment(a.name,S.visitNode(a.initializer,y,S.isExpression))):t.push(S.visitNode(a,y,S.isObjectLiteralElementLike)))}return t&&r.push(S.createObjectLiteral(t)),r})(i.properties)).length&&178!==s[0].kind&&s.unshift(S.createObjectLiteral()),C(f,s)):S.visitEachChild(i,y,f);case 194:var s=e,a=t;return S.isDestructuringAssignment(s)&&1048576&s.left.transformFlags?S.flattenDestructuringAssignment(s,y,f,1,!a):26===s.operatorToken.kind?S.updateBinary(s,S.visitNode(s.left,b,S.isExpression),S.visitNode(s.right,a?b:y,S.isExpression)):S.visitEachChild(s,y,f);case 226:a=e;return S.isBindingPattern(a.name)&&1048576&a.name.transformFlags?S.flattenDestructuringBinding(a,y,f,1):S.visitEachChild(a,y,f);case 216:return T(e,void 0);case 214:return g=e,S.updateFor(g,S.visitNode(g.initializer,b,S.isForInitializer),S.visitNode(g.condition,y,S.isExpression),S.visitNode(g.incrementor,y,S.isExpression),S.visitNode(g.statement,y,S.isStatement));case 190:return S.visitEachChild(e,b,f);case 152:return g=e,m=_,_=0,g=S.updateConstructor(g,void 0,g.modifiers,S.visitParameterList(g.parameters,y,f),x(g)),_=m,g;case 151:return m=e,h=_,_=S.getFunctionFlags(m),m=S.updateMethod(m,void 0,1&_?S.visitNodes(m.modifiers,v,S.isModifier):m.modifiers,2&_?void 0:m.asteriskToken,S.visitNode(m.name,y,S.isPropertyName),S.visitNode(void 0,y,S.isToken),void 0,S.visitParameterList(m.parameters,y,f),void 0,(2&_&&1&_?k:x)(m)),_=h,m;case 153:return h=e,p=_,_=0,h=S.updateGetAccessor(h,void 0,h.modifiers,S.visitNode(h.name,y,S.isPropertyName),S.visitParameterList(h.parameters,y,f),void 0,x(h)),_=p,h;case 154:return p=e,d=_,_=0,p=S.updateSetAccessor(p,void 0,p.modifiers,S.visitNode(p.name,y,S.isPropertyName),S.visitParameterList(p.parameters,y,f),x(p)),_=d,p;case 228:return d=e,u=_,_=S.getFunctionFlags(d),d=S.updateFunctionDeclaration(d,void 0,1&_?S.visitNodes(d.modifiers,v,S.isModifier):d.modifiers,2&_?void 0:d.asteriskToken,d.name,void 0,S.visitParameterList(d.parameters,y,f),void 0,(2&_&&1&_?k:x)(d)),_=u,d;case 186:return u=e,c=_,_=S.getFunctionFlags(u),u=S.updateFunctionExpression(u,1&_?S.visitNodes(u.modifiers,v,S.isModifier):u.modifiers,2&_?void 0:u.asteriskToken,u.name,void 0,S.visitParameterList(u.parameters,y,f),void 0,(2&_&&1&_?k:x)(u)),_=c,u;case 187:return c=e,l=_,_=S.getFunctionFlags(c),c=S.updateArrowFunction(c,c.modifiers,void 0,S.visitParameterList(c.parameters,y,f),void 0,c.equalsGreaterThanToken,x(c)),_=l,c;case 146:l=e;return 1048576&l.transformFlags?S.updateParameter(l,void 0,void 0,l.dotDotDotToken,S.getGeneratedNameForNode(l),void 0,void 0,S.visitNode(l.initializer,y,S.isExpression)):S.visitEachChild(l,y,f);case 210:return S.visitEachChild(e,b,f);case 185:return S.visitEachChild(e,t?b:y,f);case 260:return(o=e).variableDeclaration?S.visitEachChild(o,y,f):S.updateCatchClause(o,S.createVariableDeclaration(S.createTempVariable(void 0)),S.visitNode(o.block,y,S.isBlock));default:return S.visitEachChild(e,y,f)}var o,l,c,u,d,p,h,m,g}function T(e,t){return(e=1048576&e.initializer.transformFlags?(e=>{var t,r,n,i=S.skipParentheses(e.initializer);return S.isVariableDeclarationList(i)||S.isAssignmentPattern(i)?(r=t=void 0,n=S.createTempVariable(void 0),i=[S.createForOfBindingStatement(i,n)],S.isBlock(e.statement)&&(S.addRange(i,e.statement.statements),t=e.statement,r=e.statement.statements),S.updateForOf(e,e.awaitModifier,S.setTextRange(S.createVariableDeclarationList([S.setTextRange(S.createVariableDeclaration(n),e.initializer)],1),e.initializer),e.expression,S.setTextRange(S.createBlock(S.setTextRange(S.createNodeArray(i),r),!0),t))):e})(e):e).awaitModifier?(r=e,n=t,i=S.visitNode(r.expression,y,S.isExpression),s=S.isIdentifier(i)?S.getGeneratedNameForNode(i):S.createTempVariable(void 0),a=S.isIdentifier(i)?S.getGeneratedNameForNode(s):S.createTempVariable(void 0),o=S.createUniqueName("e"),l=S.getGeneratedNameForNode(o),c=S.createTempVariable(void 0),i=N(f,i,r.expression),u=S.createCall(S.createPropertyAccess(s,"next"),void 0,[]),d=S.createPropertyAccess(a,"done"),p=S.createPropertyAccess(a,"value"),h=S.createFunctionCall(c,s,[]),m(o),m(c),i=S.setEmitFlags(S.setTextRange(S.createFor(S.setEmitFlags(S.setTextRange(S.createVariableDeclarationList([S.setTextRange(S.createVariableDeclaration(s,void 0,i),r.expression),S.createVariableDeclaration(a)]),r.expression),2097152),S.createComma(S.createAssignment(a,g(u)),S.createLogicalNot(d)),void 0,((e,t)=>{var r,n,t=S.createForOfBindingStatement(e.initializer,t),t=[S.visitNode(t,y,S.isStatement)],e=S.visitNode(e.statement,y,S.isStatement);return S.isBlock(e)?(S.addRange(t,e.statements),n=(r=e).statements):t.push(e),S.setEmitFlags(S.setTextRange(S.createBlock(S.setTextRange(S.createNodeArray(t),n),!0),r),432)})(r,g(p))),r),256),S.createTry(S.createBlock([S.restoreEnclosingLabel(i,n)]),S.createCatchClause(S.createVariableDeclaration(l),S.setEmitFlags(S.createBlock([S.createStatement(S.createAssignment(o,S.createObjectLiteral([S.createPropertyAssignment("error",l)])))]),1)),S.createBlock([S.createTry(S.createBlock([S.setEmitFlags(S.createIf(S.createLogicalAnd(S.createLogicalAnd(a,S.createLogicalNot(d)),S.createAssignment(c,S.createPropertyAccess(s,"return"))),S.createStatement(g(h))),1)]),void 0,S.setEmitFlags(S.createBlock([S.setEmitFlags(S.createIf(o,S.createThrow(S.createPropertyAccess(o,"error"))),1)]),1))]))):S.restoreEnclosingLabel(S.visitEachChild(e,y,f),t);var r,n,i,s,a,o,l,c,u,d,p,h}function g(e){return 1&_?S.createYield(void 0,I(f,e)):S.createAwait(e)}function k(e){a();var t=[],r=S.addPrologue(t,e.body.statements,!1,y),n=(d(t,e),t.push(S.createReturn((n=f,r=S.createFunctionExpression(void 0,S.createToken(39),e.name&&S.getGeneratedNameForNode(e.name),void 0,[],void 0,S.updateBlock(e.body,S.visitLexicalEnvironment(e.body.statements,y,f,r))),n.requestEmitHelper(w),n.requestEmitHelper(A),(r.emitNode||(r.emitNode={})).flags|=262144,S.createCall(S.getHelperName("__asyncGenerator"),void 0,[S.createThis(),S.createIdentifier("arguments"),r])))),S.addRange(t,o()),S.updateBlock(e.body,t));return 2<=i&&(4096&l.getNodeCheckFlags(e)?(p(),S.addEmitHelper(n,S.advancedAsyncSuperHelper)):2048&l.getNodeCheckFlags(e)&&(p(),S.addEmitHelper(n,S.asyncSuperHelper))),n}function x(e){a();var t,r=0,n=[],i=S.visitNode(e.body,y,S.isConciseBody),e=(S.isBlock(i)&&(r=S.addPrologue(n,i.statements,!1,y)),S.addRange(n,d(void 0,e)),o());return 0<r||S.some(n)||S.some(e)?(t=S.convertToFunctionBody(i,!0),S.addRange(n,t.statements.slice(r)),S.addRange(n,e),S.updateBlock(t,S.setTextRange(S.createNodeArray(n),t.statements))):i}function d(e,t){for(var r=0,n=t.parameters;r<n.length;r++){var i,s=n[r];1048576&s.transformFlags&&(i=S.getGeneratedNameForNode(s),s=S.flattenDestructuringBinding(s,y,f,1,i,!1,!0),S.some(s))&&(i=S.createVariableStatement(void 0,S.createVariableDeclarationList(s)),S.setEmitFlags(i,1048576),e=S.append(e,i))}return e}function p(){0==(1&s)&&(s|=1,f.enableSubstitution(181),f.enableSubstitution(179),f.enableSubstitution(180),f.enableEmitNotification(229),f.enableEmitNotification(151),f.enableEmitNotification(153),f.enableEmitNotification(154),f.enableEmitNotification(152))}function n(e){return 97===e.expression.kind?E(S.createLiteral(S.idText(e.name)),e):e}function h(e){return 97===e.expression.kind?E(e.argumentExpression,e):e}function E(e,t){return 4096&u?S.setTextRange(S.createPropertyAccess(S.createCall(S.createIdentifier("_super"),void 0,[e]),"value"),t):S.setTextRange(S.createCall(S.createIdentifier("_super"),void 0,[e]),t)}}),priority:1,text:"\n            var __assign = (this && this.__assign) || Object.assign || function(t) {\n                for (var s, i = 1, n = arguments.length; i < n; i++) {\n                    s = arguments[i];\n                    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                        t[p] = s[p];\n                }\n                return t;\n            };"};function C(e,t){return 2<=e.getCompilerOptions().target?S.createCall(S.createPropertyAccess(S.createIdentifier("Object"),"assign"),void 0,t):(e.requestEmitHelper(r),S.createCall(S.getHelperName("__assign"),void 0,t))}S.createAssignHelper=C;var w={name:"typescript:await",scoped:!1,text:"\n            var __await = (this && this.__await) || function (v) { return this instanceof __await ? (this.v = v, this) : new __await(v); }\n        "};function I(e,t){return e.requestEmitHelper(w),S.createCall(S.getHelperName("__await"),void 0,[t])}var A={name:"typescript:asyncGenerator",scoped:!1,text:'\n            var __asyncGenerator = (this && this.__asyncGenerator) || function (thisArg, _arguments, generator) {\n                if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");\n                var g = generator.apply(thisArg, _arguments || []), i, q = [];\n                return i = {}, verb("next"), verb("throw"), verb("return"), i[Symbol.asyncIterator] = function () { return this; }, i;\n                function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\n                function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n                function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r);  }\n                function fulfill(value) { resume("next", value); }\n                function reject(value) { resume("throw", value); }\n                function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n            };\n        '},D={name:"typescript:asyncDelegator",scoped:!1,text:'\n            var __asyncDelegator = (this && this.__asyncDelegator) || function (o) {\n                var i, p;\n                return i = {}, verb("next"), verb("throw", function (e) { throw e; }), verb("return"), i[Symbol.iterator] = function () { return this; }, i;\n                function verb(n, f) { if (o[n]) i[n] = function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === "return" } : f ? f(v) : v; }; }\n            };\n        '},n={name:"typescript:asyncValues",scoped:!1,text:'\n            var __asyncValues = (this && this.__asyncIterator) || function (o) {\n                if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined.");\n                var m = o[Symbol.asyncIterator];\n                return m ? m.call(o) : typeof __values === "function" ? __values(o) : o[Symbol.iterator]();\n            };\n        '};function N(e,t,r){return e.requestEmitHelper(n),S.setTextRange(S.createCall(S.getHelperName("__asyncValues"),void 0,[t]),r)}})(ts=ts||{}),(m=>{m.transformJsx=function(l){var c=l.getCompilerOptions();return function(e){if(e.isDeclarationFile)return e;e=m.visitEachChild(e,r,l);return m.addEmitHelpers(e,l.readEmitHelpers()),e};function r(e){if(!(4&e.transformFlags))return e;var t=e;switch(t.kind){case 249:return n(t,!1);case 250:return i(t,!1);case 256:return h(t);default:return m.visitEachChild(t,r,l)}}function u(e){switch(e.kind){case 10:var t=e;return void 0===(t=(e=>{for(var t,r=0,n=-1,i=0;i<e.length;i++){var s=e.charCodeAt(i);m.isLineBreak(s)?(-1!==r&&-1!==n&&(t=a(t,e.substr(r,n-r+1))),r=-1):m.isWhiteSpaceSingleLine(s)||(n=i,-1===r&&(r=i))}return-1!==r?a(t,e.substr(r)):t})(m.getTextOfNode(t,!0)))?void 0:m.createLiteral(t);case 256:return h(e);case 249:return n(e,!0);case 250:return i(e,!0);default:return void m.Debug.failBadSyntaxKind(e)}}function n(e,t){return s(e.openingElement,e.children,t,e)}function i(e,t){return s(e,void 0,t,e)}function s(e,t,r,n){var i,s=function e(t){return 249===t.kind?e(t.openingElement):(t=t.tagName,m.isIdentifier(t)&&m.isIntrinsicJsxName(t.escapedText)?m.createLiteral(m.idText(t)):m.createExpressionFromEntityName(t))}(e),a=e.attributes.properties,o=0===a.length?m.createNull():(i=m.flatten(m.spanMap(a,m.isJsxSpreadAttribute,function(e,t){return t?m.map(e,d):m.createObjectLiteral(m.map(e,p))})),m.isJsxSpreadAttribute(a[0])&&i.unshift(m.createObjectLiteral()),(o=m.singleOrUndefined(i))||m.createAssignHelper(l,i)),a=m.createExpressionForJsxElement(l.getEmitResolver().getJsxFactoryEntity(),c.reactNamespace,s,o,m.mapDefined(t,u),e,n);return r&&m.startOnNewLine(a),a}function d(e){return m.visitNode(e.expression,r,m.isExpression)}function p(e){t=(t=e).name,r=m.idText(t);var t=/^[A-Za-z_]\w*$/.test(r)?t:m.createLiteral(r),r=(e=>{var t;return void 0===e?m.createTrue():9===e.kind?(t=(e=>{var t=o(e);return t===e?void 0:t})(e.text))?m.setTextRange(m.createLiteral(t),e):e:256===e.kind?void 0===e.expression?m.createTrue():h(e):void m.Debug.failBadSyntaxKind(e)})(e.initializer);return m.createPropertyAssignment(t,r)}function a(e,t){t=o(t);return void 0===e?t:e+" "+t}function o(e){return e.replace(/&((#((\d+)|x([\da-fA-F]+)))|(\w+));/g,function(e,t,r,n,i,s,a){return i?String.fromCharCode(parseInt(i,10)):s?String.fromCharCode(parseInt(s,16)):(i=g.get(a))?String.fromCharCode(i):e})}function h(e){return m.visitNode(e.expression,r,m.isExpression)}};var g=m.createMapFromTemplate({quot:34,amp:38,apos:39,lt:60,gt:62,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,copy:169,ordf:170,laquo:171,not:172,shy:173,reg:174,macr:175,deg:176,plusmn:177,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,sup1:185,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,Agrave:192,Aacute:193,Acirc:194,Atilde:195,Auml:196,Aring:197,AElig:198,Ccedil:199,Egrave:200,Eacute:201,Ecirc:202,Euml:203,Igrave:204,Iacute:205,Icirc:206,Iuml:207,ETH:208,Ntilde:209,Ograve:210,Oacute:211,Ocirc:212,Otilde:213,Ouml:214,times:215,Oslash:216,Ugrave:217,Uacute:218,Ucirc:219,Uuml:220,Yacute:221,THORN:222,szlig:223,agrave:224,aacute:225,acirc:226,atilde:227,auml:228,aring:229,aelig:230,ccedil:231,egrave:232,eacute:233,ecirc:234,euml:235,igrave:236,iacute:237,icirc:238,iuml:239,eth:240,ntilde:241,ograve:242,oacute:243,ocirc:244,otilde:245,ouml:246,divide:247,oslash:248,ugrave:249,uacute:250,ucirc:251,uuml:252,yacute:253,thorn:254,yuml:255,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830})})(ts=ts||{}),(l=>{l.transformES2016=function(r){var a=r.hoistVariableDeclaration;return function(e){if(e.isDeclarationFile)return e;return l.visitEachChild(e,o,r)};function o(e){if(0==(32&e.transformFlags))return e;if(194!==e.kind)return l.visitEachChild(e,o,r);var t=e;switch(t.operatorToken.kind){case 62:return(e=>{var t,r,n,i=l.visitNode(e.left,o,l.isExpression),s=l.visitNode(e.right,o,l.isExpression);return r=l.isElementAccessExpression(i)?(n=l.createTempVariable(a),r=l.createTempVariable(a),t=l.setTextRange(l.createElementAccess(l.setTextRange(l.createAssignment(n,i.expression),i.expression),l.setTextRange(l.createAssignment(r,i.argumentExpression),i.argumentExpression)),i),l.setTextRange(l.createElementAccess(n,r),i)):l.isPropertyAccessExpression(i)?(n=l.createTempVariable(a),t=l.setTextRange(l.createPropertyAccess(l.setTextRange(l.createAssignment(n,i.expression),i.expression),i.name),i),l.setTextRange(l.createPropertyAccess(n,i.name),i)):t=i,l.setTextRange(l.createAssignment(t,l.createMathPow(r,s,e)),e)})(t);case 40:return(e=>{var t=l.visitNode(e.left,o,l.isExpression),r=l.visitNode(e.right,o,l.isExpression);return l.createMathPow(t,r,e)})(t);default:return l.visitEachChild(t,o,r)}}}})(ts=ts||{}),(he=>{var me={name:"typescript:extends",scoped:!(he.transformES2015=function(x){var u,a,E,d,S,i,C=x.startLexicalEnvironment,l=x.resumeLexicalEnvironment,w=x.endLexicalEnvironment,y=x.hoistVariableDeclaration,o=x.getCompilerOptions(),I=x.getEmitResolver(),B=x.onSubstituteNode,s=x.onEmitNode;return x.onEmitNode=function(e,t,r){var n;1&i&&he.isFunctionLike(t)?(n=b(16286,8&he.getEmitFlags(t)?81:65),s(e,t,r),v(n,0,0)):s(e,t,r)},x.onSubstituteNode=function(e,t){if(t=B(e,t),1===e)return(e=>{switch(e.kind){case 71:return(e=>{if(2&i&&!he.isInternalName(e)){var t=I.getReferencedDeclarationWithCollidingName(e);if(t&&(!he.isClassLike(t)||!((e,t)=>{var r=he.getParseTreeNode(t);if(!(!r||r===e||r.end<=e.pos||r.pos>=e.end))for(var n=he.getEnclosingBlockScopeContainer(e);r;){if(r===n||r===e)return;if(he.isClassElement(r)&&r.parent===e)return 1;r=r.parent}})(t,e)))return he.setTextRange(he.getGeneratedNameForNode(he.getNameOfDeclaration(t)),e)}return e})(e);case 99:return(e=>1&i&&16&E?he.setTextRange(he.createIdentifier("_this"),e):e)(e)}return e})(t);if(he.isIdentifier(t))return(e=>{if(2&i&&!he.isInternalName(e)){var t=he.getParseTreeNode(e,he.isIdentifier);if(t&&(e=>{var t=e.parent;switch(t.kind){case 176:case 229:case 232:case 226:return t.name===e&&I.isDeclarationWithCollidingName(t)}})(t))return he.setTextRange(he.getGeneratedNameForNode(t),e)}return e})(t);return t},function(e){if(e.isDeclarationFile)return e;a=(u=e).text;e=(e=>{var t=b(3968,64),r=[],n=(C(),he.addStandardPrologue(r,e.statements,!1));return p(r,e),n=he.addCustomPrologue(r,e.statements,n,A),he.addRange(r,he.visitNodes(e.statements,A,he.isStatement,n)),d&&r.push(he.createVariableStatement(void 0,he.createVariableDeclarationList(d))),he.addRange(r,w()),v(t,0,0),he.updateSourceFileNode(e,he.setTextRange(he.createNodeArray(r),e.statements))})(e);return he.addEmitHelpers(e,x.readEmitHelpers()),u=void 0,a=void 0,d=void 0,E=0,e};function b(e,t){var r=E;return E=16383&(E&~e|t),r}function v(e,t,r){E=-16384&(E&~t|r)|e}function r(e){return 4096&E&&219===e.kind&&!e.expression}function $(e){return 0!=(128&e.transformFlags)||void 0!==S||4096&E&&(he.isStatement(e)||207===e.kind)||he.isIterationStatement(e,!1)&&ie(e)||0!=(33554432&he.getEmitFlags(e))}function A(e){if(!$(e))return e;var t=e;switch(t.kind){case 115:return;case 229:return(e=>{var t=he.createVariableDeclaration(he.getLocalName(e,!0),void 0,H(e)),r=(he.setOriginalNode(t,e),[]),t=he.createVariableStatement(void 0,he.createVariableDeclarationList([t])),n=(he.setOriginalNode(t,e),he.setTextRange(t,e),he.startOnNewLine(t),r.push(t),he.hasModifier(e,1)&&(n=he.hasModifier(e,512)?he.createExportDefault(he.getLocalName(e)):he.createExternalModuleExport(he.getLocalName(e)),he.setOriginalNode(n,t),r.push(n)),he.getEmitFlags(e));return 0==(4194304&n)&&(r.push(he.createEndOfDeclarationMarker(e)),he.setEmitFlags(t,4194304|n)),he.singleOrMany(r)})(t);case 199:return H(t);case 146:return(e=>{if(!e.dotDotDotToken)return he.isBindingPattern(e.name)?he.setOriginalNode(he.setTextRange(he.createParameter(void 0,void 0,void 0,he.getGeneratedNameForNode(e),void 0,void 0,void 0),e),e):e.initializer?he.setOriginalNode(he.setTextRange(he.createParameter(void 0,void 0,void 0,e.name,void 0,void 0,void 0),e),e):e})(t);case 228:return(e=>{var t=S,r=(S=void 0,b(16286,65)),n=he.visitParameterList(e.parameters,A,x),i=(64&e.transformFlags?f:W)(e),s=16384&E?he.getLocalName(e):e.name;return v(r,49152,0),S=t,he.updateFunctionDeclaration(e,void 0,he.visitNodes(e.modifiers,A,he.isModifier),e.asteriskToken,s,void 0,n,void 0,i)})(t);case 187:return(e=>{16384&e.transformFlags&&F();var t=S,r=(S=void 0,b(16256,66)),n=he.createFunctionExpression(void 0,void 0,void 0,void 0,he.visitParameterList(e.parameters,A,x),void 0,f(e));return he.setTextRange(n,e),he.setOriginalNode(n,e),he.setEmitFlags(n,8),v(r,0,0),S=t,n})(t);case 186:return(e=>{var t=262144&he.getEmitFlags(e)?b(16278,69):b(16286,65),r=S,n=(S=void 0,he.visitParameterList(e.parameters,A,x)),i=(64&e.transformFlags?f:W)(e),s=16384&E?he.getLocalName(e):e.name;return v(t,49152,0),S=r,he.updateFunctionExpression(e,void 0,e.asteriskToken,s,void 0,n,void 0,i)})(t);case 226:return k(t);case 71:return(e=>S&&!he.isGeneratedIdentifier(e)&&"arguments"===e.escapedText&&I.isArgumentsLocalBinding(e)?S.argumentsName||(S.argumentsName=he.createUniqueName("arguments")):e)(t);case 227:return(e=>{var t,r,n;return 64&e.transformFlags?(3&e.flags&&M(),n=he.flatMap(e.declarations,1&e.flags?J:k),t=he.createVariableDeclarationList(n),he.setOriginalNode(t,e),he.setTextRange(t,e),he.setCommentRange(t,e),8388608&e.transformFlags&&(he.isBindingPattern(e.declarations[0].name)||he.isBindingPattern(he.lastOrUndefined(e.declarations).name))&&(r=he.firstOrUndefined(n))&&(n=he.lastOrUndefined(n),he.setSourceMapRange(t,he.createRange(r.pos,n.end))),t):he.visitEachChild(e,A,x)})(t);case 221:return(e=>{var t;return void 0===S?he.visitEachChild(e,A,x):(t=S.allowedNonLabeledJumps,S.allowedNonLabeledJumps|=2,e=he.visitEachChild(e,A,x),S.allowedNonLabeledJumps=t,e)})(t);case 235:return(e=>{var t=b(4032,0),e=he.visitEachChild(e,A,x);return v(t,0,0),e})(t);case 207:return q(t,!1);case 218:case 217:return(e=>{if(S){var t=218===e.kind?2:4;if(!(e.label&&S.labels&&S.labels.get(he.idText(e.label))||!e.label&&S.allowedNonLabeledJumps&t)){t=void 0,t=(e.label?218===e.kind?(t="break-"+e.label.escapedText,R(S,!0,he.idText(e.label),t)):(t="continue-"+e.label.escapedText,R(S,!1,he.idText(e.label),t)):t=218===e.kind?(S.nonLocalJumps|=2,"break"):(S.nonLocalJumps|=4,"continue"),he.createLiteral(t));if(S.loopOutParameters.length){for(var r=S.loopOutParameters,n=void 0,i=0;i<r.length;i++){var s=se(r[i],1);n=0===i?s:he.createBinary(n,26,s)}t=he.createBinary(n,26,t)}return he.createReturn(t)}}return he.visitEachChild(e,A,x)})(t);case 222:return(e=>{S&&!S.labels&&(S.labels=he.createMap());var t=he.unwrapInnermostStatementOfLabel(e,S&&Y);if(!he.isIterationStatement(t,!1))return he.restoreEnclosingLabel(he.visitNode(t,A,he.isStatement),e,S&&D);var r=t,n=e;switch(r.kind){case 212:case 213:return X(r,n);case 214:return Z(r,n);case 215:return Q(r,n);case 216:return ee(r,n)}})(t);case 212:case 213:return X(t,void 0);case 214:return Z(t,void 0);case 215:return Q(t,void 0);case 216:return ee(t,void 0);case 210:return(e=>{switch(e.expression.kind){case 185:return he.updateStatement(e,n(e.expression,!1));case 194:return he.updateStatement(e,_(e.expression,!1))}return he.visitEachChild(e,A,x)})(t);case 178:return(e=>{for(var t=e.properties,r=t.length,n=r,i=r,s=0;s<r;s++){var a=t[s];if(16777216&a.transformFlags&&4&E&&s<i&&(i=s),144===a.name.kind){n=s;break}}if(n===r)return he.visitEachChild(e,A,x);i<n&&(n=i);for(var o=he.createTempVariable(y),l=[],c=he.createAssignment(o,he.setEmitFlags(he.createObjectLiteral(he.visitNodes(t,A,he.isObjectLiteralElementLike,0,n),e.multiLine),65536)),u=(e.multiLine&&(c.startsOnNewLine=!0),l.push(c),l),d=e,p=o,c=n,h=d.properties,m=h.length,g=c;g<m;g++){var f=h[g];switch(f.kind){case 153:case 154:var _=he.getAllAccessorDeclarations(d.properties,f);f===_.firstAccessor&&u.push(z(p,_,d,d.multiLine));break;case 151:u.push(((e,t,r,n)=>{var i=b(0,0),t=he.createAssignment(he.createMemberAccessForPropertyName(t,he.visitNode(e.name,A,he.isPropertyName)),T(e,e,void 0,r));return he.setTextRange(t,e),n&&(t.startsOnNewLine=!0),v(i,49152,49152&E?16384:0),t})(f,p,d,d.multiLine));break;case 261:u.push(((e,t,r)=>(t=he.createAssignment(he.createMemberAccessForPropertyName(t,he.visitNode(e.name,A,he.isPropertyName)),he.visitNode(e.initializer,A,he.isExpression)),he.setTextRange(t,e),r&&(t.startsOnNewLine=!0),t))(f,p,d.multiLine));break;case 262:u.push(((e,t,r)=>(t=he.createAssignment(he.createMemberAccessForPropertyName(t,he.visitNode(e.name,A,he.isPropertyName)),he.getSynthesizedClone(e.name)),he.setTextRange(t,e),r&&(t.startsOnNewLine=!0),t))(f,p,d.multiLine));break;default:he.Debug.failBadSyntaxKind(d)}}return l.push(e.multiLine?he.startOnNewLine(he.getMutableClone(o)):o),he.inlineExpressions(l)})(t);case 260:return(e=>{var t,r,n=b(4032,0);return he.Debug.assert(!!e.variableDeclaration,"Catch clause variable should always be present when downleveling ES2015."),t=he.isBindingPattern(e.variableDeclaration.name)?(r=he.createTempVariable(void 0),t=he.createVariableDeclaration(r),he.setTextRange(t,e.variableDeclaration),r=he.flattenDestructuringBinding(e.variableDeclaration,A,x,0,r),r=he.createVariableDeclarationList(r),he.setTextRange(r,e.variableDeclaration),r=he.createVariableStatement(void 0,r),he.updateCatchClause(e,t,((e,t)=>{var r=he.visitNodes(e.statements,A,he.isStatement);return he.updateBlock(e,[t].concat(r))})(e.block,r))):he.visitEachChild(e,A,x),v(n,0,0),t})(t);case 262:return(e=>he.setTextRange(he.createPropertyAssignment(e.name,he.getSynthesizedClone(e.name)),e))(t);case 144:return(e=>{var t=b(0,8192),e=he.visitEachChild(e,A,x);return v(t,49152,49152&E?32768:0),e})(t);case 177:return(e=>64&e.transformFlags?L(e.elements,!0,e.multiLine,e.elements.hasTrailingComma):he.visitEachChild(e,A,x))(t);case 181:return(e=>{if(33554432&he.getEmitFlags(e)){var t,r=e,n=he.cast(he.cast(he.skipOuterExpressions(r.expression),he.isArrowFunction).body,he.isBlock),i=he.visitNodes(n.statements,A,he.isStatement,0,1),n=he.visitNodes(n.statements,A,he.isStatement,1,n.statements.length-1),s=he.cast(he.firstOrUndefined(i),he.isVariableStatement).declarationList.declarations[0],a=he.skipOuterExpressions(s.initializer),o=he.tryCast(a,he.isAssignmentExpression),a=he.cast(o?he.skipOuterExpressions(o.right):a,he.isCallExpression),l=he.cast(he.skipOuterExpressions(a.expression),he.isFunctionExpression),c=l.body.statements,u=0,d=-1,p=[];for(o&&((t=he.tryCast(c[u],he.isExpressionStatement))&&(p.push(t),u++),p.push(c[u]),u++,p.push(he.createStatement(he.createAssignment(o.left,he.cast(s.name,he.isIdentifier)))));!he.isReturnStatement(he.elementAt(c,d));)d--;return he.addRange(p,c,u,d),d<-1&&he.addRange(p,c,d+1),he.addRange(p,n),he.addRange(p,i,1),he.recreateOuterExpressions(r.expression,he.recreateOuterExpressions(s.initializer,he.recreateOuterExpressions(o&&o.right,he.updateCall(a,he.recreateOuterExpressions(a.expression,he.updateFunctionExpression(l,void 0,void 0,void 0,void 0,l.parameters,void 0,he.updateBlock(l.body,p))),void 0,a.arguments))))}return 64&e.transformFlags?oe(e,!0):he.updateCall(e,he.visitNode(e.expression,h,he.isExpression),void 0,he.visitNodes(e.arguments,A,he.isExpression))})(t);case 182:return(e=>{var t,r;return 524288&e.transformFlags?(r=he.createCallBinding(he.createPropertyAccess(e.expression,"bind"),y),t=r.target,r=r.thisArg,he.createNew(he.createFunctionApply(he.visitNode(t,A,he.isExpression),r,L(he.createNodeArray([he.createVoidZero()].concat(e.arguments)),!1,!1,!1)),void 0,[])):he.visitEachChild(e,A,x)})(t);case 185:return n(t,!0);case 194:return _(t,!0);case 13:case 14:case 15:case 16:return(e=>he.setTextRange(he.createLiteral(e.text),e))(t);case 9:return(e=>e.hasExtendedUnicodeEscape?he.setTextRange(he.createLiteral(e.text),e):e)(t);case 8:return(e=>48&e.numericLiteralFlags?he.setTextRange(he.createNumericLiteral(e.text),e):e)(t);case 183:return(e=>{var t,r=he.visitNode(e.tag,A,he.isExpression),n=[void 0],i=[],s=[],e=e.template;if(he.isNoSubstitutionTemplateLiteral(e))i.push(he.createLiteral(e.text)),s.push(P(e));else{i.push(he.createLiteral(e.head.text)),s.push(P(e.head));for(var a=0,o=e.templateSpans;a<o.length;a++){var l=o[a];i.push(he.createLiteral(l.literal.text)),s.push(P(l.literal)),n.push(he.visitNode(l.expression,A,he.isExpression))}}{var c;(e=((e,t,r)=>(e.requestEmitHelper(ge),he.createCall(he.getHelperName("__makeTemplateObject"),void 0,[t,r])))(x,he.createArrayLiteral(i),he.createArrayLiteral(s)),he.isExternalModule(u))?(c=t=he.createUniqueName("templateObject"),d=he.append(d,he.createVariableDeclaration(t)),n[0]=he.createLogicalOr(t,he.createAssignment(t,e))):n[0]=e}return he.createCall(r,void 0,n)})(t);case 196:return(e=>{((e,t)=>{(e=>(he.Debug.assert(0!==e.templateSpans.length),0!==e.head.text.length||0===e.templateSpans[0].literal.text.length))(t)&&e.push(he.createLiteral(t.head.text))})(t=[],e),((e,t)=>{for(var r=0,n=t.templateSpans;r<n.length;r++){var i=n[r];e.push(he.visitNode(i.expression,A,he.isExpression)),0!==i.literal.text.length&&e.push(he.createLiteral(i.literal.text))}})(t,e);var t=he.reduceLeft(t,he.createAdd);return he.nodeIsSynthesized(t)&&(t.pos=e.pos,t.end=e.end),t})(t);case 197:return(e=>he.visitEachChild(e,A,x))(t);case 198:return(e=>he.visitNode(e.expression,A,he.isExpression))(t);case 97:return de(!1);case 99:return(e=>S?2&E?(S.containsLexicalThis=!0,e):S.thisName||(S.thisName=he.createUniqueName("this")):e)(t);case 204:return(e=>94!==e.keywordToken||"target"!==e.name.escapedText?e:(E|=8192&E?32768:16384,he.createIdentifier("_newTarget")))(t);case 151:return(e=>{he.Debug.assert(!he.isComputedPropertyName(e.name));var t=T(e,he.moveRangePos(e,-1),void 0,void 0);return he.setEmitFlags(t,512|he.getEmitFlags(t)),he.setTextRange(he.createPropertyAssignment(e.name,t),e)})(t);case 153:case 154:return(e=>{he.Debug.assert(!he.isComputedPropertyName(e.name));var t,r,n=S,i=(S=void 0,b(16286,65));return t=32768&e.transformFlags?(t=he.visitParameterList(e.parameters,A,x),r=f(e),153===e.kind?he.updateGetAccessor(e,e.decorators,e.modifiers,e.name,t,e.type,r):he.updateSetAccessor(e,e.decorators,e.modifiers,e.name,t,r)):he.visitEachChild(e,A,x),v(i,49152,0),S=n,t})(t);case 208:return(e=>{var t,r=b(0,he.hasModifier(e,1)?32:0);if(S&&0==(3&e.declarationList.flags)){for(var n=void 0,i=0,s=e.declarationList.declarations;i<s.length;i++){var a,o=s[i];((s,e)=>{s.hoistedLocalVariables||(s.hoistedLocalVariables=[]),function e(t){if(71===t.kind)s.hoistedLocalVariables.push(t);else for(var r=0,n=t.elements;r<n.length;r++){var i=n[r];he.isOmittedExpression(i)||e(i.name)}}(e.name)})(S,o),o.initializer&&(a=void 0,he.isBindingPattern(o.name)?a=he.flattenDestructuringAssignment(o,A,x,0):(a=he.createBinary(o.name,58,he.visitNode(o.initializer,A,he.isExpression)),he.setTextRange(a,o)),n=he.append(n,a))}t=n?he.setTextRange(he.createStatement(he.inlineExpressions(n)),e):void 0}else t=he.visitEachChild(e,A,x);return v(r,0,0),t})(t);case 219:return(e=>S?(S.nonLocalJumps|=8,r(e)&&(e=V(e)),he.createReturn(he.createObjectLiteral([he.createPropertyAssignment(he.createIdentifier("value"),e.expression?he.visitNode(e.expression,A,he.isExpression):he.createVoidZero())]))):r(e)?V(e):he.visitEachChild(e,A,x))(t);default:return he.visitEachChild(t,A,x)}}function U(e){return $(e)?q(e,!0):e}function h(e){return 97===e.kind?de(!0):A(e)}function V(e){return he.setOriginalNode(he.createReturn(he.createIdentifier("_this")),e)}function H(e){e.name&&M();var t=he.getClassExtendsHeritageClauseElement(e),r=he.createFunctionExpression(void 0,void 0,void 0,void 0,t?[he.createParameter(void 0,void 0,void 0,"_super")]:[],void 0,(i=e,s=t,n=[],C(),((e,t,r)=>{r&&e.push(he.setTextRange(he.createStatement(((e,t)=>(e.requestEmitHelper(me),he.createCall(he.getHelperName("__extends"),void 0,[t,he.createIdentifier("_super")])))(x,he.getLocalName(t))),r))})(n,i,s),((e,t,r)=>{var n=S,i=(S=void 0,b(16278,73)),s=he.getFirstConstructorWithBody(t),a=((e,t)=>!(!e||!t)&&!he.some(e.parameters)&&!(!(t=he.firstOrUndefined(e.body.statements))||!he.nodeIsSynthesized(t)||210!==t.kind)&&(e=t.expression,!(!he.nodeIsSynthesized(e)||181!==e.kind))&&(t=e.expression,!(!he.nodeIsSynthesized(t)||97!==t.kind))&&!(!(t=he.singleOrUndefined(e.arguments))||!he.nodeIsSynthesized(t)||198!==t.kind)&&(e=t.expression,he.isIdentifier(e))&&"arguments"===e.escapedText)(s,void 0!==r),a=he.createFunctionDeclaration(void 0,void 0,void 0,he.getInternalName(t),void 0,((e,t)=>he.visitParameterList(e&&!t&&e.parameters,A,x)||[])(s,a),void 0,((e,t,r,n)=>{var i=[],s=(l(),-1);return n?s=0:e&&(s=he.addStandardPrologue(i,e.body.statements,!1)),e&&(j(i,e),K(i,e,n),n||(s=he.addCustomPrologue(i,e.body.statements,s,A)),he.Debug.assert(0<=s,"statementOffset not initialized correctly!")),r=r&&95!==he.skipOuterExpressions(r.expression).kind,1!==(n=((e,t,r,n,i)=>{if(r){if(!t)return e.push(he.createReturn(G())),2;if(n)return m(e,t,G()),F(),1;var s,a,r=t.body.statements;if((a=i<r.length&&210===(s=r[i]).kind&&he.isSuperCall(s.expression)?(e=>oe(e,!1))(s.expression):a)&&i===r.length-1&&!(49152&t.transformFlags))return n=he.createReturn(a),194===a.kind&&181===a.left.kind||he.Debug.fail("Assumed generated super call would have form 'super.call(...) || this'."),he.setCommentRange(n,he.getCommentRange(he.setEmitFlags(a.left,1536))),e.push(n),2;if(m(e,t,a||c(),s),a)return 1}else t&&p(e,t);return 0})(i,e,r,n,s))&&2!==n||s++,e&&(1===n&&(E|=4096),he.addRange(i,he.visitNodes(e.body.statements,A,he.isStatement,s))),!r||2===n||e&&function e(t){{if(219===t.kind)return!0;if(211===t.kind){var r=t;if(r.elseStatement)return e(r.thenStatement)&&e(r.elseStatement)}else if(207===t.kind){r=he.lastOrUndefined(t.statements);if(r&&e(r))return!0}}return!1}(e.body)||i.push(he.createReturn(he.createIdentifier("_this"))),he.addRange(i,w()),e&&g(i,e,!1),s=he.createBlock(he.setTextRange(he.createNodeArray(i),e?e.body.statements:t.members),!0),he.setTextRange(s,e?e.body:t),e||he.setEmitFlags(s,1536),s})(s,t,r,a));he.setTextRange(a,s||t),r&&he.setEmitFlags(a,8),e.push(a),v(i,49152,0),S=n})(n,i,s),((e,t)=>{for(var r=0,n=t.members;r<n.length;r++){var i=n[r];switch(i.kind){case 206:e.push((e=>he.setTextRange(he.createEmptyStatement(),e))(i));break;case 151:e.push(((e,t,r)=>{var n=b(0,0),i=he.getCommentRange(t),s=he.getSourceMapRange(t),e=he.createMemberAccessForPropertyName(e,he.visitNode(t.name,A,he.isPropertyName),t.name),r=T(t,t,void 0,r),s=(he.setEmitFlags(r,1536),he.setSourceMapRange(r,s),he.setTextRange(he.createStatement(he.createAssignment(e,r)),t));return he.setOriginalNode(s,t),he.setCommentRange(s,i),he.setEmitFlags(s,48),v(n,49152,49152&E?16384:0),s})(pe(t,i),i,t));break;case 153:case 154:var s=he.getAllAccessorDeclarations(t.members,i);i===s.firstAccessor&&e.push(((e,t,r)=>(e=he.createStatement(z(e,t,r,!1)),he.setEmitFlags(e,1536),he.setSourceMapRange(e,he.getSourceMapRange(t.firstAccessor)),e))(pe(t,i),s,t));break;case 152:break;default:he.Debug.failBadSyntaxKind(t)}}})(n,i),s=he.createTokenRange(he.skipTrivia(a,i.members.end),18),r=he.getInternalName(i),(r=he.createPartiallyEmittedExpression(r)).end=s.end,he.setEmitFlags(r,1536),(r=he.createReturn(r)).pos=s.pos,he.setEmitFlags(r,1920),n.push(r),he.addRange(n,w()),s=he.createBlock(he.setTextRange(he.createNodeArray(n),i.members),!0),he.setEmitFlags(s,1536),s)),n=(65536&he.getEmitFlags(e)&&he.setEmitFlags(r,65536),he.createPartiallyEmittedExpression(r)),i=(n.end=e.end,he.setEmitFlags(n,1536),he.createPartiallyEmittedExpression(n)),s=(i.end=he.skipTrivia(a,e.pos),he.setEmitFlags(i,1536),he.createParen(he.createCall(i,void 0,t?[he.visitNode(t.expression,A,he.isExpression)]:[])));return he.addSyntheticLeadingComment(s,3,"* @class "),s}function c(){return he.setEmitFlags(he.createThis(),4)}function G(){return he.createLogicalOr(he.createLogicalAnd(he.createStrictInequality(he.createIdentifier("_super"),he.createNull()),he.createFunctionApply(he.createIdentifier("_super"),c(),he.createIdentifier("arguments"))),c())}function j(e,t){if(0!=(131072&t.transformFlags))for(var r,n=0,i=t.parameters;n<i.length;n++){var s,a,o,l,c=i[n],u=c.name,d=c.initializer;c.dotDotDotToken||(he.isBindingPattern(u)?(o=e,a=c,s=u,r=d,l=void 0,l=he.getGeneratedNameForNode(a),0<s.elements.length?o.push(he.setEmitFlags(he.createVariableStatement(void 0,he.createVariableDeclarationList(he.flattenDestructuringBinding(a,A,x,0,l))),1048576)):r&&o.push(he.setEmitFlags(he.createStatement(he.createAssignment(l,he.visitNode(r,A,he.isExpression))),1048576))):d&&(l=o=a=s=void 0,s=e,a=c,o=u,l=d,l=he.visitNode(l,A,he.isExpression),(o=he.createIf(he.createTypeCheck(he.getSynthesizedClone(o),"undefined"),he.setEmitFlags(he.setTextRange(he.createBlock([he.createStatement(he.setTextRange(he.createAssignment(he.setEmitFlags(he.getMutableClone(o),48),he.setEmitFlags(l,48|he.getEmitFlags(l))),a))]),a),417))).startsOnNewLine=!0,he.setTextRange(o,a),he.setEmitFlags(o,1048992),s.push(o)))}}function K(e,t,r){var n,i,s=he.lastOrUndefined(t.parameters);r=r,(i=s)&&i.dotDotDotToken&&71===i.name.kind&&!r&&(i=he.getMutableClone(s.name),he.setEmitFlags(i,48),r=he.getSynthesizedClone(s.name),t=t.parameters.length-1,n=he.createLoopVariable(),e.push(he.setEmitFlags(he.setTextRange(he.createVariableStatement(void 0,he.createVariableDeclarationList([he.createVariableDeclaration(i,void 0,he.createArrayLiteral([]))])),s),1048576)),i=he.createFor(he.setTextRange(he.createVariableDeclarationList([he.createVariableDeclaration(n,void 0,he.createLiteral(t))]),s),he.setTextRange(he.createLessThan(n,he.createPropertyAccess(he.createIdentifier("arguments"),"length")),s),he.setTextRange(he.createPostfixIncrement(n),s),he.createBlock([he.startOnNewLine(he.setTextRange(he.createStatement(he.createAssignment(he.createElementAccess(r,0==t?n:he.createSubtract(n,he.createLiteral(t))),he.createElementAccess(he.createIdentifier("arguments"),n))),s))])),he.setEmitFlags(i,1048576),he.startOnNewLine(i),e.push(i))}function p(e,t){32768&t.transformFlags&&187!==t.kind&&m(e,t,he.createThis())}function m(e,t,r,n){F();r=he.createVariableStatement(void 0,he.createVariableDeclarationList([he.createVariableDeclaration("_this",void 0,r)]));he.setEmitFlags(r,1050112),he.setTextRange(r,n),he.setSourceMapRange(r,t),e.push(r)}function g(e,t,r){if(16384&E){var n=void 0;switch(t.kind){case 187:return e;case 151:case 153:case 154:n=he.createVoidZero();break;case 152:n=he.createPropertyAccess(he.setEmitFlags(he.createThis(),4),"constructor");break;case 228:case 186:n=he.createConditional(he.createLogicalAnd(he.setEmitFlags(he.createThis(),4),he.createBinary(he.setEmitFlags(he.createThis(),4),93,he.getLocalName(t))),he.createPropertyAccess(he.setEmitFlags(he.createThis(),4),"constructor"),he.createVoidZero());break;default:he.Debug.failBadSyntaxKind(t)}var i=he.createVariableStatement(void 0,he.createVariableDeclarationList([he.createVariableDeclaration("_newTarget",void 0,n)]));if(r)return[i].concat(e);e.unshift(i)}return e}function z(e,t,r,n){var i,s=t.firstAccessor,a=t.getAccessor,t=t.setAccessor,o=b(0,0),e=he.getMutableClone(e),l=(he.setEmitFlags(e,1568),he.setSourceMapRange(e,s.name),he.createExpressionForPropertyName(he.visitNode(s.name,A,he.isPropertyName))),s=(he.setEmitFlags(l,1552),he.setSourceMapRange(l,s.name),[]),r=(a&&(i=T(a,void 0,void 0,r),he.setSourceMapRange(i,he.getSourceMapRange(a)),he.setEmitFlags(i,512),i=he.createPropertyAssignment("get",i),he.setCommentRange(i,he.getCommentRange(a)),s.push(i)),t&&(a=T(t,void 0,void 0,r),he.setSourceMapRange(a,he.getSourceMapRange(t)),he.setEmitFlags(a,512),i=he.createPropertyAssignment("set",a),he.setCommentRange(i,he.getCommentRange(t)),s.push(i)),s.push(he.createPropertyAssignment("enumerable",he.createTrue()),he.createPropertyAssignment("configurable",he.createTrue())),he.createCall(he.createPropertyAccess(he.createIdentifier("Object"),"defineProperty"),void 0,[e,l,he.createObjectLiteral(s,!0)]));return n&&(r.startsOnNewLine=!0),v(o,49152,49152&E?16384:0),r}function T(e,t,r,n){var i=S,n=(S=void 0,n&&he.isClassLike(n)&&!he.hasModifier(e,32)?b(16286,73):b(16286,65)),s=he.visitParameterList(e.parameters,A,x),a=f(e);return 16384&E&&!r&&(228===e.kind||186===e.kind)&&(r=he.getGeneratedNameForNode(e)),v(n,49152,0),S=i,he.setOriginalNode(he.setTextRange(he.createFunctionExpression(void 0,e.asteriskToken,r,void 0,s,void 0,a),t),e)}function f(e){var t,r,n=!1,i=!1,s=[],a=e.body,o=(l(),he.isBlock(a)&&(o=he.addStandardPrologue(s,a.statements,!1)),p(s,e),j(s,e),K(s,e,!1),!n&&0<s.length&&(n=!0),he.isBlock(a)?(o=he.addCustomPrologue(s,a.statements,o,A),r=a.statements,he.addRange(s,he.visitNodes(a.statements,A,he.isStatement,o)),!n&&a.multiLine&&(n=!0)):(he.Debug.assert(187===e.kind),r=he.moveRangeEnd(a,-1),o=e.equalsGreaterThanToken,he.nodeIsSynthesized(o)||he.nodeIsSynthesized(a)||(he.rangeEndIsOnSameLineAsRangeStart(o,a,u)?i=!0:n=!0),o=he.visitNode(a,A,he.isExpression),o=he.createReturn(o),he.setTextRange(o,a),he.setEmitFlags(o,1440),s.push(o),t=a),x.endLexicalEnvironment()),a=(he.addRange(s,o),g(s,e,!1),!n&&o&&o.length&&(n=!0),he.createBlock(he.setTextRange(he.createNodeArray(s),r),n));return he.setTextRange(a,e.body),!n&&i&&he.setEmitFlags(a,1),t&&he.setTokenSourceMapRange(a,18,t),he.setOriginalNode(a,e.body),a}function W(e){var t=he.visitFunctionBody(e.body,U,x);return he.updateBlock(t,he.setTextRange(he.createNodeArray(g(t.statements,e,!0)),t.statements))}function q(e,t){return t?he.visitEachChild(e,A,x):(t=256&E?b(4032,512):b(3904,128),e=he.visitEachChild(e,A,x),v(t,0,0),e)}function n(e,t){if(!t)switch(e.expression.kind){case 185:return he.updateParen(e,n(e.expression,!1));case 194:return he.updateParen(e,_(e.expression,!1))}return he.visitEachChild(e,A,x)}function _(e,t){return he.isDestructuringAssignment(e)?he.flattenDestructuringAssignment(e,A,x,0,t):he.visitEachChild(e,A,x)}function J(e){var t,r,n=e.name;return he.isBindingPattern(n)?k(e):e.initializer||(n=e,t=131072&(r=I.getNodeCheckFlags(n)),r&=262144,0!=(64&E))||t&&r&&0!=(512&E)||0!=(2048&E)||I.isDeclarationWithCollidingName(n)&&(!r||t||0!=(3072&E))?he.visitEachChild(e,A,x):((n=he.getMutableClone(e)).initializer=he.createVoidZero(),n)}function k(e){var t=b(32,0),e=he.isBindingPattern(e.name)?he.flattenDestructuringBinding(e,A,x,0,void 0,0!=(32&t)):he.visitEachChild(e,A,x);return v(t,0,0),e}function Y(e){S.labels.set(he.idText(e.label),!0)}function D(e){S.labels.set(he.idText(e.label),!1)}function N(e,t,r,n,i){e=b(e,t),t=((e,t,r)=>{if(!ie(e))return i=void 0,S&&(i=S.allowedNonLabeledJumps,S.allowedNonLabeledJumps=6),u=r?r(e,t,void 0):he.restoreEnclosingLabel(he.visitEachChild(e,A,x),t,S&&D),S&&(S.allowedNonLabeledJumps=i),u;var n,i=he.createUniqueName("_loop");switch(e.kind){case 214:case 215:case 216:var s=e.initializer;s&&227===s.kind&&(n=s)}var a=[],o=[];if(n&&3&he.getCombinedNodeFlags(n))for(var l=0,c=n.declarations;l<c.length;l++)!function e(t,r,n){var i=t.name;if(he.isBindingPattern(i))for(var s=0,a=i.elements;s<a.length;s++){var o=a[s];he.isOmittedExpression(o)||e(o,r,n)}else r.push(he.createParameter(void 0,void 0,void 0,i)),2097152&I.getNodeCheckFlags(t)&&(t=he.createUniqueName("out_"+he.idText(i)),n.push({originalName:i,outParamName:t}))}(c[l],a,o);var u=S,d=(S={loopOutParameters:o},u&&(u.argumentsName&&(S.argumentsName=u.argumentsName),u.thisName&&(S.thisName=u.thisName),u.hoistedLocalVariables)&&(S.hoistedLocalVariables=u.hoistedLocalVariables),C(),he.visitNode(e.statement,A,he.isStatement,he.liftToBlock)),p=w(),h=S;S=u,(o.length||p)&&(m=he.isBlock(d)?d.statements.slice():[d],o.length&&O(o,1,m),he.addRange(m,p),d=he.createBlock(m,!0)),he.isBlock(d)?d.multiLine=!0:d=he.createBlock([d],!0);var m=(p=0!=(16777216&e.statement.transformFlags))&&0!=(4&E),g=0;h.containsLexicalThis&&(g|=8),m&&(g|=262144);var f,m=[he.createVariableStatement(void 0,he.setEmitFlags(he.createVariableDeclarationList([he.createVariableDeclaration(i,void 0,he.setEmitFlags(he.createFunctionExpression(void 0,p?he.createToken(39):void 0,void 0,void 0,a,void 0,d),g))]),2097152))];if(h.argumentsName&&(u?u.argumentsName=h.argumentsName:(f=f||[]).push(he.createVariableDeclaration(h.argumentsName,void 0,he.createIdentifier("arguments")))),h.thisName&&(u?u.thisName=h.thisName:(f=f||[]).push(he.createVariableDeclaration(h.thisName,void 0,he.createIdentifier("this")))),h.hoistedLocalVariables)if(u)u.hoistedLocalVariables=h.hoistedLocalVariables;else{f=f||[];for(var _=0,y=h.hoistedLocalVariables;_<y.length;_++){var b=y[_];f.push(he.createVariableDeclaration(b))}}if(o.length){f=f||[];for(var v=0,T=o;v<T.length;v++){var k=T[v];f.push(he.createVariableDeclaration(k.outParamName))}}return f&&m.push(he.createVariableStatement(void 0,he.createVariableDeclarationList(f))),d=((e,t,r,n)=>{var i=S,s=[],a=!(-5&r.nonLocalJumps||r.labeledNonLocalBreaks||r.labeledNonLocalContinues),e=he.createCall(e,void 0,he.map(t,function(e){return e.name})),t=n?he.createYield(he.createToken(39),he.setEmitFlags(e,8388608)):e;return a?(s.push(he.createStatement(t)),O(r.loopOutParameters,0,s)):(n=he.createUniqueName("state"),e=he.createVariableStatement(void 0,he.createVariableDeclarationList([he.createVariableDeclaration(n,void 0,t)])),s.push(e),O(r.loopOutParameters,0,s),8&r.nonLocalJumps&&(a=void 0,a=i?(i.nonLocalJumps|=8,he.createReturn(n)):he.createReturn(he.createPropertyAccess(n,"value")),s.push(he.createIf(he.createBinary(he.createTypeOf(n),34,he.createLiteral("object")),a))),2&r.nonLocalJumps&&s.push(he.createIf(he.createBinary(n,34,he.createLiteral("break")),he.createBreak())),(r.labeledNonLocalBreaks||r.labeledNonLocalContinues)&&(t=[],ae(r.labeledNonLocalBreaks,!0,n,i,t),ae(r.labeledNonLocalContinues,!1,n,i,t),s.push(he.createSwitch(n,he.createCaseBlock(t))))),s})(i,a,h,p),u=r?r(e,t,d):((g=he.getMutableClone(e)).statement=void 0,(g=he.visitEachChild(g,A,x)).statement=he.createBlock(d,!0),g.transformFlags=0,he.aggregateTransformFlags(g),he.restoreEnclosingLabel(g,t,S&&D)),m.push(u),m})(r,n,i);return v(e,0,0),t}function X(e,t){return N(0,256,e,t)}function Z(e,t){return N(3008,1280,e,t)}function Q(e,t){return N(1984,2304,e,t)}function ee(e,t){return N(1984,2304,e,t,o.downlevelIteration?ne:re)}function te(e,t,r){var n,i,s,a,o,l,c=[];return he.isVariableDeclarationList(e.initializer)?(3&e.initializer.flags&&M(),(n=he.firstOrUndefined(e.initializer.declarations))&&he.isBindingPattern(n.name)?(l=he.flattenDestructuringBinding(n,A,x,0,t),i=he.setTextRange(he.createVariableDeclarationList(l),e.initializer),he.setOriginalNode(i,e.initializer),s=l[0],l=he.lastOrUndefined(l),he.setSourceMapRange(i,he.createRange(s.pos,l.end)),c.push(he.createVariableStatement(void 0,i))):c.push(he.setTextRange(he.createVariableStatement(void 0,he.setOriginalNode(he.setTextRange(he.createVariableDeclarationList([he.createVariableDeclaration(n?n.name:he.createTempVariable(void 0),void 0,t)]),he.moveRangePos(e.initializer,-1)),e.initializer)),he.moveRangeEnd(e.initializer,-1)))):(s=he.createAssignment(e.initializer,t),he.isDestructuringAssignment(s)?(he.aggregateTransformFlags(s),c.push(he.createStatement(_(s,!1)))):(s.end=e.initializer.end,c.push(he.setTextRange(he.createStatement(he.visitNode(s,A,he.isExpression)),he.moveRangeEnd(e.initializer,-1))))),r?he.addRange(c,r):(l=he.visitNode(e.statement,A,he.isStatement,he.liftToBlock),he.isBlock(l)?(he.addRange(c,l.statements),o=(a=l).statements):c.push(l)),he.setEmitFlags(he.setTextRange(he.createBlock(he.setTextRange(he.createNodeArray(c),o),!0),a),432)}function re(e,t,r){var n=he.visitNode(e.expression,A,he.isExpression),i=he.createLoopVariable(),s=he.isIdentifier(n)?he.getGeneratedNameForNode(n):he.createTempVariable(void 0),n=(he.setEmitFlags(n,48|he.getEmitFlags(n)),he.setTextRange(he.createFor(he.setEmitFlags(he.setTextRange(he.createVariableDeclarationList([he.setTextRange(he.createVariableDeclaration(i,void 0,he.createLiteral(0)),he.moveRangePos(e.expression,-1)),he.setTextRange(he.createVariableDeclaration(s,void 0,n),e.expression)]),e.expression),2097152),he.setTextRange(he.createLessThan(i,he.createPropertyAccess(s,"length")),e.expression),he.setTextRange(he.createPostfixIncrement(i),e.expression),te(e,he.createElementAccess(s,i),r)),e));return he.setEmitFlags(n,256),he.setTextRange(n,e),he.restoreEnclosingLabel(n,t,S&&D)}function ne(e,t,r){var n=he.visitNode(e.expression,A,he.isExpression),i=he.isIdentifier(n)?he.getGeneratedNameForNode(n):he.createTempVariable(void 0),s=he.isIdentifier(n)?he.getGeneratedNameForNode(i):he.createTempVariable(void 0),a=he.createUniqueName("e"),o=he.getGeneratedNameForNode(a),l=he.createTempVariable(void 0),n=he.createValuesHelper(x,n,e.expression),c=he.createCall(he.createPropertyAccess(i,"next"),void 0,[]),n=(y(a),y(l),he.setEmitFlags(he.setTextRange(he.createFor(he.setEmitFlags(he.setTextRange(he.createVariableDeclarationList([he.setTextRange(he.createVariableDeclaration(i,void 0,n),e.expression),he.createVariableDeclaration(s,void 0,c)]),e.expression),2097152),he.createLogicalNot(he.createPropertyAccess(s,"done")),he.createAssignment(s,c),te(e,he.createPropertyAccess(s,"value"),r)),e),256));return he.createTry(he.createBlock([he.restoreEnclosingLabel(n,t,S&&D)]),he.createCatchClause(he.createVariableDeclaration(o),he.setEmitFlags(he.createBlock([he.createStatement(he.createAssignment(a,he.createObjectLiteral([he.createPropertyAssignment("error",o)])))]),1)),he.createBlock([he.createTry(he.createBlock([he.setEmitFlags(he.createIf(he.createLogicalAnd(he.createLogicalAnd(s,he.createLogicalNot(he.createPropertyAccess(s,"done"))),he.createAssignment(l,he.createPropertyAccess(i,"return"))),he.createStatement(he.createFunctionCall(l,i,[]))),1)]),void 0,he.setEmitFlags(he.createBlock([he.setEmitFlags(he.createIf(a,he.createThrow(he.createPropertyAccess(a,"error"))),1)]),1))]))}function ie(e){return 0!=(65536&I.getNodeCheckFlags(e))}function se(e,t){var r=0===t?e.outParamName:e.originalName,t=0===t?e.originalName:e.outParamName;return he.createBinary(t,58,r)}function O(e,t,r){for(var n=0,i=e;n<i.length;n++){var s=i[n];r.push(he.createStatement(se(s,t)))}}function R(e,t,r,n){(t?(e.labeledNonLocalBreaks||(e.labeledNonLocalBreaks=he.createMap()),e.labeledNonLocalBreaks):(e.labeledNonLocalContinues||(e.labeledNonLocalContinues=he.createMap()),e.labeledNonLocalContinues)).set(r,n)}function ae(e,i,s,a,o){e&&e.forEach(function(e,t){var r,n=[];!a||a.labels&&a.labels.get(t)?(r=he.createIdentifier(t),n.push(i?he.createBreak(r):he.createContinue(r))):(R(a,i,t,e),n.push(he.createReturn(s))),o.push(he.createCaseClause(he.createLiteral(e),n))})}function oe(e,t){var r=he.createCallBinding(e.expression,y),n=r.target,r=r.thisArg;return 97===e.expression.kind&&he.setEmitFlags(r,4),n=524288&e.transformFlags?he.createFunctionApply(he.visitNode(n,h,he.isExpression),he.visitNode(r,A,he.isExpression),L(e.arguments,!1,!1,!1)):he.createFunctionCall(he.visitNode(n,h,he.isExpression),he.visitNode(r,A,he.isExpression),he.visitNodes(e.arguments,A,he.isExpression),e),97===e.expression.kind&&(r=he.createThis(),he.setEmitFlags(r,4),r=he.createLogicalOr(n,r),n=t?he.createAssignment(he.createIdentifier("_this"),r):r),he.setOriginalNode(n,e)}function L(e,t,i,s){var a=e.length,r=he.flatten(he.spanMap(e,le,function(e,t,r,n){return t(e,i,s&&n===a)}));if(o.downlevelIteration){if(1===r.length){var n=r[0];if(he.isCallExpression(n)&&he.isIdentifier(n.expression)&&4096&he.getEmitFlags(n.expression)&&"___spread"===n.expression.escapedText)return r[0]}return he.createSpreadHelper(x,r)}return 1===r.length?(n=e[0],t&&he.isSpreadElement(n)&&177!==n.expression.kind?he.createArraySlice(r[0]):r[0]):he.createArrayConcat(r.shift(),r)}function le(e){return he.isSpreadElement(e)?t:ce}function t(e){return he.map(e,ue)}function ce(e,t,r){return he.createArrayLiteral(he.visitNodes(he.createNodeArray(e,r),A,he.isExpression),t)}function ue(e){return he.visitNode(e.expression,A,he.isExpression)}function P(e){var t=he.getSourceTextOfNodeFromSourceFile(u,e),r=13===e.kind||16===e.kind;return t=(t=t.substring(1,t.length-(r?1:2))).replace(/\r\n?/g,"\n"),he.setTextRange(he.createLiteral(t),e)}function de(e){return 8&E&&!e?he.createPropertyAccess(he.createIdentifier("_super"),"prototype"):he.createIdentifier("_super")}function M(){0==(2&i)&&(i|=2,x.enableSubstitution(71))}function F(){0==(1&i)&&(i|=1,x.enableSubstitution(99),x.enableEmitNotification(152),x.enableEmitNotification(151),x.enableEmitNotification(153),x.enableEmitNotification(154),x.enableEmitNotification(187),x.enableEmitNotification(186),x.enableEmitNotification(228))}function pe(e,t){return he.hasModifier(t,32)?he.getInternalName(e):he.createPropertyAccess(he.getInternalName(e),"prototype")}}),priority:0,text:"\n            var __extends = (this && this.__extends) || (function () {\n                var extendStatics = Object.setPrototypeOf ||\n                    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n                    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n                return function (d, b) {\n                    extendStatics(d, b);\n                    function __() { this.constructor = d; }\n                    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n                };\n            })();"},ge={name:"typescript:makeTemplateObject",scoped:!1,priority:0,text:'\n            var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {\n                if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }\n                return cooked;\n            };'}})(ts=ts||{}),(a=>{a.transformES5=function(e){var i,s,t=e.getCompilerOptions(),r=(1!==t.jsx&&3!==t.jsx||(i=e.onEmitNode,e.onEmitNode=function(e,t,r){switch(t.kind){case 251:case 252:case 250:var n=t.tagName;s[a.getOriginalNodeId(n)]=!0}i(e,t,r)},e.enableEmitNotification(251),e.enableEmitNotification(252),e.enableEmitNotification(250),s=[]),e.onSubstituteNode);return e.onSubstituteNode=function(e,t){if(t.id&&s&&s[t.id])return r(e,t);{if(t=r(e,t),a.isPropertyAccessExpression(t))return(e=>{var t=n(e.name);return t?a.setTextRange(a.createElementAccess(e.expression,t),e):e})(t);if(a.isPropertyAssignment(t))return(e=>{var t=a.isIdentifier(e.name)&&n(e.name);return t?a.updatePropertyAssignment(e,t,e.initializer):e})(t)}return t},e.enableSubstitution(179),e.enableSubstitution(261),function(e){return e};function n(e){var t=e.originalKeywordKind||(a.nodeIsSynthesized(e)?a.stringToToken(a.idText(e)):void 0);if(72<=t&&t<=107)return a.setTextRange(a.createLiteral(e),e)}}})(ts=ts||{}),(Ae=>{var De={name:"typescript:generator",scoped:!(Ae.transformGenerators=function(v){var d,p,T,k,f,_,y,b,x,E,S,J,Y,C,w,I,X,A,D,Z,N,O,Q=v.resumeLexicalEnvironment,ee=v.endLexicalEnvironment,n=v.hoistFunctionDeclaration,R=v.hoistVariableDeclaration,e=v.getCompilerOptions(),te=Ae.getEmitScriptTarget(e),i=v.getEmitResolver(),s=v.onSubstituteNode,re=(v.onSubstituteNode=function(e,t){if(t=s(e,t),1!==e)return t;e=t;if(Ae.isIdentifier(e)){t=e;if(!Ae.isGeneratedIdentifier(t)&&d&&d.has(Ae.idText(t))){var r=Ae.getOriginalNode(t);if(Ae.isIdentifier(r)&&r.parent){r=i.getReferencedValueDeclaration(r);if(r){var r=p[Ae.getOriginalNodeId(r)];if(r)return r=Ae.getMutableClone(r),Ae.setSourceMapRange(r,t),Ae.setCommentRange(r,t),r}}}return t}return e},1),ne=0,L=0;return function(e){if(e.isDeclarationFile||0==(512&e.transformFlags))return e;e=Ae.visitEachChild(e,P,v);return Ae.addEmitHelpers(e,v.readEmitHelpers()),e};function P(e){var t=e.transformFlags;if(k){var r=e;switch(r.kind){case 212:return(e=>k?(de(),e=Ae.visitEachChild(e,P,v),V(),e):Ae.visitEachChild(e,P,v))(r);case 213:return(e=>k?(de(),e=Ae.visitEachChild(e,P,v),V(),e):Ae.visitEachChild(e,P,v))(r);case 221:return(e=>(k&&h({kind:2,isScript:!0,breakLabel:-1}),e=Ae.visitEachChild(e,P,v),k&&he(),e))(r);case 222:return(e=>{{var t;k&&h({kind:4,isScript:!0,labelText:Ae.idText(e.label),breakLabel:-1})}return e=Ae.visitEachChild(e,P,v),k&&me(),e})(r);default:return a(r)}}else{if(T)return a(e);if(!(256&t))return 512&t?Ae.visitEachChild(e,P,v):e;var n=e;switch(n.kind){case 228:return ie(n);case 186:return se(n);default:return Ae.Debug.failBadSyntaxKind(n),Ae.visitEachChild(n,P,v)}}}function a(e){switch(e.kind){case 228:return ie(e);case 186:return se(e);case 153:case 154:return i=e,y=T,b=k,k=T=!1,i=Ae.visitEachChild(e,P,v),T=y,k=b,i;case 208:y=e;if(16777216&y.transformFlags)return void le(y.declarationList);if(1048576&Ae.getEmitFlags(y))return y;for(var t=0,r=y.declarationList.declarations;t<r.length;t++){var n=r[t];R(n.name)}b=Ae.getInitializedVariables(y.declarationList);return 0!==b.length?Ae.setSourceMapRange(Ae.createStatement(Ae.inlineExpressions(Ae.map(b,ce))),y):void 0;case 214:var i=e,s=(k&&de(),i.initializer);if(s&&Ae.isVariableDeclarationList(s)){for(var a=0,o=s.declarations;a<o.length;a++){var l=o[a];R(l.name)}s=Ae.getInitializedVariables(s);i=Ae.updateFor(i,0<s.length?Ae.inlineExpressions(Ae.map(s,ce)):void 0,Ae.visitNode(i.condition,P,Ae.isExpression),Ae.visitNode(i.incrementor,P,Ae.isExpression),Ae.visitNode(i.statement,P,Ae.isStatement,Ae.liftToBlock))}else i=Ae.visitEachChild(i,P,v);return k&&V(),i;case 215:var s=e,c=(k&&de(),s.initializer);if(Ae.isVariableDeclarationList(c)){for(var u=0,d=c.declarations;u<d.length;u++){var p=d[u];R(p.name)}s=Ae.updateForIn(s,c.declarations[0].name,Ae.visitNode(s.expression,P,Ae.isExpression),Ae.visitNode(s.statement,P,Ae.isStatement,Ae.liftToBlock))}else s=Ae.visitEachChild(s,P,v);return k&&V(),s;case 218:c=e;if(k){var h=be(c.label&&Ae.idText(c.label));if(0<h)return Te(h,c)}return Ae.visitEachChild(c,P,v);case 217:h=e;if(k){var m=ve(h.label&&Ae.idText(h.label));if(0<m)return Te(m,h)}return Ae.visitEachChild(h,P,v);case 219:m=e;var g=Ae.visitNode(m.expression,P,Ae.isExpression),f=m;return Ae.setTextRange(Ae.createReturn(Ae.createArrayLiteral(g?[G(2),g]:[G(2)])),f);default:if(!(16777216&e.transformFlags))return 33554944&e.transformFlags?Ae.visitEachChild(e,P,v):e;var _=e;switch(_.kind){case 194:return(e=>{switch(Ae.getExpressionAssociativity(e)){case 0:return(e=>{var t;{var r,n,i,s,a;if(M(e.right))return Ae.isLogicalOperator(e.operatorToken.kind)?(r=e,n=$(),K(i=B(),Ae.visitNode(r.left,P,Ae.isExpression),r.left),(53===r.operatorToken.kind?Ee:xe)(n,i,r.left),K(i,Ae.visitNode(r.right,P,Ae.isExpression),r.right),U(n),i):26!==e.operatorToken.kind?((t=Ae.getMutableClone(e)).left=F(Ae.visitNode(e.left,P,Ae.isExpression)),t.right=Ae.visitNode(e.right,P,Ae.isExpression),t):(a=[],o((s=e).left),o(s.right),Ae.inlineExpressions(a));return Ae.visitEachChild(e,P,v);function o(e){Ae.isBinaryExpression(e)&&26===e.operatorToken.kind?(o(e.left),o(e.right)):(M(e)&&0<a.length&&(W(1,[Ae.createStatement(Ae.inlineExpressions(a))]),a=[]),a.push(Ae.visitNode(e,P,Ae.isExpression)))}}})(e);case 1:return(e=>{var t=e.left,r=e.right;if(M(r)){var n=void 0;switch(t.kind){case 179:n=Ae.updatePropertyAccess(t,F(Ae.visitNode(t.expression,P,Ae.isLeftHandSideExpression)),t.name);break;case 180:n=Ae.updateElementAccess(t,F(Ae.visitNode(t.expression,P,Ae.isLeftHandSideExpression)),F(Ae.visitNode(t.argumentExpression,P,Ae.isExpression)));break;default:n=Ae.visitNode(t,P,Ae.isExpression)}var i=e.operatorToken.kind;return(e=>59<=e&&e<=70)(i)?Ae.setTextRange(Ae.createAssignment(n,Ae.setTextRange(Ae.createBinary(F(n),(e=>{switch(e){case 59:return 37;case 60:return 38;case 61:return 39;case 62:return 40;case 63:return 41;case 64:return 42;case 65:return 45;case 66:return 46;case 67:return 47;case 68:return 48;case 69:return 49;case 70:return 50}})(i),Ae.visitNode(r,P,Ae.isExpression)),e)),e):Ae.updateBinary(e,n,Ae.visitNode(r,P,Ae.isExpression))}return Ae.visitEachChild(e,P,v)})(e);default:Ae.Debug.fail("Unknown associativity.")}})(_);case 195:return(e=>{var t,r,n;return M(e.whenTrue)||M(e.whenFalse)?(t=$(),r=$(),n=B(),Ee(t,Ae.visitNode(e.condition,P,Ae.isExpression),e.condition),K(n,Ae.visitNode(e.whenTrue,P,Ae.isExpression),e.whenTrue),z(r),U(t),K(n,Ae.visitNode(e.whenFalse,P,Ae.isExpression),e.whenFalse),U(r),n):Ae.visitEachChild(e,P,v)})(_);case 197:return(e=>{var t=$(),r=Ae.visitNode(e.expression,P,Ae.isExpression);{var n,i,s;e.asteriskToken?W(7,[0==(8388608&Ae.getEmitFlags(e.expression))?Ae.createValuesHelper(v,r,e):r],e):W(6,[r],e)}U(t);r=e;return Ae.setTextRange(Ae.createCall(Ae.createPropertyAccess(C,"sent"),void 0,[]),r)})(_);case 177:return(e=>ae(e.elements,void 0,void 0,e.multiLine))(_);case 178:return(r=>{var e=r.properties,n=r.multiLine,t=ue(e),i=B();return K(i,Ae.createObjectLiteral(Ae.visitNodes(e,P,Ae.isObjectLiteralElementLike,0,t),n)),(e=Ae.reduceLeft(e,function(e,t){M(t)&&0<e.length&&(j(Ae.createStatement(Ae.inlineExpressions(e))),e=[]);t=Ae.createExpressionForObjectLiteralElementLike(r,t,i),t=Ae.visitNode(t,P,Ae.isExpression);t&&(n&&(t.startsOnNewLine=!0),e.push(t));return e},[],t)).push(n?Ae.startOnNewLine(Ae.getMutableClone(i)):i),Ae.inlineExpressions(e)})(_);case 180:return(e=>{var t;return M(e.argumentExpression)?((t=Ae.getMutableClone(e)).expression=F(Ae.visitNode(e.expression,P,Ae.isLeftHandSideExpression)),t.argumentExpression=Ae.visitNode(e.argumentExpression,P,Ae.isExpression),t):Ae.visitEachChild(e,P,v)})(_);case 181:return(e=>{var t,r;return Ae.isImportCall(e)||!Ae.forEach(e.arguments,M)?Ae.visitEachChild(e,P,v):(r=Ae.createCallBinding(e.expression,R,te,!0),t=r.target,r=r.thisArg,Ae.setOriginalNode(Ae.createFunctionApply(F(Ae.visitNode(t,P,Ae.isLeftHandSideExpression)),r,ae(e.arguments),e),e))})(_);case 182:return(e=>{var t,r;return Ae.forEach(e.arguments,M)?(r=Ae.createCallBinding(Ae.createPropertyAccess(e.expression,"bind"),R),t=r.target,r=r.thisArg,Ae.setOriginalNode(Ae.setTextRange(Ae.createNew(Ae.createFunctionApply(F(Ae.visitNode(t,P,Ae.isExpression)),r,ae(e.arguments,Ae.createVoidZero())),void 0,[]),e),e)):Ae.visitEachChild(e,P,v)})(_);default:return Ae.visitEachChild(_,P,v)}}var i,y,b}function ie(e){var t,r;if(e.asteriskToken?e=Ae.setOriginalNode(Ae.setTextRange(Ae.createFunctionDeclaration(void 0,e.modifiers,void 0,e.name,void 0,Ae.visitParameterList(e.parameters,P,v),void 0,o(e.body)),e),e):(t=T,r=k,k=T=!1,e=Ae.visitEachChild(e,P,v),T=t,k=r),!T)return e;n(e)}function se(e){var t,r;return e.asteriskToken?e=Ae.setOriginalNode(Ae.setTextRange(Ae.createFunctionExpression(void 0,void 0,e.name,void 0,Ae.visitParameterList(e.parameters,P,v),void 0,o(e.body)),e),e):(t=T,r=k,k=T=!1,e=Ae.visitEachChild(e,P,v),T=t,k=r),e}function o(e){var t=[],r=T,n=k,i=f,s=_,a=y,o=b,l=x,c=E,u=re,d=S,p=J,h=Y,m=C,g=(k=!(T=!0),re=1,Y=J=S=E=x=b=y=_=f=void 0,C=Ae.createTempVariable(void 0),Q(),Ae.addPrologue(t,e.statements,!1,P)),g=(oe(e.statements,g),L=ne=0,X=I=!1,O=N=Z=D=A=w=void 0,g=(()=>{if(S){for(var e=0;e<S.length;e++)(e=>{we(e);var t=e;if(f)for(;ne<y.length&&_[ne]<=t;ne++){var r=f[ne],n=y[ne];switch(r.kind){case 0:0===n?(D=D||[],(Z=Z||[]).push(N),N=r):1===n&&(N=Z.pop());break;case 1:0===n?(O=O||[]).push(r):1===n&&O.pop()}}if(!I){X=I=!1;var i=S[e];if(0!==i)if(10===i)I=!0,q(Ae.createReturn(Ae.createArrayLiteral([G(7)])));else{var s=J[e];if(1===i)return q(s[0]);var a=Y[e];switch(i){case 2:return((e,t,r)=>{q(Ae.setTextRange(Ae.createStatement(Ae.createAssignment(e,t)),r))})(s[0],s[1],a);case 3:return((e,t)=>{I=!0,q(Ae.setEmitFlags(Ae.setTextRange(Ae.createReturn(Ae.createArrayLiteral([G(3),H(e)])),t),384))})(s[0],a);case 4:return((e,t,r)=>{q(Ae.setEmitFlags(Ae.createIf(t,Ae.setEmitFlags(Ae.setTextRange(Ae.createReturn(Ae.createArrayLiteral([G(3),H(e)])),r),384)),1))})(s[0],s[1],a);case 5:return((e,t,r)=>{q(Ae.setEmitFlags(Ae.createIf(Ae.createLogicalNot(t),Ae.setEmitFlags(Ae.setTextRange(Ae.createReturn(Ae.createArrayLiteral([G(3),H(e)])),r),384)),1))})(s[0],s[1],a);case 6:return((e,t)=>{I=!0,q(Ae.setEmitFlags(Ae.setTextRange(Ae.createReturn(Ae.createArrayLiteral(e?[G(4),e]:[G(4)])),t),384))})(s[0],a);case 7:return((e,t)=>{I=!0,q(Ae.setEmitFlags(Ae.setTextRange(Ae.createReturn(Ae.createArrayLiteral([G(5),e])),t),384))})(s[0],a);case 8:return Ie(s[0],a);case 9:((e,t)=>{X=I=!0,q(Ae.setTextRange(Ae.createThrow(e),t))})(s[0],a)}}}})(e);Se(S.length)}else Se(0);var t;return A?(t=Ae.createPropertyAccess(C,"label"),(t=Ae.createSwitch(t,Ae.createCaseBlock(A))).startsOnNewLine=!0,[t]):D||[]})(),((e,t)=>(e.requestEmitHelper(De),Ae.createCall(Ae.getHelperName("__generator"),void 0,[Ae.createThis(),t])))(v,Ae.setEmitFlags(Ae.createFunctionExpression(void 0,void 0,void 0,void 0,[Ae.createParameter(void 0,void 0,void 0,C)],void 0,Ae.createBlock(g,0<g.length)),524288)));return Ae.addRange(t,ee()),t.push(Ae.createReturn(g)),T=r,k=n,f=i,_=s,y=a,b=o,x=l,E=c,re=u,S=d,J=p,Y=h,C=m,Ae.setTextRange(Ae.createBlock(t,e.multiLine),e)}function ae(e,n,t,i){var s,r=ue(e),a=(0<r&&(s=B(),a=Ae.visitNodes(e,P,Ae.isExpression,0,r),K(s,Ae.createArrayLiteral(n?[n].concat(a):a)),n=void 0),Ae.reduceLeft(e,function(e,t){{var r;M(t)&&0<e.length&&(r=void 0!==s,K(s=s||B(),r?Ae.createArrayConcat(s,[Ae.createArrayLiteral(e,i)]):Ae.createArrayLiteral(n?[n].concat(e):e,i)),n=void 0,e=[])}return e.push(Ae.visitNode(t,P,Ae.isExpression)),e},[],r));return s?Ae.createArrayConcat(s,[Ae.createArrayLiteral(a,i)]):Ae.setTextRange(Ae.createArrayLiteral(n?[n].concat(a):a,i),t)}function oe(e,t){for(var r=e.length,n=t=void 0===t?0:t;n<r;n++)l(e[n])}function u(e){Ae.isBlock(e)?oe(e.statements):l(e)}function l(e){var t=k;k=k||M(e),(e=>{switch(e.kind){case 207:return(e=>{M(e)?oe(e.statements):j(Ae.visitNode(e,P,Ae.isStatement))})(e);case 210:return(e=>{j(Ae.visitNode(e,P,Ae.isStatement))})(e);case 211:return(e=>{var t,r;M(e)&&(M(e.thenStatement)||M(e.elseStatement))?(t=$(),r=e.elseStatement?$():void 0,Ee(e.elseStatement?r:t,Ae.visitNode(e.expression,P,Ae.isExpression),e.expression),u(e.thenStatement),e.elseStatement&&(z(t),U(r),u(e.elseStatement)),U(t)):j(Ae.visitNode(e,P,Ae.isStatement))})(e);case 212:return(e=>{var t,r;M(e)?(t=$(),r=$(),pe(t),U(r),u(e.statement),U(t),xe(r,Ae.visitNode(e.expression,P,Ae.isExpression)),V()):j(Ae.visitNode(e,P,Ae.isStatement))})(e);case 213:return(e=>{var t,r;M(e)?(t=$(),r=pe(t),U(t),Ee(r,Ae.visitNode(e.expression,P,Ae.isExpression)),u(e.statement),z(t),V()):j(Ae.visitNode(e,P,Ae.isStatement))})(e);case 214:return(e=>{var t,r,n,i;M(e)?(t=$(),r=$(),n=pe(r),e.initializer&&(i=e.initializer,Ae.isVariableDeclarationList(i)?le(i):j(Ae.setTextRange(Ae.createStatement(Ae.visitNode(i,P,Ae.isExpression)),i))),U(t),e.condition&&Ee(n,Ae.visitNode(e.condition,P,Ae.isExpression)),u(e.statement),U(r),e.incrementor&&j(Ae.setTextRange(Ae.createStatement(Ae.visitNode(e.incrementor,P,Ae.isExpression)),e.incrementor)),z(t),V()):j(Ae.visitNode(e,P,Ae.isStatement))})(e);case 215:return(e=>{if(M(e)){var t=B(),r=B(),n=Ae.createLoopVariable(),i=e.initializer,r=(R(n),K(t,Ae.createArrayLiteral()),j(Ae.createForIn(r,Ae.visitNode(e.expression,P,Ae.isExpression),Ae.createStatement(Ae.createCall(Ae.createPropertyAccess(t,"push"),void 0,[r])))),K(n,Ae.createLiteral(0)),$()),s=$(),a=pe(s),a=(U(r),Ee(a,Ae.createLessThan(n,Ae.createPropertyAccess(t,"length"))),void 0);if(Ae.isVariableDeclarationList(i)){for(var o=0,l=i.declarations;o<l.length;o++){var c=l[o];R(c.name)}a=Ae.getSynthesizedClone(i.declarations[0].name)}else a=Ae.visitNode(i,P,Ae.isExpression),Ae.Debug.assert(Ae.isLeftHandSideExpression(a));K(a,Ae.createElementAccess(t,n)),u(e.statement),U(s),j(Ae.createStatement(Ae.createPostfixIncrement(n))),z(r),V()}else j(Ae.visitNode(e,P,Ae.isStatement))})(e);case 217:return(e=>{var t=ve(e.label?Ae.idText(e.label):void 0);0<t?z(t,e):j(e)})(e);case 218:return(e=>{var t=be(e.label?Ae.idText(e.label):void 0);0<t?z(t,e):j(e)})(e);case 219:return(e=>{W(8,[Ae.visitNode(e.expression,P,Ae.isExpression)],e)})(e);case 220:return(e=>{var t,r,n;M(e)?(t=F(Ae.visitNode(e.expression,P,Ae.isExpression)),r=$(),n=$(),U(r),h({kind:1,expression:t,startLabel:r,endLabel:n}),u(e.statement),Ae.Debug.assert(1===c()),U(m().endLabel)):j(Ae.visitNode(e,P,Ae.isStatement))})(e);case 221:return(e=>{if(M(e.caseBlock)){for(var t=e.caseBlock,r=t.clauses.length,n=(()=>{var e=$();return h({kind:2,isScript:!1,breakLabel:e}),e})(),i=F(Ae.visitNode(e.expression,P,Ae.isExpression)),s=[],a=-1,o=0;o<r;o++){var l=t.clauses[o];s.push($()),258===l.kind&&-1===a&&(a=o)}for(var c=0,u=[];c<r;){for(var d=0,o=c;o<r;o++)if(257===(l=t.clauses[o]).kind){var p=l;if(M(p.expression)&&0<u.length)break;u.push(Ae.createCaseClause(Ae.visitNode(p.expression,P,Ae.isExpression),[Te(s[o],p.expression)]))}else d++;u.length&&(j(Ae.createSwitch(i,Ae.createCaseBlock(u))),c+=u.length,u=[]),0<d&&(c+=d,d=0)}z(0<=a?s[a]:n);for(o=0;o<r;o++)U(s[o]),oe(t.clauses[o].statements);he()}else j(Ae.visitNode(e,P,Ae.isStatement))})(e);case 222:return(e=>{var t,r;M(e)?(t=Ae.idText(e.label),r=$(),h({kind:4,isScript:!1,labelText:t,breakLabel:r}),u(e.statement),me()):j(Ae.visitNode(e,P,Ae.isStatement))})(e);case 223:return(e=>{W(9,[Ae.visitNode(e.expression,P,Ae.isExpression)],e)})(e);case 224:return(e=>{var t,r,n,i,s,a,o,l;M(e)?(t=$(),r=$(),U(t),h({kind:0,state:0,startLabel:t,endLabel:r}),ke(),u(e.tryBlock),e.catchClause&&(n=e.catchClause.variableDeclaration,Ae.Debug.assert(0===c()),Ae.isGeneratedIdentifier(n.name)?(i=n.name,R(n.name)):(s=Ae.idText(n.name),i=B(s),d||(d=Ae.createMap(),p=[],v.enableSubstitution(71)),d.set(s,!0),p[Ae.getOriginalNodeId(n)]=i),s=g(),Ae.Debug.assert(s.state<1),z(s.endLabel),U(n=$()),s.state=1,s.catchVariable=i,s.catchLabel=n,K(i,Ae.createCall(Ae.createPropertyAccess(C,"sent"),void 0,[])),ke(),u(e.catchClause.block)),e.finallyBlock&&(Ae.Debug.assert(0===c()),a=g(),Ae.Debug.assert(a.state<2),z(a.endLabel),U(o=$()),a.state=2,a.finallyLabel=o,u(e.finallyBlock)),Ae.Debug.assert(0===c()),(l=m()).state<2?z(l.endLabel):W(10),U(l.endLabel),ke(),l.state=3):j(Ae.visitEachChild(e,P,v))})(e);default:j(Ae.visitNode(e,P,Ae.isStatement))}})(e),k=t}function le(e){for(var t=0,r=e.declarations;t<r.length;t++){var n=r[t],i=Ae.getSynthesizedClone(n.name);Ae.setCommentRange(i,n.name),R(i)}for(var s=Ae.getInitializedVariables(e),a=s.length,o=0,l=[];o<a;){for(var c=o;c<a;c++){if(M((n=s[c]).initializer)&&0<l.length)break;l.push(ce(n))}l.length&&(j(Ae.createStatement(Ae.inlineExpressions(l))),o+=l.length,l=[])}}function ce(e){return Ae.setSourceMapRange(Ae.createAssignment(Ae.setSourceMapRange(Ae.getSynthesizedClone(e.name),e.name),Ae.visitNode(e.initializer,P,Ae.isExpression)),e)}function M(e){return e&&0!=(16777216&e.transformFlags)}function ue(e){for(var t=e.length,r=0;r<t;r++)if(M(e[r]))return r;return-1}function F(e){var t;return Ae.isGeneratedIdentifier(e)||4096&Ae.getEmitFlags(e)?e:(K(t=Ae.createTempVariable(R),e,e),t)}function B(e){e=e?Ae.createUniqueName(e):Ae.createTempVariable(void 0);return R(e),e}function $(){var e=re;return re++,(x=x||[])[e]=-1,e}function U(e){Ae.Debug.assert(void 0!==x,"No labels were defined."),x[e]=S?S.length:0}function h(e){f||(f=[],y=[],_=[],b=[]);var t=y.length;y[t]=0,_[t]=S?S.length:0,f[t]=e,b.push(e)}function m(){var e=g(),t=(Ae.Debug.assert(void 0!==e,"beginBlock was never called."),y.length);return y[t]=1,_[t]=S?S.length:0,f[t]=e,b.pop(),e}function g(){return Ae.lastOrUndefined(b)}function c(){var e=g();return e&&e.kind}function de(){h({kind:3,isScript:!0,breakLabel:-1,continueLabel:-1})}function pe(e){var t=$();return h({kind:3,isScript:!1,breakLabel:t,continueLabel:e}),t}function V(){Ae.Debug.assert(3===c());var e=m(),t=e.breakLabel;e.isScript||U(t)}function he(){Ae.Debug.assert(2===c());var e=m(),t=e.breakLabel;e.isScript||U(t)}function me(){Ae.Debug.assert(4===c());var e=m();e.isScript||U(e.breakLabel)}function ge(e){return 2===e.kind||3===e.kind}function fe(e){return 4===e.kind}function _e(e){return 3===e.kind}function ye(e,t){for(var r=t;0<=r;r--){var n=b[r];if(!fe(n))break;if(n.labelText===e)return 1}}function be(e){if(b)if(e)for(var t=b.length-1;0<=t;t--){if(fe(r=b[t])&&r.labelText===e)return r.breakLabel;if(ge(r)&&ye(e,t-1))return r.breakLabel}else for(var r,t=b.length-1;0<=t;t--)if(ge(r=b[t]))return r.breakLabel;return 0}function ve(e){if(b)if(e){for(var t=b.length-1;0<=t;t--)if(_e(r=b[t])&&ye(e,t-1))return r.continueLabel}else for(var r,t=b.length-1;0<=t;t--)if(_e(r=b[t]))return r.continueLabel;return 0}function H(e){var t;return 0<e?(void 0===E&&(E=[]),t=Ae.createLiteral(-1),void 0===E[e]?E[e]=[t]:E[e].push(t),t):Ae.createOmittedExpression()}function G(e){var t=Ae.createLiteral(e);return Ae.addSyntheticTrailingComment(t,3,(e=>{switch(e){case 2:return"return";case 3:return"break";case 4:return"yield";case 5:return"yield*";case 7:return"endfinally"}})(e)),t}function Te(e,t){return Ae.Debug.assertLessThan(0,e,"Invalid label"),Ae.setTextRange(Ae.createReturn(Ae.createArrayLiteral([G(3),H(e)])),t)}function ke(){W(0)}function j(e){e?W(1,[e]):ke()}function K(e,t,r){W(2,[e,t],r)}function z(e,t){W(3,[e],t)}function xe(e,t,r){W(4,[e,t],r)}function Ee(e,t,r){W(5,[e,t],r)}function W(e,t,r){void 0===S&&(S=[],J=[],Y=[]),void 0===x&&U($());var n=S.length;S[n]=e,J[n]=t,Y[n]=r}function Se(e){if((e=>{if(!X)return 1;if(x&&E)for(var t=0;t<x.length;t++)if(x[t]===e&&E[t])return 1})(e)&&(we(e),Ie(O=void 0,void 0)),D&&A&&Ce(!1),void 0!==E&&void 0!==w)for(var t=0;t<w.length;t++){var r=w[t];if(void 0!==r)for(var n=0,i=r;n<i.length;n++){var s=i[n],s=E[s];if(void 0!==s)for(var a=0,o=s;a<o.length;a++)o[a].text=String(t)}}}function Ce(e){if(A=A||[],D){if(O)for(var t=O.length-1;0<=t;t--){var r=O[t];D=[Ae.createWith(r.expression,Ae.createBlock(D))]}var n,i,s,a;N&&(n=N.startLabel,i=N.catchLabel,s=N.finallyLabel,a=N.endLabel,D.unshift(Ae.createStatement(Ae.createCall(Ae.createPropertyAccess(Ae.createPropertyAccess(C,"trys"),"push"),void 0,[Ae.createArrayLiteral([H(n),H(i),H(s),H(a)])]))),N=void 0),e&&D.push(Ae.createStatement(Ae.createAssignment(Ae.createPropertyAccess(C,"label"),Ae.createLiteral(L+1))))}A.push(Ae.createCaseClause(Ae.createLiteral(L),D||[])),D=void 0}function we(e){if(x)for(var t=0;t<x.length;t++)x[t]===e&&(D&&(Ce(!I),X=I=!1,L++),void 0===(w=void 0===w?[]:w)[L]?w[L]=[t]:w[L].push(t))}function q(e){e&&(D?D.push(e):D=[e])}function Ie(e,t){X=I=!0,q(Ae.setEmitFlags(Ae.setTextRange(Ae.createReturn(Ae.createArrayLiteral(e?[G(2),e]:[G(2)])),t),384))}}),priority:6,text:'\n            var __generator = (this && this.__generator) || function (thisArg, body) {\n                var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n                return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;\n                function verb(n) { return function (v) { return step([n, v]); }; }\n                function step(op) {\n                    if (f) throw new TypeError("Generator is already executing.");\n                    while (_) try {\n                        if (f = 1, y && (t = y[op[0] & 2 ? "return" : op[0] ? "throw" : "next"]) && !(t = t.call(y, op[1])).done) return t;\n                        if (y = 0, t) op = [0, t.value];\n                        switch (op[0]) {\n                            case 0: case 1: t = op; break;\n                            case 4: _.label++; return { value: op[1], done: false };\n                            case 5: _.label++; y = op[1]; op = [0]; continue;\n                            case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                            default:\n                                if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                                if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                                if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                                if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                                if (t[2]) _.ops.pop();\n                                _.trys.pop(); continue;\n                        }\n                        op = body.call(thisArg, _);\n                    } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n                    if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n                }\n            };'}})(ts=ts||{}),(j=>{j.transformModule=function(D){var p,h,a,n,i=D.startLexicalEnvironment,s=D.endLexicalEnvironment,S=D.hoistVariableDeclaration,m=D.getCompilerOptions(),g=D.getEmitResolver(),f=D.getEmitHost(),N=j.getEmitScriptTarget(m),O=j.getEmitModuleKind(m),r=D.onSubstituteNode,o=D.onEmitNode,l=(D.onSubstituteNode=function(e,t){if(!(t=r(e,t)).id||!a[t.id]){if(1===e)return(e=>{switch(e.kind){case 71:return x(e);case 194:return(e=>{if(j.isAssignmentOperator(e.operatorToken.kind)&&j.isIdentifier(e.left)&&!j.isGeneratedIdentifier(e.left)&&!j.isLocalName(e.left)&&!j.isDeclarationNameOfEnumOrNamespace(e.left)){var t=E(e.left);if(t){for(var r=e,n=0,i=t;n<i.length;n++){var s=i[n];a[j.getNodeId(r)]=!0,r=H(s,r,e)}return r}}return e})(e);case 193:case 192:return(e=>{if((43===e.operator||44===e.operator)&&j.isIdentifier(e.operand)&&!j.isGeneratedIdentifier(e.operand)&&!j.isLocalName(e.operand)&&!j.isDeclarationNameOfEnumOrNamespace(e.operand)){var t=E(e.operand);if(t){for(var r=193===e.kind?j.setTextRange(j.createBinary(e.operand,j.createToken(43===e.operator?59:60),j.createLiteral(1)),e):e,n=0,i=t;n<i.length;n++){var s=i[n];a[j.getNodeId(r)]=!0,r=H(s,r)}return r}}return e})(e)}return e})(t);if(j.isShorthandPropertyAssignment(t))return(e=>{var t,r=e.name,n=x(r);return n===r?e:e.objectAssignmentInitializer?(t=j.createAssignment(n,e.objectAssignmentInitializer),j.setTextRange(j.createPropertyAssignment(r,t),e)):j.setTextRange(j.createPropertyAssignment(r,n),e)})(t)}return t},D.onEmitNode=function(e,t,r){265===t.kind?(p=t,h=l[j.getOriginalNodeId(p)],a=[],o(e,t,r),a=h=p=void 0):o(e,t,r)},D.enableSubstitution(71),D.enableSubstitution(194),D.enableSubstitution(192),D.enableSubstitution(193),D.enableSubstitution(262),D.enableEmitNotification(265),[]),R=[];return function(e){if(e.isDeclarationFile||!(j.isExternalModule(e)||m.isolatedModules||67108864&e.transformFlags))return e;p=e,h=j.collectExternalModuleInfo(e,g,m),l[j.getOriginalNodeId(e)]=h;e=(e=>{switch(e){case j.ModuleKind.AMD:return C;case j.ModuleKind.UMD:return w;default:return t}})(O)(e);return p=void 0,h=void 0,n=!1,j.aggregateTransformFlags(e)};function c(){return!(h.exportEquals||!j.isExternalModule(p))}function t(e){i();var t=[],r=m.alwaysStrict||!m.noImplicitUseStrict&&j.isExternalModule(p),r=j.addPrologue(t,e.statements,r,y),r=(c()&&j.append(t,k()),j.append(t,j.visitNode(h.externalHelpersImportDeclaration,y,j.isStatement)),j.addRange(t,j.visitNodes(e.statements,y,j.isStatement,r)),_(t,!1),j.addRange(t,s()),j.updateSourceFileNode(e,j.setTextRange(j.createNodeArray(t),e.statements)));return h.hasExportStarsToExportValues&&!m.importHelpers&&j.addEmitHelper(r,I),j.addEmitHelpers(r,D.readEmitHelpers()),r}function C(e){var t=j.createIdentifier("define"),r=j.tryGetModuleNameFromFile(e,f,m),n=u(e,!0),i=n.aliasedModuleNames,s=n.unaliasedModuleNames,n=n.importAliasNames;return j.updateSourceFileNode(e,j.setTextRange(j.createNodeArray([j.createStatement(j.createCall(t,void 0,(r?[r]:[]).concat([j.createArrayLiteral([j.createLiteral("require"),j.createLiteral("exports")].concat(i,s)),j.createFunctionExpression(void 0,void 0,void 0,void 0,[j.createParameter(void 0,void 0,void 0,"require"),j.createParameter(void 0,void 0,void 0,"exports")].concat(n),void 0,d(e))])))]),e.statements))}function w(e){var t=u(e,!1),r=t.aliasedModuleNames,n=t.unaliasedModuleNames,t=t.importAliasNames,i=j.tryGetModuleNameFromFile(e,f,m),i=j.createFunctionExpression(void 0,void 0,void 0,void 0,[j.createParameter(void 0,void 0,void 0,"factory")],void 0,j.setTextRange(j.createBlock([j.createIf(j.createLogicalAnd(j.createTypeCheck(j.createIdentifier("module"),"object"),j.createTypeCheck(j.createPropertyAccess(j.createIdentifier("module"),"exports"),"object")),j.createBlock([j.createVariableStatement(void 0,[j.createVariableDeclaration("v",void 0,j.createCall(j.createIdentifier("factory"),void 0,[j.createIdentifier("require"),j.createIdentifier("exports")]))]),j.setEmitFlags(j.createIf(j.createStrictInequality(j.createIdentifier("v"),j.createIdentifier("undefined")),j.createStatement(j.createAssignment(j.createPropertyAccess(j.createIdentifier("module"),"exports"),j.createIdentifier("v")))),1)]),j.createIf(j.createLogicalAnd(j.createTypeCheck(j.createIdentifier("define"),"function"),j.createPropertyAccess(j.createIdentifier("define"),"amd")),j.createBlock([j.createStatement(j.createCall(j.createIdentifier("define"),void 0,(i?[i]:[]).concat([j.createArrayLiteral([j.createLiteral("require"),j.createLiteral("exports")].concat(r,n)),j.createIdentifier("factory")])))])))],!0),void 0));return j.updateSourceFileNode(e,j.setTextRange(j.createNodeArray([j.createStatement(j.createCall(i,void 0,[j.createFunctionExpression(void 0,void 0,void 0,void 0,[j.createParameter(void 0,void 0,void 0,"require"),j.createParameter(void 0,void 0,void 0,"exports")].concat(t),void 0,d(e))]))]),e.statements))}function u(e,t){for(var r=[],n=[],i=[],s=0,a=e.amdDependencies;s<a.length;s++){var o=a[s];o.name?(r.push(j.createLiteral(o.path)),i.push(j.createParameter(void 0,void 0,void 0,o.name))):n.push(j.createLiteral(o.path))}for(var l=0,c=h.externalImports;l<c.length;l++){var u=c[l],d=j.getExternalModuleNameLiteral(u,p,f,g,m),u=j.getLocalNameForExternalImport(u,p);d&&(t&&u?(j.setEmitFlags(u,4),r.push(d),i.push(j.createParameter(void 0,void 0,void 0,u))):n.push(d))}return{aliasedModuleNames:r,unaliasedModuleNames:n,importAliasNames:i}}function d(e){i();var t=[],r=j.addPrologue(t,e.statements,!m.noImplicitUseStrict,y),e=(c()&&j.append(t,k()),j.append(t,j.visitNode(h.externalHelpersImportDeclaration,y,j.isStatement)),j.addRange(t,j.visitNodes(e.statements,y,j.isStatement,r)),_(t,!0),j.addRange(t,s()),j.createBlock(t,!0));return h.hasExportStarsToExportValues&&!m.importHelpers&&j.addEmitHelper(e,I),n&&j.addEmitHelper(e,A),e}function _(e,t){var r,n;h.exportEquals&&(r=j.visitNode(h.exportEquals.expression,L))&&(t?(n=j.createReturn(r),j.setTextRange(n,h.exportEquals),j.setEmitFlags(n,1920)):(n=j.createStatement(j.createAssignment(j.createPropertyAccess(j.createIdentifier("module"),"exports"),r)),j.setTextRange(n,h.exportEquals),j.setEmitFlags(n,1536)),e.push(n))}function y(e){switch(e.kind){case 238:var t,r=e,n=j.getNamespaceDeclarationNode(r);if(O!==j.ModuleKind.AMD){if(!r.importClause)return j.setTextRange(j.createStatement(P(r)),r);var i=[];n&&!j.isDefaultImport(r)?i.push(j.createVariableDeclaration(j.getSynthesizedClone(n.name),void 0,P(r))):(i.push(j.createVariableDeclaration(j.getGeneratedNameForNode(r),void 0,P(r))),n&&j.isDefaultImport(r)&&i.push(j.createVariableDeclaration(j.getSynthesizedClone(n.name),void 0,j.getGeneratedNameForNode(r)))),t=j.append(t,j.setTextRange(j.createVariableStatement(void 0,j.createVariableDeclarationList(i,2<=N?2:0)),r))}else n&&j.isDefaultImport(r)&&(t=j.append(t,j.createVariableStatement(void 0,j.createVariableDeclarationList([j.setTextRange(j.createVariableDeclaration(j.getSynthesizedClone(n.name),void 0,j.getGeneratedNameForNode(r)),r)],2<=N?2:0))));return M(r)?(i=j.getOriginalNodeId(r),R[i]=F(R[i],r)):t=F(t,r),j.singleOrMany(t);case 237:var s,n=e;return j.Debug.assert(j.isExternalModuleImportEqualsDeclaration(n),"import= for internal module references should be handled in an earlier transformer."),O!==j.ModuleKind.AMD?s=j.hasModifier(n,1)?j.append(s,j.setTextRange(j.createStatement(H(n.name,P(n))),n)):j.append(s,j.setTextRange(j.createVariableStatement(void 0,j.createVariableDeclarationList([j.createVariableDeclaration(j.getSynthesizedClone(n.name),void 0,P(n))],2<=N?2:0)),n)):j.hasModifier(n,1)&&(s=j.append(s,j.setTextRange(j.createStatement(H(j.getExportName(n),j.getLocalName(n))),n))),M(n)?(i=j.getOriginalNodeId(n),R[i]=B(R[i],n)):s=B(s,n),j.singleOrMany(s);case 244:r=e;if(r.moduleSpecifier){var a=j.getGeneratedNameForNode(r);if(r.exportClause){var o=[];O!==j.ModuleKind.AMD&&o.push(j.setTextRange(j.createVariableStatement(void 0,j.createVariableDeclarationList([j.createVariableDeclaration(a,void 0,P(r))])),r));for(var l=0,c=r.exportClause.elements;l<c.length;l++){var u=c[l],d=j.createPropertyAccess(a,u.propertyName||u.name);o.push(j.setTextRange(j.createStatement(H(j.getExportName(u),d)),u))}return j.singleOrMany(o)}return j.setTextRange(j.createStatement(((e,t)=>e.getCompilerOptions().importHelpers?j.createCall(j.getHelperName("__exportStar"),void 0,[t,j.createIdentifier("exports")]):j.createCall(j.createIdentifier("__export"),void 0,[t]))(D,O!==j.ModuleKind.AMD?P(r):a)),r)}return;case 243:var p,h=e;return h.isExportEquals?void 0:((_=h.original)&&M(_)?(_=j.getOriginalNodeId(h),R[_]=V(R[_],j.createIdentifier("default"),j.visitNode(h.expression,L),h,!0)):p=V(p,j.createIdentifier("default"),j.visitNode(h.expression,L),h,!0),j.singleOrMany(p));case 208:var m,g,f,_,y=e;if(j.hasModifier(y,1)){for(var b=void 0,v=0,T=y.declarationList.declarations;v<T.length;v++){var k=T[v];j.isIdentifier(k.name)&&j.isLocalName(k.name)?(b=b||j.visitNodes(y.modifiers,G,j.isModifier),g=j.append(g,k)):k.initializer&&(f=j.append(f,(e=>j.isBindingPattern(e.name)?j.flattenDestructuringAssignment(j.visitNode(e,L),void 0,D,0,!1,H):j.createAssignment(j.setTextRange(j.createPropertyAccess(j.createIdentifier("exports"),e.name),e.name),j.visitNode(e.initializer,L)))(k)))}g&&(m=j.append(m,j.updateVariableStatement(y,b,j.updateVariableDeclarationList(y.declarationList,g)))),f&&(m=j.append(m,j.setTextRange(j.createStatement(j.inlineExpressions(f)),y)))}else m=j.append(m,j.visitEachChild(y,L,D));return M(y)?(_=j.getOriginalNodeId(y),R[_]=$(R[_],y)):m=$(m,y),j.singleOrMany(m);case 228:var x,h=e;return x=j.hasModifier(h,1)?j.append(x,j.setOriginalNode(j.setTextRange(j.createFunctionDeclaration(void 0,j.visitNodes(h.modifiers,G,j.isModifier),h.asteriskToken,j.getDeclarationName(h,!0,!0),void 0,j.visitNodes(h.parameters,L),void 0,j.visitEachChild(h.body,L,D)),h),h)):j.append(x,j.visitEachChild(h,L,D)),M(h)?(S=j.getOriginalNodeId(h),R[S]=U(R[S],h)):x=U(x,h),j.singleOrMany(x);case 229:var E,S=e;return E=j.hasModifier(S,1)?j.append(E,j.setOriginalNode(j.setTextRange(j.createClassDeclaration(void 0,j.visitNodes(S.modifiers,G,j.isModifier),j.getDeclarationName(S,!0,!0),void 0,j.visitNodes(S.heritageClauses,L),j.visitNodes(S.members,L)),S),S)):j.append(E,j.visitEachChild(S,L,D)),M(S)?(C=j.getOriginalNodeId(S),R[C]=U(R[C],S)):E=U(E,S),j.singleOrMany(E);case 290:var C=e;return M(C)&&208===C.original.kind&&(w=j.getOriginalNodeId(C),R[w]=$(R[w],C.original)),C;case 291:var w=e,I=j.getOriginalNodeId(w),A=R[I];return A?(delete R[I],j.append(A,w)):w;default:return j.visitEachChild(e,L,D)}}function L(e){if(!(67108864&e.transformFlags))return e;if(!j.isImportCall(e))return j.visitEachChild(e,L,D);var t=j.visitNode(j.firstOrUndefined(e.arguments),L),r=!!(16384&e.transformFlags);switch(m.module){case j.ModuleKind.AMD:return b(t,r);case j.ModuleKind.UMD:return((e,t)=>{var r;return n=!0,j.isSimpleCopiableExpression(e)?(r=j.isGeneratedIdentifier(e)?e:j.isStringLiteral(e)?j.createLiteral(e):j.setEmitFlags(j.setTextRange(j.getSynthesizedClone(e),e),1536),j.createConditional(j.createIdentifier("__syncRequire"),v(e,t),b(r,t))):(r=j.createTempVariable(S),j.createComma(j.createAssignment(r,e),j.createConditional(j.createIdentifier("__syncRequire"),v(r,t),b(r,t))))})(t,r);default:j.ModuleKind.CommonJS;return v(t,r)}}function b(e,t){var r,n=j.createUniqueName("resolve"),i=j.createUniqueName("reject"),s=[j.createParameter(void 0,void 0,void 0,n),j.createParameter(void 0,void 0,void 0,i)],e=j.createBlock([j.createStatement(j.createCall(j.createIdentifier("require"),void 0,[j.createArrayLiteral([e||j.createOmittedExpression()]),n,i]))]);return 2<=N?r=j.createArrowFunction(void 0,void 0,s,void 0,void 0,e):(r=j.createFunctionExpression(void 0,void 0,void 0,void 0,s,void 0,e),t&&j.setEmitFlags(r,8)),j.createNew(j.createIdentifier("Promise"),void 0,[r])}function v(e,t){var r,n=j.createCall(j.createPropertyAccess(j.createIdentifier("Promise"),"resolve"),void 0,[]),e=j.createCall(j.createIdentifier("require"),void 0,e?[e]:[]);return 2<=N?r=j.createArrowFunction(void 0,void 0,[],void 0,void 0,e):(r=j.createFunctionExpression(void 0,void 0,void 0,void 0,[],void 0,j.createBlock([j.createReturn(e)])),t&&j.setEmitFlags(r,8)),j.createCall(j.createPropertyAccess(n,"then"),void 0,[r])}function P(e){var e=j.getExternalModuleNameLiteral(e,p,f,g,m),t=[];return e&&t.push(e),j.createCall(j.createIdentifier("require"),void 0,t)}function M(e){return 0!=(4194304&j.getEmitFlags(e))}function F(e,t){if(!h.exportEquals){t=t.importClause;if(t){t.name&&(e=T(e,t));var r=t.namedBindings;if(r)switch(r.kind){case 240:e=T(e,r);break;case 241:for(var n=0,i=r.elements;n<i.length;n++)e=T(e,i[n])}}}return e}function B(e,t){return h.exportEquals?e:T(e,t)}function $(e,t){if(!h.exportEquals)for(var r=0,n=t.declarationList.declarations;r<n.length;r++)e=function e(t,r){if(h.exportEquals)return t;if(j.isBindingPattern(r.name))for(var n=0,i=r.name.elements;n<i.length;n++){var s=i[n];j.isOmittedExpression(s)||(t=e(t,s))}else j.isGeneratedIdentifier(r.name)||(t=T(t,r));return t}(e,n[r]);return e}function U(e,t){return h.exportEquals||(j.hasModifier(t,1)&&(e=V(e,j.hasModifier(t,512)?j.createIdentifier("default"):j.getDeclarationName(t),j.getLocalName(t),t)),t.name&&(e=T(e,t))),e}function T(e,t){var r=j.getDeclarationName(t),t=h.exportSpecifiers.get(j.idText(r));if(t)for(var n=0,i=t;n<i.length;n++){var s=i[n];e=V(e,s.name,r,s.name)}return e}function V(e,t,r,n,i){return e=j.append(e,((e,t,r,n)=>(e=j.setTextRange(j.createStatement(H(e,t)),r),j.startOnNewLine(e),n||j.setEmitFlags(e,1536),e))(t,r,n,i))}function k(){var e=0===N?j.createStatement(H(j.createIdentifier("__esModule"),j.createLiteral(!0))):j.createStatement(j.createCall(j.createPropertyAccess(j.createIdentifier("Object"),"defineProperty"),void 0,[j.createIdentifier("exports"),j.createLiteral("__esModule"),j.createObjectLiteral([j.createPropertyAssignment("value",j.createLiteral(!0))])]));return j.setEmitFlags(e,1048576),e}function H(e,t,r){return j.setTextRange(j.createAssignment(j.createPropertyAccess(j.createIdentifier("exports"),j.getSynthesizedClone(e)),t),r)}function G(e){switch(e.kind){case 84:case 79:return}return e}function x(e){if(4096&j.getEmitFlags(e))return(t=j.getExternalHelpersModuleName(p))?j.createPropertyAccess(t,e):e;if(!j.isGeneratedIdentifier(e)&&!j.isLocalName(e)){var t=g.getReferencedExportContainer(e,j.isExportName(e));if(t&&265===t.kind)return j.setTextRange(j.createPropertyAccess(j.createIdentifier("exports"),j.getSynthesizedClone(e)),e);var r,t=g.getReferencedImportDeclaration(e);if(t){if(j.isImportClause(t))return j.setTextRange(j.createPropertyAccess(j.getGeneratedNameForNode(t.parent),j.createIdentifier("default")),e);if(j.isImportSpecifier(t))return r=t.propertyName||t.name,j.setTextRange(j.createPropertyAccess(j.getGeneratedNameForNode(t.parent.parent.parent),j.getSynthesizedClone(r)),e)}}return e}function E(e){if(!j.isGeneratedIdentifier(e)){e=g.getReferencedImportDeclaration(e)||g.getReferencedValueDeclaration(e);if(e)return h&&h.exportedBindings[j.getOriginalNodeId(e)]}}};var I={name:"typescript:export-star",scoped:!0,text:"\n            function __export(m) {\n                for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n            }\n        "},A={name:"typescript:dynamicimport-sync-require",scoped:!0,text:'\n            var __syncRequire = typeof module === "object" && typeof module.exports === "object";'}})(ts=ts||{}),(z=>{z.transformSystemModule=function(E){var _,f,y,a,S,C,o,$=E.startLexicalEnvironment,U=E.endLexicalEnvironment,w=E.hoistVariableDeclaration,l=E.getCompilerOptions(),c=E.getEmitResolver(),u=E.getEmitHost(),s=E.onSubstituteNode,i=E.onEmitNode,d=(E.onSubstituteNode=function(e,t){if((e=>o&&e.id&&o[e.id])(t=s(e,t)))return t;if(1!==e)return t;var r=t;switch(r.kind){case 71:return(e=>{if(4096&z.getEmitFlags(e)){var t=z.getExternalHelpersModuleName(_);if(t)return z.createPropertyAccess(t,e)}else if(!z.isGeneratedIdentifier(e)&&!z.isLocalName(e)){t=c.getReferencedImportDeclaration(e);if(t){if(z.isImportClause(t))return z.setTextRange(z.createPropertyAccess(z.getGeneratedNameForNode(t.parent),z.createIdentifier("default")),e);if(z.isImportSpecifier(t))return z.setTextRange(z.createPropertyAccess(z.getGeneratedNameForNode(t.parent.parent.parent),z.getSynthesizedClone(t.propertyName||t.name)),e)}}return e})(r);case 194:return(e=>{if(z.isAssignmentOperator(e.operatorToken.kind)&&z.isIdentifier(e.left)&&!z.isGeneratedIdentifier(e.left)&&!z.isLocalName(e.left)&&!z.isDeclarationNameOfEnumOrNamespace(e.left)){var t=K(e.left);if(t){for(var r=e,n=0,i=t;n<i.length;n++){var s=i[n];r=x(s,B(r))}return r}}return e})(r);case 192:case 193:return(e=>{if((43===e.operator||44===e.operator)&&z.isIdentifier(e.operand)&&!z.isGeneratedIdentifier(e.operand)&&!z.isLocalName(e.operand)&&!z.isDeclarationNameOfEnumOrNamespace(e.operand)){var t=K(e.operand);if(t){for(var r=193===e.kind?z.setTextRange(z.createPrefix(e.operator,e.operand),e):e,n=0,i=t;n<i.length;n++){var s=i[n];r=x(s,B(r))}return r=193===e.kind?43===e.operator?z.createSubtract(B(r),z.createLiteral(1)):z.createAdd(B(r),z.createLiteral(1)):r}}return e})(r)}return r},E.onEmitNode=function(e,t,r){{var n;265===t.kind?(n=z.getOriginalNodeId(t),_=t,f=d[n],y=p[n],(o=h[n])&&delete h[n],i(e,t,r),o=y=f=_=void 0):i(e,t,r)}},E.enableSubstitution(71),E.enableSubstitution(194),E.enableSubstitution(192),E.enableSubstitution(193),E.enableEmitNotification(265),[]),I=[],p=[],h=[];return function(e){if(e.isDeclarationFile||!(z.isEffectiveExternalModule(e,l)||67108864&e.transformFlags))return e;var t=z.getOriginalNodeId(e),r=(C=_=e,f=d[t]=z.collectExternalModuleInfo(e,c,l),y=z.createUniqueName("exports"),p[t]=y,a=z.createUniqueName("context"),(e=>{for(var t=z.createMap(),r=[],n=0;n<e.length;n++){var i,s,a=e[n],o=z.getExternalModuleNameLiteral(a,_,u,c,l);o&&(i=o.text,void 0!==(s=t.get(i))?r[s].externalImports.push(a):(t.set(i,r.length),r.push({name:o,externalImports:[a]})))}return r})(f.externalImports)),n=((e,t)=>{var r=[],n=($(),l.alwaysStrict||!l.noImplicitUseStrict&&z.isExternalModule(_)),n=z.addPrologue(r,e.statements,n,m),e=(r.push(z.createVariableStatement(void 0,z.createVariableDeclarationList([z.createVariableDeclaration("__moduleName",void 0,z.createLogicalAnd(a,z.createPropertyAccess(a,"id")))]))),z.visitNode(f.externalHelpersImportDeclaration,m,z.isStatement),z.visitNodes(e.statements,m,z.isStatement,n)),n=(z.addRange(r,S),z.addRange(r,U()),(e=>{if(f.hasExportStarsToExportValues){if(!f.exportedNames&&0===f.exportSpecifiers.size){for(var t=!1,r=0,n=f.externalImports;r<n.length;r++)if(244===(u=n[r]).kind&&u.exportClause){t=!0;break}if(!t)return g=b(void 0),e.push(g),g.name}var i=[];if(f.exportedNames)for(var s=0,a=f.exportedNames;s<a.length;s++){var o=a[s];"default"!==o.escapedText&&i.push(z.createPropertyAssignment(z.createLiteral(o),z.createTrue()))}for(var l=0,c=f.externalImports;l<c.length;l++){var u=c[l];if(244===u.kind){var d=u;if(d.exportClause)for(var p=0,h=d.exportClause.elements;p<h.length;p++){var m=h[p];i.push(z.createPropertyAssignment(z.createLiteral(z.idText(m.name||m.propertyName)),z.createTrue()))}}}var g=z.createUniqueName("exportedNames"),g=(e.push(z.createVariableStatement(void 0,z.createVariableDeclarationList([z.createVariableDeclaration(g,void 0,z.createObjectLiteral(i,!0))]))),b(g));return e.push(g),g.name}})(r));return(n=z.createObjectLiteral([z.createPropertyAssignment("setters",((e,t)=>{for(var r=[],n=0,i=t;n<i.length;n++){for(var s=i[n],a=z.forEach(s.externalImports,function(e){return z.getLocalNameForExternalImport(e,_)}),o=a?z.getGeneratedNameForNode(a):z.createUniqueName(""),l=[],c=0,u=s.externalImports;c<u.length;c++){var d=u[c],p=z.getLocalNameForExternalImport(d,_);switch(d.kind){case 238:if(!d.importClause)break;case 237:z.Debug.assert(void 0!==p),l.push(z.createStatement(z.createAssignment(p,o)));break;case 244:if(z.Debug.assert(void 0!==p),d.exportClause){for(var h=[],m=0,g=d.exportClause.elements;m<g.length;m++){var f=g[m];h.push(z.createPropertyAssignment(z.createLiteral(z.idText(f.name)),z.createElementAccess(o,z.createLiteral(z.idText(f.propertyName||f.name)))))}l.push(z.createStatement(z.createCall(y,void 0,[z.createObjectLiteral(h,!0)])))}else l.push(z.createStatement(z.createCall(e,void 0,[o])))}}r.push(z.createFunctionExpression(void 0,void 0,void 0,void 0,[z.createParameter(void 0,void 0,void 0,o)],void 0,z.createBlock(l,!0)))}return z.createArrayLiteral(r,!0)})(n,t)),z.createPropertyAssignment("execute",z.createFunctionExpression(void 0,void 0,void 0,void 0,[],void 0,z.createBlock(e,!0)))])).multiLine=!0,r.push(z.createReturn(n)),z.createBlock(r,!0)})(e,r),i=z.createFunctionExpression(void 0,void 0,void 0,void 0,[z.createParameter(void 0,void 0,void 0,y),z.createParameter(void 0,void 0,void 0,a)],void 0,n),s=z.tryGetModuleNameFromFile(e,u,l),r=z.createArrayLiteral(z.map(r,function(e){return e.name})),s=z.setEmitFlags(z.updateSourceFileNode(e,z.setTextRange(z.createNodeArray([z.createStatement(z.createCall(z.createPropertyAccess(z.createIdentifier("System"),"register"),void 0,s?[s,r,i]:[r,i]))]),e.statements)),1024);l.outFile||l.out||z.moveEmitHelpers(s,n,function(e){return!e.scoped});o&&(h[t]=o,o=void 0);return _=void 0,f=void 0,y=void 0,a=void 0,S=void 0,C=void 0,z.aggregateTransformFlags(s)};function b(e){var t=z.createUniqueName("exportStar"),r=z.createIdentifier("m"),n=z.createIdentifier("n"),i=z.createIdentifier("exports"),s=z.createStrictInequality(n,z.createLiteral("default"));return e&&(s=z.createLogicalAnd(s,z.createLogicalNot(z.createCall(z.createPropertyAccess(e,"hasOwnProperty"),void 0,[n])))),z.createFunctionDeclaration(void 0,void 0,void 0,t,void 0,[z.createParameter(void 0,void 0,void 0,r)],void 0,z.createBlock([z.createVariableStatement(void 0,z.createVariableDeclarationList([z.createVariableDeclaration(i,void 0,z.createObjectLiteral([]))])),z.createForIn(z.createVariableDeclarationList([z.createVariableDeclaration(n,void 0)]),r,z.createBlock([z.setEmitFlags(z.createIf(s,z.createStatement(z.createAssignment(z.createElementAccess(i,n),z.createElementAccess(r,n)))),1)])),z.createStatement(z.createCall(y,void 0,[i]))],!0))}function m(e){switch(e.kind){case 238:var t,r=e;return r.importClause&&w(z.getLocalNameForExternalImport(r,_)),O(r)?(i=z.getOriginalNodeId(r),I[i]=g(I[i],r)):t=g(t,r),z.singleOrMany(t);case 237:var n,i=e;return z.Debug.assert(z.isExternalModuleImportEqualsDeclaration(i),"import= for internal module references should be handled in an earlier transformer."),w(z.getLocalNameForExternalImport(i,_)),O(i)?(r=z.getOriginalNodeId(i),I[r]=v(I[r],i)):n=v(n,i),z.singleOrMany(n);case 244:return;case 243:var s=e;if(!s.isExportEquals){var a=z.visitNode(s.expression,F,z.isExpression),o=s.original;if(!o||!O(o))return G(z.createIdentifier("default"),a,!0);o=z.getOriginalNodeId(s),I[o]=k(I[o],z.createIdentifier("default"),a,!0)}return;default:return P(e)}}function A(e){if(z.isBindingPattern(e.name))for(var t=0,r=e.name.elements;t<r.length;t++){var n=r[t];z.isOmittedExpression(n)||A(n)}else w(z.getSynthesizedClone(e.name))}function D(e){return 0==(2097152&z.getEmitFlags(e))&&(265===C.kind||0==(3&z.getOriginalNode(e).flags))}function N(e,t){t=t?V:H;return z.isBindingPattern(e.name)?z.flattenDestructuringAssignment(e,F,E,0,!1,t):e.initializer?t(e.name,z.visitNode(e.initializer,F,z.isExpression)):e.name}function V(e,t,r){return n(e,t,r,!0)}function H(e,t,r){return n(e,t,r,!1)}function n(e,t,r,n){return w(z.getSynthesizedClone(e)),n?x(e,B(z.setTextRange(z.createAssignment(e,t),r))):B(z.setTextRange(z.createAssignment(e,t),r))}function O(e){return 0!=(4194304&z.getEmitFlags(e))}function g(e,t){if(!f.exportEquals){t=t.importClause;if(t){t.name&&(e=T(e,t));var r=t.namedBindings;if(r)switch(r.kind){case 240:e=T(e,r);break;case 241:for(var n=0,i=r.elements;n<i.length;n++)e=T(e,i[n])}}}return e}function v(e,t){return f.exportEquals?e:T(e,t)}function R(e,t,r){if(!f.exportEquals)for(var n=0,i=t.declarationList.declarations;n<i.length;n++){var s=i[n];(s.initializer||r)&&(e=function e(t,r,n){if(f.exportEquals)return t;if(z.isBindingPattern(r.name))for(var i=0,s=r.name.elements;i<s.length;i++){var a=s[i];z.isOmittedExpression(a)||(t=e(t,a,n))}else{var o;z.isGeneratedIdentifier(r.name)||(o=void 0,n&&(t=k(t,r.name,z.getLocalName(r)),o=z.idText(r.name)),t=T(t,r,o))}return t}(e,s,r))}return e}function L(e,t){var r;return f.exportEquals||(z.hasModifier(t,1)&&(e=k(e,r=z.hasModifier(t,512)?z.createLiteral("default"):t.name,z.getLocalName(t)),r=z.getTextOfIdentifierOrLiteral(r)),t.name&&(e=T(e,t,r))),e}function T(e,t,r){if(!f.exportEquals){var n=z.getDeclarationName(t),t=f.exportSpecifiers.get(z.idText(n));if(t)for(var i=0,s=t;i<s.length;i++){var a=s[i];a.name.escapedText!==r&&(e=k(e,a.name,n))}}return e}function k(e,t,r,n){return e=z.append(e,G(t,r,n))}function G(e,t,r){e=z.createStatement(x(e,t));return z.startOnNewLine(e),r||z.setEmitFlags(e,1536),e}function x(e,t){e=z.isIdentifier(e)?z.createLiteral(e):e;return z.setEmitFlags(t,1536|z.getEmitFlags(t)),z.setCommentRange(z.createCall(y,void 0,[e,t]),t)}function P(e){switch(e.kind){case 208:var t=e;if(!D(t.declarationList))return z.visitNode(t,F,z.isStatement);for(var r,n,i=z.hasModifier(t,1),s=O(t),a=0,o=t.declarationList.declarations;a<o.length;a++){var l=o[a];l.initializer?r=z.append(r,N(l,i&&!s)):A(l)}return r&&(n=z.append(n,z.setTextRange(z.createStatement(z.inlineExpressions(r)),t))),s?(x=z.getOriginalNodeId(t),I[x]=R(I[x],t,i)):n=R(n,t,!1),z.singleOrMany(n);case 228:return x=e,S=z.hasModifier(x,1)?z.append(S,z.updateFunctionDeclaration(x,x.decorators,z.visitNodes(x.modifiers,j,z.isModifier),x.asteriskToken,z.getDeclarationName(x,!0,!0),void 0,z.visitNodes(x.parameters,F,z.isParameterDeclaration),void 0,z.visitNode(x.body,F,z.isBlock))):z.append(S,z.visitEachChild(x,F,E)),void(O(x)?(t=z.getOriginalNodeId(x),I[t]=L(I[t],x)):S=L(S,x));case 229:return v=e,k=z.getLocalName(v),w(k),T=z.append(T,z.setTextRange(z.createStatement(z.createAssignment(k,z.setTextRange(z.createClassExpression(void 0,v.name,void 0,z.visitNodes(v.heritageClauses,F,z.isHeritageClause),z.visitNodes(v.members,F,z.isClassElement)),v))),v)),O(v)?(k=z.getOriginalNodeId(v),I[k]=L(I[k],v)):T=L(T,v),z.singleOrMany(T);case 214:return k=C,C=v=e,v=z.updateFor(v,M(v.initializer),z.visitNode(v.condition,F,z.isExpression),z.visitNode(v.incrementor,F,z.isExpression),z.visitNode(v.statement,P,z.isStatement)),C=k,v;case 215:return b=C,C=y=e,y=z.updateForIn(y,M(y.initializer),z.visitNode(y.expression,F,z.isExpression),z.visitNode(y.statement,P,z.isStatement,z.liftToBlock)),C=b,y;case 216:return b=C,C=y=e,y=z.updateForOf(y,y.awaitModifier,M(y.initializer),z.visitNode(y.expression,F,z.isExpression),z.visitNode(y.statement,P,z.isStatement,z.liftToBlock)),C=b,y;case 212:return _=e,z.updateDo(_,z.visitNode(_.statement,P,z.isStatement,z.liftToBlock),z.visitNode(_.expression,F,z.isExpression));case 213:return _=e,z.updateWhile(_,z.visitNode(_.expression,F,z.isExpression),z.visitNode(_.statement,P,z.isStatement,z.liftToBlock));case 222:return z.updateLabel(e,e.label,z.visitNode(e.statement,P,z.isStatement,z.liftToBlock));case 220:return f=e,z.updateWith(f,z.visitNode(f.expression,F,z.isExpression),z.visitNode(f.statement,P,z.isStatement,z.liftToBlock));case 221:return f=e,z.updateSwitch(f,z.visitNode(f.expression,F,z.isExpression),z.visitNode(f.caseBlock,P,z.isCaseBlock));case 235:return g=C,C=m=e,m=z.updateCaseBlock(e,z.visitNodes(e.clauses,P,z.isCaseOrDefaultClause)),C=g,m;case 257:return g=e,z.updateCaseClause(g,z.visitNode(g.expression,F,z.isExpression),z.visitNodes(g.statements,P,z.isStatement));case 258:case 224:return z.visitEachChild(e,P,E);case 260:return m=C,C=h=e,h=z.updateCatchClause(e,e.variableDeclaration,z.visitNode(e.block,P,z.isBlock)),C=m,h;case 207:return h=C,C=p=e,p=z.visitEachChild(e,P,E),C=h,p;case 290:return O(p=e)&&208===p.original.kind&&(u=z.getOriginalNodeId(p),d=z.hasModifier(p.original,1),I[u]=R(I[u],p.original,d)),p;case 291:return u=e,d=z.getOriginalNodeId(u),(c=I[d])?(delete I[d],z.append(c,u)):u;default:return F(e)}var c,u,d,p,h,m,g,f,_,y,b,v,T,k,x}function M(e){if(!e)return e;if(s=e,z.isVariableDeclarationList(s)&&D(s)){for(var t=void 0,r=0,n=e.declarations;r<n.length;r++){var i=n[r],t=z.append(t,N(i,!1));i.initializer||A(i)}return t?z.inlineExpressions(t):z.createOmittedExpression()}return z.visitEachChild(e,P,E);var s}function F(e){var t;return 1024&e.transformFlags&&194===e.kind?r((t=e).left)?z.flattenDestructuringAssignment(t,F,E,0,!0):z.visitEachChild(t,F,E):z.isImportCall(e)?(t=e,z.createCall(z.createPropertyAccess(a,z.createIdentifier("import")),void 0,z.some(t.arguments)?[z.visitNode(t.arguments[0],F)]:[])):2048&e.transformFlags||67108864&e.transformFlags?z.visitEachChild(e,F,E):e}function r(e){return z.isAssignmentExpression(e,!0)?r(e.left):z.isSpreadElement(e)?r(e.expression):z.isObjectLiteralExpression(e)?z.some(e.properties,r):z.isArrayLiteralExpression(e)?z.some(e.elements,r):z.isShorthandPropertyAssignment(e)?r(e.name):z.isPropertyAssignment(e)?r(e.initializer):!!z.isIdentifier(e)&&void 0!==(e=c.getReferencedExportContainer(e))&&265===e.kind}function j(e){switch(e.kind){case 84:case 79:return}return e}function K(e){var t,r;return z.isGeneratedIdentifier(e)||(r=c.getReferencedImportDeclaration(e)||c.getReferencedValueDeclaration(e))&&((e=c.getReferencedExportContainer(e,!1))&&265===e.kind&&(t=z.append(t,z.getDeclarationName(r))),t=z.addRange(t,f&&f.exportedBindings[z.getOriginalNodeId(r)])),t}function B(e){return(o=void 0===o?[]:o)[z.getNodeId(e)]=!0,e}}})(ts=ts||{}),(l=>{l.transformES2015Module=function(i){var n,s=i.getCompilerOptions(),a=i.onEmitNode,r=i.onSubstituteNode;return i.onEmitNode=function(e,t,r){l.isSourceFile(t)?(a(e,n=t,r),n=void 0):a(e,t,r)},i.onSubstituteNode=function(e,t){if(t=r(e,t),l.isIdentifier(t)&&1===e)return(e=>{if(4096&l.getEmitFlags(e)){var t=l.getExternalHelpersModuleName(n);if(t)return l.createPropertyAccess(t,e)}return e})(t);return t},i.enableEmitNotification(265),i.enableSubstitution(71),function(e){var t,r,n;if(!e.isDeclarationFile&&(l.isExternalModule(e)||s.isolatedModules))return(t=l.getOrCreateExternalHelpersModuleNameIfNeeded(e,s))?(r=[],n=l.addPrologue(r,e.statements),l.append(r,l.createImportDeclaration(void 0,void 0,l.createImportClause(void 0,l.createNamespaceImport(t)),l.createLiteral(l.externalHelpersModuleNameText))),l.addRange(r,l.visitNodes(e.statements,o,l.isStatement,n)),l.updateSourceFileNode(e,l.setTextRange(l.createNodeArray(r),e.statements))):l.visitEachChild(e,o,i);return e};function o(e){switch(e.kind){case 237:return;case 243:return(t=e).isExportEquals?void 0:t}var t;return e}}})(ts=ts||{}),(E=>{E.getTransformers=function(e,t){var r=e.jsx,n=E.getEmitScriptTarget(e),e=E.getEmitModuleKind(e),i=[];return E.addRange(i,t&&t.before),i.push(E.transformTypeScript),2===r&&i.push(E.transformJsx),n<5&&i.push(E.transformESNext),n<4&&i.push(E.transformES2017),n<3&&i.push(E.transformES2016),n<2&&(i.push(E.transformES2015),i.push(E.transformGenerators)),i.push((e=>{switch(e){case E.ModuleKind.ESNext:case E.ModuleKind.ES2015:return E.transformES2015Module;case E.ModuleKind.System:return E.transformSystemModule;default:return E.transformModule}})(e)),n<1&&i.push(E.transformES5),E.addRange(i,t&&t.after),i},E.transformNodes=function(e,t,r,n,i,s){for(var a,o,l,c=new Array(292),u=[],d=[],p=0,h=!1,m=function(e,t){return t},g=function(e,t,r){return r(e,t)},f=0,_={getCompilerOptions:function(){return r},getEmitResolver:function(){return e},getEmitHost:function(){return t},startLexicalEnvironment:function(){E.Debug.assert(0<f,"Cannot modify the lexical environment during initialization."),E.Debug.assert(f<2,"Cannot modify the lexical environment after transformation has completed."),E.Debug.assert(!h,"Lexical environment is suspended."),u[p]=a,d[p]=o,p++,a=void 0,o=void 0},suspendLexicalEnvironment:function(){E.Debug.assert(0<f,"Cannot modify the lexical environment during initialization."),E.Debug.assert(f<2,"Cannot modify the lexical environment after transformation has completed."),E.Debug.assert(!h,"Lexical environment is already suspended."),h=!0},resumeLexicalEnvironment:function(){E.Debug.assert(0<f,"Cannot modify the lexical environment during initialization."),E.Debug.assert(f<2,"Cannot modify the lexical environment after transformation has completed."),E.Debug.assert(h,"Lexical environment is not suspended."),h=!1},endLexicalEnvironment:function(){var e;{var t;E.Debug.assert(0<f,"Cannot modify the lexical environment during initialization."),E.Debug.assert(f<2,"Cannot modify the lexical environment after transformation has completed."),E.Debug.assert(!h,"Lexical environment is suspended."),(a||o)&&(o&&(e=o.slice()),a)&&(t=E.createVariableStatement(void 0,E.createVariableDeclarationList(a)),e?e.push(t):e=[t])}a=u[--p],o=d[p],0===p&&(u=[],d=[]);return e},hoistVariableDeclaration:function(e){E.Debug.assert(0<f,"Cannot modify the lexical environment during initialization."),E.Debug.assert(f<2,"Cannot modify the lexical environment after transformation has completed.");e=E.setEmitFlags(E.createVariableDeclaration(e),64);a?a.push(e):a=[e]},hoistFunctionDeclaration:function(e){E.Debug.assert(0<f,"Cannot modify the lexical environment during initialization."),E.Debug.assert(f<2,"Cannot modify the lexical environment after transformation has completed."),o?o.push(e):o=[e]},requestEmitHelper:function(e){E.Debug.assert(0<f,"Cannot modify the transformation context during initialization."),E.Debug.assert(f<2,"Cannot modify the transformation context after transformation has completed."),E.Debug.assert(!e.scoped,"Cannot request a scoped emit helper."),l=E.append(l,e)},readEmitHelpers:function(){E.Debug.assert(0<f,"Cannot modify the transformation context during initialization."),E.Debug.assert(f<2,"Cannot modify the transformation context after transformation has completed.");var e=l;return l=void 0,e},enableSubstitution:function(e){E.Debug.assert(f<2,"Cannot modify the transformation context after transformation has completed."),c[e]|=1},enableEmitNotification:function(e){E.Debug.assert(f<2,"Cannot modify the transformation context after transformation has completed."),c[e]|=2},isSubstitutionEnabled:k,isEmitNotificationEnabled:x,get onSubstituteNode(){return m},set onSubstituteNode(e){E.Debug.assert(f<1,"Cannot modify transformation hooks after initialization has completed."),E.Debug.assert(void 0!==e,"Value must not be 'undefined'"),m=e},get onEmitNode(){return g},set onEmitNode(e){E.Debug.assert(f<1,"Cannot modify transformation hooks after initialization has completed."),E.Debug.assert(void 0!==e,"Value must not be 'undefined'"),g=e}},y=0,b=n;y<b.length;y++){var v=b[y];E.disposeEmitNodes(E.getSourceFileOfNode(E.getParseTreeNode(v)))}E.performance.mark("beforeTransform");var T=E.chain.apply(void 0,i)(_),f=1,i=E.map(n,s?T:function(e){return!e||E.isSourceFile(e)&&e.isDeclarationFile?e:T(e)});return f=2,E.performance.mark("afterTransform"),E.performance.measure("transformTime","beforeTransform","afterTransform"),{transformed:i,substituteNode:function(e,t){return E.Debug.assert(f<3,"Cannot substitute a node after the result is disposed."),t&&k(t)&&m(e,t)||t},emitNodeWithNotification:function(e,t,r){E.Debug.assert(f<3,"Cannot invoke TransformationResult callbacks after the result is disposed."),t&&(x(t)?g(e,t,r):r(e,t))},dispose:function(){if(f<3){for(var e=0,t=n;e<t.length;e++){var r=t[e];E.disposeEmitNodes(E.getSourceFileOfNode(E.getParseTreeNode(r)))}l=g=m=d=o=u=a=void 0,f=3}}};function k(e){return 0!=(1&c[e.kind])&&0==(4&E.getEmitFlags(e))}function x(e){return 0!=(2&c[e.kind])||0!=(2&E.getEmitFlags(e))}}})(ts=ts||{}),(T=>{var k={emittedLine:1,emittedColumn:1,sourceLine:1,sourceColumn:1,sourceIndex:0},n=(T.createSourceMapWriter=function(n,i){var l,s,a,o,c,u,d,p,h=n.getCompilerOptions(),m=h.extendedDiagnostics,g=!(h.sourceMap||h.inlineSourceMap);return{initialize:function(e,t,r){g||(p&&_(),o=-1,c=s=l=void 0,u=k,d=0,(p={sourceMapFilePath:t,jsSourceMappingURL:h.inlineSourceMap?void 0:T.getBaseFileName(T.normalizeSlashes(t)),sourceMapFile:T.getBaseFileName(T.normalizeSlashes(e)),sourceMapSourceRoot:h.sourceRoot||"",sourceMapSources:[],inputSourceFileNames:[],sourceMapNames:[],sourceMapMappings:"",sourceMapSourcesContent:h.inlineSources?[]:void 0,sourceMapDecodedMappings:[]}).sourceMapSourceRoot=T.normalizeSlashes(p.sourceMapSourceRoot),p.sourceMapSourceRoot.length&&47!==p.sourceMapSourceRoot.charCodeAt(p.sourceMapSourceRoot.length-1)&&(p.sourceMapSourceRoot+=T.directorySeparator),h.mapRoot?(a=T.normalizeSlashes(h.mapRoot),265===r.kind&&(a=T.getDirectoryPath(T.getSourceFilePathInNewDir(r,n,a))),T.isRootedDiskPath(a)||T.isUrl(a)?p.jsSourceMappingURL=T.combinePaths(a,p.jsSourceMappingURL):(a=T.combinePaths(n.getCommonSourceDirectory(),a),p.jsSourceMappingURL=T.getRelativePathToDirectoryOrUrl(T.getDirectoryPath(T.normalizePath(e)),T.combinePaths(a,p.jsSourceMappingURL),n.getCurrentDirectory(),n.getCanonicalFileName,!0))):a=T.getDirectoryPath(T.normalizePath(e)))},reset:_,getSourceMapData:function(){return p},setSourceFile:v,emitPos:b,emitNodeWithSourceMap:function(e,t,r){if(g)return r(e,t);{var n,i,s,a,o;t&&(a=t.emitNode,n=a&&a.flags,a=a&&a.sourceMapRange,i=(s=a||t).pos,s=s.end,(a=(a=a&&a.source)===(o=l)?void 0:a)&&v(a),287!==t.kind&&0==(16&n)&&0<=i&&b(f(i)),a&&v(o),64&n?(g=!0,r(e,t),g=!1):r(e,t),a&&v(a),287!==t.kind&&0==(32&n)&&0<=s&&b(s),a)&&v(o)}},emitTokenWithSourceMap:function(e,t,r,n){if(g)return n(t,r);var e=e&&e.emitNode,i=e&&e.flags,e=e&&e.tokenSourceMapRanges&&e.tokenSourceMapRanges[t];r=f(e?e.pos:r),0==(128&i)&&0<=r&&b(r);r=n(t,r),e&&(r=e.end);0==(256&i)&&0<=r&&b(r);return r},getText:t,getSourceMappingURL:function(){var e;if(!g)return h.inlineSourceMap?(e=T.convertToBase64(t()),p.jsSourceMappingURL="data:application/json;base64,"+e):p.jsSourceMappingURL}};function f(e){return l.skipTrivia?l.skipTrivia(e):T.skipTrivia(s,e)}function _(){g||(p=d=u=c=o=a=l=void 0)}function y(){if(c&&c!==u){var e=u.emittedColumn;if(u.emittedLine===c.emittedLine)p.sourceMapMappings&&(p.sourceMapMappings+=",");else{for(var t=u.emittedLine;t<c.emittedLine;t++)p.sourceMapMappings+=";";e=1}p.sourceMapMappings+=r(c.emittedColumn-e),p.sourceMapMappings+=r(c.sourceIndex-u.sourceIndex),p.sourceMapMappings+=r(c.sourceLine-u.sourceLine),p.sourceMapMappings+=r(c.sourceColumn-u.sourceColumn),0<=c.nameIndex&&(T.Debug.assert(!1,"We do not support name index right now, Make sure to update updateLastEncodedAndRecordedSpans when we start using this"),p.sourceMapMappings+=r(c.nameIndex-d),d=c.nameIndex),u=c,p.sourceMapDecodedMappings.push(u)}}function b(e){var t,r;g||T.positionIsSynthesized(e)||(m&&T.performance.mark("beforeSourcemap"),(e=T.getLineAndCharacterOfPosition(l,e)).line++,e.character++,t=i.getLine(),r=i.getColumn(),!c||c.emittedLine!==t||c.emittedColumn!==r||c.sourceIndex===o&&(c.sourceLine>e.line||c.sourceLine===e.line&&c.sourceColumn>e.character)?(y(),c={emittedLine:t,emittedColumn:r,sourceLine:e.line,sourceColumn:e.character,sourceIndex:o}):(c.sourceLine=e.line,c.sourceColumn=e.character,c.sourceIndex=o),m&&(T.performance.mark("afterSourcemap"),T.performance.measure("Source Map","beforeSourcemap","afterSourcemap")))}function v(e){g||(s=(l=e).text,e=h.sourceRoot?n.getCommonSourceDirectory():a,e=T.getRelativePathToDirectoryOrUrl(e,l.fileName,n.getCurrentDirectory(),n.getCanonicalFileName,!0),-1===(o=T.indexOf(p.sourceMapSources,e))&&(o=p.sourceMapSources.length,p.sourceMapSources.push(e),p.inputSourceFileNames.push(l.fileName),h.inlineSources)&&p.sourceMapSourcesContent.push(l.text))}function t(){if(!g)return y(),JSON.stringify({version:3,file:p.sourceMapFile,sourceRoot:p.sourceMapSourceRoot,sources:p.sourceMapSources,names:p.sourceMapNames,mappings:p.sourceMapMappings,sourcesContent:p.sourceMapSourcesContent})}},"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/");function r(e){e<0?e=1+(-e<<1):e<<=1;var t="";do{var r=31&e;0<(e>>=5)&&(r|=32),t+=(e=>{if(e<64)return n.charAt(e);throw TypeError(e+": not a 64 based value")})(r)}while(0<e);return t}})(ts=ts||{}),(C=>{C.createCommentWriter=function(e,a){var o,t,l,c,u,h=e.extendedDiagnostics,d=C.getNewLineCharacter(e),m=-1,g=-1,f=-1,_=!1,y=e.removeComments;return{reset:function(){t=void 0,l=void 0,c=void 0,u=void 0},setWriter:function(e){o=e},setSourceFile:function(e){l=(t=e).text,c=C.getLineStarts(t),u=void 0},emitNodeWithComments:function(e,t,r){var n,i,s,a,o,l,c,u,d,p;y?r(e,t):t&&(_=!1,n=t.emitNode,i=n&&n.flags,a=n&&n.commentRange||t,s=a.pos,a=a.end,s<0&&a<0||s===a?b(e,t,n,i,r):(h&&C.performance.mark("preEmitNodeWithComment"),o=287!==t.kind,l=s<0||0!=(512&i)||10===t.kind,c=a<0||0!=(1024&i)||10===t.kind,l||T(s,o),u=m,d=g,p=f,l||(m=s),c||(g=a,227===t.kind&&(f=a)),h&&C.performance.measure("commentTime","preEmitNodeWithComment"),b(e,t,n,i,r),h&&C.performance.mark("postEmitNodeWithComment"),m=u,g=d,f=p,!c&&o&&E(a,k),h&&C.performance.measure("commentTime","postEmitNodeWithComment")))},emitBodyWithDetachedComments:function(e,t,r){h&&C.performance.mark("preEmitBodyWithDetachedComments");var n=t.pos,i=t.end,s=C.getEmitFlags(e),i=y||i<0||0!=(1024&s);n<0||0!=(512&s)||(e=>{(e=C.emitDetachedComments(l,c,o,S,e,d,y))&&(u?u.push(e):u=[e])})(t);h&&C.performance.measure("commentTime","preEmitBodyWithDetachedComments");2048&s&&!y?(y=!0,r(e),y=!1):r(e);h&&C.performance.mark("beginEmitBodyWithDetachedCommetns");i||(T(t.end,!0),_&&!o.isAtStartOfLine()&&o.writeLine());h&&C.performance.measure("commentTime","beginEmitBodyWithDetachedCommetns")},emitTrailingCommentsOfPosition:function(e,t){y||(h&&C.performance.mark("beforeEmitTrailingCommentsOfPosition"),E(e,t?k:i),h&&C.performance.measure("commentTime","beforeEmitTrailingCommentsOfPosition"))},emitLeadingCommentsOfPosition:function(e){y||-1===e||T(e,!0)}};function b(e,t,r,n,i){var s=r&&r.leadingComments,i=(C.some(s)&&(h&&C.performance.mark("preEmitNodeWithSynthesizedComments"),C.forEach(s,p),h)&&C.performance.measure("commentTime","preEmitNodeWithSynthesizedComments"),s=e,e=t,t=i,2048&n?(y=!0,t(s,e),y=!1):t(s,e),r&&r.trailingComments);C.some(i)&&(h&&C.performance.mark("postEmitNodeWithSynthesizedComments"),C.forEach(i,v),h)&&C.performance.measure("commentTime","postEmitNodeWithSynthesizedComments")}function p(e){2===e.kind&&o.writeLine(),r(e),e.hasTrailingNewLine||2===e.kind?o.writeLine():o.write(" ")}function v(e){o.isAtStartOfLine()||o.write(" "),r(e),e.hasTrailingNewLine&&o.writeLine()}function r(e){var t=3===(t=e).kind?"/*"+t.text+"*/":"//"+t.text,e=3===e.kind?C.computeLineStarts(t):void 0;C.writeCommentRange(t,e,o,0,t.length,d)}function T(e,t){_=!1,t?x(e,s):0===e&&x(e,n)}function n(e,t,r,n,i){C.isRecognizedTripleSlashComment(l,e,t)&&s(e,t,0,n,i)}function s(e,t,r,n,i){_||(C.emitNewLineBeforeLeadingCommentOfPosition(c,o,i,e),_=!0),a&&a(e),C.writeCommentRange(l,c,o,e,t,d),a&&a(t),n?o.writeLine():o.write(" ")}function k(e,t,r,n){o.isAtStartOfLine()||o.write(" "),a&&a(e),C.writeCommentRange(l,c,o,e,t,d),a&&a(t),n&&o.writeLine()}function i(e,t,r,n){a&&a(e),C.writeCommentRange(l,c,o,e,t,d),a&&a(t),n?o.writeLine():o.write(" ")}function x(e,t){var r,n;-1!==m&&e===m||(n=e,void 0!==u&&C.lastOrUndefined(u).nodePos===n?(n=t,r=C.lastOrUndefined(u).detachedCommentEndPos,u.length-1?u.pop():u=void 0,C.forEachLeadingCommentRange(l,r,n,r)):C.forEachLeadingCommentRange(l,e,t,e))}function E(e,t){(-1===g||e!==g&&e!==f)&&C.forEachTrailingCommentRange(l,e,t)}function S(e,t,r,n,i,s){a&&a(n),C.writeCommentRange(e,t,r,n,i,s),a&&a(i)}}})(ts=ts||{}),(ye=>{function a(a,u,r,F,e,B){var d,p,h,m,g,f,_,n,y,i,s,$,o,l,c,t=266===e.kind?e.sourceFiles:[e],b=266===e.kind,v=a.getNewLine(),T=a.getCompilerOptions(),k=(j(),!1),x=T.removeComments?ye.noop:function(e){{var t;e&&(t=ye.getJSDocCommentRanges(e,y,T),ye.emitNewLineBeforeLeadingComments(i,f,e,t),ye.emitComments(y,i,f,t,!1,!0,v,ye.writeCommentRange))}},U=T.stripInternal?function(e){{var t;e&&(t=ye.getLeadingCommentRanges(y,e.pos),ye.forEach(t,G)||_e(e))}}:_e,E=!0,S=[],C="",V=[],H=!1,w=[];return ye.forEach(t,function(t){var e;ye.isSourceFileJavaScript(t)||(T.noResolve||ye.forEach(t.referencedFiles,function(e){e=ye.tryResolveScriptReference(a,t,e);e&&!ye.contains(V,e)&&(((r,n,e)=>{var i,s=!1;return r.isDeclarationFile?i=r.fileName:ye.forEachEmittedFile(a,function(e,t){t=266===t.kind;t&&!n||(ye.Debug.assert(!!e.declarationFilePath||ye.isSourceFileJavaScript(r),"Declaration file is not present only for javascript files"),i=e.declarationFilePath||e.jsFilePath,s=t)},r,e),i&&(i=ye.getRelativePathToDirectoryOrUrl(ye.getDirectoryPath(ye.normalizeSlashes(F)),i,a.getCurrentDirectory(),a.getCanonicalFileName,!1),C+='/// <reference path="'+i+'" />'+v),s})(e,!b&&!H,B)&&(H=!0),V.push(e))}),n=!1,b&&ye.isExternalModule(t)?ye.isExternalModule(t)&&(E=!1,d('declare module "'+ye.getResolvedExternalModuleName(a,t)+'" {'),p(),h(),Q(t),m(),d("}"),p()):(E=!0,Q(t)),S.length&&(e=f,ye.forEach(S,function(e){if(e.isVisible&&!e.asynchronousOutput){ye.Debug.assert(238===e.node.kind),j(),ye.Debug.assert(0===e.indent||1===e.indent&&b);for(var t=0;t<e.indent;t++)h();ie(e.node),e.asynchronousOutput=f.getText();for(t=0;t<e.indent;t++)m()}}),K(e),w=w.concat(S),S=[]),!b&&ye.isExternalModule(t)&&t.moduleAugmentations.length&&!n&&(d("export {};"),p()))}),c&&ye.forEachKey(c,function(e){C+='/// <reference types="'+e+'" />'+v}),{reportedDeclarationError:k,moduleElementDeclarationEmitInfo:w,synchronousDeclarationOutput:f.getText(),referencesOutput:C};function G(e){e=y.substring(e.pos,e.end);return ye.stringContains(e,"@internal")}function j(){var e=ye.createTextWriter(v);e.trackSymbol=J,e.reportInaccessibleThisError=X,e.reportPrivateInBaseOfClassExpression=Y,e.writeKeyword=e.write,e.writeOperator=e.write,e.writePunctuation=e.write,e.writeSpace=e.write,e.writeStringLiteral=e.writeLiteral,e.writeParameter=e.write,e.writeProperty=e.write,e.writeSymbol=e.write,K(e)}function K(e){d=(f=e).write,g=e.writeTextOfNode,p=e.writeLine,h=e.increaseIndent,m=e.decreaseIndent}function z(e){var t=f;ye.forEach(e,function(e){226===e.kind?t=e.parent.parent:241===e.kind||242===e.kind||239===e.kind?ye.Debug.fail("We should be getting ImportDeclaration instead to write"):t=e;var t,e=ye.forEach(S,function(e){return e.node===t?e:void 0});if(e=!e&&l?ye.forEach(l,function(e){return e.node===t?e:void 0}):e)if(238===e.node.kind)e.isVisible=!0;else{j();for(var r=e.indent;r;r--)h();233===t.kind&&(ye.Debug.assert(void 0===l),l=[]),re(t),233===t.kind&&(e.subModuleElementDeclarationEmitInfo=l,l=void 0),e.asynchronousOutput=f.getText()}}),K(t)}function W(e){if(e){c=c||ye.createMap();for(var t=0,r=e;t<r.length;t++){var n=r[t];c.has(n)||c.set(n,n)}}}function q(e){var t;0===e.accessibility?e&&e.aliasesToMakeVisible&&z(e.aliasesToMakeVisible):(k=!0,(t=f.getSymbolAccessibilityDiagnostic(e))&&(t.typeName?r.add(ye.createDiagnosticForNode(e.errorNode||t.errorNode,t.diagnosticMessage,ye.getTextOfNodeFromSourceText(y,t.typeName),e.errorSymbolName,e.errorModuleName)):r.add(ye.createDiagnosticForNode(e.errorNode||t.errorNode,t.diagnosticMessage,e.errorSymbolName,e.errorModuleName))))}function J(e,t,r){q(u.isSymbolAccessible(e,t,r,!0)),W(u.getTypeReferenceDirectivesForSymbol(e,r))}function Y(e){o&&(k=!0,r.add(ye.createDiagnosticForNode(o,ye.Diagnostics.Property_0_of_exported_class_expression_may_not_be_private_or_protected,e)))}function X(){o&&(k=!0,r.add(ye.createDiagnosticForNode(o,ye.Diagnostics.The_inferred_type_of_0_references_an_inaccessible_this_type_A_type_annotation_is_necessary,ye.declarationNameToString(o))))}function I(e,t,r){f.getSymbolAccessibilityDiagnostic=r,d(": ");r=146===e.kind&&(u.isRequiredInitializedParameter(e)||u.isOptionalUninitializedParameterProperty(e));t&&!r?O(t):(o=e.name,u.writeTypeOfDeclaration(e,_,16388|(r?8192:0),f),o=void 0)}function A(e){for(var t=0,r=e;t<r.length;t++){var n=r[t];U(n)}}function Z(e,t,r,n){for(var i=f.getTextPos(),s=0,a=e;s<a.length;s++){var o=a[s];n&&!n(o)||(i!==f.getTextPos()&&d(t),i=f.getTextPos(),r(o))}}function D(e,t,r){Z(e,", ",t,r)}function N(e,t){f.getSymbolAccessibilityDiagnostic=t,O(e)}function O(e){switch(e.kind){case 119:case 136:case 133:case 122:case 134:case 137:case 105:case 139:case 95:case 130:case 169:case 173:return g(y,e);case 201:return a=e,void(ye.isEntityNameExpression(a.expression)&&(ye.Debug.assert(71===a.expression.kind||179===a.expression.kind),l(a.expression),a.typeArguments)&&(d("<"),D(a.typeArguments,O),d(">")));case 159:return l((a=e).typeName),void(a.typeArguments&&(d("<"),D(a.typeArguments,O),d(">")));case 162:return s=e,d("typeof "),void l(s.exprName);case 164:return O(e.elementType),void d("[]");case 165:return s=e,d("["),D(s.elementTypes,O),void d("]");case 166:return void Z(e.types," | ",O);case 167:return void Z(e.types," & ",O);case 168:return i=e,d("("),O(i.type),void d(")");case 170:return i=e,d(ye.tokenToString(i.operator)),d(" "),void O(i.type);case 171:return O((t=e).objectType),d("["),O(t.indexType),void d("]");case 172:var t=e,r=_;return _=t,d("{"),p(),h(),t.readonlyToken&&d("readonly "),d("["),o(t.typeParameter.name),d(" in "),O(t.typeParameter.constraint),d("]"),t.questionToken&&d("?"),d(": "),O(t.type),d(";"),p(),m(),d("}"),void(_=r);case 160:case 161:return me(e);case 163:r=e;return d("{"),r.members.length&&(p(),h(),A(r.members),m()),void d("}");case 71:case 143:return l(e);case 158:return g(y,(n=e).parameterName),d(" is "),void O(n.type)}var n,t,i,s,a;function o(e){var t;71===e.kind?g(y,e):(t=143===e.kind?e.left:e.expression,e=143===e.kind?e.right:e.name,o(t),d("."),g(y,e))}function l(e){q(u.isEntityNameVisible(e,237===e.parent.kind?e.parent:_)),W(u.getTypeReferenceDirectivesForEntityName(e)),o(e)}}function Q(e){y=e.text,i=ye.getLineStarts(e),s=e.identifiers,$=ye.isExternalModule(e),_=e,ye.emitDetachedComments(y,i,f,ye.writeCommentRange,e,v,!0),A(e.statements)}function ee(e,t,r,n){t=(e=>{if(!s.has(e))return e;for(var t=0;;){var r=e+"_"+ ++t;if(!s.has(r))return r}})(t);return n&&d("declare "),d("const "),d(t),d(": "),f.getSymbolAccessibilityDiagnostic=function(){return r},u.writeTypeOfExpression(e,_,16388,f),d(";"),p(),t}function te(e,t){var r;t?re(e):(237===e.kind||265===e.parent.kind&&$)&&(t=void 0,(l&&265!==e.parent.kind?l:(238===e.kind&&(r=e).importClause&&(t=r.importClause.name&&u.isDeclarationVisible(r.importClause)||ne(r.importClause.namedBindings)),S)).push({node:e,outputPos:f.getTextPos(),indent:f.getIndent(),isVisible:t}))}function re(e){switch(e.kind){case 228:return he(e);case 208:return t=e,ye.every(t.declarationList&&t.declarationList.declarations,function(e){return e.name&&ye.isEmptyBindingPattern(e.name)})||(x(t),R(t),ye.isLet(t.declarationList)?d("let "):ye.isConst(t.declarationList)?d("const "):d("var "),D(t.declarationList.declarations,ue,u.isDeclarationVisible),d(";"),p());case 230:var t=e,r=(x(t),R(t),d("interface "),g(y,t.name),_),n=(M((_=t).typeParameters),ye.filter(ye.getInterfaceBaseTypeNodes(t),function(e){return ye.isEntityNameExpression(e.expression)}));return n&&n.length&&le(n,!1),d(" {"),p(),h(),A(t.members),m(),d("}"),p(),void(_=r);case 229:var n=e,r=_,i=(_=n,ye.getClassExtendsHeritageClauseElement(n)),s=(i&&!ye.isEntityNameExpression(i.expression)&&(s=95===i.expression.kind?"null":ee(i.expression,n.name.escapedText+"_base",{diagnosticMessage:ye.Diagnostics.extends_clause_of_exported_class_0_has_or_is_using_private_name_1,errorNode:i,typeName:n.name},!ye.findAncestor(n,function(e){return 233===e.kind}))),x(n),R(n),ye.hasModifier(n,128)&&d("abstract "),d("class "),g(y,n.name),M(n.typeParameters),i&&(ye.isEntityNameExpression(i.expression)?le([i],!1):(d(" extends "),d(s),i.typeArguments&&(d("<"),D(i.typeArguments,O),d(">")))),le(ye.getClassImplementsHeritageClauseElements(n),!0),d(" {"),p(),h(),ye.getFirstConstructorWithBody(n));return s&&ye.forEach(s.parameters,function(e){ye.hasModifier(e,92)&&ce(e)}),A(n.members),m(),d("}"),p(),void(_=r);case 231:return i=_,x(_=c=e),R(c),d("type "),g(y,c.name),M(c.typeParameters),d(" = "),N(c.type,function(){return{diagnosticMessage:ye.Diagnostics.Exported_type_alias_0_has_or_is_using_private_name_1,errorNode:c.type,typeName:c.name}}),d(";"),p(),_=i;case 232:var a=e;return x(a),R(a),ye.isConst(a)&&d("const "),d("enum "),g(y,a.name),d(" {"),p(),h(),A(a.members),m(),d("}"),void p();case 233:var o=e;for(x(o),R(o),ye.isGlobalScopeAugmentation(o)?d("global "):(16&o.flags?d("namespace "):d("module "),ye.isExternalModuleAugmentation(o)?P(o):g(y,o.name));o.body&&234!==o.body.kind;)o=o.body,d("."),g(y,o.name);a=_;return void(o.body?(_=o,d(" {"),p(),h(),A(o.body.statements),m(),d("}"),p(),_=a):d(";"));case 237:var l=e;return x(l),ye.hasModifier(l,1)&&d("export "),d("import "),g(y,l.name),d(" = "),ye.isInternalModuleImportEqualsDeclaration(l)?(N(l.moduleReference,function(){return{diagnosticMessage:ye.Diagnostics.Import_declaration_0_is_using_private_name_1,errorNode:l,typeName:l.name}}),d(";")):(d("require("),P(l),d(");")),void f.writeLine();case 238:return ie(e);default:ye.Debug.fail("Unknown symbol kind")}var c,t}function R(e){var t;265===e.parent.kind&&(1&(t=ye.getModifierFlags(e))&&d("export "),512&t?d("default "):230!==e.kind&&E&&d("declare "))}function L(e){8&e?d("private "):16&e&&d("protected "),32&e&&d("static "),64&e&&d("readonly "),128&e&&d("abstract ")}function ne(e){if(e)return 240===e.kind?u.isDeclarationVisible(e):ye.forEach(e.elements,function(e){return u.isDeclarationVisible(e)})}function ie(e){var t;x(e),ye.hasModifier(e,1)&&d("export "),d("import "),e.importClause&&(t=f.getTextPos(),e.importClause.name&&u.isDeclarationVisible(e.importClause)&&g(y,e.importClause.name),e.importClause.namedBindings&&ne(e.importClause.namedBindings)&&(t!==f.getTextPos()&&d(", "),240===e.importClause.namedBindings.kind?(d("* as "),g(y,e.importClause.namedBindings.name)):(d("{ "),D(e.importClause.namedBindings.elements,se,u.isDeclarationVisible),d(" }"))),d(" from ")),P(e),d(";"),f.writeLine()}function P(e){var t;if(n=n||233!==e.kind,9===(t=237===e.kind?ye.getExternalModuleImportEqualsDeclarationExpression(e):233===e.kind?e.name:e.moduleSpecifier).kind&&b&&(T.out||T.outFile)){e=ye.getExternalModuleNameFromDeclaration(a,u,e);if(e)return d('"'),d(e),void d('"')}g(y,t)}function se(e){e.propertyName&&(g(y,e.propertyName),d(" as ")),g(y,e.name)}function ae(e){se(e),z(u.collectLinkedAliases(e.propertyName||e.name))}function oe(e){return 151===e.parent.kind&&ye.hasModifier(e.parent,8)}function M(e){e&&(d("<"),D(e,function(t){function e(){var e;switch(t.parent.kind){case 229:e=ye.Diagnostics.Type_parameter_0_of_exported_class_has_or_is_using_private_name_1;break;case 230:e=ye.Diagnostics.Type_parameter_0_of_exported_interface_has_or_is_using_private_name_1;break;case 156:e=ye.Diagnostics.Type_parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1;break;case 155:e=ye.Diagnostics.Type_parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1;break;case 151:case 150:e=ye.hasModifier(t.parent,32)?ye.Diagnostics.Type_parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1:229===t.parent.parent.kind?ye.Diagnostics.Type_parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1:ye.Diagnostics.Type_parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1;break;case 228:e=ye.Diagnostics.Type_parameter_0_of_exported_function_has_or_is_using_private_name_1;break;case 231:e=ye.Diagnostics.Type_parameter_0_of_exported_type_alias_has_or_is_using_private_name_1;break;default:ye.Debug.fail("This is unknown parent for type parameter: "+t.parent.kind)}return{diagnosticMessage:e,errorNode:t,typeName:t.name}}h(),x(t),m(),g(y,t.name),t.constraint&&!oe(t)&&(d(" extends "),160===t.parent.kind||161===t.parent.kind||t.parent.parent&&163===t.parent.parent.kind?(ye.Debug.assert(151===t.parent.kind||150===t.parent.kind||160===t.parent.kind||161===t.parent.kind||155===t.parent.kind||156===t.parent.kind),O(t.constraint)):N(t.constraint,e)),t.default&&!oe(t)&&(d(" = "),160===t.parent.kind||161===t.parent.kind||t.parent.parent&&163===t.parent.parent.kind?(ye.Debug.assert(151===t.parent.kind||150===t.parent.kind||160===t.parent.kind||161===t.parent.kind||155===t.parent.kind||156===t.parent.kind),O(t.default)):N(t.default,e))}),d(">"))}function le(e,r){e&&(d(r?" implements ":" extends "),D(e,function(t){ye.isEntityNameExpression(t.expression)?N(t,function(){var e;e=229===t.parent.parent.kind?r?ye.Diagnostics.Implements_clause_of_exported_class_0_has_or_is_using_private_name_1:ye.Diagnostics.extends_clause_of_exported_class_0_has_or_is_using_private_name_1:ye.Diagnostics.extends_clause_of_exported_interface_0_has_or_is_using_private_name_1;return{diagnosticMessage:e,errorNode:t,typeName:ye.getNameOfDeclaration(t.parent.parent)}}):r||95!==t.expression.kind||d("null")}))}function ce(e){ye.hasDynamicName(e)||(x(e),L(ye.getModifierFlags(e)),ue(e),d(";"),p())}function ue(t){function r(e){return 226===t.kind?e.errorModuleName?2===e.accessibility?ye.Diagnostics.Exported_variable_0_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:ye.Diagnostics.Exported_variable_0_has_or_is_using_name_1_from_private_module_2:ye.Diagnostics.Exported_variable_0_has_or_is_using_private_name_1:149===t.kind||148===t.kind||146===t.kind&&ye.hasModifier(t.parent,8)?ye.hasModifier(t,32)?e.errorModuleName?2===e.accessibility?ye.Diagnostics.Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:ye.Diagnostics.Public_static_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2:ye.Diagnostics.Public_static_property_0_of_exported_class_has_or_is_using_private_name_1:229===t.parent.kind||146===t.kind?e.errorModuleName?2===e.accessibility?ye.Diagnostics.Public_property_0_of_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:ye.Diagnostics.Public_property_0_of_exported_class_has_or_is_using_name_1_from_private_module_2:ye.Diagnostics.Public_property_0_of_exported_class_has_or_is_using_private_name_1:e.errorModuleName?ye.Diagnostics.Property_0_of_exported_interface_has_or_is_using_name_1_from_private_module_2:ye.Diagnostics.Property_0_of_exported_interface_has_or_is_using_private_name_1:void 0}function e(e){for(var t=[],r=0,n=e.elements;r<n.length;r++){var i=n[r];200!==i.kind&&t.push(i)}D(t,s)}function s(t){t.name&&(ye.isBindingPattern(t.name)?e(t.name):(g(y,t.name),I(t,void 0,function(e){return void 0!==(e=r(e))?{diagnosticMessage:e,errorNode:t,typeName:t.name}:void 0})))}226===t.kind&&!u.isDeclarationVisible(t)||(ye.isBindingPattern(t.name)?e(t.name):(g(y,t.name),(149===t.kind||148===t.kind||146===t.kind&&!ye.isParameterPropertyDeclaration(t))&&ye.hasQuestionToken(t)&&d("?"),149!==t.kind&&148!==t.kind||163!==t.parent.kind?u.isLiteralConstDeclaration(t)?(d(" = "),u.writeLiteralConstValue(t,f)):ye.hasModifier(t,8)||I(t,t.type,function(e){e=r(e);return void 0!==e?{diagnosticMessage:e,errorNode:t,typeName:t.name}:void 0}):de(t)))}function de(e){e.type&&(d(": "),O(e.type))}function pe(e){var t,r,n;function i(e){if(e)return 153===e.kind?e.type:0<e.parameters.length?e.parameters[0].type:void 0}ye.hasDynamicName(e)||e===(r=ye.getAllAccessorDeclarations(e.parent.members,e)).firstAccessor&&(x(r.getAccessor),x(r.setAccessor),L(ye.getModifierFlags(e)|(r.setAccessor?0:64)),g(y,e.name),ye.hasModifier(e,8)||(!(n=i(t=e))&&(n=i(r=153===e.kind?r.setAccessor:r.getAccessor))&&(t=r),I(e,n,function(e){return 154===t.kind?{diagnosticMessage:ye.hasModifier(t.parent,32)?e.errorModuleName?ye.Diagnostics.Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_name_1_from_private_module_2:ye.Diagnostics.Parameter_0_of_public_static_property_setter_from_exported_class_has_or_is_using_private_name_1:e.errorModuleName?ye.Diagnostics.Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_name_1_from_private_module_2:ye.Diagnostics.Parameter_0_of_public_property_setter_from_exported_class_has_or_is_using_private_name_1,errorNode:t.parameters[0],typeName:t.name}:{diagnosticMessage:ye.hasModifier(t,32)?e.errorModuleName?2===e.accessibility?ye.Diagnostics.Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:ye.Diagnostics.Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_name_0_from_private_module_1:ye.Diagnostics.Return_type_of_public_static_property_getter_from_exported_class_has_or_is_using_private_name_0:e.errorModuleName?2===e.accessibility?ye.Diagnostics.Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:ye.Diagnostics.Return_type_of_public_property_getter_from_exported_class_has_or_is_using_name_0_from_private_module_1:ye.Diagnostics.Return_type_of_public_property_getter_from_exported_class_has_or_is_using_private_name_0,errorNode:t.name,typeName:void 0}})),d(";"),p())}function he(e){ye.hasDynamicName(e)||u.isImplementationOfOverload(e)||(x(e),228===e.kind?R(e):151!==e.kind&&152!==e.kind||L(ye.getModifierFlags(e)),228===e.kind?(d("function "),g(y,e.name)):152===e.kind?d("constructor"):(g(y,e.name),ye.hasQuestionToken(e)&&d("?")),ge(e))}function me(e){x(e),ge(e)}function ge(r){var e=_,t=!1;if(157===(_=r).kind)L(ye.getModifierFlags(r)),d("[");else{if(152===r.kind&&ye.hasModifier(r,8))return d("();"),void p();156===r.kind||161===r.kind?d("new "):160===r.kind&&(s=f.getText(),r.typeParameters)&&"<"===s.charAt(s.length-1)&&(t=!0,d("(")),M(r.typeParameters),d("(")}D(r.parameters,fe),d(157===r.kind?"]":")");var n,i,s=160===r.kind||161===r.kind;s||163===r.parent.kind?r.type&&(d(s?" => ":": "),O(r.type)):152===r.kind||ye.hasModifier(r,8)||(n=r,i=function(e){var t;switch(r.kind){case 156:t=e.errorModuleName?ye.Diagnostics.Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:ye.Diagnostics.Return_type_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_0;break;case 155:t=e.errorModuleName?ye.Diagnostics.Return_type_of_call_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:ye.Diagnostics.Return_type_of_call_signature_from_exported_interface_has_or_is_using_private_name_0;break;case 157:t=e.errorModuleName?ye.Diagnostics.Return_type_of_index_signature_from_exported_interface_has_or_is_using_name_0_from_private_module_1:ye.Diagnostics.Return_type_of_index_signature_from_exported_interface_has_or_is_using_private_name_0;break;case 151:case 150:t=ye.hasModifier(r,32)?e.errorModuleName?2===e.accessibility?ye.Diagnostics.Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:ye.Diagnostics.Return_type_of_public_static_method_from_exported_class_has_or_is_using_name_0_from_private_module_1:ye.Diagnostics.Return_type_of_public_static_method_from_exported_class_has_or_is_using_private_name_0:229===r.parent.kind?e.errorModuleName?2===e.accessibility?ye.Diagnostics.Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:ye.Diagnostics.Return_type_of_public_method_from_exported_class_has_or_is_using_name_0_from_private_module_1:ye.Diagnostics.Return_type_of_public_method_from_exported_class_has_or_is_using_private_name_0:e.errorModuleName?ye.Diagnostics.Return_type_of_method_from_exported_interface_has_or_is_using_name_0_from_private_module_1:ye.Diagnostics.Return_type_of_method_from_exported_interface_has_or_is_using_private_name_0;break;case 228:t=e.errorModuleName?2===e.accessibility?ye.Diagnostics.Return_type_of_exported_function_has_or_is_using_name_0_from_external_module_1_but_cannot_be_named:ye.Diagnostics.Return_type_of_exported_function_has_or_is_using_name_0_from_private_module_1:ye.Diagnostics.Return_type_of_exported_function_has_or_is_using_private_name_0;break;default:ye.Debug.fail("This is unknown kind for signature: "+r.kind)}return{diagnosticMessage:t,errorNode:r.name||r}},f.getSymbolAccessibilityDiagnostic=i,d(": "),n.type?O(n.type):(o=n.name,u.writeReturnTypeOfSignatureDeclaration(n,_,16388,f),o=void 0)),_=e,s?t&&d(")"):(d(";"),p())}function fe(t){function r(e){174===e.kind?(d("{"),D(e.elements,n),d("}")):175===e.kind&&(d("["),D(e=e.elements,n),e&&e.hasTrailingComma&&d(", "),d("]"))}function n(e){200===e.kind?d(" "):176===e.kind&&(e.propertyName&&(g(y,e.propertyName),d(": ")),e.name)&&(ye.isBindingPattern(e.name)?r(e.name):(ye.Debug.assert(71===e.name.kind),e.dotDotDotToken&&d("..."),g(y,e.name)))}h(),x(t),t.dotDotDotToken&&d("..."),ye.isBindingPattern(t.name)?r(t.name):g(y,t.name),u.isOptionalParameter(t)&&d("?"),m(),160===t.parent.kind||161===t.parent.kind||163===t.parent.parent.kind?de(t):ye.hasModifier(t.parent,8)||I(t,t.type,function(e){e=(e=>{switch(t.parent.kind){case 152:return e.errorModuleName?2===e.accessibility?ye.Diagnostics.Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:ye.Diagnostics.Parameter_0_of_constructor_from_exported_class_has_or_is_using_name_1_from_private_module_2:ye.Diagnostics.Parameter_0_of_constructor_from_exported_class_has_or_is_using_private_name_1;case 156:return e.errorModuleName?ye.Diagnostics.Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:ye.Diagnostics.Parameter_0_of_constructor_signature_from_exported_interface_has_or_is_using_private_name_1;case 155:return e.errorModuleName?ye.Diagnostics.Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:ye.Diagnostics.Parameter_0_of_call_signature_from_exported_interface_has_or_is_using_private_name_1;case 157:return e.errorModuleName?ye.Diagnostics.Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_name_1_from_private_module_2:ye.Diagnostics.Parameter_0_of_index_signature_from_exported_interface_has_or_is_using_private_name_1;case 151:case 150:return ye.hasModifier(t.parent,32)?e.errorModuleName?2===e.accessibility?ye.Diagnostics.Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:ye.Diagnostics.Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_name_1_from_private_module_2:ye.Diagnostics.Parameter_0_of_public_static_method_from_exported_class_has_or_is_using_private_name_1:229===t.parent.parent.kind?e.errorModuleName?2===e.accessibility?ye.Diagnostics.Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:ye.Diagnostics.Parameter_0_of_public_method_from_exported_class_has_or_is_using_name_1_from_private_module_2:ye.Diagnostics.Parameter_0_of_public_method_from_exported_class_has_or_is_using_private_name_1:e.errorModuleName?ye.Diagnostics.Parameter_0_of_method_from_exported_interface_has_or_is_using_name_1_from_private_module_2:ye.Diagnostics.Parameter_0_of_method_from_exported_interface_has_or_is_using_private_name_1;case 228:return e.errorModuleName?2===e.accessibility?ye.Diagnostics.Parameter_0_of_exported_function_has_or_is_using_name_1_from_external_module_2_but_cannot_be_named:ye.Diagnostics.Parameter_0_of_exported_function_has_or_is_using_name_1_from_private_module_2:ye.Diagnostics.Parameter_0_of_exported_function_has_or_is_using_private_name_1;default:ye.Debug.fail("This is unknown parent for parameter: "+t.parent.kind)}})(e);return void 0!==e?{diagnosticMessage:e,errorNode:t,typeName:t.name}:void 0})}function _e(e){switch(e.kind){case 228:case 233:case 237:case 230:case 229:case 231:case 232:return te(e,u.isDeclarationVisible(e));case 208:return te(e,ye.forEach(e.declarationList.declarations,function(e){return u.isDeclarationVisible(e)}));case 238:return te(e,!e.importClause);case 244:return x(n=e),d("export "),n.exportClause?(d("{ "),D(n.exportClause.elements,ae),d(" }")):d("*"),n.moduleSpecifier&&(d(" from "),P(n)),d(";"),void f.writeLine();case 152:case 151:case 150:return he(e);case 156:case 155:case 157:return me(e);case 153:case 154:return pe(e);case 149:case 148:return ce(e);case 264:return x(n=e),g(y,n.name),void 0!==(n=u.getConstantValue(n))&&(d(" = "),d(ye.getTextOfConstantValue(n))),d(","),void p();case 243:return 71===(t=e).expression.kind?(d(t.isExportEquals?"export = ":"export default "),g(y,t.expression)):(r=ee(t.expression,"_default",{diagnosticMessage:ye.Diagnostics.Default_export_of_the_module_has_or_is_using_private_name_0,errorNode:t},E),d(t.isExportEquals?"export = ":"export default "),d(r)),d(";"),p(),void(71===t.expression.kind&&z(u.collectLinkedAliases(t.expression)));case 265:return Q(e)}var t,r,n}}ye.getDeclarationDiagnostics=function(r,n,e){var i=ye.createDiagnosticCollection();return ye.forEachEmittedFile(r,function(e,t){e=e.declarationFilePath;a(r,n,i,e,t,!1)},e),i.getDiagnostics(e?e.fileName:void 0)},ye.writeDeclarationFile=function(e,t,r,n,i,s){var n=a(r,n,i,e,t,s);return(s=n.reportedDeclarationError||r.isEmitBlocked(e)||r.getCompilerOptions().noEmit)||(t=266===t.kind?t.sourceFiles:[t],n=n.referencesOutput+function t(r,e){var n=0;var i="";ye.forEach(e,function(e){e.asynchronousOutput&&(i=(i+=r.substring(n,e.outputPos))+t(e.asynchronousOutput,e.subModuleElementDeclarationEmitInfo),n=e.outputPos)});i+=r.substring(n);return i}(n.synchronousDeclarationOutput,n.moduleElementDeclarationEmitInfo),ye.writeFile(r,i,e,n,r.getCompilerOptions().emitBOM,t)),s}})(ts=ts||{}),(nt=>{(e=[""])[16]=",",e[4]=" |",e[8]=" &";var e,it=e,st=((e=[])[512]=["{","}"],e[1024]=["(",")"],e[2048]=["<",">"],e[4096]=["[","]"],e);function n(e,t,r,n){var r=nt.isArray(r)?r:nt.getSourceFilesToEmit(e,r),i=e.getCompilerOptions();if(i.outFile||i.out)r.length&&t({jsFilePath:o=i.outFile||i.out,sourceMapFilePath:c(o,i),declarationFilePath:i.declaration?nt.removeFileExtension(o)+".d.ts":""},nt.createBundle(r),n);else for(var s=0,a=r;s<a.length;s++){var o,l=a[s];t({jsFilePath:o=nt.getOwnEmitOutputFilePath(l,e,((e,t)=>{if(1===t.jsx)if(nt.isSourceFileJavaScript(e)){if(nt.fileExtensionIs(e.fileName,".jsx"))return".jsx"}else if(1===e.languageVariant)return".jsx";return".js"})(l,i)),sourceMapFilePath:c(o,i),declarationFilePath:nt.isSourceFileJavaScript(l)||!n&&!i.declaration?void 0:nt.getDeclarationEmitOutputFilePath(l,e)},l,n)}}function c(e,t){return t.sourceMap?e+".map":void 0}function b(T,e){void 0===T&&(T={});var k,y,b,v,$,n,a,t,U=(e=void 0===e?{}:e).hasGlobalName,V=e.onEmitSourceMapOfNode,H=e.onEmitSourceMapOfToken,G=e.onEmitSourceMapOfPosition,i=e.onEmitNode,j=e.onEmitHelpers,K=e.onSetSourceFile,z=e.substituteNode,g=e.onBeforeEmitNodeArray,W=e.onAfterEmitNodeArray,q=e.onBeforeEmitToken,J=e.onAfterEmitToken,Y=nt.getNewLineCharacter(T),r=nt.createCommentWriter(T,G),X=r.emitNodeWithComments,Z=r.emitBodyWithDetachedComments,x=r.emitTrailingCommentsOfPosition,Q=r.emitLeadingCommentsOfPosition;return ue(),{printNode:function(e,t,r){switch(e){case 0:nt.Debug.assert(nt.isSourceFile(t),"Expected a SourceFile node.");break;case 2:nt.Debug.assert(nt.isIdentifier(t),"Expected an Identifier node.");break;case 1:nt.Debug.assert(nt.isExpression(t),"Expected an Expression node.")}switch(t.kind){case 265:return te(t);case 266:return ee(t)}return re(e,t,r,se()),ae()},printFile:te,printBundle:ee,writeNode:re,writeFile:ie,writeBundle:ne};function ee(e){return ne(e,se()),ae()}function te(e){return ie(e,se()),ae()}function re(e,t,r,n){var i=a;ce(n),oe(e,t,r),ue(),a=i}function ne(e,t){var r=a;ce(t),Fe(e),Me(e),_e(e);for(var n=0,i=e.sourceFiles;n<i.length;n++){var s=i[n];oe(0,s,s)}ue(),a=r}function ie(e,t){var r=a;ce(t),Fe(e),Me(e),oe(0,e,e),ue(),a=r}function se(){return t=t||nt.createTextWriter(Y)}function ae(){var e=t.getText();return t.reset(),e}function oe(e,t,r){r&&le(r),l(e,t)}function le(e){k=e,r.setSourceFile(e),K&&K(e)}function ce(e){a=e,r.setWriter(e)}function ue(){y=[],b=[],v=nt.createMap(),$=[],n=0,r.reset(),ce(void 0)}function o(e){e&&E(e)}function E(e){l(4,e)}function de(e){l(2,e)}function S(e){l(1,e)}function l(e,t){i?i(e,t,pe):pe(e,t)}function pe(e,t){t=fe(e,t),X&&0!==e?X(e,t,he):he(e,t)}function he(e,t){V&&0!==e&&2!==e?V(e,t,me):me(e,t)}function me(e,t){switch(e){case 0:s=t,nt.Debug.assertNode(s,nt.isSourceFile);f();var r=s.statements;if(Z)if(0===r.length||!nt.isPrologueDirective(r[0])||nt.nodeIsSynthesized(r[0]))return void Z(s,r,Le);return void Le(s);case 2:return r=t,nt.Debug.assertNode(r,nt.isIdentifier),void be(r);case 1:return ge(t);case 3:return E((s=nt.cast(t,nt.isTypeParameterDeclaration)).name),O(" in "),void E(s.constraint);case 4:var n=t,i=n.kind;if(nt.isKeyword(i))Ge(n);else{switch(i){case 14:case 15:case 16:return ye(n);case 71:return be(n);case 143:return(e=>{var t=e.left;(71===t.kind?S:E)(t),O("."),E(e.right)})(n);case 144:return(e=>{O("["),S(e.expression),O("]")})(n);case 145:return(e=>{E(e.name),c(" extends ",e.constraint),c(" = ",e.default)})(n);case 146:return(e=>{A(e,e.decorators),w(e,e.modifiers),o(e.dotDotDotToken),e.name&&E(e.name),o(e.questionToken),e.parent&&273===e.parent.kind&&!e.name?E(e.type):c(": ",e.type),I(" = ",e.initializer)})(n);case 147:return(e=>{O("@"),S(e.expression)})(n);case 148:return(e=>{A(e,e.decorators),w(e,e.modifiers),E(e.name),o(e.questionToken),c(": ",e.type),O(";")})(n);case 149:return(e=>{A(e,e.decorators),w(e,e.modifiers),E(e.name),o(e.questionToken),c(": ",e.type),I(" = ",e.initializer),O(";")})(n);case 150:return(e=>{A(e,e.decorators),w(e,e.modifiers),E(e.name),o(e.questionToken),d(e,e.typeParameters),p(e,e.parameters),c(": ",e.type),O(";")})(n);case 151:return(e=>{A(e,e.decorators),w(e,e.modifiers),o(e.asteriskToken),E(e.name),o(e.questionToken),C(e,Se)})(n);case 152:return(e=>{w(e,e.modifiers),O("constructor"),C(e,Se)})(n);case 153:case 154:return(e=>{A(e,e.decorators),w(e,e.modifiers),O(153===e.kind?"get ":"set "),E(e.name),C(e,Se)})(n);case 155:return(e=>{A(e,e.decorators),w(e,e.modifiers),d(e,e.typeParameters),p(e,e.parameters),c(": ",e.type),O(";")})(n);case 156:return(e=>{A(e,e.decorators),w(e,e.modifiers),O("new "),d(e,e.typeParameters),p(e,e.parameters),c(": ",e.type),O(";")})(n);case 157:return(e=>{A(e,e.decorators),w(e,e.modifiers),N(e,e.parameters,4432),c(": ",e.type),O(";")})(n);case 158:return(e=>{E(e.parameterName),O(" is "),E(e.type)})(n);case 159:return(e=>{E(e.typeName),D(e,e.typeArguments)})(n);case 160:return(e=>{d(e,e.typeParameters),Ue(e,e.parameters),O(" => "),E(e.type)})(n);case 273:return(e=>{O("function"),p(e,e.parameters),O(":"),E(e.type)})(n);case 161:return(e=>{O("new "),d(e,e.typeParameters),p(e,e.parameters),O(" => "),E(e.type)})(n);case 162:return(e=>{O("typeof "),E(e.exprName)})(n);case 163:return(e=>{O("{");var t=1&nt.getEmitFlags(e)?448:65;N(e,e.members,262144|t),O("}")})(n);case 164:return(e=>{E(e.elementType),O("[]")})(n);case 165:return(e=>{O("["),N(e,e.elementTypes,336),O("]")})(n);case 166:return(e=>{N(e,e.types,260)})(n);case 167:return(e=>{N(e,e.types,264)})(n);case 168:return(e=>{O("("),E(e.type),O(")")})(n);case 201:return(e=>{S(e.expression),D(e,e.typeArguments)})(n);case 169:return void O("this");case 170:return(e=>{M(e.operator),O(" "),E(e.type)})(n);case 171:return(e=>{E(e.objectType),O("["),E(e.indexType),O("]")})(n);case 172:return(e=>{var t=nt.getEmitFlags(e);O("{"),1&t?O(" "):(f(),R()),e.readonlyToken&&(E(e.readonlyToken),O(" ")),O("["),l(3,e.typeParameter),O("]"),o(e.questionToken),O(": "),E(e.type),O(";"),1&t?O(" "):(f(),L()),O("}")})(n);case 173:return(e=>{S(e.literal)})(n);case 268:return void O("*");case 269:return void O("?");case 270:return(e=>{O("?"),E(e.type)})(n);case 271:return(e=>{O("!"),E(e.type)})(n);case 272:return(e=>{E(e.type),O("=")})(n);case 274:return(e=>{O("..."),E(e.type)})(n);case 174:return(e=>{var t=e.elements;0===t.length?O("{}"):(O("{"),N(e,t,432),O("}"))})(n);case 175:return(e=>{0===e.elements.length?O("[]"):(O("["),N(e,e.elements,304),O("]"))})(n);case 176:return(e=>{$e(e.propertyName,": "),o(e.dotDotDotToken),E(e.name),I(" = ",e.initializer)})(n);case 205:return(e=>{S(e.expression),E(e.literal)})(n);case 206:return void O(";");case 207:return(e=>{P(17,e.pos,e),Te(e,!e.multiLine&&Xe(e)),R(),Q(e.statements.end),L(),P(18,e.statements.end,e)})(n);case 208:return(e=>{w(e,e.modifiers),E(e.declarationList),O(";")})(n);case 209:return void O(";");case 210:return(e=>{S(e.expression),O(";")})(n);case 211:return(e=>{var t=P(90,e.pos,e);O(" "),P(19,t,e),S(e.expression),P(20,e.expression.end,e),u(e,e.thenStatement),e.elseStatement&&(je(e),P(82,e.thenStatement.end,e),211===e.elseStatement.kind?(O(" "),E(e.elseStatement)):u(e,e.elseStatement))})(n);case 212:return(e=>{O("do"),u(e,e.statement),nt.isBlock(e.statement)?O(" "):je(e),O("while ("),S(e.expression),O(");")})(n);case 213:return(e=>{O("while ("),S(e.expression),O(")"),u(e,e.statement)})(n);case 214:return(e=>{var t=P(88,e.pos);O(" "),P(19,t,e),ke(e.initializer),O(";"),I(" ",e.condition),O(";"),I(" ",e.incrementor),O(")"),u(e,e.statement)})(n);case 215:return(e=>{var t=P(88,e.pos);O(" "),P(19,t),ke(e.initializer),O(" in "),S(e.expression),P(20,e.expression.end),u(e,e.statement)})(n);case 216:return(e=>{var t=P(88,e.pos);O(" "),$e(e.awaitModifier," "),P(19,t),ke(e.initializer),O(" of "),S(e.expression),P(20,e.expression.end),u(e,e.statement)})(n);case 217:return(e=>{P(77,e.pos),c(" ",e.label),O(";")})(n);case 218:return(e=>{P(72,e.pos),c(" ",e.label),O(";")})(n);case 219:return(e=>{var t=96,r=e.pos,n=e,i=n&&nt.getParseTreeNode(n);i&&i.kind===n.kind&&(r=nt.skipTrivia(k.text,r)),r=P(t,r,n),i&&i.kind===n.kind&&x(r,!0),I(" ",e.expression),O(";")})(n);case 220:return(e=>{O("with ("),S(e.expression),O(")"),u(e,e.statement)})(n);case 221:return(e=>{var t=P(98,e.pos);O(" "),P(19,t),S(e.expression),P(20,e.expression.end),O(" "),E(e.caseBlock)})(n);case 222:return(e=>{E(e.label),O(": "),E(e.statement)})(n);case 223:return(e=>{O("throw"),I(" ",e.expression),O(";")})(n);case 224:return(e=>{O("try "),E(e.tryBlock),e.catchClause&&(je(e),E(e.catchClause)),e.finallyBlock&&(je(e),O("finally "),E(e.finallyBlock))})(n);case 225:return(e=>{P(78,e.pos),O(";")})(n);case 226:return(e=>{E(e.name),c(": ",e.type),I(" = ",e.initializer)})(n);case 227:return(e=>{O(nt.isLet(e)?"let ":nt.isConst(e)?"const ":"var "),N(e,e.declarations,272)})(n);case 228:return(e=>{xe(e)})(n);case 229:return(e=>{Ae(e)})(n);case 230:return(e=>{A(e,e.decorators),w(e,e.modifiers),O("interface "),E(e.name),d(e,e.typeParameters),N(e,e.heritageClauses,256),O(" {"),N(e,e.members,65),O("}")})(n);case 231:return(e=>{A(e,e.decorators),w(e,e.modifiers),O("type "),E(e.name),d(e,e.typeParameters),O(" = "),E(e.type),O(";")})(n);case 232:return(e=>{w(e,e.modifiers),O("enum "),E(e.name),m(),O(" {"),N(e,e.members,81),O("}"),_()})(n);case 233:return(e=>{w(e,e.modifiers),512&~e.flags&&O(16&e.flags?"namespace ":"module "),E(e.name);for(var t=e.body;233===t.kind;)O("."),E(t.name),t=t.body;O(" "),E(t)})(n);case 234:return(e=>{m(),O("{"),Te(e,Xe(e)),O("}"),_()})(n);case 235:return(e=>{P(17,e.pos),N(e,e.clauses,65),P(18,e.clauses.end)})(n);case 236:return(e=>{O("export as namespace "),E(e.name),O(";")})(n);case 237:return(e=>{w(e,e.modifiers),O("import "),E(e.name),O(" = ");e=e.moduleReference;(71===e.kind?S:E)(e),O(";")})(n);case 238:return(e=>{w(e,e.modifiers),O("import "),e.importClause&&(E(e.importClause),O(" from ")),S(e.moduleSpecifier),O(";")})(n);case 239:return(e=>{E(e.name),e.name&&e.namedBindings&&O(", "),E(e.namedBindings)})(n);case 240:return(e=>{O("* as "),E(e.name)})(n);case 241:return(e=>{De(e)})(n);case 242:return(e=>{Ne(e)})(n);case 243:return(e=>{O(e.isExportEquals?"export = ":"export default "),S(e.expression),O(";")})(n);case 244:return(e=>{O("export "),e.exportClause?E(e.exportClause):O("*"),e.moduleSpecifier&&(O(" from "),S(e.moduleSpecifier)),O(";")})(n);case 245:return(e=>{De(e)})(n);case 246:return(e=>{Ne(e)})(n);case 247:return;case 248:return(e=>{O("require("),S(e.expression),O(")")})(n);case 10:return(e=>{a.writeLiteral(h(e,!0))})(n);case 251:return(e=>{O("<"),Oe(e.tagName);var t=e.attributes.properties,r=" ";nt.some(t)&&O(r),e.attributes.properties&&0<e.attributes.properties.length&&E(e.attributes),O(">")})(n);case 252:return(e=>{O("</"),Oe(e.tagName),O(">")})(n);case 253:return(e=>{E(e.name),c("=",e.initializer)})(n);case 254:return(e=>{N(e,e.properties,131328)})(n);case 255:return(e=>{O("{..."),S(e.expression),O("}")})(n);case 256:return(e=>{e.expression&&(O("{"),o(e.dotDotDotToken),S(e.expression),O("}"))})(n);case 257:return(e=>{O("case "),S(e.expression),O(":"),Re(e,e.statements)})(n);case 258:return(e=>{O("default:"),Re(e,e.statements)})(n);case 259:return(e=>{O(" "),M(e.token),O(" "),N(e,e.types,272)})(n);case 260:return(e=>{var t=P(74,e.pos);O(" "),e.variableDeclaration&&(P(19,t),E(e.variableDeclaration),P(20,e.variableDeclaration.end),O(" ")),E(e.block)})(n);case 261:return(e=>{var t;E(e.name),O(": "),e=e.initializer,x&&0==(512&nt.getEmitFlags(e))&&(t=nt.getCommentRange(e),x(t.pos)),S(e)})(n);case 262:return(e=>{E(e.name),e.objectAssignmentInitializer&&(O(" = "),S(e.objectAssignmentInitializer))})(n);case 263:return(e=>{e.expression&&(O("..."),S(e.expression))})(n);case 264:return(e=>{E(e.name),I(" = ",e.initializer)})(n)}if(nt.isExpression(n))return ge(fe(1,n));nt.isToken(n)&&Ge(n)}return}var s}function ge(e){var t,r,n,i,s,a,o,l,c,u,d,p;switch(e.kind){case 8:return void ye(e);case 9:case 12:case 13:return ye(e);case 71:return be(e);case 86:case 95:case 97:case 101:case 99:case 91:return void Ge(e);case 177:return p=e.elements,void Ve(e,p,4466|(e.multiLine?32768:0));case 178:return p=e,(y=65536&nt.getEmitFlags(p))&&R(),_=p.multiLine?32768:0,f=1<=k.languageVersion?32:0,N(p,p.properties,263122|f|_),void(y&&L());case 179:var h,m,g,f=e,_=!1,y=!1;return 131072&nt.getEmitFlags(f)||(h=f.expression.end,m=nt.skipTrivia(k.text,f.expression.end)+1,(g=nt.createToken(23)).pos=h,g.end=m,_=B(f,f.expression,g),y=B(f,g,f.name)),S(f.expression),F(_),O(!_&&(e=>{var t;return e=nt.skipPartiallyEmittedExpressions(e),nt.isNumericLiteral(e)?(t=Qe(e),!e.numericLiteralFlags&&!nt.stringContains(t,nt.tokenToString(23))):nt.isPropertyAccessExpression(e)||nt.isElementAccessExpression(e)?"number"==typeof(t=nt.getConstantValue(e))&&isFinite(t)&&Math.floor(t)===t&&T.removeComments:void 0})(f.expression)?"..":"."),F(y),E(f.name),void ze(_,y);case 180:return S((h=e).expression),O("["),S(h.argumentExpression),void O("]");case 181:return S((m=e).expression),D(m,m.typeArguments),void Ve(m,m.arguments,1296);case 182:return g=e,O("new "),S(g.expression),D(g,g.typeArguments),void Ve(g,g.arguments,9488);case 183:return S((d=e).tag),O(" "),void S(d.template);case 184:return d=e,O("<"),E(d.type),O(">"),void S(d.expression);case 185:return u=e,O("("),S(u.expression),void O(")");case 186:return void xe(e);case 187:return A(u=e,u.decorators),w(u,u.modifiers),void C(u,ve);case 188:return c=e,O("delete "),void S(c.expression);case 189:return c=e,O("typeof "),void S(c.expression);case 190:return l=e,O("void "),void S(l.expression);case 191:return l=e,O("await "),void S(l.expression);case 192:var b=e;return M(b.operator),(e=>{var t=e.operand;return 192===t.kind&&(37===e.operator&&(37===t.operator||43===t.operator)||38===e.operator&&(38===t.operator||44===t.operator))})(b)&&O(" "),void S(b.operand);case 193:return S((b=e).operand),void M(b.operator);case 194:return s=26!==(i=e).operatorToken.kind,a=B(i,i.left,i.operatorToken),o=B(i,i.operatorToken,i.right),S(i.left),F(a,s?" ":void 0),Q(i.operatorToken.pos),Ge(i.operatorToken),x(i.operatorToken.end,!0),F(o," "),S(i.right),void ze(a,o);case 195:return i=B(s=e,s.condition,s.questionToken),a=B(s,s.questionToken,s.whenTrue),o=B(s,s.whenTrue,s.colonToken),n=B(s,s.colonToken,s.whenFalse),S(s.condition),F(i," "),E(s.questionToken),F(a," "),S(s.whenTrue),ze(i,a),F(o," "),E(s.colonToken),F(n," "),S(s.whenFalse),void ze(o,n);case 196:return E((n=e).head),void N(n,n.templateSpans,131072);case 197:return r=e,O("yield"),E(r.asteriskToken),void I(" ",r.expression);case 198:return r=e,O("..."),void S(r.expression);case 199:return void Ae(e);case 200:return;case 202:return S((t=e).expression),void(t.type&&(O(" as "),E(t.type)));case 203:return S(e.expression),void O("!");case 204:return P((t=e).keywordToken,t.pos),O("."),void E(t.name);case 249:return E((v=e).openingElement),N(v,v.children,131072),void E(v.closingElement);case 250:var v=e;return O("<"),Oe(v.tagName),O(" "),v.attributes.properties&&0<v.attributes.properties.length&&E(v.attributes),void O("/>");case 288:return void S(e.expression);case 289:return void Ve(e,e.elements,272)}}function fe(e,t){return t&&z&&z(e,t)||t}function _e(e){j&&j(e,Ke)}function ye(e){var t=Qe(e);!T.sourceMap&&!T.inlineSourceMap||9!==e.kind&&!nt.isTemplateLiteralKind(e.kind)?O(t):a.writeLiteral(t)}function be(e){O(h(e,!1)),D(e,e.typeArguments)}function ve(e){d(e,e.typeParameters),Ue(e,e.parameters),c(": ",e.type),O(" "),E(e.equalsGreaterThanToken)}function Te(e,t){t=t||1&nt.getEmitFlags(e)?384:65;N(e,e.statements,t)}function ke(e){void 0!==e&&(227===e.kind?E:S)(e)}function xe(e){A(e,e.decorators),w(e,e.modifiers),O("function"),o(e.asteriskToken),O(" "),de(e.name),C(e,Se)}function Ee(e,t){Ce(t)}function C(e,t){var r,n=e.body;n?nt.isBlock(n)?((r=65536&nt.getEmitFlags(e))&&R(),524288&nt.getEmitFlags(e)?(t(e),i?i(4,n,Ee):Ce(n)):(m(),t(e),i?i(4,n,Ee):Ce(n),_()),r&&L()):(t(e),O(" "),S(n)):(t(e),O(";"))}function Se(e){d(e,e.typeParameters),p(e,e.parameters),c(": ",e.type)}function Ce(e){O(" {"),R();var t=(e=>{if(1&nt.getEmitFlags(e))return 1;if(!e.multiLine&&(nt.nodeIsSynthesized(e)||nt.rangeIsOnSingleLine(e,k))&&!We(e,e.statements,2)&&!Je(e,e.statements,2)){for(var t,r=0,n=e.statements;r<n.length;r++){var i=n[r];if(qe(t,i,2))return;t=i}return 1}})(e)?we:Ie;Z?Z(e,e.statements,t):t(e),L(),P(18,e.statements.end,e)}function we(e){Ie(e,!0)}function Ie(e,t){var r=Pe(e.statements,!0),n=a.getTextPos();_e(e),0===r&&n===a.getTextPos()&&t?(L(),N(e,e.statements,384),R()):N(e,e.statements,1,r)}function Ae(e){A(e,e.decorators),w(e,e.modifiers),O("class"),Be(" ",e.name,de);var t=65536&nt.getEmitFlags(e);t&&R(),d(e,e.typeParameters),N(e,e.heritageClauses,256),m(),O(" {"),N(e,e.members,65),O("}"),_(),t&&L()}function De(e){O("{"),N(e,e.elements,432),O("}")}function Ne(e){e.propertyName&&(E(e.propertyName),O(" as ")),E(e.name)}function Oe(e){(71===e.kind?S:E)(e)}function Re(e,t){var r=1===t.length&&(nt.nodeIsSynthesized(e)||nt.nodeIsSynthesized(t[0])||nt.rangeStartPositionsAreOnSameLine(e,t[0],k)),n=(0<t.length&&x(t.pos),81985);r&&(O(" "),n&=-66),N(e,t,n)}function Le(e){var t=e.statements,r=(m(),_e(e),nt.findIndex(t,function(e){return!nt.isPrologueDirective(e)}));N(e,t,1,-1===r?t.length:r),_()}function Pe(e,t,r){for(var n=0;n<e.length;n++){var i=e[n];if(!nt.isPrologueDirective(i))return n;r&&r.has(i.expression.text)||((t||0<n)&&f(),E(i),!r)||r.set(i.expression.text,!0)}return e.length}function Me(e){if(nt.isSourceFile(e))le(e),Pe(e.statements);else for(var t=nt.createMap(),r=0,n=e.sourceFiles;r<n.length;r++){var i=n[r];le(i),Pe(i.statements,!0,t)}}function Fe(e){var t;if(nt.isSourceFile(e))return(t=nt.getShebang(e.text))?(O(t),f(),1):void 0;for(var r=0,n=e.sourceFiles;r<n.length;r++)if(Fe(n[r]))break}function w(e,t){t&&t.length&&(N(e,t,131328),O(" "))}function c(e,t){Be(e,t,E)}function I(e,t){Be(e,t,S)}function Be(e,t,r){t&&(O(e),r(t))}function $e(e,t){e&&(E(e),O(t))}function u(e,t){nt.isBlock(t)||1&nt.getEmitFlags(e)?(O(" "),E(t)):(f(),R(),E(t),L())}function A(e,t){N(e,t,24577)}function D(e,t){N(e,t,26960)}function d(e,t){N(e,t,26960)}function p(e,t){N(e,t,1360)}function Ue(e,t){var r,n;r=e,n=t,!(n=nt.singleOrUndefined(n))||n.pos!==r.pos||nt.isArrowFunction(r)&&r.type||nt.some(r.decorators)||nt.some(r.modifiers)||nt.some(r.typeParameters)||nt.some(n.decorators)||nt.some(n.modifiers)||n.dotDotDotToken||n.questionToken||n.type||n.initializer||!nt.isIdentifier(n.name)?p(e,t):N(e,t,336)}function N(e,t,r,n,i){He(E,e,t,r,n,i)}function Ve(e,t,r,n,i){He(S,e,t,r,n,i)}function He(e,t,r,n,i,s){void 0===i&&(i=0),void 0===s&&(s=r?r.length-i:0);var a=void 0===r;if(!(a&&8192&n)){a=a||i>=r.length||0===s;if(a&&16384&n)g&&g(r),W&&W(r);else{if(7680&n&&O(st[7680&n][0]),g&&g(r),a)1&n?f():128&n&&!(262144&n)&&O(" ");else{for(var o=0==(131072&n),l=o,c=(We(t,r,n)?(f(),l=!1):128&n&&O(" "),64&n&&R(),void 0),u=void 0,d=it[28&n],p=0;p<s;p++){var h,m=r[i+p];c&&(d&&c.end!==t.end&&Q(c.end),O(d),qe(c,m,n)?(0==(67&n)&&(R(),u=!0),f(),l=!1):c&&256&n&&O(" ")),l?x&&(h=nt.getCommentRange(m),x(h.pos)):l=o,e(m),u&&(L(),u=!1),c=m}a=32&n&&r.hasTrailingComma;16&n&&a&&O(","),!c||!d||c.end===t.end||1024&nt.getEmitFlags(c)||Q(c.end),64&n&&L(),Je(t,r,n)?f():128&n&&O(" ")}W&&W(r),7680&n&&O(st[7680&n][1])}}}function O(e){a.write(e)}function f(){a.writeLine()}function R(){a.increaseIndent()}function L(){a.decreaseIndent()}function P(e,t,r){return H?H(r,e,t,M):M(e,t)}function Ge(e){q&&q(e),O(nt.tokenToString(e.kind)),J&&J(e)}function M(e,t){e=nt.tokenToString(e);return O(e),t<0?t:t+e.length}function je(e){1&nt.getEmitFlags(e)?O(" "):f()}function Ke(e){for(var t=e.split(/\r\n?|\n/g),r=(e=>{for(var t,r=0,n=e;r<n.length;r++)for(var i=n[r],s=0;s<i.length&&(void 0===t||s<t);s++)if(!nt.isWhiteSpaceLike(i.charCodeAt(s))&&(void 0===t||s<t)){t=s;break}return t})(t),n=0;n<t.length;n++){var i=r?t[n].slice(r):t[n];i.length&&(f(),O(i),f())}}function F(e,t){e?(R(),f()):t&&O(t)}function ze(e,t){e&&L(),t&&L()}function We(e,t,r){return 1&r||2&r&&(32768&r||(void 0===(t=t[0])?!nt.rangeIsOnSingleLine(e,k):nt.positionIsSynthesized(e.pos)||nt.nodeIsSynthesized(t)?Ye(t,r):!nt.rangeStartPositionsAreOnSameLine(e,t,k)))}function qe(e,t,r){return 1&r||(2&r?void 0!==e&&void 0!==t&&(nt.nodeIsSynthesized(e)||nt.nodeIsSynthesized(t)?Ye(e,r)||Ye(t,r):!nt.rangeEndIsOnSameLineAsRangeStart(e,t,k)):t.startsOnNewLine)}function Je(e,t,r){return 1&r?0==(65536&r):2&r&&(32768&r||(void 0===(t=nt.lastOrUndefined(t))?!nt.rangeIsOnSingleLine(e,k):nt.positionIsSynthesized(e.pos)||nt.nodeIsSynthesized(t)?Ye(t,r):!nt.rangeEndPositionsAreOnSameLine(e,t,k)))}function Ye(e,t){return!nt.nodeIsSynthesized(e)||void 0===(e=e.startsOnNewLine)?0!=(32768&t):e}function B(e,t,r){return e=Ze(e),t=Ze(t),!!(r=Ze(r)).startsOnNewLine||!(nt.nodeIsSynthesized(e)||nt.nodeIsSynthesized(t)||nt.nodeIsSynthesized(r)||nt.rangeEndIsOnSameLineAsRangeStart(t,r,k))}function Xe(e){return 0===e.statements.length&&nt.rangeEndIsOnSameLineAsRangeStart(e,e,k)}function Ze(e){for(;185===e.kind&&nt.nodeIsSynthesized(e);)e=e.expression;return e}function h(e,t){var r,n;return nt.isGeneratedIdentifier(e)?4===(r=e).autoGenerateKind?et((e=>{for(var t=e.autoGenerateId,r=e,n=r.original;n&&(r=n,!nt.isIdentifier(r)||4!==r.autoGenerateKind||r.autoGenerateId===t);)n=r.original;return r})(r)):(n=r.autoGenerateId,b[n]||(b[n]=(e=>{switch(e.autoGenerateKind){case 1:return rt(0);case 2:return rt(268435456);case 3:return s(nt.idText(e))}nt.Debug.fail("Unsupported GeneratedIdentifierKind.")})(r))):!nt.isIdentifier(e)||!nt.nodeIsSynthesized(e)&&e.parent?9===e.kind&&e.textSourceNode?h(e.textSourceNode,t):!nt.isLiteralExpression(e)||!nt.nodeIsSynthesized(e)&&e.parent?nt.getSourceTextOfNodeFromSourceFile(k,e,t):e.text:nt.idText(e)}function Qe(e){var t;return 9===e.kind&&e.textSourceNode?(t=e.textSourceNode,nt.isIdentifier(t)?16777216&nt.getEmitFlags(e)?'"'+nt.escapeString(h(t))+'"':'"'+nt.escapeNonAsciiString(h(t))+'"':Qe(t)):nt.getLiteralText(e,k)}function m(){$.push(n),n=0}function _(){n=$.pop()}function et(e){var t=nt.getNodeId(e);return y[t]||(y[t]=(e=>{switch(e.kind){case 71:return s(h(e));case 233:case 232:return(e=>{var t=h(e.name);return((e,t)=>{for(var r=t;nt.isNodeDescendantOf(r,t);r=r.nextContainer)if(r.locals){var n=r.locals.get(nt.escapeLeadingUnderscores(e));if(n&&3253183&n.flags)return}return 1})(t,e)?t:s(t)})(e);case 238:case 244:return(e=>(e=nt.getExternalModuleName(e),s(nt.isStringLiteral(e)?nt.makeIdentifierFromModuleName(e.text):"module")))(e);case 228:case 229:case 243:return s("default");case 199:return s("class");case 151:case 153:case 154:return(e=>nt.isIdentifier(e.name)?et(e.name):rt(0))(e);default:return rt(0)}})(e))}function tt(e){return!(U&&U(e)||k.identifiers.has(e)||v.has(e))}function rt(e){if(e&&!(n&e)&&tt(t=268435456===e?"_i":"_n"))return n|=e,t;for(;;){var t,r=268435455&n;if(n++,8!=r&&13!=r)if(tt(t=r<26?"_"+String.fromCharCode(97+r):"_"+(r-26)))return t}}function s(e){95!==e.charCodeAt(e.length-1)&&(e+="_");for(var t=1;;){var r=e+t;if(tt(r))return v.set(r,!0),r;t++}}}nt.forEachEmittedFile=n,nt.emitFiles=function(i,a,e,s,t){var h,m,g,f=a.getCompilerOptions(),_=nt.getEmitModuleKind(f),o=f.sourceMap||f.inlineSourceMap?[]:void 0,l=f.listEmittedFiles?[]:void 0,c=nt.createDiagnosticCollection(),r=a.getNewLine(),u=nt.createTextWriter(r),d=nt.createSourceMapWriter(a,u),p=!1,r=nt.getSourceFilesToEmit(a,e),e=nt.transformNodes(i,a,f,r,t,!1),y=b(f,{hasGlobalName:i.hasGlobalName,onEmitNode:e.emitNodeWithNotification,substituteNode:e.substituteNode,onEmitSourceMapOfNode:d.emitNodeWithSourceMap,onEmitSourceMapOfToken:d.emitTokenWithSourceMap,onEmitSourceMapOfPosition:d.emitPos,onEmitHelpers:function(e,t){var r=!1,n=266===e.kind?e:void 0;if(!n||_!==nt.ModuleKind.None){for(var i=n?n.sourceFiles.length:1,s=0;s<i;s++){var a=n?n.sourceFiles[s]:e,o=nt.isSourceFile(a)?a:h,l=f.noEmitHelpers||void 0!==nt.getExternalHelpersModuleName(o),c=nt.isSourceFile(a)&&!g,o=nt.getEmitHelpers(a);if(o)for(var u=0,d=nt.stableSort(o,nt.compareEmitHelpers);u<d.length;u++){var p=d[u];if(p.scoped){if(n)continue}else{if(l)continue;if(c){if(m.get(p.name))continue;m.set(p.name,!0)}}t(p.text),r=!0}}return r}},onSetSourceFile:function(e){h=e,d.setSourceFile(e)}});return nt.performance.mark("beforePrint"),n(a,function(e,t){var r=e.jsFilePath,n=e.sourceMapFilePath,e=e.declarationFilePath;a.isEmitBlocked(r)||f.noEmit?p=!0:s||((e,t,r)=>{var n=266===r.kind?r:void 0,i=265===r.kind?r:void 0,s=n?n.sourceFiles:[i];d.initialize(e,t,r),n?(m=nt.createMap(),g=!1,y.writeBundle(n,u)):(g=!0,y.writeFile(i,u)),u.writeLine(),(r=d.getSourceMappingURL())&&u.write("//# sourceMappingURL="+r),f.sourceMap&&!f.inlineSourceMap&&nt.writeFile(a,c,t,d.getText(),!1,s),o&&o.push(d.getSourceMapData()),nt.writeFile(a,c,e,u.getText(),f.emitBOM,s),d.reset(),u.reset(),m=h=void 0,g=!1})(r,n,t);e&&(p=nt.writeDeclarationFile(e,(e=>266===e.kind?nt.updateBundle(e,nt.sameMap(e.sourceFiles,nt.getOriginalSourceFile)):nt.getOriginalSourceFile(e))(t),a,i,c,s)||p);!p&&l&&(s||l.push(r),n&&l.push(n),e)&&l.push(e)},e.transformed,s),nt.performance.measure("printTime","beforePrint"),e.dispose(),{emitSkipped:p,diagnostics:c.getDiagnostics(),emittedFiles:l,sourceMaps:o}},nt.createPrinter=b,(e={None:0,0:"None",SingleLine:0})[0]="SingleLine",e[e.MultiLine=1]="MultiLine",e[e.PreserveLines=2]="PreserveLines",e[e.LinesMask=3]="LinesMask",e[e.NotDelimited=0]="NotDelimited",e[e.BarDelimited=4]="BarDelimited",e[e.AmpersandDelimited=8]="AmpersandDelimited",e[e.CommaDelimited=16]="CommaDelimited",e[e.DelimitersMask=28]="DelimitersMask",e[e.AllowTrailingComma=32]="AllowTrailingComma",e[e.Indented=64]="Indented",e[e.SpaceBetweenBraces=128]="SpaceBetweenBraces",e[e.SpaceBetweenSiblings=256]="SpaceBetweenSiblings",e[e.Braces=512]="Braces",e[e.Parenthesis=1024]="Parenthesis",e[e.AngleBrackets=2048]="AngleBrackets",e[e.SquareBrackets=4096]="SquareBrackets",e[e.BracketsMask=7680]="BracketsMask",e[e.OptionalIfUndefined=8192]="OptionalIfUndefined",e[e.OptionalIfEmpty=16384]="OptionalIfEmpty",e[e.Optional=24576]="Optional",e[e.PreferNewLine=32768]="PreferNewLine",e[e.NoTrailingNewLine=65536]="NoTrailingNewLine",e[e.NoInterveningComments=131072]="NoInterveningComments",e[e.NoSpaceIfEmpty=262144]="NoSpaceIfEmpty",e[e.SingleElement=524288]="SingleElement",e[e.Modifiers=131328]="Modifiers",e[e.HeritageClauses=256]="HeritageClauses",e[e.SingleLineTypeLiteralMembers=448]="SingleLineTypeLiteralMembers",e[e.MultiLineTypeLiteralMembers=65]="MultiLineTypeLiteralMembers",e[e.TupleTypeElements=336]="TupleTypeElements",e[e.UnionTypeConstituents=260]="UnionTypeConstituents",e[e.IntersectionTypeConstituents=264]="IntersectionTypeConstituents",e[e.ObjectBindingPatternElements=432]="ObjectBindingPatternElements",e[e.ArrayBindingPatternElements=304]="ArrayBindingPatternElements",e[e.ObjectLiteralExpressionProperties=263122]="ObjectLiteralExpressionProperties",e[e.ArrayLiteralExpressionElements=4466]="ArrayLiteralExpressionElements",e[e.CommaListElements=272]="CommaListElements",e[e.CallExpressionArguments=1296]="CallExpressionArguments",e[e.NewExpressionArguments=9488]="NewExpressionArguments",e[e.TemplateExpressionSpans=131072]="TemplateExpressionSpans",e[e.SingleLineBlockStatements=384]="SingleLineBlockStatements",e[e.MultiLineBlockStatements=65]="MultiLineBlockStatements",e[e.VariableDeclarationList=272]="VariableDeclarationList",e[e.SingleLineFunctionBodyStatements=384]="SingleLineFunctionBodyStatements",e[e.MultiLineFunctionBodyStatements=1]="MultiLineFunctionBodyStatements",e[e.ClassHeritageClauses=256]="ClassHeritageClauses",e[e.ClassMembers=65]="ClassMembers",e[e.InterfaceMembers=65]="InterfaceMembers",e[e.EnumMembers=81]="EnumMembers",e[e.CaseBlockClauses=65]="CaseBlockClauses",e[e.NamedImportsOrExportsElements=432]="NamedImportsOrExportsElements",e[e.JsxElementChildren=131072]="JsxElementChildren",e[e.JsxElementAttributes=131328]="JsxElementAttributes",e[e.CaseOrDefaultClauseStatements=81985]="CaseOrDefaultClauseStatements",e[e.HeritageClauseTypes=272]="HeritageClauseTypes",e[e.SourceFileStatements=65537]="SourceFileStatements",e[e.Decorators=24577]="Decorators",e[e.TypeArguments=26960]="TypeArguments",e[e.TypeParameters=26960]="TypeParameters",e[e.Parameters=1360]="Parameters",e[e.IndexSignatureParameters=4432]="IndexSignatureParameters"})(ts=ts||{}),(b=>{function v(e,t,r,n,i){var s=[],e=e.emit(t,function(e,t,r){s.push({name:e,writeByteOrderMark:r,text:t})},n,r,i);return{outputFiles:s,emitSkipped:e.emitSkipped}}b.getFileEmitOutput=v,b.createBuilder=function(p){var t,l,s,a=b.createMap(),c=b.createMap(),o=b.createMap(),u=b.createMap();return{updateProgram:function(e){s&&r(e)},getFilesAffectedBy:g,emitChangedFiles:function(r,n){m(r);var e=r.getCompilerOptions();if(!o.size)return b.emptyArray;if(e.outFile||e.out)return b.Debug.assert(0===c.size),o.clear(),[r.emit(void 0,n)];var i,s=b.createMap();return o.forEach(function(e,t){g(r,t).forEach(function(e){c.delete(e.path),s.has(e.path)||(s.set(e.path,!0),(i=i||[]).push(r.emit(e,n)))})}),o.clear(),i||b.emptyArray},getSemanticDiagnostics:function(e,t){m(e),b.Debug.assert(0===o.size);var r,n=e.getCompilerOptions();if(n.outFile||n.out)return b.Debug.assert(0===c.size),e.getSemanticDiagnostics(void 0,t);for(var i=0,s=e.getSourceFiles();i<s.length;i++){var a=s[i];r=b.addRange(r,((e,t,r)=>{var n=t.path,i=c.get(n);return i||(i=e.getSemanticDiagnostics(t,r),c.set(n,i)),i})(e,a,t))}return r||b.emptyArray},clear:function(){t=void 0,s=void 0,a.clear(),c.clear(),o.clear(),u.clear()}};function r(n){var i,e=n.getCompilerOptions().module!==b.ModuleKind.None;function o(r){return b.mapDefinedIter(i.entries(),function(e){var t=e[0];return e[1].has(r)?t:void 0})}t!==e&&(s=(t=e)?(i=b.createMap(),{onAddSourceFile:function(e,t){e=_(e,t);e&&i.set(t.path,e)},onRemoveSourceFile:function(r){i.forEach(function(e,t){e.has(r)&&a.get(t)&&d(t)}),i.delete(r)},onUpdateSourceFile:function(e,t){e=_(e,t);e?i.set(t.path,e):i.delete(t.path)},onUpdateSourceFileWithSameVersion:function(e,t){var r,e=_(e,t);return e?(r=i.get(t.path),i.set(t.path,e),!r||r.size!==e.size||b.forEachEntry(e,function(e,t){return!r.delete(t)})||!!r.size):i.delete(t.path)},getFilesAffectedByUpdatedShape:function(e,t){if(!b.isExternalModule(t)&&!(e=>{for(var t=0,r=e.statements;t<r.length;t++){var n=r[t];if(!b.isModuleWithStringLiteralName(n))return}return 1})(t))return y(e,t);var r=e.getCompilerOptions();if(r&&(r.isolatedModules||r.out||r.outFile))return[t];var n=b.createMap(),r=t.path,i=(n.set(r,t),o(r));for(;0<i.length;){var s,a=i.pop();n.has(a)||(s=e.getSourceFileByPath(a),n.set(a,s),s&&f(e,s)&&i.push.apply(i,o(a)))}return b.flatMapIter(n.values(),function(e){return e})}}):{onAddSourceFile:b.noop,onRemoveSourceFile:b.noop,onUpdateSourceFile:b.noop,onUpdateSourceFileWithSameVersion:b.returnFalse,getFilesAffectedByUpdatedShape:function(e,t){var r=e.getCompilerOptions();if(r&&(r.out||r.outFile))return[t];return y(e,t)}},a.clear(),c.clear()),u.clear(),l=void 0,b.mutateMap(a,b.arrayToMap(n.getSourceFiles(),function(e){return e.path}),{createNewValue:function(e,t){return r=n,d((t=t).path),s.onAddSourceFile(r,t),{version:t.version,signature:void 0};var r},onDeleteValue:h,onExistingValue:function(e,t){var r;r=n,t=t,(e=e).version!==t.version?(d(t.path),e.version=t.version,s.onUpdateSourceFile(r,t)):s.onUpdateSourceFileWithSameVersion(r,t)&&d(t.path)}})}function d(e){o.set(e,!0),c.delete(e)}function h(e,t){o.delete(t),c.delete(t),s.onRemoveSourceFile(t)}function m(e){s||r(e)}function g(e,t){m(e);t=e.getSourceFileByPath(t);return t?f(e,t)?s.getFilesAffectedByUpdatedShape(e,t):[t]:b.emptyArray}function f(e,t){var r,n,i;if(b.Debug.assert(!!t),!u.has(t.path))return u.set(t.path,!0),r=a.get(t.path),b.Debug.assert(!!r),n=r.signature,t.isDeclarationFile?(i=t.version,r.signature=i):(e=v(e,t,!0)).outputFiles&&0<e.outputFiles.length?(i=p.computeHash(e.outputFiles[0].text),r.signature=i):i=n,!n||i!==n}function _(e,t){var r;if(t.imports&&0<t.imports.length)for(var n=e.getTypeChecker(),i=0,s=t.imports;i<s.length;i++){var a=s[i],a=n.getSymbolAtLocation(a);a&&a.declarations&&a.declarations[0]&&(a=b.getSourceFileOfNode(a.declarations[0]))&&d(a.path)}var o=b.getDirectoryPath(t.path);if(t.referencedFiles&&0<t.referencedFiles.length)for(var l=0,c=t.referencedFiles;l<c.length;l++){var u=c[l];d(b.toPath(u.fileName,o,p.getCanonicalFileName))}return t.resolvedTypeReferenceDirectiveNames&&t.resolvedTypeReferenceDirectiveNames.forEach(function(e){e&&(e=e.resolvedFileName,d(b.toPath(e,o,p.getCanonicalFileName)))}),r;function d(e){(r=r||b.createMap()).set(e,!0)}}function y(t,e){if(!l){var r;a(e);for(var n=0,i=t.getSourceFiles();n<i.length;n++){var s=i[n];s!==e&&a(s)}l=r||b.emptyArray}return l;function a(e){t.isSourceFileDefaultLibrary(e)||(r=r||[]).push(e)}}}})(ts=ts||{}),(qe=>{var Je=/(^\s*$)|(^\s*\/\/\/?\s*(@ts-ignore)?)/;function Ye(e,t){t=qe.getDirectoryPath(t),t=qe.isRootedDiskPath(e)?e:qe.combinePaths(t,e);return qe.normalizePath(t)}function Xe(e,i,s){var a;return qe.forEach(e,function(e){var t=qe.getNormalizedPathComponents(e,i);if(t.pop(),a){for(var r=Math.min(a.length,t.length),n=0;n<r;n++)if(s(a[n])!==s(t[n])){if(0===n)return!0;a.length=n;break}t.length<a.length&&(a.length=t.length)}else a=t})?"":a?qe.getNormalizedPathFromPathComponents(a):i}function Ze(i,s){var a,r=qe.createMap();function o(e){var t;e.length>qe.getRootLength(e)&&(t=e,!(r.has(t)||qe.sys.directoryExists(t)&&(r.set(t,!0),1)))&&(o(qe.getDirectoryPath(e)),qe.sys.createDirectory(e))}function t(){return qe.getDirectoryPath(qe.normalizePath(qe.sys.getExecutingFilePath()))}var n=qe.getNewLineCharacter(i),e=qe.sys.realpath&&function(e){return qe.sys.realpath(e)};return{getSourceFile:function(e,t,r){var n;try{qe.performance.mark("beforeIORead"),n=qe.sys.readFile(e,i.charset),qe.performance.mark("afterIORead"),qe.performance.measure("I/O Read","beforeIORead","afterIORead")}catch(e){r&&r(e.message),n=""}return void 0!==n?qe.createSourceFile(e,n,t,s):void 0},getDefaultLibLocation:t,getDefaultLibFileName:function(e){return qe.combinePaths(t(),qe.getDefaultLibFileName(e))},writeFile:function(e,t,r,n){try{qe.performance.mark("beforeIOWrite"),o(qe.getDirectoryPath(qe.normalizePath(e))),qe.isWatchSet(i)&&qe.sys.createHash&&qe.sys.getModifiedTime?((e,t,r)=>{a=a||qe.createMap();var n=qe.sys.createHash(t),i=qe.sys.getModifiedTime(e);if(i){var s=a.get(e);if(s&&s.byteOrderMark===r&&s.hash===n&&s.mtime.getTime()===i.getTime())return}qe.sys.writeFile(e,t,r),s=qe.sys.getModifiedTime(e),a.set(e,{hash:n,byteOrderMark:r,mtime:s})})(e,t,r):qe.sys.writeFile(e,t,r),qe.performance.mark("afterIOWrite"),qe.performance.measure("I/O Write","beforeIOWrite","afterIOWrite")}catch(e){n&&n(e.message)}},getCurrentDirectory:qe.memoize(function(){return qe.sys.getCurrentDirectory()}),useCaseSensitiveFileNames:function(){return qe.sys.useCaseSensitiveFileNames},getCanonicalFileName:function(e){return qe.sys.useCaseSensitiveFileNames?e:e.toLowerCase()},getNewLine:function(){return n},fileExists:function(e){return qe.sys.fileExists(e)},readFile:function(e){return qe.sys.readFile(e)},trace:function(e){return qe.sys.write(e+n)},directoryExists:function(e){return qe.sys.directoryExists(e)},getEnvironmentVariable:function(e){return qe.sys.getEnvironmentVariable?qe.sys.getEnvironmentVariable(e):""},getDirectories:function(e){return qe.sys.getDirectories(e)},realpath:e}}function s(e,t){var r,n,i=qe.DiagnosticCategory[e.category].toLowerCase()+" TS"+e.code+": "+I(e.messageText,t.getNewLine())+t.getNewLine();return e.file?(r=(n=qe.getLineAndCharacterOfPosition(e.file,e.start)).line,n=n.character,e=e.file.fileName,qe.convertToRelativePath(e,t.getCurrentDirectory(),function(e){return t.getCanonicalFileName(e)})+"("+(r+1)+","+(n+1)+"): "+i):i}qe.findConfigFile=function(e,t,r){for(void 0===r&&(r="tsconfig.json");;){var n=qe.combinePaths(e,r);if(t(n))return n;n=qe.getDirectoryPath(e);if(n===e)break;e=n}},qe.resolveTripleslashReference=Ye,qe.computeCommonSourceDirectoryOfFilenames=Xe,qe.createCompilerHost=Ze,qe.getPreEmitDiagnostics=function(e,t,r){var n=e.getOptionsDiagnostics(r).concat(e.getSyntacticDiagnostics(t,r),e.getGlobalDiagnostics(r),e.getSemanticDiagnostics(t,r));return e.getCompilerOptions().declaration&&qe.addRange(n,e.getDeclarationDiagnostics(t,r)),qe.sortAndDeduplicateDiagnostics(n)},qe.formatDiagnostics=function(e,t){for(var r="",n=0,i=e;n<i.length;n++)r+=s(i[n],t);return r},qe.formatDiagnostic=s;var T="[91m",k="[93m",x="[93m",E="[30;47m",S="[0m";function C(e,t){return t+e+S}function w(e,t){for(;e.length<t;)e=" "+e;return e}function I(e,t){if(qe.isString(e))return e;for(var r=e,n="",i=0;r;){if(i){n+=t;for(var s=0;s<i;s++)n+="  "}n+=r.messageText,i++,r=r.next}return n}function Qe(e,t,r){if(0===e.length)return[];for(var n=[],i=qe.createMap(),s=0,a=e;s<a.length;s++){var o=a[s],l=void 0;i.has(o)?l=i.get(o):i.set(o,l=r(o,t)),n.push(l)}return n}function et(e,t){switch(t.extension){case".ts":case".d.ts":return;case".tsx":return r();case".jsx":return r()||n();case".js":return n()}function r(){return e.jsx?void 0:qe.Diagnostics.Module_0_was_resolved_to_1_but_jsx_is_not_set}function n(){return e.allowJs||!e.noImplicitAny?void 0:qe.Diagnostics.Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type}}function tt(e){return qe.Debug.assert(e.every(function(e){return void 0!==e}),"A name is undefined.",function(){return JSON.stringify(e)}),e}function rt(e){for(var t=e.imports,e=e.moduleAugmentations,r=t.map(function(e){return e.text}),n=0,i=e;n<i.length;n++){var s=i[n];9===s.kind&&r.push(s.text)}return r}qe.formatDiagnosticsWithColorAndContext=function(e,t){for(var r="",n=0,i=e;n<i.length;n++){var s=i[n],a="";if(s.file){var o=s.start,l=s.length,c=s.file,u=qe.getLineAndCharacterOfPosition(c,o),d=u.line,p=u.character,u=qe.getLineAndCharacterOfPosition(c,o+l),h=u.line,m=u.character,g=qe.getLineAndCharacterOfPosition(c,c.text.length).line,o=t?qe.convertToRelativePath(c.fileName,t.getCurrentDirectory(),function(e){return t.getCanonicalFileName(e)}):c.fileName,f=4<=h-d,_=(h+1+"").length;f&&(_=Math.max("...".length,_)),a+=t.getNewLine();for(var y=d;y<=h;y++){f&&d+1<y&&y<h-1&&(a+=C(w("...",_),E)+" "+t.getNewLine(),y=h-1);var b=qe.getPositionOfLineAndCharacter(c,y,0),v=y<g?qe.getPositionOfLineAndCharacter(c,y+1,0):c.text.length,b=c.text.slice(b,v);b=(b=b.replace(/\s+$/g,"")).replace("\t"," "),a=(a=(a=(a+=C(w(y+1+"",_),E)+" ")+(b+t.getNewLine()))+(C(w("",_),E)+" "))+T,y===d?(v=y===h?m:void 0,a=(a+=b.slice(0,p).replace(/\S/g," "))+b.slice(p,v).replace(/./g,"~")):a+=(y===h?b.slice(0,m):b).replace(/./g,"~"),a+=S}r=r+t.getNewLine()+(o+"("+(d+1)+","+(p+1)+"): ")}r+=(e=>{switch(e){case qe.DiagnosticCategory.Warning:return k;case qe.DiagnosticCategory.Error:return T;case qe.DiagnosticCategory.Message:return x}})(s.category)+qe.DiagnosticCategory[s.category].toLowerCase()+S+" TS"+s.code+": "+I(s.messageText,t.getNewLine()),s.file&&(r=r+t.getNewLine()+a),r+=t.getNewLine()}return r},qe.flattenDiagnosticMessageText=I,qe.isProgramUptoDate=function(e,t,r,n,i,s,a){return!(!e||a||e.getRootFileNames().length!==t.length||e.getSourceFiles().some(function(e){return e.version!==n(e.path)||s(e.path)})||e.getMissingFilePaths().some(i)||(a=e.getCompilerOptions(),!qe.compareDataObjects(a,r))||a.configFile&&r.configFile&&a.configFile.text!==r.configFile.text)},qe.createProgram=function(F,x,E,S){var h,t,r,k,n,B,i,$,U,C,V,w,I,A=[],H={},G={},D=qe.createMap(),N=qe.createDiagnosticCollection(),j="number"==typeof x.maxNodeModuleJsDepth?x.maxNodeModuleJsDepth:0,g=0,f=qe.createMap(),O=qe.createMap(),K=(qe.performance.mark("beforeProgram"),E=E||Ze(x),x.noLib),z=qe.memoize(function(){return E.getDefaultLibFileName(x)}),W=E.getDefaultLibLocation?E.getDefaultLibLocation():qe.getDirectoryPath(z()),m=qe.createDiagnosticCollection(),R=E.getCurrentDirectory(),q=qe.getSupportedExtensions(x),J=qe.createMap(),Y=E.hasInvalidatedResolution||qe.returnFalse,X=(C=E.resolveModuleNames?function(e,t,r){return E.resolveModuleNames(tt(e),t,r).map(function(e){var t;return e&&void 0===e.extension?((t=qe.clone(e)).extension=qe.extensionFromPath(e.resolvedFileName),t):e})}:($=qe.createModuleResolutionCache(R,function(e){return E.getCanonicalFileName(e)}),U=function(e,t){return qe.resolveModuleName(e,t,x,E,$).resolvedModule},function(e,t){return Qe(tt(e),t,U)}),w=E.resolveTypeReferenceDirectives?function(e,t){return E.resolveTypeReferenceDirectives(tt(e),t)}:(V=function(e,t){return qe.resolveTypeReferenceDirective(e,t,x,E).resolvedTypeReferenceDirective},function(e,t){return Qe(tt(e),t,V)}),qe.createMap()),L=qe.createMap(),Z=qe.createMap(),P=qe.createMap(),Q=E.useCaseSensitiveFileNames()?qe.createMap():void 0,M=(a=x,(s=(s=S)&&s.getCompilerOptions())&&(s.target!==a.target||s.module!==a.module||s.moduleResolution!==a.moduleResolution||s.noResolve!==a.noResolve||s.jsx!==a.jsx||s.allowJs!==a.allowJs||s.disableSizeLimit!==a.disableSizeLimit||s.baseUrl!==a.baseUrl||!qe.equalOwnProperties(s.paths,a.paths))),ee=(()=>{if(!S)return 0;var e=S.getCompilerOptions();if(qe.changesAffectModuleResolution(e,x))return S.structureIsReused=0;qe.Debug.assert(!(3&S.structureIsReused));var t=S.getRootFileNames();if(!qe.arrayIsEqualTo(t,F))return S.structureIsReused=0;if(!qe.arrayIsEqualTo(x.types,e.types))return S.structureIsReused=0;var r=[],n=[],i=[];if(S.structureIsReused=2,S.getMissingFilePaths().some(function(e){return E.fileExists(e)}))return S.structureIsReused=0;t=S.getSourceFiles(),e={Exists:0,0:"Exists",Modified:1,1:"Modified"};for(var s=qe.createMap(),a=0,o=t;a<o.length;a++){var l=o[a];if(!(y=E.getSourceFileByPath?E.getSourceFileByPath(l.fileName,l.path,x.target,void 0,M):E.getSourceFile(l.fileName,x.target,void 0,M)))return S.structureIsReused=0;qe.Debug.assert(!y.redirectInfo,"Host should not return a redirect source file from `getSourceFile`");var c=void 0;if(l.redirectInfo){if(y!==l.redirectInfo.unredirected)return S.structureIsReused=0;c=!1,y=l}else if(S.redirectTargetsSet.has(l.path)){if(y!==l)return S.structureIsReused=0;c=!1}else c=y!==l;y.path=l.path,n.push(y.path);var u=S.sourceFileToPackageName.get(l.path);if(void 0!==u){var d=s.get(u),p=c?1:0;if(void 0!==d&&1==p||1===d)return S.structureIsReused=0;s.set(u,p)}c?(l.hasNoDefaultLib!==y.hasNoDefaultLib&&(S.structureIsReused=1),qe.arrayIsEqualTo(l.referencedFiles,y.referencedFiles,we)||(S.structureIsReused=1),Ae(y),qe.arrayIsEqualTo(l.imports,y.imports,Ie)||(S.structureIsReused=1),qe.arrayIsEqualTo(l.moduleAugmentations,y.moduleAugmentations,Ie)||(S.structureIsReused=1),(524288&l.flags)!=(524288&y.flags)&&(S.structureIsReused=1),qe.arrayIsEqualTo(l.typeReferenceDirectives,y.typeReferenceDirectives,we)||(S.structureIsReused=1),i.push({oldFile:l,newFile:y})):Y(l.path)&&(S.structureIsReused=1,i.push({oldFile:l,newFile:y})),r.push(y)}if(2!==S.structureIsReused)return S.structureIsReused;B=i.map(function(e){return e.newFile.path});for(var h=0,m=i;h<m.length;h++){var g,f,_=m[h],l=_.oldFile,y=_.newFile,_=qe.getNormalizedAbsolutePath(y.fileName,R);C&&(g=rt(y),f=ue(g,_,y,{program:S,file:l,modifiedFilePaths:B}),qe.hasChangesInResolutions(g,f,l.resolvedModules,qe.moduleResolutionIsEqualTo)?(S.structureIsReused=1,y.resolvedModules=qe.zipToMap(g,f)):y.resolvedModules=l.resolvedModules),w&&(g=qe.map(y.typeReferenceDirectives,function(e){return e.fileName}),f=w(g,_),qe.hasChangesInResolutions(g,f,l.resolvedTypeReferenceDirectiveNames,qe.typeDirectiveIsEqualTo)?(S.structureIsReused=1,y.resolvedTypeReferenceDirectiveNames=qe.zipToMap(g,f)):y.resolvedTypeReferenceDirectiveNames=l.resolvedTypeReferenceDirectiveNames)}if(2!==S.structureIsReused)return S.structureIsReused;if(E.hasChangedAutomaticTypeDirectiveNames)return S.structureIsReused=1;I=S.getMissingFilePaths();for(var b=0;b<r.length;b++)P.set(n[b],r[b]),S.isSourceFileFromExternalLibrary(S.getSourceFileByPath(n[b]))&&O.set(n[b],!0);A=r,N=S.getFileProcessingDiagnostics();for(var v=0,T=i;v<T.length;v++){var k=T[v];N.reattachFileDiagnostics(k.newFile)}return D=S.getResolvedTypeReferenceDirectives(),L=S.sourceFileToPackageName,Z=S.redirectTargetsSet,S.structureIsReused=2})();if(2!==ee){qe.forEach(F,function(e){return Ce(e,!1)});var e=qe.getAutomaticTypeDirectiveNames(x,E);if(e.length)for(var s=x.configFilePath?qe.getDirectoryPath(x.configFilePath):E.getCurrentDirectory(),a=qe.combinePaths(s,"__inferred type names__.ts"),te=w(e,a),o=0;o<e.length;o++)Me(e[o],te[o]);K||(x.lib?qe.forEach(x.lib,function(e){Ce(qe.combinePaths(W,e),!0)}):Ce(z(),!0)),I=qe.arrayFrom(P.keys(),function(e){return e}).filter(function(e){return!P.get(e)})}if(qe.Debug.assert(!!I),$=void 0,S&&E.onReleaseOldSourceFile)for(var re=0,ne=S.getSourceFiles();re<ne.length;re++){var ie=ne[re];ge(ie.path)&&!M||E.onReleaseOldSourceFile(ie,S.getCompilerOptions())}if(S=void 0,h={getRootFileNames:function(){return F},getSourceFile:ge,getSourceFileByPath:fe,getSourceFiles:function(){return A},getMissingFilePaths:function(){return I},getCompilerOptions:function(){return x},getSyntacticDiagnostics:function(e,t){return _e(e,ye,t)},getOptionsDiagnostics:function(){return qe.sortAndDeduplicateDiagnostics(qe.concatenate(N.getGlobalDiagnostics(),qe.concatenate(m.getGlobalDiagnostics(),x.configFile?m.getDiagnostics(x.configFile.fileName):[])))},getGlobalDiagnostics:function(){return qe.sortAndDeduplicateDiagnostics(b().getGlobalDiagnostics().slice())},getSemanticDiagnostics:function(e,t){return _e(e,be,t)},getDeclarationDiagnostics:function(e,t){var r=h.getCompilerOptions();return!e||r.out||r.outFile?ke(e,t):_e(e,Se,t)},getTypeChecker:he,getClassifiableNames:function(){if(!n){he(),n=qe.createUnderscoreEscapedMap();for(var e=0,t=A;e<t.length;e++){var r=t[e];qe.copyEntries(r.classifiableNames,n)}}return n},getDiagnosticsProducingTypeChecker:b,getCommonSourceDirectory:ce,emit:function(l,c,u,d,p){return v(function(){var e=h,t=l,r=c,n=u,i=d,s=p,a=[];if(x.noEmit)return{diagnostics:a,sourceMaps:void 0,emittedFiles:void 0,emitSkipped:!0};if(x.noEmitOnError){var o=e.getOptionsDiagnostics(n).concat(e.getSyntacticDiagnostics(t,n),e.getGlobalDiagnostics(n),e.getSemanticDiagnostics(t,n));if(0===o.length&&e.getCompilerOptions().declaration&&(a=e.getDeclarationDiagnostics(void 0,n)),0<o.length||0<a.length)return{diagnostics:qe.concatenate(o,a),sourceMaps:void 0,emittedFiles:void 0,emitSkipped:!0}}return e=b().getEmitResolver(x.outFile||x.out?void 0:t),qe.performance.mark("beforeEmit"),n=i?[]:qe.getTransformers(x,s),o=qe.emitFiles(e,de(r),t,i,n),qe.performance.mark("afterEmit"),qe.performance.measure("Emit","beforeEmit","afterEmit"),o})},getCurrentDirectory:function(){return R},getNodeCount:function(){return b().getNodeCount()},getIdentifierCount:function(){return b().getIdentifierCount()},getSymbolCount:function(){return b().getSymbolCount()},getTypeCount:function(){return b().getTypeCount()},getFileProcessingDiagnostics:function(){return N},getResolvedTypeReferenceDirectives:function(){return D},isSourceFileFromExternalLibrary:pe,isSourceFileDefaultLibrary:function(t){if(t.hasNoDefaultLib)return!0;if(!x.noLib)return!1;return x.lib?qe.forEach(x.lib,function(e){return 0===qe.compareStrings(t.fileName,qe.combinePaths(W,e),!E.useCaseSensitiveFileNames())}):0===qe.compareStrings(t.fileName,z(),!E.useCaseSensitiveFileNames())},dropDiagnosticsProducingTypeChecker:function(){r=void 0},getSourceFileFromReference:function(e,t){return De(Ye(t.fileName,e.fileName),function(e){return P.get(y(e))})},sourceFileToPackageName:L,redirectTargetsSet:Z},x.isolatedModules&&(x.declaration&&T(qe.Diagnostics.Option_0_cannot_be_specified_with_option_1,"declaration","isolatedModules"),x.noEmitOnError&&T(qe.Diagnostics.Option_0_cannot_be_specified_with_option_1,"noEmitOnError","isolatedModules"),x.out&&T(qe.Diagnostics.Option_0_cannot_be_specified_with_option_1,"out","isolatedModules"),x.outFile)&&T(qe.Diagnostics.Option_0_cannot_be_specified_with_option_1,"outFile","isolatedModules"),x.inlineSourceMap&&(x.sourceMap&&T(qe.Diagnostics.Option_0_cannot_be_specified_with_option_1,"sourceMap","inlineSourceMap"),x.mapRoot)&&T(qe.Diagnostics.Option_0_cannot_be_specified_with_option_1,"mapRoot","inlineSourceMap"),x.paths&&void 0===x.baseUrl&&T(qe.Diagnostics.Option_paths_cannot_be_used_without_specifying_baseUrl_option,"paths"),x.paths)for(var l in x.paths)if(qe.hasProperty(x.paths,l))if(qe.hasZeroOrOneAsteriskCharacter(l)||Ve(!0,l,qe.Diagnostics.Pattern_0_can_have_at_most_one_Asterisk_character,l),qe.isArray(x.paths[l])){var se=x.paths[l].length;0===se&&Ve(!1,l,qe.Diagnostics.Substitutions_for_pattern_0_shouldn_t_be_an_empty_array,l);for(var c=0;c<se;c++){var u=x.paths[l][c],ae=typeof u;"string"==ae?qe.hasZeroOrOneAsteriskCharacter(u)||Ue(l,c,qe.Diagnostics.Substitution_0_in_pattern_1_in_can_have_at_most_one_Asterisk_character,u,l):Ue(l,c,qe.Diagnostics.Substitution_0_for_pattern_1_has_incorrect_type_expected_string_got_2,u,l,ae)}}else Ve(!1,l,qe.Diagnostics.Substitutions_for_pattern_0_should_be_an_array,l);x.sourceMap||x.inlineSourceMap||(x.inlineSources&&T(qe.Diagnostics.Option_0_can_only_be_used_when_either_option_inlineSourceMap_or_option_sourceMap_is_provided,"inlineSources"),x.sourceRoot&&T(qe.Diagnostics.Option_0_can_only_be_used_when_either_option_inlineSourceMap_or_option_sourceMap_is_provided,"sourceRoot")),x.out&&x.outFile&&T(qe.Diagnostics.Option_0_cannot_be_specified_with_option_1,"out","outFile"),x.mapRoot&&!x.sourceMap&&T(qe.Diagnostics.Option_0_cannot_be_specified_without_specifying_option_1,"mapRoot","sourceMap"),x.declarationDir&&(x.declaration||T(qe.Diagnostics.Option_0_cannot_be_specified_without_specifying_option_1,"declarationDir","declaration"),x.out||x.outFile)&&T(qe.Diagnostics.Option_0_cannot_be_specified_with_option_1,"declarationDir",x.out?"out":"outFile"),x.lib&&x.noLib&&T(qe.Diagnostics.Option_0_cannot_be_specified_with_option_1,"lib","noLib"),x.noImplicitUseStrict&&(void 0===x.alwaysStrict?x.strict:x.alwaysStrict)&&T(qe.Diagnostics.Option_0_cannot_be_specified_with_option_1,"noImplicitUseStrict","alwaysStrict");var d,p,oe,s=x.target||0,a=x.outFile||x.out,_=qe.forEach(A,function(e){return qe.isExternalModule(e)&&!e.isDeclarationFile?e:void 0});function le(e,t){var r,n;e&&(r=y(e),P.has(r)&&(x.configFilePath||(n=qe.chainDiagnosticMessages(void 0,qe.Diagnostics.Adding_a_tsconfig_json_file_will_help_organize_projects_that_contain_both_TypeScript_and_JavaScript_files_Learn_more_at_https_Colon_Slash_Slashaka_ms_Slashtsconfig)),n=qe.chainDiagnosticMessages(n,qe.Diagnostics.Cannot_write_file_0_because_it_would_overwrite_input_file,e),We(e,qe.createCompilerDiagnosticFromMessageChain(n))),n=E.useCaseSensitiveFileNames()?r:r.toLocaleLowerCase(),t.has(n)?We(e,qe.createCompilerDiagnostic(qe.Diagnostics.Cannot_write_file_0_because_it_would_be_overwritten_by_multiple_input_files,e)):t.set(n,!0))}return x.isolatedModules?(x.module===qe.ModuleKind.None&&s<2&&T(qe.Diagnostics.Option_isolatedModules_can_only_be_used_when_either_option_module_is_provided_or_option_target_is_ES2015_or_higher,"isolatedModules","target"),(p=qe.forEach(A,function(e){return qe.isExternalModule(e)||e.isDeclarationFile?void 0:e}))&&(d=qe.getErrorSpanForNode(p,p),m.add(qe.createFileDiagnostic(p,d.start,d.length,qe.Diagnostics.Cannot_compile_namespaces_when_the_isolatedModules_flag_is_provided)))):_&&s<2&&x.module===qe.ModuleKind.None&&(p=qe.getErrorSpanForNode(_,_.externalModuleIndicator),m.add(qe.createFileDiagnostic(_,p.start,p.length,qe.Diagnostics.Cannot_use_imports_exports_or_module_augmentations_when_module_is_none))),a&&(x.module&&x.module!==qe.ModuleKind.AMD&&x.module!==qe.ModuleKind.System?T(qe.Diagnostics.Only_amd_and_system_modules_are_supported_alongside_0,x.out?"out":"outFile","module"):void 0===x.module&&_&&(d=qe.getErrorSpanForNode(_,_.externalModuleIndicator),m.add(qe.createFileDiagnostic(_,d.start,d.length,qe.Diagnostics.Cannot_compile_modules_using_option_0_unless_the_module_flag_is_amd_or_system,x.out?"out":"outFile")))),(x.outDir||x.sourceRoot||x.mapRoot)&&(p=ce(),x.outDir)&&""===p&&qe.forEach(A,function(e){return 1<qe.getRootLength(e.fileName)})&&T(qe.Diagnostics.Cannot_find_the_common_subdirectory_path_for_the_input_files,"outDir"),!x.noEmit&&x.allowJs&&x.declaration&&T(qe.Diagnostics.Option_0_cannot_be_specified_with_option_1,"allowJs","declaration"),x.checkJs&&!x.allowJs&&m.add(qe.createCompilerDiagnostic(qe.Diagnostics.Option_0_cannot_be_specified_without_specifying_option_1,"checkJs","allowJs")),x.emitDecoratorMetadata&&!x.experimentalDecorators&&T(qe.Diagnostics.Option_0_cannot_be_specified_without_specifying_option_1,"emitDecoratorMetadata","experimentalDecorators"),x.jsxFactory?(x.reactNamespace&&T(qe.Diagnostics.Option_0_cannot_be_specified_with_option_1,"reactNamespace","jsxFactory"),qe.parseIsolatedEntityName(x.jsxFactory,s)||Ge("jsxFactory",qe.Diagnostics.Invalid_value_for_jsxFactory_0_is_not_a_valid_identifier_or_qualified_name,x.jsxFactory)):x.reactNamespace&&!qe.isIdentifierText(x.reactNamespace,s)&&Ge("reactNamespace",qe.Diagnostics.Invalid_value_for_reactNamespace_0_is_not_a_valid_identifier,x.reactNamespace),x.noEmit||x.suppressOutputPathCheck||(a=de(),oe=qe.createMap(),qe.forEachEmittedFile(a,function(e){le(e.jsFilePath,oe),le(e.declarationFilePath,oe)})),qe.performance.mark("afterProgram"),qe.performance.measure("Program","beforeProgram","afterProgram"),h;function y(e){return qe.toPath(e,R,Be)}function ce(){var e;return void 0===t&&(e=qe.filter(A,function(e){return qe.sourceFileMayBeEmitted(e,x,pe)}),t=x.rootDir&&((e,t)=>{var r=!0;if(e)for(var n=E.getCanonicalFileName(qe.getNormalizedAbsolutePath(t,R)),i=0,s=e;i<s.length;i++){var a=s[i];a.isDeclarationFile||0!==E.getCanonicalFileName(qe.getNormalizedAbsolutePath(a.fileName,R)).indexOf(n)&&(m.add(qe.createCompilerDiagnostic(qe.Diagnostics.File_0_is_not_under_rootDir_1_rootDir_is_expected_to_contain_all_source_files,a.fileName,x.rootDir)),r=!1)}return r})(e,x.rootDir)?qe.getNormalizedAbsolutePath(x.rootDir,R):(e=>{for(var t=[],r=0,n=e;r<n.length;r++){var i=n[r];i.isDeclarationFile||t.push(i.fileName)}return Xe(t,R,Be)})(e))&&t[t.length-1]!==qe.directorySeparator&&(t+=qe.directorySeparator),t}function ue(e,t,r,n){if(0===ee&&!r.ambientModuleNames.length)return C(e,t);var i,s,a,o=n.program&&n.program.getSourceFile(t);if(o!==r&&r.resolvedModules){for(var l=[],c=0,u=e;c<u.length;c++){var d=u[c],p=r.resolvedModules.get(d);l.push(p)}return l}for(var h={},m=0;m<e.length;m++){d=e[m];if(r===o&&!Y(o.path)){var g=o&&o.resolvedModules.get(d);if(g){qe.isTraceEnabled(x,E)&&qe.trace(E,qe.Diagnostics.Reusing_resolution_of_module_0_to_file_1_from_old_program,d,t),(s=s||new Array(e.length))[m]=g,(a=a||[]).push(d);continue}}g=!1;qe.contains(r.ambientModuleNames,d)?(g=!0,qe.isTraceEnabled(x,E)&&qe.trace(E,qe.Diagnostics.Module_0_was_resolved_as_locally_declared_ambient_module_in_file_1,d,t)):g=((e,t)=>{var r;return!qe.getResolvedModule(t.file,e)&&!(!(r=t.program&&t.program.getTypeChecker().tryFindAmbientModuleWithoutAugmentations(e))||!r.declarations||!(r=qe.forEach(r.declarations,function(e){e=qe.getSourceFileOfNode(e);return!qe.contains(t.modifiedFilePaths,e.path)&&e}))||(qe.isTraceEnabled(x,E)&&qe.trace(E,qe.Diagnostics.Module_0_was_resolved_as_ambient_module_declared_in_1_since_this_file_was_not_modified,e,r.fileName),0))})(d,n),g?(s=s||new Array(e.length))[m]=h:(i=i||[]).push(d)}var f=i&&i.length?C(i,t,a):qe.emptyArray;if(!s)return qe.Debug.assert(f.length===e.length),f;for(var _=0,m=0;m<s.length;m++)s[m]?s[m]===h&&(s[m]=void 0):(s[m]=f[_],_++);return qe.Debug.assert(_===f.length),s}function de(e){return{getCanonicalFileName:Be,getCommonSourceDirectory:h.getCommonSourceDirectory,getCompilerOptions:h.getCompilerOptions,getCurrentDirectory:function(){return R},getNewLine:function(){return E.getNewLine()},getSourceFile:h.getSourceFile,getSourceFileByPath:h.getSourceFileByPath,getSourceFiles:h.getSourceFiles,isSourceFileFromExternalLibrary:pe,writeFile:e||function(e,t,r,n,i){return E.writeFile(e,t,r,n,i)},isEmitBlocked:me}}function pe(e){return O.get(e.path)}function b(){return r=r||qe.createTypeChecker(h,!0)}function he(){return k=k||qe.createTypeChecker(h,!1)}function me(e){return J.has(y(e))}function ge(e){return fe(y(e))}function fe(e){return P.get(e)}function _e(e,t,r){return e?t(e,r):qe.sortAndDeduplicateDiagnostics(qe.flatMap(h.getSourceFiles(),function(e){return r&&r.throwIfCancellationRequested(),t(e,r)}))}function ye(e){var a;return qe.isSourceFileJavaScript(e)?(e.additionalSyntacticDiagnostics||(e.additionalSyntacticDiagnostics=(a=e,v(function(){var d=[],p=a;return h(a),d;function h(e){switch(p.kind){case 146:case 149:if(p.questionToken===e)return void d.push(g(e,qe.Diagnostics._0_can_only_be_used_in_a_ts_file,"?"));case 151:case 150:case 152:case 153:case 154:case 186:case 228:case 187:case 226:if(p.type===e)return void d.push(g(e,qe.Diagnostics.types_can_only_be_used_in_a_ts_file))}switch(e.kind){case 237:return void d.push(g(e,qe.Diagnostics.import_can_only_be_used_in_a_ts_file));case 243:if(e.isExportEquals)return void d.push(g(e,qe.Diagnostics.export_can_only_be_used_in_a_ts_file));break;case 259:if(108===e.token)return void d.push(g(e,qe.Diagnostics.implements_clauses_can_only_be_used_in_a_ts_file));break;case 230:return void d.push(g(e,qe.Diagnostics.interface_declarations_can_only_be_used_in_a_ts_file));case 233:return void d.push(g(e,qe.Diagnostics.module_declarations_can_only_be_used_in_a_ts_file));case 231:return void d.push(g(e,qe.Diagnostics.type_aliases_can_only_be_used_in_a_ts_file));case 232:return void d.push(g(e,qe.Diagnostics.enum_declarations_can_only_be_used_in_a_ts_file));case 203:return void d.push(g(e,qe.Diagnostics.non_null_assertions_can_only_be_used_in_a_ts_file));case 202:return void d.push(g(e.type,qe.Diagnostics.type_assertion_expressions_can_only_be_used_in_a_ts_file));case 184:qe.Debug.fail()}var t=p;p=e,qe.forEachChild(e,h,r),p=t}function r(e){switch(p.decorators!==e||x.experimentalDecorators||d.push(g(p,qe.Diagnostics.Experimental_support_for_decorators_is_a_feature_that_is_subject_to_change_in_a_future_release_Set_the_experimentalDecorators_option_to_remove_this_warning)),p.kind){case 229:case 151:case 150:case 152:case 153:case 154:case 186:case 228:case 187:if(e===p.typeParameters)return void d.push(m(e,qe.Diagnostics.type_parameter_declarations_can_only_be_used_in_a_ts_file));case 208:if(e!==p.modifiers)break;for(var t=e,r=208===p.kind,n=0,i=t;n<i.length;n++){var s=i[n];switch(s.kind){case 76:if(r)continue;case 114:case 112:case 113:case 131:case 124:case 117:d.push(g(s,qe.Diagnostics._0_can_only_be_used_in_a_ts_file,qe.tokenToString(s.kind)))}}return;case 149:if(e!==p.modifiers)break;for(var a=0,o=e;a<o.length;a++){var l=o[a];115!==l.kind&&d.push(g(l,qe.Diagnostics._0_can_only_be_used_in_a_ts_file,qe.tokenToString(l.kind)))}return;case 146:if(e===p.modifiers)return void d.push(m(e,qe.Diagnostics.parameter_modifiers_can_only_be_used_in_a_ts_file));break;case 181:case 182:case 201:if(e===p.typeArguments)return void d.push(m(e,qe.Diagnostics.type_arguments_can_only_be_used_in_a_ts_file))}for(var c=0,u=e;c<u.length;c++)h(u[c])}function m(e,t,r,n,i){var s=e.pos;return qe.createFileDiagnostic(a,s,e.end-s,t,r,n,i)}function g(e,t,r,n,i){return qe.createDiagnosticForNodeInSourceFile(a,e,t,r,n,i)}})),qe.isCheckJsEnabledForFile(e,x)&&(e.additionalSyntacticDiagnostics=qe.concatenate(e.additionalSyntacticDiagnostics,e.jsDocDiagnostics))),qe.concatenate(e.additionalSyntacticDiagnostics,e.parseDiagnostics)):e.parseDiagnostics}function v(e){try{return e()}catch(e){throw e instanceof qe.OperationCanceledException&&(r=k=void 0),e}}function be(e,t){return Ee(e,t,H,ve)}function ve(i,s){return v(function(){var e,t,r,n;return x.skipLibCheck&&i.isDeclarationFile||x.skipDefaultLibCheck&&i.hasNoDefaultLib?qe.emptyArray:(t=b(),qe.Debug.assert(!!i.bindDiagnostics),n=(e=3===i.scriptKind||4===i.scriptKind||5===i.scriptKind||qe.isCheckJsEnabledForFile(i,x))?i.bindDiagnostics:qe.emptyArray,e=e?t.getDiagnostics(i,s):qe.emptyArray,t=N.getDiagnostics(i.fileName),r=m.getDiagnostics(i.fileName),n=n.concat(e,t,r),qe.filter(n,Te))})}function Te(e){var t=e.file,e=e.start;if(t)for(var r=qe.getLineStarts(t),n=qe.computeLineAndCharacterOfPosition(r,e).line;0<n;){var i=t.text.slice(r[n-1],r[n]),i=Je.exec(i);if(!i)return!0;if(i[3])return!1;n--}return!0}function ke(e,t){return Ee(e,t,G,xe)}function xe(t,r){return v(function(){var e=b().getEmitResolver(t,r);return qe.getDeclarationDiagnostics(de(qe.noop),e,t)})}function Ee(e,t,r,n){var i=e?r.perFile&&r.perFile.get(e.path):r.allDiagnostics;return i||(i=n(e,t)||qe.emptyArray,e?(r.perFile||(r.perFile=qe.createMap()),r.perFile.set(e.path,i)):r.allDiagnostics=i,i)}function Se(e,t){return e.isDeclarationFile?[]:ke(e,t)}function Ce(e,t){Ne(qe.normalizePath(e),t,void 0)}function we(e,t){return e.fileName===t.fileName}function Ie(e,t){return 9===e.kind?9===t.kind&&e.text===t.text:71===t.kind&&e.escapedText===t.escapedText}function Ae(l){if(!l.imports){var c,u,d,e,t,r=qe.isSourceFileJavaScript(l),p=qe.isExternalModule(l);x.importHelpers&&(x.isolatedModules||p)&&!l.isDeclarationFile&&(e=qe.createLiteral(qe.externalHelpersModuleNameText),t=qe.createImportDeclaration(void 0,void 0,void 0),(e.parent=t).parent=l,c=[e]);for(var n=0,i=l.statements;n<i.length;n++){var s=i[n];!function e(t,r){switch(t.kind){case 238:case 237:case 244:var n=qe.getExternalModuleName(t);n&&qe.isStringLiteral(n)&&(!n.text||r&&qe.isExternalModuleNameRelative(n.text)||(c=c||[]).push(n));break;case 233:if(qe.isAmbientModule(t)&&(r||qe.hasModifier(t,2)||l.isDeclarationFile)){var n=t.name,i=qe.getTextOfIdentifierOrLiteral(n);if(p||r&&!qe.isExternalModuleNameRelative(i))(u=u||[]).push(n);else if(!r){l.isDeclarationFile&&(d=d||[]).push(i);n=t.body;if(n)for(var s=0,a=n.statements;s<a.length;s++){var o=a[s];e(o,!0)}}}}}(s,!1),(524288&l.flags||r)&&a(s)}l.imports=c||qe.emptyArray,l.moduleAugmentations=u||qe.emptyArray,l.ambientModuleNames=d||qe.emptyArray}function a(e){qe.isRequireCall(e,!0)||qe.isImportCall(e)&&1===e.arguments.length&&9===e.arguments[0].kind?(c=c||[]).push(e.arguments[0]):qe.forEachChild(e,a)}}function De(t,r,e,n){var i;return qe.hasExtension(t)?x.allowNonTsExtensions||qe.forEach(q,function(e){return qe.fileExtensionIs(E.getCanonicalFileName(t),e)})?(i=r(t),e&&(i?n&&E.getCanonicalFileName(t)===E.getCanonicalFileName(n.fileName)&&e(qe.Diagnostics.A_file_cannot_have_a_reference_to_itself):e(qe.Diagnostics.File_0_not_found,t)),i):void(e&&e(qe.Diagnostics.File_0_has_unsupported_extension_The_only_supported_extensions_are_1,t,"'"+q.join("', '")+"'")):x.allowNonTsExtensions&&r(t)||(e&&x.allowNonTsExtensions?void e(qe.Diagnostics.File_0_not_found,t):(n=qe.forEach(q,function(e){return r(t+e)}),e&&!n&&e(qe.Diagnostics.File_0_not_found,t+".ts"),n))}function Ne(e,t,r,n,i,s){De(e,function(e){return Re(e,y(e),t,n,i,s,r)},function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];N.add(void 0!==n&&void 0!==s&&void 0!==i?qe.createFileDiagnostic.apply(void 0,[n,i,s-i,e].concat(t)):qe.createCompilerDiagnostic.apply(void 0,[e].concat(t)))},n)}function Oe(e,t,r,n,i){void 0!==r&&void 0!==n&&void 0!==i?N.add(qe.createFileDiagnostic(r,n,i-n,qe.Diagnostics.File_name_0_differs_from_already_included_file_name_1_only_in_casing,e,t)):N.add(qe.createCompilerDiagnostic(qe.Diagnostics.File_name_0_differs_from_already_included_file_name_1_only_in_casing,e,t))}function Re(t,e,r,n,i,s,a){if(P.has(e))return(d=P.get(e))&&x.forceConsistentCasingInFileNames&&qe.getNormalizedAbsolutePath(d.fileName,R)!==qe.getNormalizedAbsolutePath(t,R)&&Oe(t,d.fileName,n,i,s),d&&O.get(d.path)&&0===g?(O.set(d.path,!1),x.noResolve||(Le(d,r),Pe(d)),f.set(d.path,!1),$e(d)):d&&f.get(d.path)&&g<j&&(f.set(d.path,!1),$e(d)),d;var o,l,c,u,d=E.getSourceFile(t,x.target,function(e){void 0!==n&&void 0!==i&&void 0!==s?N.add(qe.createFileDiagnostic(n,i,s-i,qe.Diagnostics.Cannot_read_file_0_Colon_1,t,e)):N.add(qe.createCompilerDiagnostic(qe.Diagnostics.Cannot_read_file_0_Colon_1,t,e))},M);if(a){var p,h=a.name+"/"+a.subModuleName+"@"+a.version,m=X.get(h);if(m)return u=m,o=d,p=t,c=e,(l=Object.create(u)).fileName=p,l.path=c,l.redirectInfo={redirectTarget:u,unredirected:o},Object.defineProperties(l,{id:{get:function(){return this.redirectInfo.redirectTarget.id},set:function(e){this.redirectInfo.redirectTarget.id=e}},symbol:{get:function(){return this.redirectInfo.redirectTarget.symbol},set:function(e){this.redirectInfo.redirectTarget.symbol=e}}}),p=l,Z.set(m.path,!0),P.set(e,p),L.set(e,a.name),A.push(p),p;d&&(X.set(h,d),L.set(e,a.name))}return P.set(e,d),d&&(O.set(e,0<g),d.path=e,E.useCaseSensitiveFileNames()&&(c=e.toLowerCase(),(u=Q.get(c))?Oe(t,u.fileName,n,i,s):Q.set(c,d)),K=K||d.hasNoDefaultLib,x.noResolve||(Le(d,r),Pe(d)),$e(d),r?A.unshift(d):A.push(d)),d}function Le(t,r){qe.forEach(t.referencedFiles,function(e){Ne(Ye(e.fileName,t.fileName),r,void 0,t,e.pos,e.end)})}function Pe(e){for(var t=qe.map(e.typeReferenceDirectives,function(e){return e.fileName.toLocaleLowerCase()}),r=w(t,e.fileName),n=0;n<t.length;n++){var i=e.typeReferenceDirectives[n],s=r[n],a=i.fileName.toLocaleLowerCase();qe.setResolvedTypeReferenceDirective(e,a,s),Me(a,s,e,i.pos,i.end)}}function Me(e,t,r,n,i){var s,a=D.get(e);a&&a.primary||(s=!0,t?!t.primary&&a?(t.resolvedFileName!==a.resolvedFileName&&E.readFile(t.resolvedFileName)!==ge(a.resolvedFileName).text&&N.add(Fe(r,n,i,qe.Diagnostics.Conflicting_definitions_for_0_found_at_1_and_2_Consider_installing_a_specific_version_of_this_library_to_resolve_the_conflict,e,t.resolvedFileName,a.resolvedFileName)),s=!1):Ne(t.resolvedFileName,!1,t.packageId,r,n,i):N.add(Fe(r,n,i,qe.Diagnostics.Cannot_find_type_definition_file_for_0,e)),s&&D.set(e,t))}function Fe(e,t,r,n){for(var i=[],s=4;s<arguments.length;s++)i[s-4]=arguments[s];return void 0===e||void 0===t||void 0===r?qe.createCompilerDiagnostic.apply(void 0,[n].concat(i)):qe.createFileDiagnostic.apply(void 0,[e,t,r-t,n].concat(i))}function Be(e){return E.getCanonicalFileName(e)}function $e(e){if(Ae(e),e.imports.length||e.moduleAugmentations.length){var t=rt(e),r={program:S,file:e,modifiedFilePaths:B},n=ue(t,qe.getNormalizedAbsolutePath(e.fileName,R),e,r);qe.Debug.assert(n.length===t.length);for(var i=0;i<t.length;i++){var s,a,o,l,c=n[i];qe.setResolvedModule(e,t[i],c),c&&(s=c.isExternalLibraryImport,l=!qe.extensionIsTypeScript(c.extension),a=c.resolvedFileName,s&&g++,o=s&&l&&j<g,l=a&&!et(x,c)&&!x.noResolve&&i<e.imports.length&&!o&&!(l&&!x.allowJs),o?f.set(e.path,!0):l&&Re(a,y(a),!1,e,qe.skipTrivia(e.text,e.imports[i].pos),e.imports[i].end,c.packageId),s)&&g--}}else e.resolvedModules=void 0}function Ue(e,t,r,n,i,s){for(var a=!0,o=0,l=He();o<l.length;o++){var c=l[o];if(qe.isObjectLiteralExpression(c.initializer))for(var u=0,d=qe.getPropertyAssignment(c.initializer,e);u<d.length;u++){var p=d[u];qe.isArrayLiteralExpression(p.initializer)&&p.initializer.elements.length>t&&(m.add(qe.createDiagnosticForNodeInSourceFile(x.configFile,p.initializer.elements[t],r,n,i,s)),a=!1)}}a&&m.add(qe.createCompilerDiagnostic(r,n,i,s))}function Ve(e,t,r,n){for(var i=!0,s=0,a=He();s<a.length;s++){var o=a[s];qe.isObjectLiteralExpression(o.initializer)&&ze(o.initializer,e,t,void 0,r,n)&&(i=!1)}i&&m.add(qe.createCompilerDiagnostic(r,n))}function He(){var e=Ke();return e?qe.getPropertyAssignment(e,"paths"):qe.emptyArray}function T(e,t,r){je(!0,t,r,e,t,r)}function Ge(e,t,r){je(!1,e,void 0,t,r)}function je(e,t,r,n,i,s){var a=Ke();a&&ze(a,e,t,r,n,i,s)||m.add(qe.createCompilerDiagnostic(n,i,s))}function Ke(){if(void 0===i&&(i=null,x.configFile)&&x.configFile.jsonObject)for(var e=0,t=qe.getPropertyAssignment(x.configFile.jsonObject,"compilerOptions");e<t.length;e++){var r=t[e];if(qe.isObjectLiteralExpression(r.initializer)){i=r.initializer;break}}return i}function ze(e,t,r,n,i,s,a){for(var e=qe.getPropertyAssignment(e,r,n),o=0,l=e;o<l.length;o++){var c=l[o];m.add(qe.createDiagnosticForNodeInSourceFile(x.configFile,t?c.name:c.initializer,i,s,a))}return e.length}function We(e,t){J.set(y(e),!0),m.add(t)}},qe.getResolutionDiagnostic=et})(ts=ts||{}),(C=>{var e,h;function i(e){return e&&void 0!==e.enableAutoDiscovery&&void 0===e.enable?{enable:e.enableAutoDiscovery,include:e.include||[],exclude:e.exclude||[]}:e}function v(){var t,r;return e||(t=C.createMap(),r=C.createMap(),C.forEach(C.optionDeclarations,function(e){t.set(e.name.toLowerCase(),e),e.shortName&&r.set(e.shortName,e.name)}),e={optionNameMap:t,shortOptionNames:r}),e}function n(e){return o(e,C.createCompilerDiagnostic)}function o(e,t){var r=C.arrayFrom(e.type.keys()).map(function(e){return"'"+e+"'"}).join(", ");return t(C.Diagnostics.Argument_for_0_option_must_be_Colon_1,"--"+e.name,r)}function g(e,t,r){return u(e,P(t||""),r)}function f(t,e,r){if(e=P(e=void 0===e?"":e),!C.startsWith(e,"-")){if(""===e)return[];var n=e.split(",");switch(t.element.type){case"number":return C.map(n,parseInt);case"string":return C.map(n,function(e){return e||""});default:return C.filter(C.map(n,function(e){return g(t.element,e,r)}),function(e){return!!e})}}}function _(e,t){void 0===t&&(t=!1),e=e.toLowerCase();var r=v(),n=r.optionNameMap;return t&&void 0!==(t=r.shortOptionNames.get(e))&&(e=t),n.get(e)}function r(e,t){e=C.parseJsonText(e,t);return{config:d(e,e.parseDiagnostics),error:e.parseDiagnostics.length?e.parseDiagnostics[0]:void 0}}function p(e,t){t=s(e,t);return C.isString(t)?C.parseJsonText(e,t):{parseDiagnostics:[t]}}function s(t,e){var r;try{r=e(t)}catch(e){return C.createCompilerDiagnostic(C.Diagnostics.Cannot_read_file_0_Colon_1,t,e.message)}return void 0===r?C.createCompilerDiagnostic(C.Diagnostics.The_specified_path_does_not_exist_Colon_0,t):r}function m(e){return C.arrayToMap(e,function(e){return e.name})}function d(e,t){return y(e,t,void 0,void 0)}function y(p,h,m,g){return p.jsonObject?a(p.jsonObject,m,void 0,void 0):{};function a(e,t,r,n){for(var i={},s=0,a=e.properties;s<a.length;s++){var o,l,c,u,d=a[s];261!==d.kind?h.push(C.createDiagnosticForNodeInSourceFile(p,d,C.Diagnostics.Property_assignment_expected)):(d.questionToken&&h.push(C.createDiagnosticForNodeInSourceFile(p,d.questionToken,C.Diagnostics._0_can_only_be_used_in_a_ts_file,"?")),_(d.name)||h.push(C.createDiagnosticForNodeInSourceFile(p,d.name,C.Diagnostics.String_literal_with_double_quotes_expected)),o=C.unescapeLeadingUnderscores(C.getTextOfPropertyName(d.name)),l=t?t.get(o):void 0,c=(r&&!l&&h.push(C.createDiagnosticForNodeInSourceFile(p,d.name,r,o)),f(d.initializer,l)),void 0!==o&&(i[o]=c,g)&&(n||t===m)&&(u=b(l,c),n?u&&g.onSetValidOptionKeyValueInParent(n,l,c):t===m&&(u?g.onSetValidOptionKeyValueInRoot(o,d.name,c,d.initializer):l||g.onSetUnknownOptionKeyValueInRoot(o,d.name,c,d.initializer))))}return i}function f(n,t){switch(n.kind){case 101:return s(t&&"boolean"!==t.type),!0;case 86:return s(t&&"boolean"!==t.type),!1;case 95:return s(t&&"extends"===t.name),null;case 9:_(n)||h.push(C.createDiagnosticForNodeInSourceFile(p,n,C.Diagnostics.String_literal_with_double_quotes_expected)),s(t&&C.isString(t.type)&&"string"!==t.type);var e=n.text;return!t||C.isString(t.type)||(r=t).type.has(e.toLowerCase())||h.push(o(r,function(e,t,r){return C.createDiagnosticForNodeInSourceFile(p,n,e,t,r)})),e;case 8:return s(t&&"number"!==t.type),Number(n.text);case 178:s(t&&"object"!==t.type);var r=n;return t?a(r,t.elementOptions,t.extraKeyDiagnosticMessage,t.name):a(r,void 0,void 0,void 0);case 177:return s(t&&"list"!==t.type),e=n.elements,i=t&&t.element,e.map(function(e){return f(e,i)})}var i;function s(e){e&&h.push(C.createDiagnosticForNodeInSourceFile(p,n,C.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,t.name,l(t)))}t?s(!0):h.push(C.createDiagnosticForNodeInSourceFile(p,n,C.Diagnostics.Property_value_can_only_be_string_literal_numeric_literal_true_false_null_object_literal_or_array_literal))}function _(e){return C.isStringLiteral(e)&&C.isStringDoubleQuoted(e,p)}}function l(e){return"list"===e.type?"Array":C.isString(e.type)?e.type:"string"}function b(e,t){if(e)return!!k(t)||("list"===e.type?C.isArray(t):typeof t===(C.isString(e.type)?e.type:"string"))}function T(e,t){t&&Object.defineProperty(e,"configFile",{enumerable:!1,writable:!1,value:t})}function k(e){return null==e}function x(e,t){return C.getDirectoryPath(C.toPath(e,t,C.identity))}function c(e,i,s,a,t,o,l,c){void 0===t&&(t={}),void 0===l&&(l=[]),void 0===c&&(c=[]),C.Debug.assert(void 0===e&&void 0!==i||void 0!==e&&void 0===i);var u=[],r=C.createGetCanonicalFileName(s.useCaseSensitiveFileNames),e=w(e,i,s,a,o,r,l,u),d=e.raw,p=C.extend(t,e.options||{}),r=(p.configFilePath=o,T(p,i),(()=>{C.hasProperty(d,"files")&&!k(d.files)&&(C.isArray(d.files)?0===(e=d.files).length&&h(C.Diagnostics.The_files_list_in_config_file_0_is_empty,o||"tsconfig.json"):h(C.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,"files","Array")),C.hasProperty(d,"include")&&!k(d.include)&&(C.isArray(d.include)?t=d.include:h(C.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,"include","Array")),C.hasProperty(d,"exclude")&&!k(d.exclude)?C.isArray(d.exclude)?r=d.exclude:h(C.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,"exclude","Array"):(n=d.compilerOptions&&d.compilerOptions.outDir)&&(r=[n]);var e,t,r,n=((e,t,r,n,i,s,a,o,l)=>{var c,u;return n=C.normalizePath(n),t&&(c=H(t,a,!1,l,"include")),r&&(u=H(r,a,!0,l,"exclude")),a=((e,t,r,n)=>{var i=(t=C.getRegularExpressionForWildcard(t,r,"exclude"))&&new RegExp(t,n?"":"i"),s={};if(void 0!==e){for(var a=[],o=0,l=e;o<l.length;o++){var c,u,d=l[o],d=C.normalizePath(C.combinePaths(r,d));i&&i.test(d)||(d=((e,t)=>{var r=V.exec(e);return r?{key:t?r[0]:r[0].toLowerCase(),flags:U.test(e)?1:0}:C.isImplicitGlob(e)?{key:e,flags:1}:void 0})(d,n))&&(c=d.key,d=d.flags,void 0===(u=s[c])||u<d)&&1===(s[c]=d)&&a.push(c)}for(c in s)if(C.hasProperty(s,c))for(var p=0,h=a;p<h.length;p++){var m=h[p];c!==m&&C.containsPath(m,c,r,!n)&&delete s[c]}}return s})(c,u,n,s.useCaseSensitiveFileNames),M({filesSpecs:e,includeSpecs:t,excludeSpecs:r,validatedIncludeSpecs:c,validatedExcludeSpecs:u,wildcardDirectories:a},n,i,s,o)})(e,t=void 0===e&&void 0===t?["**/*"]:t,r,o?x(o,a):a,p,s,u,c,i);return 0!==n.fileNames.length||C.hasProperty(d,"files")||0!==l.length||u.push(E(n.spec,o)),n})()),t=r.fileNames,n=r.wildcardDirectories,r=r.spec;return{options:p,fileNames:t,typeAcquisition:e.typeAcquisition||N(),raw:d,errors:u,wildcardDirectories:n,compileOnSave:!!d.compileOnSave,configFileSpecs:r};function h(e,t,r){i||u.push(C.createCompilerDiagnostic(e,t,r))}}function E(e,t){var r=e.includeSpecs,e=e.excludeSpecs;return C.createCompilerDiagnostic(C.Diagnostics.No_inputs_were_found_in_config_file_0_Specified_include_paths_were_1_and_exclude_paths_were_2,t||"tsconfig.json",JSON.stringify(r||[]),JSON.stringify(e||[]))}function S(e){return e.options}function w(e,t,r,n,i,s,a,o){n=C.normalizeSlashes(n);var l,c,u=C.toPath(i||"",n,s);return 0<=a.indexOf(u)?(o.push(C.createCompilerDiagnostic(C.Diagnostics.Circularity_detected_while_resolving_configuration_Colon_0,a.concat([u]).join(" -> "))),{raw:e||d(t,o)}):((e=e?((e,t,r,n,i,s)=>{C.hasProperty(e,"excludes")&&s.push(C.createCompilerDiagnostic(C.Diagnostics.Unknown_option_excludes_Did_you_mean_exclude));var a,o=D(e.compilerOptions,r,s,i),l=O(e.typeAcquisition||e.typingOptions,r,s,i);return e.compileOnSave=((e,t,r)=>{if(C.hasProperty(e,C.compileOnSaveCommandLineOption.name))return!("boolean"!=typeof(e=R(C.compileOnSaveCommandLineOption,e.compileOnSave,t,r))||!e)&&e})(e,r,s),e.extends&&(C.isString(e.extends)?(i=i?x(i,r):r,a=I(e.extends,t,i,n,s,C.createCompilerDiagnostic)):s.push(C.createCompilerDiagnostic(C.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,"extends","string"))),{raw:e,options:o,typeAcquisition:l,extendedConfigPath:a}})(e,r,n,s,i,o):((s,a,o,l,c,u)=>{var n,i,d,p=A(c),e={onSetValidOptionKeyValueInParent:function(e,t,r){C.Debug.assert("compilerOptions"===e||"typeAcquisition"===e||"typingOptions"===e),("compilerOptions"===e?p:"typeAcquisition"===e?n=n||N(c):i=i||N(c))[t.name]=function t(e,r,n){if(k(n))return;{var i;if("list"===e.type)return(i=e).element.isFilePath||!C.isString(i.element.type)?C.filter(C.map(n,function(e){return t(i.element,r,e)}),function(e){return!!e}):n;if(!C.isString(e.type))return e.type.get(C.isString(n)?n.toLowerCase():n)}return L(e,r,n)}(t,o,r)},onSetValidOptionKeyValueInRoot:function(e,t,r,n){switch(e){case"extends":var i=c?x(c,o):o;return void(d=I(r,a,i,l,u,function(e,t){return C.createDiagnosticForNodeInSourceFile(s,n,e,t)}));case"files":return void(0===r.length&&u.push(C.createDiagnosticForNodeInSourceFile(s,n,C.Diagnostics.The_files_list_in_config_file_0_is_empty,c||"tsconfig.json")))}},onSetUnknownOptionKeyValueInRoot:function(e,t,r,n){"excludes"===e&&u.push(C.createDiagnosticForNodeInSourceFile(s,t,C.Diagnostics.Unknown_option_excludes_Did_you_mean_exclude))}},e=y(s,u,h=void 0===h?m([{name:"compilerOptions",type:"object",elementOptions:m(C.optionDeclarations),extraKeyDiagnosticMessage:C.Diagnostics.Unknown_compiler_option_0},{name:"typingOptions",type:"object",elementOptions:m(C.typeAcquisitionDeclarations),extraKeyDiagnosticMessage:C.Diagnostics.Unknown_type_acquisition_option_0},{name:"typeAcquisition",type:"object",elementOptions:m(C.typeAcquisitionDeclarations),extraKeyDiagnosticMessage:C.Diagnostics.Unknown_type_acquisition_option_0},{name:"extends",type:"string"},{name:"files",type:"list",element:{name:"files",type:"string"}},{name:"include",type:"list",element:{name:"include",type:"string"}},{name:"exclude",type:"list",element:{name:"exclude",type:"string"}},C.compileOnSaveCommandLineOption]):h,e);return n=n||(i?void 0!==i.enableAutoDiscovery?{enable:i.enableAutoDiscovery,include:i.include,exclude:i.exclude}:i:N(c)),{raw:e,options:p,typeAcquisition:n,extendedConfigPath:d}})(t,r,n,s,i,o)).extendedConfigPath&&(a=a.concat([u]),i=((e,t,r,n,i,s,a)=>{var o,l,c,u,d=p(t,function(e){return r.readFile(e)});if(e&&(e.extendedSourceFiles||(e.extendedSourceFiles=[])).push(d.fileName),!d.parseDiagnostics.length)return o=C.getDirectoryPath(t),t=w(void 0,d,r,o,C.getBaseFileName(t),i,s,a),e&&(s=e.extendedSourceFiles).push.apply(s,d.extendedSourceFiles),S(t)&&(l=C.convertToRelativePath(o,n,i),c=function(e){return C.isRootedDiskPath(e)?e:C.combinePaths(l,e)},a=function(e){u[e]&&(u[e]=C.map(u[e],c))},u=t.raw,a("include"),a("exclude"),a("files")),t;a.push.apply(a,d.parseDiagnostics)})(t,e.extendedConfigPath,r,n,s,a,o))&&S(i)&&(l=i.raw,c=e.raw,(u=function(e){var t=c[e]||l[e];t&&(c[e]=t)})("include"),u("exclude"),u("files"),void 0===c.compileOnSave&&(c.compileOnSave=l.compileOnSave),e.options=C.assign({},i.options,e.options)),e)}function I(e,t,r,n,i,s){if(e=C.normalizeSlashes(e),C.isRootedDiskPath(e)||C.startsWith(e,"./")||C.startsWith(e,"../")){r=C.toPath(e,r,n);if(t.fileExists(r)||C.endsWith(r,".json")||t.fileExists(r+=".json"))return r;i.push(s(C.Diagnostics.File_0_does_not_exist,e))}else i.push(s(C.Diagnostics.A_path_in_an_extends_option_must_be_relative_or_rooted_but_0_is_not,e))}function A(e){return"jsconfig.json"===C.getBaseFileName(e)?{allowJs:!0,maxNodeModuleJsDepth:2,allowSyntheticDefaultImports:!0,skipLibCheck:!0}:{}}function D(e,t,r,n){n=A(n);return a(C.optionDeclarations,e,t,n,C.Diagnostics.Unknown_compiler_option_0,r),n}function N(e){return{enable:"jsconfig.json"===C.getBaseFileName(e),include:[],exclude:[]}}function O(e,t,r,n){n=N(n),e=i(e);return a(C.typeAcquisitionDeclarations,e,t,n,C.Diagnostics.Unknown_type_acquisition_option_0,r),n}function a(e,t,r,n,i,s){if(t){var a,o=m(e);for(a in t){var l=o.get(a);l?n[l.name]=R(l,t[a],r,s):s.push(C.createCompilerDiagnostic(i,a))}}}function R(e,t,r,n){var i,s,a,o;if(b(e,t))return"list"===(i=e.type)&&C.isArray(t)?(s=e,a=r,o=n,C.filter(C.map(t,function(e){return R(s.element,e,a,o)}),function(e){return!!e})):C.isString(i)?L(e,r,t):u(e,t,n);n.push(C.createCompilerDiagnostic(C.Diagnostics.Compiler_option_0_requires_a_value_of_type_1,e.name,l(e)))}function L(e,t,r){return r=e.isFilePath&&""===(r=C.normalizePath(C.combinePaths(t,r)))?".":r}function u(e,t,r){if(!k(t))return t=t.toLowerCase(),void 0!==(t=e.type.get(t))?t:void r.push(n(e))}function P(e){return"function"==typeof e.trim?e.trim():e.replace(/^[\s]+|[\s]+$/g,"")}C.compileOnSaveCommandLineOption={name:"compileOnSave",type:"boolean"},C.optionDeclarations=[{name:"help",shortName:"h",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Command_line_Options,description:C.Diagnostics.Print_this_message},{name:"help",shortName:"?",type:"boolean"},{name:"all",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Command_line_Options,description:C.Diagnostics.Show_all_compiler_options},{name:"version",shortName:"v",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Command_line_Options,description:C.Diagnostics.Print_the_compiler_s_version},{name:"init",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Command_line_Options,description:C.Diagnostics.Initializes_a_TypeScript_project_and_creates_a_tsconfig_json_file},{name:"project",shortName:"p",type:"string",isFilePath:!0,showInSimplifiedHelpView:!0,category:C.Diagnostics.Command_line_Options,paramType:C.Diagnostics.FILE_OR_DIRECTORY,description:C.Diagnostics.Compile_the_project_given_the_path_to_its_configuration_file_or_to_a_folder_with_a_tsconfig_json},{name:"pretty",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Command_line_Options,description:C.Diagnostics.Stylize_errors_and_messages_using_color_and_context_experimental},{name:"watch",shortName:"w",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Command_line_Options,description:C.Diagnostics.Watch_input_files},{name:"target",shortName:"t",type:C.createMapFromTemplate({es3:0,es5:1,es6:2,es2015:2,es2016:3,es2017:4,esnext:5}),paramType:C.Diagnostics.VERSION,showInSimplifiedHelpView:!0,category:C.Diagnostics.Basic_Options,description:C.Diagnostics.Specify_ECMAScript_target_version_Colon_ES3_default_ES5_ES2015_ES2016_ES2017_or_ESNEXT},{name:"module",shortName:"m",type:C.createMapFromTemplate({none:C.ModuleKind.None,commonjs:C.ModuleKind.CommonJS,amd:C.ModuleKind.AMD,system:C.ModuleKind.System,umd:C.ModuleKind.UMD,es6:C.ModuleKind.ES2015,es2015:C.ModuleKind.ES2015,esnext:C.ModuleKind.ESNext}),paramType:C.Diagnostics.KIND,showInSimplifiedHelpView:!0,category:C.Diagnostics.Basic_Options,description:C.Diagnostics.Specify_module_code_generation_Colon_none_commonjs_amd_system_umd_es2015_or_ESNext},{name:"lib",type:"list",element:{name:"lib",type:C.createMapFromTemplate({es5:"lib.es5.d.ts",es6:"lib.es2015.d.ts",es2015:"lib.es2015.d.ts",es7:"lib.es2016.d.ts",es2016:"lib.es2016.d.ts",es2017:"lib.es2017.d.ts",esnext:"lib.esnext.d.ts",dom:"lib.dom.d.ts","dom.iterable":"lib.dom.iterable.d.ts",webworker:"lib.webworker.d.ts",scripthost:"lib.scripthost.d.ts","es2015.core":"lib.es2015.core.d.ts","es2015.collection":"lib.es2015.collection.d.ts","es2015.generator":"lib.es2015.generator.d.ts","es2015.iterable":"lib.es2015.iterable.d.ts","es2015.promise":"lib.es2015.promise.d.ts","es2015.proxy":"lib.es2015.proxy.d.ts","es2015.reflect":"lib.es2015.reflect.d.ts","es2015.symbol":"lib.es2015.symbol.d.ts","es2015.symbol.wellknown":"lib.es2015.symbol.wellknown.d.ts","es2016.array.include":"lib.es2016.array.include.d.ts","es2017.object":"lib.es2017.object.d.ts","es2017.sharedmemory":"lib.es2017.sharedmemory.d.ts","es2017.string":"lib.es2017.string.d.ts","es2017.intl":"lib.es2017.intl.d.ts","esnext.asynciterable":"lib.esnext.asynciterable.d.ts"})},showInSimplifiedHelpView:!0,category:C.Diagnostics.Basic_Options,description:C.Diagnostics.Specify_library_files_to_be_included_in_the_compilation_Colon},{name:"allowJs",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Basic_Options,description:C.Diagnostics.Allow_javascript_files_to_be_compiled},{name:"checkJs",type:"boolean",category:C.Diagnostics.Basic_Options,description:C.Diagnostics.Report_errors_in_js_files},{name:"jsx",type:C.createMapFromTemplate({preserve:1,"react-native":3,react:2}),paramType:C.Diagnostics.KIND,showInSimplifiedHelpView:!0,category:C.Diagnostics.Basic_Options,description:C.Diagnostics.Specify_JSX_code_generation_Colon_preserve_react_native_or_react},{name:"declaration",shortName:"d",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Basic_Options,description:C.Diagnostics.Generates_corresponding_d_ts_file},{name:"sourceMap",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Basic_Options,description:C.Diagnostics.Generates_corresponding_map_file},{name:"outFile",type:"string",isFilePath:!0,paramType:C.Diagnostics.FILE,showInSimplifiedHelpView:!0,category:C.Diagnostics.Basic_Options,description:C.Diagnostics.Concatenate_and_emit_output_to_single_file},{name:"outDir",type:"string",isFilePath:!0,paramType:C.Diagnostics.DIRECTORY,showInSimplifiedHelpView:!0,category:C.Diagnostics.Basic_Options,description:C.Diagnostics.Redirect_output_structure_to_the_directory},{name:"rootDir",type:"string",isFilePath:!0,paramType:C.Diagnostics.LOCATION,category:C.Diagnostics.Basic_Options,description:C.Diagnostics.Specify_the_root_directory_of_input_files_Use_to_control_the_output_directory_structure_with_outDir},{name:"removeComments",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Basic_Options,description:C.Diagnostics.Do_not_emit_comments_to_output},{name:"noEmit",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Basic_Options,description:C.Diagnostics.Do_not_emit_outputs},{name:"importHelpers",type:"boolean",category:C.Diagnostics.Basic_Options,description:C.Diagnostics.Import_emit_helpers_from_tslib},{name:"downlevelIteration",type:"boolean",category:C.Diagnostics.Basic_Options,description:C.Diagnostics.Provide_full_support_for_iterables_in_for_of_spread_and_destructuring_when_targeting_ES5_or_ES3},{name:"isolatedModules",type:"boolean",category:C.Diagnostics.Basic_Options,description:C.Diagnostics.Transpile_each_file_as_a_separate_module_similar_to_ts_transpileModule},{name:"strict",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Strict_Type_Checking_Options,description:C.Diagnostics.Enable_all_strict_type_checking_options},{name:"noImplicitAny",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Strict_Type_Checking_Options,description:C.Diagnostics.Raise_error_on_expressions_and_declarations_with_an_implied_any_type},{name:"strictNullChecks",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Strict_Type_Checking_Options,description:C.Diagnostics.Enable_strict_null_checks},{name:"strictFunctionTypes",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Strict_Type_Checking_Options,description:C.Diagnostics.Enable_strict_checking_of_function_types},{name:"noImplicitThis",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Strict_Type_Checking_Options,description:C.Diagnostics.Raise_error_on_this_expressions_with_an_implied_any_type},{name:"alwaysStrict",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Strict_Type_Checking_Options,description:C.Diagnostics.Parse_in_strict_mode_and_emit_use_strict_for_each_source_file},{name:"noUnusedLocals",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Additional_Checks,description:C.Diagnostics.Report_errors_on_unused_locals},{name:"noUnusedParameters",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Additional_Checks,description:C.Diagnostics.Report_errors_on_unused_parameters},{name:"noImplicitReturns",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Additional_Checks,description:C.Diagnostics.Report_error_when_not_all_code_paths_in_function_return_a_value},{name:"noFallthroughCasesInSwitch",type:"boolean",showInSimplifiedHelpView:!0,category:C.Diagnostics.Additional_Checks,description:C.Diagnostics.Report_errors_for_fallthrough_cases_in_switch_statement},{name:"moduleResolution",type:C.createMapFromTemplate({node:C.ModuleResolutionKind.NodeJs,classic:C.ModuleResolutionKind.Classic}),paramType:C.Diagnostics.STRATEGY,category:C.Diagnostics.Module_Resolution_Options,description:C.Diagnostics.Specify_module_resolution_strategy_Colon_node_Node_js_or_classic_TypeScript_pre_1_6},{name:"baseUrl",type:"string",isFilePath:!0,category:C.Diagnostics.Module_Resolution_Options,description:C.Diagnostics.Base_directory_to_resolve_non_absolute_module_names},{name:"paths",type:"object",isTSConfigOnly:!0,category:C.Diagnostics.Module_Resolution_Options,description:C.Diagnostics.A_series_of_entries_which_re_map_imports_to_lookup_locations_relative_to_the_baseUrl},{name:"rootDirs",type:"list",isTSConfigOnly:!0,element:{name:"rootDirs",type:"string",isFilePath:!0},category:C.Diagnostics.Module_Resolution_Options,description:C.Diagnostics.List_of_root_folders_whose_combined_content_represents_the_structure_of_the_project_at_runtime},{name:"typeRoots",type:"list",element:{name:"typeRoots",type:"string",isFilePath:!0},category:C.Diagnostics.Module_Resolution_Options,description:C.Diagnostics.List_of_folders_to_include_type_definitions_from},{name:"types",type:"list",element:{name:"types",type:"string"},showInSimplifiedHelpView:!0,category:C.Diagnostics.Module_Resolution_Options,description:C.Diagnostics.Type_declaration_files_to_be_included_in_compilation},{name:"allowSyntheticDefaultImports",type:"boolean",category:C.Diagnostics.Module_Resolution_Options,description:C.Diagnostics.Allow_default_imports_from_modules_with_no_default_export_This_does_not_affect_code_emit_just_typechecking},{name:"preserveSymlinks",type:"boolean",category:C.Diagnostics.Module_Resolution_Options,description:C.Diagnostics.Do_not_resolve_the_real_path_of_symlinks},{name:"sourceRoot",type:"string",isFilePath:!0,paramType:C.Diagnostics.LOCATION,category:C.Diagnostics.Source_Map_Options,description:C.Diagnostics.Specify_the_location_where_debugger_should_locate_TypeScript_files_instead_of_source_locations},{name:"mapRoot",type:"string",isFilePath:!0,paramType:C.Diagnostics.LOCATION,category:C.Diagnostics.Source_Map_Options,description:C.Diagnostics.Specify_the_location_where_debugger_should_locate_map_files_instead_of_generated_locations},{name:"inlineSourceMap",type:"boolean",category:C.Diagnostics.Source_Map_Options,description:C.Diagnostics.Emit_a_single_file_with_source_maps_instead_of_having_a_separate_file},{name:"inlineSources",type:"boolean",category:C.Diagnostics.Source_Map_Options,description:C.Diagnostics.Emit_the_source_alongside_the_sourcemaps_within_a_single_file_requires_inlineSourceMap_or_sourceMap_to_be_set},{name:"experimentalDecorators",type:"boolean",category:C.Diagnostics.Experimental_Options,description:C.Diagnostics.Enables_experimental_support_for_ES7_decorators},{name:"emitDecoratorMetadata",type:"boolean",category:C.Diagnostics.Experimental_Options,description:C.Diagnostics.Enables_experimental_support_for_emitting_type_metadata_for_decorators},{name:"jsxFactory",type:"string",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Specify_the_JSX_factory_function_to_use_when_targeting_react_JSX_emit_e_g_React_createElement_or_h},{name:"diagnostics",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Show_diagnostic_information},{name:"extendedDiagnostics",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Show_verbose_diagnostic_information},{name:"traceResolution",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Enable_tracing_of_the_name_resolution_process},{name:"listFiles",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Print_names_of_files_part_of_the_compilation},{name:"listEmittedFiles",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Print_names_of_generated_files_part_of_the_compilation},{name:"out",type:"string",isFilePath:!1,category:C.Diagnostics.Advanced_Options,paramType:C.Diagnostics.FILE,description:C.Diagnostics.Deprecated_Use_outFile_instead_Concatenate_and_emit_output_to_single_file},{name:"reactNamespace",type:"string",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Deprecated_Use_jsxFactory_instead_Specify_the_object_invoked_for_createElement_when_targeting_react_JSX_emit},{name:"skipDefaultLibCheck",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Deprecated_Use_skipLibCheck_instead_Skip_type_checking_of_default_library_declaration_files},{name:"charset",type:"string",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.The_character_set_of_the_input_files},{name:"emitBOM",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Emit_a_UTF_8_Byte_Order_Mark_BOM_in_the_beginning_of_output_files},{name:"locale",type:"string",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.The_locale_used_when_displaying_messages_to_the_user_e_g_en_us},{name:"newLine",type:C.createMapFromTemplate({crlf:0,lf:1}),paramType:C.Diagnostics.NEWLINE,category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Specify_the_end_of_line_sequence_to_be_used_when_emitting_files_Colon_CRLF_dos_or_LF_unix},{name:"noErrorTruncation",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Do_not_truncate_error_messages},{name:"noLib",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Do_not_include_the_default_library_file_lib_d_ts},{name:"noResolve",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Do_not_add_triple_slash_references_or_imported_modules_to_the_list_of_compiled_files},{name:"stripInternal",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Do_not_emit_declarations_for_code_that_has_an_internal_annotation},{name:"disableSizeLimit",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Disable_size_limitations_on_JavaScript_projects},{name:"noImplicitUseStrict",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Do_not_emit_use_strict_directives_in_module_output},{name:"noEmitHelpers",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Do_not_generate_custom_helper_functions_like_extends_in_compiled_output},{name:"noEmitOnError",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Do_not_emit_outputs_if_any_errors_were_reported},{name:"preserveConstEnums",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Do_not_erase_const_enum_declarations_in_generated_code},{name:"declarationDir",type:"string",isFilePath:!0,paramType:C.Diagnostics.DIRECTORY,category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Output_directory_for_generated_declaration_files},{name:"skipLibCheck",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Skip_type_checking_of_declaration_files},{name:"allowUnusedLabels",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Do_not_report_errors_on_unused_labels},{name:"allowUnreachableCode",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Do_not_report_errors_on_unreachable_code},{name:"suppressExcessPropertyErrors",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Suppress_excess_property_checks_for_object_literals},{name:"suppressImplicitAnyIndexErrors",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Suppress_noImplicitAny_errors_for_indexing_objects_lacking_index_signatures},{name:"forceConsistentCasingInFileNames",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Disallow_inconsistently_cased_references_to_the_same_file},{name:"maxNodeModuleJsDepth",type:"number",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.The_maximum_dependency_depth_to_search_under_node_modules_and_load_JavaScript_files},{name:"noStrictGenericChecks",type:"boolean",category:C.Diagnostics.Advanced_Options,description:C.Diagnostics.Disable_strict_checking_of_generic_signatures_in_function_types},{name:"plugins",type:"list",isTSConfigOnly:!0,element:{name:"plugin",type:"object"},description:C.Diagnostics.List_of_language_service_plugins}],C.typeAcquisitionDeclarations=[{name:"enableAutoDiscovery",type:"boolean"},{name:"enable",type:"boolean"},{name:"include",type:"list",element:{name:"include",type:"string"}},{name:"exclude",type:"list",element:{name:"exclude",type:"string"}}],C.defaultInitCompilerOptions={module:C.ModuleKind.CommonJS,target:1,strict:!0},C.convertEnableAutoDiscoveryToEnable=i,C.createCompilerDiagnosticForInvalidCustomType=n,C.parseCustomTypeOption=g,C.parseListTypeOption=f,C.parseCommandLine=function(e,u){var d={},p=[],h=[];return m(e),{options:d,fileNames:p,errors:h};function m(e){for(var t=0;t<e.length;){var r=e[t];if(t++,64===r.charCodeAt(0)){o=a=s=i=n=void 0;var n=r.slice(1),i=u?u(n):C.sys.readFile(n);if(i){for(var s=[],a=0;;){for(;a<i.length&&i.charCodeAt(a)<=32;)a++;if(a>=i.length)break;var o=a;if(34===i.charCodeAt(o)){for(a++;a<i.length&&34!==i.charCodeAt(a);)a++;a<i.length?(s.push(i.substring(o+1,a)),a++):h.push(C.createCompilerDiagnostic(C.Diagnostics.Unterminated_quoted_string_in_response_file_0,n))}else{for(;32<i.charCodeAt(a);)a++;s.push(i.substring(o,a))}}m(s)}else h.push(C.createCompilerDiagnostic(C.Diagnostics.File_0_not_found,n))}else if(45===r.charCodeAt(0)){var l=_(r.slice(45===r.charCodeAt(1)?2:1),!0);if(l)if(l.isTSConfigOnly)h.push(C.createCompilerDiagnostic(C.Diagnostics.Option_0_can_only_be_specified_in_tsconfig_json_file,l.name));else switch(e[t]||"boolean"===l.type||h.push(C.createCompilerDiagnostic(C.Diagnostics.Compiler_option_0_expects_an_argument,l.name)),l.type){case"number":d[l.name]=parseInt(e[t]),t++;break;case"boolean":var c=e[t];d[l.name]="false"!==c,"false"!==c&&"true"!==c||t++;break;case"string":d[l.name]=e[t]||"",t++;break;case"list":c=f(l,e[t],h);d[l.name]=c||[],c&&t++;break;default:d[l.name]=g(l,e[t],h),t++}else h.push(C.createCompilerDiagnostic(C.Diagnostics.Unknown_compiler_option_0,r))}else p.push(r)}}},C.readConfigFile=function(e,t){return t=s(e,t),C.isString(t)?r(e,t):{config:{},error:t}},C.parseConfigFileTextToJson=r,C.readJsonConfigFile=p,C.convertToObject=d,C.generateTSConfig=function(e,t,r){for(var a=(i=>{function e(e){if(C.hasProperty(i,e)){if(a.has(e)&&a.get(e).category===C.Diagnostics.Command_line_Options)return;var t,r=i[e],n=a.get(e.toLowerCase());n&&((t=function e(t){if("string"!==t.type&&"number"!==t.type&&"boolean"!==t.type)return"list"===t.type?e(t.element):t.type}(n))?"list"===n.type?s.set(e,r.map(function(e){return y(e,t)})):s.set(e,y(r,t)):s.set(e,r))}}var t,s=C.createMap(),a=v().optionNameMap;for(t in i)e(t);return s})(C.extend(e,C.defaultInitCompilerOptions)),n=C.createMultiMap(),i=0,s=C.optionDeclarations;i<s.length;i++){var o=s[i],l=o.category;void 0!==l&&l!==C.Diagnostics.Command_line_Options&&l!==C.Diagnostics.Advanced_Options&&n.add(C.getLocaleSpecificMessage(l),o)}var c=0,u=0,d=[],p=[],h=(n.forEach(function(e,t){0!==d.length&&(d.push(""),p.push("")),d.push("/* "+t+" */"),p.push("");for(var r=0,n=e;r<n.length;r++){var i=n[r],s=void 0,s=a.has(i.name)?'"'+i.name+'": '+JSON.stringify(a.get(i.name))+((u+=1)===a.size?"":","):'// "'+i.name+'": '+JSON.stringify((e=>{switch(e.type){case"number":return 1;case"boolean":return!0;case"string":return e.isFilePath?"./":"";case"list":return[];case"object":return{};default:return e.type.keys().next().value}})(i))+",";d.push(s),p.push("/* "+(i.description&&C.getLocaleSpecificMessage(i.description)||i.name)+" */"),c=Math.max(s.length,c)}}),b(2)),m=[];m.push("{"),m.push(h+'"compilerOptions": {');for(var g=0;g<d.length;g++){var f=d[g],_=p[g];m.push(f&&""+h+h+f+(_&&b(c-f.length+2)+_))}if(t.length){m.push(h+"},"),m.push(h+'"files": [');for(g=0;g<t.length;g++)m.push(""+h+h+JSON.stringify(t[g])+(g===t.length-1?"":","));m.push(h+"]")}else m.push(h+"}");return m.push("}"),m.join(r);function y(r,e){return C.forEachEntry(e,function(e,t){if(e===r)return t})}function b(e){return Array(e+1).join(" ")}},C.parseJsonConfigFileContent=function(e,t,r,n,i,s,a){return c(e,void 0,t,r,n,i,s,a)},C.parseJsonSourceFileConfigFileContent=function(e,t,r,n,i,s,a){return c(void 0,e,t,r,n,i,s,a)},C.setConfigFileInOptions=T,C.isErrorNoInputFiles=function(e){return e.code===C.Diagnostics.No_inputs_were_found_in_config_file_0_Specified_include_paths_were_1_and_exclude_paths_were_2.code},C.getErrorForNoInputFiles=E,C.convertCompilerOptionsFromJson=function(e,t,r){var n=[];return{options:D(e,t,n,r),errors:n}},C.convertTypeAcquisitionFromJson=function(e,t,r){var n=[];return{options:O(e,t,n,r),errors:n}};var F=/(^|\/)\*\*\/?$/,B=/(^|\/)\*\*\/(.*\/)?\*\*($|\/)/,$=/(^|\/)\*\*\/(.*\/)?\.\.($|\/)/,U=/\/[^/]*?[*?][^/]*\//,V=/^[^*?]*(?=\/[^/]*[*?])/;function M(e,t,r,n,i){void 0===i&&(i=[]),t=C.normalizePath(t);var s=n.useCaseSensitiveFileNames?G:j,a=C.createMap(),o=C.createMap(),l=e.filesSpecs,c=e.validatedIncludeSpecs,u=e.validatedExcludeSpecs,d=e.wildcardDirectories,p=C.getSupportedExtensions(r,i);if(l)for(var h=0,m=l;h<m.length;h++){var g=m[h],f=C.getNormalizedAbsolutePath(g,t);a.set(s(f),f)}if(c&&0<c.length)for(var _=0,y=n.readDirectory(t,p,u,c,void 0);_<y.length;_++){f=y[_];if(!((e,t,r,n,i)=>{for(var s=C.getExtensionPriority(e,n),a=C.adjustExtensionPriority(s,n),o=0;o<a;o++){var l=n[o],l=i(C.changeExtension(e,l));if(t.has(l)||r.has(l))return 1}})(f,a,o,p,s)){S=E=x=k=T=v=b=void 0;for(var b=f,v=o,T=p,k=s,x=C.getExtensionPriority(b,T),E=C.getNextLowestExtensionPriority(x,T);E<T.length;E++){var S=T[E],S=k(C.changeExtension(b,S));v.delete(S)}x=s(f);a.has(x)||o.has(x)||o.set(x,f)}}r=C.arrayFrom(a.values()),i=C.arrayFrom(o.values());return{fileNames:r.concat(i),wildcardDirectories:d,spec:e}}function H(e,r,n,l,c){return e.filter(function(e){t=e;var t=!n&&F.test(t)?C.Diagnostics.File_specification_cannot_end_in_a_recursive_directory_wildcard_Asterisk_Asterisk_Colon_0:B.test(t)?C.Diagnostics.File_specification_cannot_contain_multiple_recursive_directory_wildcards_Asterisk_Asterisk_Colon_0:$.test(t)?C.Diagnostics.File_specification_cannot_contain_a_parent_directory_that_appears_after_a_recursive_directory_wildcard_Asterisk_Asterisk_Colon_0:void 0;return void 0!==t&&r.push(((e,t)=>{if(l&&l.jsonObject)for(var r=0,n=C.getPropertyAssignment(l.jsonObject,c);r<n.length;r++){var i=n[r];if(C.isArrayLiteralExpression(i.initializer))for(var s=0,a=i.initializer.elements;s<a.length;s++){var o=a[s];if(C.isStringLiteral(o)&&o.text===t)return C.createDiagnosticForNodeInSourceFile(l,o,e,t)}}return C.createCompilerDiagnostic(e,t)})(t,e)),void 0===t})}function G(e){return e}function j(e){return e.toLowerCase()}C.getFileNamesFromConfigSpecs=M,C.convertCompilerOptionsForTelemetry=function(e){var t,r,n={};for(t in e)e.hasOwnProperty(t)&&void 0!==(r=_(t))&&(n[t]=function t(r,e){switch(e.type){case"object":case"string":return"";case"number":return"number"==typeof r?r:"";case"boolean":return"boolean"==typeof r?r:"";case"list":var n=e.element;return C.isArray(r)?r.map(function(e){return t(e,n)}):"";default:return C.forEachEntry(e.type,function(e,t){if(e===r)return t})}}(e[t],r));return n}})(ts=ts||{}),(e=>{var t,r;function n(e){this.text=e}r=e.ScriptSnapshot||(e.ScriptSnapshot={}),n.prototype.getText=function(e,t){return 0===e&&t===this.text.length?this.text:this.text.substring(e,t)},n.prototype.getLength=function(){return this.text.length},n.prototype.getChangeRange=function(){},t=n,r.fromString=function(e){return new t(e)},e.TextChange=function(){},(r=e.HighlightSpanKind||(e.HighlightSpanKind={})).none="none",r.definition="definition",r.reference="reference",r.writtenReference="writtenReference",(r=e.IndentStyle||(e.IndentStyle={}))[r.None=0]="None",r[r.Block=1]="Block",r[r.Smart=2]="Smart",(r=e.SymbolDisplayPartKind||(e.SymbolDisplayPartKind={}))[r.aliasName=0]="aliasName",r[r.className=1]="className",r[r.enumName=2]="enumName",r[r.fieldName=3]="fieldName",r[r.interfaceName=4]="interfaceName",r[r.keyword=5]="keyword",r[r.lineBreak=6]="lineBreak",r[r.numericLiteral=7]="numericLiteral",r[r.stringLiteral=8]="stringLiteral",r[r.localName=9]="localName",r[r.methodName=10]="methodName",r[r.moduleName=11]="moduleName",r[r.operator=12]="operator",r[r.parameterName=13]="parameterName",r[r.propertyName=14]="propertyName",r[r.punctuation=15]="punctuation",r[r.space=16]="space",r[r.text=17]="text",r[r.typeParameterName=18]="typeParameterName",r[r.enumMemberName=19]="enumMemberName",r[r.functionName=20]="functionName",r[r.regularExpressionLiteral=21]="regularExpressionLiteral",(r=e.OutputFileType||(e.OutputFileType={}))[r.JavaScript=0]="JavaScript",r[r.SourceMap=1]="SourceMap",r[r.Declaration=2]="Declaration",(r=e.EndOfLineState||(e.EndOfLineState={}))[r.None=0]="None",r[r.InMultiLineCommentTrivia=1]="InMultiLineCommentTrivia",r[r.InSingleQuoteStringLiteral=2]="InSingleQuoteStringLiteral",r[r.InDoubleQuoteStringLiteral=3]="InDoubleQuoteStringLiteral",r[r.InTemplateHeadOrNoSubstitutionTemplate=4]="InTemplateHeadOrNoSubstitutionTemplate",r[r.InTemplateMiddleOrTail=5]="InTemplateMiddleOrTail",r[r.InTemplateSubstitutionPosition=6]="InTemplateSubstitutionPosition",(r=e.TokenClass||(e.TokenClass={}))[r.Punctuation=0]="Punctuation",r[r.Keyword=1]="Keyword",r[r.Operator=2]="Operator",r[r.Comment=3]="Comment",r[r.Whitespace=4]="Whitespace",r[r.Identifier=5]="Identifier",r[r.NumberLiteral=6]="NumberLiteral",r[r.StringLiteral=7]="StringLiteral",r[r.RegExpLiteral=8]="RegExpLiteral",(r=e.ScriptElementKind||(e.ScriptElementKind={})).unknown="",r.warning="warning",r.keyword="keyword",r.scriptElement="script",r.moduleElement="module",r.classElement="class",r.localClassElement="local class",r.interfaceElement="interface",r.typeElement="type",r.enumElement="enum",r.enumMemberElement="enum member",r.variableElement="var",r.localVariableElement="local var",r.functionElement="function",r.localFunctionElement="local function",r.memberFunctionElement="method",r.memberGetAccessorElement="getter",r.memberSetAccessorElement="setter",r.memberVariableElement="property",r.constructorImplementationElement="constructor",r.callSignatureElement="call",r.indexSignatureElement="index",r.constructSignatureElement="construct",r.parameterElement="parameter",r.typeParameterElement="type parameter",r.primitiveType="primitive type",r.label="label",r.alias="alias",r.constElement="const",r.letElement="let",r.directory="directory",r.externalModuleName="external module name",r.jsxAttribute="JSX attribute",(r=e.ScriptElementKindModifier||(e.ScriptElementKindModifier={})).none="",r.publicMemberModifier="public",r.privateMemberModifier="private",r.protectedMemberModifier="protected",r.exportedModifier="export",r.ambientModifier="declare",r.staticModifier="static",r.abstractModifier="abstract",(r=e.ClassificationTypeNames||(e.ClassificationTypeNames={})).comment="comment",r.identifier="identifier",r.keyword="keyword",r.numericLiteral="number",r.operator="operator",r.stringLiteral="string",r.whiteSpace="whitespace",r.text="text",r.punctuation="punctuation",r.className="class name",r.enumName="enum name",r.interfaceName="interface name",r.moduleName="module name",r.typeParameterName="type parameter name",r.typeAliasName="type alias name",r.parameterName="parameter name",r.docCommentTagName="doc comment tag name",r.jsxOpenTagName="jsx open tag name",r.jsxCloseTagName="jsx close tag name",r.jsxSelfClosingTagName="jsx self closing tag name",r.jsxAttribute="jsx attribute",r.jsxText="jsx text",r.jsxAttributeStringLiteralValue="jsx attribute string literal value",(r=e.ClassificationType||(e.ClassificationType={}))[r.comment=1]="comment",r[r.identifier=2]="identifier",r[r.keyword=3]="keyword",r[r.numericLiteral=4]="numericLiteral",r[r.operator=5]="operator",r[r.stringLiteral=6]="stringLiteral",r[r.regularExpressionLiteral=7]="regularExpressionLiteral",r[r.whiteSpace=8]="whiteSpace",r[r.text=9]="text",r[r.punctuation=10]="punctuation",r[r.className=11]="className",r[r.enumName=12]="enumName",r[r.interfaceName=13]="interfaceName",r[r.moduleName=14]="moduleName",r[r.typeParameterName=15]="typeParameterName",r[r.typeAliasName=16]="typeAliasName",r[r.parameterName=17]="parameterName",r[r.docCommentTagName=18]="docCommentTagName",r[r.jsxOpenTagName=19]="jsxOpenTagName",r[r.jsxCloseTagName=20]="jsxCloseTagName",r[r.jsxSelfClosingTagName=21]="jsxSelfClosingTagName",r[r.jsxAttribute=22]="jsxAttribute",r[r.jsxText=23]="jsxText",r[r.jsxAttributeStringLiteralValue=24]="jsxAttributeStringLiteralValue"})(ts=ts||{}),(h=>{var e;function r(e){switch(e.kind){case 146:case 226:case 176:case 149:case 148:case 261:case 262:case 151:case 150:case 152:case 153:case 154:case 228:case 186:case 187:case 260:case 253:return 1;case 145:case 230:case 231:case 163:return 2;case 283:return void 0===e.name?3:2;case 264:case 229:return 3;case 233:return h.isAmbientModule(e)||1===h.getModuleInstanceState(e)?5:4;case 232:case 241:case 242:case 237:case 238:case 243:case 244:return 7;case 265:return 5}return 7}function n(e){for(;143===e.parent.kind;)e=e.parent;return h.isInternalModuleImportEqualsDeclaration(e.parent)&&e.parent.moduleReference===e}function t(e,t){e=i(e);return e&&e.parent&&e.parent.kind===t&&e.parent.expression===e}function i(e){return a(e)?e.parent:e}function s(e){return 71===e.kind&&(218===e.parent.kind||217===e.parent.kind)&&e.parent.label===e}function a(e){return e&&e.parent&&179===e.parent.kind&&e.parent.name===e}h.scanner=h.createScanner(5,!0),(e=h.SemanticMeaning||(h.SemanticMeaning={}))[e.None=0]="None",e[e.Value=1]="Value",e[e.Type=2]="Type",e[e.Namespace=4]="Namespace",e[e.All=7]="All",h.getMeaningFromDeclaration=r,h.getMeaningFromLocation=function(e){return 265===e.kind?1:243===e.parent.kind?7:n(e)?(t=e,h.Debug.assert(71===t.kind),143!==t.parent.kind||t.parent.right!==t||237!==t.parent.parent.kind?4:7):h.isDeclarationName(e)?r(e.parent):(e=>{switch((e=h.isRightSideOfQualifiedNameOrPropertyAccess(e)?e.parent:e).kind){case 99:return!h.isPartOfExpression(e);case 169:return 1}switch(e.parent.kind){case 159:return 1;case 201:return!h.isExpressionWithTypeArgumentsInClassExtendsClause(e.parent)}})(e)?2:(e=>{var t=e,r=!0;if(143===t.parent.kind){for(;t.parent&&143===t.parent.kind;)t=t.parent;r=t.right===e}return 159===t.parent.kind&&!r})(t=e)||(e=>{var t=e,r=!0;if(179===t.parent.kind){for(;t.parent&&179===t.parent.kind;)t=t.parent;r=t.name===e}return!r&&201===t.parent.kind&&259===t.parent.parent.kind&&(229===(e=t.parent.parent.parent).kind&&108===t.parent.parent.token||230===e.kind&&85===t.parent.parent.token)})(t)?4:h.isTypeParameterDeclaration(e.parent)?(h.Debug.assert(h.isJSDocTemplateTag(e.parent.parent)),2):1;var t},h.isInRightSideOfInternalImportEqualsDeclaration=n,h.isCallExpressionTarget=function(e){return t(e,181)},h.isNewExpressionTarget=function(e){return t(e,182)},h.climbPastPropertyAccess=i,h.getTargetLabel=function(e,t){for(;e;){if(222===e.kind&&e.label.escapedText===t)return e.label;e=e.parent}},h.isJumpStatementTarget=s,h.isLabelName=function(e){return 71===(t=e).kind&&222===t.parent.kind&&t.parent.label===t||s(e);var t},h.isRightSideOfQualifiedName=function(e){return 143===e.parent.kind&&e.parent.right===e},h.isRightSideOfPropertyAccess=a,h.isNameOfModuleDeclaration=function(e){return 233===e.parent.kind&&e.parent.name===e},h.isNameOfFunctionDeclaration=function(e){return 71===e.kind&&h.isFunctionLike(e.parent)&&e.parent.name===e},h.isLiteralNameOfPropertyDeclarationOrIndexAccess=function(e){switch(e.parent.kind){case 149:case 148:case 261:case 264:case 151:case 150:case 153:case 154:case 233:return h.getNameOfDeclaration(e.parent)===e;case 180:return e.parent.argumentExpression===e;case 144:return!0;case 173:return 171===e.parent.parent.kind}},h.isExpressionOfExternalModuleImportEqualsDeclaration=function(e){return h.isExternalModuleImportEqualsDeclaration(e.parent.parent)&&h.getExternalModuleImportEqualsDeclarationExpression(e.parent.parent)===e},h.getContainerNode=function(e){for(283===e.kind&&(e=e.parent.parent);;){if(!(e=e.parent))return;switch(e.kind){case 265:case 151:case 150:case 228:case 186:case 153:case 154:case 229:case 230:case 232:case 233:return e}}},h.getNodeKind=function e(t){switch(t.kind){case 265:return h.isExternalModule(t)?"module":"script";case 233:return"module";case 229:case 199:return"class";case 230:return"interface";case 231:return"type";case 232:return"enum";case 226:return s(t);case 176:return s(h.getRootDeclaration(t));case 187:case 228:case 186:return"function";case 153:return"getter";case 154:return"setter";case 151:case 150:return"method";case 149:case 148:return"property";case 157:return"index";case 156:return"construct";case 155:return"call";case 152:return"constructor";case 145:return"type parameter";case 264:return"enum member";case 146:return h.hasModifier(t,92)?"property":"parameter";case 237:case 242:case 239:case 246:case 240:return"alias";case 283:return"type";case 194:var r=h.getSpecialPropertyAssignmentKind(t),n=t.right;switch(r){case 0:return"";case 1:case 2:var i=e(n);return""===i?"const":i;case 3:return"method";case 4:return"property";case 5:return h.isFunctionExpression(n)?"method":"property";default:return h.assertTypeIsNever(r),""}default:return""}function s(e){return h.isConst(e)?"const":h.isLet(e)?"let":"var"}},h.isThis=function(e){switch(e.kind){case 99:return!0;case 71:return h.identifierIsThisKeyword(e)&&146===e.parent.kind;default:return!1}};var o=/^\/\/\/\s*</;function l(e,t,r){return e<=r.pos&&t>=r.end}function c(e,t,r,n){return Math.max(e,r)<Math.min(t,n)}function u(e,t){if(h.nodeIsMissing(e))return!1;switch(e.kind){case 229:case 230:case 232:case 178:case 174:case 163:case 207:case 234:case 235:case 241:case 245:return d(e,18,t);case 260:return u(e.block,t);case 182:if(!e.arguments)return!0;case 181:case 185:case 168:return d(e,20,t);case 160:case 161:return u(e.type,t);case 152:case 153:case 154:case 228:case 186:case 151:case 150:case 156:case 155:case 187:return e.body?u(e.body,t):e.type?u(e.type,t):p(e,20,t);case 233:return e.body&&u(e.body,t);case 211:return e.elseStatement?u(e.elseStatement,t):u(e.thenStatement,t);case 210:return u(e.expression,t)||p(e,25);case 177:case 175:case 180:case 144:case 165:return d(e,22,t);case 157:return e.type?u(e.type,t):p(e,22,t);case 257:case 258:return!1;case 214:case 215:case 216:case 213:return u(e.statement,t);case 212:return m(e,106,t)?d(e,20,t):u(e.statement,t);case 162:return u(e.exprName,t);case 189:case 188:case 190:case 197:case 198:return u(e.expression,t);case 183:return u(e.template,t);case 196:return u(h.lastOrUndefined(e.templateSpans),t);case 205:return h.nodeIsPresent(e.literal);case 244:case 238:return h.nodeIsPresent(e.moduleSpecifier);case 192:return u(e.operand,t);case 194:return u(e.right,t);case 195:return u(e.whenFalse,t);default:return!0}}function d(e,t,r){e=e.getChildren(r);if(e.length){r=h.lastOrUndefined(e);if(r.kind===t)return!0;if(25===r.kind&&1!==e.length)return e[e.length-2].kind===t}return!1}function p(e,t,r){return!!m(e,t,r)}function m(e,t,r){return h.forEach(e.getChildren(r),function(e){return e.kind===t&&e})}function g(t){var e=h.forEach(t.parent.getChildren(),function(e){if(h.isSyntaxList(e)&&e.pos<=t.pos&&e.end>=t.end)return e});return h.Debug.assert(!e||h.contains(e.getChildren(),t)),e}function f(e,t,r,n){return y(e,t,!1,n,!1,r)}function _(e,t,r,n){return y(e,t,!0,void 0,n,r)}function y(e,t,r,n,i,s){var a=e;e:for(;;){if(!h.isToken(a))for(var o=0,l=a.getChildren();o<l.length;o++){var c=l[o];if(s||!h.isJSDocNode(c)){if(t<(r?c.getFullStart():c.getStart(e,s)))break;var u=c.getEnd();if(t<u||t===u&&(1===c.kind||i)){a=c;continue e}if(n&&u===t){u=b(t,e,c);if(u&&n(u))return u}}}return a}}function b(o,l,c,u){var e=function e(t){if(h.isToken(t))return t;var r=t.getChildren();for(var n=0;n<r.length;n++){var i,s=r[n];if(o<s.end)return i=s.getStart(l,u),o<=i||!k(s)||v(s)?(a=p(r,n))&&d(a):e(s)}h.Debug.assert(void 0!==c||265===t.kind||h.isJSDocCommentContainingNode(t));{var a;if(r.length)return(a=p(r,r.length))&&d(a)}}(c||l);return h.Debug.assert(!(e&&v(e))),e;function d(e){return h.isToken(e)?e:(e=p(e=e.getChildren(),e.length))&&d(e)}function p(e,t){for(var r=t-1;0<=r;r--)if(v(e[r]))h.Debug.assert(0<r,"`JsxText` tokens should not be the first child of `JsxElement | JsxSelfClosingElement`");else if(k(e[r]))return e[r]}}function v(e){return h.isJsxText(e)&&e.containsOnlyWhiteSpaces}function T(e,t,r,n){return!!h.formatting.getRangeOfEnclosingComment(e,t,!1,void 0,r,n)}function k(e){return 0!==e.getWidth()}function x(e){return 71===e||h.isKeyword(e)}h.getLineStartPositionForPosition=function(e,t){return h.getLineStarts(t)[t.getLineAndCharacterOfPosition(e).line]},h.rangeContainsRange=function(e,t){return l(e.pos,e.end,t)},h.startEndContainsRange=l,h.rangeContainsStartEnd=function(e,t,r){return e.pos<=t&&e.end>=r},h.rangeOverlapsWithStartEnd=function(e,t,r){return c(e.pos,e.end,t,r)},h.startEndOverlapsWithStartEnd=c,h.positionBelongsToNode=function(e,t,r){return t<e.end||!u(e,r)},h.isCompletedNode=u,h.findListItemInfo=function(e){var t,r=g(e);if(r)return t=r.getChildren(),{listItemIndex:h.indexOfNode(t,e),list:r}},h.hasChildOfKind=p,h.findChildOfKind=m,h.findContainingList=g,h.getTouchingWord=function(e,t,r){return f(e,t,r,function(e){return x(e.kind)})},h.getTouchingPropertyName=function(e,t,r){return f(e,t,r,function(e){return 9===(e=e.kind)||8===e||x(e)})},h.getTouchingToken=f,h.getTokenAtPosition=_,h.findTokenOnLeftOfPosition=function(e,t){var r=_(e,t,!1);return h.isToken(r)&&t>r.getStart(e)&&t<r.getEnd()?r:b(t,e)},h.findNextToken=function(a,e){return function e(t){if(h.isToken(t)&&t.pos===a.end)return t;t=t.getChildren();for(var r=0,n=t;r<n.length;r++){var i=n[r],s=i.pos<=a.pos&&i.end>a.end||i.pos===a.end;if(s&&k(i))return e(i)}return}(e)},h.findPrecedingToken=b,h.isInString=function(e,t){if((e=b(t,e))&&h.isStringTextContainingNode(e)){var r=e.getStart(),n=e.getEnd();if(r<t&&t<n)return!0;if(t===n)return!!e.isUnterminated}return!1},h.isInsideJsxElementOrAttribute=function(e,t){return!!(e=_(e,t,!1))&&(10===e.kind||27===e.kind&&10===e.parent.kind||27===e.kind&&256===e.parent.kind||!(!e||18!==e.kind||256!==e.parent.kind)||27===e.kind&&252===e.parent.kind)},h.isWhiteSpaceOnlyJsxText=v,h.isInTemplateString=function(e,t){var r=_(e,t,!1);return h.isTemplateLiteralKind(r.kind)&&t>r.getStart(e)},h.isInComment=T,h.hasDocComment=function(r,e){return e=_(r,e,!1),e=h.getLeadingCommentRanges(r.text,e.pos),h.forEach(e,function(e){var t=r.text;return t.length>=e.pos+3&&"/"===t[e.pos]&&"*"===t[e.pos+1]&&"*"===t[e.pos+2]})},h.getNodeModifiers=function(e){var t=h.getCombinedModifierFlags(e),r=[];return 8&t&&r.push("private"),16&t&&r.push("protected"),4&t&&r.push("public"),32&t&&r.push("static"),128&t&&r.push("abstract"),1&t&&r.push("export"),h.isInAmbientContext(e)&&r.push("declare"),0<r.length?r.join(","):""},h.getTypeArgumentOrTypeParameterList=function(e){return 159===e.kind||181===e.kind?e.typeArguments:h.isFunctionLike(e)||229===e.kind||230===e.kind?e.typeParameters:void 0},h.isWord=x,h.isComment=function(e){return 2===e||3===e},h.isStringOrRegularExpressionOrTemplateLiteral=function(e){return!(9!==e&&12!==e&&!h.isTemplateLiteralKind(e))},h.isPunctuation=function(e){return 17<=e&&e<=70},h.isInsideTemplateLiteral=function(e,t){return h.isTemplateLiteralKind(e.kind)&&e.getStart()<t&&t<e.getEnd()||!!e.isUnterminated&&t===e.getEnd()},h.isAccessibilityModifier=function(e){switch(e){case 114:case 112:case 113:return!0}return!1},h.cloneCompilerOptions=function(e){var t=h.clone(e);return h.setConfigFileInOptions(t,e&&e.configFile),t},h.isArrayLiteralOrObjectLiteralDestructuringPattern=function e(t){if(177===t.kind||178===t.kind){if(194===t.parent.kind&&t.parent.left===t&&58===t.parent.operatorToken.kind)return!0;if(216===t.parent.kind&&t.parent.initializer===t)return!0;if(e((261===t.parent.kind?t.parent:t).parent))return!0}return!1},h.hasTrailingDirectorySeparator=function(e){return"/"===(e=e.charAt(e.length-1))||"\\"===e},h.isInReferenceComment=function(t,e){return T(t,e,void 0,function(e){e=t.text.substring(e.pos,e.end);return o.test(e)})},h.isInNonReferenceComment=function(t,e){return T(t,e,void 0,function(e){e=t.text.substring(e.pos,e.end);return!o.test(e)})},h.createTextSpanFromNode=function(e,t){return h.createTextSpanFromBounds(e.getStart(t),e.getEnd())},h.createTextSpanFromRange=function(e){return h.createTextSpanFromBounds(e.pos,e.end)},h.isTypeKeyword=function(e){switch(e){case 119:case 122:case 130:case 133:case 134:case 136:case 137:case 105:return!0;default:return!1}},h.isExternalModuleSymbol=function(e){return h.Debug.assert(!!(1536&e.flags)),34===e.name.charCodeAt(0)},h.nodeSeenTracker=function(){var t=[];return function(e){e=h.getNodeId(e);return!t[e]&&(t[e]=!0)}}})(ts=ts||{}),(o=>{function r(e){return e.declarations&&0<e.declarations.length&&146===e.declarations[0].kind}o.isFirstDeclarationOfSymbolParameter=r,e();var n,t,i,s={displayParts:function(){return n},writeKeyword:function(e){return l(e,o.SymbolDisplayPartKind.keyword)},writeOperator:function(e){return l(e,o.SymbolDisplayPartKind.operator)},writePunctuation:function(e){return l(e,o.SymbolDisplayPartKind.punctuation)},writeSpace:function(e){return l(e,o.SymbolDisplayPartKind.space)},writeStringLiteral:function(e){return l(e,o.SymbolDisplayPartKind.stringLiteral)},writeParameter:function(e){return l(e,o.SymbolDisplayPartKind.parameterName)},writeProperty:function(e){return l(e,o.SymbolDisplayPartKind.propertyName)},writeSymbol:function(e,t){a(),n.push(c(e,t))},writeLine:function(){n.push(h()),t=!0},increaseIndent:function(){i++},decreaseIndent:function(){i--},clear:e,trackSymbol:o.noop,reportInaccessibleThisError:o.noop,reportPrivateInBaseOfClassExpression:o.noop};function a(){var e;t&&((e=o.getIndentString(i))&&n.push(u(e,o.SymbolDisplayPartKind.space)),t=!1)}function l(e,t){a(),n.push(u(e,t))}function e(){n=[],t=!0,i=0}function c(e,t){return u(e,(e=>{var t=e.flags;return 3&t?r(e)?o.SymbolDisplayPartKind.parameterName:o.SymbolDisplayPartKind.localName:4&t||32768&t||65536&t?o.SymbolDisplayPartKind.propertyName:8&t?o.SymbolDisplayPartKind.enumMemberName:16&t?o.SymbolDisplayPartKind.functionName:32&t?o.SymbolDisplayPartKind.className:64&t?o.SymbolDisplayPartKind.interfaceName:384&t?o.SymbolDisplayPartKind.enumName:1536&t?o.SymbolDisplayPartKind.moduleName:8192&t?o.SymbolDisplayPartKind.methodName:262144&t?o.SymbolDisplayPartKind.typeParameterName:524288&t||2097152&t?o.SymbolDisplayPartKind.aliasName:o.SymbolDisplayPartKind.text})(t))}function u(e,t){return{text:e,kind:o.SymbolDisplayPartKind[t]}}function d(e){return u(o.tokenToString(e),o.SymbolDisplayPartKind.keyword)}function p(e){return u(e,o.SymbolDisplayPartKind.text)}function h(){return u("\n",o.SymbolDisplayPartKind.lineBreak)}function m(e){try{return e(s),s.displayParts()}finally{s.clear()}}function g(e){return e.parent&&(242===e.parent.kind||246===e.parent.kind)&&e.parent.propertyName===e}function f(e,t){return o.ensureScriptKind(e,t&&t.getScriptKind&&t.getScriptKind(e))}o.symbolPart=c,o.displayPart=u,o.spacePart=function(){return u(" ",o.SymbolDisplayPartKind.space)},o.keywordPart=d,o.punctuationPart=function(e){return u(o.tokenToString(e),o.SymbolDisplayPartKind.punctuation)},o.operatorPart=function(e){return u(o.tokenToString(e),o.SymbolDisplayPartKind.operator)},o.textOrKeywordPart=function(e){var t=o.stringToToken(e);return void 0===t?p(e):d(t)},o.textPart=p,o.getNewLineOrDefaultFromHost=function(e){return e.getNewLine?e.getNewLine():"\r\n"},o.lineBreakPart=h,o.mapToDisplayParts=m,o.typeToDisplayParts=function(t,r,n,i){return m(function(e){t.getSymbolDisplayBuilder().buildTypeDisplay(r,e,n,i)})},o.symbolToDisplayParts=function(t,r,n,i,s){return m(function(e){t.getSymbolDisplayBuilder().buildSymbolDisplay(r,e,n,i,s)})},o.signatureToDisplayParts=function(t,r,n,i){return i|=65536,m(function(e){t.getSymbolDisplayBuilder().buildSignatureDisplay(r,e,n,i)})},o.getDeclaredName=function(e,t,r){return g(r)||o.isStringOrNumericLiteral(r)&&144===r.parent.kind?o.getTextOfIdentifierOrLiteral(r):(r=o.getLocalSymbolForExportDefault(t),e.symbolToString(r||t))},o.isImportOrExportSpecifierName=g,o.stripQuotes=function(e){var t=e.length;return 2<=t&&e.charCodeAt(0)===e.charCodeAt(t-1)&&o.isSingleOrDoubleQuote(e.charCodeAt(0))?e.substring(1,t-1):e},o.scriptKindIs=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var i=f(e,t);return o.forEach(r,function(e){return e===i})},o.getScriptKind=f,o.getUniqueSymbolId=function(e,t){return o.getSymbolId(o.skipAlias(e,t))},o.getFirstNonSpaceCharacterPosition=function(e,t){for(;o.isWhiteSpaceLike(e.charCodeAt(t));)t+=1;return t},o.getOpenBrace=function(e,t){return e.body.getFirstToken(t)},o.getOpenBraceOfClassLike=function(e,t){return o.getTokenAtPosition(t,e.members.pos-1,!1)},o.getSourceFileImportLocation=function(e){var t=e.text,r=o.getLeadingCommentRanges(t,0);if(!r)return 0;var n=0;r.length&&3===r[0].kind&&o.isPinnedComment(t,r[0])&&(n=r[0].end+1,r=r.slice(1));for(var i=0,s=r;i<s.length;i++){var a=s[i];if(2!==a.kind||!o.isRecognizedTripleSlashComment(e.text,a.pos,a.end))break;n=a.end+1}return n},o.getSynthesizedDeepClone=function e(t){var r,n;if(void 0!==t)return(r=o.visitEachChild(t,e,o.nullTransformationContext))===t?(n=o.getSynthesizedClone(t),o.isStringLiteral(n)?n.textSourceNode=t:o.isNumericLiteral(n)&&(n.numericLiteralFlags=t.numericLiteralFlags),n.pos=t.pos,n.end=t.end,n):(r.parent=void 0,r)},o.suppressLeadingAndTrailingTrivia=function(e){o.Debug.assert(void 0!==e),function e(t){o.addEmitFlags(t,512);t=o.forEachChild(t,function(e){return e});t&&e(t)}(e),function e(t){o.addEmitFlags(t,1024);var r=void 0;o.forEachChild(t,function(e){r=e},function(e){e.length&&(r=o.last(e))});r&&e(r)}(e)}})(ts=ts||{}),(T=>{function u(e,t){switch(t){case 233:case 229:case 230:case 228:e.throwIfCancellationRequested()}}function s(n,i,e,s,a){var o=[];return function e(t){{var r;t&&T.textSpanIntersectsWith(a,t.getFullStart(),t.getFullWidth())&&(r=t.kind,u(i,r),71!==r||T.nodeIsMissing(t)||(r=t,s.has(r.escapedText)&&(r=n.getSymbolAtLocation(t))&&(r=c(r,T.getMeaningFromLocation(t)))&&l(t.getStart(),t.getWidth(),r)),T.forEachChild(t,e))}}(e),{spans:o,endOfLineState:0};function l(e,t,r){o.push(e),o.push(t),o.push(r)}function c(e,t){var r=e.getFlags();if(0!=(788448&r)){if(32&r)return 11;if(384&r)return 12;if(524288&r)return 16;if(2&t){if(64&r)return 13;if(262144&r)return 15}else if(1536&r&&(4&t||1&t&&T.forEach(e.declarations,function(e){return 233===e.kind&&1===T.getModuleInstanceState(e)})))return 14}}}function a(e){T.Debug.assert(e.spans.length%3==0);for(var t=e.spans,r=[],n=0;n<t.length;n+=3)r.push({textSpan:T.createTextSpan(t[n],t[n+1]),classificationType:(e=>{switch(e){case 1:return"comment";case 2:return"identifier";case 3:return"keyword";case 4:return"number";case 5:return"operator";case 6:return"string";case 8:return"whitespace";case 9:return"text";case 10:return"punctuation";case 11:return"class name";case 12:return"enum name";case 13:return"interface name";case 14:return"module name";case 15:return"type parameter name";case 16:return"type alias name";case 17:return"parameter name";case 18:return"doc comment tag name";case 19:return"jsx open tag name";case 20:return"jsx close tag name";case 21:return"jsx self closing tag name";case 22:return"jsx attribute";case 23:return"jsx text";case 24:return"jsx attribute string literal value"}})(t[n+2])});return r}function n(i,p,e){var s=e.start,a=e.length,h=T.createScanner(5,!1,p.languageVariant,p.text),m=T.createScanner(5,!1,p.languageVariant,p.text),n=[];return y(p),{spans:n,endOfLineState:0};function g(e,t,r){n.push(e),n.push(t),n.push(r)}function o(e){for(h.setTextPos(e.pos);;){var t=h.getTextPos();if(!T.couldStartTrivia(p.text,t))return t;var r=h.scan(),n=h.getTextPos(),i=n-t;if(!T.isTrivia(r))return t;if(4!==r&&5!==r)if(T.isComment(r))((e,t,r,n)=>{if(3===t){t=T.parseIsolatedJSDocComment(p.text,r,n);if(t&&t.jsDoc)return t.jsDoc.parent=e,(e=>{var t=e.pos;if(e.tags)for(var r=0,n=e.tags;r<n.length;r++){var i=n[r];switch(i.pos!==t&&f(t,i.pos-t),g(i.atToken.pos,i.atToken.end-i.atToken.pos,10),g(i.tagName.pos,i.tagName.end-i.tagName.pos,18),t=i.tagName.end,i.kind){case 279:(e=>{e.isNameFirst&&(f(t,e.name.pos-t),g(e.name.pos,e.name.end-e.name.pos,17),t=e.name.end),e.typeExpression&&(f(t,e.typeExpression.pos-t),y(e.typeExpression),t=e.typeExpression.end),e.isNameFirst||(f(t,e.name.pos-t),g(e.name.pos,e.name.end-e.name.pos,17),t=e.name.end)})(i);break;case 282:(e=>{for(var t=0,r=e.getChildren();t<r.length;t++)y(r[t])})(i);break;case 281:case 280:y(i.typeExpression)}t=i.end}t!==e.end&&f(t,e.end-t)})(t.jsDoc)}f(r,n)})(e,r,t,i),h.setTextPos(n);else if(7===r){var r=p.text,s=r.charCodeAt(t);if(60===s||62===s)g(t,i,1);else{T.Debug.assert(124===s||61===s),d=u=c=a=l=i=o=void 0;var a,o=r,i=t,l=n;for(a=i;a<l&&!T.isLineBreak(o.charCodeAt(a));a++);for(g(i,a-i,1),m.setTextPos(a);m.getTextPos()<l;){c=void 0;u=void 0;d=void 0;var c=m.getTextPos(),u=m.scan(),d=m.getTextPos();(u=_(u))&&g(c,d-c,u)}}}}}function f(e,t){g(e,t,1)}function l(e){var t,r,n;return T.isJSDoc(e)||T.nodeIsMissing(e)||(n=(e=>{switch(e.parent&&e.parent.kind){case 251:if(e.parent.tagName===e)return 19;break;case 252:if(e.parent.tagName===e)return 20;break;case 250:if(e.parent.tagName===e)return 21;break;case 253:if(e.parent.name===e)return 22}})(e),T.isToken(e)||10===e.kind||void 0!==n?(t=10===e.kind?e.pos:o(e),T.Debug.assert(0<=(r=e.end-t)),0<r&&(n=n||_(e.kind,e))&&g(t,r,n),1):void 0)}function _(e,t){if(T.isKeyword(e))return 3;if((27===e||29===e)&&t&&T.getTypeArgumentOrTypeParameterList(t.parent))return 10;if(T.isPunctuation(e)){if(t){if(58===e&&(226===t.parent.kind||149===t.parent.kind||146===t.parent.kind||253===t.parent.kind))return 5;if(194===t.parent.kind||192===t.parent.kind||193===t.parent.kind||195===t.parent.kind)return 5}return 10}if(8===e)return 4;if(9===e)return 253===t.parent.kind?24:6;if(12===e)return 6;if(T.isTemplateLiteralKind(e))return 6;if(10===e)return 23;if(71===e){if(t)switch(t.parent.kind){case 229:return t.parent.name===t?11:void 0;case 145:return t.parent.name===t?15:void 0;case 230:return t.parent.name===t?13:void 0;case 232:return t.parent.name===t?12:void 0;case 233:return t.parent.name===t?14:void 0;case 146:return t.parent.name===t?T.isThisIdentifier(t)?3:17:void 0}return 2}}function y(e){if(e&&T.decodedTextSpanIntersectsWith(s,a,e.pos,e.getFullWidth())){u(i,e.kind);for(var t=0,r=e.getChildren(p);t<r.length;t++){var n=r[t];l(n)||y(n)}}}}T.createClassifier=function(){var _=T.createScanner(5,!1),y=[],b=(y[71]=!0,y[9]=!0,y[8]=!0,y[12]=!0,y[99]=!0,y[43]=!0,y[44]=!0,y[20]=!0,y[22]=!0,y[18]=!0,y[101]=!0,y[86]=!0,[]);function n(e,t){for(var r=[],n=e.spans,i=0,s=0;s<n.length;s+=3){var a,o=n[s],l=n[s+1],c=n[s+2];0<=i&&0<(a=o-i)&&r.push({length:a,classification:T.TokenClass.Whitespace}),r.push({length:l,classification:(e=>{switch(e){case 1:return T.TokenClass.Comment;case 3:return T.TokenClass.Keyword;case 4:return T.TokenClass.NumberLiteral;case 5:return T.TokenClass.Operator;case 6:return T.TokenClass.StringLiteral;case 8:return T.TokenClass.Whitespace;case 10:return T.TokenClass.Punctuation;default:return T.TokenClass.Identifier}})(c)}),i=o+l}t=t.length-i;return 0<t&&r.push({length:t,classification:T.TokenClass.Whitespace}),{entries:r,finalLexState:e.endOfLineState}}function i(e,t,r){for(var n=0,i=0,s=0;0<b.length;)b.pop();switch(t){case 3:e='"\\\n'+e,n=3;break;case 2:e="'\\\n"+e,n=3;break;case 1:e="/*\n"+e,n=3;break;case 4:e="`\n"+e,n=2;break;case 5:e="}\n"+e,n=2;case 6:b.push(14)}_.setText(e);var a={endOfLineState:0,spans:[]},o=0;do{var l,i=_.scan(),c=(T.isTrivia(i)||(41!==i&&63!==i||y[s]?23===s&&v(i)||v(s)&&v(i)&&(l=s,c=i,T.isAccessibilityModifier(l))&&125!==c&&135!==c&&123!==c&&115!==c?i=71:71===s&&27===i?o++:29===i&&0<o?o--:119===i||136===i||133===i||122===i||137===i?0<o&&!r&&(i=71):14===i?b.push(i):17===i?0<b.length&&b.push(i):18===i&&0<b.length&&(14===(l=T.lastOrUndefined(b))?16===(i=_.reScanTemplateToken())?b.pop():T.Debug.assertEqual(i,15,"Should have been a template middle."):(T.Debug.assertEqual(l,17,"Should have been an open brace"),b.pop())):12===_.reScanSlashToken()&&(i=12),s=i),h=p=d=f=g=m=u=c=void 0,_.getTokenPos()),u=_.getTextPos(),d=c,p=u,h=(e=>{if(v(e))return 3;if((e=>{switch(e){case 39:case 41:case 42:case 37:case 38:case 45:case 46:case 47:case 27:case 29:case 30:case 31:case 93:case 92:case 118:case 32:case 33:case 34:case 35:case 48:case 50:case 49:case 53:case 54:case 69:case 68:case 70:case 65:case 66:case 67:case 59:case 60:case 61:case 63:case 64:case 58:case 26:return 1;default:return}})(e)||(e=>{switch(e){case 37:case 38:case 52:case 51:case 43:case 44:return 1;default:return}})(e))return 5;if(17<=e&&e<=70)return 10;switch(e){case 8:return 4;case 9:return 6;case 12:return 7;case 7:case 3:case 2:return 1;case 5:case 4:return 8;default:return T.isTemplateLiteralKind(e)?6:2}})(i);if(8!==h&&(0===d&&0<n&&(d+=n),0<(p=(p-=n)-(d-=n)))&&(a.spans.push(d),a.spans.push(p),a.spans.push(h)),u>=e.length)if(9===i){var m=_.getTokenText();if(_.isUnterminated()){for(var g=m.length-1,f=0;92===m.charCodeAt(g-f);)f++;1&f&&(c=m.charCodeAt(0),a.endOfLineState=34===c?3:2)}}else 3===i?_.isUnterminated()&&(a.endOfLineState=1):T.isTemplateLiteralKind(i)?_.isUnterminated()&&(16===i?a.endOfLineState=5:13===i?a.endOfLineState=4:T.Debug.fail("Only 'NoSubstitutionTemplateLiteral's and 'TemplateTail's can be unterminated; got SyntaxKind #"+i)):0<b.length&&14===T.lastOrUndefined(b)&&(a.endOfLineState=6)}while(1!==i);return a}function v(e){return 72<=e&&e<=142}return{getClassificationsForLine:function(e,t,r){return n(i(e,t,r),e)},getEncodedLexicalClassifications:i}},T.getSemanticClassifications=function(e,t,r,n,i){return a(s(e,t,r,n,i))},T.getEncodedSemanticClassifications=s,T.getSyntacticClassifications=function(e,t,r){return a(n(e,t,r))},T.getEncodedSyntacticClassifications=n})(ts=ts||{}),(T=>{var e,d,k;function x(e,t,r,n,i,s,a,o){void 0===o&&(o=[]),e=T.normalizeSlashes(e=void 0===e?"":e),""===(e=T.getDirectoryPath(e))&&(e="."+T.directorySeparator),e=T.ensureTrailingDirectorySeparator(e);var e=w(T.isRootedDiskPath(e)?e:T.combinePaths(t,e)),e=T.getDirectoryPath(e),l=!(s.useCaseSensitiveFileNames&&s.useCaseSensitiveFileNames());if(_(s,e)){r=I(s,e,r,void 0,["./*"]);if(r){for(var c=T.createMap(),u=0,d=r;u<d.length;u++){var p=d[u],p=T.normalizePath(p);a&&0===T.comparePaths(p,a,t,l)||(p=n?T.getBaseFileName(p):T.removeFileExtension(T.getBaseFileName(p)),c.get(p))||c.set(p,!0)}T.forEachKey(c,function(e){o.push(C(e,"script",i))})}r=f(s,e);if(r)for(var h=0,m=r;h<m.length;h++){var g=m[h],g=T.getBaseFileName(T.normalizePath(g));o.push(C(g,"directory",i))}}return o}function E(e,t,r,n,i){if(void 0===i&&(i=[]),t.types)for(var s=0,a=t.types;s<a.length;s++){var o=a[s];i.push(C(o,"external module name",n))}else if(e.getDirectories){var l=void 0;try{l=T.getEffectiveTypeRoots(t,e)}catch(e){}if(l)for(var c=0,u=l;c<u.length;c++)m(e,u[c],n,i)}if(e.getDirectories)for(var d=0,p=S(r,e);d<p.length;d++){var h=p[d];m(e,T.combinePaths(T.getDirectoryPath(h),"node_modules/@types"),n,i)}return i}function m(e,t,r,n){if(e.getDirectories&&_(e,t)){e=f(e,t);if(e)for(var i=0,s=e;i<s.length;i++){var a=s[i],a=T.normalizePath(a);n.push(C(T.getBaseFileName(a),"external module name",r))}}}function S(e,t){for(var r=[];n=T.findConfigFile(e,function(e){return A(t,t.fileExists,e)},"package.json");){r.push(n),e=T.getDirectoryPath(n);var n=T.getDirectoryPath(e);if(e===n)break;e=n}return r}function C(e,t,r){return{name:e,kind:t,kindModifiers:"",sortText:e,replacementSpan:r}}function p(e,t){var r=e.lastIndexOf(T.directorySeparator),r=-1!==r?r+1:0;return{start:t+r,length:e.length-r}}function w(e){return T.hasTrailingDirectorySeparator(e)?T.ensureTrailingDirectorySeparator(T.normalizePath(e)):T.normalizePath(e)}function f(e,t){return A(e,e.getDirectories,t)}function I(e,t,r,n,i){return A(e,e.readDirectory,t,r,n,i)}function _(e,t){try{return T.directoryProbablyExists(t,e)}catch(e){}}function A(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];try{return t&&t.apply(e,r)}catch(e){}}(e=(e=T.Completions||(T.Completions={})).PathCompletions||(e.PathCompletions={})).getStringLiteralCompletionEntriesFromModuleNames=function(e,t,r,n){var i,s=T.normalizeSlashes(e.text),a=e.getSourceFile().path,o=T.getDirectoryPath(a),e=p(e.text,e.getStart()+1);return{isGlobalCompletion:!1,isMemberCompletion:!1,isNewIdentifierLocation:!0,entries:(e=>{var t;if(e&&2<=e.length&&46===e.charCodeAt(0))return t=3<=e.length&&46===e.charCodeAt(1)?2:1,47===(e=e.charCodeAt(t))||92===e})(s)||T.isRootedDiskPath(s)?(i=T.getSupportedExtensions(t),t.rootDirs?((e,t,r,n,i,s,a,o,l)=>{for(var a=a.project||o.getCurrentDirectory(),c=!(o.useCaseSensitiveFileNames&&o.useCaseSensitiveFileNames()),e=((e,t,r,n)=>{e=T.map(e,function(e){return T.normalizePath(T.isRootedDiskPath(e)?e:T.combinePaths(t,e))});var i=T.forEach(e,function(e){return T.containsPath(e,r,t,n)?r.substr(e.length):void 0});return T.deduplicate(T.map(e,function(e){return T.combinePaths(e,i)}))})(e,a,r,c),u=[],d=0,p=e;d<p.length;d++){var h=p[d];x(t,h,n,i,s,o,l,u)}return u})(t.rootDirs,s,o,i,!1,e,t,r,a):x(s,o,i,!1,e,r,a)):((e,t,r,n,i,s)=>{var a,o=n.baseUrl,l=n.paths;if(o){var c=T.getSupportedExtensions(n),u=n.project||i.getCurrentDirectory(),u=T.isRootedDiskPath(o)?o:T.combinePaths(u,o);if(a=x(e,T.normalizePath(u),c,!1,r,i),l)for(var d in l)if(l.hasOwnProperty(d))if("*"===d){if(l[d])for(var p=0,h=l[d];p<h.length;p++)for(var m=h[p],g=0,f=((e,t,r,n,i)=>{if(i.readDirectory){r=T.hasZeroOrOneAsteriskCharacter(r)?T.tryParsePattern(r):void 0;if(r){var s=w(r.prefix),a=T.getDirectoryPath(s),s=T.getBaseFileName(s),o=T.stringContains(e,T.directorySeparator),e=o?T.combinePaths(a,s+T.getDirectoryPath(e)):a,l=T.normalizePath(r.suffix),a=T.combinePaths(t,e),c=o?a:T.ensureTrailingDirectorySeparator(a)+s,r=I(i,a,n,void 0,[l?"**/*":"./*"]);if(r){for(var u=[],d=0,p=r;d<p.length;d++){var h,m,g=p[d],g=T.normalizePath(g);T.endsWith(g,l)&&T.startsWith(g,c)&&(h=c.length,m=g.length-h-l.length,u.push(T.removeFileExtension(g.substr(h,m))))}return u}}}})(e,o,m,c,i);g<f.length;g++){var _=f[g];a.push(C(_,"external module name",r))}}else T.startsWith(d,e)&&l[d]&&1===l[d].length&&l[d][0]&&a.push(C(d,"external module name",r))}else a=[];E(i,n,t,r,a);for(var y=0,b=((t,e,r,n,i)=>{var s,a=T.stringContains(t,T.directorySeparator),o=a?t.substr(0,t.lastIndexOf(T.directorySeparator)):void 0,n=T.map(n.getAmbientModules(),function(e){return T.stripQuotes(e.name)}),l=T.filter(n,function(e){return T.startsWith(e,t)});if(a&&(s=T.ensureTrailingDirectorySeparator(o),l=T.map(l,function(e){return T.removePrefix(e,s)})),!r.moduleResolution||r.moduleResolution===T.ModuleResolutionKind.NodeJs)for(var c=0,u=((r,e)=>{var t=[];if(r.readFile&&r.fileExists)for(var n=0,i=S(e,r);n<i.length;n++){var s=i[n],a=(e=>{try{var t=((e,t)=>A(e,e.readFile,t))(r,e);return t?JSON.parse(t):void 0}catch(e){}})(s);if(!a)return;for(var o=T.combinePaths(T.getDirectoryPath(s),"node_modules"),l=[],c=0,u=k;c<u.length;c++){var d=u[c];((e,t)=>{if(e)for(var r in e)e.hasOwnProperty(r)&&!T.startsWith(r,"@types/")&&t.push(r)})(a[d],l)}for(var p=0,h=l;p<h.length;p++){var m=h[p],g=T.combinePaths(o,m);t.push({moduleName:m,moduleDir:g})}}return t})(i,e);c<u.length;c++){var d=u[c];if(a){if(T.startsWith(d.moduleName,o)){var p=I(i,d.moduleDir,T.supportedTypeScriptExtensions,void 0,["./*"]);if(p)for(var h=0,m=p;h<m.length;h++){var g=m[h],g=(g=T.normalizePath(g),T.removeFileExtension(T.getBaseFileName(g)));l.push(g)}}}else l.push(d.moduleName)}return T.deduplicate(l)})(e,t,n,s,i);y<b.length;y++){var v=b[y];a.push(C(v,"external module name",r))}return a})(s,o,e,t,r,n)}},e.getTripleSlashReferenceCompletion=function(e,t,r,n){if(u=T.getTokenAtPosition(e,t,!1)){u=T.getLeadingCommentRanges(e.text,u.pos);if(u&&u.length){var i,s,a,o,l,c,u=T.forEach(u,function(e){return t>=e.pos&&t<=e.end&&e});if(u)return i={isGlobalCompletion:!1,isMemberCompletion:!1,isNewIdentifierLocation:!0,entries:[]},s=e.text.substr(u.pos,t-u.pos),(s=d.exec(s))&&(a=s[1],l=s[2],c=s[3],o=T.getDirectoryPath(e.path),"path"===l?(l=p(c,u.pos+a.length),i.entries=x(c,o,T.getSupportedExtensions(r),!0,l,n,e.path)):(c={start:u.pos+a.length,length:s[0].length-a.length},i.entries=E(n,r,o,c))),i}}},d=/^(\/\/\/\s*<reference\s+(path|types)\s*=\s*(?:'|"))([^\3"]*)$/,k=["dependencies","devDependencies","peerDependencies","optionalDependencies"]})(ts=ts||{}),(O=>{var N,n;function _(e){return e&&O.stripQuotes(e.moduleSymbol.name)}function R(e,t,r,n,i,s,a,o,l){var c=O.timestamp(),u=O.createMap();if(e)for(var d=0,p=e;d<p.length;d++){var h,m=p[d],g=l?l[O.getSymbolId(m)]:void 0,f=((e,t,r,n,i,s,a)=>{if(i=y(e,i,r,s))return{name:i,kind:O.SymbolDisplay.getSymbolKind(n,e,t),kindModifiers:O.SymbolDisplay.getSymbolModifiers(e),sortText:"0",source:_(a),hasAction:void 0!==a||void 0}})(m,r,n,i,s,o,g);f&&(h=f.name,u.has(h)||(g||void 0===m.parent&&!O.some(m.declarations,function(e){return e.getSourceFile()===r.getSourceFile()})||u.set(h,!0),t.push(f)))}return a("getCompletionsAtPosition: getCompletionEntriesFromSymbols: "+(O.timestamp()-c)),u}function L(e,t){if(e){var r=[];if(P(e,r,t),r.length)return{isGlobalCompletion:!1,isMemberCompletion:!1,isNewIdentifierLocation:!1,entries:r}}}function P(e,t,r,n){if(void 0===n&&(n=O.createMap()),e=e&&16384&e.flags?r.getBaseConstraintOfType(e):e)if(65536&e.flags)for(var i=0,s=e.types;i<s.length;i++)P(s[i],t,r,n);else 32&e.flags&&!(256&e.flags)&&(e=e.value,n.has(e)||(n.set(e,!0),t.push({name:e,kindModifiers:"",kind:"var",sortText:"0"})))}function d(e,t,r,n,i,s,a){var o,l,c=s.name,u=s.source,s=M(e,t,n,i,a);if(s)return e=s.symbols,t=s.location,o=s.allowStringLiteral,l=s.symbolToOriginInfoMap,(n=O.find(e,function(e){return y(e,r.target,!1,o)===c&&_(l[O.getSymbolId(e)])===u}))&&{symbol:n,location:t,symbolToOriginInfoMap:l}}function M(u,e,d,p,h){var t,a=O.isSourceFileJavaScript(d),r=O.timestamp(),n=O.getTokenAtPosition(d,p,!1),i=(e("getCompletionData: Get current token: "+(O.timestamp()-r)),r=O.timestamp(),O.isInComment(d,p,n)),m=(e("getCompletionData: Is inside comment: "+(O.timestamp()-r)),!1);if(i){O.hasDocComment(d,p)&&(64===d.text.charCodeAt(p-1)?t={kind:"JsDocTagName"}:(i=O.getLineStartPositionForPosition(p,d),d.text.substring(i,p).match(/[^\*|\s|(/\*\*)]/)||(t={kind:"JsDocTag"})));i=((e,t)=>{if(e=(e=>{if(!O.isToken(e))return e;switch(e.kind){case 104:case 110:case 76:return e.parent.parent;default:return e.parent}})(e).jsDoc)for(var r=0,n=e;r<n.length;r++){var i=n[r],s=i.pos,a=i.end,o=i.tags;if(!(!o||t<s||a<t))for(var l=o.length-1;0<=l;l--){var c=o[l];if(t>=c.pos)return c}}})(n,p);if(t=i&&(i.tagName.pos<=p&&p<=i.tagName.end&&(t={kind:"JsDocTagName"}),(e=>{switch(e.kind){case 279:case 284:case 280:case 281:case 283:return 1}})(i)&&i.typeExpression&&267===i.typeExpression.kind&&((n=O.getTokenAtPosition(d,p,!0))&&(O.isDeclarationName(n)||284===n.parent.kind&&n.parent.name===n)||(m=N(i.typeExpression))),O.isJSDocParameterTag(i))&&(O.nodeIsMissing(i.name)||i.name.pos<=p&&p<=i.name.end)?{kind:"JsDocParameterName",tag:i}:t)return{symbols:void 0,isGlobalCompletion:!1,isMemberCompletion:!1,allowStringLiteral:!1,isNewIdentifierLocation:!1,location:void 0,isRightOfDot:!1,request:t,keywordFilters:0,symbolToOriginInfoMap:void 0};if(!m)return void e("Returning an empty list because completion was inside a regular comment or plain text part of a JsDoc comment.")}var r=O.timestamp(),g=O.findPrecedingToken(p,d,void 0,m),f=(e("getCompletionData: Get previous token 1: "+(O.timestamp()-r)),g),_=(f&&p<=f.end&&O.isWord(f.kind)&&(i=O.timestamp(),f=O.findPrecedingToken(f.getFullStart(),d,void 0,m),e("getCompletionData: Get previous token 2: "+(O.timestamp()-i))),n),r=!1,s=!1,o=!1,y=O.getTouchingPropertyName(d,p,m);if(f){if(i=f,n=O.timestamp(),i=(e=>{if(9===e.kind||12===e.kind||O.isTemplateLiteralKind(e.kind)){var t=e.getStart(),r=e.getEnd();if(t<p&&p<r)return!0;if(p===r)return!!e.isUnterminated||12===e.kind}return!1})(i)||(e=>{var t=e.parent.kind;switch(e.kind){case 26:return 226===t||227===t||208===t||232===t||D(t)||230===t||175===t||231===t||O.isClassLike(e.parent)&&e.parent.typeParameters&&e.parent.typeParameters.end>=e.pos;case 23:return 175===t;case 56:return 176===t;case 21:return 175===t;case 19:return 260===t||D(t);case 17:return 232===t||230===t||163===t;case 25:return 148===t&&e.parent&&e.parent.parent&&(230===e.parent.parent.kind||163===e.parent.parent.kind);case 27:return 229===t||199===t||230===t||231===t||O.isFunctionLikeKind(t);case 115:return 149===t&&!O.isClassLike(e.parent.parent);case 24:return 146===t||e.parent&&e.parent.parent&&175===e.parent.parent.kind;case 114:case 112:case 113:return 146===t&&!O.isConstructorDeclaration(e.parent.parent);case 118:return 242===t||246===t||240===t;case 125:case 135:if(I(e))return!1;case 75:case 83:case 109:case 89:case 104:case 91:case 110:case 76:case 116:case 138:return!0}if(U(e.getText())&&I(e))return!1;if(A(e)&&(!O.isIdentifier(e)||H(e.getText())||N(e)))return!1;switch(e.getText()){case"abstract":case"async":case"class":case"const":case"declare":case"enum":case"function":case"interface":case"let":case"private":case"protected":case"public":case"static":case"var":case"yield":return!0}return O.isDeclarationName(e)&&!O.isJsxAttribute(e.parent)})(i)||(e=>8===e.kind&&"."===(e=e.getFullText()).charAt(e.length-1))(i)||(e=>{if(10===e.kind)return!0;if(29===e.kind&&e.parent){if(251===e.parent.kind)return!0;if(252===e.parent.kind||250===e.parent.kind)return e.parent.parent&&249===e.parent.parent.kind}return!1})(i),e("getCompletionsAtPosition: isCompletionListBlocker: "+(O.timestamp()-n)),i)return void e("Returning an empty list because completion was requested in an invalid position.");var l=f.parent;if(23===f.kind){if(179===l.kind)_=f.parent.expression;else{if(143!==l.kind)return;_=f.parent.left}r=!0}else if(1===d.languageVariant)switch((l=l&&179===l.kind?(f=l).parent:l).kind){case 252:41===f.kind&&(o=!0,y=f);break;case 194:if(!(32768&l.left.flags))break;case 250:case 249:case 251:27===f.kind&&(s=!0,y=f)}}var n=O.timestamp(),b=!1,v=!1,T=0,k=[],x=[];if(r)(()=>{S=b=!(E=!0);var e=m||O.isPartOfTypeNode(_.parent),t=O.isInRightSideOfInternalImportEqualsDeclaration(_);if(O.isEntityName(_)){var r=u.getSymbolAtLocation(_);if(r&&1920&(r=O.skipAlias(r,u)).flags){for(var n=u.getExportsOfModule(r),i=function(e){return u.isValidPropertyAccess(_.parent,e.name)},s=w,a=t?function(e){return s(e)||i(e)}:e?s:i,o=0,l=n;o<l.length;o++){var c=l[o];a(c)&&k.push(c)}return!e&&r.declarations.some(function(e){return 265!==e.kind&&233!==e.kind&&232!==e.kind})&&C(u.getTypeOfSymbolAtLocation(r,_))}}e||C(u.getTypeAtLocation(_))})();else if(s)var i=u.getJsxIntrinsicTagNames(),k=c()?i.concat(k.filter(function(e){return!!(2204607&e.flags)})):i,E=!0,S=!1;else if(o){i=f.parent.parent.openingElement.tagName,i=u.getSymbolAtLocation(i);u.isUnknownSymbol(i)||(k=[i]),S=!(E=!0)}else if(!c())return;return e("getCompletionData: Semantic work: "+(O.timestamp()-n)),{symbols:k,isGlobalCompletion:b,isMemberCompletion:E,allowStringLiteral:v,isNewIdentifierLocation:S,location:y,isRightOfDot:r||s,request:t,keywordFilters:T,symbolToOriginInfoMap:x};function C(e){for(var t=0,r=e.getApparentProperties();t<r.length;t++){var n=r[t];u.isValidPropertyAccess(_.parent,n.name)&&k.push(n)}if(a&&65536&e.flags)for(var i=0,s=e.types;i<s.length;i++)C(s[i])}function c(){if(s=(e=>{if(e)switch(e.kind){case 17:case 26:var t=e.parent;if(O.isObjectLiteralExpression(t)||O.isObjectBindingPattern(t))return t}})(f)){if(v=E=!0,178===s.kind){if(S=!0,!(t=u.getContextualType(s)))return;n=((e,t)=>{var r;return 65536&e.flags?(r=e.types.filter(function(e){return!(8190&e.flags||t.isArrayLikeType(e))}),t.getAllPossiblePropertiesOfTypes(r)):t.getPropertiesOfType(e)})(t,u),i=s.properties}else{O.Debug.assert(174===s.kind),S=!1;var e=O.getRootDeclaration(s.parent);if(!O.isVariableLike(e))throw O.Debug.fail("Root declaration is not variable-like.");var t,r=e.initializer||e.type||216===e.parent.parent.kind;if(r||146!==e.kind||(O.isExpression(e.parent)?r=!!u.getContextualType(e.parent):151!==e.parent.kind&&154!==e.parent.kind||(r=O.isExpression(e.parent.parent)&&!!u.getContextualType(e.parent.parent))),r){if(!(t=u.getTypeAtLocation(s)))return;n=u.getPropertiesOfType(t).filter(function(e){return!(24&O.getDeclarationModifierFlagsFromSymbol(e))}),i=s.elements}}n&&0<n.length&&(k=((e,t)=>{if(!t||0===t.length)return e;for(var r=O.createUnderscoreEscapedMap(),n=0,i=t;n<i.length;n++){var s,a=i[n];261!==a.kind&&262!==a.kind&&176!==a.kind&&151!==a.kind&&153!==a.kind&&154!==a.kind||N(a)||(s=void 0,176===a.kind&&a.propertyName?71===a.propertyName.kind&&(s=a.propertyName.escapedText):(a=O.getNameOfDeclaration(a),s=O.getEscapedTextOfIdentifierOrLiteral(a)),r.set(s,!0))}return O.filter(e,function(e){return!r.get(e.escapedName)})})(n,i))}else{if(e=(e=>{if(e)switch(e.kind){case 17:case 26:switch(e.parent.kind){case 241:case 245:return e.parent}}})(f))return t=241===(r=e).kind?238:244,(t=O.getAncestor(r,t).moduleSpecifier)&&(S=!(E=!0),t=u.getSymbolAtLocation(t),k=t?((e,t)=>{for(var r=O.createUnderscoreEscapedMap(),n=0,i=t;n<i.length;n++){var s=i[n];N(s)||(s=s.propertyName||s.name,r.set(s.escapedText,!0))}return 0!==r.size?O.filter(e,function(e){return"default"!==e.escapedName&&!r.get(e.escapedName)}):O.filter(e,function(e){return"default"!==e.escapedName})})(t=u.getExportsAndPropertiesOfModule(t),r.elements):O.emptyArray,1);if((e=>{if(e)switch(e.kind){case 19:case 26:return O.isConstructorDeclaration(e.parent)&&e.parent;default:if(A(e))return e.parent.parent}})(f))return S=!(E=!1),T=2;if(s=(e=>{if(e)switch(e.kind){case 17:case 26:if(O.isClassLike(e.parent))return e.parent;break;case 25:case 18:if(O.isClassLike(y))return y;if(I(y)&&y.parent.name===y)return y.parent.parent;break;default:if(I(e)&&($(e.kind)||U(e.getText())))return e.parent.parent}if(y&&286===y.kind&&O.isClassLike(y.parent))return y.parent})(f)){var n=s,i=(S=E=!0,T=1,O.getClassExtendsHeritageClauseElement(n)),s=O.getClassImplementsHeritageClauseElements(n);if(i||s){var a=f.parent,o=O.isClassElement(a)&&O.getModifierFlags(a);if(71===f.kind&&!N(f))switch(f.getText()){case"private":o|=8;break;case"static":o|=32}8&o||(a=void 0,i&&(a=u.getTypeAtLocation(i),32&o)&&(a=u.getTypeOfSymbolAtLocation(a.symbol,n)),i=32&o?O.emptyArray:O.flatMap(s||O.emptyArray,function(e){return u.getPropertiesOfType(u.getTypeAtLocation(e))}),k=((e,t,r,n)=>{for(var o=O.createUnderscoreEscapedMap(),i=0,s=r;i<s.length;i++){var a,l,c=s[i];149!==c.kind&&151!==c.kind&&153!==c.kind&&154!==c.kind||N(c)||O.hasModifier(c,8)||(l=O.hasModifier(c,32),a=!!(32&n),l&&!a)||!l&&a||(l=O.getPropertyNameForPropertyNameNode(c.name))&&o.set(l,!0)}var u=[];return d(e,8),d(t,24),u;function d(e,t){for(var r,n,i=0,s=e;i<s.length;i++){var a=s[i];r=a,n=t,o.get(r.escapedName)||!r.getDeclarations()||O.getDeclarationModifierFlagsFromSymbol(r)&n||u.push(a)}}})(a?u.getPropertiesOfType(a):O.emptyArray,i,n.members,o))}}else{if(s=(e=>{if(e){var t=e.parent;switch(e.kind){case 28:case 41:case 71:case 179:case 254:case 253:case 255:if(t&&(250===t.kind||251===t.kind))return t;if(253===t.kind)return t.parent.parent;break;case 9:if(!t||253!==t.kind&&255!==t.kind)break;return t.parent.parent;case 18:if(t&&256===t.kind&&t.parent&&253===t.parent.kind)return t.parent.parent.parent;if(t&&255===t.kind)return t.parent.parent}}})(f))if((250===s.kind||251===s.kind)&&(a=u.getAllAttributesTypeFromJsxOpeningLikeElement(s)))return k=((e,t)=>{for(var r=O.createUnderscoreEscapedMap(),n=0,i=t;n<i.length;n++){var s=i[n];N(s)||253===s.kind&&r.set(s.name.escapedText,!0)}return O.filter(e,function(e){return!r.get(e.escapedName)})})(u.getPropertiesOfType(a),s.attributes.properties),S=!(E=!0),1;E=!1,S=(e=>{if(e){var t=e.parent.kind;switch(e.kind){case 26:return 181===t||152===t||182===t||177===t||194===t||160===t;case 19:return 181===t||152===t||182===t||185===t||168===t;case 21:return 177===t||157===t||144===t;case 128:case 129:return!0;case 23:return 233===t;case 17:return 229===t;case 58:return 226===t||194===t;case 14:return 196===t;case 15:return 205===t;case 114:case 112:case 113:return 149===t}switch(e.getText()){case"public":case"protected":case"private":return!0}}return!1})(f),g!==f&&O.Debug.assert(!!g,"Expected 'contextToken' to be defined when different from 'previousToken'.");var l,c,s=g!==f?g.getStart():p,s=((e,t,r)=>{for(var n=e;n&&!O.positionBelongsToNode(n,t,r);)n=n.parent;return n})(f,s,d)||d;s&&(b=265===s.kind||196===s.kind||256===s.kind||O.isStatement(s));k=u.getSymbolsInScope(s,2998271),l=k,s=g&&O.isIdentifier(g)?g.text:"",c=s.toLowerCase(),O.codefix.forEachExternalModule(u,h,function(e){if(e!==d.symbol)for(var t=0,r=u.getExportsOfModule(e);t<r.length;t++){var n,i=r[t],s=i.name,a="default"===s;a&&(n=O.getLocalSymbolForExportDefault(i))&&(s=(i=n).name),i.declarations&&i.declarations.some(function(e){return O.isExportSpecifier(e)&&!!e.parent.parent.moduleSpecifier})||((e,t)=>{if(0===t.length)return 1;for(var r=0,n=0;n<e.length;n++)if(e.charCodeAt(n)===t.charCodeAt(r)&&++r===t.length)return 1})(s.toLowerCase(),c)&&(l.push(i),x[O.getSymbolId(i)]={moduleSymbol:e,isDefaultExport:a})}}),s=k,O.filterMutate(s,function(e){if(!O.isSourceFile(y)){if(O.isExportAssignment(y.parent))return!0;if(e&&2097152&e.flags&&(e=u.getAliasedSymbol(e)),O.isInRightSideOfInternalImportEqualsDeclaration(y))return!!(1920&e.flags);if(m||(!(t=f)||103!==t.kind||162!==t.parent.kind)&&(O.isPartOfTypeNode(y)||(e=>{if(e){var t=e.parent.kind;switch(e.kind){case 56:return 149===t||148===t||146===t||226===t||O.isFunctionLikeKind(t);case 58:return 231===t;case 118:return 202===t}}})(f)))return w(e)}var t;return!!(107455&O.getCombinedLocalAndExportSymbolFlags(e))})}}return 1}function w(e){return e=e.exportSymbol||e,!!(793064&(e=O.skipAlias(e,u)).flags)||(1536&e.flags?(e=u.getExportsOfModule(e),O.forEach(e,w)):void 0)}function I(e){return O.isClassElement(e.parent)&&O.isClassLike(e.parent.parent)}function A(e){return e.parent&&(t=e.parent,O.isParameter(t))&&O.isConstructorDeclaration(t.parent)&&(V(e.kind)||O.isDeclarationName(e));var t}function D(e){return O.isFunctionLikeKind(e)&&152!==e}function N(e){return e.getStart()<=p&&p<=e.getEnd()}}function y(e,t,r,n){var i=e.name;if(i){if(1920&e.flags){e=i.charCodeAt(0);if(O.isSingleOrDoubleQuote(e))return}return F(i,t,r,n)}}function F(e,t,r,n){return r&&!O.isIdentifierText(e,t)?n?JSON.stringify(e):void 0:e}function B(e){var t=n[e];return t||(n[e]=(e=>{switch(e){case 0:return(()=>{for(var e=[],t=72;t<=142;t++)e.push({name:O.tokenToString(t),kind:"keyword",kindModifiers:"",sortText:"0"});return e})();case 1:return r(U);case 2:return r(H)}})(e));function r(t){return O.filter(B(0),function(e){return t(e.name)})}}function $(e){switch(e){case 114:case 113:case 112:case 117:case 115:case 123:case 131:case 125:case 135:case 120:return!0}}function U(e){return $(O.stringToToken(e))}function V(e){switch(e){case 114:case 112:case 113:case 131:return!0}}function H(e){return V(O.stringToToken(e))}(N=O.Completions||(O.Completions={})).getCompletionsAtPosition=function(e,t,r,n,i,s,a){if(O.isInReferenceComment(i,s))return N.PathCompletions.getTripleSlashReferenceCompletion(i,s,n,e);if(O.isInString(i,s)){var o=i,l=s,c=t,u=n,d=r,p=O.findPrecedingToken(l,o);if(p&&9===p.kind)if(261===p.parent.kind&&178===p.parent.parent.kind&&p.parent.name===p){var h=p.parent;var m=c;var g=u.target;var f=d;var _=m.getContextualType(h.parent),y=[];if(_&&(R(_.getApparentProperties(),y,h,!1,m,g,f,!0),y.length))return{isGlobalCompletion:!1,isMemberCompletion:!0,isNewIdentifierLocation:!0,entries:y};return}else if(O.isElementAccessExpression(p.parent)&&p.parent.argumentExpression===p){_=p.parent;h=c;m=u.target;g=d;f=h.getTypeAtLocation(_.expression),y=[];if(f&&(R(f.getApparentProperties(),y,_,!1,h,m,g,!0),y.length))return{isGlobalCompletion:!1,isMemberCompletion:!0,isNewIdentifierLocation:!0,entries:y};return}else if(238===p.parent.kind||O.isExpressionOfExternalModuleImportEqualsDeclaration(p)||O.isRequireCall(p.parent,!1))return N.PathCompletions.getStringLiteralCompletionEntriesFromModuleNames(p,u,e,c);else if((e=>O.isBinaryExpression(e)&&(e=>32===e||33===e||34===e||35===e)(e.operatorToken.kind))(p.parent))return L(c.getTypeAtLocation(p.parent.left===p?p.parent.right:p.parent.left),c);else if(O.isCaseOrDefaultClause(p.parent))return L(c.getTypeAtLocation(p.parent.parent.parent.expression),c);else if(d=O.SignatureHelp.getImmediatelyContainingArgumentInfo(p,l,o)){var b=d;var v=c;var u=[],T=[],k=O.createMap();v.getResolvedSignature(b.invocation,u,b.argumentCount);for(var x=0,E=u;x<E.length;x++){var S=E[x];P(v.getParameterType(S,b.argumentIndex),T,v,k)}if(T.length)return{isGlobalCompletion:!1,isMemberCompletion:!1,isNewIdentifierLocation:!0,entries:T};return}else return L(c.getContextualType(p),c)}else{e=M(t,r,i,s,a);if(e){l=e.symbols,o=e.isGlobalCompletion,d=e.isMemberCompletion,u=e.allowStringLiteral,p=e.isNewIdentifierLocation,c=e.location,s=e.request,a=e.keywordFilters,e=e.symbolToOriginInfoMap;if(1===i.languageVariant&&c&&c.parent&&252===c.parent.kind)return{isGlobalCompletion:!1,isMemberCompletion:!0,isNewIdentifierLocation:!1,entries:[{name:c.parent.parent.openingElement.tagName.getFullText(),kind:"class",kindModifiers:void 0,sortText:"0"}]};if(s)return{isGlobalCompletion:!1,isMemberCompletion:!1,isNewIdentifierLocation:!1,entries:"JsDocTagName"===s.kind?O.JsDoc.getJSDocTagNameCompletions():"JsDocTag"===s.kind?O.JsDoc.getJSDocTagCompletions():O.JsDoc.getJSDocParameterNameCompletions(s.tag)};var C,w,I,A,s=[];if(O.isSourceFileJavaScript(i)){var D=R(l,s,c,!0,t,n.target,r,u,e);C=c.pos,w=D,I=n.target,A=s,O.getNameTable(i).forEach(function(e,t){var r;e!==C&&(e=O.unescapeLeadingUnderscores(t),!w.has(e))&&(w.set(e,!0),r=F(e,I,!0,!1))&&A.push({name:r,kind:"warning",kindModifiers:"",sortText:"1"})})}else{if((!l||0===l.length)&&0===a)return;R(l,s,c,!0,t,n.target,r,u,e)}return 0===a&&d||O.addRange(s,B(a)),{isGlobalCompletion:o,isMemberCompletion:d,isNewIdentifierLocation:p,entries:s}}}},N.getCompletionEntryDetails=function(e,t,r,n,i,s,a,o,l){var c=s.name,u=s.source;return(t=d(e,t,r,n,i,s,a))?(i=t.symbol,s=t.location,a=((e,t,r,n,i,s,a)=>{var o;if(e=e[O.getSymbolId(t)])return o=e.moduleSymbol,e=e.isDefaultExport,O.codefix.getCodeActionForImport(o,{host:n,checker:r,newLineCharacter:n.getNewLine(),compilerOptions:i,sourceFile:s,rulesProvider:a,symbolName:t.name,getCanonicalFileName:O.createGetCanonicalFileName(!!n.useCaseSensitiveFileNames&&n.useCaseSensitiveFileNames()),symbolToken:void 0,kind:e?1:0})})(t.symbolToOriginInfoMap,i,e,o,r,n,l),t=O.SymbolDisplay.getSymbolModifiers(i),r=(o=O.SymbolDisplay.getSymbolDisplayPartsDocumentationAndSymbolKind(e,i,n,s,s,7)).displayParts,{name:c,kindModifiers:t,kind:o.symbolKind,displayParts:r,documentation:o.documentation,tags:o.tags,codeActions:a,source:void 0===u?void 0:[O.textPart(u)]}):void 0===u&&O.some(B(0),function(e){return e.name===c})?{name:c,kind:"keyword",kindModifiers:"",displayParts:[O.displayPart(c,O.SymbolDisplayPartKind.keyword)],documentation:void 0,tags:void 0,codeActions:void 0,source:void 0}:void 0},N.getCompletionEntrySymbol=function(e,t,r,n,i,s,a){return(e=d(e,t,r,n,i,s,a))&&e.symbol},n=[]})(ts=ts||{}),(u=>{function d(e,t){return{fileName:t.fileName,textSpan:u.createTextSpanFromNode(e,t),kind:"none"}}function p(e,t){return void 0!==e&&e.kind===t}function a(e){return e&&e.parent}function o(e){var n=[];return function e(t){{var r;223===t.kind?n.push(t):224===t.kind?((r=t).catchClause?e(r.catchClause):e(r.tryBlock),r.finallyBlock&&e(r.finallyBlock)):u.isFunctionLike(t)||u.forEachChild(t,e)}}(e),n}function s(e){var r=[];return function e(t){218===t.kind||217===t.kind?r.push(t):u.isFunctionLike(t)||u.forEachChild(t,e)}(e),r}function l(e,t){t=c(t);return t&&t===e}function c(e){for(var t=e.parent;t;t=t.parent)switch(t.kind){case 221:if(217===e.kind)continue;case 214:case 215:case 216:case 213:case 212:if(!e.label||((e,t)=>{for(var r=e.parent;222===r.kind;r=r.parent)if(r.label.escapedText===t)return 1})(t,e.label.text))return t;break;default:if(u.isFunctionLike(t))return}}function h(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return!(!t||!u.contains(r,t.kind)||(e.push(t),0))}function m(t){var r=[];if(h(r,t.getFirstToken(),88,106,81)&&212===t.kind)for(var e=t.getChildren(),n=e.length-1;0<=n&&!h(r,e[n],106);n--);var i=s(t.statement);return u.forEach(i,function(e){l(t,e)&&h(r,e.getFirstToken(),72,77)}),r}function g(t){var r=[];return h(r,t.getFirstToken(),98),u.forEach(t.caseBlock.clauses,function(e){h(r,e.getFirstToken(),73,79);e=s(e);u.forEach(e,function(e){l(t,e)&&h(r,e.getFirstToken(),72)})}),r}(u.DocumentHighlights||(u.DocumentHighlights={})).getDocumentHighlights=function(e,t,r,n,i){var s,n=u.getTouchingWord(r,n,!0);if(n!==r)return u.Debug.assert(void 0!==n.parent),u.isJsxOpeningElement(n.parent)&&n.parent.tagName===n||u.isJsxClosingElement(n.parent)?(s=[(s=n.parent.parent).openingElement,s.closingElement].map(function(e){return d(e.tagName,r)}),[{fileName:r.fileName,highlightSpans:s}]):((e,t,r,n)=>(e=u.FindAllReferences.getReferenceEntriesForNode(e,t,n,r))&&(e=>{for(var t=u.createMap(),r=0,n=e;r<n.length;r++){var i=n[r],i=u.FindAllReferences.toHighlightSpan(i),s=i.fileName,i=i.span,a=t.get(s);a||t.set(s,a=[]),a.push(i)}return u.arrayFrom(t.entries(),function(e){return{fileName:e[0],highlightSpans:e[1]}})})(e))(n,e,t,i)||((e,t)=>{if((e=((e,t)=>{if(e)switch(e.kind){case 90:case 82:if(p(e.parent,211))return((e,t)=>{for(var r=[];p(e.parent,211)&&e.parent.elseStatement===e;)e=e.parent;for(;e;){var n=e.getChildren();h(r,n[0],90);for(var i=n.length-1;0<=i&&!h(r,n[i],82);i--);if(!p(e.elseStatement,211))break;e=e.elseStatement}for(var s=[],i=0;i<r.length;i++){if(82===r[i].kind&&i<r.length-1){for(var a=r[i],o=r[i+1],l=!0,c=o.getStart()-1;c>=a.end;c--)if(!u.isWhiteSpaceSingleLine(t.text.charCodeAt(c))){l=!1;break}if(l){s.push({fileName:t.fileName,textSpan:u.createTextSpanFromBounds(a.getStart(),o.end),kind:"reference"}),i++;continue}}s.push(d(r[i],t))}return s})(e.parent,t);break;case 96:if(p(e.parent,219))return n((e=>{var t;if((e=u.getContainingFunction(e))&&p(e.body,207))return t=[],u.forEachReturnStatement(e.body,function(e){h(t,e.getFirstToken(),96)}),u.forEach(o(e.body),function(e){h(t,e.getFirstToken(),100)}),t})(e.parent));break;case 100:if(p(e.parent,223))return n((e=>{var t;if(e=(e=>{for(var t=e;t.parent;){var r=t.parent;if(u.isFunctionBlock(r)||265===r.kind)return r;if(224===r.kind){var n=r;if(n.tryBlock===t&&n.catchClause)return t}t=r}})(e))return t=[],u.forEach(o(e),function(e){h(t,e.getFirstToken(),100)}),u.isFunctionBlock(e)&&u.forEachReturnStatement(e,function(e){h(t,e.getFirstToken(),96)}),t})(e.parent));break;case 102:case 74:case 87:var r=74===e.kind?a(a(e)):a(e);if(p(r,224))return n(((e,t)=>{var r=[];return h(r,e.getFirstToken(),102),e.catchClause&&h(r,e.catchClause.getFirstToken(),74),e.finallyBlock&&(e=u.findChildOfKind(e,87,t),h(r,e,87)),r})(r,t));break;case 98:if(p(e.parent,221))return n(g(e.parent));break;case 73:case 79:if(p(a(a(a(e))),221))return n(g(e.parent.parent.parent));break;case 72:case 77:if(p(e.parent,218)||p(e.parent,217))return n((e=>{var t=c(e);if(t)switch(t.kind){case 214:case 215:case 216:case 212:case 213:return m(t);case 221:return g(t)}})(e.parent));break;case 88:if(p(e.parent,214)||p(e.parent,215)||p(e.parent,216))return n(m(e.parent));break;case 106:case 81:if(p(e.parent,213)||p(e.parent,212))return n(m(e.parent));break;case 123:if(p(e.parent,152))return n((e=>{var e=e.symbol.getDeclarations(),t=[];return u.forEach(e,function(e){u.forEach(e.getChildren(),function(e){return h(t,e,123)})}),t})(e.parent));break;case 125:case 135:if(p(e.parent,153)||p(e.parent,154))return n((e=>{var r=[];return t(e.symbol,153),t(e.symbol,154),r;function t(e,t){e=u.getDeclarationOfKind(e,t);e&&u.forEach(e.getChildren(),function(e){return h(r,e,125,135)})}})(e.parent));break;default:if(u.isModifierKind(e.kind)&&e.parent&&(u.isDeclaration(e.parent)||208===e.parent.kind))return n(((t,e)=>{var r;if(((e,t)=>{var r=t.parent;switch(e){case 112:case 113:case 114:switch(r.kind){case 229:case 199:return 1;case 152:return 146===t.kind;default:return}case 115:return 229===r.kind||199===r.kind;case 84:case 124:return 234===r.kind||265===r.kind;case 117:return 229===r.kind||229===t.kind;default:return}})(t,e))return r=u.modifierToFlag(t),u.mapDefined(((e,t)=>{var r=e.parent;switch(r.kind){case 234:case 265:case 207:case 257:case 258:return 128&t?e.members.concat([e]):r.statements;case 152:return r.parameters.concat(r.parent.members);case 229:case 199:var n=r.members;if(28&t){var i=u.find(r.members,u.isConstructorDeclaration);if(i)return n.concat(i.parameters)}else if(128&t)return n.concat([r]);return n;default:u.Debug.fail("Invalid container kind.")}})(e,r),function(e){if(u.getModifierFlags(e)&r)return e=u.find(e.modifiers,function(e){return e.kind===t}),u.Debug.assert(!!e),e})})(e.kind,e.parent))}function n(e){return e&&e.map(function(e){return d(e,t)})}})(e,t))&&0!==e.length)return[{fileName:t.fileName,highlightSpans:e}]})(n,r)}})(ts=ts||{}),(p=>{p.createDocumentRegistry=function(e,s){void 0===s&&(s="");var n=p.createMap(),a=p.createGetCanonicalFileName(!!e);function o(e){return"_"+e.target+"|"+e.module+"|"+e.noResolve+"|"+e.jsx+"|"+e.allowJs+"|"+e.baseUrl+"|"+JSON.stringify(e.typeRoots)+"|"+JSON.stringify(e.rootDirs)+"|"+JSON.stringify(e.paths)}function c(e,t){var r=n.get(e);return!r&&t&&n.set(e,r=p.createMap()),r}function l(e,t,r,n,i,s,a){return d(e,t,r,n,i,s,!0,a)}function u(e,t,r,n,i,s,a){return d(e,t,r,n,i,s,!1,a)}function d(e,t,r,n,i,s,a,o){var n=c(n,!0),l=n.get(t);return l?(l.sourceFile.version!==s&&(l.sourceFile=p.updateLanguageServiceSourceFile(l.sourceFile,i,s,i.getChangeRange(l.sourceFile.scriptSnapshot))),a&&l.languageServiceRefCount++):(l={sourceFile:p.createLanguageServiceSourceFile(e,i,r.target,s,!1,o),languageServiceRefCount:1,owners:[]},n.set(t,l)),l.sourceFile}function r(e,t){var t=c(t,!1),r=(p.Debug.assert(void 0!==t),t.get(e));r.languageServiceRefCount--,p.Debug.assert(0<=r.languageServiceRefCount),0===r.languageServiceRefCount&&t.delete(e)}return{acquireDocument:function(e,t,r,n,i){return l(e,p.toPath(e,s,a),t,o(t),r,n,i)},acquireDocumentWithKey:l,updateDocument:function(e,t,r,n,i){return u(e,p.toPath(e,s,a),t,o(t),r,n,i)},updateDocumentWithKey:u,releaseDocument:function(e,t){return r(p.toPath(e,s,a),o(t))},releaseDocumentWithKey:r,reportStats:function(){var e=p.arrayFrom(n.keys()).filter(function(e){return e&&"_"===e.charAt(0)}).map(function(e){var t=n.get(e),r=[];return t.forEach(function(e,t){r.push({name:t,refCount:e.languageServiceRefCount,references:e.owners.slice(0)})}),r.sort(function(e,t){return t.refCount-e.refCount}),{bucket:e,sourceFiles:r}});return JSON.stringify(e,void 0,2)},getKeyForCompilationSettings:o}}})(ts=ts||{}),(k=>{var e,t;function x(e,t){return k.forEach((265===e.kind?e:e.body).statements,function(e){return t(e)||n(e)&&k.forEach(e.body&&e.body.statements,t)})}function g(e,n){if(e.externalModuleIndicator||void 0!==e.imports)for(var t=0,r=e.imports;t<r.length;t++){var i=r[t];n((e=>{var t=e.parent;switch(t.kind){case 181:case 238:case 244:return t;case 248:return t.parent;default:k.Debug.fail("Unexpected module specifier parent: "+t.kind)}})(i),i)}else x(e,function(e){switch(e.kind){case 244:case 238:(t=e).moduleSpecifier&&9===t.moduleSpecifier.kind&&n(t,t.moduleSpecifier);break;case 237:var t,r=(t=e).moduleReference;248===r.kind&&9===r.expression.kind&&n(t,r.expression)}})}function r(e,t,r){r=r.getMergedSymbol(e.parent);return k.isExternalModuleSymbol(r)?{exportingModuleSymbol:r,exportKind:t}:void 0}function E(e){return"default"!==e.escapedName?e.escapedName:k.forEach(e.declarations,function(e){e=k.getNameOfDeclaration(e);return e&&71===e.kind&&e.escapedText})}function S(e,t){return t.getMergedSymbol(C(e).symbol)}function C(e){return 181===e.kind?e.getSourceFile():265===(e=e.parent).kind?e:(k.Debug.assert(234===e.kind&&n(e.parent)),e.parent)}function n(e){return 233===e.kind&&9===e.name.kind}function w(e){e=e.moduleReference;return 248===e.kind&&9===e.expression.kind}(e=k.FindAllReferences||(k.FindAllReferences={})).createImportTracker=function(y,b,v){var T=((e,n,t)=>{for(var i=k.createMap(),r=0,s=e;r<s.length;r++){var a=s[r];t.throwIfCancellationRequested(),g(a,function(e,t){var r,t=n.getSymbolAtLocation(t);t&&(t=k.getSymbolId(t).toString(),(r=i.get(t))||i.set(t,r=[]),r.push(e))})}return i})(y,b,v);return function(e,t,r){n=y,i=T,o=b,a=v,s=t.exportingModuleSymbol,l=t.exportKind,c=k.nodeSeenTracker(),u=k.nodeSeenTracker(),d=[],p=!!s.globalExports,h=p?void 0:[],function e(t){t=_(t);if(t)for(var r=0,n=t;r<n.length;r++){var i=n[r];if(c(i))switch(a.throwIfCancellationRequested(),i.kind){case 181:if(!p){var s=i.parent;if(2===l&&226===s.kind){s=s.name;if(71===s.kind){d.push(s);break}}f(i.getSourceFile())}break;case 237:g(i,i.name,k.hasModifier(i,1));break;case 238:s=i.importClause&&i.importClause.namedBindings;s&&240===s.kind?g(i,s.name):d.push(i);break;case 244:i.exportClause?d.push(i):e(S(i,o))}}}(s);var n,i,o,a,s,l,c,u,d,p,h,m={directImports:d,indirectUsers:(()=>{if(p)return n;for(var e=0,t=s.declarations;e<t.length;e++){var r=t[e];k.isExternalModuleAugmentation(r)&&f(r)}return h.map(k.getSourceFileOfNode)})()};function g(e,t,r){var s,a;2===l?d.push(e):p||(e=C(e),k.Debug.assert(265===e.kind||233===e.kind),(r||(r=e,a=(s=o).getSymbolAtLocation(t),x(r,function(e){if(244===e.kind){var t=e.exportClause,e=e.moduleSpecifier;if(!e&&t)for(var r=0,n=t.elements;r<n.length;r++){var i=n[r];if(s.getExportSpecifierLocalTargetSymbol(i)===a)return!0}}}))?function e(t){if(!f(t))return;t=o.getMergedSymbol(t.symbol);k.Debug.assert(!!(1536&t.flags));t=_(t);if(t)for(var r=0,n=t;r<n.length;r++){var i=n[r];e(C(i))}}:f)(e))}function f(e){k.Debug.assert(!p);var t=u(e);return t&&h.push(e),t}function _(e){return i.get(k.getSymbolId(e).toString())}return __assign({indirectUsers:m.indirectUsers},((e,t,r,a,o)=>{var n,i,s=[],l=[];function c(e,t){s.push([e,t])}if(e)for(var u=0,d=e;u<d.length;u++){p=void 0;n=void 0;i=void 0;var p=d[u];237===p.kind?w(p)&&h(p.name):71===p.kind?h(p):9===p.moduleSpecifier.kind&&(244===p.kind?m(p.exportClause):(p=p.importClause)&&((n=p.namedBindings)&&240===n.kind?h(n.name):0!==r&&(!(p=p.name)||o&&p.escapedText!==E(t)||(i=a.getSymbolAtLocation(p),c(p,i)),o||1!==r)||m(n)))}return{importSearches:s,singleReferences:l};function h(e){2!==r||o&&!g(e.escapedText)||c(e,a.getSymbolAtLocation(e))}function m(e){if(e)for(var t=0,r=e.elements;t<r.length;t++){var n=r[t],i=n.name,s=n.propertyName;g((s||i).escapedText)&&(s?(l.push(s),o||c(i,a.getSymbolAtLocation(i))):c(i,246===n.kind&&n.propertyName?a.getExportSpecifierLocalTargetSymbol(n):a.getSymbolAtLocation(i)))}}function g(e){return e===t.escapedName||0!==r&&"default"===e}})(m.directImports,e,t.exportKind,b,r))}},(t=e.ExportKind||(e.ExportKind={}))[t.Named=0]="Named",t[t.Default=1]="Default",t[t.ExportEquals=2]="ExportEquals",(t=e.ImportExport||(e.ImportExport={}))[t.Import=0]="Import",t[t.Export=1]="Export",e.findModuleReferences=function(e,t,r){for(var n=[],i=e.getTypeChecker(),s=0,a=t;s<a.length;s++){var o=a[s],l=r.valueDeclaration;if(265===l.kind){for(var c=0,u=o.referencedFiles;c<u.length;c++){var d=u[c];e.getSourceFileFromReference(o,d)===l&&n.push({kind:"reference",referencingFile:o,ref:d})}for(var p=0,h=o.typeReferenceDirectives;p<h.length;p++){var d=h[p],m=e.getResolvedTypeReferenceDirectives().get(d.fileName);void 0!==m&&m.resolvedFileName===l.fileName&&n.push({kind:"reference",referencingFile:o,ref:d})}}g(o,function(e,t){i.getSymbolAtLocation(t)===r&&n.push({kind:"import",literal:t})})}return n},e.getImportOrExportSymbol=function(i,s,a,o){return o?e():e()||(()=>{var e,t,r=(e=>{var t=e.parent;switch(t.kind){case 237:return t.name===e&&w(t)?{isNamedImport:!1}:void 0;case 242:return t.propertyName?void 0:{isNamedImport:!0};case 239:case 240:return k.Debug.assert(t.name===e),{isNamedImport:!1};default:return}})(i);return r&&(e=a.getImmediateAliasedSymbol(s))&&(void 0===(t=E(e="export="===(e=((e,t)=>{if(e.declarations)for(var r=0,n=e.declarations;r<n.length;r++){var i=n[r];if(k.isExportSpecifier(i)&&!i.propertyName&&!i.parent.parent.moduleSpecifier)return t.getExportSpecifierLocalTargetSymbol(i)}return e})(e,a)).escapedName?((e,t)=>2097152&e.flags?t.getImmediateAliasedSymbol(e):(t=e.valueDeclaration,k.isExportAssignment(t)?t.expression.symbol:k.isBinaryExpression(t)?t.right.symbol:void k.Debug.fail()))(e,a):e))||"default"===t||t===s.escapedName)?__assign({kind:0,symbol:e},r):void 0})();function e(){var e,t=i.parent;return s.exportSymbol?179===t.kind?s.declarations.some(function(e){return e===t})&&k.isBinaryExpression(t.parent)?n(t.parent,!1):void 0:l(s.exportSymbol,c(t)):(e=((e,t)=>{var r;return 226===e.kind?(r=e).name===t&&260!==r.parent.kind&&208===r.parent.parent.kind?r.parent.parent:void 0:e})(t,i))&&k.hasModifier(e,1)?k.isImportEqualsDeclaration(e)&&e.moduleReference===i?o?void 0:{kind:0,symbol:a.getSymbolAtLocation(e.name),isNamedImport:!1}:l(s,c(e)):k.isExportAssignment(t)?r(t):k.isExportAssignment(t.parent)?r(t.parent):k.isBinaryExpression(t)?n(t,!0):k.isBinaryExpression(t.parent)?n(t.parent,!0):void 0;function r(e){var t=e.symbol.parent,e=(k.Debug.assert(!!t),e.isExportEquals?2:1);return{kind:1,symbol:s,exportInfo:{exportingModuleSymbol:t,exportKind:e}}}function n(e,t){var r;switch(k.getSpecialPropertyAssignmentKind(e)){case 1:r=0;break;case 2:r=2;break;default:return}t=t?a.getSymbolAtLocation(e.left.name):s;return t&&l(t,r)}}function l(e,t){t=r(e,t,a);return t&&{kind:1,symbol:e,exportInfo:t}}function c(e){return k.hasModifier(e,512)?1:0}},e.getExportInfo=r})(ts=ts||{}),(d=>{var a;function o(e,t){return{type:"node",node:e,isInString:t}}function l(e,t,r,n,i){return c(a.Core.getReferencedSymbolsForNode(e,t,r,n,i=void 0===i?{}:i))}function p(e,t,r,n,i,s){n=d.getTouchingPropertyName(n,i,!0);return a.Core.getReferencedSymbolsForNode(n,e,r,t,s)}function c(e){return e&&d.flatMap(e,function(e){return e.references})}function h(e,t,r){r=d.SymbolDisplay.getSymbolDisplayPartsDocumentationAndSymbolKind(r,e,t.getSourceFile(),d.getContainerNode(t),t);return{displayParts:r.displayParts,kind:r.symbolKind}}function m(e){var t;return"span"===e.type?{textSpan:e.textSpan,fileName:e.fileName,isWriteAccess:!1,isDefinition:!1}:(t=e.isInString,{fileName:(e=e.node).getSourceFile().fileName,textSpan:u(e),isWriteAccess:i(e),isDefinition:79===e.kind||d.isAnyDeclarationName(e)||d.isLiteralComputedPropertyDeclarationName(e),isInString:t})}function u(e){var t=e.getStart(),r=e.getEnd();return 9===e.kind&&(t+=1,--r),d.createTextSpanFromBounds(t,r)}function i(e){return 79===e.kind||d.isAnyDeclarationName(e)||d.isWriteAccess(e)}(a=d.FindAllReferences||(d.FindAllReferences={})).nodeEntry=o,a.findReferencedSymbols=function(e,t,r,n,i){if((t=p(e,t,r,n,i))&&t.length){for(var s=[],a=e.getTypeChecker(),o=0,l=t;o<l.length;o++){var c=l[o],u=c.definition,c=c.references;u&&s.push({definition:((i,s)=>{var e,t,r,n,a=(()=>{switch(i.type){case"symbol":var e=i.symbol,t=i.node,r=h(e,t,s),n=r.displayParts,r=r.kind;return{node:t,name:n.map(function(e){return e.text}).join(""),kind:r,displayParts:n};case"label":t=i.node;return{node:t,name:t.text,kind:"label",displayParts:[d.displayPart(t.text,d.SymbolDisplayPartKind.text)]};case"keyword":r=i.node,n=d.tokenToString(r.kind);return{node:r,name:n,kind:"keyword",displayParts:[{text:n,kind:"keyword"}]};case"this":t=i.node,r=(e=s.getSymbolAtLocation(t))&&d.SymbolDisplay.getSymbolDisplayPartsDocumentationAndSymbolKind(s,e,t.getSourceFile(),d.getContainerNode(t),t).displayParts;return{node:t,name:"this",kind:"var",displayParts:r};case"string":n=i.node;return{node:n,name:n.text,kind:"var",displayParts:[d.displayPart(d.getTextOfNode(n),d.SymbolDisplayPartKind.stringLiteral)]}}})();if(a)return e=a.node,t=a.name,r=a.kind,a=a.displayParts,{containerKind:"",containerName:"",fileName:(n=e.getSourceFile()).fileName,kind:r,name:t,textSpan:d.createTextSpanFromNode(e,n),displayParts:a}})(u,a),references:c.map(m)})}return s}},a.getImplementationsAtPosition=function(e,t,r,n,i){var t=((e,t,r,n)=>{var i,s;if(265!==n.kind)return i=e.getTypeChecker(),262===n.parent.kind?(s=[],a.Core.getReferenceEntriesForShorthandPropertyAssignment(n,i,function(e){return s.push(o(e))}),s):97===n.kind||d.isSuperProperty(n.parent)?(i=i.getSymbolAtLocation(n)).valueDeclaration&&[o(i.valueDeclaration)]:l(n,e,r,t,{implementations:!0})})(e,t,r,d.getTouchingPropertyName(n,i,!1)),s=e.getTypeChecker();return d.map(t,function(e){var t,r=s;return"node"===e.type?(t=e.node,__assign({textSpan:u(t),fileName:t.getSourceFile().fileName},((e,t)=>{var r=t.getSymbolAtLocation(d.isDeclaration(e)&&e.name?e.name:e);return r?h(r,e,t):178===e.kind?{kind:"interface",displayParts:[d.punctuationPart(19),d.textPart("object literal"),d.punctuationPart(20)]}:199===e.kind?{kind:"local class",displayParts:[d.punctuationPart(19),d.textPart("anonymous local class"),d.punctuationPart(20)]}:{kind:d.getNodeKind(e),displayParts:[]}})(t,r))):{textSpan:e.textSpan,fileName:e.fileName,kind:"",displayParts:[]}})},a.findReferencedEntries=function(e,t,r,n,i,s){return e=c(p(e,t,r,n,i,s)),d.map(e,m)},a.getReferenceEntriesForNode=l,a.toHighlightSpan=function(e){var t,r,n;return"span"===e.type?{fileName:e.fileName,span:{textSpan:e.textSpan,kind:"reference"}}:(t=e.isInString,r=(e=e.node).getSourceFile().fileName,n=i(e),{fileName:r,span:{textSpan:u(e),kind:n?"writtenReference":"reference",isInString:t}})}})(ts=ts||{}),(A=>{var D,e,S;function t(e,t,r,n,i,s,a){this.sourceFiles=e,this.isForConstructor=t,this.checker=r,this.cancellationToken=n,this.searchMeaning=i,this.options=s,this.result=a,this.inheritsFromCache=A.createMap(),this.markSeenContainingTypeReference=A.nodeSeenTracker(),this.markSeenReExportRHS=A.nodeSeenTracker(),this.symbolIdToReferences=[],this.sourceFileToSeenSymbols=[]}function N(e,t,r,n){var i=n.getImportSearches(t,r),s=i.importSearches,a=i.singleReferences,i=i.indirectUsers;if(a.length)for(var o=n.referenceAdder(t,e),l=0,c=a;l<c.length;l++)o(c[l]);for(var u=0,d=s;u<d.length;u++){var p=d[u],h=p[0],p=p[1];_(h.getSourceFile(),n.createSearch(h,p,1),n)}if(i.length){var m=void 0;switch(r.exportKind){case 0:m=n.createSearch(e,t,1);break;case 1:m=n.options.isForRename?void 0:n.createSearch(e,t,1,{text:"default"})}if(m)for(var g=0,f=i;g<f.length;g++)C(f[g],m,n)}}function O(e,t){for(var r=0,n=e.declarations;r<n.length;r++){var i=n[r];_(i.getSourceFile(),t.createSearch(i,e,0),t)}}function C(e,t,r){void 0!==A.getNameTable(e).get(t.escapedText)&&_(e,t,r)}function R(e,t){return A.isArrayLiteralOrObjectLiteralDestructuringPattern(e.parent.parent)&&t.getPropertySymbolOfDestructuringAssignment(e)}function w(e){e=A.getDeclarationOfKind(e,176);if(e&&174===e.parent.kind&&!e.propertyName)return e}function L(e,t){var r,e=w(e);if(e)return(t=(r=t.getTypeAtLocation(e.parent))&&t.getPropertyOfType(r,e.name.text))&&98304&t.flags?(A.Debug.assert(!!(33554432&t.flags)),t.target):t}function I(e,t,r){void 0===r&&(r=e);var n=[];if(t&&t.length)for(var i=e.text,s=i.length,a=t.length,o=i.indexOf(t,r.pos);0<=o&&!(o>r.end);){var l=o+a;0!==o&&A.isIdentifierPart(i.charCodeAt(o-1),5)||l!==s&&A.isIdentifierPart(i.charCodeAt(l),5)||n.push(o),o=i.indexOf(t,o+a+1)}return n}function P(e,t){for(var r=[],n=e.getSourceFile(),i=t.text,s=0,a=I(n,i,e);s<a.length;s++){var o=a[s],o=A.getTouchingWord(n,o,!1);o&&(o===t||A.isJumpStatementTarget(o)&&A.getTargetLabel(o,i)===t)&&r.push(D.nodeEntry(o))}return[{definition:{type:"label",node:t},references:r}]}function M(e,t){switch(e.kind){case 71:return e.text.length===t.length;case 9:return(A.isLiteralNameOfPropertyDeclarationOrIndexAccess(e)||9===(r=e).kind&&(A.isNameOfModuleDeclaration(r)||A.isExpressionOfExternalModuleImportEqualsDeclaration(r)))&&e.text.length===t.length;case 8:return A.isLiteralNameOfPropertyDeclarationOrIndexAccess(e)&&e.text.length===t.length;case 79:return"default".length===t.length;default:return}var r}function _(e,t,r){r.cancellationToken.throwIfCancellationRequested(),F(e,e,t,r)}function F(e,t,r,n){if(n.markSearchedSymbol(t,r.symbol))for(var i=0,s=I(t,r.text,e);i<s.length;i++)((e,t,r,n)=>{var i=A.getTouchingPropertyName(e,t,!0);if(M(i,r.text)){if(A.getMeaningFromLocation(i)&n.searchMeaning&&(w=n.checker.getSymbolAtLocation(i))&&(m=i.parent,!A.isImportSpecifier(m)||m.propertyName!==i))if(A.isExportSpecifier(m)){A.Debug.assert(71===i.kind);var s=i,a=w,o=r,l=n,c=m.parent,u=m.propertyName,d=m.name,c=c.parent,p=B(s,a,m,l.checker);function h(){$(s,p,o.location,l)}o.includes(p)&&(u?s===u?(c.moduleSpecifier||h(),!l.options.isForRename&&l.markSeenReExportRHS(d)&&$(d,a,d,l)):l.markSeenReExportRHS(s)&&h():h(),s===u&&l.options.isForRename||(d=79===s.originalKeywordKind?1:0,d=D.getExportInfo(a,d,l.checker),A.Debug.assert(!!d),N(s,a,d,l)),1!==o.comingFrom)&&c.moduleSpecifier&&!u&&O(l.checker.getExportSpecifierLocalTargetSymbol(m),l)}else if(a=((t,e,r,c)=>{if(t.includes(e))return e;var n=A.getContainingObjectLiteralElement(r);if(n){n=A.forEach(V(n,c.checker),function(e){return A.find(c.checker.getRootSymbols(e),t.includes)});if(n)return n;n=R(r,c.checker);if(n&&t.includes(n))return n}if(r=L(e,c.checker)){n=i(r);if(n)return n}return i(e);function i(e){return A.forEach(c.checker.getRootSymbols(e),function(l){var e;return t.includes(l)?l:!(l.parent&&96&l.parent.flags)||t.parents&&!A.some(t.parents,function(e){return r=l.parent,n=e,s=c.inheritsFromCache,a=c.checker,o=64&n.getFlags(),t(r);function t(e){if(e===n)return!0;var t=A.getSymbolId(e)+","+A.getSymbolId(n),r=s.get(t);if(void 0!==r)return r;s.set(t,!1);r=A.forEach(e.getDeclarations(),function(e){if(A.isClassLike(e)){if(o){var t=A.getClassImplementsHeritageClauseElements(e);if(t)for(var r=0,n=t;r<n.length;r++)if(i(n[r]))return!0}return i(A.getClassExtendsHeritageClauseElement(e))}return!(230!==e.kind||!o)&&A.forEach(A.getInterfaceBaseTypeNodes(e),i)});return s.set(t,r),r}function i(e){if(e){e=a.getTypeAtLocation(e);if(e&&e.symbol)return t(e.symbol)}return!1}var r,n,s,a,o})?void 0:(U(l.parent,l.name,e=[],A.createSymbolTable(),c.checker),A.find(e,t.includes))})}})(r,w,i,n)){if(n.isForConstructor){var d=i,c=e,u=r,m=n;if(A.isNewExpressionTarget(d)&&$(d,u.symbol,u.location,m),m=m.referenceAdder(u.symbol,u.location),A.isClassLike(d.parent)){A.Debug.assert(d.parent.name===d);for(var g=u.symbol,f=c,_=m,y=0,b=g.members.get("__constructor").declarations;y<b.length;y++){var v=b[y],T=A.findChildOfKind(v,123,f);A.Debug.assert(152===v.kind&&!!T),_(T)}g.exports.forEach(function(e){var e=e.valueDeclaration;e&&151===e.kind&&(e=e.body)&&H(e,99,function(e){A.isNewExpressionTarget(e)&&_(e)})})}else if((u=(e=>A.tryGetClassExtendingExpressionWithTypeArguments(A.climbPastPropertyAccess(e).parent))(d))&&A.isClassLike(u)){var c=u,k=m;if(c=c.symbol.members.get("__constructor"))for(var x=0,E=c.declarations;x<E.length;x++){var S=E[x],S=(A.Debug.assert(152===S.kind),S.body);S&&H(S,97,function(e){A.isCallExpressionTarget(e)&&k(e)})}}}else $(i,a,r.location,n);var g=i,m=w,i=r,C=n;(m=D.getImportOrExportSymbol(g,m,C.checker,1===i.comingFrom))&&(i=m.symbol,0===m.kind?C.options.isForRename&&!m.isNamedImport||O(i,C):N(g,i,m.exportInfo,C))}else{var i=r,m=n,w=(C=w).flags,C=C.valueDeclaration,I=m.checker.getShorthandAssignmentValueSymbol(C);33554432&w||!i.includes(I)||$(A.getNameOfDeclaration(C),I,i.location,m)}}else!n.options.implementations&&(n.options.findInStrings&&A.isInString(e,t)||n.options.findInComments&&A.isInNonReferenceComment(e,t))&&n.addStringOrCommentReference(e.fileName,A.createTextSpan(t,r.text.length))})(t,s[i],r,n)}function B(e,t,r,n){return e=e,s=(i=r).parent,a=r.propertyName,i=r.name,A.Debug.assert(a===e||i===e),(a?a!==e:s.parent.moduleSpecifier)?t:n.getExportSpecifierLocalTargetSymbol(r);var i,s,a}function $(e,t,r,n){var i,s,t=n.referenceAdder(t,r);n.options.implementations?(r=e,i=t,n=n,A.isDeclarationName(r)&&(e=>{if(e)if(A.isVariableLike(e)){if(e.initializer)return 1;var t;if(226===e.kind)return(t=(e=>{if(e.parent&&e.parent.parent&&208===e.parent.parent.kind)return A.Debug.assert(227===e.parent.kind),e.parent.parent})(e))&&A.hasModifier(t,2)}else{if(A.isFunctionLike(e))return!!e.body||A.hasModifier(e,2);switch(e.kind){case 229:case 199:case 232:case 233:return 1}}})(r.parent)?i(r.parent):71===r.kind&&(262===r.parent.kind&&o(r,n.checker,i),(s=function e(t){if(t&&t.parent){if(201===t.kind&&259===t.parent.kind&&A.isClassLike(t.parent.parent))return t.parent.parent;if(71===t.kind||179===t.kind)return e(t.parent)}return}(r))?i(s):(s=(e=>{for(var t=void 0;e;)A.isTypeNode(e)&&(t=e),e=e.parent;return t})(r))&&n.markSeenContainingTypeReference(s)&&(r=s.parent,A.isVariableLike(r)&&r.type===s&&r.initializer&&a(r.initializer)?i(r.initializer):A.isFunctionLike(r)&&r.type===s&&r.body?207===(n=r.body).kind?A.forEachReturnStatement(n,function(e){e.expression&&a(e.expression)&&i(e.expression)}):a(n)&&i(n):A.isAssertionExpression(r)&&a(r.expression)&&i(r.expression)))):t(e)}function a(e){switch(e.kind){case 185:return a(e.expression);case 187:case 186:case 178:case 199:case 177:return!0;default:return!1}}function U(r,n,i,s,a){function t(e){var t;e&&(e=a.getTypeAtLocation(e))&&((t=a.getPropertyOfType(e,n))&&i.push.apply(i,a.getRootSymbols(t)),s.set(r.escapedName,r),U(e.symbol,n,i,s,a))}r&&!s.has(r.escapedName)&&96&r.flags&&A.forEach(r.getDeclarations(),function(e){A.isClassLike(e)?(t(A.getClassExtendsHeritageClauseElement(e)),A.forEach(A.getClassImplementsHeritageClauseElements(e),t)):230===e.kind&&A.forEach(A.getInterfaceBaseTypeNodes(e),t)})}function V(e,t){var r,n=e.parent,t=t.getContextualType(n),i=144===(n=e).name.kind?(e=n.name.expression,A.isStringOrNumericLiteral(e)?e.text:void 0):A.getTextOfIdentifierOrLiteral(n.name);if(i&&t)return r=[],(e=t.getProperty(i))&&r.push(e),65536&t.flags&&A.forEach(t.types,function(e){e=e.getProperty(i);e&&r.push(e)}),r}function o(e,t,r){e=t.getSymbolAtLocation(e),t=t.getShorthandAssignmentValueSymbol(e.valueDeclaration);if(t)for(var n=0,i=t.getDeclarations();n<i.length;n++){var s=i[n];1&A.getMeaningFromDeclaration(s)&&r(s)}}function H(e,t,r){A.forEachChild(e,function(e){e.kind===t&&r(e),H(e,t,r)})}D=A.FindAllReferences||(A.FindAllReferences={}),(e=D.Core||(D.Core={})).getReferencedSymbolsForNode=function(e,t,r,n,i){if(void 0===i&&(i={}),265!==e.kind){if(!i.implementations){var s=((e,t,r)=>{if(A.isTypeKeyword(e.kind)){for(var n=t,i=e.kind,s=r,a=[],o=0,l=n;o<l.length;o++){var c=l[o];s.throwIfCancellationRequested(),((e,t,r,n)=>{for(var r=I(e,r,e),i=0,s=r;i<s.length;i++){var a=s[i],a=A.getTouchingPropertyName(e,a,!0);a.kind===t&&n.push(D.nodeEntry(a))}})(c,i,A.tokenToString(i),a)}return a.length?[{definition:{type:"keyword",node:a[0].node},references:a}]:void 0}if(A.isLabelName(e))return A.isJumpStatementTarget(e)?(y=A.getTargetLabel(e.parent,e.text))&&P(y.parent,y):P(e.parent,e);if(A.isThis(e)){var u=e,d=t,p=r,h=A.getThisContainer(u,!1),m=32;switch(h.kind){case 151:case 150:if(A.isObjectLiteralMethod(h))break;case 149:case 148:case 152:case 153:case 154:m&=A.getModifierFlags(h),h=h.parent;break;case 265:if(A.isExternalModule(h))return;case 228:case 186:break;default:return}var g,f=[];return 265===h.kind?A.forEach(d,function(e){p.throwIfCancellationRequested(),_(e,e,g=I(e,"this"),f)}):(d=h.getSourceFile(),g=I(d,"this",h),_(d,h,g,f)),[{definition:{type:"this",node:u},references:f}];function _(n,i,e,s){A.forEach(e,function(e){var t=A.getTouchingWord(n,e,!1);if(t&&A.isThis(t)){var r=A.getThisContainer(t,!1);switch(i.kind){case 186:case 228:i.symbol===r.symbol&&s.push(D.nodeEntry(t));break;case 151:case 150:A.isObjectLiteralMethod(i)&&i.symbol===r.symbol&&s.push(D.nodeEntry(t));break;case 199:case 229:r.parent&&i.symbol===r.parent.symbol&&(32&A.getModifierFlags(r))===m&&s.push(D.nodeEntry(t));break;case 265:265!==r.kind||A.isExternalModule(r)||s.push(D.nodeEntry(t))}}})}}else if(97===e.kind){var y=e,b=A.getSuperContainer(y,!1);if(b){var v=32;switch(b.kind){case 149:case 148:case 151:case 150:case 152:case 153:case 154:v&=A.getModifierFlags(b),b=b.parent;break;default:return}for(var T=[],k=b.getSourceFile(),t=I(k,"super",b),x=0,E=t;x<E.length;x++){var S,C=E[x],C=A.getTouchingWord(k,C,!1);C&&97===C.kind&&(S=A.getSuperContainer(C,!1))&&(32&A.getModifierFlags(S))===v&&S.parent.symbol===b.symbol&&T.push(D.nodeEntry(C))}return[{definition:{type:"symbol",symbol:b.symbol,node:y},references:T}]}}})(e,r,n);if(s)return s}var s=t.getTypeChecker(),a=s.getSymbolAtLocation(e);if(!a){if(i.implementations||9!==e.kind)return;for(var o=e,l=n,c=[],u=0,d=r;u<d.length;u++){var p=d[u],h=(l.throwIfCancellationRequested(),I(p,o.text));((e,t,r,n)=>{for(var i=0,s=r;i<s.length;i++){var a=s[i],a=A.getTouchingWord(e,a,!1);a&&9===a.kind&&a.text===t&&n.push(D.nodeEntry(a,!0))}})(p,o.text,h,c)}return[{definition:{type:"string",node:o},references:c}]}if(1536&a.flags&&(e=>{if(9===e.kind)switch(e.parent.kind){case 233:case 248:case 238:case 244:return 1;case 181:return A.isRequireCall(e.parent,!1)||A.isImportCall(e.parent);default:return}})(e)){var m=a,g=r;A.Debug.assert(!!m.valueDeclaration);for(var f=D.findModuleReferences(t,g,m).map(function(e){return"import"===e.kind?{type:"node",node:e.literal}:{type:"span",fileName:e.referencingFile.fileName,textSpan:A.createTextSpanFromRange(e.ref)}}),_=0,y=m.declarations;_<y.length;_++){var b=y[_];switch(b.kind){case 265:break;case 233:f.push({type:"node",node:b.name});break;default:A.Debug.fail("Expected a module symbol to be declared by a SourceFile or ModuleDeclaration.")}}return[{definition:{type:"symbol",symbol:m,node:m.valueDeclaration},references:f}]}var t=a,g=e,m=r,a=s,e=n,r=i,s=(t=((e,t,r)=>{var n=t.parent;return A.isExportSpecifier(n)?B(t,e,n,r):A.isImportSpecifier(n)&&n.propertyName===t?r.getImmediateAliasedSymbol(e):e})(t,g,a),((e,t)=>{if(t){var r=void 0;do{r=e;for(var n=0,i=t;n<i.length;n++){var s=i[n],s=A.getMeaningFromDeclaration(s);s&e&&(e|=s)}}while(e!==r)}return e})(A.getMeaningFromLocation(g),t.declarations)),n=[],v=new S(m,123===g.kind,a,e,s,r,n);if(79===g.kind)$(g,t,g,v),N(g,t,{exportingModuleSymbol:t.parent,exportKind:1},v);else{var T=v.createSearch(g,t,void 0,{allSearchSymbols:((e,t,i,s)=>{var r,a=[e],n=A.getContainingObjectLiteralElement(t);return n&&(262!==n.kind&&(r=R(t,i))&&a.push(r),A.forEach(V(n,i),function(e){A.addRange(a,i.getRootSymbols(e))}),r=i.getShorthandAssignmentValueSymbol(t.parent))&&a.push(r),e.valueDeclaration&&146===e.valueDeclaration.kind&&A.isParameterPropertyDeclaration(e.valueDeclaration)&&A.addRange(a,i.getSymbolsOfParameterPropertyDeclaration(e.valueDeclaration,e.name)),(n=L(e,i))&&(a.push(n),o(n)),o(e),a;function o(e){for(var t=0,r=i.getRootSymbols(e);t<r.length;t++){var n=r[t];n!==e&&a.push(n),!s&&n.parent&&96&n.parent.flags&&U(n.parent,n.name,a,A.createSymbolTable(),i)}}})(t,g,a,r.implementations)}),m=(e=>{var t,r=e.declarations,n=e.flags,i=e.parent,s=e.valueDeclaration;if(s&&(186===s.kind||199===s.kind))return s;if(r){if(8196&n)return(s=A.find(r,function(e){return A.hasModifier(e,8)}))?A.getAncestor(s,229):void 0;if(!w(e))if(!(n=i&&!(262144&e.flags))||1536&i.flags&&A.isExternalModuleSymbol(i)&&!i.globalExports){for(var a=0,o=r;a<o.length;a++){var l=o[a],l=A.getContainerNode(l);if(t&&t!==l)return;if(!l||265===l.kind&&!A.isExternalOrCommonJsModule(l))return;t=l}return n?t.getSourceFile():t}}})(t);if(m)F(m,m.getSourceFile(),T,v);else for(var k=0,x=v.sourceFiles;k<x.length;k++){var E=x[k];v.cancellationToken.throwIfCancellationRequested(),C(E,T,v)}}return n}},t.prototype.getImportSearches=function(e,t){return this.importTracker||(this.importTracker=D.createImportTracker(this.sourceFiles,this.checker,this.cancellationToken)),this.importTracker(e,t,this.options.isForRename)},t.prototype.createSearch=function(e,t,r,n){var i=(n=void 0===n?{}:n).text,i=void 0===i?A.stripQuotes(A.unescapeLeadingUnderscores((A.getLocalSymbolForExportDefault(t)||t).escapedName)):i,n=n.allSearchSymbols,s=void 0===n?void 0:n,n=A.escapeLeadingUnderscores(i),a=this.options.implementations&&((e,t,r)=>{if((e=(e=>A.isRightSideOfPropertyAccess(e)&&e.parent)(e))&&(r=r.getTypeAtLocation(e.expression)))return r.symbol&&96&r.symbol.flags&&r.symbol!==t.parent?[r.symbol]:196608&r.flags?function e(t,r){void 0===r&&(r=[]);for(var n=0,i=t.types;n<i.length;n++){var s=i[n];s.symbol&&96&s.symbol.getFlags()&&r.push(s.symbol),196608&s.getFlags()&&e(s,r)}return r}(r):void 0})(e,t,this.checker);return{location:e,symbol:t,comingFrom:r,text:i,escapedText:n,parents:a,includes:function(e){return s?A.contains(s,e):e===t}}},t.prototype.referenceAdder=function(e,t){var r=A.getSymbolId(e),n=this.symbolIdToReferences[r];return n||(n=this.symbolIdToReferences[r]=[],this.result.push({definition:{type:"symbol",symbol:e,node:t},references:n})),function(e){return n.push(D.nodeEntry(e))}},t.prototype.addStringOrCommentReference=function(e,t){this.result.push({definition:void 0,references:[{type:"span",fileName:e,textSpan:t}]})},t.prototype.markSearchedSymbol=function(e,t){e=A.getNodeId(e),t=A.getSymbolId(t),e=this.sourceFileToSeenSymbols[e]||(this.sourceFileToSeenSymbols[e]=[]);return!e[t]&&(e[t]=!0)},S=t,e.getReferenceEntriesForShorthandPropertyAssignment=o})(ts=ts||{}),(d=>{var e;function u(e,t,r){var n=[],i=t.getDeclarations(),e=g(e,t,r),s=e.symbolName,a=e.symbolKind,o=e.containerName;return((e,t,r,n,i,s)=>{if((d.isNewExpressionTarget(t)||123===t.kind)&&32&e.flags){for(var a=0,o=e.getDeclarations();a<o.length;a++){var l=o[a];if(d.isClassLike(l))return c(l.members,!0,r,n,i,s)}d.Debug.fail("Expected declaration to have at least one class-like declaration")}})(t,r,a,s,o,n)||((e,t,r,n,i,s)=>(d.isCallExpressionTarget(t)||d.isNewExpressionTarget(t)||d.isNameOfFunctionDeclaration(t))&&c(e.declarations,!1,r,n,i,s))(t,r,a,s,o,n)||d.forEach(i,function(e){n.push(h(e,a,s,o))}),n;function c(e,t,r,n,i,s){if(!e)return!1;for(var a,o=[],l=0,c=e;l<c.length;l++){var u=c[l];(t?152===u.kind:p(u))&&(o.push(u),u.body)&&(a=u)}return!!o.length&&(s.push(h(a||d.lastOrUndefined(o),r,n,i)),!0)}}function p(e){switch(e.kind){case 152:case 228:case 151:case 150:return 1;default:return}}function h(e,t,r,n){return m(d.getNameOfDeclaration(e)||e,t,r,n)}function m(e,t,r,n){var i=e.getSourceFile();return{fileName:i.fileName,textSpan:d.createTextSpanFromNode(e,i),kind:t,name:r,containerKind:void 0,containerName:n}}function g(e,t,r){return{symbolName:e.symbolToString(t),symbolKind:d.SymbolDisplay.getSymbolKind(e,t,r),containerName:t.parent?e.symbolToString(t.parent,r):""}}function f(e,t){for(var r=0,n=e;r<n.length;r++){var i=n[r];if(i.pos<=t&&t<=i.end)return i}}function _(e,t){return{fileName:t,textSpan:d.createTextSpanFromBounds(0,0),kind:"script",name:e,containerName:void 0,containerKind:void 0}}(e=d.GoToDefinition||(d.GoToDefinition={})).getDefinitionAtPosition=function(e,t,r){var n=f(t.referencedFiles,r);if(n&&(s=d.tryResolveScriptReference(e,t,n)))return[_(n.fileName,s.fileName)];if(n=f(t.typeReferenceDirectives,r))return(s=e.getResolvedTypeReferenceDirectives().get(n.fileName))&&s.resolvedFileName&&[_(n.fileName,s.resolvedFileName)];var i=d.getTouchingPropertyName(t,r,!0);if(i!==t){if(d.isJumpStatementTarget(i))return n=i.text,(s=d.getTargetLabel(i.parent,n))?[m(s,"label",n,void 0)]:void 0;var s,a=e.getTypeChecker(),r=((e,t)=>{if(t=(e=>{var t=(e=function e(t){return d.isRightSideOfPropertyAccess(t)?e(t.parent):t}(e)).parent;return t&&d.isCallLikeExpression(t)&&d.getInvokedExpression(t)===e&&t})(t),e=t&&e.getResolvedSignature(t)){t=e.declaration;if(t&&p(t))return t}})(a,i);if(r)return[(t=g(t=a,(s=r).symbol,s),n=t.symbolName,h(s,t.symbolKind,n,t.containerName))];var o,l,c,e=a.getSymbolAtLocation(i);if(e){if(2097152&e.flags&&((e,t)=>{if(71===e.kind){if(e.parent===t)return 1;switch(t.kind){case 239:case 237:return 1;case 242:return 241===t.parent.kind;default:return}}})(i,e.declarations[0])&&(r=a.getAliasedSymbol(e)).declarations&&(e=r),262===i.parent.kind)return(n=a.getShorthandAssignmentValueSymbol(e.valueDeclaration))?(t=n.getDeclarations(),o=d.SymbolDisplay.getSymbolKind(a,n,i),l=a.symbolToString(n),c=a.symbolToString(e.parent,i),d.map(t,function(e){return h(e,o,l,c)})):[];if(d.isPropertyName(i)&&d.isBindingElement(i.parent)&&d.isObjectBindingPattern(i.parent.parent)&&i===(i.parent.propertyName||i.parent.name)){r=a.getTypeAtLocation(i.parent.parent);if(r){n=d.getPropertySymbolsFromType(r,i);if(n)return d.flatMap(n,function(e){return u(a,e,i)})}}t=d.getContainingObjectLiteralElement(i);return t&&a.getContextualType(t.parent)?d.flatMap(d.getPropertySymbolsFromContextualType(a,t),function(e){return u(a,e,i)}):u(a,e,i)}}},e.getTypeDefinitionAtPosition=function(t,e,r){var n=d.getTouchingPropertyName(e,r,!0);if(n!==e){r=t.getSymbolAtLocation(n);if(r){var i,e=t.getTypeOfSymbolAtLocation(r,n);if(e)return 65536&e.flags&&!(16&e.flags)?(i=[],d.forEach(e.types,function(e){e.symbol&&d.addRange(i,u(t,e.symbol,n))}),i):e.symbol?u(t,e.symbol,n):void 0}}}})(ts=ts||{}),(p=>{var e,t,r,n;function s(e,t){if(e)for(var r=0;r<e.length;r++)if(p.indexOf(e,e[r])===r){var n=t(e[r],r);if(n)return}}e=p.JsDoc||(p.JsDoc={}),n=["augments","author","argument","borrows","class","constant","constructor","constructs","default","deprecated","description","event","example","extends","field","fileOverview","function","ignore","inner","lends","link","memberOf","method","name","namespace","param","private","prop","property","public","requires","returns","see","since","static","throws","type","typedef","version"],e.getJsDocCommentsFromDeclarations=function(e){var t=[];return s(e,function(e){p.forEach(p.getAllJSDocs(e),function(e){e.comment&&(t.length&&t.push(p.lineBreakPart()),t.push(p.textPart(e.comment)))})}),t},e.getJsDocTagsFromDeclarations=function(e){var i=[];return s(e,function(e){for(var t=0,r=p.getJSDocTags(e);t<r.length;t++){var n=r[t];276===n.kind&&i.push({name:n.tagName.text,text:n.comment})}}),i},e.getJSDocTagNameCompletions=function(){return t=t||p.map(n,function(e){return{name:e,kind:"keyword",kindModifiers:"",sortText:"0"}})},e.getJSDocTagCompletions=function(){return r=r||p.map(n,function(e){return{name:"@"+e,kind:"keyword",kindModifiers:"",sortText:"0"}})},e.getJSDocParameterNameCompletions=function(r){var n,i,e;return p.isIdentifier(r.name)?(n=r.name.text,e=(i=r.parent).parent,p.isFunctionLike(e)?p.mapDefined(e.parameters,function(e){if(p.isIdentifier(e.name)){var t=e.name.text;if(!i.tags.some(function(e){return e!==r&&p.isJSDocParameterTag(e)&&p.isIdentifier(e.name)&&e.name.escapedText===t})&&(void 0===n||p.startsWith(t,n)))return{name:t,kind:"parameter",kindModifiers:"",sortText:"0"}}}):[]):p.emptyArray},e.getDocCommentTemplateAtPosition=function(e,t,r){if(!(p.isInString(t,r)||p.isInComment(t,r)||p.hasDocComment(t,r))){var n=p.getTokenAtPosition(t,r,!1),i=n.getStart();if(n&&!(i<r)){n=(e=>{for(var t=e;t;t=t.parent)switch(t.kind){case 228:case 151:case 152:var r=t.parameters;return{commentOwner:t,parameters:r};case 229:return{commentOwner:t};case 208:var r=t.declarationList.declarations,n=1===r.length&&r[0].initializer?(e=>{for(;185===e.kind;)e=e.expression;switch(e.kind){case 186:case 187:return e.parameters;case 199:for(var t=0,r=e.members;t<r.length;t++){var n=r[t];if(152===n.kind)return n.parameters}}return p.emptyArray})(r[0].initializer):void 0;return{commentOwner:t,parameters:n};case 265:return;case 233:return 233===t.parent.kind?void 0:{commentOwner:t};case 194:var i,n=t;return 0===p.getSpecialPropertyAssignmentKind(n)?void 0:(i=p.isFunctionLike(n.right)?n.right.parameters:p.emptyArray,{commentOwner:t,parameters:i})}})(n);if(n){var s=n.commentOwner,a=n.parameters;if(!(s.getStart()<r)){var n=t.getLineAndCharacterOfPosition(r),s=t.getLineStarts()[n.line],o=t.text.substr(s,n.character).replace(/\S/i,function(){return" "}),l=p.hasJavaScriptFileExtension(t.fileName),c="";if(a)for(var u=0;u<a.length;u++){var d=a[u].name,d=71===d.kind?d.escapedText:"param"+u;c+=l?o+" * @param {any} "+d+e:o+" * @param "+d+e}s="/**"+e+o+" * ";return{newText:s+e+c+o+" */"+(i===r?e+o:""),caretOffset:s.length}}}}}}})(ts=ts||{}),(v=>{var e=v.JsTyping||(v.JsTyping={});e.nodeCoreModuleList=["buffer","querystring","events","http","cluster","zlib","os","https","punycode","repl","readline","vm","child_process","url","dns","net","dgram","fs","path","string_decoder","tls","crypto","stream","util","assert","tty","domain","constants","process","v8","timers","console"];var t,T=v.arrayToSet(e.nodeCoreModuleList);e.loadSafeList=function(t,e){return e=v.readConfigFile(e,function(e){return t.readFile(e)}),v.createMapFromTemplate(e.config)},e.loadTypesMap=function(t,e){if((e=v.readConfigFile(e,function(e){return t.readFile(e)})).config)return v.createMapFromTemplate(e.config.simpleMap)},e.discoverTypings=function(l,c,e,t,r,n,i,s){if(!i||!i.enable)return{cachedTypingPaths:[],newTypingNames:[],filesToWatch:[]};var u=v.createMap(),a=(e=v.mapDefined(e,function(e){e=v.normalizePath(e);if(v.hasJavaScriptFileExtension(e))return e}),[]),i=(i.include&&_(i.include,"Explicitly included types"),i.exclude||[]),o=v.arrayToSet(e,v.getDirectoryPath),t=(o.set(t,!0),o.forEach(function(e,t){y(v.combinePaths(t,"package.json"),a);var r=v.combinePaths(t,"bower.json");y(r,a);b(v.combinePaths(t,"bower_components"),a);r=v.combinePaths(t,"node_modules");b(r,a)}),e);(o=v.mapDefined(t,function(e){if(v.hasJavaScriptFileExtension(e))return e=v.removeFileExtension(v.getBaseFileName(e.toLowerCase())).replace(/((?:\.|-)min(?=\.|$))|((?:-|\.)\d+)/g,""),r.get(e)})).length&&_(o,"Inferred typings from file names"),v.some(t,function(e){return v.fileExtensionIs(e,".jsx")})&&(c&&c("Inferred 'react' typings due to presence of '.jsx' extension"),f("react")),s&&_(v.deduplicate(s.map(function(e){return T.has(e)?"node":e})),"Inferred typings from unresolved imports"),n.forEach(function(e,t){u.has(t)&&void 0===u.get(t)&&u.set(t,e)});for(var d=0,p=i;d<p.length;d++){var h=p[d];u.delete(h)&&c&&c("Typing for "+h+" is in exclude list, will be ignored.")}var m=[],g=[],e=(u.forEach(function(e,t){void 0!==e?g.push(e):m.push(t)}),{cachedTypingPaths:g,newTypingNames:m,filesToWatch:a});return c&&c("Result: "+JSON.stringify(e)),e;function f(e){u.has(e)||u.set(e,void 0)}function _(e,t){c&&c(t+": "+JSON.stringify(e)),v.forEach(e,f)}function y(e,t){l.fileExists(e)&&(t.push(e),t=v.readConfigFile(e,function(e){return l.readFile(e)}).config,_(v.flatMap([t.dependencies,t.devDependencies,t.optionalDependencies,t.peerDependencies],v.getOwnKeys),"Typing names in '"+e+"' dependencies"))}function b(e,t){if(t.push(e),l.directoryExists(e)){for(var t=l.readDirectory(e,[".json"],void 0,void 0,2),r=(c&&c("Searching for typing names in "+e+"; all files: "+JSON.stringify(t)),[]),n=0,i=t;n<i.length;n++){var s,a=i[n],a=v.normalizePath(a),o=v.getBaseFileName(a);"package.json"!==o&&"bower.json"!==o||(s=v.readConfigFile(a,function(e){return l.readFile(e)}).config,"package.json"===o&&s._requiredBy&&0===v.filter(s._requiredBy,function(e){return"#"===e[0]||"/"===e}).length)||s.name&&((o=s.types||s.typings)?(o=v.getNormalizedAbsolutePath(o,v.getDirectoryPath(a)),c&&c("    Package '"+s.name+"' provides its own types."),u.set(s.name,o)):r.push(s.name))}_(r,"    Found package names")}}},(t=e.PackageNameValidationResult||(e.PackageNameValidationResult={}))[t.Ok=0]="Ok",t[t.ScopedPackagesNotSupported=1]="ScopedPackagesNotSupported",t[t.EmptyName=2]="EmptyName",t[t.NameTooLong=3]="NameTooLong",t[t.NameStartsWithDot=4]="NameStartsWithDot",t[t.NameStartsWithUnderscore=5]="NameStartsWithUnderscore",t[t.NameContainsNonURISafeCharacters=6]="NameContainsNonURISafeCharacters",e.validatePackageName=function(e){return e?214<e.length?3:46===e.charCodeAt(0)?4:95===e.charCodeAt(0)?5:/^@[^/]+\/[^/]+$/.test(e)?1:encodeURIComponent(e)!==e?6:0:2},e.renderPackageNameValidationFailure=function(e,t){switch(e){case 2:return"Package name '"+t+"' cannot be empty";case 3:return"Package name '"+t+"' should be less than 214 characters";case 4:return"Package name '"+t+"' cannot start with '.'";case 5:return"Package name '"+t+"' cannot start with '_'";case 1:return"Package '"+t+"' is scoped and currently is not supported";case 6:return"Package name '"+t+"' contains non URI safe characters";case 0:throw v.Debug.fail();default:v.Debug.assertNever(e)}}})(ts=ts||{}),(_=>{function y(e,t,r){var n=_.getTextOfIdentifierOrLiteral(e);return void 0!==n?(r&&t.unshift(n),!0):179===e.kind&&(n=e,r&&t.unshift(n.name.text),y(n.expression,t,!0))}function l(e,t){return e.matchKind-t.matchKind||_.compareStringsCaseInsensitive(e.name,t.name)||_.compareStrings(e.name,t.name)}function c(e){var t=e.declaration,r=_.getContainerNode(t),n=r&&_.getNameOfDeclaration(r);return{name:e.name,kind:_.getNodeKind(t),kindModifiers:_.getNodeModifiers(t),matchKind:_.PatternMatchKind[e.matchKind],isCaseSensitive:e.isCaseSensitive,fileName:e.fileName,textSpan:_.createTextSpanFromNode(t),containerName:n?n.text:"",containerKind:n?_.getNodeKind(r):""}}(_.NavigateTo||(_.NavigateTo={})).getNavigateToItems=function(e,m,t,r,n,i){for(var g=_.createPatternMatcher(r),f=[],s=function(h){if(t.throwIfCancellationRequested(),i&&_.fileExtensionIs(h.fileName,".d.ts"))return"continue";_.forEachEntry(h.getNamedDeclarations(),function(e,t){var r=g,n=t,t=e,i=m,s=h.fileName,a=f,o=r.getMatchesForLastSegmentOfPattern(n);if(o)for(var l=0,c=t;l<c.length;l++){var u,d,p=c[l];((e,t)=>{switch(e.kind){case 239:case 242:case 237:var r=t.getSymbolAtLocation(e.name),n=t.getAliasedSymbol(r);return r.escapedName!==n.escapedName;default:return 1}})(p,i)&&(d=o,r.patternContainsDots&&!(d=r.getMatches((e=>{var t=[],r=_.getNameOfDeclaration(e);if(144!==r.kind||y(r.expression,t,!1)){for(e=_.getContainerNode(e);e;){if(!((e,t)=>{if(e){e=_.getNameOfDeclaration(e);if(e){var r=_.getTextOfIdentifierOrLiteral(e);if(void 0===r)return 144===e.kind&&y(e.expression,t,!0);t.unshift(r)}}return 1})(e,t))return;e=_.getContainerNode(e)}return t}})(p),n))||(u=(e=>{_.Debug.assert(0<e.length);for(var t=_.PatternMatchKind.camelCase,r=0,n=e;r<n.length;r++){var i=n[r].kind;i<t&&(t=i)}return t})(d),d=(e=>{_.Debug.assert(0<e.length);for(var t=0,r=e;t<r.length;t++)if(!r[t].isCaseSensitive)return!1;return!0})(d),a.push({name:n,fileName:s,matchKind:u,isCaseSensitive:d,declaration:p})))}})},a=0,o=e;a<o.length;a++)s(o[a]);return f.sort(l),(f=void 0!==n?f.slice(0,n):f).map(c)}})(ts=ts||{}),(m=>{var e,g,n,i,t,s,r;function a(){s=[],i=g=n=void 0,r=[]}function u(e){return e.getText(n)}function o(e){return e.node.kind}function l(e,t){e.children?e.children.push(t):e.children=[t]}function c(e){m.Debug.assert(!s.length);var t={node:e,additionalNodes:void 0,parent:void 0,children:void 0,indent:0};i=t;for(var r=0,n=e.statements;r<n.length;r++)v(n[r]);return y(),m.Debug.assert(!i&&!s.length),t}function f(e){l(i,d(e))}function d(e){return{node:e,additionalNodes:void 0,parent:i,children:void 0,indent:i.indent+1}}function _(e){e=d(e);l(i,e),s.push(i),i=e}function y(){i.children&&(!function n(e){var o=m.createMap();m.filterMutate(e,function(e){var t=m.getNameOfDeclaration(e.node),t=t&&u(t);if(!t)return!0;var r=o.get(t);if(!r)return o.set(t,e),!0;if(r instanceof Array){for(var n=0,i=r;n<i.length;n++){var s=i[n];if(a(s,e))return!1}return r.push(e),!0}return!a(s=r,e)&&(o.set(t,[s,e]),!0);function a(e,t){return!!l(e.node,t.node)&&(c(e,t),!0)}});function l(e,t){return e.kind===t.kind&&(233!==e.kind||r(e,t));function r(e,t){return e.body.kind===t.body.kind&&(233!==e.body.kind||r(e.body,t.body))}}function c(e,t){var r;e.additionalNodes=e.additionalNodes||[],e.additionalNodes.push(t.node),t.additionalNodes&&(r=e.additionalNodes).push.apply(r,t.additionalNodes),e.children=m.concatenate(e.children,t.children),e.children&&(n(e.children),p(e.children))}}(i.children),p(i.children)),i=s.pop()}function b(e,t){_(e),v(t),y()}function v(e){var t;if(g.throwIfCancellationRequested(),e&&!m.isToken(e))switch(e.kind){case 152:var r=e;b(r,r.body);for(var n=0,i=r.parameters;n<i.length;n++){var s=i[n];m.isParameterPropertyDeclaration(s)&&f(s)}break;case 151:case 153:case 154:case 150:m.hasDynamicName(e)||b(e,e.body);break;case 149:case 148:m.hasDynamicName(e)||f(e);break;case 239:r=e,r=(r.name&&f(r),r.namedBindings);if(r)if(240===r.kind)f(r);else for(var a=0,o=r.elements;a<o.length;a++)f(o[a]);break;case 176:case 226:var r=e.name,l=e.initializer;m.isBindingPattern(r)?v(r):l&&(e=>{switch(e.kind){case 187:case 186:case 199:return 1;default:return}})(l)?l.name?v(l):(_(e),m.forEachChild(l,v),y()):b(e,l);break;case 187:case 228:case 186:b(e,e.body);break;case 232:_(e);for(var c=0,u=e.members;c<u.length;c++){var d=u[c];(t=d).name&&144!==t.name.kind&&f(d)}y();break;case 229:case 199:case 230:_(e);for(var p=0,h=e.members;p<h.length;p++)v(d=h[p]);y();break;case 233:b(e,function e(t){return 233===t.body.kind?e(t.body):t}(e).body);break;case 246:case 237:case 157:case 155:case 156:case 231:f(e);break;default:m.hasJSDocNodes(e)&&m.forEach(e.jsDoc,function(e){m.forEach(e.tags,function(e){283===e.kind&&f(e)})}),m.forEachChild(e,v)}}function p(e){e.sort(h)}function h(e,t){var r,n=T(e.node),i=T(t.node);return n&&i?0!==(r=m.compareStringsCaseInsensitive(n,i))?r:o(e)-o(t):n?1:i?-1:o(e)-o(t)}function T(e){if(233===e.kind)return w(e);var t=m.getNameOfDeclaration(e);if(t)return m.unescapeLeadingUnderscores(m.getPropertyNameForPropertyNameNode(t));switch(e.kind){case 186:case 187:case 199:return D(e);case 283:return x(e);default:return}}function k(e){if(233===e.kind)return w(e);var t=m.getNameOfDeclaration(e);if(t){t=u(t);if(0<t.length)return t}switch(e.kind){case 265:var r=e;return m.isExternalModule(r)?'"'+m.escapeString(m.getBaseFileName(m.removeFileExtension(m.normalizePath(r.fileName))))+'"':"<global>";case 187:case 228:case 186:case 229:case 199:return 512&m.getModifierFlags(e)?"default":D(e);case 152:return"constructor";case 156:return"new()";case 155:return"()";case 157:return"[]";case 283:return x(e);default:return"<unknown>"}}function x(e){if(e.name)return e.name.text;e=e.parent&&e.parent.parent;if(e&&208===e.kind&&0<e.declarationList.declarations.length){e=e.declarationList.declarations[0].name;if(71===e.kind)return e.text}return"<typedef>"}function E(e){return{text:k(e.node),kind:m.getNodeKind(e.node),kindModifiers:A(e.node),spans:C(e),childItems:m.map(e.children,E)}}function S(e){return{text:k(e.node),kind:m.getNodeKind(e.node),kindModifiers:A(e.node),spans:C(e),childItems:m.map(e.children,function(e){return{text:k(e.node),kind:m.getNodeKind(e.node),kindModifiers:m.getNodeModifiers(e.node),spans:C(e),childItems:r,indent:0,bolded:!1,grayed:!1}})||r,indent:e.indent,bolded:!1,grayed:!1}}function C(e){var t=[I(e.node)];if(e.additionalNodes)for(var r=0,n=e.additionalNodes;r<n.length;r++){var i=n[r];t.push(I(i))}return t}function w(e){if(m.isAmbientModule(e))return m.getTextOfNode(e.name);var t=[];for(t.push(m.getTextOfIdentifierOrLiteral(e.name));e.body&&233===e.body.kind;)t.push(m.getTextOfIdentifierOrLiteral((e=e.body).name));return t.join(".")}function I(e){return 265===e.kind?m.createTextSpanFromBounds(e.getFullStart(),e.getEnd()):m.createTextSpanFromNode(e,n)}function A(e){return e.parent&&226===e.parent.kind&&(e=e.parent),m.getNodeModifiers(e)}function D(e){return e.name&&0<m.getFullWidth(e.name)?m.declarationNameToString(e.name):226===e.parent.kind?m.declarationNameToString(e.parent.name):194===e.parent.kind&&58===e.parent.operatorToken.kind?u(e.parent.left).replace(t,""):261===e.parent.kind&&e.parent.name?u(e.parent.name):512&m.getModifierFlags(e)?"default":m.isClassLike(e)?"<class>":"<function>"}e=m.NavigationBar||(m.NavigationBar={}),t=/\s+/g,s=[],r=[],e.getNavigationBarItems=function(e,t){g=t,n=e;try{return m.map((r=c(e),i=[],function e(t){if((e=>{switch(o(e)){case 229:case 199:case 232:case 230:case 233:case 265:case 231:case 283:return 1;case 152:case 151:case 153:case 154:case 226:return t(e);case 187:case 228:case 186:return(e=>{if(e.node.body)switch(o(e.parent)){case 234:case 265:case 151:case 152:return 1;default:return t(e)}})(e);default:return}function t(e){return m.forEach(e.children,function(e){return 226!==(e=o(e))&&176!==e})}})(t)&&(i.push(t),t.children))for(var r=0,n=t.children;r<n.length;r++)e(n[r])}(r),i),S)}finally{a()}var r,i},e.getNavigationTree=function(e,t){g=t,n=e;try{return E(c(e))}finally{a()}}})(ts=ts||{}),(f=>{var e,_;e=f.OutliningElementsCollector||(f.OutliningElementsCollector={}),_=new RegExp("^\\s*//\\s*#(end)?region(?:\\s+(.*))?$"),e.collectElements=function(l,c){var a=[],o=0,e=[];!function e(t){c.throwIfCancellationRequested();if(40<o)return;f.isDeclaration(t)&&h(t);switch(t.kind){case 207:if(!f.isFunctionBlock(t)){var r=t.parent,n=f.findChildOfKind(t,17,l),i=f.findChildOfKind(t,18,l);if(212===r.kind||215===r.kind||216===r.kind||214===r.kind||211===r.kind||213===r.kind||220===r.kind||260===r.kind){d(r,n,i,g(t),!0);break}if(224===r.kind){var s=r;if(s.tryBlock===t){d(r,n,i,g(t),!0);break}if(s.finallyBlock===t){r=f.findChildOfKind(s,87,l);if(r){d(r,n,i,g(t),!0);break}}}s=f.createTextSpanFromNode(t);a.push({textSpan:s,hintSpan:s,bannerText:"...",autoCollapse:g(t)});break}case 234:r=f.findChildOfKind(t,17,l),n=f.findChildOfKind(t,18,l);d(t.parent,r,n,g(t),!0);break;case 229:case 230:case 232:case 235:i=f.findChildOfKind(t,17,l),s=f.findChildOfKind(t,18,l);d(t,i,s,g(t),!0);break;case 178:r=f.findChildOfKind(t,17,l),n=f.findChildOfKind(t,18,l);d(t,r,n,g(t),!f.isArrayLiteralExpression(t.parent));break;case 177:i=f.findChildOfKind(t,21,l),s=f.findChildOfKind(t,22,l);d(t,i,s,g(t),!f.isArrayLiteralExpression(t.parent))}o++;f.forEachChild(t,e);o--}(l);for(var t=l.getLineStarts(),r=0;r<t.length;r++){var n,i=t[r],s=t[r+1]-1||l.getEnd(),u=l.text.substring(i,s).match(_);u&&!f.isInComment(l,i)&&(u[1]?(n=e.pop())&&(n.textSpan.length=s-n.textSpan.start,n.hintSpan.length=s-n.textSpan.start,a.push(n)):(i=l.getFullText().indexOf("//",i),i=f.createTextSpanFromBounds(i,s),n={textSpan:i,hintSpan:i,bannerText:u[2]||"#region",autoCollapse:!1},e.push(n)))}return a.sort(function(e,t){return e.textSpan.start-t.textSpan.start});function d(e,t,r,n,i){e&&t&&r&&(i={textSpan:f.createTextSpanFromBounds(i?t.getFullStart():t.getStart(),r.getEnd()),hintSpan:f.createTextSpanFromNode(e,l),bannerText:"...",autoCollapse:n},a.push(i))}function p(e,t){e&&(e={textSpan:f.createTextSpanFromBounds(e.pos,e.end),hintSpan:f.createTextSpanFromBounds(e.pos,e.end),bannerText:"...",autoCollapse:t},a.push(e))}function h(e){e=f.getLeadingCommentRangesOfNode(e,l);if(e){for(var t=-1,r=-1,n=!0,i=0,s=0,a=e;s<a.length;s++){var o=a[s];c.throwIfCancellationRequested(),2===o.kind?(n&&(t=o.pos),n=!1,r=o.end,i++):3===o.kind&&(m(i,t,r),p(o,!1),r=-1,n=!(i=0))}m(i,t,r)}}function m(e,t,r){1<e&&p({kind:2,pos:t,end:r},!1)}function g(e){return f.isFunctionBlock(e)&&187!==e.parent.kind}}})(ts=ts||{}),(m=>{var p,e;function g(e,t,r,n){return{kind:e,punctuationStripped:t,isCaseSensitive:r,camelCaseWeight:n}}function n(e){return 0===e.subWordTextChunks.length}function f(e){return 65<=e&&e<=90||!(e<127||!m.isUnicodeIdentifierStart(e,5))&&(e=String.fromCharCode(e))===e.toUpperCase()}function _(e){return 97<=e&&e<=122||!(e<127||!m.isUnicodeIdentifierStart(e,5))&&(e=String.fromCharCode(e))===e.toLowerCase()}function y(e){return 65<=e&&e<=90?e-65+97:e<127?e:String.fromCharCode(e).toLowerCase().charCodeAt(0)}function b(e){return 48<=e&&e<=57}function s(e){var t=e.toLowerCase();return{text:e,textLowerCase:t,isLowerCase:e===t,characterSpans:r(e)}}function r(e){return t(e,!1)}function i(e){return t(e,!0)}function t(e,t){for(var r,n,i=[],s=0,a=1;a<e.length;a++){var o=b(e.charCodeAt(a-1)),l=b(e.charCodeAt(a)),c=(u=t,c=a,n=void 0,n=f((r=e).charCodeAt(c-1)),r=f(r.charCodeAt(c)),u?r&&!n:r),u=((e,t,r,n)=>{if(t&&r!==n&&r+1<e.length){var t=f(e.charCodeAt(r)),i=_(e.charCodeAt(r+1));if(t&&i){for(var s=n;s<r;s++)if(!f(e.charCodeAt(s)))return!1;return!0}}return!1})(e,t,a,s);(d(e.charCodeAt(a-1))||d(e.charCodeAt(a))||o!==l||c||u)&&(h(e,s,a)||i.push(m.createTextSpan(s,a-s)),s=a)}return h(e,s,e.length)||i.push(m.createTextSpan(s,e.length-s)),i}function d(e){switch(e){case 33:case 34:case 35:case 37:case 38:case 39:case 40:case 41:case 42:case 44:case 45:case 46:case 47:case 58:case 59:case 63:case 64:case 91:case 92:case 93:case 95:case 123:case 125:return 1}}function h(e,t,r){for(var n=t;n<r;n++){var i=e.charCodeAt(n);if(!d(i)||95===i||36===i)return}return 1}(e=p=m.PatternMatchKind||(m.PatternMatchKind={}))[e.exact=0]="exact",e[e.prefix=1]="prefix",e[e.substring=2]="substring",e[e.camelCase=3]="camelCase",m.createPatternMatcher=function(e){var r=m.createMap(),a=(e=e.trim()).split(".").map(function(e){return{totalTextChunk:s(e=e.trim()),subWordTextChunks:(e=>{for(var t=[],r=0,n=0,i=0;i<e.length;i++)(e=>f(e)||_(e)||b(e)||95===e||36===e)(e.charCodeAt(i))?(0===n&&(r=i),n++):0<n&&(t.push(s(e.substr(r,n))),n=0);return 0<n&&t.push(s(e.substr(r,n))),t})(e)}}),t=0===a.length||m.forEach(a,n);return{getMatches:function(e,t){if(o(t))return;t=c(t,m.lastOrUndefined(a));if(!t)return;if(e=e||[],a.length-1>e.length)return;for(var r=t,n=a.length-2,i=e.length-1;0<=n;--n,--i){var s=a[n],s=c(e[i],s);if(!s)return;m.addRange(r,s)}return r},getMatchesForLastSegmentOfPattern:function(e){if(o(e))return;return c(e,m.lastOrUndefined(a))},patternContainsDots:1<a.length};function o(e){return t||!e}function u(e){var t=r.get(e);return t||r.set(e,t=i(e)),t}function l(e,t,r){var n=((e,t)=>{for(var r=e.length-t.length,n=0;n<=r;n++)if(((e,t,r)=>{for(var n=0;n<t.length;n++){var i=y(e.charCodeAt(n+r)),s=t.charCodeAt(n);if(i!==s)return}return 1})(e,t,n))return n;return-1})(e,t.textLowerCase);if(0===n)return t.text.length===e.length?g(p.exact,r,e===t.text):g(p.prefix,r,m.startsWith(e,t.text));var i=t.isLowerCase;if(i){if(0<n)for(var s=0,a=u(e);s<a.length;s++){var o=a[s];if(h(e,o,t.text,!0))return g(p.substring,r,h(e,o,t.text,!1))}}else if(0<e.indexOf(t.text))return g(p.substring,r,!0);if(!i&&0<t.characterSpans.length){var l=u(e),c=d(e,l,t,!1);if(void 0!==c)return g(p.camelCase,r,!0,c);if(void 0!==(c=d(e,l,t,!0)))return g(p.camelCase,r,!1,c)}return i&&t.text.length<e.length&&0<n&&f(e.charCodeAt(n))?g(p.substring,r,!1):void 0}function c(e,t){if(!(e=>{for(var t=0;t<e.length;t++){var r=e.charCodeAt(t);if(32===r||42===r)return 1}})(t.totalTextChunk.text)){var r=l(e,t.totalTextChunk,!1);if(r)return[r]}for(var n=void 0,i=0,s=t.subWordTextChunks;i<s.length;i++){var a=l(e,s[i],!0);if(!a)return;(n=n||[]).push(a)}return n}function h(e,t,r,n,i){var s=i?i.start:0,a=(i||r).length;if(a>t.length)return!1;if(n)for(var o=0;o<a;o++){var l=r.charCodeAt(s+o),c=e.charCodeAt(t.start+o);if(y(l)!==y(c))return!1}else for(o=0;o<a;o++)if((l=r.charCodeAt(s+o))!==(c=e.charCodeAt(t.start+o)))return!1;return!0}function d(e,t,r,n){for(var i,s=r.characterSpans,a=0,o=0,l=void 0,c=void 0;;){if(o===s.length)return i=0,c&&(i+=1),0===l&&(i+=2),i;if(a===t.length)return;for(var u=t[a],d=!1;o<s.length;o++){var p=s[o];if(d&&(!f(r.text.charCodeAt(s[o-1].start))||!f(r.text.charCodeAt(s[o].start))))break;if(!h(e,u,r.text,n,p))break;d=!0,l=void 0===l?a:l,c=void 0===c||c,u=m.createTextSpan(u.start+p.length,u.length-p.length)}d||void 0===c||(c=!1),a++}}},m.breakIntoCharacterSpans=r,m.breakIntoWordSpans=i})(ts=ts||{}),(x=>{x.preProcessFile=function(r,e,t){void 0===t&&(t=!1);var n,i=[],s=[],a=[],o=!1,l=0,c=!1;function u(){var e=x.scanner.scan();return 17===e?l++:18===e&&l--,e}function d(){var e=x.scanner.getTokenValue(),t=x.scanner.getTokenPos();return{fileName:e,pos:t,end:t+e.length}}function p(){a.push(d()),h()}function h(){0===l&&(c=!0)}function m(){return 124===x.scanner.getToken()&&(128===u()&&9===u()&&(n=n||[]).push({ref:d(),depth:l}),1)}function g(e){return 132===(e?u():x.scanner.getToken())&&(19===u()&&9===u()&&p(),1)}function f(){for(x.scanner.setText(r),u();;){if(1===x.scanner.getToken())break;m()||(()=>{var e=x.scanner.getToken();if(91===e){if(19===(e=u())){if(9===(e=u()))p()}else{if(9===e)return p(),1;if(71===e||x.isKeyword(e))if(140===(e=u())){if(9===(e=u()))return p(),1}else if(58===e){if(g(!0))return 1}else{if(26!==e)return 1;e=u()}if(17===e){for(e=u();18!==e&&1!==e;)e=u();18===e&&140===(e=u())&&9===(e=u())&&p()}else 39!==e||118!==(e=u())||71!==(e=u())&&!x.isKeyword(e)||140!==(e=u())||9!==(e=u())||p()}return 1}})()||(()=>{var e=x.scanner.getToken();if(84===e){if(h(),17===(e=u())){for(e=u();18!==e&&1!==e;)e=u();18===e&&140===(e=u())&&9===(e=u())&&p()}else if(39===e)140===(e=u())&&9===(e=u())&&p();else if(91===e&&(71===(e=u())||x.isKeyword(e))&&58===(e=u())&&g(!0));return 1}})()||t&&(g(!1)||(()=>{var e=x.scanner.getToken();if(71===e&&"define"===x.scanner.getTokenValue()){if(19===(e=u())){if(9===(e=u())){if(26!==(e=u()))return 1;e=u()}if(21===e)for(e=u();22!==e&&1!==e;)9===e&&p(),e=u()}return 1}})())||u()}x.scanner.setText(void 0)}if((e=void 0===e?!0:e)&&f(),e=x.getLeadingCommentRanges(r,0),x.forEach(e,function(e){var t=r.substring(e.pos,e.end),t=x.getFileReferenceFromReferencePath(t,e);t&&(o=t.isNoDefaultLib,e=t.fileReference)&&(t.isTypeReferenceDirective?s:i).push(e)}),c){if(n)for(var _=0,y=n;_<y.length;_++){var b=y[_];a.push(b.ref)}return{referencedFiles:i,typeReferenceDirectives:s,importedFiles:a,isLibFile:o,ambientExternalModules:void 0}}var v=void 0;if(n)for(var T=0,k=n;T<k.length;T++)0===(b=k[T]).depth?(v=v||[]).push(b.ref.fileName):a.push(b.ref);return{referencedFiles:i,typeReferenceDirectives:s,importedFiles:a,isLibFile:o,ambientExternalModules:v}}})(ts=ts||{}),(o=>{function l(e,t,r,n,i,s){return{canRename:!0,kind:r,displayName:e,localizedErrorMessage:void 0,fullDisplayName:t,kindModifiers:n,triggerSpan:((e,t)=>{var r=e.getStart(t),t=e.getWidth(t);return 9===e.kind&&(r+=1,t-=2),o.createTextSpan(r,t)})(i,s)}}function c(e){return{canRename:!1,localizedErrorMessage:o.getLocaleSpecificMessage(e),displayName:void 0,fullDisplayName:void 0,kind:void 0,kindModifiers:void 0,triggerSpan:void 0}}(o.Rename||(o.Rename={})).getRenameInfo=function(e,t,r,n,i){var s=o.memoize(function(){return r(o.normalizePath(t))});return((i=o.getTouchingWord(n,i,!0))&&(e=>{switch(e.kind){case 71:case 9:case 99:return 1;case 8:return o.isLiteralNameOfPropertyDeclarationOrIndexAccess(e);default:return}})(i)?((e,t,r,n)=>{var i,s=t.getSymbolAtLocation(e);if(s){var a=s.getDeclarations();if(a&&0<a.length)return o.some(a,n)?c(o.Diagnostics.You_cannot_rename_elements_that_are_defined_in_the_standard_TypeScript_library):!(71===e.kind&&79===e.originalKeywordKind&&1536&s.parent.flags)&&(i=o.stripQuotes(o.getDeclaredName(t,s,e)),a=o.SymbolDisplay.getSymbolKind(t,s,e))?l(i,t.getFullyQualifiedName(s),a,o.SymbolDisplay.getSymbolModifiers(s),e,r):void 0}else if(9===e.kind)return n(e)?c(o.Diagnostics.You_cannot_rename_elements_that_are_defined_in_the_standard_TypeScript_library):l(i=o.stripQuotes(e.text),i,"var","",e,r)})(i,e,n,function(e){return!!t&&(e=e.getSourceFile(),r(o.normalizePath(e.fileName))===s())}):void 0)||c(o.Diagnostics.You_cannot_rename_this_element)}})(ts=ts||{}),(_=>{var e,t;function s(e,t,r){if(_.isCallOrNewExpression(e.parent)){var n=e.parent,i=void 0,s=void 0;if(27===e.kind||19===e.kind)i=((e,t,r)=>(e=e.getChildren(r),r=e.indexOf(t),_.Debug.assert(0<=r&&e.length>r+1),e[r+1]))(n,e,r),_.Debug.assert(void 0!==i),s=0;else{if(!(i=_.findContainingList(e)))return;s=((e,t)=>{for(var r=0,e=e.getChildren(),n=0,i=e;n<i.length;n++){var s=i[n];if(s===t)break;26!==s.kind&&r++}return r})(i,e)}var a=n.typeArguments&&n.typeArguments.pos===i.pos?0:1,o=(e=>{var e=e.getChildren(),t=_.countWhere(e,function(e){return 26!==e.kind});return 0<e.length&&26===_.lastOrUndefined(e).kind&&t++,t})(i);return 0!==s&&_.Debug.assertLessThan(s,o),u=r,d=(i=i).getFullStart(),u=_.skipTrivia(u.text,i.getEnd(),!1),{kind:a,invocation:n,argumentsSpan:_.createTextSpan(d,u-d),argumentIndex:s,argumentCount:o}}if(13===e.kind&&183===e.parent.kind){if(_.isInsideTemplateLiteral(e,t))return p(e.parent,0,r)}else{var l,c;if(14===e.kind&&183===e.parent.parent.kind)return c=(l=e.parent).parent,_.Debug.assert(196===l.kind),p(c,s=_.isInsideTemplateLiteral(e,t)?0:1,r);if(205===e.parent.kind&&183===e.parent.parent.parent.kind)return c=(l=(i=e.parent).parent).parent,_.Debug.assert(196===l.kind),16!==e.kind||_.isInsideTemplateLiteral(e,t)?p(c,s=((e,t,r)=>(_.Debug.assert(r>=t.getStart(),"Assumed 'position' could not occur before node."),_.isTemplateLiteralKind(t.kind)?_.isInsideTemplateLiteral(t,r)?0:e+2:e+1))(l.templateSpans.indexOf(i),e,t),r):void 0;if(e.parent&&_.isJsxOpeningLikeElement(e.parent))return a=e.parent.attributes.getFullStart(),n=_.skipTrivia(r.text,e.parent.attributes.getEnd(),!1),{kind:3,invocation:e.parent,argumentsSpan:_.createTextSpan(a,n-a),argumentIndex:0,argumentCount:1}}var u,d}function p(e,t,r){var n=13===e.template.kind?1:e.template.templateSpans.length+1;return 0!==t&&_.Debug.assertLessThan(t,n),{kind:2,invocation:e,argumentsSpan:((e,t)=>{var r=(e=e.template).getStart(),n=e.getEnd();return 196===e.kind&&0===_.lastOrUndefined(e.templateSpans).literal.getFullWidth()&&(n=_.skipTrivia(t.text,n,!1)),_.createTextSpan(r,n-r)})(e,r),argumentIndex:t,argumentCount:n}}function y(e,t,r){for(var n=e;265!==n.kind;n=n.parent){if(_.isFunctionBlock(n))return;(n.pos<n.parent.pos||n.end>n.parent.end)&&_.Debug.fail("Node of kind "+n.kind+" is not a subspan of its parent of kind "+n.parent.kind);var i=s(n,t,r);if(i)return i}}function b(e,t,r,a){var n=r.argumentCount,i=r.argumentsSpan,o=r.invocation,s=r.argumentIndex,l=0===r.kind,r=_.getInvokedExpression(o),r=a.getSymbolAtLocation(r),c=r&&_.symbolToDisplayParts(a,r,void 0,void 0),r=_.map(e,function(t){var e,r,n=[],i=[],s=(c&&_.addRange(n,c),l?(r=!1,n.push(_.punctuationPart(27)),e=(e=(t.target||t).typeParameters)&&0<e.length?_.map(e,d):_.emptyArray,i.push(_.punctuationPart(29)),s=_.mapToDisplayParts(function(e){return a.getSymbolDisplayBuilder().buildDisplayForParametersAndDelimiters(t.thisParameter,t.parameters,e,o)}),_.addRange(i,s)):(r=t.hasRestParameter,s=_.mapToDisplayParts(function(e){return a.getSymbolDisplayBuilder().buildDisplayForTypeParametersAndDelimiters(t.typeParameters,e,o)}),_.addRange(n,s),n.push(_.punctuationPart(19)),e=_.map(t.parameters,u),i.push(_.punctuationPart(20))),_.mapToDisplayParts(function(e){return a.getSymbolDisplayBuilder().buildReturnTypeDisplay(t,e,o)}));return _.addRange(i,s),{isVariadic:r,prefixDisplayParts:n,suffixDisplayParts:i,separatorDisplayParts:[_.punctuationPart(26),_.spacePart()],parameters:e,documentation:t.getDocumentationComment(),tags:t.getJsDocTags()}}),e=(0!==s&&_.Debug.assertLessThan(s,n),e.indexOf(t));return _.Debug.assert(-1!==e),{items:r,applicableSpan:i,selectedItemIndex:e,argumentIndex:s,argumentCount:n};function u(t){var e=_.mapToDisplayParts(function(e){return a.getSymbolDisplayBuilder().buildParameterDisplay(t,e,o)});return{name:t.name,documentation:t.getDocumentationComment(),displayParts:e,isOptional:a.isOptionalParameter(t.valueDeclaration)}}function d(t){var e=_.mapToDisplayParts(function(e){return a.getSymbolDisplayBuilder().buildTypeParameterDisplay(t,e,o)});return{name:t.symbol.name,documentation:_.emptyArray,displayParts:e,isOptional:!1}}}e=_.SignatureHelp||(_.SignatureHelp={}),(t=e.ArgumentListKind||(e.ArgumentListKind={}))[t.TypeArguments=0]="TypeArguments",t[t.CallArguments=1]="CallArguments",t[t.TaggedTemplateArguments=2]="TaggedTemplateArguments",t[t.JSXAttributesArguments=3]="JSXAttributesArguments",e.getSignatureHelpItems=function(e,t,r,n){var i=e.getTypeChecker(),s=_.findTokenOnLeftOfPosition(t,r);if(s){s=y(s,r,t);if(s){n.throwIfCancellationRequested();var r=s.invocation,a=[],r=i.getResolvedSignature(r,a,s.argumentCount);if(n.throwIfCancellationRequested(),a.length)return b(a,r,s,i);if(_.isSourceFileJavaScript(t)){var o=s,n=e;if(181===o.invocation.kind){var a=o.invocation.expression,l=71===a.kind?a:179===a.kind?a.name:void 0;if(l&&l.escapedText)for(var c=n.getTypeChecker(),u=0,d=n.getSourceFiles();u<d.length;u++){var p=d[u].getNamedDeclarations().get(l.text);if(p)for(var h=0,m=p;h<m.length;h++){var g=m[h],f=g.symbol;if(f){f=c.getTypeOfSymbolAtLocation(f,g);if(f){g=f.getCallSignatures();if(g&&g.length)return b(g,g[0],o,c)}}}}}}}}},e.getImmediatelyContainingArgumentInfo=s,e.getContainingArgumentInfo=y})(ts=ts||{}),(D=>{var e;function N(e,t,r){var n=D.getCombinedLocalAndExportSymbolFlags(t);if(32&n)return D.getDeclarationOfKind(t,199)?"local class":"class";if(384&n)return"enum";if(524288&n)return"type";if(64&n)return"interface";if(262144&n)return"type parameter";e=O(e,t,r);if(""===e){if(262144&n)return"type parameter";if(8&n)return"enum member";if(2097152&n)return"alias";if(1536&n)return"module"}return e}function O(e,t,r){var n;return e.isUndefinedSymbol(t)?"var":e.isArgumentsSymbol(t)?"local var":99===r.kind&&D.isExpression(r)?"parameter":3&(n=D.getCombinedLocalAndExportSymbolFlags(t))?D.isFirstDeclarationOfSymbolParameter(t)?"parameter":t.valueDeclaration&&D.isConst(t.valueDeclaration)?"const":D.forEach(t.declarations,D.isLet)?"let":i(t)?"local var":"var":16&n?i(t)?"local function":"function":32768&n?"getter":65536&n?"setter":8192&n?"method":16384&n?"constructor":4&n?33554432&n&&6&t.checkFlags?D.forEach(e.getRootSymbols(t),function(e){e=e.getFlags();if(98311&e)return"property";D.Debug.assert(!!(8208&e))})||(e.getTypeOfSymbolAtLocation(t,r).getCallSignatures().length?"method":"property"):r.parent&&D.isJsxAttribute(r.parent)?"JSX attribute":"property":""}function i(e){return!e.parent&&D.forEach(e.declarations,function(e){if(186!==e.kind){if(226!==e.kind&&228!==e.kind)return!1;for(var t=e.parent;!D.isFunctionBlock(t);t=t.parent)if(265===t.kind||234===t.kind)return!1}return!0})}(e=D.SymbolDisplay||(D.SymbolDisplay={})).getSymbolKind=N,e.getSymbolModifiers=function(e){return e&&e.declarations&&0<e.declarations.length?D.getNodeModifiers(e.declarations[0]):""},e.getSymbolDisplayPartsDocumentationAndSymbolKind=function(n,e,r,i,t,s){void 0===s&&(s=D.getMeaningFromLocation(t));var a,o,l,c=[],u=D.getCombinedLocalAndExportSymbolFlags(e),d=O(n,e,t),p=99===t.kind&&D.isExpression(t);if(""!==d||32&u||2097152&u){"getter"!==d&&"setter"!==d||(d="property");var h,m=void 0,g=p?n.getTypeAtLocation(t):n.getTypeOfSymbolAtLocation(e.exportSymbol||e,t),f=(t.parent&&179===t.parent.kind&&((f=t.parent.name)===t||f&&0===f.getFullWidth())&&(t=t.parent),void 0);if(D.isCallOrNewExpression(t)?f=t:(D.isCallExpressionTarget(t)||D.isNewExpressionTarget(t)||t.parent&&D.isJsxOpeningLikeElement(t.parent)&&D.isFunctionLike(e.valueDeclaration))&&(f=t.parent),f){m=n.getResolvedSignature(f,[]);var _=182===f.kind||D.isCallExpression(f)&&97===f.expression.kind,y=_?g.getConstructSignatures():g.getCallSignatures();if(m=D.contains(y,m.target)||D.contains(y,m)?m:y.length?y[0]:void 0){switch(_&&32&u?C(g.symbol,d="constructor"):2097152&u?(w(d="alias"),c.push(D.spacePart()),_&&(c.push(D.keywordPart(94)),c.push(D.spacePart())),S(e)):C(e,d),d){case"JSX attribute":case"property":case"var":case"const":case"let":case"parameter":case"local var":c.push(D.punctuationPart(56)),c.push(D.spacePart()),_&&(c.push(D.keywordPart(94)),c.push(D.spacePart())),32768&g.flags&&16&g.objectFlags||!g.symbol||D.addRange(c,D.symbolToDisplayParts(n,g.symbol,i,void 0,1)),I(m,y,16);break;default:I(m,y)}l=!0}}else(D.isNameOfFunctionDeclaration(t)&&!(98304&u)||123===t.kind&&152===t.parent.kind)&&(h=t.parent,D.find(e.declarations,function(e){return e===(123===t.kind?h.parent:h)}))&&(y=152===h.kind?g.getNonNullableType().getConstructSignatures():g.getNonNullableType().getCallSignatures(),m=n.isImplementationOfOverload(h)?y[0]:n.getSignatureFromDeclaration(h),152===h.kind?C(g.symbol,d="constructor"):C(155!==h.kind||2048&g.symbol.flags||4096&g.symbol.flags?e:g.symbol,d),I(m,y),l=!0)}if(32&u&&!l&&!p&&(D.getDeclarationOfKind(e,199)?w("local class"):c.push(D.keywordPart(75)),c.push(D.spacePart()),S(e),A(e,r)),64&u&&2&s&&(x(),c.push(D.keywordPart(109)),c.push(D.spacePart()),S(e),A(e,r)),524288&u&&(x(),c.push(D.keywordPart(138)),c.push(D.spacePart()),S(e),A(e,r),c.push(D.spacePart()),c.push(D.operatorPart(58)),c.push(D.spacePart()),D.addRange(c,D.typeToDisplayParts(n,n.getDeclaredTypeOfSymbol(e),i,1024))),384&u&&(x(),D.forEach(e.declarations,D.isConstEnumDeclaration)&&(c.push(D.keywordPart(76)),c.push(D.spacePart())),c.push(D.keywordPart(83)),c.push(D.spacePart()),S(e)),1536&u&&(x(),f=(b=D.getDeclarationOfKind(e,233))&&b.name&&71===b.name.kind,c.push(D.keywordPart(f?129:128)),c.push(D.spacePart()),S(e)),262144&u&&2&s&&(x(),c.push(D.punctuationPart(19)),c.push(D.textPart("type parameter")),c.push(D.punctuationPart(20)),c.push(D.spacePart()),S(e),e.parent?(E(),S(e.parent,i),A(e.parent,i)):(f=D.getDeclarationOfKind(e,145),D.Debug.assert(void 0!==f),(b=f.parent)&&(D.isFunctionLikeKind(b.kind)?(E(),m=n.getSignatureFromDeclaration(b),156===b.kind?(c.push(D.keywordPart(94)),c.push(D.spacePart())):155!==b.kind&&b.name&&S(b.symbol),D.addRange(c,D.signatureToDisplayParts(n,m,r,64))):231===b.kind&&(E(),c.push(D.keywordPart(138)),c.push(D.spacePart()),S(b.symbol),A(b.symbol,r))))),8&u&&(C(e,d="enum member"),264===(b=e.declarations[0]).kind)&&void 0!==(s=n.getConstantValue(b))&&(c.push(D.spacePart()),c.push(D.operatorPart(58)),c.push(D.spacePart()),c.push(D.displayPart(D.getTextOfConstantValue(s),"number"==typeof s?D.SymbolDisplayPartKind.numericLiteral:D.SymbolDisplayPartKind.stringLiteral))),2097152&u){switch(x(),e.declarations[0].kind){case 236:c.push(D.keywordPart(84)),c.push(D.spacePart()),c.push(D.keywordPart(129));break;case 243:c.push(D.keywordPart(84)),c.push(D.spacePart()),c.push(D.keywordPart(e.declarations[0].isExportEquals?58:79));break;default:c.push(D.keywordPart(91))}c.push(D.spacePart()),S(e),D.forEach(e.declarations,function(e){if(237===e.kind)return D.isExternalModuleImportEqualsDeclaration(e=e)?(c.push(D.spacePart()),c.push(D.operatorPart(58)),c.push(D.spacePart()),c.push(D.keywordPart(132)),c.push(D.punctuationPart(19)),c.push(D.displayPart(D.getTextOfNode(D.getExternalModuleImportEqualsDeclarationExpression(e)),D.SymbolDisplayPartKind.stringLiteral)),c.push(D.punctuationPart(20))):(e=n.getSymbolAtLocation(e.moduleReference))&&(c.push(D.spacePart()),c.push(D.operatorPart(58)),c.push(D.spacePart()),S(e,i)),!0})}if(l||(""!==d?g&&(p?(x(),c.push(D.keywordPart(99))):C(e,d),"property"===d||"JSX attribute"===d||3&u||"local var"===d||p?(c.push(D.punctuationPart(56)),c.push(D.spacePart()),g.symbol&&262144&g.symbol.flags?(f=D.mapToDisplayParts(function(e){n.getSymbolDisplayBuilder().buildTypeParameterDisplay(g,e,i)}),D.addRange(c,f)):D.addRange(c,D.typeToDisplayParts(n,g,i))):(16&u||8192&u||16384&u||131072&u||98304&u||"method"===d)&&(y=g.getNonNullableType().getCallSignatures()).length&&I(y[0],y)):d=N(n,e,t)),!a&&(a=e.getDocumentationComment(),o=e.getJsDocTags(),0===a.length)&&4&u&&e.parent&&D.forEach(e.parent.declarations,function(e){return 265===e.kind}))for(var b,v=0,T=e.declarations;v<T.length;v++)if((b=T[v]).parent&&194===b.parent.kind){var k=n.getSymbolAtLocation(b.parent.right);if(k&&(a=k.getDocumentationComment(),o=k.getJsDocTags(),0<a.length))break}return{displayParts:c,documentation:a,symbolKind:d,tags:o};function x(){c.length&&c.push(D.lineBreakPart())}function E(){c.push(D.spacePart()),c.push(D.keywordPart(92)),c.push(D.spacePart())}function S(e,t){e=D.symbolToDisplayParts(n,e,t||r,void 0,3);D.addRange(c,e)}function C(e,t){x(),t&&(w(t),c.push(D.spacePart()),S(e))}function w(e){switch(e){case"var":case"function":case"let":case"const":case"constructor":return void c.push(D.textOrKeywordPart(e));default:c.push(D.punctuationPart(19)),c.push(D.textOrKeywordPart(e)),c.push(D.punctuationPart(20))}}function I(e,t,r){D.addRange(c,D.signatureToDisplayParts(n,e,i,64|r)),1<t.length&&(c.push(D.spacePart()),c.push(D.punctuationPart(19)),c.push(D.operatorPart(37)),c.push(D.displayPart((t.length-1).toString(),D.SymbolDisplayPartKind.numericLiteral)),c.push(D.spacePart()),c.push(D.textPart(2===t.length?"overload":"overloads")),c.push(D.punctuationPart(20))),a=e.getDocumentationComment(),o=e.getJsDocTags()}function A(t,r){var e=D.mapToDisplayParts(function(e){n.getSymbolDisplayBuilder().buildTypeParameterDisplayFromSymbol(t,e,r)});D.addRange(c,e)}}})(ts=ts||{}),(c=>{function s(e,t){var r,n,i=[],s=t.compilerOptions?u(t.compilerOptions,i):c.getDefaultCompilerOptions(),a=(s.isolatedModules=!0,s.suppressOutputPathCheck=!0,s.allowNonTsExtensions=!0,s.noLib=!0,s.lib=void 0,s.types=void 0,s.noEmit=void 0,s.noEmitOnError=void 0,s.paths=void 0,s.rootDirs=void 0,s.declaration=void 0,s.declarationDir=void 0,s.out=void 0,s.outFile=void 0,s.noResolve=!0,t.fileName||(s.jsx?"module.tsx":"module.ts")),o=c.createSourceFile(a,e,s.target),l=(t.moduleName&&(o.moduleName=t.moduleName),t.renamedDependencies&&(o.renamedDependencies=c.createMapFromTemplate(t.renamedDependencies)),c.getNewLineCharacter(s)),e=c.createProgram([a],s,{getSourceFile:function(e){return e===c.normalizePath(a)?o:void 0},writeFile:function(e,t){c.fileExtensionIs(e,".map")?(c.Debug.assertEqual(n,void 0,"Unexpected multiple source map outputs, file:",e),n=t):(c.Debug.assertEqual(r,void 0,"Unexpected multiple outputs, file:",e),r=t)},getDefaultLibFileName:function(){return"lib.d.ts"},useCaseSensitiveFileNames:function(){return!1},getCanonicalFileName:function(e){return e},getCurrentDirectory:function(){return""},getNewLine:function(){return l},fileExists:function(e){return e===a},readFile:function(){return""},directoryExists:function(){return!0},getDirectories:function(){return[]}});return t.reportDiagnostics&&(c.addRange(i,e.getSyntacticDiagnostics(o)),c.addRange(i,e.getOptionsDiagnostics())),e.emit(void 0,void 0,void 0,void 0,t.transformers),c.Debug.assert(void 0!==r,"Output generation failed"),{outputText:r,diagnostics:i,sourceMapText:n}}var i;function u(r,n){i=i||c.filter(c.optionDeclarations,function(e){return"object"==typeof e.type&&!c.forEachEntry(e.type,function(e){return"number"!=typeof e})}),r=c.cloneCompilerOptions(r);for(var e=0,t=i;e<t.length;e++)(e=>{if(!c.hasProperty(r,e.name))return;var t=r[e.name];c.isString(t)?r[e.name]=c.parseCustomTypeOption(e,t,n):c.forEachEntry(e.type,function(e){return e===t})||n.push(c.createCompilerDiagnosticForInvalidCustomType(e))})(t[e]);return r}c.transpileModule=s,c.transpile=function(e,t,r,n,i){return e=s(e,{compilerOptions:t,fileName:r,reportDiagnostics:!!n,moduleName:i}),c.addRange(n,e.diagnostics),e.outputText},c.fixupCompilerOptions=u})(ts=ts||{}),(m=>{var e,g,f;e=m.formatting||(m.formatting={}),g=m.createScanner(5,!1,0),f=m.createScanner(5,!1,1),e.getFormattingScanner=function(e,t,r,i,n){var s,a,o,l,c=1===t?f:g,u=(c.setText(e),c.setTextPos(r),!0),t=n({advance:function(){d=void 0,c.getStartPos()!==r?u=a&&4===m.lastOrUndefined(a).kind:c.scan();s=void 0,a=void 0;var e=c.getStartPos();for(;e<i;){var t=c.getToken();if(!m.isTrivia(t))break;c.scan();t={pos:e,end:c.getStartPos(),kind:t};e=c.getStartPos(),s=m.append(s,t)}o=c.getStartPos()},readTokenInfo:function(e){m.Debug.assert(p());var t=(e=>{switch(e.kind){case 31:case 66:case 67:case 47:case 46:return 1}})(e)?1:12===e.kind?2:(e=>15===e.kind||16===e.kind)(e)?3:(e=>{if(e.parent)switch(e.parent.kind){case 253:case 251:case 252:case 250:return m.isKeyword(e.kind)||71===e.kind}})(e)?4:10===e.kind?5:0;if(!d||t!==l){c.getStartPos()!==o&&(m.Debug.assert(void 0!==d),c.setTextPos(o),c.scan());var r=((e,t)=>{var r,n=c.getToken();switch(l=0,t){case 1:if(29===n)return l=1,r=c.reScanGreaterToken(),m.Debug.assert(e.kind===r),r;break;case 2:if((e=>41===e||63===e)(n))return l=2,r=c.reScanSlashToken(),m.Debug.assert(e.kind===r),r;break;case 3:if(18===n)return l=3,c.reScanTemplateToken();break;case 4:return l=4,c.scanJsxIdentifier();case 5:return l=5,c.reScanJsxToken();case 0:break;default:m.Debug.assertNever(t)}return n})(e,t),t={pos:c.getStartPos(),end:c.getTextPos(),kind:r};for(a=a&&void 0;c.getStartPos()<i&&(r=c.scan(),m.isTrivia(r));){var n={pos:c.getStartPos(),end:c.getTextPos(),kind:r};if((a=a||[]).push(n),4===r){c.scan();break}}d={leadingTrivia:s,trailingTrivia:a,token:t}}return h(d,e)},isOnToken:p,getCurrentLeadingTrivia:function(){return s},lastTrailingTriviaWasNewLine:function(){return u},skipToEndOf:function(e){c.setTextPos(e.end),o=c.getStartPos(),l=void 0,d=void 0,u=!1,s=void 0,a=void 0}}),d=void 0;return c.setText(void 0),t;function p(){var e=d?d.token.kind:c.getToken();return(d?d.token.pos:c.getStartPos())<i&&1!==e&&!m.isTrivia(e)}function h(e,t){return m.isToken(t)&&e.token.kind!==t.kind&&(e.token.kind=t.kind),e}}})(ts=ts||{}),(s=>{var e;function t(e,t,r){this.sourceFile=e,this.formattingRequestKind=t,this.options=r}e=s.formatting||(s.formatting={}),t.prototype.updateContext=function(e,t,r,n,i){s.Debug.assert(void 0!==e,"currentTokenSpan is null"),s.Debug.assert(void 0!==t,"currentTokenParent is null"),s.Debug.assert(void 0!==r,"nextTokenSpan is null"),s.Debug.assert(void 0!==n,"nextTokenParent is null"),s.Debug.assert(void 0!==i,"commonParent is null"),this.currentTokenSpan=e,this.currentTokenParent=t,this.nextTokenSpan=r,this.nextTokenParent=n,this.contextNode=i,this.contextNodeAllOnSameLine=void 0,this.nextNodeAllOnSameLine=void 0,this.tokensAreOnSameLine=void 0,this.contextNodeBlockIsOnOneLine=void 0,this.nextNodeBlockIsOnOneLine=void 0},t.prototype.ContextNodeAllOnSameLine=function(){return void 0===this.contextNodeAllOnSameLine&&(this.contextNodeAllOnSameLine=this.NodeIsOnOneLine(this.contextNode)),this.contextNodeAllOnSameLine},t.prototype.NextNodeAllOnSameLine=function(){return void 0===this.nextNodeAllOnSameLine&&(this.nextNodeAllOnSameLine=this.NodeIsOnOneLine(this.nextTokenParent)),this.nextNodeAllOnSameLine},t.prototype.TokensAreOnSameLine=function(){var e,t;return void 0===this.tokensAreOnSameLine&&(e=this.sourceFile.getLineAndCharacterOfPosition(this.currentTokenSpan.pos).line,t=this.sourceFile.getLineAndCharacterOfPosition(this.nextTokenSpan.pos).line,this.tokensAreOnSameLine=e===t),this.tokensAreOnSameLine},t.prototype.ContextNodeBlockIsOnOneLine=function(){return void 0===this.contextNodeBlockIsOnOneLine&&(this.contextNodeBlockIsOnOneLine=this.BlockIsOnOneLine(this.contextNode)),this.contextNodeBlockIsOnOneLine},t.prototype.NextNodeBlockIsOnOneLine=function(){return void 0===this.nextNodeBlockIsOnOneLine&&(this.nextNodeBlockIsOnOneLine=this.BlockIsOnOneLine(this.nextTokenParent)),this.nextNodeBlockIsOnOneLine},t.prototype.NodeIsOnOneLine=function(e){return this.sourceFile.getLineAndCharacterOfPosition(e.getStart(this.sourceFile)).line===this.sourceFile.getLineAndCharacterOfPosition(e.getEnd()).line},t.prototype.BlockIsOnOneLine=function(e){var t=s.findChildOfKind(e,17,this.sourceFile),e=s.findChildOfKind(e,18,this.sourceFile);return!(!t||!e)&&this.sourceFile.getLineAndCharacterOfPosition(t.getEnd()).line===this.sourceFile.getLineAndCharacterOfPosition(e.getStart(this.sourceFile)).line},e.FormattingContext=t})(ts=ts||{}),(e=>{(e=(e=e.formatting||(e.formatting={})).FormattingRequestKind||(e.FormattingRequestKind={}))[e.FormatDocument=0]="FormatDocument",e[e.FormatSelection=1]="FormatSelection",e[e.FormatOnEnter=2]="FormatOnEnter",e[e.FormatOnSemicolon=3]="FormatOnSemicolon",e[e.FormatOnOpeningCurlyBrace=4]="FormatOnOpeningCurlyBrace",e[e.FormatOnClosingCurlyBrace=5]="FormatOnClosingCurlyBrace"})(ts=ts||{}),(e=>{(e.formatting||(e.formatting={})).Rule=function(e,t,r){void 0===r&&(r=0),this.Descriptor=e,this.Operation=t,this.Flag=r}})(ts=ts||{}),(e=>{(e=(e=e.formatting||(e.formatting={})).RuleAction||(e.RuleAction={}))[e.Ignore=1]="Ignore",e[e.Space=2]="Space",e[e.NewLine=4]="NewLine",e[e.Delete=8]="Delete"})(ts=ts||{}),(e=>{var r;function n(e,t){this.LeftTokenRange=e,this.RightTokenRange=t}r=e.formatting||(e.formatting={}),n.prototype.toString=function(){return"[leftRange="+this.LeftTokenRange+",rightRange="+this.RightTokenRange+"]"},n.create1=function(e,t){return n.create4(r.Shared.TokenRange.FromToken(e),r.Shared.TokenRange.FromToken(t))},n.create2=function(e,t){return n.create4(e,r.Shared.TokenRange.FromToken(t))},n.create3=function(e,t){return n.create4(r.Shared.TokenRange.FromToken(e),t)},n.create4=function(e,t){return new n(e,t)},r.RuleDescriptor=n})(ts=ts||{}),(e=>{(e=(e=e.formatting||(e.formatting={})).RuleFlags||(e.RuleFlags={}))[e.None=0]="None",e[e.CanDeleteNewLines=1]="CanDeleteNewLines"})(ts=ts||{}),(e=>{var t;function r(e,t){this.Context=e,this.Action=t}t=e.formatting||(e.formatting={}),r.prototype.toString=function(){return"[context="+this.Context+",action="+this.Action+"]"},r.create1=function(e){return r.create2(t.RuleOperationContext.Any,e)},r.create2=function(e,t){return new r(e,t)},t.RuleOperation=r})(ts=ts||{}),(e=>{function t(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.customContextChecks=e}e=e.formatting||(e.formatting={}),t.prototype.IsAny=function(){return this===t.Any},t.prototype.InContext=function(e){if(!this.IsAny())for(var t=0,r=this.customContextChecks;t<r.length;t++)if(!(0,r[t])(e))return!1;return!0},t.Any=new t,e.RuleOperationContext=t})(ts=ts||{}),(r=>{var n,e;function i(){if(this.IgnoreBeforeComment=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.Any,n.Shared.TokenRange.Comments),n.RuleOperation.create1(1)),this.IgnoreAfterLineComment=new n.Rule(n.RuleDescriptor.create3(2,n.Shared.TokenRange.Any),n.RuleOperation.create1(1)),this.NoSpaceBeforeSemicolon=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,25),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeColon=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,56),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsNotBinaryOpContext),8)),this.NoSpaceBeforeQuestionMark=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,55),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsNotBinaryOpContext),8)),this.SpaceAfterColon=new n.Rule(n.RuleDescriptor.create3(56,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsNotBinaryOpContext),2)),this.SpaceAfterQuestionMarkInConditionalOperator=new n.Rule(n.RuleDescriptor.create3(55,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsConditionalOperatorContext),2)),this.NoSpaceAfterQuestionMark=new n.Rule(n.RuleDescriptor.create3(55,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterSemicolon=new n.Rule(n.RuleDescriptor.create3(25,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),2)),this.SpaceAfterCloseBrace=new n.Rule(n.RuleDescriptor.create3(18,n.Shared.TokenRange.FromRange(0,142,[20])),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsAfterCodeBlockContext),2)),this.SpaceBetweenCloseBraceAndElse=new n.Rule(n.RuleDescriptor.create1(18,82),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),2)),this.SpaceBetweenCloseBraceAndWhile=new n.Rule(n.RuleDescriptor.create1(18,106),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterCloseBrace=new n.Rule(n.RuleDescriptor.create3(18,n.Shared.TokenRange.FromTokens([22,26,25])),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeDot=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,23),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterDot=new n.Rule(n.RuleDescriptor.create3(23,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeOpenBracket=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.AnyExcept(120),21),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterCloseBracket=new n.Rule(n.RuleDescriptor.create3(22,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsNotBeforeBlockInFunctionDeclarationContext),8)),this.FunctionOpenBraceLeftTokenRange=n.Shared.TokenRange.AnyIncludingMultilineComments,this.SpaceBeforeOpenBraceInFunction=new n.Rule(n.RuleDescriptor.create2(this.FunctionOpenBraceLeftTokenRange,17),n.RuleOperation.create2(new n.RuleOperationContext(i.isOptionDisabledOrUndefinedOrTokensOnSameLine("placeOpenBraceOnNewLineForFunctions"),i.IsFunctionDeclContext,i.IsBeforeBlockContext,i.IsNotFormatOnEnter,i.IsSameLineTokenOrBeforeBlockContext),2),1),this.TypeScriptOpenBraceLeftTokenRange=n.Shared.TokenRange.FromTokens([71,3,75,84,91]),this.SpaceBeforeOpenBraceInTypeScriptDeclWithBlock=new n.Rule(n.RuleDescriptor.create2(this.TypeScriptOpenBraceLeftTokenRange,17),n.RuleOperation.create2(new n.RuleOperationContext(i.isOptionDisabledOrUndefinedOrTokensOnSameLine("placeOpenBraceOnNewLineForFunctions"),i.IsTypeScriptDeclWithBlockContext,i.IsNotFormatOnEnter,i.IsSameLineTokenOrBeforeBlockContext),2),1),this.ControlOpenBraceLeftTokenRange=n.Shared.TokenRange.FromTokens([20,3,81,102,87,82]),this.SpaceBeforeOpenBraceInControl=new n.Rule(n.RuleDescriptor.create2(this.ControlOpenBraceLeftTokenRange,17),n.RuleOperation.create2(new n.RuleOperationContext(i.isOptionDisabledOrUndefinedOrTokensOnSameLine("placeOpenBraceOnNewLineForControlBlocks"),i.IsControlDeclContext,i.IsNotFormatOnEnter,i.IsSameLineTokenOrBeforeBlockContext),2),1),this.SpaceAfterOpenBrace=new n.Rule(n.RuleDescriptor.create3(17,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyBraces"),i.IsBraceWrappedContext),2)),this.SpaceBeforeCloseBrace=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,18),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyBraces"),i.IsBraceWrappedContext),2)),this.NoSpaceAfterOpenBrace=new n.Rule(n.RuleDescriptor.create3(17,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyBraces"),i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeCloseBrace=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,18),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyBraces"),i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBetweenEmptyBraceBrackets=new n.Rule(n.RuleDescriptor.create1(17,18),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsObjectContext),8)),this.NewLineAfterOpenBraceInBlockContext=new n.Rule(n.RuleDescriptor.create3(17,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsMultilineBlockContext),4)),this.NewLineBeforeCloseBraceInBlockContext=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.AnyIncludingMultilineComments,18),n.RuleOperation.create2(new n.RuleOperationContext(i.IsMultilineBlockContext),4)),this.NoSpaceAfterUnaryPrefixOperator=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.UnaryPrefixOperators,n.Shared.TokenRange.UnaryPrefixExpressions),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsNotBinaryOpContext),8)),this.NoSpaceAfterUnaryPreincrementOperator=new n.Rule(n.RuleDescriptor.create3(43,n.Shared.TokenRange.UnaryPreincrementExpressions),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterUnaryPredecrementOperator=new n.Rule(n.RuleDescriptor.create3(44,n.Shared.TokenRange.UnaryPredecrementExpressions),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeUnaryPostincrementOperator=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.UnaryPostincrementExpressions,43),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeUnaryPostdecrementOperator=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.UnaryPostdecrementExpressions,44),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterPostincrementWhenFollowedByAdd=new n.Rule(n.RuleDescriptor.create1(43,37),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsBinaryOpContext),2)),this.SpaceAfterAddWhenFollowedByUnaryPlus=new n.Rule(n.RuleDescriptor.create1(37,37),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsBinaryOpContext),2)),this.SpaceAfterAddWhenFollowedByPreincrement=new n.Rule(n.RuleDescriptor.create1(37,43),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsBinaryOpContext),2)),this.SpaceAfterPostdecrementWhenFollowedBySubtract=new n.Rule(n.RuleDescriptor.create1(44,38),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsBinaryOpContext),2)),this.SpaceAfterSubtractWhenFollowedByUnaryMinus=new n.Rule(n.RuleDescriptor.create1(38,38),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsBinaryOpContext),2)),this.SpaceAfterSubtractWhenFollowedByPredecrement=new n.Rule(n.RuleDescriptor.create1(38,44),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsBinaryOpContext),2)),this.NoSpaceBeforeComma=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,26),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterCertainKeywords=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.FromTokens([104,100,94,80,96,103,121]),n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterNewKeywordOnConstructorSignature=new n.Rule(n.RuleDescriptor.create1(94,19),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsConstructorSignatureContext),8)),this.SpaceAfterLetConstInVariableDeclaration=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.FromTokens([110,76]),n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsStartOfVariableDeclarationList),2)),this.NoSpaceBeforeOpenParenInFuncCall=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,19),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsFunctionCallOrNewContext,i.IsPreviousTokenNotComma),8)),this.SpaceAfterFunctionInFuncDecl=new n.Rule(n.RuleDescriptor.create3(89,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsFunctionDeclContext),2)),this.SpaceBeforeOpenParenInFuncDecl=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,19),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceBeforeFunctionParenthesis"),i.IsNonJsxSameLineTokenContext,i.IsFunctionDeclContext),2)),this.NoSpaceBeforeOpenParenInFuncDecl=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,19),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabledOrUndefined("insertSpaceBeforeFunctionParenthesis"),i.IsNonJsxSameLineTokenContext,i.IsFunctionDeclContext),8)),this.SpaceAfterVoidOperator=new n.Rule(n.RuleDescriptor.create3(105,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsVoidOpContext),2)),this.NoSpaceBetweenReturnAndSemicolon=new n.Rule(n.RuleDescriptor.create1(96,25),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.SpaceBetweenStatements=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.FromTokens([20,81,82,73]),n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsNonJsxElementContext,i.IsNotForContext),2)),this.SpaceAfterTryFinally=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.FromTokens([102,87]),17),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),2)),this.SpaceAfterGetSetInMember=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.FromTokens([125,135]),71),n.RuleOperation.create2(new n.RuleOperationContext(i.IsFunctionDeclContext),2)),this.SpaceBeforeBinaryKeywordOperator=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.Any,n.Shared.TokenRange.BinaryKeywordOperators),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsBinaryOpContext),2)),this.SpaceAfterBinaryKeywordOperator=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.BinaryKeywordOperators,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsBinaryOpContext),2)),this.SpaceAfterConstructor=new n.Rule(n.RuleDescriptor.create1(123,19),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceAfterConstructor"),i.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterConstructor=new n.Rule(n.RuleDescriptor.create1(123,19),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabledOrUndefined("insertSpaceAfterConstructor"),i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterModuleImport=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.FromTokens([128,132]),19),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterCertainTypeScriptKeywords=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.FromTokens([117,75,124,79,83,84,85,125,108,91,109,128,129,112,114,113,131,135,115,138,140,127]),n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),2)),this.SpaceBeforeCertainTypeScriptKeywords=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.Any,n.Shared.TokenRange.FromTokens([85,108,140])),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),2)),this.SpaceAfterModuleName=new n.Rule(n.RuleDescriptor.create1(9,17),n.RuleOperation.create2(new n.RuleOperationContext(i.IsModuleDeclContext),2)),this.SpaceBeforeArrow=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,36),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),2)),this.SpaceAfterArrow=new n.Rule(n.RuleDescriptor.create3(36,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterEllipsis=new n.Rule(n.RuleDescriptor.create1(24,71),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterOptionalParameters=new n.Rule(n.RuleDescriptor.create3(55,n.Shared.TokenRange.FromTokens([20,26])),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsNotBinaryOpContext),8)),this.NoSpaceBeforeOpenAngularBracket=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.TypeNames,27),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsTypeArgumentOrParameterOrAssertionContext),8)),this.NoSpaceBetweenCloseParenAndAngularBracket=new n.Rule(n.RuleDescriptor.create1(20,27),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsTypeArgumentOrParameterOrAssertionContext),8)),this.NoSpaceAfterOpenAngularBracket=new n.Rule(n.RuleDescriptor.create3(27,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsTypeArgumentOrParameterOrAssertionContext),8)),this.NoSpaceBeforeCloseAngularBracket=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,29),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsTypeArgumentOrParameterOrAssertionContext),8)),this.NoSpaceAfterCloseAngularBracket=new n.Rule(n.RuleDescriptor.create3(29,n.Shared.TokenRange.FromTokens([19,21,29,26])),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsTypeArgumentOrParameterOrAssertionContext),8)),this.NoSpaceBetweenEmptyInterfaceBraceBrackets=new n.Rule(n.RuleDescriptor.create1(17,18),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsObjectTypeContext),8)),this.SpaceBeforeAt=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,57),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterAt=new n.Rule(n.RuleDescriptor.create3(57,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterDecorator=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.Any,n.Shared.TokenRange.FromTokens([117,71,84,79,75,115,114,112,113,125,135,21,39])),n.RuleOperation.create2(new n.RuleOperationContext(i.IsEndOfDecoratorContextOnSameLine),2)),this.NoSpaceBetweenFunctionKeywordAndStar=new n.Rule(n.RuleDescriptor.create1(89,39),n.RuleOperation.create2(new n.RuleOperationContext(i.IsFunctionDeclarationOrFunctionExpressionContext),8)),this.SpaceAfterStarInGeneratorDeclaration=new n.Rule(n.RuleDescriptor.create3(39,n.Shared.TokenRange.FromTokens([71,19])),n.RuleOperation.create2(new n.RuleOperationContext(i.IsFunctionDeclarationOrFunctionExpressionContext),2)),this.NoSpaceBetweenYieldKeywordAndStar=new n.Rule(n.RuleDescriptor.create1(116,39),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsYieldOrYieldStarWithOperand),8)),this.SpaceBetweenYieldOrYieldStarAndOperand=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.FromTokens([116,39]),n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsYieldOrYieldStarWithOperand),2)),this.SpaceBetweenAsyncAndOpenParen=new n.Rule(n.RuleDescriptor.create1(120,19),n.RuleOperation.create2(new n.RuleOperationContext(i.IsArrowFunctionContext,i.IsNonJsxSameLineTokenContext),2)),this.SpaceBetweenAsyncAndFunctionKeyword=new n.Rule(n.RuleDescriptor.create1(120,89),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),2)),this.NoSpaceBetweenTagAndTemplateString=new n.Rule(n.RuleDescriptor.create3(71,n.Shared.TokenRange.FromTokens([13,14])),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.SpaceBeforeJsxAttribute=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,71),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNextTokenParentJsxAttribute,i.IsNonJsxSameLineTokenContext),2)),this.SpaceBeforeSlashInJsxOpeningElement=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,41),n.RuleOperation.create2(new n.RuleOperationContext(i.IsJsxSelfClosingElementContext,i.IsNonJsxSameLineTokenContext),2)),this.NoSpaceBeforeGreaterThanTokenInJsxOpeningElement=new n.Rule(n.RuleDescriptor.create1(41,29),n.RuleOperation.create2(new n.RuleOperationContext(i.IsJsxSelfClosingElementContext,i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeEqualInJsxAttribute=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,58),n.RuleOperation.create2(new n.RuleOperationContext(i.IsJsxAttributeContext,i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterEqualInJsxAttribute=new n.Rule(n.RuleDescriptor.create3(58,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsJsxAttributeContext,i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeNonNullAssertionOperator=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,51),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext,i.IsNonNullAssertionContext),8)),this.SpaceAfterComma=new n.Rule(n.RuleDescriptor.create3(26,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceAfterCommaDelimiter"),i.IsNonJsxSameLineTokenContext,i.IsNonJsxElementContext,i.IsNextTokenNotCloseBracket),2)),this.NoSpaceAfterComma=new n.Rule(n.RuleDescriptor.create3(26,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabledOrUndefined("insertSpaceAfterCommaDelimiter"),i.IsNonJsxSameLineTokenContext,i.IsNonJsxElementContext),8)),this.SpaceBeforeBinaryOperator=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.Any,n.Shared.TokenRange.BinaryOperators),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceBeforeAndAfterBinaryOperators"),i.IsNonJsxSameLineTokenContext,i.IsBinaryOpContext),2)),this.SpaceAfterBinaryOperator=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.BinaryOperators,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceBeforeAndAfterBinaryOperators"),i.IsNonJsxSameLineTokenContext,i.IsBinaryOpContext),2)),this.NoSpaceBeforeBinaryOperator=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.Any,n.Shared.TokenRange.BinaryOperators),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabledOrUndefined("insertSpaceBeforeAndAfterBinaryOperators"),i.IsNonJsxSameLineTokenContext,i.IsBinaryOpContext),8)),this.NoSpaceAfterBinaryOperator=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.BinaryOperators,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabledOrUndefined("insertSpaceBeforeAndAfterBinaryOperators"),i.IsNonJsxSameLineTokenContext,i.IsBinaryOpContext),8)),this.SpaceAfterKeywordInControl=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Keywords,19),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceAfterKeywordsInControlFlowStatements"),i.IsControlDeclContext),2)),this.NoSpaceAfterKeywordInControl=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Keywords,19),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabledOrUndefined("insertSpaceAfterKeywordsInControlFlowStatements"),i.IsControlDeclContext),8)),this.NewLineBeforeOpenBraceInFunction=new n.Rule(n.RuleDescriptor.create2(this.FunctionOpenBraceLeftTokenRange,17),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("placeOpenBraceOnNewLineForFunctions"),i.IsFunctionDeclContext,i.IsBeforeMultilineBlockContext),4),1),this.NewLineBeforeOpenBraceInTypeScriptDeclWithBlock=new n.Rule(n.RuleDescriptor.create2(this.TypeScriptOpenBraceLeftTokenRange,17),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("placeOpenBraceOnNewLineForFunctions"),i.IsTypeScriptDeclWithBlockContext,i.IsBeforeMultilineBlockContext),4),1),this.NewLineBeforeOpenBraceInControl=new n.Rule(n.RuleDescriptor.create2(this.ControlOpenBraceLeftTokenRange,17),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("placeOpenBraceOnNewLineForControlBlocks"),i.IsControlDeclContext,i.IsBeforeMultilineBlockContext),4),1),this.SpaceAfterSemicolonInFor=new n.Rule(n.RuleDescriptor.create3(25,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceAfterSemicolonInForStatements"),i.IsNonJsxSameLineTokenContext,i.IsForContext),2)),this.NoSpaceAfterSemicolonInFor=new n.Rule(n.RuleDescriptor.create3(25,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabledOrUndefined("insertSpaceAfterSemicolonInForStatements"),i.IsNonJsxSameLineTokenContext,i.IsForContext),8)),this.SpaceAfterOpenParen=new n.Rule(n.RuleDescriptor.create3(19,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis"),i.IsNonJsxSameLineTokenContext),2)),this.SpaceBeforeCloseParen=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,20),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis"),i.IsNonJsxSameLineTokenContext),2)),this.SpaceBetweenOpenParens=new n.Rule(n.RuleDescriptor.create1(19,19),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis"),i.IsNonJsxSameLineTokenContext),2)),this.NoSpaceBetweenParens=new n.Rule(n.RuleDescriptor.create1(19,20),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterOpenParen=new n.Rule(n.RuleDescriptor.create3(19,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis"),i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeCloseParen=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,20),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyParenthesis"),i.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterOpenBracket=new n.Rule(n.RuleDescriptor.create3(21,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets"),i.IsNonJsxSameLineTokenContext),2)),this.SpaceBeforeCloseBracket=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,22),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets"),i.IsNonJsxSameLineTokenContext),2)),this.NoSpaceBetweenBrackets=new n.Rule(n.RuleDescriptor.create1(21,22),n.RuleOperation.create2(new n.RuleOperationContext(i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterOpenBracket=new n.Rule(n.RuleDescriptor.create3(21,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets"),i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceBeforeCloseBracket=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,22),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingNonemptyBrackets"),i.IsNonJsxSameLineTokenContext),8)),this.NoSpaceAfterTemplateHeadAndMiddle=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.FromTokens([14,15]),n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces"),i.IsNonJsxSameLineTokenContext),8)),this.SpaceAfterTemplateHeadAndMiddle=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.FromTokens([14,15]),n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces"),i.IsNonJsxSameLineTokenContext),2)),this.NoSpaceBeforeTemplateMiddleAndTail=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.Any,n.Shared.TokenRange.FromTokens([15,16])),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces"),i.IsNonJsxSameLineTokenContext),8)),this.SpaceBeforeTemplateMiddleAndTail=new n.Rule(n.RuleDescriptor.create4(n.Shared.TokenRange.Any,n.Shared.TokenRange.FromTokens([15,16])),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingTemplateStringBraces"),i.IsNonJsxSameLineTokenContext),2)),this.NoSpaceAfterOpenBraceInJsxExpression=new n.Rule(n.RuleDescriptor.create3(17,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces"),i.IsNonJsxSameLineTokenContext,i.IsJsxExpressionContext),8)),this.SpaceAfterOpenBraceInJsxExpression=new n.Rule(n.RuleDescriptor.create3(17,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces"),i.IsNonJsxSameLineTokenContext,i.IsJsxExpressionContext),2)),this.NoSpaceBeforeCloseBraceInJsxExpression=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,18),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabledOrUndefined("insertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces"),i.IsNonJsxSameLineTokenContext,i.IsJsxExpressionContext),8)),this.SpaceBeforeCloseBraceInJsxExpression=new n.Rule(n.RuleDescriptor.create2(n.Shared.TokenRange.Any,18),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceAfterOpeningAndBeforeClosingJsxExpressionBraces"),i.IsNonJsxSameLineTokenContext,i.IsJsxExpressionContext),2)),this.SpaceAfterAnonymousFunctionKeyword=new n.Rule(n.RuleDescriptor.create1(89,19),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceAfterFunctionKeywordForAnonymousFunctions"),i.IsFunctionDeclContext),2)),this.NoSpaceAfterAnonymousFunctionKeyword=new n.Rule(n.RuleDescriptor.create1(89,19),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabledOrUndefined("insertSpaceAfterFunctionKeywordForAnonymousFunctions"),i.IsFunctionDeclContext),8)),this.NoSpaceAfterTypeAssertion=new n.Rule(n.RuleDescriptor.create3(29,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionDisabledOrUndefined("insertSpaceAfterTypeAssertion"),i.IsNonJsxSameLineTokenContext,i.IsTypeAssertionContext),8)),this.SpaceAfterTypeAssertion=new n.Rule(n.RuleDescriptor.create3(29,n.Shared.TokenRange.Any),n.RuleOperation.create2(new n.RuleOperationContext(i.IsOptionEnabled("insertSpaceAfterTypeAssertion"),i.IsNonJsxSameLineTokenContext,i.IsTypeAssertionContext),2)),this.HighPriorityCommonRules=[this.IgnoreBeforeComment,this.IgnoreAfterLineComment,this.NoSpaceBeforeColon,this.SpaceAfterColon,this.NoSpaceBeforeQuestionMark,this.SpaceAfterQuestionMarkInConditionalOperator,this.NoSpaceAfterQuestionMark,this.NoSpaceBeforeDot,this.NoSpaceAfterDot,this.NoSpaceAfterUnaryPrefixOperator,this.NoSpaceAfterUnaryPreincrementOperator,this.NoSpaceAfterUnaryPredecrementOperator,this.NoSpaceBeforeUnaryPostincrementOperator,this.NoSpaceBeforeUnaryPostdecrementOperator,this.SpaceAfterPostincrementWhenFollowedByAdd,this.SpaceAfterAddWhenFollowedByUnaryPlus,this.SpaceAfterAddWhenFollowedByPreincrement,this.SpaceAfterPostdecrementWhenFollowedBySubtract,this.SpaceAfterSubtractWhenFollowedByUnaryMinus,this.SpaceAfterSubtractWhenFollowedByPredecrement,this.NoSpaceAfterCloseBrace,this.NewLineBeforeCloseBraceInBlockContext,this.SpaceAfterCloseBrace,this.SpaceBetweenCloseBraceAndElse,this.SpaceBetweenCloseBraceAndWhile,this.NoSpaceBetweenEmptyBraceBrackets,this.NoSpaceBetweenFunctionKeywordAndStar,this.SpaceAfterStarInGeneratorDeclaration,this.SpaceAfterFunctionInFuncDecl,this.NewLineAfterOpenBraceInBlockContext,this.SpaceAfterGetSetInMember,this.NoSpaceBetweenYieldKeywordAndStar,this.SpaceBetweenYieldOrYieldStarAndOperand,this.NoSpaceBetweenReturnAndSemicolon,this.SpaceAfterCertainKeywords,this.SpaceAfterLetConstInVariableDeclaration,this.NoSpaceBeforeOpenParenInFuncCall,this.SpaceBeforeBinaryKeywordOperator,this.SpaceAfterBinaryKeywordOperator,this.SpaceAfterVoidOperator,this.SpaceBetweenAsyncAndOpenParen,this.SpaceBetweenAsyncAndFunctionKeyword,this.NoSpaceBetweenTagAndTemplateString,this.SpaceBeforeJsxAttribute,this.SpaceBeforeSlashInJsxOpeningElement,this.NoSpaceBeforeGreaterThanTokenInJsxOpeningElement,this.NoSpaceBeforeEqualInJsxAttribute,this.NoSpaceAfterEqualInJsxAttribute,this.NoSpaceAfterModuleImport,this.SpaceAfterCertainTypeScriptKeywords,this.SpaceBeforeCertainTypeScriptKeywords,this.SpaceAfterModuleName,this.SpaceBeforeArrow,this.SpaceAfterArrow,this.NoSpaceAfterEllipsis,this.NoSpaceAfterOptionalParameters,this.NoSpaceBetweenEmptyInterfaceBraceBrackets,this.NoSpaceBeforeOpenAngularBracket,this.NoSpaceBetweenCloseParenAndAngularBracket,this.NoSpaceAfterOpenAngularBracket,this.NoSpaceBeforeCloseAngularBracket,this.NoSpaceAfterCloseAngularBracket,this.SpaceBeforeAt,this.NoSpaceAfterAt,this.SpaceAfterDecorator,this.NoSpaceBeforeNonNullAssertionOperator,this.NoSpaceAfterNewKeywordOnConstructorSignature],this.UserConfigurableRules=[this.SpaceAfterConstructor,this.NoSpaceAfterConstructor,this.SpaceAfterComma,this.NoSpaceAfterComma,this.SpaceAfterAnonymousFunctionKeyword,this.NoSpaceAfterAnonymousFunctionKeyword,this.SpaceAfterKeywordInControl,this.NoSpaceAfterKeywordInControl,this.SpaceAfterOpenParen,this.SpaceBeforeCloseParen,this.SpaceBetweenOpenParens,this.NoSpaceBetweenParens,this.NoSpaceAfterOpenParen,this.NoSpaceBeforeCloseParen,this.SpaceAfterOpenBracket,this.SpaceBeforeCloseBracket,this.NoSpaceBetweenBrackets,this.NoSpaceAfterOpenBracket,this.NoSpaceBeforeCloseBracket,this.SpaceAfterOpenBrace,this.SpaceBeforeCloseBrace,this.NoSpaceBetweenEmptyBraceBrackets,this.NoSpaceAfterOpenBrace,this.NoSpaceBeforeCloseBrace,this.SpaceAfterTemplateHeadAndMiddle,this.SpaceBeforeTemplateMiddleAndTail,this.NoSpaceAfterTemplateHeadAndMiddle,this.NoSpaceBeforeTemplateMiddleAndTail,this.SpaceAfterOpenBraceInJsxExpression,this.SpaceBeforeCloseBraceInJsxExpression,this.NoSpaceAfterOpenBraceInJsxExpression,this.NoSpaceBeforeCloseBraceInJsxExpression,this.SpaceAfterSemicolonInFor,this.NoSpaceAfterSemicolonInFor,this.SpaceBeforeBinaryOperator,this.SpaceAfterBinaryOperator,this.NoSpaceBeforeBinaryOperator,this.NoSpaceAfterBinaryOperator,this.SpaceBeforeOpenParenInFuncDecl,this.NoSpaceBeforeOpenParenInFuncDecl,this.NewLineBeforeOpenBraceInControl,this.NewLineBeforeOpenBraceInFunction,this.NewLineBeforeOpenBraceInTypeScriptDeclWithBlock,this.SpaceAfterTypeAssertion,this.NoSpaceAfterTypeAssertion],this.LowPriorityCommonRules=[this.NoSpaceBeforeSemicolon,this.SpaceBeforeOpenBraceInControl,this.SpaceBeforeOpenBraceInFunction,this.SpaceBeforeOpenBraceInTypeScriptDeclWithBlock,this.NoSpaceBeforeComma,this.NoSpaceBeforeOpenBracket,this.NoSpaceAfterCloseBracket,this.SpaceAfterSemicolon,this.SpaceBetweenStatements,this.SpaceAfterTryFinally],r.Debug.isDebugging)for(var e in this){var t=this[e];t instanceof n.Rule&&(t.debugName=e)}}n=r.formatting||(r.formatting={}),i.IsOptionEnabled=function(t){return function(e){return e.options&&e.options.hasOwnProperty(t)&&!!e.options[t]}},i.IsOptionDisabled=function(t){return function(e){return e.options&&e.options.hasOwnProperty(t)&&!e.options[t]}},i.IsOptionDisabledOrUndefined=function(t){return function(e){return!e.options||!e.options.hasOwnProperty(t)||!e.options[t]}},i.isOptionDisabledOrUndefinedOrTokensOnSameLine=function(t){return function(e){return!e.options||!e.options.hasOwnProperty(t)||!e.options[t]||e.TokensAreOnSameLine()}},i.IsOptionEnabledOrUndefined=function(t){return function(e){return!e.options||!e.options.hasOwnProperty(t)||!!e.options[t]}},i.IsForContext=function(e){return 214===e.contextNode.kind},i.IsNotForContext=function(e){return!i.IsForContext(e)},i.IsBinaryOpContext=function(e){switch(e.contextNode.kind){case 194:case 195:case 202:case 246:case 242:case 158:case 166:case 167:return!0;case 176:case 231:case 237:case 226:case 146:case 264:case 149:case 148:return 58===e.currentTokenSpan.kind||58===e.nextTokenSpan.kind;case 215:case 145:return 92===e.currentTokenSpan.kind||92===e.nextTokenSpan.kind;case 216:return 142===e.currentTokenSpan.kind||142===e.nextTokenSpan.kind}return!1},i.IsNotBinaryOpContext=function(e){return!i.IsBinaryOpContext(e)},i.IsConditionalOperatorContext=function(e){return 195===e.contextNode.kind},i.IsSameLineTokenOrBeforeBlockContext=function(e){return e.TokensAreOnSameLine()||i.IsBeforeBlockContext(e)},i.IsBraceWrappedContext=function(e){return 174===e.contextNode.kind||i.IsSingleLineBlockContext(e)},i.IsBeforeMultilineBlockContext=function(e){return i.IsBeforeBlockContext(e)&&!(e.NextNodeAllOnSameLine()||e.NextNodeBlockIsOnOneLine())},i.IsMultilineBlockContext=function(e){return i.IsBlockContext(e)&&!(e.ContextNodeAllOnSameLine()||e.ContextNodeBlockIsOnOneLine())},i.IsSingleLineBlockContext=function(e){return i.IsBlockContext(e)&&(e.ContextNodeAllOnSameLine()||e.ContextNodeBlockIsOnOneLine())},i.IsBlockContext=function(e){return i.NodeIsBlockContext(e.contextNode)},i.IsBeforeBlockContext=function(e){return i.NodeIsBlockContext(e.nextTokenParent)},i.NodeIsBlockContext=function(e){if(i.NodeIsTypeScriptDeclWithBlockContext(e))return!0;switch(e.kind){case 207:case 235:case 178:case 234:return!0}return!1},i.IsFunctionDeclContext=function(e){switch(e.contextNode.kind){case 228:case 151:case 150:case 153:case 154:case 155:case 186:case 152:case 187:case 230:return!0}return!1},i.IsFunctionDeclarationOrFunctionExpressionContext=function(e){return 228===e.contextNode.kind||186===e.contextNode.kind},i.IsTypeScriptDeclWithBlockContext=function(e){return i.NodeIsTypeScriptDeclWithBlockContext(e.contextNode)},i.NodeIsTypeScriptDeclWithBlockContext=function(e){switch(e.kind){case 229:case 199:case 230:case 232:case 163:case 233:case 244:case 245:case 238:case 241:return!0}return!1},i.IsAfterCodeBlockContext=function(e){switch(e.currentTokenParent.kind){case 229:case 233:case 232:case 260:case 234:case 221:return!0;case 207:var t=e.currentTokenParent.parent;if(!t||187!==t.kind&&186!==t.kind)return!0}return!1},i.IsControlDeclContext=function(e){switch(e.contextNode.kind){case 211:case 221:case 214:case 215:case 216:case 213:case 224:case 212:case 220:case 260:return!0;default:return!1}},i.IsObjectContext=function(e){return 178===e.contextNode.kind},i.IsFunctionCallContext=function(e){return 181===e.contextNode.kind},i.IsNewContext=function(e){return 182===e.contextNode.kind},i.IsFunctionCallOrNewContext=function(e){return i.IsFunctionCallContext(e)||i.IsNewContext(e)},i.IsPreviousTokenNotComma=function(e){return 26!==e.currentTokenSpan.kind},i.IsNextTokenNotCloseBracket=function(e){return 22!==e.nextTokenSpan.kind},i.IsArrowFunctionContext=function(e){return 187===e.contextNode.kind},i.IsNonJsxSameLineTokenContext=function(e){return e.TokensAreOnSameLine()&&10!==e.contextNode.kind},i.IsNonJsxElementContext=function(e){return 249!==e.contextNode.kind},i.IsJsxExpressionContext=function(e){return 256===e.contextNode.kind},i.IsNextTokenParentJsxAttribute=function(e){return 253===e.nextTokenParent.kind},i.IsJsxAttributeContext=function(e){return 253===e.contextNode.kind},i.IsJsxSelfClosingElementContext=function(e){return 250===e.contextNode.kind},i.IsNotBeforeBlockInFunctionDeclarationContext=function(e){return!i.IsFunctionDeclContext(e)&&!i.IsBeforeBlockContext(e)},i.IsEndOfDecoratorContextOnSameLine=function(e){return e.TokensAreOnSameLine()&&e.contextNode.decorators&&i.NodeIsInDecoratorContext(e.currentTokenParent)&&!i.NodeIsInDecoratorContext(e.nextTokenParent)},i.NodeIsInDecoratorContext=function(e){for(;r.isPartOfExpression(e);)e=e.parent;return 147===e.kind},i.IsStartOfVariableDeclarationList=function(e){return 227===e.currentTokenParent.kind&&e.currentTokenParent.getStart(e.sourceFile)===e.currentTokenSpan.pos},i.IsNotFormatOnEnter=function(e){return 2!==e.formattingRequestKind},i.IsModuleDeclContext=function(e){return 233===e.contextNode.kind},i.IsObjectTypeContext=function(e){return 163===e.contextNode.kind},i.IsConstructorSignatureContext=function(e){return 156===e.contextNode.kind},i.IsTypeArgumentOrParameterOrAssertion=function(e,t){if(27!==e.kind&&29!==e.kind)return!1;switch(t.kind){case 159:case 184:case 231:case 229:case 199:case 230:case 228:case 186:case 187:case 151:case 150:case 155:case 156:case 181:case 182:case 201:return!0;default:return!1}},i.IsTypeArgumentOrParameterOrAssertionContext=function(e){return i.IsTypeArgumentOrParameterOrAssertion(e.currentTokenSpan,e.currentTokenParent)||i.IsTypeArgumentOrParameterOrAssertion(e.nextTokenSpan,e.nextTokenParent)},i.IsTypeAssertionContext=function(e){return 184===e.contextNode.kind},i.IsVoidOpContext=function(e){return 105===e.currentTokenSpan.kind&&190===e.currentTokenParent.kind},i.IsYieldOrYieldStarWithOperand=function(e){return 197===e.contextNode.kind&&void 0!==e.contextNode.expression},i.IsNonNullAssertionContext=function(e){return 203===e.contextNode.kind},e=i,n.Rules=e})(ts=ts||{}),(n=>{var e=n.formatting||(n.formatting={});function t(e){this.mapRowLength=143,this.map=new Array(this.mapRowLength*this.mapRowLength);for(var t=new Array(this.map.length),r=0,n=e;r<n.length;r++){var i=n[r];this.FillRule(i,t)}}t.prototype.GetRuleBucketIndex=function(e,t){return n.Debug.assert(e<=142&&t<=142,"Must compute formatting context from tokens"),e*this.mapRowLength+t},t.prototype.FillRule=function(n,i){var s=this,a=n.Descriptor.LeftTokenRange.isSpecific()&&n.Descriptor.RightTokenRange.isSpecific();n.Descriptor.LeftTokenRange.GetTokens().forEach(function(r){n.Descriptor.RightTokenRange.GetTokens().forEach(function(e){var e=s.GetRuleBucketIndex(r,e),t=s.map[e];(t=void 0===t?s.map[e]=new o:t).AddRule(n,a,i,e)})})},t.prototype.GetRule=function(e){var t=this.GetRuleBucketIndex(e.currentTokenSpan.kind,e.nextTokenSpan.kind),t=this.map[t];if(t)for(var r=0,n=t.Rules();r<n.length;r++){var i=n[r];if(i.Operation.Context.InContext(e))return i}},e.RulesMap=t,(r=s=s||{})[r.IgnoreRulesSpecific=0]="IgnoreRulesSpecific",r[r.IgnoreRulesAny=5]="IgnoreRulesAny",r[r.ContextRulesSpecific=10]="ContextRulesSpecific",r[r.ContextRulesAny=15]="ContextRulesAny",r[r.NoContextRulesSpecific=20]="NoContextRulesSpecific",r[r.NoContextRulesAny=25]="NoContextRulesAny",i.prototype.GetInsertionIndex=function(e){for(var t=0,r=0,n=this.rulesInsertionIndexBitmap;r<=e;)t+=31&n,n>>=5,r+=5;return t},i.prototype.IncreaseInsertionIndex=function(e){var t=this.rulesInsertionIndexBitmap>>e&31,r=(n.Debug.assert((31&++t)==t,"Adding more rules into the sub-bucket than allowed. Maximum allowed is 32 rules."),this.rulesInsertionIndexBitmap&~(31<<e));this.rulesInsertionIndexBitmap=r|=t<<e};var s,r,a=i;function i(){this.rulesInsertionIndexBitmap=0}e.RulesBucketConstructionState=a,l.prototype.Rules=function(){return this.rules},l.prototype.AddRule=function(e,t,r,n){var t=1===e.Operation.Action?t?s.IgnoreRulesSpecific:s.IgnoreRulesAny:e.Operation.Context.IsAny()?t?s.NoContextRulesSpecific:s.NoContextRulesAny:t?s.ContextRulesSpecific:s.ContextRulesAny,i=r[n],r=(i=void 0===i?r[n]=new a:i).GetInsertionIndex(t);this.rules.splice(r,0,e),i.IncreaseInsertionIndex(t)};var o=l;function l(){this.rules=[]}e.RulesBucket=o})(ts=ts||{}),(s=>{for(var e=(e=s.formatting||(s.formatting={})).Shared||(e.Shared={}),r=[],t=0;t<=142;t++)r.push(t);n.prototype.GetTokens=function(){return this.tokens},n.prototype.Contains=function(e){return 0<=this.tokens.indexOf(e)},n.prototype.isSpecific=function(){return!0};var a=n;function n(e){this.tokens=e=void 0===e?[]:e}o.prototype.GetTokens=function(){return[this.token]},o.prototype.Contains=function(e){return e===this.token},o.prototype.isSpecific=function(){return!0};var i=o;function o(e){this.token=e}c.prototype.GetTokens=function(){return r},c.prototype.Contains=function(){return!0},c.prototype.toString=function(){return"[allTokens]"},c.prototype.isSpecific=function(){return!1};var l=c;function c(){}d.prototype.GetTokens=function(){var t=this;return r.filter(function(e){return e!==t.except})},d.prototype.Contains=function(e){return e!==this.except},d.prototype.isSpecific=function(){return!1};var u=d;function d(e){this.except=e}(e=e.TokenRange||(e.TokenRange={})).FromToken=function(e){return new i(e)},e.FromTokens=function(e){return new a(e)},e.FromRange=function(e,t,r){void 0===r&&(r=[]);for(var n=[],i=e;i<=t;i++)s.indexOf(r,i)<0&&n.push(i);return new a(n)},e.AnyExcept=function(e){return new u(e)},e.Any=new l,e.AnyIncludingMultilineComments=e.FromTokens(r.concat([3])),e.Keywords=e.FromRange(72,142),e.BinaryOperators=e.FromRange(27,70),e.BinaryKeywordOperators=e.FromTokens([92,93,142,118,126]),e.UnaryPrefixOperators=e.FromTokens([43,44,52,51]),e.UnaryPrefixExpressions=e.FromTokens([8,71,19,21,17,99,94]),e.UnaryPreincrementExpressions=e.FromTokens([71,19,99,94]),e.UnaryPostincrementExpressions=e.FromTokens([71,20,22,94]),e.UnaryPredecrementExpressions=e.FromTokens([71,19,99,94]),e.UnaryPostdecrementExpressions=e.FromTokens([71,20,22,94]),e.Comments=e.FromTokens([2,3]),e.TypeNames=e.FromTokens([71,133,136,122,137,105,119])})(ts=ts||{}),(t=>{var r;function e(){this.globalRules=new r.Rules;var e=this.globalRules.HighPriorityCommonRules.concat(this.globalRules.UserConfigurableRules).concat(this.globalRules.LowPriorityCommonRules);this.rulesMap=new r.RulesMap(e)}r=t.formatting||(t.formatting={}),e.prototype.getRulesMap=function(){return this.rulesMap},e.prototype.getFormatOptions=function(){return this.options},e.prototype.ensureUpToDate=function(e){this.options&&t.compareDataObjects(this.options,e)||(this.options=t.clone(e))},r.RulesProvider=e})(ts=ts||{}),(O=>{var R,a,o,l;function s(e,t,r){r=O.findPrecedingToken(e,r);return r&&r.kind===t&&e===r.getEnd()?r:void 0}function c(e){for(var t=e;t&&t.parent&&t.parent.end===e.end&&!((e,t)=>{switch(e.kind){case 229:case 230:return O.rangeContainsRange(e.members,t);case 233:var r=e.body;return r&&234===r.kind&&O.rangeContainsRange(r.statements,t);case 265:case 207:case 234:return O.rangeContainsRange(e.statements,t);case 260:return O.rangeContainsRange(e.block.statements,t)}})(t.parent,t);)t=t.parent;return t}function i(n,i){return function e(t){var r=O.forEachChild(t,function(e){return O.startEndContainsRange(e.getStart(i),e.end,n)&&e});if(r){r=e(r);if(r)return r}return t}(i)}function u(e,t,r,n,i){return e?d({pos:O.getLineStartPositionForPosition(e.getStart(t),t),end:e.end},t,r,n,i):[]}function d(s,a,o,l,c){var e,t,r,n,u=i(s,a);return R.getFormattingScanner(a.text,a.languageVariant,(t=s,r=a,(n=(e=u).getStart(r))===t.pos&&e.end===t.end?n:!(n=O.findPrecedingToken(t.pos,r))||n.end>=t.pos?e.pos:n.end),s.end,function(e){return p(s,u,R.SmartIndenter.getIndentationForNode(u,s,a,o),((e,t,r)=>{for(var n,i=-1;e;){var s=r.getLineAndCharacterOfPosition(e.getStart(r)).line;if(-1!==i&&s!==i)break;if(R.SmartIndenter.shouldIndentChildNode(e,n))return t.indentSize;i=s,e=(n=e).parent}return 0})(u,o,a),e,o,l,c,(e=a.parseDiagnostics,r=s,e.length&&(n=e.filter(function(e){return O.rangeOverlapsWithStartEnd(r,e.start,e.start+e.length)}).sort(function(e,t){return e.start-t.start})).length?(i=0,function(e){for(;;){if(i>=n.length)return!1;var t=n[i];if(e.end<=t.start)return!1;if(O.startEndOverlapsWithStartEnd(e.pos,e.end,t.start,t.start+t.length))return!0;i++}}):t),a);function t(){return!1}var r,n,i})}function p(y,e,t,r,b,g,c,n,v,T){var k,a,o,x,E,u=new R.FormattingContext(T,n,g),i=[];return b.advance(),b.isOnToken()&&(n=T.getLineAndCharacterOfPosition(e.getStart(T)).line,function h(m,e,t,r,n,i){if(!O.rangeOverlapsWithStartEnd(y,m.getStart(T),m.getEnd()))return;var s=w(m,t,n,i);var _=e;O.forEachChild(m,function(e){g(e,-1,m,s,t,r,!1)},function(e){o(e,m,t,s)});for(;b.isOnToken();){var a=b.readTokenInfo(m);if(a.token.end>m.end)break;f(a,m,s,m)}function g(e,t,r,n,i,s,a,o){var l,c=e.getStart(T),u=T.getLineAndCharacterOfPosition(c).line,d=u,p=(e.decorators&&(d=T.getLineAndCharacterOfPosition(O.getNonDecoratorTokenPosOfNode(e,T)).line),-1);if(a&&O.rangeContainsRange(y,r)&&-1!==(p=S(c,e.end,i,y,t))&&(t=p),O.rangeOverlapsWithStartEnd(y,e.pos,e.end)){if(0!==e.getFullWidth()){for(;b.isOnToken();){if((l=b.readTokenInfo(m)).token.end>c)break;f(l,m,n,m)}b.isOnToken()&&(O.isToken(e)&&10!==e.kind?(l=b.readTokenInfo(e),O.Debug.assert(l.token.end===e.end,"Token end is child end"),f(l,m,n,e)):(a=147===e.kind?u:s,i=C(e,u,p,m,n,a),h(e,_,u,d,i.indentation,i.delta),_=m,o&&177===r.kind&&-1===t&&(t=i.indentation)))}}else e.end<y.pos&&b.skipToEndOf(e);return t}function o(e,t,r,n){O.Debug.assert(O.isNodeArray(e));var i,s=L(t,e),a=P(s),o=n,l=r;if(0!==s)for(;b.isOnToken();){if((c=b.readTokenInfo(t)).token.end>e.pos)break;c.token.kind===s?(l=T.getLineAndCharacterOfPosition(c.token.pos).line,i=C(c.token,l,-1,t,n,r),o=w(t,r,i.indentation,i.delta),f(c,t,o,t)):f(c,t,n,t)}for(var c,u=-1,d=0;d<e.length;d++){var p=e[d];u=g(p,u,m,o,l,l,!0,0===d)}0!==a&&b.isOnToken()&&(c=b.readTokenInfo(t)).token.kind===a&&O.rangeContainsRange(t,c.token)&&f(c,t,o,t)}function f(e,t,r,n){O.Debug.assert(O.rangeContainsRange(t,e.token));var i,s,a=b.lastTrailingTriviaWasNewLine(),o=!1,l=(e.leadingTrivia&&I(e.leadingTrivia,t,_,r),O.rangeContainsRange(y,e.token)),c=T.getLineAndCharacterOfPosition(e.token.pos);if(l&&(s=v(e.token),u=k,i=A(e.token,c,t,_,r),o=!s&&(void 0!==i?i:(s=u&&T.getLineAndCharacterOfPosition(u.end).line,a&&c.line!==s))),e.trailingTrivia&&I(e.trailingTrivia,t,_,r),o){var u=l&&!v(e.token)?r.getIndentationForToken(c.line,e.token.kind,n):-1,d=!0;if(e.leadingTrivia)for(var p=r.getIndentationForComment(e.token.kind,u,n),h=0,m=e.leadingTrivia;h<m.length;h++){var g=m[h],f=O.rangeContainsRange(y,g);switch(g.kind){case 3:f&&N(g,p,!d),d=!1;break;case 2:d&&f&&D(g.pos,p,!1),d=!1;break;case 4:d=!0}}-1!==u&&d&&(D(e.token.pos,u,i),x=c.line,E=u)}b.advance(),_=t}}(e,e,n=n,n=e.decorators?T.getLineAndCharacterOfPosition(O.getNonDecoratorTokenPosOfNode(e,T)).line:n,t,r)),b.isOnToken()||(n=b.getCurrentLeadingTrivia())&&(I(n,e,e,void 0),t=k?k.end:y.pos,t=T.getLineAndCharacterOfPosition(t).line,r=T.getLineAndCharacterOfPosition(y.end).line,d(t,r+1,k)),i;function S(e,t,r,n,i){if(O.rangeOverlapsWithStartEnd(n,e,t)||O.rangeContainsStartEnd(n,e,t)){if(-1!==i)return i}else{var n=T.getLineAndCharacterOfPosition(e).line,t=O.getLineStartPositionForPosition(e,T),i=R.SmartIndenter.findFirstNonWhitespaceColumn(t,e,T,g);if(n!==r||e===i)return i<(t=R.SmartIndenter.getBaseIndentation(g))?t:i}return-1}function C(e,t,r,n,i,s){var a=R.SmartIndenter.shouldIndentChildNode(e)?g.indentSize:0;return s===t?(r=t===x?E:i.getIndentation(),a=Math.min(g.indentSize,i.getDelta(e)+a)):-1===r&&(r=R.SmartIndenter.childStartsOnTheSameLineWithElseInIfStatement(n,e,t,T)?i.getIndentation():i.getIndentation()+i.getDelta(e)),{indentation:r,delta:a}}function w(n,i,s,a){return{getIndentationForComment:function(e,t,r){switch(e){case 18:case 22:case 20:return s+o(a,r)}return-1!==t?t:s},getIndentationForToken:function(e,t,r){if(i!==e&&n.decorators&&t===(e=>{if(e.modifiers&&e.modifiers.length)return e.modifiers[0].kind;switch(e.kind){case 229:return 75;case 230:return 109;case 228:return 89;case 232:return 232;case 153:return 125;case 154:return 135;case 151:if(e.asteriskToken)return 39;case 149:case 146:return O.getNameOfDeclaration(e).kind}})(n))return s;switch(t){case 17:case 18:case 19:case 20:case 82:case 106:case 57:return s;case 41:case 29:if(251===r.kind||252===r.kind||250===r.kind)return s;break;case 21:case 22:if(172!==r.kind)return s}return i!==e?s+o(a,r):s},getIndentation:function(){return s},getDelta:function(e){return o(a,e)},recomputeIndentation:function(e){n.parent&&R.SmartIndenter.shouldIndentChildNode(n.parent,n)&&(e?s+=g.indentSize:s-=g.indentSize,a=R.SmartIndenter.shouldIndentChildNode(n)?g.indentSize:0)}};function o(e,t){return R.SmartIndenter.nodeWillIndentChild(n,t,!0)?e:0}}function I(e,t,r,n){for(var i=0,s=e;i<s.length;i++){var a=s[i];O.isComment(a.kind)&&O.rangeContainsRange(y,a)&&A(a,T.getLineAndCharacterOfPosition(a.pos),t,r,n)}}function A(e,t,r,n,i){var s;return v(e)||(k?s=((e,t,r,n,i,s,a,o)=>{u.updateContext(n,s,e,r,a);var l,s=c.getRulesMap().GetRule(u);return a=!(s&&(((e,t,r,n,i)=>{switch(e.Operation.Action){case 1:return;case 8:t.end!==n.pos&&f(t.end,n.pos-t.end);break;case 4:1!==e.Flag&&r!==i||1!=i-r&&_(t.end,n.pos-t.end,g.newLineCharacter);break;case 2:1!==e.Flag&&r!==i||1==n.pos-t.end&&32===T.text.charCodeAt(t.end)||_(t.end,n.pos-t.end," ")}})(s,n,i,e,t),10&s.Operation.Action&&t!==i?(l=!1,r.getStart(T)===e.pos&&o.recomputeIndentation(!1)):4&s.Operation.Action&&t===i&&(l=!0,r.getStart(T)===e.pos)&&o.recomputeIndentation(!0),8&s.Operation.Action||1===s.Flag)),t!==i&&a&&d(i,t,n),l})(e,t.line,r,k,o,a,n,i):d(T.getLineAndCharacterOfPosition(y.pos).line,t.line)),k=e,a=r,o=t.line,s}function D(e,t,r){var n=M(t,g);r?_(e,0,n):(r=T.getLineAndCharacterOfPosition(e),t===((e,t)=>{for(var r=0,n=0;n<t;n++)9===T.text.charCodeAt(e+n)?r+=g.tabSize-r%g.tabSize:r++;return r})(e=O.getStartPositionOfLine(r.line,T),r.character)&&n===T.text.substr(e,n.length)||_(e,r.character,n))}function N(e,t,r){var n=T.getLineAndCharacterOfPosition(e.pos).line,i=T.getLineAndCharacterOfPosition(e.end).line;if(n===i)r||D(e.pos,t,!1);else{for(var s=[],a=e.pos,o=n;o<i;o++){var l=O.getEndLinePosition(o,T);s.push({pos:a,end:l}),a=O.getStartPositionOfLine(o+1,T)}s.push({pos:a,end:e.end});var e=O.getStartPositionOfLine(n,T),c=R.SmartIndenter.findFirstNonWhitespaceCharacterAndColumn(e,s[0].pos,T,g);if(t!==c.column)for(var e=0,u=(r&&(e=1,n++),t-c.column),d=e;d<s.length;d++,n++){var p=O.getStartPositionOfLine(n,T),h=0===d?c:R.SmartIndenter.findFirstNonWhitespaceCharacterAndColumn(s[d].pos,s[d].end,T,g),m=h.column+u;0<m?(m=M(m,g),_(p,h.character,m)):f(p,h.character)}}}function d(e,t,r){for(var n=e;n<t;n++){var i,s=O.getStartPositionOfLine(n,T),a=O.getEndLinePosition(n,T);r&&(O.isComment(r.kind)||O.isStringOrRegularExpressionOrTemplateLiteral(r.kind))&&r.pos<=a&&r.end>a||-1!==(i=((e,t)=>{for(var r=t;e<=r&&O.isWhiteSpaceSingleLine(T.text.charCodeAt(r));)r--;return r===t?-1:r+1})(s,a))&&(O.Debug.assert(i===s||!O.isWhiteSpaceSingleLine(T.text.charCodeAt(i-1))),f(i,a+1-i))}}function s(e,t,r){return{span:O.createTextSpan(e,t),newText:r}}function f(e,t){t&&i.push(s(e,t,""))}function _(e,t,r){(t||r)&&i.push(s(e,t,r))}}function L(e,t){switch(e.kind){case 152:case 228:case 186:case 151:case 150:case 187:if(e.typeParameters===t)return 27;if(e.parameters===t)return 19;break;case 181:case 182:if(e.typeArguments===t)return 27;if(e.arguments===t)return 19;break;case 159:if(e.typeArguments===t)return 27}return 0}function P(e){switch(e){case 19:return 20;case 27:return 29}return 0}function M(e,t){var r,n,i;return(!a||a.tabSize!==t.tabSize||a.indentSize!==t.indentSize)&&(a={tabSize:t.tabSize,indentSize:t.indentSize},o=l=void 0),t.convertTabsToSpaces?(i=void 0,r=Math.floor(e/t.indentSize),n=e%t.indentSize,void 0===(l=l||[])[r]?(i=s(" ",t.indentSize*r),l[r]=i):i=l[r],n?i+s(" ",n):i):(n=e-(r=Math.floor(e/t.tabSize))*t.tabSize,(i=void 0)===(o=o||[])[r]?o[r]=i=s("\t",r):i=o[r],n?i+s(" ",n):i);function s(e,t){for(var r="",n=0;n<t;n++)r+=e;return r}}(R=O.formatting||(O.formatting={})).formatOnEnter=function(e,t,r,n){if(0===(e=t.getLineAndCharacterOfPosition(e).line))return[];for(var i=O.getEndLinePosition(e,t);O.isWhiteSpaceSingleLine(t.text.charCodeAt(i));)i--;return O.isLineBreak(t.text.charCodeAt(i))&&i--,d({pos:O.getStartPositionOfLine(e-1,t),end:i+1},t,n,r,2)},R.formatOnSemicolon=function(e,t,r,n){return u(c(s(e,25,t)),t,n,r,3)},R.formatOnOpeningCurly=function(e,t,r,n){var i=s(e,17,t);return i?(i=c(i.parent),d({pos:O.getLineStartPositionForPosition(i.getStart(t),t),end:e},t,n,r,4)):[]},R.formatOnClosingCurly=function(e,t,r,n){return u(c(s(e,18,t)),t,n,r,5)},R.formatDocument=function(e,t,r){return d({pos:0,end:e.text.length},e,r,t,0)},R.formatSelection=function(e,t,r,n,i){return d({pos:O.getLineStartPositionForPosition(e,r),end:t},r,i,n,1)},R.formatNodeGivenIndentation=function(t,r,e,n,i,s){var a={pos:0,end:r.text.length};return R.getFormattingScanner(r.text,e,a.pos,a.end,function(e){return p(a,t,n,i,e,s.getFormatOptions(),s,1,function(e){return!1},r)})},R.getRangeOfEnclosingComment=function(e,t,r,n,i,s){var a=(i=void 0===i?O.getTokenAtPosition(e,t,!1):i).getStart(e);if(!(a<=t&&t<i.getEnd())){a=(n=void 0===n?O.findPrecedingToken(t,e):n)&&O.getTrailingCommentRanges(e.text,n.end),n=O.getLeadingCommentRangesOfNode(i,e),i=a&&n?a.concat(n):a||n;if(i)for(var o=0,l=i;o<l.length;o++){var c=l[o];if(c.pos<t&&t<c.end||t===c.end&&(2===c.kind||t===e.getFullWidth()))return 3!==c.kind&&r||s&&!s(c)?void 0:c}}},R.getIndentationString=M})(ts=ts||{}),(_=>{var y,b;function v(e){return e.baseIndentSize||0}function T(e,t,r,n,i,s){for(var a,o,l,c,u,d=e.parent;d;){var p=!0;if(p=r?(h=e.getStart(i))<r.pos||h>r.end:p)if(-1!==(m=S(e,i,s)))return m+n;var h,m,g=(h=((e,t,r)=>(t=(t=E(t,r))?t.pos:e.getStart(r),r.getLineAndCharacterOfPosition(t)))(d,e,i)).line===t.line||x(d,e,t.line,i);if(p){if(p=e,a=d,o=t,l=g,c=i,u=s,-1!==(m=!_.isDeclaration(p)&&!_.isStatementButNotDeclaration(p)||265!==a.kind&&l?-1:I(o,c,u)))return m+n;if(-1!==(m=C(e,i,s)))return m+n}N(d,e)&&!g&&(n+=s.indentSize);p=f(d,e,t.line,i),d=(e=d).parent;t=p?i.getLineAndCharacterOfPosition(e.getStart()):h}return n+v(s)}function k(e,t){return t.getLineAndCharacterOfPosition(e.getStart(t))}function f(e,t,r,n){return!(!_.isCallExpression(e)||!_.contains(e.arguments,t))&&(t=e.expression.getEnd(),_.getLineAndCharacterOfPosition(n,t).line===r)}function x(e,t,r,n){return 211===e.kind&&e.elseStatement===t&&(t=_.findChildOfKind(e,82,n),_.Debug.assert(void 0!==t),k(t,n).line===r)}function n(e,t,r){return e&&_.rangeContainsStartEnd(e,t,r)?e:void 0}function E(e,t){if(e.parent)switch(e.parent.kind){case 159:return n(e.parent.typeArguments,e.getStart(t),e.getEnd());case 178:return e.parent.properties;case 177:return e.parent.elements;case 228:case 186:case 187:case 151:case 150:case 155:case 152:case 161:case 156:var r=e.getStart(t);return n(e.parent.typeParameters,r,e.getEnd())||n(e.parent.parameters,r,e.getEnd());case 229:return n(e.parent.typeParameters,e.getStart(t),e.getEnd());case 182:case 181:r=e.getStart(t);return n(e.parent.typeArguments,r,e.getEnd())||n(e.parent.arguments,r,e.getEnd());case 227:return n(e.parent.declarations,e.getStart(t),e.getEnd());case 241:case 245:return n(e.parent.elements,e.getStart(t),e.getEnd())}}function S(e,t,r){var n=E(e,t);return n&&(n=n,-1!==(e=_.indexOf(n,e)))?w(n,e,t,r):-1}function C(e,t,r){var n;return 20===e.kind||!e.parent||!_.isCallOrNewExpression(e.parent)||e.parent.expression===e||(e=e.parent.expression)===(n=(e=>{for(;;)switch(e.kind){case 181:case 182:case 179:case 180:e=e.expression;break;default:return e}})(e))||(e=t.getLineAndCharacterOfPosition(e.end),n=t.getLineAndCharacterOfPosition(n.end),e.line===n.line)?-1:I(e,t,r)}function w(e,t,r,n){_.Debug.assert(0<=t&&t<e.length);for(var i=k(e[t],r),s=t-1;0<=s;s--)if(26!==e[s].kind){if(r.getLineAndCharacterOfPosition(e[s].end).line!==i.line)return I(i,r,n);i=k(e[s],r)}return-1}function I(e,t,r){var n=t.getPositionOfLineAndCharacter(e.line,0);return D(n,n+e.character,t,r)}function A(e,t,r,n){for(var i=0,s=0,a=e;a<t;a++){var o=r.text.charCodeAt(a);if(!_.isWhiteSpaceSingleLine(o))break;9===o?s+=n.tabSize+s%n.tabSize:s++,i++}return{column:s,character:i}}function D(e,t,r,n){return A(e,t,r,n).column}function r(e,t,r){var n=t?t.kind:0;switch(e.kind){case 212:case 213:case 215:case 216:case 214:case 211:case 228:case 186:case 151:case 187:case 152:case 153:case 154:return 207!==n;case 244:return 245!==n;case 238:return 239!==n||t.namedBindings&&241!==t.namedBindings.kind;case 249:return 252!==n}return r}function N(e,t){return(e=>{switch(e){case 210:case 229:case 199:case 230:case 232:case 231:case 177:case 207:case 234:case 178:case 163:case 172:case 165:case 235:case 258:case 257:case 185:case 179:case 181:case 182:case 208:case 226:case 243:case 219:case 195:case 175:case 174:case 251:case 250:case 256:case 150:case 155:case 156:case 146:case 160:case 161:case 168:case 183:case 191:case 245:case 241:case 246:case 242:case 261:case 149:return!0}return!1})(e.kind)||r(e,t,!1)}y=_.formatting||(_.formatting={}),(b=y.SmartIndenter||(y.SmartIndenter={})).getIndentation=function(e,t,r,n){if(void 0===n&&(n=!1),e>t.text.length)return v(r);if(r.indentStyle===_.IndentStyle.None)return 0;var i,s,a=_.findPrecedingToken(e,t),o=y.getRangeOfEnclosingComment(t,e,!0,a||null);if(o)return i=_.getLineAndCharacterOfPosition(t,e).line-1,o=_.getLineAndCharacterOfPosition(t,o.pos).line,_.Debug.assert(0<=o),i<=o?D(_.getStartPositionOfLine(o,t),e,t,r):0!==(s=(i=A(o=_.getStartPositionOfLine(i,t),e,t,r)).column)&&42===t.text.charCodeAt(o+i.character)?s-1:s;if(!a)return v(r);if(_.isStringOrRegularExpressionOrTemplateLiteral(a.kind)&&a.getStart(t)<=e&&e<a.end)return 0;var l,c=t.getLineAndCharacterOfPosition(e).line;if(r.indentStyle===_.IndentStyle.Block){for(var u=e;0<u;){var d=t.text.charCodeAt(u);if(!_.isWhiteSpaceLike(d))break;u--}o=_.getLineStartPositionForPosition(u,t);return b.findFirstNonWhitespaceColumn(o,u,t,r)}if(26===a.kind&&194!==a.parent.kind&&-1!==(p=((e,t,r)=>(e=_.findListItemInfo(e))&&0<e.listItemIndex?w(e.list.getChildren(),e.listItemIndex-1,t,r):-1)(a,t,r)))return p;for(var p,h=a;h;){if(_.positionBelongsToNode(h,e,t)&&N(h,l)){var m=k(h,t),g=((e,t,r,n)=>{if(e=_.findNextToken(e,t)){if(17===e.kind)return 1;if(18===e.kind)return t=k(e,n).line,r===t?2:0}return 0})(a,h,c,t),f=0!==g?n&&2===g?r.indentSize:0:c!==m.line?r.indentSize:0;break}if(-1!==(p=S(h,t,r)))return p;if(-1!==(p=C(h,t,r)))return p+r.indentSize;h=(l=h).parent}return h?T(h,m,void 0,f,t,r):v(r)},b.getIndentationForNode=function(e,t,r,n){var i=r.getLineAndCharacterOfPosition(e.getStart(r));return T(e,i,t,0,r,n)},b.getBaseIndentation=v,b.isArgumentAndStartLineOverlapsExpressionBeingCalled=f,b.childStartsOnTheSameLineWithElseInIfStatement=x,b.getContainingList=E,b.findFirstNonWhitespaceCharacterAndColumn=A,b.findFirstNonWhitespaceColumn=D,b.nodeWillIndentChild=r,b.shouldIndentChildNode=N})(ts=ts||{}),(d=>{var a,p,e,t=d.textChanges||(d.textChanges={});function s(e){e=e.__pos;return d.Debug.assert("number"==typeof e),e}function i(e,t){d.Debug.assert("number"==typeof t),e.__pos=t}function o(e){e=e.__end;return d.Debug.assert("number"==typeof e),e}function l(e,t){d.Debug.assert("number"==typeof t),e.__end=t}function h(e,t){return d.skipTrivia(e,t,!1,!0)}function c(e,t,r,n){var i;return r.useNonAdjustedStartPosition?t.getFullStart():(r=t.getFullStart())===(t=t.getStart(e))?t:(i=d.getLineStartPositionForPosition(r,e),d.getLineStartPositionForPosition(t,e)===i?n===a.Start?t:r:(n=0<r?1:0,t=d.getStartPositionOfLine(d.getLineOfLocalPosition(e,i)+n,e),t=h(e.text,t),d.getStartPositionOfLine(d.getLineOfLocalPosition(e,t),e)))}function u(e,t,r){return r.useNonAdjustedEndPosition||d.isExpression(t)?t.getEnd():(r=t.getEnd(),(t=d.skipTrivia(e.text,r,!0))!==r&&d.isLineBreak(e.text.charCodeAt(t-1))?t:r)}function m(e,t){return t&&e.parent&&(26===t.kind||25===t.kind&&178===e.parent.kind)}function g(e,t,r){this.newLine=e,this.rulesProvider=t,this.validator=r,this.changes=[],this.newLineCharacter=d.getNewLineCharacter({newLine:e})}function f(e,t){for(var r=t.length-1;0<=r;r--){var n=t[r];e=""+e.substring(0,n.span.start)+n.newText+e.substring(d.textSpanEnd(n.span))}return e}function _(e){var t=d.visitEachChild(e,_,d.nullTransformationContext,r,_),t=d.nodeIsSynthesized(t)?t:Object.create(t);return t.pos=s(e),t.end=o(e),t}function r(e,t,r,n,i){t=d.visitNodes(e,t,r,n,i);return t&&((r=t===e?d.createNodeArray(t.slice(0)):t).pos=s(e),r.end=o(e),r)}(e=a=t.Position||(t.Position={}))[e.FullStart=0]="FullStart",e[e.Start=1]="Start",(e=p=p||{})[e.Remove=0]="Remove",e[e.ReplaceWithSingleNode=1]="ReplaceWithSingleNode",e[e.ReplaceWithMultipleNodes=2]="ReplaceWithMultipleNodes",t.getSeparatorCharacter=function(e){return d.tokenToString(e.kind)},t.getAdjustedStartPosition=c,t.getAdjustedEndPosition=u,g.fromContext=function(e){return new g("\n"===e.newLineCharacter?1:0,e.rulesProvider)},g.with=function(e,t){e=g.fromContext(e);return t(e),e.getChanges()},g.prototype.deleteRange=function(e,t){return this.changes.push({kind:p.Remove,sourceFile:e,range:t}),this},g.prototype.deleteNode=function(e,t,r){var n=c(e,t,r=void 0===r?{}:r,a.FullStart),t=u(e,t,r);return this.changes.push({kind:p.Remove,sourceFile:e,range:{pos:n,end:t}}),this},g.prototype.deleteNodeRange=function(e,t,r,n){t=c(e,t,n=void 0===n?{}:n,a.FullStart),r=u(e,r,n);return this.changes.push({kind:p.Remove,sourceFile:e,range:{pos:t,end:r}}),this},g.prototype.deleteNodeInList=function(e,t){var r,n,i,s=d.formatting.SmartIndenter.getContainingList(t,e);return s?(r=d.indexOfNode(s,t))<0||(1===s.length?this.deleteNode(e,t):r!==s.length-1?(i=d.getTokenAtPosition(e,t.end,!1))&&m(t,i)&&(i=d.skipTrivia(e.text,c(e,t,{},a.FullStart),!1,!0),n=s[r+1],n=d.skipTrivia(e.text,c(e,n,{},a.FullStart),!1,!0),this.deleteRange(e,{pos:i,end:n})):(i=d.getTokenAtPosition(e,s[r-1].end,!1))&&m(t,i)&&this.deleteNodeRange(e,i,t)):d.Debug.fail("node is not a list element"),this},g.prototype.replaceRange=function(e,t,r,n){return this.changes.push({kind:p.ReplaceWithSingleNode,sourceFile:e,range:t,options:n=void 0===n?{}:n,node:r}),this},g.prototype.replaceNode=function(e,t,r,n){var i=c(e,t,n=void 0===n?{}:n,a.Start),t=u(e,t,n);return this.replaceWithSingle(e,i,t,r,n)},g.prototype.replaceNodeRange=function(e,t,r,n,i){t=c(e,t,i=void 0===i?{}:i,a.Start),r=u(e,r,i);return this.replaceWithSingle(e,t,r,n,i)},g.prototype.replaceWithSingle=function(e,t,r,n,i){return this.changes.push({kind:p.ReplaceWithSingleNode,sourceFile:e,options:i,node:n,range:{pos:t,end:r}}),this},g.prototype.replaceWithMultiple=function(e,t,r,n,i){return this.changes.push({kind:p.ReplaceWithMultipleNodes,sourceFile:e,options:i,nodes:n,range:{pos:t,end:r}}),this},g.prototype.replaceNodeWithNodes=function(e,t,r,n){var i=c(e,t,n,a.Start),t=u(e,t,n);return this.replaceWithMultiple(e,i,t,r,n)},g.prototype.replaceNodesWithNodes=function(e,t,r,n){var i=c(e,t[0],n,a.Start),t=u(e,d.lastOrUndefined(t),n);return this.replaceWithMultiple(e,i,t,r,n)},g.prototype.replaceRangeWithNodes=function(e,t,r,n){return this.replaceWithMultiple(e,t.pos,t.end,r,n)},g.prototype.replaceNodeRangeWithNodes=function(e,t,r,n,i){t=c(e,t,i,a.Start),r=u(e,r,i);return this.replaceWithMultiple(e,t,r,n,i)},g.prototype.insertNodeAt=function(e,t,r,n){return this.changes.push({kind:p.ReplaceWithSingleNode,sourceFile:e,options:n=void 0===n?{}:n,node:r,range:{pos:t,end:t}}),this},g.prototype.insertNodeBefore=function(e,t,r,n){t=c(e,t,n=void 0===n?{}:n,a.Start);return this.replaceWithSingle(e,t,t,r,n)},g.prototype.insertNodeAfter=function(e,t,r,n){void 0===n&&(n={}),!d.isStatementButNotDeclaration(t)&&149!==t.kind&&148!==t.kind&&150!==t.kind||59===e.text.charCodeAt(t.end-1)||this.changes.push({kind:p.ReplaceWithSingleNode,sourceFile:e,options:{},range:{pos:t.end,end:t.end},node:d.createToken(25)});t=u(e,t,n);return this.replaceWithSingle(e,t,t,r,n)},g.prototype.insertNodeInListAfter=function(e,t,r){var n,i,s,a,o,l,c,u=d.formatting.SmartIndenter.getContainingList(t,e);return u?(n=d.indexOfNode(u,t))<0||(i=t.getEnd(),n!==u.length-1?(c=d.getTokenAtPosition(e,t.end,!1))&&m(t,c)&&(a=d.getLineAndCharacterOfPosition(e,h(e.text,u[n+1].getFullStart())),o=l=void 0,(s=d.getLineAndCharacterOfPosition(e,c.end)).line===a.line?(o=c.end,l=(e=>{for(var t="",r=0;r<e;r++)t+=" ";return t})(a.character-s.character)):o=d.getStartPositionOfLine(a.line,e),this.changes.push({kind:p.ReplaceWithSingleNode,sourceFile:e,range:{pos:o,end:u[n+1].getStart(e)},node:r,options:{prefix:l,suffix:""+d.tokenToString(c.kind)+e.text.substring(c.end,u[n+1].getStart(e))}})):(s=t.getStart(e),a=d.getLineStartPositionForPosition(s,e),o=void 0,l=!1,1===u.length?o=26:(o=m(t,c=d.findPrecedingToken(t.pos,e))?c.kind:26,l=d.getLineStartPositionForPosition(u[n-1].getStart(e),e)!==a),(l=((e,t)=>{for(var r=t;r<e.length;){var n=e.charCodeAt(r);if(!d.isWhiteSpaceSingleLine(n))return 47===n;r++}})(e.text,t.end)?!0:l)?(this.changes.push({kind:p.ReplaceWithSingleNode,sourceFile:e,range:{pos:i,end:i},node:d.createToken(o),options:{}}),c=d.formatting.SmartIndenter.findFirstNonWhitespaceColumn(a,s,e,this.rulesProvider.getFormatOptions()),(u=d.skipTrivia(e.text,i,!0,!1))!==i&&d.isLineBreak(e.text.charCodeAt(u-1))&&u--,this.changes.push({kind:p.ReplaceWithSingleNode,sourceFile:e,range:{pos:u,end:u},node:r,options:{indentation:c,prefix:this.newLineCharacter}})):this.changes.push({kind:p.ReplaceWithSingleNode,sourceFile:e,range:{pos:i,end:i},node:r,options:{prefix:d.tokenToString(o)+" "}}))):d.Debug.fail("node is not a list element"),this},g.prototype.getChanges=function(){for(var a=this,e=d.createMap(),t=0,r=this.changes;t<r.length;t++){var n=r[t],i=e.get(n.sourceFile.path);i||e.set(n.sourceFile.path,i=[]),i.push(n)}var o=[];return e.forEach(function(e){for(var t=e[0].sourceFile,r={fileName:t.fileName,textChanges:[]},n=0,i=g.normalize(e);n<i.length;n++){var s=i[n];r.textChanges.push({span:a.computeSpan(s,t),newText:a.computeNewText(s,t)})}o.push(r)}),o},g.prototype.computeSpan=function(e,t){return d.createTextSpanFromBounds(e.range.pos,e.range.end)},g.prototype.computeNewText=function(e,t){var r,n,i,s=this;return e.kind===p.Remove?"":(r=e.options||{},n=e.range.pos,i=d.getLineStartPositionForPosition(n,t)===n,e=e.kind===p.ReplaceWithMultipleNodes?e.nodes.map(function(e){return s.getFormattedTextOfNode(e,t,n,r)}).join(e.options.nodeSeparator):(d.Debug.assert(e.kind===p.ReplaceWithSingleNode,"change.kind === ReplaceWithSingleNode"),this.getFormattedTextOfNode(e.node,t,n,r)),e=i||void 0!==r.indentation?e:e.replace(/^\s+/,""),(r.prefix||"")+e+(r.suffix||""))},g.prototype.getFormattedTextOfNode=function(e,t,r,n){l=e,a=t,s={newLine:s=this.newLine,target:a&&a.languageVersion},o=new y(d.getNewLineCharacter(s)),d.createPrinter(s,o).writeNode(4,l,a,o);var i,s={text:o.getText(),node:_(l)},a=(this.validator&&this.validator(s),this.rulesProvider.getFormatOptions()),o=d.getLineStartPositionForPosition(r,t)===r,l=void 0!==n.indentation?n.indentation:!1!==n.useIndentationFromFile?d.formatting.SmartIndenter.getIndentation(r,t,a,o||n.prefix===this.newLineCharacter):0,r=void 0!==n.delta?n.delta:d.formatting.SmartIndenter.shouldIndentChildNode(e)&&a.indentSize||0;return o=s,n=t,e=l,a=r,s=this.rulesProvider,i=d.computeLineStarts(o.text),t={text:o.text,lineMap:i,getLineAndCharacterOfPosition:function(e){return d.computeLineAndCharacterOfPosition(i,e)}},t=d.formatting.formatNodeGivenIndentation(o.node,t,n.languageVariant,e,a,s),f(o.text,t)},g.normalize=function(e){for(var t=d.stableSort(e,function(e,t){return e.range.pos-t.range.pos}),r=0;r<t.length-2;r++)d.Debug.assert(t[r].range.end<=t[r+1].range.pos);return t},t.ChangeTracker=g,t.applyChanges=f,n.prototype.setLastNonTriviaPosition=function(e,t){if(t||(t=e,d.skipTrivia(t,0)!==t.length)){this.lastNonTriviaPosition=this.writer.getTextPos();for(var r=0;d.isWhiteSpaceLike(e.charCodeAt(e.length-r-1));)r++;this.lastNonTriviaPosition-=r}},n.prototype.write=function(e){this.writer.write(e),this.setLastNonTriviaPosition(e,!1)},n.prototype.writeTextOfNode=function(e,t){this.writer.writeTextOfNode(e,t)},n.prototype.writeLine=function(){this.writer.writeLine()},n.prototype.increaseIndent=function(){this.writer.increaseIndent()},n.prototype.decreaseIndent=function(){this.writer.decreaseIndent()},n.prototype.getText=function(){return this.writer.getText()},n.prototype.rawWrite=function(e){this.writer.rawWrite(e),this.setLastNonTriviaPosition(e,!1)},n.prototype.writeLiteral=function(e){this.writer.writeLiteral(e),this.setLastNonTriviaPosition(e,!0)},n.prototype.getTextPos=function(){return this.writer.getTextPos()},n.prototype.getLine=function(){return this.writer.getLine()},n.prototype.getColumn=function(){return this.writer.getColumn()},n.prototype.getIndent=function(){return this.writer.getIndent()},n.prototype.isAtStartOfLine=function(){return this.writer.isAtStartOfLine()},n.prototype.reset=function(){this.writer.reset(),this.lastNonTriviaPosition=0};var y=n;function n(e){var n=this;this.lastNonTriviaPosition=0,this.writer=d.createTextWriter(e),this.onEmitNode=function(e,t,r){t&&i(t,n.lastNonTriviaPosition),r(e,t),t&&l(t,n.lastNonTriviaPosition)},this.onBeforeEmitNodeArray=function(e){e&&i(e,n.lastNonTriviaPosition)},this.onAfterEmitNodeArray=function(e){e&&l(e,n.lastNonTriviaPosition)},this.onBeforeEmitToken=function(e){e&&i(e,n.lastNonTriviaPosition)},this.onAfterEmitToken=function(e){e&&l(e,n.lastNonTriviaPosition)}}})(ts=ts||{}),(t=>{var e,n;e=t.codefix||(t.codefix={}),n=[],e.registerCodeFix=function(r){t.forEach(r.errorCodes,function(e){var t=n[e];t||(n[e]=t=[]),t.push(r)})},e.getSupportedErrorCodes=function(){return Object.keys(n)},e.getFixes=function(i){var e=n[i.errorCode],s=[];return t.forEach(e,function(e){e=e.getCodeActions(i);if(e&&0<e.length)for(var t=0,r=e;t<r.length;t++){var n=r[t];void 0===n?i.host.log("Action for error code "+i.errorCode+" added an invalid action entry; please log a bug"):s.push(n)}}),s}})(ts=ts||{}),(e=>{var t,n;t=e.refactor||(e.refactor={}),n=e.createMap(),t.registerRefactor=function(e){n.set(e.name,e)},t.getApplicableRefactors=function(t){return e.flatMapIter(n.values(),function(e){return t.cancellationToken&&t.cancellationToken.isCancellationRequested()?void 0:e.getAvailableActions(t)})},t.getEditsForRefactor=function(e,t,r){return(t=n.get(t))&&t.getEditsForAction(e,r)},e.getRefactorContextLength=function(e){return void 0===e.endPosition?0:e.endPosition-e.startPosition}})(ts=ts||{}),(i=>{(i.codefix||(i.codefix={})).registerCodeFix({errorCodes:[i.Diagnostics._0_accepts_too_few_arguments_to_be_used_as_a_decorator_here_Did_you_mean_to_call_it_first_and_write_0.code],getCodeActions:function(e){var t=e.sourceFile,r=i.getTokenAtPosition(t,e.span.start,!1),r=i.getAncestor(r,147),n=(i.Debug.assert(!!r,"Expected position to be owned by a decorator."),i.createCall(r.expression,void 0,void 0)),e=i.textChanges.ChangeTracker.fromContext(e);return e.replaceNode(t,r.expression,n),[{description:i.getLocaleSpecificMessage(i.Diagnostics.Call_decorator_expression),changes:e.getChanges()}]}})})(ts=ts||{}),(a=>{(a.codefix||(a.codefix={})).registerCodeFix({errorCodes:[a.Diagnostics.Cannot_access_0_1_because_0_is_a_type_but_not_a_namespace_Did_you_mean_to_retrieve_the_type_of_the_property_1_in_0_with_0_1.code],getCodeActions:function(e){var t,r,n,i=e.sourceFile,s=a.getTokenAtPosition(i,e.span.start,!1),s=a.getAncestor(s,143);if(a.Debug.assert(!!s,"Expected position to be owned by a qualified name."),a.isIdentifier(s.left))return t=s.left.getText(i),r=s.right.getText(i),n=a.createIndexedAccessTypeNode(a.createTypeReferenceNode(s.left,void 0),a.createLiteralTypeNode(a.createLiteral(r))),(e=a.textChanges.ChangeTracker.fromContext(e)).replaceNode(i,s,n),[{description:a.formatStringFromArgs(a.getLocaleSpecificMessage(a.Diagnostics.Rewrite_as_the_indexed_access_type_0),[t+'["'+r+'"]']),changes:e.getChanges()}]}})})(ts=ts||{}),(f=>{var _;(_=f.codefix||(f.codefix={})).registerCodeFix({errorCodes:[f.Diagnostics.Class_0_incorrectly_implements_interface_1.code],getCodeActions:function(n){var e=n.sourceFile,t=n.span.start,t=f.getTokenAtPosition(e,t,!1),i=n.program.getTypeChecker(),s=f.getContainingClass(t);if(!s)return;for(var a=f.getOpenBraceOfClassLike(s,e),t=i.getTypeAtLocation(s),e=f.getClassImplementsHeritageClauseElements(s),r=!!i.getIndexTypeOfType(t,1),o=!!i.getIndexTypeOfType(t,0),l=[],c=0,u=e;c<u.length;c++){var d=u[c],p=i.getTypeAtLocation(d),h=i.getPropertiesOfType(p).filter(function(e){return!(8&f.getModifierFlags(e.valueDeclaration))}),m=[],p=(g(p,1,r,m),g(p,0,o,m),m=m.concat(_.createMissingMemberNodes(s,h,i)),f.formatStringFromArgs(f.getLocaleSpecificMessage(f.Diagnostics.Implement_interface_0),[d.getText()]));0<m.length&&((e,t,r)=>{e.push({description:r,changes:_.newNodesToChanges(t,a,n)})})(l,m,p)}return l;function g(e,t,r,n){r||(r=i.getIndexInfoOfType(e,t))&&(e=i.indexInfoToIndexSignatureDeclaration(r,t,s),n.push(e))}}})})(ts=ts||{}),(d=>{var p;(p=d.codefix||(d.codefix={})).registerCodeFix({errorCodes:[d.Diagnostics.Property_0_does_not_exist_on_type_1.code,d.Diagnostics.Property_0_does_not_exist_on_type_1_Did_you_mean_2.code],getCodeActions:function(s){var e=s.sourceFile,t=s.span.start,a=d.getTokenAtPosition(e,t,!1);if(71!==a.kind)return;if(!d.isPropertyAccessExpression(a.parent))return;var r,o,l,c=a.getText(e),n=!1;if(99===a.parent.expression.kind){t=d.getThisContainer(a,!1);if(!d.isClassElement(t))return;r=t.parent,n=r&&d.hasModifier(t,32)}else{var i,e=s.program.getTypeChecker(),t=a.parent.expression,t=e.getTypeAtLocation(t);32768&t.flags&&32&(i=t.symbol).flags&&(r=i.declarations&&i.declarations[0],t!==e.getDeclaredTypeOfSymbol(i))&&(n=!0)}if(r&&d.isClassLike(r))return o=d.getSourceFileOfNode(r),l=d.getOpenBraceOfClassLike(r,o),(d.isInJavaScriptFile(o)?(e,t)=>{var r,n=u(!1);return n&&(r=[n]),t?199!==e.kind&&(n=e.name.getText(),t=d.createStatement(d.createAssignment(d.createPropertyAccess(d.createIdentifier(n),c),d.createIdentifier("undefined"))),(n=d.textChanges.ChangeTracker.fromContext(s)).insertNodeAfter(o,e,t,{prefix:s.newLineCharacter,suffix:s.newLineCharacter}),t={description:d.formatStringFromArgs(d.getLocaleSpecificMessage(d.Diagnostics.Initialize_static_property_0),[c]),changes:n.getChanges()},(r=r||[]).push(t)):(n=d.getFirstConstructorWithBody(e))&&(t=d.createStatement(d.createAssignment(d.createPropertyAccess(d.createThis(),c),d.createIdentifier("undefined"))),(e=d.textChanges.ChangeTracker.fromContext(s)).insertNodeBefore(o,n.body.getLastToken(),t,{suffix:s.newLineCharacter}),n={description:d.formatStringFromArgs(d.getLocaleSpecificMessage(d.Diagnostics.Initialize_property_0_in_the_constructor),[c]),changes:e.getChanges()},(r=r||[]).push(n)),r}:(e,t)=>{var r,n,i=u(!0);return i&&(r=[i]),194===a.parent.parent.kind&&(i=a.parent.parent,i=a.parent===i.left?i.right:i.left,n=s.program.getTypeChecker(),i=n.getWidenedType(n.getBaseTypeOfLiteralType(n.getTypeAtLocation(i))),n=n.typeToTypeNode(i,e)),n=n||d.createKeywordTypeNode(119),i=d.createProperty(void 0,t?[d.createToken(115)]:void 0,c,void 0,n,void 0),(e=d.textChanges.ChangeTracker.fromContext(s)).insertNodeAfter(o,l,i,{suffix:s.newLineCharacter}),i=t?d.Diagnostics.Declare_static_property_0:d.Diagnostics.Declare_property_0,r=d.append(r,{description:d.formatStringFromArgs(d.getLocaleSpecificMessage(i),[c]),changes:e.getChanges()}),t||(i=d.createKeywordTypeNode(136),e=d.createParameter(void 0,void 0,void 0,"x",void 0,i,void 0),t=d.createIndexSignature(void 0,void 0,[e],n),(i=d.textChanges.ChangeTracker.fromContext(s)).insertNodeAfter(o,l,t,{suffix:s.newLineCharacter}),r.push({description:d.formatStringFromArgs(d.getLocaleSpecificMessage(d.Diagnostics.Add_index_signature_for_property_0),[c]),changes:i.getChanges()})),r})(r,n);function u(e){var t;if(181===a.parent.parent.kind)return t=a.parent.parent,t=p.createMethodFromCallExpression(t,c,e,n),(e=d.textChanges.ChangeTracker.fromContext(s)).insertNodeAfter(o,l,t,{suffix:s.newLineCharacter}),t=n?d.Diagnostics.Declare_static_method_0:d.Diagnostics.Declare_method_0,{description:d.formatStringFromArgs(d.getLocaleSpecificMessage(t),[c]),changes:e.getChanges()}}}})})(ts=ts||{}),(i=>{(i.codefix||(i.codefix={})).registerCodeFix({errorCodes:[i.Diagnostics.Property_0_does_not_exist_on_type_1_Did_you_mean_2.code,i.Diagnostics.Cannot_find_name_0_Did_you_mean_1.code],getCodeActions:function(e){var t=e.sourceFile,r=i.getTokenAtPosition(t,e.span.start,!1),e=e.program.getTypeChecker();{var n;e=i.isPropertyAccessExpression(r.parent)&&r.parent.name===r?(i.Debug.assert(71===r.kind),n=e.getTypeAtLocation(r.parent.expression),e.getSuggestionForNonexistentProperty(r,n)):(n=i.getMeaningFromLocation(r),e.getSuggestionForNonexistentSymbol(r,i.getTextOfNode(r),(e=>{var t=0;return 4&e&&(t|=1920),2&e&&(t|=793064),1&e&&(t|=107455),t})(n)))}if(e)return[{description:i.formatStringFromArgs(i.getLocaleSpecificMessage(i.Diagnostics.Change_spelling_to_0),[e]),changes:[{fileName:t.fileName,textChanges:[{span:{start:r.getStart(),length:r.getWidth()},newText:e}]}]}]}})})(ts=ts||{}),(n=>{var e;function i(e,t){t=n.getPackageName(t).packageName;if(e.isKnownTypesPackageName(t))return{description:"Install '"+(e=n.getTypesPackageName(t))+"'",changes:[],commands:[{type:"install package",packageName:e}]}}(e=n.codefix||(n.codefix={})).registerCodeFix({errorCodes:[n.Diagnostics.Could_not_find_a_declaration_file_for_module_0_1_implicitly_has_an_any_type.code],getCodeActions:function(e){var t=e.sourceFile,r=e.span.start,t=n.getTokenAtPosition(t,r,!1);if(n.isStringLiteral(t))return(r=i(e.host,t.text))&&[r];throw n.Debug.fail()}}),e.tryGetCodeActionForInstallPackageTypes=i})(ts=ts||{}),(s=>{var a;function e(e){var t=e.sourceFile,r=e.span.start,r=s.getTokenAtPosition(t,r,!1),n=e.program.getTypeChecker();if(s.isClassLike(r.parent)){var r=r.parent,i=s.getClassExtendsHeritageClauseElement(r),i=n.getTypeAtLocation(i),i=n.getPropertiesOfType(i).filter(o),i=a.createMissingMemberNodes(r,i,n),n=a.newNodesToChanges(i,s.getOpenBraceOfClassLike(r,t),e);if(n&&0<n.length)return[{description:s.getLocaleSpecificMessage(s.Diagnostics.Implement_inherited_abstract_class),changes:n}]}}function o(e){e=e.getDeclarations(),s.Debug.assert(!!(e&&0<e.length)),e=s.getModifierFlags(e[0]);return!(8&e||!(128&e))}(a=s.codefix||(s.codefix={})).registerCodeFix({errorCodes:[s.Diagnostics.Non_abstract_class_0_does_not_implement_inherited_abstract_member_1_from_class_2.code],getCodeActions:e}),a.registerCodeFix({errorCodes:[s.Diagnostics.Non_abstract_class_expression_does_not_implement_inherited_abstract_member_0_from_class_1.code],getCodeActions:e})})(ts=ts||{}),(l=>{(l.codefix||(l.codefix={})).registerCodeFix({errorCodes:[l.Diagnostics.super_must_be_called_before_accessing_this_in_the_constructor_of_a_derived_class.code],getCodeActions:function(e){var t=e.sourceFile,r=l.getTokenAtPosition(t,e.span.start,!1);if(99===r.kind){var n=l.getContainingFunction(r),i=function e(t){if(210===t.kind&&l.isSuperCall(t.expression))return t;if(l.isFunctionLike(t))return;return l.forEachChild(t,e)}(n.body);if(i){if(i.expression&&181===i.expression.kind)for(var s=i.expression.arguments,a=0;a<s.length;a++)if(s[a].expression===r)return;var o=l.textChanges.ChangeTracker.fromContext(e);return o.insertNodeAfter(t,l.getOpenBrace(n,t),i,{suffix:e.newLineCharacter}),o.deleteNode(t,i),[{description:l.getLocaleSpecificMessage(l.Diagnostics.Make_super_call_the_first_statement_in_the_constructor),changes:o.getChanges()}]}}}})})(ts=ts||{}),(s=>{(s.codefix||(s.codefix={})).registerCodeFix({errorCodes:[s.Diagnostics.Constructors_for_derived_classes_must_contain_a_super_call.code],getCodeActions:function(e){var t,r,n=e.sourceFile,i=s.getTokenAtPosition(n,e.span.start,!1);if(123===i.kind)return t=s.textChanges.ChangeTracker.fromContext(e),r=s.createStatement(s.createCall(s.createSuper(),void 0,s.emptyArray)),t.insertNodeAfter(n,s.getOpenBrace(i.parent,n),r,{suffix:e.newLineCharacter}),[{description:s.getLocaleSpecificMessage(s.Diagnostics.Add_missing_super_call),changes:t.getChanges()}]}})})(ts=ts||{}),(l=>{(l.codefix||(l.codefix={})).registerCodeFix({errorCodes:[l.Diagnostics.Cannot_extend_an_interface_0_Did_you_mean_implements.code],getCodeActions:function(e){var t=e.sourceFile,r=e.span.start,r=l.getTokenAtPosition(t,r,!1),n=l.getContainingClass(r);if(71===r.kind&&l.isClassLike(n)){var i=n.heritageClauses;if(i&&0<i.length){r=i[0].getFirstToken();if(r&&85===r.kind){var s=l.textChanges.ChangeTracker.fromContext(e);s.replaceNode(t,r,l.createToken(108));for(var a=1;a<i.length;a++){var o=i[a].getFirstToken();o&&s.replaceNode(t,o,l.createToken(26))}return[{description:l.getLocaleSpecificMessage(l.Diagnostics.Change_extends_to_implements),changes:s.getChanges()}]}}}}})})(ts=ts||{}),(n=>{(n.codefix||(n.codefix={})).registerCodeFix({errorCodes:[n.Diagnostics.Cannot_find_name_0_Did_you_mean_the_instance_member_this_0.code],getCodeActions:function(e){var t=e.sourceFile,r=n.getTokenAtPosition(t,e.span.start,!1);if(71===r.kind)return(e=n.textChanges.ChangeTracker.fromContext(e)).replaceNode(t,r,n.createPropertyAccess(n.createThis(),r)),[{description:n.getLocaleSpecificMessage(n.Diagnostics.Add_this_to_unresolved_variable),changes:e.getChanges()}]}})})(ts=ts||{}),(f=>{(f.codefix||(f.codefix={})).registerCodeFix({errorCodes:[f.Diagnostics._0_is_declared_but_its_value_is_never_read.code,f.Diagnostics.Property_0_is_declared_but_its_value_is_never_read.code],getCodeActions:function(n){var i=n.sourceFile,e=n.span.start,t=f.getTokenAtPosition(i,e,!1);switch((t=21===t.kind?f.getTokenAtPosition(i,e+1,!1):t).kind){case 71:var r=t,s=r.parent;switch(s.kind){case 226:return((e,t)=>{switch(t.parent.parent.kind){case 214:var r=t.parent.parent.initializer;return[1===r.declarations.length?p(r):m(t)];case 216:r=t.parent.parent;return f.Debug.assert(227===r.initializer.kind),[((e,t)=>g(f.textChanges.ChangeTracker.fromContext(n).replaceNode(i,e,t)))(r.initializer.declarations[0],f.createObjectLiteral()),u(e)];case 215:return[u(e)];default:r=t.parent.parent;return 1===r.declarationList.declarations.length?[p(r)]:[m(t)]}})(r,s);case 145:var a=s.parent.typeParameters;return 1===a.length?(l=f.getTokenAtPosition(i,a.pos-1,!1),o=f.getTokenAtPosition(i,a.end,!1),f.Debug.assert(27===l.kind),f.Debug.assert(29===o.kind),[((e,t)=>g(f.textChanges.ChangeTracker.fromContext(n).deleteNodeRange(i,e,t)))(l,o)]):[m(s)];case 146:return[(1===s.parent.parameters.length?p:m)(s),u(r)];case 237:return[p(f.getAncestor(r,237))];case 242:a=s.parent;return 1===a.elements.length?d(a):[m(s)];case 239:var o,l=s;return l.namedBindings?(a=l.name.getStart(i),(o=f.getTokenAtPosition(i,l.name.end,!1))&&26===o.kind?[h({pos:a,end:f.skipTrivia(i.text,o.end,!1,!0)})]:[p(l.name)]):[p(f.getAncestor(l,238))];case 240:return d(s);default:return c()}return;case 149:case 240:return[p(t.parent)];default:return c()}function c(){return f.isDeclarationName(t)?[p(t.parent)]:f.isLiteralComputedPropertyDeclarationName(t)?[p(t.parent.parent)]:void 0}function u(e){e=e.getStart(i,!1);return{description:f.formatStringFromArgs(f.getLocaleSpecificMessage(f.Diagnostics.Prefix_0_with_an_underscore),{0:t.getText()}),changes:[{fileName:i.path,textChanges:[{span:{start:e,length:0},newText:"_"}]}]}}function d(e){var t;return e.parent.name?(t=f.getTokenAtPosition(i,e.pos-1,!1))&&26===t.kind?[h({pos:t.getStart(),end:e.end})]:void 0:[p(f.getAncestor(e,238))]}function p(e){return g(f.textChanges.ChangeTracker.fromContext(n).deleteNode(i,e))}function h(e){return g(f.textChanges.ChangeTracker.fromContext(n).deleteRange(i,e))}function m(e){return g(f.textChanges.ChangeTracker.fromContext(n).deleteNodeInList(i,e))}function g(e){return{description:f.formatStringFromArgs(f.getLocaleSpecificMessage(f.Diagnostics.Remove_declaration_for_Colon_0),{0:t.getText()}),changes:e.getChanges()}}}})})(ts=ts||{}),(a=>{function o(e,t,r,n){return{description:a.formatStringFromArgs(a.getLocaleSpecificMessage(a.Diagnostics.Change_0_to_1),[r,n]),changes:[{fileName:t,textChanges:[{span:{start:e.getStart(),length:e.getWidth()},newText:n}]}]}}(a.codefix||(a.codefix={})).registerCodeFix({errorCodes:[a.Diagnostics.JSDoc_types_can_only_be_used_inside_documentation_comments.code],getCodeActions:function(e){var t=e.sourceFile,r=a.getTokenAtPosition(t,e.span.start,!1),r=a.findAncestor(r,function(e){return 202===e.kind||155===e.kind||156===e.kind||228===e.kind||153===e.kind||157===e.kind||172===e.kind||151===e.kind||150===e.kind||146===e.kind||149===e.kind||148===e.kind||154===e.kind||231===e.kind||184===e.kind||226===e.kind});if(r){var n,i,s,e=e.program.getTypeChecker(),r=r.type;if(r)return n=a.getTextOfNode(r),i=e.getTypeFromTypeNode(r),s=[o(r,t.fileName,n,e.typeToString(i,void 0,8))],270===r.kind&&(e=e.typeToString(e.getNullableType(i,2048),void 0,8),s.push(o(r,t.fileName,n,e))),s}}})})(ts=ts||{}),(d=>{var e,t,c,r;function n(){this.symbolIdToActionMap=[]}function u(e,t,r,n,i){return{description:d.formatMessage.apply(void 0,[void 0,e].concat(t)),changes:r,kind:n,moduleSpecifier:i}}function p(e,t){var r=((r,n,e,t)=>{e=e.imports,void 0===t&&(t=[]);var i=d.getUniqueSymbolId(r,n),s=t[i];return s=s||(t[i]=d.mapDefined(e,function(e){if(n.getSymbolAtLocation(e)===r){var t=e.parent;switch(t.kind){case 238:return t;case 248:return t.parent;default:return void d.Debug.assert(244===t.kind)}}}))})(e,t.checker,t.sourceFile,t.cachedImportDeclarations),n=[];if(t.symbolToken)for(var i=0,s=r;i<s.length;i++){var a=(e=>{var t;return 238===e.kind?(t=e.importClause&&e.importClause.namedBindings)&&240===t.kind?t.name:void 0:e.name})(s[i]);a&&n.push(((t,e,r)=>{var n=e.symbolName,i=e.sourceFile;return u(d.Diagnostics.Change_0_to_1,[n,t+"."+n],c.with(e,function(e){return e.replaceNode(i,r,d.createPropertyAccess(d.createIdentifier(t),n))}),"CodeChange",void 0)})(a.text,t,t.symbolToken))}return n.push(((e,r,t)=>{var n=d.firstDefined(t,function(e){if(238===e.kind&&e.importClause){var t=((e,t)=>{var r=e.symbolName,n=e.sourceFile,i=e.kind,s=t.name,a=t.namedBindings;switch(i){case 1:return s?void 0:c.with(e,function(e){return e.replaceNode(n,t,d.createImportClause(d.createIdentifier(r),a))});case 0:var o=d.createImportSpecifier(void 0,d.createIdentifier(r));return a&&241===a.kind&&0!==a.elements.length?c.with(e,function(e){return e.insertNodeInListAfter(n,a.elements[a.elements.length-1],o)}):!a||241===a.kind&&0===a.elements.length?c.with(e,function(e){return e.replaceNode(n,t,d.createImportClause(s,d.createNamedImports([o])))}):void 0;case 2:return a?void 0:c.with(e,function(e){return e.replaceNode(n,t,d.createImportClause(s,d.createNamespaceImport(d.createIdentifier(r))))});default:d.Debug.assertNever(i)}})(r,e.importClause);if(t)return e=d.stripQuotes(e.moduleSpecifier.getText()),u(d.Diagnostics.Add_0_to_existing_import_declaration_from_1,[r.symbolName,e],t,"InsertingIntoExistingImport",e)}});if(n)return n;n=d.firstDefined(t,_)||((e,t,r,n,i)=>{var s=t.valueDeclaration.getSourceFile().fileName,e=d.getDirectoryPath(e.fileName);return(e=>{if(e=e.valueDeclaration,d.isModuleDeclaration(e)&&d.isStringLiteral(e.name))return e.name.text})(t)||((e,t,r,n)=>(e=d.getEffectiveTypeRoots(e,t))&&d.firstDefined(e,function(e){e=d.toPath(e,void 0,r);if(d.startsWith(n,e))return m(n.substring(e.length+1))}))(r,i,n,s)||((e,t,n,i,r)=>{var s;return d.getEmitModuleResolutionKind(e)===d.ModuleResolutionKind.NodeJs&&(s=(e=>{for(var t=0,r=0,n=0,i=0,s={},a=(s[s.BeforeNodeModules=0]="BeforeNodeModules",s[s.NodeModules=1]="NodeModules",s[s.Scope=2]="Scope",s[s.PackageContent=3]="PackageContent",0),o=0,l=0;0<=o;)switch(a=o,o=e.indexOf("/",a+1),l){case 0:e.indexOf("/node_modules/",a)===a&&(t=a,r=o,l=1);break;case 1:case 2:l=1===l&&"@"===e.charAt(a+1)?2:(n=o,3);break;case 3:l=e.indexOf("/node_modules/",a)===a?1:3}return i=a,1<l?{topLevelNodeModulesIndex:t,topLevelPackageNameIndex:r,packageRootIndex:n,fileNameIndex:i}:void 0})(t))?(e=(e=>{var t=e.substring(0,s.topLevelNodeModulesIndex);return 0===r.indexOf(t)?e.substring(s.topLevelPackageNameIndex+1):f(e,r,i)})(e=(e=>{var t=e.substring(0,s.packageRootIndex),r=d.combinePaths(t,"package.json");if(n.fileExists(r)){r=JSON.parse(n.readFile(r));if(r){r=r.typings||r.types||r.main;if(r)if(d.toPath(r,t,i)===i(e))return t}}return r=d.removeFileExtension(e),"/index"!==i(r.substring(s.fileNameIndex))?r:r.substring(0,s.fileNameIndex)})(t)),d.getPackageNameFromAtTypesDirectory(e)):void 0})(r,s,i,n,e)||((e,t,r)=>{if(e.baseUrl){var n=g(t,e.baseUrl,r);if(n){var i=d.removeFileExtension(n);if(n=m(n),e.paths)for(var s in e.paths)for(var a=0,o=e.paths[s];a<o.length;a++){var l=o[a],c=l.indexOf("*");if(0!==c||1!==l.length)if(-1!==c){var u=l.substr(0,c),c=l.substr(c+1);if(n.length>=u.length+c.length&&d.startsWith(n,u)&&d.endsWith(n,c))return u=n.substr(u.length,n.length-c.length),s.replace("*",u)}else if(l===n||l===i)return s}return n}}})(r,s,n)||r.rootDirs&&((e,t,r,n)=>{if(void 0!==(t=h(t,e,n)))return r=h(r,e,n),e=void 0!==r?f(t,r,n):t,d.removeFileExtension(e)})(r.rootDirs,s,e,n)||d.removeFileExtension(f(s,e,n))})(r.sourceFile,e,r.compilerOptions,r.getCanonicalFileName,r.host);var t=r,e=n,n=t.kind,i=t.sourceFile,s=t.newLineCharacter,a=t.symbolName,o=d.findLast(i.statements,d.isAnyImportSyntax),e=d.stripQuotes(e),l=d.createImportDeclaration(void 0,void 0,((e,t)=>{var r=d.createIdentifier(t);switch(e){case 1:return d.createImportClause(r,void 0);case 2:return d.createImportClause(void 0,d.createNamespaceImport(r));case 0:return d.createImportClause(void 0,d.createNamedImports([d.createImportSpecifier(void 0,r)]));default:d.Debug.assertNever(e)}})(n,a),((e,t)=>{var t=d.createLiteral(t),r=d.firstOrUndefined(e.imports);return t.singleQuote=!!r&&!d.isStringDoubleQuoted(r,e),t})(i,e)),n=c.with(t,function(e){o?e.insertNodeAfter(i,o,l,{suffix:s}):e.insertNodeAt(i,d.getSourceFileImportLocation(i),l,{suffix:""+s+s})});return u(d.Diagnostics.Import_0_from_1,[a,e],n,"NewImport",e)})(e,t,r)),n}function h(t,e,r){return d.firstDefined(e,function(e){return g(t,e,r)})}function m(e){return e=d.removeFileExtension(e),e=d.endsWith(e,"/index")?e.substr(0,e.length-6):e}function g(e,t,r){e=d.getRelativePathToDirectoryOrUrl(t,e,t,r,!1);return d.isRootedDiskPath(e)||d.startsWith(e,"..")?void 0:e}function f(e,t,r){e=d.getRelativePathToDirectoryOrUrl(t,e,t,r,!1);return d.pathIsRelative(e)?e:"./"+e}function _(e){e=238===e.kind?e.moduleSpecifier:248===e.moduleReference.kind?e.moduleReference.expression:void 0;return e&&d.isStringLiteral(e)?e.text:void 0}function y(e,t){e=e.declarations;return d.some(e,function(e){return!!(d.getMeaningFromDeclaration(e)&t)})}function b(e,t,r){for(var n=0,i=e.getAmbientModules();n<i.length;n++)r(i[n]);for(var s=0,a=t;s<a.length;s++){var o=a[s];d.isExternalOrCommonJsModule(o)&&r(o.symbol)}}e=d.codefix||(d.codefix={}),c=d.textChanges.ChangeTracker,e.registerCodeFix({errorCodes:[d.Diagnostics.Cannot_find_name_0.code,d.Diagnostics.Cannot_find_name_0_Did_you_mean_1.code,d.Diagnostics.Cannot_find_namespace_0.code,d.Diagnostics._0_refers_to_a_UMD_global_but_the_current_file_is_a_module_Consider_adding_an_import_instead.code],getCodeActions:function(e){var t=(e=>{var t=!!e.host.useCaseSensitiveFileNames&&e.host.useCaseSensitiveFileNames(),r=e.program.getTypeChecker(),n=d.getTokenAtPosition(e.sourceFile,e.span.start,!1);return{host:e.host,newLineCharacter:e.newLineCharacter,rulesProvider:e.rulesProvider,sourceFile:e.sourceFile,checker:r,compilerOptions:e.program.getCompilerOptions(),cachedImportDeclarations:[],getCanonicalFileName:d.createGetCanonicalFileName(t),symbolName:n.getText(),symbolToken:n}})(e);return e.errorCode===d.Diagnostics._0_refers_to_a_UMD_global_but_the_current_file_is_a_module_Consider_adding_an_import_instead.code?(e=>{var t,r,n=e.checker,i=e.symbolToken,s=n.getSymbolAtLocation(i);return 2097152&s.flags?(t=n.getAliasedSymbol(s),r=e.symbolName):d.isJsxOpeningLikeElement(i.parent)&&i.parent.tagName===i?(t=n.getAliasedSymbol(n.resolveName(n.getJsxNamespace(),i.parent.tagName,107455)),r=t.name):d.Debug.fail("Either the symbol or the JSX namespace should be a UMD global if we got here"),p(t,__assign({},e,{symbolName:r,kind:2}))})(t):((n,e,i)=>{var s=n.sourceFile,a=n.checker,o=n.symbolName,t=n.symbolToken,l=(d.Debug.assert("default"!==o),new r),c=d.getMeaningFromLocation(t);return b(a,e,function(e){var t,r;e!==s.symbol&&(i.throwIfCancellationRequested(),(t=a.tryGetMemberInModuleExports("default",e))&&(t=d.getLocalSymbolForExportDefault(t))&&t.escapedName===o&&y(t,c)&&(r=d.getUniqueSymbolId(t,a),l.addActions(r,p(e,__assign({},n,{kind:1})))),t=a.tryGetMemberInModuleExportsAndProperties(o,e))&&y(t,c)&&(r=d.getUniqueSymbolId(t,a),l.addActions(r,p(e,__assign({},n,{kind:0}))))}),l.getAllActions()})(t,e.program.getSourceFiles(),e.cancellationToken)}}),n.prototype.addAction=function(e,t){var r=this.symbolIdToActionMap[e];if(r)if("CodeChange"===t.kind)r.push(t);else{for(var n=[],i=0,s=this.symbolIdToActionMap[e];i<s.length;i++){var a=s[i];if("CodeChange"===a.kind)n.push(a);else switch(this.compareModuleSpecifiers(a.moduleSpecifier,t.moduleSpecifier)){case 0:if("NewImport"===t.kind)return;case 1:n.push(a);break;case 2:continue}}n.push(t),this.symbolIdToActionMap[e]=n}else this.symbolIdToActionMap[e]=[t]},n.prototype.addActions=function(e,t){for(var r=0,n=t;r<n.length;r++){var i=n[r];this.addAction(e,i)}},n.prototype.getAllActions=function(){var e,t=[];for(e in this.symbolIdToActionMap)t=d.concatenate(t,this.symbolIdToActionMap[e]);return t},n.prototype.compareModuleSpecifiers=function(e,t){var r;return e===t?1:0===t.indexOf(e)?0:0===e.indexOf(t)?2:d.isExternalModuleNameRelative(e)&&d.isExternalModuleNameRelative(t)?(r=new RegExp(d.directorySeparator,"g"),(e=(e.match(r)||[]).length)<(t=(t.match(r)||[]).length)?0:e===t?1:2):1},r=n,(t=e.ImportKind||(e.ImportKind={}))[t.Named=0]="Named",t[t.Default=1]="Default",t[t.Namespace=2]="Namespace",e.getCodeActionForImport=p,e.forEachExternalModule=b})(ts=ts||{}),(s=>{var t;(s.codefix||(s.codefix={})).registerCodeFix({errorCodes:(t=s.Diagnostics,Object.keys(t).filter(function(e){return t[e]&&t[e].category===s.DiagnosticCategory.Error}).map(function(e){return t[e].code})),getCodeActions:function(e){var t=e.sourceFile,r=e.program,n=e.newLineCharacter,e=e.span;if(s.isInJavaScriptFile(t)&&s.isCheckJsEnabledForFile(t,r.getCompilerOptions()))return[{description:s.getLocaleSpecificMessage(s.Diagnostics.Ignore_this_error_message),changes:[{fileName:t.fileName,textChanges:[((e,t,r)=>{var n=s.getLineAndCharacterOfPosition(e,t).line,n=s.getStartPositionOfLine(n,e),n=s.getFirstNonSpaceCharacterPosition(e.text,n);if(!s.isInComment(e,n)&&!s.isInString(e,n)&&!s.isInTemplateString(e,n)){var i=s.getTouchingToken(e,n,!1),i=s.getLeadingCommentRangesOfNode(i,e);if(!i||!i.length||i[0].pos>=n)return{span:{start:n,length:0},newText:"// @ts-ignore"+r}}return{span:{start:t,length:0},newText:(t===n?"":r)+"// @ts-ignore"+r}})(t,e.start,n)]}]},{description:s.getLocaleSpecificMessage(s.Diagnostics.Disable_checking_for_this_file),changes:[{fileName:t.fileName,textChanges:[{span:{start:t.checkJsDirective?t.checkJsDirective.pos:0,length:t.checkJsDirective?t.checkJsDirective.end-t.checkJsDirective.pos:0},newText:"// @ts-nocheck"+n}]}]}]}})})(ts=ts||{}),(_=>{var e;function y(e,t,r,n){for(var i=[],s=0;s<e;s++){var a=_.createParameter(void 0,void 0,void 0,t&&t[s]||"arg"+s,void 0!==r&&r<=s?_.createToken(55):void 0,n?_.createKeywordTypeNode(119):void 0,void 0);i.push(a)}return i}function b(e,t,r,n,i,s){return _.createMethod(void 0,e,void 0,t,r?_.createToken(55):void 0,n,i,s,v())}function v(){return _.createBlock([_.createThrow(_.createNew(_.createIdentifier("Error"),void 0,[_.createLiteral("Method not implemented.")]))],!0)}(e=_.codefix||(_.codefix={})).newNodesToChanges=function(e,t,r){for(var n=r.sourceFile,i=_.textChanges.ChangeTracker.fromContext(r),s=0,a=e;s<a.length;s++){var o=a[s];i.insertNodeAfter(n,t,o,{suffix:r.newLineCharacter})}return e=i.getChanges(),_.some(e)?(_.Debug.assert(1===e.length),[{fileName:e[0].fileName,textChanges:[{span:e[0].textChanges[0].span,newText:e[0].textChanges.reduce(function(e,t){return e+t.newText},"")}]}]):e},e.createMissingMemberNodes=function(e,t,r){for(var n=e.symbol.members,i=[],s=0,a=t.filter(function(e){return!n.has(e.escapedName)});s<a.length;s++){var o=((e,t,n)=>{var r=e.getDeclarations();if(r&&r.length){var i=r[0],s=_.getSynthesizedClone(_.getNameOfDeclaration(i)),a=(e=>4&e?_.createToken(114):16&e?_.createToken(113):void 0)(_.getModifierFlags(i)),o=a?_.createNodeArray([a]):void 0,l=n.getWidenedType(n.getTypeOfSymbolAtLocation(e,t)),c=!!(16777216&e.flags);switch(i.kind){case 153:case 154:case 148:case 149:var u=n.typeToTypeNode(l,t);return _.createProperty(void 0,o,s,c?_.createToken(55):void 0,u,void 0);case 150:case 151:var d=n.getSignaturesOfType(l,0);if(!_.some(d))return;if(1===r.length)return _.Debug.assert(1===d.length),f(g=d[0],t,v());for(var p=[],h=0;h<d.length;h++){var m,g=d[h];(m=f(g,t))&&p.push(m)}return r.length>d.length?(g=n.getSignatureFromDeclaration(r[r.length-1]),(m=f(g,t,v()))&&p.push(m)):(_.Debug.assert(r.length===d.length),u=((e,t,r,n)=>{for(var i=e[0],s=e[0].minArgumentCount,a=!1,o=0;o<e.length;o++){var l=e[o];s=Math.min(l.minArgumentCount,s),l.hasRestParameter&&(a=!0),l.parameters.length>=i.parameters.length&&(!l.hasRestParameter||i.hasRestParameter)&&(i=l)}var c,u=i.parameters.length-(i.hasRestParameter?1:0),d=i.parameters.map(function(e){return e.name}),p=y(u,d,s,!0);return a&&(c=_.createArrayTypeNode(_.createKeywordTypeNode(119)),d=_.createParameter(void 0,void 0,_.createToken(24),d[u]||"rest",s<=u?_.createToken(55):void 0,c,void 0),p.push(d)),b(n,t,r,void 0,p,void 0)})(d,s,c,o),p.push(u)),p;default:return}}function f(e,t,r){e=n.signatureToSignatureDeclaration(e,151,t,_.NodeBuilderFlags.SuppressAnyReturnType);return e&&(e.decorators=void 0,e.modifiers=o,e.name=s,e.questionToken=c?_.createToken(55):void 0,e.body=r),e}})(a[s],e,r);o&&(Array.isArray(o)?i=i.concat(o):i.push(o))}return i},e.createMethodFromCallExpression=function(e,t,r,n){var i,s=y(e.arguments.length,void 0,void 0,r);if(r)for(var a=_.length(e.typeArguments),o=0;o<a;o++){var l=a<8?String.fromCharCode(84+o):"T"+o,l=_.createTypeParameterDeclaration(l,void 0,void 0);(i=i||[]).push(l)}return _.createMethod(void 0,n?[_.createToken(115)]:void 0,void 0,t,void 0,i,s,r?_.createKeywordTypeNode(119):void 0,v())},e.createStubbedMethod=b})(ts=ts||{}),(T=>{var _,e;function k(e,t,r){for(;T.isRightSideOfQualifiedNameOrPropertyAccess(e);)e=e.parent;switch(e.parent.kind){case 193:r.isNumber=!0;break;case 192:var n=e.parent,i=r;switch(n.operator){case 43:case 44:case 38:case 52:i.isNumber=!0;break;case 37:i.isNumberOrString=!0}break;case 194:var s=e,a=e.parent,o=t,l=r;switch(a.operatorToken.kind){case 40:case 39:case 41:case 42:case 45:case 46:case 47:case 48:case 49:case 50:case 60:case 62:case 61:case 63:case 64:case 68:case 69:case 70:case 65:case 67:case 66:case 38:case 27:case 30:case 29:case 31:var c=o.getTypeAtLocation(a.left===s?a.right:a.left);272&c.flags?E(l,c):l.isNumber=!0;break;case 59:case 37:c=o.getTypeAtLocation(a.left===s?a.right:a.left);272&c.flags?E(l,c):84&c.flags?l.isNumber=!0:262178&c.flags?l.isString=!0:l.isNumberOrString=!0;break;case 58:case 32:case 34:case 35:case 33:E(l,o.getTypeAtLocation(a.left===s?a.right:a.left));break;case 92:s===a.left&&(l.isString=!0);break;case 54:s!==a.left||226!==s.parent.parent.kind&&!T.isAssignmentExpression(s.parent.parent,!0)||E(l,o.getTypeAtLocation(a.right))}break;case 257:case 258:n=e.parent,E(r,t.getTypeAtLocation(n.parent.parent.expression));break;case 181:case 182:if(e.parent.expression===e){var u=e.parent,d=t,p=r,h={argumentTypes:[],returnType:{}};if(u.arguments)for(var m=0,g=u.arguments;m<g.length;m++){var f=g[m];h.argumentTypes.push(d.getTypeAtLocation(f))}k(u,d,h.returnType),(181===u.kind?p.callContexts||(p.callContexts=[]):p.constructContexts||(p.constructContexts=[])).push(h)}else x(e,t,r);break;case 179:u=e.parent,p=t,y=r,b=T.escapeLeadingUnderscores(u.name.text),y.properties||(y.properties=T.createUnderscoreEscapedMap()),v=y.properties.get(b)||{},k(u,p,v),y.properties.set(b,v);break;case 180:y=e.parent,b=t,v=r,(_=e)===y.argumentExpression?v.isNumberOrString=!0:(_=b.getTypeAtLocation(y),k(y,b,y={}),84&_.flags?v.numberIndexContext=y:v.stringIndexContext=y);break;default:x(e,t,r)}var _,y,b,v}function x(e,t,r){T.isPartOfExpression(e)&&E(r,t.getContextualType(e))}function h(e,n){if(e.isNumberOrString&&!e.isNumber&&!e.isString)return n.getUnionType([n.getNumberType(),n.getStringType()]);if(e.isNumber)return n.getNumberType();if(e.isString)return n.getStringType();if(e.candidateTypes)return n.getWidenedType(n.getUnionType(T.map(e.candidateTypes,function(e){return n.getBaseTypeOfLiteralType(e)}),!0));if(e.properties&&f(e.properties.get("then")))return s=m(0,e.properties.get("then").callContexts,!1,n).getCallSignatures().map(function(e){return e.getReturnType()}),n.createPromiseType(s.length?n.getUnionType(s,!0):n.getAnyType());if(e.properties&&f(e.properties.get("push")))return n.createArrayType(m(0,e.properties.get("push").callContexts,!1,n));if(e.properties||e.callContexts||e.constructContexts||e.numberIndexContext||e.stringIndexContext){var i=T.createUnderscoreEscapedMap(),t=[],r=[],s=void 0,a=void 0;if(e.properties&&e.properties.forEach(function(e,t){var r=n.createSymbol(4,t);r.type=h(e,n)||n.getAnyType(),i.set(t,r)}),e.callContexts)for(var o=0,l=e.callContexts;o<l.length;o++){var c=l[o];t.push(g(c,n))}if(e.constructContexts)for(var u=0,d=e.constructContexts;u<d.length;u++){var p=d[u];r.push(g(p,n))}return e.numberIndexContext&&(a=n.createIndexInfo(h(e.numberIndexContext,n),!1)),e.stringIndexContext&&(s=n.createIndexInfo(h(e.stringIndexContext,n),!1)),n.createAnonymousType(void 0,i,t,r,s,a)}}function m(e,t,r,n){var i=[];if(t)for(var s=0,a=t;s<a.length;s++){var o=a[s];o.argumentTypes.length>e&&(r?i=T.concatenate(i,T.map(o.argumentTypes.slice(e),function(e){return n.getBaseTypeOfLiteralType(e)})):i.push(n.getBaseTypeOfLiteralType(o.argumentTypes[e])))}if(i.length)return t=n.getWidenedType(n.getUnionType(i,!0)),r?n.createArrayType(t):t}function g(e,t){for(var r=[],n=0;n<e.argumentTypes.length;n++){var i=t.createSymbol(1,T.escapeLeadingUnderscores("arg"+n));i.type=t.getWidenedType(t.getBaseTypeOfLiteralType(e.argumentTypes[n])),r.push(i)}var s=h(e.returnType,t)||t.getVoidType();return t.createSignature(void 0,void 0,void 0,r,s,void 0,e.argumentTypes.length,!1,!1)}function E(e,t){!t||1&t.flags||8192&t.flags||(e.candidateTypes||(e.candidateTypes=[])).push(t)}function f(e){return e&&e.callContexts}(T.codefix||(T.codefix={})).registerCodeFix({errorCodes:[T.Diagnostics.Variable_0_implicitly_has_type_1_in_some_locations_where_its_type_cannot_be_determined.code,T.Diagnostics.Variable_0_implicitly_has_an_1_type.code,T.Diagnostics.Parameter_0_implicitly_has_an_1_type.code,T.Diagnostics.Rest_parameter_0_implicitly_has_an_any_type.code,T.Diagnostics.Property_0_implicitly_has_type_any_because_its_get_accessor_lacks_a_return_type_annotation.code,T.Diagnostics._0_which_lacks_return_type_annotation_implicitly_has_an_1_return_type.code,T.Diagnostics.Property_0_implicitly_has_type_any_because_its_set_accessor_lacks_a_parameter_type_annotation.code,T.Diagnostics.Member_0_implicitly_has_an_1_type.code],getCodeActions:function(e){var s,n=e.sourceFile,t=e.program,r=e.span.start,i=e.errorCode,a=e.cancellationToken,o=T.getTokenAtPosition(n,r,!1);if(!T.isInJavaScriptFile(o)){switch(o.kind){case 71:case 24:case 114:case 112:case 113:case 131:break;default:return}var l=T.getContainingFunction(o),c=t.getTypeChecker();switch(i){case T.Diagnostics.Member_0_implicitly_has_an_1_type.code:case T.Diagnostics.Variable_0_implicitly_has_type_1_in_some_locations_where_its_type_cannot_be_determined.code:return u(o.parent);case T.Diagnostics.Variable_0_implicitly_has_an_1_type.code:return(e=>(e=c.getSymbolAtLocation(e))&&e.valueDeclaration&&u(e.valueDeclaration))(o);case T.Diagnostics.Parameter_0_implicitly_has_an_1_type.code:if(T.isSetAccessor(l))return d(l);case T.Diagnostics.Rest_parameter_0_implicitly_has_an_any_type.code:return(e=>{var t;return T.isIdentifier(e.name)&&(e=>{switch(e.kind){case 228:case 151:case 152:return 1;case 186:return e.name}})(l)&&(t=(e=>{switch(e.kind){case 152:case 186:case 228:case 151:var t=152===e.kind?f(e,n,123):e.name;if(t)return _.inferTypeForParametersFromReferences(h(t),e,c,a)}})(l)||T.map(l.parameters,function(e){return T.isIdentifier(e.name)&&m(e.name)}))&&(t=T.zipWith(l.parameters,t,function(e,t){return t&&!e.type&&!e.initializer&&(t=g(t,l))?{span:{start:e.end,length:0},newText:": "+t}:void 0}).filter(function(e){return!!e})).length?[{description:T.formatStringFromArgs(T.getLocaleSpecificMessage(T.Diagnostics.Infer_parameter_types_from_usage),[e.name.getText()]),changes:[{fileName:n.fileName,textChanges:t}]}]:void 0})(o.parent);case T.Diagnostics.Property_0_implicitly_has_type_any_because_its_get_accessor_lacks_a_return_type_annotation.code:case T.Diagnostics._0_which_lacks_return_type_annotation_implicitly_has_an_1_return_type.code:return T.isGetAccessor(l)?(e=>{var t,r;return T.isIdentifier(e.name)&&(r=(r=m(e.name))&&g(r,l))?(t=f(e,n,20),p(e.name.getText(),t.getEnd(),": "+r)):void 0})(l):void 0;case T.Diagnostics.Property_0_implicitly_has_type_any_because_its_set_accessor_lacks_a_parameter_type_annotation.code:return T.isSetAccessor(l)?d(l):void 0}}return;function u(e){if(T.isIdentifier(e.name)){var t=m(e.name),t=t&&g(t,e);if(t)return p(e.name.getText(),e.name.getEnd(),": "+t)}}function d(e){var t=e.parameters[0];if(t&&T.isIdentifier(e.name)&&T.isIdentifier(t.name)){var r=m(e.name)||m(t.name),r=r&&g(r,l);if(r)return p(e.name.getText(),t.name.getEnd(),": "+r)}}function p(e,t,r){return[{description:T.formatStringFromArgs(T.getLocaleSpecificMessage(T.Diagnostics.Infer_type_of_0_from_usage),[e]),changes:[{fileName:n.fileName,textChanges:[{span:{start:t,length:0},newText:r}]}]}]}function h(e){e=T.FindAllReferences.findReferencedSymbols(t,a,t.getSourceFiles(),e.getSourceFile(),e.getStart());return T.Debug.assert(!!e,"Found no references!"),T.Debug.assert(1===e.length,"Found more references than expected"),T.map(e[0].references,function(e){return T.getTokenAtPosition(t.getSourceFile(e.fileName),e.textSpan.start,!1)})}function m(e){return _.inferTypeFromReferences(h(e),c,a)}function g(e,t){s||(n=!(r=""),s={string:function(){return n?r:void 0},writeKeyword:i=function(e){return r+=e},writeOperator:i,writePunctuation:i,writeSpace:i,writeStringLiteral:i,writeParameter:i,writeProperty:i,writeSymbol:i,writeLine:function(){return r+=" "},increaseIndent:T.noop,decreaseIndent:T.noop,clear:function(){n=!(r="")},trackSymbol:function(e,t,r){0!==c.isSymbolAccessible(e,t,r,!1).accessibility&&(n=!1)},reportInaccessibleThisError:function(){n=!1},reportPrivateInBaseOfClassExpression:function(){n=!1}}),s.clear();var r,n,i=s;return c.getSymbolDisplayBuilder().buildTypeDisplay(e,i,t),i.string()}function f(e,t,r){for(var n=0,i=e.getChildren(t);n<i.length;n++){var s=i[n];if(s.kind===r)return s}}}}),(e=_=_||{}).inferTypeFromReferences=function(e,t,r){for(var n={},i=0,s=e;i<s.length;i++){var a=s[i];r.throwIfCancellationRequested(),k(a,t,n)}return h(n,t)},e.inferTypeForParametersFromReferences=function(e,t,r,n){if(t.parameters){for(var i={},s=0,a=e;s<a.length;s++){var o=a[s];n.throwIfCancellationRequested(),k(o,r,i)}var l=152===t.kind?i.constructContexts:i.callContexts;if(l){for(var c=[],u=0;u<t.parameters.length;u++){for(var d,p=[],h=T.isRestParameter(t.parameters[u]),m=0,g=l;m<g.length;m++){var f=g[m];f.argumentTypes.length>u&&(h?p=T.concatenate(p,T.map(f.argumentTypes.slice(u),function(e){return r.getBaseTypeOfLiteralType(e)})):p.push(r.getBaseTypeOfLiteralType(f.argumentTypes[u])))}p.length&&(d=r.getWidenedType(r.getUnionType(p,!0)),c[u]=h?r.createArrayType(d):d)}return c}}}})(ts=ts||{}),(o=>{var n,i,t;function r(e){return!!e&&(o.isFunctionLikeDeclaration(e)?e.parameters.some(r)||!e.type&&!!o.getJSDocReturnType(e):!e.type&&!!o.getJSDocType(e))}function s(e){return o.isFunctionLikeDeclaration(e)||226===e.kind||146===e.kind||148===e.kind||149===e.kind}function l(e){var t,r;if(void 0!==e)switch(e.kind){case 268:case 269:return o.createTypeReferenceNode("any",o.emptyArray);case 272:return o.createUnionTypeNode([o.visitNode(e.type,l),o.createTypeReferenceNode("undefined",o.emptyArray)]);case 271:return l(e.type);case 270:return o.createUnionTypeNode([o.visitNode(e.type,l),o.createTypeReferenceNode("null",o.emptyArray)]);case 274:return o.createArrayTypeNode(o.visitNode(e.type,l));case 273:return r=(t=e).parameters&&t.parameters.map(l),o.createFunctionTypeNode(o.emptyArray,r,t.type);case 146:return t=(r=e).parent.parameters.indexOf(r),n=274===r.type.kind&&t===r.parent.parameters.length-1,t=r.name||(n?"rest":"arg"+t),n=n?o.createToken(24):r.dotDotDotToken,o.createParameter(r.decorators,r.modifiers,n,t,r.questionToken,o.visitNode(r.type,l),r.initializer);case 159:var n=e,i=n.typeName,s=n.typeArguments;if(o.isIdentifier(n.typeName)){if(o.isJSDocIndexSignature(n))return(e=>{var t=o.createParameter(void 0,void 0,void 0,133===e.typeArguments[0].kind?"n":"s",void 0,o.createTypeReferenceNode(133===e.typeArguments[0].kind?"number":"string",[]),void 0),t=o.createTypeLiteralNode([o.createIndexSignature(void 0,void 0,[t],e.typeArguments[1])]);return o.setEmitFlags(t,1),t})(n);var a=n.typeName.text;switch(n.typeName.text){case"String":case"Boolean":case"Object":case"Number":a=a.toLowerCase();break;case"array":case"date":case"promise":a=a[0].toUpperCase()+a.slice(1)}i=o.createIdentifier(a),s="Array"!==a&&"Promise"!==a||n.typeArguments?o.visitNodes(n.typeArguments,l):o.createNodeArray([o.createTypeReferenceNode("any",o.emptyArray)])}return o.createTypeReferenceNode(i,s);default:i=o.visitEachChild(e,l,void 0);return o.setEmitFlags(i,1),i}}(n=o.refactor||(o.refactor={})).annotateWithTypeFromJSDoc||(n.annotateWithTypeFromJSDoc={}),i="annotate",t={name:"Annotate with type from JSDoc",description:o.Diagnostics.Annotate_with_type_from_JSDoc.message,getEditsForAction:function(e,t){if(i!==t)return o.Debug.fail("actionName !== action: "+i+" !== "+t);t=o.getTokenAtPosition(e.file,e.startPosition,!1),t=o.findAncestor(t,s);if(!t||t.type)return;var r=o.getJSDocType(t);{if(o.isFunctionLikeDeclaration(t)&&(o.getJSDocReturnType(t)||t.parameters.some(function(e){return!!o.getJSDocType(e)}))||r&&146===t.kind)return(e=>{var t=e.file,r=o.getTokenAtPosition(t,e.startPosition,!1),r=o.findAncestor(r,o.isFunctionLikeDeclaration),e=o.textChanges.ChangeTracker.fromContext(e),n=(e=>{var t=o.getEffectiveTypeParameterDeclarations(e,!0),r=e.parameters.map(function(e){return o.createParameter(e.decorators,e.modifiers,e.dotDotDotToken,e.name,e.questionToken,l(o.getEffectiveTypeAnnotationNode(e,!0)),e.initializer)}),n=l(o.getEffectiveReturnTypeNode(e,!0));switch(e.kind){case 228:return o.createFunctionDeclaration(e.decorators,e.modifiers,e.asteriskToken,e.name,t,r,n,e.body);case 152:return o.createConstructor(e.decorators,e.modifiers,r,e.body);case 186:return o.createFunctionExpression(e.modifiers,e.asteriskToken,e.name,t,r,n,e.body);case 187:return o.createArrowFunction(e.modifiers,t,r,n,e.equalsGreaterThanToken,e.body);case 151:return o.createMethod(e.decorators,e.modifiers,e.asteriskToken,e.name,e.questionToken,t,r,n,e.body);case 153:return o.createGetAccessor(e.decorators,e.modifiers,e.name,e.parameters,n,e.body);case 154:return o.createSetAccessor(e.decorators,e.modifiers,e.name,r,e.body);default:return o.Debug.assertNever(e,"Unexpected SyntaxKind: "+e.kind)}})(r);return o.suppressLeadingAndTrailingTrivia(n),e.replaceRange(t,{pos:r.getStart(),end:r.end},n),{edits:e.getChanges(),renameFilename:void 0,renameLocation:void 0}})(e);{if(r)return(e=>{var t,r=e.file,n=o.getTokenAtPosition(r,e.startPosition,!1),n=o.findAncestor(n,s),i=o.getJSDocType(n);return n&&i&&!n.type?(e=o.textChanges.ChangeTracker.fromContext(e),t=((e,t)=>{switch(e.kind){case 226:return o.createVariableDeclaration(e.name,t,e.initializer);case 148:return o.createPropertySignature(e.modifiers,e.name,e.questionToken,t,e.initializer);case 149:return o.createProperty(e.decorators,e.modifiers,e.name,e.questionToken,t,e.initializer);default:return o.Debug.fail("Unexpected SyntaxKind: "+e.kind)}})(n,l(i)),o.suppressLeadingAndTrailingTrivia(t),e.replaceRange(r,{pos:n.getStart(),end:n.end},t),{edits:e.getChanges(),renameFilename:void 0,renameLocation:void 0}):o.Debug.fail("!decl || !jsdocType || decl.type: !"+n+" || !"+i+" || "+n.type)})(e);o.Debug.assert(!!n,"No applicable refactor found.")}}},getAvailableActions:function(e){if(o.isInJavaScriptFile(e.file))return;e=o.getTokenAtPosition(e.file,e.startPosition,!1);if(r(o.findAncestor(e,s)))return[{name:t.name,description:t.description,actions:[{description:t.description,name:i}]}]}},n.registerRefactor(t)})(ts=ts||{}),(f=>{var e,t;function _(e){var t=e.startPosition,r=e.file,e=e.program.getTypeChecker(),r=f.getTokenAtPosition(r,t,!1);return e.getSymbolAtLocation(r)}(e=f.refactor||(f.refactor={})).convertFunctionToES6Class||(e.convertFunctionToES6Class={}),t={name:"Convert to ES2015 class",description:f.Diagnostics.Convert_function_to_an_ES2015_class.message,getEditsForAction:function(e,t){if("convert"!==t)return;var u=e.file,n=_(e),t=e.rulesProvider.getFormatOptions().newLineCharacter,r=[],i=[];if(!(19&n.flags))return;var s,a,o=n.valueDeclaration,l=f.textChanges.ChangeTracker.fromContext(e);switch(o.kind){case 228:p(s=o),a=(e=>{var t=h(n),r=(e.body&&t.unshift(f.createConstructor(void 0,void 0,e.parameters,e.body)),g(e,84));return f.createClassDeclaration(void 0,r,e.name,void 0,void 0,t)})(o);break;case 226:s=o.parent.parent,1===o.parent.declarations.length?p(s):p(o,!0),a=(e=>{var t,r=e.initializer;if(r&&186===r.kind&&71===e.name.kind)return t=h(r.symbol),r.body&&t.unshift(f.createConstructor(void 0,void 0,r.parameters,r.body)),r=g(s,84),f.createClassDeclaration(void 0,r,e.name,void 0,void 0,t)})(o)}if(!a)return;l.insertNodeAfter(u,s,a,{suffix:t});for(var c=0,d=i;c<d.length;c++)(0,d[c])();return{edits:l.getChanges(),renameFilename:void 0,renameLocation:void 0};function p(t,e){void 0===e&&(e=!1),r.some(function(e){return f.isNodeDescendantOf(t,e)})||(r.push(t),e?i.push(function(){return l.deleteNodeInList(u,t)}):i.push(function(){return l.deleteNode(u,t)}))}function h(e){var t=[];return e.members&&e.members.forEach(function(e){e=r(e,void 0);e&&t.push(e)}),e.exports&&e.exports.forEach(function(e){e=r(e,[f.createToken(115)]);e&&t.push(e)}),t;function r(e,t){if(4&e.flags){var r,n=e.valueDeclaration,i=n.parent;if(r=i.right,f.isFunctionLike(r)){if(p(i.parent&&210===i.parent.kind?i.parent:i),!i.right)return f.createProperty([],t,e.name,void 0,void 0,void 0);switch(i.right.kind){case 186:var s=i.right,a=f.concatenate(t,g(s,120));return m(i,s=f.createMethod(void 0,a,void 0,n.name,void 0,void 0,s.parameters,void 0,s.body)),s;case 187:var o=i.right,l=o.body,c=void 0,a=(c=207===l.kind?l:f.createBlock([f.createReturn(l)]),f.concatenate(t,g(o,120)));return m(i,s=f.createMethod(void 0,a,void 0,n.name,void 0,void 0,o.parameters,void 0,c)),s;default:if(!f.isSourceFileJavaScript(u))return l=f.createProperty(void 0,t,n.name,void 0,void 0,i.right),m(i.parent,l),l}}}}}function m(e,i){f.forEachLeadingCommentRange(u.text,e.pos,function(e,t,r,n){3===r?(e+=2,t-=2):e+=2,f.addSyntheticLeadingComment(i,r,u.text.slice(e,t),n)})}function g(e,t){return f.filter(e.modifiers,function(e){return e.kind===t})}},getAvailableActions:function(e){if(!f.isInJavaScriptFile(e.file))return;e=_(e);if(!e)return;f.isDeclarationOfFunctionOrClassExpression(e)&&(e=e.valueDeclaration.initializer.symbol);if(16&e.flags&&e.members&&0<e.members.size)return[{name:t.name,description:t.description,actions:[{description:t.description,name:"convert"}]}]}},e.registerRefactor(t)})(ts=ts||{}),(H=>{var e,t,P,G,m;function r(e){var t=j(e.file,{start:e.startPosition,length:H.getRefactorContextLength(e)}).targetRange;if(void 0!==t){e=(t=z(t=t,e=e)).scopes,o=(t=t.readsAndWrites).functionErrorsPerScope,l=t.constantErrorsPerScope;var o,l,t=e.map(function(e,t){i=e;var r,n,i=H.isFunctionLikeDeclaration(i)?"inner function":H.isClassLike(i)?"method":"function",s=H.isClassLike(e)?"readonly field":"constant",a=H.isFunctionLikeDeclaration(e)?(e=>{switch(e.kind){case 152:return"constructor";case 186:return e.name?"function expression '"+e.name.text+"'":"anonymous function expression";case 228:return"function '"+e.name.text+"'";case 187:return"arrow function";case 151:return"method '"+e.name.getText();case 153:return"'get "+e.name.getText()+"'";case 154:return"'set "+e.name.getText()+"'";default:H.Debug.assertNever(e)}})(e):H.isClassLike(e)?229===(r=e).kind?"class '"+r.name.text+"'":r.name?"class expression '"+r.name.text+"'":"anonymous class expression":234===(r=e).kind?"namespace '"+r.parent.name.getText()+"'":r.externalModuleIndicator?0:1,i=1===a?(n=H.formatStringFromArgs(H.getLocaleSpecificMessage(H.Diagnostics.Extract_to_0_in_1_scope),[i,"global"]),H.formatStringFromArgs(H.getLocaleSpecificMessage(H.Diagnostics.Extract_to_0_in_1_scope),[s,"global"])):0===a?(n=H.formatStringFromArgs(H.getLocaleSpecificMessage(H.Diagnostics.Extract_to_0_in_1_scope),[i,"module"]),H.formatStringFromArgs(H.getLocaleSpecificMessage(H.Diagnostics.Extract_to_0_in_1_scope),[s,"module"])):(n=H.formatStringFromArgs(H.getLocaleSpecificMessage(H.Diagnostics.Extract_to_0_in_1),[i,a]),H.formatStringFromArgs(H.getLocaleSpecificMessage(H.Diagnostics.Extract_to_0_in_1),[s,a]));return 0!==t||H.isClassLike(e)||(i=H.formatStringFromArgs(H.getLocaleSpecificMessage(H.Diagnostics.Extract_to_0_in_enclosing_scope),[s])),{functionExtraction:{description:n,errors:o[t]},constantExtraction:{description:i,errors:l[t]}}});if(void 0!==t){for(var r=[],n=H.createMap(),i=[],s=H.createMap(),a=0,c=0,u=t;c<u.length;c++){var d,p=u[c],h=p.functionExtraction,p=p.constantExtraction;0===h.errors.length&&(d=h.description,n.has(d)||(n.set(d,!0),r.push({description:d,name:"function_scope_"+a}))),0===p.errors.length&&(d=p.description,s.has(d)||(s.set(d,!0),i.push({description:d,name:"constant_scope_"+a}))),a++}e=[];return r.length&&e.push({name:m.name,description:H.getLocaleSpecificMessage(H.Diagnostics.Extract_function),actions:r}),i.length&&e.push({name:m.name,description:H.getLocaleSpecificMessage(H.Diagnostics.Extract_constant),actions:i}),e.length?e:void 0}}}function n(e,t){var r=j(e.file,{start:e.startPosition,length:H.getRefactorContextLength(e)}).targetRange,n=/^function_scope_(\d+)$/.exec(t);if(n){var i,s=+n[1],a=(H.Debug.assert(isFinite(s),"Expected to parse a finite number from the function scope index"),n=s,p=z(m=r,g=e),u=p.scopes,c=(p=p.readsAndWrites).target,d=p.usagesPerScope,l=p.functionErrorsPerScope,p=p.exposedVariableDeclarations,H.Debug.assert(!l[n].length,"The extraction went missing? How?"),g.cancellationToken.throwIfCancellationRequested(),c),o=u[n],l=d[n],c=p,u=m,d=g,n=l.usages,p=l.typeParameterUsages,l=l.substitutions,h=d.program.getTypeChecker(),m=o.getSourceFile(),g=W(H.isClassLike(o)?"newMethod":"newFunction",m.text),f=H.isInJavaScriptFile(o),_=H.createIdentifier(g),y=void 0,b=[],v=[],l=(n.forEach(function(e,t){var r=void 0,n=(f||(n=h.getTypeOfSymbolAtLocation(e.symbol,e.node),n=h.getBaseTypeOfLiteralType(n),r=h.typeToTypeNode(n,a,H.NodeBuilderFlags.NoTruncation)),H.createParameter(void 0,void 0,void 0,t,void 0,r));b.push(n),2===e.usage&&(i=i||[]).push(e),v.push(H.createIdentifier(t))}),n=void 0!==(p=0===(n=H.arrayFrom(p.values()).map(function(e){return{type:e,declaration:(e=>{var t=void 0;if((e=e.symbol)&&e.declarations)for(var r=0,n=e.declarations;r<n.length;r++){var i=n[r];(void 0===t||i.pos<t.pos)&&(t=i)}return t})(e)}}).sort(J)).length?void 0:n.map(function(e){return e.declaration}))?p.map(function(e){return H.createTypeReferenceNode(e.name,void 0)}):void 0,H.isExpression(a)&&!f&&(T=h.getContextualType(a),y=h.typeToTypeNode(T,o,H.NodeBuilderFlags.NoTruncation)),(T=((e,i,s,a,t)=>{var o,l,r,n,c=void 0!==s||0<i.length;return H.isBlock(e)&&!c&&0===a.size?{body:H.createBlock(e.statements,!0),returnValueProperty:void 0}:(l=!1,r=H.createNodeArray(H.isBlock(e)?e.statements.slice(0):[H.isStatement(e)?e:H.createReturn(e)]),c||a.size?(n=H.visitNodes(r,function e(t){{var r,n;return!l&&219===t.kind&&c?(r=Y(i,s),t.expression&&(o=o||"__return",r.unshift(H.createPropertyAssignment(o,H.visitNode(t.expression,e)))),1===r.length?H.createReturn(r[0].name):H.createReturn(H.createObjectLiteral(r))):(l=(r=l)||H.isFunctionLikeDeclaration(t)||H.isClassLike(t),n=a.get(H.getNodeId(t).toString()),n=n?H.getSynthesizedDeepClone(n):H.visitEachChild(t,e,H.nullTransformationContext),l=r,n)}}).slice(),c&&!t&&H.isStatement(e)&&(1===(t=Y(i,s)).length?n.push(H.createReturn(t[0].name)):n.push(H.createReturn(H.createObjectLiteral(t)))),{body:H.createBlock(n,!0),returnValueProperty:o}):{body:H.createBlock(r,!0),returnValueProperty:void 0})})(a,c,i,l,!!(u.facts&G.HasReturn))).body),T=T.returnValueProperty,k=(H.suppressLeadingAndTrailingTrivia(l),w=H.isClassLike(o)?(w=f?[]:[H.createToken(112)],u.facts&G.InStaticRegion&&w.push(H.createToken(115)),u.facts&G.IsAsyncFunction&&w.push(H.createToken(120)),H.createMethod(void 0,w.length?w:void 0,u.facts&G.IsGenerator?H.createToken(39):void 0,_,void 0,p,b,y,l)):H.createFunctionDeclaration(void 0,u.facts&G.IsAsyncFunction?[H.createToken(120)]:void 0,u.facts&G.IsGenerator?H.createToken(39):void 0,_,p,b,y,l),_=H.textChanges.ChangeTracker.fromContext(d),(p=((t,e)=>H.find((e=>{if(H.isFunctionLikeDeclaration(e)){var t=e.body;if(H.isBlock(t))return t.statements}else{if(H.isModuleBlock(e)||H.isSourceFile(e))return e.statements;if(H.isClassLike(e))return e.members;H.assertTypeIsNever(e)}return H.emptyArray})(e),function(e){return e.pos>=t&&H.isFunctionLikeDeclaration(e)&&!H.isConstructorDeclaration(e)}))((X(u.range)?H.last(u.range):u.range).end,o))?_.insertNodeBefore(d.file,p,w,{suffix:d.newLineCharacter+d.newLineCharacter}):_.insertNodeBefore(d.file,o.getLastToken(),w,{prefix:H.isLineBreak(m.text.charCodeAt(o.getLastToken().pos))?d.newLineCharacter:d.newLineCharacter+d.newLineCharacter,suffix:d.newLineCharacter}),[]),l=((e,t,r)=>(r=H.createIdentifier(r),H.isClassLike(e)?(t=t.facts&G.InStaticRegion?H.createIdentifier(e.name.text):H.createThis(),H.createPropertyAccess(t,r)):r))(o,u,g),p=H.createCall(l,n,v);if(u.facts&G.IsGenerator&&(p=H.createYield(H.createToken(39),p)),u.facts&G.IsAsyncFunction&&(p=H.createAwait(p)),c.length&&!i)if(H.Debug.assert(!T),H.Debug.assert(!(u.facts&G.HasReturn)),1===c.length){var x=c[0];k.push(H.createVariableStatement(void 0,H.createVariableDeclarationList([H.createVariableDeclaration(H.getSynthesizedDeepClone(x.name),H.getSynthesizedDeepClone(x.type),p)],x.parent.flags)))}else{for(var E=[],M=[],F=c[0].parent.flags,S=!1,C=0,B=c;C<B.length;C++){var x=B[C],$=(E.push(H.createBindingElement(void 0,void 0,H.getSynthesizedDeepClone(x.name))),h.typeToTypeNode(h.getBaseTypeOfLiteralType(h.getTypeAtLocation(x)),o,H.NodeBuilderFlags.NoTruncation));M.push(H.createPropertySignature(void 0,x.symbol.name,void 0,$,void 0)),S=S||void 0!==x.type,F&=x.parent.flags}var w=S?H.createTypeLiteralNode(M):void 0;w&&H.setEmitFlags(w,1),k.push(H.createVariableStatement(void 0,H.createVariableDeclarationList([H.createVariableDeclaration(H.createObjectBindingPattern(E),w,p)],F)))}else if(c.length||i){if(c.length)for(var I=0,U=c;I<U.length;I++){var A=(x=U[I]).parent.flags;2&A&&(A=-3&A|1),k.push(H.createVariableStatement(void 0,H.createVariableDeclarationList([H.createVariableDeclaration(x.symbol.name,V(x.type))],A)))}T&&k.push(H.createVariableStatement(void 0,H.createVariableDeclarationList([H.createVariableDeclaration(T,V(y))],1)));m=Y(c,i);T&&m.unshift(H.createShorthandPropertyAssignment(T)),1===m.length?(H.Debug.assert(!T),k.push(H.createStatement(H.createAssignment(m[0].name,p))),u.facts&G.HasReturn&&k.push(H.createReturn())):(k.push(H.createStatement(H.createAssignment(H.createObjectLiteral(m),p))),T&&k.push(H.createReturn(H.createIdentifier(T))))}else u.facts&G.HasReturn?k.push(H.createReturn(p)):X(u.range)?k.push(H.createStatement(p)):k.push(p);return l=X(u.range)?{pos:H.first(u.range).getStart(),end:H.last(u.range).end}:{pos:u.range.getStart(),end:u.range.end},_.replaceRangeWithNodes(d.file,l,k,{nodeSeparator:d.newLineCharacter}),n=_.getChanges(),w=(X(u.range)?H.first(u.range):u.range).getSourceFile().fileName,y=q(n,w,g,!1),{renameFilename:w,renameLocation:y,edits:n};function V(e){if(void 0!==e){for(var e=H.getSynthesizedDeepClone(e),t=e;H.isParenthesizedTypeNode(t);)t=t.type;return H.isUnionTypeNode(t)&&H.find(t.types,function(e){return 139===e.kind})?e:H.createUnionTypeNode([e,H.createKeywordTypeNode(139)])}}}var D,N,O,R,L,P,p,c=/^constant_scope_(\d+)$/.exec(t);if(c)return s=+c[1],H.Debug.assert(isFinite(s),"Expected to parse a finite number from the constant scope index"),m=s,l=z(T=r,p=e),d=l.scopes,_=(l=l.readsAndWrites).target,u=l.usagesPerScope,g=l.constantErrorsPerScope,l=l.exposedVariableDeclarations,H.Debug.assert(!g[m].length,"The extraction went missing? How?"),H.Debug.assert(0===l.length,"Extract constant accepted a range containing a variable declaration?"),p.cancellationToken.throwIfCancellationRequested(),w=H.isExpression(_)?_:_.statements[0].expression,y=d[m],n=u[m],t=T.facts,s=p,n=n.substitutions,r=s.program.getTypeChecker(),e=y.getSourceFile(),R=W(H.isClassLike(y)?"newProperty":"newLocal",e.text),L=H.isInJavaScriptFile(y),r=L?void 0:r.typeToTypeNode(r.getContextualType(w),y,H.NodeBuilderFlags.NoTruncation),n=((e,n)=>n.size?function e(t){var r=n.get(H.getNodeId(t).toString());return r?H.getSynthesizedDeepClone(r):H.visitEachChild(t,e,H.nullTransformationContext)}(e):e)(w,n),H.suppressLeadingAndTrailingTrivia(n),P=H.textChanges.ChangeTracker.fromContext(s),H.isClassLike(y)?(H.Debug.assert(!L),(L=[]).push(H.createToken(112)),t&G.InStaticRegion&&L.push(H.createToken(115)),L.push(H.createToken(131)),L=H.createProperty(void 0,L,R,void 0,r,n),O=H.createPropertyAccess(t&G.InStaticRegion?H.createIdentifier(y.name.getText()):H.createThis(),H.createIdentifier(R)),N=((e,t)=>{for(var r=t.members,n=void H.Debug.assert(0<r.length),i=!0,s=0,a=r;s<a.length;s++){var o=a[s];if(o.pos>e)return n||r[0];if(i&&!H.isPropertyDeclaration(o)){if(void 0!==n)return o;i=!1}n=o}return H.Debug.assert(void 0!==n),n})(w.pos,y),P.insertNodeBefore(s.file,N,L,{suffix:s.newLineCharacter+s.newLineCharacter}),P.replaceRange(s.file,{pos:w.getStart(),end:w.end},O)):(t=H.createVariableDeclaration(R,r,n),(L=((e,t)=>{for(var r=void 0;void 0!==e&&e!==t;){if(H.isVariableDeclaration(e)&&e.initializer===r&&H.isVariableDeclarationList(e.parent)&&1<e.parent.declarations.length)return e;e=(r=e).parent}})(w,y))?(P.insertNodeAt(s.file,L.getStart(),t,{suffix:", "}),O=H.createIdentifier(R),P.replaceRange(s.file,{pos:w.getStart(),end:w.end},O)):210===w.parent.kind&&y===H.findAncestor(w,K)?(D=H.createVariableStatement(void 0,H.createVariableDeclarationList([t],2)),P.replaceRange(s.file,{pos:w.parent.getStart(),end:w.parent.end},D)):(D=H.createVariableStatement(void 0,H.createVariableDeclarationList([t],2)),0===(N=((e,t)=>{H.Debug.assert(!H.isClassLike(t));for(var r=void 0,n=e;n!==t;n=n.parent)K(n)&&(r=n);for(n=(r||e).parent;;n=n.parent){if(Z(n)){for(var i=void 0,s=0,a=n.statements;s<a.length;s++){var o=a[s];if(o.pos>e.pos)break;i=o}return H.Debug.assert(void 0!==i),i}if(n===t){H.Debug.fail("Didn't encounter a block-like before encountering scope");break}}})(w,y)).pos?(r=H.getSourceFileImportLocation(e),P.insertNodeAt(s.file,r,D,{prefix:0===r?void 0:s.newLineCharacter,suffix:H.isLineBreak(e.text.charCodeAt(r))?s.newLineCharacter:s.newLineCharacter+s.newLineCharacter})):P.insertNodeBefore(s.file,N,D,{suffix:s.newLineCharacter+s.newLineCharacter}),210===w.parent.kind?P.deleteRange(s.file,{pos:w.parent.getStart(),end:w.parent.end}):(O=H.createIdentifier(R),P.replaceRange(s.file,{pos:w.getStart(),end:w.end},O)))),n=P.getChanges(),L=w.getSourceFile().fileName,t=q(n,L,R,!0),{renameFilename:L,renameLocation:t,edits:n};H.Debug.fail("Unrecognized action name")}function i(e){return{message:e,code:0,category:H.DiagnosticCategory.Message,key:e}}function j(e,l){var t=l.length;if(0===t)return{errors:[H.createFileDiagnostic(e,l.start,t,P.CannotExtractEmpty)]};var r=h(H.getTokenAtPosition(e,l.start,!1),e,l),n=h(H.findTokenOnLeftOfPosition(e,H.textSpanEnd(l)),e,l),c=[],u=G.None;if(!r||!n)return{errors:[H.createFileDiagnostic(e,l.start,t,P.CannotExtractRange)]};if(r.parent!==n.parent)return{errors:[H.createFileDiagnostic(e,l.start,t,P.CannotExtractRange)]};if(r!==n){if(!Z(r.parent))return{errors:[H.createFileDiagnostic(e,l.start,t,P.CannotExtractRange)]};for(var i=[],s=0,a=r.parent.statements;s<a.length;s++){var o=a[s];if(o===r||i.length){var d=p(o);if(d)return{errors:d};i.push(o)}if(o===n)break}return{targetRange:{range:i,facts:u,declarations:c}}}e=(e=>{if(H.isIdentifier(H.isExpressionStatement(e)?e.expression:e))return[H.createDiagnosticForNode(e,P.CannotExtractIdentifier)]})(r)||p(r);return e?{errors:e}:{targetRange:{range:(e=>H.isStatement(e)?[e]:H.isPartOfExpression(e)?H.isExpressionStatement(e.parent)?[e.parent]:e:void 0)(r),facts:u,declarations:c}};function p(e){if(0,!(H.isStatement(e)||H.isPartOfExpression(e)&&(e=>{if(264!==e.parent.kind){switch(e.kind){case 9:return 238!==e.parent.kind&&242!==e.parent.kind;case 198:case 174:case 176:return;case 71:return 176!==e.parent.kind&&242!==e.parent.kind&&246!==e.parent.kind}return 1}})(e)))return[H.createDiagnosticForNode(e,P.StatementOrExpressionExpected)];if(H.isInAmbientContext(e))return[H.createDiagnosticForNode(e,P.CannotExtractAmbientBlock)];var s,t=H.getContainingClass(e);if(t)for(var r=t,n=e;n!==r;){if(149===n.kind){H.hasModifier(n,32)&&(u|=G.InStaticRegion);break}if(146===n.kind){152===H.getContainingFunction(n).kind&&(u|=G.InStaticRegion);break}151===n.kind&&H.hasModifier(n,32)&&(u|=G.InStaticRegion),n=n.parent}var a,o=4;return function e(t){if(s)return!0;if(H.isDeclaration(t)){var r=226===t.kind?t.parent.parent:t;if(H.hasModifier(r,1))return(s=s||[]).push(H.createDiagnosticForNode(t,P.CannotExtractExportedEntity)),!0;c.push(t.symbol)}switch(t.kind){case 238:return(s=s||[]).push(H.createDiagnosticForNode(t,P.CannotExtractImport)),!0;case 97:if(181===t.parent.kind){var n=H.getContainingClass(t);if(n.pos<l.start||n.end>=l.start+l.length)return(s=s||[]).push(H.createDiagnosticForNode(t,P.CannotExtractSuper)),!0}else u|=G.UsesThis}if(!t||H.isFunctionLikeDeclaration(t)||H.isClassLike(t)){switch(t.kind){case 228:case 229:265===t.parent.kind&&void 0===t.parent.externalModuleIndicator&&(s=s||[]).push(H.createDiagnosticForNode(t,P.FunctionWillNotBeVisibleInTheNewScope))}return!1}r=o;switch(t.kind){case 211:case 224:o=0;break;case 207:t.parent&&224===t.parent.kind&&t.parent.finallyBlock===t&&(o=4);break;case 257:o|=1;break;default:H.isIterationStatement(t,!1)&&(o|=3)}switch(t.kind){case 169:case 99:u|=G.UsesThis;break;case 222:var i=t.label;(a=a||[]).push(i.escapedText),H.forEachChild(t,e),a.pop();break;case 218:case 217:(i=t.label)?H.contains(a,i.escapedText)||(s=s||[]).push(H.createDiagnosticForNode(t,P.CannotExtractRangeContainingLabeledBreakOrContinueStatementWithTargetOutsideOfTheRange)):o&(218===t.kind?1:2)||(s=s||[]).push(H.createDiagnosticForNode(t,P.CannotExtractRangeContainingConditionalBreakOrContinueStatements));break;case 191:u|=G.IsAsyncFunction;break;case 197:u|=G.IsGenerator;break;case 219:4&o?u|=G.HasReturn:(s=s||[]).push(H.createDiagnosticForNode(t,P.CannotExtractRangeContainingConditionalReturnStatement));break;default:H.forEachChild(t,e)}o=r}(e),s}}function K(e){return H.isFunctionLikeDeclaration(e)||H.isSourceFile(e)||H.isModuleBlock(e)||H.isClassLike(e)}function z(e,t){var r,n=t.file,i=(e=>{var t=X(e.range)?H.first(e.range):e.range;if(e.facts&G.UsesThis){var r,e=H.getContainingClass(t);if(e)return(r=H.findAncestor(t,H.isFunctionLikeDeclaration))?[r,e]:[e]}for(var n=[];;)if(K(t=146===(t=t.parent).kind?H.findAncestor(t,function(e){return H.isFunctionLikeDeclaration(e)}).parent:t)&&(n.push(t),265===t.kind))return n})(e),s=(s=n,X((r=e).range)?{pos:H.first(r.range).getStart(s),end:H.last(r.range).getEnd()}:r.range);return{scopes:i,readsAndWrites:((f,_,y,b,v,i)=>{var s=H.createMap(),T=[],k=[],x=[],E=[],a=[],o=H.createMap(),l=[],c=void 0,e=X(f.range)?1===f.range.length&&H.isExpressionStatement(f.range[0])?f.range[0].expression:void 0:f.range,t=void 0;void 0===e?(p=f.range,h=H.first(p).getStart(),p=H.last(p).end,t=H.createFileDiagnostic(b,h,p-h,P.ExpressionExpected)):9216&v.getTypeAtLocation(e).flags&&(t=H.createDiagnosticForNode(e,P.UselessConstantType));for(var r=0,n=_;r<n.length;r++){var u=n[r],d=(T.push({usages:H.createMap(),typeParameterUsages:H.createMap(),substitutions:H.createMap()}),k.push(H.createMap()),x.push(H.isFunctionLikeDeclaration(u)&&228!==u.kind?[H.createDiagnosticForNode(u,P.CannotExtractToOtherFunctionLike)]:[]),[]);t&&d.push(t),H.isClassLike(u)&&H.isInJavaScriptFile(u)&&d.push(H.createDiagnosticForNode(u,P.CannotExtractToJSClass)),H.isArrowFunction(u)&&!H.isBlock(u.body)&&d.push(H.createDiagnosticForNode(u,P.CannotExtractToExpressionArrowFunction)),E.push(d)}var S=H.createMap(),p=X(f.range)?H.createBlock(f.range):f.range,h=X(f.range)?H.first(f.range):f.range,m=(e=>{for(;e;e=e.parent)if((e=>H.isDeclarationWithTypeParameters(e)&&void 0!==e.typeParameters&&0<e.typeParameters.length)(e))return!0;return!1})(h);if(function e(t,r){void 0===r&&(r=1);m&&O(v.getTypeAtLocation(t));H.isDeclaration(t)&&t.symbol&&a.push(t);H.isAssignmentExpression(t)?(e(t.left,2),e(t.right)):H.isUnaryExpressionWithWrite(t)?e(t.operand,2):!H.isPropertyAccessExpression(t)&&!H.isElementAccessExpression(t)&&H.isIdentifier(t)?!t.parent||H.isQualifiedName(t.parent)&&t!==t.parent.left||H.isPropertyAccessExpression(t.parent)&&t!==t.parent.expression||R(t,r,H.isPartOfTypeNode(t)):H.forEachChild(t,e)}(p),m&&!X(f.range)&&O(v.getContextualType(f.range)),0<s.size){for(var g=H.createMap(),C=0,w=h;void 0!==w&&C<_.length;w=w.parent)if(w===_[C]&&(g.forEach(function(e,t){T[C].typeParameterUsages.set(t,e)}),C++),H.isDeclarationWithTypeParameters(w)&&w.typeParameters)for(var I=0,A=w.typeParameters;I<A.length;I++){var D=A[I],D=v.getTypeAtLocation(D);s.has(D.id.toString())&&g.set(D.id.toString(),D)}H.Debug.assert(C===_.length)}a.length&&(e=H.isBlockScope(_[0],_[0].parent)?_[0]:H.getEnclosingBlockScopeContainer(_[0]),H.forEachChild(e,function e(t){if(t===f.range||X(f.range)&&0<=f.range.indexOf(t))return;var r=H.isIdentifier(t)?L(t):v.getSymbolAtLocation(t);{var n,i;r&&(n=H.find(a,function(e){return e.symbol===r}))&&(H.isVariableDeclaration(n)?(i=n.symbol.id.toString(),o.has(i)||(l.push(n),o.set(i,!0))):c=c||n)}H.forEachChild(t,e)}));for(var N=0;N<_.length;N++)(e=>{var t,r=T[e],n=(0<e&&(0<r.usages.size||0<r.typeParameterUsages.size)&&(r=X(f.range)?f.range[0]:f.range,E[e].push(H.createDiagnosticForNode(r,P.CannotAccessVariablesFromNestedScopes))),!1),i=void 0;T[e].usages.forEach(function(e){2===e.usage&&(n=!0,106500&e.symbol.flags)&&e.symbol.valueDeclaration&&H.hasModifier(e.symbol.valueDeclaration,64)&&(i=e.symbol.valueDeclaration)}),H.Debug.assert(X(f.range)||0===l.length),n&&!X(f.range)?(t=H.createDiagnosticForNode(f.range,P.CannotWriteInExpression),x[e].push(t),E[e].push(t)):i&&0<e?(t=H.createDiagnosticForNode(i,P.CannotExtractReadonlyPropertyInitializerOutsideConstructor),x[e].push(t),E[e].push(t)):c&&(t=H.createDiagnosticForNode(c,P.CannotExtractExportedEntity),x[e].push(t),E[e].push(t))})(N);return{target:p,usagesPerScope:T,functionErrorsPerScope:x,constantErrorsPerScope:E,exposedVariableDeclarations:l};function O(e){for(var t=0,r=v.getSymbolWalker(function(){return i.throwIfCancellationRequested(),!0}).walkType(e).visitedTypes;t<r.length;t++){var n=r[t];16384&n.flags&&s.set(n.id.toString(),n)}}function R(e,t,r){var n=((e,t,r)=>{var n=L(e);if(n){var i=H.getSymbolId(n).toString(),s=S.get(i);if(!(s&&t<=s))if(S.set(i,t),s)for(var a=0,o=T;a<o.length;a++){var l=o[a];l.usages.get(e.text)&&l.usages.set(e.text,{usage:t,symbol:n,node:e})}else{s=H.find(n.getDeclarations(),function(e){return e.getSourceFile()===b});if(!s)return;if(H.rangeContainsStartEnd(y,s.getStart(),s.end))return;if(f.facts&G.IsGenerator&&2===t){for(var c=H.createDiagnosticForNode(e,P.CannotExtractRangeThatContainsWritesToReferencesLocatedOutsideOfTheTargetRangeInGenerators),u=0,d=x;u<d.length;u++)d[u].push(c);for(var p=0,h=E;p<h.length;p++)h[p].push(c)}for(var m=0;m<_.length;m++){var g=_[m];v.resolveName(n.name,g,n.flags)===n||k[m].has(i)||((g=function e(t,r,n){if(!t)return;if(t.getDeclarations().some(function(e){return e.parent===r}))return H.createIdentifier(t.name);var i=e(t.parent,r,n);if(void 0===i)return;return n?H.createQualifiedName(i,H.createIdentifier(t.name)):H.createPropertyAccess(i,t.name)}(n.exportSymbol||n,g,r))?k[m].set(i,g):r?262144&n.flags||(c=H.createDiagnosticForNode(e,P.TypeWillNotBeVisibleInTheNewScope),x[m].push(c),E[m].push(c)):T[m].usages.set(e.text,{usage:t,symbol:n,node:e}))}}return i}})(e,t,r);if(n)for(var i=0;i<_.length;i++){var s=k[i].get(n);s&&T[i].substitutions.set(H.getNodeId(e).toString(),s)}}function L(e){return e.parent&&H.isShorthandPropertyAssignment(e.parent)&&e.parent.name===e?v.getShorthandAssignmentValueSymbol(e.parent):v.getSymbolAtLocation(e)}})(e,i,s,n,t.program.getTypeChecker(),t.cancellationToken)}}function W(e,t){for(var r=e,n=1;H.stringContains(t,r);n++)r=e+"_"+n;return r}function q(e,t,r,n){for(var i=0,s=-1,a=0,o=e;a<o.length;a++){var l=o[a],c=l.fileName,l=l.textChanges;H.Debug.assert(c===t);for(var u=0,d=l;u<d.length;u++){var p=d[u],h=p.span,p=p.newText,m=p.indexOf(r);if(-1!==m&&(s=h.start+i+m,!n))return s;i+=p.length-h.length}}return H.Debug.assert(n),H.Debug.assert(0<=s),s}function J(e,t){var r=e.type,e=e.declaration,n=t.type,t=t.declaration;if(e){if(!t)return 1;e=e.pos-t.pos;if(0!=e)return e}else if(t)return-1;e=r.symbol?r.symbol.getName():"",t=n.symbol?n.symbol.getName():"",e=H.compareStrings(e,t);return 0!==e?e:r.id-n.id}function Y(e,t){e=H.map(e,function(e){return H.createShorthandPropertyAssignment(e.symbol.name)}),t=H.map(t,function(e){return H.createShorthandPropertyAssignment(e.symbol.name)});return void 0===e?t:void 0===t?e:e.concat(t)}function X(e){return H.isArray(e)}function h(e,t,r){var n,i;if(e)for(;e.parent;){if(H.isSourceFile(e.parent)||(n=r,i=e.parent,!(H.textSpanContainsPosition(n,i.getStart(t))&&i.getEnd()<=H.textSpanEnd(n))))return e;e=e.parent}}function Z(e){switch(e.kind){case 207:case 265:case 234:case 257:return 1;default:return}}e=H.refactor||(H.refactor={}),t=e.extractSymbol||(e.extractSymbol={}),m={name:"Extract Symbol",description:H.getLocaleSpecificMessage(H.Diagnostics.Extract_symbol),getAvailableActions:r,getEditsForAction:n},e.registerRefactor(m),t.getAvailableActions=r,t.getEditsForAction=n,(e=P=t.Messages||(t.Messages={})).CannotExtractRange=i("Cannot extract range."),e.CannotExtractImport=i("Cannot extract import statement."),e.CannotExtractSuper=i("Cannot extract super call."),e.CannotExtractEmpty=i("Cannot extract empty range."),e.ExpressionExpected=i("expression expected."),e.UselessConstantType=i("No reason to extract constant of type."),e.StatementOrExpressionExpected=i("Statement or expression expected."),e.CannotExtractRangeContainingConditionalBreakOrContinueStatements=i("Cannot extract range containing conditional break or continue statements."),e.CannotExtractRangeContainingConditionalReturnStatement=i("Cannot extract range containing conditional return statement."),e.CannotExtractRangeContainingLabeledBreakOrContinueStatementWithTargetOutsideOfTheRange=i("Cannot extract range containing labeled break or continue with target outside of the range."),e.CannotExtractRangeThatContainsWritesToReferencesLocatedOutsideOfTheTargetRangeInGenerators=i("Cannot extract range containing writes to references located outside of the target range in generators."),e.TypeWillNotBeVisibleInTheNewScope=i("Type will not visible in the new scope."),e.FunctionWillNotBeVisibleInTheNewScope=i("Function will not visible in the new scope."),e.CannotExtractIdentifier=i("Select more than a single identifier."),e.CannotExtractExportedEntity=i("Cannot extract exported declaration"),e.CannotWriteInExpression=i("Cannot write back side-effects when extracting an expression"),e.CannotExtractReadonlyPropertyInitializerOutsideConstructor=i("Cannot move initialization of read-only class property outside of the constructor"),e.CannotExtractAmbientBlock=i("Cannot extract code from ambient contexts"),e.CannotAccessVariablesFromNestedScopes=i("Cannot access variables from nested scopes"),e.CannotExtractToOtherFunctionLike=i("Cannot extract method to a function-like scope that is not a function"),e.CannotExtractToJSClass=i("Cannot extract constant to a class scope in JS"),e.CannotExtractToExpressionArrowFunction=i("Cannot extract constant to an arrow function without a block"),(e=G=G||{})[e.None=0]="None",e[e.HasReturn=1]="HasReturn",e[e.IsGenerator=2]="IsGenerator",e[e.IsAsyncFunction=4]="IsAsyncFunction",e[e.UsesThis=8]="UsesThis",e[e.InStaticRegion=16]="InStaticRegion",t.getRangeToExtract=j})(ts=ts||{}),(n=>{var e,r;function i(e){var t=e.file,r=n.getTokenAtPosition(t,e.startPosition,!1);if(n.isStringLiteral(r)&&(e=>{switch(e.parent.kind){case 238:case 248:return 1;default:return}})(r)&&void 0===n.getResolvedModule(t,r.text))return n.codefix.tryGetCodeActionForInstallPackageTypes(e.host,r.text)}(e=n.refactor||(n.refactor={})).installTypesForPackage||(e.installTypesForPackage={}),r={name:"Install missing types package",description:"Install missing types package",getEditsForAction:function(e,t){n.Debug.assertEqual("install",t);t=i(e);return{edits:[],renameFilename:void 0,renameLocation:void 0,commands:t.commands}},getAvailableActions:function(e){var t=e.program.getCompilerOptions();if(void 0===t.noImplicitAny?t.strict:t.noImplicitAny)return;t=i(e);return t&&[{name:r.name,description:r.description,actions:[{description:t.description,name:"install"}]}]}},e.registerRefactor(r)})(ts=ts||{}),(T=>{var t;function a(e,t,r,n){e=T.isNodeKind(e)?new i(e,t,r):71===e?new p(71,t,r):new c(e,t,r);return e.parent=n,e}T.servicesVersion="0.6",e.prototype.getSourceFile=function(){return T.getSourceFileOfNode(this)},e.prototype.getStart=function(e,t){return T.getTokenPosOfNode(this,e,t)},e.prototype.getFullStart=function(){return this.pos},e.prototype.getEnd=function(){return this.end},e.prototype.getWidth=function(e){return this.getEnd()-this.getStart(e)},e.prototype.getFullWidth=function(){return this.end-this.pos},e.prototype.getLeadingTriviaWidth=function(e){return this.getStart(e)-this.pos},e.prototype.getFullText=function(e){return(e||this.getSourceFile()).text.substring(this.pos,this.end)},e.prototype.getText=function(e){return(e=e||this.getSourceFile()).text.substring(this.getStart(e),this.getEnd())},e.prototype.addSyntheticNodes=function(e,t,r){for(T.scanner.setTextPos(t);t<r;){var n=T.scanner.scan(),i=T.scanner.getTextPos();if(i<=r&&e.push(a(n,t,i,this)),t=i,1===n)break}return t},e.prototype.createSyntaxList=function(e){for(var t=a(286,e.pos,e.end,this),r=(t._children=[],e.pos),n=0,i=e;n<i.length;n++){var s=i[n];r<s.pos&&(r=this.addSyntheticNodes(t._children,r,s.pos)),t._children.push(s),r=s.end}return r<e.end&&this.addSyntheticNodes(t._children,r,e.end),t},e.prototype.createChildren=function(e){var t,r=this;if(T.isNodeKind(this.kind))if(T.isJSDocCommentContainingNode(this))t=[],this.forEachChild(function(e){t.push(e)}),this._children=t;else{var n=[],i=(T.scanner.setText((e||this.getSourceFile()).text),this.pos),s=function(e){i=r.addSyntheticNodes(n,i,e.pos),n.push(e),i=e.end};if(this.jsDoc)for(var a=0,o=this.jsDoc;a<o.length;a++)s(o[a]);i=this.pos,T.forEachChild(this,s,function(e){i<e.pos&&(i=r.addSyntheticNodes(n,i,e.pos)),n.push(r.createSyntaxList(e)),i=e.end}),i<this.end&&this.addSyntheticNodes(n,i,this.end),T.scanner.setText(void 0),this._children=n}else this._children=T.emptyArray},e.prototype.getChildCount=function(e){return this._children||this.createChildren(e),this._children.length},e.prototype.getChildAt=function(e,t){return this._children||this.createChildren(t),this._children[e]},e.prototype.getChildren=function(e){return this._children||this.createChildren(e),this._children},e.prototype.getFirstToken=function(e){var t=this.getChildren(e);if(t.length)return(t=T.find(t,function(e){return e.kind<267||285<e.kind})).kind<143?t:t.getFirstToken(e)},e.prototype.getLastToken=function(e){var t=this.getChildren(e),t=T.lastOrUndefined(t);if(t)return t.kind<143?t:t.getLastToken(e)},e.prototype.forEachChild=function(e,t){return T.forEachChild(this,e,t)};var i=e;function e(e,t,r){this.pos=t,this.end=r,this.flags=0,this.transformFlags=void 0,this.parent=void 0,this.kind=e}n.prototype.getSourceFile=function(){return T.getSourceFileOfNode(this)},n.prototype.getStart=function(e,t){return T.getTokenPosOfNode(this,e,t)},n.prototype.getFullStart=function(){return this.pos},n.prototype.getEnd=function(){return this.end},n.prototype.getWidth=function(e){return this.getEnd()-this.getStart(e)},n.prototype.getFullWidth=function(){return this.end-this.pos},n.prototype.getLeadingTriviaWidth=function(e){return this.getStart(e)-this.pos},n.prototype.getFullText=function(e){return(e||this.getSourceFile()).text.substring(this.pos,this.end)},n.prototype.getText=function(e){return(e||this.getSourceFile()).text.substring(this.getStart(),this.getEnd())},n.prototype.getChildCount=function(){return 0},n.prototype.getChildAt=function(){},n.prototype.getChildren=function(){return T.emptyArray},n.prototype.getFirstToken=function(){},n.prototype.getLastToken=function(){},n.prototype.forEachChild=function(){};var r=n;function n(e,t){this.pos=e,this.end=t,this.flags=0,this.parent=void 0}o.prototype.getFlags=function(){return this.flags},Object.defineProperty(o.prototype,"name",{get:function(){return T.symbolName(this)},enumerable:!0,configurable:!0}),o.prototype.getEscapedName=function(){return this.escapedName},o.prototype.getName=function(){return this.name},o.prototype.getDeclarations=function(){return this.declarations},o.prototype.getDocumentationComment=function(){return void 0===this.documentationComment&&(this.documentationComment=T.JsDoc.getJsDocCommentsFromDeclarations(this.declarations)),this.documentationComment},o.prototype.getJsDocTags=function(){return void 0===this.tags&&(this.tags=T.JsDoc.getJsDocTagsFromDeclarations(this.declarations)),this.tags};var s=o;function o(e,t){this.flags=e,this.escapedName=t}__extends(u,l=r);var l,c=u;function u(e,t,r){t=l.call(this,t,r)||this;return t.kind=e,t}__extends(h,d=r),Object.defineProperty(h.prototype,"text",{get:function(){return T.idText(this)},enumerable:!0,configurable:!0});var d,p=h;function h(e,t,r){return d.call(this,t,r)||this}p.prototype.kind=71,g.prototype.getFlags=function(){return this.flags},g.prototype.getSymbol=function(){return this.symbol},g.prototype.getProperties=function(){return this.checker.getPropertiesOfType(this)},g.prototype.getProperty=function(e){return this.checker.getPropertyOfType(this,e)},g.prototype.getApparentProperties=function(){return this.checker.getAugmentedPropertiesOfType(this)},g.prototype.getCallSignatures=function(){return this.checker.getSignaturesOfType(this,0)},g.prototype.getConstructSignatures=function(){return this.checker.getSignaturesOfType(this,1)},g.prototype.getStringIndexType=function(){return this.checker.getIndexTypeOfType(this,0)},g.prototype.getNumberIndexType=function(){return this.checker.getIndexTypeOfType(this,1)},g.prototype.getBaseTypes=function(){return 32768&this.flags&&3&this.objectFlags?this.checker.getBaseTypes(this):void 0},g.prototype.getNonNullableType=function(){return this.checker.getNonNullableType(this)};var m=g;function g(e,t){this.checker=e,this.flags=t}_.prototype.getDeclaration=function(){return this.declaration},_.prototype.getTypeParameters=function(){return this.typeParameters},_.prototype.getParameters=function(){return this.parameters},_.prototype.getReturnType=function(){return this.checker.getReturnTypeOfSignature(this)},_.prototype.getDocumentationComment=function(){return void 0===this.documentationComment&&(this.documentationComment=this.declaration?T.JsDoc.getJsDocCommentsFromDeclarations([this.declaration]):[]),this.documentationComment},_.prototype.getJsDocTags=function(){return void 0===this.jsDocTags&&(this.jsDocTags=this.declaration?T.JsDoc.getJsDocTagsFromDeclarations([this.declaration]):[]),this.jsDocTags};var f=_;function _(e){this.checker=e}__extends(v,y=i),v.prototype.update=function(e,t){return T.updateSourceFile(this,e,t)},v.prototype.getLineAndCharacterOfPosition=function(e){return T.getLineAndCharacterOfPosition(this,e)},v.prototype.getLineStarts=function(){return T.getLineStarts(this)},v.prototype.getPositionOfLineAndCharacter=function(e,t){return T.getPositionOfLineAndCharacter(this,e,t)},v.prototype.getLineEndOfPosition=function(e){var t,e=this.getLineAndCharacterOfPosition(e).line,r=this.getLineStarts(),r=(t=(t=e+1>=r.length?this.getEnd():t)||r[e+1]-1,this.getFullText());return"\n"===r[t]&&"\r"===r[t-1]?t-1:t},v.prototype.getNamedDeclarations=function(){return this.namedDeclarations||(this.namedDeclarations=this.computeNamedDeclarations()),this.namedDeclarations},v.prototype.computeNamedDeclarations=function(){var r=T.createMultiMap();return T.forEachChild(this,function e(t){switch(t.kind){case 228:case 186:case 151:case 150:var r=t,n=o(r);n&&(n=a(n),(i=T.lastOrUndefined(n))&&r.parent===i.parent&&r.symbol===i.symbol?r.body&&!i.body&&(n[n.length-1]=r):n.push(r)),T.forEachChild(t,e);break;case 229:case 199:case 230:case 231:case 232:case 233:case 237:case 246:case 242:case 239:case 240:case 153:case 154:case 163:s(t),T.forEachChild(t,e);break;case 146:if(!T.hasModifier(t,92))break;case 226:case 176:var i=t;if(T.isBindingPattern(i.name)){T.forEachChild(i.name,e);break}i.initializer&&e(i.initializer);case 264:case 149:case 148:s(t);break;case 244:t.exportClause&&T.forEach(t.exportClause.elements,e);break;case 238:n=t.importClause;n&&(n.name&&s(n),n.namedBindings)&&(240===n.namedBindings.kind?s(n.namedBindings):T.forEach(n.namedBindings.elements,e));break;case 194:0!==T.getSpecialPropertyAssignmentKind(t)&&s(t);default:T.forEachChild(t,e)}}),r;function s(e){var t=o(e);t&&r.add(t,e)}function a(e){var t=r.get(e);return t||r.set(e,t=[]),t}function o(e){e=T.getNameOfDeclaration(e);if(e){var t=T.getTextOfIdentifierOrLiteral(e);if(void 0!==t)return t;if(144===e.kind)return 179===(t=e.expression).kind?t.name.text:T.getTextOfIdentifierOrLiteral(t)}}};var y,b=v;function v(e,t,r){return y.call(this,e,t,r)||this}x.prototype.getLineAndCharacterOfPosition=function(e){return T.getLineAndCharacterOfPosition(this,e)};var k=x;function x(e,t,r){this.fileName=e,this.text=t,this.skipTrivia=r}function E(e){var t=!0;for(r in e)if(T.hasProperty(e,r)&&!S(r)){t=!1;break}if(t)return e;var r,n={};for(r in e)T.hasProperty(e,r)&&(n[S(r)?r:r.charAt(0).toLowerCase()+r.substr(1)]=e[r]);return n}function S(e){return!e.length||e.charAt(0)===e.charAt(0).toLowerCase()}function C(){return{target:1,jsx:1}}T.toEditorSettings=E,T.displayPartsToString=function(e){return e?T.map(e,function(e){return e.text}).join(""):""},T.getDefaultCompilerOptions=C,T.getSupportedCodeFixes=function(){return T.codefix.getSupportedErrorCodes()},w.prototype.compilationSettings=function(){return this._compilationSettings},w.prototype.createEntry=function(e,t){var r=this.host.getScriptSnapshot(e),r=r?{hostFileName:e,version:this.host.getScriptVersion(e),scriptSnapshot:r,scriptKind:T.getScriptKind(e,this.host)}:e;return this.fileNameToEntry.set(t,r),r},w.prototype.getEntryByPath=function(e){return this.fileNameToEntry.get(e)},w.prototype.getHostFileInformation=function(e){e=this.fileNameToEntry.get(e);return T.isString(e)?void 0:e},w.prototype.getOrCreateEntryByPath=function(e,t){e=this.getEntryByPath(t)||this.createEntry(e,t);return T.isString(e)?void 0:e},w.prototype.getRootFileNames=function(){return T.arrayFrom(this.fileNameToEntry.values(),function(e){return T.isString(e)?e:e.hostFileName})},w.prototype.getVersion=function(e){e=this.getHostFileInformation(e);return e&&e.version},w.prototype.getScriptSnapshot=function(e){e=this.getHostFileInformation(e);return e&&e.scriptSnapshot};var M=w;function w(e,t){this.host=e,this.currentDirectory=e.getCurrentDirectory(),this.fileNameToEntry=T.createMap();for(var r=0,n=e.getScriptFileNames();r<n.length;r++){var i=n[r];this.createEntry(i,T.toPath(i,this.currentDirectory,t))}this._compilationSettings=e.getCompilationSettings()||C()}I.prototype.getCurrentSourceFile=function(e){var t,r,n,i=this.host.getScriptSnapshot(e);if(i)return r=T.getScriptKind(e,this.host),t=this.host.getScriptVersion(e),this.currentFileName!==e?n=D(e,i,5,t,!0,r):this.currentFileVersion!==t&&(r=i.getChangeRange(this.currentFileScriptSnapshot),n=N(this.currentSourceFile,i,t,r)),n&&(this.currentFileVersion=t,this.currentFileName=e,this.currentFileScriptSnapshot=i,this.currentSourceFile=n),this.currentSourceFile;throw new Error("Could not find file: '"+e+"'.")};var F=I;function I(e){this.host=e}function A(e,t,r){e.version=r,e.scriptSnapshot=t}function D(e,t,r,n,i,s){var a=t.getText(0,t.getLength()),e=T.createSourceFile(e,a,r,i,s);return A(e,t,n),e}function N(e,t,r,n,i){var s,a,o,l;if(n&&(r!==e.version&&!T.disableIncrementalParsing))return o=void 0,l=0!==n.span.start?e.text.substr(0,n.span.start):"",s=T.textSpanEnd(n.span)!==e.text.length?e.text.substr(T.textSpanEnd(n.span)):"",o=0===n.newLength?l&&s?l+s:l||s:(a=t.getText(n.span.start,n.span.start+n.newLength),l&&s?l+a+s:l?l+a:a+s),A(l=T.updateSourceFile(e,o,n,i),t,r),l.nameTable=void 0,e!==l&&e.scriptSnapshot&&(e.scriptSnapshot.dispose&&e.scriptSnapshot.dispose(),e.scriptSnapshot=void 0),l;return D(e.fileName,t,e.languageVersion,r,!0,e.scriptKind)}T.createLanguageServiceSourceFile=D,T.disableIncrementalParsing=!1,T.updateLanguageServiceSourceFile=N,O.prototype.isCancellationRequested=function(){return this.cancellationToken&&this.cancellationToken.isCancellationRequested()},O.prototype.throwIfCancellationRequested=function(){if(this.isCancellationRequested())throw new T.OperationCanceledException};var B=O;function O(e){this.cancellationToken=e}function R(e,t){void 0===t&&(t=20),this.hostCancellationToken=e,this.throttleWaitMilliseconds=t,this.lastCancellationCheckTime=0}function L(e){switch(e.kind){case 253:case 255:case 261:case 262:case 151:case 153:case 154:return 1}}function P(e,t){var r=T.unescapeLeadingUnderscores(T.getTextOfPropertyName(t));if(r&&e){var n=[],t=e.getProperty(r);if(65536&e.flags)return T.forEach(e.types,function(e){e=e.getProperty(r);e&&n.push(e)}),n;if(t)return n.push(t),n}}R.prototype.isCancellationRequested=function(){var e=T.timestamp();return Math.abs(e-this.lastCancellationCheckTime)>=this.throttleWaitMilliseconds&&(this.lastCancellationCheckTime=e,this.hostCancellationToken.isCancellationRequested())},R.prototype.throwIfCancellationRequested=function(){if(this.isCancellationRequested())throw new T.OperationCanceledException},T.ThrottledCancellationToken=R,T.createLanguageService=function(c,u){void 0===u&&(u=T.createDocumentRegistry(c.useCaseSensitiveFileNames&&c.useCaseSensitiveFileNames(),c.getCurrentDirectory()));var d,n,p=new F(c),s=(t=t||new T.formatting.RulesProvider,0),h=c.useCaseSensitiveFileNames&&c.useCaseSensitiveFileNames(),m=new B(c.getCancellationToken&&c.getCancellationToken()),g=c.getCurrentDirectory();function f(e){c.log&&c.log(e)}!T.localizedDiagnosticMessages&&c.getLocalizedDiagnosticMessages&&(T.localizedDiagnosticMessages=c.getLocalizedDiagnosticMessages());var _=T.createGetCanonicalFileName(h);function y(e){var t=d.getSourceFile(e);if(t)return t;throw new Error("Could not find file: '"+e+"'.")}function b(e){return t.ensureUpToDate(e),t}function v(){if(c.getProjectVersion){var e=c.getProjectVersion();if(e){if(n===e&&!c.hasChangedAutomaticTypeDirectiveNames)return;n=e}}var a,o,e=c.getTypeRootsVersion?c.getTypeRootsVersion():0,l=(s!==e&&(f("TypeRoots version has changed; provide new program"),d=void 0,s=e),new M(c,_)),e=l.getRootFileNames(),t=c.hasInvalidatedResolution||T.returnFalse;function r(e){var t=T.toPath(e,g,_),t=l.getEntryByPath(t);return t?!T.isString(t):c.fileExists&&c.fileExists(e)}function i(e,t,r,n,i){T.Debug.assert(void 0!==l);var s=l.getOrCreateEntryByPath(e,t);if(s){if(!i){i=d&&d.getSourceFileByPath(t);if(i)return T.Debug.assertEqual(s.scriptKind,i.scriptKind,"Registered script kind should match new script kind.",t),u.updateDocumentWithKey(e,t,a,o,s.scriptSnapshot,s.version,s.scriptKind)}return u.acquireDocumentWithKey(e,t,a,o,s.scriptSnapshot,s.version,s.scriptKind)}}T.isProgramUptoDate(d,e,l.compilationSettings(),function(e){return l.getVersion(e)},r,t,c.hasChangedAutomaticTypeDirectiveNames)||(a=l.compilationSettings(),t={getSourceFile:function(e,t,r,n){return i(e,T.toPath(e,g,_),0,0,n)},getSourceFileByPath:i,getCancellationToken:function(){return m},getCanonicalFileName:_,useCaseSensitiveFileNames:function(){return h},getNewLine:function(){return T.getNewLineCharacter(a,{newLine:T.getNewLineOrDefaultFromHost(c)})},getDefaultLibFileName:function(e){return c.getDefaultLibFileName(e)},writeFile:T.noop,getCurrentDirectory:function(){return g},fileExists:r,readFile:function(e){var t=T.toPath(e,g,_),t=l.getEntryByPath(t);return t?T.isString(t)?void 0:t.scriptSnapshot.getText(0,t.scriptSnapshot.getLength()):c.readFile&&c.readFile(e)},directoryExists:function(e){return T.directoryProbablyExists(e,c)},getDirectories:function(e){return c.getDirectories?c.getDirectories(e):[]},onReleaseOldSourceFile:function(e,t){t=u.getKeyForCompilationSettings(t);u.releaseDocumentWithKey(e.path,t)},hasInvalidatedResolution:t,hasChangedAutomaticTypeDirectiveNames:c.hasChangedAutomaticTypeDirectiveNames},c.trace&&(t.trace=function(e){return c.trace(e)}),c.resolveModuleNames&&(t.resolveModuleNames=function(e,t,r){return c.resolveModuleNames(e,t,r)}),c.resolveTypeReferenceDirectives&&(t.resolveTypeReferenceDirectives=function(e,t){return c.resolveTypeReferenceDirectives(e,t)}),o=u.getKeyForCompilationSettings(a),d=T.createProgram(e,a,t,d),l=void 0,d.getTypeChecker())}function i(){return v(),d}function a(e,t,r){v();r=T.map(r,function(e){return d.getSourceFile(e)}),e=y(e);return T.DocumentHighlights.getDocumentHighlights(d,m,e,t,r)}function o(e,t,r){v();var n=[];if(r&&r.isForRename)for(var i=0,s=d.getSourceFiles();i<s.length;i++){var a=s[i];d.isSourceFileDefaultLibrary(a)||n.push(a)}else n=d.getSourceFiles().slice();return T.FindAllReferences.findReferencedEntries(d,m,n,y(e),t,r)}function e(e){return p.getCurrentSourceFile(e)}function r(e){e=T.getScriptKind(e,c);return 3===e||4===e}function l(e,t,r){t="number"==typeof t?[t,void 0]:[t.pos,t.end];return{file:e,startPosition:t[0],endPosition:t[1],program:i(),newLineCharacter:r?r.newLineCharacter:c.getNewLine(),host:c,rulesProvider:b(r),cancellationToken:m}}return{dispose:function(){d&&(T.forEach(d.getSourceFiles(),function(e){return u.releaseDocument(e.fileName,d.getCompilerOptions())}),d=void 0),c=void 0},cleanupSemanticCache:function(){d=void 0},getSyntacticDiagnostics:function(e){return v(),d.getSyntacticDiagnostics(y(e),m).slice()},getSemanticDiagnostics:function(e){v();var e=y(e),t=d.getSemanticDiagnostics(e,m);return d.getCompilerOptions().declaration?(e=d.getDeclarationDiagnostics(e,m),t.concat(e)):t.slice()},getCompilerOptionsDiagnostics:function(){return v(),d.getOptionsDiagnostics(m).concat(d.getGlobalDiagnostics(m))},getSyntacticClassifications:function(e,t){return T.getSyntacticClassifications(m,p.getCurrentSourceFile(e),t)},getSemanticClassifications:function(e,t){return r(e)?(v(),T.getSemanticClassifications(d.getTypeChecker(),m,y(e),d.getClassifiableNames(),t)):[]},getEncodedSyntacticClassifications:function(e,t){return T.getEncodedSyntacticClassifications(m,p.getCurrentSourceFile(e),t)},getEncodedSemanticClassifications:function(e,t){return r(e)?(v(),T.getEncodedSemanticClassifications(d.getTypeChecker(),m,y(e),d.getClassifiableNames(),t)):{spans:[],endOfLineState:0}},getCompletionsAtPosition:function(e,t){return v(),T.Completions.getCompletionsAtPosition(c,d.getTypeChecker(),f,d.getCompilerOptions(),y(e),t,d.getSourceFiles())},getCompletionEntryDetails:function(e,t,r,n,i){return v(),n=n?b(n):void 0,T.Completions.getCompletionEntryDetails(d.getTypeChecker(),f,d.getCompilerOptions(),y(e),t,{name:r,source:i},d.getSourceFiles(),c,n)},getCompletionEntrySymbol:function(e,t,r,n){return v(),T.Completions.getCompletionEntrySymbol(d.getTypeChecker(),f,d.getCompilerOptions(),y(e),t,{name:r,source:n},d.getSourceFiles())},getSignatureHelpItems:function(e,t){return v(),e=y(e),T.SignatureHelp.getSignatureHelpItems(d,e,t,m)},getQuickInfoAtPosition:function(e,t){v();var e=y(e),r=T.getTouchingPropertyName(e,t,!0);if(r!==e&&!T.isLabelName(r)){var n=d.getTypeChecker(),t=((e,t)=>{if((T.isIdentifier(e)||T.isStringLiteral(e))&&T.isPropertyAssignment(e.parent)&&e.parent.name===e){var r=t.getContextualType(e.parent.parent);if(r){r=t.getPropertyOfType(r,T.getTextOfIdentifierOrLiteral(e));if(r)return r}}return t.getSymbolAtLocation(e)})(r,n);if(t&&!n.isUnknownSymbol(t))return{kind:(e=T.SymbolDisplay.getSymbolDisplayPartsDocumentationAndSymbolKind(n,t,e,T.getContainerNode(r),r)).symbolKind,kindModifiers:T.SymbolDisplay.getSymbolModifiers(t),textSpan:T.createTextSpan(r.getStart(),r.getWidth()),displayParts:e.displayParts,documentation:e.documentation,tags:e.tags};switch(r.kind){case 71:case 179:case 143:case 99:case 169:case 97:var i=n.getTypeAtLocation(r);if(i)return{kind:"",kindModifiers:"",textSpan:T.createTextSpan(r.getStart(),r.getWidth()),displayParts:T.typeToDisplayParts(n,i,T.getContainerNode(r)),documentation:i.symbol?i.symbol.getDocumentationComment():void 0,tags:i.symbol?i.symbol.getJsDocTags():void 0}}}},getDefinitionAtPosition:function(e,t){return v(),T.GoToDefinition.getDefinitionAtPosition(d,y(e),t)},getImplementationAtPosition:function(e,t){return v(),T.FindAllReferences.getImplementationsAtPosition(d,m,d.getSourceFiles(),y(e),t)},getTypeDefinitionAtPosition:function(e,t){return v(),T.GoToDefinition.getTypeDefinitionAtPosition(d.getTypeChecker(),y(e),t)},getReferencesAtPosition:function(e,t){return o(e,t)},findReferences:function(e,t){return v(),T.FindAllReferences.findReferencedSymbols(d,m,d.getSourceFiles(),y(e),t)},getOccurrencesAtPosition:function(e,t){var r;return(t=(e=>{if(e){for(var t=[],r=0,n=e;r<n.length;r++)for(var i=n[r],s=0,a=i.highlightSpans;s<a.length;s++){var o=a[s];t.push({fileName:i.fileName,textSpan:o.textSpan,isWriteAccess:"writtenReference"===o.kind,isDefinition:!1,isInString:o.isInString})}return t}})(a(e,t,[e])))&&(r=_(T.normalizeSlashes(e)),t=T.filter(t,function(e){return _(T.normalizeSlashes(e.fileName))===r})),t},getDocumentHighlights:a,getNameOrDottedNameSpan:function(e,t,r){if(e=p.getCurrentSourceFile(e),(t=T.getTouchingPropertyName(e,t,!1))!==e){switch(t.kind){case 179:case 143:case 9:case 86:case 101:case 95:case 97:case 99:case 169:case 71:break;default:return}for(var n=t;;)if(T.isRightSideOfPropertyAccess(n)||T.isRightSideOfQualifiedName(n))n=n.parent;else{if(!T.isNameOfModuleDeclaration(n))break;if(233!==n.parent.parent.kind||n.parent.parent.body!==n.parent)break;n=n.parent.parent.name}return T.createTextSpanFromBounds(n.getStart(),t.getEnd())}},getBreakpointStatementAtPosition:function(e,t){return e=p.getCurrentSourceFile(e),T.BreakpointResolver.spanInSourceFileAtLocation(e,t)},getNavigateToItems:function(e,t,r,n){return v(),r=r?[y(r)]:d.getSourceFiles(),T.NavigateTo.getNavigateToItems(r,d.getTypeChecker(),m,e,t,n)},getRenameInfo:function(e,t){v();var r=c.getDefaultLibFileName(c.getCompilationSettings());return T.Rename.getRenameInfo(d.getTypeChecker(),r,_,y(e),t)},findRenameLocations:function(e,t,r,n){return o(e,t,{findInStrings:r,findInComments:n,isForRename:!0})},getNavigationBarItems:function(e){return T.NavigationBar.getNavigationBarItems(p.getCurrentSourceFile(e),m)},getNavigationTree:function(e){return T.NavigationBar.getNavigationTree(p.getCurrentSourceFile(e),m)},getOutliningSpans:function(e){return e=p.getCurrentSourceFile(e),T.OutliningElementsCollector.collectElements(e,m)},getTodoComments:function(e,t){v();var r,n=y(e),i=(m.throwIfCancellationRequested(),n.text),s=[];if(0<t.length&&(e=n.fileName,!T.stringContains(e,"/node_modules/"))){e="("+/(?:^(?:\s|\*)*)/.source+"|"+/(?:\/\/+\s*)/.source+"|"+/(?:\/\*+\s*)/.source+")",r="(?:"+T.map(t,function(e){return"("+e.text.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")+")"}).join("|")+")";for(var a,o=new RegExp(e+"("+r+/(?:.*?)/.source+")"+/(?:$|\*\/)/.source,"gim");a=o.exec(i);){m.throwIfCancellationRequested();T.Debug.assert(a.length===t.length+3);var l=a[1],l=a.index+l.length;if(T.isInComment(n,l)){for(var c,u=void 0,d=0;d<t.length;d++)a[d+3]&&(u=t[d]);T.Debug.assert(void 0!==u),97<=(c=i.charCodeAt(l+u.text.length))&&c<=122||65<=c&&c<=90||48<=c&&c<=57||(c=a[2],s.push({descriptor:u,message:c,position:l}))}}}return s},getBraceMatchingAtPosition:function(e,t){var r=p.getCurrentSourceFile(e),n=[],i=T.getTouchingToken(r,t,!1);if(i.getStart(r)===t){var s=(e=>{switch(e.kind){case 17:return 18;case 19:return 20;case 21:return 22;case 27:return 29;case 18:return 17;case 20:return 19;case 22:return 21;case 29:return 27}})(i);if(s)for(var a=0,o=i.parent.getChildren(r);a<o.length;a++){var l=o[a];if(l.kind===s){var c=T.createTextSpan(i.getStart(r),i.getWidth(r)),l=T.createTextSpan(l.getStart(r),l.getWidth(r));c.start<l.start?n.push(c,l):n.push(l,c);break}}}return n},getIndentationAtPosition:function(e,t,r){var n=T.timestamp(),r=E(r),e=p.getCurrentSourceFile(e),t=(f("getIndentationAtPosition: getCurrentSourceFile: "+(T.timestamp()-n)),n=T.timestamp(),T.formatting.SmartIndenter.getIndentation(t,e,r));return f("getIndentationAtPosition: computeIndentation  : "+(T.timestamp()-n)),t},getFormattingEditsForRange:function(e,t,r,n){return e=p.getCurrentSourceFile(e),n=E(n),T.formatting.formatSelection(t,r,e,b(n),n)},getFormattingEditsForDocument:function(e,t){return e=p.getCurrentSourceFile(e),t=E(t),T.formatting.formatDocument(e,b(t),t)},getFormattingEditsAfterKeystroke:function(e,t,r,n){if(e=p.getCurrentSourceFile(e),n=E(n),!T.isInComment(e,t)){if("{"===r)return T.formatting.formatOnOpeningCurly(t,e,b(n),n);if("}"===r)return T.formatting.formatOnClosingCurly(t,e,b(n),n);if(";"===r)return T.formatting.formatOnSemicolon(t,e,b(n),n);if("\n"===r)return T.formatting.formatOnEnter(t,e,b(n),n)}return[]},getDocCommentTemplateAtPosition:function(e,t){return T.JsDoc.getDocCommentTemplateAtPosition(T.getNewLineOrDefaultFromHost(c),p.getCurrentSourceFile(e),t)},isValidBraceCompletionAtPosition:function(e,t,r){if(60===r)return!1;var n=p.getCurrentSourceFile(e);if(T.isInString(n,t))return!1;if(T.isInsideJsxElementOrAttribute(n,t))return 123===r;if(T.isInTemplateString(n,t))return!1;switch(r){case 39:case 34:case 96:return!T.isInComment(n,t)}return!0},getSpanOfEnclosingComment:function(e,t,r){return e=p.getCurrentSourceFile(e),(e=T.formatting.getRangeOfEnclosingComment(e,t,r))&&T.createTextSpanFromRange(e)},getCodeFixesAtPosition:function(e,t,r,n,i){v();var s=y(e),a=T.createTextSpanFromBounds(t,r),o=T.getNewLineOrDefaultFromHost(c),l=b(i);return T.flatMap(T.deduplicate(n),function(e){return m.throwIfCancellationRequested(),T.codefix.getFixes({errorCode:e,sourceFile:s,span:a,program:d,newLineCharacter:o,host:c,cancellationToken:m,rulesProvider:l})})},applyCodeActionCommand:function(e,t){if(e=T.toPath(e,g,_),"install package"===t.type)return c.installPackage?c.installPackage({fileName:e,packageName:t.packageName}):Promise.reject("Host does not implement `installPackage`");T.Debug.fail()},getEmitOutput:function(e,t){v();var e=y(e),r=c.getCustomTransformers&&c.getCustomTransformers();return T.getFileEmitOutput(d,e,t,m,r)},getNonBoundSourceFile:e,getSourceFile:e,getProgram:i,getApplicableRefactors:function(e,t){return v(),e=y(e),T.refactor.getApplicableRefactors(l(e,t))},getEditsForRefactor:function(e,t,r,n,i){return v(),e=y(e),T.refactor.getEditsForRefactor(l(e,r,t),n,i)}}},T.getNameTable=function(e){var t,a;return e.nameTable||(a=(t=e).nameTable=T.createUnderscoreEscapedMap(),t.forEachChild(function e(t){var r;if((T.isIdentifier(t)&&t.escapedText||T.isStringOrNumericLiteral(t)&&(r=t,T.isDeclarationName(r)||248===r.parent.kind||(e=>e&&e.parent&&180===e.parent.kind&&e.parent.argumentExpression===e)(r)||T.isLiteralComputedPropertyDeclarationName(r)))&&(r=T.getEscapedTextOfIdentifierOrLiteral(t),a.set(r,void 0===a.get(r)?t.pos:-1)),T.forEachChild(t,e),T.hasJSDocNodes(t))for(var n=0,i=t.jsDoc;n<i.length;n++){var s=i[n];T.forEachChild(s,e)}})),e.nameTable},T.getContainingObjectLiteralElement=function(e){switch(e.kind){case 9:case 8:if(144===e.parent.kind)return L(e.parent.parent)?e.parent.parent:void 0;case 71:return!L(e.parent)||178!==e.parent.parent.kind&&254!==e.parent.parent.kind||e.parent.name!==e?void 0:e.parent}},T.getPropertySymbolsFromContextualType=function(e,t){var r=t.parent;return P(e.getContextualType(r),t.name)},T.getPropertySymbolsFromType=P,T.getDefaultLibFilePath=function(e){if("undefined"!=typeof __dirname)return __dirname+T.directorySeparator+T.getDefaultLibFileName(e);throw new Error("getDefaultLibFilePath is only supported when consumed as a node module. ")},T.objectAllocator={getNodeConstructor:function(){return i},getTokenConstructor:function(){return c},getIdentifierConstructor:function(){return p},getSourceFileConstructor:function(){return b},getSymbolConstructor:function(){return s},getTypeConstructor:function(){return m},getSignatureConstructor:function(){return f},getSourceMapSourceConstructor:function(){return k}}})(ts=ts||{}),(A=>{(A.BreakpointResolver||(A.BreakpointResolver={})).spanInSourceFileAtLocation=function(k,e){if(!k.isDeclarationFile){var t=A.getTokenAtPosition(k,e,!1),r=k.getLineAndCharacterOfPosition(e).line;if((!(k.getLineAndCharacterOfPosition(t.getStart(k)).line>r)||(t=A.findPrecedingToken(t.pos,k))&&k.getLineAndCharacterOfPosition(t.getEnd()).line===r)&&!A.isInAmbientContext(t))return I(t)}function x(e,t){var r=e.decorators?A.skipTrivia(k.text,e.decorators.end):e.getStart(k);return A.createTextSpanFromBounds(r,(t||e).getEnd())}function E(e,t){return x(e,A.findNextToken(t,t.parent))}function S(e,t){return e&&r===k.getLineAndCharacterOfPosition(e.getStart(k)).line?I(e):I(t)}function C(e){return I(A.findPrecedingToken(e.pos,k))}function w(e){return I(A.findNextToken(e,e.parent))}function I(e){if(e)switch(e.kind){case 208:return g(e.declarationList.declarations[0]);case 226:case 149:case 148:return g(e);case 146:return function e(t){{var r;return A.isBindingPattern(t.name)?v(t.name):f(t)?x(t):(r=t.parent,(t=A.indexOf(r.parameters,t))?e(r.parameters[t-1]):I(r.body))}}(e);case 228:case 151:case 150:case 153:case 154:case 152:case 186:case 187:var t=e;return t.body?_(t)?x(t):I(t.body):void 0;case 207:if(A.isFunctionBlock(e))return r=(t=e).statements.length?t.statements[0]:t.getLastToken(),_(t.parent)?S(t.parent,r):I(r);case 234:return y(e);case 260:return y(e.block);case 210:return x(e.expression);case 219:return x(e.getChildAt(0),e.expression);case 213:return E(e,e.expression);case 212:return I(e.statement);case 225:return x(e.getChildAt(0));case 211:return E(e,e.expression);case 222:return I(e.statement);case 218:case 217:return x(e.getChildAt(0),e.label);case 214:var r=e;return r.initializer?b(r):r.condition?x(r.condition):r.incrementor?x(r.incrementor):void 0;case 215:return E(e,e.expression);case 216:return b(e);case 221:return E(e,e.expression);case 257:case 258:return I(e.statements[0]);case 224:return y(e.tryBlock);case 223:case 243:return x(e,e.expression);case 237:return x(e,e.moduleReference);case 238:case 244:return x(e,e.moduleSpecifier);case 233:if(1!==A.getModuleInstanceState(e))return;case 229:case 232:case 264:case 176:return x(e);case 220:return I(e.statement);case 147:return h=e.parent.decorators,A.createTextSpanFromBounds(A.skipTrivia(k.text,h.pos),h.end);case 174:case 175:return v(e);case 230:case 231:return;case 25:case 1:return S(A.findPrecedingToken(e.pos,k));case 26:return C(e);case 17:var n=e;switch(n.parent.kind){case 232:var i=n.parent;return S(A.findPrecedingToken(n.pos,k,n.parent),i.members.length?i.members[0]:i.getLastToken(k));case 229:i=n.parent;return S(A.findPrecedingToken(n.pos,k,n.parent),i.members.length?i.members[0]:i.getLastToken(k));case 235:return S(n.parent.parent,n.parent.clauses[0])}return I(n.parent);case 18:var s=e;switch(s.parent.kind){case 234:if(1!==A.getModuleInstanceState(s.parent.parent))return;case 232:case 229:return x(s);case 207:if(A.isFunctionBlock(s.parent))return x(s);case 260:return I(A.lastOrUndefined(s.parent.statements));case 235:var a=s.parent,a=A.lastOrUndefined(a.clauses);return a?I(A.lastOrUndefined(a.statements)):void 0;case 174:a=s.parent;return I(A.lastOrUndefined(a.elements)||a);default:return A.isArrayLiteralOrObjectLiteralDestructuringPattern(s.parent)?(a=s.parent,x(A.lastOrUndefined(a.properties)||a)):I(s.parent)}return;case 22:h=e;return 175===h.parent.kind||A.isArrayLiteralOrObjectLiteralDestructuringPattern(h.parent)?(p=h.parent,x(A.lastOrUndefined(p.elements)||p)):I(h.parent);case 19:return 212!==(p=e).parent.kind&&181!==p.parent.kind&&182!==p.parent.kind?185!==p.parent.kind?I(p.parent):w(p):C(p);case 20:var o=e;switch(o.parent.kind){case 186:case 228:case 187:case 151:case 150:case 153:case 154:case 152:case 213:case 212:case 214:case 216:case 181:case 182:case 185:return C(o);default:return I(o.parent)}return;case 56:var l=e;return A.isFunctionLike(l.parent)||261===l.parent.kind||146===l.parent.kind?C(l):I(l.parent);case 29:case 27:return 184!==(l=e).parent.kind?I(l.parent):w(l);case 106:return 212!==(d=e).parent.kind?I(d.parent):E(d,d.parent.expression);case 82:case 74:case 87:return w(e);case 142:return 216!==(d=e).parent.kind?I(d.parent):w(d);default:if(A.isArrayLiteralOrObjectLiteralDestructuringPattern(e))return T(e);if((71===e.kind||198===e.kind||261===e.kind||262===e.kind)&&A.isArrayLiteralOrObjectLiteralDestructuringPattern(e.parent))return x(e);if(194===e.kind){var c=e;if(A.isArrayLiteralOrObjectLiteralDestructuringPattern(c.left))return T(c.left);if(58===c.operatorToken.kind&&A.isArrayLiteralOrObjectLiteralDestructuringPattern(c.parent))return x(e);if(26===c.operatorToken.kind)return I(c.left)}if(A.isPartOfExpression(e))switch(e.parent.kind){case 212:return C(e);case 147:return I(e.parent);case 214:case 216:return x(e);case 194:if(26===e.parent.operatorToken.kind)return x(e);break;case 187:if(e.parent.body===e)return x(e)}if(261===e.parent.kind&&e.parent.name===e&&!A.isArrayLiteralOrObjectLiteralDestructuringPattern(e.parent.parent))return I(e.parent.initializer);if(184===e.parent.kind&&e.parent.type===e)return w(e.parent.type);if(A.isFunctionLike(e.parent)&&e.parent.type===e)return C(e);if(226===e.parent.kind||146===e.parent.kind){var u=e.parent;if(u.initializer===e||u.type===e||A.isAssignmentOperator(e.kind))return C(e)}if(194===e.parent.kind){c=e.parent;if(A.isArrayLiteralOrObjectLiteralDestructuringPattern(c.left)&&(c.right===e||c.operatorToken===e))return C(e)}return I(e.parent)}var d,p,h;function m(e){return 227===e.parent.kind&&e.parent.declarations[0]===e?x(A.findPrecedingToken(e.pos,k,e.parent),e):x(e)}function g(e){return 215===e.parent.parent.kind?I(e.parent.parent):A.isBindingPattern(e.name)?v(e.name):e.initializer||A.hasModifier(e,1)||216===e.parent.parent.kind?m(e):227===e.parent.kind&&e.parent.declarations[0]!==e?I(A.findPrecedingToken(e.pos,k,e.parent)):void 0}function f(e){return!!e.initializer||void 0!==e.dotDotDotToken||A.hasModifier(e,12)}function _(e){return A.hasModifier(e,1)||229===e.parent.kind&&152!==e.kind}function y(e){switch(e.parent.kind){case 233:if(1!==A.getModuleInstanceState(e.parent))return;case 213:case 211:case 215:return S(e.parent,e.statements[0]);case 214:case 216:return S(A.findPrecedingToken(e.pos,k,e.parent),e.statements[0])}return I(e.statements[0])}function b(e){return 227!==e.initializer.kind?I(e.initializer):0<(e=e.initializer).declarations.length?I(e.declarations[0]):void 0}function v(e){var t=A.forEach(e.elements,function(e){return 200!==e.kind?e:void 0});return t?I(t):(176===e.parent.kind?x:m)(e.parent)}function T(e){A.Debug.assert(175!==e.kind&&174!==e.kind);var t=177===e.kind?e.elements:e.properties,t=A.forEach(t,function(e){return 200!==e.kind?e:void 0});return t?I(t):x(194===e.parent.kind?e.parent:e)}}}})(ts=ts||{}),(i=>{i.transform=function(e,t,r){var n=[],e=(r=i.fixupCompilerOptions(r,n),i.isArray(e)?e:[e]);return(r=i.transformNodes(void 0,void 0,r,e,t,!0)).diagnostics=i.concatenate(r.diagnostics,n),r}})(ts=ts||{}),function(){return this}()),ts,TypeScript,toolsVersion=((d=>{function p(e,t){e&&e.log("*INTERNAL ERROR* - Exception in typescript services: "+t.message)}e.prototype.getText=function(e,t){return this.scriptSnapshotShim.getText(e,t)},e.prototype.getLength=function(){return this.scriptSnapshotShim.getLength()},e.prototype.getChangeRange=function(e){var e=this.scriptSnapshotShim.getChangeRange(e.scriptSnapshotShim);return null===e?null:(e=JSON.parse(e),d.createTextChangeRange(d.createTextSpan(e.span.start,e.span.length),e.newLength))},e.prototype.dispose=function(){"dispose"in this.scriptSnapshotShim&&this.scriptSnapshotShim.dispose()};var t=e;function e(e){this.scriptSnapshotShim=e}r.prototype.log=function(e){this.loggingEnabled&&this.shimHost.log(e)},r.prototype.trace=function(e){this.tracingEnabled&&this.shimHost.trace(e)},r.prototype.error=function(e){this.shimHost.error(e)},r.prototype.getProjectVersion=function(){if(this.shimHost.getProjectVersion)return this.shimHost.getProjectVersion()},r.prototype.getTypeRootsVersion=function(){return this.shimHost.getTypeRootsVersion?this.shimHost.getTypeRootsVersion():0},r.prototype.useCaseSensitiveFileNames=function(){return!!this.shimHost.useCaseSensitiveFileNames&&this.shimHost.useCaseSensitiveFileNames()},r.prototype.getCompilationSettings=function(){var e=this.shimHost.getCompilationSettings();if(null===e||""===e)throw Error("LanguageServiceShimHostAdapter.getCompilationSettings: empty compilationSettings");e=JSON.parse(e);return e.allowNonTsExtensions=!0,e},r.prototype.getScriptFileNames=function(){var e=this.shimHost.getScriptFileNames();return this.files=JSON.parse(e)},r.prototype.getScriptSnapshot=function(e){e=this.shimHost.getScriptSnapshot(e);return e&&new t(e)},r.prototype.getScriptKind=function(e){return"getScriptKind"in this.shimHost?this.shimHost.getScriptKind(e):0},r.prototype.getScriptVersion=function(e){return this.shimHost.getScriptVersion(e)},r.prototype.getLocalizedDiagnosticMessages=function(){var e=this.shimHost.getLocalizedDiagnosticMessages();if(null===e||""===e)return null;try{return JSON.parse(e)}catch(e){return this.log(e.description||"diagnosticMessages.generated.json has invalid JSON format"),null}},r.prototype.getCancellationToken=function(){var e=this.shimHost.getCancellationToken();return new d.ThrottledCancellationToken(e)},r.prototype.getCurrentDirectory=function(){return this.shimHost.getCurrentDirectory()},r.prototype.getDirectories=function(e){return JSON.parse(this.shimHost.getDirectories(e))},r.prototype.getDefaultLibFileName=function(e){return this.shimHost.getDefaultLibFileName(JSON.stringify(e))},r.prototype.readDirectory=function(e,t,r,n,i){r=d.getFileMatcherPatterns(e,r,n,this.shimHost.useCaseSensitiveFileNames(),this.shimHost.getCurrentDirectory());return JSON.parse(this.shimHost.readDirectory(e,JSON.stringify(t),JSON.stringify(r.basePaths),r.excludePattern,r.includeFilePattern,r.includeDirectoryPattern,i))},r.prototype.readFile=function(e,t){return this.shimHost.readFile(e,t)},r.prototype.fileExists=function(e){return this.shimHost.fileExists(e)};var n=r;function r(e){var n=this;this.shimHost=e,this.loggingEnabled=!1,this.tracingEnabled=!1,"getModuleResolutionsForFile"in this.shimHost&&(this.resolveModuleNames=function(e,t){var r=JSON.parse(n.shimHost.getModuleResolutionsForFile(t));return d.map(e,function(e){e=d.getProperty(r,e);return e?{resolvedFileName:e,extension:d.extensionFromPath(e),isExternalLibraryImport:!1}:void 0})}),"directoryExists"in this.shimHost&&(this.directoryExists=function(e){return n.shimHost.directoryExists(e)}),"getTypeReferenceDirectiveResolutionsForFile"in this.shimHost&&(this.resolveTypeReferenceDirectives=function(e,t){var r=JSON.parse(n.shimHost.getTypeReferenceDirectiveResolutionsForFile(t));return d.map(e,function(e){return d.getProperty(r,e)})})}d.LanguageServiceShimHostAdapter=n,s.prototype.readDirectory=function(e,t,r,n,i){r=d.getFileMatcherPatterns(e,r,n,this.shimHost.useCaseSensitiveFileNames(),this.shimHost.getCurrentDirectory());return JSON.parse(this.shimHost.readDirectory(e,JSON.stringify(t),JSON.stringify(r.basePaths),r.excludePattern,r.includeFilePattern,r.includeDirectoryPattern,i))},s.prototype.fileExists=function(e){return this.shimHost.fileExists(e)},s.prototype.readFile=function(e){return this.shimHost.readFile(e)},s.prototype.getDirectories=function(e){return JSON.parse(this.shimHost.getDirectories(e))};var i=s;function s(e){var t=this;this.shimHost=e,this.useCaseSensitiveFileNames=!!this.shimHost.useCaseSensitiveFileNames&&this.shimHost.useCaseSensitiveFileNames(),"directoryExists"in this.shimHost&&(this.directoryExists=function(e){return t.shimHost.directoryExists(e)}),"realpath"in this.shimHost&&(this.realpath=function(e){return t.shimHost.realpath(e)})}function a(e,t,r,n){return o(e,t,!0,r,n)}function o(t,r,e,n,i){try{a=t,o=r,l=n,(c=i)&&(a.log(o),u=d.timestamp()),l=l(),c&&(c=d.timestamp(),a.log(o+" completed in "+(c-u)+" msec"),d.isString(l))&&(128<(o=l).length&&(o=o.substring(0,128)+"..."),a.log("  result.length="+o.length+", result='"+JSON.stringify(o)+"'"));var s=l;return e?JSON.stringify({result:s}):s}catch(e){return e instanceof d.OperationCanceledException?JSON.stringify({canceled:!0}):(p(t,e),e.description=r,JSON.stringify({error:e}))}var a,o,l,c,u}d.CoreServicesShimHostAdapter=i,c.prototype.dispose=function(e){this.factory.unregisterShim(this)};var l=c;function c(e){(this.factory=e).registerShim(this)}function u(e,t){return e.map(function(e){return e=e,{message:d.flattenDiagnosticMessageText(e.messageText,t),start:e.start,length:e.length,category:d.DiagnosticCategory[e.category].toLowerCase(),code:e.code}})}d.realizeDiagnostics=u,__extends(g,h=l),g.prototype.forwardJSONCall=function(e,t){return a(this.logger,e,t,this.logPerformance)},g.prototype.dispose=function(e){this.logger.log("dispose()"),this.languageService.dispose(),this.languageService=null,debugObjectHost&&debugObjectHost.CollectGarbage&&(debugObjectHost.CollectGarbage(),this.logger.log("CollectGarbage()")),this.logger=null,h.prototype.dispose.call(this,e)},g.prototype.refresh=function(e){this.forwardJSONCall("refresh("+e+")",function(){return null})},g.prototype.cleanupSemanticCache=function(){var e=this;this.forwardJSONCall("cleanupSemanticCache()",function(){return e.languageService.cleanupSemanticCache(),null})},g.prototype.realizeDiagnostics=function(e){var t=d.getNewLineOrDefaultFromHost(this.host);return d.realizeDiagnostics(e,t)},g.prototype.getSyntacticClassifications=function(e,t,r){var n=this;return this.forwardJSONCall("getSyntacticClassifications('"+e+"', "+t+", "+r+")",function(){return n.languageService.getSyntacticClassifications(e,d.createTextSpan(t,r))})},g.prototype.getSemanticClassifications=function(e,t,r){var n=this;return this.forwardJSONCall("getSemanticClassifications('"+e+"', "+t+", "+r+")",function(){return n.languageService.getSemanticClassifications(e,d.createTextSpan(t,r))})},g.prototype.getEncodedSyntacticClassifications=function(e,t,r){var n=this;return this.forwardJSONCall("getEncodedSyntacticClassifications('"+e+"', "+t+", "+r+")",function(){return f(n.languageService.getEncodedSyntacticClassifications(e,d.createTextSpan(t,r)))})},g.prototype.getEncodedSemanticClassifications=function(e,t,r){var n=this;return this.forwardJSONCall("getEncodedSemanticClassifications('"+e+"', "+t+", "+r+")",function(){return f(n.languageService.getEncodedSemanticClassifications(e,d.createTextSpan(t,r)))})},g.prototype.getSyntacticDiagnostics=function(t){var r=this;return this.forwardJSONCall("getSyntacticDiagnostics('"+t+"')",function(){var e=r.languageService.getSyntacticDiagnostics(t);return r.realizeDiagnostics(e)})},g.prototype.getSemanticDiagnostics=function(t){var r=this;return this.forwardJSONCall("getSemanticDiagnostics('"+t+"')",function(){var e=r.languageService.getSemanticDiagnostics(t);return r.realizeDiagnostics(e)})},g.prototype.getCompilerOptionsDiagnostics=function(){var t=this;return this.forwardJSONCall("getCompilerOptionsDiagnostics()",function(){var e=t.languageService.getCompilerOptionsDiagnostics();return t.realizeDiagnostics(e)})},g.prototype.getQuickInfoAtPosition=function(e,t){var r=this;return this.forwardJSONCall("getQuickInfoAtPosition('"+e+"', "+t+")",function(){return r.languageService.getQuickInfoAtPosition(e,t)})},g.prototype.getNameOrDottedNameSpan=function(e,t,r){var n=this;return this.forwardJSONCall("getNameOrDottedNameSpan('"+e+"', "+t+", "+r+")",function(){return n.languageService.getNameOrDottedNameSpan(e,t,r)})},g.prototype.getBreakpointStatementAtPosition=function(e,t){var r=this;return this.forwardJSONCall("getBreakpointStatementAtPosition('"+e+"', "+t+")",function(){return r.languageService.getBreakpointStatementAtPosition(e,t)})},g.prototype.getSignatureHelpItems=function(e,t){var r=this;return this.forwardJSONCall("getSignatureHelpItems('"+e+"', "+t+")",function(){return r.languageService.getSignatureHelpItems(e,t)})},g.prototype.getDefinitionAtPosition=function(e,t){var r=this;return this.forwardJSONCall("getDefinitionAtPosition('"+e+"', "+t+")",function(){return r.languageService.getDefinitionAtPosition(e,t)})},g.prototype.getTypeDefinitionAtPosition=function(e,t){var r=this;return this.forwardJSONCall("getTypeDefinitionAtPosition('"+e+"', "+t+")",function(){return r.languageService.getTypeDefinitionAtPosition(e,t)})},g.prototype.getImplementationAtPosition=function(e,t){var r=this;return this.forwardJSONCall("getImplementationAtPosition('"+e+"', "+t+")",function(){return r.languageService.getImplementationAtPosition(e,t)})},g.prototype.getRenameInfo=function(e,t){var r=this;return this.forwardJSONCall("getRenameInfo('"+e+"', "+t+")",function(){return r.languageService.getRenameInfo(e,t)})},g.prototype.findRenameLocations=function(e,t,r,n){var i=this;return this.forwardJSONCall("findRenameLocations('"+e+"', "+t+", "+r+", "+n+")",function(){return i.languageService.findRenameLocations(e,t,r,n)})},g.prototype.getBraceMatchingAtPosition=function(e,t){var r=this;return this.forwardJSONCall("getBraceMatchingAtPosition('"+e+"', "+t+")",function(){return r.languageService.getBraceMatchingAtPosition(e,t)})},g.prototype.isValidBraceCompletionAtPosition=function(e,t,r){var n=this;return this.forwardJSONCall("isValidBraceCompletionAtPosition('"+e+"', "+t+", "+r+")",function(){return n.languageService.isValidBraceCompletionAtPosition(e,t,r)})},g.prototype.getSpanOfEnclosingComment=function(e,t,r){var n=this;return this.forwardJSONCall("getSpanOfEnclosingComment('"+e+"', "+t+")",function(){return n.languageService.getSpanOfEnclosingComment(e,t,r)})},g.prototype.getIndentationAtPosition=function(t,r,n){var i=this;return this.forwardJSONCall("getIndentationAtPosition('"+t+"', "+r+")",function(){var e=JSON.parse(n);return i.languageService.getIndentationAtPosition(t,r,e)})},g.prototype.getReferencesAtPosition=function(e,t){var r=this;return this.forwardJSONCall("getReferencesAtPosition('"+e+"', "+t+")",function(){return r.languageService.getReferencesAtPosition(e,t)})},g.prototype.findReferences=function(e,t){var r=this;return this.forwardJSONCall("findReferences('"+e+"', "+t+")",function(){return r.languageService.findReferences(e,t)})},g.prototype.getOccurrencesAtPosition=function(e,t){var r=this;return this.forwardJSONCall("getOccurrencesAtPosition('"+e+"', "+t+")",function(){return r.languageService.getOccurrencesAtPosition(e,t)})},g.prototype.getDocumentHighlights=function(r,n,i){var s=this;return this.forwardJSONCall("getDocumentHighlights('"+r+"', "+n+")",function(){var e=s.languageService.getDocumentHighlights(r,n,JSON.parse(i)),t=d.normalizeSlashes(r).toLowerCase();return d.filter(e,function(e){return d.normalizeSlashes(e.fileName).toLowerCase()===t})})},g.prototype.getCompletionsAtPosition=function(e,t){var r=this;return this.forwardJSONCall("getCompletionsAtPosition('"+e+"', "+t+")",function(){return r.languageService.getCompletionsAtPosition(e,t)})},g.prototype.getCompletionEntryDetails=function(t,r,n,i,s){var a=this;return this.forwardJSONCall("getCompletionEntryDetails('"+t+"', "+r+", '"+n+"')",function(){var e=JSON.parse(i);return a.languageService.getCompletionEntryDetails(t,r,n,e,s)})},g.prototype.getFormattingEditsForRange=function(t,r,n,i){var s=this;return this.forwardJSONCall("getFormattingEditsForRange('"+t+"', "+r+", "+n+")",function(){var e=JSON.parse(i);return s.languageService.getFormattingEditsForRange(t,r,n,e)})},g.prototype.getFormattingEditsForDocument=function(t,r){var n=this;return this.forwardJSONCall("getFormattingEditsForDocument('"+t+"')",function(){var e=JSON.parse(r);return n.languageService.getFormattingEditsForDocument(t,e)})},g.prototype.getFormattingEditsAfterKeystroke=function(t,r,n,i){var s=this;return this.forwardJSONCall("getFormattingEditsAfterKeystroke('"+t+"', "+r+", '"+n+"')",function(){var e=JSON.parse(i);return s.languageService.getFormattingEditsAfterKeystroke(t,r,n,e)})},g.prototype.getDocCommentTemplateAtPosition=function(e,t){var r=this;return this.forwardJSONCall("getDocCommentTemplateAtPosition('"+e+"', "+t+")",function(){return r.languageService.getDocCommentTemplateAtPosition(e,t)})},g.prototype.getNavigateToItems=function(e,t,r){var n=this;return this.forwardJSONCall("getNavigateToItems('"+e+"', "+t+", "+r+")",function(){return n.languageService.getNavigateToItems(e,t,r)})},g.prototype.getNavigationBarItems=function(e){var t=this;return this.forwardJSONCall("getNavigationBarItems('"+e+"')",function(){return t.languageService.getNavigationBarItems(e)})},g.prototype.getNavigationTree=function(e){var t=this;return this.forwardJSONCall("getNavigationTree('"+e+"')",function(){return t.languageService.getNavigationTree(e)})},g.prototype.getOutliningSpans=function(e){var t=this;return this.forwardJSONCall("getOutliningSpans('"+e+"')",function(){return t.languageService.getOutliningSpans(e)})},g.prototype.getTodoComments=function(e,t){var r=this;return this.forwardJSONCall("getTodoComments('"+e+"')",function(){return r.languageService.getTodoComments(e,JSON.parse(t))})},g.prototype.getEmitOutput=function(e){var t=this;return this.forwardJSONCall("getEmitOutput('"+e+"')",function(){return t.languageService.getEmitOutput(e)})},g.prototype.getEmitOutputObject=function(e){var t=this;return o(this.logger,"getEmitOutput('"+e+"')",!1,function(){return t.languageService.getEmitOutput(e)},this.logPerformance)};var h,m=g;function g(e,t,r){e=h.call(this,e)||this;return e.host=t,e.languageService=r,e.logPerformance=!1,e.logger=e.host,e}function f(e){return{spans:e.spans.join(","),endOfLineState:e.endOfLineState}}__extends(b,_=l),b.prototype.getEncodedLexicalClassifications=function(e,t,r){var n=this;return a(this.logger,"getEncodedLexicalClassifications",function(){return f(n.classifier.getEncodedLexicalClassifications(e,t,r))},this.logPerformance)},b.prototype.getClassificationsForLine=function(e,t,r){for(var e=this.classifier.getClassificationsForLine(e,t,r),n="",i=0,s=e.entries;i<s.length;i++)var a=s[i],n=(n+=a.length+"\n")+(a.classification+"\n");return n+=e.finalLexState};var _,y=b;function b(e,t){e=_.call(this,e)||this;return e.logger=t,e.logPerformance=!1,e.classifier=d.createClassifier(),e}__extends(k,v=l),k.prototype.forwardJSONCall=function(e,t){return a(this.logger,e,t,this.logPerformance)},k.prototype.resolveModuleName=function(r,n,i){var s=this;return this.forwardJSONCall("resolveModuleName('"+r+"')",function(){var e=JSON.parse(i),e=d.resolveModuleName(n,d.normalizeSlashes(r),e,s.host),t=e.resolvedModule?e.resolvedModule.resolvedFileName:void 0;return{resolvedFileName:t=e.resolvedModule&&".ts"!==e.resolvedModule.extension&&".tsx"!==e.resolvedModule.extension&&".d.ts"!==e.resolvedModule.extension?void 0:t,failedLookupLocations:e.failedLookupLocations}})},k.prototype.resolveTypeReferenceDirective=function(t,r,n){var i=this;return this.forwardJSONCall("resolveTypeReferenceDirective("+t+")",function(){var e=JSON.parse(n),e=d.resolveTypeReferenceDirective(r,d.normalizeSlashes(t),e,i.host);return{resolvedFileName:e.resolvedTypeReferenceDirective?e.resolvedTypeReferenceDirective.resolvedFileName:void 0,primary:!e.resolvedTypeReferenceDirective||e.resolvedTypeReferenceDirective.primary,failedLookupLocations:e.failedLookupLocations}})},k.prototype.getPreProcessedFileInfo=function(e,t){var r=this;return this.forwardJSONCall("getPreProcessedFileInfo('"+e+"')",function(){var e=d.preProcessFile(t.getText(0,t.getLength()),!0,!0);return{referencedFiles:r.convertFileReferences(e.referencedFiles),importedFiles:r.convertFileReferences(e.importedFiles),ambientExternalModules:e.ambientExternalModules,isLibFile:e.isLibFile,typeReferenceDirectives:r.convertFileReferences(e.typeReferenceDirectives)}})},k.prototype.getAutomaticTypeDirectiveNames=function(t){var r=this;return this.forwardJSONCall("getAutomaticTypeDirectiveNames('"+t+"')",function(){var e=JSON.parse(t);return d.getAutomaticTypeDirectiveNames(e,r.host)})},k.prototype.convertFileReferences=function(e){if(e){for(var t=[],r=0,n=e;r<n.length;r++){var i=n[r];t.push({path:d.normalizeSlashes(i.fileName),position:i.pos,length:i.end-i.pos})}return t}},k.prototype.getTSConfigFileInfo=function(r,n){var i=this;return this.forwardJSONCall("getTSConfigFileInfo('"+r+"')",function(){var e=n.getText(0,n.getLength()),e=d.parseJsonText(r,e),t=d.normalizeSlashes(r),t=d.parseJsonSourceFileConfigFileContent(e,i.host,d.getDirectoryPath(t),{},t);return{options:t.options,typeAcquisition:t.typeAcquisition,files:t.fileNames,raw:t.raw,errors:u(e.parseDiagnostics.concat(t.errors),"\r\n")}})},k.prototype.getDefaultCompilationSettings=function(){return this.forwardJSONCall("getDefaultCompilationSettings()",function(){return d.getDefaultCompilerOptions()})},k.prototype.discoverTypings=function(t){var r=this,n=d.createGetCanonicalFileName(!1);return this.forwardJSONCall("discoverTypings()",function(){var e=JSON.parse(t);return void 0===r.safeList&&(r.safeList=d.JsTyping.loadSafeList(r.host,d.toPath(e.safeListPath,e.safeListPath,n))),d.JsTyping.discoverTypings(r.host,function(e){return r.logger.log(e)},e.fileNames,d.toPath(e.projectRootPath,e.projectRootPath,n),r.safeList,e.packageNameToTypingLocation,e.typeAcquisition,e.unresolvedImports)})};var v,T=k;function k(e,t,r){e=v.call(this,e)||this;return e.logger=t,e.host=r,e.logPerformance=!1,e}function x(){this._shims=[]}x.prototype.getServicesVersion=function(){return d.servicesVersion},x.prototype.createLanguageServiceShim=function(t){try{void 0===this.documentRegistry&&(this.documentRegistry=d.createDocumentRegistry(t.useCaseSensitiveFileNames&&t.useCaseSensitiveFileNames(),t.getCurrentDirectory()));var e=new n(t),r=d.createLanguageService(e,this.documentRegistry);return new m(this,t,r)}catch(e){throw p(t,e),e}},x.prototype.createClassifierShim=function(t){try{return new y(this,t)}catch(e){throw p(t,e),e}},x.prototype.createCoreServicesShim=function(t){try{var e=new i(t);return new T(this,t,e)}catch(e){throw p(t,e),e}},x.prototype.close=function(){d.clear(this._shims),this.documentRegistry=void 0},x.prototype.registerShim=function(e){this._shims.push(e)},x.prototype.unregisterShim=function(e){for(var t=0;t<this._shims.length;t++)if(this._shims[t]===e)return void delete this._shims[t];throw new Error("Invalid operation")},d.TypeScriptServicesFactory=x,"undefined"!=typeof module&&module.exports&&(module.exports=d)})(ts=ts||{}),(e=>{(e.Services||(e.Services={})).TypeScriptServicesFactory=ts.TypeScriptServicesFactory})(TypeScript=TypeScript||{}),"2.6"),e=(()=>{function D(e,t){postMessage({action:De,cbn:t,result:e})}function g(e){var t=[];return t[e-1]=void 0,t}function _(e,t){return r(e[0]+t[0],e[1]+t[1])}function N(e,t){return r=~~Math.max(Math.min(e[1]/a,2147483647),-2147483648)&~~Math.max(Math.min(t[1]/a,2147483647),-2147483648),(e=e=v(e)&v(t))<0&&(e+=a),[e,r*a];var r}function y(e,t){var r,n;return e[0]==t[0]&&e[1]==t[1]?0:(r=e[1]<0,n=t[1]<0,r&&!n||(r||!n)&&P(e,t)[1]<0?-1:1)}function r(e,t){var r,n;for(e%=0x10000000000000000,t=(t%=0x10000000000000000)-(r=t%a)+(n=Math.floor(e/a)*a),e=e-n+r;e<0;)e+=a,t-=a;for(;4294967295<e;)e-=a,t+=a;for(t%=0x10000000000000000;0x7fffffff00000000<t;)t-=0x10000000000000000;for(;t<-0x8000000000000000;)t+=0x10000000000000000;return[e,t]}function O(e,t){return e[0]==t[0]&&e[1]==t[1]}function b(e){return 0<=e?[e,0]:[e+a,-a]}function v(e){return 2147483648<=e[0]?~~Math.max(Math.min(e[0]-a,2147483647),-2147483648):~~Math.max(Math.min(e[0],2147483647),-2147483648)}function n(e){return e<=30?1<<e:n(30)*n(e-30)}function R(e,t){var r;if(t&=63,O(e,Ne))return t?A:e;if(e[1]<0)throw Error("Neg");return t=n(t),r=e[1]*t%0x10000000000000000,0x8000000000000000<=(r+=t=(e=e[0]*t)-e%a)&&(r-=0x10000000000000000),[e-=t,r]}function L(e,t){t=n(t&=63);return r(Math.floor(e[0]/t),e[1]/t)}function P(e,t){return r(e[0]-t[0],e[1]-t[1])}function M(e,t){return e.Mc=t,e.Lc=0,e.Yb=t.length,e}function c(e){return e.Lc>=e.Yb?-1:255&e.Mc[e.Lc++]}function F(e){return e.Mc=g(32),e.Yb=0,e}function u(e){var t=e.Mc;return t.length=e.Yb,t}function B(e,t){e.Mc[e.Yb++]=t<<24>>24}function $(e,t,r,n){U(t,r,e.Mc,e.Yb,n),e.Yb+=n}function U(e,t,r,n,i){for(var s=0;s<i;++s)r[n+s]=e[t+s]}function V(t,r,n,i,s){var a;if(y(i,I)<0)throw Error("invalid length "+i);t.Tb=i;var o=(e=>{var t;for(e.v=g(4),e.a=[],e.d={},e.C=g(192),e.bb=g(12),e.hb=g(12),e.Ub=g(12),e.vc=g(12),e._=g(192),e.K=[],e.Sb=g(114),e.S=f({},4),e.$=Te({}),e.i=Te({}),e.A={},e.m=[],e.P=[],e.lb=[],e.nc=g(16),e.x=g(4),e.Q=g(4),e.Xb=[A],e.uc=[A],e.Kc=[0],e.fc=g(5),e.yc=g(128),e.vb=0,e.X=1,e.D=0,e.Hb=-1,t=e.mb=0;t<4096;++t)e.a[t]={};for(t=0;t<4;++t)e.K[t]=f({},6);return e})({}),l=o,c=l,u=1<<s.s;c.ab=u;for(var d,p=0;1<<p<u;++p);c.$b=2*p,l.n=s.f,c=s.m,d=(s=l).X,s.X=c,s.b&&d!=s.X&&(s.wb=-1,s.b=null),l.eb=0,l.fb=3,l.Y=2,l.y=3,o.Gc=void 0===e.disableEndMark;var h=o,c=n;h.fc[0]=9*(5*h.Y+h.eb)+h.fb<<24>>24;for(var m=0;m<4;++m)h.fc[1+m]=h.ab>>8*m<<24>>24;for($(c,h.fc,0,5),a=0;a<64;a+=8)B(n,255&v(L(i,a)));t.yb=(o.W=0,o.oc=r,o.pc=0,(d=o).b||(s={},l=4,d.X||(l=2),((e,t)=>{e.qb=2<t,e.qb?(e.w=0,e.xb=4,e.R=66560):(e.w=2,e.xb=3,e.R=0)})(s,l),d.b=s),((e,t,r)=>{var n,i;if(null==e.V||e.u!=r||e.I!=t)for(e.I=t,e.qc=(1<<t)-1,e.u=r,e.V=g(i=1<<e.u+e.I),n=0;n<i;++n)e.V[n]=(e=>(e.tb=g(768),e))({})})(d.A,d.eb,d.fb),d.ab==d.wb&&d.Hb==d.n||(((e,t,r,n,i)=>{t<1073741567&&(e.Fc=16+(n>>1),((e,t,r,n)=>{t=(e.Bc=t)+(e._b=r)+n,null!=e.c&&e.Kb==t||(e.c=null,e.Kb=t,e.c=g(e.Kb)),e.H=e.Kb-r})(e,t+r,n+i,256+~~((t+r+n+i)/2)),e.ob=n,e.p!=(r=t+1)&&(e.L=g(2*(e.p=r))),i=65536,e.qb&&(i=t-1,16777216<(i=(i=(i=(i=(i|=i>>1)|i>>2)|i>>4)|i>>8)>>1|65535)&&(i>>=1),e.Ec=i,++i,i+=e.R),i!=e.rc)&&(e.ub=g(e.rc=i))})(d.b,d.ab,4096,d.n,274),d.wb=d.ab,d.Hb=d.n),o.d.Ab=n,(e=>{var t=e;t.l=0;for(var r=t.J=0;r<4;++r)t.v[r]=0;var n,i=e.d,s=(i.mc=A,i.xc=A,i.E=-1,i.Jb=1,i.Oc=0,E(e.C),E(e._),E(e.bb),E(e.hb),E(e.Ub),E(e.vc),E(e.Sb),e.A),a=1<<s.u+s.I;for(n=0;n<a;++n)E(s.V[n].tb);for(var o=0;o<4;++o)E(e.K[o].G);ye(e.$,1<<e.Y),ye(e.i,1<<e.Y),E(e.S.G),e.N=0,e.jb=0,e.q=0,e.s=0})(o),de(o),ue(o),o.$.rb=o.n+1-2,ke(o.$,1<<o.Y),o.i.rb=o.n+1-2,ke(o.i,1<<o.Y),o.g=A,c=o,(t={}).cb=c,t.Z=null,t.zc=1,t)}function H(e,t,r){return e.Nb=F({}),V(e,M({},t),e.Nb,b(t.length),r),e}function G(e,t,r){for(var n,i,s,a="",o=[],l=0;l<5;++l){if(-1==(i=c(t)))throw Error("truncated input");o[l]=i<<24>>24}if(!((e,t)=>{var r,n,i,s,a;if(!(t.length<5)){for(i=(a=255&t[0])%9,s=(a=~~(a/9))%5,a=~~(a/5),n=r=0;n<4;++n)r+=(255&t[1+n])<<8*n;return!(99999999<r)&&((e,t,r,n)=>{if(!(8<t||4<r||4<n)){var i=e.gb,s=r,a,o;if(null==i.V||i.u!=t||i.I!=s)for(i.I=s,i.qc=(1<<s)-1,i.u=t,i.V=g(o=1<<i.u+i.I),a=0;a<o;++a)i.V[a]=(e=>(e.Ib=g(768),e))({});return se(e.Rb,r=1<<n),se(e.sb,r),e.Dc=r-1,1}})(e,i,s,a)&&((e,t)=>!(t<0)&&(e.Ob!=t&&(e.Ob=t,e.nb=Math.max(e.Ob,1),((e,t)=>{null!=e.Lb&&e.M==t||(e.Lb=g(t)),e.M=t,e.o=0,e.h=0})(e.B,Math.max(e.nb,4096))),1))(e,r)}})(n=(e=>{e.B={},e.e={},e.Gb=g(192),e.Zb=g(12),e.Cb=g(12),e.Db=g(12),e.Eb=g(12),e.pb=g(192),e.kb=g(4),e.kc=g(114),e.Fb=p({},4),e.Rb=oe({}),e.sb=oe({}),e.gb={};for(var t=0;t<4;++t)e.kb[t]=p({},6);return e})({}),o))throw Error("corrupted input");for(l=0;l<64;l+=8){if(-1==(i=c(t)))throw Error("truncated input");a=(i=1==(i=i.toString(16)).length?"0"+i:i)+""+a}/^0+$|^f+$/i.test(a)?e.Tb=I:(s=parseInt(a,16),e.Tb=4294967295<s?I:b(s)),e.yb=(s=r,r=e.Tb,(e=n).e.Ab=t,ie(e.B),e.B.cc=s,(e=>{e.B.h=0,e.B.o=0,E(e.Gb),E(e.pb),E(e.Zb),E(e.Cb),E(e.Db),E(e.Eb),E(e.kc);var t,r,n=e.gb;for(r=1<<n.u+n.I,t=0;t<r;++t)E(n.V[t].Ib);for(var i=0;i<4;++i)E(e.kb[i].G);le(e.Rb),le(e.sb),E(e.Fb.G);var s=e.e;s.Bb=0,s.E=-1;for(var a=0;a<5;++a)s.Bb=s.Bb<<8|c(s.Ab)})(e),e.U=0,e.ib=0,e.Jc=0,e.Ic=0,e.Qc=0,e.Nc=r,e.g=A,e.jc=0,((e,t)=>(e.Z=t,e.cb=null,e.zc=1,e))({},e))}function j(e,t){return e.Nb=F({}),G(e,M({},t),e.Nb),e}function K(e,t){return e.c[e.f+e.o+t]}function z(e,t,r,n){var i,s;for(e.T&&e.o+t+n>e.h&&(n=e.h-(e.o+t)),++r,s=e.f+e.o+t,i=0;i<n&&e.c[s+i]==e.c[s+i-r];++i);return i}function W(e){return e.h-e.o}function ee(e){var t,r,n,i;if(!e.T)for(;;){if(!(i=-e.f+e.Kb-e.h))return;if(t=e.cc,r=e.c,n=e.f+e.h,i=i,-1==(r=t.Lc>=t.Yb?-1:(i=Math.min(i,t.Yb-t.Lc),U(t.Mc,t.Lc,r,n,i),t.Lc+=i,i)))return e.zb=e.h,e.H<e.f+e.zb&&(e.zb=e.H-e.f),e.T=1;e.h+=r,e.o+e._b<=e.h&&(e.zb=e.h-e._b)}}function te(e,t){e.f+=t,e.zb-=t,e.o-=t,e.h-=t}function k(e){++e.k>=e.p&&(e.k=0);var t,r=e;if(++r.o,r.zb<r.o){if(t=r.f+r.o,r.H<t){var n,i,s=r,a=s.f+s.o-s.Bc;for(0<a&&--a,i=s.f+s.h-a,n=0;n<i;++n)s.c[n]=s.c[a+n];s.f-=a}ee(r)}1073741823==e.o&&(t=e.o-e.p,re(e.L,2*e.p,t),re(e.ub,e.rc,t),te(e,t))}function re(e,t,r){for(var n,i=0;i<t;++i)(n=e[i]||0)<=r?n=0:n-=r,e[i]=n}function i(e){var t=e.o-e.h;t&&($(e.cc,e.Lb,e.h,t),e.M<=e.o&&(e.o=0),e.h=e.o)}function ne(e,t){t=e.o-t-1;return t<0&&(t+=e.M),e.Lb[t]}function ie(e){i(e),e.cc=null}function T(e){return(e-=2)<4?e:3}function q(e){return e<4?0:e<10?e-3:e-6}function d(e){if(e.zc){if(e.cb){r=e,((e,t,r,n)=>{var i,s,a,o,l,c,u,d,p,h,m,g;{var f;t[0]=A,r[0]=A,n[0]=1,e.oc&&(e.b.cc=e.oc,(f=e.b).f=0,f.o=0,f.h=0,f.T=0,ee(f),f.k=0,te(f,-1),e.W=1,e.oc=null)}if(!e.pc){if(e.pc=1,O(m=e.g,A)){if(!W(e.b))return pe(e,v(e.g));ge(e),h=v(e.g)&e.y,S(e.d,e.C,(e.l<<4)+h,0),e.l=q(e.l),s=K(e.b,-e.s),xe(X(e.A,v(e.g),e.J),e.d,s),e.J=s,--e.s,e.g=_(e.g,Oe)}if(W(e.b))for(;;){if(c=((e,t)=>{var r,M,F,n,i,s,B,a,o,l,c,u,d,$,p,h,m,U,V,g,f,H,_,y,b,v,T,k,x,E,S,C,G,w,j,I,A,D,N,O,R,L;if(e.jb!=e.q)return P=e.a[e.q].r-e.q,e.mb=e.a[e.q].j,e.q=e.a[e.q].r,P;if(e.q=e.jb=0,e.N?(c=e.vb,e.N=0):c=ge(e),b=e.D,(_=W(e.b)+1)<2)return e.mb=-1,1;for(273<_&&(_=273),a=A=0;a<4;++a)e.x[a]=e.v[a],e.Q[a]=z(e.b,-1,e.x[a],273),e.Q[a]>e.Q[A]&&(A=a);if(e.Q[A]>=e.n)return e.mb=A,P=e.Q[A],me(e,P-1),P;if(e.n<=c)return e.mb=e.m[b-1]+4,me(e,c-1),c;if(s=K(e.b,-1),p=K(e.b,-e.v[0]-1-1),c<2&&s!=p&&e.Q[A]<2)return e.mb=-1,1;{var P;e.a[0].Hc=e.l,S=t&e.y,e.a[1].z=Q[e.C[(e.l<<4)+S]>>>2]+Z(X(e.A,t,e.J),7<=e.l,p,s),Ee(e.a[1]),h=Q[2048-e.C[(e.l<<4)+S]>>>2],I=h+Q[2048-e.bb[e.l]>>>2],p==s&&(D=I+((e,t,r)=>Q[e.hb[t]>>>2]+Q[e._[(t<<4)+r]>>>2])(e,e.l,S),e.a[1].z>D)&&(e.a[1].z=D,(P=e.a[1]).j=0,P.t=0)}if((l=c>=e.Q[A]?c:e.Q[A])<2)return e.mb=e.a[1].j,1;for(e.a[1].r=0,e.a[0].bc=e.x[0],e.a[0].ac=e.x[1],e.a[0].dc=e.x[2],e.a[0].lc=e.x[3],o=l;e.a[o--].z=268435455,2<=o;);for(a=0;a<4;++a)if(!((j=e.Q[a])<2))for(G=I+J(e,a,e.l,S);n=G+Y(e.i,j-2,S),(k=e.a[j]).z>n&&(k.z=n,k.r=0,k.j=a,k.t=0),2<=--j;);if(H=h+Q[e.bb[e.l]>>>2],(o=2<=e.Q[0]?e.Q[0]+1:2)<=c){for(v=0;o>e.m[v];)v+=2;for(;B=e.m[v+1],n=H+he(e,B,o,S),(k=e.a[o]).z>n&&(k.z=n,k.r=0,k.j=B+4,k.t=0),o!=e.m[v]||(v+=2)!=b;++o);}for(r=0;;){if(++r==l)return ce(e,r);if(m=ge(e),b=e.D,e.n<=m)return e.vb=m,e.N=1,ce(e,r);if(++t,E=e.a[r].r,O=e.a[r].t?(--E,q(O=e.a[r].Ac?(O=e.a[e.a[r].r2].Hc,e.a[r].j2<4?O<7?8:11:O<7?7:10):e.a[E].Hc)):e.a[E].Hc,E==r-1?O=e.a[r].j?q(O):O<7?9:11:(O=e.a[r].t&&e.a[r].Ac?(E=e.a[r].r2,x=e.a[r].j2,O<7?8:11):(x=e.a[r].j)<4?O<7?8:11:O<7?7:10,E=e.a[E],x<4?x?1==x?(e.x[0]=E.ac,e.x[1]=E.bc,e.x[2]=E.dc,e.x[3]=E.lc):2==x?(e.x[0]=E.dc,e.x[1]=E.bc,e.x[2]=E.ac,e.x[3]=E.lc):(e.x[0]=E.lc,e.x[1]=E.bc,e.x[2]=E.ac,e.x[3]=E.dc):(e.x[0]=E.bc,e.x[1]=E.ac,e.x[2]=E.dc,e.x[3]=E.lc):(e.x[0]=x-4,e.x[1]=E.bc,e.x[2]=E.ac,e.x[3]=E.dc)),e.a[r].Hc=O,e.a[r].bc=e.x[0],e.a[r].ac=e.x[1],e.a[r].dc=e.x[2],e.a[r].lc=e.x[3],E=e.a[r].z,s=K(e.b,-1),p=K(e.b,-e.x[0]-1-1),M=E+Q[e.C[(O<<4)+(S=t&e.y)]>>>2]+Z(X(e.A,t,K(e.b,-2)),7<=O,p,s),g=e.a[r+1],U=0,g.z>M&&(g.z=M,g.r=r,g.j=-1,g.t=0,U=1),h=E+Q[2048-e.C[(O<<4)+S]>>>2],I=h+Q[2048-e.bb[O]>>>2],p!=s||r>g.r&&!g.j||(D=I+(Q[e.hb[O]>>>2]+Q[e._[(O<<4)+S]>>>2]),g.z>=D&&(g.z=D,g.r=r,g.j=0,g.t=0,U=1)),y=W(e.b)+1,!((_=y=4095-r<y?4095-r:y)<2)){if(_>e.n&&(_=e.n),!U&&p!=s&&(L=Math.min(y-1,e.n),2<=(d=z(e.b,0,e.x[0],L)))){for(R=q(O),C=t+1&e.y,f=M+Q[2048-e.C[(R<<4)+C]>>>2]+Q[2048-e.bb[R]>>>2],T=r+1+d;l<T;)e.a[++l].z=268435455;n=f+(Y(e.i,d-2,C)+J(e,0,R,C)),(k=e.a[T]).z>n&&(k.z=n,k.r=r+1,k.j=0,k.t=1,k.Ac=0)}for(N=2,w=0;w<4;++w)if(!((u=z(e.b,-1,e.x[w],_))<2)){$=u;do{for(;l<r+u;)e.a[++l].z=268435455}while(n=I+(Y(e.i,u-2,S)+J(e,w,O,S)),(k=e.a[r+u]).z>n&&(k.z=n,k.r=r,k.j=w,k.t=0),2<=--u);if(u=$,w||(N=u+1),u<y&&(L=Math.min(y-1-u,e.n),2<=(d=z(e.b,u,e.x[w],L)))){for(R=O<7?8:11,C=t+u&e.y,F=I+(Y(e.i,u-2,S)+J(e,w,O,S))+Q[e.C[(R<<4)+C]>>>2]+Z(X(e.A,t+u,K(e.b,u-1-1)),1,K(e.b,u-1-(e.x[w]+1)),K(e.b,u-1)),R=q(R),V=F+Q[2048-e.C[(R<<4)+(C=t+u+1&e.y)]>>>2],f=V+Q[2048-e.bb[R]>>>2],T=u+1+d;l<r+T;)e.a[++l].z=268435455;n=f+(Y(e.i,d-2,C)+J(e,0,R,C)),(k=e.a[r+T]).z>n&&(k.z=n,k.r=r+u+1,k.j=0,k.t=1,k.Ac=1,k.r2=r,k.j2=w)}}if(_<m){for(m=_,b=0;m>e.m[b];b+=2);e.m[b]=m,b+=2}if(N<=m){for(H=h+Q[e.bb[O]>>>2];l<r+m;)e.a[++l].z=268435455;for(v=0;N>e.m[v];)v+=2;for(u=N;;++u)if(i=e.m[v+1],n=H+he(e,i,u,S),(k=e.a[r+u]).z>n&&(k.z=n,k.r=r,k.j=i+4,k.t=0),u==e.m[v]){if(u<y&&(L=Math.min(y-1-u,e.n),2<=(d=z(e.b,u,i,L)))){for(R=O<7?7:10,C=t+u&e.y,F=n+Q[e.C[(R<<4)+C]>>>2]+Z(X(e.A,t+u,K(e.b,u-1-1)),1,K(e.b,u-(i+1)-1),K(e.b,u-1)),R=q(R),V=F+Q[2048-e.C[(R<<4)+(C=t+u+1&e.y)]>>>2],f=V+Q[2048-e.bb[R]>>>2],T=u+1+d;l<r+T;)e.a[++l].z=268435455;n=f+(Y(e.i,d-2,C)+J(e,0,R,C)),(k=e.a[r+T]).z>n&&(k.z=n,k.r=r+u+1,k.j=0,k.t=1,k.Ac=1,k.r2=r,k.j2=i+4)}if((v+=2)==b)break}}}}})(e,v(e.g)),d=e.mb,h=v(e.g)&e.y,o=(e.l<<4)+h,1==c&&-1==d)S(e.d,e.C,o,0),s=K(e.b,-e.s),g=X(e.A,v(e.g),e.J),e.l<7?xe(g,e.d,s):(u=K(e.b,-e.v[0]-1-e.s),((e,t,r,n)=>{var i,s,a,o,l=1,c=1;for(s=7;0<=s;--s)i=n>>s&1,o=c,l&&(o+=1+(a=r>>s&1)<<8,l=a==i),S(t,e.tb,o,i),c=c<<1|i})(g,e.d,u,s)),e.J=s,e.l=q(e.l);else{if(S(e.d,e.C,o,1),d<4){if(S(e.d,e.bb,e.l,1),d?(S(e.d,e.hb,e.l,1),1==d?S(e.d,e.Ub,e.l,0):(S(e.d,e.Ub,e.l,1),S(e.d,e.vc,e.l,d-2))):(S(e.d,e.hb,e.l,0),S(e.d,e._,o,1==c?0:1)),1==c?e.l=e.l<7?9:11:(ve(e.i,e.d,c-2,h),e.l=e.l<7?8:11),a=e.v[d],0!=d){for(l=d;1<=l;--l)e.v[l]=e.v[l-1];e.v[0]=a}}else{for(S(e.d,e.bb,e.l,0),e.l=e.l<7?7:10,ve(e.$,e.d,c-2,h),g=_e(d-=4),u=T(c),x(e.K[u],e.d,g),4<=g&&(p=d-(i=(2|1&g)<<(o=(g>>1)-1)),g<14?((e,t,r,n,i)=>{var s,a,o=1;for(a=0;a<n;++a)S(r,e,t+o,s=1&i),o=o<<1|s,i>>=1})(e.Sb,i-g-1,e.d,o,p):(Ce(e.d,p>>4,o-4),Se(e.S,e.d,15&p),++e.Qb)),a=d,l=3;1<=l;--l)e.v[l]=e.v[l-1];e.v[0]=a,++e.Mb}e.J=K(e.b,c-1-e.s)}if(e.s-=c,e.g=_(e.g,b(c)),!e.s){if(128<=e.Mb&&de(e),16<=e.Qb&&ue(e),t[0]=e.g,r[0]=(e=>_(_(b(e.Jb),e.mc),[4,0]))(e.d),!W(e.b))return pe(e,v(e.g));if(0<=y(P(e.g,m),[4096,0]))return e.pc=0,n[0]=0}}else pe(e,v(e.g))}})(r.cb,r.cb.Xb,r.cb.uc,r.cb.Kc),r.Pb=r.cb.Xb[0];if(r.cb.Kc[0]){{var t=r.cb;fe(t),t.d.Ab=null}r.zc=0}}else{t=e;r=(e=>{var t;if(t=v(e.g)&e.Dc,l(e.e,e.Gb,(e.U<<4)+t)){if(l(e.e,e.Zb,e.U))n=0,l(e.e,e.Cb,e.U)?(l(e.e,e.Db,e.U)?(l(e.e,e.Eb,e.U)?(r=e.Qc,e.Qc=e.Ic):r=e.Ic,e.Ic=e.Jc):r=e.Jc,e.Jc=e.ib,e.ib=r):l(e.e,e.pb,(e.U<<4)+t)||(e.U=e.U<7?9:11,n=1),n||(n=ae(e.sb,e.e,t)+2,e.U=e.U<7?8:11);else if(e.Qc=e.Ic,e.Ic=e.Jc,e.Jc=e.ib,n=2+ae(e.Rb,e.e,t),e.U=e.U<7?7:10,4<=(r=s(e.kb[T(n)],e.e))){if(t=(r>>1)-1,e.ib=(2|1&r)<<t,r<14)e.ib+=((e,t,r,n)=>{var i,s,a=1,o=0;for(s=0;s<n;++s)i=l(r,e,t+a),a=(a<<1)+i,o|=i<<s;return o})(e.kc,e.ib-r-1,e.e,t);else if(e.ib+=((e,t)=>{var r,n,i=0;for(r=t;0!=r;--r)e.E>>>=1,e.Bb-=e.E&(n=e.Bb-e.E>>>31)-1,i=i<<1|1-n,-16777216&e.E||(e.Bb=e.Bb<<8|c(e.Ab),e.E<<=8);return i})(e.e,t-4)<<4,e.ib+=((e,t)=>{var r,n,i=1,s=0;for(n=0;e.F>n;++n)r=l(t,e.G,i),i=(i<<1)+r,s|=r<<n;return s})(e.Fb,e.e),e.ib<0)return-1==e.ib?1:-1}else e.ib=r;if(0<=y(b(e.ib),e.g)||e.ib>=e.nb)return-1;((e,t,r)=>{var n=e.o-t-1;for(n<0&&(n+=e.M);0!=r;--r)n>=e.M&&(n=0),e.Lb[e.o++]=e.Lb[n++],e.M<=e.o&&i(e)})(e.B,e.ib,n),e.g=_(e.g,b(n)),e.jc=ne(e.B,0)}else{t=((e,t,r)=>e.V[((t&e.qc)<<e.u)+((255&r)>>>8-e.u)])(e.gb,v(e.g),e.jc),e.jc=e.U<7?((e,t)=>{for(var r=1;(r=r<<1|l(t,e.Ib,r))<256;);return r<<24>>24})(t,e.e):((e,t,r)=>{var n,i,s=1;do{if(i=r>>7&1,r<<=1,n=l(t,e.Ib,(1+i<<8)+s),s=s<<1|n,i!=n){for(;s<256;)s=s<<1|l(t,e.Ib,s);break}}while(s<256);return s<<24>>24})(t,e.e,ne(e.B,e.ib));{var r=e.B;var n=e.jc;r.Lb[r.o++]=n,r.M<=r.o&&i(r)}e.U=q(e.U),e.g=_(e.g,Oe)}return 0})(t.Z);if(-1==r)throw Error("corrupted input");t.Pb=I,t.Pc=t.Z.g,(r||0<=y(t.Z.Nc,A)&&0<=y(t.Z.g,t.Z.Nc))&&(i(t.Z.B),ie(t.Z.B),t.Z.e.Ab=null,t.zc=0)}return e.zc}throw Error("bad state");var r}function se(e,t){for(;t>e.O;++e.O)e.ec[e.O]=p({},3),e.hc[e.O]=p({},3)}function ae(e,t,r){return l(t,e.wc,0)?8+(l(t,e.wc,1)?8+s(e.tc,t):s(e.hc[r],t)):s(e.ec[r],t)}function oe(e){return e.wc=g(2),e.ec=g(16),e.hc=g(16),e.tc=p({},8),e.O=0,e}function le(e){E(e.wc);for(var t=0;e.O>t;++t)E(e.ec[t].G),E(e.hc[t].G);E(e.tc.G)}function ce(e,t){var r,n,i,s;for(e.jb=t,i=e.a[t].r,n=e.a[t].j;e.a[t].t&&(Ee(e.a[i]),e.a[i].r=i-1,e.a[t].Ac)&&(e.a[i-1].t=0,e.a[i-1].r=e.a[t].r2,e.a[i-1].j=e.a[t].j2),s=i,r=n,n=e.a[s].j,i=e.a[s].r,e.a[s].j=r,e.a[s].r=t,0<(t=s););return e.mb=e.a[0].j,e.q=e.a[0].r}function ue(e){for(var t=0;t<16;++t)e.nc[t]=((e,t)=>{var r,n,i=1,s=0;for(n=e.F;0!=n;--n)r=1&t,t>>>=1,s+=m(e.G[i],r),i=i<<1|r;return s})(e.S,t);e.Qb=0}function de(e){for(var t,r,n,i,s,a,o,l=4;l<128;++l)s=_e(l),e.yc[l]=((e,t,r,n)=>{var i,s,a=1,o=0;for(s=r;0!=s;--s)i=1&n,n>>>=1,o+=Q[(2047&(e[t+a]-i^-i))>>>2],a=a<<1|i;return o})(e.Sb,(t=(2|1&s)<<(n=(s>>1)-1))-s-1,n,l-t);for(i=0;i<4;++i){for(r=e.K[i],a=i<<6,s=0;e.$b>s;++s)e.P[a+s]=h(r,s);for(s=14;e.$b>s;++s)e.P[a+s]+=(s>>1)-1-4<<6;for(o=128*i,l=0;l<4;++l)e.lb[o+l]=e.P[a+l];for(;l<128;++l)e.lb[o+l]=e.P[a+_e(l)]+e.yc[l]}e.Mb=0}function pe(e,t){var r;fe(e),r=t&(t=e).y,t.Gc&&(S(t.d,t.C,(t.l<<4)+r,1),S(t.d,t.bb,t.l,0),t.l=t.l<7?7:10,ve(t.$,t.d,0,r),r=T(2),x(t.K[r],t.d,63),Ce(t.d,67108863,26),Se(t.S,t.d,15));for(var n=0;n<5;++n)we(e.d)}function he(e,t,r,n){var i=T(r);return(t<128?e.lb[128*i+t]:e.P[(i<<6)+((i=t)<131072?o[i>>6]+12:i<134217728?o[i>>16]+32:o[i>>26]+52)]+e.nc[15&t])+Y(e.$,r-2,n)}function J(e,t,r,n){var i;return t?(i=Q[2048-e.hb[r]>>>2],1==t?i+=Q[e.Ub[r]>>>2]:i=(i+=Q[2048-e.Ub[r]>>>2])+m(e.vc[r],t-2)):(i=Q[e.hb[r]>>>2],i+=Q[2048-e._[(r<<4)+n]>>>2]),i}function me(e,t){if(0<t){var r,n,i,s,a,o,l,c,u,d,p,h,m,g=e.b,f=t;do{if(g.h>=g.o+g.ob)c=g.ob;else if((c=g.h-g.o)<g.xb){k(g);continue}for(u=g.p<g.o?g.o-g.p:0,n=g.f+g.o,m=g.qb?(m=Re[255&g.c[n]]^255&g.c[n+1],g.ub[1023&m]=g.o,m^=(255&g.c[n+2])<<8,g.ub[1024+(65535&m)]=g.o,(m^Re[255&g.c[n+3]]<<5)&g.Ec):255&g.c[n]^(255&g.c[n+1])<<8,i=g.ub[g.R+m],g.ub[g.R+m]=g.o,p=1+(g.k<<1),h=g.k<<1,o=l=g.w,r=g.Fc;;){if(i<=u||0==r--){g.L[p]=g.L[h]=0;break}if(s=((s=g.o-i)<=g.k?g.k-s:g.k-s+g.p)<<1,g.c[(d=g.f+i)+(a=o<l?o:l)]==g.c[n+a]){for(;++a!=c&&g.c[d+a]==g.c[n+a];);if(a==c){g.L[h]=g.L[s],g.L[p]=g.L[1+s];break}}(255&g.c[n+a])>(255&g.c[d+a])?(g.L[h]=i,i=g.L[h=1+s],l=a):(g.L[p]=i,i=g.L[p=s],o=a)}k(g)}while(0!=--f);e.s+=t}}function ge(e){var t=0;return e.D=((e,t)=>{var r,n,i,s,a,o,l,c,u,d,p,h,m,g,f,_,y,b,v,T;if(e.h>=e.o+e.ob)m=e.ob;else if((m=e.h-e.o)<e.xb)return k(e),0;for(g=e.p<e.o?e.o-e.p:0,n=e.f+e.o,f=1,u=c=_=0,T=e.qb?(c=1023&(T=Re[255&e.c[n]]^255&e.c[n+1]),u=65535&(T^=(255&e.c[n+2])<<8),(T^Re[255&e.c[n+3]]<<5)&e.Ec):255&e.c[n]^(255&e.c[n+1])<<8,i=e.ub[e.R+T]||0,e.qb&&(s=e.ub[c]||0,a=e.ub[1024+u]||0,e.ub[c]=e.o,e.ub[1024+u]=e.o,g<s&&e.c[e.f+s]==e.c[n]&&(t[_++]=f=2,t[_++]=e.o-s-1),g<a&&e.c[e.f+a]==e.c[n]&&(a==s&&(_-=2),t[_++]=f=3,t[_++]=e.o-a-1,s=a),0!=_)&&s==i&&(_-=2,f=1),e.ub[e.R+T]=e.o,b=1+(e.k<<1),v=e.k<<1,0!=(p=h=e.w)&&g<i&&e.c[e.f+i+e.w]!=e.c[n+e.w]&&(t[_++]=f=e.w,t[_++]=e.o-i-1),r=e.Fc;;){if(i<=g||0==r--){e.L[b]=e.L[v]=0;break}if(o=((l=e.o-i)<=e.k?e.k-l:e.k-l+e.p)<<1,e.c[(y=e.f+i)+(d=p<h?p:h)]==e.c[n+d]){for(;++d!=m&&e.c[y+d]==e.c[n+d];);if(f<d&&(t[_++]=f=d,t[_++]=l-1,d==m)){e.L[v]=e.L[o],e.L[b]=e.L[1+o];break}}(255&e.c[n+d])>(255&e.c[y+d])?(e.L[v]=i,i=e.L[v=1+o],h=d):(e.L[b]=i,i=e.L[b=o],p=d)}return k(e),_})(e.b,e.m),0<e.D&&(t=e.m[e.D-2])==e.n&&(t+=z(e.b,t-1,e.m[e.D-1],273-t)),++e.s,t}function fe(e){e.b&&e.W&&(e.b.cc=null,e.W=0)}function _e(e){return e<2048?o[e]:e<2097152?o[e>>10]+20:o[e>>20]+40}function ye(e,t){E(e.db);for(var r=0;r<t;++r)E(e.Vb[r].G),E(e.Wb[r].G);E(e.ic.G)}function be(e,t,r,n,i){var s=Q[e.db[0]>>>2],a=Q[2048-e.db[0]>>>2],o=a+Q[e.db[1]>>>2],l=a+Q[2048-e.db[1]>>>2],c=0;for(c=0;c<8;++c){if(r<=c)return;n[i+c]=s+h(e.Vb[t],c)}for(;c<16;++c){if(r<=c)return;n[i+c]=o+h(e.Wb[t],c-8)}for(;c<r;++c)n[i+c]=l+h(e.ic,c-8-8)}function ve(e,t,r,n){var i,s;i=e,t=t,s=n,(r=r)<8?(S(t,i.db,0,0),x(i.Vb[s],t,r)):(r-=8,S(t,i.db,0,1),r<8?(S(t,i.db,1,0),x(i.Wb[s],t,r)):(S(t,i.db,1,1),x(i.ic,t,r-8))),0==--e.sc[n]&&(be(e,n,e.rb,e.Cc,272*n),e.sc[n]=e.rb)}function Te(e){var t=e;t.db=g(2),t.Vb=g(16),t.Wb=g(16),t.ic=f({},8);for(var r=0;r<16;++r)t.Vb[r]=f({},3),t.Wb[r]=f({},3);return e.Cc=[],e.sc=[],e}function Y(e,t,r){return e.Cc[272*r+t]}function ke(e,t){for(var r=0;r<t;++r)be(e,r,e.rb,e.Cc,272*r),e.sc[r]=e.rb}function X(e,t,r){return e.V[((t&e.qc)<<e.u)+((255&r)>>>8-e.u)]}function xe(e,t,r){for(var n,i=1,s=7;0<=s;--s)S(t,e.tb,i,n=r>>s&1),i=i<<1|n}function Z(e,t,r,n){var i,s,a=1,o=7,l=0;if(t)for(;0<=o;--o)if(l+=m(e.tb[(1+(s=r>>o&1)<<8)+a],i=n>>o&1),a=a<<1|i,s!=i){--o;break}for(;0<=o;--o)l+=m(e.tb[a],i=n>>o&1),a=a<<1|i;return l}function Ee(e){e.j=-1,e.t=0}function p(e,t){return e.F=t,e.G=g(1<<t),e}function s(e,t){for(var r=1,n=e.F;0!=n;--n)r=(r<<1)+l(t,e.G,r);return r-(1<<e.F)}function f(e,t){return e.F=t,e.G=g(1<<t),e}function x(e,t,r){for(var n,i=1,s=e.F;0!=s;)S(t,e.G,i,n=r>>>--s&1),i=i<<1|n}function h(e,t){for(var r,n=1,i=0,s=e.F;0!=s;)i+=m(e.G[n],r=t>>>--s&1),n=(n<<1)+r;return i}function Se(e,t,r){for(var n,i=1,s=0;e.F>s;++s)S(t,e.G,i,n=1&r),i=i<<1|n,r>>=1}function l(e,t,r){var n=t[r],i=(e.E>>>11)*n;return(-2147483648^e.Bb)<(-2147483648^i)?(e.E=i,t[r]=n+(2048-n>>>5)<<16>>16,-16777216&e.E||(e.Bb=e.Bb<<8|c(e.Ab),e.E<<=8),0):(e.E-=i,e.Bb-=i,t[r]=n-(n>>>5)<<16>>16,-16777216&e.E||(e.Bb=e.Bb<<8|c(e.Ab),e.E<<=8),1)}function E(e){for(var t=e.length-1;0<=t;--t)e[t]=1024}function S(e,t,r,n){var i=t[r],s=(e.E>>>11)*i;n?(e.xc=_(e.xc,N(b(s),[4294967295,0])),e.E-=s,t[r]=i-(i>>>5)<<16>>16):(e.E=s,t[r]=i+(2048-i>>>5)<<16>>16),-16777216&e.E||(e.E<<=8,we(e))}function Ce(e,t,r){for(var n=r-1;0<=n;--n)e.E>>>=1,1==(t>>>n&1)&&(e.xc=_(e.xc,b(e.E))),-16777216&e.E||(e.E<<=8,we(e))}function we(e){var t,r,n,i,s=v((r=e.xc,n=32,i=L(r,n&=63),i=r[1]<0?_(i,R([2,0],63-n)):i));if(0!=s||y(e.xc,[4278190080,0])<0){for(e.mc=_(e.mc,b(e.Jb)),t=e.Oc;B(e.Ab,t+s),t=255,0!=--e.Jb;);e.Oc=v(e.xc)>>>24}++e.Jb,e.xc=R(N(e.xc,[16777215,0]),8)}function m(e,t){return Q[(2047&(e-t^-t))>>>2]}function Ie(e){for(var t,r,n,i=0,s=0,a=e.length,o=[],l=[];i<a;++i,++s){if(128&(t=255&e[i]))if(192==(224&t)){if(a<=i+1)return e;if(128!=(192&(r=255&e[++i])))return e;l[s]=(31&t)<<6|63&r}else{if(224!=(240&t))return e;if(a<=i+2)return e;if(128!=(192&(r=255&e[++i])))return e;if(128!=(192&(n=255&e[++i])))return e;l[s]=(15&t)<<12|(63&r)<<6|63&n}else{if(!t)return e;l[s]=t}16383==s&&(o.push(String.fromCharCode.apply(String,l)),s=-1)}return 0<s&&(l.length=s,o.push(String.fromCharCode.apply(String,l))),o.join("")}function Ae(e){var t,r,n,i=[],s=0,a=e.length;if("object"==typeof e)return e;for(var o=e,l=a,c=i,u=0,d=0;d<l;++d)c[u++]=o.charCodeAt(d);for(n=0;n<a;++n)1<=(t=i[n])&&t<=127?++s:s+=!t||128<=t&&t<=2047?2:3;for(r=[],n=s=0;n<a;++n)1<=(t=i[n])&&t<=127?r[s++]=t<<24>>24:(!t||128<=t&&t<=2047?r[s++]=(192|t>>6&31)<<24>>24:(r[s++]=(224|t>>12&15)<<24>>24,r[s++]=(128|t>>6&63)<<24>>24),r[s++]=(128|63&t)<<24>>24);return r}function C(e){return e[1]+e[0]}var t,De=3,w="function"==typeof setImmediate?setImmediate:setTimeout,a=4294967296,I=[4294967295,-a],Ne=[0,-0x8000000000000000],A=[0,0],Oe=[1,0],Re=(()=>{for(var e,t,r=[],n=0;n<256;++n){for(t=n,e=0;e<8;++e)0!=(1&t)?t=t>>>1^-306674912:t>>>=1;r[n]=t}return r})(),o=(()=>{for(var e,t,r=2,n=[0,1],i=2;i<22;++i)for(t=1<<(i>>1)-1,e=0;e<t;++e,++r)n[r]=i<<24>>24;return n})(),Q=(()=>{for(var e,t,r=[],n=8;0<=n;--n)for(e=1<<9-n,t=1<<9-n-1;t<e;++t)r[t]=(n<<6)+(e-t<<6>>>9-n-1);return r})(),Le=(t=[{s:16,f:64,m:0},{s:20,f:64,m:0},{s:19,f:64,m:1},{s:20,f:64,m:1},{s:21,f:128,m:1},{s:22,f:128,m:1},{s:23,f:128,m:1},{s:24,f:255,m:1},{s:25,f:255,m:1}],function(e){return t[e-1]||t[6]});return"undefined"==typeof onmessage||"undefined"!=typeof window&&void 0!==window.document||(onmessage=function(t){t&&t.gc&&(2==t.gc.action?e.decompress(t.gc.gc,t.gc.cbn):1==t.gc.action&&e.compress(t.gc.gc,t.gc.Rc,t.gc.cbn))}),{compress:function(e,t,n,i){var s,r,a={},o=void 0===n&&void 0===i;if("function"!=typeof n&&(r=n,n=i=0),i=i||function(e){return void 0!==r?D(e,r):void 0},n=n||function(e,t){return void 0!==r?postMessage({action:1,cbn:r,result:e,error:t}):void 0},o){for(a.c=H({},Ae(e),Le(t));d(a.c.yb););return u(a.c.Nb)}try{a.c=H({},Ae(e),Le(t)),i(0)}catch(e){return n(null,e)}w(function e(){try{for(var t,r=(new Date).getTime();d(a.c.yb);)if(s=C(a.c.yb.Pb)/C(a.c.Tb),200<(new Date).getTime()-r)return i(s),w(e,0),0;i(1),t=u(a.c.Nb),w(n.bind(null,t),0)}catch(e){n(null,e)}},0)},decompress:function(e,i,s){var a,r,o,l,c={},t=void 0===i&&void 0===s;if("function"!=typeof i&&(r=i,i=s=0),s=s||function(e){return void 0!==r?D(o?e:-1,r):void 0},i=i||function(e,t){return void 0!==r?postMessage({action:2,cbn:r,result:e,error:t}):void 0},t){for(c.d=j({},e);d(c.d.yb););return Ie(u(c.d.Nb))}try{c.d=j({},e),l=C(c.d.Tb),o=-1<l,s(0)}catch(e){return i(null,e)}w(function e(){try{for(var t,r=0,n=(new Date).getTime();d(c.d.yb);)if(++r%1e3==0&&200<(new Date).getTime()-n)return o&&(a=C(c.d.yb.Z.g)/l,s(a)),w(e,0),0;s(1),t=Ie(u(c.d.Nb)),w(i.bind(null,t),0)}catch(e){i(null,e)}},0)}}})(),pxt,pxt,pxt,pxt,pxt,pxt,ts,pxtc=(this.LZMA=this.LZMA_WORKER=e,((e,t)=>{"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).DOMPurify=t()})(this,function(){var n=Object.hasOwnProperty,s=Object.setPrototypeOf,a=Object.isFrozen,_e=Object.keys,ye=Object.freeze,e=Object.seal,i=Object.create,t="undefined"!=typeof Reflect&&Reflect,o=(o=t.apply)||function(e,t,r){return e.apply(t,r)},ye=ye||function(e){return e},e=e||function(e){return e},l=(l=t.construct)||function(e,t){return new(Function.prototype.bind.apply(e,[null].concat((e=>{if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)})(t))))},be=r(Array.prototype.forEach),ve=r(Array.prototype.indexOf),Te=r(Array.prototype.join),ke=r(Array.prototype.pop),xe=r(Array.prototype.push),Ee=r(Array.prototype.slice),Se=r(String.prototype.toLowerCase),Ce=r(String.prototype.match),we=r(String.prototype.replace),Ge=r(String.prototype.indexOf),je=r(String.prototype.trim),Ie=r(RegExp.prototype.test),Ke=c(RegExp),Ae=c(TypeError);function r(i){return function(e){for(var t=arguments.length,r=Array(1<t?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return o(i,e,r)}}function c(n){return function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return l(n,t)}}function De(e,t){s&&s(e,null);for(var r=t.length;r--;){var n,i=t[r];"string"==typeof i&&(n=Se(i))!==i&&(a(t)||(t[r]=n),i=n),e[i]=!0}return e}function Ne(e){var t=i(null),r=void 0;for(r in e)o(n,e,[r])&&(t[r]=e[r]);return t}var Oe=ye(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Re=ye(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","audio","canvas","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","video","view","vkern"]),Le=ye(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Pe=ye(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Me=ye(["#text"]),Fe=ye(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns"]),Be=ye(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),$e=ye(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Ue=ye(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),ze=e(/\{\{[\s\S]*|[\s\S]*\}\}/gm),We=e(/<%[\s\S]*|[\s\S]*%>/gm),qe=e(/^data-[\-\w.\u00B7-\uFFFF]/),Je=e(/^aria-[\-\w]+$/),Ye=e(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Xe=e(/^(?:\w+script|data):/i),Ze=e(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function He(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}return function P(){var o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,c=function(e){return P(e)};if(c.version="2.0.17",c.removed=[],o&&o.document&&9===o.document.nodeType){var l=o.document,M=!1,s=o.document,F=o.DocumentFragment,e=o.HTMLTemplateElement,u=o.Node,t=o.NodeFilter,r=o.NamedNodeMap,B=void 0===r?o.NamedNodeMap||o.MozNamedAttrMap:r,$=o.Text,U=o.Comment,V=o.DOMParser,r=o.trustedTypes,d=("function"==typeof e&&(e=s.createElement("template")).content&&e.content.ownerDocument&&(s=e.content.ownerDocument),((e,t)=>{if("object"!==(void 0===e?"undefined":Ve(e))||"function"!=typeof e.createPolicy)return null;var r=null,t="dompurify"+((r=t.currentScript&&t.currentScript.hasAttribute("data-tt-policy-suffix")?t.currentScript.getAttribute("data-tt-policy-suffix"):r)?"#"+r:"");try{return e.createPolicy(t,{createHTML:function(e){return e}})}catch(e){return console.warn("TrustedTypes policy "+t+" could not be created."),null}})(r,l)),H=d&&C?d.createHTML(""):"",e=s,a=e.implementation,G=e.createNodeIterator,j=e.getElementsByTagName,K=e.createDocumentFragment,z=l.importNode,r={};try{r=Ne(s).documentMode?s.documentMode:{}}catch(P){}var n={},p=(c.isSupported=a&&void 0!==a.createHTMLDocument&&9!==r,ze),h=We,W=qe,q=Je,J=Xe,Y=Ze,i=Ye,m=null,X=De({},[].concat(He(Oe),He(Re),He(Le),He(Pe),He(Me))),g=null,Z=De({},[].concat(He(Fe),He(Be),He($e),He(Ue))),f=null,_=null,Q=!0,y=!0,ee=!1,b=!1,v=!1,T=!1,k=!1,x=!1,E=!1,S=!1,te=!1,C=!1,re=!0,w=!0,I=!1,A={},ne=De({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","plaintext","script","style","svg","template","thead","title","video","xmp"]),ie=null,se=De({},["audio","video","img","source","image","track"]),D=null,ae=De({},["alt","class","for","id","label","name","pattern","placeholder","summary","title","value","style","xmlns"]),N=null,oe=s.createElement("form"),le=function(e){N&&N===e||(e=Ne(e=e&&"object"===(void 0===e?"undefined":Ve(e))?e:{}),m="ALLOWED_TAGS"in e?De({},e.ALLOWED_TAGS):X,g="ALLOWED_ATTR"in e?De({},e.ALLOWED_ATTR):Z,D="ADD_URI_SAFE_ATTR"in e?De(Ne(ae),e.ADD_URI_SAFE_ATTR):ae,ie="ADD_DATA_URI_TAGS"in e?De(Ne(se),e.ADD_DATA_URI_TAGS):se,f="FORBID_TAGS"in e?De({},e.FORBID_TAGS):{},_="FORBID_ATTR"in e?De({},e.FORBID_ATTR):{},A="USE_PROFILES"in e&&e.USE_PROFILES,Q=!1!==e.ALLOW_ARIA_ATTR,y=!1!==e.ALLOW_DATA_ATTR,ee=e.ALLOW_UNKNOWN_PROTOCOLS||!1,b=e.SAFE_FOR_JQUERY||!1,v=e.SAFE_FOR_TEMPLATES||!1,T=e.WHOLE_DOCUMENT||!1,E=e.RETURN_DOM||!1,S=e.RETURN_DOM_FRAGMENT||!1,te=e.RETURN_DOM_IMPORT||!1,C=e.RETURN_TRUSTED_TYPE||!1,x=e.FORCE_BODY||!1,re=!1!==e.SANITIZE_DOM,w=!1!==e.KEEP_CONTENT,I=e.IN_PLACE||!1,i=e.ALLOWED_URI_REGEXP||i,v&&(y=!1),S&&(E=!0),A&&(m=De({},[].concat(He(Me))),g=[],!0===A.html&&(De(m,Oe),De(g,Fe)),!0===A.svg&&(De(m,Re),De(g,Be),De(g,Ue)),!0===A.svgFilters&&(De(m,Le),De(g,Be),De(g,Ue)),!0===A.mathMl)&&(De(m,Pe),De(g,$e),De(g,Ue)),e.ADD_TAGS&&De(m=m===X?Ne(m):m,e.ADD_TAGS),e.ADD_ATTR&&De(g=g===Z?Ne(g):g,e.ADD_ATTR),e.ADD_URI_SAFE_ATTR&&De(D,e.ADD_URI_SAFE_ATTR),w&&(m["#text"]=!0),T&&De(m,["html","head","body"]),m.table&&(De(m,["tbody"]),delete f.tbody),ye&&ye(e),N=e)},ce=function(t){xe(c.removed,{element:t});try{t.parentNode.removeChild(t)}catch(e){t.outerHTML=H}},O=function(e,t){try{xe(c.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){xe(c.removed,{attribute:null,from:t})}t.removeAttribute(e)},ue=function(e){var t,r=void 0,n=void 0,i=(x?e="<remove></remove>"+e:n=(i=Ce(e,/^[\r\n\t ]+/))&&i[0],d?d.createHTML(e):e);try{r=(new V).parseFromString(i,"text/html")}catch(e){}return M&&De(f,["title"]),r&&r.documentElement||((t=(r=a.createHTMLDocument("")).body).parentNode.removeChild(t.parentNode.firstElementChild),t.outerHTML=i),e&&n&&r.body.insertBefore(s.createTextNode(n),r.body.childNodes[0]||null),j.call(r,T?"html":"body")[0]};if(c.isSupported)try{var de=ue("<x/><title>&lt;/title&gt;&lt;img&gt;");Ie(/<\/title/,de.querySelector("title").innerHTML)&&(M=!0)}catch(de){}var pe=function(e){return G.call(e.ownerDocument||e,e,t.SHOW_ELEMENT|t.SHOW_COMMENT|t.SHOW_TEXT,function(){return t.FILTER_ACCEPT},!1)},R=function(e){return"object"===(void 0===u?"undefined":Ve(u))?e instanceof u:e&&"object"===(void 0===e?"undefined":Ve(e))&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName},L=function(e,t,r){n[e]&&be(n[e],function(e){e.call(c,t,r,N)})},he=function(e){var t;if(L("beforeSanitizeElements",e,null),((r=e)instanceof $||r instanceof U||"string"==typeof r.nodeName&&"string"==typeof r.textContent&&"function"==typeof r.removeChild&&r.attributes instanceof B&&"function"==typeof r.removeAttribute&&"function"==typeof r.setAttribute&&"string"==typeof r.namespaceURI)&&!Ce(e.nodeName,/[\u0080-\uFFFF]/)){var r=Se(e.nodeName);if(L("uponSanitizeElement",e,{tagName:r,allowedTags:m}),"svg"!==r&&"math"!==r||0===e.querySelectorAll("p, br, form, table").length){if(m[r]&&!f[r])return"noscript"===r&&Ie(/<\/noscript/i,e.innerHTML)||"noembed"===r&&Ie(/<\/noembed/i,e.innerHTML)?(ce(e),!0):(!b||R(e.firstElementChild)||R(e.content)&&R(e.content.firstElementChild)||!Ie(/</g,e.textContent)||(xe(c.removed,{element:e.cloneNode()}),e.innerHTML?e.innerHTML=we(e.innerHTML,/</g,"&lt;"):e.innerHTML=we(e.textContent,/</g,"&lt;")),v&&3===e.nodeType&&(t=e.textContent,t=we(t,p," "),t=we(t,h," "),e.textContent!==t)&&(xe(c.removed,{element:e.cloneNode()}),e.textContent=t),L("afterSanitizeElements",e,null),!1);if(w&&!ne[r]&&"function"==typeof e.insertAdjacentHTML)try{var n=e.innerHTML;e.insertAdjacentHTML("AfterEnd",d?d.createHTML(n):n)}catch(e){}}}return ce(e),!0},me=function(e,t,r){if(re&&("id"===t||"name"===t)&&(r in s||r in oe))return!1;if(!(y&&Ie(W,t)||Q&&Ie(q,t))){if(!g[t]||_[t])return!1;if(!D[t]&&!Ie(i,we(r,Y,""))&&("src"!==t&&"xlink:href"!==t&&"href"!==t||"script"===e||0!==Ge(r,"data:")||!ie[e])&&(!ee||Ie(J,we(r,Y,"")))&&r)return!1}return!0},ge=function(e){var t=void 0,r=void 0,n=(L("beforeSanitizeAttributes",e,null),e.attributes);if(n){for(var i={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:g},r=n.length;r--;){o=n[r];var s=o.name,a=o.namespaceURI,t=je(o.value),o=Se(s);if(i.attrName=o,i.attrValue=t,i.keepAttr=!0,i.forceKeepAttr=void 0,L("uponSanitizeAttribute",e,i),t=i.attrValue,!i.forceKeepAttr){if("name"===o&&"IMG"===e.nodeName&&n.id)l=n.id,n=Ee(n,[]),O("id",e),O(s,e),ve(n,l)>r&&e.setAttribute("id",l.value);else{if("INPUT"===e.nodeName&&"type"===o&&"file"===t&&i.keepAttr&&(g[o]||!_[o]))continue;"id"===s&&e.setAttribute(s,""),O(s,e)}if(i.keepAttr)if(b&&Ie(/\/>/i,t))O(s,e);else if(Ie(/svg|math/i,e.namespaceURI)&&Ie(Ke("</("+Te(_e(ne),"|")+")","i"),t))O(s,e);else{v&&(t=we(t,p," "),t=we(t,h," "));var l=e.nodeName.toLowerCase();if(me(l,o,t))try{a?e.setAttributeNS(a,s,t):e.setAttribute(s,t),ke(c.removed)}catch(e){}}}}L("afterSanitizeAttributes",e,null)}},fe=function e(t){var r,n=pe(t);for(L("beforeSanitizeShadowDOM",t,null);r=n.nextNode();)L("uponSanitizeShadowNode",r,null),he(r)||(r.content instanceof F&&e(r.content),ge(r));L("afterSanitizeShadowDOM",t,null)};c.sanitize=function(e,t){var r,n=void 0,i=void 0,s=void 0;if("string"!=typeof(e=e||"\x3c!--\x3e")&&!R(e)){if("function"!=typeof e.toString)throw Ae("toString is not a function");if("string"!=typeof(e=e.toString()))throw Ae("dirty is not a string, aborting")}if(!c.isSupported){if("object"===Ve(o.toStaticHTML)||"function"==typeof o.toStaticHTML){if("string"==typeof e)return o.toStaticHTML(e);if(R(e))return o.toStaticHTML(e.outerHTML)}return e}if(k||le(t),c.removed=[],!(I="string"==typeof e?!1:I))if(e instanceof u)1===(t=(n=ue("\x3c!--\x3e")).ownerDocument.importNode(e,!0)).nodeType&&"BODY"===t.nodeName||"HTML"===t.nodeName?n=t:n.appendChild(t);else{if(!E&&!v&&!T&&-1===e.indexOf("<"))return d&&C?d.createHTML(e):e;if(!(n=ue(e)))return E?null:H}n&&x&&ce(n.firstChild);for(var a=pe(I?e:n);r=a.nextNode();)3===r.nodeType&&r===i||he(r)||(r.content instanceof F&&fe(r.content),ge(r),i=r);if(i=null,I)return e;if(E){if(S)for(s=K.call(n.ownerDocument);n.firstChild;)s.appendChild(n.firstChild);else s=n;return s=te?z.call(l,s,!0):s}t=T?n.outerHTML:n.innerHTML;return v&&(t=we(t,p," "),t=we(t,h," ")),d&&C?d.createHTML(t):t},c.setConfig=function(e){le(e),k=!0},c.clearConfig=function(){N=null,k=!1},c.isValidAttribute=function(e,t,r){N||le({});e=Se(e),t=Se(t);return me(e,t,r)},c.addHook=function(e,t){"function"==typeof t&&(n[e]=n[e]||[],xe(n[e],t))},c.removeHook=function(e){n[e]&&ke(n[e])},c.removeHooks=function(e){n[e]&&(n[e]=[])},c.removeAllHooks=function(){n={}}}else c.isSupported=!1;return c}()}),pxt=pxt||{},(c=>{var e;{var u=c.analytics||(c.analytics={});let a={},o={},r=!1,l;function i(t){Object.keys(t).forEach(e=>{"string"==typeof t[e]?a[e]=t[e]:o[e]=t[e]})}(e=l=u.ConsoleTickOptions||(u.ConsoleTickOptions={}))[e.Off=0]="Off",e[e.Short=1]="Short",e[e.Verbose=2]="Verbose",u.consoleTicks=l.Off,u.addDefaultProperties=i,u.enable=function(t){if(c.aiTrackException&&c.aiTrackEvent&&!r){r=!0,i({lang:t="string"==typeof t&&0!=t.length?t:"en"}),c.debug("setting up app insights");let s=c.tickEvent,n=(c.tickEvent=function(e,n,t){var r,i;if(n=c.Util.cleanData(n),u.consoleTicks!=l.Off&&(r=u.consoleTicks==l.Short?"":(new Date).toLocaleTimeString(void 0,{hour12:!1})+" - Tick - ",i=`${e} ${n?JSON.stringify(n):"<no data>"} `+(t?JSON.stringify(t):"<no opts>"),c.log(r+i)),s&&s(e,n,t),null!=t&&t.interactiveConsent&&c.setInteractiveConsent(!0),n){let t=Object.assign({},a),r=Object.assign({},o);Object.keys(n).forEach(e=>{"string"==typeof n[e]?t[e]=n[e]:"number"==typeof n[e]?r[e]=n[e]:t[e]=JSON.stringify(n[e]||"")}),c.aiTrackEvent(e,t,r)}else c.aiTrackEvent(e)},c.reportException),e=(c.reportException=function(e,t){t=c.Util.cleanData(t),n&&n(e,t);var r={target:c.appTarget.id,version:c.appTarget.versions.target};t&&c.Util.jsonMergeFrom(r,t),c.aiTrackException(e,"exception",r)},c.reportError);c.reportError=function(t,r,n){n=c.Util.cleanData(n),e&&e(t,r,n);try{throw r}catch(e){t={target:c.appTarget.id,version:c.appTarget.versions.target,category:t,message:r};n&&c.Util.jsonMergeFrom(t,n),c.aiTrackException(e,"error",t)}}}},u.trackPerformanceReport=function(){var e,t;c.perf.perfReportLogged||(e=c.perf.report())&&({durations:e,milestones:t}=e,c.tickEvent("performance.milestones",t),c.tickEvent("performance.durations",e))}}})(pxt=pxt||{}),pxt=pxt||{},(e=>{{e=e.AudioContextManager||(e.AudioContextManager={});let r=0,n,i,s,a=!1;function o(){return n=n||(()=>{if(window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext)try{return new window.AudioContext}catch(e){}})()}function t(){n&&(s.gain.setTargetAtTime(0,n.currentTime,.015),r=0)}e.mute=function(e){n&&(a=e,t(),e)&&i&&(i.disconnect(),s.disconnect(),i=void 0,s=void 0)},e.stop=t,e.frequency=function(){return r},e.tone=function(e){if(!a&&!(isNaN(e)||e<0)){r=e;var t=o();if(t)try{i||((i=t.createOscillator()).type="triangle",(s=t.createGain()).gain.value=0,s.connect(t.destination),i.connect(s),i.start(0)),i.frequency.linearRampToValueAtTime(e,n.currentTime),s.gain.setTargetAtTime(.2,n.currentTime,.015)}catch(e){i=void 0}}}}})(pxt=pxt||{}),(h=>{{var m=h.auth||(h.auth={});let l="auth",c="csrf-token",u="login-state",r="user-state",d="interactive-login-until",t=!1;m.DEFAULT_USER_PREFERENCES=()=>({language:h.appTarget.appTheme.defaultLocale,highContrast:!1,accessibleBlocks:!1,colorThemeIds:{},reader:"",skillmap:{mapProgress:{},completedTags:{}},email:!1});let e,a=(m.client=function(){if(!t)return e},0),o=0;async function g(e,t){return t?h.storage.shared.setAsync(l,e,t):h.storage.shared.delAsync(l,e)}async function s(e){try{return await h.storage.shared.getAsync(l,e)}catch(e){}}async function n(){var e=await s(c);return m.cachedHasAuthToken=!!e,e}async function i(){return!!await n()}async function f(){return m.cachedHasAuthToken=!1,g(c,void 0)}async function _(){let t;try{t=await h.storage.shared.getAsync(l,r)}catch(e){t={}}return m.cachedUserState=t}async function y(e){return m.cachedUserState=Object.assign({},e),h.storage.shared.setAsync(l,r,e)}async function b(){return m.cachedUserState=void 0,h.storage.shared.delAsync(l,r)}async function v(e){var t={};return(e=e||await n())&&(t.authorization="mkcd "+e),t["x-pxt-target"]=null==(e=h.appTarget)?void 0:e.id,t}m.cachedHasAuthToken=!1,m.getAuthTokenAsync=n,m.hasAuthTokenAsync=i,m.getUserStateAsync=_,m.getAuthHeadersAsync=v;class E{constructor(){this.initialUserPreferences_=void 0,this.initialAuthCheck_=void 0,this.patchQueue=[],e=this}async initAsync(){var e=await _();this.setUserProfileAsync(null==e?void 0:e.profile),this.setUserPreferencesAsync(null==e?void 0:e.preferences)}async loginAsync(e,t,r=void 0){if(k()&&(n=e,0<T().filter(e=>e.id===n).length)){r=null!=r?r:p,this.clearAuthStateAsync();var n,r={key:(Math.PI*Math.random()).toString(36).slice(2),callbackState:r,callbackPathname:window.location.pathname,idp:e,persistent:t},i=(parseInt(await s(d))||0)>Date.now(),t=h.Util.stringifyQueryString("/api/auth/login",{response_type:"token",provider:e,persistent:t,redirect_uri:""+window.location.origin+window.location.pathname+"?authcallback=1&state="+r.key,prompt:i?"select_account":"silent"}),i=await this.apiAsync(t);if(i.success)r.authCodeVerifier=i.resp.authCodeVerifier,await h.storage.shared.setAsync(l,u,r),h.tickEvent("auth.login.start",{provider:e}),window.location.href=i.resp.loginUrl;else try{await this.onSignInFailed()}catch(e){}}}async logoutAsync(e){if(k()){await E.staticLogoutAsync(e);try{await this.onStateCleared()}catch(e){}try{await this.onSignedOut()}catch(e){}}}static async staticLogoutAsync(t){if(k()){h.tickEvent("auth.logout"),await g(d,(Date.now()+6e4).toString()),t=t?t.startsWith("#")?t:"#"+t:"";t=""+window.location.origin+window.location.pathname+window.location.search+t;let e="";try{var r=h.Util.stringifyQueryString("/api/auth/logout",{redirect_uri:t,authcallback:"1"}),n=await E.staticApiAsync(r);n.success&&(e=n.resp.logoutUrl)}catch(e){}await f(),await b(),h.BrowserUtils.hasWindow()&&(e?window.location.href=e:(window.location.href=t,location.reload()))}}async deleteProfileAsync(){if(await this.loggedInAsync()){var e=await _(),e=null==(e=null==e?void 0:e.profile)?void 0:e.id,t=await this.apiAsync("/api/user",null,"DELETE");if(t.err)try{await this.onApiError(t.err)}catch(e){}else try{await this.clearAuthStateAsync();try{await this.onProfileDeleted(e)}catch(e){}}finally{h.tickEvent("auth.profile.deleted")}}}async initialUserPreferencesAsync(){if(await this.loggedInAsync())return this.initialUserPreferences_||(this.initialUserPreferences_=this.fetchUserPreferencesAsync()),this.initialUserPreferences_}async userProfileAsync(){var e;if(await this.loggedInAsync())return e=await _(),Object.assign({},e.profile)}async userPreferencesAsync(){var e=await _();return Object.assign({},e.preferences)}async authCheckAsync(){var e,t;if(k()&&await i())return null!=(e=null==(t=await _())?void 0:t.profile)&&e.id?this.initialAuthCheck_||(this.initialAuthCheck_=Promise.resolve(t.profile)):this.initialAuthCheck_||(this.initialAuthCheck_=this.fetchUserAsync()),this.initialAuthCheck_}async loggedInAsync(){return!!await this.authCheckAsync()&&this.hasUserIdAsync()}async updateUserProfileAsync(e){var t;return!!await this.loggedInAsync()&&(t=await _(),(t=await this.apiAsync("/api/user/profile",{id:t.profile.id,username:e.username,avatarUrl:e.avatarUrl})).success&&await this.setUserProfileAsync(t.resp),t.success)}async patchUserPreferencesAsync(e,t={}){let n=async()=>({success:!0,res:await this.userPreferencesAsync()});if(!(e=(e=Array.isArray(e)?e:[e]).filter(e=>!!e)).length)return n();let i=(e,t,r)=>{var n=h.U.deepCopy(e);ts.pxtc.jsonPatch.patchInPlace(n,t);let i=ts.pxtc.jsonPatch.diff(e,n);return i=i.length&&r?i.filter(r):i};var r=await this.userPreferencesAsync(),s=i(r,e,t.filter);if(!s.length)return n();if(ts.pxtc.jsonPatch.patchInPlace(r,s),await this.setUserPreferencesAsync(r),!await this.loggedInAsync())return n();this.patchQueue.push({ops:e,filter:t.filter}),clearTimeout(a);s=async()=>{if(o=0,!this.patchQueue.length)return n();var e=await this.apiAsync("/api/user/preferences");if(!e.success)return h.reportError("identity","failed to fetch preferences for patch",e),{success:!1,res:void 0};let t=h.U.deepCopy(e.resp)||m.DEFAULT_USER_PREFERENCES();var r=this.patchQueue,r=(this.patchQueue=[],r.forEach(e=>{e=i(t,e.ops,e.filter);ts.pxtc.jsonPatch.patchInPlace(t,e)}),pxtc.jsonPatch.diff(e.resp,t)),e=await this.apiAsync("/api/user/preferences",r,"PATCH");return e.success?this.setUserPreferencesAsync(e.resp):h.reportError("identity","failed to patch preferences",e),{success:e.success,res:e.resp}};return t.immediate||(o=o||h.U.now(),1e4<h.U.now()-o)?s():(a=setTimeout(s,1e3),{success:!1,res:void 0})}async hasUserIdAsync(){var e;return!!k()&&(await i()?!(null==(e=null==(e=await _())?void 0:e.profile)||!e.id):void 0)}async fetchUserAsync(){var e,t;if(k()&&await i())return null!=(e=null==(t=await _())?void 0:t.profile)&&e.id?t.profile:(e=await this.apiAsync("/api/user/profile")).success?(t=e.resp,await this.setUserProfileAsync(t),t):void 0}async setUserProfileAsync(e){var t=await this.hasUserIdAsync(),e=(await this.transformUserProfileAsync(e),await this.hasUserIdAsync());try{await this.onUserProfileChanged()}catch(e){}if(e&&!t)try{await this.onSignedIn()}catch(e){}else if(!e&&t)try{await this.onSignedOut()}catch(e){}}async setUserPreferencesAsync(e){var t=await _(),t=null!=(t=null==t?void 0:t.preferences)?t:m.DEFAULT_USER_PREFERENCES(),r=ts.pxtc.jsonPatch.diff(t,e),t=await this.transformUserPreferencesAsync(Object.assign(Object.assign({},t),e));try{await this.onUserPreferencesChanged(r)}catch(e){}return t}async fetchUserPreferencesAsync(){if(await this.loggedInAsync()){await _();var e=await this.apiAsync("/api/user/preferences");if(e.success)if(e.resp)return this.setUserPreferencesAsync(e.resp)}}async transformUserProfileAsync(e){var t=await _();return await y(t=Object.assign(Object.assign({},t),{profile:Object.assign({},e)})),t.profile}async transformUserPreferencesAsync(e){var t=await _();return await y(t=Object.assign(Object.assign({},t),{preferences:Object.assign({},e)})),t.preferences}async clearAuthStateAsync(){await f(),await b();try{await this.onStateCleared()}catch(e){}}async apiAsync(e,t,r,n){return E.staticApiAsync(e,t,r,n)}static async staticApiAsync(t,e,r,n){n=await v(n);return t=h.BrowserUtils.isLocalHostDev()?""+h.cloud.DEV_BACKEND+t:t,h.Util.requestAsync({url:t,headers:n,data:e,method:r||(e?"POST":"GET"),withCredentials:!0}).then(e=>({statusCode:e.statusCode,resp:e.json,success:2===Math.floor(e.statusCode/100),err:null})).catch(async e=>(/logout/.test(t)||401!=e.statusCode||await E.staticLogoutAsync(),{statusCode:e.statusCode,err:e,resp:null,success:!1}))}}m.AuthClient=E;let p={hash:"",params:{}};function T(){var e;return Object.keys((null==(e=null==(e=h.appTarget)?void 0:e.cloud)?void 0:e.cloudProviders)||{}).map(e=>h.appTarget.cloud.cloudProviders[e]).filter(e=>e.identity).sort((e,t)=>e.order-t.order)}function k(){return!t&&!h.BrowserUtils.isPxtElectron()&&0<T().length}function x(e,t){return e.id===t.id&&e.sourceURL===t.sourceURL}m.loginCallbackAsync=async function(e){let t,r=Object.assign({},p);do{if(!(t=await h.storage.shared.getAsync(l,u)))return void h.debug("Auth state not found in storge.");await h.storage.shared.delAsync(l,u);var n=e.state;if(!n||t.key!==n)return void h.debug("Failed to get auth state for key");r=Object.assign(Object.assign({},p),t.callbackState);n=e.error;if(n){var i=e.error_description;h.tickEvent("auth.login.error",{error:n,provider:t.idp}),h.log(`Auth failed: ${n}:`+i),r=Object.assign({},p);break}n=e.token;if(!n){h.debug("Missing authToken in auth callback.");break}t.authCodeVerifier&&(i=h.Util.stringifyQueryString("/api/otac/check",{persistent:t.persistent}),await E.staticApiAsync(i,null,null,t.authCodeVerifier)),n=n,m.cachedHasAuthToken=!!n,await g(c,n),await g(d,void 0),h.tickEvent("auth.login.success",{provider:t.idp})}while(0);var s=r.hash.startsWith("#")?r.hash:"#"+r.hash,a=h.Util.stringifyQueryString("",r.params),o=t.callbackPathname.startsWith("/")?t.callbackPathname:"/"+t.callbackPathname;window.location.href=""+o+a+s},m.identityProviders=T,m.identityProvider=function(t){return T().filter(e=>e.id===t).shift()},m.hasIdentity=k,m.enableAuth=function(e=!0){t=!e},m.userName=function(e){var t;return null!=(e=null!=(t=null==(t=null==e?void 0:e.idp)?void 0:t.displayName)?t:null==(t=null==e?void 0:e.idp)?void 0:t.username)?e:"??"},m.identityProviderId=function(e){return null==(e=null==e?void 0:e.idp)?void 0:e.provider},m.firstName=function(e){return(null==(e=h.auth.userName(e))?void 0:e.split(" ").shift())||e},m.userInitials=function(e){return e=h.auth.userName(e),ts.pxtc.Util.initials(e)},m.generateUserProfilePicDataUrl=function(e){if(null!=(t=null==(t=null==e?void 0:e.idp)?void 0:t.picture)&&t.encoded){var t=window.URL||window.webkitURL;try{var r=h.Util.stringToUint8Array(atob(e.idp.picture.encoded)),n=new Blob([r],{type:e.idp.picture.mimeType});e.idp.picture.dataUrl=t.createObjectURL(n)}catch(e){}}},m.badgeEquals=x,m.hasBadge=function(e,t){return e.badges.some(e=>x(e,t))}}})(pxt=pxt||{}),(pxt||(pxt={})).tickEvent=function(e){},(e=>{let t;var r;(r=t=e.LogLevel||(e.LogLevel={}))[r.Debug=0]="Debug",r[r.Info=1]="Info",r[r.Log=1]="Log",r[r.Warning=2]="Warning",r[r.Error=3]="Error";class n{constructor(){this.setLogLevel(t.Info)}setLogLevel(e){this.logLevel=e}getLogLevel(){return this.logLevel}info(...e){this.shouldLog(t.Info)&&null!=console&&console.info&&console.info.call(null,...e)}log(...e){this.shouldLog(t.Log)&&null!=console&&console.log&&console.log.call(null,...e)}debug(...e){this.shouldLog(t.Debug)&&null!=console&&console.debug&&console.debug.call(null,...e)}error(...e){this.shouldLog(t.Error)&&null!=console&&console.error&&console.error.call(null,...e)}warn(...e){this.shouldLog(t.Warning)&&null!=console&&console.warn&&console.warn.call(null,...e)}shouldLog(e){return e>=this.logLevel}}let i=new(e.ConsoleLogger=n);e.info=function(...e){i.info(...e)},e.log=function(...e){i.log(...e)},e.debug=function(...e){i.debug(...e)},e.error=function(...e){i.error(...e)},e.warn=function(...e){i.warn(...e)},e.setLogger=function(e){var t=null==i?void 0:i.getLogLevel();i=e,void 0!==t&&i.setLogLevel(t)},e.setLogLevel=function(e){i.setLogLevel(e)}})(pxt=pxt||{}),(e=>{(e.pxtc||(e.pxtc={})).__dummy=42})(ts=ts||{}),ts.pxtc),ts,pxt,pxt,pxt,pxt,pxt,pxt,Measurements,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,ts,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxt,ts,pxt,pxt,pxt,pxt,ts,pxt,ts,pxtmelody,pxtmelody,pxtmelody,pxt,pxt,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,pxt,pxt,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,ts,pxt,pxt,pxt,pxt,pxt,pxt,pxt,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim,pxsim;(s=>{s=s.pxtc||(s.pxtc={});{var l=s.Util||(s.Util={});function a(e){return e.replace(/[^\w .!?\-$]/g,e=>{e=e.charCodeAt(0).toString(16);return"\\u"+"0000".substr(0,4-e.length)+e})}l.assert=function(e,t="Assertion failed"){if(!e)throw new Error(t)},l.flatClone=function(t){if(null==t)return null;let r={};return Object.keys(t).forEach(e=>{r[e]=t[e]}),r},l.clone=function(e){return null==e?null:JSON.parse(JSON.stringify(e))},l.htmlEscape=function(e){return e&&e.replace(/([^\w .!?\-$])/g,e=>"&#"+e.charCodeAt(0)+";")},l.htmlUnescape=function(e){return e&&e.replace(/(&#\d+;)/g,e=>String.fromCharCode(Number(e.substr(2,e.length-3))))},l.jsStringQuote=a,l.jsStringLiteral=function(e){return'"'+a(e)+'"'};let t="en",r={},e={},n=!(l.initials=function(e){return(/^\w+@/.test(e)?e.match(/^\w\w/).shift():((e=e.match(/\b\w/g)||[]).shift()||"")+(e.pop()||"")).toUpperCase()});function o(){return t}function c(e){var t=/^(\w{2,3})-(\w{2,4}$)/i.exec(e);return t&&t[1]&&t[2]?[t[1].toLowerCase()+"-"+t[2].toUpperCase(),t[1].toLowerCase(),t[1].toLowerCase()+"-"+t[2].toLowerCase()]:[(e||"en").toLowerCase()]}function u(e,o){return 0==o.length?e:e.replace(/\{([0-9]+)(\:[^\}]+)?\}/g,function(e,r,t){r=o[parseInt(r)];let n="";var i=/^:f(\d*)\.(\d+)/.exec(t);if(i){var s=parseInt(i[2]);let e=parseInt(i[1])||0;var a=/^0/.test(i[1])?"0":" ";let t=r.toFixed(s);if(0<e&&0<s&&(e+=s+1),0<e)for(;t.length<e;)t=a+t;n=t}else n=":x"==t?"0x"+r.toString(16):void 0===r?"(undef)":null===r?"(null)":r.toString?r.toString():r+"";return":a"==t?/^\s*[euioah]/.test(n.toLowerCase())?n="an "+n:/^\s*[bcdfgjklmnpqrstvwxz]/.test(n.toLowerCase())&&(n="a "+n):":s"==t?n=1==r?"":"s":":q"==t?n=l.htmlEscape(n):":jq"==t?n=l.jsStringQuote(n):":uri"==t?n=encodeURIComponent(n).replace(/'/g,"%27").replace(/"/g,"%22"):":url"==t?n=encodeURI(n).replace(/'/g,"%27").replace(/"/g,"%22"):":%"==t&&(n=(100*r).toFixed(1).toString()+"%"),n})}l.enableLiveLocalizationUpdates=function(){n=!0},l.liveLocalizationEnabled=function(){return n},l.localeInfo=function(){return(n?"live-":"")+t},l.userLanguage=o,l.normalizeLanguageCode=c,l.setUserLanguage=function(e){t=c(e)[0]},l.isUserLanguageRtl=function(){return/^ar|dv|fa|ha|he|ks|ku|ps|ur|yi/i.test(t)},l.TRANSLATION_LOCALE="pxt",l.isTranslationMode=function(){return t==l.TRANSLATION_LOCALE},l._localize=function(e){return r[e]||e},l.getLocalizedStrings=function(){return r},l.setLocalizedStrings=function(e){r=e},l.translationsCache=function(){return e},l.fmt_va=u,l.fmt=function(e,...t){return u(e,t)};let i={};function d(e,t){if(!e)return e;i[e]=(i[e]||0)+1;let r=l._localize(e);return u(r=r.replace(/^\{(id|loc):[^\}]+\}/g,""),t)}l.dumpLocStats=function(){let t={};Object.keys(i).sort((e,t)=>i[t]-i[e]).forEach(e=>t[e]=e),pxt.log("prioritized list of strings:"),pxt.log(JSON.stringify(t,null,2))},l.lf_va=d,l.lf=function(e,...t){return d(e,t)},l.rlf=function(e,...t){return d(e,t)},l.lookup=function(e,t){return e.hasOwnProperty(t)?e[t]:null},l.isoTime=function(e){return e=new Date(1e3*e),l.fmt("{0}-{1:f02.0}-{2:f02.0} {3:f02.0}:{4:f02.0}:{5:f02.0}",e.getFullYear(),e.getMonth()+1,e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds())},l.userError=function(e){throw(e=new Error(e)).isUserError=!0,e},l.deq=function t(r,n){if(r!==n){if(!r||!n)return"Null value";if("object"!=typeof r||"object"!=typeof n)return"Unable to compare "+r+", "+n;if(Array.isArray(r)){if(!Array.isArray(n))return"Expected array";if(r.length!=n.length)return"Expected array of length "+r.length+", got "+n.length;for(let e=0;e<r.length;e++)if(null!=t(r[e],n[e]))return"Expected array value "+r[e]+" got "+n[e]}else{var i=Object.keys(r),e=Object.keys(r);if(i.length!=e.length)return"Expected "+i.length+" keys, got "+e.length;for(let e=0;e<i.length;e++){if(!Object.prototype.hasOwnProperty.call(n,i[e]))return"Missing key "+i[e];if(null!=t(r[i[e]],n[i[e]]))return"Expected value of "+i[e]+" to be "+r[i[e]]+", got "+n[i[e]]}}}return null},l.deepEqual=function t(r,n){if(r===n)return!0;if(r&&n&&"object"==typeof r&&"object"==typeof n){var e,i=Array.isArray(r),s=Array.isArray(n);if(i&&s){if(r.length!==n.length)return!1;for(let e=0;e<r.length;++e)if(!t(r[e],n[e]))return!1}else{if(i!==s)return!1;if((i=Object.keys(r)).length!==Object.keys(n).length)return!1;for(e of i){if(!n.hasOwnProperty(e))return!1;if(!t(r[e],n[e]))return!1}}return!0}return r!=r&&n!=n}}})(ts=ts||{});let lf=ts.pxtc.Util.lf,getCellId=((e=>{(e=e.pxtc||(e.pxtc={})).decodeBase64=function(e){return atob(e)},e.encodeBase64=function(e){return btoa(e)}})(ts=ts||{}),(a=>{var e,u=a.pxtc||(a.pxtc={});{var m=u.Util||(u.Util={});function n(t,r){if(r)for(let e=0;e<r.length;++e)t.push(r[e])}function r(t){var r=[];for(let e=0;e<t.length;++e)n(r,t[e]);return r}function i(e){return e&&"object"==typeof e&&!Array.isArray(e)}function o(t,r,n,i,s){void 0===i&&(i=0),void 0===s&&(s=n.length-i);for(let e=0;e<s;++e)t[r+e]=n[i+e]}function s(e,t){return e==t?0:e<t?-1:1}m.CancellationToken=class{constructor(){this.pending=!1,this.cancelled=!1}startOperation(){this.pending=!0}isRunning(){return this.pending}onProgress(e){this.progressHandler=e}reportProgress(e,t){this.progressHandler&&this.progressHandler(e,t)}cancel(){this.cancelled=!0,this.pending=!1}cancelAsync(){return this.cancelled||!this.pending?(this.cancelled=!0,this.pending=!1,Promise.resolve()):(this.cancelled=!0,this.deferred=new Promise(e=>{this.resolve=e}),this.deferred)}isCancelled(){return this.cancelled}throwIfCancelled(){if(this.isCancelled())throw new Error}resolveCancel(){this.pending=!1,this.deferred&&(this.resolve(),this.deferred=void 0,this.resolve=void 0)}},m.codalHash16=function(e){let i=[251,175,119,215,81,14,79,191,103,49,181,143,186,157,0,232,31,32,55,60,152,58,17,237,174,70,160,144,220,90,57,223,59,3,18,140,111,166,203,196,134,243,124,95,222,179,197,65,180,48,36,15,107,46,233,130,165,30,123,161,209,23,97,16,40,91,219,61,100,10,210,109,250,127,22,138,29,108,244,67,207,9,178,204,74,98,126,249,167,116,34,77,193,200,121,5,20,113,71,35,128,13,182,94,25,226,227,199,75,27,41,245,230,224,43,225,177,26,155,150,212,142,218,115,241,73,88,105,39,114,62,255,192,201,145,214,168,158,221,148,154,122,12,84,82,163,44,139,228,236,205,242,217,11,187,146,159,64,86,239,195,42,106,198,118,112,184,172,87,2,173,117,176,229,247,253,137,185,99,164,102,147,45,66,231,52,141,211,194,206,246,238,56,110,78,248,63,240,189,93,92,51,53,183,19,171,72,50,33,104,101,69,8,252,83,120,76,135,85,54,202,125,188,213,96,235,136,208,162,129,190,132,156,38,47,1,7,254,24,4,216,131,89,21,28,133,37,153,149,80,170,68,6,169,234,151];if(e){var r=e;var n=2;var s,a=new Uint8Array(r.length);for(let e=0;e<r.length;++e){var o=r.charCodeAt(e);a[e]=255&o}let t=0;for(let e=0;e<n;++e)s=(t=>{let r=0;for(let e=0;e<t.length;e++){var n=t[e];r=i[r^n]}return r})(a),t|=s<<8*e,a[0]=(a[0]+1)%255;return t}return 0},m.bufferSerial=function(t,r="",n="?",i=255){for(let e=0;e<r.length;++e){var s=r[e];t[n]=(t[n]||"")+s,("\n"===s||t[n].length>i)&&(s=t[n],t[n]="",window.postMessage({type:"serial",id:n,data:s},"*"))}},m.blobReadAsDataURL=function(n){return n?new Promise((e,t)=>{let r=new FileReader;r.onload=()=>e(r.result),r.onerror=e=>t(e),r.readAsDataURL(n)}):Promise.resolve(void 0)},m.fileReadAsBufferAsync=function(n){return n?new Promise((t,e)=>{let r=new FileReader;r.onerror=e=>t(null),r.onload=e=>t(new Uint8Array(r.result)),r.readAsArrayBuffer(n)}):Promise.resolve(null)},m.fileReadAsTextAsync=function(n){return n?new Promise((t,e)=>{let r=new FileReader;r.onerror=e=>t(null),r.onload=e=>t(r.result),r.readAsText(n)}):Promise.resolve(null)},m.sanitizeFileName=function(e){return e.replace(/[()\\\/.,?*^:<>!;'#$%^&|"@+={}\[\]~`\x00-\x1F]/g,"").trim().replace(/\s+/g,"-")},m.repeatMap=function(t,r){t=t||0;var n=[];for(let e=0;e<t;++e)n.push(r(e));return n},m.listsEqual=function(t,r){if(!t||!r||t.length!==r.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==r[e])return!1;return!0},m.oops=function(e="OOPS"){throw new Error(e)},m.reversed=function(e){return(e=e.slice(0)).reverse(),e},m.arrayEquals=function(t,r,n=(e,t)=>e===t){if(t!=r){if(!t&&r||!r&&t||t.length!==r.length)return!1;for(let e=0;e<t.length;e++)if(!n(t[e],r[e]))return!1}return!0},m.iterMap=function(t,r){Object.keys(t).forEach(e=>r(e,t[e]))},m.mapMap=function(t,r){let n={};return Object.keys(t).forEach(e=>n[e]=r(e,t[e])),n},m.values=function(t){return Object.keys(t||{}).map(e=>t[e])},m.pushRange=n,m.concatArrayLike=r,m.concat=r,m.memcpy=o,m.uint8ArrayConcat=function(e){let t=0;for(var r of e)t+=r.length;var n,i=new Uint8Array(t);let s=0;for(n of e)o(i,s,n),s+=n.length;return i},m.jsonTryParse=function(e){try{return JSON.parse(e)}catch(e){}},m.jsonMergeFrom=function t(r,n){n&&Object.keys(n).forEach(e=>{i(r[e])&&i(n[e])?t(r[e],n[e]):r[e]=m.clone(n[e])})},m.jsonCopyFrom=function(e,t){var r,n=m.clone(t);for(r of Object.keys(t))e[r]=n[r]},m.jsonFlatten=function(e){let n={},i=(e,t)=>{if(null!==t&&"object"==typeof t){m.assert(!Array.isArray(t)),e&&(e+=".");for(var r of Object.keys(t))i(e+r,t[r])}else n[e]=t};return i("",e),n},m.jsonUnFlatten=function(r){var n,e={};for(n of Object.keys(r)){let t=e;var i=n.split(".");for(let e=0;e<i.length;++e){var s=i[e];e==i.length-1?t[s]=r[n]:("object"!=typeof t[s]&&(t[s]={}),t=t[s])}}return e},m.strcmp=s,m.stringMapEq=function(e,t){var r,n=Object.keys(e),i=Object.keys(t);if(n.length!=i.length)return!1;for(r of n){if(!t.hasOwnProperty(r))return!1;if(e[r]!==t[r])return!1}return!0},m.endsWith=function(e,t){return!(e.length<t.length||0!=t.length&&e.slice(-t.length)!=t)},m.startsWith=function(e,t){return!(e.length<t.length||0!=t.length&&e.slice(0,t.length)!=t)},m.contains=function(e,t){return!(e.length<t.length)&&(0==t.length||-1<e.indexOf(t))},m.replaceAll=function(e,t,r){return t?e.split(t).join(r):e},m.snakify=function(r){let n=r.toUpperCase(),t=r.toLowerCase();if(r==n||r==t)return r;if(0<r.lastIndexOf("_"))return r;var i,s=e=>r[e]!=t[e];let a="",o=0;for(;o<r.length;){let e=s(o),t=o;for(;t<r.length;){if(e&&(i=t,r[i]!=n[i])){if(2<t-o){t--;break}e=!1}if(!e&&s(t))break;t++}a&&(a+="_"),a+=r.slice(o,t),o=t}return a.toUpperCase()===a?a:a.toLowerCase()},m.sortObjectFields=function(t){var e=Object.keys(t);e.sort(s);let r={};return e.forEach(e=>r[e]=t[e]),r},m.chopArray=function(t,r){var n=[];for(let e=0;e<t.length;e+=r)n.push(t.slice(e,e+r));return n},m.unique=function(e,r){let n=[],i={};return e.forEach(e=>{var t=r(e);i.hasOwnProperty(t)||(i[t]=null,n.push(e))}),n},m.groupBy=function(e,r){let n={};return e.forEach(e=>{var t=r(e);n.hasOwnProperty(t)||(n[t]=[]),n[t].push(e)}),n},m.toDictionary=function(e,t){let r={};return e.forEach(e=>{r[t(e)]=e}),r},m.toSet=function(e,t){let r={};return e.forEach(e=>{r[t(e)]=!0}),r},m.deepCopy=function e(t){if("object"!=typeof t||null===t)return t;var r,n=Array.isArray(t)?[]:{};for(r in t){var i=t[r];n[r]=e(i)}return n},m.toArray=function(t){if(Array.isArray(t))return t;var r=[];if(t)for(let e=0;e<t.length;++e)r.push(t[e]);return r},m.indexOfMatching=function(t,r){for(let e=0;e<t.length;++e)if(r(t[e]))return e;return-1};let t=Promise.resolve();async function l(t,r,n){let i=0;var s=[];let a=[];for(let e=0;e<t;e++){var o=(async()=>{for(;i<r.length;){var e=i++,t=r[e];a[e]=await n(t)}})();s.push(o)}try{await Promise.all(s)}catch(e){throw i=r.length,e}return a}function d(r,n){let i={};return e=>{var t=r(e);return i.hasOwnProperty(t)?i[t]:i[t]=n(e)}}function p(e){return e=e&&e.replace(/\\/g,"/")}function h(r){let n={url:""+encodeURI(r.url.replace(/[?#].*/,"...")),method:""+(r.method||"GET")};return pxt.perf.measureStart(Measurements.NetworkRequest),m.httpRequestCoreAsync(r).then(e=>{var t=e.statusCode;return(r.successCodes||[304,200,201,202]).indexOf(t)<0&&!r.allowHttpErrors?(t=m.lf("Bad HTTP status code: {0} at {1}; message: {2}",e.statusCode,r.url,(e.text||"").slice(0,500)),(t=new Error(t)).statusCode=e.statusCode,Promise.reject(t)):(e.text&&/application\/json/.test(e.headers["content-type"])&&(e.json=u.U.jsonTryParse(e.text)),e)}).then(e=>{var t=e.headers["content-length"];return t?n.sizeInBytes=""+t:e.text&&pxt.perf.isEnabled()&&(t=(new TextEncoder).encode(e.text),n.sizeInBytes=t.length+""),n.statusCode=""+e.statusCode,e}).finally(()=>{pxt.perf.measureEnd(Measurements.NetworkRequest,n)})}function g(r,n){let i="";if(r)for(let t=0;t<r.length;++t){let e=r.charCodeAt(t);var s;e<=127?i+=r.charAt(t):e<=2047?i+=String.fromCharCode(192|e>>6,128|63&e):(!n&&55296<=e&&e<=56319&&(s=r.charCodeAt(++t),isNaN(s)||(e=65536+(e-55296<<10)+(s-56320))),e<=65535?i+=String.fromCharCode(224|e>>12,128|e>>6&63,128|63&e):i+=String.fromCharCode(240|e>>18,128|e>>12&63,128|e>>6&63,128|63&e))}return i}function f(){return Date.now()}function _(){var e=new Uint8Array(4);return m.getRandomBuf(e),new Uint32Array(e.buffer)[0]}function y(i,s,a){function t(r){pxt.debug(`downloading translations for ${i} `+s);var e=pxt.BrowserUtils.isLocalHost()||pxt.webConfig.isStatic?"https://makecode.com/api/":"";let t=e+`translations?lang=${encodeURIComponent(i)}&filename=${encodeURIComponent(s)}&approved=true`;var n={};return a&&!pxt.Cloud.useCdnApi()&&(n["If-None-Match"]=a),(e?h:pxt.Cloud.apiRequestWithCdnAsync)({url:t,headers:n}).then(t=>304==t.statusCode||200==t.statusCode?(a=t.headers.etag||"",pxt.BrowserUtils.translationDbAsync().then(e=>e.setAsync(i,s,a,t.json||r)).then(()=>t.json||r)):t.json,e=>{pxt.log("failed to load translations from "+t)})}return pxt.BrowserUtils.translationDbAsync().then(e=>e.getAsync(i,s)).then(e=>e?(a=e.etag,300<(Date.now()-e.time)/1e3&&t(e.strings),e.strings):t())}function b(e){var[e,t]=m.normalizeLanguageCode(e),r=pxt.appTarget.appTheme;if(r&&r.availableLocales){if(-1<r.availableLocales.indexOf(e))return!0;if(t&&-1<r.availableLocales.indexOf(t))return!0}return!1}m.nextTick=function(e){t.then(e)},m.delay=async function(t,e){return e=await e,await new Promise(e=>setTimeout(()=>e(),t)),e},m.promiseMapAll=function(e,t){return Promise.all(e.map(e=>t(e)))},m.promiseMapAllSeries=function(e,t){return l(1,e,t)},m.promisePoolAsync=l,m.memoizeString=function(e){return d(e=>e,e)},m.promiseTimeout=async function(r,e,n){let i,s;var t=new Promise((e,t)=>{s=e,i=setTimeout(()=>{s=void 0,clearTimeout(i),t(n||`Promise timed out after ${r}ms`)},r)});return Promise.race([e,t]).then(e=>(s&&(clearTimeout(i),s()),e))},m.defer=function(){let n,r,i,e=!1;return{resolve:function(t){e?pxt.debug("Deferred promise already resolved"):(r?r(t):n=n||new Promise(function(e){e(t)}),e=!0)},reject:function(r){e?pxt.debug("Deferred promise already resolved"):(i?i(r):n=n||new Promise(function(e,t){t(r)}),e=!0)},promise:new Promise(function(e,t){n?e(n):(r=e,i=t)})}},m.memoize=d,m.debounce=function(n,i,s){let a;return function(){let e=this,t=arguments;var r=s&&!a;return clearTimeout(a),a=setTimeout(function(){a=null,s||n.apply(e,t)},i),r&&n.apply(e,t),a}},m.AdaptiveDebouncer=class{constructor(e,t=300,r=2e3,n=2){this.func=e,this.minDelay=t,this.maxDelay=r,this.slowdownFactor=n,this.lastPoke=0,this.recentGaps=[],this.wrapped=()=>{this.timeout=null,this.func()}}poke(){var e=Date.now();if(this.lastPoke){var t=e-this.lastPoke;if(t<10)return;for(t<4e3&&this.recentGaps.push(t);10<this.recentGaps.length;)this.recentGaps.shift()}this.lastPoke=e}trigger(){let e=this.maxDelay;var t;this.lastPoke&&((t=this.recentGaps.slice()).sort(),t=t[t.length>>1]||1,e=Math.min(Math.max(t*this.slowdownFactor|0,this.minDelay),this.maxDelay),t=Date.now()-this.lastPoke,(e-=t)<0&&(e=0),this.lastPoke=null),clearTimeout(this.timeout),this.timeout=setTimeout(this.wrapped,e)}},m.throttle=function(n,i,s){let a;return function(){let e=this,t=arguments;var r=s&&!a;a=a||setTimeout(function(){a=null,s||n.apply(e,t)},i),r&&n.apply(e,t)}},m.randomPermute=function(t){for(let e=0;e<t.length;++e){var r=_()%t.length,n=t[e];t[e]=t[r],t[r]=n}},m.randomPick=function(e){return 0==e.length?null:e[_()%e.length]},m.timeSince=function(e){let t=(Date.now()-(e*=1e3))/1e3;return isNaN(t)?"":t<-30?(t=-t)<60?m.lf("in a few seconds"):t<120?m.lf("in a minute"):t<3600?m.lf("in {0} minute{0:s}",Math.floor(t/60)):t<7200?m.lf("in an hour"):t<86400?m.lf("in {0} hour{0:s}",Math.floor(t/60/60)):t<2592e3?m.lf("in {0} day{0:s}",Math.floor(t/60/60/24)):t<31536e3?m.lf("in {0} month{0:s}",Math.floor(t/60/60/24/30)):m.lf("in {0} year{0:s}",Math.floor(t/60/60/24/365)):t<0?m.lf("now"):t<10?m.lf("a few seconds ago"):t<60?m.lf("{0} second{0:s} ago",Math.floor(t)):t<120?m.lf("a minute ago"):t<3600?m.lf("{0} minute{0:s} ago",Math.floor(t/60)):t<7200?m.lf("an hour ago"):t<86400?m.lf("{0} hour{0:s} ago",Math.floor(t/60/60)):t<2592e3?m.lf("{0} day{0:s} ago",Math.floor(t/60/60/24)):t<31536e3?m.lf("{0} month{0:s} ago",Math.floor(t/60/60/24/30)):m.lf("{0} year{0:s} ago",Math.floor(t/60/60/24/365))},m.unicodeToChar=function(e){return e.replace(/\\u([\d\w]{4})/gi,function(e,t){return String.fromCharCode(parseInt(t,16))})},m.escapeForRegex=function(e){return null==e?void 0:e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},m.stripUrlProtocol=function(e){return null==e?void 0:e.replace(/.*?:\/\//g,"")},m.normalizePath=p,m.pathJoin=function(e,t){if(p(e),p(t),e||t)return e?t?("/"!==e.charAt(e.length-1)&&(e+="/"),e+(t="/"==t.charAt(0)?t.substring(1):t)):e:t},m.isNodeJS="undefined"==typeof window,m.requestAsync=h,m.httpGetTextAsync=function(e){return h({url:e}).then(e=>e.text)},m.httpGetJsonAsync=function(e){return h({url:e}).then(e=>e.json)},m.httpPostJsonAsync=function(e,t){return h({url:e,data:t||{}}).then(e=>e.json)},m.stringToUint8Array=function(t){var r=t.length,n=new Uint8Array(r);for(let e=0;e<r;++e)n[e]=255&t.charCodeAt(e);return n},m.uint8ArrayToString=function(t){var r=t.length;let n="";for(let e=0;e<r;++e)n+=String.fromCharCode(t[e]);return n},m.fromUTF8=function(t){if(!t)return"";let r="";for(let e=0;e<t.length;++e){var n=255&t.charCodeAt(e);r+=37==n||127<n?"%"+n.toString(16):t.charAt(e)}return decodeURIComponent(r)},m.toUTF8=g,m.toHex=function(t){let r="";for(let e=0;e<t.length;++e)r+=("0"+t[e].toString(16)).slice(-2);return r},m.fromHex=function(t){var r=new Uint8Array(t.length>>1);for(let e=0;e<t.length;e+=2)r[e>>1]=parseInt(t.slice(e,e+2),16);return r},m.PromiseQueue=class{constructor(){this.promises={}}enqueue(n,i){return new Promise((e,t)=>{let r=this.promises[n];(r=r||(this.promises[n]=[])).push(()=>i().finally(()=>{r.shift(),0==r.length?delete this.promises[n]:r[0]()}).then(e,t)),1==r.length&&r[0]()})}},m.PromiseBuffer=class{constructor(){this.waiting=[],this.available=[]}drain(){for(var e of this.waiting)e(new Error("Promise Buffer Reset"));this.waiting=[],this.available=[]}pushError(e){this.push(e)}push(e){var t=this.waiting.shift();t?t(e):this.available.push(e)}shiftAsync(e=0){var t;return 0<this.available.length?(t=this.available.shift())instanceof Error?Promise.reject(t):Promise.resolve(t):new Promise((t,r)=>{let n=e=>{(e instanceof Error?r:t)(e)};this.waiting.push(n),0<e&&u.U.delay(e).then(()=>{var e=this.waiting.indexOf(n);0<=e&&(this.waiting.splice(e,1),r(new Error("Timeout")))})})}},m.now=f,m.nowSeconds=function(){return Math.round(f()/1e3)},m.timeout=function(t){return new Promise(e=>setTimeout(()=>e(),t))},m.runWithBackoffAsync=async function(e,t,r,n,i,s,a=1.5){let o=r;for(var l=Date.now();Date.now()-l<i;){var c=await e();if(t(c))return c;await pxt.Util.timeout(o),o=Math.min(o*a,n)}throw new Error(s)},m.cpuUs=()=>{let e="undefined"!=typeof performance?performance.now.bind(performance)||performance.moznow.bind(performance)||performance.msNow.bind(performance)||performance.webkitNow.bind(performance)||performance.oNow.bind(performance):Date.now;return m.cpuUs=()=>1e3*e(),m.cpuUs()},m.getMime=function(e){if(!(e=/\.([a-zA-Z0-9]+)$/.exec(e)))return"application/octet-stream";switch(e[1].toLowerCase()){case"txt":return"text/plain";case"html":case"htm":return"text/html";case"css":return"text/css";case"js":return"application/javascript";case"jpg":case"jpeg":return"image/jpeg";case"png":return"image/png";case"ico":return"image/x-icon";case"manifest":return"text/cache-manifest";case"webmanifest":return"application/manifest+json";case"json":return"application/json";case"svg":return"image/svg+xml";case"eot":return"application/vnd.ms-fontobject";case"ttf":return"font/ttf";case"woff":return"application/font-woff";case"woff2":return"application/font-woff2";case"md":return"text/markdown";case"xml":return"application/xml";case"m4a":return"audio/m4a";case"mp3":return"audio/mp3";case"wasm":return"application/wasm";default:return"application/octet-stream"}},m.randomUint32=_,m.guidGen=function(){function e(){return(65536|_()).toString(16).slice(-4)}return e()+e()+"-"+e()+"-4"+e().slice(-3)+"-"+e()+"-"+e()+e()+e()},m.downloadLiveTranslationsAsync=y,m.pxtLangCookieId="PXT_LANG",m.langCookieExpirationDays=30,m.allLanguages={af:{englishName:"Afrikaans",localizedName:"Afrikaans"},ar:{englishName:"Arabic",localizedName:""},az:{englishName:"Azerbaijani",localizedName:" "},bg:{englishName:"Bulgarian",localizedName:""},bi:{englishName:"Bislama",localizedName:"Bislama"},bn:{englishName:"Bengali",localizedName:""},ca:{englishName:"Catalan",localizedName:"Catal"},cs:{englishName:"Czech",localizedName:"etina"},cy:{englishName:"Welsh",localizedName:"Cymraeg"},da:{englishName:"Danish",localizedName:"Dansk"},de:{englishName:"German",localizedName:"Deutsch"},el:{englishName:"Greek",localizedName:""},en:{englishName:"English",localizedName:"English"},"es-ES":{englishName:"Spanish (Spain)",localizedName:"Espaol (Espaa)"},"es-MX":{englishName:"Spanish (Mexico)",localizedName:"Espaol (Mxico)"},et:{englishName:"Estonian",localizedName:"Eesti"},eu:{englishName:"Basque",localizedName:"Euskara"},fa:{englishName:"Persian",localizedName:""},fi:{englishName:"Finnish",localizedName:"Suomi"},fil:{englishName:"Filipino",localizedName:"Filipino"},fo:{englishName:"Faroese",localizedName:"froyskt"},fr:{englishName:"French",localizedName:"Franais"},"fr-CA":{englishName:"French (Canada)",localizedName:"Franais (Canada)"},"ga-IE":{englishName:"Irish",localizedName:"Gaeilge"},gl:{englishName:"Galician",localizedName:"galego"},gn:{englishName:"Guarani",localizedName:"Avae'"},"gu-IN":{englishName:"Gujarati",localizedName:""},haw:{englishName:"Hawaiian",localizedName:"lelo Hawaii"},hi:{englishName:"Hindi",localizedName:""},he:{englishName:"Hebrew",localizedName:""},hr:{englishName:"Croatian",localizedName:"Hrvatski"},hu:{englishName:"Hungarian",localizedName:"Magyar"},"hy-AM":{englishName:"Armenian (Armenia)",localizedName:" ()"},id:{englishName:"Indonesian",localizedName:"Bahasa Indonesia"},is:{englishName:"Icelandic",localizedName:"slenska"},it:{englishName:"Italian",localizedName:"Italiano"},ja:{englishName:"Japanese",localizedName:""},"ja-HIRA":{englishName:"Hiragana",localizedName:""},ka:{englishName:"Georgian",localizedName:""},kab:{englishName:"Kabyle",localizedName:""},kk:{englishName:"Kazakh",localizedName:" "},km:{englishName:"Khmer",localizedName:""},kmr:{englishName:"Kurmanji (Kurdish)",localizedName:""},kn:{englishName:"Kannada",localizedName:""},ko:{englishName:"Korean",localizedName:""},lt:{englishName:"Lithuanian",localizedName:"Lietuvi"},lv:{englishName:"Latvian",localizedName:"Latvieu"},"ml-IN":{englishName:"Malayalam",localizedName:""},mr:{englishName:"Marathi",localizedName:""},ms:{englishName:"Malay",localizedName:"Melayu"},nl:{englishName:"Dutch",localizedName:"Nederlands"},no:{englishName:"Norwegian",localizedName:"Norsk"},nb:{englishName:"Norwegian Bokmal",localizedName:"Norsk bokml"},"nn-NO":{englishName:"Norwegian Nynorsk",localizedName:"Norsk nynorsk"},"pa-IN":{englishName:"Punjabi",localizedName:""},pl:{englishName:"Polish",localizedName:"Polski"},ps:{englishName:"Pashto",localizedName:""},"pt-BR":{englishName:"Portuguese (Brazil)",localizedName:"Portugus (Brasil)"},"pt-PT":{englishName:"Portuguese (Portugal)",localizedName:"Portugus (Portugal)"},ro:{englishName:"Romanian",localizedName:"Romn"},ru:{englishName:"Russian",localizedName:""},sat:{englishName:"Santali",localizedName:""},"si-LK":{englishName:"Sinhala",localizedName:""},sk:{englishName:"Slovak",localizedName:"Slovenina"},sl:{englishName:"Slovenian",localizedName:"Slovenski"},sq:{englishName:"Albanian",localizedName:"shqip"},sr:{englishName:"Serbian (Cyrillic)",localizedName:"Srpski"},su:{englishName:"Sundanese",localizedName:" "},"sv-SE":{englishName:"Swedish",localizedName:"Svenska"},sw:{englishName:"Swahili",localizedName:"Kiswahili"},"sw-TZ":{englishName:"Swahili (Tanzania)",localizedName:"Kiswahili (Tanzania)"},ta:{englishName:"Tamil",localizedName:""},te:{englishName:"Telugu",localizedName:""},th:{englishName:"Thai",localizedName:""},tl:{englishName:"Tagalog",localizedName:" "},tr:{englishName:"Turkish",localizedName:"Trke"},uk:{englishName:"Ukrainian",localizedName:""},"ur-IN":{englishName:"Urdu (India)",localizedName:" ()"},"ur-PK":{englishName:"Urdu (Pakistan)",localizedName:" ()"},vi:{englishName:"Vietnamese",localizedName:"Ting vit"},"zh-CN":{englishName:"Chinese (Simplified)",localizedName:"()"},"zh-TW":{englishName:"Chinese (Traditional)",localizedName:"()"}},m.isLocaleEnabled=b,m.updateLocalizationAsync=function(e){let{targetId:r,baseUrl:n,force:t}=e,i=e.code;if((i="en-US"===(i=m.normalizeLanguageCode(i)[0])?"en":i)===m.userLanguage()||!b(i)&&!t)return pxt.debug(`loc: ${i} (using built-in)`),Promise.resolve();pxt.debug("loc: "+i);let s=pxt.Util.liveLocalizationEnabled();return v(r,n,i,s,a.pxtc.Util.TranslationsKind.Editor).then(e=>{var t;return e&&(m.setUserLanguage(i),null!=(t=pxt.analytics)&&t.addDefaultProperties({lang:i}),m.setLocalizedStrings(e)),a.pxtc.Util.downloadTranslationsAsync(r,n,i,s,a.pxtc.Util.TranslationsKind.Apis).then(e=>{e&&(a.pxtc.apiLocalizationStrings=e)})})};let c;function v(e,r,n,t,i){if(i=i||c.Editor,"en-US"===(n=m.normalizeLanguageCode(n)[0])||"en"===n)return Promise.resolve(void 0);let s=n+`/${t}/`+i;if(m.translationsCache()[s])return Promise.resolve(m.translationsCache()[s]);let a;switch(i){case c.Editor:a=[{staticName:"strings.json",path:"strings.json"},{staticName:"target-strings.json",path:e+"/target-strings.json"}];break;case c.Sim:a=[{staticName:"sim-strings.json",path:e+"/sim-strings.json"}];break;case c.Apis:a=[{staticName:"bundled-strings.json",path:e+"/bundled-strings.json"}];break;case c.SkillMap:a=[{staticName:"skillmap-strings.json",path:"/skillmap-strings.json"}]}let o;function l(t){t&&(o=o||{},Object.keys(t).filter(e=>!!t[e]).forEach(e=>o[e]=t[e]))}if(t){let t=0;return u.U.promiseMapAllSeries(a,e=>y(n,e.path).then(l,e=>{pxt.log(e.message),++t})).then(()=>(t&&(m.translationsCache()[s]=o),t!==a.length&&o?Promise.resolve(o):(pxt.tickEvent("translations.livetranslationsfailed"),v(e,r,n,!1,i))))}return Promise.all(a.map(e=>m.httpGetJsonAsync(r+`locales/${n}/`+e.staticName).catch(e=>{}))).then(e=>{let t={};e.forEach(e=>pxt.Util.jsonMergeFrom(t,e)),Object.keys(t).length&&(o=t,m.translationsCache()[s]=o)},e=>{pxt.error("failed to load localizations")}).then(()=>o)}function T(e){var t,r={};for(t of Object.keys(e))r[t]=k(e[t]);return r}function k(e){var t;return{attributes:Object.assign({},e.attributes),parameters:null==(t=e.parameters)?void 0:t.map(x),extendsTypes:e.extendsTypes?[...e.extendsTypes]:void 0,pkgs:e.pkgs?[...e.pkgs]:void 0,combinedProperties:e.combinedProperties?[...e.combinedProperties]:void 0,name:e.name,namespace:e.namespace,fileName:e.fileName,kind:e.kind,retType:e.retType,isInstance:e.isInstance,isContextual:e.isContextual,qName:e.qName,pkg:e.pkg,snippet:e.snippet,snippetName:e.snippetName,snippetWithMarkers:e.snippetWithMarkers,pySnippet:e.pySnippet,pySnippetName:e.pySnippetName,pySnippetWithMarkers:e.pySnippetWithMarkers,blockFields:e.blockFields,isReadOnly:e.isReadOnly,pyName:e.pyName,pyQName:e.pyQName,snippetAddsDefinitions:e.snippetAddsDefinitions}}function x(e){var t;return{name:e.name,description:e.description,type:e.type,pyTypeString:e.pyTypeString,initializer:e.initializer,default:e.default,properties:null==(t=e.properties)?void 0:t.map(E),handlerParameters:null==(t=e.handlerParameters)?void 0:t.map(E),options:e.options?u.U.clone(e.options):void 0,isEnum:e.isEnum}}function E(e){return{name:e.name,type:e.type}}function S(e){if(e){var t;for(t of[{label:"Google API Key",regex:/AIza[A-Za-z0-9_\\\-]{35}/},{label:"Slack Token",regex:/xox[pbar]\-[A-Za-z0-9]/},{label:"GitHub Token",regex:/(gh[psuro]_[a-zA-Z0-9]{36}|github_pat_[a-zA-Z0-9]{22}_[a-zA-Z0-9]{59})/},{label:"Generic Secret",regex:/\b(token|signature|password|passwd|pwd|android:value)[^a-zA-Z0-9]{0,200}/i},{label:"CLI Credentials",regex:/((login|psexec|(certutil|psexec)\.exe).{1,50}(\s-u(ser(name)?)?\s+.{3,100})?\s-(admin|user|vm|root)?p(ass(word)?)?\s+["']?[^$\-\/\s]|(^|[\s\r\n\\])net(\.exe)?.{1,5}(user\s+|share\s+\/user:| user -? secrets ? set) \s + [^ $\s \/])/},{label:"JWT Token",regex:/\beyJ[A-Za-z0-9_\-]+?\.[A-Za-z0-9_\-]+?\.[A-Za-z0-9_\-]+?\b/},{label:"Email",regex:/\b[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,63}\b/i}])if(t.regex.test(e))return`<REDACTED: ${t.label}>`}return e}(e=c=m.TranslationsKind||(m.TranslationsKind={}))[e.Editor=0]="Editor",e[e.Sim=1]="Sim",e[e.Apis=2]="Apis",e[e.SkillMap=3]="SkillMap",m.downloadTranslationsAsync=v,m.capitalize=function(e){return e&&e[0].toLocaleUpperCase()+e.slice(1)},m.uncapitalize=function(e){return(e||"").split(/(?=[A-Z])/g).join(" ").toLowerCase()},m.camelCaseToLowercaseWithSpaces=function(e){return e.replace(/([A-Z])/gm," $1").toLocaleLowerCase().trim()},m.snakeCaseToLowercaseWithSpaces=function(e){return e.replace(/_/g," ").toLocaleLowerCase().trim()},m.range=function(t){var r=[];for(let e=0;e<t;++e)r.push(e);return r},m.multipartPostAsync=function(e,r={},t=null,n=null){let i="--------------------------0461489f461126c5",s="";Object.keys(r).forEach(e=>{var t;t=r[e=e],s=(s+=i+"\r\n")+'Content-Disposition: form-data; name="'+e+'"\r\n\r\n'+t+"\r\n"}),t&&(n=n,a=(t=t).split("/").reverse()[0],s=(s=s+i+'\r\nContent-Disposition: form-data; name="files['+t+']"; filename="'+a+'"\r\n')+"\r\n"+n+"\r\n"),s+=i+"--\r\n";var a,t={url:e,method:"POST",headers:{"Content-Type":"multipart/form-data; boundary="+i.slice(2)},data:s};return m.httpRequestCoreAsync(t)},m.toDataUri=function(e,t){return/^https?:/i.test(e)||/^data:/i.test(e)?e:(t||/^<svg/i.test(e)&&(t="image/svg+xml"),/xml|svg/.test(t)?`data:${t},`+encodeURIComponent(e):`data:${t||"image/png"};base64,`+u.encodeBase64(g(e)))},m.imageMagic=1496611453,m.imageHeaderSize=36,m.encodeBlobAsync=function(t,e){var r=m.imageHeaderSize+e.length,n=3*(t.width*t.height-1);let i=1;for(;i<4&&!(n*i>=8*r);)i++;var s=n*i>>3,a=r-s;let o=0;var l=t.width*t.height*4;if(0<a){var c=3*t.width,a=(o=Math.ceil(a/c),document.createElement("canvas"));a.width=t.width,a.height=t.height+o;let e=a.getContext("2d");e.drawImage(t,0,0),t=a}function u(t,r,n,i){let s=0,a=0,o=i[a++];var l=(1<<n)-1;let c=!0;for(;c;){let e=o>>s&l;var u=8-s;if(u<=n){if(a>=i.length){if(0==u)break;c=!1}o=i[a++],e|=o<<u&l,s=n-u}else s+=n;t[r]=255&(t[r]&~l|e),3==(3&++r)&&(t[r++]=255)}return r}c=pxt.HF2.encodeU32LE([m.imageMagic,e.length,o,0,0,0,0,0,0]),pxt.Util.assert(c.length==m.imageHeaderSize);let d=t.getContext("2d");var p=d.getImageData(0,0,t.width,t.height);u(p.data,0,1,[i]);let h=4;for(h=u(p.data,h,i,c),pxt.Util.assert(0==(3&h)),h=0==o?u(p.data,h,i,e):(a=s-c.length,h=u(p.data,h,i,e.slice(0,a)),u(p.data,l,8,e.slice(a))),h|=3;h<p.data.length;)p.data[h]=255,h+=4;return d.putImageData(p,0,0),t},m.decodeBlobAsync=function(e){return pxt.BrowserUtils.loadCanvasAsync(e).then(e=>{let o=e.getContext("2d").getImageData(0,0,e.width,e.height).data;var t,r,n,i=1&o[0]|(1&o[1])<<1|(1&o[2])<<2;return 5<i||0==i?Promise.reject(new Error(m.lf("Invalid encoded PNG format"))):(t=s(4,i,n=new Uint8Array(pxt.Util.imageHeaderSize)),(n=pxt.HF2.decodeU32LE(n))[0]!=pxt.Util.imageMagic?Promise.reject(new Error(m.lf("Invalid magic in encoded PNG"))):(r=new Uint8Array(n[1]),0<(n=n[2])?(n=(e.height-n)*e.width,s(t,i,e=new Uint8Array((3*(n-1)*i>>3)-pxt.Util.imageHeaderSize)),r.set(e),s(4*n,8,n=new Uint8Array(r.length-e.length)),r.set(n,e.length)):s(t,i,r),r));function s(e,t,r){let n=0,i=0,s=0;for(var a=(1<<t)-1;i<r.length;)s|=(o[e++]&a)<<n,3==(3&e)&&e++,8<=(n+=t)&&(r[i++]=255&s,s>>=8,n-=8);return e}})},m.parseQueryString=function(e){let n={};return e.replace(/\+/g," ").replace(/([^#?&=]+)=([^#?&=]*)/g,(e,t,r)=>(n[decodeURIComponent(t)]=decodeURIComponent(r),"")),n},m.stringifyQueryString=function(e,t){for(var r of Object.keys(t))0<=e.indexOf("?")?e+="&":e+="?",e+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]);return e},m.cloneTargetBundle=function(e){var t=(e=Object.assign({},e)).apiInfo,r=(delete e.apiInfo,e.bundleddirs),n=(delete e.bundleddirs,e.bundledpkgs),i=(delete e.bundledpkgs,e.tutorialInfo),s=(delete e.tutorialInfo,m.clone(e));if(t){s.apiInfo={};for(var a of Object.keys(t)){var o=t[a].apis;s.apiInfo[a]={sha:t[a].sha,apis:{jres:Object.assign({},o.jres),byQName:T(o.byQName)}}}}if(r&&(s.bundleddirs=[...r]),n){s.bundledpkgs={};for(var l of Object.keys(n))s.bundledpkgs[l]=Object.assign({},n[l])}if(i){s.tutorialInfo={};for(var c of Object.keys(i)){var u=i[c];s.tutorialInfo[c]={hash:u.hash,usedBlocks:Object.assign({},u.usedBlocks),snippetBlocks:Object.assign({},u.snippetBlocks),highlightBlocks:Object.assign({},u.highlightBlocks),validateBlocks:Object.assign({},u.validateBlocks)}}}return s},m.cloneApis=T,m.cloneSymbolInfo=k,m.toUTF8Array=function(e){return(new TextEncoder).encode(e)},m.fromUTF8Array=function(e){return(new TextDecoder).decode(e)},m.getHomeUrl=function(){let e,t,r,n=null==(e=pxt.webConfig)?void 0:e.relprefix.substr(0,pxt.webConfig.relprefix.length-3);return pxt.appTarget.appTheme.homeUrl&&n?((null==(t=pxt.appTarget.appTheme.homeUrl)?void 0:t.lastIndexOf("/"))===(null==(r=pxt.appTarget.appTheme.homeUrl)?void 0:r.length)-1&&(n=n.substr(1)),pxt.appTarget.appTheme.homeUrl+n):pxt.appTarget.appTheme.homeUrl},m.isExperienceSupported=function(e){var t=null==(t=null==(t=null==(t=pxt.appTarget)?void 0:t.appTheme)?void 0:t.supportedExperiences)?void 0:t.map(e=>e.toLocaleLowerCase()),e=e.toLocaleLowerCase();return null!=(t=null==t?void 0:t.includes(e))&&t},m.ocvEnabled=function(){var e;return(null==(e=null==(e=pxt.webConfig)?void 0:e.ocv)?void 0:e.appId)&&(null==(e=null==(e=pxt.webConfig)?void 0:e.ocv)?void 0:e.iframeEndpoint)},m.bresenhamLine=function(n,i,s,a,o){var e=s-n,l=a-i;if(0==e){var t=0<=l?a:i;for(let e=0<=l?i:a;e<=t;e++)o(n,e)}else{var c=0<e?1:-1,u=0<l?1:-1,d=Math.abs(l/e);let t=0,r=i;for(let e=n;0<c?e<=s:e>=s;e+=c)for(o(e,r),t+=d;.5<=t;)(0<u?r<=a:r>=a)&&o(e,r),r+=u,--t}},m.isFeatureEnabled=function(e){var t=null==(t=null==(t=pxt.appTarget.appTheme)?void 0:t.enabledFeatures)?void 0:t[e];if(!t)return!1;let r=!0,n=pxt.Cloud.getRegion()?pxt.Cloud.getRegion().toUpperCase():void 0;return r=(r=t.includeRegions?n&&t.includeRegions.some(e=>e.toUpperCase()==n):r)&&t.excludeRegions?n&&!t.excludeRegions.some(e=>e.toUpperCase()==n):r},m.cleanData=function(e){if(!e)return e;let t;if("string"==typeof e)t=S(e);else if("object"==typeof e){t={};for(var[r,n]of Object.entries(e))t[r]="string"==typeof n?S(n):n}else t=e;return t}}})(ts=ts||{}),(e=>{var b=e.pxtc||(e.pxtc={});{e=b.BrowserImpl||(b.BrowserImpl={});b.Util.httpRequestCoreAsync=function(l){return new Promise((e,t)=>{let r,n=!1,i=b.Util.clone(l.headers)||{};r=new XMLHttpRequest,l.responseArrayBuffer&&(r.responseType="arraybuffer"),l.withCredentials&&(r.withCredentials=!0),r.onreadystatechange=()=>{if(!n&&4==r.readyState){n=!0;let t={statusCode:r.status,headers:{},buffer:r.responseBody||r.response,text:l.responseArrayBuffer?void 0:r.responseText};r.getAllResponseHeaders().split(/\r?\n/).forEach(e=>{e=/^\s*([^:]+): (.*)/.exec(e);e&&(t.headers[e[1].toLowerCase()]=e[2])}),e(t)}};var s=l.data,a=l.method||(null==s?"GET":"POST");let o;null==s?o=null:s instanceof Uint8Array?o=s:"object"==typeof s?(o=JSON.stringify(s),i["content-type"]="application/json; charset=utf8"):"string"==typeof s?o=s:b.Util.oops("bad data"),r.open(a,l.url),Object.keys(i).forEach(e=>{r.setRequestHeader(e,i[e])}),null==o?r.send():r.send(o)})},b.Util.sha256=r,b.Util.getRandomBuf=t=>{if(window.crypto)window.crypto.getRandomValues(t);else for(let e=0;e<t.length;++e)t[e]=Math.floor(255*Math.random())};let y=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function v(e,t){return e>>>t|e<<32-t}function t(e){let f=new Uint32Array(8),_=(f[0]=1779033703,f[1]=3144134277,f[2]=1013904242,f[3]=2773480762,f[4]=1359893119,f[5]=2600822924,f[6]=528734635,f[7]=1541459225,new Uint32Array(64));function t(r){var e=r.length-63;for(let t=0;t<e;t+=64){for(let e=0;e<16;e++){var n=(e<<2)+t;_[e]=r[n]<<24|r[n+1]<<16|r[n+2]<<8|r[n+3]}{c=void 0;u=void 0;d=void 0;p=void 0;h=void 0;m=void 0;g=void 0;var c=f;var u=_;b.Util.assert(8==c.length),b.Util.assert(64==u.length);for(let e=16;e<64;++e){var d=v(u[e-15],7)^v(u[e-15],18)^u[e-15]>>>3,p=v(u[e-2],17)^v(u[e-2],19)^u[e-2]>>>10;u[e]=u[e-16]+d+u[e-7]+p|0}let t=c[0],r=c[1],n=c[2],i=c[3],s=c[4],a=c[5],o=c[6],l=c[7];for(let e=0;e<64;++e){var h=v(s,6)^v(s,11)^v(s,25),m=s&a^~s&o,h=l+h+m+y[e]+u[e]|0,m=v(t,2)^v(t,13)^v(t,22),g=t&r^t&n^r&n;l=o,o=a,a=s,s=i+h|0,i=n,n=r,r=t,t=h+(m+g|0)|0}c[0]+=t,c[1]+=r,c[2]+=n,c[3]+=i,c[4]+=s,c[5]+=a,c[6]+=o,c[7]+=l}}}t(e);let r=64-(e.length+9)%64,n=(64==r&&(r=0),e.length-e.length%64);var i=new Uint8Array(e.length-n+1+r+8);let s=0;for(;n<e.length;)i[s++]=e[n++];for(i[s++]=128;0<r--;)i[s++]=0;let a=8*e.length;for(s=i.length;0<a;)i[--s]=255&a,a>>=8;t(i);let o="";for(let e=0;e<f.length;++e)o+=("000000000"+f[e].toString(16)).slice(-8);return o.toLowerCase()}function r(e){pxt.perf.measureStart(Measurements.Sha256Buffer);e=t(b.Util.toUTF8Array(e));return pxt.perf.measureEnd(Measurements.Sha256Buffer),e}e.sha256buffer=t,e.sha256string=r}})(ts=ts||{}),(e=>{var r=e.pxtc||(e.pxtc={});{e=r.jsonPatch||(r.jsonPatch={});let o={add:(e,t,r)=>{if("object"!=typeof e)throw new Error("jsonPatch: expected object type");if(t in e)throw new Error("jsonPatch: object already contains key "+t);e[t]=r},replace:(e,t,r)=>{if("object"!=typeof e)throw new Error("jsonPatch: expected object type");e[t]=r},remove:(e,t)=>{if("object"!=typeof e)throw new Error("jsonPatch: expected object type");delete e[t]}},l={add:(e,t,r)=>{if(!Array.isArray(e))throw new Error("jsonPatch: expected array type");if(t in e)throw new Error(`jsonPatch: key ${t} already exists in array`);"number"==typeof t&&t===Math.floor(t)?e.splice(t,0,r):e[t]=r},replace:(e,t,r)=>{if(!Array.isArray(e))throw new Error("jsonPatch: expected array type");"number"==typeof t&&t===Math.floor(t)?e.splice(t,1,r):e[t]=r},remove:(e,t)=>{if(!Array.isArray(e))throw new Error("jsonPatch: expected array type");"number"==typeof t&&t===Math.floor(t)?e.splice(t,1):delete e[t]}};e.diff=function(e,t){let l={add:[],remove:[],replace:[]};function c(e,t){return!Array.isArray(e)||(e=Number.parseFloat(t),Number.isNaN(e))?t:e}return function e(t,r,n){if(!Object.is(t,r)){r=r||{},t=t||{};for(var i of Object.keys(t))i in r||(i=c(t,i),l.remove.push({op:"remove",path:n.concat(i)}));for(var s of Object.keys(r)){var a=t[s],o=r[s];(s=c(r,s))in t?"object"!=typeof a&&"object"!=typeof o&&a!==o||typeof a!=typeof o||Array.isArray(a)!==Array.isArray(o)?l.replace.push({op:"replace",path:n.concat(s),value:o}):e(a,o,n.concat(s)):void 0!==r[s]&&(n.length&&l.add.push({op:"add",path:n,value:Array.isArray(r)?[]:{}}),l.add.push({op:"add",path:n.concat(s),value:o}))}}}(e,t,[]),[...l.remove.reverse(),...l.replace,...l.add.sort((e,t)=>e.path.length-t.path.length)]},e.patchInPlace=function(n,e){if(!n||"object"!=typeof n)throw new Error("jsonPatch: Must be an object or an array.");for(var i of e){var s=i.path.slice(),a=s.pop();if(null==a)throw new Error("jsonPatch: missing last key");let e=n,t=s.shift();for(;null!=t;){if(!(t in e))throw new Error("jsonPatch: missing parent element "+t);e=e[t],t=s.shift()}if(Array.isArray(e)&&"number"!=typeof a)throw new Error("jsonPatch: expected numeric index for array object");let r=Array.isArray(e)?l:o;"remove"===i.op?r.remove(e,a):"add"!==i.op||a in e?"replace"===i.op&&r.replace(e,a,i.value):r.add(e,a,i.value)}},e.opsAreEqual=function(e,t){return e.op===t.op&&r.U.arrayEquals(e.path,t.path)}}})(ts=ts||{}),(r=>{var n,e;n=r.pxtc||(r.pxtc={}),(e=(e=n.jsonPatch||(n.jsonPatch={})).tests||(e.tests={})).diffTests=function(){var e;for(e of[{comment:"test 1",obja:{a:4,b:5},objb:{a:3,b:5},expected:[{op:"replace",path:["a"],value:3}]},{comment:"test 2",obja:{a:3,b:5},objb:{a:4,c:5},expected:[{op:"remove",path:["b"]},{op:"replace",path:["a"],value:4},{op:"add",path:["c"],value:5}]},{comment:"test 3",obja:{a:4,b:[1,2,3]},objb:{a:3,b:[1,2,4]},expected:[{op:"replace",path:["a"],value:3},{op:"replace",path:["b",2],value:4}]},{comment:"test 4",obja:{a:3,b:[1,2,4]},objb:{a:3,b:[1,2,4,5]},expected:[{op:"add",path:["b"],value:[]},{op:"add",path:["b",3],value:5}]},{comment:"test 5",obja:{a:4,b:{c:3}},objb:{a:4,b:{c:4}},expected:[{op:"replace",path:["b","c"],value:4}]},{comment:"test 6",obja:{a:4,b:{c:4}},objb:{a:5,b:{d:4}},expected:[{op:"remove",path:["b","c"]},{op:"replace",path:["a"],value:5},{op:"add",path:["b"],value:{}},{op:"add",path:["b","d"],value:4}]},{comment:"test 7",obja:{a:4,b:[2,"foo"]},objb:{a:4,b:[2,"foo",["this","that"]]},expected:[{op:"add",path:["b"],value:[]},{op:"add",path:["b",2],value:["this","that"]}]}]){pxt.log(e.comment);var t=r.pxtc.jsonPatch.diff(e.obja,e.objb);n.U.deepEqual(t,e.expected)?pxt.log("succeeded"):(pxt.error("FAILED"),pxt.log("got",t),pxt.log("exp",e.expected))}},e.patchTests=function(){var e;for(e of[{comment:"test 1",obj:{a:"foo",b:[4,11]},patches:[{op:"remove",path:["b"]},{op:"replace",path:["a"],value:4},{op:"add",path:["c"],value:5}],expected:{a:4,c:5}},{comment:"test 2",obj:{a:4,b:[1,2,3]},patches:[{op:"replace",path:["a"],value:3},{op:"replace",path:["b",2],value:4},{op:"add",path:["b",3],value:9}],expected:{a:3,b:[1,2,4,9]}},{comment:"test 3",obj:{a:4,b:{c:3}},patches:[{op:"replace",path:["a"],value:5},{op:"remove",path:["b","c"]},{op:"add",path:["b","d"],value:4}],expected:{a:5,b:{d:4}}},{comment:"test 4",obj:{a:4},patches:[{op:"add",path:["b"],value:[]},{op:"add",path:["b",0],value:"foo"},{op:"add",path:["b",1],value:"bar"}],expected:{a:4,b:["foo","bar"]},validate:e=>e.b&&e.b.forEach}])pxt.log(e.comment),r.pxtc.jsonPatch.patchInPlace(e.obj,e.patches),!n.U.deepEqual(e.obj,e.expected)||!e.validate||e.validate(e.obj)?pxt.log("succeeded"):e.expected&&(pxt.error("FAILED"),pxt.log("got",e.obj),pxt.log("exp",e.expected))}})(ts=ts||{}),(e=>{e.perf||(e.perf={})})(pxt=pxt||{}),pxt.perf.isEnabled||(pxt.perf.isEnabled=()=>!1),pxt.perf.report||(pxt.perf.report=()=>{}),pxt.perf.recordMilestone||(pxt.perf.recordMilestone=()=>{}),pxt.perf.measureStart||(pxt.perf.measureStart=()=>{}),pxt.perf.measureEnd||(pxt.perf.measureEnd=()=>{}),(i=>{i.U=pxtc.Util,i.Util=pxtc.Util;let n,r={};i.setAppTarget=function(e){i.appTarget=e||{},c(),n=i.U.cloneTargetBundle(i.appTarget)};let o;function s(e,t){/^csv-/.test(e)?i.setAppTargetVariant(e.replace(/^csv-*/,"")):i.appTarget&&(r[e]=t,i.U.jsonCopyFrom(i.appTarget.compile.switches,r),i.U.jsonCopyFrom(n.compile.switches,r))}i.setBundledApiInfo=function(e){for(var t of Object.keys(e)){var r,n=e[t].apis.byQName;for(r of Object.keys(n)){var i=n[r],s=r.lastIndexOf("."),a=i.pyQName,s=n[r]={kind:Math.abs(i.kind||7),qName:r,namespace:r.slice(0,s<0?0:s),name:r.slice(s+1),pyQName:a,pyName:a?a.slice(a.lastIndexOf(".")+1):void 0,fileName:"",attributes:i.attributes||{},retType:i.retType||"void",parameters:i.parameters?i.parameters.map(e=>({name:e.name,description:e.description||"",type:e.type||"number",initializer:e.initializer,default:e.default,options:e.options||{},isEnum:!!e.isEnum,handlerParameters:e.handlerParameters})):null,extendsTypes:i.extendsTypes,snippet:i.kind&&i.kind<0?null:void 0,isInstance:!!i.isInstance,isReadOnly:!!i.isReadOnly},a=s.attributes;a.paramDefl||(a.paramDefl={}),a.callingConvention||(a.callingConvention=0),a.paramHelp||(a.paramHelp={}),a.jsDoc||(a.jsDoc=""),a._name=s.name.replace(/@.*/,"")}}o=e},i.getBundledApiInfo=function(){return o},i.savedAppTheme=function(){return n?n.appTheme:void 0},i.setCompileSwitch=s,i.setCompileSwitches=function(e){if(e)for(var t of e.split(/[\s,;:]+/))t&&("-"==t[0]?s(t.slice(1),!1):s(t,!0))};let a;function l(e,t,r){if(Array.isArray(e))return e.map(e=>l(e,t,r));if("object"!=typeof e)return"string"==typeof e&&t.test(e)?r(e):e;for(var n of Object.keys(e))e[n]=l(e[n],t,r);return e}function c(){let e=i.appTarget.compile;(e=e||(i.appTarget.compile={isNative:!1,hasHex:!1,switches:{}})).hasHex&&!e.nativeType&&(e.nativeType=pxtc.NATIVE_TYPE_THUMB),e.switches||(e.switches={}),e.nativeType==pxtc.NATIVE_TYPE_VM&&(e.sourceMap=!0),i.U.jsonCopyFrom(e.switches,r),e.jsRefCounting=!1,e.useUF2||e.useELF||null!=e.noSourceInFlash||(e.noSourceInFlash=!0),void 0===e.utf8&&(e.utf8=!0),i.appTarget.appTheme||(i.appTarget.appTheme={}),i.appTarget.appTheme.embedUrl||(i.appTarget.appTheme.embedUrl=i.appTarget.appTheme.homeUrl);var t=i.appTarget.compileService;if(t&&t.yottaTarget&&!t.yottaBinary&&(t.yottaBinary="pxt-microbit-app-combined.hex"),i.appTarget=l(i.appTarget,/^@cdnUrl@/i,e=>i.BrowserUtils.patchCdn(e)),i.appTarget.bundledpkgs&&Object.keys(i.appTarget.bundledpkgs).forEach(e=>{var e=i.appTarget.bundledpkgs[e],t=JSON.parse(e[i.CONFIG_NAME]);t.icon&&(t.icon=i.BrowserUtils.patchCdn(t.icon)),e[i.CONFIG_NAME]=i.Package.stringifyConfig(t)}),"undefined"!=typeof window){let t={"lockededitor=1":{appTheme:{lockedEditor:!0}},"hidemenu=1":{appTheme:{hideMenuBar:!0}}},r=(i.appTarget.queryVariants&&i.Util.jsonCopyFrom(t,i.appTarget.queryVariants),window.location.href);Object.keys(t).forEach(e=>{new RegExp(e,"i").exec(r)&&(e=t[e])&&i.U.jsonMergeFrom(i.appTarget,e)})}}function u(e=!1){i.perf.measureStart(Measurements.ReloadAppTargetVariant);var t,r=e?"":JSON.stringify(i.appTarget);i.appTarget=i.U.cloneTargetBundle(n),i.appTargetVariant&&((t=i.appTarget.variants&&i.appTarget.variants[i.appTargetVariant])?i.U.jsonMergeFrom(i.appTarget,t):i.U.userError(lf("Variant '{0}' not defined in pxtarget.json",i.appTargetVariant))),c(),!e&&i.onAppTargetChanged&&r!=JSON.stringify(i.appTarget)&&i.onAppTargetChanged(),i.perf.measureEnd(Measurements.ReloadAppTargetVariant)}function t(){return{relprefix:"/--",workerjs:"/worker.js",monacoworkerjs:"/monacoworker.js",gifworkerjs:"/gifjs/gif.worker.js",serviceworkerjs:"/serviceworker.js",typeScriptWorkerJs:"/tsworker.js",pxtVersion:"local",pxtRelId:"localRelId",pxtCdnUrl:"/cdn/",commitCdnUrl:"/cdn/",blobCdnUrl:"/blb/",cdnUrl:"/cdn/",targetUrl:"",targetVersion:"local",targetRelId:"",targetId:i.appTarget?i.appTarget.id:"",simUrl:"/sim/simulator.html",simserviceworkerUrl:"/simulatorserviceworker.js",simworkerconfigUrl:"/sim/workerConfig.js",partsUrl:"/sim/siminstructions.html"}}i.bundledSvg=function(t){if(t){var r=a&&a[t];if(r)return r;if(i.appTarget.simulator&&i.appTarget.simulator.dynamicBoardDefinition){a=a||{};r=i.appTarget.bundledpkgs[t];if(r){if(JSON.parse(r["pxt.json"]).core&&r["board.json"]){var n=JSON.parse(r["board.json"]);if(n&&n.visual&&n.visual.image){let e=n.visual.image;/^pkg:\/\//.test(e)&&(e=r[e.slice(6)]),a[t]="data:image/svg+xml;base64,"+ts.pxtc.encodeBase64(i.Util.toUTF8(e))}}return a[t]}}}},i.replaceStringsInJsonBlob=l,i.reloadAppTargetVariant=u,i.setAppTargetVariant=function(e,t={}){i.debug("app variant: "+e),(t.force||i.appTargetVariant!==e&&(i.appTargetVariant||e))&&(i.appTargetVariant=e,u(t.temporary))},i.setHwVariant=function(e,t){e=e.replace(/.*---/,""),/^[\w\-]+$/.test(e)?(i.hwVariant=e,i.hwName=t||e):(i.hwVariant=null,i.hwName=null),i.debug(`hwVariant: ${i.hwVariant} (${i.hwName})`)},i.hasHwVariants=function(){return!!i.appTarget.variants&&Object.keys(i.appTarget.bundledpkgs).some(e=>/^hw---/.test(e))},i.getHwVariants=function(){return i.appTarget.variants?Object.keys(i.appTarget.bundledpkgs).filter(e=>/^hw---/.test(e)).map(e=>JSON.parse(i.appTarget.bundledpkgs[e][i.CONFIG_NAME])).filter(e=>!!i.appTarget.appTheme.experimentalHw||!e.experimentalHw):[]},i.getActiveHwVariant=function(){return i.hwVariant},i.options={},i.reportException=function(e,t){if(i.error(e),t)try{i.error(t)}catch(e){}},i.reportError=function(e,t,r){if(i.error(e+": "+t),r)try{i.log(JSON.stringify(r,null,2))}catch(e){}},i.localWebConfig=t,i.getOnlineCdnUrl=function(){var e;return i.webConfig&&(e=/^(https:\/\/[^\/]+)/.exec(i.webConfig.commitCdnUrl))?e[1]:null},i.setupWebConfig=function(e){e?i.webConfig=e:i.webConfig||(i.webConfig=t())},i.getEmbeddedScript=function(e){return i.U.lookup(i.appTarget.bundledpkgs||{},e)};let e=void 0;function d(){return e=e||i.Cloud.downloadTargetConfigAsync().then(e=>e||{},e=>({}))}function p(e=null){return(e=e||i.appTarget.compile).nativeType==ts.pxtc.NATIVE_TYPE_VM?e.useESP?e.useUF2?ts.pxtc.BINARY_UF2:ts.pxtc.BINARY_ESP:ts.pxtc.BINARY_PXT64:e.useUF2&&!e.switches.rawELF?ts.pxtc.BINARY_UF2:e.useELF?ts.pxtc.BINARY_ELF:ts.pxtc.BINARY_HEX}i.targetConfigAsync=d,i.packagesConfigAsync=function(){return d().then(e=>e?e.packages:void 0)},i.CONFIG_NAME="pxt.json",i.SIMSTATE_JSON=".simstate.json",i.SERIAL_EDITOR_FILE="serial.txt",i.README_FILE="README.md",i.GITIGNORE_FILE=".gitignore",i.ASSETS_FILE="assets.json",i.CLOUD_ID="pxt/",i.BLOCKS_PROJECT_NAME="blocksprj",i.JAVASCRIPT_PROJECT_NAME="tsprj",i.PYTHON_PROJECT_NAME="pyprj",i.MAIN_BLOCKS="main.blocks",i.MAIN_TS="main.ts",i.MAIN_PY="main.py",i.DEFAULT_GROUP_NAME="other",i.TILEMAP_CODE="tilemap.g.ts",i.TILEMAP_JRES="tilemap.g.jres",i.IMAGES_CODE="images.g.ts",i.IMAGES_JRES="images.g.jres",i.TUTORIAL_CODE_START="_onCodeStart.ts",i.TUTORIAL_CODE_STOP="_onCodeStop.ts",i.TUTORIAL_INFO_FILE="tutorial-info-cache.json",i.TUTORIAL_CUSTOM_TS="tutorial.custom.ts",i.BREAKPOINT_TABLET=991,i.PALETTES_FILE="_palettes.json",i.HISTORY_FILE="_history",i.outputName=p,i.isOutputText=function(e=null){return p(e)==ts.pxtc.BINARY_HEX}})(pxt=pxt||{}),(a=>{{var y=a.blocks||(a.blocks={});let s="this";y.showBlockIdInTooltip=!1,y.requirePxtBlockly=()=>{},y.requireBlockly=()=>{},y.registerFieldEditor=()=>{},y.MATH_FUNCTIONS={unary:["sqrt","sin","cos","tan","asin","acos"],binary:["atan2"],infix:["idiv","imul"]},y.ROUNDING_FUNCTIONS=["round","ceil","floor","trunc"],y.builtinFunctionInfo={"Math.abs":{blockId:"math_op3",params:["x"]},"Math.min":{blockId:"math_op2",params:["x","y"]},"Math.max":{blockId:"math_op2",params:["x","y"]}},y.normalizeBlock=function(e,t=a.log){if(!e)return e;let r=e.replace(/(?:^|[^\\])([%$])\s+/g,"$1");return r!=e&&(t("block has extra spaces: "+e),e=r),(r=(e=r).replace(/([%$]\w+)\s*=\s*(\w+)/,"$1=$2"))!=e&&(t("block has space between %name and = : "+e),e=r),r=r.replace(/\s*\|\s*/g,"|")},y.compileInfo=function(o){let e,l={parameters:[],actualNameToParam:{},definitionNameToParam:{},handlerArgs:[]},t=!(1!=o.kind&&2!=o.kind||o.attributes.defaultInstance||o.isStatic),c=("boolean"!=typeof o.isInstance||null!=(e=o.attributes)&&e.defaultInstance||(t=o.isInstance),!!o.attributes._def),u=c?o.attributes._def.parameters.slice(0):void 0,d=c?u.length:o.parameters?o.parameters.length:0,p=y.builtinFunctionInfo[o.qName],h=(c&&o.attributes._expandedDef&&u.push(...o.attributes._expandedDef.parameters),{}),m=u?u.filter(e=>!e.ref||(h[e.name]=e,!1)):[];if(t&&c&&u.length){var r=h.this||u[0],n=r.name,i=!r.shadowBlockId||"variables_get"===r.shadowBlockId;let e=o.attributes.paramDefl[n]||o.attributes.paramDefl.this;i&&(e=r.varName||e),l.thisParameter={actualName:s,definitionName:n,shadowBlockId:r.shadowBlockId,type:o.namespace,defaultValue:e,definitionIndex:u.indexOf(r),fieldEditor:g(n,s),fieldOptions:f(n,s),shadowOptions:_(n,s)}}if(o.parameters){let a=t&&!h.this?1:0;o.parameters.forEach((t,r)=>{let n;if(h[t.name]?n=h[t.name]:a<m.length&&(n=m[a],++a),n||!c){let e=void 0;t.options&&t.options.min&&t.options.max&&(e={min:t.options.min.value,max:t.options.max.value});var i=n?n.name:p?p.params[a++]:t.name,s=n&&("variables_get"===n.shadowBlockId||"lists_create_with"==n.shadowBlockId);l.parameters.push({actualName:t.name,type:t.type,defaultValue:s&&n.varName||t.default,definitionName:i,definitionIndex:n?u.indexOf(n):r,shadowBlockId:n&&n.shadowBlockId,isOptional:!!u&&u.indexOf(n)>=d,fieldEditor:g(i,t.name),fieldOptions:f(i,t.name),shadowOptions:_(i,t.name),range:e})}t.handlerParameters&&t.handlerParameters.forEach(t=>{l.handlerArgs.push({name:t.name,type:t.type,inBlockDef:!!u&&u.some(e=>e.ref&&e.name===t.name),localizationKey:o.qName+"|handlerParam|"+t.name})})})}return l.parameters.forEach(e=>{l.actualNameToParam[e.actualName]=e,l.definitionNameToParam[e.definitionName]=e}),l;function g(e,t){return o.attributes.paramFieldEditor&&(o.attributes.paramFieldEditor[e]||o.attributes.paramFieldEditor[t])}function f(e,t){return o.attributes.paramFieldEditorOptions&&(o.attributes.paramFieldEditorOptions[e]||o.attributes.paramFieldEditorOptions[t])}function _(e,t){return o.attributes.paramShadowOptions&&(o.attributes.paramShadowOptions[e]||o.attributes.paramShadowOptions[t])}},y.hasHandler=function(e){return e.parameters&&e.parameters.some(e=>{var t;return"() => void"==e.type||"Action"==e.type||!(null==(t=e.properties)||!t.length)||!(null==(t=e.handlerParameters)||!t.length)})},y.getHelpUrl=function(e){if(e.attributes.help){var t=e.attributes.help.replace(/^\//,"");if(/^github:/.test(t))return t;if("none"!==t)return"/reference/"+t}else if(e.pkg&&!a.appTarget.bundledpkgs[e.pkg])return(t=e.qName.toLowerCase().split("."))[0]==e.pkg&&t.shift(),`/pkg/${e.pkg}#`+encodeURIComponent(t.join("-"))},y.reporterTypeForArgType=function(e){let t="boolean"!==e&&"number"!==e&&"string"!==e?"argument_reporter_custom":"argument_reporter_"+e;return t=/^(?:Array<(?:.+)>)|(?:(?:.+)\[\])$/.test(e)?"argument_reporter_array":t},y.defaultIconForArgType=function(e=""){switch(e){case"number":return"calculator";case"string":return"text width";case"boolean":return"random";case"Array":return"list";default:return"align justify"}},y.parseFields=function(e){return e.split("|").map((e,t)=>{var r=/([^%]*)\s*%([a-zA-Z0-9_]+)/.exec(e);if(!r)return{n:e,ni:t};let n=r[1];return{n:e,ni:t,pre:n=n&&n.trim(),p:r[2]}})};let i;function t(){if((i={device_while:{name:a.Util.lf("a loop that repeats while the condition is true"),tooltip:a.Util.lf("Run the same sequence of actions while the condition is met."),url:"/blocks/loops/while",category:"loops",block:{message0:a.Util.lf("while %1"),appendField:a.Util.lf("{id:while}do")}},pxt_controls_for:{name:a.Util.lf("a loop that repeats the number of times you say"),tooltip:a.Util.lf("Have the variable '{0}' take on the values from 0 to the end number, counting by 1, and do the specified blocks."),url:"/blocks/loops/for",category:"loops",block:{message0:a.Util.lf("for %1 from 0 to %2"),variable:a.Util.lf("{id:var}index"),appendField:a.Util.lf("{id:for}do")}},controls_simple_for:{name:a.Util.lf("a loop that repeats the number of times you say"),tooltip:a.Util.lf("Have the variable '{0}' take on the values from 0 to the end number, counting by 1, and do the specified blocks."),url:"/blocks/loops/for",category:"loops",block:{message0:a.Util.lf("for %1 from 0 to %2"),variable:a.Util.lf("{id:var}index"),appendField:a.Util.lf("{id:for}do")}},pxt_controls_for_of:{name:a.Util.lf("a loop that repeats for each value in an array"),tooltip:a.Util.lf("Have the variable '{0}' take the value of each item in the array one by one, and do the specified blocks."),url:"/blocks/loops/for-of",category:"loops",block:{message0:a.Util.lf("for element %1 of %2"),variable:a.Util.lf("{id:var}value"),appendField:a.Util.lf("{id:for_of}do")}},controls_for_of:{name:a.Util.lf("a loop that repeats for each value in an array"),tooltip:a.Util.lf("Have the variable '{0}' take the value of each item in the array one by one, and do the specified blocks."),url:"/blocks/loops/for-of",category:"loops",block:{message0:a.Util.lf("for element %1 of %2"),variable:a.Util.lf("{id:var}value"),appendField:a.Util.lf("{id:for_of}do")}},math_op2:{name:a.Util.lf("minimum or maximum of 2 numbers"),tooltip:{min:a.Util.lf("smaller value of 2 numbers"),max:a.Util.lf("larger value of 2 numbers")},url:"/blocks/math",operators:{op:["min","max"]},category:"math"},math_op3:{name:a.Util.lf("absolute number"),tooltip:a.Util.lf("absolute value of a number"),url:"/reference/math",category:"math",block:{message0:a.Util.lf("absolute of %1")}},math_number:{name:a.Util.lf("{id:block}number"),url:"/types/number",category:"math",tooltip:a.appTarget&&a.appTarget.compile?a.Util.lf("a decimal number"):a.Util.lf("an integer number")},math_integer:{name:a.Util.lf("{id:block}number"),url:"/types/number",category:"math",tooltip:a.Util.lf("an integer number")},math_whole_number:{name:a.Util.lf("{id:block}number"),url:"/types/number",category:"math",tooltip:a.Util.lf("a whole number")},math_number_minmax:{name:a.Util.lf("{id:block}number"),url:"/blocks/math",category:"math"},math_arithmetic:{name:a.Util.lf("arithmetic operation"),url:"/blocks/math",tooltip:{ADD:a.Util.lf("Return the sum of the two numbers."),MINUS:a.Util.lf("Return the difference of the two numbers."),MULTIPLY:a.Util.lf("Return the product of the two numbers."),DIVIDE:a.Util.lf("Return the quotient of the two numbers."),POWER:a.Util.lf("Return the first number raised to the power of the second number.")},operators:{OP:["ADD","MINUS","MULTIPLY","DIVIDE","POWER"]},category:"math",block:{MATH_ADDITION_SYMBOL:a.Util.lf("{id:op}+"),MATH_SUBTRACTION_SYMBOL:a.Util.lf("{id:op}-"),MATH_MULTIPLICATION_SYMBOL:a.Util.lf("{id:op}"),MATH_DIVISION_SYMBOL:a.Util.lf("{id:op}/"),MATH_POWER_SYMBOL:a.Util.lf("{id:op}**")}},math_modulo:{name:a.Util.lf("division remainder"),tooltip:a.Util.lf("Return the remainder from dividing the two numbers."),url:"/blocks/math",category:"math",block:{MATH_MODULO_TITLE:a.Util.lf("remainder of %1 / %2")}},math_js_op:{name:a.Util.lf("math function"),tooltip:{sqrt:a.Util.lf("Returns the square root of the argument"),sin:a.Util.lf("Returns the sine of the argument"),cos:a.Util.lf("Returns the cosine of the argument"),acos:a.Util.lf("Returns the arccosine of the argument"),asine:a.Util.lf("Returns the arcsine of the argument"),tan:a.Util.lf("Returns the tangent of the argument"),atan2:a.Util.lf("Returns the arctangent of the quotient of the two arguments"),idiv:a.Util.lf("Returns the integer portion of the division operation on the two arguments"),imul:a.Util.lf("Returns the integer portion of the multiplication operation on the two arguments")},url:"/blocks/math",operators:{OP:["sqrt","sin","cos","tan","atan2","idiv","imul"]},category:"math",block:{sqrt:a.Util.lf("{id:op}square root"),sin:a.Util.lf("{id:op}sin"),cos:a.Util.lf("{id:op}cos"),asin:a.Util.lf("{id:op}asin"),acos:a.Util.lf("{id:op}acos"),tan:a.Util.lf("{id:op}tan"),atan2:a.Util.lf("{id:op}atan2"),idiv:a.Util.lf("{id:op}integer /"),imul:a.Util.lf("{id:op}integer ")}},math_js_round:{name:a.Util.lf("rounding functions"),tooltip:{round:a.Util.lf("Increases the argument to the next higher whole number if its fractional part is more than one half"),ceil:a.Util.lf("Increases the argument to the next higher whole number"),floor:a.Util.lf("Decreases the argument to the next lower whole number"),trunc:a.Util.lf("Removes the fractional part of the argument")},url:"/blocks/math",operators:{OP:["round","ceil","floor","trunc"]},category:"math",block:{round:a.Util.lf("{id:op}round"),ceil:a.Util.lf("{id:op}ceiling"),floor:a.Util.lf("{id:op}floor"),trunc:a.Util.lf("{id:op}truncate")}},variables_change:{name:a.Util.lf("update the value of a number variable"),tooltip:a.Util.lf("Changes the value of the variable by this amount"),url:"/blocks/variables/change",category:"variables",block:{message0:a.Util.lf("change %1 by %2")}},controls_repeat_ext:{name:a.Util.lf("a loop that repeats and increments an index"),tooltip:a.Util.lf("Do some statements several times."),url:"/blocks/loops/repeat",category:"loops",block:{CONTROLS_REPEAT_TITLE:a.Util.lf("repeat %1 times"),CONTROLS_REPEAT_INPUT_DO:a.Util.lf("{id:repeat}do")}},variables_get:{name:a.Util.lf("get the value of a variable"),tooltip:a.Util.lf("Returns the value of this variable."),url:"/blocks/variables",category:"variables",block:{VARIABLES_GET_CREATE_SET:a.Util.lf("Create 'set %1'")}},variables_get_reporter:{name:a.Util.lf("get the value of a variable"),tooltip:a.Util.lf("Returns the value of this variable."),url:"/blocks/variables",category:"variables",block:{VARIABLES_GET_CREATE_SET:a.Util.lf("Create 'set %1'")}},variables_set:{name:a.Util.lf("assign the value of a variable"),tooltip:a.Util.lf("Sets this variable to be equal to the input."),url:"/blocks/variables/assign",category:"variables",block:{VARIABLES_SET:a.Util.lf("set %1 to %2")}},controls_if:{name:a.Util.lf("a conditional statement"),tooltip:{CONTROLS_IF_TOOLTIP_1:a.Util.lf("If a value is true, then do some statements."),CONTROLS_IF_TOOLTIP_2:a.Util.lf("If a value is true, then do the first block of statements. Otherwise, do the second block of statements."),CONTROLS_IF_TOOLTIP_3:a.Util.lf("If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements."),CONTROLS_IF_TOOLTIP_4:a.Util.lf("If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.")},tooltipSearch:"CONTROLS_IF_TOOLTIP_2",url:"/blocks/logic/if",category:"logic",block:{CONTROLS_IF_MSG_IF:a.Util.lf("{id:logic}if"),CONTROLS_IF_MSG_THEN:a.Util.lf("{id:logic}then"),CONTROLS_IF_MSG_ELSE:a.Util.lf("{id:logic}else"),CONTROLS_IF_MSG_ELSEIF:a.Util.lf("{id:logic}else if")}},lists_create_with:{name:a.Util.lf("create an array"),tooltip:a.Util.lf("Creates a new array."),url:"/reference/arrays/create",category:"arrays",blockTextSearch:"LISTS_CREATE_WITH_INPUT_WITH",block:{LISTS_CREATE_EMPTY_TITLE:a.Util.lf("empty array"),LISTS_CREATE_WITH_INPUT_WITH:a.Util.lf("array of"),LISTS_CREATE_WITH_CONTAINER_TITLE_ADD:a.Util.lf("array"),LISTS_CREATE_WITH_ITEM_TITLE:a.Util.lf("value")}},lists_length:{name:a.Util.lf("array length"),tooltip:a.Util.lf("Returns the number of items in an array."),url:"/reference/arrays/length",category:"arrays",block:{LISTS_LENGTH_TITLE:a.Util.lf("length of array %1")}},lists_index_get:{name:a.Util.lf("get a value in an array"),tooltip:a.Util.lf("Returns the value at the given index in an array."),url:"/reference/arrays/get",category:"arrays",block:{message0:a.Util.lf("%1 get value at %2")}},lists_index_set:{name:a.Util.lf("set a value in an array"),tooltip:a.Util.lf("Sets the value at the given index in an array"),url:"/reference/arrays/set",category:"arrays",block:{message0:a.Util.lf("%1 set value at %2 to %3")}},logic_compare:{name:a.Util.lf("comparing two numbers"),tooltip:{LOGIC_COMPARE_TOOLTIP_EQ:a.Util.lf("Return true if both inputs equal each other."),LOGIC_COMPARE_TOOLTIP_NEQ:a.Util.lf("Return true if both inputs are not equal to each other."),LOGIC_COMPARE_TOOLTIP_LT:a.Util.lf("Return true if the first input is smaller than the second input."),LOGIC_COMPARE_TOOLTIP_LTE:a.Util.lf("Return true if the first input is smaller than or equal to the second input."),LOGIC_COMPARE_TOOLTIP_GT:a.Util.lf("Return true if the first input is greater than the second input."),LOGIC_COMPARE_TOOLTIP_GTE:a.Util.lf("Return true if the first input is greater than or equal to the second input.")},url:"/blocks/logic/boolean",category:"logic",block:{search:"=  <  > "}},logic_operation:{name:a.Util.lf("boolean operation"),tooltip:{LOGIC_OPERATION_TOOLTIP_AND:a.Util.lf("Return true if both inputs are true."),LOGIC_OPERATION_TOOLTIP_OR:a.Util.lf("Return true if at least one of the inputs is true.")},url:"/blocks/logic/boolean",category:"logic",block:{LOGIC_OPERATION_AND:a.Util.lf("{id:op}and"),LOGIC_OPERATION_OR:a.Util.lf("{id:op}or")}},logic_negate:{name:a.Util.lf("logical negation"),tooltip:a.Util.lf("Returns true if the input is false. Returns false if the input is true."),url:"/blocks/logic/boolean",category:"logic",block:{LOGIC_NEGATE_TITLE:a.Util.lf("not %1")}},logic_boolean:{name:a.Util.lf("a `true` or `false` value"),tooltip:a.Util.lf("Returns either true or false."),url:"/blocks/logic/boolean",category:"logic",block:{LOGIC_BOOLEAN_TRUE:a.Util.lf("{id:boolean}true"),LOGIC_BOOLEAN_FALSE:a.Util.lf("{id:boolean}false")}},text:{name:a.Util.lf("a piece of text"),tooltip:a.Util.lf("A letter, word, or line of text."),url:"/types/string",category:"text",block:{search:a.Util.lf("a piece of text")}},text_length:{name:a.Util.lf("number of characters in the string"),tooltip:a.Util.lf("Returns the number of letters (including spaces) in the provided text."),url:"/reference/text/length",category:"text",block:{TEXT_LENGTH_TITLE:a.Util.lf("length of %1")}},text_join:{name:a.Util.lf("join items to create text"),tooltip:a.Util.lf("Create a piece of text by joining together any number of items."),url:"/reference/text/join",category:"text",block:{TEXT_JOIN_TITLE_CREATEWITH:a.Util.lf("join")}},procedures_defnoreturn:{name:a.Util.lf("define the function"),tooltip:a.Util.lf("Create a function."),url:"/types/function/define",category:"functions",block:{PROCEDURES_DEFNORETURN_TITLE:a.Util.lf("function"),PROCEDURE_ALREADY_EXISTS:a.Util.lf("A function named '%1' already exists.")}},procedures_callnoreturn:{name:a.Util.lf("call the function"),tooltip:a.Util.lf("Call the user-defined function."),url:"/types/function/call",category:"functions",block:{PROCEDURES_CALLNORETURN_TITLE:a.Util.lf("call function")}},function_return:{name:a.Util.lf("return a value from within a function"),tooltip:a.Util.lf("Return a value from within a user-defined function."),url:"/types/function/return",category:"functions",block:{message_with_value:a.Util.lf("return %1"),message_no_value:a.Util.lf("return")}},function_definition:{name:a.Util.lf("define the function"),tooltip:a.Util.lf("Create a function."),url:"/types/function/define",category:"functions",block:{FUNCTIONS_EDIT_OPTION:a.Util.lf("Edit Function")}},function_call:{name:a.Util.lf("call the function"),tooltip:a.Util.lf("Call the user-defined function."),url:"/types/function/call",category:"functions",block:{FUNCTIONS_CALL_TITLE:a.Util.lf("call"),FUNCTIONS_GO_TO_DEFINITION_OPTION:a.Util.lf("Go to Definition")}},function_call_output:{name:a.Util.lf("call the function with a return value"),tooltip:a.Util.lf("Call the user-defined function with a return value."),url:"/types/function/call",category:"functions",block:{}}})[pxtc.ON_START_TYPE]={name:a.Util.lf("on start event"),tooltip:a.Util.lf("Run code when the program starts"),url:"/blocks/on-start",category:"loops",block:{message0:a.Util.lf("on start %1 %2")}},i[pxtc.PAUSE_UNTIL_TYPE]={name:a.Util.lf("pause until"),tooltip:a.Util.lf("Pause execution of code until the given boolean expression is true"),url:"/blocks/pause-until",category:"loops",block:{message0:a.Util.lf("pause until %1")}},i[pxtc.TS_BREAK_TYPE]={name:a.Util.lf("break"),tooltip:a.Util.lf("Break out of the current loop or switch"),url:"/blocks/loops/break",category:"loops",block:{message0:a.Util.lf("break")}},i[pxtc.TS_CONTINUE_TYPE]={name:a.Util.lf("continue"),tooltip:a.Util.lf("Skip current iteration and continues with the next iteration in the loop"),url:"/blocks/loops/continue",category:"loops",block:{message0:a.Util.lf("continue")}},a.blocks.showBlockIdInTooltip)for(var e of Object.keys(i)){var t=i[e].tooltip;if("object"==typeof t&&null!==t)for(var r in t)t.hasOwnProperty(r)&&(i[e].tooltip[r]=`${t[r]} (id: ${e})`);else i[e].tooltip=`${i[e].tooltip} (id: ${e})`}}y.blockDefinitions=function(){return i||t(),i},y.getBlockDefinition=function(e){return i||t(),i[e]},y.initInContextTranslationAsync=async function(){i||t();let n={};return await Promise.all(a.Util.values(i).filter(e=>e.block).map(async r=>{var e=Object.keys(r.block);r.translationIds=a.Util.values(r.block),await Promise.all(e.map(async e=>{var t=await a.crowdin.inContextLoadAsync(r.block[e]);r.block[e]=t,/^[A-Z_]+$/.test(e)&&(n[e]=t)}))})),n}}})(pxt=pxt||{}),(u=>{{var o=u.BrowserUtils||(u.BrowserUtils={});function s(){return"undefined"!=typeof navigator}function e(){return s()&&/(Win32|Win64|WOW64)/i.test(navigator.platform)}function l(){return s()&&/mobi/i.test(navigator.userAgent)}function c(){return s()&&/Mac/i.test(navigator.platform)}function d(){return!!navigator&&/Linux/i.test(navigator.platform)}function p(){return s()&&/arm/i.test(navigator.platform)}function h(){return s()&&/Edge/i.test(navigator.userAgent)}function m(){return s()&&/Trident/i.test(navigator.userAgent)}function g(){return!h()&&!m()&&!!navigator&&(/Chrome/i.test(navigator.userAgent)||/Chromium/i.test(navigator.userAgent))}function f(){return!g()&&!h()&&!!navigator&&/(Macintosh|Safari|iPod|iPhone|iPad)/i.test(navigator.userAgent)}function _(){return!f()&&!!navigator&&(/Firefox/i.test(navigator.userAgent)||/Seamonkey/i.test(navigator.userAgent))}function y(){return s()&&/Opera|OPR/i.test(navigator.userAgent)}function b(){return s()&&/Midori/i.test(navigator.userAgent)}function v(){return s()&&/Epiphany/i.test(navigator.userAgent)}function T(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator&&0<navigator.maxTouchPoints)}function k(){return"undefined"!=typeof window&&!!window.pxtElectron}function x(){return"undefined"!=typeof window&&!!window.ipcRenderer}function E(){return k()||x()}function S(e){var t;try{return"undefined"!=typeof window&&/^https?:\/\/(?:localhost|127\.0\.0\.1|192\.168\.\d{1,3}\.\d{1,3}|[a-zA-Z0-9.-]+\.local):\d+\/?/.test(window.location.href)&&(e||!/nolocalhost=1/.test(window.location.href))&&!(null!=(t=null==u?void 0:u.webConfig)&&t.isStatic)}catch(e){return!1}}function C(){return"undefined"!=typeof window&&!!window.PointerEvent}function w(){return e()?"windows":c()?"mac":d()&&p()?"rpi":d()?"linux":"unknown"}function I(){return h()?"edge":v()?"epiphany":b()?"midori":y()?"opera":m()?"ie":g()?"chrome":f()?"safari":_()?"firefox":"unknown"}function A(){if(!s())return null;let e=[];return y()&&(e=/(Opera|OPR)\/([0-9\.]+)/i.exec(navigator.userAgent)),(e=v()?/Epiphany\/([0-9\.]+)/i.exec(navigator.userAgent):b()?/Midori\/([0-9\.]+)/i.exec(navigator.userAgent):f()?(e=/Version\/([0-9\.]+)/i.exec(navigator.userAgent))||/(Macintosh|iPod( touch)?|iPhone|iPad); (CPU|Intel).*?OS (X )?(\d+)/i.exec(navigator.userAgent):(g()?/(Chrome|Chromium)\/([0-9\.]+)/i:h()?/Edge\/([0-9\.]+)/i:m()?/(MSIE |rv:)([0-9\.]+)/i:/(Firefox|Seamonkey)\/([0-9\.]+)/i).exec(navigator.userAgent))&&0!=e.length?e[e.length-1]:null}o.isDocumentVisible=function(){return"undefined"!=typeof window&&"visible"===document.visibilityState},o.isIFrame=function(){try{return window&&window.self!==window.top}catch(e){return!0}},o.hasNavigator=s,o.hasWindow=function(){return"undefined"!=typeof window},o.isWindows=e,o.isWindows10=function(){return s()&&/(Win32|Win64|WOW64)/i.test(navigator.platform)&&/Windows NT 10/i.test(navigator.userAgent)},o.isMobile=l,o.isIOS=function(){return s()&&(/iPad|iPhone|iPod/.test(navigator.userAgent)||"MacIntel"===navigator.platform&&1<navigator.maxTouchPoints)},o.isAndroid=function(){return s()&&/android/i.test(navigator.userAgent)},o.isMac=c,o.isLinux=d,o.isARM=p,o.isEdge=h,o.isChromiumEdge=function(){return s()&&/Edg\//i.test(navigator.userAgent)},o.isIE=m,o.isChrome=g,o.isSafari=f,o.isFirefox=_,o.isOpera=y,o.isMidori=b,o.isEpiphany=v,o.isTouchEnabled=T,o.isPxtElectron=k,o.isIpcRenderer=x,o.isElectron=E,o.isWinRT=()=>"undefined"!=typeof Windows,o.isLocalHost=S,o.isLocalHostDev=function(){return S()&&!E()},o.isSkillmapEditor=function(){try{return/skill(?:s?)map=1/i.test(window.location.href)}catch(e){return!1}},o.isTabletSize=function(){return(null==window?void 0:window.innerWidth)<=u.BREAKPOINT_TABLET},o.isComputerSize=function(){return(null==window?void 0:window.innerWidth)>u.BREAKPOINT_TABLET},o.isInGame=function(){return!!/inGame=1/i.exec(window.location.href)},o.hasFileAccess=function(){var e=u.appTarget.appTheme.disableFileAccessinMaciOs&&(u.BrowserUtils.isMac()||u.BrowserUtils.isIOS()),t=u.appTarget.appTheme.disableFileAccessinAndroid&&u.BrowserUtils.isAndroid();return!e&&!t},o.noSharedLocalStorage=function(){try{return/nosharedlocalstorage/i.test(window.location.href)}catch(e){return!1}},o.useOldTutorialLayout=function(){var e;if(null!=(e=null==(e=u.appTarget)?void 0:e.appTheme)&&e.legacyTutorial)return!0;try{return/tutorialview=old/.test(window.location.href)}catch(e){return!1}},o.hasPointerEvents=C,o.os=w,o.browser=I,o.browserVersion=A;let a=!1;function V(){return l()&&f()&&!/downloadWindowOpen=0/i.test(window.location.href)}function D(t,e,r){var n=V(),i=A(),s=parseInt(i||"0");if(n)r?r.location.href=t:window.open(t,"_self");else if(u.BrowserUtils.isSafari()&&(s<10||0==i.indexOf("10.0")||l())){let e=document.getElementById("downloader");e||(u.debug("injecting downloader iframe"),(e=document.createElement("iframe")).id="downloader",e.style.position="absolute",e.style.right="0",e.style.bottom="0",e.style.zIndex="-1",e.style.width="1px",e.style.height="1px",document.body.appendChild(e)),e.src=t}else/^data:/i.test(t)&&(u.BrowserUtils.isEdge()||u.BrowserUtils.isIE())?(n=atob(t.split(",")[1]),r=u.Util.stringToUint8Array(n),s=new Blob([r],{type:"img/png"}),window.navigator.msSaveOrOpenBlob(s,e)):"string"==typeof(i=window.document.createElement("a")).download?(i.href=t,i.download=e,document.body.appendChild(i),i.click(),document.body.removeChild(i)):document.location.href=t}function H(e,t){let r="data";l()&&f()&&u.appTarget.appTheme.mobileSafariDownloadProtocol&&(r=u.appTarget.appTheme.mobileSafariDownloadProtocol);var n=/downloadProtocol=([a-z0-9:/?]+)/i.exec(window.location.href);return(r=n?n[1]:r)+":"+t+";base64,"+e}function N(e,t,r={}){u.debug("trigger download");var n,{contentType:r="application/octet-stream",userContextWindow:i,onError:s,maintainObjectURL:a}=r,o=null==(o=window.URL)?void 0:o.createObjectURL,l=u.appTarget.appTheme.disableBlobObjectDownload;let c;try{o&&!l?(D(n=o(new Blob([u.Util.stringToUint8Array(atob(e))],{type:r})),t,i),a?c=n:window.setTimeout(()=>window.URL.revokeObjectURL(c),0)):D(c=H(e,t),t,i)}catch(e){s&&s(e),u.debug("saving failed")}return c}function G(r){let n=document.createElement("img");return new Promise((e,t)=>{n.onload=()=>e(n),n.onerror=()=>e(void 0),n.crossOrigin="anonymous",n.src=r})}function O(e){return/^https?:\/\//i.test(e)?e:(window.MonacoPaths||{})[e]||(u.U.startsWith(e,u.webConfig.commitCdnUrl)?e:u.webConfig.commitCdnUrl+e)}o.isBrowserSupported=function(){var e,t,r,n,i,s;return!navigator||!!/bot|crawler|spider|crawling/i.test(navigator.userAgent)||(null==(e=(null==(e=u.appTarget)?void 0:e.unsupportedBrowsers)||(null==(e=window.pxtTargetBundle)?void 0:e.unsupportedBrowsers))||!e.some(e=>e.id==I()))&&(e=A(),n=parseInt(e||"0"),s=g()&&38<=n,i=_()&&31<=n,t=h(),r=f()&&9<=n,n=y()&&g()&&21<=n,s=s||i||t||r||n,i=b()||d()&&p()&&v(),s=(s=s&&!i)||/anybrowser=(true|1)/.test(window.location.href),a||(u.log(`Browser: ${I()} ${e} on `+w()),s||u.tickEvent("browser.unsupported",{useragent:navigator.userAgent}),a=!0),s)},o.devicePixelRatio=function(){var e,t;return"undefined"!=typeof window&&window.screen?(e=window.screen.systemXDPI,t=window.screen.logicalXDPI,void 0!==e&&void 0!==t&&t<e?e/t:window&&void 0!==window.devicePixelRatio?window.devicePixelRatio:1):1},o.browserDownloadBinText=function(e,t,r){return N(ts.pxtc.encodeBase64(e),t,r)},o.browserDownloadText=function(e,t,r){return N(ts.pxtc.encodeBase64(u.Util.toUTF8(e)),t,r)},o.isBrowserDownloadInSameWindow=V,o.isBrowserDownloadWithinUserContext=function(){var e=A(),e=parseInt(e||"0");return l()&&f()&&11<=e||/downloadUserContext=1/i.test(window.location.href)},o.browserDownloadDataUri=D,o.browserDownloadUInt8Array=function(e,t,r){return N(ts.pxtc.encodeBase64(u.Util.uint8ArrayToString(e)),t,r)},o.toDownloadDataUri=H,o.browserDownloadBase64=N,o.loadImageAsync=G,o.loadCanvasAsync=function(e){return G(e).then(e=>{var t=document.createElement("canvas");return t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t})},o.scaleImageData=function(e,t){var r=document.createElement("canvas"),n=document.createElement("canvas"),i=(r.width=e.width,r.height=e.height,n.width=e.width*t,n.height=e.height*t,r.getContext("2d")),n=n.getContext("2d");return i.putImageData(e,0,0),n.imageSmoothingEnabled=!1,n.scale(t,t),n.drawImage(r,0,0),n.getImageData(0,0,e.width*t,e.height*t)},o.imageDataToPNG=function(e,t=1){var r,n,i,s;if(e)return r=document.createElement("canvas"),n=document.createElement("canvas"),r.width=e.width,r.height=e.height,n.width=e.width*t,n.height=e.height*t,i=r.getContext("2d"),s=n.getContext("2d"),i.putImageData(e,0,0),s.imageSmoothingEnabled=!1,s.scale(t,t),s.drawImage(r,0,0),n.toDataURL("image/png")},o.encodeToPngAsync=function(r,e){let{width:s,height:a,pixelDensity:o=4,maxSize:l=1e7,text:c}=e||{};return new Promise((n,e)=>{let i=new Image;i.onload=function(){let t=document.createElement("canvas");var e=t.getContext("2d");t.width=(s||i.width)*o,t.height=(a||i.height)*o,c&&(e.fillStyle="#fff",e.fillRect(0,0,t.width,t.height)),e.drawImage(i,0,0,s,a,0,0,t.width,t.height);let r=t.toDataURL("image/png");for(;r.length>l;)t.width=t.width/2>>0,t.height=t.height/2>>0,u.debug(`screenshot size ${r.length}b, shrinking to ${t.width}x`+t.height),e.drawImage(i,0,0,s,a,0,0,t.width,t.height),r=t.toDataURL("image/png");c?u.lzmaCompressAsync(c).then(e=>{e=u.Util.encodeBlobAsync(t,e);n(e.toDataURL("image/png"))}):n(r)},i.onerror=e=>{u.reportError("png","png rendering failed"),n(void 0)};try{var t=new URL(r);"http:"!==t.protocol&&"https:"!==t.protocol||t.host===window.location.host||i.setAttribute("crossOrigin","anonymous")}catch(e){}i.src=r})},o.resolveCdnUrl=O,o.loadStyleAsync=function(e,t){let n="style-"+(e=t?"rtl"+e:e);if(document.getElementById(n))return Promise.resolve();let i=O(e);return(t=u.Util.toArray(document.head.getElementsByTagName("link")).filter(e=>e.getAttribute("href")==i)[0])?(t.id||(t.id=n),Promise.resolve()):new Promise((e,t)=>{var r=document.createElement("link");r.href=i,r.rel="stylesheet",r.type="text/css",r.id=n,r.addEventListener("load",()=>e()),r.addEventListener("error",e=>t(e)),document.head.appendChild(r)})};let i={};o.loadScriptAsync=function(e){let n=O(e),t=i[n];return t=t||(i[n]=new Promise((e,t)=>{u.debug("script: loading "+n);var r=document.createElement("script");r.type="text/javascript",r.addEventListener("load",()=>e()),r.addEventListener("error",e=>{delete i[n],t(e)}),r.src=n,r.async=!0,document.body.appendChild(r)}))},o.loadAjaxAsync=function(n){return new Promise((e,t)=>{let r=new XMLHttpRequest;r.onreadystatechange=function(){r.readyState==XMLHttpRequest.DONE&&(200==r.status?e(r.responseText):t(r.status))},r.open("GET",n,!0),r.send()})};let t;function j(e,t){return e?t?(e.indexOf("/")==e.length-1?e.substring(0,e.length-1):e)+"/"+(0==t.indexOf("/")?t.substring(1):t):e:t}function K(){var e=s()&&window.navigator;return e&&e.storage&&e.storage.estimate?e.storage.estimate():Promise.resolve({})}o.loadBlocklyAsync=function(){if(!t){u.debug("blockly: delay load");let e=u.BrowserUtils.loadStyleAsync("blockly.css",ts.pxtc.Util.isUserLanguageRtl());e=e.then(()=>{u.debug("blockly: loaded")}),t=e}return t},o.patchCdn=function(e){var t;return e&&((t=u.getOnlineCdnUrl())?e.replace("@cdnUrl@",t):e.replace(/@cdnUrl@\/(blob|commit)\/[a-f0-9]{40}\//,"./"))},o.initTheme=function(){var e,t,r=u.appTarget.appTheme;r&&r.accentColor&&((e=document.createElement("style")).type="text/css",e.appendChild(document.createTextNode(`.ui.accent { color: ${r.accentColor}; }
                .ui.inverted.menu .accent.active.item, .ui.inverted.accent.menu  { background-color: ${r.accentColor}; }`)),document.getElementsByTagName("head")[0].appendChild(e)),u.Util.isUserLanguageRtl()&&(u.debug("rtl layout"),u.BrowserUtils.addClass(document.body,"rtl"),document.body.style.direction="rtl",(e=(r=u.Util.toArray(document.head.getElementsByTagName("link"))).filter(e=>u.Util.endsWith(e.getAttribute("href"),"semantic.css"))[0])&&(t=e.getAttribute("data-rtl"))&&(u.debug("swapping to "+t),e.setAttribute("href",t)),e=r.filter(e=>u.Util.endsWith(e.getAttribute("href"),"blockly.css"))[0])&&(t=e.getAttribute("data-rtl"))&&(u.debug("swapping to "+t),e.setAttribute("href",t),e.removeAttribute("data-rtl"))},o.changeHash=function(e,t){"#"!=e.charAt(0)&&(e="#"+e),t?window.location.hash=e:window.history.replaceState("","",e)},o.urlJoin=j,o.joinURLs=function(...t){let r;if(t)for(let e=0;e<t.length;e++)r=j(r,t[e]);return r},o.storageEstimateAsync=K,o.scheduleStorageCleanup=s()&&navigator.storage&&navigator.storage.estimate?ts.pxtc.Util.throttle(function(){K().then(e=>(u.debug(`storage estimate: ${e.usage/e.quota*100>>0}%, ${e.usage/1e6>>0}/${e.quota/1e6>>0}Mb`),e.quota&&e.usage&&1e6<e.quota&&.9<e.usage/e.quota?(u.log("quota usage exceeded, clearing translations"),u.tickEvent("storage.cleanup"),R()):Promise.resolve())).catch(e=>{u.reportException(e)})},1e4,!1):()=>{},o.stressTranslationsAsync=function t(){let r="...";for(let e=0;e<16;++e)r+=r+Math.random();return u.log(`adding entry ${2*r.length} bytes`),u.U.delay(1).then(()=>z()).then(e=>e.setAsync("foobar",Math.random().toString(),null,void 0,r)).then(()=>u.BrowserUtils.storageEstimateAsync()).then(e=>!e.quota||e.usage/e.quota<.8?t():Promise.resolve())};class M{constructor(){this.translations={}}key(e,t){return e+`|${t}|master`}get(e,t){return this.translations[this.key(e,t)]}getAsync(e,t){return Promise.resolve(this.get(e,t))}set(e,t,r,n,i,s){this.translations[this.key(e,t)]={etag:r,time:n,strings:i,md:s}}setAsync(e,t,r,n,i){return this.set(e,t,r,u.Util.now(),n),Promise.resolve()}clearAsync(){return this.translations={},Promise.resolve()}}class F{constructor(e,t,r,n,i=!1){this.name=e,this.version=t,this.upgradeHandler=r,this.quotaExceededHandler=n,this.skipErrorLog=i}throwIfNotOpened(){if(!this._db)throw new Error("Database not opened; call IDBWrapper.openAsync() first")}errorHandler(e,t,r){this.skipErrorLog?r(e):(u.error(new Error(this.name+` IDBWrapper error for ${t}: `+e.message)),r(e),"QuotaExceededError"==e.name&&(u.log("storage quota exceeded..."),u.tickEvent("storage.quotaexceedederror"),this.quotaExceededHandler)&&this.quotaExceededHandler())}getObjectStore(e,t="readonly"){return this.throwIfNotOpened(),this._db.transaction([e],t).objectStore(e)}static deleteDatabaseAsync(n){return new Promise((e,t)=>{let r=(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB).deleteDatabase(n);r.onsuccess=()=>e(),r.onerror=()=>t(r.error)})}openAsync(){return new Promise((e,t)=>{let r=(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB).open(this.name,this.version);r.onsuccess=()=>{this._db=r.result,e()},r.onerror=()=>this.errorHandler(r.error,"open",t),r.onupgradeneeded=e=>this.upgradeHandler(e,r)})}getAsync(n,i){return new Promise((e,t)=>{let r=this.getObjectStore(n).get(i);r.onsuccess=()=>e(r.result),r.onerror=()=>this.errorHandler(r.error,"get",t)})}getAllAsync(i){return new Promise((e,t)=>{let r=this.getObjectStore(i).openCursor(),n=[];r.onsuccess=()=>{r.result?(n.push(r.result.value),r.result.continue()):e(n)},r.onerror=()=>this.errorHandler(r.error,"getAll",t)})}setAsync(i,s){return new Promise((e,t)=>{var r=this.getObjectStore(i,"readwrite");let n;(n=null!=s.id?r.put(s):r.add(s)).onsuccess=()=>e(),n.onerror=()=>this.errorHandler(n.error,"set",t)})}deleteAsync(n,i){return new Promise((e,t)=>{let r=this.getObjectStore(n,"readwrite").delete(i);r.onsuccess=()=>e(),r.onerror=()=>this.errorHandler(r.error,"delete",t)})}deleteAllAsync(n){return new Promise((e,t)=>{let r=this.getObjectStore(n,"readwrite").clear();r.onsuccess=()=>e(),r.onerror=()=>this.errorHandler(r.error,"deleteAll",t)})}getObjectStoreWrapper(e){return new B(this,e)}}o.IDBWrapper=F;class B{constructor(e,t){this.db=e,this.storeName=t}getAsync(e){return this.db.getAsync(this.storeName,e)}getAllAsync(){return this.db.getAllAsync(this.storeName)}setAsync(e){return this.db.setAsync(this.storeName,e)}async deleteAsync(e){await this.db.deleteAsync(this.storeName,e)}async deleteAllAsync(){await this.db.deleteAllAsync(this.storeName)}}o.IDBObjectStoreWrapper=B;class ${constructor(e){this.db=e,this.mem=new M}static dbName(){return"__pxt_translations_"+(u.appTarget.id||"")}static createAsync(){function t(){let e=new F($.dbName(),2,(e,t)=>{t.result.createObjectStore($.TABLE,{keyPath:$.KEYPATH})},()=>{R().catch(e=>{})});return e.openAsync().then(()=>new $(e))}return t().catch(e=>(u.log("db: failed to open database, try delete entire store..."),F.deleteDatabaseAsync($.dbName()).then(()=>t())))}getAsync(t,r){t=(t||"en-US").toLowerCase();var e=this.mem.key(t,r),n=this.mem.get(t,r);return n?Promise.resolve(n):this.db.getAsync($.TABLE,e).then(e=>e?(this.mem.set(t,r,e.etag,e.time,e.strings),Promise.resolve(e)):Promise.resolve(void 0)).catch(e=>Promise.resolve(void 0))}setAsync(e,t,r,n,i){e=(e||"en-US").toLowerCase();var s=this.mem.key(e,t),a=u.Util.now(),e=(this.mem.set(e,t,r,a,n,i),n&&Object.keys(n).filter(e=>!n[e]).forEach(e=>delete n[e]),{id:s,etag:r,time:a,strings:n,md:i});return this.db.setAsync($.TABLE,e).finally(()=>o.scheduleStorageCleanup()).catch(e=>(u.log(`db: set failed (${e.message}), recycling...`),this.clearAsync()))}clearAsync(){return this.db.deleteAllAsync($.TABLE).then(()=>u.debug("db: all clean")).catch(e=>{u.error("db: failed to delete all")})}}$.TABLE="files",$.KEYPATH="id";let r;function z(){return u.Util.isNodeJS?Promise.resolve(new M):r=r||$.createAsync().catch(()=>new M)}function R(){function t(){let t=$.dbName();return F.deleteDatabaseAsync(t).then(()=>{r=void 0}).catch(e=>{u.log("db: failed to delete "+t),r=void 0})}return r?r.then(e=>e.clearAsync()).catch(e=>t().then()):t()}function L(e){e=JSON.stringify(e)+u.appTarget.versions.pxt+"_"+u.appTarget.versions.target;return pxtc.U.sha256(e)}function W(e,t){return e+"|"+(t||"master")}o.translationDbAsync=z,o.clearTranslationDbAsync=R,o.getTutorialCodeHash=L;class U{constructor(e){this.db=e}static dbName(){return"__pxt_tutorialinfo_"+(u.appTarget.id||"")}static createAsync(){function t(){let e=new u.BrowserUtils.IDBWrapper(U.dbName(),2,(e,t)=>{t.result.createObjectStore(U.TABLE,{keyPath:U.KEYPATH})},()=>{u.BrowserUtils.IDBWrapper.deleteDatabaseAsync(U.dbName())});return e.openAsync().then(()=>new U(e))}return t().catch(e=>(u.log("db: failed to open tutorial info database, try delete entire store..."),u.BrowserUtils.IDBWrapper.deleteDatabaseAsync(U.dbName()).then(()=>t())))}getAsync(e,t,r){let n=W(e,r),i=L(t);return this.db.getAsync(U.TABLE,n).then(e=>{if(e&&e.hash==i&&u.Util.now()-(e.time||0)<864e5)return e;this.db.deleteAsync(U.TABLE,n)})}setAsync(e,t,r,n,i,s){u.perf.measureStart(Measurements.TutorialInfoDbSetAsync);r=L(r);return this.setWithHashAsync(e,t,r,n,i)}setWithHashAsync(e,r,t,n,i,s){u.perf.measureStart(Measurements.TutorialInfoDbSetAsync);e=W(e,s);let a={};Object.keys(r).forEach(t=>{Object.keys(r[t]).forEach(e=>{a[e]=r[t][e]})});s={id:e,time:u.Util.now(),hash:t,snippets:r,blocks:a,highlightBlocks:n,validateBlocks:i};return this.db.setAsync(U.TABLE,s).then(()=>{u.perf.measureEnd(Measurements.TutorialInfoDbSetAsync)})}clearAsync(){return this.db.deleteAllAsync(U.TABLE).then(()=>u.debug("db: all clean")).catch(e=>{u.error("db: failed to delete all")})}}U.TABLE="info",U.KEYPATH="id";let n;function P(e){return e.split(/\s+/).filter(e=>!!e)}function q(){var e=new RegExp(u.Util.escapeForRegex(u.Util.pxtLangCookieId)+"=(.*?)(?:;|$)").exec(document.cookie);return e&&e[1]||null}o.tutorialInfoDbAsync=function(){return n=n||U.createAsync()},o.clearTutorialInfoDbAsync=function(){function t(){let t=U.dbName();return F.deleteDatabaseAsync(t).then(()=>{n=void 0}).catch(e=>{u.log("db: failed to delete "+t),n=void 0})}return n?n.then(e=>e.clearAsync()).catch(e=>t().then()):t()},o.pointerEvents=C()?{up:"pointerup",down:["pointerdown"],move:"pointermove",enter:"pointerenter",leave:"pointerleave"}:T()?{up:"mouseup",down:["mousedown","touchstart"],move:"touchmove",enter:"touchenter",leave:"touchend"}:{up:"mouseup",down:["mousedown"],move:"mousemove",enter:"mouseenter",leave:"mouseleave"},o.getPageX=function(e){return("pageX"in e?e:e.changedTouches[0]).pageX},o.getPageY=function(e){return("pageY"in e?e:e.changedTouches[0]).pageY},o.getClientX=function(e){return("clientX"in e?e:e.changedTouches[0]).clientX},o.getClientY=function(e){return("clientY"in e?e:e.changedTouches[0]).clientY},o.popupWindow=function(e,t,r,n){try{var i=window.screenLeft||window.screenX,s=window.screenTop||window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o="width="+r+", height="+n+", top="+((window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight)/2-n/2+s)+", left="+(a/2-r/2+i),l=window.open(e,t,u.BrowserUtils.isIpcRenderer()?void 0:o);return l.focus&&l.focus(),l}catch(e){return u.tickEvent("pxt.popupError",{msg:e.message}),null}},o.containsClass=function(r,e){return P(e).every(e=>{return e=e,(t=r).classList?t.classList.contains(e):!((t.className+"").split(/\s+/).indexOf(e)<0);var t})},o.addClass=function(r,e){P(e).forEach(e=>{var t;e=e,(t=r).classList?t.classList.add(e):(t.className+"").split(/\s+/).indexOf(e)<0&&(t.className.baseVal+=" "+e)})},o.removeClass=function(r,e){P(e).forEach(e=>{var t;t=e,(e=r).classList?e.classList.remove(t):e.className.baseVal=(e.className+"").split(/\s+/).filter(e=>e!=t).join(" ")})},o.getCookieLang=q,o.setCookieLang=function(e,t=!1){u.Util.allLanguages[e]&&e!==q()&&(u.tickEvent("menu.lang.setcookielang",{lang:e,docs:""+t}),(t=new Date).setTime(t.getTime()+24*u.Util.langCookieExpirationDays*60*60*1e3),document.cookie=`${u.Util.pxtLangCookieId}=${e}; expires=${t.toUTCString()}; path=/`)},o.cacheBustingUrl=function(e){return e&&(/[?&]rnd=/.test(e)?e:`${e}${0<e.indexOf("?")?"&":"?"}rnd=`+Math.random())},o.appendUrlQueryParams=function(e,t){var r,n,i=[];for([r,n]of t.entries())i.push(encodeURIComponent(r)+"="+encodeURIComponent(n));return i.length&&(-1!==e.indexOf("?")?e+="&"+i.join("&"):e+="?"+i.join("&")),e},o.legacyCopyText=function(e){e.focus(),e.setSelectionRange(0,9999);try{var t=document.execCommand("copy");return u.debug("copy: "+t),!!t}catch(e){return!1}},o.setApplicationTheme=function(e){var t=document.body,r=t.classList;for(let e=0;e<r.length;e++)/^theme-/.test(r[e])&&t.classList.remove(r[e]);e&&t.classList.add("theme-"+e)},o.isElement=function(e){return e.nodeType===Node.ELEMENT_NODE}}})(pxt=pxt||{}),(t=>{{var r=t.cloud||(t.cloud={});let e="https://staging.pxt.io";r.DEV_BACKEND=e,r.DEV_REGION="US",r.devBackendType=function(){return"https://makecode.com"===r.DEV_BACKEND?"prod":r.DEV_BACKEND===e?"staging":"http://localhost:8080"===r.DEV_BACKEND?"localhost":"prod"},r.cloudStatus={none:{value:"none"},synced:{value:"synced",icon:"cloud-saved-b",tooltip:lf("Project saved to cloud"),shortStatus:lf("saved"),longStatus:lf("Saved to cloud"),indicator:""},justSynced:{value:"justSynced",icon:"cloud-saved-b",tooltip:lf("Project saved to cloud"),shortStatus:lf("saved!"),longStatus:lf("Saved to cloud!"),indicator:""},offline:{value:"offline",icon:"cloud-error-b",tooltip:lf("Unable to connect to cloud"),shortStatus:lf("offline"),longStatus:lf("Offline"),indicator:lf("offline")},syncing:{value:"syncing",icon:"cloud-saving-b",tooltip:lf("Saving project to cloud..."),shortStatus:lf("saving..."),longStatus:lf("Saving to cloud..."),indicator:lf("syncing...")},conflict:{value:"conflict",icon:"cloud-error-b",tooltip:lf("Project was edited in two places and the changes conflict"),shortStatus:lf("conflict!"),longStatus:lf("Project has a conflict!"),indicator:"!"},localEdits:{value:"localEdits",icon:"cloud-saving-b",tooltip:lf("Project has local changes and will save to cloud soon."),shortStatus:"",longStatus:"",indicator:"*"}}}})(pxt=pxt||{}),(e=>{var r;(e=(r=e.commands||(e.commands={})).WebUSBPairResult||(r.WebUSBPairResult={}))[e.Failed=0]="Failed",e[e.Success=1]="Success",e[e.UserRejected=2]="UserRejected",r.deployCoreAsync=void 0,r.deployFallbackAsync=void 0,r.hasDeployFn=()=>r.deployCoreAsync||r.deployFallbackAsync,r.deployAsync=(e,t)=>(r.deployCoreAsync||r.deployFallbackAsync)(e,t),r.patchCompileResultAsync=void 0,r.browserDownloadAsync=void 0,r.saveOnlyAsync=void 0,r.renderBrowserDownloadInstructions=void 0,r.renderUsbPairDialog=void 0,r.renderIncompatibleHardwareDialog=void 0,r.showUploadInstructionsAsync=void 0,r.saveProjectAsync=void 0,r.electronDeployAsync=void 0,r.electronFileDeployAsync=void 0,r.webUsbPairDialogAsync=void 0,r.onTutorialCompleted=void 0,r.perfMeasurementThresholdMs=void 0,r.onPerfMilestone=void 0,r.onPerfMeasurement=void 0,r.workspaceLoadedAsync=void 0,r.getDownloadMenuItems=void 0,r.notifyProjectCompiled=void 0,r.notifyProjectSaved=void 0,r.onDownloadButtonClick=void 0,r.getDefaultProjectName=void 0,r.onMarkdownActivityLoad=void 0})(pxt=pxt||{}),(u=>{function r(e){var e=u.toolbox.convertColor(e),t=parseInt(e.slice(1,3),16)/255,r=parseInt(e.slice(3,5),16)/255,e=parseInt(e.slice(5,7),16)/255;return.2126*(t<=.03928?t/12.92:Math.pow((.055+t)/1.055,2.4))+.7152*(r<=.03928?r/12.92:Math.pow((.055+r)/1.055,2.4))+.0722*(e<=.03928?e/12.92:Math.pow((.055+e)/1.055,2.4))}function i(e,t){return(r(e)+.05)/(r(t)+.05)}function o(e){return("0"+e.toString(16)).slice(-2)}u.getWhiteContrastingBackground=function(t){if(!(4.5<=i("#ffffff",t))){var r=(e=>{let t=u.toolbox.convertColor(e),r=parseInt(t.slice(1,3),16)/255,n=parseInt(t.slice(3,5),16)/255,i=parseInt(t.slice(5,7),16)/255,s=Math.max(Math.max(r,n),i),a=Math.min(Math.min(r,n),i),o=s-a,l;0==o?l=0:s===r?l=((n-i)/o%6+6)%6:s===n?l=(i-r)/o+2:s===i&&(l=(r-n)/o+4);var e=(a+s)/2,c=0==o?0:o/(1-Math.abs(2*e-1));return{h:60*l,s:c,l:e}})(t);let e=r.l-.05;for(;0<e;){var n=(e=>{let t=(1-Math.abs(2*e.l-1))*e.s,r=e.h/60,n=t*(1-Math.abs(r%2-1)),i;void 0===e.h?i=[0,0,0]:r<=1?i=[t,n,0]:r<=2?i=[n,t,0]:r<=3?i=[0,t,n]:r<=4?i=[0,n,t]:r<=5?i=[n,0,t]:r<=6&&(i=[t,0,n]),e=e.l-.5*t;var s=Math.round(255*(i[0]+e)),a=Math.round(255*(i[1]+e)),e=Math.round(255*(i[2]+e));return"#"+o(s)+o(a)+o(e)})({h:r.h,s:r.s,l:e});if(4.5<=i("#ffffff",n))return n;e-=.05}u.warn("Couldn't find a contrasting background for color "+t)}return t},u.contrastRatio=i})(pxt=pxt||{}),(e=>{e.TutorialInfoDbSetAsync="tutorial info db setAsync",e.ReloadAppTargetVariant="reloadAppTargetVariant",e.Sha256Buffer="sha256buffer",e.WebworkerRecvHandler="webworker recvHandler",e.NetworkRequest="network.request"})(Measurements=Measurements||{}),(i=>{function e(){let e;return e||(e=i.U.isNodeJS?Promise.resolve(require("lzma")):Promise.resolve(window.LZMA)).then(e=>(e||i.reportError("lzma","failed to load"),e)),e}i.lzmaDecompressAsync=function(n){return e().then(t=>new Promise((r,e)=>{try{t.decompress(n,(e,t)=>{t&&i.debug("lzma decompression failed"),r(t?void 0:e)})}catch(e){e&&i.debug("lzma decompression failed"),r(void 0)}}))},i.lzmaCompressAsync=function(n){return e().then(t=>new Promise((r,e)=>{try{t.compress(n,7,(e,t)=>{t&&i.reportException(t),r(t?void 0:new Uint8Array(e))})}catch(e){i.reportException(e),r(void 0)}}))}})(pxt=pxt||{}),(Te=>{{var e=Te.cpp||(Te.cpp={}),ke=pxtc.Util;let ye=ke.lf,be={"pxt::mkAction":1,"pxt::dumpPerfCounters":1,"pxt::deepSleep":1,"pxt::getConfig":1,"pxtrt::mkMap":1,"pxtrt::mapSet":1,"pxtrt::stclo":1,"pxtrt::mklocRef":1,"pxtrt::stlocRef":1,"pxtrt::ldlocRef":1,"pxtrt::panic":1};function xe(r="namespace"){let n="",i="",e=(e,t="")=>{i!=e&&(i&&(n+="}\n"),e&&(n+=t||r+" "+e+" {\n"),i=e)},t="    ";return{setNs:e,clear:()=>{n="",i=""},write:e=>{e.trim()?(e=e.trim().replace(/^\s*/gm,t).replace(/^(\s*)\*/gm,(e,t)=>t+" *"),n+=e+"\n"):n+="\n"},incrIndent:()=>{t+="    "},decrIndent:()=>{t=t.slice(4)},finish:()=>(e(""),n)}}function Ee(e){if(!e)return null;e=e.trim();var t=/^\((.*)\)/.exec(e);return t&&(e=t[1]),/^-?(\d+|0[xX][0-9a-fA-F]+)$/.test(e)?parseInt(e):null}e.nsWriter=xe,e.parseCppInt=Ee;let ve={};class Se extends Error{constructor(e){super(e),this.isUserError=!0,this.message=e}}function l(t){if(!t)return"";let r="";for(let e=0;e<t.length;++e){var n=255&t[e];r+=37==n||127<n?"%"+n.toString(16):String.fromCharCode(n)}return decodeURIComponent(r)}function c(e){let t="",r=0;for(;r<e.length;r+=2)t=e[r]+e[r+1]+t;return Te.Util.assert(r==e.length),t}function s(r){var n=[65,20,14,47,184,47,162,187];e:for(let t=0;t<r.length;t+=16)if(r[t]==n[0]){for(let e=0;e<n.length;++e)if(r[t+e]!=n[e])continue e;var e,i=r[t+8]|r[t+9]<<8,s=r[t+10]|r[t+11]<<8|r[t+12]<<16|r[t+13]<<24,s=(t+=16)+i+s;if(!(r.length<s))return e=r.slice(t,t+i),i=r.slice(t+i,s),{meta:l(e),text:i}}return null}function a(e){if(e){let r=0,n=0,i=0,s,a=0;if(e.split(/\r?\n/).forEach(e=>{var t=/^:10....0[0E]41140E2FB82FA2BB(....)(....)(....)(....)(..)/.exec(e);if(t)r=parseInt(c(t[1]),16),n=parseInt(c(t[2]),16),i=r+n,s=new Uint8Array(i);else if(0<i&&(t=/^:10....0[0E](.*)(..)$/.exec(e))){let e=t[1];for(;0<i&&0<e.length;)s[a++]=parseInt(e[0]+e[1],16),e=e.slice(2),i--}}),s&&0==i&&a==s.length){var t=new Uint8Array(r),o=new Uint8Array(n);for(let e=0;e<r;++e)t[e]=s[e];for(let e=0;e<n;++e)o[e]=s[r+e];return{meta:l(t),text:o}}}}function t(e){function t(e){return Te.debug(e),Promise.reject(new Error(e))}let r;var n;if(Te.HF2.read32(e,0)==ts.pxtc.UF2.UF2_MAGIC_START0&&(n=ts.pxtc.UF2.toBin(e))&&(r=s(n.buf)),1179403647==Te.HF2.read32(e,0)&&(r=s(e)),58==e[0]&&(n=l(e),r=a(n||"")),!r||!r.meta||!r.text)return t("This .hex file doesn't contain source.");let i=JSON.parse(r.meta);return i?"LZMA"==i.compression?Te.lzmaDecompressAsync(r.text).then(e=>{var t;return e?(t=e.slice(0,i.headerSize||i.metaSize||0),e=e.slice(t.length),t&&Te.Util.jsonCopyFrom(i,JSON.parse(t)),{meta:i,source:e}):null}):i.compression?t(`Compression type ${i.compression} not supported.`):Promise.resolve({source:l(r.text)}):t("This .hex file is not valid.")}e.PkgConflictError=Se,e.getExtensionInfo=function(M){var F={__appVariant:Te.appTargetVariant||""},B="dal.d.ts";let r="/source/",e="";var t,$=[];for(t of M.sortedDeps(!0).sort((e,t)=>"this"==e.id?1:"this"==t.id?-1:ke.strcmp(e.id,t.id)))t.disablesVariant(Te.appTargetVariant)||t.resolvedDependencies().some(e=>e.disablesVariant(Te.appTargetVariant))?(e&&(e+=", "),e+=t.id,Te.debug(`disable variant ${Te.appTargetVariant} due to `+t.id)):($.push(t),t.addSnapshot(F,[B,".h",".cpp"]));var U=JSON.stringify(F),n=ve[U];if(n)return Te.debug("Using cached extinfo"),(n=ke.flatClone(n)).disabledDeps=e,n;Te.debug("Generating new extinfo");let g=pxtc.emptyExtInfo(),i=(g.disabledDeps=e,Te.appTarget.compileService),s=(i=i||{gittag:"none",serviceId:"nocompile"},i=ke.clone(i),M.getTargetOptions()),V=(s=s||{isNative:!1,hasHex:!1,switches:{}},n=!!i.platformioIni,"codal"==i.buildEngine||"dockercodal"==i.buildEngine);var a,H,o,l,c="dockermake"==i.buildEngine||"dockercross"==i.buildEngine,u="dockerespidf"==i.buildEngine;let f=!(n||V||c||u),G=s.nativeType==pxtc.NATIVE_TYPE_VM,j=(n?r="/src/":V||c?r="/pxtapp/":u&&(r="/main/"),"// Configuration defines\n"),_="\nPXT_SHIMS_BEGIN\n",y="",K="",z=`#include "pxt.h"
`,W="",b=e=>W+=`   ${J}(${q}): ${e}
`,q=0,J="",v=xe("namespace"),T=xe("declare namespace"),k=xe("declare namespace"),Y="",X={},Z={},Q={true:"1",false:"0",null:"0",NULL:"0"};function x(e){return e.trim().replace(/[\_\*]$/,"")}for(a of $){0<=a.getFiles().indexOf(B)&&(H=a.host().readFile(a,B),Te.Util.assert(!!H,B+" not found in "+a.id),H.split(/\r?\n/).forEach(e=>{e=/^\s*(\w+) = (.*),/.exec(e);e&&(Q[e[1]]=e[2])}));for(o of a.getFiles())(0<=["Makefile","sdkconfig.defaults","CMakeLists.txt"].indexOf(o)||ke.endsWith(o,".mk"))&&(g.generatedFiles["/"+o]=a.host().readFile(a,o))}let ee=["0","false","PXT_UTF8"],E={};function te(e){return e.replace(/\/\/.*/,"").replace(/\/\*/,"")}s.switches.boxDebug&&(E.PXT_BOX_DEBUG=1),s.utf8&&(E.PXT_UTF8=1),s.switches.profile&&(E.PXT_PROFILE=1),s.switches.gcDebug&&(E.PXT_GC_DEBUG=1),s.switches.numFloat&&(E.PXT_USE_FLOAT=1),s.nativeType==pxtc.NATIVE_TYPE_VM&&(E.PXT_VM=1);let S=0,C=!1,w="",I="",A="",re=!1;function ne(){T.setNs(""),T.write(""),T.write(""),(A||I)&&(T.write(I),T.write(A),A="",I="")}function ie(e,u){w="",I="",A="",re=!1;let d,t=-1;function p(){var e=w.replace(/Methods$/,"");return e==w?null:e}function h(e){switch(e.replace(/\s+/g,"")){case"void":return"void";case"int32_t":case"int":return"int32";case"uint32_t":case"unsigned":return"uint32";case"TNumber":case"float":case"double":return"number";case"uint16_t":return"uint16";case"int16_t":case"short":return"int16";case"uint8_t":case"byte":return"uint8";case"int8_t":case"sbyte":return"int8";case"bool":return s.shortPointers&&b("use 'boolean' not 'bool' on 8 bit targets"),"boolean";case"StringData*":case"String":case"ImageLiteral_":case"ImageLiteral":return"string";case"Action":return"() => void";case"TValue":return"any";default:return x(e)}}function m(e){switch(e=e.replace(/\s+/g,"")){case"int32_t":case"uint32_t":case"unsigned":case"uint16_t":case"int16_t":case"short":case"uint8_t":case"byte":case"int8_t":case"sbyte":case"int":case"ramint_t":return"I";case"void":return"V";case"float":return"F";case"TNumber":return"N";case"TValue":return"T";case"bool":return"B";case"double":return"D";case"ImageLiteral_":return"T";case"String":return"S";default:return ke.lookup(X,e)?"I":"_"+e.replace(/[\*_]+$/,"")}}e=e.replace(/^(\s*#\s*if\s+(\w+)\s*$)([^]*?)(^\s*#\s*(elif|else|endif)\s*$)/gm,(e,t,r,n,i)=>0<=ee.indexOf(r)&&!E[r]?t+n.replace(/[^\n]/g,"")+i:e),q=0,C=!1,S=0,k.setNs(""),T.setNs(""),e.split(/\r?\n/).forEach(e=>{++q;var i=te(e),s=e,a=te(s);if(C&&0<=a.indexOf("}")&&(C=!1,k.write("}")),C){var r=/^\s*(\w+)\s*(=\s*(.*?))?,?\s*$/.exec(a);if(r){var n=r[1];let e=r[3],t="";e?(e=e.trim(),null!=(r=ke.lookup(Q,e))&&(t="  // "+e,e=r),null==(S=Ee(e))&&b("cannot determine value of "+a)):(S++,e=S+""),k.write(`    ${x(n)} = ${e},`+t)}else k.write(s)}r=/^\s*enum\s+(|class\s+|struct\s+)(\w+)\s*({|$)/.exec(i);if(r&&(a=r[2],n=r[3],C=!0,S=-1,k.write(""),k.write(""),(A||I)&&(k.write(I),k.write(A),A="",I=""),k.write(`declare const enum ${x(a)} `+n),X[a]=!0,u||(v.setNs(w),v.write(`enum ${r[2]} : int;`))),s=e,!C&&!(/^\s*\/\*\*/.test(s)?(re=!0,I=s+"\n",/\*\//.test(s)&&(re=!1),1):re?(I+=s+"\n",/\*\//.test(s)&&(re=!1),1):/^\s*\/\/%/.test(s)&&(A+=s+"\n",1)))if(/^typedef.*;\s*$/.test(e)&&(v.setNs(w),v.write(e)),i=/^\s*namespace\s+(\w+)/.exec(e))w=i[1],p()?(ne(),a=p(),T.setNs(w,`declare interface ${a} {`)):(A||I)&&(ne(),T.setNs(x(w)),k.setNs(x(w)));else if((i=/^PXT_ABI\((\w+)\)/.exec(e))&&!G&&(_+=`PXT_FNPTR(::${i[1]}),
`,K+=`extern "C" void ${i[1]}();
`,g.functions.push({name:i[1],argsFmt:[],value:0})),(i=/^\s*PXT_EXPORT\(([:\&\w]+)\)/.exec(e))&&(g.vmPointers||(g.vmPointers=[]),g.vmPointers.push(i[1])),(i=/^#define\s+PXT_COMM_BASE\s+([0-9a-fx]+)/.exec(e))&&(g.commBase=parseInt(i[1])),i=/^\s*(\w+)([\*\&]*\s+[\*\&]*)(\w+)\s*\(([^\(\)]*)\)\s*(;\s*$|\{|$)/.exec(e),A&&i){d=null;let t=pxtc.parseCommentString(A);w||b("missing namespace declaration");s=(i[1]+i[2]).replace(/\s+/g,"");let e=i[3];a=i[4];A=A.trim().replace(/ \w+\.defl=\w+/g,"");let r=[m(s)],n=[];var o=a.split(/,/).filter(e=>!!e).map(e=>{e=((e,t)=>{t=t.trim();let r=/(.*)=\s*(-?\w+)$/.exec(t),n="",i="";var s;return r&&(n=r[2],i="?",t=r[1].trim()),(r=/^(.*?)(\w+)$/.exec(t))?(s=r[2],e.paramDefl[s]&&(n=e.paramDefl[s],i="?"),e=n?ke.lookup(Q,n):null,(n=null!=e?e:n)&&(null==Ee(n)&&b("Invalid default value (non-integer): "+n),A+=` ${s}.defl=`+n),{name:s+i,type:r[1]}):(b("invalid argument: "+t),{name:"???",type:"int"})})(t,e);return r.push(m(e.type)),n.push(e.type.replace(/ /g,"")),e.name+": "+h(e.type)}),l={name:w+"::"+e,argsFmt:r,value:null};I&&(T.setNs(x(w)),T.write(""),T.write(I),/ImageLiteral/.test(i[4])&&!/imageLiteral=/.test(A)&&(A+=" imageLiteral=1"),A+=" shim="+l.name,T.write(A),e=x(e),p()?((c=(o[0]||"").replace(/^.*:\s*/,"").trim()).toLowerCase()!=p().toLowerCase()&&b(ye("Invalid first argument; should be of type '{0}', but is '{1}'",p(),c)),o.shift(),0==o.length&&/\bproperty\b/.test(A)?T.write(`${e}: ${h(s)};`):T.write(`${e}(${o.join(", ")}): ${h(s)};`)):T.write(`function ${e}(${o.join(", ")}): ${h(s)};`)),I="",A="",u||(v.setNs(w),v.write(`${s} ${e}(${a});`)),g.functions.push(l),void(f?_+="(uint32_t)(void*)::"+l.name+",\n":G?(ke.startsWith(l.name,"pxt::op_")||be[l.name]||t.expose||!ke.startsWith(l.name,"pxt::")&&!ke.startsWith(l.name,"pxtrt::"))&&(c=((s,a)=>{if("FiberContext*"==a[0])return"::"+s.name;var e="_wrp_"+s.name.replace(/:/g,"_");if(!Z[s.name]){Z[s.name]=!0,y+=`
void ${e}(FiberContext *ctx) {
`;var o=a.length,l=[];let n=!1,i="";for(let r=0;r<o;++r){var c=s.argsFmt[r+1],u=a[r];let e="I"==c?"toInt":"B"==c?"numops::toBool":"";c=r==o-1?"ctx->r0":`ctx->sp[${o-r-2}]`;let t="";switch(u){case"TValue":case"TNumber":break;case"Action":e="asRefAction";break;case"String":e="convertToString",t="ctx, ",n=!0;break;default:e=e||"as"+u.replace(/\*/g,"")}i+=`  ${u} a${r} = (${u}) ${e}(${t}${c});
`,l.push("a"+r)}n&&(y+="  auto prevSP = ctx->sp;\n"),y+=i,n&&(y+="  if (panicCode) { ctx->sp = prevSP; return; }\n");var t=`::${s.name}(${l.join(", ")})`;"V"==s.argsFmt[0]?y=y+`  ${t};
`+`  ctx->r0 = NULL;
`:"I"==s.argsFmt[0]?y+=`  ctx->r0 = fromInt(${t});
`:"B"==s.argsFmt[0]?y+=`  ctx->r0 = fromBool(${t});
`:y+=`  ctx->r0 = (TValue)${t};
`,n&&(y+="  ctx->sp = prevSP;\n"),1<o&&(y+=`  ctx->sp += ${o-1};
`),y+=`}
`}return e})(l,n),o=l.argsFmt.length-1,_+=`{ "${l.name}", (OpFun)(void*)${c}, ${o} },
`):_+="PXT_FNPTR(::"+l.name+"),\n")}else{i=/^\s*extern const (\w+) (\w+);/.exec(e);if(A&&i)s={name:w+"::"+i[2],argsFmt:[],value:null},g.functions.push(s),G||(_+="PXT_FNPTR(&::"+s.name+"),\n"),A="";else{if(i=/^\s*(\w+)\s+(\w+)\s*;/.exec(e),A&&i){var a=pxtc.parseCommentString(A),c=(a.indexedInstanceNS&&(d=a,T.setNs(a.indexedInstanceNS),t=0),i[1]),o=i[2];if(d)return A=A.trim(),A+=` fixedInstance shim=${d.indexedInstanceShim}(${t++})`,T.write(""),T.write(I),T.write(A),T.write(`const ${o}: ${h(c)};`),I="",void(A="")}A&&e.trim()&&(b("declaration not understood: "+e),A="",I="")}}})}let se=ke.clone(i.yottaConfig||{}),d={},ae={},oe={};if(f&&s.hasHex&&(L=i,ke.assert(!!L.yottaCorePackage),ke.assert(!!L.githubCorePackage),ke.assert(!!L.gittag),P=L.githubCorePackage+"#"+i.gittag,g.yotta.dependencies[L.yottaCorePackage]=P),M){let e=!1;for(var p of $){W="",pe=me=he=N=O=de=ue=le=ce=D=m=h=void 0;var h=p,m=((m=h.config.platformio)&&m.dependencies&&ke.jsonCopyFrom(g.platformio.dependencies,m.dependencies),g.npmDependencies&&h.config.npmDependencies&&ke.jsonCopyFrom(g.npmDependencies,h.config.npmDependencies),h.config.codal);if(V&&m)for(var le of m.libraries||[]){var D=Te.github.parseRepoId(le),le=(D||ke.userError(ye("codal library {0} doesn't look like github repo",le)),Te.github.stringifyRepo(D)),ce=ke.lookup(oe,D.project);ce?Te.github.stringifyRepo(ce)!=le&&ke.userError(ye("conflict between codal libraries: {0} and {1}",Te.github.stringifyRepo(ce),le)):oe[D.project]=D}if(m=h.config.yotta){if(m.dependencies&&ke.jsonCopyFrom(g.yotta.dependencies,m.dependencies),m.config){var N,ue=ke.jsonFlatten(m.config);for(N of Object.keys(ue)){var de=ke.lookup(ae,N),O=ue[N];if(!de||de.config.yotta.configIsJustDefaults)ae[N]=h,se[N]=O;else if(se[N]!==O)if(!h.parent.config.yotta||!h.parent.config.yotta.ignoreConflicts)throw(O=new Se(ye("conflict on yotta setting {0} between extensions {1} and {2}",N,h.id,de.id))).pkg0=de,O.pkg1=h,O.settingName=N,O}}if(m.optionalConfig){var pe,he=ke.jsonFlatten(m.optionalConfig);for(pe of Object.keys(he)){var me=he[pe];d[pe]=me}}}p==M?(e=!0,T.clear(),k.clear()):ke.assert(!e);let t=e=>ke.endsWith(e,".h");for(l of p.getFiles().filter(t).concat(p.getFiles().filter(e=>!t(e)))){var R=t(l);if(R||ke.endsWith(l,".cpp")){let e=p.config.name+"/"+l;("base"==p.config.name||/^core($|---)/.test(p.config.name))&&R&&(e=l),R&&(z+=`#include "${f?r.slice(1):""}${e}"
`);var ge=p.readFile(l);null==ge&&ke.userError(ye("C++ file {0} is missing in extension {1}.",l,p.config.name)),J=e,ie(ge,R),g.extensionFiles[r+e]=ge,0==p.level&&(g.onlyPublic=!1),p.verProtocol()&&"pub"!=p.verProtocol()&&"embed"!=p.verProtocol()&&(g.onlyPublic=!1)}(ke.endsWith(l,".c")||ke.endsWith(l,".S")||ke.endsWith(l,".s"))&&(R=p.readFile(l),g.extensionFiles[r+p.config.name+"/"+l.replace(/\.S$/,".s")]=R)}W&&(Y+=ye("Extension {0}:\n",p.id)+W)}e||(T.clear(),k.clear())}function fe(t){return Object.keys(g.extensionFiles).concat(Object.keys(g.generatedFiles)).filter(e=>ke.endsWith(e,t)).map(e=>e.slice(1))}Y&&ke.userError(Y),ke.jsonCopyFrom(d,se),ke.iterMap(d,(e,t)=>{null===t&&delete d[e]}),Object.keys(d).filter(e=>/-/.test(e)).forEach(e=>{var t=d[e];delete d[e],d[e.replace(/-/g,"_")]=t}),!f&&i.yottaConfigCompatibility&&Object.keys(d).forEach(e=>d["YOTTA_CFG_"+e]=d[e]),d.PXT_TARGET=JSON.stringify(Te.appTarget.id);var _e,L=ke.jsonUnFlatten(d);if(c){var P={name:"pxt-app",private:!0,dependencies:g.npmDependencies};g.generatedFiles["/package.json"]=JSON.stringify(P,null,4)+"\n"}else if(u){c=ke.concatArrayLike([fe(".c"),fe(".cpp"),fe(".s")]).map(e=>e.slice(r.length-1)).concat(["main.cpp"]);c.push("pointers.cpp"),g.generatedFiles[r+"CMakeLists.txt"]=`idf_component_register(
  SRCS
`+c.map(e=>`    "${e}"
`).join("")+`  INCLUDE_DIRS
    "."
)
`}else if(V){P=i;let r=ke.clone(P.codalDefinitions)||{},e=P.codalTarget;"string"==typeof e&&(e+=".json");u={target:e,definitions:r,config:r,application:"pxtapp",output_folder:"build",pxt_gitrepo:P.githubCorePackage,pxt_gittag:P.gittag,libraries:ke.values(oe).map(e=>({name:e.project,url:"https://github.com/"+e.fullName,branch:e.tag||"master",type:"git"}))};0==u.libraries.length&&delete u.libraries,ke.iterMap(ke.jsonFlatten(L),(e,t)=>{e=e.replace(/^codal\./,"device.").toUpperCase().replace(/\./g,"_"),r[e]=t}),g.generatedFiles["/codal.json"]=JSON.stringify(u,null,4)+"\n",Te.debug("codal.json: "+g.generatedFiles["/codal.json"]),g.codal=u}else if(n){let r=i.platformioIni.slice();r.push("lib_deps ="),ke.iterMap(g.platformio.dependencies,(e,t)=>{e=/[@#\/]/.test(t)?t:e+"@"+t;r.push("  "+e)}),g.generatedFiles["/platformio.ini"]=r.join("\n")+"\n"}else{g.yotta.config=L;let e="pxt-app";c={name:e=i.yottaBinary?i.yottaBinary.replace(/-combined/,"").replace(/\.hex$/,""):e,version:"0.0.0",description:"Auto-generated. Do not edit.",license:"n/a",dependencies:g.yotta.dependencies,targetDependencies:{},bin:"./source"};g.generatedFiles["/module.json"]=JSON.stringify(c,null,4)+"\n",Te.debug("module.json: "+g.generatedFiles["/module.json"])}for(_e of Object.keys(E))j+=`#define ${_e} ${E[_e]}
`;if(s.uf2Family&&(j+=`#define PXT_UF2_FAMILY ${s.uf2Family}
`),g.generatedFiles[r+"pointers.cpp"]=z+v.finish()+K+y+_+"\nPXT_SHIMS_END\n",g.generatedFiles[r+"pxtconfig.h"]=j,Te.debug("pxtconfig.h: "+g.generatedFiles[r+"pxtconfig.h"]),f&&(g.generatedFiles["/config.json"]=JSON.stringify(L,null,4)+"\n",Te.debug("yotta config.json: "+g.generatedFiles["/config.json"])),g.generatedFiles[r+"main.cpp"]=`
#include "pxt.h"
#ifdef PXT_MAIN
PXT_MAIN
#else
int main() {
    uBit.init();
    pxt::start();
    release_fiber();
    return 0;   // your program will never reach this line.
}
#endif
`,g.generatedFiles["/Makefile"]){let r="";P=(e,t)=>{r+=`${e} = ${fe(t).join(" ")}\n`};P("PXT_C",".c"),P("PXT_CPP",".cpp"),P("PXT_S",".s"),P("PXT_HEADERS",".h"),r=r+"PXT_SOURCES := $(PXT_C) $(PXT_S) $(PXT_CPP)\n"+"PXT_OBJS := $(addprefix bld/, $(PXT_C:.c=.o) $(PXT_S:.s=.o) $(PXT_CPP:.cpp=.o))\n",g.generatedFiles["/Makefile.inc"]=r}return g.generatedFiles["/functions.json"]=JSON.stringify(g.functions,null,1),u=g.extensionFiles,ke.jsonCopyFrom(u,g.generatedFiles),n={config:i.serviceId,tag:i.gittag,replaceFiles:u,dependencies:f?g.yotta.dependencies:null},c=JSON.stringify(n),g.sha=ke.sha256(c),g.skipCloudBuild=!!i.skipCloudBuild,g.compileData=ts.pxtc.encodeBase64(ke.toUTF8(c)),g.shimsDTS=T.finish(),g.enumsDTS=k.finish(),(ve=10<Object.keys(ve).length?{}:ve)[U]=g},e.unpackSourceFromHexFileAsync=function(e){if(e)return Te.Util.fileReadAsBufferAsync(e).then(e=>t(new Uint8Array(e)))},e.unpackSourceFromHexAsync=t}})(pxt=pxt||{}),(u=>{{var n=u.hexloader||(u.hexloader={});let t={},r,s={};function a(e){return t.hasOwnProperty(e.sha)||(t[e.sha]=(t=>{let c="";return n.showLoading(u.U.lf("Compiling (this may take a minute)...")),u.tickEvent("cppcompile.start"),(e=>e.skipCloudBuild?Promise.resolve({hex:["SKIP"]}):u.webConfig&&u.webConfig.isStatic?u.Util.requestAsync({url:`${u.webConfig.cdnUrl}hexcache/${e.sha}.hex`}).then(e=>e.text?(e={enums:[],functions:[],hex:e.text.split(/\r?\n/)},Promise.resolve(e)):(u.log("Hex info not found in bundled hex cache"),Promise.resolve())).catch(e=>(u.log("Error fetching hex info from bundled hex cache"),Promise.resolve())):u.Cloud.localToken&&window&&u.BrowserUtils.isLocalHost()?((e,t)=>u.Cloud.localRequestAsync(e,t).then(e=>e.json))("compile/"+e.sha).then(e=>e&&!e.notInOfflineCache&&e.hex?(e.hex=e.hex.split(/\r?\n/),e):Promise.resolve(void 0)).catch(e=>Promise.resolve(void 0)):Promise.resolve(void 0))(t).then(e=>e?(u.tickEvent("cppcompile.cachehit"),e):(()=>{var e;return r||(e=u.getOnlineCdnUrl(),r=e?Promise.resolve(e):(e=u.webConfig&&u.webConfig.isStatic,u.Cloud.privateGetAsync("clientconfig",e).then(e=>e.primaryCdnUrl)))})().then(e=>(c=e+"/compile/"+t.sha,u.U.httpGetTextAsync(c+".hex"))).then(e=>e,e=>u.Cloud.privatePostAsync("compile/extension",{data:t.compileData},!0).then(l=>new Promise((r,e)=>{let n=0,i=8e3,s=3e5,a=u.U.now(),o=()=>{if(n++,u.U.now()-a>s)return u.log("abandoning C++ build"),u.tickEvent("cppcompile.cancel",{retry:n}),r(null),null;let t=l.hex.replace(/\.hex/,".json");return u.log(`polling C++ build ${t} (attempt #${n})`),u.tickEvent("cppcompile.poll",{retry:n}),u.Util.httpGetJsonAsync(t).then(e=>{u.log("build log "+t.replace(/\.json$/,".log")),u.tickEvent("cppcompile.done",{success:null!=e&&e.success?1:0,retry:n,duration:u.U.now()-a}),e.success?(u.log("fetching "+c+".hex"),r(u.U.httpGetTextAsync(c+".hex"))):(u.log("build failed"),e.mbedresponse&&e.mbedresponse.result&&e.mbedresponse.result.exception&&u.log(e.mbedresponse.result.exception),r(null))},e=>(u.log(`waiting ${i/1e3|0}s for C++ build...`),setTimeout(o,i),null))};o()}))).then(e=>(n.hideLoading(),{hex:e&&e.split(/\r?\n/)}))).finally(()=>{n.hideLoading()})})(e)),t[e.sha]}function o(r,n,i,e,s=10){return r.cacheStoreAsync(i,e).then(()=>r.cacheGetAsync(n)).then(e=>{let t;try{t=JSON.parse(e||"[]")}catch(e){u.error("invalid cache entry, clearing entry"),t=[]}(t=t.filter(e=>e!=i)).unshift(i);e=t.slice(s);return t=t.slice(0,s),u.U.promiseMapAll(e,e=>r.cacheStoreAsync(e,"[]")).then(()=>r.cacheStoreAsync(n,JSON.stringify(t)))})}function l(r,n,i){return r.cacheGetAsync(n).then(e=>{let t;try{t=JSON.parse(e||"[]")}catch(e){return u.error("invalid cache entry, clearing entry"),r.cacheStoreAsync(n,"[]")}return t[0]!=i?((t=t.filter(e=>e!=i)).unshift(i),r.cacheStoreAsync(n,JSON.stringify(t))):null})}n.showLoading=e=>{},n.hideLoading=()=>{},n.storeWithLimitAsync=o,n.recordGetAsync=l,n.getHexInfoAsync=function(n,r,e){if(!r.sha)return Promise.resolve(null);var t=s[r.sha];if(t)return Promise.resolve(t);u.debug("get hex info: "+r.sha);let i="hex-"+r.sha;return n.cacheGetAsync(i).then(e=>{let t;try{t=e?JSON.parse(e):null}catch(e){u.log("invalid cache entry, clearing entry"),t=null}return t&&t.hex?(u.debug("cache hit, size="+e.length),t.hex=(r=>{var s=[];for(let t=0;t<r.length;t++){var n=/^([@!])(....)$/.exec(r[t]);if(n){let e=parseInt(n[2],16);var a=r[++t];let i="";if("@"==n[1]){i="";let e=parseInt(a,16);for(;0<e--;)i+="\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0"}else i=ts.pxtc.decodeBase64(a);u.Util.assert(0<i.length),u.Util.assert(i.length%16==0);for(let n=0;n<i.length;){var o=[16,e>>8&255,255&e,0];e+=16;for(let e=0;e<16;++e)o.push(i.charCodeAt(n++));let t=0;for(let e=0;e<o.length;++e)t+=o[e];o.push(255&-t);let r=":";for(let e=0;e<o.length;++e){var l=255&o[e];l<=15&&(r+="0"),r+=l.toString(16)}s.push(r.toUpperCase())}}else s.push(r[t])}return s})(t.hex),l(n,"hex-keys",i).then(()=>t)):a(r).then(e=>{var t=e.hex,r=(e.hex=(i=>{let s=[],a=0;for(let n=0;n<i.length;n+=a){let e=-1,r="",t=(a=0,!1);for(;a<500;){var o=/^:10(....)00(.{32})(..)$/.exec(i[n+a]);if(!o)break;var l=o[2],c=/^0+$/.test(l),u=parseInt(o[1],16);if(-1==e)t=c,s.push((t?"@":"!")+o[1]),e=u-16;else{if(c!=t)break;if(e+16!=u)break}t||(r+=l),e=u,a++}if(0==a)s.push(i[n]),a=1;else if(t)s.push(a.toString(16));else{let t="";for(let e=0;e<r.length;e+=2)t+=String.fromCharCode(parseInt(r.slice(e,e+2),16));s.push(ts.pxtc.encodeBase64(t))}}return s})(e.hex),JSON.stringify(e));return e.hex=t,o(n,"hex-keys",i,r).then(()=>e)}).catch(e=>(u.reportException(e,{sha:r.sha}),Promise.resolve(null)))}).then(e=>(e&&((s=20<Object.keys(s).length?{}:s)[r.sha]=e),e))}}})(pxt=pxt||{}),(s=>{var e;(e=s.crowdin||(s.crowdin={})).KEY_VARIABLE="CROWDIN_KEY",e.testMode=!1,e.setTestMode=function(){s.crowdin.testMode=!0,s.log("CROWDIN TEST MODE - files will NOT be uploaded")},e.inContextLoadAsync=function(n){let i=document.createElement("input");i.type="text",i.setAttribute("class","hidden"),i.value=n;var e=new Promise((t,e)=>{let r=new MutationObserver(()=>{var e;n!=i.value&&(e=s.Util.rlf(i.value),i.remove(),r.disconnect(),t(e))});r.observe(i,{attributes:!0})});return document.body.appendChild(i),e}})(pxt=pxt||{}),(m=>{var e;{var t=m.diff||(m.diff={});function T(r,e){if(!r)return[];if(e){var n=[];let t=0;for(let e=0;e<r.length;e++)"\n"===r.charAt(e)&&(n.push(r.substring(t,e+1)),t=e+1);return n.push(r.substring(t)),n}return r.split(/\r?\n/)}t.toLines=T;let v;function g(e,t,i={}){i.ignoreWhitespace&&(e=e.replace(/[\r\n]+$/,""),t=t.replace(/[\r\n]+$/,""));var s=T(e,!0),a=T(t,!0);let o=Math.min(i.maxDiffSize||1024,s.length+a.length);if(0==o)return[];let l=65520<s.length?Uint32Array:Uint16Array,c={},u=0,d=r(s),p=r(a);function r(e){var t,r=new l(e.length);let n=0;for(t of e)i.ignoreWhitespace&&(t=t.replace(/\s+$/g,"").replace(/^\s+/g,"")),c.hasOwnProperty(t)?r[n]=c[t]:(++u,r[n]=u,c[t]=u),n++;return r}let n=new l(2*o+1),h=-1;for(let e=0;e<=o;e++)null!=b(e,n)&&(h=e);if(-1==h)return null;var m=[];let g=null;for(let t=0;t<=h;t++){let e=m.length?m[m.length-1].slice(0):new l(2*h+1);if(m.push(e),null!=(g=b(t,e)))break}var f=[];let _=g;for(let n=m.length-1;0<=n;n--){let t=m[n],r=0,e=0;var y=(r=_==-n||_!=n&&t[o+_-1]<t[o+_+1]?(e=_+1,t[o+e]):(e=_-1,t[o+e]+1))-_;for(let e=t[o+_]-r-1;0<=e;--e)f.push([v.Unchanged,a[y+e]]);e==_-1?f.push([v.Deleted,s[r-1]]):0<y&&f.push([v.Added,a[y-1]]),_=e}return f.reverse(),f;function b(n,i){for(let r=-n;r<=n;r+=2){let e=0,t=(e=r==-n||r!=n&&i[o+r-1]<i[o+r+1]?i[o+r+1]:i[o+r-1]+1)-r;for(;e<d.length&&t<p.length&&d[e]==p[t];)e++,t++;if((i[o+r]=e)>=d.length&&t>=p.length)return r}return null}}function f(e,t,r={}){var n=g(e,t,r);if(r.context==1/0||r.full)return n.map(p);let i=1,s=1,a=0;for(var o=[],l=r.context||3;a<n.length;){let e=a;for(;e<n.length&&n[e][0]===v.Unchanged;)e++;if(e==n.length)break;var c=e-l,u=c-a,u=(0<u&&(i+=u,s+=u,a=c),o.length),c=i,d=s;o.push("@@");let t=a,r=0;for(;t<n.length;){if(n[t][0]===v.Unchanged){if(++r>2*l+2){t-=l+2;break}}else r=0;t++}for(;a<t;){switch(o.push(p(n[a])),n[a][0]){case v.Deleted:i++;break;case v.Added:s++;break;case v.Unchanged:i++,s++}a++}o[u]=`@@ -${c},${i-c} +${d},${s-d} @@`}return o}function p([e,t]){let r;return(r=e===v.Added?"+ ":e===v.Deleted?"- ":"  ")+t.replace(/\r?\n/,"")}function s(e){return T(e).map(e=>e.replace(/;\s*$/,"")).join("\n")}function _(e){e=/^@@ -(\d+),(\d+) \+(\d+),(\d+)/.exec(e);return e&&{oldStart:parseInt(e[1])-1,oldLength:parseInt(e[2]),newStart:parseInt(e[3])-1,newLength:parseInt(e[4])}}(e=v=v||{})[e.Added=1]="Added",e[e.Deleted=-1]="Deleted",e[e.Unchanged=0]="Unchanged",t.compute=g,t.computeFormattedDiff=f,t.computePatch=function(e,t){var s=g(e,t,{full:!0,maxDiffSize:2048});if(s){var a=s;let e=[],t="",r="",n="",i=v.Unchanged;var o=()=>{e.push({start1:t.length,length1:n.length,diffs:[[v.Added,r]]}),t+=r,r="",n=""};for(let e=0;e<a.length;e++){var[l,c]=a[e];l==v.Unchanged?(i!==v.Unchanged&&o(),t+=c):l===v.Added?r+=c:l===v.Deleted&&(i===v.Added&&o(),n+=c),i=l}return i!==v.Unchanged&&o(),e}return[{start1:0,length1:e.length,diffs:[[v.Added,t]]}]},t.applyPatch=function(e,t){let r=e;for(var n of t){var i=n.diffs.filter(e=>e[0]!==v.Deleted).map(e=>e[1]).join("");r=r.substring(0,n.start1)+i+r.substring(n.start1+n.length1)}return r},t.diff3=function(e,t,r,o,l){var c=n(e),u=n(r);if(c&&u){var d=T(e),p=T(r);let i=0;var h=[];let s=0,a=0;for(let n=0;n<c.length-1;)if(c[n]==s&&u[n]==a)h.push(d[s]),s++,a++,n++;else{let e=!0,t=!0,r=n;for(;r<c.length&&(c[r]!=s+r-n&&(e=!1),u[r]!=a+r-n&&(t=!1),null==c[r]||null==u[r]);)r++;if(m.U.assert(r<c.length),e)for(;a<u[r];)h.push(p[a++]);else if(t)for(;s<c[r];)h.push(d[s++]);else if(d.slice(s,c[r]).join("\n")==p.slice(a,u[r]).join("\n"))for(;s<c[r];)h.push(d[s++]);else{for(i++,h.push("<<<<<<< "+o);s<c[r];)h.push(d[s++]);for(h.push("=======");a<u[r];)h.push(p[a++]);h.push(">>>>>>> "+l)}n=r,s=c[r],a=u[r]}return{merged:h.join("\n"),numConflicts:i};function n(r){r=g(t,r,{context:1/0});if(r){var n,i=[];let e=0,t=0;for(n of r)n[0]==v.Added?e++:n[0]==v.Deleted?(i[t]=null,t++):n[0]==v.Unchanged?(i[t]=e,e++,t++):m.U.oops();return i.push(e+1),i}}}},t.removeTrailingSemiColumns=s,t.split=function(e,t){var r=e.split(/-{10,}/,2);if(r.length<2)return{fileA:e,fileB:void 0};let n=r[0].replace(/\n$/,""),i=r[1].replace(/^\n/,"");return t&&t.removeTrailingSemiColumns&&(n=s(n),i=s(i)),{fileA:n,fileB:i}},t.parseDiffMarker=_,t.render=function(e,t,a={}){let o=f(e,t,a);if(!o)return m.dom.el("div",null,pxtc.Util.lf("Too many differences to render diff."));let l={"@":"diff-marker"," ":"diff-unchanged","+":"diff-added","-":"diff-removed"},c=0,u=0,d="",p=m.dom.el("tbody"),h=(e=m.dom.el("table",{class:"diffview "+(a.update?"update":"")},p),null);return o.forEach((e,t)=>{var r=_(e),r=(r?(c=r.oldStart,u=r.newStart):("+"!=e[0]&&c++,"-"!=e[0]&&u++),o[t+1]?o[t+1][0]:""),n=o[t+2]?o[t+2][0]:"",i=e.slice(2);let s=m.dom.el("code",null,i);h?(s=h,h=null):"-"!=e[0]||" "!=d&&"@"!=d||"+"!=r||" "!=n&&"@"!=n&&""!=n||(i=((e,t)=>{var r=f(e.split("").join("\n"),t.split("").join("\n"),{context:1/0});if(!r)return{a:m.dom.el("div",{class:"inline-diff"},m.dom.el("code",null,e)),b:m.dom.el("div",{class:"inline-diff"},m.dom.el("code",null,t))};var n=[],i=[];for(let t=0;t<r.length;){let e=t;for(var s=r[t][0];r[e]&&r[e][0]==s;)e++;var a=r.slice(t,e).map(e=>e.slice(2)).join("");" "==s?(n.push(m.dom.el("code",{class:"ch-common"},a)),i.push(m.dom.el("code",{class:"ch-common"},a))):"-"==s?n.push(m.dom.el("code",{class:"ch-removed"},a)):"+"==s?i.push(m.dom.el("code",{class:"ch-added"},a)):m.Util.oops(),t=e}return{a:m.dom.el("div",{class:"inline-diff"},n),b:m.dom.el("div",{class:"inline-diff"},i)}})(e.slice(2),o[t+1].slice(2)),s=i.a,h=i.b),d=e[0],a.hideMarkerLine&&"@"==d||a.hideRemoved&&"-"==d||(r="@"==d,n=""+l[d],p.appendChild(m.dom.el("tr",{class:n},[!a.hideLineNumbers&&m.dom.el("td",{class:"line-a","data-content":c}),!a.hideLineNumbers&&m.dom.el("td",{class:"line-b","data-content":u}),r&&m.dom.el("td",{colspan:2,class:"change"},m.dom.el("code",null,e)),!a.hideMarker&&!r&&m.dom.el("td",{class:"marker","data-content":d}),!r&&m.dom.el("td",{class:"change"},s)])))}),e},t.resolveMergeConflictMarker=function(e,t,r,n){var i=m.diff.toLines(e);let s=t;for(;s<i.length&&!/^<<<<<<<[^<]/.test(i[s]);)s++;let a=s+1;for(;a<i.length&&!/^=======$/.test(i[a]);)a++;let o=a+1;for(;o<i.length&&!/^>>>>>>>[^>]/.test(i[o]);)o++;if(o>=i.length)return m.debug(`diff marker mistmatch: ${i.length} -> ${s} ${a} `+o),e;if(i[s]=void 0,i[a]=void 0,i[o]=void 0,!r)for(let e=s;e<=a;++e)i[e]=void 0;if(!n)for(let e=a;e<=o;++e)i[e]=void 0;return i.filter(e=>void 0!==e).join("\n")},t.mergeDiff3Config=function(e,t,r){var n=m.Util.jsonTryParse(e);let i=m.Util.jsonTryParse(t);var s=m.Util.jsonTryParse(r);if(n&&!s)return e;if(!n)return r||t;if(!i&&s&&(i=s),n&&i&&s){delete n.installedVersion,delete i.installedVersion,delete s.installedVersion;var a,o,l={};for(a of m.U.unique(Object.keys(i).concat(Object.keys(n)).concat(Object.keys(s)),e=>e)){var c=n[a],u=i[a],d=s[a];if(JSON.stringify(c)==JSON.stringify(d))void 0!==c&&(l[a]=c);else switch(a){case"name":l[a]=(h=d,(o=c)==(p=u)||h!=p&&o==lf("Untitled")?h:o);break;case"version":l[a]=0<m.semver.strcmp(c,d)?c:d;break;case"languageRestriction":case"preferredEditor":case"targetVersion":l[a]=c;break;case"public":l[a]=c&&d;break;case"files":case"testFiles":var p=((e,t,r)=>{var n,i=[];for(n of m.U.unique(t.concat(e).concat(r),e=>e)){var s=-1<e.indexOf(n),a=-1<r.indexOf(n),o=-1<t.indexOf(n);s==a||a==o?s&&i.push(n):a&&i.push(n)}return i})(c||[],u||[],d||[]);if(!p)return;l[a]=p.length?p:void 0;break;case"dependencies":case"testDependencies":var h=((e,t,r)=>{var n,i={};for(n of m.U.unique(Object.keys(t).concat(Object.keys(e)).concat(Object.keys(r)),e=>e)){var s,a,o=e[n],l=r[n],c=t[n];o==l?o&&(i[n]=o):(s=m.github.parseRepoId(o),a=m.github.parseRepoId(l),s&&a&&m.semver.tryParse(s.tag)&&m.semver.tryParse(a.tag)&&s.owner&&s.project&&s.owner==a.owner&&s.project==a.project?(a=(0<m.semver.strcmp(s.tag,a.tag)?s:a).tag,i[n]=`github:${s.owner}/${s.project}#`+a):l==c?o&&(i[n]=o):l&&(i[n]=l))}return i})(c||{},u||{},d||{});if(Object.keys(h).length)return;l[a]=h;break;case"description":if(c&&!d)l[a]=c;else{if(c||!d)return;l[a]=d}break;default:return}}return m.Package.stringifyConfig(l)}},t.hasMergeConflictMarker=function(e){return e&&/^(<<<<<<<[^<]|>>>>>>>[^>])/m.test(e)},t.reconstructConfig=function(t,r,e,n){var i={};let s=e.tree.tree.map(e=>e.path).filter(e=>/\.(ts|blocks|md|jres|asm|json)$/.test(e)).filter(e=>e!=m.CONFIG_NAME);return(s=t.fileName?s.filter(e=>0===e.indexOf(t.fileName)).map(e=>e.slice(t.fileName.length+1)):s).find(e=>/\.ts$/.test(e))||(n.config.files.filter(e=>s.indexOf(e)<0).forEach(e=>{s.push(e),r[e]=n.files[e]}),m.Util.jsonCopyFrom(i,n.config.dependencies)),Object.keys(i).length||(i[m.appTarget.corepkg]="*"),{name:"",files:s,dependencies:i,preferredEditor:s.find(e=>/.blocks$/.test(e))?m.BLOCKS_PROJECT_NAME:m.JAVASCRIPT_PROJECT_NAME}}}})(pxt=pxt||{}),(n=>{var e;(e=n.discourse||(n.discourse={})).extractSharedIdFromPostUrl=function(e){return n.Util.httpGetJsonAsync(e+".json").then(e=>e.post_stream&&e.post_stream.posts&&e.post_stream.posts[0]&&e.post_stream.posts[0].link_counts.map(e=>n.Cloud.parseScriptId(e.url)).filter(e=>!!e)[0])},e.topicsByTag=function(r,e){return e=(r=r.replace(/\/$/,""))+`/tag/${e}.json`,n.Util.httpGetJsonAsync(e).then(e=>{let t=n.Util.toDictionary(e.users,e=>e.id.toString());return e.topic_list.topics.map(e=>({id:e.id,title:e.title,url:r+`/t/${e.slug}/`+e.id,imageUrl:e.image_url,author:t[e.posters[0].user_id].username,cardType:"forumUrl"}))})}})(pxt=pxt||{}),(h=>{{var S=h.docs||(h.docs={}),C=pxtc.Util;let b,T={},k={};var e="\x3c!-- @CMD@ @ARGS@ --\x3e";let x={parent:e,short:e,description:"\x3c!-- desc --\x3e",activities:"\x3c!-- activities --\x3e",explicitHints:"\x3c!-- hints --\x3e",flyoutOnly:"\x3c!-- flyout --\x3e",hideToolbox:"\x3c!-- hideToolbox --\x3e",hideIteration:"\x3c!-- iter --\x3e",codeStart:"\x3c!-- start --\x3e",codeStop:"\x3c!-- stop --\x3e",autoOpen:"\x3c!-- autoOpen --\x3e",autoexpandOff:"\x3c!-- autoexpandOff --\x3e",preferredEditor:"\x3c!-- preferredEditor --\x3e"};function t(e,t,r){return e.split(t).join(r)}function r(e){return e=t(e,"&","&amp;"),e=t(e,"<","&lt;"),e=t(e,">","&gt;"),e=t(e,'"',"&quot;"),e=t(e,"'","&#39;")}function w(e){return e&&r(e.replace(/\&([#a-z0-9A-Z]+);/g,(e,t)=>{switch(t){case"amp":return"&";case"lt":return"<";case"gt":return">";case"quot":return'"';default:return"#"==t[0]?String.fromCharCode(parseInt(t.slice(1))):e}}))}S.htmlQuote=r,S.html2Quote=w;let v=[{rx:/^vimeo\.com\/(\d+)/i,cmd:"### @vimeo $1"},{rx:/^(www\.youtube\.com\/watch\?v=|youtu\.be\/)([\w\-]+(\#t=([0-9]+m[0-9]+s|[0-9]+m|[0-9]+s))?)/i,cmd:"### @youtube $2"}],E=(S.requireMarked=()=>"undefined"!=typeof marked?marked:"undefined"!=typeof require?require("marked"):void 0,S.requireDOMSanitizer=()=>"undefined"!=typeof DOMPurify?DOMPurify.sanitize:"undefined"!=typeof require?require("DOMPurify").sanitize:void 0,e=>`<div class='ui negative message'>${r(e)}</div>`);function I(i){let s=C.clone(T),a=C.clone(k),o=C.clone(x),l={},c={},r=i.params;var e=i.theme;i.boxes=s,i.macros=a,i.settings=o,i.html=i.html.replace(/<aside\s+([^<>]+)>([^]*?)<\/aside>/g,(e,t,r)=>{var t=(t=>{for(var r,n={};t.trim();){let e=/\s*([^=\s]+)=("([^"]*)"|'([^']*)'|(\S*))/.exec(t);e?(r=e[3]||e[4]||e[5]||"",n[e[1].toLowerCase()]=r):n[(e=/^\s*(\S+)/.exec(t))[1]]="true",t=t.slice(e[0].length)}return n})(t),n=t["data-name"]||t.id;return n?(/box/.test(t.class)?s[n]=r:/aside/.test(t.class)?s[n]=`<!-- BEGIN-ASIDE ${n} -->${r}<!-- END-ASIDE -->`:/setting/.test(t.class)?o[n]=r:/menu/.test(t.class)?l[n]=r:/toc/.test(t.class)?c[n]=r:a[n]=r,`<!-- macro ${n} -->`):E("id or data-name missing on macro")});let u=(e,t)=>{let r=l.item;var n={NAME:e.name};if(e.subitems)r=l["toc-dropdown"]||(0==t?l["top-dropdown"]:l["inner-dropdown"]),n.ITEMS=e.subitems.map(e=>u(e,t+1)).join("\n");else{if(/^-+$/.test(e.name)&&(r=l.divider),e.path&&!/^(https?:|\/)/.test(e.path))return E("Invalid link: "+e.path);n.LINK=e.path}return N(r,n,["ITEMS"])},d=[{name:lf("Docs"),href:"/docs"}];var n=i.TOC||e.TOC||[];let p=[],h=e=>{for(var t of e.subitems||[])if(h(t))return p.push(e),!0;return!(!i.filepath||!e.path||i.filepath!=e.path||(p.push(e),0))},m=(n.forEach(h),(e,t)=>{let r=c.item;var n={NAME:e.name};return e.path&&!/^(https?:|\/)/.test(e.path)?E("Invalid link: "+e.path):(/^\//.test(e.path)&&i.versionPath&&(e.path="/"+i.versionPath+e.path),n.LINK=e.path,0<=p.indexOf(e)?(n.ACTIVE="active",n.EXPANDED="true",d.push({name:e.name,href:e.path})):n.EXPANDED="false",e.subitems&&0<e.subitems.length?(r=c["toc-dropdown"]?""!==e.name?c["toc-dropdown"]:c["toc-dropdown-noLink"]:0==t?""!==e.name?c["top-dropdown"]:c["top-dropdown-noHeading"]:1==t?c["inner-dropdown"]:c["nested-dropdown"],n.ITEMS=e.subitems.map(e=>m(e,t+1)).join("\n")):/^-+$/.test(e.name)&&(r=c.divider),N(r,n,["ITEMS"]))}),t=(r.menu=(e.docMenu||[]).map(e=>u(e,0)).join("\n"),r.TOC=n.map(e=>m(e,0)).join("\n"),e.appStoreID&&(r.appstoremeta=`<meta name="apple-itunes-app" content="app-id=${C.htmlEscape(e.appStoreID)}"/>`),"");1<d.length&&(t=`
            <nav class="ui breadcrumb" aria-label="${lf("Breadcrumb")}">
                ${d.map((e,t)=>`<a class="${t==d.length-1?"active":""} section"
                        href="${w(e.href)}" aria-current="${t==d.length-1?"page":""}">${w(e.name)}</a>`).join('<i class="right chevron icon divider"></i>')}
            </nav>`),r.breadcrumb=t,e.boardName&&(r.boardname=w(e.boardName)),e.boardNickname&&(r.boardnickname=w(e.boardNickname)),e.driveDisplayName&&(r.drivename=w(e.driveDisplayName)),e.homeUrl&&(r.homeurl=w(e.homeUrl)),r.targetid=e.id||"???",r.targetname=e.name||"Microsoft MakeCode",r.docsheader=e.docsHeader||"Documentation",r.orgtitle="MakeCode";var n=e.docsLogo&&C.htmlEscape(e.docsLogo),g=(e.organizationWideLogo||e.organizationLogo)&&C.htmlEscape(e.organizationWideLogo||e.organizationLogo),f=e.organizationLogo&&C.htmlEscape(e.organizationLogo),n=(r.targetlogo=n?`<img aria-hidden="true" role="presentation" class="ui ${e.logoWide?"small":"mini"} image" src="${n}" />`:"",r.orglogo=g?`<img aria-hidden="true" role="presentation" class="ui image" src="${g}" />`:"",r.orglogomobile=f?`<img aria-hidden="true" role="presentation" class="ui image" src="${f}" />`:"",i.ghEditURLs||[]);if(n.length){let e=`<p style="margin-top:1em">
`,t=lf("Edit this page on GitHub");for(var _ of n)e+=`<a href="${_}"><i class="write icon"></i>${t}</a><br>
`,t=lf("Edit template of this page on GitHub");e+=`</p>
`,r.github=e}else r.github="";var y,g=`
            <a href="#maincontent" class="ui item link" tabindex="0" role="menuitem">${lf("Skip to main content")}</a>
        `,f=(r.accMenu=g,lf("Print this page")),n=(r.printBtn=`
            <button id="printbtn" class="circular ui icon right floated button hideprint" title="${f}" aria-label="${f}">
                <i class="icon print"></i>
            </button>
        `,`
            <a id="togglesidebar" class="launch icon item" tabindex="0" title="Side menu" aria-label="${lf("Side menu")}" role="menuitem" aria-expanded="false">
                <i class="content icon"></i>
            </a>
        `),g=(r.sidebarToggle=n,["tocsearch1","tocsearch2"].map(e=>`
                <input type="search" name="q" placeholder="${lf("Search...")}" aria-label="${lf("Search Documentation")}">
                <i onclick="document.getElementById('${e}').submit();" tabindex="0" class="search link icon" aria-label="${lf("Search")}" role="button"></i>
            `));r.searchBar1=g[0],r.searchBar2=g[1];let b="";e.accentColor&&(b+=`
.ui.accent { color: ${e.accentColor}; }
.ui.inverted.accent { background: ${e.accentColor}; }
`),r.targetstyle=b,r.tocclass=e.lightToc?"lighttoc":"inverted";for(y of Object.keys(e)){var v=e[y];void 0===r[y]&&"string"==typeof v&&(r[y]=v)}i.finish=()=>N(i.html,r,["body","menu","accMenu","TOC","prev","next","printBtn","breadcrumb","targetlogo","orglogo","orglogomobile","github","JSON","appstoremeta","sidebarToggle","searchBar1","searchBar2"])}function A(e){e.image=function(n,t,r){if(n.startsWith("youtube:"))return'<div class="tutorial-video-embed"><iframe class="yt-embed" src="https://www.youtube.com/embed/'+n.split(":").pop()+'" title="'+r+'" frameborder="0" allowFullScreen allow="autoplay; picture-in-picture"></iframe></div>';if(n.startsWith("azuremedia:")){let e=n.split(":")[1];var i=e.split("?");let t,r;i[1]&&(e=i[0],i=i[1],t=null==(s=/start(?:time)?=(\d+)/i.exec(i))?void 0:s[1],r=null==(s=/end(?:time)?=(\d+)/i.exec(i))?void 0:s[1]);var i=new URL(`https://makecodeprodmediaeastus-usea.streaming.media.azure.net/${e}/manifest(format=mpd-time-csf).mpd`),s=(t&&(i.hash="t="+t,i.searchParams.append("startTime",t)),r&&i.searchParams.append("endTime",r),`<div class="tutorial-video-embed"><video class="ams-embed" controls src="${i.toString()}" /></div>`);return s}{let e='<img class="ui image" src="'+n+'" alt="'+r+'"';return t&&(e+=' title="'+t+'"'),e=(e+=' loading="lazy"')+(this.options.xhtml?"/>":">")}},e.listitem=function(e){var t=/^\s*\[( |x)\]/i.exec(e);return t?`<li class="${" "==t[1]?"unchecked":"checked"}">`+e.slice(t[0].length)+"</li>\n":"<li>"+e+"</li>\n"},e.heading=function(e,t,r){var n=/(.*)#([\w\-]+)\s*$/.exec(e);let i="";return n&&(e=n[1],i=n[2]),(e=e&&e.replace(/@(fullscreen|unplugged|showdialog|showhint)/gi,"")).match(/\{([\s\S]+)\}/)&&(e=e.match(/\{([\s\S]+)\}/)[1].trim()),""===i&&(i=e.toLowerCase().replace(/[^\w]+/g,"-")),`<h${t} id="${this.options.headerPrefix}${i}">${e}</h${t}>`}}function D(e,i){return e.replace(/<!--\s*@(ifn?def)\s+(\w+)\s*-->([^]*?)<!--\s*@endif\s*-->/g,(e,t,r,n)=>"ifdef"==t&&i[r]||"ifndef"==t&&!i[r]?`<!-- ${t} ${r} -->${n}<!-- endif -->`:`<!-- ${t} ${r} endif -->`)}function N(e,n,i=[]){return e?e.replace(/@(\w+)@/g,(e,t)=>{let r=C.lookup(n,t)||"";return r+="",r=i.indexOf(t)<0?w(r):r}):""}S.prepTemplate=I,S.setupRenderer=A,S.renderConditionalMacros=D,S.renderMarkdown=function(o){let e=!0,l=(o.pubinfo||(e=!1,o.pubinfo={}),o.pubinfo),t=(o.theme||(o.theme={}),delete o.pubinfo.private,l.time&&(d=parseInt(l.time),l.timems||(l.timems=1e3*d+""),l.humantime||(l.humantime=C.isoTime(d))),l.name&&(l.dirname=l.name.replace(/[^A-Za-z0-9_]/g,"-"),l.title=l.name),e&&(l.JSON=JSON.stringify(l,null,4).replace(/</g,"\\u003c")),o.template),c=(t=D(t=t.replace(/<!--\s*@include\s+(\S+)\s*-->/g,(e,t)=>"\x3c!-- include "+t+" --\x3e\n"+((o.theme.htmlDocIncludes||{})[t]||"")+"\n\x3c!-- end include --\x3e\n"),l),{html:t=o.locale?O(t,o.locale).text:t,theme:o.theme,filepath:o.filepath,versionPath:o.versionPath,ghEditURLs:o.ghEditURLs,params:l,TOC:o.TOC}),s=(I(c),new(b=b||S.requireMarked()).Renderer),a=(A(s),s.link);s.link=function(e,t,r){var n=new RegExp("^[/#]").test(e),i=n?"":"_blank";return n&&c.versionPath&&(e="/"+c.versionPath+e),a.call(s,e,t,r).replace(/^<a /,`<a ${i?`target="${i}"`:""} rel="nofollow noopener" `)};var r,n,i,u,d=S.requireDOMSanitizer();b.setOptions({renderer:s,gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!0,sanitizer:d,smartLists:!0,smartypants:!0});let p=o.markdown,h=(o.repo&&(p+=`
\`\`\`package
${o.repo.name.replace(/^pxt-/,"")}=github:${o.repo.fullName}#${o.repo.tag||"master"}
\`\`\`
`),p=(p=p.replace(/^\s*https?:\/\/(\S+)\s*$/gm,(e,t)=>{for(var n of v){let r=n.rx.exec(t);if(r)return n.cmd.replace(/\$(\d+)/g,(e,t)=>r[parseInt(t)]||"")+"\n"}return e})).replace(/@([a-z]+)@/gi,(e,t)=>{var r=l[t];return!r&&o.throwOnError&&C.userError("unknown macro "+t),r||"unknown macro"}),b(p)),m=(h=(h=h.replace(/&lt;br\s*\/&gt;/gi,"<br/>")).replace(/(<img [^>]* src=")\/docs\/static\/([^">]+)"/g,(e,t,r)=>t+"/static/"+r+'"'),""),g=0;function f(e,t,r){let n=r;return e<=g&&(n=m+n,m="",g=0),n}h=h.replace(/<h(\d)[^>]+>\s*([~@])?\s*(.*?)<\/h\d>/g,(e,t,r,n)=>{var i,s=/^(\w+)\s+(.*)/.exec(n),n=s?s[1]:n,s=(s=s?s[2]:"",w(s)),n=w(n);if(t=parseInt(t),r){if("@"!=r)return n?(r=C.lookup(c.boxes,n))?(a=r.split("@BODY@"),i=f(t,m,a[0].replace("@ARGS@",s)),m=a[1],(a=r.match(/data-[^>\s]+/gi))&&0<=a.indexOf("data-inferred")&&(g=t),i):(o.throwOnError&&C.userError("Unknown box: ~ "+n),E("Unknown box: ~ "+n)):(r=m,m="",r);{let e=C.lookup(c.settings,n);if(null!=e)l[n]=s;else if(null==(e=C.lookup(c.macros,n)))return o.throwOnError&&C.userError("Unknown command: @"+n),E("Unknown command: @"+n);var a={ARGS:s,CMD:n};return f(t,m,N(e,a,["ARGS","CMD"]))}}return f(t,m,e)}),m&&(h+=m),l.title||(d=/<h1[^<>]*>([^<>]+)<\/h1>/.exec(h))&&(l.title=w(d[1])),l.description||(d=/<p>([^]+?)<\/p>/.exec(h))&&(l.description=w(d[1])),(d=/<div class="ui embed mdvid"[^<>]+?data-placeholder="([^"]+)"[^>]*\/?>/i.exec(h)||/<img class="ui [^"]*image" src="([^"]+)"[^>]*\/?>/i.exec(h))&&(l.cardLogo=w(d[1])),l.twitter=w(o.theme.twitter||"@msmakecode");let _={main:""};h=(h=h.replace(/<!-- BEGIN-ASIDE (\S+) -->([^]*?)<!-- END-ASIDE -->/g,(e,t,r)=>{var n=C.lookup(_,t);return _[t]=(n||"")+r,"\x3c!-- aside --\x3e"})).replace(/\n<\/code>/g,"</code>"),_.main=h,h="";for(r of Object.keys(_))h+=(n=r+"-container",i=_[r],N(c.boxes[n]||"@BODY@",{BODY:i},["BODY"]));l.body=h,l.name=l.title||"";for(u of Object.keys(o.theme)){var y=o.theme[u];"string"==typeof y&&(l["theme_"+u]=y)}return c.finish()},S.embedUrl=function(e,t,r,n){return`<div style="position:relative;height:0;padding-bottom:70%;overflow:hidden;"><iframe style="position:absolute;top:0;left:0;width:100%;height:100%;" src="${e+`#${t}:`+r}" frameborder="0" sandbox="allow-popups allow-forms allow-scripts allow-same-origin"></iframe></div>`},S.runUrl=function(e,t,r){return`<div style="position:relative;height:0;padding-bottom:${t};overflow:hidden;"><iframe style="position:absolute;top:0;left:0;width:100%;height:100%;" src="${e}?id=${encodeURIComponent(r)}" allowfullscreen="allowfullscreen" sandbox="allow-popups allow-forms allow-scripts allow-same-origin" frameborder="0"></iframe></div>`},S.codeEmbedUrl=function(e,t,r){return e=e+"---codeembed#pub:"+t,`<div style="position:relative;height:calc(${r=Math.ceil(r||300)}px + 5em);width:100%;overflow:hidden;"><iframe style="position:absolute;top:0;left:0;width:100%;height:100%;" src="${e}" allowfullscreen="allowfullscreen" frameborder="0" sandbox="allow-scripts allow-same-origin"></iframe></div>`};let o={b:1,strong:1,em:1};function O(e,n){let i={};function s(e){var t,e=/^(\s*)([^]*?)(\s*)$/.exec(e);let r=e[2].replace(/\s+/g," ");return""==r||/^((IE=edge,.*|width=device-width.*|(https?:\/\/|\/)[\w@\/\.]+|@[\-\w]+@|\{[^\{\}]+\}|[^a-zA-Z]*|(&nbsp;)+)\s*)+$/.test(r)?null:((t=C.lookup(n,r))?r=t:i[r]="",e[1]+r+e[3])}function a(e){return e.replace(/&llt;/g,"<").replace(/&ggt;/g,">")}return{text:e=(e=(e=(e="<start>"+(e=e.replace(/<([\/\w]+)([^<>]*)>/g,(e,t,r)=>{var n=t.replace(/^\//,"").toLowerCase();return 1===o[n]?"&llt;"+t+r+"&ggt;":e}))).replace(/(<([\/\w]+)([^<>]*)>)([^<>]+)/g,(e,t,r,n,i)=>"script"==r||"style"==r||null==(r=s(a(i)))?a(e):t+r)).replace(/(<[^<>]*)(content|placeholder|alt|title)="([^"]+)"/g,(e,t,r,n)=>null==s(n)?e:t+r+'="'+n.replace(/"/g,"''")+'"')).replace(/^<start>/g,""),missing:i}}function m(e,n){let t=0;var i,s=[{level:0,id:"",title:"",start:t,text:"",children:[]}],e=(e=e.replace(/\r/g,"")).split(/\n/);let a={};for(i of e){let e=/^\s*(#+)\s*(.*?)(#(\S+)\s*)?$/.exec(i),r=null;if(n&&e)if(e[4])if(a[e[4]])e=null;else{r=function e(t,r){if(t.id==r)return t;for(var n of t.children)if(n=e(n,r))return n;return null}(n,e[4]);let t=e=>{e.id&&(a[e.id]=!0),e.children.forEach(t)};r&&t(r)}else e=null;if(e){var o={level:n?1:e[1].length,title:e[2].trim(),id:e[4]||"",start:t,text:"",children:[]};if(r){i="";for(let e=0;e<r.level;++e)i+="#";i=(i=(i+=" ")+(o.title||r.title))+(" #"+o.id)}for(;s[s.length-1].level>=o.level;)s.pop();s[s.length-1].children.push(o),s.push(o)}s[s.length-1].text+=i+"\n",t++}return s[0]}S.translate=O,S.buildTOC=function(e){if(!e)return null;var t=h.docs.requireMarked(),r=S.requireDOMSanitizer(),r={renderer:new t.Renderer,gfm:!0,tables:!1,breaks:!1,pedantic:!1,sanitize:!0,sanitizer:r,smartLists:!1,smartypants:!1},n={name:"dummy",subitems:[]};let i=[],s=(i.push(n),t=t.lexer(e,r),!1);return t.forEach(e=>{switch(e.type){case"heading":e.depth;break;case"list_start":break;case"list_item_start":case"loose_item_start":s=!0;var t={name:"",path:"",subitems:[]};return void i.push(t);case"text":let n=i[i.length-1];0<=e.text.indexOf("[")?e.text.replace(/\[(.*?)\]\((.*?)\)/i,function(e,t,r){n.name=t,n.path=r.replace(".md","")}):s&&(n.name=e.text);break;case"list_item_end":case"loose_item_end":t=i.pop();i[i.length-1].subitems.push(t)}s=!1}),(e=n.subitems)&&0!=e.length?e:null};let p=!(S.visitTOC=function(e,t){e.forEach(function(e){t(e),e.subitems&&e.subitems.forEach(t)})});function g(e,t){function r(e,t,r){var n=g(e,t).trim();if(n!=(r=r.trim()))throw h.log(`*** Template:
${e}
*** Input:
${t}
*** Expected:
${r}
*** Output:
`+n),new Error("augment docs test fail")}if(p||(p=!0,r(i=`
# T0
## Examples #ex
### Example 1
TEx1
### Example 2 #ex2
TEx2
### Example 3
TEx3

## See also #also
TAlso
`,"",i),r(i," ",i),r(i,`
# @extends
# #ex2
My example
## See Also These! #also
My links
`,`
# T0
## Examples #ex
### Example 1
TEx1
### Example 2 #ex2
My example
### Example 3
TEx3

## See Also These! #also
My links
`),r(i,`
# @extends
### #ex
Foo
#### Example 1
Ex1
#### Example 2x #ex2
Ex2
## See Also These! #also
My links
`,`
# T0
## Examples #ex
Foo
#### Example 1
Ex1
#### Example 2x #ex2
Ex2
## See Also These! #also
My links
`)),!t)return e;var n,i=m(e,null),e=m(t,i);let s={},a={};for(n of e.children)C.assert(0==n.children.length),C.assert(!!n.id),s[n.id]=n.text;let o=e=>{e.id&&void 0!==s[e.id]&&(a[e.id]=!0,e.text=s[e.id],e.children=[]),e.children.forEach(o)},l=(o(i),""),c=e=>{l+=e.text,e.children.forEach(c)},u=(c(i),"");var d,t=e.text.replace(/^\s*#+\s*@extends.*/gm,"").replace(/^\s*\n/gm,"");t.trim()&&(u+=t.trim()+"\n");for(d of e.children)a[d.id]||(u+=d.text);return u&&(l+="## Couldn't apply replacement logic to:\n"+u),l}S.augmentDocs=g}})(pxt=pxt||{}),(e=>{(e.dom||(e.dom={})).el=function(e,t,r){let n=document.createElement(e);return t&&Object.keys(t).forEach(e=>n.setAttribute(e,t[e]+"")),function t(e){Array.isArray(e)?e.forEach(e=>t(e)):"string"==typeof e?n.appendChild(document.createTextNode(e)):e instanceof HTMLElement&&n.appendChild(e)}(r),n}})(pxt=pxt||{}),(c=>{var e;function u(e){e=/```package\s+((.|\s)+?)\s*```/i.exec(e);let t=void 0;return e&&(t={},e[1].split("\n").map(e=>e.replace(/\s*/g,"")).filter(e=>!!e).map(e=>e.split("=")).forEach(e=>t[e[0]]=e[1]||"*")),t}function d(e){e=/```config\s+((.|\s)+?)\s*```/i.exec(e);let t=[];return e&&e[1].split("\n").map(e=>e.replace(/\s*/g,"")).filter(e=>!!e).map(e=>e.split("=")).filter(e=>"feature"==e[0]&&!!e[1]).forEach(e=>t.push(e[1])),t.length?t:void 0}function p(e){var t,e=/```jres\s+((.|\s)+?)\s*```/i.exec(e);if(e)return e=e[1],t=JSON.parse(e),{jres:e,ts:c.emitTilemapsFromJRes(t)}}function h(e){e=/```assetjson\s+((.|\s)+?)\s*```/i.exec(e);return e?c.tutorial.parseAssetJson(e[1]):{}}function m(e){e=/```simtheme\s+([\s\S]*?)```/i.exec(e);return e?c.tutorial.parseSimThemeJson(e[1]):{}}function a(e){let t=c.Util.jsonTryParse(e);return null!=(t=t&&!Array.isArray(t)?[t]:t)&&t.length||null!=(t=e.split(/^---$/gm).filter(e=>!!e).map(e=>{let i={};return e.replace(/^\s*(?:-|\*)\s+(\w+)\s*:\s*(.*)$/gm,(e,t,r)=>{var n;return"flags"==t?i[t]=r.split(","):"otherAction"===t?(n=r.split(",").map(e=>null==e?void 0:e.trim()),(i.otherActions||(i.otherActions=[])).push({url:n[0],editor:n[1],cardType:n[2]})):i[t]=r,""}),!!Object.keys(i).length&&i}).filter(e=>!!e))&&t.length?t:void 0}function t(e){if(!e)return[];let r=[],n=!1,i=void 0,s="";return e.split(/\r?\n/).forEach(e=>{var t;/^## /.test(e)?i=e.substr(2).trim():/^(### ~ |```)codecard$/.test(e)?n=!0:/^(### ~|```)$/.test(e)?(n=!1,i&&s&&(null!=(t=a(s))&&t.length?r.push({name:i,cards:t}):c.log("invalid gallery format")),s="",i=void 0):n&&(s+=e+"\n")}),r.forEach(e=>e.cards.forEach(t=>{var e;!t.otherActions||t.otherActions.length||"tutorial"!=t.cardType&&"example"!=t.cardType||(e=["js"],c.appTarget.appTheme.python&&e.unshift("py"),t.otherActions=e.map(e=>({url:t.url,cardType:t.cardType,editor:e})))})),r}(e=c.gallery||(c.gallery={})).parsePackagesFromMarkdown=u,e.parseFeaturesFromMarkdown=d,e.parseJResFromMarkdown=p,e.parseTemplateProjectJSON=h,e.parseSimThemeJSON=m,e.parseExampleMarkdown=function(e,t){if(t){var r,n,i,s,a,o,l=/```(blocks?|typescript|python|spy|sim)\s+((.|\s)+?)\s*```/i.exec(t);if(l)return r=u(t),n=l[1],i=l[2],s=d(t),a=p(t),o=m(t),(e={name:e,filesOverride:{[c.MAIN_BLOCKS]:'<xml xmlns="http://www.w3.org/1999/xhtml"></xml>',["python"===l[1]?c.MAIN_PY:c.MAIN_TS]:i},dependencies:r,features:s,snippetType:n,source:i,simTheme:o}).filesOverride=Object.assign(Object.assign({},e.filesOverride),h(t)),a&&(e.filesOverride[c.TILEMAP_JRES]=a.jres,e.filesOverride[c.TILEMAP_CODE]=a.ts),e}},e.parseCodeCards=a,e.parseCodeCardsHtml=function(e){let t=[],r;return Array.from(e.children).forEach(e=>{"UL"===e.tagName||"OL"===e.tagName?(r=r||{},Array.from(e.querySelectorAll("li")).forEach(e=>{var t,e=e.innerText,e=/^\s*(\w+)\s*:\s*(.*)$/.exec(e);e&&(t=e[1],r[t]=e[2].trim(),"flags"===t)&&(r[t]=r[t].split(/,\s*/))})):"HR"==e.tagName&&(r&&t.push(r),r=void 0)}),r&&t.push(r),!(null==(t=0===t.length&&"CODE"===e.tagName?c.Util.jsonTryParse(e.textContent):t)||!t.length)&&t},e.parseGalleryMardown=t,e.loadGalleryAsync=function(e){return c.Cloud.markdownAsync(e).then(e=>t(e))},e.codeCardsToMarkdown=function(e){return`### ~ codecard

${(e||[]).map(t=>Object.keys(t).filter(e=>!!t[e]).map(e=>"otherActions"===e?t[e].map(e=>`* otherAction: ${e.url}, ${e.editor||""}, `+(e.cardType||"")).join("\n"):`* ${e}: `+t[e]).join("\n")).join(`

---

`)}

### ~
`}})(pxt=pxt||{}),(o=>{class e{constructor(e){this.io=e,this.q=new o.U.PromiseQueue,this.dataBuf="",this.numSent=0,this.pktSize=400,this.trace=!1,this.bmpMode=!0,this.targetInfo="",this.onEvent=e=>{},this.io.onData=e=>this.onData(e)}onData(e){for(this.dataBuf+=o.U.uint8ArrayToString(e);0<this.dataBuf.length;){var t=this.dataBuf[0];if("+"==t)this.dataBuf=this.dataBuf.slice(1);else if("$"==t||"%"==t){var r=this.decodeResp(this.dataBuf.slice(1));if(null==r)break;"$"==t?(this.io.sendPacketAsync(this.buildCmd("+")),this.onResponse?this.onResponse(r):0<this.numSent&&this.io.error("unexpected response: "+r)):this.onEvent(r)}else this.io.error("invalid character: "+t)}}buildCmd(t){if("+"==t)return o.U.stringToUint8Array(t);let r="";for(let e=0;e<t.length;++e){var n=t.charAt(e);"}"==n||"#"==n||"$"==n?r=(r+="}")+String.fromCharCode(32^n.charCodeAt(0)):r+=n}let i=0;t=r;for(let e=0;e<t.length;++e)i=i+t.charCodeAt(e)&255;return r="$"+t+"#"+("0"+i.toString(16)).slice(-2),o.U.stringToUint8Array(r)}decodeResp(r){let n="";for(let t=0;t<r.length;++t){var e=r[t];if("}"==e)++t,n+=String.fromCharCode(32^r.charCodeAt(t));else if("*"==e){++t;let e=r.charCodeAt(t)-29;for(var i=n.charAt(n.length-1);0<e--;)n+=i}else{if("#"==e)return 2==r.slice(t+1,t+3).length?(this.dataBuf=r.slice(t+3),n):null;n+=e}}return null}sendCmdOKAsync(e){return this.sendCmdAsync(e,e=>"OK"==e)}error(e){this.io.error(e),this.io.disconnectAsync()}sendCmdAsync(r,n){this.numSent++;let e=this.buildCmd(r);return this.q.enqueue("one",()=>null===n?this.io.sendPacketAsync(e).then(()=>null):new Promise(t=>{this.onResponse=e=>{this.onResponse=null,this.trace&&o.log(`GDB: '${r}' -> '${e}'`),void 0===n||n(e)||this.error(`Invalid GDB command response: '${r}' -> '${e}'`),t(e)},this.io.sendPacketAsync(e)}))}sendRCmdAsync(e){return this.sendMCmdAsync("qRcmd,"+o.U.toHex(o.U.stringToUint8Array(e)))}sendMCmdAsync(n){this.numSent++;let e=this.buildCmd(n),i="";return this.q.enqueue("one",()=>new Promise(r=>{this.onResponse=e=>{var t;"OK"!=e&&"O"==e[0]?i+=(t=e.slice(1),o.U.uint8ArrayToString(o.U.fromHex(t))):("OK"!=e&&(i+=" - "+e),this.onResponse=null,this.trace&&o.log(`Final GDB: '${n}' -> '${i}'`),r(i))},this.io.sendPacketAsync(e)}))}write32Async(e,t){var r=new Uint8Array(4);return o.HF2.write32(r,0,t),this.writeMemAsync(e,r)}writeMemAsync(e,t){var r=this.pktSize/2-10;return o.U.assert(t.length<r),this.sendCmdOKAsync("M"+e.toString(16)+","+t.length.toString(16)+":"+o.U.toHex(t)).then(e=>{o.log(e)})}readMemAsync(e,s){let a=this.pktSize/2-6;if(s>a){let n=new Uint8Array(s),i=t=>{let r=Math.min(s-t,a);return 0==r?Promise.resolve(n):this.readMemAsync(e+t,r).then(e=>(o.U.memcpy(n,t,e),i(t+r)))};return i(0)}return this.sendCmdAsync("m"+e.toString(16)+","+s.toString(16)).then(e=>o.U.fromHex(e))}initBMPAsync(){return Promise.resolve().then(()=>this.sendRCmdAsync("swdp_scan")).then(e=>(this.targetInfo=e,this.sendCmdAsync("vAttach;1",e=>"T"==e[0]))).then(()=>{})}initAsync(){return o.U.delay(1e3).then(()=>this.sendCmdAsync("!")).then(()=>this.sendCmdAsync("qSupported")).then(e=>{let n={};return e=(e=";"+e+";").replace(/;([^;]+)[=:]([^:;]+)/g,(e,t,r)=>(n[t]=r,";")),this.pktSize=parseInt(n.PacketSize)||1024,o.log("GDB-server caps: "+JSON.stringify(n)+" "+e.replace(/;+/g,";")),this.bmpMode?this.initBMPAsync():this.sendCmdAsync("c").then(()=>{})})}}o.GDBServer=e})(pxt=pxt||{}),(c=>{var e;{var o=c.github||(c.github={});function l(){var e;return!!o.forceProxy||!(c.U.isNodeJS||null!=(e=null==(e=null==c?void 0:c.appTarget)?void 0:e.cloud)&&e.noGithubProxy)}o.token=null,o.forceProxy=!1;let i={};function u(i){var e;return i.method=null!=(e=i.method)?e:"GET",function r(e){var t;let n=c.U.clone(i);o.token&&(n.headers||(n.headers={}),n.url==a?n.headers.Authorization="bearer "+o.token:(n.url=c.BrowserUtils.cacheBustingUrl(n.url),n.headers.Authorization="token "+o.token));n.allowHttpErrors=null!=(t=n.allowHttpErrors)&&t;return c.U.requestAsync(n).catch(t=>{if(c.tickEvent("github.error",{statusCode:t.statusCode}),o.handleGithubNetworkError){let e=o.handleGithubNetworkError(n,t);if(e)return r(!1)}throw t})}(o.token)}function d(e){return u({url:e,method:"GET"}).then(e=>e.json)}function p(e){return c.Cloud.apiRequestWithCdnAsync({url:"gh/"+e,forceLiveEndpoint:!0}).then(e=>e.json)}function h(e){c.log("github proxy error: "+e.message),c.debug(e)}o.isOrgAsync=function(e){return u({url:"https://api.github.com/orgs/"+e,method:"GET",allowHttpErrors:!0}).then(e=>200==e.statusCode)};class M{constructor(){this.latestVersions={},this.configs={},this.packages={}}proxyWithCdnLoadPackageAsync(e,t){let r=e+"/"+t;var n=this.packages[r];return n?(c.debug(`github cache ${e}/${t}/text`),Promise.resolve(n)):p(D((n=w(e)).slug,t,n.fileName,"text")).then(e=>this.packages[r]={files:e})}cacheConfig(e,t){t=c.Package.parseAndValidConfig(t);return this.configs[e]=t,c.U.clone(t)}async loadConfigAsync(e,t){t||(c.debug("dep: default to master branch"),t="master");var r=e+"/"+t,n=this.configs[r];if(n)return c.debug(`github cache ${e}/${t}/config`),c.U.clone(n);if(l())try{var i=await this.proxyWithCdnLoadPackageAsync(e,t);return this.cacheConfig(r,i.files[c.CONFIG_NAME])}catch(e){h(e)}n=await g(e,t,c.CONFIG_NAME);return this.cacheConfig(r,n)}async latestVersionAsync(e,t){let r=this.latestVersions[e];return r||(c.debug("dep: resolve latest version of "+e),this.latestVersions[e]=r=await c.github.latestVersionAsync(e,t,!0,!1)),r}async loadPackageAsync(e,t){if(t||(c.debug("load pkg: default to master branch"),t="master"),l())try{return await this.proxyWithCdnLoadPackageAsync(e,t).then(e=>c.U.clone(e))}catch(e){h(e)}return this.githubLoadPackageAsync(e,t)}githubLoadPackageAsync(i,r){return v(i,r).then(n=>{let t=i+"/"+n;var e=this.packages[t];return e?(c.debug(`github cache ${i}/${r}/text`),Promise.resolve(c.U.clone(e))):(c.log(`Downloading ${i}/${r} -> `+n),g(i,n,c.CONFIG_NAME).then(e=>{let r={files:{}};r.files[c.CONFIG_NAME]=e;e=JSON.parse(e);return c.U.promiseMapAll(c.allPkgFiles(e).slice(1),t=>g(i,n,t).then(e=>{r.files[t]=e})).then(()=>(this.packages[t]=r,c.U.clone(r)))}))})}async loadTutorialMarkdown(e,t){e=(await r(e=P(e),t)).resp,t=e.markdown;return c.Util.assert("object"==typeof t),await this.cacheReposAsync(e),t.repo}async cacheReposAsync(e){var t,r;"object"==typeof e.markdown&&(t=e.markdown,this.cacheRepo(t.repo));for(r of e.dependencies)this.cacheRepo(r)}cacheRepo(e){let t=e.repo;e.subPath&&(t+="/"+e.subPath);var r=t,n=(this.packages[r+="/"+e.sha]={files:e.files},e.latestVersion&&this.cacheLatestVersion(t,e.latestVersion),e.files["pxt.json"]);n&&(e=r+"/"+(e.version||"master"),this.cacheConfig(r,n),this.cacheConfig(e,n))}cacheLatestVersion(e,t){this.latestVersions[e]=t}}function m(t,e,r){return u({url:"https://api.github.com/repos/"+D(t.slug,"contents",t.fileName,r+"?ref="+e),method:"GET"}).then(e=>{e=e.json;return i[t.slug]=!0,e&&"base64"==e.encoding&&null!=e.content?c.Util.fromUTF8(atob(e.content)):c.U.httpGetTextAsync(e.download_url)})}function g(e,t,r){let n=w(e);return i[n.slug]?m(n,t,r):c.U.requestAsync({url:"https://raw.githubusercontent.com/"+D(n.slug,t,n.fileName,r),allowHttpErrors:!0}).then(e=>200==e.statusCode?e.text:m(n,t,r))}async function r(e,t,r,n){let i=c.Cloud.apiRequestWithCdnAsync;var s=new URLSearchParams;t&&s.set("ref",t),r&&(s.set("noCache","1"),i=c.Cloud.privateRequestAsync);t=c.BrowserUtils.appendUrlQueryParams("ghtutorial/"+e,s),r=await i({url:t,method:"GET",headers:n?{"If-None-Match":n}:void 0});let a;return{resp:a=304===r.statusCode?void 0:r.json,etag:r.headers.etag}}function f(e,t,r,n){return u({url:/^https:/.test(e)?e:"https://api.github.com/repos/"+e,headers:r,method:n||"POST",data:t,successCodes:[200,201,202,204]}).then(e=>e.json)}function _(e,t){let r=1;for(;e.refs[t+r];)r++;return t+r}async function y(e,t,r){return await f(e+"/git/refs",{ref:"refs/heads/"+t,sha:r}),t}function b(e,r="tags",t,n){e=w(e),t=t,t=!!o.forceProxy||!(o.token&&!t)&&l();let i=null;t=t?c.U.httpGetJsonAsync(c.BrowserUtils.cacheBustingUrl(`${c.Cloud.apiRoot}gh/${e.slug}/refs`+(n?"?nocache=1":""))).then(t=>{var e=Object.keys(t.refs).filter(e=>c.U.startsWith(e,"refs/"+r+"/")).map(e=>({ref:e,object:{sha:t.refs[e]}}));return i=t.refs.HEAD,e}):d(`https://api.github.com/repos/${e.slug}/git/refs/${r}/?per_page=100`);let s=e=>e.replace(/^refs\/[^\/]+\//,"");return t.then(e=>{e.sort((e,t)=>c.semver.strcmp(s(e.ref),s(t.ref)));var t,r={};for(t of e)r[s(t.ref)]=t.object.sha;return{refs:r,head:i}},e=>404==e.statusCode?{refs:{}}:Promise.reject(e))}function n(e){return"commit"==e.object.type?Promise.resolve(e.object.sha):"tag"==e.object.type?d(e.object.url).then(e=>"commit"==e.object.type?e.object.sha:Promise.reject(new Error("Bad type (2nd order) "+e.object.type))):Promise.reject(new Error("Bad type "+e.object.type))}function v(e,t){if(/^[a-f0-9]{40}$/.test(t))return Promise.resolve(t);let r=w(e);return d(`https://api.github.com/repos/${r.slug}/git/refs/tags/`+t).then(n,e=>d(`https://api.github.com/repos/${r.slug}/git/refs/heads/`+t).then(n))}async function T(e,t,r){return t=t||await o.db.latestVersionAsync(e,r),o.db.loadConfigAsync(e,t)}async function k(e,t){var r,n=w(e);if(n){if(!S(n,t))return n.tag||(n.tag=await o.db.latestVersionAsync(n.slug,t)),n=await o.db.loadPackageAsync(n.fullName,n.tag),(t=O(t,e))&&(r=c.Package.parseAndValidConfig(n.files[c.CONFIG_NAME]))&&(c.log(`auto-disable ${t.join(",")} due to targetconfig entry for `+e),r.disablesVariants=t,n.files[c.CONFIG_NAME]=c.Package.stringifyConfig(r)),n;c.tickEvent("github.download.banned"),c.log("Github repo is banned")}else c.log("Unknown GitHub syntax")}o.MemoryGithubDb=M,o.downloadTextAsync=g,o.downloadMarkdownTutorialInfoAsync=r,o.downloadTutorialMarkdownAsync=async function(e,t){return o.db.loadTutorialMarkdown(e,t)},o.db=new M,o.authenticatedUserAsync=function(){return o.token?d("https://api.github.com/user"):Promise.resolve(void 0)},o.getCommitsAsync=function(e,t){return d("https://api.github.com/repos/"+w(e).slug+"/commits?sha="+t).then(e=>e.map(e=>{var t=e.commit;return t.url=e.url,t.sha=e.sha,t}))},o.getCommitAsync=function(e,t){return d("https://api.github.com/repos/"+w(e).slug+"/git/commits/"+t).then(t=>d(t.tree.url+"?recursive=1").then(e=>(t.tree=e,t)))},o.createObjectAsync=function(e,t,r){return f(w(e).slug+"/git/"+t+"s",r).then(e=>e.sha)},o.postCommitComment=function(e,t,r,n,i){return f(w(e).slug+`/commits/${t}/comments`,{body:r,path:n,position:i}).then(e=>e.id)},o.fastForwardAsync=async function(e,t,r){return 200==(await u({url:`https://api.github.com/repos/${w(e).slug}/git/refs/heads/`+t,method:"PATCH",allowHttpErrors:!0,data:{sha:r,force:!1}})).statusCode},o.putFileAsync=async function(e,t,r){e=w(e),await u({url:"https://api.github.com/repos/"+c.github.join(e.slug,"contents",e.fileName,t),method:"PUT",allowHttpErrors:!0,data:{message:lf("Initialize empty repo"),content:btoa(c.U.toUTF8(r)),branch:"master"},successCodes:[201]})},o.createTagAsync=async function(e,t,r){await f(e+"/git/refs",{ref:"refs/tags/"+t,sha:r})},o.createReleaseAsync=async function(e,t,r){await f(e+"/releases",{tag_name:t,target_commitish:r,name:t,draft:!1,prerelease:!1})},o.createPRFromBranchAsync=async function(e,t,r,n,i){return null==(e=await f(e+"/pulls",{title:n,body:i||lf("Automatically created from MakeCode."),head:r,base:t,maintainer_can_modify:!0}))?void 0:e.html_url},o.mergeAsync=function(t,e,r,n){return u({url:`https://api.github.com/repos/${w(t).slug}/merges`,method:"POST",successCodes:[201,204,409],data:{base:e,head:r,commit_message:n}}).then(e=>{if(201==e.statusCode||204==e.statusCode)return e.json.sha;if(409==e.statusCode)return null;throw c.U.userError(lf("Cannot merge in github.com/{1}; code: {2}",t,e.statusCode))})},o.getRefAsync=function(e,t){return d("https://api.github.com/repos/"+e+"/git/refs/heads/"+(t=t||"master")).then(n).catch(e=>{404!=e.statusCode&&Promise.reject(e)})},o.getNewBranchNameAsync=async function(e,t="patch-"){return _(await b(e,"heads"),t)},o.createNewBranchAsync=y,o.forkRepoAsync=async function(e,t,r="pr-"){var n=x(await f((e=w(e)).slug+"/forks",{}),{fullName:e.fullName,fileName:e.fileName}),i=Date.now()+3e5;let s=null;for(;!s&&Date.now()<i;){await c.U.delay(1e3);try{s=await b(n.slug,"heads")}catch(e){}}if(s)return e=_(s,r),await y(n.slug,e,t),n.fullName+"#"+e;throw new Error(lf("Timeout waiting for fork"))},o.listRefsAsync=function(e,t="tags",r,n){return b(e,t,r,n).then(e=>Object.keys(e.refs))},o.listRefsExtAsync=b,o.pkgConfigAsync=T,o.downloadPackageAsync=k,o.downloadLatestPackageAsync=async function(e,t,r){var n=await c.packagesConfigAsync(),t=await c.github.latestVersionAsync(e.slug,n,t,r),r=e.fullName+"#"+t,e=(await c.github.downloadPackageAsync(r,n),await T(e.fullName,t,n));return{version:"github:"+r,config:e}},o.cacheProjectDependenciesAsync=async function(n){var e=null==(e=Object.keys(n.dependencies))?void 0:e.filter(e=>I(n.dependencies[e]));if(e.length){let r=await c.packagesConfigAsync();await Promise.all(e.map(async e=>{var t=n.dependencies[e];if(!await k(t,r))throw new Error(lf("Cannot load extension {0} from {1}",e,t))}))}};let s;function t(e){return c.Cloud.cdnApiUrl(`gh/${e.fullName}/icon`)}function x(e,t){var r;if(e)return(r={owner:e.owner.login.toLowerCase(),slug:e.full_name.toLowerCase(),fullName:((null==t?void 0:t.fullName)||e.full_name).toLowerCase(),fileName:null==(r=null==t?void 0:t.fileName)?void 0:r.toLocaleLowerCase(),name:e.name,description:e.description,defaultBranch:e.default_branch,tag:null==t?void 0:t.tag,updatedAt:Math.round(new Date(e.updated_at).getTime()/1e3),fork:e.fork,private:e.private}).status=E(r,null==t?void 0:t.config),r}function E(e,t){return e?S(e,t)?s.Banned:((e,t)=>{var r;return!(!((t,e)=>!(!t||!e||!(t.owner&&e.approvedOrgs&&e.approvedOrgs.some(e=>e.toLowerCase()==t.owner.toLowerCase()))))(e,t)&&(r=null==(r=null==e?void 0:e.fullName)?void 0:r.toLowerCase(),e=null==(e=null==e?void 0:e.slug)?void 0:e.toLowerCase(),null==t||!t.approvedRepoLib||!r&&!e||!t.approvedRepoLib[r]&&!t.approvedRepoLib[e]))})(e,t)?s.Approved:s.Unknown:s.Unknown}function S(e,n){var t,i;if(t=e,!(!(i=n)||t&&t.owner&&(!i.bannedOrgs||!i.bannedOrgs.some(e=>e.toLowerCase()==t.owner.toLowerCase()))))return 1;if(n){if(!e)return 1;let t=null==(i=e.fullName)?void 0:i.toLowerCase(),r=null==(i=e.slug)?void 0:i.toLowerCase();return!(!n.bannedRepos||!n.bannedRepos.some(e=>e&&(e.toLowerCase()==t||e.toLowerCase()==r)))}}async function C(e,t){e=w(e);if(e){var r,n,i=E(e,t);if(i!=s.Banned){if(l())try{return n=i,await p((r=e).slug).then(e=>{if(e)return{github:!0,owner:r.owner,fullName:r.fullName,fileName:r.fileName,slug:r.slug,name:r.fileName?e.name+"-"+r.fileName:e.name,description:e.description,defaultBranch:e.defaultBranch||"master",tag:r.tag,status:n}}).catch(e=>{c.reportException(e)})}catch(e){h(e)}return x(await d("https://api.github.com/repos/"+e.slug),{config:t,fullName:e.fullName,fileName:e.fileName,tag:e.tag})}}}function w(t){if(t){t=(t=t.trim()).replace(/\/$/,"");var r=/^https:\/\/([^./#]+)\.github\.io\/([^/#]+)\/?$/i.exec(t),r=(t=(t=(t=(t=r?`github:${r[1]}/`+r[2]:t).replace(/^github:/i,"")).replace(/^https:\/\/github\.com\//i,"")).replace(/\.git\b/i,""),/^([^#\/:]+)\/([^#\/:]+)(\/([^#]+))?(#([^\/:]*))?$/.exec(t));if(r){var t=r[1],n=r[2];let e=r[4];var r=r[6],i=e&&/^tree\/([^\/]+\/)/.exec(e);return i&&(e=e.slice(i[0].length)),{owner:t,project:n,slug:D(t,n),fullName:D(t,n,e),tag:r,fileName:e}}}}function I(e){return!!e&&"github:"==e.slice(0,7)}function A(e,t=!1){return e?"github:"+(t?e.fullName:e.fullName.toLowerCase())+(e.tag?"#"+e.tag:""):void 0}function D(...e){return e.filter(e=>!!e).join("/")}function N(e,t){return e&&(t=w(t))?(e.approvedRepoLib,e.approvedRepoLib&&(null==(e=c.U.lookup(e.approvedRepoLib,t.slug.toLowerCase()))?void 0:e.upgrades)):null}function O(e,t){e=N(e,t)||[];if(e)for(var r of e){var r=/^dv:(.*)/.exec(r);if(r)return(r=r[1].split(/,/)).some(e=>!/^\w+$/.test(e))?null:r}return null}function R(e,s,t,r){let a=w(e);return a?C(a.slug,s).then(i=>{if(i)return b(i.slug,"tags",t,r).then(e=>{var r=Object.keys(e.refs),r=c.semver.sortLatestTags(r),n=c.appTarget.versions&&c.semver.tryParse(c.appTarget.versions.target);if(n&&s.releases&&s.releases["v"+n.major]){let t=s.releases["v"+n.major].map(e=>c.github.parseRepoId(e)).filter(e=>e&&e.fullName.toLowerCase()==a.fullName.toLowerCase())[0];if(t){if(r.some(e=>e==t.tag))return c.debug(`approved release ${t.fullName}#${t.tag} for v`+n.major),Promise.resolve(t.tag);c.reportError("packages",`approved release ${t.fullName}#${t.tag} for v${n.major} not found anymore`,{repo:i.fullName})}}return r[0]?Promise.resolve(r[0]):e.head||v(i.slug,i.defaultBranch)})}):Promise.resolve(null)}(e=s=o.GitRepoStatus||(o.GitRepoStatus={}))[e.Unknown=0]="Unknown",e[e.Approved=1]="Approved",e[e.Banned=2]="Banned",o.isDefaultBranch=function(e,t){return t&&t.defaultBranch?e===t.defaultBranch:/^(main|master)$/.test(e)},o.listUserReposAsync=function(){return L(`{
  viewer {
    repositories(first: 100, affiliations: [OWNER, COLLABORATOR], orderBy: {field: PUSHED_AT, direction: DESC}) {
      nodes {
        name
        description
        full_name: nameWithOwner
        private: isPrivate
        fork: isFork
        updated_at: updatedAt
        owner {
          login
        }
        defaultBranchRef {
          name
        }
        pxtjson: object(expression: "HEAD:pxt.json") {
          ... on Blob {
            text
          }
        }
        readme: object(expression: "HEAD:README.md") {
          ... on Blob {
            text
          }
        }
      }
    }
  }
}`).then(e=>e.data.viewer.repositories.nodes.filter(e=>e.pxtjson).filter(e=>{e.default_branch=e.defaultBranchRef.name;var t=c.Package.parseAndValidConfig(e.pxtjson&&e.pxtjson.text),e=e.readme&&e.readme.text;return!!t&&(t.supportedTargets?-1<t.supportedTargets.indexOf(c.appTarget.id):e&&-1<e.indexOf("PXT/"+c.appTarget.id))}).map(e=>x(e,{fullName:e.full_name})))},o.createRepoAsync=function(e,t,r){return f("https://api.github.com/user/repos",{name:e,description:t,private:!!r,has_issues:!0,has_projects:!1,has_wiki:!1,allow_rebase_merge:!1,allow_merge_commit:!0,delete_branch_on_merge:!1}).then(e=>x(e))},o.enablePagesAsync=async function(e){var t=w(e);let r=void 0;try{var n=await d(`https://api.github.com/repos/${t.slug}/pages`);n&&(r=n.html_url)}catch(e){}if(!r)try{var i=await f(`https://api.github.com/repos/${t.slug}/pages`,{source:{branch:"master",path:"/"}},{Accept:"application/vnd.github.switcheroo-preview+json"});r=i.html_url}catch(e){c.tickEvent("github.pages.error"),c.reportException(e)}if(r){n=await d("https://api.github.com/repos/"+e);if(n&&!n.homepage)try{await f("https://api.github.com/repos/"+e,{homepage:r},void 0,"PATCH")}catch(e){c.tickEvent("github.homepage.error")}}},o.repoIconUrl=function(e){if(e.status==s.Approved)return t(e)},o.mkRepoIconUrl=t,o.repoStatus=E,o.isRepoHidden=function(e,t){var r;return!(e&&t&&(r=null==(r=e.fullName)?void 0:r.toLowerCase(),e=null==(e=e.slug)?void 0:e.toLowerCase(),!(r=t.approvedRepoLib[r]||t.approvedRepoLib[e])||!r.hidden))},o.repoAsync=C,o.searchAsync=function(e,t){var r;return t?0<(r=e.split("|").map(w).filter(e=>!!e)).length?Promise.all(r.map(e=>C(e.fullName,t))).then(e=>e.filter(e=>e&&e.status!=s.Banned)):c.U.httpGetJsonAsync(`${c.Cloud.apiRoot}ghsearch/${c.appTarget.id}/${c.appTarget.platformid||c.appTarget.id}?q=`+encodeURIComponent(e)).then(e=>e.items.map(e=>x(e,{config:t,fullName:e.full_name})).filter(e=>e.status==s.Approved||t.allowUnapproved&&e.status==s.Unknown).filter(e=>!c.appTarget.appTheme.githubUrl||"https://github.com/"+e.fullName!=c.appTarget.appTheme.githubUrl.toLowerCase())).catch(e=>[]):Promise.resolve([])},o.parseRepoId=w,o.toGithubDependencyPath=function(e,t){let r="github:"+e;return t&&(r+="#"+t),r},o.isGithubId=I,o.stringifyRepo=A,o.normalizeRepoId=function(e,t){if(e=w(e))return!e.tag&&t&&(e.tag=t),A(e)},o.join=D,o.upgradedPackageReferenceAsync=async function e(t,r){var n,i=N(t,r);if(!i)return null;for(n of i){var s=/^move:(.*)$/.exec(n);if(s){if(o=w(s[1]))return o.tag||(o.tag=await R(s[1],t)),l=w(r),!o.fileName&&l.fileName&&(o.fileName=l.fileName,o.fullName=D(o.owner,o.project,o.fileName)),l=A(o),c.debug(`upgrading ${r} to ${l}}`),await e(t,l)||l;c.log("cannot parse move target: "+s[1])}var a,o,l=(o=/^min:(.*)/.exec(n))&&c.semver.tryParse(o[1]);if(l)return s=w(r),(a=c.semver.tryParse(s.tag))&&c.semver.cmp(a,l)<0?(s.tag=o[1],c.debug(`upgrading ${r} to `+o[1]),A(s)):(a||c.log(`not upgrading ${r} - cannot parse version`),null);O(t,r)||c.log(`invalid upgrade rule: ${r} -> `+n)}return r},o.upgradedPackageId=function(e,t){return(e=O(e,t))?t+"?dv="+e.join(","):t},o.latestVersionAsync=R,o.resolveMonoRepoVersions=function(r){r=c.Util.clone(r);let n={};return Object.keys(r).map(e=>({id:e,ghid:o.parseRepoId(r[e])})).filter(e=>null==(e=e.ghid)?void 0:e.tag).forEach(e=>{var t=e.ghid;let r=n[t.slug];(r=r||(n[t.slug]={tag:t.tag,deps:[]})).deps.push(e),c.semver.strcmp(r.tag,t.tag)<0&&(c.debug("dep: resolve later monorepo tag to "+c.github.stringifyRepo(t)),r.tag=t.tag)}),c.U.values(n).forEach(t=>t.deps.forEach(e=>{e.ghid.tag!==t.tag&&(c.debug(`dep: ${c.github.stringifyRepo(e.ghid)} -> `+t.tag),e.ghid.tag=t.tag,r[e.id]=c.github.stringifyRepo(e.ghid))})),r},o.GIT_JSON=".git.json";let a="https://api.github.com/graphql";function L(e){e=JSON.stringify({query:e});return f(a,e)}function P(e){var t;return/^github\:/i.test(e)&&(e=e.slice(7)),e=/^https?\:/i.test(e)&&(e=new URL(e).pathname.slice(1),t=/^((?:[^\/]+\/){2})blob\/[^\/]+\/(.*)\.md$/.exec(e))?t[1]+t[2]:e}o.lookupFile=function(e,t,r){if(!t)return null;let n=D(e.fileName,r);return t.tree.tree.find(e=>e.path==n)},o.ghGraphQLQueryAsync=L,o.findPRNumberforBranchAsync=function(e,t){return e=w(e),L(`
{
    repository(owner: ${JSON.stringify(e.owner)}, name: ${JSON.stringify(e.project)}) {
        pullRequests(last: 1, states: [OPEN, MERGED], headRefName: ${JSON.stringify(t)}) {
            edges {
                node {
                    number
                    state
                    mergeable
                    baseRefName
                    url
                    isDraft
                }
            }
        }
    }
}
`).then(e=>{var e=e.data.repository.pullRequests.edges[0];return e&&e.node?{number:(e=e.node).number,mergeable:e.mergeable,state:e.state,title:e.title,url:e.url,base:e.baseRefName}:{number:-1}})},o.getPagesStatusAsync=function(e){return d(`https://api.github.com/repos/${e}/pages`).catch(e=>({status:null}))},o.normalizeTutorialPath=P}})(pxt=pxt||{}),(e=>{e.REFCNT_FLASH="0xfffe",e.VTABLE_MAGIC=249,e.ValTypeObject=4,(e=e.BuiltInType||(e.BuiltInType={}))[e.BoxedString=1]="BoxedString",e[e.BoxedNumber=2]="BoxedNumber",e[e.BoxedBuffer=3]="BoxedBuffer",e[e.RefAction=4]="RefAction",e[e.RefImage=5]="RefImage",e[e.RefCollection=6]="RefCollection",e[e.RefRefLocal=7]="RefRefLocal",e[e.RefMap=8]="RefMap",e[e.RefMImage=9]="RefMImage",e[e.MMap=10]="MMap",e[e.BoxedString_SkipList=11]="BoxedString_SkipList",e[e.BoxedString_ASCII=12]="BoxedString_ASCII",e[e.ZPin=13]="ZPin",e[e.User0=16]="User0"})(pxt=pxt||{}),(c=>{{var u=c.HF2||(c.HF2={});function o(e,t,r){e[t+0]=r>>0&255,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255}function l(e,t,r){e[t+0]=r>>0&255,e[t+1]=r>>8&255}function s(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function d(e,t){return e[t]|e[t+1]<<8}function r(t){var r=new Uint8Array(4*t.length);for(let e=0;e<t.length;++e)o(r,4*e,t[e]);return r}u.HF2_CMD_BININFO=1,u.HF2_MODE_BOOTLOADER=1,u.HF2_MODE_USERSPACE=2,u.HF2_CMD_INFO=2,u.HF2_CMD_RESET_INTO_APP=3,u.HF2_CMD_RESET_INTO_BOOTLOADER=4,u.HF2_CMD_START_FLASH=5,u.HF2_CMD_WRITE_FLASH_PAGE=6,u.HF2_CMD_CHKSUM_PAGES=7,u.HF2_CMD_READ_WORDS=8,u.HF2_CMD_WRITE_WORDS=9,u.HF2_CMD_DMESG=16,u.HF2_FLAG_SERIAL_OUT=128,u.HF2_FLAG_SERIAL_ERR=192,u.HF2_FLAG_CMDPKT_LAST=64,u.HF2_FLAG_CMDPKT_BODY=0,u.HF2_FLAG_MASK=192,u.HF2_SIZE_MASK=63,u.HF2_STATUS_OK=0,u.HF2_STATUS_INVALID_CMD=1,u.HF2_STATUS_EXEC_ERR=2,u.HF2_STATUS_EVENT=128,u.HF2_CMD_JDS_CONFIG=32,u.HF2_CMD_JDS_SEND=33,u.HF2_EV_JDS_PACKET=8388640,u.CUSTOM_EV_JACDAC="jacdac",u.HF2_EV_MASK=8388608,u.write32=o,u.write16=l,u.read32=s,u.read16=d,u.encodeU32LE=r;let t=!(u.decodeU32LE=function(t){var r=[];for(let e=0;e<t.length;e+=4)r.push(s(t,e));return r});function p(e){t?c.log("HF2: "+e):c.debug("HF2: "+e)}u.enableLog=function(){t=!0};class n{constructor(o){var e;this.io=o,this.initialized=!1,this.cmdSeq=c.U.randomUint32(),this.lock=new c.U.PromiseQueue,this.flashing=!1,this.rawMode=!1,this.maxMsgSize=63,this.bootloaderMode=!1,this.reconnectTries=0,this.autoReconnect=!1,this.icon=(null==(e=c.appTarget.appTheme.downloadDialogTheme)?void 0:e.deviceIcon)||"usb",this.msgs=new c.U.PromiseBuffer,this.eventHandlers={},this.jacdacAvailable=!1,this.onSerial=(e,t)=>{},this.onCustomEvent=(e,t)=>{},this.onConnectionChanged=()=>{};let l=[];o.onDeviceConnectionChanged=e=>this.disconnectAsync().then(()=>e&&this.reconnectAsync()),o.onSerial=(e,t)=>this.onSerial(e,t),o.onData=e=>{var r=e[0]&u.HF2_FLAG_MASK,t=63&e[0],n=new Uint8Array(t);if(c.U.memcpy(n,0,e,1,t),r&u.HF2_FLAG_SERIAL_OUT)this.onSerial(n,r==u.HF2_FLAG_SERIAL_ERR);else if(l.push(n),r!=u.HF2_FLAG_CMDPKT_BODY){c.U.assert(r==u.HF2_FLAG_CMDPKT_LAST);let e=0;for(var i of l)e+=i.length;var s,a=new Uint8Array(e);let t=0;for(s of l)c.U.memcpy(a,t,s),t+=s.length;l=[],a[2]&u.HF2_STATUS_EVENT?o.onEvent(a):this.msgs.push(a)}},o.onEvent=e=>{var t=s(e,0),r=c.U.lookup(this.eventHandlers,t+"");r?r(e.slice(4)):p("unhandled event: "+t.toString(16))},o.onError=e=>{p("recv error: "+e.message),this.autoReconnect&&(this.autoReconnect=!1,this.reconnectAsync().then(()=>{this.autoReconnect=!0},e=>{p("reconnect error: "+e.message)}))},this.onEvent(u.HF2_EV_JDS_PACKET,e=>{this.onCustomEvent(u.CUSTOM_EV_JACDAC,e)})}resetState(){this.initialized=!1,this.lock=new c.U.PromiseQueue,this.info=null,this.infoRaw=null,this.pageSize=null,this.flashSize=null,this.maxMsgSize=63,this.bootloaderMode=!1,this.msgs.drain()}onEvent(e,t){c.U.assert(!!(e&u.HF2_EV_MASK)),this.eventHandlers[e+""]=t}sendCustomEventAsync(e,t){return e==u.CUSTOM_EV_JACDAC?this.jacdacAvailable?this.talkAsync(u.HF2_CMD_JDS_SEND,t).then(()=>{}):Promise.resolve():Promise.reject(new Error("invalid custom event type"))}isConnected(){return this.io.isConnected()&&this.initialized}isConnecting(){return this.io.isConnecting()||this.io.isConnected()&&!this.initialized}reconnectAsync(){return this.resetState(),p("reconnect raw="+this.rawMode),this.io.reconnectAsync().then(()=>this.initAsync()).catch(e=>{if(this.reconnectTries<5)return this.reconnectTries++,p(`error ${e.message}; reconnecting attempt #`+this.reconnectTries),c.U.delay(500).then(()=>this.reconnectAsync());throw e})}disconnectAsync(){return p("disconnect"),this.io.disconnectAsync()}error(e){return this.io.error(e)}talkAsync(e,t){if(this.io.talksAsync)return this.io.talksAsync([{cmd:e,data:t}]).then(e=>e[0]);let r=8;t&&(r+=t.length);var n=new Uint8Array(r);let i=65535&++this.cmdSeq,s=(o(n,0,e),l(n,4,i),l(n,6,0),t&&c.U.memcpy(n,8,t,0,t.length),0),a=()=>this.msgs.shiftAsync(1e3).then(e=>{if(d(e,0)!=i){if(s<3)return s++,p(`message out of sync, (${i} vs ${d(e,0)}); will re-try`),a();this.error("out of sync")}let t="";switch(e[3]&&(t="; info="+e[3]),e[2]){case u.HF2_STATUS_OK:return e.slice(4);case u.HF2_STATUS_INVALID_CMD:this.error("invalid command"+t);break;case u.HF2_STATUS_EXEC_ERR:this.error("execution error"+t);break;default:this.error("error "+e[2]+t)}return null});return this.sendMsgAsync(n).then(a)}sendMsgAsync(e){return this.sendMsgCoreAsync(e)}sendSerialAsync(e,t=!1){return this.io.sendSerialAsync?this.io.sendSerialAsync(e,t):this.sendMsgCoreAsync(e,t?2:1)}sendMsgCoreAsync(n,e=0){let i=new Uint8Array(64),s=t=>{let r=n.length-t;if(r<=0)return Promise.resolve();63<r?(r=63,i[0]=u.HF2_FLAG_CMDPKT_BODY):i[0]=u.HF2_FLAG_CMDPKT_LAST,e&&(i[0]=1==e?u.HF2_FLAG_SERIAL_OUT:u.HF2_FLAG_SERIAL_ERR),i[0]|=r;for(let e=0;e<r;++e)i[e+1]=n[t+e];return this.io.sendPacketAsync(i).then(()=>s(t+r))};return this.lock.enqueue("out",()=>s(0))}switchToBootloaderAsync(){return this.bootloaderMode?Promise.resolve():(p("Switching into bootloader mode"),this.io.isSwitchingToBootloader&&this.io.isSwitchingToBootloader(),this.maybeReconnectAsync().then(()=>this.talkAsync(u.HF2_CMD_START_FLASH).then(()=>{},e=>this.talkAsync(u.HF2_CMD_RESET_INTO_BOOTLOADER).then(()=>{},e=>{}).then(()=>this.reconnectAsync().catch(e=>{throw"devicenotfound"===e.type&&(e.type="repairbootloader"),e})))).then(()=>this.initAsync()).then(()=>{this.bootloaderMode||this.error("cannot switch into bootloader mode")}))}isFlashing(){return!!this.flashing}reflashAsync(e){p("reflash"),c.U.assert(c.appTarget.compile.useUF2);e=e.outfiles[pxtc.BINARY_UF2];let t=pxtc.UF2.parseFile(c.Util.stringToUint8Array(atob(e)));return this.flashing=!0,this.io.reconnectAsync().then(()=>this.flashAsync(t)).then(()=>c.U.delay(100)).finally(()=>this.flashing=!1).then(()=>this.reconnectAsync())}writeWordsAsync(e,t){return c.U.assert(t.length<=64),this.talkAsync(u.HF2_CMD_WRITE_WORDS,r([e,t.length].concat(t))).then(()=>{})}readWordsAsync(e,t){var r=new Uint8Array(8);return o(r,0,e),o(r,4,t),c.U.assert(t<=64),this.talkAsync(u.HF2_CMD_READ_WORDS,r)}pingAsync(){return this.rawMode?Promise.resolve():this.talkAsync(u.HF2_CMD_BININFO).then(e=>{})}maybeReconnectAsync(){return this.pingAsync().catch(e=>this.reconnectAsync().then(()=>this.pingAsync()))}flashAsync(n){let r=Date.now(),i=0,s=e=>{var t,r;return e>=n.length?Promise.resolve():(t=n[e],o(r=new Uint8Array(4+t.payloadSize),0,t.targetAddr),c.U.memcpy(r,4,t.data,0,t.payloadSize),this.talkAsync(u.HF2_CMD_WRITE_FLASH_PAGE,r).then(()=>s(e+1)))};return this.switchToBootloaderAsync().then(()=>{var e=256*n.length;return p(`Starting flash (${Math.round(e/1024)}kB).`),i=Date.now(),16384<this.pageSize?n:a(n,(e,t)=>this.readWordsAsync(e,t))}).then(e=>{e.length!=n.length&&(e=256*(n=e).length,p(`Performing partial flash (${Math.round(e/1024)}kB).`))}).then(()=>s(0)).then(()=>{var e=Date.now(),t=e-r,e=e-i;p(`Flashing done at ${Math.round(256*n.length/e*1e3/1024)} kB/s in ${t}ms (reset ${t-e}ms). Resetting.`)}).then(()=>this.talkAsync(u.HF2_CMD_RESET_INTO_APP).catch(e=>{})).then(()=>{})}initAsync(){return this.rawMode?(this.initialized=!0,Promise.resolve()):Promise.resolve().then(()=>this.talkAsync(u.HF2_CMD_BININFO)).then(e=>(this.bootloaderMode=e[0]==u.HF2_MODE_BOOTLOADER,this.pageSize=s(e,4),this.flashSize=s(e,8)*this.pageSize,this.maxMsgSize=s(e,12),this.familyID=s(e,16),p(`Connected; msgSize ${this.maxMsgSize}B; flash ${this.flashSize/1024}kB; ${this.bootloaderMode?"bootloader":"application"} mode; family=0x`+this.familyID.toString(16)),this.talkAsync(u.HF2_CMD_INFO))).then(e=>{this.infoRaw=c.Util.fromUTF8Array(e),c.debug("Info: "+this.infoRaw);let n={};("Header: "+this.infoRaw).replace(/^([\w\-]+):\s*([^\n\r]*)/gm,(e,t,r)=>(n[t.replace(/-/g,"")]=r,"")),this.info=n;e=/v(\d\S+)(\s+(\S+))?/.exec(this.info.Header);this.info.Parsed=e?{Version:e[1],Features:e[3]||""}:{Version:"?",Features:""},p(`Board-ID: ${this.info.BoardID} v${this.info.Parsed.Version} f`+this.info.Parsed.Features)}).then(()=>this.talkAsync(u.HF2_CMD_JDS_CONFIG,new Uint8Array([1])).then(()=>{this.jacdacAvailable=!0},e=>{this.jacdacAvailable=!1})).then(()=>{this.reconnectTries=0,this.initialized=!0,this.io.onConnectionChanged()})}}function a(n,e){if(!c.appTarget.compile.flashChecksumAddr)return Promise.resolve(n);var r,t=pxtc.UF2.readBytes(n,c.appTarget.compile.flashChecksumAddr,48);let i=pxtc.parseChecksumBlock(t);return i?(r=e,(c.appTarget.compile.flashChecksumAddr?r(c.appTarget.compile.flashChecksumAddr,12).then(e=>{let t=pxtc.parseChecksumBlock(e);return t?r(t.endMarkerPos,1).then(e=>s(e,0)!=t.endMarker?(c.log("end-marker mismatch"),null):t):null}):Promise.resolve(null)).then(e=>{if(!e)return n;let r=e.regions.filter(t=>i.regions.some(e=>t.checksum==e.checksum&&t.length==e.length&&t.start==e.start));if(0==r.length)return n;p("skipping flash at: "+r.map(e=>`${pxtc.assembler.tohex(e.start)} (${e.length/1024}kB)`).join(", "));let t=t=>r.some(e=>e.start<=t&&t<e.start+e.length);return n.filter(e=>!(t(e.targetAddr)&&t(e.targetAddr+e.payloadSize-1)))})):Promise.resolve(n)}u.Wrapper=n,u.mkHF2PacketIOWrapper=function(e){return c.debug("packetio: wrapper hf2"),new n(e)},u.onlyChangedBlocksAsync=a}})(pxt=pxt||{}),(u=>{{var g=u.HWDBG||(u.HWDBG={}),f=u.Util,_=u.HF2;let e=1409050336,t=665147697,r=1888490768,n=_.read32,s=!1,p,i,a,o,h,m,l,c;function y(e){return 1&e?e>>1:0!=e?2&e?e==g.taggedNull?null:e!=g.taggedFalse&&(e==g.taggedTrue||{tagged:e>>2}):{ptr:e}:void 0}function d(e,t){var r;if(f.assert(!(3&e)),f.assert(0<=e),e<2097152)return r=new Uint8Array(t),e-=l.start,f.memcpy(r,0,l.buf,e,t),Promise.resolve(r);var n=c.maxMsgSize-32;if(n<t){for(var i=[];0<t;){var s=Math.min(n,t);i.push(d(e,s)),t-=s,e+=s}return Promise.all(i).then(f.uint8ArrayConcat)}return c.readWordsAsync(e,Math.ceil(t/4)).then(e=>e.length>t?e.slice(0,t):e)}function b(n){if("object"!=typeof n||!n)return Promise.resolve(n);if("number"!=typeof n.ptr)return Promise.resolve(n);{if(3&n.ptr)return Promise.resolve({unalignedPtr:n.ptr});let r=0;return d(n.ptr,56).then(t=>{r=_.read16(t,2);let e=t.length;return r==u.BuiltInType.BoxedString||r==u.BuiltInType.BoxedBuffer?e=_.read16(t,4)+6:r==u.BuiltInType.BoxedNumber&&(e=12),e>t.length?d(n.ptr+t.length,e-t.length).then(e=>f.uint8ArrayConcat([t,e])):e<t.length?t.slice(0,e):t}).then(e=>r==u.BuiltInType.BoxedString?f.uint8ArrayToString(e.slice(6)):r==u.BuiltInType.BoxedBuffer?{type:"buffer",data:e.slice(6)}:r==u.BuiltInType.BoxedNumber?new Float64Array(e.buffer.slice(4))[0]:{type:"unknown",tag:r,refcnt:_.read16(e,0),data:e.slice(4)})}}function v(r){var e=[];for(let t of Object.keys(r))e.push(b(r[t]).then(e=>{r[t]=e}));return Promise.all(e).then(()=>{})}function T(e){var t,r=p.breakpoints;let n=r[0],i=1/0;for(t of r){var s=e-t.binAddr;0<=s&&s<i&&(i=s,n=t)}return n}function k(t){if(s)return Promise.resolve();s=!0;let d;return C().then(n=>{var e=_.decodeU32LE(t)[0],i={};for(let r of p.procDebugInfo[0].locals){let e=n.globals;let t=(()=>{switch(r.type){case"uint32":return _.read32(e,r.index);case"int32":return 0|_.read32(e,r.index);case"uint16":return _.read16(e,r.index);case"int16":return _.read16(e,r.index)<<16>>16;case"uint8":return e[r.index];case"int8":return e[r.index]<<24>>24;default:return null}})();null===t&&(f.assert(0==(3&r.index)),t=y(_.read32(e,r.index))),i[r.name]=t}return h=T(e),d={type:"debugger",subtype:"breakpoint",breakpointId:h.id,globals:i,stackframes:[]},a(),c.talkAsync(r)}).then(e=>{{var i=_.decodeU32LE(e),s=d;let t=h.binAddr,r=0,n=p.procDebugInfo.filter(e=>e.codeStartLoc<=t&&t<=e.codeEndLoc)[0];for(;;){if(!n)break;if(n==p.procDebugInfo[0])break;var a,o=T(t),l=f.clone(o),c=(l.functionName=n.name,l.argumentNames=n.args&&n.args.map(e=>e.name),s.stackframes.push({locals:{},funcInfo:l,breakpointId:o.id}),s.stackframes[s.stackframes.length-1]);let e=0;for(a of n.locals)f.assert(a.index==e++),c.locals[a.name]=y(i[r++]);t=2147483646&i[r++];var u,l=m[t+""];for(u of n.args)c.locals[u.name]=y(i[r+(n.args.length-1-u.index)]);if(!l)break;n=l.from,r+=l.stack-n.localsMark}}e=[d.globals].concat(d.stackframes.map(e=>e.locals));return f.promiseMapAll(e,v)}).then(()=>g.postMessage(d))}function x(){s=!1,i=new Promise((e,t)=>{a=e})}function E(e=!1){return Promise.resolve().then(()=>c.talkAsync(t,_.encodeU32LE([e?1:3]))).then(x)}function S(){return i=i||Promise.resolve()}function C(){return(o?Promise.resolve(o):c.talkAsync(e).then(e=>o={numGlobals:n(e,0),globalsPtr:n(e,4)})).then(e=>c.readWordsAsync(e.globalsPtr,e.numGlobals)).then(e=>({staticState:o,globals:e}))}g.taggedUndefined=0,g.taggedNull=6,g.taggedFalse=10,g.taggedTrue=66,g.postMessage=e=>u.log(e),g.decodeValue=y,g.heapExpandAsync=b,g.heapExpandMapAsync=v,g.startDebugAsync=function(i,e){return(c=e).onEvent(915601917,k),s=!1,p=null,o=null,Promise.resolve().then(()=>{p=i,m={};var e,t,r=[];for(e of i.procDebugInfo)r[e.idx]=e;for(t of i.procDebugInfo)for(var n of t.calls)m[n.addr+""]={from:t,to:r[n.procIndex],stack:n.stack}}).then(()=>{var e=p.outfiles[pxtc.BINARY_UF2],e=f.stringToUint8Array(atob(e));return l=pxtc.UF2.toBin(e),c.reflashAsync(p).then(()=>c.reconnectAsync())}).then(()=>c.talkAsync(287358355).catch(e=>{})).then(()=>f.delay(200)).then(()=>c.reconnectAsync()).then(x).then(S)},g.handleMessage=function(t){if(u.log("HWDBGMSG",t),"debugger"==t.type){let e=!1;switch(t.subtype){case"stepinto":e=!0;case"stepover":E(e)}}},g.resumeAsync=E,g.waitForHaltAsync=S,g.getHwStateAsync=C}})(pxt=pxt||{}),(m=>{class e{logTime(){var e;this.start&&(e=Date.now()-this.start,m.debug("Icon creation: "+e+"ms"))}convert(e){this.start||(this.start=Date.now());let t=atob(e.slice(e.indexOf(",")+1)),r=t.charCodeAt(0),n=t.charCodeAt(1),i=t.charCodeAt(2);return 135===r&&(r=224|t.charCodeAt(1),n=t.charCodeAt(2)|t.charCodeAt(3)<<8,i=t.charCodeAt(4)|t.charCodeAt(5)<<8,t=t.slice(4)),225!=r&&228!=r?null:(this.palette||this.setPalette(m.appTarget.runtime.palette.map(function(e){return[(e=parseInt(e.replace(/#/,""),16))>>0&255,e>>8&255,e>>16&255,255]})),225==r?this.genMonochrome(t,n,i):(e=(m.BrowserUtils.isEdge()||m.BrowserUtils.isIE())&&n<100&&i<100?3:1,this.genColor(t,n,i,e)))}setPalette(t){t[0][3]=0,this.palette=new Uint8Array(4*t.length);for(let e=0;e<t.length;++e)this.palette[4*e+0]=t[e][0],this.palette[4*e+1]=t[e][1],this.palette[4*e+2]=t[e][2],this.palette[4*e+3]=t[e][3]}genMonochrome(t,r,n){var i=r+3&-4,s=54+this.palette.length,e=s+i*n,a=new Uint8Array(e);a[0]=66,a[1]=77,m.HF2.write32(a,2,e),m.HF2.write32(a,10,s),m.HF2.write32(a,14,40),m.HF2.write32(a,18,r),m.HF2.write32(a,22,-n),m.HF2.write16(a,26,1),m.HF2.write16(a,28,8),m.HF2.write32(a,38,2835),m.HF2.write32(a,42,2835),m.HF2.write32(a,46,this.palette.length>>2),a.set(this.palette,54);let o=4,l=s,c=1,u=t.charCodeAt(o++);for(let e=0;e<r;++e){l=s+e;for(let e=0;e<n;++e)a[l]=u&c?1:0,l+=i,256==(c<<=1)&&(c=1,u=t.charCodeAt(o++))}return"data:image/bmp;base64,"+btoa(m.U.uint8ArrayToString(a))}genColor(i,e,s,a){var t=e*(a=Math.max(1,0|a)),o=s*a,l=t<<2,e=138+l*o,c=new Uint8Array(e);c[0]=66,c[1]=77,m.HF2.write32(c,2,e),m.HF2.write32(c,10,138),m.HF2.write32(c,14,124),m.HF2.write32(c,18,t),m.HF2.write32(c,22,-o),m.HF2.write16(c,26,1),m.HF2.write16(c,28,32),m.HF2.write16(c,30,3),m.HF2.write32(c,38,2835),m.HF2.write32(c,42,2835),m.HF2.write32(c,54,16711680),m.HF2.write32(c,58,65280),m.HF2.write32(c,62,255),m.HF2.write32(c,66,4278190080),c[70]=66,c[71]=71,c[72]=82,c[73]=115;let u=4,d=138,p=!0;for(let e=0;e<t;e++){let t=!1;d=138+(e<<2);var h=u;let r=i.charCodeAt(u++),n=t?(r>>4&15)<<2:(15&r)<<2;for(let e=0;e<o;e++)r&&(p=!1),c[d]=this.palette[n],c[d+1]=this.palette[n+1],c[d+2]=this.palette[n+2],c[d+3]=this.palette[n+3],d+=l,e%a==a-1&&(t&&(r=i.charCodeAt(u++)),t=!t,n=t?(r>>4&15)<<2:(15&r)<<2);if(p&&(c[141]=1),e%a==a-1)for(s%2||--u;3&u;)u++;else u=h}return"data:image/bmp;base64,"+btoa(m.U.uint8ArrayToString(c))}}m.ImageConverter=e,m.convertUint8BufferToPngUri=function(t,e){var r=new m.ImageConverter,n=[];for(let e=0;e<16;e++)n.push([t[3*e+2],t[3*e+1],t[3*e+0],255]);return r.setPalette(n),e=String.fromCharCode.apply(null,e),e="data:image/x-mkcd-f4;base64,"+btoa(e),r.convert(e)}})(pxt=pxt||{}),(o=>{var e;function l(){let t={"tsconfig.json":e.TS_CONFIG,"test.ts":`// ${lf("tests go here; this will not be compiled when this package is used as an extension.")}
`,"_config.yml":`makecode:
  target: @TARGET@
  platform: @PLATFORM@
  home_url: @HOMEURL@
theme: jekyll-theme-slate
include:
  - assets
  - README.md
`,Makefile:`all: deploy

build:
	pxt build

deploy:
	pxt deploy

test:
	pxt test
`,Gemfile:`source 'https://rubygems.org'
gem 'github-pages', group: :jekyll_plugins`,"README.md":`
> ${lf("Open this page at {0}","[https://@REPOOWNER@.github.io/@REPONAME@/](https://@REPOOWNER@.github.io/@REPONAME@/)")}

## ${lf("Use as Extension")}

${lf("This repository can be added as an **extension** in MakeCode.")}

* ${lf("open [@HOMEURL@](@HOMEURL@)")}
* ${lf("click on **New Project**")}
* ${lf("click on **Extensions** under the gearwheel menu")}
* ${lf("search for **https://github.com/@REPO@** and import")}

## ${lf("Edit this project")}

${lf("To edit this repository in MakeCode.")}

* ${lf("open [@HOMEURL@](@HOMEURL@)")}
* ${lf("click on **Import** then click on **Import URL**")}
* ${lf("paste **https://github.com/@REPO@** and click import")}

#### ${lf("Metadata (used for search, rendering)")}

* for PXT/@TARGET@
<script src="https://makecode.com/gh-pages-embed.js"></script><script>makeCodeRender("{{ site.makecode.home_url }}", "{{ site.github.owner_name }}/{{ site.github.repository_name }}");</script>
`,".gitignore":`# MakeCode
built
node_modules
yotta_modules
yotta_targets
pxt_modules
.pxt
_site
*.db
*.tgz
.header.json
.simstate.json
`,".vscode/settings.json":`{
    "editor.formatOnType": true,
    "files.autoSave": "afterDelay",
    "files.watcherExclude": {
        "**/.git/objects/**": true,
        "**/built/**": true,
        "**/node_modules/**": true,
        "**/yotta_modules/**": true,
        "**/yotta_targets": true,
        "**/pxt_modules/**": true,
        "**/.pxt/**": true
    },
    "files.associations": {
        "*.blocks": "html",
        "*.jres": "json"
    },
    "search.exclude": {
        "**/built": true,
        "**/node_modules": true,
        "**/yotta_modules": true,
        "**/yotta_targets": true,
        "**/pxt_modules": true,
        "**/.pxt": true
    },
    "files.exclude": {
        "**/pxt_modules": true,
        "**/.pxt": true
    }
}`,".vscode/extensions.json":`{
    "recommendations": ["ms-edu.pxt-vscode-web"]
}`},r=n();return r&&Object.keys(r).forEach(e=>t[e]=r[e]),t}function n(){var e=o.appTarget.bundledpkgs[o.template.TEMPLATE_PRJ];if(e)return delete(e=o.Util.clone(e))[o.CONFIG_NAME],e}(e=o.template||(o.template={})).TS_CONFIG=`{
    "compilerOptions": {
        "target": "ES5",
        "noImplicitAny": true,
        "outDir": "built",
        "rootDir": "."
    },
    "exclude": ["pxt_modules/**/*test.ts"]
}
`,e.defaultFiles=l,e.targetTemplateFiles=n,e.TEMPLATE_PRJ="template",e.packageFiles=function(e){var t,r,n=o.appTarget.blocksprj||o.appTarget.tsprj,i=o.U.clone(n.config),s=(delete i.installedVersion,delete i.additionalFilePath,delete i.additionalFilePaths,i.preferredEditor=i.files.find(e=>/\.blocks$/.test(e))?o.BLOCKS_PROJECT_NAME:o.JAVASCRIPT_PROJECT_NAME,i.name=e,i.public=!0,i.version||(i.version="0.0.0"),{}),a=l();for(t in a)s[t]=a[t];for(r in n.files)"README.md"!=r&&(s[r]=n.files[r]);return e=Object.keys(s).filter(e=>/\.(blocks|md|ts|asm|cpp|h|py)$/.test(e)),i.files=e.filter(e=>!/test/.test(e)),i.testFiles=e.filter(e=>/test/.test(e)),i.supportedTargets=[o.appTarget.id],s[o.CONFIG_NAME]=o.Package.stringifyConfig(i),s},e.packageFilesFixup=function(r,e){let n=JSON.parse(r[o.CONFIG_NAME]);e&&o.Util.jsonMergeFrom(n,e),o.webConfig&&(Object.keys(o.webConfig).forEach(e=>n[e.toLowerCase()]=o.webConfig[e]),n.platform=o.appTarget.platformid||o.appTarget.id,n.target=o.appTarget.id,n.docs=o.appTarget.appTheme.homeUrl||"./",n.homeurl=o.appTarget.appTheme.homeUrl||"???"),o.U.iterMap(r,(e,t)=>{t=t.replace(/@([A-Z]+)@/g,(e,t)=>n[t.toLowerCase()]||""),r[e]=t})}})(pxt=pxt||{}),(k=>{var e,r;{var n=k.blocks||(k.blocks={});let v;(e=v=n.NT||(n.NT={}))[e.Prefix=0]="Prefix",e[e.Postfix=1]="Postfix",e[e.Infix=2]="Infix",e[e.Block=3]="Block",e[e.NewLine=4]="NewLine";let T,t=((e=T=n.GlueMode||(n.GlueMode={}))[e.None=0]="None",e[e.WithSpace=1]="WithSpace",e[e.NoSpace=2]="NoSpace",["break","case","catch","class","const","continue","debugger","default","delete","do","else","enum","export","extends","false","finally","for","function","if","import","in","instanceof","new","null","return","super","switch","this","throw","true","try","typeof","var","void","while","with"]);function i(e){return"`"+e.replace(/[\\`${}]/g,e=>"\\"+e)+"`"}function s(e){return 20<e.length&&/\n/.test(e)?i(e):JSON.stringify(e)}function a(e,t,r){return{type:e,op:t,children:r}}function l(){return a(v.NewLine,"",[])}function c(e,t){return a(v.Prefix,e,t)}function u(e,t,r){return a(v.Infix,t,null==e?[r]:[e,r])}function x(e){return c(e,[])}function d(e){return a(v.Block,"",e)}function E(e){return c("",e)}function p(e,t=!1){var r,n=[];for(r of e)t?(0<n.length&&n.push(x(",")),n.push(l())):0<n.length&&n.push(x(", ")),n.push(r);return t&&n.push(l()),E(n)}function h(e,t,r=!1,n=!1){return E(n?[u(t[0],".",x(e)),x("("),p(t.slice(1),r),x(")")]:[x(e),x("("),p(t,r),x(")")])}function m(e,t,r,n){return h(e+"."+t,r,n)}function g(e,t){return k.U.assert(2==t.length),u(t[0],e,t[1])}n.backtickLit=i,n.stringLit=s,n.mkNode=a,n.mkNewLine=l,n.mkPrefix=c,n.mkPostfix=function(e,t){return a(v.Postfix,t,e)},n.mkInfix=u,n.mkText=x,n.mkBlock=d,n.mkGroup=E,n.mkStmt=function(...e){var t=e[e.length-1];return t&&t.type==v.Block||e.push(l()),E(e)},n.mkCommaSep=p,(r=e=n.Helpers||(n.Helpers={})).mkArrayLiteral=function(e,t){return E([x("["),p(e,t),x("]")])},r.mkNumberLiteral=function(e){return x(e.toString())},r.mkBooleanLiteral=function(e){return x(e?"true":"false")},r.mkStringLiteral=function(e){return x(s(e))},r.mkPropertyAccess=function(e,t){return E([u(t,".",x(e))])},r.mkCall=h,r.stdCall=function(e,t,r){return h(e,t,r)},r.extensionCall=function(e,t,r){return h(e,t,r,!0)},r.namespaceCall=m,r.mathCall=function(e,t){return m("Math",e,t,!1)},r.mkGlobalRef=x,r.mkSimpleCall=g,r.mkWhile=function(e,t){return E([x("while ("),e,x(")"),d(t)])},r.mkComment=function(e){return x("// "+e)},r.mkMultiComment=function(e){let n=[x("/**"),l()];return e.split("\n").forEach((e,t,r)=>{e&&(n.push(x(" * "+e)),n.push(l()),t<r.length-1)&&(n.push(x(" * ")),n.push(l()))}),E(n.concat([x(" */"),l()]))},r.mkAssign=function(e,t){return g("=",[e,t])},r.mkParenthesizedExpression=function(e){return _(f([e]).output)?e:E([x("("),e,x(")")])},n.H=e;let o={"=":3,"+=":3,"-=":3,"?":4,":":4,"||":5,"&&":6,"|":7,"^":8,"&":9,"==":10,"!=":10,"===":10,"!==":10,"<":11,">":11,"<=":11,">=":11,">>":12,">>>":12,"<<":12,"+":13,"-":13,"*":14,"/":14,"%":14,"**":15,"!":16,"~":16,"P-":16,"P+":16,"++":16,"--":16,".":18};function f(e){let u=[],d={},p="",h="",m=[{}],g=0;function f(e){"string"==typeof e&&(g+=(e.match(/\n/g)||[]).length),p+=e}e=E(e);return function e(r,n){if(r.type!=v.Infix)for(var t of r.children)e(t,-1);else{let t=[];var i,s=k.U.lookup(o,r.op);function a(e){"P"==e[0]&&(e=e.slice(1)),t.push(x(e))}null==s&&k.U.oops("bad infix op: "+r.op),s<n&&a("("),1==r.children.length?(a(r.op),e(r.children[0],s),t.push(r.children[0])):(i=3!=s&&"**"!=r.op,e(r.children[0],i?s:s+.1),t.push(r.children[0]),"."==r.op?a("."):a(" "+r.op+" "),e(r.children[1],i?s+.1:s),t.push(r.children[1])),s<n&&a(")"),r.type=v.Prefix,r.op="",r.children=t}}(e,-1),_(e),p||f("\n"),{output:p,sourceMap:u};function _(e){e.glueToBlock&&(b(),e.glueToBlock==T.WithSpace)&&f(" ");var t=g,r=p.length;switch(e.type){case v.Infix:k.U.oops("no infix should be left");break;case v.NewLine:f("\n"+h);break;case v.Block:var n=e,i=n.noFinalNewline?"":"\n";if(0==n.children.length)y(" {\n\t\n}"+i);else{var s,a=k.U.clone(m[m.length-1]||{});m.push(a),h+="    "," "!=p[p.length-1]&&y(" "),y("{\n");for(s of n.children)_(s);h=h.slice(4),b(),y("\n}"+i),m.pop()}break;case v.Prefix:e.canIndentInside?f(e.op.replace(/\n/g,"\n"+h+"    ")):f(e.op),e.children.forEach(_);break;case v.Postfix:e.children.forEach(_),e.canIndentInside?f(e.op.replace(/\n/g,"\n"+h+"    ")):f(e.op)}var o,l=g,c=Math.max(p.length,1);e.id&&(d[e.id]?((o=d[e.id]).startLine=Math.min(o.startLine,t),o.endLine=Math.max(o.endLine,l),o.startPos=Math.min(o.startPos,r),o.endPos=Math.max(o.endPos,c)):(o={id:e.id,startLine:t,startPos:r,endLine:l,endPos:c},d[e.id]=o,u.push(o)))}function y(e){f(e.replace(/\n/g,"\n"+h))}function b(){p=p.replace(/\n *$/,function(){return g--,""})}}function _(r){if("("===r[0]&&")"===r[r.length-1]){let t=1;for(let e=1;e<r.length;e++){var n=r[e];if("("===n)t++;else if(")"===n&&0===--t)return e===r.length-1}}return!1}n.flattenNode=f,n.isReservedWord=function(e){return-1!==t.indexOf(e)},n.isParenthesized=_}})(pxt=pxt||{}),(c=>{var i;{var s=i=c.sprite||(c.sprite={});let a=[".","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];s.BLOCKLY_TILESET_TYPE="BLOCKLY_TILESET_TYPE",s.TILE_PREFIX="tile",s.TILE_NAMESPACE="myTiles",s.IMAGES_NAMESPACE="myImages",s.IMAGE_PREFIX="image",s.ANIMATION_NAMESPACE="myAnimations",s.ANIMATION_PREFIX="anim",s.SONG_NAMESPACE="mySongs",s.JSON_NAMESPACE="myFiles",s.SONG_PREFIX="song",s.JSON_PREFIX="file";class E{constructor(e,t,r=0,n=0,i){this.width=e,this.height=t,this.x0=r,this.y0=n,this.width||(this.width=16),this.height||(this.height=16),this.buf=i||new Uint8ClampedArray(this.dataLength())}static fromData(e){return new E(e.width,e.height,e.x0,e.y0,e.data)}set(e,t,r){e<this.width&&t<this.height&&0<=e&&0<=t&&(e=this.coordToIndex(e,t),this.setCore(e,r))}get(e,t){return e<this.width&&t<this.height&&0<=e&&0<=t?(e=this.coordToIndex(e,t),this.getCore(e)):0}copy(r=0,n=0,e=this.width,i=this.height){var s=new E(e,i);s.x0=r,s.y0=n;for(let t=0;t<e;t++)for(let e=0;e<i;e++)s.set(t,e,this.get(r+t,n+e));return s}apply(r,n=!1){var i;for(let t=0;t<r.width;t++)for(let e=0;e<r.height;e++)!(i=r.get(t,e))&&n||this.set(r.x0+t,r.y0+e,i)}equals(t){if(this.width!==t.width||this.height!==t.height||this.x0!==t.x0||this.y0!==t.y0||this.buf.length!==t.buf.length)return!1;for(let e=0;e<this.buf.length;e++)if(this.buf[e]!==t.buf[e])return!1;return!0}data(){return{width:this.width,height:this.height,x0:this.x0,y0:this.y0,data:this.buf}}resize(e,t){return u(this,e,t)}coordToIndex(e,t){return e+t*this.width}getCore(e){var t=Math.floor(e/2);return e%2==0?15&this.buf[t]:(240&this.buf[t])>>4}setCore(e,t){var r=Math.floor(e/2);this.buf[r]=e%2==0?240&this.buf[r]|15&t:15&this.buf[r]|(15&t)<<4}dataLength(){return Math.ceil(this.width*this.height/2)}}s.Bitmap=E;class S extends E{static fromData(e){return new S(e.width,e.height,e.x0,e.y0,e.data)}copy(r=0,n=0,e=this.width,i=this.height){var s=new S(e,i);s.x0=r,s.y0=n;for(let t=0;t<e;t++)for(let e=0;e<i;e++)s.set(t,e,this.get(r+t,n+e));return s}resize(e,t){return d(this,e,t)}getCore(e){return this.buf[e]}setCore(e,t){this.buf[e]=t}dataLength(){return this.width*this.height}}s.Tilemap=S;class C{constructor(e,t,r){this.tilemap=e,this.tileset=t,this.layers=r,this.nextId=0}cloneData(e=!1){var t=this.tilemap.copy(),r={tileWidth:this.tileset.tileWidth,tiles:this.tileset.tiles.map(e=>Object.assign(Object.assign({},e),{bitmap:E.fromData(e.bitmap).copy().data()}))},n=E.fromData(this.layers).copy().data(),t=new C(t,r,n);return e&&(t.nextId=this.nextId,t.projectReferences=null==(r=this.projectReferences)?void 0:r.slice(),t.tileOrder=null==(n=this.tileOrder)?void 0:n.slice(),t.editedTiles=null==(e=this.editedTiles)?void 0:e.slice(),t.deletedTiles=null==(r=this.deletedTiles)?void 0:r.slice()),t}equals(e){return this.tilemap.equals(e.tilemap)&&_(this.tileset,e.tileset)&&f(this.layers,e.layers)}}function r(e){return t(atob(e.slice(e.indexOf(",")+1)))}function t(i){let e=i.charCodeAt(0),s=i.charCodeAt(1),a=i.charCodeAt(2);135===e&&(e=224|i.charCodeAt(1),s=i.charCodeAt(2)|i.charCodeAt(3)<<8,a=i.charCodeAt(4)|i.charCodeAt(5)<<8,i=i.slice(4));var o=new c.sprite.Bitmap(s,a);let l=4;if(225===e){let r=1,n=i.charCodeAt(l++);for(let t=0;t<s;++t)for(let e=0;e<a;++e)o.set(t,e,n&r?1:0),256==(r<<=1)&&(r=1,n=i.charCodeAt(l++))}else for(let t=0;t<s;t++){for(let e=0;e<a;e+=2){var r=i.charCodeAt(l++);o.set(t,e,15&r),e!=a-1&&o.set(t,e+1,r>>4&15)}for(;3&l;)l++}return o}function o(e,t){!(e=(e=(e=e.replace(/[ `]|(?:&#96;)|(?:&#9;)|(?:hex)/g,"").trim()).replace(/^["`\(\)]*/,"").replace(/["`\(\)]*$/,"")).replace(/&#10;/g,"\n"))&&t&&(e=t);var t=parseInt(e.substr(0,2),16)|parseInt(e.substr(2,2),16)<<8,r=parseInt(e.substr(4,2),16)|parseInt(e.substr(6,2),16)<<8,e=v(e.substring(8));return S.fromData({width:t,height:r,x0:0,y0:0,data:e})}function l(e){return""+n(e.width,2)+n(e.height,2)+T(e.data().data)}function n(e,t){let r=e.toString(16);var n=t<<1;for(1&r.length&&(r="0"+r);r.length<n;)r+="0";return r}function u(e,t,r){t=new E(t,r);return t.apply(e),t}function d(e,t,r){t=new S(t,r);return t.apply(e),t}function p(e,t="img"){var r=(e=(e=(e=(e=e.replace(/[ `]|(?:&#96;)|(?:&#9;)|(?:img)/g,"").trim()).replaceAll(t,"")).replace(/^["`\(\)]*/,"").replace(/["`\(\)]*$/,"")).replace(/&#10;/g,"\n")).split("\n"),n=[];let i=0;for(let e=0;e<r.length;e++){var s=r[e],a=[];for(let e=0;e<s.length;e++)switch(s[e]){case"0":case".":a.push(0);break;case"1":case"#":a.push(1);break;case"2":case"T":a.push(2);break;case"3":case"t":a.push(3);break;case"4":case"N":a.push(4);break;case"5":case"n":a.push(5);break;case"6":case"G":a.push(6);break;case"7":case"g":a.push(7);break;case"8":a.push(8);break;case"9":a.push(9);break;case"a":case"A":case"R":a.push(10);break;case"b":case"B":case"P":a.push(11);break;case"c":case"C":case"p":a.push(12);break;case"d":case"D":case"O":a.push(13);break;case"e":case"E":case"Y":a.push(14);break;case"f":case"F":case"W":a.push(15);break;default:if(!/\s/.test(s[e]))return}a.length&&(n.push(a),i=Math.max(i,a.length))}var o=n.length,l=new E(i,o);for(let t=0;t<o;t++){var c=n[t];for(let e=0;e<i;e++)e<c.length?l.set(e,t,c[e]):l.set(e,t,0)}return l}function h(e,t="img"){let r="";return r="python"===e?t+'("""':t+"`"}function m(e){let t="";return t+="python"===e?'""")':"`"}function g(r,e,t="img"){if(!r||0===r.height||0===r.width)return"";let n=h(e,t);if(r){var i=300<r.width*r.height?"":" ";for(let t=0;t<r.height;t++){n+="\n";for(let e=0;e<r.width;e++)n+=a[r.get(e,t)]+i}}return n=(n+="\n")+m(e)}function f(e,t){return e===t||!(!e&&t||!t&&e)&&c.sprite.Bitmap.fromData(e).equals(c.sprite.Bitmap.fromData(t))}function _(e,t){return e.tileWidth===t.tileWidth&&c.U.arrayEquals(e.tiles,t.tiles,c.assetEquals)}function y(e){switch(e){case 4:return"TileScale.Four";case 8:return"TileScale.Eight";case 16:return"TileScale.Sixteen";case 32:return"TileScale.ThirtyTwo";default:return Math.floor(Math.log2(e)).toString()}}function b(e){switch(e=e.replace(/\s/g,"")){case"TileScale.Four":return 4;case"TileScale.Eight":return 8;case"TileScale.Sixteen":return 16;case"TileScale.ThirtyTwo":return 32;default:return Math.pow(2,parseInt(e))}}function v(t){var r=new Uint8ClampedArray(t.length>>1);for(let e=0;e<t.length;e+=2)r[e>>1]=parseInt(t.slice(e,e+2),16);return r}function T(t){var r="0123456789abcdef";let n="";for(let e=0;e<t.length;++e)n=(n+=r[t[e]>>4])+r[15&t[e]];return n}function k(e,t,r){e[t]=255&r,e[t+1]=r>>8&255}function x(e){e=(e=>{if(e){if(6===e.length)return parseInt("0x"+e);if(7===e.length)return parseInt("0x"+e.substr(1))}return 0})(e);return[e>>16&255,e>>8&255,255&e]}s.TilemapData=C,s.Bitmask=class{constructor(e,t){this.width=e,this.height=t,this.mask=new Uint8Array(Math.ceil(e*t/8))}set(e,t){e+=this.width*t;this.mask[e>>3]|=1<<(7&e)}get(e,t){e+=this.width*t;return this.mask[e>>3]>>(7&e)&1}},s.encodeTilemap=function(e,t,r){return e?`tiles.createTilemap(${n=e.tilemap,n?`hex\`${l(n)}\``:"hex``"}, ${g(E.fromData(e.layers),t)}, [${e.tileset.tiles.map(e=>{var t=r;return t&&t[e.id]?t[e.id]:e.id})}], ${y(e.tileset.tileWidth)})`:"null";var n},s.decodeTilemap=function(e,t,r){var n,i,s,a;return(e=c.Util.htmlUnescape(e).trim()).trim()&&-1!==e.indexOf("(")?(s=(e=(e=e.substr(e.indexOf("(")+1)).substr(0,e.lastIndexOf(")"))).substr(0,e.indexOf(",")),n=(e=e.substr(s.length+1)).substr(0,e.indexOf(",")),i=(e=e.substr(n.length+1)).substr(0,e.lastIndexOf("]")+1),e=e=e.substr(i.length+1),new C(o(s),{tiles:(a=r,(s=(s=i).replace(/[\[\]]/g,""))?s.split(",").filter(e=>!!e.trim()).map(e=>{var t=e,r=a;if(0===(t=t.trim()).indexOf("img"))return e=p(t),r.createNewTile(e.data());switch(t){case"myTiles.tile0":case"myTiles.transparency16":return r.getTransparency(16);case"myTiles.transparency8":return r.getTransparency(8);case"myTiles.transparency4":return r.getTransparency(4);case"myTiles.transparency32":return r.getTransparency(32);default:return r.resolveTile(t)}}):[]),tileWidth:b(e)},p(n).data())):null},s.trimTilemapTileset=function(e){var r=e.tileset.tiles.slice(),n=e.tilemap;let i={};i[r[0].id]=!0;for(let t=0;t<n.width;t++)for(let e=0;e<n.height;e++)i[r[n.get(t,e)].id]=!0;let t=e.editedTiles||[];var s=r.filter(e=>i[e.id]||"*"===e.id.charAt(0)||-1!==t.indexOf(e.id));if(s.length!==r.length){var a=[];for(let e=0;e<r.length;e++)a.push(s.indexOf(r[e]));for(let t=0;t<n.width;t++)for(let e=0;e<n.height;e++)n.set(t,e,a[n.get(t,e)]);e.tileset.tiles=s}},s.isEmptyTilemap=function(e){var r=e.tileset.tiles,n=e.tilemap,i=r[0].id;for(let t=0;t<n.width;t++)for(let e=0;e<n.height;e++)if(r[n.get(t,e)].id!==i)return!1;return!0},s.computeAverageColor=function(r,e){var n=e.map(x),i=[0,0,0];let s=0;for(let t=0;t<r.width;t++)for(let e=0;e<r.height;e++){var a=r.get(t,e);a&&(++s,a=n[a],i[0]+=a[0],i[1]+=a[1],i[2]+=a[2])}return s?"#"+(t=>{let r="";for(let e=0;e<t.length;++e)r+=("0"+t[e].toString(16)).slice(-2);return r})(i.map(e=>Math.floor(e/s))):"#00000000"},s.getBitmap=function(e,t){return(e=e.apis.byQName[t])?r(e.attributes.jresURL):null},s.getBitmapFromJResURL=r,s.hexToBitmap=t,s.filterItems=function(e,t){let i=(t=t.filter(e=>!!e).map(e=>e.toLowerCase())).filter(e=>0!==e.indexOf("!")),s=t.filter(e=>0===e.indexOf("!")&&1<e.length).map(e=>e.substring(1));return e.filter(e=>{return n=e,i.every(t=>{let r="?"+t;return n.tags.some(e=>e===t||e===r)})&&(r=e,s.every(t=>!r.tags.some(e=>e===t)));var r,n})},s.getGalleryItems=function(e,t){n=e.apis,i=t;let r=c.Util.values(n.byQName).filter(e=>4===e.kind&&e.attributes.fixedInstance&&((e,t,r)=>t==r||!(!(e=e.byQName[t])||!e.extendsTypes)&&0<=e.extendsTypes.indexOf(r))(n,e.retType,i));var n,i;r=r.filter(e=>e.namespace!=s.TILE_NAMESPACE);{e=r;let t=new c.ImageConverter;e.forEach(e=>{e.attributes.jresURL&&!e.attributes.iconURL&&0==e.attributes.jresURL.indexOf("data:image/x-mkcd-f")&&(e.attributes.iconURL=t.convert(e.attributes.jresURL))})}return r.map(e=>{var t=(e.attributes.tags||"").split(" ").filter(e=>!!e).map(e=>c.Util.startsWith(e,"category-")?e:e.toLowerCase());return{qName:e.qName,src:e.attributes.iconURL,alt:e.qName,tags:t}})},s.base64EncodeBitmap=function(e){let r=E.fromData(e);return e=pxtc.f4EncodeImg(e.width,e.height,4,(e,t)=>r.get(e,t)),btoa(c.U.uint8ArrayToString(v(e)))},s.tilemapLiteralToTilemap=o,s.hexEncodeTilemap=l,s.formatByte=n,s.resizeBitmap=u,s.resizeTilemap=d,s.imageLiteralToBitmap=p,s.encodeAnimationString=function(e,t){var r=e.map(e=>e.data);let n=new Uint8ClampedArray(8+r[0].length*r.length),i=(k(n,0,t),k(n,2,e[0].width),k(n,4,e[0].height),k(n,6,e.length),8);return r.forEach(e=>{n.set(e,i),i+=e.length}),btoa(c.sprite.uint8ArrayToHex(n))},s.addMissingTilemapTilesAndReferences=function(e,r){var n=e.getProjectTiles(r.data.tileset.tileWidth,!0);r.data.projectReferences=[];for(let t of n.tiles)r.data.tileset.tiles.some(e=>e.id===t.id)||r.data.tileset.tiles.push(t),e.isAssetUsed(t,null,[r.id])&&r.data.projectReferences.push(t.id)},s.updateTilemapReferencesFromResult=function(r,e){var n=e.data;if(n.deletedTiles)for(var t of n.deletedTiles)r.deleteTile(t);if(n.editedTiles)for(let t of n.editedTiles){var i=n.tileset.tiles.findIndex(e=>e.id===t),s=n.tileset.tiles[i];s&&(n.tileset.tiles[i]=r.updateTile(s))}for(let e=0;e<n.tileset.tiles.length;e++){var a=n.tileset.tiles[e];a.jresData||(n.tileset.tiles[e]=r.resolveTile(a.id))}c.sprite.trimTilemapTileset(n)},s.isTilemapEmptyOrUnused=function(r,e,t){var n=i.Bitmap.fromData(r.data.layers);for(let t=0;t<r.data.tilemap.width;t++)for(let e=0;e<r.data.tilemap.height;e++)if(r.data.tilemap.get(t,e)||n.get(t,e))return!1;return!e.isAssetUsed(r,t)},s.imageLiteralFromDimensions=function(t,r,n,e){let i=h(e);var s=300<t*r?"":" ";for(let e=0;e<r;e++){i+="\n";for(let e=0;e<t;e++)i+=a[n]+s}return i=(i+="\n")+m(e)},s.bitmapToImageLiteral=g,s.bitmapEquals=f,s.tilesetEquals=_,s.tileWidthToTileScale=y,s.tileScaleToTileWidth=b,s.hexToUint8Array=v,s.uint8ArrayToHex=T,s.colorStringToRGB=x}})(pxt=pxt||{}),(a=>{var o=a.sprite||(a.sprite={});{var e=o.legacy||(o.legacy={});let s=new RegExp(`^\\s*${o.TILE_NAMESPACE}\\s*\\.\\s*${o.TILE_PREFIX}(\\d+)\\s*$`);class l{constructor(e,t,r){this.tilemap=e,this.tileset=t,this.layers=r,this.nextId=0}}e.LegacyTilemapData=l,e.decodeTilemap=function(e,t){var r,n,i;return null!=(e=null==(i=a.Util.htmlUnescape(e))?void 0:i.trim())&&e.trim()?(i=(e=(e=e.substr(e.indexOf("(")+1)).substr(0,e.lastIndexOf(")"))).substr(0,e.indexOf(",")),r=(e=e.substr(i.length+1)).substr(0,e.indexOf(",")),n=(e=e.substr(r.length+1)).substr(0,e.lastIndexOf("]")+1),e=e=e.substr(n.length+1),new l(o.tilemapLiteralToTilemap(i),{tiles:(i=(i=n).replace(/[\[\]]/g,""))?i.split(",").filter(e=>!!e.trim()).map(e=>{var t;return 0===(e=e.trim()).indexOf("img")?{data:o.imageLiteralToBitmap(e).data()}:(t=s.exec(e))?{data:null,projectId:Number(t[1])}:{data:null,qualifiedName:e}}):[],tileWidth:o.tileScaleToTileWidth(e)},o.imageLiteralToBitmap(r).data())):new l(new o.Tilemap(16,16),{tileWidth:16,tiles:[]},new o.Bitmap(16,16).data())},e.tileToBlocklyVariable=function(e){return`${e.projectId};${e.data.width};${e.data.height};`+pxtc.Util.toHex(e.data.data)},e.blocklyVariableToTile=function(e){return 4!==(e=e.split(";")).length?null:{projectId:parseInt(e[0]),data:{width:parseInt(e[1]),height:parseInt(e[2]),data:new Uint8ClampedArray(pxtc.Util.fromHex(e[3])),x0:0,y0:0}}}}})(pxt=pxt||{}),(s=>{{var e=s.storage||(s.storage={});class o{constructor(){this.items={}}removeItem(e){delete this.items[e]}getItem(e){return this.items[e]}setItem(e,t){this.items[e]=t}clear(){this.items={}}}class l{constructor(e){this.storageId=e,this.type="localstorage"}targetKey(e){return this.storageId+"/"+e}removeItem(e){window.localStorage.removeItem(this.targetKey(e))}getItem(e){return window.localStorage[this.targetKey(e)]}setItem(e,t){window.localStorage[this.targetKey(e)]=t}clear(){var t=this.targetKey(""),r=[];for(let e=0;e<window.localStorage.length;++e){var n=window.localStorage.key(e);0==n.indexOf(t)&&r.push(n)}r.forEach(e=>window.localStorage.removeItem(e))}}function a(){var e;return s.appTarget?s.appTarget.id:(e=window.pxtConfig)?e.targetId:(e=window.pxtTargetBundle)?e.id:""}e.storageId=a;let i;function r(){if(!i){var t=a();let e=!1;if(!s.shell.isSandboxMode())try{var r=s.Util.guidGen(),n=(window.localStorage[t]=r,window.localStorage[t]);e=n===r}catch(e){}e?(i=new l(t),s.debug("storage: local under "+t)):(i=new o,s.debug("storage: in memory"))}}e.setLocal=function(e,t){r(),i.setItem(e,t)},e.getLocal=function(e){return r(),i.getItem(e)},e.removeLocal=function(e){r(),i.removeItem(e)},e.clearLocal=function(){r(),i.clear()}}})(pxt=pxt||{}),(s=>{var t=s.storage||(s.storage={});{t=t.shared||(t.shared={});let e=!0,i="http://localhost:3232/api/store/";function a(){return e&&s.BrowserUtils.isLocalHostDev()&&!s.BrowserUtils.noSharedLocalStorage()}function o(){return s.BrowserUtils.isChromiumEdge()?"chromium-edge":s.BrowserUtils.browser()}t.getAsync=async function(e,t){if(a()){e+="-"+o();var r=await s.Util.requestAsync({url:i+encodeURIComponent(e)+"/"+encodeURIComponent(t),method:"GET",allowHttpErrors:!0});if(204===r.statusCode)throw new Error(`Missing ${t} not available in `+e);return r.json||r.text||void 0}return r=s.storage.getLocal(e+":"+t),s.Util.jsonTryParse(r)||r},t.setAsync=async function(t,r,n){if(void 0===n)await s.storage.shared.delAsync(t,r);else{let e="";e="object"==typeof n?JSON.stringify(n):n.toString(),a()?(t+="-"+o(),n={type:"object"==typeof n?"json":"text",val:e},n=JSON.stringify(n),await s.Util.requestAsync({url:i+encodeURIComponent(t)+"/"+encodeURIComponent(r),method:"POST",data:n})):s.storage.setLocal(t+":"+r,e)}},t.delAsync=async function(e,t){a()?(e+="-"+o(),await s.Util.requestAsync({url:i+encodeURIComponent(e)+"/"+encodeURIComponent(t),method:"DELETE",allowHttpErrors:!0})):s.storage.removeLocal(e+":"+t)}}})(pxt=pxt||{}),(pxt||(pxt={})).getSectionsFromMarkdownMetadata=function(e){var t,r,n,e=e.split(/\r?\n/);let i=[],s=null,a=null,o=null,l=[],c=0;for(t of e)if(t.trim()){if(t.startsWith("#")){var u=/^(#+)\s*(.+)$/.exec(t);if(u){d(),s={headerKind:1===u[1].length?"single":2===u[1].length?"double":"triple",header:u[2],attributes:{}},a=null,o=null,c=0;continue}}s&&(u=(t=>{let r=0;for(let e=0;e<t.length;e++)if(" "===t.charAt(e))r++;else{if("\t"!==t.charAt(e))return r;r+=4}return 0})(t),r=t.trim(),r=/^[*-]\s+(?:([^:]+):)?(.*)$/.exec(r))&&(1<Math.abs(u-c)&&a&&(u>c?(n={key:a,items:[]},l.length?l[l.length-1].items.push(n):(s.listAttributes||(s.listAttributes={}),s.listAttributes[a]=n),a=null,l.push(n)):(n=l.pop(),a&&o&&(null!=n&&n.items.push((a+":"+o).trim()),o=null)),c=u),r)&&(r[1]?(a&&o&&(l.length?l[l.length-1].items.push((a+":"+o).trim()):s.attributes[a]=o.trim()),a=r[1].trim().toLowerCase(),o=r[2]):a&&(o+=r[2]))}else o&&(o+="\n");return d(),i;function d(){s&&(a&&o&&(l.length?l[l.length-1].items.push((a+":"+o).trim()):s.attributes[a]=o.trim()),i.push(s)),l=[]}},(r=>{var n;{var i=r.multiplayer||(r.multiplayer={});let e,t=((n=e=e||{})[n.PROD=0]="PROD",n[n.STAGING=1]="STAGING",n[n.LOCAL=2]="LOCAL",e.STAGING);i.ABSOLUTE_LINKS={PROD_BETA:"https://arcade.makecode.com/beta--multiplayer",STAGING_BETA:"https://arcade.staging.pxt.io/beta--multiplayer",LOCAL:"http://localhost:3000"},i.RELATIVE_LINKS={PROD:"/--multiplayer",BETA:"/beta--multiplayer"},i.SHORT_LINKS={PROD:"https://aka.ms/a9",PROD_BETA:"https://aka.ms/a9b",STAGING:"https://aka.ms/a9s",STAGING_BETA:"https://aka.ms/a9sb"},i.RELATIVE_LINK=()=>{if(r.BrowserUtils.isLocalHostDev())switch(t){case e.PROD:return i.ABSOLUTE_LINKS.PROD_BETA;case e.STAGING:return i.ABSOLUTE_LINKS.STAGING_BETA;case e.LOCAL:return i.ABSOLUTE_LINKS.LOCAL}return window.location.pathname.startsWith("/beta")?i.RELATIVE_LINKS.BETA:i.RELATIVE_LINKS.PROD},i.SHORT_LINK=()=>{if(r.BrowserUtils.isLocalHostDev())switch(t){case e.PROD:return i.SHORT_LINKS.PROD_BETA;case e.STAGING:return i.SHORT_LINKS.STAGING_BETA;case e.LOCAL:return i.ABSOLUTE_LINKS.LOCAL}return window.location.host.endsWith(".staging.pxt.io")?window.location.pathname.startsWith("/beta")?i.SHORT_LINKS.STAGING_BETA:i.SHORT_LINKS.STAGING:window.location.pathname.startsWith("/beta")?i.SHORT_LINKS.PROD_BETA:i.SHORT_LINKS.PROD},i.makeHostLink=function(e,t){return`${t?i.SHORT_LINK():i.RELATIVE_LINK()}?host=`+encodeURIComponent(e)},i.makeJoinLink=function(e,t){return`${t?i.SHORT_LINK():i.RELATIVE_LINK()}?join=`+encodeURIComponent(e)}}})(pxt=pxt||{}),(t=>{var e;function h(e,t,r){var n=new Uint8Array(2);new Uint16Array(n.buffer)[0]=0|r,e[t]=n[0],e[t+1]=n[1]}function c(e,t){var r=new Uint8Array(2);return r[0]=e[t],r[1]=e[t+1],new Uint16Array(r.buffer)[0]}function m(t){var r=new Uint8Array(5+7*t.steps.length);r[0]=t.steps.length,h(r,1,t.startFrequency),h(r,3,t.startVolume);for(let e=0;e<t.steps.length;e++){var n=5+7*e;r[n]=t.steps[e].waveform,h(r,1+n,t.steps[e].frequency),h(r,3+n,t.steps[e].volume),h(r,5+n,t.steps[e].duration)}return r}function g(t,r,n){var i=new Uint8Array(5+t.notes.length);h(i,0,t.startTick),h(i,2,t.endTick),i[4]=t.notes.length;for(let e=0;e<t.notes.length;e++)i[5+e]=((e,t,r)=>{if(r)return e.note;let n=0;return"flat"===e.enharmonicSpelling?n=1:"sharp"===e.enharmonicSpelling&&(n=2),e.note-12*(t-2)|n<<6})(t.notes[e],r,n);return i}function a(t){if(t.drums){var r,n,i=t,s=i.drums.map(m),a=s.reduce((e,t)=>t.length+e,0),o=i.notes.map(e=>g(e,0,!0)),l=o.reduce((e,t)=>t.length+e,0),c=new Uint8Array(6+a+l);c[0]=i.id,c[1]=1,h(c,2,a);let e=4;for(r of s)c.set(r,e),e+=r.length;h(c,e,l),e+=2;for(n of o)c.set(n,e),e+=n.length;return c}{var u=t;var d,i=(e=>{var t,r=new Uint8Array(28);return r[0]=e.waveform,h(r,1,e.ampEnvelope.attack),h(r,3,e.ampEnvelope.decay),h(r,5,e.ampEnvelope.sustain),h(r,7,e.ampEnvelope.release),h(r,9,e.ampEnvelope.amplitude),h(r,11,(null==(t=e.pitchEnvelope)?void 0:t.attack)||0),h(r,13,(null==(t=e.pitchEnvelope)?void 0:t.decay)||0),h(r,15,(null==(t=e.pitchEnvelope)?void 0:t.sustain)||0),h(r,17,(null==(t=e.pitchEnvelope)?void 0:t.release)||0),h(r,19,(null==(t=e.pitchEnvelope)?void 0:t.amplitude)||0),r[21]=(null==(t=e.ampLFO)?void 0:t.frequency)||0,h(r,22,(null==(t=e.ampLFO)?void 0:t.amplitude)||0),r[24]=(null==(t=e.pitchLFO)?void 0:t.frequency)||0,h(r,25,(null==(t=e.pitchLFO)?void 0:t.amplitude)||0),r[27]=e.octave,r})(u.instrument),a=u.notes.map(e=>g(e,u.instrument.octave,!1)),s=a.reduce((e,t)=>t.length+e,0),p=new Uint8Array(6+i.length+s);p[0]=u.id,p[1]=0,h(p,2,i.length);let e=4;p.set(i,e),e+=i.length,h(p,e,s),e+=2;for(d of a)p.set(d,e),e+=d.length;return p;return}}function u(t,r,n,i){var s={startTick:c(t,r),endTick:c(t,r+2),notes:[]};for(let e=0;e<t[r+4];e++)s.notes.push(((e,t,r)=>{var n=e>>6,r={note:r?e:(63&e)+12*(t-2),enharmonicSpelling:"normal"};return 1==n?r.enharmonicSpelling="flat":2==n&&(r.enharmonicSpelling="sharp"),r})(t[r+5+e],n,i));return s}function r(e){return{ticksPerBeat:8,beatsPerMeasure:4,beatsPerMinute:120,measures:e,tracks:[{id:0,name:lf("Dog"),notes:[],iconURI:"music-editor/dog.png",instrument:{waveform:1,octave:4,ampEnvelope:{attack:10,decay:100,sustain:500,release:100,amplitude:1024},pitchLFO:{frequency:5,amplitude:0}}},{id:1,name:lf("Duck"),notes:[],iconURI:"music-editor/duck.png",instrument:{waveform:15,octave:4,ampEnvelope:{attack:5,decay:530,sustain:705,release:450,amplitude:1024},pitchEnvelope:{attack:5,decay:40,sustain:0,release:100,amplitude:40},ampLFO:{frequency:3,amplitude:20},pitchLFO:{frequency:6,amplitude:2}}},{id:2,name:lf("Cat"),notes:[],iconURI:"music-editor/cat.png",instrument:{waveform:12,octave:5,ampEnvelope:{attack:150,decay:100,sustain:365,release:400,amplitude:1024},pitchEnvelope:{attack:120,decay:300,sustain:0,release:100,amplitude:50},pitchLFO:{frequency:10,amplitude:6}}},{id:3,name:lf("Fish"),notes:[],iconURI:"music-editor/fish.png",instrument:{waveform:1,octave:3,ampEnvelope:{attack:220,decay:105,sustain:1024,release:350,amplitude:1024},ampLFO:{frequency:5,amplitude:100},pitchLFO:{frequency:1,amplitude:4}}},{id:4,name:lf("Car"),notes:[],iconURI:"music-editor/car.png",instrument:{waveform:16,octave:4,ampEnvelope:{attack:5,decay:100,sustain:1024,release:30,amplitude:1024},pitchLFO:{frequency:10,amplitude:4}}},{id:5,name:lf("Computer"),notes:[],iconURI:"music-editor/computer.png",instrument:{waveform:15,octave:2,ampEnvelope:{attack:10,decay:100,sustain:500,release:10,amplitude:1024}}},{id:6,name:lf("Burger"),notes:[],iconURI:"music-editor/burger.png",instrument:{waveform:1,octave:2,ampEnvelope:{attack:10,decay:100,sustain:500,release:100,amplitude:1024}}},{id:7,name:lf("Cherry"),notes:[],iconURI:"music-editor/cherry.png",instrument:{waveform:2,octave:3,ampEnvelope:{attack:10,decay:100,sustain:500,release:100,amplitude:1024}}},{id:8,name:lf("Lemon"),notes:[],iconURI:"music-editor/lemon.png",instrument:{waveform:14,octave:2,ampEnvelope:{attack:5,decay:70,sustain:870,release:50,amplitude:1024},pitchEnvelope:{attack:10,decay:45,sustain:0,release:100,amplitude:20},ampLFO:{frequency:1,amplitude:50},pitchLFO:{frequency:2,amplitude:1}}},{id:9,name:lf("Drums"),notes:[],iconURI:"music-editor/explosion.png",instrument:{waveform:11,octave:4,ampEnvelope:{attack:10,decay:100,sustain:500,release:100,amplitude:1024}},drums:[{startFrequency:100,startVolume:1024,steps:[{waveform:3,frequency:120,duration:10,volume:1024},{waveform:3,frequency:1,duration:100,volume:0}]},{startFrequency:200,startVolume:1024,steps:[{frequency:0,volume:0,duration:100,waveform:1}]},{startFrequency:100,startVolume:1024,steps:[{frequency:0,volume:0,duration:250,waveform:1}]},{startFrequency:175,startVolume:1024,steps:[{waveform:1,frequency:200,duration:10,volume:1024},{waveform:1,frequency:150,duration:20,volume:1024},{waveform:5,frequency:1,duration:20,volume:100},{waveform:5,frequency:1,duration:300,volume:0}]},{startFrequency:220,startVolume:1024,steps:[{waveform:1,frequency:250,duration:10,volume:1024},{waveform:1,frequency:200,duration:20,volume:1024},{waveform:5,frequency:2e3,duration:20,volume:100},{waveform:5,frequency:2e3,duration:200,volume:0}]},{startFrequency:400,startVolume:500,steps:[{frequency:450,volume:500,duration:10,waveform:5},{frequency:400,volume:20,duration:20,waveform:5}]},{startFrequency:400,startVolume:0,steps:[{frequency:450,volume:500,duration:5,waveform:5},{frequency:900,volume:5,duration:50,waveform:5},{frequency:900,volume:0,duration:250,waveform:5}]},{startFrequency:400,startVolume:0,steps:[{frequency:450,volume:500,duration:5,waveform:5},{frequency:900,volume:200,duration:50,waveform:5},{frequency:900,volume:5,duration:100,waveform:5},{frequency:900,volume:0,duration:400,waveform:5}]},{startFrequency:400,startVolume:0,steps:[{frequency:450,volume:500,duration:5,waveform:5},{frequency:900,volume:200,duration:100,waveform:5},{frequency:900,volume:5,duration:200,waveform:5},{frequency:900,volume:0,duration:500,waveform:5}]},{startFrequency:3500,startVolume:1024,steps:[{frequency:4e3,volume:0,duration:10,waveform:4},{frequency:3500,volume:800,duration:1,waveform:4},{frequency:4e3,volume:0,duration:40,waveform:4},{frequency:3500,volume:400,duration:1,waveform:4},{frequency:4e3,volume:0,duration:40,waveform:4}]},{startFrequency:2e3,startVolume:1024,steps:[{frequency:1800,volume:15,duration:100,waveform:4},{frequency:1800,volume:0,duration:200,waveform:4}]},{startFrequency:200,startVolume:200,steps:[{frequency:125,volume:200,duration:25,waveform:14},{frequency:100,volume:15,duration:50,waveform:14},{frequency:120,volume:0,duration:250,waveform:14}]},{startFrequency:300,startVolume:200,steps:[{frequency:225,volume:200,duration:25,waveform:14},{frequency:200,volume:15,duration:50,waveform:14},{frequency:220,volume:0,duration:250,waveform:14}]},{startFrequency:500,startVolume:200,steps:[{frequency:425,volume:200,duration:25,waveform:14},{frequency:400,volume:15,duration:50,waveform:14},{frequency:420,volume:0,duration:250,waveform:14}]},{startFrequency:200,startVolume:1024,steps:[{frequency:75,volume:0,duration:200,waveform:1}]},{startFrequency:300,startVolume:1024,steps:[{frequency:200,volume:0,duration:200,waveform:1}]},{startFrequency:400,startVolume:1024,steps:[{frequency:300,volume:0,duration:200,waveform:1}]},{startFrequency:200,startVolume:1024,steps:[{frequency:200,volume:15,duration:100,waveform:4},{frequency:150,volume:0,duration:200,waveform:4}]},{startFrequency:450,startVolume:1024,steps:[{frequency:350,volume:15,duration:100,waveform:4},{frequency:300,volume:0,duration:100,waveform:4}]},{startFrequency:2500,startVolume:1024,steps:[{frequency:2500,volume:100,duration:150,waveform:4},{frequency:2550,volume:0,duration:500,waveform:4}]},{startFrequency:3e3,startVolume:1024,steps:[{frequency:3e3,volume:100,duration:300,waveform:4},{frequency:3060,volume:0,duration:500,waveform:4}]},{startFrequency:800,startVolume:0,steps:[{frequency:800,volume:1024,duration:10,waveform:4},{frequency:800,volume:0,duration:490,waveform:4}]},{startFrequency:400,startVolume:0,steps:[{frequency:400,volume:1024,duration:10,waveform:4},{frequency:400,volume:0,duration:400,waveform:4}]},{startFrequency:2e3,startVolume:1024,steps:[{frequency:2e3,volume:100,duration:150,waveform:16},{frequency:2e3,volume:0,duration:200,waveform:16}]}]}]}}(e=(e=t.assets||(t.assets={})).music||(e.music={})).encodeSongToHex=function(e){return e=(e=>{var t,r=e.tracks.filter(e=>0<e.notes.length).map(a),n=r.reduce((e,t)=>t.length+e,0),i=new Uint8Array(7+n);i[0]=0,h(i,1,e.beatsPerMinute),i[3]=e.beatsPerMeasure,i[4]=e.ticksPerBeat,i[5]=e.measures,i[6]=r.length;let s=7;for(t of r)i.set(t,s),s+=t.length;return i})(e),t.U.toHex(e)},e.decodeSongFromHex=function(r){r=t.U.fromHex(r);{var n=r;let e={beatsPerMinute:c(n,1),beatsPerMeasure:n[3],ticksPerBeat:n[4],measures:n[5],tracks:[]},t=7;for(;t<n.length;){var[i,s]=((i,s)=>{if(i[s+1]){var n=i,a=s;let e={id:n[a],instrument:{ampEnvelope:{attack:0,decay:0,sustain:0,release:0,amplitude:0},waveform:0},notes:[],drums:[]},t=c(n,a+2),r=a+4;for(;r<a+4+t;)e.drums.push(((t,r)=>{var n={startFrequency:c(t,r+1),startVolume:c(t,r+3),steps:[]};for(let e=0;e<t[r];e++){var i=r+5+7*e;n.steps.push({waveform:t[i],frequency:c(t,i+1),volume:c(t,i+3),duration:c(t,i+5)})}return n})(n,r)),r+=5+7*e.drums[e.drums.length-1].steps.length;var o=c(n,r);for(r+=2;r<a+4+t+o;)e.notes.push(u(n,r,0,!0)),r+=5+e.notes[e.notes.length-1].notes.length;return[e,r]}{var l=i,i=s;let e={id:l[i],instrument:((e,t)=>({waveform:e[t],ampEnvelope:{attack:c(e,t+1),decay:c(e,t+3),sustain:c(e,t+5),release:c(e,t+7),amplitude:c(e,t+9)},pitchEnvelope:{attack:c(e,t+11),decay:c(e,t+13),sustain:c(e,t+15),release:c(e,t+17),amplitude:c(e,t+19)},ampLFO:{frequency:e[t+21],amplitude:c(e,22)},pitchLFO:{frequency:e[t+24],amplitude:c(e,25)},octave:e[t+27]}))(l,i+4),notes:[]},t=i+4+c(l,i+2),r=c(l,t),n=t+2;for(;n<t+2+r;)e.notes.push(u(l,n,e.instrument.octave,!1)),n+=5+e.notes[e.notes.length-1].notes.length;return[e,n]}})(n,t);t=s,e.tracks.push(i)}return e}},e.cloneSong=function(e){return Object.assign(Object.assign({},e),{tracks:e.tracks.map(e=>Object.assign(Object.assign({},e),{instrument:e.instrument&&Object.assign(Object.assign({},e.instrument),{ampEnvelope:Object.assign({},e.instrument.ampEnvelope),pitchEnvelope:e.instrument.pitchEnvelope&&Object.assign({},e.instrument.pitchEnvelope),ampLFO:e.instrument.ampLFO&&Object.assign({},e.instrument.ampLFO),pitchLFO:e.instrument.pitchLFO&&Object.assign({},e.instrument.pitchLFO)}),drums:e.drums&&e.drums.map(e=>Object.assign(Object.assign({},e),{steps:e.steps.map(e=>Object.assign({},e))})),notes:e.notes.map(e=>Object.assign(Object.assign({},e),{notes:e.notes.slice()}))}))})},e.songEquals=function(e,t){return function t(r,n){{if(typeof r!=typeof n)return!1;if("object"!=typeof r)return r===n;if(Array.isArray(r)){if(r.length!==n.length)return!1;for(let e=0;e<r.length;e++)if(!t(r[e],n[e]))return!1;return!0}}let e=Object.keys(r);let i=Object.keys(n);if(e.length!==i.length)return!1;for(var s of e){if(-1===i.indexOf(s))return!1;if(!t(r[s],n[s]))return!1}return!0}(e,t)},e.inflateSong=function(n){var e=r(1);n.tracks=e.tracks.map((e,t)=>{var r=n.tracks.find(e=>e.id===t);return r&&(e.notes=r.notes),e})},e.getSongInfo=function(e){return{ticksPerBeat:e.ticksPerBeat,beatsPerMeasure:e.beatsPerMeasure,beatsPerMinute:e.beatsPerMinute,measures:e.measures}},e.getEmptySong=r})(pxt=pxt||{}),(g=>{let s=["name","version","description","license","dependencies","files","testFiles","testDependencies","fileDependencies","public","targetVersions","supportedTargets","preferredEditor","languageRestriction","additionalFilePath","additionalFilePaths"];class h{constructor(e,t,r,n,i){this.id=e,this._verspec=t,this.parent=r,this.depName=i,this.level=-1,this.isLoaded=!1,this.ignoreTests=!1,this.cppOnly=!1,n&&(this.level=n.level+1),this.addedBy=[n]}static stringifyConfig(e){var t,r,n=e,i={};for(t of s)n.hasOwnProperty(t)&&(i[t]=n[t]);for(r of Object.keys(n))i.hasOwnProperty(r)||(i[r]=n[r]);return JSON.stringify(i,null,4)+"\n"}static parseAndValidConfig(e){let t=g.Util.jsonTryParse(e);return t&&void 0!==t.name&&"string"==typeof t.name&&t.files&&Array.isArray(t.files)&&t.files.every(e=>"string"==typeof e)&&t.dependencies&&Object.keys(t.dependencies).every(e=>"string"==typeof t.dependencies[e])&&t}static async getConfigAsync(e,t,r){var n,i;if(g.github.isGithubId(r))return n=g.github.parseRepoId(r),i=await g.packagesConfigAsync(),await g.github.repoAsync(n.fullName,i)?await g.github.pkgConfigAsync(n.fullName,n.tag,i):null;if(r.startsWith("workspace:"))return r.slice("workspace:".length),null;if(!r.startsWith("pub:"))return n=g.patching.upgradePackageReference(e,t,r),i=g.appTarget.bundledpkgs[n],JSON.parse(i[g.CONFIG_NAME]);{let e=r.slice("pub:".length);try{var s=await g.Cloud.downloadScriptFilesAsync(e);return JSON.parse(s[g.CONFIG_NAME])}catch(e){return g.log(`Unable to fetch files for published script '${r}'`),null}}}static corePackages(){let t=g.appTarget.bundledpkgs;return Object.keys(t).map(e=>JSON.parse(t[e][g.CONFIG_NAME])).filter(e=>!!e)}disablesVariant(e){return this.config&&this.config.disablesVariants&&0<=this.config.disablesVariants.indexOf(e)}invalid(){return/^invalid:/.test(this.version())}version(){return this.resolvedVersion||this._verspec}verProtocol(){var e=this.version().split(":");return 1<e.length?e[0]:""}verArgument(){var e=this.verProtocol();return e?this.version().slice(e.length+1):this.version()}targetVersion(){return this.parent&&this.parent!=this?this.parent.targetVersion():this.config.targetVersions?this.config.targetVersions.target:void 0}async commonDownloadAsync(){var e,t=this.verProtocol();let r;return"pub"==t?r=await g.Cloud.downloadScriptFilesAsync(this.verArgument()):"github"==t?(e=await g.packagesConfigAsync(),e=await g.github.downloadPackageAsync(this.verArgument(),e),r=e.files):"embed"==t?r=g.getEmbeddedScript(this.verArgument()):"pkg"==t&&(e=(this.parent||this).readFile(this.verArgument()),(t=g.U.jsonTryParse(e))||g.log("unable to find "+this.verArgument()),r=t),r}writeAssetPackFiles(){var e,t=JSON.parse(JSON.stringify(this.config));t.files=t.files.filter(e=>e.endsWith(".jres")),t.files.push("gallery.ts"),t.dependencies={},t.assetPack=!0,this.config=t,this.saveConfig();let r="";for(e of t.files){var n,i=this.readFile(e),i=g.U.jsonTryParse(i);i&&([i,n]=g.emitGalleryDeclarations(i,this.getNamespaceName()),this.writeFile(e,JSON.stringify(i,null,4)),r+=n)}this.writeFile("gallery.ts",r)}getNamespaceName(){let e=this,t=e.addedBy[0];for(var r=[];t&&t!==e;)e.depName&&r.push(e.depName),t=(e=t).addedBy[0];return r.reverse().map(e=>ts.pxtc.escapeIdentifier(e)).join(".")}host(){return this.parent._host}readFile(e){return this.host().readFile(this,e)}writeFile(e,t){this.host().writeFile(this,e,t,!0)}readGitJson(){var e=this.readFile(g.github.GIT_JSON);return g.Util.jsonTryParse(e)}resolveDep(e){return this.parent.deps.hasOwnProperty(e)?this.parent.deps[e]:null}saveConfig(){var e=g.U.clone(this.config),e=(delete e.additionalFilePaths,g.Package.stringifyConfig(e));this.host().writeFile(this,g.CONFIG_NAME,e)}setPreferredEditor(e){this.config.preferredEditor!=e&&(this.config.preferredEditor=e,this.saveConfig())}getPreferredEditor(){var e,t=this.config.preferredEditor;return t||(!(0<=this.getFiles().indexOf(g.MAIN_BLOCKS))||(t=this.readFile(g.MAIN_BLOCKS),e=this.readFile(g.MAIN_TS),!t&&e)?g.JAVASCRIPT_PROJECT_NAME:g.BLOCKS_PROJECT_NAME)}parseJRes(e={}){for(var t of this.getFiles())g.U.endsWith(t,".jres")&&r(JSON.parse(this.readFile(t)),e);return e}isAssetPack(){var e;return 0<this.level&&!(null==(e=this.config)||!e.assetPack)}resolveVersionAsync(){let e,r=this._verspec;if(g.getEmbeddedScript(this.id))this.resolvedVersion=r="embed:"+this.id;else if(r&&"*"!=r){if("github"==this.verProtocol()){let t=g.github.parseRepoId(this._verspec);var n;t&&!t.tag&&this.parent&&(g.debug("dep: unbound github extensions, trying to resolve tag"),n=g.semver.sortLatestTags(g.Util.values((null==(e=this.parent)?void 0:e.deps)||{}).map(e=>g.github.parseRepoId(e.version())).filter(e=>(null==e?void 0:e.slug)===t.slug).map(e=>e.tag))[0])&&(t.tag=n,this.resolvedVersion=r=g.github.stringifyRepo(t),g.debug(`dep: github patched ${this._verspec} to `+r))}}else this.configureAsInvalidPackage(lf("version not specified for {0}",this.id)),r=this._verspec;return Promise.resolve(r)}downloadAsync(){return this.resolveVersionAsync().then(e=>{if(this.invalid())g.debug("skip download of invalid package "+this.id);else if(/^embed:/.test(e)||this.installedVersion!=e)return g.debug("downloading "+e),this.host().downloadPackageAsync(this).then(()=>{this.loadConfig(),this.isAssetPack()&&this.writeAssetPackFiles(),g.debug(`installed ${this.id} /`+e)})})}loadConfig(){var e;0!=this.level&&this.invalid()||((e=this.readFile(g.CONFIG_NAME))||g.U.userError(`extension ${this.id} is missing `+g.CONFIG_NAME),this.parseConfig(e),0!=this.level&&(this.installedVersion=this.version()),this.saveConfig())}validateConfig(){this.config.dependencies||g.U.userError("Missing dependencies in config of: "+this.id),Array.isArray(this.config.files)||g.U.userError("Missing files in config of: "+this.id),"string"==typeof this.config.name&&this.config.name||(this.config.name=lf("Untitled")),this.config.targetVersions&&this.config.targetVersions.target&&this.config.targetVersions.targetId===g.appTarget.id&&g.appTarget.versions&&0<g.semver.majorCmp(this.config.targetVersions.target,g.appTarget.versions.target)&&g.U.userError(lf("{0} requires target version {1} (you are running {2})",this.config.name,this.config.targetVersions.target,g.appTarget.versions.target))}isPackageInUse(r,e=this.readFile(g.MAIN_TS)){let n=null;var t=g.patching.computePatches(this.targetVersion(),"missingPackage");return t&&t.forEach(t=>{Object.keys(t.map).forEach(e=>{t.map[e]===r&&(n=new RegExp(e,"g"))})}),(n=n||new RegExp(r+"\\.","g")).test(e)}upgradePackagesAsync(){return this.config||this.loadConfig(),g.packagesConfigAsync().then(async n=>{let i=0,s={},e=[];return g.U.iterMap(this.config.dependencies,(t,r)=>{e.push((async()=>{var e;g.github.isGithubId(r)&&(e=await g.github.upgradedPackageReferenceAsync(n,r))&&e!=r&&(g.log(`upgrading dep ${t}: ${r} -> `+e),s[r]=e,this.config.dependencies[t]=e,i++)})())}),await Promise.all(e),i&&this.saveConfig(),i&&s})}getMissingPackages(i,s){var e=g.patching.computePatches(this.targetVersion(),"missingPackage");let a={};return s&&e&&e.forEach(n=>{Object.keys(n.map).forEach(e=>{var t=new RegExp(e,"g");let r=n.map[e];s.replace(t,e=>(i.dependencies[r]||(a[r]="*"),""))})}),a}findConflictsAsync(e,u){let d=[],p;return Promise.resolve().then(()=>"string"==typeof e?h.getConfigAsync(this.targetVersion(),e,u):Promise.resolve(e)).then(e=>{if(p=e){let c=p.yotta?g.U.jsonFlatten(p.yotta.config):null;this.parent.sortedDeps().forEach(t=>{var r,n;if(p.core&&t.config.core&&p.name!=t.config.name)(n=new g.cpp.PkgConflictError(lf("conflict between core extensions {0} and {1}",p.name,t.id))).pkg0=t,d.push(n);else{let e=!1;if(c){var i=t.config||JSON.parse(t.readFile(g.CONFIG_NAME));if(!!i&&!!i.yotta&&!!t.config.yotta.config){var s,a=g.U.jsonFlatten(i.yotta.config);for(s of Object.keys(c)){var o=a[s],l=p.yotta.configIsJustDefaults||i.yotta.configIsJustDefaults;!a.hasOwnProperty(s)||o===c[s]||l||t.parent.config.yotta&&t.parent.config.yotta.ignoreConflicts||((o=new g.cpp.PkgConflictError(lf("conflict on yotta setting {0} between extensions {1} and {2}",s,p.name,t.id))).pkg0=t,o.settingName=s,d.push(o),e=!0)}}}e||p.name!==t.id||t._verspec===u||/^file:/.test(t._verspec)||/^file:/.test(u)||(n=/^github:/.test(t._verspec)&&g.github.parseRepoId(t._verspec),r=/^github:/.test(u)&&g.github.parseRepoId(u),n&&r&&n.fullName===r.fullName&&!(r.tag&&g.semver.strcmp(n.tag,r.tag)<0))||((n=new g.cpp.PkgConflictError(lf("version mismatch for extension {0} (added: {1}, adding: {2})",t.id,t._verspec,u))).pkg0=t,n.isVersionConflict=!0,d.push(n))}})}return Object.keys(null!=(e=null==p?void 0:p.dependencies)?e:{}).reduce((e,t)=>e.then(()=>this.findConflictsAsync(t,p.dependencies[t])).then(e=>d.push.apply(d,e)),Promise.resolve())}).then(()=>{let n=e=>{let t=[];return e.addedBy.forEach(e=>{e.id!==this.id&&(t.push.apply(n(e)),t.push(e))}),t},e=[];return d.forEach(r=>{e.push.apply(e,n(r.pkg0).map(e=>{var t=new g.cpp.PkgConflictError(r.isVersionConflict?lf("a dependency of {0} has a version mismatch with extension {1} (added: {1}, adding: {2})",e.id,p.name,r.pkg0._verspec,u):lf("conflict on yotta setting {0} between extensions {1} and {2}",r.settingName,p.name,r.pkg0.id));return t.pkg0=e,t}))}),d.push.apply(d,e),d=d.filter((t,r)=>{for(let e=0;e<r;++e)if(t.pkg0.id===d[e].pkg0.id)return!1;return!0})})}configureAsInvalidPackage(e){g.log(`invalid package ${this.id}: `+e),this._verspec="invalid:"+this.id,this.config={name:this.id,description:e,dependencies:{},files:[]}}parseConfig(e,t){try{var r=JSON.parse(e);this.config=r}catch(e){this.configureAsInvalidPackage(lf("Syntax error in pxt.json")),g.tickEvent("package.invalidConfigEncountered")}var n,e=JSON.stringify(this.config);for(n in this.config.dependencies){var i=g.patching.upgradePackageReference(this.targetVersion(),n,this.config.dependencies[n]);i!=n&&(delete this.config.dependencies[n],i)&&(this.config.dependencies[i]="*")}t&&(this.config.targetVersions={target:t}),JSON.stringify(this.config)!=e&&this.saveConfig(),this.validateConfig()}patchCorePackage(){g.Util.assert(g.appTarget.simulator&&g.appTarget.simulator.dynamicBoardDefinition),g.Util.assert(0==this.level);var e,t=Object.keys(this.config.dependencies).filter(e=>!!e&&(e==g.BLOCKS_PROJECT_NAME||e==g.JAVASCRIPT_PROJECT_NAME||JSON.parse((g.appTarget.bundledpkgs[e]||{})[g.CONFIG_NAME]||"{}").core));0==t.length?(e=g.Package.corePackages()).length&&this.config.dependencies[e[0].name]:1<t.length&&(t.pop(),t.forEach(e=>{g.log("removing core package "+e),delete this.config.dependencies[e]}))}resolvedDependencies(){return Object.keys(this.dependencies()).map(e=>this.resolveDep(e))}dependencies(e=!1){if(!this.config)return{};let r=g.Util.clone(this.config.dependencies||{});return 0==this.level&&this.config.testDependencies&&g.Util.iterMap(this.config.testDependencies,(e,t)=>{"*"==t&&!g.appTarget.bundledpkgs[e]||(r[e]=t)}),e&&this.config.cppDependencies&&g.Util.jsonMergeFrom(r,this.config.cppDependencies),r}async loadAsync(c=!1,e){if(!this.isLoaded){0!=this.level||g.appTarget.multiVariants||g.setAppTargetVariant(null),this.isLoaded=!0;var r,n=this.readFile(g.CONFIG_NAME);if(null==n?c||g.U.userError("Package not installed: "+this.id+", did you forget to run `pxt install`?"):this.parseConfig(n),c||await this.upgradePackagesAsync(),c&&(await this.downloadAsync(),0!==this.level)&&!this.isAssetPack())for(var i of this.addedBy)if(null!=(i=i.config.assetPacks)&&i[this.id]){this.writeAssetPackFiles();break}c&&(n=await this.upgradePackagesAsync())&&(Object.keys(n).forEach(e=>g.tickEvent("package.doubleload",{extension:e})),g.log("upgraded, downloading again"),g.debug(n),await this.downloadAsync()),g.appTarget.simulator&&g.appTarget.simulator.dynamicBoardDefinition&&(0==this.level&&this.patchCorePackage(),this.config.compileServiceVariant&&g.setAppTargetVariant(this.config.compileServiceVariant),0<=this.config.files.indexOf("board.json"))&&((n=g.appTarget.simulator.boardDefinition=JSON.parse(this.readFile("board.json"))).id=this.config.name,g.appTarget.appTheme.boardName=n.boardName||lf("board"),g.appTarget.appTheme.driveDisplayName=n.driveDisplayName||lf("DRIVE"),n=e=>{var t,r=/^pkg:\/\/(.*)/.exec(e);return r?(r=r[1],t=this.readFile(r),g.U.toDataUri(t,g.U.getMime(r))):e},"object"==typeof(r=g.appTarget.simulator.boardDefinition).visual)&&((r=r.visual).image=n(r.image),r.outlineImage=n(r.outlineImage));let l=(e,t)=>{if(g.debug(`version spec mismatch: ${e._verspec} != `+t),/^github:/.test(e._verspec)&&/^github:/.test(t)){var r=g.github.parseRepoId(e._verspec),n=g.github.parseRepoId(t);if(null!=r&&r.slug&&(null==r?void 0:r.slug)===(null==n?void 0:n.slug)){var r=(null==r?void 0:r.tag)||(null==(r=e.config)?void 0:r.version),i=n.tag;if(r&&!i)return void g.debug(`unversioned ${t}, using `+r);i=g.semver.strcmp(r,n.tag);if(0==i)return void g.debug("resolved version are "+r);if(0<i)return void g.debug(`auto-upgraded ${t} to `+r)}}/^file:/.test(e._verspec)||/^file:/.test(t)?g.debug("ignore file: mismatch issues"):e.configureAsInvalidPackage(lf("version mismatch"))},t=async(n,i,s=!1)=>{n=n||i.dependencies(s),g.debug(`deps: ${i.id}->`+Object.keys(n).join(", ")),n=g.github.resolveMonoRepoVersions(n),g.debug(`deps: resolved ${i.id}->`+Object.keys(n).join(", "));for(var a of Object.keys(n)){let e=n[a]||"*",t=(g.debug(`dep: load ${i.id}.${a}${s?"++":""}: `+e),"hw"==a&&g.hwVariant&&(a="hw---"+g.hwVariant),g.github.parseRepoId(e));var o;null!=t&&t.slug&&(o=Object.values(i.parent.deps).map(e=>g.github.parseRepoId(e._verspec)).filter(e=>(null==e?void 0:e.slug)===t.slug).map(e=>e.tag).reduce((e,t)=>0<g.semver.strcmp(e,t)?e:t,"0.0.0"),g.debug(`dep: common repo ${t.slug} version found `+o),0<g.semver.strcmp(o,"0.0.0"))&&(!t.tag||0<g.semver.strcmp(o,t.tag))&&(g.debug(`dep: upgrade from ${t.tag} to `+o),t.tag=o,e=g.github.stringifyRepo(t,!0));let r=i.resolveDep(a);r?(r.invalid()||r._verspec===e||l(r,e),!r.invalid()&&s||(r.level=Math.min(r.level,i.level+1),r.addedBy.push(i))):(r=new h(a,e,i.parent,i,a),s&&(r.cppOnly=!0),i.parent.deps[a]=r,await(i.parent.deps[a.replace(/---.*/,"")]=r).loadAsync(c))}};if(await t(null,this),this.patchAppTargetPalette(),this.config.screenSize&&g.appTarget.runtime&&(g.appTarget.runtime.screenSize=g.U.clone(this.config.screenSize)),0===this.level){n=this.readFile(g.MAIN_TS);if(n){var s,a=this.getMissingPackages(this.config,n);let e=!1;for(s of Object.keys(a)){var o,u=await this.findConflictsAsync(s,a[s]);u.length?(o=u.map(e=>e.pkg0.id).join(", "),u=u.map(e=>e.settingName).filter(e=>!!e).join(", "),g.log(`skipping missing package ${s} because it conflicts with the following packages: ${o} (conflicting settings: ${u})`)):(g.log("adding missing package "+s),e=!0,this.config.dependencies[s]="*",(o={})[s]=a[s],await t(o,this))}e&&(this.saveConfig(),this.validateConfig())}await Promise.all(g.U.values(this.parent.deps).map(e=>t(null,e,!0)))}g.debug("  installed "+this.id)}}getFiles(){let e,t=(e=0!=this.level||this.ignoreTests?this.config.files.slice(0):this.config.files.concat(this.config.testFiles||[]),this.config.fileDependencies);return e=this.config.fileDependencies?e.filter(r=>{let n=e=>{var t;return"!"==(e=e.trim())[0]?!n(e.slice(1)):/^[\w-]+$/.test(e)?!(!(t=this.parent.resolveDep(e))||t.cppOnly):(t=/^target:(\w+)$/.exec(e))?t[1]==g.appTarget.id||t[1]==g.appTarget.platformid:(h.depWarnings[e]||(h.depWarnings[e]=!0,g.log(`invalid dependency expression: ${e} in ${this.id}/`+r)),!1)};var e=g.U.lookup(t,r);return!e||!e.trim()||e.split("||").some(e=>e.split("&&").every(n))}):e}addSnapshot(e,r=[""]){for(let t of this.getFiles())r.some(e=>g.U.endsWith(t,e))&&(e[this.id+"/"+t]=this.readFile(t));e[this.id+"/"+g.CONFIG_NAME]=this.readFile(g.CONFIG_NAME)}packageLocalizationStringsAsync(r){let n=g.appTarget.id;var e=[this.config.name+"-jsdoc",this.config.name];let i={};g.appTarget.appTheme;return this.config.skipLocalization?Promise.resolve(i):g.Util.liveLocalizationEnabled()&&"this"!=this.id&&g.appTarget.bundledpkgs[this.id]?(g.debug("loading live translations for "+this.id),Promise.all(e.map(t=>g.Util.downloadLiveTranslationsAsync(r,n+`/${t}-strings.json`).then(e=>{e&&Object.keys(e).length?g.Util.jsonMergeFrom(i,e):(g.tickEvent("translations.livetranslationsfailed",{filename:t}),g.Util.jsonMergeFrom(i,this.bundledStringsForFile(r,t)))}).catch(e=>{g.tickEvent("translations.livetranslationsfailed",{filename:t}),g.log(`error while downloading ${n}/${t}-strings.json`),g.Util.jsonMergeFrom(i,this.bundledStringsForFile(r,t))}))).then(()=>i)):(e.map(e=>this.bundledStringsForFile(r,e)).filter(e=>!!e).forEach(e=>g.Util.jsonMergeFrom(i,e)),Promise.resolve(i))}bundledStringsForFile(t,e){let r={};var[n,i,s]=g.Util.normalizeLanguageCode(t),a=this.config.files;let o=`_locales/${n}/${e}-strings.json`;if(s&&-1===a.indexOf(o)&&(o=`_locales/${s}/${e}-strings.json`),i&&-1===a.indexOf(o)&&(o=`_locales/${i}/${e}-strings.json`),-1<a.indexOf(o))try{r=JSON.parse(this.readFile(o))}catch(e){g.reportError("extension","Extension localization JSON failed to parse",{fileName:o,lang:t,extension:this.verArgument()}),"github"===this.verProtocol()&&g.tickEvent("loc.errors.json",{repo:this.verArgument(),file:o})}return r}patchAppTargetPalette(){this.config.palette&&g.appTarget.runtime&&(g.appTarget.runtime.palette=g.U.clone(this.config.palette),this.config.paletteNames)&&(g.appTarget.runtime.paletteNames=this.config.paletteNames)}}h.depWarnings={},g.Package=h;class e extends h{constructor(e){super("this","file:.",null,null,null),this._host=e,this.deps={},(this.parent=this).addedBy=[this],this.level=0,this.deps[this.id]=this}installAllAsync(e){return this.loadAsync(!0,e)}sortedDeps(r=!1){let n={},i=[],s=e=>e.config?Object.keys(e.config.cppDependencies||{}).length:0,a=e=>{var t;e&&!g.U.lookup(n,e.id)&&(n[e.id]=!0,(t=Object.keys(e.dependencies(r)).map(e=>this.resolveDep(e))).sort((e,t)=>s(t)-s(e)||g.U.strcmp(e.id,t.id)),t.forEach(a),i.push(e.id))};return a(this),i.map(e=>this.resolveDep(e))}localizationStringsAsync(t){let r={};return Promise.all(g.Util.values(this.deps).map(e=>e.packageLocalizationStringsAsync(t).then(t=>{t&&Object.keys(t).forEach(e=>{r[e]||(r[e]=t[e])})}))).then(()=>{let t=g.U.getLocalizedStrings();return Object.keys(r).forEach(e=>{!g.U.startsWith(e,"{id:subcategory}")&&!g.U.startsWith(e,"{id:group}")||t[e]||(t[e]=r[e])}),g.U.setLocalizedStrings(t),Promise.resolve(r)})}getTargetOptions(){let t=g.U.clone(g.appTarget.compile);return g.U.assert(!!t),t.utf8||this.sortedDeps(!0).forEach(e=>{e.config&&e.config.utf8&&(g.debug("forcing utf8 mode: pkg="+e.id),t.utf8=!0)}),t}getJRes(){if(!this._jres){this._jres={};for(var e of this.sortedDeps())e.parseJRes(this._jres);var t=(g.appTarget.runtime&&g.appTarget.runtime.palette?g.appTarget.runtime.palette:["#000000","#ffffff"]).map(e=>("000000"+parseInt(e.replace(/#/,""),16).toString(16)).slice(-6)).join("");this._jres.__palette={id:"__palette",data:t,dataEncoding:"hex",mimeType:"application/x-palette"}}return this._jres}updateJRes(){this._jres&&this.parseJRes(this._jres)}resolveBannedCategories(){if(void 0===this._resolvedBannedCategories){let t=[];g.appTarget&&g.appTarget.runtime&&g.appTarget.runtime.bannedCategories&&g.appTarget.runtime.bannedCategories.length&&(t=g.appTarget.runtime.bannedCategories.slice(),Object.keys(this.deps).map(e=>this.deps[e]).filter(e=>!!e).map(e=>g.Util.jsonTryParse(e.readFile(g.CONFIG_NAME))).filter(e=>e&&e.requiredCategories).forEach(e=>e.requiredCategories.forEach(e=>{e=t.indexOf(e);-1<e&&t.splice(e,1)})),this._resolvedBannedCategories=t),this._resolvedBannedCategories=t,this._resolvedBannedCategories.length||(this._resolvedBannedCategories=null)}return this._resolvedBannedCategories}async getCompileOptionsAsync(i=this.getTargetOptions()){let e,n={sourceFiles:[],fileSystem:{},target:i,name:this.config?this.config.name:""},s=(e,t)=>{this.config.files.indexOf(e)<0&&g.U.userError(lf("please add '{0}' to \"files\" in {1}",e,g.CONFIG_NAME)),t="// Auto-generated. Do not edit.\n"+t+"\n// Auto-generated. Do not edit. Really.\n",this.host().readFile(this,e,!0)!==t&&(g.debug(`updating ${e} (size=${t.length})...`),this.host().writeFile(this,e,t,!0))},a=g.appTarget.disabledVariants,o=!1,l=async e=>{var t={extinfo:null,target:null},r=g.appTargetVariant;e&&g.setAppTargetVariant(e,{temporary:!0});let n;try{t.target=g.appTarget.compile,n=g.cpp.getExtensionInfo(this),o||!n.shimsDTS&&!n.enumsDTS||(o=!0,n.shimsDTS&&s("shims.d.ts",n.shimsDTS),n.enumsDTS&&s("enums.d.ts",n.enumsDTS))}finally{e&&g.setAppTargetVariant(r,{temporary:!0})}n.appVariant=e;r=i.isNative?await this.host().getHexInfoAsync(n):null;return n=g.U.flatClone(n),i.keepCppFiles||(delete n.compileData,delete n.generatedFiles,delete n.extensionFiles),n.hexinfo=r,t.extinfo=n,t};await this.loadAsync(),n.bannedCategories=this.resolveBannedCategories(),g.debug("building: "+this.sortedDeps().map(e=>null==(e=e.config)?void 0:e.name).join(", "));let c,u=(g.appTarget.multiVariants?(c=g.appTargetVariant?[g.appTargetVariant]:g.appTarget.alwaysMultiVariant||g.appTarget.compile.switches.multiVariant?g.appTarget.multiVariants:[g.appTarget.multiVariants[0]],!g.appTarget.alwaysMultiVariant&&a&&(c=c.filter(e=>!a.includes(e)))):c=[null],null);var t,r,d;await Promise.all(c.map(async e=>{u&&g.debug("building for "+e);var t=await l(e),r=t.extinfo;r.appVariant=e,r.outputPrefix=1!=c.length&&e?e+"-":"",-1<(null==a?void 0:a.indexOf(e))&&(r.disabledDeps=r.disabledDeps||"user-disabled"),u?n.otherMultiVariants.push(t):(t.target.isNative=n.target.isNative,n.target=t.target,u=r,n.otherMultiVariants=[])})),n.extinfo=u,n.target.preferredEditor=this.getPreferredEditor(),!(g.appTarget.compile.shortPointers||"vm"==g.appTarget.compile.nativeType||this.config.binaryonly||!n.target.isNative)&&(t=await this.filesToBePublishedAsync(!0),m=JSON.stringify({name:this.config.name,comment:this.config.description,status:"unpublished",scriptId:this.installedVersion,cloudId:g.CLOUD_ID+g.appTarget.id,editor:this.getPreferredEditor(),targetVersions:g.appTarget.versions}),t=JSON.stringify(t),r=await g.lzmaCompressAsync(m+t))&&(n.embedMeta=JSON.stringify({compression:"LZMA",headerSize:m.length,textSize:t.length,name:this.config.name,eURL:g.appTarget.appTheme.embedUrl,eVER:g.appTarget.versions?g.appTarget.versions.target:"",pxtTarget:g.appTarget.id}),n.embedBlob=ts.pxtc.encodeBase64(g.U.uint8ArrayToString(r)));for(d of this.sortedDeps())for(var p of d.getFiles())if(/\.(ts|asm|py)$/.test(p)){let e=p;0<d.level&&(e="pxt_modules/"+d.id+"/"+p),n.sourceFiles.push(e),n.fileSystem[e]=d.readFile(p)}n.jres=this.getJRes();var h,m=g.appTarget.runtime&&g.appTarget.runtime.functionsOptions;n.allowedArgumentTypes=m&&m.extraFunctionEditorTypes&&m.extraFunctionEditorTypes.map(e=>e.typeName).concat("number","boolean","string"),n.unfetteredInitializers=null==(e=g.appTarget.compile)?void 0:e.unfetteredInitializers;for(h of this.sortedDeps())h.patchAppTargetPalette();return this.patchAppTargetPalette(),n}prepareConfigToBePublished(){let i=g.U.clone(this.config);return delete i.installedVersion,delete i.additionalFilePath,delete i.additionalFilePaths,i.targetVersions||(i.targetVersions=g.Util.clone(g.appTarget.versions)),g.U.iterMap(i.dependencies,(e,t)=>{if(!t||/^(file|workspace):/.test(t)){t="*";try{var r,n=this.resolveDep(e).readGitJson();n&&n.repo&&((r=g.github.parseRepoId(n.repo)).tag=n.commit.tag||n.commit.sha,t=g.github.stringifyRepo(r))}catch(e){}i.dependencies[e]=t}}),i.files=i.files.filter(e=>e!==g.HISTORY_FILE),i}filesToBePublishedAsync(n=!1){let i={};return this.loadAsync().then(()=>{n||this.config.public||g.U.userError('Only packages with "public":true can be published');var e,t,r=this.prepareConfigToBePublished();i[g.CONFIG_NAME]=g.Package.stringifyConfig(r);for(e of this.getFiles())e!==g.CONFIG_NAME&&e!==g.HISTORY_FILE&&(null==(t=this.readFile(e))&&g.U.userError("referenced file missing: "+e),i[e]=t);return g.U.sortObjectFields(i)})}saveToJsonAsync(){return this.filesToBePublishedAsync(!0).then(e=>({meta:{cloudId:g.CLOUD_ID+g.appTarget.id,targetVersions:g.appTarget.versions,editor:this.getPreferredEditor(),name:this.config.name},source:JSON.stringify(e,null,2)}))}compressToFileAsync(){return this.saveToJsonAsync().then(e=>g.lzmaCompressAsync(JSON.stringify(e,null,2)))}computePartDefinitions(n){if(!n||!n.length)return{};let i={};return this.sortedDeps().forEach(r=>{var t=r.readFile("pxtparts.json");if(t)try{let e=JSON.parse(t);Object.keys(e).forEach(t=>{if(0<=n.indexOf(t)){t=i[t]=e[t];if("string"==typeof t.visual.image&&/\.svg$/i.test(t.visual.image)){let e=r.readFile(t.visual.image);e||g.reportError("parts","invalid part definition",{error:"missing visual "+t.visual.image}),/^data:image\/svg\+xml/.test(e)||(e="data:image/svg+xml,"+encodeURIComponent(e)),t.visual.image=e}}})}catch(e){g.reportError("parts","invalid pxtparts.json file")}}),i}}function r(n,i={}){var s,a=n["*"]||{};for(s of Object.keys(n))if("*"!=s){let e=n[s],t=(e="string"==typeof e?{data:e}:e).namespace||a.namespace||"";t&&!t.endsWith(".")&&(t+=".");var o=e.id||t+s;let r=e.icon;var l=e.mimeType||a.mimeType,c=e.dataEncoding||a.dataEncoding||"base64";r||"base64"!=c||"image/png"!=l&&"image/jpeg"!=l||(r="data:"+l+";base64,"+e.data),i[o]={id:o,data:e.data,dataEncoding:c,icon:r,namespace:t,mimeType:l,tilemapTile:e.tilemapTile,displayName:e.displayName,tileset:e.tileset,tags:e.tags}}return i}g.MainPackage=e,g.inflateJRes=r,g.allPkgFiles=function(e){return[g.CONFIG_NAME].concat(e.files||[]).concat(e.testFiles||[])},g.isPkgBeta=function(e){return e&&/\bbeta\b/.test(e.description)}})(pxt=pxt||{}),(l=>{{var c=l.packetio||(l.packetio={});let n,r,i=()=>{},s,a;c.isActive=function(){return!!n},c.isConnected=function(){return!(null==n||!n.isConnected())},c.isConnecting=function(){return!(null==n||!n.isConnecting())},c.icon=function(){var e;return!!n&&(n.icon||(null==(e=l.appTarget.appTheme.downloadDialogTheme)?void 0:e.deviceIcon)||"usb")},c.unsupportedParts=function(){return null!=n&&n.unsupportedParts?n.unsupportedParts():[]},c.deviceVariant=function(){return null==n?void 0:n.devVariant};let o;function u(){if(o)return o;let t=Promise.resolve();if(n){l.debug("packetio: disconnect");let e=n;t=t.then(()=>e.disconnectAsync()).then(()=>e.io.disposeAsync()).catch(e=>{l.reportException(e)}).finally(()=>{r=void 0,n=void 0,o=void 0}),i&&(t=t.then(()=>i())),o=t}return t}c.disconnectAsync=u,c.configureEvents=function(e,t,r){i=e,s=t,a=r,n&&(n.io.onConnectionChanged=i,n.onSerial=s,n.onCustomEvent=r)},c.sendCustomEventAsync=function(e,t){return n?n.sendCustomEventAsync(e,t):Promise.resolve()},c.initAsync=function(t=!1){if(l.debug("packetio: init "+(t?"(force)":"")),!r){let e=Promise.resolve();t&&(e=e.then(()=>u())),r=e.then(()=>n?Promise.resolve(n):c.mkPacketIOAsync?(l.debug("packetio: new wrapper"),c.mkPacketIOAsync().then(e=>(e.onConnectionChanged=i,n=c.mkPacketIOWrapper(e),s&&(n.onSerial=s),a&&(n.onCustomEvent=a),i&&i(),n))):(l.debug("packetio: not defined, skipping"),Promise.resolve(void 0))).finally(()=>{r=void 0})}return r}}})(pxt=pxt||{}),(s=>{var e;function n(e,t,r){let n=s.semver.tryParse(e||"0.0.0")||s.semver.tryParse("0.0.0"),i=[];return Object.keys(t).filter(e=>s.semver.inRange(e,n)).forEach(e=>i=i.concat(t[e])),(i=r?i.filter(e=>e.type==r):i).length?i:void 0}function r(e,t,r){let n=t;return r&&(r.filter(e=>"api"===e.type).forEach(r=>{Object.keys(r.map).forEach(e=>{var t=new RegExp(e,"g");n=n.replace(t,r.map[e])})}),r.filter(e=>"userenum"===e.type).forEach(r=>{Object.keys(r.map).forEach(e=>{var t=new RegExp("enum\\s+"+e+"\\s*{","gm"),t=(n=n.replace(t,`enum ${r.map[e]} {`),new RegExp(`(^|[^_a-zA-Z0-9])${e}(\\s*\\.)`,"g"));n=n.replace(t,`$1${r.map[e]}$2`)})})),n}(e=s.patching||(s.patching={})).computePatches=function(e,t){var r=s.appTarget.compile?s.appTarget.compile.patches:void 0;if(r)return n(e,r,t)},e.computePyPatches=function(e,t){var r=s.appTarget.compile?s.appTarget.compile.pyPatches:void 0;if(r)return n(e,r,t)},e.upgradePackageReference=function(e,t,r){if("*"!=r)return t;r=s.patching.computePatches(e,"package");let n=t;return r&&r.forEach(t=>{Object.keys(t.map).forEach(e=>{n==e&&(n=t.map[e])})}),n},e.patchJavaScript=function(e,t){return r(0,t,s.patching.computePatches(e))},e.patchPython=function(e,t){return r(0,t,s.patching.computePyPatches(e))}})(pxt=pxt||{}),(e=>{e.react||(e.react={})})(pxt=pxt||{}),(a=>{var t;function s(r,n){if(r){if(n){let t=r.major-n.major||r.minor-n.minor||r.patch-n.patch;if(t)return t;if(0==r.pre.length&&0<n.pre.length)return 1;if(0<r.pre.length&&0==n.pre.length)return-1;for(let e=0;e<r.pre.length+1;++e){var i=r.pre[e],s=n.pre[e];if(!i)return s?-1:0;if(!s)return 1;if(/^\d+$/.test(i)){if(!/^\d+$/.test(s))return-1;if(t=parseInt(i)-parseInt(s))return t}else{if(/^\d+$/.test(s))return 1;if(t=a.U.strcmp(i,s))return t}}return 0}return-1}return n?1:0}function o(e,t){t=l(e)||l(t);return t||a.U.userError(a.U.lf("'{0}' doesn't look like a semantic version number",e)),t}function l(e){if(!e)return null;if("*"===e)return{major:Number.MAX_SAFE_INTEGER,minor:Number.MAX_SAFE_INTEGER,patch:Number.MAX_SAFE_INTEGER,pre:[],build:[]};/^v\d/i.test(e)&&(e=e.slice(1));e=/^(\d+)\.(\d+)\.(\d+)(-([0-9a-zA-Z\-\.]+))?(\+([0-9a-zA-Z\-\.]+))?$/.exec(e);return e?{major:parseInt(e[1]),minor:parseInt(e[2]),patch:parseInt(e[3]),pre:e[5]?e[5].split("."):[],build:e[7]?e[7].split("."):[]}:null}function c(e){let t=e.major+"."+e.minor+"."+e.patch;return e.pre.length&&(t+="-"+e.pre.join(".")),e.build.length&&(t+="+"+e.build.join(".")),t}function r(e,t){var r=l(e),n=l(t);return r||n?s(r,n):a.U.strcmp(e,t)}function u(e,t){var r,e=e.split(" - ");return 2==e.length&&(r=l(e[0]),e=l(e[1]),!(!r||!e))&&(!t||(r=s(r,t),t=s(t,e),r<=0&&t<0))}(t=a.semver||(a.semver={})).cmp=s,t.parse=o,t.tryParse=l,t.normalize=function(e){return c(o(e))},t.stringify=c,t.majorCmp=function(e,t){return e=l(e),t=l(t),e.major-t.major},t.strcmp=r,t.inRange=u,t.sortLatestTags=function(e){return(e=e.filter(e=>!!t.tryParse(e))).sort(r),e.reverse(),e},t.bump=function(e,t){let r=o(c(e));switch(t){case"major":r.major++,r.minor=0,r.patch=0;break;case"minor":r.minor++,r.patch=0;break;case"patch":r.patch++;break;default:r=a.semver.parse(t)}return r},t.test=function(){a.log("Test semver");var r=["0.9.0","1.0.0-0.3.7","1.0.0-alpha","1.0.0-alpha.1","1.0.0-alpha.beta","1.0.0-beta","1.0.0-beta.2","1.0.0-beta.11","1.0.0-rc.1","1.0.0-x.7.z.92","1.0.0","1.0.1","1.9.0","1.10.0","1.11.0"];for(let t=0;t<r.length;++t){var n=o(r[t]);a.log(r[t],n),a.U.assert(c(n)==r[t]);for(let e=0;e<r.length;++e){var i=s(n,o(r[e]));a.log(r[t],r[e],i),t<e?a.U.assert(i<0):t>e?a.U.assert(0<i):a.U.assert(0==i)}}var e=l("1.2.3");a.U.assert(u("0.1.2 - 2.2.3",e)),a.U.assert(u("1.2.3 - 2.2.3",e)),a.U.assert(!u("0.0.0 - 1.2.3",e)),a.U.assert(!u("1.2.4 - 4.2.3",e)),a.U.assert(!u("0.0.0 - 0.0.1",e))}})(pxt=pxt||{}),(e=>{var u;{var x=e.pxtc||(e.pxtc={});function t(e){return x.Util.values(e.byQName).filter(e=>e.attributes.block&&/^{[^:]+:[^}]+}/.test(e.attributes.block)).forEach(e=>{e.attributes.block=e.attributes.block.replace(/^{[^:]+:[^}]+}/,"")}),e}x.assert=x.Util.assert,x.oops=x.Util.oops,x.U=x.Util,x.ON_START_TYPE="pxt-on-start",x.ON_START_COMMENT="on start",x.HANDLER_COMMENT="code goes here",x.TS_STATEMENT_TYPE="typescript_statement",x.TS_DEBUGGER_TYPE="debugger_keyword",x.TS_BREAK_TYPE="break_keyword",x.TS_CONTINUE_TYPE="continue_keyword",x.TS_OUTPUT_TYPE="typescript_expression",x.TS_RETURN_STATEMENT_TYPE="function_return",x.PAUSE_UNTIL_TYPE="pxt_pause_until",x.COLLAPSED_BLOCK="pxt_collapsed_block",x.FUNCTION_DEFINITION_TYPE="function_definition",x.BINARY_JS="binary.js",x.BINARY_ASM="binary.asm",x.BINARY_HEX="binary.hex",x.BINARY_UF2="binary.uf2",x.BINARY_ELF="binary.elf",x.BINARY_PXT64="binary.pxt64",x.BINARY_ESP="binary.bin",x.BINARY_SRCMAP="binary.srcmap",x.NATIVE_TYPE_THUMB="thumb",x.NATIVE_TYPE_VM="vm",x.BLOCK_TRANSLATION_CACHE_KEY="_blocks",x.BuildSourceMapHelpers=function(i,t,r){let s={ts:(u=e=>{let t=e.split("\n").map(e=>e.length),r=t.reduce(({lens:e,sum:t},r)=>({lens:[...e,t+r+1],sum:t+r+1}),{lens:[],sum:0}).lens;return{posToLineCol:n=>{var e=r.reduce((e,t,r)=>n<t?e:r+1,0);return[e,t[e]-(r[e]-n)+1]},lineColToPos:(e,t)=>(r[e-1]||0)+t}})(t),py:u(r)},a=e=>e.endPos-e.startPos,n=(e,t)=>{let{startPos:r,endPos:n}=e;return i.filter(e=>e[t].startPos<=r&&n<=e[t].endPos)},o=(e,r)=>{e=n(e,r);return e.reduce((e,t)=>a(t[r])<a(e[r])?t:e,e[0])};const e={allOverlaps:e=>n(e,"ts"),smallestOverlap:e=>o(e,"ts")},l={allOverlaps:e=>n(e,"py"),smallestOverlap:e=>o(e,"py")};var c=(u=(n,i)=>e=>{e=e;var t,[e,r]=[s[n].lineColToPos(e.line,e.column),e.length],r=e+r,e=o({startPos:e,endPos:r},n);if(e)return[r,t]=s[i].posToLineCol(e[i].startPos),{fileName:"main."+i,start:e[i].startPos,length:a(e[i]),line:r,column:t}})("ts","py"),u=u("py","ts");return{ts:Object.assign(Object.assign(Object.assign({},s.ts),e),{locToLoc:c,getText:e=>t.substring(e.startPos,e.endPos)}),py:Object.assign(Object.assign(Object.assign({},s.py),l),{locToLoc:u,getText:e=>r.substring(e.startPos,e.endPos)})}},x.computeUsedParts=function(t,e,r=!1){if(!t.usedSymbols||!pxt.appTarget.simulator||!r&&!pxt.appTarget.simulator.parts)return[];let n=(e,t)=>{e&&(e=e.split(/[ ,]+/g),t.push(...e.filter(e=>!!e&&t.indexOf(e)<0)))},i=[],s=[];if(Object.keys(t.usedSymbols).forEach(e=>{e=t.usedSymbols[e];n(null==e?void 0:e.attributes.parts,i),n(null==e?void 0:e.attributes.hiddenParts,s)}),e){let t=pxt.appTarget.simulator.boardDefinition.onboardComponents;t&&("ignorebuiltin"===e?i=i.filter(e=>-1===t.indexOf(e)):"onlybuiltin"===e&&(i=i.filter(e=>0<=t.indexOf(e))))}return(i=i.filter(e=>s.indexOf(e)<0)).sort(),i=i.reverse()},x.buildSimJsInfo=function(e){return{js:e.outfiles[x.BINARY_JS],targetVersion:pxt.appTarget.versions.target,fnArgs:e.usedArguments,parts:x.computeUsedParts(e,"ignorebuiltin"),usedBuiltinParts:x.computeUsedParts(e,"onlybuiltin"),allParts:x.computeUsedParts(e,void 0,!0),breakpoints:null==(e=e.breakpoints)?void 0:e.map(e=>e.id)}},x.blocksCategory=function(e){return(e=e?e.attributes.blockNamespace||e.namespace:void 0)?x.Util.capitalize(e.split(".")[0]):void 0},x.getBlocksInfo=function(e,t){let r,n,h=[],m={},g={},f={};var i,s,a,o,l={},c={};function u(r,n){var i="get"==r,s="set"==r,a="number"==n.retType,o=i?g:s?m:f,l=n.namespace+"."+n.retType;let c=x.U.lookup(o,l);if(!c){var u=`@${r}@`;let e,t;n.attributes.blockCombineShadow&&(d=(p=n.attributes.blockCombineShadow).match(/^([^,.]*),?([^,.]*)$/))&&3==d.length&&(e=d[1].trim(),0!=(t=d[2].trim()).length||x.Util.endsWith(p,",")||(t=e,e=""));var d=(n.attributes.blockSetVariable||n.namespace.toLocaleLowerCase())+"="+(e||""),p="value="+(t||"");(c=o[l]={attributes:{blockId:`${a?n.namespace:l}_blockCombine_`+r,callingConvention:0,group:n.attributes.group,paramDefl:{},jsDoc:i?x.U.lf("Read value of a property on an object"):x.U.lf("Update value of property on an object")},name:u,namespace:n.namespace,fileName:n.fileName,qName:l+"."+u,pkg:n.pkg,kind:2,parameters:[{name:"property",description:i?x.U.lf("the name of the property to read"):x.U.lf("the name of the property to change"),isEnum:!0,type:"@combined@"},{name:"value",description:s?x.U.lf("the new value of the property"):x.U.lf("the amount by which to change the property"),type:n.retType}].slice(0,i?1:2),retType:i?n.retType:"void",combinedProperties:[]}).attributes.block=i?`%${d} %property`:s?x.U.lf("set %{0} %property to %{1}",d,p):x.U.lf("change %{0} %property by %{1}",d,p),S(c.attributes),pxt.Util.isTranslationMode()&&(c.attributes.translationId=c.attributes.block,c.attributes.block=i?`%${d} %property`:s?`set %${d} %property to %`+p:`change %${d} %property by %`+p,S(c.attributes),pxt.crowdin.inContextLoadAsync(c.attributes.translationId).then(e=>{c.attributes.block=e,S(c.attributes)})),h.push(c)}c.combinedProperties.push(n.qName)}for(i of x.Util.values(e.byQName)){if("ENUM_GET"===i.attributes.shim&&i.attributes.enumName&&i.attributes.blockId){let e=!1;if(l[i.attributes.enumName]&&(pxt.warn(`Enum block ${i.attributes.blockId} trying to overwrite enum `+i.attributes.enumName),e=!0),i.attributes.enumMemberName||(pxt.warn(`Enum block ${i.attributes.blockId} should specify enumMemberName`),e=!0),i.attributes.enumPromptHint||(pxt.warn(`Enum block ${i.attributes.blockId} should specify enumPromptHint`),e=!0),i.attributes.enumInitialMembers&&i.attributes.enumInitialMembers.length||(pxt.warn(`Enum block ${i.attributes.blockId} should specify enumInitialMembers`),e=!0),e)continue;var d=parseInt(i.attributes.enumStartValue);l[i.attributes.enumName]={blockId:i.attributes.blockId,name:i.attributes.enumName,memberName:i.attributes.enumMemberName,firstValue:isNaN(d)?void 0:d,isBitMask:i.attributes.enumIsBitMask,isHash:i.attributes.enumIsHash,initialMembers:i.attributes.enumInitialMembers,promptHint:i.attributes.enumPromptHint}}if("KIND_GET"===i.attributes.shim&&i.attributes.blockId){var p=i.attributes.kindNamespace||i.attributes.blockNamespace||i.namespace;if(c[p]){pxt.warn("More than one block defined for kind "+p);continue}var _=[];if(e.byQName[p])for(var y of x.Util.values(e.byQName))y.namespace===p&&y.attributes.isKind&&_.push(y.name);c[p]={blockId:i.attributes.blockId,name:p,memberName:i.attributes.kindMemberName||p,initialMembers:_,promptHint:i.attributes.enumPromptHint||x.Util.lf("Create a new kind..."),createFunctionName:i.attributes.kindCreateFunction||"create"}}if(i.attributes.blockCombine)/@set/.test(i.name)||u("get",i),i.isReadOnly||("number"==i.retType&&u("change",i),u("set",i));else if(i.attributes.block&&!i.attributes.fixedInstance&&7!=i.kind&&5!=i.kind&&9!=i.kind&&8!=i.kind&&!i.attributes.blockIdentity){if(i.attributes.blockId||(i.attributes.blockId=i.qName.replace(/\./g,"_")),"true"==i.attributes.block){let e=x.U.uncapitalize(i.name);1!=i.kind&&2!=i.kind||(e+=" %"+i.namespace.toLowerCase());for(s of null!=(n=null==(r=i.parameters)?void 0:r.filter(e=>!E(e)))?n:[])e+=" %"+s.name;i.attributes.block=e,S(i.attributes)}h.push(i)}}for(a of h){var b=x.U.lookup(e.byQName,a.namespace);if(b){var v,T=b.attributes,k=a.attributes;for(v of["blockNamespace","color","blockGap"])void 0===k[v]&&T[v]&&(k[v]=T[v])}}return{apis:e,blocks:h=t&&(o=t).length?h.filter(e=>{e=(e.attributes.blockNamespace||e.namespace).split(".")[0];return-1===o.indexOf(e)}):h,blocksById:pxt.Util.toDictionary(h,e=>e.attributes.blockId),enumsByName:l,kindsByName:c}},x.tsSnippetToPySnippet=function(e,t){var r={true:"True",false:"False",null:"None"}[e];return r||(t&&6==t.kind||!t&&e.includes(".")?(r=e.lastIndexOf("."),t=e.substr(0,r),r=e.substr(r+1),r=x.U.snakify(r).toUpperCase(),t?t+"."+r:r):e)},x.apiLocalizationStrings={},x.localizeApisAsync=async function(u,e){let d=x.Util.userLanguage();if("en"==d)return Promise.resolve(t(u));let p=d.toLowerCase(),h=p+"|jsdoc",m=p+"|block",g=await e.localizationStringsAsync(d);return x.apiLocalizationStrings&&x.Util.jsonMergeFrom(g,x.apiLocalizationStrings),e=x.Util.values(u.byQName).filter(e=>e.attributes._translatedLanguageCode!==d),await x.Util.promiseMapAll(e,async n=>{var e=n.attributes.useLoc||n.attributes.blockAliasFor;let i=e&&u.byQName[e],r=(n.attributes._untranslatedJsDoc&&(n.attributes.jsDoc=n.attributes._untranslatedJsDoc),n.attributes._untranslatedBlock&&(n.attributes.jsDoc=n.attributes._untranslatedBlock),(e,t)=>{var r;return g[n.qName+e]||(null==(r=n.attributes.locs)?void 0:r[t])||i&&(g[i.qName+e]||(null==(r=i.attributes.locs)?void 0:r[t]))});var e=r("",h),e=(e&&(n.attributes._untranslatedJsDoc||(n.attributes._untranslatedJsDoc=n.attributes.jsDoc),n.attributes.jsDoc=e),null!=(e=n.parameters)&&e.forEach(e=>{var t="|param|"+e.name,t=r(t,p+t);t&&(e.description=t)}),g["{id:category}"+x.Util.capitalize(n.qName)]);let t=g[n.qName+"|block"]||(null==(l=n.attributes.locs)?void 0:l[m]);if(n.attributes.block){var s,a,o,l=pxt.blocks.compileInfo(n);if(l.handlerArgs)for(var c of l.handlerArgs)g[c.localizationKey]?(o=a=s=void 0,s=c.localizationKey,a=g[c.localizationKey],(o=pxt.Util.translationsCache())[x.BLOCK_TRANSLATION_CACHE_KEY]||(o[x.BLOCK_TRANSLATION_CACHE_KEY]={}),o[x.BLOCK_TRANSLATION_CACHE_KEY][s]=a):(o=c.localizationKey,s=void 0,(s=pxt.Util.translationsCache())[x.BLOCK_TRANSLATION_CACHE_KEY]&&delete s[x.BLOCK_TRANSLATION_CACHE_KEY][o])}(t=!t&&i&&(l=g[i.qName+"|block"]||(null==(l=i.attributes.locs)?void 0:l[m]),n.attributes.block===(i.attributes._untranslatedBlock||i.attributes.block))&&l?l:t)&&pxt.Util.isTranslationMode()&&(n.attributes.translationId=t,t=await pxt.crowdin.inContextLoadAsync(t)),e?(n.attributes.block?n.attributes.block=t||n.attributes.block:n.attributes.block=e,S(n.attributes)):n.attributes.block&&t?(l=pxt.blocks.compileInfo(n),e=n.attributes.block,n.attributes.block=pxt.blocks.normalizeBlock(t,e=>{pxt.tickEvent("loc.normalized",{block:n.attributes.block,lang:d,error:e})}),n.attributes._untranslatedBlock||(n.attributes._untranslatedBlock=e),e!=n.attributes.block&&(S(n.attributes),((e,t)=>{if(e.parameters.length==t.parameters.length){for(var r of e.parameters){var n=t.actualNameToParam[r.actualName];if(!n||r.type!=n.type||r.shadowBlockId!=n.shadowBlockId||r.definitionName!=n.definitionName)return void pxt.debug(`Parameter ${r.actualName} type, shadow block, or definition name does not match after localization`)}return 1}pxt.debug("Localized block has extra or missing parameters")})(l,pxt.blocks.compileInfo(n))||(pxt.reportError("loc.errors","block has non matching arguments",{block:n.attributes.blockId,lang:d,originalDefinition:e,translatedBlock:n.attributes.block}),pxt.tickEvent("loc.errors",{block:n.attributes.blockId,lang:d}),n.attributes.block=e,S(n.attributes)))):S(n.attributes),n.attributes._translatedLanguageCode=d}),t(u)},x.getBlockTranslationsCacheKey=function(e){var t=pxt.Util.translationsCache();if(t[x.BLOCK_TRANSLATION_CACHE_KEY])return t[x.BLOCK_TRANSLATION_CACHE_KEY][e]},x.emptyExtInfo=function(){let e=pxt.appTarget.compileService;var t=!!(e=e||{}).platformioIni,r="dockermake"==e.buildEngine||"dockercross"==e.buildEngine||"dockerespidf"==e.buildEngine,n={functions:[],generatedFiles:{},extensionFiles:{},sha:"",compileData:"",shimsDTS:"",enumsDTS:"",onlyPublic:!0};return t?n.platformio={dependencies:{}}:r?n.npmDependencies={}:n.yotta={config:{},dependencies:{}},n};let n=["weight","imageLiteral","gridLiteral","topblockWeight","inlineInputModeLimit"],i=["advanced","handlerStatement","forceStatement","afterOnStart","optionalVariableArgs","blockHidden","constantShim","blockCombine","enumIsBitMask","enumIsHash","decompileIndirectFixedInstances","topblock","callInDebugger","duplicateShadowOnDrag","argsNullable","compileHiddenArguments","expandArgumentsInToolbox"];function E(e){return"Action"===e.type||/^\([^\)]*\)\s*=>/.test(e.type)}function S(r){var e;function t(e){return r._shadowOverrides&&e.parameters.forEach(e=>{var t=r._shadowOverrides[e.name];"unset"===t?delete e.shadowBlockId:null!=t&&(e.shadowBlockId=t)}),e}r.block&&(e=r.block.split("||"),r._def=t(s(e[0])),r._def||pxt.debug("Unable to parse block def for id: "+r.blockId),e[1]&&(r._expandedDef=t(s(e[1]))),e[1])&&!r._expandedDef&&pxt.debug("Unable to parse expanded block def for id: "+r.blockId)}function s(n){var i=[];let e,s=0;for(;s<n.length;s++){let t=n[s];var a=s;let r;switch(t){case"*":case"_":var o=_(e=>e==t),l="_"===t?2:0;1===o.length?r={kind:1<<l,content:o}:2===o.length?r={kind:2<<l,content:o}:3===o.length?r={kind:3<<l,content:o}:s=a;break;case"`":l=y("`");void 0===l?s=a:r={kind:256,content:l};break;case"|":r={kind:32};break;case"\\":s<n.length-1&&(r={kind:16,content:n[1+s++]});break;case"[":o=y("]");if(void 0!==o&&"("===n[1+s++]){var c=y(")");if(void 0!==c){r={kind:512,content:o,type:c};break}}s=a;break;case"$":case"%":var u,c=_(e=>/[a-zA-Z0-9_=]/.test(e),!0).split("=");if(2<c.length)s=a;else{let e;"("!==n[s+1]||(u=s,++s,e=y(")"))||(s=u),r={kind:"$"===t?1024:64,content:c[0],type:c[1],name:e}}}r?(e&&i.push({kind:128,content:e}),e=void 0,i.push(r)):e?e+=t:e=t}e&&i.push({kind:128,content:e});let r=[];var t=[];let d=[],p=0,h="",m=[];for(let e=0;e<i.length;e++){var g=i[e].kind,f=d[d.length-1];15&g?(T(i[e].content),g&p?f&g?(d.pop(),(f=f&(p^=g)|g&p)&&d.push(f)):b():(p|=g,d.push(g))):144&g?h+=i[e].content:1120&g&&v(),64==g?(f={kind:"param",name:i[e].content,shadowBlockId:i[e].type,ref:!1},i[e].name&&(f.varName=i[e].name),r.push(f),t.push(f)):1024==g?(f={kind:"param",name:i[e].content,shadowBlockId:i[e].type,ref:!0},i[e].name&&(f.varName=i[e].name),r.push(f),t.push(f)):256==g?(T(),m.push({kind:"image",uri:i[e].content})):512==g?(T(),m.push({kind:"label",text:i[e].content,cssClass:i[e].type})):32==g&&r.push({kind:"break"})}return v(),{parts:r,parameters:t};function _(e,t=!1){let r="";for(t&&s++;s<n.length&&e(n[s]);)r+=n[s],++s;return r&&s--,r}function y(t){var e=_(e=>e!==t,!0);if(n[s+1]===t)return++s,e}function b(){let e="";var t,r=[];for(t of m)t.kind?(r.push({content:e,styles:0}),r.push(t),e=""):(e+=t.content,t.endingToken&&(e+=t.endingToken));m=r,e&&m.push({content:e,styles:0}),d=[],p=0}function v(){for(T(),p&&b();m.length;){var e,t=m.shift();t.kind?r.push(t):t.content&&(e=[],10&t.styles&&e.push("bold"),5&t.styles&&e.push("italics"),r.push({kind:"label",text:t.content,style:e}))}}function T(e){m.push({content:h,styles:p,endingToken:e}),h=""}}function h(t){var r=e=>t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24)>>>0;if(!t||512!=t.length||r(0)!=u.UF2_MAGIC_START0||r(4)!=u.UF2_MAGIC_START1||r(t.length-4)!=u.UF2_MAGIC_END)return null;var e=r(8);let n=r(16),i=(476<n&&(n=256),null),s=0,a=0;if(e&u.UF2_FLAG_FILE){let e=t.slice(32+n);var o=e.indexOf(0);0<=o&&(e=e.slice(0,o)),i=x.U.fromUTF8Array(e),a=r(28)}return e&u.UF2_FLAG_FAMILY_ID_PRESENT&&(s=r(28)),{flags:e,targetAddr:r(12),payloadSize:n,blockNo:r(20),numBlocks:r(24),fileSize:a,familyId:s,data:t.slice(32,32+n),filename:i}}function a(e,t){return!!e&&e.targetAddr<=t&&t<e.targetAddr+e.payloadSize}function d(e,t,r){e[t]=255&r,e[t+1]=r>>8&255,e[t+2]=r>>16&255,e[t+3]=r>>24&255}function o(e){return{currBlock:null,currPtr:-1,blocks:[],ptrs:[],filesize:0,familyId:(e="string"==typeof e?parseInt(e):e)||0}}function l(t){for(let e=0;e<t.blocks.length;++e)d(t.blocks[e],20,e),d(t.blocks[e],24,t.blocks.length),t.filename&&d(t.blocks[e],28,t.filesize)}function p(t,e,r,n=0){let i=t.currBlock;var s=e>>8;let a=256-(255&e);if(r.length>a){var o=new Uint8Array(r);for(p(t,e,o.slice(0,a));a<r.length;){var l=Math.min(a+256,r.length);p(t,e+a,o.slice(a,l)),a=l}}else{if(s!=t.currPtr){i=null;for(let e=0;e<t.ptrs.length;++e)if(t.ptrs[e]==s){i=t.blocks[e];break}if(!i){i=new Uint8Array(512),t.filename?n|=u.UF2_FLAG_FILE:t.familyId&&(n|=u.UF2_FLAG_FAMILY_ID_PRESENT),d(i,0,u.UF2_MAGIC_START0),d(i,4,u.UF2_MAGIC_START1),d(i,8,n),d(i,12,s<<8),d(i,16,256),d(i,20,t.blocks.length),d(i,28,t.familyId),d(i,508,u.UF2_MAGIC_END);for(let e=32;e<288;++e)i[e]=255;t.filename&&x.U.memcpy(i,288,x.U.toUTF8Array(t.filename)),t.blocks.push(i),t.ptrs.push(s)}t.currPtr=s,t.currBlock=i}var c=32+(255&e);for(let e=0;e<r.length;++e)i[c+e]=r[e];t.filesize=Math.max(t.filesize,r.length+e)}}x.parseCommentString=function(e){let l={paramDefl:{},callingConvention:0,_source:e},c=!0;for(;c;)c=!1,e=e.replace(/\/\/%[ \t]*([\w\.-]+)(=(("[^"\n]*")|'([^'\n]*)'|([^\s]*)))?/,(e,t,r,n,i,s,a)=>{let o=i?JSON.parse(i):r?i||s||a:"true";return o=o||"",x.U.startsWith(t,"block.loc.")?(l.locs||(l.locs={}),l.locs[t.slice("block.loc.".length).toLowerCase()+"|block"]=o):x.U.startsWith(t,"jsdoc.loc.")?(l.locs||(l.locs={}),l.locs[t.slice("jsdoc.loc.".length).toLowerCase()+"|jsdoc"]=o):x.U.contains(t,".loc.")?(l.locs||(l.locs={}),r=t.slice(0,t.indexOf(".loc.")),i=t.slice(t.indexOf(".loc.")+".loc.".length),l.locs[i+"|param|"+r]=o):x.U.endsWith(t,".defl")?(-1<o.indexOf(" ")?l.paramDefl[t.slice(0,t.length-5)]=`"${o}"`:l.paramDefl[t.slice(0,t.length-5)]=o,l.explicitDefaults||(l.explicitDefaults=[]),l.explicitDefaults.push(t.slice(0,t.length-5))):x.U.endsWith(t,".shadow")?(l._shadowOverrides||(l._shadowOverrides={}),l._shadowOverrides[t.slice(0,t.length-7)]=o):x.U.endsWith(t,".snippet")?(l.paramSnippets||(l.paramSnippets={}),s=t.slice(0,t.length-8),l.paramSnippets[s]||(l.paramSnippets[s]={}),l.paramSnippets[s].ts=o):x.U.endsWith(t,".pySnippet")?(l.paramSnippets||(l.paramSnippets={}),a=t.slice(0,t.length-10),l.paramSnippets[a]||(l.paramSnippets[a]={}),l.paramSnippets[a].python=o):x.U.endsWith(t,".fieldEditor")?(l.paramFieldEditor||(l.paramFieldEditor={}),l.paramFieldEditor[t.slice(0,t.length-12)]=o):x.U.contains(t,".fieldOptions.")?(l.paramFieldEditorOptions||(l.paramFieldEditorOptions={}),i=t.slice(0,t.indexOf(".fieldOptions.")),r=t.slice(t.indexOf(".fieldOptions.")+14,t.length),l.paramFieldEditorOptions[i]||(l.paramFieldEditorOptions[i]={}),l.paramFieldEditorOptions[i][r]=o):x.U.contains(t,".shadowOptions.")?(l.paramShadowOptions||(l.paramShadowOptions={}),s=t.slice(0,t.indexOf(".shadowOptions.")),a=t.slice(t.indexOf(".shadowOptions.")+15,t.length),l.paramShadowOptions[s]||(l.paramShadowOptions[s]={}),l.paramShadowOptions[s][a]=o):x.U.endsWith(t,".min")?(l.paramMin||(l.paramMin={}),l.paramMin[t.slice(0,t.length-4)]=o):x.U.endsWith(t,".max")?(l.paramMax||(l.paramMax={}),l.paramMax[t.slice(0,t.length-4)]=o):l[t]=o,c=!0,"//% "});for(var t of n)"string"==typeof l[t]&&(l[t]=parseInt(l[t]));for(var r of i)"string"==typeof l[r]&&(l[r]="true"==l[r]||"1"==l[r]);if(l.trackArgs&&(l.trackArgs=l.trackArgs.split(/[ ,]+/).map(e=>parseInt(e)||0)),l.enumInitialMembers&&(l.enumInitialMembers=l.enumInitialMembers.split(/[ ,]+/)),l.blockExternalInputs&&!l.inlineInputMode&&(l.inlineInputMode="external"),l.paramHelp={},l.jsDoc="",e=e.replace(/\/\*\*([^]*?)\*\//g,(e,t)=>(t=(t=t.replace(/\n\s*(\*\s*)?/g,"\n")).replace(/^\s*@param\s+(\w+)\s+(.*)$/gm,(e,t,r)=>{if(l.paramHelp[t]=r,!l.paramDefl[t]){r=/\beg\.?:\s*(.+)/.exec(r);if(r&&r[1]){r=/(?:"([^"]*)")|(?:'([^']*)')|(?:([^\s,]+))/g.exec(r[1]);if(r){let e=r[1]||r[2]||r[3];-1<(e=e||"").indexOf(" ")?l.paramDefl[t]=`"${e}"`:l.paramDefl[t]=e}}}return""}),l.jsDoc+=t,"")),l.jsDoc=l.jsDoc.trim(),l.async&&(l.callingConvention=1),l.promise&&(l.callingConvention=2),l.jres&&(l.whenUsed=!0),l.subcategories)try{l.subcategories=JSON.parse(l.subcategories)}catch(e){l.subcategories=void 0}if(l.groups)try{l.groups=JSON.parse(l.groups)}catch(e){l.groups=void 0}if(l.groupIcons)try{l.groupIcons=JSON.parse(l.groupIcons)}catch(e){l.groupIcons=void 0}if(l.groupHelp)try{l.groupHelp=JSON.parse(l.groupHelp)}catch(e){l.groupHelp=void 0}return S(l),l},x.parameterTypeIsArrowFunction=E,x.updateBlockDef=S,x.parseBlockDefinition=s,x.parseChecksumBlock=function(t,r=0){var e=pxt.HF2.read32(t,r);if(133083260!=(2147483647&e))return pxt.log("no checksum block magic"),null;var n=pxt.HF2.read32(t,r+4),i=pxt.HF2.read32(t,r+8);if(3&n)return pxt.log("invalid end marker position"),null;var s=1<<(255&i);if(s!=pxt.appTarget.compile.flashCodeAlign)return pxt.log("invalid page size: "+s),null;var a={magic:e,endMarkerPos:n,endMarker:i,regions:[]};for(let e=r+12;e<t.length-7;e+=8){var o={start:s*pxt.HF2.read16(t,e),length:s*pxt.HF2.read16(t,e+2),checksum:pxt.HF2.read32(t,e+4)};if(!o.length||!o.checksum)break;a.regions.push(o)}return a},(u=x.UF2||(x.UF2={})).UF2_MAGIC_START0=171066965,u.UF2_MAGIC_START1=2656915799,u.UF2_MAGIC_END=179400496,u.UF2_FLAG_NONE=0,u.UF2_FLAG_NOFLASH=1,u.UF2_FLAG_FILE=4096,u.UF2_FLAG_FAMILY_ID_PRESENT=8192,u.parseBlock=h,u.parseFile=function(t){var r=[];for(let e=0;e<t.length;e+=512){var n=h(t.slice(e,e+512));n&&r.push(n)}return r},u.toBin=function(t,r=void 0){if(t.length<512)return null;let n=-1,i=-1;var e,s=[];for(let e=0;e<t.length;++e){var a=512*e,o=h(t.slice(a,512+a));if(o){if(r&&o.targetAddr+256>r)break;-1==n&&(n=o.targetAddr,i=n);var l=o.targetAddr-n;l<0||l%4||1048576<l||(0<l&&s.push(new Uint8Array(l)),s.push(t.slice(32+a,32+a+o.payloadSize)),n=o.targetAddr+o.payloadSize)}}let c=0;for(e of s)c+=e.length;if(0==c)return null;var u,d=new Uint8Array(c);let p=0;for(u of s)for(let e=0;e<u.length;++e)d[p++]=u[e];return{buf:d,start:i}},u.readBytes=function(t,r,n){var i=new Uint8Array(n);let s;for(let e=0;e<n;++e,++r)(s=a(s,r)?s:t.filter(e=>a(e,r))[0])&&(i[e]=s.data[r-s.targetAddr]);return i},u.newBlockFile=o,u.finalizeFile=l,u.concatFiles=function(e){for(var t of e)l(t),t.filename=null;var r,n=o();n.blocks=x.U.concat(e.map(e=>e.blocks));for(r of e)r.blocks=[];return n},u.serializeFile=function(e){l(e);let t="";for(var r of e.blocks)t+=x.Util.uint8ArrayToString(r);return t},u.readBytesFromFile=function e(t,r,n){var i,s,a=r>>8;let o;if(a==t.currPtr)o=t.currBlock;else{for(let e=0;e<t.ptrs.length;++e)if(t.ptrs[e]==a){o=t.blocks[e];break}o&&(t.currPtr=a,t.currBlock=o)}return o?(i=new Uint8Array(n),s=Math.min(n,256-(255&r)),x.U.memcpy(i,0,o,32+(255&r),s),0<(n-=s)&&(r=e(t,r+s,n),x.U.memcpy(i,s,r)),i):null},u.writeBytes=p,u.writeHex=function(t,r){let n="0000";for(let e=0;e<r.length;++e){var i=/:02000004(....)/.exec(r[e]);if(i&&(n=i[1]),i=/^:..(....)00(.*)[0-9A-F][0-9A-F]$/.exec(r[e])){var s=parseInt(n+i[1],16),a=i[2],o=[];for(let e=0;e<a.length;e+=2)o.push(parseInt(a[e]+a[e+1],16));p(t,s,o)}}}}})(ts=ts||{}),(e=>{(e=(e=(e=e.pxtc||(e.pxtc={})).service||(e.service={})).ExtensionType||(e.ExtensionType={}))[e.Bundled=1]="Bundled",e[e.Github=2]="Github",e[e.ShareScript=3]="ShareScript"})(ts=ts||{}),(p=>{var e;{var t=p.shell||(p.shell={});let a;(e=a=t.EditorLayoutType||(t.EditorLayoutType={}))[e.IDE=0]="IDE",e[e.Sandbox=1]="Sandbox",e[e.Widget=2]="Widget",e[e.Controller=3]="Controller";let o;(e=o=t.ControllerMode||(t.ControllerMode={}))[e.None=0]="None",e[e.Basic=1]="Basic",e[e.App=2]="App";let l,c=o.None,u=!1,d=!1;function r(){if(void 0===l){if(p.BrowserUtils.hasWindow()){var e=/sandbox=1|#sandbox|#sandboxproject/i.test(window.location.href)||p.BrowserUtils.isIFrame(),t=/nosandbox=1/i.test(window.location.href),r=/controller=(0|1|2)/i.exec(window.location.href),r=(c=r&&p.BrowserUtils.isIFrame()?parseInt(r[1]):c)!==o.None,n=/readonly=1/i.test(window.location.href),i=/editorlayout=(widget|sandbox|ide)/i.exec(window.location.href),s=/noproject=1/i.test(window.location.href);if(l=a.IDE,t?l=a.Widget:r?l=a.Controller:e&&(l=a.Sandbox),r&&n&&(u=!0),r&&s&&(d=!0),i)switch(i[1].toLowerCase()){case"widget":l=a.Widget;break;case"sandbox":l=a.Sandbox;break;case"ide":l=a.IDE}}else l=a.Sandbox;p.debug(`shell: layout type ${a[l]}, readonly `+h())}}function n(){return r(),l==a.Sandbox}function i(){return/[?&]timeMachine=1/i.test(window.location.href)}function h(){return!p.BrowserUtils.hasWindow()||i()||n()&&!/[?&]edit=1/i.test(window.location.href)||s()&&u}function s(){return r(),l==a.Controller}t.layoutTypeClass=function(){return r(),p.shell.EditorLayoutType[l].toLowerCase()},t.isSandboxMode=n,t.isTimeMachineEmbed=i,t.isReadOnly=h,t.isNoProject=function(){return d},t.isControllerMode=s,t.getControllerMode=function(){return r(),c},t.isPyLangPref=function(){return"py"==p.storage.getLocal("editorlangpref")},t.getEditorLanguagePref=function(){return p.storage.getLocal("editorlangpref")},t.setEditorLanguagePref=function(e){e.match(/prj$/)&&(e=e.replace(/prj$/,"")),p.storage.setLocal("editorlangpref",e)},t.getToolboxAnimation=function(){return p.storage.getLocal("toolboxanimation")},t.setToolboxAnimation=function(){p.storage.setLocal("toolboxanimation","1")},t.hasHomeScreen=function(){return!p.shell.isControllerMode()&&!p.appTarget.appTheme.lockedEditor}}})(pxt=pxt||{}),(e=>{{var t=e.skillmap||(e.skillmap={});t.USER_VERSION="0.0.1";class r{constructor(){this.db=new e.BrowserUtils.IDBWrapper(r.databaseName,r.version,(e,t)=>{t=t.result;e.oldVersion<1&&(t.createObjectStore(r.projectTable,{keyPath:r.projectKey}),t.createObjectStore(r.userTable,{keyPath:r.userKey}))})}initAsync(){return this.db.openAsync()}getAllProjectsAsync(){return this.db.getAllAsync(r.projectTable).then(e=>e.map(e=>e.project).filter(e=>!e.deleted))}deleteProjectAsync(e){return this.getProjectAsync(e).then(e=>{e.deleted=!0,this.saveProjectAsync(e)})}getProjectAsync(e){return this.db.getAsync(r.projectTable,e).then(e=>null==e?void 0:e.project)}saveProjectAsync(e){return this.db.setAsync(r.projectTable,{id:e.header.id,project:e})}getUserStateAsync(){return this.db.getAsync(r.userTable,"local-user").then(e=>null==e?void 0:e.user)}saveUserStateAsync(e){return this.db.setAsync(r.userTable,{id:"local-user",user:e})}}r.version=6,r.databaseName="local-skill-map",r.projectTable="projects",r.projectKey="id",r.userTable="users",r.userKey="id",t.IndexedDBWorkspace=r}})(pxt=pxt||{}),(e=>{{var _=e.assets||(e.assets={});_.MAX_FREQUENCY=5e3,_.MAX_VOLUME=255,_.renderSoundPath=function(e,t,r){let{startFrequency:n,endFrequency:i,startVolume:s,endVolume:a,wave:o,interpolation:l}=e,c=(n=Math.max(Math.min(n,_.MAX_FREQUENCY),1),i=Math.max(Math.min(i,_.MAX_FREQUENCY),1),s=Math.max(Math.min(s,_.MAX_VOLUME),0),a=Math.max(Math.min(a,_.MAX_VOLUME),0),new b(n+i+1)),u;switch(l){case"linear":u=e=>n+e*(i-n)/t;break;case"curve":u=e=>n+(i-n)*Math.sin(e/t*(Math.PI/2));break;case"logarithmic":u=e=>n+Math.log10(1+e/t*9)*(i-n)}"noise"===o&&(u=()=>c.randomRange(500,5e3));var d=e=>Math.max(Math.min((a-s)/t*e+s,_.MAX_VOLUME),0);let p=t/2;var h=e=>e/_.MAX_VOLUME*(r-2)/2,m=e=>(1-e/_.MAX_FREQUENCY)*(p-10)+10,g=["M 2 "+r/2];let f=0;for(;f<t;)g.push(y(h(d(f)),m(u(f))/2,o,!1,c)),f+=m(u(f))/2,g.push(y(h(d(f)),m(u(f))/2,o,!0,c)),f+=m(u(f))/2;return g.join(" ")},_.renderWaveSnapshot=function(e,t,r,n,i,s){var a=new b(e),o=("noise"===r&&(e=a.randomRange(500,5e3)),e=Math.max(Math.min(e,_.MAX_FREQUENCY),1),t/_.MAX_VOLUME*(i-2)/2),l=n/(e*s/1e3)/2;let c=Math.ceil(n/(2*l));c%2==1&&c++;var u=[`M ${n/2-c*l} `+i/2];let d=0;for(let e=0;e<c;e++)u.push(y(o,l,r,!1,a)),d+=l,u.push(y(o,l,r,!0,a)),d+=l;return u.join(" ")};class b{constructor(e){this.seed=e,this.lfsr=e}next(){return(this.lfsr=this.lfsr>>1^46080&-(1&this.lfsr))/65535}randomRange(e,t){return e+(t-e)*this.next()}}function y(n,i,e,s,a){switch(e){case"triangle":return`l ${i/2} ${s?n:-n} l ${i/2} `+(s?-n:n);case"square":return`v ${s?n:-n} h ${i} v `+(s?-n:n);case"sawtooth":return s?`l ${i} ${n} v `+-n:`v ${-n} l ${i} `+n;case"sine":return`q ${i/2} ${1.9*(s?n:-n)} ${i} 0`;case"noise":var o,l=[],c=[],u=Math.min(4,i/4);let t=s;for(let e=0;e<i;e+=u)c.push(a.randomRange(0,n)*(t?1:-1)),t=!t;c[0]=s?n:-n;let e=c[c.length-1]=0,r=0;for(o of c){var d=Math.min(u,i-r);if(l.push(`v ${o-e} h `+d),e=o,(r+=d)>=i)break}return l.join(" ")}}function g(e,t,r){var n=new Uint8Array(2);new Uint16Array(n.buffer)[0]=0|r,e[t]=n[0],e[t+1]=n[1]}_.soundToInstructionBuffer=function(r,n,i){let{startFrequency:s,endFrequency:a,startVolume:o,endVolume:l,interpolation:e,duration:c}=r;var u=[];if("linear"===r.interpolation&&"none"===r.effect)u.push({frequency:s,volume:o/_.MAX_VOLUME*1024}),u.push({frequency:a,volume:l/_.MAX_VOLUME*1024});else{n=Math.min(n,Math.floor(c/5));let t;switch(e){case"linear":t=e=>s+e*(a-s)/c;break;case"curve":t=e=>s+(a-s)*Math.sin(e/c*(Math.PI/2));break;case"logarithmic":t=e=>s+Math.log10(1+e/c*9)*(a-s)}var d=c/n;for(let e=0;e<n;e++){var p={frequency:Math.max(t(e*d),1),volume:(p=e*d,(o+p*(l-o)/c)/_.MAX_VOLUME*1024)};"tremolo"===r.effect?e%2==0?p.volume=Math.max(p.volume-500*i,0):p.volume=Math.min(p.volume+500*i,1023):"vibrato"===r.effect?e%2==0?p.frequency=Math.max(p.frequency-100*i,1):p.frequency=p.frequency+100*i:"warble"===r.effect&&(e%2==0?p.frequency=Math.max(p.frequency-1e3*i,1):p.frequency=p.frequency+1e3*i),u.push(p)}}var t=new Uint8Array(12*(u.length-1)),h=Math.floor(c/(u.length-1));for(let e=0;e<u.length-1;e++){var m=12*e;t[m]=(e=>{switch(e){case"square":return 15;case"sine":return 3;case"triangle":return 1;case"noise":return 18;case"sawtooth":return 2}})(r.wave),g(t,2+m,u[e].frequency),g(t,4+m,h),g(t,6+m,u[e].volume),g(t,8+m,u[e+1].volume),g(t,10+m,u[e+1].frequency)}return t}}})(pxt=pxt||{}),(r=>{var e;(e=r.streams||(r.streams={})).createStreamAsync=function(e,t){return r.Cloud.privatePostAsync("streams",{target:e,name:t||"data"}).then(e=>e)},e.postPayloadAsync=function(e,t){return r.Util.assert(!!e.privatekey),r.Cloud.privatePostAsync(e.id+"/data?privatekey="+e.privatekey,t)}})(pxt=pxt||{}),(r=>{var e;{var i=r.svgUtil||(r.svgUtil={});let t;(e=t=i.PatternUnits||(i.PatternUnits={}))[e.userSpaceOnUse=0]="userSpaceOnUse",e[e.objectBoundingBox=1]="objectBoundingBox";let n;(e=n=i.LengthUnit||(i.LengthUnit={}))[e.em=0]="em",e[e.ex=1]="ex",e[e.px=2]="px",e[e.in=3]="in",e[e.cm=4]="cm",e[e.mm=5]="mm",e[e.pt=6]="pt",e[e.pc=7]="pc",e[e.percent=8]="percent";class o{constructor(e){this.el=s(e)}attr(t){return Object.keys(t).forEach(e=>{this.setAttribute(e,t[e])}),this}setAttribute(e,t){return this.el.setAttribute(e,t.toString()),this}setAttributeNS(e,t,r){return this.el.setAttributeNS(e,t,r.toString()),this}id(e){return this.setAttribute("id",e)}setClass(...e){return this.setAttribute("class",e.join(" "))}appendClass(e){return r.BrowserUtils.addClass(this.el,e),this}removeClass(e){r.BrowserUtils.removeClass(this.el,e)}title(e){this.titleElement||(this.titleElement=s("title"),this.el.firstChild?this.el.insertBefore(this.titleElement,this.el.firstChild):this.el.appendChild(this.titleElement)),this.titleElement.textContent=e}setVisible(e){return this.setAttribute("visibility",e?"visible":"hidden")}}i.BaseElement=o;class l extends o{draw(e){e=(e=>{switch(e){case"text":return new g;case"circle":return new _;case"rect":return new f;case"line":return new y;case"polygon":return new T;case"polyline":return new v;case"path":return new k;default:return new m(e)}})(e);return this.el.appendChild(e.el),e}element(e,t){return t(this.draw(e)),this}group(){var e=new u;return this.el.appendChild(e.el),e}appendChild(e){this.el.appendChild(e.el)}onDown(e){return i.events.down(this.el,e),this}onUp(e){return i.events.up(this.el,e),this}onMove(e){return i.events.move(this.el,e),this}onEnter(e){return i.events.enter(this.el,e),this}onLeave(e){return i.events.leave(this.el,e),this}onClick(e){return i.events.click(this.el,e),this}}i.DrawContext=l;class c extends l{constructor(e){super("svg"),e&&e.appendChild(this.el)}define(e){return this.defs||(this.defs=new p(this.el)),e(this.defs),this}}i.SVG=c;class u extends l{constructor(e){super("g"),e&&e.appendChild(this.el)}translate(e,t){return this.left=e,this.top=t,this.updateTransform()}scale(e){return this.scaleFactor=e,this.updateTransform()}def(){return new p(this.el)}style(){return new h(this.el)}updateTransform(){let e="";return null!=this.left&&(e+=`translate(${this.left} ${this.top})`),null!=this.scaleFactor&&(e+=` scale(${this.scaleFactor})`),this.setAttribute("transform",e),this}}i.Group=u;class d extends l{constructor(){super("pattern")}units(e){return this.setAttribute("patternUnits",e===t.objectBoundingBox?"objectBoundingBox":"userSpaceOnUse")}contentUnits(e){return this.setAttribute("patternContentUnits",e===t.objectBoundingBox?"objectBoundingBox":"userSpaceOnUse")}size(e,t){return this.setAttribute("width",e),this.setAttribute("height",t),this}}i.Pattern=d;class p extends o{constructor(e){super("defs"),e.appendChild(this.el)}create(e,t){let r;switch(e){case"path":r=new k;break;case"pattern":r=new d;break;case"radialGradient":r=new C;break;case"linearGradient":r=new S;break;case"clipPath":r=new w;break;default:r=new o(e)}return r.id(t),this.el.appendChild(r.el),r}}i.DefsElement=p;class h extends o{constructor(e){super("style"),e.appendChild(this.el)}content(e){this.el.textContent=e}}i.StyleElement=h;class m extends l{at(e,t){return this.setAttribute("x",e),this.setAttribute("y",t),this}moveTo(e,t){return this.at(e,t)}fill(e,t){return this.setAttribute("fill",e),null!=t&&this.opacity(t),this}opacity(e){return this.setAttribute("fill-opacity",e)}stroke(e,t){return this.setAttribute("stroke",e),null!=t&&this.strokeWidth(t),this}strokeWidth(e){return this.setAttribute("stroke-width",e)}strokeOpacity(e){return this.setAttribute("stroke-opacity",e)}clipPath(e){return this.setAttribute("clip-path",e)}}i.Drawable=m;class g extends m{constructor(e){super("text"),null!=e&&this.text(e)}text(e){return this.el.textContent=e,this}fontFamily(e){return this.setAttribute("font-family",e)}fontSize(e,t){return this.setAttribute("font-size",a(e,t))}offset(e,t,r){return 0!==e&&this.setAttribute("dx",a(e,r)),0!==t&&this.setAttribute("dy",a(t,r)),this}anchor(e){return this.setAttribute("text-anchor",e)}}i.Text=g;class f extends m{constructor(){super("rect")}width(e,t=n.px){return this.setAttribute("width",a(e,t))}height(e,t=n.px){return this.setAttribute("height",a(e,t))}corner(e){return this.corners(e,e)}corners(e,t){return this.setAttribute("rx",e),this.setAttribute("ry",t),this}size(e,t,r=n.px){return this.width(e,r),this.height(t,r),this}}i.Rect=f;class _ extends m{constructor(){super("circle")}at(e,t){return this.setAttribute("cx",e),this.setAttribute("cy",t),this}radius(e){return this.setAttribute("r",e)}}i.Circle=_,class extends m{};class y extends m{constructor(){super("line")}at(e,t,r,n){return this.from(e,t),null!=r&&null!=n&&this.to(r,n),this}from(e,t){return this.setAttribute("x1",e),this.setAttribute("y1",t),this}to(e,t){return this.setAttribute("x2",e),this.setAttribute("y2",t),this}}i.Line=y;class b extends m{points(e){return this.setAttribute("points",e)}with(e){return this.points(e.map(({x:e,y:t})=>e+" "+t).join(","))}}i.PolyElement=b;class v extends b{constructor(){super("polyline")}}i.Polyline=v;class T extends b{constructor(){super("polygon")}}i.Polygon=T;class k extends m{constructor(){super("path"),this.d=new I}update(){return this.setAttribute("d",this.d.toAttribute())}path(e){return e(this.d),this.update()}setD(e){return this.setAttribute("d",e),this}}i.Path=k;class x extends m{constructor(){super("image")}src(e){return this.setAttributeNS("http://www.w3.org/1999/xlink","href",e)}width(e,t=n.px){return this.setAttribute("width",a(e,t))}height(e,t=n.px){return this.setAttribute("height",a(e,t))}size(e,t,r=n.px){return this.width(e,r),this.height(t,r),this}}i.Image=x;class E extends o{units(e){return this.setAttribute("gradientUnits",e===t.objectBoundingBox?"objectBoundingBox":"userSpaceOnUse")}stop(e,t,r){var n=s("stop");return n.setAttribute("offset",e+"%"),null!=t&&n.setAttribute("stop-color",t),null!=r&&n.setAttribute("stop-opacity",r),this.el.appendChild(n),this}}i.Gradient=E;class S extends E{constructor(){super("linearGradient")}start(e,t){return this.setAttribute("x1",e),this.setAttribute("y1",t),this}end(e,t){return this.setAttribute("x2",e),this.setAttribute("y2",t),this}}i.LinearGradient=S;class C extends E{constructor(){super("radialGradient")}center(e,t){return this.setAttribute("cx",e),this.setAttribute("cy",t),this}focus(e,t,r){return this.setAttribute("fx",e),this.setAttribute("fy",t),this.setAttribute("fr",r),this}radius(e){return this.setAttribute("r",e)}}i.RadialGradient=C;class w extends l{constructor(){super("clipPath")}clipPathUnits(e){return e?this.setAttribute("clipPathUnits","objectBoundingBox"):this.setAttribute("clipPathUnits","userSpaceOnUse")}}function s(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}i.ClipPath=w;class I{constructor(){this.ops=[]}clear(){this.ops=[]}moveTo(e,t){return this.op("M",e,t)}moveBy(e,t){return this.op("m",e,t)}lineTo(e,t){return this.op("L",e,t)}lineBy(e,t){return this.op("l",e,t)}cCurveTo(e,t,r,n,i,s){return this.op("C",e,t,r,n,i,s)}cCurveBy(e,t,r,n,i,s){return this.op("c",e,t,r,n,i,s)}qCurveTo(e,t,r,n){return this.op("Q",e,t,r,n)}qCurveBy(e,t,r,n){return this.op("q",e,t,r,n)}sCurveTo(e,t,r,n){return this.op("S",e,t,r,n)}sCurveBy(e,t,r,n){return this.op("s",e,t,r,n)}tCurveTo(e,t){return this.op("T",e,t)}tCurveBy(e,t){return this.op("t",e,t)}arcTo(e,t,r,n,i,s,a){return this.op("A",e,t,r,n?1:0,i?1:0,s,a)}arcBy(e,t,r,n,i,s,a){return this.op("a",e,t,r,n?1:0,i?1:0,s,a)}close(){return this.op("z")}toAttribute(){return this.ops.map(e=>e.op+" "+e.args.join(" ")).join(" ")}op(e,...t){return this.ops.push({op:e,args:t}),this}}function a(e,t){switch(t){case n.em:return e+"em";case n.ex:return e+"ex";case n.px:return e+"px";case n.in:return e+"in";case n.cm:return e+"cm";case n.mm:return e+"mm";case n.pt:return e+"pt";case n.pc:return e+"pc";case n.percent:return e+"%";default:return e.toString()}}i.PathContext=I}})(pxt=pxt||{}),(e=>{function r(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator&&0<navigator.maxTouchPoints)}function n(){return"undefined"!=typeof window&&!!window.PointerEvent}(e=(e=e.svgUtil||(e.svgUtil={})).events||(e.events={})).isTouchEnabled=r,e.hasPointerEvents=n,e.down=function(e,t){n()?e.addEventListener("pointerdown",t):r()?(e.addEventListener("mousedown",t),e.addEventListener("touchstart",t)):e.addEventListener("mousedown",t)},e.up=function(e,t){n()?e.addEventListener("pointerup",t):(r(),e.addEventListener("mouseup",t))},e.enter=function(e,t){n()?e.addEventListener("pointerover",e=>{t(!!(1&e.buttons))}):r()?e.addEventListener("touchstart",e=>{t(!0)}):e.addEventListener("mouseover",e=>{t(!!(1&e.buttons))})},e.leave=function(e,t){n()?e.addEventListener("pointerleave",t):r()?e.addEventListener("touchend",t):e.addEventListener("mouseleave",t)},e.move=function(e,t){n()?e.addEventListener("pointermove",t):r()?e.addEventListener("touchmove",t):e.addEventListener("mousemove",t)},e.click=function(e,t){e.addEventListener("click",t)}})(pxt=pxt||{}),(e=>{e=e.svgUtil||(e.svgUtil={});{var t=e.helpers||(e.helpers={});class r extends e.Text{at(e,t){return this.cx=e,this.cy=t,this.rePosition(),this}text(e,t=12){return super.text(e),this.fontSizePixels=t,this.setAttribute("font-size",t+"px"),this.rePosition(),this}rePosition(){null!=this.cx&&null!=this.cy&&null!=this.fontSizePixels&&(this.setAttribute("x",this.cx),this.setAttribute("y",this.cy),this.setAttribute("text-anchor","middle"),this.setAttribute("alignment-baseline","middle"))}}t.CenteredText=r}})(pxt=pxt||{}),(e=>{(e=e.editor||(e.editor={})).initExtensionsAsync=e=>Promise.resolve({}),e.initFieldExtensionsAsync=e=>Promise.resolve({})})(pxt=pxt||{}),(y=>{y.IMAGE_MIME_TYPE="image/x-mkcd-f4",y.TILEMAP_MIME_TYPE="application/mkcd-tilemap",y.ANIMATION_MIME_TYPE="application/mkcd-animation",y.SONG_MIME_TYPE="application/mkcd-song",y.JSON_MIME_TYPE="application/json";class n{constructor(e){this.type=e,this.assets=[],this.takenNames={},this.listeners=[]}add(e){return this.takenNames[e.id]?this.update(e.id,e):(e=a(e),this.takenNames[e.id]=!0,this.takenNames[p(e)]=!0,e.meta.displayName&&e.meta.displayName!==e.id&&(this.takenNames[e.meta.displayName]&&(e.meta.displayName=this.generateNewDisplayName(e.meta.displayName)),this.takenNames[e.meta.displayName]=!0),this.assets.push(e),a(e))}getSnapshot(t){return t?this.assets.filter(e=>t(e)).map(e=>a(e)):this.assets.map(e=>a(e))}update(e,t){let r;if(this.takenNames[e]){var n=this.lookupByID(e);if(l(n,t))r=t;else{if(!h(t)&&h(n))return y.warn("Refusing to overwrite asset with invalid version"),y.tickEvent("assets.invalidAssetOverwrite",{assetType:t.type}),n;this.removeByID(e),r=this.add(t),this.notifyListener(t.internalID)}}else r=this.add(t);return r}removeByID(t){var e=this.lookupByID(t);this.assets=this.assets.filter(e=>e.id!==t),delete this.takenNames[t],e&&delete this.takenNames[p(e)],null!=e&&e.meta.displayName&&delete this.takenNames[null==e?void 0:e.meta.displayName]}getByID(e){e=this.lookupByID(e);return e&&a(e)}getByDisplayName(e){if(this.takenNames[e])for(var t of this.assets)if(t.meta.displayName===e||p(t)===e)return a(t)}getByValue(e){for(var t of this.assets)if(l(e,t,!0))return t}isIDTaken(e){return!!this.takenNames[e]}clone(){var e=new n(this.type);return e.assets=this.getSnapshot(),e.takenNames=Object.assign({},this.takenNames),e}serializeToJRes(e={},t){for(var r of this.assets)if(!t||t(r)){c=l=o=a=s=i=n=void 0;var n=r,i=e,s=n.id.substr(n.id.lastIndexOf(".")+1),a=n.meta.tags;switch(n.type){case"image":i[s]=n.jresData,(n.meta.displayName||null!=a&&a.length)&&(o={data:n.jresData,mimeType:y.IMAGE_MIME_TYPE},n.meta.displayName&&(o.displayName=n.meta.displayName),null!=a&&a.length&&(o.tags=a),i[s]=o);break;case"tile":var o={data:n.jresData,mimeType:y.IMAGE_MIME_TYPE,tilemapTile:!0,displayName:n.meta.displayName};null!=a&&a.length&&(o.tags=a),i[s]=o;break;case"tilemap":var l=((e,t,r)=>{var n=e.tilemap.data(),i=new Uint8ClampedArray(5+n.data.length+e.layers.data.length);return i[0]=e.tileset.tileWidth,i[1]=255&n.width,i[2]=n.width>>8&255,i[3]=255&n.height,i[4]=n.height>>8&255,i.set(n.data,5),i.set(e.layers.data,5+n.data.length),{id:t,mimeType:y.TILEMAP_MIME_TYPE,data:btoa(y.sprite.uint8ArrayToHex(i)),tileset:e.tileset.tiles.map(e=>e.id),displayName:r}})(n.data,n.id,n.meta.displayName);i[l.id]=l;break;case"animation":i[s]=(e=>{var t,r={namespace:e.id.substr(0,e.id.lastIndexOf(".")),id:e.id.substr(e.id.lastIndexOf(".")+1),mimeType:y.ANIMATION_MIME_TYPE,data:y.sprite.encodeAnimationString(e.frames,e.interval),displayName:e.meta.displayName};return null!=(t=e.meta.tags)&&t.length&&(r.tags=e.meta.tags),r})(n);break;case"song":l={data:y.assets.music.encodeSongToHex(n.song),mimeType:y.SONG_MIME_TYPE,displayName:n.meta.displayName,namespace:y.sprite.SONG_NAMESPACE+"."};null!=a&&a.length&&(l.tags=a),i[s]=l;break;case"json":var c={data:JSON.stringify({data:n.data,fileName:n.fileName}),mimeType:y.JSON_MIME_TYPE,displayName:n.meta.displayName,namespace:y.sprite.JSON_NAMESPACE+"."};null!=a&&a.length&&(c.tags=a),i[s]=c}}return e}addListener(e,t){this.listeners.push({internalID:e,callback:t})}removeListener(t){this.listeners=this.listeners.filter(e=>e.callback!==t)}diff(e){var t,r,n={before:[],after:[]};let i={};for(t of e.assets){i[t.internalID]=!0;var s=this.lookupByInternalID(t.internalID);s&&l(t,s)||(n.before.push(t),n.after.push(s))}for(r of this.assets.filter(e=>!i[e.internalID]))n.before.push(null),n.after.push(r);return n}applyDiff(e,t=!1){var r,n=t?e.after:e.before,i=t?e.before:e.after;y.Util.assert(n.length===i.length);for(let e=0;e<n.length;e++)n[e]?(this.removeByInternalID(n[e].internalID),i[e]&&this.assets.push(i[e]),this.notifyListener(n[e].internalID)):(this.assets.push(i[e]),this.notifyListener(i[e].internalID));this.takenNames={};for(r of this.assets)y.Util.assert(!this.takenNames[r.id]),this.takenNames[r.id]=!0,this.takenNames[p(r)]=!0,r.meta.displayName&&(r.meta.displayName!==r.id&&y.Util.assert(!this.takenNames[r.meta.displayName]),this.takenNames[r.meta.displayName]=!0)}lookupByID(e){for(var t of this.assets)if(t.id===e)return t;return null}lookupByInternalID(e){for(var t of this.assets)if(t.internalID===e)return t;return null}removeByInternalID(t){this.assets=this.assets.filter(e=>e.internalID!==t)}notifyListener(e){for(var t of this.listeners)t.internalID===e&&t.callback()}generateNewDisplayName(e){e=e.replace(/\d+$/,"");let t=0;for(;this.takenNames[e+t];)++t;return e+t}}class r{constructor(){this.needsRebuild=!0,this.nextID=0,this.nextInternalID=0,this.committedState={revision:0,assets:{image:new n("image"),tile:new n("tile"),tilemap:new n("tilemap"),animation:new n("animation"),song:new n("song"),json:new n("json")}},this.state={revision:this.nextID++,assets:{image:new n("image"),tile:new n("tile"),tilemap:new n("tilemap"),animation:new n("animation"),song:new n("song"),json:new n("json")}},this.gallery={revision:0,assets:{image:new n("image"),tile:new n("tile"),tilemap:new n("tilemap"),animation:new n("animation"),song:new n("song"),json:new n("json")}},this.undoStack=[],this.redoStack=[]}getNewInternalId(){return this.nextInternalID++}createNewImage(e=16,t=16){this.onChange();var r=this.generateNewID("image"),e=new y.sprite.Bitmap(e,t).data(),t={internalID:this.getNewInternalId(),id:r,type:"image",bitmap:e,meta:{},jresData:y.sprite.base64EncodeBitmap(e)};return this.getAssetCollection("image").add(t)}createNewAnimation(e=16,t=16){this.onChange();var r=this.generateNewID("animation"),e=new y.sprite.Bitmap(e,t).data(),t={internalID:this.getNewInternalId(),id:r,type:"animation",frames:[e],interval:500,meta:{}};return this.getAssetCollection("animation").add(t)}createNewAnimationFromData(e,t=500,r){this.onChange();var n=this.generateNewID("animation"),n={internalID:this.getNewInternalId(),id:n,type:"animation",frames:e,interval:t,meta:{displayName:r}};return this.getAssetCollection("animation").add(n)}getGalleryTiles(t){return this.extensionTileSets?this.extensionTileSets.map(e=>e.tileSets.find(e=>e.tileWidth===t)).filter(e=>null==e?void 0:e.tiles.length):null}getProjectImages(){return this.getAssetCollection("image").getSnapshot()}getProjectTiles(t,e){var r=this.getAssetCollection("tile").getSnapshot(e=>e.bitmap.width===t);return 0===r.length?e?(this.createNewTile(new y.sprite.Bitmap(t,t).data()),this.getProjectTiles(t,!1)):null:{tileWidth:t,tiles:r}}createNewTile(e,t,r){this.onChange(),t&&!this.isNameTaken("tile",t)||(t=this.generateNewID("tile"));t={internalID:this.getNewInternalId(),id:t,type:"tile",jresData:y.sprite.base64EncodeBitmap(e),bitmap:e,meta:{displayName:r},isProjectTile:!0};return this.getAssetCollection("tile").add(t)}createNewProjectImage(e,t){this.onChange();t={internalID:this.getNewInternalId(),id:this.generateNewID("image"),type:"image",jresData:y.sprite.base64EncodeBitmap(e),meta:{displayName:t},bitmap:e};return this.getAssetCollection("image").add(t)}createNewSong(e,t){this.onChange();e={internalID:this.getNewInternalId(),id:this.generateNewID("song"),type:"song",song:y.assets.music.cloneSong(e),meta:{displayName:t}};return this.getAssetCollection("song").add(e)}createNewJsonAsset(e,t,r){this.onChange();e={internalID:this.getNewInternalId(),id:this.generateNewID("json"),type:"json",data:e,fileName:t,meta:{displayName:r}};return this.getAssetCollection("json").add(e)}updateTile(t){this.onChange();var e=this.resolveProjectTileByInternalID(t.internalID);if(e){if(this.getAssetCollection("tile").update(e.id,t),e.id!==t.id||!y.sprite.bitmapEquals(e.bitmap,t.bitmap))for(var r of this.getAssets("tilemap"))r.data.tileset.tiles.some(e=>e.internalID===t.internalID)&&(r.data.tileset.tiles=r.data.tileset.tiles.map(e=>e.internalID===t.internalID?t:e),this.updateTilemap(r.id,r.data));return t}return null}deleteTile(e){this.onChange(),this.getAssetCollection("tile").removeByID(e)}getProjectTilesetJRes(t){var e={};return this.getAssetCollection("tile").serializeToJRes(e),this.getAssetCollection("tilemap").serializeToJRes(e,e=>!t||!y.sprite.isTilemapEmptyOrUnused(e,this,t)),e["*"]={mimeType:"image/x-mkcd-f4",dataEncoding:"base64",namespace:y.sprite.TILE_NAMESPACE},e}getProjectAssetsJRes(){var e,t={};for(e of Object.keys(this.state.assets))"tilemap"!==e&&"tile"!==e&&this.state.assets[e].serializeToJRes(t);return t["*"]={mimeType:"image/x-mkcd-f4",dataEncoding:"base64",namespace:y.sprite.IMAGES_NAMESPACE},t}getTilemap(e){return this.getAssetCollection("tilemap").getByID(e)}updateTilemap(e,t){var r=this.getAssetCollection("tilemap").getByID(e);return r?(this.onChange(),r=Object.assign(Object.assign({},r),{data:t}),this.getAssetCollection("tilemap").update(e,r),r):null}createNewTilemap(e,t,r=16,n=16){return this.createNewTilemapFromData(this.blankTilemap(t,r,n),e)}blankTilemap(e,t=16,r=16){var n=new y.sprite.Tilemap(t,r),t=new y.sprite.Bitmap(t,r),r={tileWidth:e,tiles:[this.getTransparency(e)]};return new y.sprite.TilemapData(n,r,t.data())}resolveTile(e){return this.lookupAsset("tile",e)}resolveProjectTileByInternalID(t){return this.getAssetCollection("tile").getSnapshot(e=>e.internalID===t)[0]}resolveTileByBitmap(e){let t=y.sprite.base64EncodeBitmap(e);return this.getAssetCollection("tile").getSnapshot(e=>e.jresData===t)[0]}getTransparency(e){var t=y.sprite.TILE_NAMESPACE+".transparency"+e;let r=this.getAssetCollection("tile").getByID(t);return r||(e=new y.sprite.Bitmap(e,e).data(),r={internalID:this.getNewInternalId(),id:t,type:"tile",bitmap:e,jresData:y.sprite.base64EncodeBitmap(e),meta:{},isProjectTile:!0},this.getAssetCollection("tile").add(r))}createNewTilemapFromData(e,t){this.onChange();var r=this.generateNewIDInternal("tilemap",t||lf("level"));return this.getAssetCollection("tilemap").add({internalID:this.getNewInternalId(),id:r,type:"tilemap",meta:{displayName:t||r},data:e}),[r,e]}cloneState(){var e,t={revision:this.state.revision,assets:{}};for(e of Object.keys(this.state.assets))t.assets[e]=this.state.assets[e].clone();return t}undo(){if(this.state.revision!==this.committedState.revision&&this.pushUndo(),this.undoStack.length){var e,t=this.undoStack.pop();for(e of Object.keys(t.assetDiffs))this.getAssetCollection(e).applyDiff(t.assetDiffs[e],!0);this.state.revision=t.beforeRevision,this.redoStack.push(t),this.committedState=this.cloneState(),this.needsRebuild=!0}}redo(){if(this.redoStack.length){var e,t=this.redoStack.pop();for(e of Object.keys(t.assetDiffs))this.getAssetCollection(e).applyDiff(t.assetDiffs[e]);this.state.revision=t.afterRevision,this.undoStack.push(t),this.committedState=this.cloneState(),this.needsRebuild=!0}}pushUndo(){if(!this.undoStack.length||this.committedState.revision!==this.state.revision){this.redoStack=[],this.undoStack.push({beforeRevision:this.committedState.revision,afterRevision:this.state.revision,assetDiffs:{}});var e,t=this.undoStack[this.undoStack.length-1];for(e of Object.keys(this.state.assets))t.assetDiffs[e]=this.state.assets[e].diff(this.committedState.assets[e]);this.committedState=this.cloneState(),this.cleanupTemporaryAssets()}}revision(){return this.state.revision}encodeTilemap(e,t){var r=e.tilemap.data(),n=new Uint8ClampedArray(5+r.data.length+e.layers.data.length);return n[0]=e.tileset.tileWidth,n[1]=255&r.width,n[2]=r.width>>8&255,n[3]=255&r.height,n[4]=r.height>>8&255,n.set(r.data,5),n.set(e.layers.data,5+r.data.length),{id:t,mimeType:y.TILEMAP_MIME_TYPE,data:btoa(y.sprite.uint8ArrayToHex(n)),tileset:e.tileset.tiles.map(e=>e.id)}}forceUpdate(){this.onChange()}isNameTaken(t,e){var r=e=>this.getAssetCollection(t).isIDTaken(e)||this.getAssetCollection(t,!0).isIDTaken(e),n=g(t,e),i=n&&n!==e;return r(e)||i&&r(n)}isAssetUsed(r,n,i){var s;if(0<((null==(s=null==(s=r.meta)?void 0:s.blockIDs)?void 0:s.filter(e=>!i||(null==i?void 0:i.indexOf(e))<0))||[]).length)return!0;if("tile"==r.type)for(var e of this.getAssets("tilemap"))if(!(0<=(null==i?void 0:i.indexOf(e.id)))&&e.data.tileset.tiles.some(e=>e.id===r.id))return!0;if(n){var a=y.Util.escapeForRegex(p(r)),o=y.Util.escapeForRegex(null==(s=r.meta)?void 0:s.displayName)||"";let e;switch(r.type){case"tile":e=`myTiles.${a}|assets.tile\`${a}\``,o&&(e+=`|assets.tile\`${o}\``);break;case"tilemap":e=`tilemap\`${a}\``;break;case"animation":e=`assets.animation\`${a}\``,o&&(e+=`|assets.animation\`${o}\``);break;case"song":e=`assets.song\`${a}\``,o&&(e+=`|assets.song\`${o}\``);break;case"json":e=`assets.json\`${a}\``,o&&(e+=`|assets.json\`${o}\``);break;default:e=`assets.image\`${a}\``,o&&(e+=`|assets.image\`${o}\``)}var l=new RegExp(e,"gm");let t;switch(r.type){case"tile":t=`myTiles.${a}|assets.tile("""${a}""")`,o&&(t+=`|assets.tile("""${o}""")`);break;case"tilemap":t=`assets.tilemap("""${a}""")`;break;case"animation":t=`assets.animation("""${a}""")`,o&&(t+=`|assets.animation("""${o}""")`);break;case"song":t=`assets.song("""${a}""")`,o&&(t+=`|assets.song("""${o}""")`);break;case"json":t=`assets.json("""${a}""")`,o&&(t+=`|assets.json("""${o}""")`);break;default:t=`assets.image("""${a}""")`,o&&(t+=`|assets.image("""${o}""")`)}var c,u=new RegExp(t,"gm");for(c of Object.keys(n))if(!(0<=(null==i?void 0:i.indexOf(c)))){var d=n[c];if(c.match(/((?!\.g).{2}|^.{0,1})\.ts$/i)){if(d.content.match(l))return!0}else if(c.endsWith(".py")&&d.content.match(u))return!0}}return!1}lookupAsset(e,t){return this.getAssetCollection(e).getByID(t)||this.getAssetCollection(e,!0).getByID(t)}lookupAssetByName(e,t){return this.getAssetCollection(e).getByDisplayName(t)}lookupAssetByValue(e,t){return this.getAssetCollection(e).getByValue(t)}getAssets(e){return this.getAssetCollection(e).getSnapshot()}getGalleryAssets(e){return this.getAssetCollection(e).getSnapshot()}lookupBlockAsset(e,t){return this.getAssetCollection(e).getSnapshot(e=>-1!==(null==(e=null==(e=e.meta)?void 0:e.blockIDs)?void 0:e.indexOf(t)))[0]}updateAsset(e){return this.onChange(),"tile"!==e.type?this.getAssetCollection(e.type).update(e.id,e):this.updateTile(e)}duplicateAsset(e,t){this.onChange();var r=a(e),n=t||(null==(t=r.meta)?void 0:t.displayName);let i;switch(e.type){case"image":i=this.createNewProjectImage(r.bitmap,n);break;case"tile":i=this.createNewTile(r.bitmap,null,n);break;case"tilemap":var[s,,]=this.createNewTilemapFromData(r.data,n);i=this.getTilemap(s);break;case"animation":i=this.createNewAnimationFromData(r.frames,r.interval,n);break;case"song":i=this.createNewSong(r.song,n);break;case"json":i=this.createNewJsonAsset(r.data,e.fileName,n)}return i}removeAsset(e){this.onChange(),this.getAssetCollection(e.type).removeByID(e.id)}addChangeListener(e,t){this.getAssetCollection(e.type).addListener(e.internalID,t)}removeChangeListener(e,t){this.getAssetCollection(e).removeListener(t)}loadPackage(e){var t,r,n=e.sortedDeps();this.extensionTileSets=[];for(t of n){var i,s,a="this"===t.id;for(i of this.readImages(t.parseJRes(),a))i.meta.package=t.id,("tile"===i.type?this.getAssetCollection("tile",!a):"image"===i.type?this.getAssetCollection("image",!a):"animation"===i.type?this.getAssetCollection("animation",!a):"json"===i.type?this.getAssetCollection("json",!a):a?(s=y.sprite.IMAGES_NAMESPACE+".",i.id.startsWith(s)&&(i.id=i.id.replace(s,y.sprite.SONG_NAMESPACE+".")),this.getAssetCollection("song")):this.getAssetCollection("song",!0)).add(i)}for(r of n){var o,l="this"===r.id;for(o of c(r.parseJRes()))l?this.getAssetCollection("tilemap").add({internalID:this.getNewInternalId(),type:"tilemap",id:o.id,meta:{displayName:o.displayName||o.id,package:e.id},data:b(o,e=>this.resolveTile(e))}):this.getAssetCollection("tilemap",!0).add({internalID:this.getNewInternalId(),type:"tilemap",id:o.id,meta:{displayName:o.displayName||o.id,package:e.id},data:b(o,e=>this.getAssetCollection("tile",!0).getByID(e))})}this.committedState=this.cloneState(),this.undoStack=[],this.redoStack=[]}loadTilemapJRes(e,t=!1,r=!1){e=y.inflateJRes(e);var n,i=this.readImages(e,!r).filter(e=>"tile"===e.type);let s={};if(r)for(var a of i)this.getAssetCollection("tile",!0).add(a);else for(var o of i){if(t){var l=this.resolveTileByBitmap(o.bitmap);if(l){s[o.id]=l.id;continue}}l=this.createNewTile(o.bitmap,o.id,o.meta.displayName);l.id!==o.id&&(s[o.id]=l.id)}for(n of c(e))this.getAssetCollection("tilemap",r).add({internalID:this.getNewInternalId(),type:"tilemap",id:n.id,meta:{displayName:n.displayName||n.id},data:b(n,e=>(s[e]&&(e=s[e]),this.resolveTile(e)))})}loadAssetsJRes(e,t=!1){e=y.inflateJRes(e);var r,n,i=[];for(r of Object.keys(e)){var s,a,o=e[r];o.tilemapTile?this.getAssetCollection("tile",t).add(this.generateImage(o,"tile")):o.mimeType===y.IMAGE_MIME_TYPE?this.getAssetCollection("image",t).add(this.generateImage(o,"image")):o.mimeType===y.ANIMATION_MIME_TYPE?([s,a]=this.generateAnimation(o),a?i.push(s):this.getAssetCollection("animation",t).add(s)):o.mimeType===y.SONG_MIME_TYPE?this.getAssetCollection("song",t).add(this.generateSong(o)):o.mimeType===y.JSON_MIME_TYPE&&this.getAssetCollection("json",t).add(this.generateJsonAsset(o))}for(n of i)this.getAssetCollection("animation",t).add(this.inflateAnimation(n,this.getAssetCollection("image",t).getSnapshot()))}removeInactiveBlockAssets(t){for(var e of Object.keys(this.state.assets)){n=r=a=s=i=void 0;var r,n,i=this.state.assets[e],s=i.getSnapshot(e=>!e.meta.displayName&&(null==(e=e.meta.blockIDs)?void 0:e.some(e=>-1===t.indexOf(e)))),a=[];for(r of s)(1===r.meta.blockIDs.length||(r.meta.blockIDs=r.meta.blockIDs.filter(e=>-1!==t.indexOf(e)),0===r.meta.blockIDs.length))&&a.push(r);for(n of a)i.removeByID(n.id)}}clone(){var e,t=new r;return t.committedState=s(this.committedState),t.state=s(this.state),t.gallery=s(this.gallery),t.extensionTileSets=null==(e=this.extensionTileSets)?void 0:e.map(e=>Object.assign(Object.assign({},e),{tileSets:e.tileSets.map(e=>Object.assign(Object.assign({},e),{tiles:e.tiles.map(e=>a(e))}))})),t.needsRebuild=this.needsRebuild,t.nextID=this.nextID,t.nextInternalID=this.nextInternalID,t.undoStack=this.undoStack.map(e=>o(e)),t.redoStack=this.undoStack.map(e=>o(e)),t}saveGallerySnapshot(){return this.gallery}loadGallerySnapshot(e){this.gallery=e}generateImage(e,t){return{internalID:this.getNewInternalId(),type:t,id:e.id,meta:{displayName:e.displayName,tags:e.tags},jresData:e.data,bitmap:y.sprite.getBitmapFromJResURL(`data:${y.IMAGE_MIME_TYPE};base64,`+e.data).data()}}generateSong(e){return{internalID:this.getNewInternalId(),type:"song",id:e.id,meta:{displayName:e.displayName,tags:e.tags},song:y.assets.music.decodeSongFromHex(e.data)}}generateJsonAsset(e){var t=JSON.parse(e.data);return{internalID:this.getNewInternalId(),type:"json",id:e.id,meta:{displayName:e.displayName,tags:e.tags},data:t.data,fileName:t.fileName}}generateAnimation(t){if("json"!==t.dataEncoding)return[Object.assign(Object.assign({},v(t)),{internalID:this.getNewInternalId()}),!1];{let e;try{e=JSON.parse(t.data)}catch(e){y.warn("could not parse json data of '"+t.id+"'")}return[{internalID:this.getNewInternalId(),type:"animation",meta:{displayName:t.displayName,tags:t.tags},id:t.id,frames:[],frameIds:e.frames,interval:100,flippedHorizontal:e.flippedHorizontal},!0]}}inflateAnimation(e,r){return e.frames=e.frameIds.map(t=>r.find(e=>e.id===t).bitmap),e.flippedHorizontal&&(e.frames=e.frames.map(e=>{var r=y.sprite.Bitmap.fromData(e),n=new y.sprite.Bitmap(e.width,e.height);for(let t=0;t<n.width;t++)for(let e=0;e<n.height;e++)n.set(t,e,r.get(r.width-t-1,e));return n.data()})),e}generateNewID(e){switch(e){case"animation":return this.generateNewIDInternal("animation",y.sprite.ANIMATION_PREFIX,y.sprite.ANIMATION_NAMESPACE);case"image":return this.generateNewIDInternal("image",y.sprite.IMAGE_PREFIX,y.sprite.IMAGES_NAMESPACE);case"tile":return this.generateNewIDInternal("tile",y.sprite.TILE_PREFIX,y.sprite.TILE_NAMESPACE);case"tilemap":return this.generateNewIDInternal("tilemap",lf("level"));case"song":return this.generateNewIDInternal("song",y.sprite.SONG_PREFIX,y.sprite.SONG_NAMESPACE);case"json":return this.generateNewIDInternal("json",y.sprite.JSON_PREFIX,y.sprite.JSON_NAMESPACE)}}generateNewIDInternal(e,t,r){t=t.replace(/\d+$/,"");var n=r?r+"."+t:t;let i=1;for(;this.isNameTaken(e,n+i);)++i;return n+i}onChange(){this.needsRebuild=!0,this.state.revision=this.nextID++}readImages(e,t=!1){var r,n,i=[],s=[];for(r of Object.keys(e)){var a,o,l=e[r];l.tilemapTile?((a=this.generateImage(l,"tile")).isProjectTile=t,i.push(a)):l.mimeType===y.IMAGE_MIME_TYPE?i.push(this.generateImage(l,"image")):l.mimeType===y.ANIMATION_MIME_TYPE?([a,o]=this.generateAnimation(l),(o?s:i).push(a)):l.mimeType===y.SONG_MIME_TYPE?i.push(this.generateSong(l)):l.mimeType===y.JSON_MIME_TYPE&&i.push(this.generateJsonAsset(l))}for(n of s)i.push(this.inflateAnimation(n,i));return i}cleanupTemporaryAssets(){var e,t=this.getAssetCollection("image");for(e of t.getSnapshot(e=>!(e.meta.displayName||null!=(e=e.meta.blockIDs)&&e.length)))t.removeByID(e.id)}getAssetCollection(e,t=!1){return _(t?this.gallery:this.state,e,!0)}}function c(e){var t,r=[];for(t of Object.keys(e)){var n=e[t];n.mimeType===y.TILEMAP_MIME_TYPE&&r.push(n)}return r}function u(e,t){return"\n"+`    helpers._registerFactory("${e}", function(name: string) {
`+`        switch(helpers.stringTrim(name)) {
`+t.map(e=>e.keys.filter(e=>!!e).map(e=>`            case "${e}":`).join("\n")+`return ${e.expression};`).join("\n")+"\n"+`        }
`+`        return null;
`+`    })
`}function i(e){return y.sprite.Bitmap.fromData(e).copy().data()}function b(e,t){var r=atob(e.data),r=y.U.fromHex(r),n=r[1]|r[2]<<8,i=r[3]|r[4]<<8,e=e.tileset.map(e=>t&&t(e)||{id:e});let s=r[0];var a={tileWidth:s=(s=s||e.length&&(null==(a=e.find(e=>null==(e=e.bitmap)?void 0:e.width))?void 0:a.bitmap.width))||16,tiles:e},e=r.slice(5,5+n*i),o=new y.sprite.Tilemap(n,i,0,0,new Uint8ClampedArray(e)),r=r.slice(5+e.length),e=new y.sprite.Bitmap(n,i,0,0,new Uint8ClampedArray(r)).data();return new y.sprite.TilemapData(o,a,e)}function a(e,t=!1){switch(e.meta=Object.assign({},e.meta),e.meta.temporaryInfo&&(e.meta.temporaryInfo=Object.assign({},e.meta.temporaryInfo)),e.type){case"tile":case"image":return Object.assign(Object.assign({},e),{bitmap:i(e.bitmap)});case"animation":return Object.assign(Object.assign({},e),{frames:e.frames.map(e=>i(e))});case"tilemap":return Object.assign(Object.assign({},e),{data:e.data.cloneData(t)});case"song":return Object.assign(Object.assign({},e),{song:y.assets.music.cloneSong(e.song)});case"json":return Object.assign(Object.assign({},e),{data:y.U.clone(e.data)})}}function s(e){var t,r={revision:e.revision,assets:{}};for(t of Object.keys(e.assets)){var n=e.assets[t];r.assets[t]=n.clone()}return r}function o(e){var t,r=Object.assign(Object.assign({},e),{assetDiffs:{}});for(t of Object.keys(e.assetDiffs)){var n=e.assetDiffs[t];r.assetDiffs[t]=(n=n,Object.assign(Object.assign({},n),{before:n.before.map(e=>a(e)),after:n.after.map(e=>a(e))}))}return r}function l(e,t,r=!1){if(e==t)return!0;if(!e&&t||!t&&e||e.type!==t.type)return!1;if(!(r||e.id===t.id&&y.U.arrayEquals(e.meta.tags,t.meta.tags)&&y.U.arrayEquals(e.meta.blockIDs,t.meta.blockIDs)&&e.meta.displayName===t.meta.displayName))return!1;switch(e.type){case"image":case"tile":return y.sprite.bitmapEquals(e.bitmap,t.bitmap);case"animation":return e.interval===t.interval&&y.U.arrayEquals(e.frames,t.frames,y.sprite.bitmapEquals);case"tilemap":return e.data.equals(t.data);case"song":return y.assets.music.songEquals(e.song,t.song);case"json":return e.fileName===t.fileName&&y.U.deepEqual(e.data,t.data)}}function d(e){e=/^\s*(?:(?:assets\s*\.\s*(image|tile|animation|tilemap|song))|(tilemap))\s*(?:`|\(""")([^`"]+)(?:`|"""\))\s*$/m.exec(e);if(e)return{type:e[1]||e[2],name:e[3].trim()}}function p(e){return g(e.type,e.id)}function h(e){if(!e)return!1;switch(e.type){case"image":case"tile":return!!(n=e).bitmap&&m(y.sprite.Bitmap.fromData(n.bitmap));case"tilemap":return!!((n=e).data&&n.data.tilemap&&n.data.tileset&&n.data.tileset.tileWidth&&null!=(r=n.data.tileset.tiles)&&r.length&&n.data.layers)&&m(y.sprite.Bitmap.fromData(n.data.layers))&&m(n.data.tilemap);case"animation":r=e;return!(null==(t=r.frames)||!t.length||r.interval<=0||r.frames.some(e=>!m(y.sprite.Bitmap.fromData(e))));case"song":return(t=e).song&&0<t.song.ticksPerBeat&&0<t.song.beatsPerMeasure&&0<t.song.measures&&0<t.song.beatsPerMinute&&!!t.song.tracks;case"json":return!!e.data}var t,r,n}function m(e){return 0<e.width&&0<e.height&&!Number.isNaN(e.x0)&&!Number.isNaN(e.y0)&&e.data().data.length===e.dataLength()}function g(e,t,r=!1){let n;switch(e){case"image":n=y.sprite.IMAGES_NAMESPACE+".";break;case"tile":n=y.sprite.TILE_NAMESPACE+".";break;case"tilemap":n="";break;case"animation":n=y.sprite.ANIMATION_NAMESPACE+".";break;case"song":n=y.sprite.SONG_NAMESPACE+".";break;case"json":n=y.sprite.JSON_NAMESPACE+"."}if(n)if(t.startsWith(n)){e=t.substr(n.length);if(-1===e.indexOf("."))return e}else if(!r)return null;return t}function v(e){var t=atob(e.data),r=new Uint8ClampedArray(y.U.fromHex(t)),t=f(r,0),n=f(r,2),i=f(r,4),s=f(r,6),a=Math.ceil(n*i/2);let o=8;var l=[];for(let e=0;e<s;e++){var c=r.slice(o,o+a);l.push({x0:0,y0:0,width:n,height:i,data:c}),o+=a}let u=e.id;return{type:"animation",internalID:0,id:u=u.startsWith(e.namespace)?u:(u=e.namespace+"."+u).replace(/\.\./g,"."),interval:t,frames:l,meta:{displayName:e.displayName,tags:e.tags}}}function f(e,t){return e[t]|e[t+1]<<8}function _(e,t,r=!1){if(!e.assets[t]){if(!r)return;e.assets[t]=new n(t)}return e.assets[t]}y.TilemapProject=r,y.emitGalleryDeclarations=function(n,i){var e=Object.keys(n);let s="";var r={};let a={};var o,l,c={},u=e=>{let t=n[e].namespace||n["*"].namespace;e=n[e].id||e;return t&&(t.endsWith(".")&&(t=t.slice(0,t.length-1)),!e.startsWith(t+"."))?t+"."+e:e};n["*"]&&(c["*"]=Object.assign(Object.assign({},n["*"]),{namespace:i}));for(o of e)if("*"!==o){var d=n[o],p=u(o);let t=ts.pxtc.escapeIdentifier(d.displayName||p.split(".").pop());if(r[t]){var h=t;let e=2;for(;r[t];)t=h+e,e++}r[t]=!0,a[p]=i+"."+t}for(l of e)if("*"!==l){var m=n[l],g=m.mimeType||(null==(g=n["*"])?void 0:g.mimeType);let e,t;var f,_=a[u(l)].split(".").pop();let r=m.tags;r||(r=[],-1!==_.toLowerCase().indexOf("background")&&r.push("background"),-1!==_.toLowerCase().indexOf("dialog")&&r.push("dialog"),m.tilemapTile&&r.push("tile")),g===y.IMAGE_MIME_TYPE?(t="image.ofBuffer(hex``)",e=m.tilemapTile?"images._tile":"images._image"):g===y.ANIMATION_MIME_TYPE?(f=v(m),t=`[${f.frames.map(e=>y.sprite.bitmapToImageLiteral(y.sprite.Bitmap.fromData(e),"typescript")).join(",")}]`):g===y.TILEMAP_MIME_TYPE?(f=b(m),t=y.sprite.encodeTilemap(f,"typescript",a)):g===y.SONG_MIME_TYPE?t=`hex\`${m.data}\``:g===y.JSON_MIME_TYPE&&(t=m.data),s+=`    //% fixedInstance jres whenUsed
`,e&&(s+=`    //% blockIdentity=${e}
`),r.length&&(s+=`    //% tags="${r.join(" ")}"
`),s+=`    export const ${_} = ${t};
`,"string"==typeof m?c[_]=m:(c[_]=Object.assign(Object.assign({},m),{id:a[u(l)],tags:r}),m.namespace&&(c[_].namespace=i,m.namespace.endsWith("."))&&(c[_].namespace+="."),c[_].tileset&&(c[_].tileset=m.tileset.map(e=>a[e]||e)))}return e=lf("Auto-generated code. Do not edit."),[c,`// ${e}
namespace ${i} {
${s}
}
// ${e}
`]},y.emitTilemapsFromJRes=function(e){let t="";var r,n=[],i=[];for(r of Object.keys(e))if("*"!==r){var s,a=e[r];if(a.tilemapTile){let e=r;-1!==e.indexOf(".")&&(e=e.split(".").slice(-1)[0]),t=(t+=`    //% fixedInstance jres blockIdentity=images._tile
`)+`    export const ${e} = image.ofBuffer(hex\`\`);
`,i.push({keys:[a.displayName,g("tile",r,!0)],expression:r})}a.mimeType===y.TILEMAP_MIME_TYPE&&(s=b(a),n.push({keys:[a.displayName,g("tilemap",a.id)],expression:y.sprite.encodeTilemap(s,"typescript")}))}n.length&&(t+=u("tilemap",n)),i.length&&(t+=u("tile",i));var o=lf("Auto-generated code. Do not edit.");return`// ${o}
namespace ${y.sprite.TILE_NAMESPACE} {
${t}
}
// ${o}
`},y.emitProjectImages=function(e){var t,r="",n=[],i=[],s=[],a=[];for(t of Object.keys(e))if("*"!==t){var o=e[t];if("string"==typeof o||o.mimeType===y.IMAGE_MIME_TYPE){let e;var l=[g("image",t,!0)];"string"==typeof o?e=y.sprite.bitmapToImageLiteral(y.sprite.getBitmapFromJResURL(o),"typescript"):(e=y.sprite.bitmapToImageLiteral(y.sprite.getBitmapFromJResURL(o.data),"typescript"),l.push(o.displayName)),n.push({keys:l,expression:e})}else o.mimeType===y.ANIMATION_MIME_TYPE?(l=v(o),i.push({keys:[o.displayName,g("animation",t,!0)],expression:`[${l.frames.map(e=>y.sprite.bitmapToImageLiteral(y.sprite.Bitmap.fromData(e),"typescript")).join(", ")}]`})):o.mimeType===y.SONG_MIME_TYPE?s.push({keys:[g("song",t,!0),o.displayName],expression:`hex\`${o.data}\``}):o.mimeType===y.JSON_MIME_TYPE&&a.push({keys:[g("json",t,!0),o.displayName],expression:o.data})}var c=lf("Auto-generated code. Do not edit."),r=(r=(r=(r+=u("image",n))+u("animation",i))+u("song",s))+u("json",a);return`// ${c}
namespace ${y.sprite.IMAGES_NAMESPACE} {
${r}
}
// ${c}
`},y.cloneAsset=a,y.assetEquals=l,y.validateAssetName=function(e){return!!e&&!/[\u0000-\u001f\u0021-\u002c\u002e\u002f\u003a-\u0040\u005b-\u005e\u0060\u007b-\u007f]/.test(e)},y.getTSReferenceForAsset=function(e,t=!1){let r,n;if(!(n=null!=(r=e.meta)&&r.displayName?e.meta.displayName:p(e)))return"image"===e.type||"tile"===e.type?e.id:void 0;var i=t?'("""':"`",s=t?'""")':"`";switch(e.type){case"tile":return"assets.tile"+i+n+s;case"image":return"assets.image"+i+n+s;case"animation":return"assets.animation"+i+n+s;case"tilemap":return"tilemap"+i+n+s;case"song":return"assets.song"+i+n+s;case"json":return"assets.json"+i+n+s}},y.parseAssetTSReference=d,y.lookupProjectAssetByTSReference=function(e,t){if(e=d(e)){var{type:e,name:r}=e;switch(e){case"tile":return t.lookupAssetByName("tile",r);case"image":return t.lookupAssetByName("image",r);case"tilemap":return t.lookupAssetByName("tilemap",r)||t.lookupAsset("tilemap",r);case"animation":return t.lookupAssetByName("animation",r);case"song":return t.lookupAssetByName("song",r);case"json":return t.lookupAssetByName("json",r)}}},y.getDefaultAssetDisplayName=function(e){switch(e){case"image":return lf("myImage");case"tile":return lf("myTile");case"tilemap":return lf("level");case"animation":return lf("myAnim");case"song":return lf("mySong");case"json":return lf("myFile");default:return lf("asset")}},y.getShortIDForAsset=p,y.validateAsset=h,y.patchTemporaryAsset=function(e,t,r){var n;return e&&!l(e,t)&&(t=a(t,!0),e=-1===e.internalID,n=-1===t.internalID,e&&!n)&&(t.id=r.generateNewID(t.type),t.internalID=r.getNewInternalId()),t}})(pxt=pxt||{}),(i=>{{var e=i.toolbox||(i.toolbox={});let r={},n=(e.blockColors={loops:"#107c10",logic:"#006970",math:"#712672",variables:"#A80000",functions:"#005a9e",text:"#996600",arrays:"#A94400",advanced:"#3c3c3c",addpackage:"#717171",search:"#000",debug:"#e03030",default:"#dddddd",topblocks:"#aa8f00",recipes:"#717171"},e.blockIcons={loops:"",logic:"",math:"",variables:"",functions:"",text:"",arrays:"",advancedcollapsed:"",advancedexpanded:"",more:"",addpackage:"",search:"",debug:"",default:"",topblocks:"",recipes:""},"");function s(e){e=((e,t,r)=>{let n=0,i=0,s=0;if(0==t)n=r,i=r,s=r;else{var a=Math.floor(e/60),e=e/60-a,o=r*(1-t),l=r*(1-t*e),c=r*(1-t*(1-e));switch(a){case 1:n=l,i=r,s=o;break;case 2:n=o,i=r,s=c;break;case 3:n=o,i=l,s=r;break;case 4:n=c,i=o,s=r;break;case 5:n=r,i=o,s=l;break;case 6:case 0:n=r,i=c,s=o}}return[Math.floor(n),Math.floor(i),Math.floor(s)]})(e,.45,165.75);return"#"+t(e[0])+t(e[1])+t(e[2])}function t(e){e=e.toString(16);return 1==e.length?"0"+e:e}function a(e){var t;return null!=(t=null==(t=i.appTarget)?void 0:t.appTheme)&&t.adjustBlockContrast?(r[e]||(r[e]=i.getWhiteContrastingBackground(e)),r[e]):e}e.appendToolboxIconCss=function(e,t){var r;-1<n.indexOf(e)||(1===t.length?(r=i.Util.unicodeToChar(t),n+=`
                .blocklyTreeIcon.${e}::before {
                    content: "${r}";
                }
            `):n+=`
                .blocklyTreeIcon.${e} {
                    background-image: url("${i.Util.pathJoin(i.webConfig.commitCdnUrl,encodeURI(t))}")!important;
                    width: 30px;
                    height: 100%;
                    background-size: 20px !important;
                    background-repeat: no-repeat !important;
                    background-position: 50% 50% !important;
                }
            `)},e.getNamespaceColor=function(e){e=e.toLowerCase();let t;return i.appTarget.appTheme.blockColors&&i.appTarget.appTheme.blockColors[e]?t=i.appTarget.appTheme.blockColors[e]:i.toolbox.blockColors[e]&&(t=i.toolbox.blockColors[e]),t?a(t):""},e.getNamespaceIcon=function(e){return e=e.toLowerCase(),i.appTarget.appTheme.blockIcons&&i.appTarget.appTheme.blockIcons[e]?i.appTarget.appTheme.blockIcons[e]:i.toolbox.blockIcons[e]||""},e.advancedTitle=function(){return i.Util.lf("{id:category}Advanced")},e.addPackageTitle=function(){return i.Util.lf("{id:category}Extensions")},e.recipesTitle=function(){return i.Util.lf("{id:category}Tutorials")},e.convertColor=function(e){e=(t=e)?"0x"==t.substring(0,2)?"#"+t.substring(2):t:"#000000";var t=parseInt(e);return isNaN(t)?e:s(t)},e.hueToRgb=s,e.fadeColor=function(t,r,n){(t=t.replace(/[^0-9a-f]/gi,"")).length<6&&(t=t[0]+t[0]+t[1]+t[1]+t[2]+t[2]);let i="#";for(let e=0;e<3;e++){var s=parseInt(t.substr(2*e,2),16),s=(s=Math.round(Math.min(Math.max(0,n?s+s*r:s-s*r),255))).toString(16);i+=("00"+s).substr(s.length)}return i},e.getAccessibleBackground=a}})(pxt=pxt||{}),(b=>{{var e=b.tutorial||(b.tutorial={});let _=/^##[^#](.*)$([\s\S]*?)(?=^##[^#]|$(?![\r\n]))/gim,y=/^###[^#](.*)$([\s\S]*?)(?=^###[^#]|$(?![\r\n]))/gim;function v(){return/``` *(sim|block|blocks|filterblocks|spy|ghost|typescript|ts|js|javascript|template|python|jres|assetjson|customts|simtheme|python-template|ts-template|typescript-template|js-template|javascript-template)\s*\n([\s\S]*?)\n```/gim}function T(e,t,o){t=t||_;let l=[];if(e.replace(t,function(e,t,r){var{header:n,hint:i}=((e,t)=>{let r=e=E(e),n;return t?(t=/#+ ~ tutorialhint([\s\S]*)/i,r=e.replace(t,function(e,t){return n=t,""})):(t=e.match(/(^[\s\S]*?\S)\s*((```|\[?\!\[[\s\S]+?\]\(\S+?\)\]?)[\s\S]*)/im))&&2<t.length&&(r=t[1].trim(),n=t[2].trim()),{header:r,hint:n}})(r=r.trim(),o&&o.explicitHints),s=k("local",r),a=x("local",r),r={title:t.match(/^\{.*\}$/)?void 0:t.replace(/@(fullscreen|unplugged|showdialog|showhint|tutorialCompleted|resetDiff)/gi,"").trim(),contentMd:r,headerContentMd:n,localBlockConfig:s,localValidationConfig:a};return/@(fullscreen|unplugged|showdialog|showhint)/i.test(t)&&(r.showHint=!0),/@(unplugged|showdialog)/i.test(t)&&(r.showDialog=!0),/@tutorialCompleted/.test(t)&&(r.tutorialCompleted=!0),/@resetDiff/.test(t)&&(r.resetDiff=!0),i&&(r.hintContentMd=i),l.push(r),""}),0!=e.indexOf("# Not found"))return l;b.debug("tutorial not found")}function k(e,t){let r={md:"",blocks:[]};e=new RegExp(`\`\`\`\\s*blockconfig\\.${e}\\s*\\n([\\s\\S]*?)\\n\`\`\``,"gmi");return t.replace(e,(e,t)=>(r.md+=t+`
`,"")),r}function x(e,t){let r;e=new RegExp(`\`\`\`\\s*validation\\.${e}\\s*\\n([\\s\\S]*?)\\n\`\`\``,"gmi");return t.replace(e,(e,t)=>(r=t,"")),r&&""!=r?{validatorsMetadata:b.getSectionsFromMarkdownMetadata(r).map(e=>({validatorType:e.header,properties:e.attributes}))}:null}function E(e){return e&&e.replace(/```(filterblocks|package|ghost|config|template|jres|assetjson|simtheme|customts|blockconfig\.local|blockconfig\.global|validation\.local|validation\.global)\s*\n([\s\S]*?)\n```/gim,"").trim()}function S(e){if(e)return e=JSON.parse(e),{[b.TILEMAP_JRES]:e[b.TILEMAP_JRES],[b.TILEMAP_CODE]:e[b.TILEMAP_CODE],[b.IMAGES_JRES]:e[b.IMAGES_JRES],[b.IMAGES_CODE]:e[b.IMAGES_CODE]}}function C(e){var t,e=b.Util.jsonTryParse(e);if(e)return t={},e.theme&&(t.theme=e.theme),e.palette&&(t.palette=e.palette),t}e.parseTutorial=function(e){var{metadata:t,body:r}=(e=>{let n={},t=e.replace(/### @(\S+) ([ \S]+)/gi,function(e,t,r){try{n[t]=JSON.parse(r)}catch(e){n[t]=r}return""}),r=n;return void 0!==r.explicitHints&&b.appTarget.appTheme&&b.appTarget.appTheme.tutorialExplicitHints&&(r.explicitHints=!0),{metadata:r,body:t}})(e),{steps:n,activities:i}=((t,r)=>{if(r&&r.activities){var o=r;let s=[],a=[];return t.replace(_,function(e,t,r){let n=a.length,i=(a.push({name:t||lf("Activity {0}",n),step:s.length}),T(r,y,o));return i=i.map(e=>(e.activity=n,e)),s=s.concat(i),""}),{steps:s,activities:a}}{let e=T(t,null,r);return{steps:e=!e||e.length<1?T(t,y,r):e,activities:null}}})(r,t),s=(e=>(e=e.match(/^#[^#](.*)$/im))&&1<e.length?e[1].trim():null)(r);if(n){var{code:r,templateCode:a,templateLanguage:o,editor:l,language:c,jres:u,assetJson:d,customTs:p,simThemeJson:h}=(e=>{let t=void 0,r=v(),n,i=[],s,a,o,l=0,c,u,d;return e.replace(/((?!.)\s)+/g,"\n").replace(r,function(e,t,r){switch(t){case"block":case"blocks":case"blockconfig.local":case"blockconfig.global":case"filterblocks":if(p(b.BLOCKS_PROJECT_NAME))break;return;case"spy":case"python":if(!p(b.PYTHON_PROJECT_NAME))return;"python"==t&&(o=t);break;case"typescript":case"ts":case"javascript":case"js":if(p(b.JAVASCRIPT_PROJECT_NAME))break;return;case"template":s=r;break;case"python-template":if(!p(b.PYTHON_PROJECT_NAME))return;s=r,a="python",o="python";break;case"ts-template":case"typescript-template":case"js-template":case"javascript-template":if(!p(b.JAVASCRIPT_PROJECT_NAME))return;s=r,a="typescript";break;case"jres":n=r;break;case"assetjson":c=r;break;case"simtheme":d=r;break;case"customts":u=r,r=""}return i.push("python"===o?`
${r}
`:`{
${r}
}`),l++,""}),t=t||b.BLOCKS_PROJECT_NAME,{code:i,templateCode:s,templateLanguage:a,editor:t,language:o,jres:n,assetJson:c,customTs:u,simThemeJson:d};function p(e){if(!t||t==e)return t=e,1;b.debug("tutorial ambiguous: contains snippets of different types")}})(r);if(b.BrowserUtils.useOldTutorialLayout()&&"python"===c&&t.flyoutOnly&&(t.flyoutOnly=!1,t.hideToolbox=!0),!0===t.diffs||!1!==t.diffs&&!0!==t.noDiffs&&(l==b.BLOCKS_PROJECT_NAME&&b.appTarget.appTheme.tutorialBlocksDiff||l!=b.BLOCKS_PROJECT_NAME&&b.appTarget.appTheme.tutorialTextDiff)){var m=n;var g=i;let l=void 0;function f(e){let a={typescript:"diff",spy:"diffspy",blocks:"diffblocks",python:"diff"},o=/\s*(\/\/|#)\s*@highlight/gm;return e&&e.replace(/```(typescript|spy|python|blocks|ghost|template)((?:.|[\r\n])+)```/,function(e,t,r){var n=l,i=/^(template|ghost)$/.test(t),s=o.test(r);return r=r.replace(/^\n+/,"").replace(/\n+$/,""),s&&(r=r.replace(o,"")),l=r,!n||s||i?e:`\`\`\`${a[t]}
${n}
----------
${r}
\`\`\``})}m.forEach((e,t)=>{if((e.resetDiff||g&&g.find(e=>e.step==t))&&(l=void 0),e.hintContentMd){var r=f(e.hintContentMd);if(r&&r!=e.hintContentMd)return void(e.hintContentMd=r)}e.headerContentMd&&(r=f(e.headerContentMd))&&r!=e.headerContentMd&&(e.headerContentMd=r)})}m=S(d),d=C(h),h=k("global",e),e=x("global",e);return n.forEach(e=>{e.contentMd=E(e.contentMd),e.headerContentMd=E(e.headerContentMd),e.hintContentMd=E(e.hintContentMd)}),{editor:l,title:s,steps:n,activities:i,code:r,templateCode:a,templateLanguage:o,metadata:t,language:c,jres:u,assetFiles:m,customTs:p,globalBlockConfig:h,globalValidationConfig:e,simTheme:d}}},e.getMetadataRegex=v,e.highlight=function(r){let e=r.textContent;if(e=(e=e.replace(/img\s*\(\s*"{3}[\s\da-f.#tngrpoyw]*"{3}\s*\)/g,'img(""" """)')).replace(/img\s*`[\s\da-f.#tngrpoyw]*`\s*/g,"img` `"),/@highlight/.test(e)){r.textContent="";var n,i=e.split("\n");for(let t=0;t<i.length;++t){0<t&&t<i.length&&r.appendChild(document.createTextNode("\n"));let e=i[t];/@highlight/.test(e)?void 0!==(e=i[++t])&&((n=document.createElement("span")).className="highlight-line",n.textContent=e,r.appendChild(n)):r.appendChild(document.createTextNode(e))}}else r.textContent=e},e.getTutorialOptions=function(e,t,r,n,i){var s=b.tutorial.parseTutorial(e);if(s)return{options:{tutorial:t,tutorialName:s.title||r,tutorialReportId:n,tutorialStep:0,tutorialReady:!0,tutorialHintCounter:0,tutorialStepInfo:s.steps,tutorialActivityInfo:s.activities,tutorialMd:e,tutorialCode:s.code,tutorialRecipe:!!i,templateCode:s.templateCode,templateLanguage:s.templateLanguage,autoexpandStep:null==(t=s.metadata)||!t.autoexpandOff,metadata:s.metadata,language:s.language,jres:s.jres,assetFiles:s.assetFiles,customTs:s.customTs,globalBlockConfig:s.globalBlockConfig,globalValidationConfig:s.globalValidationConfig,simTheme:s.simTheme},editor:s.editor};throw new Error(lf("Invalid tutorial format"))},e.parseCachedTutorialInfo=function(e,i){let s=b.Util.jsonTryParse(e);return s?b.BrowserUtils.tutorialInfoDbAsync().then(e=>{if(i&&s[i]){var t=s[i];t.usedBlocks&&t.hash&&e.setWithHashAsync(i,t.snippetBlocks,t.hash,t.highlightBlocks,t.validateBlocks)}else for(var r of Object.keys(s)){var n=s[r];n.usedBlocks&&n.hash&&e.setWithHashAsync(r,n.snippetBlocks,n.hash,n.highlightBlocks,n.validateBlocks)}}).catch(e=>{}):Promise.resolve()},e.resolveLocalizedMarkdown=function(e,t,r){let n=r||e.fileName||"README",i=(n.endsWith(".md")||(n+=".md"),void 0);var[r,e,s]=b.Util.normalizeLanguageCode(b.Util.userLanguage());return i=(i=r&&e&&s?t[`_locales/${r}/`+n]||t[`_locales/${s}/`+n]||t[`_locales/${e}/`+n]:t[`_locales/${r}/`+n])||t[n]},e.parseAssetJson=S,e.parseSimThemeJson=C,e.getTutorialHighlightedBlocks=async function(e){return null==(e=await(await b.BrowserUtils.tutorialInfoDbAsync()).getAsync(e.tutorial,e.tutorialCode))?void 0:e.highlightBlocks},e.getTutorialValidateBlocks=async function(e){return null==(e=await(await b.BrowserUtils.tutorialInfoDbAsync()).getAsync(e.tutorial,e.tutorialCode))?void 0:e.validateBlocks},e.getRequiredBlockCounts=function(e){if(e){let t={};e=e["validate-exists"];return e&&e.forEach(e=>{t[e]=(t[e]||0)+1}),t}},e.getTutorialStepHash=function(e){var{tutorialStepInfo:e,tutorialStep:t}=e,e=(e=>{let n=[];return null==e||e.replace(/((?!.)\s)+/g,"\n").replace(/``` *(block|blocks)\s*\n([\s\S]*?)\n```/gim,function(e,t,r){return n.push(`{
${r}
}`),""}),n})(e[t].hintContentMd);return b.BrowserUtils.getTutorialCodeHash(e)},e.shouldFilterProject=function(e){return!(!e||!e.hideFromProjects&&!e.hideIteration)}}})(pxt=pxt||{}),(o=>{var e;{var l=o.pxtc||(o.pxtc={});l.flattenDiagnosticMessageText=function(n,i){if("string"==typeof n)return n;{let e=n,t="",r=0;for(;e;){if(r){t+=i;for(let e=0;e<r;e++)t+="  "}t+=e.messageText,r++,e=e.next}return t}};let r,n=((e=r=l.ScriptTarget||(l.ScriptTarget={}))[e.ES3=0]="ES3",e[e.ES5=1]="ES5",e[e.ES6=2]="ES6",e[e.ES2015=2]="ES2015",e[e.Latest=2]="Latest",l.isIdentifierStart=function(e,t){return 65<=e&&e<=90||97<=e&&e<=122||36===e||95===e||127<e&&c(e,t)},l.isIdentifierPart=function(e,t){return 65<=e&&e<=90||97<=e&&e<=122||48<=e&&e<=57||36===e||95===e||127<e&&(e=e,t>=r.ES5?u(e,i):u(e,a))},l.reservedWords=["abstract","any","as","break","case","catch","class","continue","const","constructor","debugger","declare","default","delete","do","else","enum","export","extends","false","finally","for","from","function","get","if","implements","import","in","instanceof","interface","is","let","module","namespace","new","null","package","private","protected","public","require","global","return","set","static","super","switch","symbol","this","throw","true","try","type","typeof","var","void","while","with","yield","async","await","of","Math"],l.keywordTypes=["boolean","number","string"],l.escapeIdentifier=function(e){if(!e)return"_";let t=e.replace(/\s+/g,"_").replace(/[^a-zA-Z0-9_$]/g,e=>o.pxtc.isIdentifierPart(e.charCodeAt(0),o.pxtc.ScriptTarget.ES5)?e:"");return t=t&&o.pxtc.isIdentifierStart(t.charCodeAt(0),o.pxtc.ScriptTarget.ES5)&&-1===l.reservedWords.indexOf(t)?t:"_"+t},[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,880,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1162,1319,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1568,1610,1646,1647,1649,1747,1749,1749,1765,1766,1774,1775,1786,1788,1791,1791,1808,1808,1810,1839,1869,1957,1969,1969,1994,2026,2036,2037,2042,2042,2048,2069,2074,2074,2084,2084,2088,2088,2112,2136,2208,2208,2210,2220,2308,2361,2365,2365,2384,2384,2392,2401,2417,2423,2425,2431,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2493,2493,2510,2510,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2785,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2877,2877,2908,2909,2911,2913,2929,2929,2947,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3024,3024,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3133,3160,3161,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3261,3261,3294,3294,3296,3297,3313,3314,3333,3340,3342,3344,3346,3386,3389,3389,3406,3406,3424,3425,3450,3455,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3807,3840,3840,3904,3911,3913,3948,3976,3980,4096,4138,4159,4159,4176,4181,4186,4189,4193,4193,4197,4198,4206,4208,4213,4225,4238,4238,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5905,5920,5937,5952,5969,5984,5996,5998,6e3,6016,6067,6103,6103,6108,6108,6176,6263,6272,6312,6314,6314,6320,6389,6400,6428,6480,6509,6512,6516,6528,6571,6593,6599,6656,6678,6688,6740,6823,6823,6917,6963,6981,6987,7043,7072,7086,7087,7098,7141,7168,7203,7245,7247,7258,7293,7401,7404,7406,7409,7413,7414,7424,7615,7680,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8305,8305,8319,8319,8336,8348,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11502,11506,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11648,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11823,11823,12293,12295,12321,12329,12337,12341,12344,12348,12353,12438,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42527,42538,42539,42560,42606,42623,42647,42656,42735,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43009,43011,43013,43015,43018,43020,43042,43072,43123,43138,43187,43250,43255,43259,43259,43274,43301,43312,43334,43360,43388,43396,43442,43471,43471,43520,43560,43584,43586,43588,43595,43616,43638,43642,43642,43648,43695,43697,43697,43701,43702,43705,43709,43712,43712,43714,43714,43739,43741,43744,43754,43762,43764,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44002,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500]),i=[170,170,181,181,186,186,192,214,216,246,248,705,710,721,736,740,748,748,750,750,768,884,886,887,890,893,902,902,904,906,908,908,910,929,931,1013,1015,1153,1155,1159,1162,1319,1329,1366,1369,1369,1377,1415,1425,1469,1471,1471,1473,1474,1476,1477,1479,1479,1488,1514,1520,1522,1552,1562,1568,1641,1646,1747,1749,1756,1759,1768,1770,1788,1791,1791,1808,1866,1869,1969,1984,2037,2042,2042,2048,2093,2112,2139,2208,2208,2210,2220,2276,2302,2304,2403,2406,2415,2417,2423,2425,2431,2433,2435,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2492,2500,2503,2504,2507,2510,2519,2519,2524,2525,2527,2531,2534,2545,2561,2563,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2620,2620,2622,2626,2631,2632,2635,2637,2641,2641,2649,2652,2654,2654,2662,2677,2689,2691,2693,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2748,2757,2759,2761,2763,2765,2768,2768,2784,2787,2790,2799,2817,2819,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2869,2873,2876,2884,2887,2888,2891,2893,2902,2903,2908,2909,2911,2915,2918,2927,2929,2929,2946,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,3001,3006,3010,3014,3016,3018,3021,3024,3024,3031,3031,3046,3055,3073,3075,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3133,3140,3142,3144,3146,3149,3157,3158,3160,3161,3168,3171,3174,3183,3202,3203,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3260,3268,3270,3272,3274,3277,3285,3286,3294,3294,3296,3299,3302,3311,3313,3314,3330,3331,3333,3340,3342,3344,3346,3386,3389,3396,3398,3400,3402,3406,3415,3415,3424,3427,3430,3439,3450,3455,3458,3459,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3530,3530,3535,3540,3542,3542,3544,3551,3570,3571,3585,3642,3648,3662,3664,3673,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3769,3771,3773,3776,3780,3782,3782,3784,3789,3792,3801,3804,3807,3840,3840,3864,3865,3872,3881,3893,3893,3895,3895,3897,3897,3902,3911,3913,3948,3953,3972,3974,3991,3993,4028,4038,4038,4096,4169,4176,4253,4256,4293,4295,4295,4301,4301,4304,4346,4348,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4744,4746,4749,4752,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4822,4824,4880,4882,4885,4888,4954,4957,4959,4992,5007,5024,5108,5121,5740,5743,5759,5761,5786,5792,5866,5870,5872,5888,5900,5902,5908,5920,5940,5952,5971,5984,5996,5998,6e3,6002,6003,6016,6099,6103,6103,6108,6109,6112,6121,6155,6157,6160,6169,6176,6263,6272,6314,6320,6389,6400,6428,6432,6443,6448,6459,6470,6509,6512,6516,6528,6571,6576,6601,6608,6617,6656,6683,6688,6750,6752,6780,6783,6793,6800,6809,6823,6823,6912,6987,6992,7001,7019,7027,7040,7155,7168,7223,7232,7241,7245,7293,7376,7378,7380,7414,7424,7654,7676,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8204,8205,8255,8256,8276,8276,8305,8305,8319,8319,8336,8348,8400,8412,8417,8417,8421,8432,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8505,8508,8511,8517,8521,8526,8526,8544,8584,11264,11310,11312,11358,11360,11492,11499,11507,11520,11557,11559,11559,11565,11565,11568,11623,11631,11631,11647,11670,11680,11686,11688,11694,11696,11702,11704,11710,11712,11718,11720,11726,11728,11734,11736,11742,11744,11775,11823,11823,12293,12295,12321,12335,12337,12341,12344,12348,12353,12438,12441,12442,12445,12447,12449,12538,12540,12543,12549,12589,12593,12686,12704,12730,12784,12799,13312,19893,19968,40908,40960,42124,42192,42237,42240,42508,42512,42539,42560,42607,42612,42621,42623,42647,42655,42737,42775,42783,42786,42888,42891,42894,42896,42899,42912,42922,43e3,43047,43072,43123,43136,43204,43216,43225,43232,43255,43259,43259,43264,43309,43312,43347,43360,43388,43392,43456,43471,43481,43520,43574,43584,43597,43600,43609,43616,43638,43642,43643,43648,43714,43739,43741,43744,43759,43762,43766,43777,43782,43785,43790,43793,43798,43808,43814,43816,43822,43968,44010,44012,44013,44016,44025,44032,55203,55216,55238,55243,55291,63744,64109,64112,64217,64256,64262,64275,64279,64285,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65024,65039,65056,65062,65075,65076,65101,65103,65136,65140,65142,65276,65296,65305,65313,65338,65343,65343,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500],s=[170,170,181,181,186,186,192,214,216,246,248,543,546,563,592,685,688,696,699,705,720,721,736,740,750,750,890,890,902,902,904,906,908,908,910,929,931,974,976,983,986,1011,1024,1153,1164,1220,1223,1224,1227,1228,1232,1269,1272,1273,1329,1366,1369,1369,1377,1415,1488,1514,1520,1522,1569,1594,1600,1610,1649,1747,1749,1749,1765,1766,1786,1788,1808,1808,1810,1836,1920,1957,2309,2361,2365,2365,2384,2384,2392,2401,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2524,2525,2527,2529,2544,2545,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2649,2652,2654,2654,2674,2676,2693,2699,2701,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2749,2749,2768,2768,2784,2784,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2870,2873,2877,2877,2908,2909,2911,2913,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,2997,2999,3001,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3168,3169,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3294,3294,3296,3297,3333,3340,3342,3344,3346,3368,3370,3385,3424,3425,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3585,3632,3634,3635,3648,3654,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3760,3762,3763,3773,3773,3776,3780,3782,3782,3804,3805,3840,3840,3904,3911,3913,3946,3976,3979,4096,4129,4131,4135,4137,4138,4176,4181,4256,4293,4304,4342,4352,4441,4447,4514,4520,4601,4608,4614,4616,4678,4680,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4742,4744,4744,4746,4749,4752,4782,4784,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4814,4816,4822,4824,4846,4848,4878,4880,4880,4882,4885,4888,4894,4896,4934,4936,4954,5024,5108,5121,5740,5743,5750,5761,5786,5792,5866,6016,6067,6176,6263,6272,6312,7680,7835,7840,7929,7936,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8319,8319,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8497,8499,8505,8544,8579,12293,12295,12321,12329,12337,12341,12344,12346,12353,12436,12445,12446,12449,12538,12540,12542,12549,12588,12593,12686,12704,12727,13312,19893,19968,40869,40960,42124,44032,55203,63744,64045,64256,64262,64275,64279,64285,64285,64287,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65136,65138,65140,65140,65142,65276,65313,65338,65345,65370,65382,65470,65474,65479,65482,65487,65490,65495,65498,65500],a=[170,170,181,181,186,186,192,214,216,246,248,543,546,563,592,685,688,696,699,705,720,721,736,740,750,750,768,846,864,866,890,890,902,902,904,906,908,908,910,929,931,974,976,983,986,1011,1024,1153,1155,1158,1164,1220,1223,1224,1227,1228,1232,1269,1272,1273,1329,1366,1369,1369,1377,1415,1425,1441,1443,1465,1467,1469,1471,1471,1473,1474,1476,1476,1488,1514,1520,1522,1569,1594,1600,1621,1632,1641,1648,1747,1749,1756,1759,1768,1770,1773,1776,1788,1808,1836,1840,1866,1920,1968,2305,2307,2309,2361,2364,2381,2384,2388,2392,2403,2406,2415,2433,2435,2437,2444,2447,2448,2451,2472,2474,2480,2482,2482,2486,2489,2492,2492,2494,2500,2503,2504,2507,2509,2519,2519,2524,2525,2527,2531,2534,2545,2562,2562,2565,2570,2575,2576,2579,2600,2602,2608,2610,2611,2613,2614,2616,2617,2620,2620,2622,2626,2631,2632,2635,2637,2649,2652,2654,2654,2662,2676,2689,2691,2693,2699,2701,2701,2703,2705,2707,2728,2730,2736,2738,2739,2741,2745,2748,2757,2759,2761,2763,2765,2768,2768,2784,2784,2790,2799,2817,2819,2821,2828,2831,2832,2835,2856,2858,2864,2866,2867,2870,2873,2876,2883,2887,2888,2891,2893,2902,2903,2908,2909,2911,2913,2918,2927,2946,2947,2949,2954,2958,2960,2962,2965,2969,2970,2972,2972,2974,2975,2979,2980,2984,2986,2990,2997,2999,3001,3006,3010,3014,3016,3018,3021,3031,3031,3047,3055,3073,3075,3077,3084,3086,3088,3090,3112,3114,3123,3125,3129,3134,3140,3142,3144,3146,3149,3157,3158,3168,3169,3174,3183,3202,3203,3205,3212,3214,3216,3218,3240,3242,3251,3253,3257,3262,3268,3270,3272,3274,3277,3285,3286,3294,3294,3296,3297,3302,3311,3330,3331,3333,3340,3342,3344,3346,3368,3370,3385,3390,3395,3398,3400,3402,3405,3415,3415,3424,3425,3430,3439,3458,3459,3461,3478,3482,3505,3507,3515,3517,3517,3520,3526,3530,3530,3535,3540,3542,3542,3544,3551,3570,3571,3585,3642,3648,3662,3664,3673,3713,3714,3716,3716,3719,3720,3722,3722,3725,3725,3732,3735,3737,3743,3745,3747,3749,3749,3751,3751,3754,3755,3757,3769,3771,3773,3776,3780,3782,3782,3784,3789,3792,3801,3804,3805,3840,3840,3864,3865,3872,3881,3893,3893,3895,3895,3897,3897,3902,3911,3913,3946,3953,3972,3974,3979,3984,3991,3993,4028,4038,4038,4096,4129,4131,4135,4137,4138,4140,4146,4150,4153,4160,4169,4176,4185,4256,4293,4304,4342,4352,4441,4447,4514,4520,4601,4608,4614,4616,4678,4680,4680,4682,4685,4688,4694,4696,4696,4698,4701,4704,4742,4744,4744,4746,4749,4752,4782,4784,4784,4786,4789,4792,4798,4800,4800,4802,4805,4808,4814,4816,4822,4824,4846,4848,4878,4880,4880,4882,4885,4888,4894,4896,4934,4936,4954,4969,4977,5024,5108,5121,5740,5743,5750,5761,5786,5792,5866,6016,6099,6112,6121,6160,6169,6176,6263,6272,6313,7680,7835,7840,7929,7936,7957,7960,7965,7968,8005,8008,8013,8016,8023,8025,8025,8027,8027,8029,8029,8031,8061,8064,8116,8118,8124,8126,8126,8130,8132,8134,8140,8144,8147,8150,8155,8160,8172,8178,8180,8182,8188,8255,8256,8319,8319,8400,8412,8417,8417,8450,8450,8455,8455,8458,8467,8469,8469,8473,8477,8484,8484,8486,8486,8488,8488,8490,8493,8495,8497,8499,8505,8544,8579,12293,12295,12321,12335,12337,12341,12344,12346,12353,12436,12441,12442,12445,12446,12449,12542,12549,12588,12593,12686,12704,12727,13312,19893,19968,40869,40960,42124,44032,55203,63744,64045,64256,64262,64275,64279,64285,64296,64298,64310,64312,64316,64318,64318,64320,64321,64323,64324,64326,64433,64467,64829,64848,64911,64914,64967,65008,65019,65056,65059,65075,65076,65101,65103,65136,65138,65140,65140,65142,65276,65296,65305,65313,65338,65343,65343,65345,65370,65381,65470,65474,65479,65482,65487,65490,65495,65498,65500];function c(e,t){return t>=r.ES5?u(e,n):u(e,s)}function u(r,n){if(!(r<n[0])){let e=0,t=n.length;for(var i;e+1<t;){if(i=e+(t-e)/2,n[i-=i%2]<=r&&r<=n[1+i])return!0;r<n[i]?t=i:e=2+i}}return!1}l.isUnicodeIdentifierStart=c,(e=l.DiagnosticCategory||(l.DiagnosticCategory={}))[e.Warning=0]="Warning",e[e.Error=1]="Error",e[e.Message=2]="Message"}})(ts=ts||{}),(a=>{var e;{var n=a.webBluetooth||(a.webBluetooth={});function t(){return!!navigator&&!!navigator.bluetooth&&"TextDecoder"in window&&a.appTarget.appTheme.bluetoothUartConsole&&a.appTarget.appTheme.bluetoothUartFilters&&0<a.appTarget.appTheme.bluetoothUartFilters.length}function r(){return!!navigator&&!!navigator.bluetooth&&!!a.appTarget.appTheme.bluetoothPartialFlashing}n.isAvailable=function(){return t()||r()},n.hasConsole=t,n.hasPartialFlash=r,n.isValidUUID=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/.test(e)};class o{constructor(e,t){this.connectionTimeout=2e4,this.connectPromise=void 0,this.id=e,this.aliveToken=t}debug(e){a.debug(this.id+": "+e)}alivePromise(e){return new Promise((t,r)=>{this.aliveToken.isCancelled()&&r(new Error),e.then(e=>t(e),e=>r(e))})}cancelConnect(){this.connectPromise=void 0}createConnectPromise(){return Promise.resolve()}connectAsync(){return this.connectPromise||(this.connectPromise=this.alivePromise(this.createConnectPromise())),a.Util.promiseTimeout(this.connectionTimeout,this.connectPromise,"connection timeout").then(()=>this.aliveToken.throwIfCancelled()).catch(e=>{throw this.connectPromise=void 0,e})}disconnect(){this.cancelConnect()}kill(){this.disconnect(),this.aliveToken.cancel()}}n.BLERemote=o;class l extends o{constructor(e,t,r){super(e,t.aliveToken),this.device=t,this.autoReconnect=r,this.autoReconnectDelay=1e3,this.disconnectOnAutoReconnect=!1,this.reconnectPromise=void 0,this.failedConnectionServicesVersion=-1,this.handleDisconnected=this.handleDisconnected.bind(this),this.device.device.addEventListener("gattserverdisconnected",this.handleDisconnected)}handleDisconnected(e){this.aliveToken.isCancelled()||(this.disconnect(),this.autoReconnect&&!this.reconnectPromise&&(this.reconnectPromise=a.U.delay(this.autoReconnectDelay).then(()=>this.exponentialBackoffConnectAsync(8,500)).finally(()=>this.reconnectPromise=void 0)))}exponentialBackoffConnectAsync(t,r){return this.debug("retry connect"),this.aliveToken.throwIfCancelled(),this.connectAsync().then(()=>{this.aliveToken.throwIfCancelled(),this.debug("reconnect success"),this.reconnectPromise=void 0}).catch(e=>{if(this.debug("reconnect error "+e.message),this.aliveToken.throwIfCancelled(),this.device.isPaired)if(this.autoReconnect)if(0==t)this.debug("give up, max tries");else{if(this.failedConnectionServicesVersion!=this.device.servicesVersion)return this.debug(`retry connect ${r}ms... (${t} tries left)`),this.device.connected&&(this.failedConnectionServicesVersion=this.device.servicesVersion),this.disconnectOnAutoReconnect&&this.device.disconnect(),a.U.delay(r).then(()=>this.exponentialBackoffConnectAsync(--t,1.8*r));this.debug("services haven't changed, giving up")}else this.debug("autoreconnect disabled");else this.debug("give up, device unpaired");this.reconnectPromise=void 0})}}n.BLEService=l;class c extends l{constructor(e,t,r,n){super(e,t,!0),this.device=t,this.serviceUUID=r,this.txCharacteristicUUID=n,this.handleValueChanged=this.handleValueChanged.bind(this)}createConnectPromise(){return this.debug("connecting"),this.device.connectAsync().then(()=>this.alivePromise(this.device.gatt.getPrimaryService(this.serviceUUID))).then(e=>(this.debug("service connected"),this.service=e,this.alivePromise(this.service.getCharacteristic(this.txCharacteristicUUID)))).then(e=>(this.debug("tx characteristic connected"),this.txCharacteristic=e,this.txCharacteristic.addEventListener("characteristicvaluechanged",this.handleValueChanged),this.txCharacteristic.startNotifications())).then(()=>{a.tickEvent("webble.connected",{id:this.id})})}handlePacket(e){}handleValueChanged(e){e=e.target.value;this.handlePacket(e)}disconnect(){if(super.disconnect(),this.txCharacteristic&&this.device&&this.device.connected)try{this.txCharacteristic.stopNotifications(),this.txCharacteristic.removeEventListener("characteristicvaluechanged",this.handleValueChanged)}catch(e){a.log(this.id+": error "+e.message)}this.service=void 0,this.txCharacteristic=void 0}}n.BLETXService=c;class u extends c{constructor(e){super("hf2",e,u.SERVICE_UUID,u.CHARACTERISTIC_TX_UUID),this.device=e}handlePacket(r){var e=r.getUint8(0);switch(192&e){case u.BLEHF2_FLAG_SERIAL_OUT:case u.BLEHF2_FLAG_SERIAL_ERR:var n=Math.min(r.byteLength-1,-193&e);let t="";for(let e=0;e<n;++e)t+=String.fromCharCode(r.getUint8(e+1));t&&window.postMessage({type:"serial",id:this.device.name||"hf2",data:t},"*")}}}u.SERVICE_UUID="b112f5e6-2679-30da-a26e-0273b6043849",u.CHARACTERISTIC_TX_UUID="b112f5e6-2679-30da-a26e-0273b604384a",u.BLEHF2_FLAG_SERIAL_OUT=128,u.BLEHF2_FLAG_SERIAL_ERR=192,n.HF2Service=u;class d extends c{constructor(e){super("uart",e,d.SERVICE_UUID,d.CHARACTERISTIC_TX_UUID),this.device=e}handlePacket(e){e=(new window.TextDecoder).decode(e);e&&window.postMessage({type:"serial",id:this.device.name||"uart",data:e},"*")}}d.SERVICE_UUID="6e400001-b5a3-f393-e0a9-e50e24dcca9e",d.CHARACTERISTIC_TX_UUID="6e400002-b5a3-f393-e0a9-e50e24dcca9e",n.UARTService=d;let s;(e=s=s||{})[e.Idle=1]="Idle",e[e.StatusRequested=2]="StatusRequested",e[e.PairingModeRequested=4]="PairingModeRequested",e[e.RegionDALRequested=8]="RegionDALRequested",e[e.RegionMakeCodeRequested=16]="RegionMakeCodeRequested",e[e.Flash=32]="Flash",e[e.EndOfTransmision=64]="EndOfTransmision",e[e.USBFlashRequired=128]="USBFlashRequired";class p extends l{constructor(e){super("partial flashing",e,!1),this.device=e,this.state=s.Idle,this.disconnectOnAutoReconnect=!0,this.handleCharacteristic=this.handleCharacteristic.bind(this)}clearFlashData(){this.version=0,this.mode=0,this.regions=[],this.chunkDelay=p.CHUNK_MIN_DELAY,this.hex=void 0,this.bin=void 0,this.magicOffset=void 0,this.dalHash=void 0,this.makeCodeHash=void 0,this.flashReject=void 0,this.flashResolve=void 0,this.flashOffset=void 0}createConnectPromise(){return this.debug("connecting to partial flash service"),this.device.connectAsync().then(()=>this.alivePromise(this.device.gatt.getPrimaryService(p.SERVICE_UUID))).then(e=>(this.debug("connecting to characteristic"),this.alivePromise(e.getCharacteristic(p.CHARACTERISTIC_UUID)))).then(e=>(this.debug("starting notifications"),this.pfCharacteristic=e,this.pfCharacteristic.startNotifications(),this.pfCharacteristic.addEventListener("characteristicvaluechanged",this.handleCharacteristic),this.state==s.PairingModeRequested?(this.debug("checking pairing mode"),this.autoReconnect=!1,this.pfCharacteristic.writeValue(new Uint8Array([p.STATUS]))):Promise.resolve()))}disconnect(){if(super.disconnect(),this.flashPacketToken&&this.flashPacketToken.cancel(),this.pfCharacteristic&&this.device.connected)try{this.pfCharacteristic.stopNotifications(),this.pfCharacteristic.removeEventListener("characteristicvaluechanged",this.handleCharacteristic)}catch(e){a.log("ble: partial flash disconnect error "+e.message)}this.pfCharacteristic=void 0}findMarker(r,n){if(this.bin)for(;r+n.length<this.bin.length;r+=16){let t=!0;for(let e=0;e<n.length;++e)if(n[e]!=this.bin[r+e]){t=!1;break}if(t)return r}return-1}flashAsync(e){return this.hex?(this.debug("flashing already in progress"),Promise.resolve()):(this.device.pauseLog(),this.createFlashPromise(e).finally(()=>this.device.resumeLogOnDisconnection()))}createFlashPromise(e){if(this.hex)return this.debug("flashing already in progress"),Promise.resolve();this.clearFlashData(),this.hex=e;var e=ts.pxtc.UF2.newBlockFile(),t=(ts.pxtc.UF2.writeHex(e,this.hex.split(/\r?\n/)),a.appTarget.compile.flashUsableEnd),e=(this.bin=ts.pxtc.UF2.toBin(a.U.stringToUint8Array(ts.pxtc.UF2.serializeFile(e)),t).buf,this.debug("bin bytes "+this.bin.length),this.magicOffset=this.findMarker(0,p.MAGIC_MARKER),this.debug("magic block "+this.magicOffset.toString(16)),this.magicOffset<0&&(this.debug("magic block not found, not a valid HEX file"),a.U.userError(lf("Invalid file"))),this.debug("bytes to flash "+(this.bin.length-this.magicOffset)),this.magicOffset+p.MAGIC_MARKER.length);return this.dalHash=a.Util.toHex(this.bin.slice(e,e+8)),this.makeCodeHash=a.Util.toHex(this.bin.slice(e+8,e+16)),this.debug("DAL hash "+this.dalHash),this.debug("MakeCode hash "+this.makeCodeHash),this.connectAsync().then(()=>new Promise((e,t)=>(this.flashResolve=e,this.flashReject=t,this.debug("check service version"),this.state=s.StatusRequested,this.pfCharacteristic.writeValue(new Uint8Array([p.STATUS]))))).then(()=>{},e=>{a.log("pf: error "+e.message),this.clearFlashData()})}checkStateTransition(e,t){return!!(this.state&t)||(this.debug(`flash cmd ${e} in state ${this.state.toString(16)} `),this.flashReject(new Error),this.clearFlashData(),!1)}handleCharacteristic(e){this.aliveToken.isCancelled()&&(this.flashReject(new Error),this.clearFlashData());var t=event.target.value,r=new Uint8Array(t.buffer),n=r[0];if(this.state!=s.Idle)switch(n){case p.STATUS:this.checkStateTransition(n,s.StatusRequested|s.PairingModeRequested)&&(this.version=r[1],this.mode=r[2],this.debug(`flash service version ${this.version} mode `+this.mode),this.debug("reading DAL region"),this.state=s.RegionDALRequested,this.pfCharacteristic.writeValue(new Uint8Array([p.REGION_INFO,p.REGION_DAL])).then(()=>{}));break;case p.REGION_INFO:if(this.checkStateTransition(n,s.RegionDALRequested|s.RegionMakeCodeRequested)){var i=this.regions[r[1]]={start:r[2]<<24|r[3]<<16|r[4]<<8|r[5],end:r[6]<<24|r[7]<<16|r[8]<<8|r[9],hash:a.Util.toHex(r.slice(10))};if(this.debug(`read region ${r[1]} start ${i.start.toString(16)} end ${i.end.toString(16)} hash `+i.hash),r[1]==p.REGION_DAL){if(i.hash!=this.dalHash)return a.tickEvent("webble.flash.DALrequired"),this.debug("DAL hash does not match, partial flashing not possible"),this.state=s.USBFlashRequired,this.flashReject(new Error("USB flashing required")),void this.clearFlashData();this.debug("DAL hash match, reading makecode region"),this.state=s.RegionMakeCodeRequested,this.pfCharacteristic.writeValue(new Uint8Array([p.REGION_INFO,p.REGION_MAKECODE])).then(()=>{})}else if(r[1]==p.REGION_MAKECODE)if(i.start!=this.magicOffset&&(this.debug("magic offset and MakeCode region.start not matching"),a.U.userError(lf("Invalid file"))),i.hash==this.makeCodeHash)a.tickEvent("webble.flash.noop"),this.debug("MakeCode hash matches, same code!"),this.debug("restart application mode"),this.pfCharacteristic.writeValue(new Uint8Array([p.RESET,p.MODE_APPLICATION])).then(()=>{this.state=s.Idle,this.flashResolve(),this.clearFlashData()});else{if(this.mode!=p.MODE_PAIRING)return this.debug("application mode, reset into pairing mode"),this.state=s.PairingModeRequested,this.autoReconnect=!0,void this.pfCharacteristic.writeValue(new Uint8Array([p.RESET,p.MODE_PAIRING])).then(()=>{});this.flashOffset=i.start,this.flashPacketNumber=0,this.debug("starting to flash from address "+this.flashOffset.toString(16)),this.flashNextPacket()}}break;case p.FLASH_DATA:if(this.checkStateTransition(n,s.Flash))switch(r[1]){case p.PACKET_OUT_OF_ORDER:this.debug("packet out of order"),this.flashPacketToken.cancel(),this.flashPacketNumber+=4,this.chunkDelay=Math.min(this.chunkDelay+10,p.CHUNK_MAX_DELAY),this.flashNextPacket();break;case p.PACKET_WRITTEN:this.chunkDelay=Math.max(this.chunkDelay-1,p.CHUNK_MIN_DELAY),this.flashOffset+=64,this.flashPacketNumber+=4,this.flashOffset>=this.bin.length?(this.debug("end transmission"),this.state=s.EndOfTransmision,this.pfCharacteristic.writeValue(new Uint8Array([p.END_OF_TRANSMISSION])).finally(()=>{this.flashResolve&&this.flashResolve(),this.clearFlashData()})):this.flashNextPacket()}break;default:this.debug("unknown message "+a.Util.toHex(r)),this.disconnect()}}flashNextPacket(){this.state=s.Flash,this.flashPacketToken=new a.Util.CancellationToken,this.flashPacketToken.startOperation();let t=this.bin.slice(this.flashOffset,this.flashOffset+64),r=(this.debug(`flashing ${this.flashOffset.toString(16)} / ${this.bin.length.toString(16)} ${(this.flashOffset-this.magicOffset)/(this.bin.length-this.magicOffset)*100>>0}%`),new Uint8Array(20));a.U.delay(this.chunkDelay).then(()=>{this.flashPacketToken.throwIfCancelled(),r[0]=p.FLASH_DATA,r[1]=this.flashOffset>>8&255,r[2]=this.flashOffset>>0&255,r[3]=this.flashPacketNumber;for(let e=0;e<16;e++)r[4+e]=t[e];return this.pfCharacteristic.writeValue(r)}).then(()=>a.U.delay(this.chunkDelay)).then(()=>{this.flashPacketToken.throwIfCancelled(),r[0]=p.FLASH_DATA,r[1]=this.flashOffset>>24&255,r[2]=this.flashOffset>>16&255,r[3]=this.flashPacketNumber+1;for(let e=0;e<16;e++)r[4+e]=t[16+e]||0;return this.pfCharacteristic.writeValue(r)}).then(()=>a.U.delay(this.chunkDelay)).then(()=>{this.flashPacketToken.throwIfCancelled(),r[0]=p.FLASH_DATA,r[1]=0,r[2]=0,r[3]=this.flashPacketNumber+2;for(let e=0;e<16;e++)r[4+e]=t[32+e]||0;return this.pfCharacteristic.writeValue(r)}).then(()=>a.U.delay(this.chunkDelay)).then(()=>{this.flashPacketToken.throwIfCancelled(),r[0]=p.FLASH_DATA,r[1]=0,r[2]=0,r[3]=this.flashPacketNumber+3;for(let e=0;e<16;e++)r[4+e]=t[48+e]||0;return this.pfCharacteristic.writeValue(r)}).then(()=>{let e=this.flashOffset,t=()=>a.U.delay(500).then(()=>{if(e!=this.flashOffset||this.flashPacketToken.isCancelled()||this.aliveToken.isCancelled()||this.state!=s.Flash)return Promise.resolve();this.debug("packet transfer deadlock, force restart"),r[0]=p.FLASH_DATA,r[1]=0,r[2]=0,r[3]=-1;for(let e=0;e<16;e++)r[4+e]=0;return this.pfCharacteristic.writeValue(r).then(()=>t())});t().catch(e=>{this.flashReject&&(this.flashReject(new Error("failed packet transfer")),this.clearFlashData())})}).catch(()=>{this.flashPacketToken.resolveCancel()})}}p.SERVICE_UUID="e97dd91d-251d-470a-a062-fa1922dfa9a8",p.CHARACTERISTIC_UUID="e97d3b10-251d-470a-a062-fa1922dfa9a8",p.REGION_INFO=0,p.FLASH_DATA=1,p.PACKET_OUT_OF_ORDER=170,p.PACKET_WRITTEN=255,p.END_OF_TRANSMISSION=2,p.STATUS=238,p.RESET=255,p.MODE_PAIRING=0,p.MODE_APPLICATION=1,p.REGION_SOFTDEVICE=0,p.REGION_DAL=1,p.REGION_MAKECODE=2,p.MAGIC_MARKER=a.Util.fromHex("708E3B92C615A841C49866C975EE5197"),p.CHUNK_MIN_DELAY=0,p.CHUNK_MAX_DELAY=75,n.PartialFlashingService=p;class h extends o{constructor(e){super("ble",new a.Util.CancellationToken),this.device=void 0,this.services=[],this.pendingResumeLogOnDisconnection=!1,this.servicesVersion=0,this.device=e,this.handleDisconnected=this.handleDisconnected.bind(this),this.handleServiceAdded=this.handleServiceAdded.bind(this),this.handleServiceChanged=this.handleServiceChanged.bind(this),this.handleServiceRemoved=this.handleServiceRemoved.bind(this),this.device.addEventListener("gattserverdisconnected",this.handleDisconnected),this.device.addEventListener("serviceadded",this.handleServiceAdded),this.device.addEventListener("servicechanged",this.handleServiceChanged),this.device.addEventListener("serviceremoved",this.handleServiceRemoved),t()&&(this.services.push(this.uartService=new d(this)),this.services.push(this.hf2Service=new u(this))),r()&&this.services.push(this.partialFlashingService=new p(this)),this.aliveToken.startOperation()}startServices(){this.services.filter(e=>e.autoReconnect).forEach(e=>e.connectAsync().catch(()=>{}))}pauseLog(){this.uartService&&(this.uartService.autoReconnect=!1,this.uartService.disconnect()),this.hf2Service&&(this.hf2Service.autoReconnect=!1,this.hf2Service.disconnect())}resumeLogOnDisconnection(){this.pendingResumeLogOnDisconnection=!0}resumeLog(){this.uartService&&(this.uartService.autoReconnect=!0,this.uartService.connectAsync().catch(()=>{})),this.hf2Service&&(this.hf2Service.autoReconnect=!0,this.hf2Service.connectAsync().catch(()=>{}))}get isPaired(){return this===n.bleDevice}get name(){return this.device.name||"?"}get connected(){return this.device&&this.device.gatt&&this.device.gatt.connected}get gatt(){return this.device.gatt}createConnectPromise(){return this.debug("connecting gatt server"),this.alivePromise(this.device.gatt.connect().then(()=>this.debug("gatt server connected")))}handleServiceAdded(e){this.debug("service added"),this.servicesVersion++}handleServiceRemoved(e){this.debug("service removed"),this.servicesVersion++}handleServiceChanged(e){this.debug("service changed"),this.servicesVersion++}handleDisconnected(e){this.debug("disconnected"),this.disconnect(),this.pendingResumeLogOnDisconnection&&(this.pendingResumeLogOnDisconnection=!1,a.U.delay(500).then(()=>this.resumeLog()))}disconnect(){if(super.disconnect(),this.services.forEach(e=>e.disconnect()),this.connected){this.debug("disconnect");try{this.device.gatt&&this.device.gatt.connected&&this.device.gatt.disconnect()}catch(e){this.debug("gatt disconnect error "+e.message)}}}}function i(){if(n.bleDevice)return Promise.resolve();a.log("ble: requesting device");var e=[];return t()&&(e.push(d.SERVICE_UUID),e.push(u.SERVICE_UUID)),r()&&e.push(p.SERVICE_UUID),navigator.bluetooth.requestDevice({filters:a.appTarget.appTheme.bluetoothUartFilters,optionalServices:e}).then(e=>(a.log("ble: received device "+e.name),n.bleDevice=new h(e),n.bleDevice.startServices(),n.bleDevice.connectAsync()))}n.BLEDevice=h,n.bleDevice=void 0,n.isPaired=function(){return!!n.bleDevice},n.pairAsync=function(){return n.bleDevice&&(n.bleDevice.kill(),n.bleDevice=void 0),i().catch(e=>{n.bleDevice&&n.bleDevice.aliveToken&&n.bleDevice.aliveToken.resolveCancel(),a.log("ble: error "+e.message)})},n.flashAsync=function(e,t){a.tickEvent("webble.flash");let r=e.outfiles[ts.pxtc.BINARY_HEX];return i().then(()=>n.bleDevice.partialFlashingService.flashAsync(r)).then(()=>a.tickEvent("webble.flash.success")).catch(e=>{throw a.tickEvent("webble.fail.fail",{message:e.message}),e})}}})(pxt=pxt||{}),(s=>{{var i=s.usb||(s.usb={});class c extends Error{constructor(e){super(e),this.message=e}}i.USBError=c,i.filters=[{classCode:255,subclassCode:42}];let n=!0;i.setFilters=function(e){n=!1,i.filters=e};class u{constructor(){this.ready=!1,this.connecting=!1,this.readLoopStarted=!1,this.onDeviceConnectionChanged=e=>{},this.onConnectionChanged=()=>{},this.onData=e=>{},this.onError=e=>{},this.onEvent=e=>{},this.enabled=!1,this.handleUSBConnected=this.handleUSBConnected.bind(this),this.handleUSBDisconnected=this.handleUSBDisconnected.bind(this)}enable(){var e;this.enabled||(this.enabled=!0,this.log("registering webusb events"),null!=(e=navigator.usb)&&e.addEventListener("disconnect",this.handleUSBDisconnected,!1),null!=(e=navigator.usb)&&e.addEventListener("connect",this.handleUSBConnected,!1))}disable(){var e;this.enabled&&(this.enabled=!1,this.log("unregistering webusb events"),null!=(e=navigator.usb)&&e.removeEventListener("disconnect",this.handleUSBDisconnected),null!=(e=navigator.usb))&&e.removeEventListener("connect",this.handleUSBConnected)}async disposeAsync(){this.disable()}handleUSBDisconnected(e){this.log("device disconnected"),e.device==this.dev&&(this.log("clear device"),this.clearDev(),null!=(e=this.onDeviceConnectionChanged))&&e.call(this,!1)}handleUSBConnected(e){var e=e.device;this.log("device connected "+e.serialNumber),this.dev||this.connecting||(this.log("attach device"),null!=(e=this.onDeviceConnectionChanged)&&e.call(this,!0))}clearDev(){var e;this.dev&&(this.dev=null,this.epIn=null,(this.epOut=null)!=(e=this.onConnectionChanged))&&e.call(this)}error(e){throw new c(s.U.lf("USB error on device {0} ({1})",this.dev.productName,e))}log(e){s.debug("webusb: "+e)}async disconnectAsync(){if(this.ready=!1,this.dev){this.log("close device");try{await this.dev.close()}catch(e){}this.clearDev(),await s.U.delay(500)}}async forgetAsync(){var e;if(null==(e=this.dev)||!e.forget)return!1;try{var t=this.dev;return await this.disconnectAsync(),await t.forget(),!0}catch(e){return!1}}async reconnectAsync(){this.log("reconnect"),this.setConnecting(!0);try{await this.disconnectAsync();var e=await r();await this.connectAsync(e)}finally{this.setConnecting(!1)}}setConnecting(e){e!=this.connecting&&(this.connecting=e,null!=(e=this.onConnectionChanged))&&e.call(this)}isConnecting(){return this.connecting}isConnected(){return!!this.dev&&this.ready}async connectAsync(t){var e,r;if(this.log(`trying to connect (${t.length} devices)`),0==t.length)throw(e=new Error("Device not found.")).type="devicenotfound",e;this.setConnecting(!0);try{this.lastKnownDeviceSerialNumber&&((r=t.find(e=>e.serialNumber===this.lastKnownDeviceSerialNumber))?(this.log("last known device spotted"),t.splice(t.indexOf(r),1),t.unshift(r)):(this.log("delay for last known device"),await s.U.delay(2e3)));for(let e=0;e<t.length;++e){var n=t[e];this.dev=n,this.log(`connect device: ${n.manufacturerName} `+n.productName),this.log(`serial number: ${n.serialNumber} ${this.lastKnownDeviceSerialNumber===n.serialNumber?"(last known device)":""} `);try{return void await this.initAsync()}catch(e){this.dev=void 0,this.log("connection failed, "+e.message)}}var i=new Error(s.U.lf("Device in use or not found."));throw i.type="devicelocked",i}finally{this.setConnecting(!1)}}async sendPacketAsync(e){if(!this.dev)throw new Error("Disconnected");s.Util.assert(e.length<=64),this.epOut?"ok"!=(await this.dev.transferOut(this.epOut.endpointNumber,e)).status&&this.error("USB OUT transfer failed"):"ok"!=(await this.dev.controlTransferOut({requestType:"class",recipient:"interface",request:9,value:512,index:this.iface.interfaceNumber},e)).status&&this.error("USB CTRL OUT transfer failed")}async readLoop(){if(!this.readLoopStarted)for(this.readLoopStarted=!0,this.log("start read loop");;)if(this.ready)try{var e=await this.recvPacketAsync();e[0]?this.onData(e):await s.U.delay(500)}catch(e){this.dev&&this.onError(e),await s.U.delay(300)}else await s.U.delay(300)}async recvPacketAsync(e){for(var t=Date.now();!e||Date.now()<t+e;){if(!this.dev)throw new Error("Disconnected");var r=await(this.epIn?this.dev.transferIn(this.epIn.endpointNumber,64):this.dev.controlTransferIn({requestType:"class",recipient:"interface",request:1,value:256,index:this.iface.interfaceNumber},64)),r=("ok"!=r.status&&this.error("USB IN transfer failed"),new Uint8Array(r.data.buffer));if(0!=r.length)return r}this.error("USB IN timed out")}async initAsync(){if(!this.dev)throw new Error("Disconnected");var e=this.dev,t=(this.log("open device"),await e.open(),this.log("select configuration"),await e.selectConfiguration(1),this.log("got "+e.configurations[0].interfaces.length+" interfaces"),e.configurations[0].interfaces.filter(e=>{var t,r=e.alternates[0];for(t of i.filters)if((null==t.classCode||r.interfaceClass===t.classCode)&&!(null!=t.subclassCode&&r.interfaceSubclass!==t.subclassCode||null!=t.protocolCode&&r.interfaceProtocol!==t.protocolCode)){if(0==r.endpoints.length)return!0;if(2==r.endpoints.length&&r.endpoints.every(e=>64==e.packetSize))return!0}return!1})),r=t[t.length-1];this.log(t.length+" matching interfaces; picking "+(r?"#"+r.interfaceNumber:"n/a")),r||this.error("cannot find supported USB interface"),this.altIface=r.alternates[0],this.iface=r,this.altIface.endpoints.length?(this.log("using dedicated endpoints"),this.epIn=this.altIface.endpoints.filter(e=>"in"==e.direction)[0],this.epOut=this.altIface.endpoints.filter(e=>"out"==e.direction)[0],s.Util.assert(64==this.epIn.packetSize),s.Util.assert(64==this.epOut.packetSize)):this.log("using ctrl pipe"),this.log("claim interface"),await e.claimInterface(r.interfaceNumber),this.log("device ready"),this.lastKnownDeviceSerialNumber=this.dev.serialNumber,this.ready=!0,n&&this.readLoop(),null!=(t=this.onConnectionChanged)&&t.call(this)}}async function r(){var e;s.log("webusb: get devices");try{return await(null==(e=navigator.usb)?void 0:e.getDevices())||[]}catch(e){return s.reportException(e),[]}}i.pairAsync=async function(){var e;try{return!!await(null==(e=navigator.usb)?void 0:e.requestDevice({filters:i.filters}))}catch(e){if("NotFoundError"!=e.name)throw e}},i.tryGetDevicesAsync=r;let e,t=(i.mkWebUSBHIDPacketIOAsync=function(){return s.debug("packetio: mk webusb io"),(e=e||new u).enable(),Promise.resolve(e)},i.forgetDeviceAsync=async function(){return s.debug("packetio: forget webusb io"),!!e&&e.forgetAsync()},i.isEnabled=!1,i.setEnabled=function(e){l()||(e=!1),i.isEnabled=e},void 0);async function a(){if(void 0===t)if(s.debug("webusb: checking availability"),null!=(e=null==(e=s.appTarget)?void 0:e.compile)&&e.webUSB){var e=await o();if(e)switch(t=!1,s.tickEvent("webusb.off",{reason:e}),e){case"electron":s.debug("webusb: off, electron");break;case"notimpl":s.debug("webusb: off, not implemented by browser");break;case"oldwindows":s.debug("webusb: off, older windows version");break;case"security":s.debug("webusb: off, security exception")}else t=!0}else t=!1}async function o(){if(s.BrowserUtils.isElectron())return"electron";var e=navigator.usb;if(!e)return"notimpl";var t=/Windows NT (\d+\.\d+)/.exec(navigator.userAgent);if(t&&parseFloat(t[1])<6.3)return"oldwindows";try{await e.getDevices()}catch(e){return"security"}}function l(){return void 0===t&&(s.error("checkAvailableAsync not called"),a()),!!t}i.checkAvailableAsync=a,i.getReasonUnavailable=o,i.isAvailable=l}})(pxt=pxt||{}),(s=>{{var e=s.worker||(s.worker={}),n=s.Util;let r={};function a(s){let a={},o=0,e=new n.PromiseQueue,t=new Promise((e,t)=>{a.ready=e});e.enqueue("main",()=>t);return{opAsync:function(n,i){return e.enqueue("main",()=>new Promise((t,r)=>{var e=""+o++;a[e]=e=>{e?e.errorMessage?r(new Error(e.errorMessage)):t(e):r(new Error("no response"))},s({id:e,op:n,arg:i})}))},recvHandler:e=>{var t;a.hasOwnProperty(e.id)&&(t=a[e.id],delete a[e.id],t(e.result))}}}function i(e){let t=new Worker(e),r=a(e=>t.postMessage(e));return t.onmessage=e=>{s.perf.measureStart(Measurements.WebworkerRecvHandler),r.recvHandler(e.data),s.perf.measureEnd(Measurements.WebworkerRecvHandler)},r}e.getWorker=function(e){let t=r[e];return t=t||(r[e]=i(e))},e.wrap=a,e.makeWebWorker=i,e.makeWebSocket=function(e,t=null){let r=new WebSocket(e),n=[],i=a(e=>{e=JSON.stringify(e);n?n.push(e):r.send(e)});return r.onmessage=e=>{e=JSON.parse(e.data);t&&null==e.id?t(e):i.recvHandler(e)},r.onopen=e=>{s.debug("socket opened");for(var t of n)r.send(t);n=null},r.onclose=e=>{s.debug("socket closed")},r.onerror=e=>{s.debug("socket errored")},i}}})(pxt=pxt||{}),(s=>{var a;function o(){a.apiKey||s.U.userError("YouTube API key missing")}(a=s.youtube||(s.youtube={})).apiKey=void 0,a.playlistItemToCodeCard=function(e){return{name:e.snippet.title.replace(/[^-]*-/,"").trim(),description:e.snippet.description.split(/\n\s+/,1)[0].trim(),youTubeId:e.snippet.resourceId.videoId,youTubePlaylistId:e.snippet.playlistId,imageUrl:(e=e.snippet.thumbnails)&&(null==(e=e.medium||e.high||e.standard||e.default)?void 0:e.url)||""}},a.playlistInfoAsync=function(e){return o(),e=`https://www.googleapis.com/youtube/v3/playlists?part=snippet&id=${e}&key=`+a.apiKey,s.Util.httpGetJsonAsync(e).then(e=>e.items[0])},a.listPlaylistVideosAsync=async function(t){o();let r=[],n=void 0;do{let e=`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=50&playlistId=${t}&key=`+a.apiKey;n&&(e+="&pageToken="+n);var i=await s.Util.httpGetJsonAsync(e);r=r.concat(i.items),n=i.nextPageToken}while(n);return s.options.debug&&s.debug(JSON.stringify(r,null,2)),r},a.watchUrl=function(e,t){let r=void 0;return e?(r="https://www.youtube.com/watch?v="+e,t&&(r+="&list="+t)):t&&(r="https://www.youtube.com/playlist?list="+t),r}})(pxt=pxt||{}),(e=>{var m=e.pxtc||(e.pxtc={});{var g=m.assembler||(m.assembler={});function f(e,...r){return e.replace(/{(\d+)}/g,(e,t)=>r[+t])}g.debug=!1,g.lf=f;let e=_("opcode name doesn't match","<name>");class a{constructor(e,t,r,n,i){this.opcode=r,this.mask=n,this.is32bit=i,this.canBeShared=!1,m.assert((r&n)==r),this.ei=e,this.code=t.replace(/\s+/g," "),this.friendlyFmt=t.replace(/\$\w+/g,e=>this.ei.encoders[e]?this.ei.encoders[e].pretty:e);i=o(t);this.name=i[0],this.args=i.slice(1)}emit(r){var n=r.words;if(n[0]!=this.name)return e;let i=this.opcode,s=1,a=0;var o=[];let l=null,c=null,u=null;for(let e=0;e<this.args.length;++e){var d=this.args[e];let t=n[s++];if("$"==d[0]){var p=this.ei.encoders[d];let e=null;if(p.isRegister){if(null==(e=this.ei.registerNo(t)))return _("expecting register name",t);this.ei.isPush(this.opcode)?a++:this.ei.isPop(this.opcode)&&a--}else if(p.isImmediate){if(t=t.replace(/^#/,""),null==(e=r.bin.parseOneInt(t)))return _("expecting number",t);this.ei.isAddSP(this.opcode)?a=-(e/this.ei.wordSize()):this.ei.isSubSP(this.opcode)&&(a=e/this.ei.wordSize())}else if(p.isRegList){if("{"!=t)return _("expecting {",t);for(e=0;"}"!=n[s];){if(!(t=n[s++]))return _("expecting }",n[s-2]);var h=this.ei.registerNo(t);if(null==h)return _("expecting register name",t);if(e&1<<h)return _("duplicate register name",t);e|=1<<h,this.ei.isPush(this.opcode)?a++:this.ei.isPop(this.opcode)&&a--,","==n[s]&&s++}t=n[s++]}else if(p.isLabel){if(t=t.replace(/^#/,""),/^[+-]?\d+$/.test(t))e=parseInt(t,10),l="rel"+e;else if(/^0x[0-9a-fA-F]+$/.test(t))e=parseInt(t,16),l="abs"+e;else if(l=t,null==(e=this.ei.getAddressFromLabel(r.bin,this,t,p.isWordAligned))){if(r.bin.finalEmit)return _("unknown label",t);e=8}if(this.ei.is32bit(this)){c=e,u=t;continue}}else m.oops();if(null==e)return _("didn't understand it",t);if(o.push(e),null==(e=p.encode(e)))return _("argument out of range or mis-aligned",t);m.assert(0==(i&e)),i|=e}else if(d!=t)return _("expecting "+d,t)}return n[s]?_("trailing tokens",n[s]):this.ei.is32bit(this)?this.ei.emit32(i,c,r.bin.normalizeExternalLabel(u)):{stack:a,opcode:i,numArgs:o,labelName:r.bin.normalizeExternalLabel(l)}}toString(){return this.friendlyFmt}}g.Instruction=a;class l{constructor(e,t){this.bin=e,this.text=t}getOpExt(){return this.instruction?this.instruction.code:""}getOp(){return this.instruction?this.instruction.name:""}update(e){this.bin.peepOps++,(e=e.replace(/^\s*/,""))||this.bin.peepDel++,e&&(e+="      "),this.text=(e="    "+e)+"; WAS: "+this.text.trim(),this.instruction=null,this.numArgs=null,this.words=o(e)||[],0==this.words.length?this.type="empty":"@"==this.words[0][0]&&(this.type="directive")}}g.Line=l;class c{constructor(e,t){this.id=e,this.description=t,this.sizeAdj=0,this.users=[]}get size(){return this.endLocation-this.startLocation-this.sizeAdj}}class u{constructor(e){this.baseOffset=0,this.checkStack=!0,this.inlineMode=!1,this.normalizeExternalLabel=e=>e,this.currLineNo=0,this.scope="",this.scopeId=0,this.errors=[],this.labels={},this.equs={},this.stackpointers={},this.stack=0,this.commPtr=0,this.peepOps=0,this.peepDel=0,this.peepCounts={},this.stats="",this.throwOnError=!1,this.disablePeepHole=!1,this.stackAtLabel={},this.codeSizeStats=!1,this.labelToObject={},this.idToObject={},this.objSuspendStart=0,this.labelsToObjectDone=!1,this.currLine=new l(this,"<start>"),this.currLine.lineNo=0,this.ei=e,this.ei.file=this}emitShort(e){m.assert(0<=e&&e<=65535),this.buf.push(e)}emitOpCode(e){this.emitShort(e)}location(){return 2*this.buf.length}pc(){return this.location()+this.baseOffset}useLabel(e){this.currObject&&"."!=e[0]&&!this.objSuspendStart&&(e=m.U.lookup(this.labelToObject,e))&&e!=this.currObject&&e.users.length<5&&e.users.indexOf(this.currObject)<0&&e.users.push(this.currObject)}parseOneInt(e){if(!e)return null;if(/^\d+$/.test(e))return parseInt(e,10);var t=e.indexOf("-");if(0<t)return this.parseOneInt(e.slice(0,t))-this.parseOneInt(e.slice(t+1));let r=1;if(0<=e.indexOf("*"))for(var n;null!=(n=/^([^\*]*)\*(.*)$/.exec(e));){var i=this.parseOneInt(n[1]);if(null==i)return null;r*=i,e=n[2]}if("-"==e[0]?(r*=-1,e=e.slice(1)):"+"==e[0]&&(e=e.slice(1)),/^\d+$/.test(e))return r*parseInt(e,10);if(m.U.endsWith(e,"|1"))return 1|this.parseOneInt(e.slice(0,e.length-2));if(m.U.endsWith(e,"-1"))return this.parseOneInt(e.slice(0,e.length-2))-1;if(m.U.endsWith(e,"+1"))return this.parseOneInt(e.slice(0,e.length-2))+1;var s,t=/(.*)>>(\d+)$/.exec(e);if(t)return s=this.parseOneInt(t[1]),(s&=~(-16777216&this.baseOffset))>>parseInt(t[2]);let a=null;return"0"==e[0]&&("x"==e[1]||"X"==e[1]?(s=/^0x([a-f0-9]+)$/i.exec(e))&&(a=parseInt(s[1],16)):"b"!=e[1]&&"B"!=e[1]||(t=/^0b([01]+)$/i.exec(e))&&(a=parseInt(t[1],2))),0<=e.indexOf("@")&&((s=/^(\w+)@(-?\d+)$/.exec(e))&&(1!=r&&this.directiveError(f("multiplication not supported with saved stacks")),this.stackpointers.hasOwnProperty(s[1])?a=this.ei.wordSize()*this.ei.computeStackOffset(s[1],this.stack-this.stackpointers[s[1]]+parseInt(s[2])):this.directiveError(f("saved stack not found"))),s=/^(.*)@(hi|lo|fn)$/.exec(e))&&this.looksLikeLabel(s[1])&&null!=(a=this.lookupLabel(s[1],!0))&&("fn"==s[2]?a=this.ei.toFnPtr(a,this.baseOffset,s[1]):0<=(a>>=1)&&a<=65535?"hi"==s[2]?a=a>>8&255:"lo"==s[2]?a&=255:m.oops():(this.directiveError(f("@hi/lo out of range")),a=null)),null==a&&this.looksLikeLabel(e)&&null!=(a=this.lookupLabel(e,!0))&&1==this.ei.postProcessRelAddress(this,1)&&(a+=this.baseOffset),null==a||isNaN(a)?null:a*r}looksLikeLabel(e){return!/^(r\d|pc|sp|lr)$/i.test(e)&&/^[\.a-zA-Z_][\.:\w+]*$/.test(e)}scopedName(e){return"."==e[0]&&this.scope?this.scope+"$"+e:e}lookupLabel(e,t=!1){this.useLabel(e);let r=null;var n=this.scopedName(e);return this.labels.hasOwnProperty(n)?(r=this.labels[n],r=this.ei.postProcessRelAddress(this,r)):this.lookupExternalLabel&&null!=(r=this.lookupExternalLabel(e))&&(r=this.ei.postProcessAbsAddress(this,r)),null==(r=null==r&&this.equs.hasOwnProperty(n)?this.equs[n]:r)&&t&&(this.finalEmit?this.directiveError(f("unknown label: {0}",e)):r=11111),r}align(e){for(m.assert(2==e||4==e||8==e||16==e);this.location()%e!=0;)this.emitOpCode(0)}pushError(e,t=""){e={scope:this.scope,message:f("  -> Line {2} ('{1}'), error: {0}\n{3}",e,this.currLine.text,this.currLine.lineNo,t),lineNo:this.currLine.lineNo,line:this.currLine.text,coremsg:e,hints:t};if(this.errors.push(e),this.throwOnError)throw new Error(e.message)}directiveError(e){this.pushError(e)}emitString(e,t=!1){function r(e,t){return 255&(e.charCodeAt(t)||0)}e=/^\s*([\w\.]+\s*:\s*)?.\w+\s+(".*")\s*$/.exec(e);let n;if(e&&null!=(n=s(e[2])))if(this.align(2),t)for(let e=0;e<n.length;e++)this.emitShort(n.charCodeAt(e));else for(let e=0;e<n.length+1;e+=2)this.emitShort(r(n,e+1)<<8|r(n,e));else this.directiveError(f("expecting string"))}parseNumber(e){e=this.parseOneInt(e.shift());return null==e?null:e}parseNumbers(e){e=e.slice(1);for(var t=[];;){var r=this.parseNumber(e);if(null==r){this.directiveError(f("cannot parse number at '{0}'",e[0]));break}if(t.push(r),","!=e[0]){if(null==e[0])break;this.directiveError(f("expecting number, got '{0}'",e[0]));break}if(e.shift(),null==e[0])break}return t}emitSpace(e){var t=this.parseNumbers(e);if(1==t.length&&t.push(0),2!=t.length)this.directiveError(f("expecting one or two numbers"));else if(t[0]%2!=0)this.directiveError(f("only even space supported"));else{var r=255&t[1];r|=r<<8;for(let e=0;e<t[0];e+=2)this.emitShort(r)}}emitBytes(e){var t=this.parseNumbers(e);t.length%2!=0&&(this.directiveError(".bytes needs an even number of arguments"),t.push(0));for(let e=0;e<t.length;e+=2){var r=t[e],n=t[e+1];0<=r&&n<=255&&0<=n&&r<=255?this.emitShort(255&r|(255&n)<<8):this.directiveError(f("expecting uint8"))}}emitHex(e){e.slice(1).forEach(t=>{if(","!=t)if(t.length%4!=0)this.directiveError(".hex needs an even number of bytes");else if(/^[a-f0-9]+$/i.test(t))for(let e=0;e<t.length;e+=4){var r=parseInt(t.slice(e,e+4),16);this.emitShort((255&r)<<8|r>>8&255)}else this.directiveError(".hex needs a hex number")})}handleDirective(t){let r=t.words;var e=()=>{2!=r.length&&this.directiveError(f("expecting one argument"))};let n;switch(r[0]){case".object":if(this.codeSizeStats)if("PUSH"==r[1])this.objSuspendStart=this.location();else if("POP"==r[1])this.objSuspendStart&&(this.currObject.sizeAdj+=this.location()-this.objSuspendStart),this.objSuspendStart=0;else{if(this.currObject&&(this.currObject.endLocation=this.location()),this.currObject=m.U.lookup(this.idToObject,r[1]),!this.currObject){var i=t.text.replace(/^[^"]*/,"");let e=r[1];2<r.length&&null==(e=s(i.trim()))&&this.directiveError(f("expecting string in .object")),this.currObject=new c(r[1],e),this.idToObject[r[1]]=this.currObject}this.currObject.sizeAdj=0,this.currObject.startLocation=this.location()}break;case".ascii":case".asciz":case".string":this.emitString(t.text);break;case".utf16":this.emitString(t.text,!0);break;case".align":if(e(),null!=(n=this.parseOneInt(r[1]))){if(0==n)return;n<=4?this.align(1<<n):this.directiveError(f("expecting 1, 2, 3 or 4 (for 2, 4, 8, or 16 byte alignment)"))}else this.directiveError(f("expecting number"));break;case".balign":if(e(),null!=(n=this.parseOneInt(r[1]))){if(1==n)return;2==n||4==n||8==n||16==n?this.align(n):this.directiveError(f("expecting 2, 4, 8, or 16"))}else this.directiveError(f("expecting number"));break;case".p2align":e(),null!=(n=this.parseOneInt(r[1]))?this.align(1<<n):this.directiveError(f("expecting number"));break;case".byte":this.emitBytes(r);break;case".hex":this.emitHex(r);break;case".hword":case".short":case".2bytes":this.parseNumbers(r).forEach(e=>{-32768<=e&&e<=65535?this.emitShort(65535&e):this.directiveError(f("expecting int16"))});break;case".word":case".4bytes":case".long":this.parseNumbers(r).forEach(e=>{-2147483648<=e&&e<=4294967295?(this.emitShort(65535&e),this.emitShort(e>>16&65535)):this.directiveError(f("expecting int32"))});break;case".skip":case".space":this.emitSpace(r);break;case".set":case".equ":/^\w+$/.test(r[1])||this.directiveError(f("expecting name"));i=this.parseNumbers(r.slice(","==r[2]||"="==r[2]?2:1));1!=i.length&&this.directiveError(f("expecting one value")),void 0!==this.equs[r[1]]&&this.equs[r[1]]!=i[0]&&this.directiveError(f("redefinition of {0}",r[1])),this.equs[r[1]]=i[0];break;case".startaddr":this.location()&&this.directiveError(f(".startaddr can be only be specified at the beginning of the file")),e(),this.baseOffset=this.parseOneInt(r[1]);break;case"@stackmark":e(),this.stackpointers[r[1]]=this.stack;break;case"@stackempty":this.checkStack&&(null==this.stackpointers[r[1]]?this.directiveError(f("no such saved stack")):this.stackpointers[r[1]]!=this.stack&&this.directiveError(f("stack mismatch")));break;case"@scope":this.scope=r[1]||"",this.currLineNo=this.scope?0:this.realCurrLineNo;break;case".syntax":case"@nostackcheck":this.checkStack=!1;break;case"@dummystack":e(),this.stack+=this.parseOneInt(r[1]);break;case".section":case".global":this.stackpointers={},this.stack=0,this.scope="$S"+this.scopeId++;break;case".comm":{(r=r.filter(e=>","!=e)).shift();i=this.parseOneInt(r[1]);let e=0;if(e=r[2]?this.parseOneInt(r[2]):4,null==this.lookupLabel(r[0])){for(this.commPtr||(this.commPtr=this.lookupExternalLabel("_pxt_comm_base")||0,this.commPtr)||this.directiveError(f("PXT_COMM_BASE not defined"));this.commPtr&e-1;)this.commPtr++;this.labels[this.scopedName(r[0])]=this.commPtr-this.baseOffset,this.commPtr+=i}break}case".file":case".text":case".cpu":case".fpu":case".eabi_attribute":case".code":case".thumb_func":case".type":case".fnstart":case".save":case".size":case".fnend":case".pad":case".globl":case".local":case"@":break;default:/^\.cfi_/.test(r[0])||this.directiveError(f("unknown directive"))}}handleOneInstruction(e,t){this.codeSizeStats&&e.ldlitLabel&&this.useLabel(e.ldlitLabel);var r=t.emit(e);return!r.error&&(this.stack+=r.stack,this.checkStack&&this.stack<0&&this.pushError(f("stack underflow")),e.location=this.location(),e.opcode=r.opcode,e.stack=r.stack,this.emitOpCode(r.opcode),null!=r.opcode2&&this.emitOpCode(r.opcode2),null!=r.opcode3&&this.emitOpCode(r.opcode3),e.instruction=t,e.numArgs=r.numArgs,!0)}handleInstruction(n){if(!n.instruction||!this.handleOneInstruction(n,n.instruction)){var e=e=>this.ei.instructions.hasOwnProperty(e)?this.ei.instructions[e]:[];if(!n.instruction){var t=e(n.words[0]);for(let e=0;e<t.length;++e)if(this.handleOneInstruction(n,t[e]))return}var i=n.words[0].toLowerCase().replace(/s$/,"").replace(/[^a-z]/g,"");let r="";e=e(i).concat(e(i+"s"));0<e.length&&e.forEach(e=>{var t=e.emit(n);r+=f("   Maybe: {0} ({1} at '{2}')\n",e.toString(),t.error,t.errorAt)}),this.pushError(f("assembly error"),r)}}buildLine(e,t){var r=e=>{e=new l(this,e);return e.scope=this.scope,e.lineNo=this.currLineNo,t.push(e),e};let n=r(e);var i=o(n.text)||[];let s=(n.words=i)[0]||"";if(":"==s.charAt(s.length-1)){var a=/^([\.\w]+):$/.exec(i[0]);if(a){if(n.type="label",n.text=a[1]+":",n.words=[a[1]],!(1<i.length))return;i.shift(),(n=r(e.replace(/^[^:]*:/,""))).words=i,s=i[0]||""}}a=s.charAt(0);"."==a||"@"==a?(n.type="directive","@scope"==n.words[0]&&this.handleDirective(n)):0==n.words.length?n.type="empty":n.type="instruction"}prepLines(e){this.currLineNo=0,this.realCurrLineNo=0,this.lines=[],e.split(/\r?\n/).forEach(e=>{10<this.errors.length||(this.currLineNo++,this.realCurrLineNo++,this.buildLine(e,this.lines))})}iterLines(){this.stack=0,this.buf=[],this.scopeId=0,this.lines.forEach(e=>{var t,r;10<this.errors.length||0!=(this.currLine=e).words.length&&("label"==e.type?(this.currObject&&!this.labelsToObjectDone&&"."!=e.words[0][0]&&(this.labelToObject[e.words[0]]=this.currObject),t=this.scopedName(e.words[0]),this.prevLabel=t,this.finalEmit?(null!=this.equs[t]&&this.directiveError(f(".equ redefined as label")),null==(r=this.labels[t])&&m.oops(),0==this.errors.length&&r!=this.location()&&m.oops(`invalid location: ${this.location()} != ${r} at `+t),m.assert(0<this.errors.length||r==this.location()),this.reallyFinalEmit&&(this.stackAtLabel[t]=this.stack)):this.labels.hasOwnProperty(t)?this.directiveError(f("label redefinition")):this.inlineMode&&/^_/.test(t)?this.directiveError(f("labels starting with '_' are reserved for the compiler")):this.labels[t]=this.location(),e.location=this.location()):"directive"==e.type?this.handleDirective(e):"instruction"==e.type?this.handleInstruction(e):"empty"!=e.type&&m.oops())}),this.labelsToObjectDone=!0,this.currObject=null}getSourceMap(){let e={},n="",i=0,s=0,a=0;function o(){n&&s&&(e[n]||(e[n]=[]),e[n].push(i,s,a-s)),s=0,a=0}return this.lines.forEach((e,t)=>{var r=/^; ([\w\/\.-]+)\(([\d]+),\d+\):/.exec(e.text);r&&(o(),n=r[1],i=parseInt(r[2])),"instruction"==e.type&&(s=s||e.location,a=e.location)}),o(),e}getCodeSizeStats(){if(!this.codeSizeStats)return"";var e,t=m.U.values(this.idToObject);t.sort((e,t)=>t.size-e.size);let r=";\n; Code size:\n;\n";for(e of t)if(r+=`; ${("         "+e.size).slice(-6)} ${e.description} [${e.id}]
`,5<=e.users.length)r+=`;        by many, including ${e.users[0].description}
`;else for(var n of e.users)r+=`;        by ${n.description} [${n.id}]
`;return r}getSource(n,e=1,t=0){let r=0;var i=e=>{var e=this.labels[e]||r,t=e-r;return r=e,t},s=this.buf?this.location():0,a=i("_code_end"),o=i("_helpers_end"),l=i("_vtables_end"),i=i("_literals_end"),c=r,u=s+this.baseOffset&16777215;if(t&&t<u)throw(d=new Error(f("program too big by {0} bytes!",u-t))).ksErrorCode=9283,d;var d=f("; total bytes: {0} ({1}% of {2}k flash with {3} free)",u,(100*u/(t=t||131072)).toFixed(1),(t/1024).toFixed(1),t-u);let p=f("; generated code sizes (bytes): {0} (incl. {1} user, {2} helpers, {3} vtables, {4} lits); src size {5}\n",c,a,o,l,i,s-c)+f("; assembly: {0} lines; density: {1} bytes/stmt; ({2} stmts)\n",this.lines.length,Math.round(100*a/e)/100,e)+d+"\n"+this.stats+this.getCodeSizeStats()+"\n\n",h=!1;return this.lines.forEach((t,r)=>{if("_stored_program"==t.words[0])p+='_stored_program: .string "..."\n',h=!0;else if(h)h=!1;else{let e=t.text;if(n){if("@stackempty"==t.words[0]&&this.lines[r-1].text==t.text)return;if(!(e=e.replace(/; WAS: .*/,"")).trim())return}!g.debug||"label"!=t.type&&"instruction"!=t.type||(e+=` 	; 0x`+(t.location+this.baseOffset).toString(16)),p+=e+"\n"}}),p}peepHole(){var t=this.lines.filter(e=>"empty"!=e.type);for(let e=0;e<t.length;++e){var r,n,i=t[e];/^user/.test(i.scope)||(r=t[e+1])&&(n=t[e+2],"instruction"==i.type)&&this.ei.peephole(i,r,n)}}clearLabels(){this.labels={},this.commPtr=0}peepPass(e){this.disablePeepHole||(this.peepOps=0,this.peepDel=0,this.peepCounts={},this.peepHole(),this.throwOnError=!0,this.finalEmit=!1,this.clearLabels(),this.iterLines(),m.assert(!this.checkStack||0==this.stack),this.finalEmit=!0,this.reallyFinalEmit=e||0==this.peepOps,this.iterLines(),this.stats+=f("; peep hole pass: {0} instructions removed and {1} updated\n",this.peepDel,this.peepOps-this.peepDel))}getLabels(){return this.userLabelsCache||(this.userLabelsCache=m.U.mapMap(this.labels,(e,t)=>t+this.baseOffset)),this.userLabelsCache}emit(e){if(m.assert(null==this.buf),this.prepLines(e),!(0<this.errors.length||(this.clearLabels(),this.iterLines(),this.checkStack&&0!=this.stack&&this.directiveError(f("stack misaligned at the end of the file")),0<this.errors.length)||(this.ei.expandLdlit(this),this.clearLabels(),this.iterLines(),this.finalEmit=!0,this.reallyFinalEmit=this.disablePeepHole,this.iterLines(),0<this.errors.length))){for(let e=0;e<5&&(pxt.debug("Peephole OPT, pass "+e),this.peepPass(5==e),0!=this.peepOps);++e);pxt.debug("emit done")}}}g.File=u;class t extends u{constructor(e){super(e)}}function o(t){var r=[];let n="";e:for(let e=0;e<t.length;++e)switch(t[e]){case"[":case"]":case"!":case"{":case"}":case",":n&&(r.push(n),n=""),r.push(t[e]);break;case" ":case"\t":case"\r":case"\n":n&&(r.push(n),n="");break;case";":break e;default:n+=t[e]}return n&&(r.push(n),n=""),r[0]?r:null}function s(e){e=e.replace(/\\\\/g,"\\B").replace(/\\(['\?])/g,(e,t)=>t).replace(/\\[z0]/g,"\0").replace(/\\x([0-9a-f][0-9a-f])/gi,(e,t)=>"\\u00"+t).replace(/\\B/g,"\\\\");try{return JSON.parse(e)}catch(e){return null}}function _(e,t){return{stack:null,opcode:null,error:e,errorAt:t}}function i(e){return(e<0||65535<e?"0x"+e.toString(16):"0x"+("000"+e.toString(16)).slice(-4)).toLowerCase()}g.VMFile=t,g.AbstractProcessor=class{constructor(){this.file=null,this.addEnc=(e,t,r)=>{t={name:e,pretty:t,encode:r,isRegister:/^\$r\d/.test(e),isImmediate:/^\$i\d/.test(e),isRegList:/^\$rl\d/.test(e),isLabel:/^\$l[a-z]/.test(e)};return this.encoders[e]=t},this.inrange=(e,t,r)=>Math.floor(t)!=t||t<0||e<t?null:r,this.inminmax=(e,t,r,n)=>Math.floor(r)!=r||r<e||t<r?null:n,this.inseq=(e,t)=>{e=e.indexOf(t);return e<0?null:e},this.inrangeSigned=(e,t,r)=>Math.floor(t)!=t||t<-(e+1)||e<t?null:r&(e<<1|1),this.addInst=(e,t,r,n)=>{e=new a(this,e,t,r,n);return this.instructions.hasOwnProperty(e.name)||(this.instructions[e.name]=[]),this.instructions[e.name].push(e),e},this.encoders={},this.instructions={}}toFnPtr(e,t,r){return e}wordSize(){return-1}computeStackOffset(e,t){return t}is32bit(e){return!1}emit32(e,t,r){return null}postProcessRelAddress(e,t){return t}postProcessAbsAddress(e,t){return t}peephole(e,t,r){}registerNo(e){return null}getAddressFromLabel(e,t,r,n=0){return null}isPop(e){return!1}isPush(e){return!1}isAddSP(e){return!1}isSubSP(e){return!1}testAssembler(){m.assert(!1)}expandLdlit(e){}},g.emitErr=_,g.expectError=function(e,t){(e=new u(e)).emit(t),0==e.errors.length&&m.oops("ASMTEST: expecting error for: "+t)},g.tohex=i,g.expect=function(e,t){let r=[];var t=t.replace(/^([0-9a-fA-F]{4,8})\s/gm,(e,t)=>(r.push(parseInt(t.slice(0,4),16)),8==t.length&&r.push(parseInt(t.slice(4,8),16)),"")),n=new u(e);n.throwOnError=!0,n.disablePeepHole=!0,n.emit(t),0<n.errors.length&&(pxt.debug(n.errors[0].message),m.oops("ASMTEST: not expecting errors")),n.buf.length!=r.length&&m.oops("ASMTEST: wrong buf len");for(let e=0;e<r.length;++e)n.buf[e]!=r[e]&&m.oops("ASMTEST: wrong buf content at "+e+" , exp:"+i(r[e])+", got: "+i(n.buf[e]))}}})(ts=ts||{}),(m=>{{var i=m.Cloud||(m.Cloud={}),s=pxtc.Util;i.apiRoot=m.BrowserUtils.isLocalHost()||s.isNodeJS?"https://www.makecode.com/api/":"/api/",i.accessToken="";let r=!(i.localToken=""),n=(i.onOffline=()=>{},void 0);function a(e){let t=new Error(s.lf("Cannot access {0} while offline",e));return t.isOffline=!0,m.U.delay(1e3).then(()=>Promise.reject(t))}function g(e,t){return m.U.requestAsync({url:"/api/"+e,headers:{Authorization:i.localToken},method:t?"POST":"GET",data:t||void 0,allowHttpErrors:!0})}function f(){return m.webConfig&&!m.webConfig.isStatic&&!m.BrowserUtils.isLocalHost()&&!!m.webConfig.cdnUrl&&("undefined"==typeof window||!/nocdn=1/i.test(window.location.href))}function e(e){var t;return e=e.replace(/^\//,""),f()?(t=(t=new Date).getUTCFullYear()+("0"+(t.getUTCMonth()+1)).slice(-2)+("0"+t.getUTCDate()).slice(-2),e.indexOf("?")<0?e+="?":e+="&",m.webConfig.cdnUrl+"/api/"+(e+="cdn="+t)):i.apiRoot+e}function _(t){return f()?(t.url=e(t.url),s.requestAsync(t).catch(e=>o(t,e))):y(t)}function o(e,t){return 0==t.statusCode?(r&&(r=!1,i.onOffline()),a(e.url)):Promise.reject(t)}function y(t){var e;return t.url=null!=(e=m.webConfig)&&e.isStatic&&!t.forceLiveEndpoint?m.webConfig.relprefix+t.url:i.apiRoot+t.url,t.allowGzipPost=!0,i.isOnline()||m.BrowserUtils.isPxtElectron()?(t.headers||(t.headers={}),m.BrowserUtils.isLocalHost()?i.localToken&&(t.headers.Authorization=i.localToken):i.accessToken&&(t.headers["x-td-access-token"]=i.accessToken),s.requestAsync(t).catch(e=>o(t,e))):a(t.url)}function t(){return navigator&&navigator.onLine}i.hasAccessToken=function(){return!!i.accessToken},i.localRequestAsync=g,i.useCdnApi=f,i.cdnApiUrl=e,i.apiRequestWithCdnAsync=_,i.privateRequestAsync=y,i.privateGetTextAsync=function(e,t){return y({url:e,headers:t}).then(e=>e.text)},i.privateGetAsync=function(e,t=!1){return y({url:e,forceLiveEndpoint:t}).then(e=>e.json)},i.downloadTargetConfigAsync=function(){var e;return i.isOnline()?(e=m.appTarget.versions&&m.appTarget.versions.target,e=m.webConfig&&m.webConfig.isStatic?"targetconfig.json":`config/${m.appTarget.id}/targetconfig`+(e?"/v"+e:""),m.BrowserUtils.isLocalHost()?g(e).then(e=>e?e.json:void 0):_({url:e}).then(e=>e.json)):Promise.resolve(void 0)},i.downloadScriptFilesAsync=function(e){return y({url:e+"/text"+(e.startsWith("S")?"?time="+Date.now():""),forceLiveEndpoint:!0}).then(e=>JSON.parse(e.text))},i.downloadScriptMetaAsync=function(e){return y({url:e+(e.startsWith("S")?"?time="+Date.now():""),forceLiveEndpoint:!0}).then(e=>JSON.parse(e.text).meta)},i.downloadBuiltSimJsInfoAsync=async function(e){var t=m.appTarget.versions&&m.appTarget.versions.target||"";return(await y({url:m.U.stringifyQueryString(e+"/js",{v:"v"+t})+(e.startsWith("S")?"&time="+Date.now():""),forceLiveEndpoint:!0})).json},i.markdownAsync=async function(t,r,n,i){var e=24*(c=m.BrowserUtils.isLocalHostDev()?0:36e5)*7;r=r||m.Util.userLanguage();let s=await m.BrowserUtils.translationDbAsync(),a=await s.getAsync(r,t);var o=async()=>{try{var e=await(async(e,t,r,n)=>{let i,s=null==(i=m.webConfig)?void 0:i.isStatic,a=m.appTarget.versions&&m.appTarget.versions.target||"?",o,l=new URLSearchParams;var c,u;if(s?(o=e,u=/\/?docs\//.test(o),c=/\.\w+$/.test(o),u||(u="/"===o[0],o="docs"+(u?"":"/")+o),c||(o+=".md")):(o=`md/${m.appTarget.id}/`+e.replace(/^\//,""),l.set("targetVersion",a)),"en"!=t&&l.set("lang",t),o=m.BrowserUtils.appendUrlQueryParams(o,l),m.BrowserUtils.isLocalHost()&&!m.Util.liveLocalizationEnabled())return g(o).then(e=>404==e.statusCode?y({url:o,method:"GET"}).then(e=>({md:e.text,etag:e.headers.etag})):{md:e.text,etag:void 0});let d=r&&!f()?{"If-None-Match":r}:void 0,p,h;return{md:h=!s&&n?(o=o.replace(/^md\//,"ghtutorial/docs/"),u=(p=await _({url:o,method:"GET",headers:d})).json,await m.github.db.cacheReposAsync(u),u.markdown):(p=await _({url:o,method:"GET",headers:d})).text,etag:p.headers.etag}})(t,r,null==a?void 0:a.etag,i);return!a||e.md&&a.md!==e.md?(await s.setAsync(r,t,e.etag,void 0,e.md),e.md):a.md}catch(e){if(n)throw e;return""}};if(a){var l=Date.now()-a.time,c=c<l;if(e<l)m.tickEvent("markdown.update.wait");else if(c&&(m.tickEvent("markdown.update.background"),o()),a.md)return a.md}return o()},i.privateDeleteAsync=function(e){return y({url:e,method:"DELETE"}).then(e=>e.json)},i.privatePostAsync=function(e,t,r=!1){return y({url:e,data:t||{},forceLiveEndpoint:r}).then(e=>e.json)},i.isLoggedIn=function(){return!!i.accessToken},i.isNavigatorOnline=t,i.isOnline=function(){return r="undefined"!=typeof navigator&&t()?!0:r},i.getServiceUrl=function(){return i.apiRoot.replace(/\/api\/$/,"")},i.getUserId=function(){var e=/^0(\w+)\./.exec(i.accessToken);return e?e[1]:null},i.parseScriptId=function(t){var r=m.appTarget;if(t&&r.appTheme&&null!=(n=r.cloud)&&n.sharing){let e=["makecode.com"];r.appTheme.embedUrl&&e.push(r.appTheme.embedUrl),r.appTheme.shareUrl&&e.push(r.appTheme.shareUrl);var n=`(?:(?:https://)?(?:${(e=s.unique(e,e=>e).map(e=>s.escapeForRegex(s.stripUrlProtocol(e).replace(/\/$/,"")).toLowerCase())).join("|")})/)`,r=new RegExp(`^${n}?(?:v[0-9]+/)?(?:(?:api/oembed\\?url=.*%2F([^&#]*)&.*)|(?:/?([a-z0-9\\-_]+)(?:[#?&].*)?))$`,"i").exec(t.trim()),n=(null==r?void 0:r[1])||(null==r?void 0:r[2]);return/^(_.{12}|S?[0-9\-]{23})$/.test(n)?n:void 0}},i.initRegionAsync=async function(){var e;if(void 0===n)if(m.BrowserUtils.isLocalHost())n=m.cloud.DEV_REGION;else if(null!=(e=m.webConfig)&&e.cdnUrl)try{var t={url:new URL("geo",m.webConfig.cdnUrl).toString()},r=await s.requestAsync(t);200!==r.statusCode&&m.error("Failed to get region: "+r.statusCode),n=r.text.trim()}catch(e){m.error("Unable to determine region",e),n="unknown"}else n="unknown"},i.getRegion=function(){return n||m.error("Accessing region before it is initialized. Call initRegionAsync first."),n}}})(pxt=pxt||{}),(e=>{(e.pxtc||(e.pxtc={})).f4EncodeImg=function(e,r,n,i){let t=[135,n,255&e,e>>8,255&r,r>>8,0,0].map(c).join(""),s=4,a=0,o=0;var l=e=>{a|=e<<o,o==8-n?(t+=c(a),s++,a=0,o=0):o+=n};for(let t=0;t<e;++t){for(let e=0;e<r;++e)l(i(t,e));for(;0!=o;)l(0);if(1<n)for(;3&s;)l(0)}return t;function c(e){return("0"+e.toString(16)).slice(-2)}}})(ts=ts||{}),(e=>{function s(e){let t="";switch(e){case 0:t="C5";break;case 1:t="B";break;case 2:t="A";break;case 3:t="G";break;case 4:t="F";break;case 5:t="E";break;case 6:t="D";break;case 7:t="C"}return t}function n(e){let t=-1;switch(e){case"C5":t=0;break;case"B":t=1;break;case"A":t=2;break;case"G":t=3;break;case"F":t=4;break;case"E":t=5;break;case"D":t=6;break;case"C":t=7}return t}e.MelodyArray=class{constructor(e){this.numCols=8,this.numRows=8,this.polyphonic=!1,e&&(this.tempo=e),this.resetMelody()}setTempo(e){this.tempo=e}getArray(){return this.melody}setArray(e){this.melody=e}getColor(e){return 0}getValue(e,t){return this.melody[e][t]}getWidth(){return this.numCols}getHeight(){return this.numRows}updateMelody(e,t){var r=!this.melody[e][t];if(r&&!this.polyphonic)for(let e=0;e<this.numRows;e++)this.melody[e][t]=!1;this.melody[e][t]=r}getStringRepresentation(){let t="";var n=new Array(this.numCols);let i=0;for(let r=0;r<this.numRows;r++){let t=0;n[r]=[];for(let e=0;e<this.numCols;e++)this.melody[e][r]&&(n[r].push(s(e)),t++);t>i&&(i=t)}if(0==i)return"- - - - - - - - ";for(let e=0;e<i;e++)for(let e=0;e<this.numCols;e++)n[e]&&0<n[e].length?t+=n[e].shift()+" ":t+="- ";return t}parseNotes(e){var r=(e=e.trim()).split(" ");for(let t=0;t<r.length;t++){for(let e=0;e<this.numRows;e++)this.melody[e][t]=!1;"-"!=r[t]&&(this.melody[n(r[t])][t]=!0)}}setPolyphonic(e){this.polyphonic=e}isPolyphonic(){return this.polyphonic}resetMelody(){this.melody=new Array(this.numCols);for(let e=0;e<this.numCols;e++)this.melody[e]=new Array(this.numRows).fill(!1)}},e.rowToNote=s,e.noteToRow=n,e.getColorClass=function(e){let t="melody-default";switch(e){case 0:t="melody-red";break;case 1:t="melody-orange";break;case 2:t="melody-yellow";break;case 3:t="melody-green";break;case 4:t="melody-teal";break;case 5:t="melody-blue";break;case 6:t="melody-purple";break;case 7:t="melody-violet"}return t}})(pxtmelody=pxtmelody||{}),(s=>{function c(e,t,r){var n=document.createElement(e),i=t,e=r;if(i)for(var s of Object.keys(i))"className"===s?n.setAttribute("class",i[s]+""):n.setAttribute(s,i[s]+"");return e&&n.addEventListener("click",e),n}s.MelodyGallery=class{constructor(){this.value=null,this.visible=!1,this.timeouts=[],this.numSamples=s.SampleMelodies.length,this.containerDiv=document.createElement("div"),this.containerDiv.setAttribute("id","melody-editor-gallery-outer"),this.contentDiv=document.createElement("div"),this.contentDiv.setAttribute("id","melody-editor-gallery"),this.contentDiv.setAttribute("role","menu"),this.contentDiv.setAttribute("tabindex","0"),this.keyDownHandler=this.keyDownListener.bind(this),this.contentDiv.addEventListener("keydown",this.keyDownHandler),this.focusHandler=this.focusListener.bind(this),this.contentDiv.addEventListener("focus",this.focusHandler),this.blurHandler=this.blurListener.bind(this),this.contentDiv.addEventListener("blur",this.blurHandler),this.itemBackgroundColor="#DCDCDC",this.itemBorderColor="white",this.initStyles(),this.containerDiv.appendChild(this.contentDiv),this.containerDiv.style.display="none",this.contentDiv.addEventListener("animationend",()=>{this.visible||(this.containerDiv.style.display="none")}),this.contentDiv.addEventListener("wheel",e=>{e.stopPropagation()},!0)}keyDownListener(e){if(this.selectedColRow){var[t,r]=this.selectedColRow,n=pxt.Util.isUserLanguageRtl()?"ArrowRight":"ArrowLeft",i=pxt.Util.isUserLanguageRtl()?"ArrowLeft":"ArrowRight";switch(e.code){case"ArrowUp":this.selectedColRow=[t,Math.max(0,r-1)];break;case"ArrowDown":this.selectedColRow=[t,Math.min(this.selectionButtons.length-1,r+1)];break;case n:this.selectedColRow=[Math.max(0,t-1),r];break;case i:this.selectedColRow=[Math.min(1,t+1),r];break;case"Enter":case"Space":return this.selectedElement.click(),e.stopPropagation(),void e.preventDefault();default:return}this.selectedElement.classList.remove("selected");var[n,i]=this.selectedColRow,n=(this.selectedElement=(0===n?this.selectionButtons:this.previewButtons)[i],this.selectedElement.classList.add("selected"),this.contentDiv.setAttribute("aria-activedescendant",getCellId(n,i)),this.contentDiv.getBoundingClientRect()),i=this.selectedElement.getBoundingClientRect();i.bottom>n.bottom?this.selectedElement.scrollIntoView({block:"end"}):i.top<n.top&&this.selectedElement.scrollIntoView({block:"start"}),e.stopPropagation(),e.preventDefault()}}focusListener(e){this.selectedElement||(this.selectedColRow=[0,0],this.selectedElement=this.selectionButtons[0]),this.selectedElement.classList.add("selected");var[t,r]=this.selectedColRow;this.contentDiv.setAttribute("aria-activedescendant",getCellId(t,r))}blurListener(e){var t;this.contentDiv.removeAttribute("aria-activedescendant"),null!=(t=this.selectedElement)&&t.classList.remove("selected")}getElement(){return this.containerDiv}getValue(){return this.value}show(e){this.pending=e,this.containerDiv.style.display="block",this.buildDom(),this.visible=!0,pxt.BrowserUtils.removeClass(this.contentDiv,"hidden-above"),pxt.BrowserUtils.addClass(this.contentDiv,"shown")}hide(){var e;this.visible=!1,pxt.BrowserUtils.removeClass(this.contentDiv,"shown"),pxt.BrowserUtils.addClass(this.contentDiv,"hidden-above"),this.value=null,this.stopMelody(),this.contentDiv.removeAttribute("aria-activedescendant"),null!=(e=this.selectedElement)&&e.classList.remove("selected"),this.selectedElement=void 0,this.selectedColRow=void 0}clearDomReferences(){this.contentDiv.removeEventListener("keydown",this.keyDownHandler),this.contentDiv.removeEventListener("focus",this.focusHandler),this.contentDiv.removeEventListener("blur",this.blurHandler),this.contentDiv=null,this.containerDiv=null}layout(e,t,r){this.containerDiv.style.left=e+"px",this.containerDiv.style.top=t+"px",this.containerDiv.style.height=r+"px"}getLastFocusableElement(){return this.contentDiv}buildDom(){for(;this.contentDiv.firstChild;)this.contentDiv.removeChild(this.contentDiv.firstChild);var t=s.SampleMelodies;this.playIcons=[],this.selectionButtons=[],this.previewButtons=[];for(let e=0;e<t.length;e++)this.mkButton(t[e],e,"255px","45px")}initStyles(){var e=document.createElement("style");e.textContent=`
            #melody-editor-gallery {
                margin-top: -100%;
            }

            #melody-editor-gallery.hidden-above {
                margin-top: -100%;
                animation: slide-up 0.2s 0s ease;
            }

            #melody-editor-gallery.shown {
                margin-top: 0px;
                animation: slide-down 0.2s 0s ease;
            }

            @keyframes slide-down {
                0% {
                    margin-top: -100%;
                }
                100% {
                    margin-top: 0px;
                }
            }

            @keyframes slide-up {
                0% {
                    margin-top: 0px;
                }
                100% {
                    margin-top: -100%;
                }
            }
            `,this.containerDiv.appendChild(e)}mkButton(e,t,r,n){var i=c("div",{className:"melody-gallery-button melody-editor-card",id:":"+t}),s=c("i",{className:"music icon melody-icon"}),a=c("div",{className:"melody-editor-text"}),o=(a.innerText=e.name,this.createColorBlock(e)),l=c("div",{className:"melody-editor-button left-button",role:"menuitem",title:e.name,tabIndex:-1,id:getCellId(t,0)},()=>this.handleSelection(e)),s=(l.appendChild(s),l.appendChild(a),l.appendChild(o),i.appendChild(l),this.selectionButtons[t]=l,c("div",{className:"melody-editor-button right-button",role:"menuitem",title:lf("Preview {0}",e.name),tabIndex:-1,id:getCellId(t,1)},()=>this.togglePlay(e,t))),a=c("i",{className:"play icon"});this.playIcons[t]=a,s.appendChild(a),i.appendChild(s),this.previewButtons[t]=s,this.contentDiv.appendChild(i)}handleSelection(e){var t;this.pending&&(t=this.pending,this.pending=void 0,t(e.notes))}playNote(e,t,r){let n=0;switch(e){case"C5":n=523;break;case"B":n=494;break;case"A":n=440;break;case"G":n=392;break;case"F":n=349;break;case"E":n=330;break;case"D":n=294;break;case"C":n=262}this.timeouts.push(setTimeout(()=>{pxt.AudioContextManager.tone(n)},t*this.getDuration(r))),this.timeouts.push(setTimeout(()=>{pxt.AudioContextManager.stop()},(t+1)*this.getDuration(r)))}getDuration(e){return 6e4/e}previewMelody(t){this.stopMelody();var r=t.notes.split(" ");for(let e=0;e<r.length;e++)this.playNote(r[e],e,t.tempo)}togglePlay(e,t){let r=this.playIcons[t];pxt.BrowserUtils.containsClass(r,"play icon")?(this.resetPlayIcons(),pxt.BrowserUtils.removeClass(r,"play icon"),pxt.BrowserUtils.addClass(r,"stop icon"),this.previewMelody(e),this.timeouts.push(setTimeout(()=>{pxt.BrowserUtils.removeClass(r,"stop icon"),pxt.BrowserUtils.addClass(r,"play icon")},e.notes.split(" ").length*this.getDuration(e.tempo)))):(pxt.BrowserUtils.removeClass(r,"stop icon"),pxt.BrowserUtils.addClass(r,"play icon"),this.stopMelody())}stopMelody(){for(;this.timeouts.length;)clearTimeout(this.timeouts.shift());pxt.AudioContextManager.stop()}resetPlayIcons(){for(let e=0;e<this.numSamples;e++){var t=this.playIcons[e];if(pxt.BrowserUtils.containsClass(t,"stop icon")){pxt.BrowserUtils.removeClass(t,"stop icon"),pxt.BrowserUtils.addClass(t,"play icon");break}}}createColorBlock(e){var t=document.createElement("div"),r=(pxt.BrowserUtils.addClass(t,"melody-color-block"),e.notes.split(" "));for(let e=0;e<r.length;e++){var n=s.getColorClass(s.noteToRow(r[e])),i=document.createElement("div");0==e?pxt.BrowserUtils.addClass(i,"left-edge sliver "+n):e==r.length-1?pxt.BrowserUtils.addClass(i,"right-edge sliver "+n):pxt.BrowserUtils.addClass(i,"sliver "+n),t.appendChild(i)}return t}}})(pxtmelody=pxtmelody||{}),(e,t)=>`:${e}-`+(0===t?"selection":"preview"));(e=>{class t{constructor(e,t,r){this.name=e,this.notes=t,this.tempo=r}}e.MelodyInfo=t,e.SampleMelodies=[new t(lf("Scale"),"C5 B A G F E D C",120),new t(lf("Reverse"),"C D E F G A B C5",120),new t(lf("Mystery"),"E B C5 A B G A F",120),new t(lf("Gilroy"),"A F E F D G E F",120),new t(lf("Falling"),"C5 A B G A F G E",120),new t(lf("Hopeful"),"G B A G C5 B A B",120),new t(lf("Tokyo"),"B A G A G F A C5",120),new t(lf("Paris"),"G F G A - F E D",120),new t(lf("Rising"),"E D G F B A C5 B",120),new t(lf("Sitka"),"C5 G B A F A C5 B",120)]})(pxtmelody=pxtmelody||{}),(s=>{let a,n=!1;class t{constructor(e){this.db=e}loadAsync(t,r,e,n){if(!/^v\d+\.\d+\.\d+$/.test(r))return n(t,r);let i=`gh-${e}-${t}#`+r;return a.cacheGet(i).then(e=>{if(e){e=s.Util.jsonTryParse(e);if(e)return s.debug("cache hit "+i),Promise.resolve(e)}return n(t,r).then(e=>e&&(s.debug("cached "+i),a.cacheSet(i,JSON.stringify(e)).then(()=>e)))})}latestVersionAsync(e,t){return this.db.latestVersionAsync(e,t)}loadConfigAsync(e,t){return this.loadAsync(e,t,"pxt",(e,t)=>this.db.loadConfigAsync(e,t))}loadPackageAsync(e,t){return this.loadAsync(e,t,"pkg",(e,t)=>this.db.loadPackageAsync(e,t))}loadTutorialMarkdown(e,t){return this.loadAsync(e,t,"tutorial",(e,t)=>this.db.loadTutorialMarkdown(e,t))}cacheReposAsync(e){return this.db.cacheReposAsync(e)}}class i{constructor(e){this.packageFiles=e}resolve(e,t){return""}readFile(e,t){var r="this"==e.id?t:"pxt_modules/"+e.id+"/"+t;return void 0!==this.packageFiles[r]?this.packageFiles[r]:s.appTarget.bundledpkgs[e.id]?s.appTarget.bundledpkgs[e.id][t]:null}writeFile(e,t,r){e="this"==e.id?"":"pxt_modules/"+e.id+"/";s.debug("write file "+e+t),this.packageFiles[e+t]=r}getHexInfoAsync(e){return Promise.resolve({hex:["SKIP"]})}cacheStoreAsync(e,t){return null!=a&&a.cacheSet?a.cacheSet(e,t):Promise.resolve()}cacheGetAsync(e){return null!=a&&a.cacheGet?a.cacheGet(e):Promise.resolve("")}downloadPackageAsync(r){var t,e;return n?(t=r,((e=null==a?void 0:a.pkgOverrideAsync)?e(t.id):Promise.resolve(void 0)).then(e=>e||t.commonDownloadAsync()).then(e=>{e&&s.U.iterMap(e,(e,t)=>{this.writeFile(r,e,t)})})):Promise.resolve()}resolveVersionAsync(e){return Promise.resolve("*")}}function o(e){if(e.target.preferredEditor==s.PYTHON_PROJECT_NAME){var t,r=s.U.clone(e);r.ast=!0,r.target.preferredEditor=s.JAVASCRIPT_PROJECT_NAME;for(t of r.sourceFiles)s.U.endsWith(t,".py")&&(r.fileSystem[t.slice(0,-3)+".ts"]=" ");var n=pxtc.compile(r);e.apisInfo=pxtc.getApiInfo(n.ast,r.jres)}}function r(e,t){e=new i(e);let r=new s.MainPackage(e);return r.loadAsync().then(()=>{var e=r.getTargetOptions();return e.hasHex&&(e.isNative=t.native),r.getCompileOptionsAsync(e)}).then(e=>(l(r.targetVersion(),e),r.getPreferredEditor()===s.PYTHON_PROJECT_NAME&&c(r.targetVersion(),e),o(e),e))}function l(e,t){if(e){s.debug("applying TS patches relative to "+e);for(var r of Object.keys(t.fileSystem)){var n;-1==r.indexOf("/")&&s.U.endsWith(r,".ts")&&(n=t.fileSystem[r])!=(n=s.patching.patchJavaScript(e,n))&&(s.debug("applying TS patch to "+r),t.fileSystem[r]=n)}}}function c(e,t){if(e){s.debug("applying PY patches relative to "+e);for(var r of Object.keys(t.fileSystem)){var n;-1==r.indexOf("/")&&s.U.endsWith(r,".py")&&(n=t.fileSystem[r])!=(n=s.patching.patchPython(e,n))&&(s.debug("applying PY patch to "+r),t.fileSystem[r]=n)}}}s.SimpleHost=i,s.prepPythonOptions=o,s.simpleInstallPackagesAsync=function(e){return e=new i(e),new s.MainPackage(e).loadAsync(!0)},s.simpleGetCompileOptionsAsync=r,s.simpleCompileAsync=function(e,t){return r(e,"boolean"==typeof t?{native:t}:t||{}).then(e=>pxtc.compile(e)).then(e=>(e.success||(e.errors=e.diagnostics.map(ts.pxtc.getDiagnosticString).join("")||"Unknown error."),e))},s.patchTS=l,s.patchPY=c,s.setupSimpleCompile=function(e){"undefined"==typeof global||global.btoa||(global.btoa=function(e){return Buffer.from(e,"binary").toString("base64")},global.atob=function(e){return Buffer.from(e,"base64").toString("binary")}),"undefined"!=typeof pxtTargetBundle&&(s.debug("setup app bundle"),s.setAppTarget(pxtTargetBundle)),e&&(a=e,n=!0,e.httpRequestAsync&&(s.Util.httpRequestCoreAsync=e.httpRequestAsync),s.github.forceProxy=!0,s.github.db=new t(new s.github.MemoryGithubDb)),s.debug("simple setup done")}})(pxt=pxt||{}),(y=>{y.simshim=function(e,t){let d=ts.SyntaxKind,p=e.getTypeChecker(),h=y.cpp.nsWriter("declare namespace"),m="",r;for(var n of e.getSourceFiles()){if(t){var i=t(n.fileName);if(y.debug("SimShim[1]: "+i.dir),!y.U.endsWith(i.dir,"/sim")&&!y.U.startsWith(n.fileName,"sim/"))continue}else if(!y.U.startsWith(n.fileName,"sim/"))continue;y.debug("SimShim[2]: "+n.fileName);for(var s of n.statements){var a=s;s.kind==d.ModuleDeclaration&&"pxsim"==a.name.text&&l((r=a).body)}}return(e={})[y.appTarget.corepkg]=h.finish(),e;function g(e){let t;return t=(t=ts.isExpression(e)?p.getContextualType(e):t)||p.getTypeAtLocation(e)}function f(e){let t=p.typeToString(e,r,ts.TypeFormatFlags.UseFullyQualifiedType);switch(t=t.replace(/^pxsim\./,"")){case"RefAction":return"() => void";case"RefBuffer":return"Buffer";default:return t}}function o(r){var t=_(r);if(t){h.setNs(m),h.write(t);var n,i,s,t=m,a=(m&&(m+="."),m+=r.name.text,t?"":"declare");let e="";if(r.heritageClauses)for(var o of r.heritageClauses)o.token==d.ExtendsKeyword&&(e=" extends "+f(g(o.types[0])));h.write(a+` class ${r.name.text}${e} {`),h.incrIndent();for(let t of r.members)switch(t.kind){case d.MethodDeclaration:c(t);break;case d.PropertyDeclaration:n=t,s=l=i=void 0,(i=_(n))&&(l=n.name.getText(),s="//% shim=."+l,n=p.getTypeAtLocation(n),h.write(i),h.write(s),h.write(`public ${l}: ${f(n)};`),h.write(""));break;case d.Constructor:i=t,s=void 0,(s=_(i))&&(p.getTypeAtLocation(i),i=i.parameters.map(e=>e.name.getText()+": "+f(g(e))),h.write(s),h.write(`//% shim="new ${m}"`),h.write(`constructor(${i.join(", ")});`),h.write(""));break;case d.GetAccessor:var l=r.members.some(e=>e.kind==d.SetAccessor&&e.name.getText()==t.name.getText());c(t,l)}m=t,h.decrIndent(),h.write("}")}}function _(e){e=pxtc.getComments(e);return/^\s*\/\/%/m.test(e)?e:null}function c(i,s=!1){var a=_(i);if(a){var o=i.name.getText(),l=i.kind==d.MethodDeclaration||i.kind==d.GetAccessor||i.kind==d.SetAccessor;let e="//% shim="+(l?"."+o:m+"::"+o);var c=p.getSignatureFromDeclaration(i);let t=p.getReturnTypeOfSignature(c);var c=/Async$/.test(o),u=(u=t,pxtc.isObjectType(u)&&u.objectFlags&ts.ObjectFlags.Reference&&"Promise"==u.symbol.name?u.typeArguments[0]:null),u=(u?(e+=" promise",t=u,c||y.U.userError(m+`::${o} should be called ${o}Async`)):c&&y.U.userError(m+`::${o} doesn't return a promise`),y.debug("emitFun: "+o),i.parameters.map(e=>`${e.name.getText()}${e.questionToken?"?":""}: `+f(g(e)))),c=o.replace(/Async$/,"");let r=l?"public":"function",n=`(${u.join(", ")})`;i.kind==d.GetAccessor&&(r=s?"public":"readonly",n="",e+=" property"),l||h.setNs(m),h.write(a),h.write(e),h.write(`${r} ${c}${n}: ${f(t)};`),h.write("")}}function l(e){switch(e.kind){case d.ModuleDeclaration:return t=e,(r=m)&&(m+="."),m+=t.name.text,l(t.body),void(m=r);case d.ModuleBlock:return e.statements.forEach(l);case d.FunctionDeclaration:return c(e);case d.ClassDeclaration:return o(e)}var t,r}}})(pxt=pxt||{}),(c=>{var u;(u=c.pxtc||(c.pxtc={})).annotate=function(e,t,r){var n=u.target,r=(u.target=r,e.getSourceFiles().filter(e=>e.fileName===t)[0]);let s=e.getTypeChecker();function i(e){var t=e.left,r=e.right,n=l(e.left),i=l(e.right);switch(e.operatorToken.kind!=u.SK.PlusToken&&e.operatorToken.kind!=u.SK.PlusEqualsToken||(u.isStringType(n)||u.isStringType(i)&&e.operatorToken.kind==u.SK.PlusToken)&&(u.pxtInfo(e).exprInfo={leftType:s.typeToString(n),rightType:s.typeToString(i)}),e.operatorToken.kind){case c.SyntaxKind.EqualsToken:case c.SyntaxKind.PlusEqualsToken:case c.SyntaxKind.MinusEqualsToken:if(t.kind==u.SK.PropertyAccessExpression){let e=o(t);e&&e.kind==u.SK.GetAccessor?a(t,[r],!1,e=c.getDeclarationOfKind(e.symbol,u.SK.SetAccessor)):e&&(e.kind==u.SK.PropertySignature||e.kind==u.SK.PropertyAssignment||u.target&&u.target.switches.slowFields)&&a(t,[r])}}}function a(t,r,e=!1,n=null){var e=e||!(l(t).flags&c.TypeFlags.Void),i=n||o(t);if(t.expression&&i){let e=!1;switch(i.kind){case u.SK.PropertySignature:case u.SK.PropertyAssignment:case u.SK.PropertyDeclaration:u.isStatic(i)||(e=!0);break;case u.SK.Parameter:u.isCtorField(i)&&(e=!0);break;case u.SK.GetAccessor:case u.SK.SetAccessor:case u.SK.MethodDeclaration:case u.SK.MethodSignature:u.isStatic(i)||(e=!0)}e&&((n=t.expression).kind===u.SK.PropertyAccessExpression?r.unshift(n.expression):r.unshift(t.expression))}n={decl:i,qName:i?u.getNodeFullName(s,i):"?",args:r,isExpression:e};u.pxtInfo(t).callInfo=n}function o(e){if(!e)return null;var t,r=s.getSymbolAtLocation(e);let n;return(n=r&&!(n=r.valueDeclaration)&&r.declarations&&(t=r.declarations[0])&&t.kind==c.SyntaxKind.ImportEqualsDeclaration&&(r=s.getSymbolAtLocation(t.moduleReference))?r.valueDeclaration:n)||e.kind!=u.SK.PropertyAccessExpression||(t=e,n={kind:u.SK.PropertySignature,symbol:{isBogusSymbol:!0,name:t.name.getText()},name:t.name},u.pxtInfo(n).flags|=2),n}function l(e){let t;var r=u.pxtInfo(e);return r.typeCache||(t=(t=c.isExpression(e)?s.getContextualType(e):t)||s.getTypeAtLocation(e))&&(c.isStringLiteral(e)?t:u.checkType(t))}!function e(t){c.forEachChild(t,r=>{switch(r.kind){case c.SyntaxKind.CallExpression:a(r,r.arguments.slice(0),null,o(r.expression));break;case c.SyntaxKind.PropertyAccessExpression:a(r,[]);break;case c.SyntaxKind.TaggedTemplateExpression:a(r,[r.template],!0,o(r.tag));break;case c.SyntaxKind.BinaryExpression:i(r);break;case c.SyntaxKind.Identifier:let t=o(r);if(t&&t.getSourceFile().fileName!==pxt.MAIN_TS&&t.kind==c.SyntaxKind.VariableDeclaration){let e=u.pxtInfo(r);e.flags|=4,e.commentAttrs||(e.commentAttrs=u.parseComments(t))}}e(r)})}(r),u.target=n}})(ts=ts||{}),(e=>{var b=e.pxtc||(e.pxtc={});function a(t){let r='"';for(let e=0;e<t.length;++e){var n=255&t.charCodeAt(e),i=String.fromCharCode(n);r+="\\"==i||'"'==i?"\\"+i:"\n"==i?"\\n":n<=15?"\\x0"+n.toString(16):n<32||127<n?"\\x"+n.toString(16):i}return r+'"'}function r(r){let e="pxt::string_inline_ascii_vt";var n=b.target.utf8?b.U.toUTF8(r,!0):r;let i="";if(n!==r)if(16<r.length){e="pxt::string_skiplist16_packed_vt";var s=[];let t=0;for(let e=0;e+16<=r.length;e+=16)t+=b.U.toUTF8(r.slice(e,e+16),!0).length,s.push(t);i=`
    .short ${n.length}, ${r.length}
    .short ${s.map(e=>e.toString()).join(", ")}
    .string ${a(n)}
`}else e="pxt::string_inline_utf8_vt";return i=i||`
    .short ${n.length}
    .string ${a(n)}
`,{vt:e,asm:i}}function n(e,t=""){return`
                .word ${e.length>>1}${t}
                .hex ${e}${e.length%4==0?"":"00"}
        `}b.asmStringLiteral=a,b.AssemblerSnippets=class{nop(){return"TBD(nop)"}reg_gets_imm(e,t){return"TBD(reg_gets_imm)"}proc_setup(e,t){return"TBD(proc_setup)"}push_fixed(e){return"TBD(push_fixed)"}push_local(e){return"TBD(push_local)"}push_locals(e){return"TBD(push_locals)"}pop_fixed(e){return"TBD(pop_fixed)"}pop_locals(e){return"TBD(pop_locals)"}proc_return(){return"TBD(proc_return)"}debugger_stmt(e){return""}debugger_bkpt(e){return""}debugger_proc(e){return""}unconditional_branch(e){return"TBD(unconditional_branch)"}beq(e){return"TBD(beq)"}bne(e){return"TBD(bne)"}cmp(e,t){return"TBD(cmp)"}cmp_zero(e){return"TBD(cmp_zero)"}arithmetic(){return""}load_reg_src_off(e,t,r,n,i,s){return"TBD(load_reg_src_off)"}rt_call(e,t,r){return"TBD(rt_call)"}call_lbl(e,t){return"TBD(call_lbl)"}call_reg(e){return"TBD(call_reg)"}helper_prologue(){return"TBD(lambda_prologue)"}helper_epilogue(){return"TBD(lambda_epilogue)"}pop_clean(e){return"TBD"}load_ptr_full(e,t){return"TBD(load_ptr_full)"}emit_int(e,t){return"TBD(emit_int)"}obj_header(e){return".word "+e}string_literal(e,t){t=r(t);return`
            .balign 4
            .object ${e}
            ${e}: ${this.obj_header(t.vt)}
            ${t.asm}
`}hex_literal(e,t){return`
.balign ${/f{16}/i.test(t)?8:4}
.object ${e}
${e}: ${this.obj_header("pxt::buffer_vt")}
${n(t)}
`}},b.utf8AsmStringLiteral=r,b.hexLiteralAsm=n,b.numBytes=function(t){let r=0;for(let e=t;0<e;e>>>=8)r++;return r||1},b.ProctoAssembler=class{constructor(e,t,r){this.resText="",this.exprStack=[],this.calls=[],this.proc=null,this.baseStackSize=0,this.labelledHelpers={},this.write=e=>{this.resText+=b.asmline(e)},this.t=e,this.bin=t,this.proc=r,this.proc&&this.work()}emitHelpers(){this.emitLambdaTrampoline(),this.emitArrayMethods(),this.emitFieldMethods(),this.emitBindHelper()}redirectOutput(e){var t=this.write;let r="";this.write=e=>r+=b.asmline(e);try{e()}finally{this.write=t}return r}stackSize(){return this.baseStackSize+this.exprStack.length}stackAlignmentNeeded(e=0){return!b.target.stackAlign||(e=b.target.stackAlign-(this.stackSize()+e&b.target.stackAlign-1))==b.target.stackAlign?0:e}getAssembly(){return this.resText}work(){this.write(`
;
; Function ${this.proc.getFullName()}
;
`);var e=this.proc.label();this.write(`.object ${e} `+JSON.stringify(this.proc.getFullName()));let s=e+"_pre",a=e+"_bkpt",o=e+"_locals",l=e+"_end";this.write(s+":"),this.emitLambdaWrapper(this.proc.isRoot),this.write(".section code"),this.write(e+":"),this.proc.classInfo&&this.proc.info.thisParameter&&!b.target.switches.skipClassCheck&&!b.target.switches.noThisCheckOpt&&(this.write("mov r7, lr"),this.write("ldr r0, [sp, #0]"),this.emitInstanceOf(this.proc.classInfo,"validate"),this.write("mov lr, r7")),this.write(`
${e}_nochk:
    @stackmark func
    @stackmark args
`),this.proc.fillDebugInfo=t=>{var e,r=t.getLabels();this.proc.debugInfo={locals:(1==this.proc.seqNo?this.bin.globals:this.proc.locals).map(e=>e.getDebugInfo()),args:this.proc.args.map(e=>e.getDebugInfo()),name:this.proc.getName(),codeStartLoc:b.U.lookup(r,o),codeEndLoc:b.U.lookup(r,l),bkptLoc:b.U.lookup(r,a),localsMark:b.U.lookup(t.stackAtLabel,o),idx:this.proc.seqNo,calls:this.calls,size:b.U.lookup(r,l)+2-b.U.lookup(r,s)};for(e of this.calls)e.addr=b.U.lookup(r,e.callLabel),e.stack=b.U.lookup(t.stackAtLabel,e.callLabel),e.callLabel=void 0;for(let e=0;e<this.proc.body.length;++e){var n,i=this.proc.body[e].breakpointInfo;i&&(n=b.U.lookup(t.stackAtLabel,"__brkp_"+i.id))!==this.proc.debugInfo.localsMark&&(pxt.log(i),pxt.log(t.stackAtLabel),b.U.oops(`offset doesn't match: ${n} != `+this.proc.debugInfo.localsMark))}},this.bin.breakpoints&&this.write(this.t.debugger_proc(a)),this.baseStackSize=1;e=this.proc.locals.length;this.write("push {lr}"),this.write(".locals:\n"),this.proc.perfCounterNo&&(this.write(this.t.emit_int(this.proc.perfCounterNo,"r0")),this.write("bl pxt::startPerfCounter")),this.write(this.t.proc_setup(e)),this.baseStackSize+=e,this.write("@stackmark locals"),this.write(o+":");for(let e=0;e<this.proc.body.length;++e){var t,r=this.proc.body[e];switch(r.stmtKind){case b.ir.SK.Expr:this.emitExpr(r.expr);break;case b.ir.SK.StackEmpty:if(0<this.exprStack.length){for(var n of this.proc.body.slice(e-4,e+1))pxt.log("PREVSTMT "+n.toString().trim());for(var i of this.exprStack)pxt.log(`EXPRSTACK ${i.currUses}/${i.totalUses} E: `+i.toString());b.oops("stack should be empty")}this.write("@stackempty locals");break;case b.ir.SK.Jmp:this.emitJmp(r);break;case b.ir.SK.Label:this.write(r.lblName+":"),this.validateJmpStack(r);break;case b.ir.SK.Comment:this.write("; "+r.expr.data);break;case b.ir.SK.Breakpoint:this.bin.breakpoints&&(t="__brkp_"+r.breakpointInfo.id,r.breakpointInfo.isDebuggerStmt?this.write(this.t.debugger_stmt(t)):this.write(this.t.debugger_bkpt(t)));break;default:b.oops()}}b.assert(0<=e&&e<127),0<e&&this.write(this.t.pop_locals(e)),this.proc.perfCounterNo&&(this.write("mov r4, r0"),this.write(this.t.emit_int(this.proc.perfCounterNo,"r0")),this.write("bl pxt::stopPerfCounter"),this.write("mov r0, r4")),this.write(l+":"),this.write(this.t.proc_return()),this.write("@stackempty func"),this.write("@stackempty args"),this.write("; endfun")}mkLbl(e){let t=e+this.bin.lblNo++;return t="_"!=t[0]?"."+t:t}dumpStack(){let e="[";for(var t of this.exprStack)e+=t.sharingInfo()+": "+t.toString()+"; ";return e+="]"}terminate(e){b.assert(e.exprKind==b.ir.EK.SharedRef);e=e.args[0];b.U.assert(e.currUses!=e.totalUses),b.U.assert(this.exprStack[0]===e,"term at top");let t=1;for(;t<this.exprStack.length;){var r=this.exprStack[t];if(r.currUses!=r.totalUses)break;t++}return this.write("@dummystack "+t),this.write(this.t.pop_locals(t)),t}validateJmpStack(e,t=0){t=this.exprStack.length-t;null==e.lblStackSize?e.lblStackSize=t:e.lblStackSize!=t&&(pxt.log(e.lblStackSize,t),pxt.log(this.dumpStack()),b.U.oops("stack misaligned at: "+e.lblName))}emitJmp(e){let t=0;var r;e.jmpMode==b.ir.JmpMode.Always?(e.expr&&this.emitExpr(e.expr),e.terminateExpr&&(t=this.terminate(e.terminateExpr)),this.write(this.t.unconditional_branch(e.lblName)+" ; with expression")):(r=this.mkLbl("jmpz"),this.emitExpr(e.expr),e.expr.exprKind==b.ir.EK.RuntimeCall&&("thumb::subs"===e.expr.data||b.U.startsWith(e.expr.data,"_cmp_"))||this.write(this.t.cmp_zero("r0")),e.jmpMode==b.ir.JmpMode.IfNotZero?this.write(this.t.beq(r)):this.write(this.t.bne(r)),e.terminateExpr&&(t=this.terminate(e.terminateExpr)),this.write(this.t.unconditional_branch(e.lblName)),this.write(r+":")),this.validateJmpStack(e.lbl,t)}clearStack(e=!1){let t=0;for(;0<this.exprStack.length&&this.exprStack[0].currUses==this.exprStack[0].totalUses;)t++,this.exprStack.shift();if(t&&this.write(this.t.pop_locals(t)),!e){e=this.exprStack.filter(e=>e.currUses==e.totalUses&&-1!=e.irCurrUses);if(0<e.length){this.write(this.t.reg_gets_imm("r7",0));for(var r of e)r.irCurrUses=-1,this.write(this.loadFromExprStack("r7",r,0,!0))}}}emitExprInto(e,t){switch(e.exprKind){case b.ir.EK.NumberLiteral:"number"==typeof e.data?this.write(this.t.emit_int(e.data,t)):b.oops();break;case b.ir.EK.PointerLiteral:this.write(this.t.load_ptr_full(e.data,t));break;case b.ir.EK.SharedRef:var r=e.args[0],n=(b.U.assert(!!r.currUses),b.U.assert(r.currUses<r.totalUses),r.currUses++,this.exprStack.indexOf(r));b.U.assert(0<=n),0==n&&r.totalUses==r.currUses?(this.write(this.t.pop_fixed([t])+(" ; tmpref @"+this.exprStack.length)),this.exprStack.shift(),this.clearStack()):(r=n.toString()+":"+this.exprStack.length,this.write(this.t.load_reg_src_off(t,"sp",r,!0)+(" ; tmpref @"+(this.exprStack.length-n))));break;case b.ir.EK.CellRef:r=e.data;if(r.isGlobal()){n=this.bitSizeInfo(r.bitSize);let e="#"+r.index;(n.needsSignExt||r.index>=n.immLimit)&&(this.write(this.t.emit_int(r.index,t)),e=t),this.write(this.t.load_reg_src_off("r7","r6","#0")),this.write(this.t.load_reg_src_off(t,"r7",e,!1,!1,n))}else{var[n,r,i]=this.cellref(r);this.write(this.t.load_reg_src_off(t,n,r,i))}break;default:b.oops()}}bitSizeInfo(e){var t={size:b.sizeOfBitSize(e),immLimit:128};return 1==t.size?t.immLimit=32:2==t.size&&(t.immLimit=64),1!=e&&3!=e||(t.needsSignExt=!0),t}emitExpr(e){switch(e.exprKind){case b.ir.EK.JmpValue:this.write("; jmp value (already in r0)");break;case b.ir.EK.Nop:this.write(this.t.nop());break;case b.ir.EK.FieldAccess:return this.emitExpr(e.args[0]),this.emitFieldAccess(e);case b.ir.EK.Store:return this.emitStore(e.args[0],e.args[1]);case b.ir.EK.RuntimeCall:return this.emitRtCall(e);case b.ir.EK.ProcCall:return this.emitProcCall(e);case b.ir.EK.SharedDef:return this.emitSharedDef(e);case b.ir.EK.Sequence:return e.args.forEach(e=>this.emitExpr(e)),this.clearStack();case b.ir.EK.InstanceOf:return this.emitExpr(e.args[0]),this.emitInstanceOf(e.data,e.jsInfo);default:return this.emitExprInto(e,"r0")}}emitFieldAccess(e,t=!1){e=e.data,e.classInfo.id,e.needsCheck&&!b.target.switches.skipClassCheck&&this.emitInstanceOf(e.classInfo,"validate"),e=4*e.idx+4;let r="#"+e;124<e&&(this.write(this.t.emit_int(e,"r3")),r="r3"),t?this.write(`str r1, [r0, ${r}]`):this.write(`ldr r0, [r0, ${r}]`)}writeFailBranch(){this.write(".fail:"),this.write("mov r1, lr"),this.write(this.t.callCPP("pxt::failedCast"))}emitClassCall(e){var t=e.virtualIndex+b.firstMethodOffset();this.write(this.t.emit_int(4*t,"r1"));let r=e.classInfo,n="";e.isThis&&(n+="_this"),this.emitLabelledHelper("classCall_"+r.id+n,()=>{this.write("ldr r0, [sp, #0] ; ld-this"),this.loadVTable(),b.target.switches.skipClassCheck||e.isThis||this.checkSubtype(r),this.write("ldr r1, [r3, r1] ; ld-method"),this.write("bx r1 ; keep lr from caller"),this.writeFailBranch()})}helperObject(e){return`.object _pxt_helper_${e.replace(/[^\w]+/g,"_")} "helper: ${e}"`}emitBindHelper(){this.write(`
                ${this.helperObject("bind")}
                .section code
                _pxt_bind_helper:
                    push {r0, r2}
                    movs r0, #2
                    ldlit r1, _pxt_bind_lit
                    ${this.t.callCPP("pxt::mkAction")}
                    pop {r1, r2}
                    str r1, [r0, #12]
                    str r2, [r0, #16]
                    bx r4 ; return

                _pxt_bind_lit:
                    ${this.t.obj_header("pxt::RefAction_vtable")}
                    .short 0, 0 ; no captured vars
                    .word .bindCode@fn
                .bindCode:
                    ; r0-bind object, r4-#args
                    cmp r4, #12
                    bge .fail
                    lsls r3, r4, #2
                    ldlit r2, _pxt_copy_list
                    ldr r1, [r2, r3]

                    ldr r3, [r0, #12]
                    ldr r2, [r0, #16]
                    adds r4, r4, #1
                    bx r1
            `),this.writeFailBranch(),this.write("_pxt_copy_list:"),this.write(b.U.range(12).map(e=>`.word _pxt_bind_${e}@fn`).join("\n"));for(let t=0;t<12;t++){this.write(`
                _pxt_bind_${t}:
                    sub sp, #4
                `);for(let e=0;e<t;++e)this.write(`ldr r1, [sp, #4*${e+1}]`),this.write(`str r1, [sp, #4*${e}]`);this.write(`
                    push {r3} ; this-ptr
                    mov r1, lr
                    str r1, [sp, #4*${t+1}] ; store LR
                    blx r2
                    ldr r1, [sp, #4*${t+1}]
                    add sp, #8
                    bx r1
                `)}}ifaceCallCore(t,e,r=!1){this.write(`
                ldr r2, [r3, #12] ; load mult
                movs r7, r2
                beq .objlit ; built-in types have mult=0
                muls r7, r1
                lsrs r7, r2
                lsls r7, r7, #1 ; r7 - hash offset
                ldr r3, [r3, #4] ; iface table
                adds r3, r3, r7
                ; r0-this, r1-method idx, r2-free, r3-hash entry, r4-num args, r7-free
                `);for(let e=0;e<b.vtLookups;++e)0<e&&this.write("    adds r3, #2"),this.write(`
                ldrh r2, [r3, #0] ; r2-offset of descriptor
                ldrh r7, [r2, r3] ; r7-method idx
                cmp r7, r1
                beq .hit
                `);"get"==e?(this.write("movs r0, #0 ; undefined"),this.write("bx lr")):this.write("b .fail2"),this.write(`
            .hit:
                adds r3, r3, r2 ; r3-descriptor
                ldr r2, [r3, #4]
                lsls r7, r2, #31
                beq .field
            `);var n=this.t.emit_int(t,"r4")+"\n     bx r2";if("set"==e?this.write(`
                    ; check for next descriptor
                    ldrh r7, [r3, #8]
                    cmp r7, r1
                    bne .fail2 ; no setter!
                    ldr r2, [r3, #12]
                    ${n}
                `):(this.write(`
                    ; check if it's getter
                    ldrh r7, [r3, #2]
                    cmp r7, #1
                `),"get"==e?this.write(`
                        bne .bind
                        ${n}
                    .bind:
                        mov r4, lr
                        bl _pxt_bind_helper
                    `):this.write(`
                        beq .doublecall
                        ${n}
                    .doublecall:
                        ; call getter
                        movs r4, #1
                        push {r0, lr}
                        blx r2
                        pop {r1, r2}
                        mov lr, r2
                        b .moveArgs
                    `)),r||(this.write(`
                .objlit:
                    ldrh r2, [r3, #8]
                    cmp r2, #${pxt.BuiltInType.RefMap}
                    bne .fail
                    mov r4, lr
                `),"set"==e&&this.write("ldr r2, [sp, #4] ; ld-val"),this.write(this.t.callCPP("set"==e?"pxtrt::mapSet":"pxtrt::mapGet")),e?this.write("bx r4"):(this.write("mov lr, r4"),this.write("b .moveArgs"))),this.write(".field:"),"set"==e?this.write(`
                        ldr r3, [sp, #4] ; ld-val
                        str r3, [r0, r2] ; store field
                        bx lr
                    `):"get"==e?this.write(`
                        ldr r0, [r0, r2] ; load field
                        bx lr
                    `):this.write(`
                        ldr r0, [r0, r2] ; load field
                    `),!e){this.write(".moveArgs:");for(let e=0;e<t;++e)e==t-1?this.write("movs r1, r0"):this.write(`ldr r1, [sp, #4*${e+1}]`),this.write(`str r1, [sp, #4*${e}]`);this.lambdaCall(t-1)}r&&this.write(".objlit:"),this.writeFailBranch(),this.write(`
            .fail2:
                ${this.t.callCPP("pxt::missingProperty")}
            `)}emitIfaceCall(e,t,r=""){b.U.assert(0<e.ifaceIndex),this.write(this.t.emit_int(e.ifaceIndex,"r1")),this.emitLabelledHelper("ifacecall"+t+"_"+r,()=>{this.write("ldr r0, [sp, #0] ; ld-this"),this.loadVTable(),this.ifaceCallCore(t,r)})}checkSubtype(e,t=".fail",r="r2"){e.classNo?(this.write(`ldrh ${r}, [r3, #8]`),this.write(`cmp ${r}, #`+e.classNo),e.classNo==e.lastSubtypeNo?this.write("bne "+t):(this.write("blt "+t),this.write(`cmp ${r}, #`+e.lastSubtypeNo),this.write("bgt "+t))):this.write(`b ${t} ; always fails; class never instantiated`)}loadVTable(e="r2",t=".fail",r=".fail"){this.write(`lsls ${e}, r0, #30`),this.write("bne "+t),this.write("cmp r0, #0"),this.write("beq "+r),this.write("ldr r3, [r0, #0]"),this.write("; vtable in R3")}emitInstanceOf(e,t){var r="inst_"+e.id+"_"+t;this.emitLabelledHelper(r,()=>{"validateNullable"==t?this.loadVTable("r2",".tagged",".undefined"):this.loadVTable("r2",".fail",".fail"),this.checkSubtype(e),"bool"==t?(this.write("movs r0, #"+b.taggedTrue),this.write("bx lr"),this.write(".fail:"),this.write("movs r0, #"+b.taggedFalse),this.write("bx lr")):"validate"==t?(this.write("bx lr"),this.writeFailBranch()):"validateNullable"==t?(this.write(".undefined:"),this.write("bx lr"),this.write(".tagged:"),this.write(`cmp r0, #${b.taggedNull} ; check for null`),this.write("bne .fail"),this.write("movs r0, #0"),this.write("bx lr"),this.writeFailBranch()):b.U.oops()})}emitSharedDef(e){e=e.args[0];if(b.U.assert(1<=e.totalUses),b.U.assert(0===e.currUses),(e.currUses=1)==e.totalUses)return this.emitExpr(e);this.emitExpr(e),this.exprStack.unshift(e),this.write(this.t.push_local("r0")+"; tmpstore @"+this.exprStack.length)}clearArgs(e,t){e.length,t.length;var r,n=e.concat(t);for(r of n)0==r.currUses&&1==r.totalUses||(pxt.log(r.toString()),pxt.log(n.map(e=>e.toString())),b.U.oops(`wrong uses: ${r.currUses} `+r.totalUses)),r.currUses=1;this.clearStack()}builtInClassNo(e){return{id:"builtin"+e,classNo:e,lastSubtypeNo:e}}emitBeginTry(e){this.emitExprInto(e.args[0],"r0"),this.write("bl _pxt_save_exception_state")}emitRtCall(e,t=null){var r=e.data;if("pxt::beginTry"==r)return this.emitBeginTry(e);let n=e.mask||{refMask:0},i=n.conversions||[];var s,a,e=e.args.map((e,t)=>({idx:t,expr:e,isSimple:e.isLiteral(),isRef:0!=(n.refMask&1<<t),conv:i.find(e=>e.argIdx==t)}));b.U.assert(e.length<=4);let o=!1;for(s of b.U.reversed(e))s.expr.isPure()?s.isSimple||s.isRef||o&&!s.expr.isStateless()||(s.isSimple=!0):o=!0;for(a of e)a.conv&&(a.isSimple=!1);let l=e.filter(e=>!e.isSimple);if(l.every(e=>e.expr.isPure()&&!e.isRef&&!e.conv)){for(var c of l)c.isSimple=!0;l=[]}var u,d=l[0];let p=!0;if(1!=l.length||d.conv||d.isRef){for(var h of l)this.pushArg(h.expr);this.alignExprStack(0);let s=l.filter(e=>!!e.conv);if(s.length){var m=this.redirectOutput(()=>{let e=0;b.target.switches.inlineConversions||(this.t.stackAligned()?e+=2:e+=1);for(var t of s){var r;b.isThumb()&&"pxt::toInt"==t.conv.method?(this.write(this.loadFromExprStack("r0",t.expr,e)),this.write("asrs r0, r0, #1"),r=b.target.switches.inlineConversions?t.expr.getId():e,this.write("bcs .isint"+r),this.write("lsls r0, r0, #1"),this.alignedCall(t.conv.method,"",e),this.write(".isint"+r+":")):(this.write(this.loadFromExprStack("r0",t.expr,e)),t.conv.refTag?b.target.switches.skipClassCheck||this.emitInstanceOf(this.builtInClassNo(t.conv.refTag),t.conv.refTagNullable?"validateNullable":"validate"):(this.alignedCall(t.conv.method,"",e),t.conv.returnsRef&&this.write(this.loadFromExprStack("r0",t.expr,e,!0)))),this.write(this.t.push_fixed(["r0"])),e++}for(var n of b.U.reversed(s))e--,this.write(this.t.pop_fixed(["r"+n.idx]));for(var i of l)i.conv||this.write(this.loadFromExprStack("r"+i.idx,i.expr,e))});b.target.switches.inlineConversions?this.write(m):this.emitHelper(this.t.helper_prologue()+m+this.t.helper_epilogue(),"conv")}else for(var g of l)this.write(this.loadFromExprStack("r"+g.idx,g.expr))}else this.emitExpr(d.expr),0!=d.idx&&this.write(this.t.mov("r"+d.idx,"r0")),p=!1;for(u of e)u.isSimple&&this.emitExprInto(u.expr,"r"+u.idx);t?t():"langsupp::ignore"!=r&&this.alignedCall(r,"",0,!0),p&&this.clearArgs(l.filter(e=>!e.isRef).map(e=>e.expr),l.filter(e=>e.isRef).map(e=>e.expr))}alignedCall(e,t="",r=0,n=!1){(b.U.startsWith(e,"_cmp_")||b.U.startsWith(e,"_pxt_"))&&(n=!1),this.write(this.t.call_lbl(e,n,this.stackAlignmentNeeded(r))+t)}emitLabelledHelper(e,t){this.labelledHelpers[e]?this.write(this.t.call_lbl(this.labelledHelpers[e])):(t=this.redirectOutput(t),this.emitHelper(t,e),this.labelledHelpers[e]=this.bin.codeHelpers[t])}emitHelper(e,t="hlp"){var r;this.bin.codeHelpers[e]||(r=Object.keys(this.bin.codeHelpers).length,this.bin.codeHelpers[e]=`_${t}_`+r),this.write(this.t.call_lbl(this.bin.codeHelpers[e]))}pushToExprStack(e){e.totalUses=1,e.currUses=0,this.exprStack.unshift(e)}pushArg(e){this.clearStack(!0);this.exprStack.length;this.emitExpr(e),this.clearStack(!0),this.write(this.t.push_local("r0")+" ; proc-arg"),this.pushToExprStack(e)}loadFromExprStack(e,t,r=0,n=!1){t=this.exprStack.indexOf(t);return b.assert(0<=t),this.t.load_reg_src_off(e,"sp",(t+r).toString(),!0,n)+` ; estack
`}pushDummy(){var e=b.ir.numlit(0);e.totalUses=1,e.currUses=1,this.exprStack.unshift(e)}alignExprStack(e){var t=this.stackAlignmentNeeded(e);if(t)for(let e=0;e<t;++e)this.write("push {r5} ; align"),this.pushDummy()}emitFieldMethods(){for(var t of["get","set"]){this.write(`
                ${this.helperObject(t)}
                .section code
                _pxt_map_${t}:
                `),this.loadVTable("r4"),this.checkSubtype(this.builtInClassNo(pxt.BuiltInType.RefMap),".notmap","r4"),this.write(this.t.callCPPPush("set"==t?"pxtrt::mapSetByString":"pxtrt::mapGetByString")),this.write(".notmap:");var r="set"==t?2:1;let e=!1;this.write("mov r4, r3 ; save VT"),"set"==t?(b.target.stackAlign&&(e=!0,this.write("push {lr} ; align")),this.write(`
                            push {r0, r2, lr}
                            mov r0, r1
                        `)):this.write(`
                            push {r0, lr}
                            mov r0, r1
                        `),this.write(`
                    bl pxtrt::lookupMapKey
                    mov r1, r0 ; put key index in r1
                    ldr r0, [sp, #0] ; restore obj pointer
                    mov r3, r4 ; restore vt
                    bl .dowork
                `),this.write(this.t.pop_locals(r+(e?1:0))),this.write("pop {pc}"),this.write(".dowork:"),this.ifaceCallCore(r,t,!0)}}emitArrayMethod(e,t){this.write(`
            ${this.helperObject(e+" "+(t?"buffer":"array"))}
            .section code
            _pxt_${t?"buffer":"array"}_${e}:
            `),this.loadVTable("r4");var r=this.builtInClassNo(t?pxt.BuiltInType.BoxedBuffer:pxt.BuiltInType.RefCollection),r=(b.target.switches.skipClassCheck||this.checkSubtype(r,".fail","r4"),b.isStackMachine()||b.target.runtimeIsARM||t?"ldr":"ldrh");this.write(`
                asrs r1, r1, #1
                bcc .notint
                ${r} r4, [r0, #${t?4:8}]
                cmp r1, r4
                bhs .oob
            `);let n="r1";t?(n="#8",this.write(`
                    adds r4, r0, r1
                `)):this.write(`
                    lsls r1, r1, #2
                    ldr r4, [r0, #4]
                `);var r=t?"b":"",i=t&&"get"==e?"lsls r0, r0, #1\nadds r0, #1":"";"set"==e?this.write(`
                        str${r} r2, [r4, ${n}]
                        bx lr
                    `):this.write(`
                        ldr${r} r0, [r4, ${n}]
                        ${i}
                        bx lr
                    `),this.write(`
            .notint:
                lsls r1, r1, #1
                ${this.t.pushLR()}
                push {r0, r2}
                mov r0, r1
                ${this.t.callCPP("pxt::toInt")}
                mov r1, r0
                pop {r0, r2}
            .doop:
                ${this.t.callCPP(`Array_::${e}At`)}
                ${i}
                ${this.t.popPC()}
            `),this.writeFailBranch(),"get"==e?this.write(`
                    .oob:
                        movs r0, #${t?1:0} ; 0 or undefined
                        bx lr
                `):this.write(`
                    .oob:
                        ${this.t.pushLR()}
                        b .doop
                `)}emitArrayMethods(){for(var e of["get","set"])this.emitArrayMethod(e,!0),this.emitArrayMethod(e,!1)}emitLambdaTrampoline(){var e=b.target.stackAlign?"r3,":"";this.write(`
            ${this.helperObject("trampoline")}
            .section code
            _pxt_lambda_trampoline:
                push {${e} r4, r5, r6, r7, lr}
                mov r4, r8
                mov r5, r9
                mov r6, r10
                mov r7, r11
                push {r4, r5, r6, r7} ; save high registers
                mov r4, r1
                mov r5, r2
                mov r6, r3
                mov r7, r0
                `),this.emitInstanceOf(this.builtInClassNo(pxt.BuiltInType.RefAction),"validate"),this.write(`
                mov r0, sp
                push {r4, r5, r6, r7} ; push args and the lambda
                mov r1, sp
                bl pxt::pushThreadContext
                mov r6, r0          ; save ctx or globals
                mov r5, r7          ; save lambda for closure
                mov r0, r5          ; also save lambda pointer in r0 - needed by pxt::bindMethod
                ldr r1, [r5, #8]    ; ld fnptr
                movs r4, #3         ; 3 args
                blx r1              ; execute the actual lambda
                mov r7, r0          ; save result
                @dummystack 4
                add sp, #4*4        ; remove arguments and lambda
                mov r0, r6   ; or pop the thread context
                bl pxt::popThreadContext
                mov r0, r7 ; restore result
                pop {r4, r5, r6, r7} ; restore high registers
                mov r8, r4
                mov r9, r5
                mov r10, r6
                mov r11, r7
                pop {${e} r4, r5, r6, r7, pc}`),this.write(`
            ${this.helperObject("exn")}
            .section code
            ; r0 - try frame
            ; r1 - handler PC
            _pxt_save_exception_state:
                push {r0, lr}
                ${this.t.callCPP("pxt::beginTry")}
                pop {r1, r4}
                str r1, [r0, #1*4] ; PC
                mov r1, sp
                str r1, [r0, #2*4] ; SP
                str r5, [r0, #3*4] ; lambda ptr
                bx r4
                `),this.write(`
            .section code
            ; r0 - try frame
            ; r1 - thread context
            _pxt_restore_exception_state:
                mov r6, r1
                ldr r1, [r0, #2*4] ; SP
                mov sp, r1
                ldr r5, [r0, #3*4] ; lambda ptr
                ldr r1, [r0, #1*4] ; PC
                movs r0, #1
                orrs r1, r0
                bx r1
                `),this.write(`
            ${this.helperObject("stringconv")}
            .section code
            _pxt_stringConv:
            `),this.loadVTable(),this.checkSubtype(this.builtInClassNo(pxt.BuiltInType.BoxedString),".notstring"),this.write(`
                bx lr

            .notstring: ; no string, but vtable in r3
                ldr r7, [r3, #4*${b.firstMethodOffset()-1}]
                cmp r7, #0
                beq .fail
                push {r0, lr}
                movs r4, #1
                blx r7
                str r0, [sp, #0]
                b .numops

            .fail: ; not an object or no toString
                push {r0, lr}
            .numops:
                ${this.t.callCPP("numops::toString")}
                pop {r1}
                pop {pc}
            `)}emitProcCall(t){let r=[],e=null,n="";var i=t.data;if(i.proc&&i.proc.inlineBody)return this.emitExpr(i.proc.inlineSelf(t.args));var s,a=-1==i.virtualIndex;let o=!1;for(s of b.U.reversed(t.args)){if(s.isPure()){if(!o||s.isStateless())continue}else o=!0;r.push(s)}if(r.reverse(),r.length<=1){var l=r[0];l&&(e=l,this.clearStack(!0),this.emitExpr(l),l==t.args[t.args.length-1]?n="r0":(n="r3",this.write(this.t.mov("r3","r0")))),r=[]}else for(var c of r)this.pushArg(c);this.alignExprStack(t.args.length);let u=["r1","r2","r3","r4"],d=[];if(r.length){let t=-1;for(var p of r)t=Math.max(this.exprStack.indexOf(p),t);if(++t<=u.length){u=u.slice(0,t),this.write(this.t.pop_fixed(u)),d=this.exprStack.splice(0,t);var h=[];for(let e=t-1;0<=e;--e)r.indexOf(d[e])<0&&(h.push(u[e]),this.exprStack.unshift(d[e]));h.length&&this.write(this.t.push_fixed(h))}else u=null,this.write(this.t.reg_gets_imm("r7",0))}var m,g,f,l=b.U.reversed(t.args);a&&l.unshift(l.pop());for(m of l)0<=r.indexOf(m)?(u?this.write(this.t.push_fixed([u[d.indexOf(m)]])):(this.write(this.loadFromExprStack("r0",m)),this.write(this.t.push_local("r0")+" ; re-push"),this.write(this.loadFromExprStack("r7",m,1,!0)),g=this.exprStack.indexOf(m),(f=b.ir.numlit(0)).currUses=1,f.totalUses=1,this.exprStack[g]=f),this.exprStack.unshift(m)):m===e?(this.write(this.t.push_local(n)+" ; the one arg"),this.pushToExprStack(m)):this.pushArg(m);var _,l=this.mkLbl("_proccall");let y=-1;if(a){let e=t.args.length-1;this.write(this.loadFromExprStack("r0",t.args[0])),this.emitLabelledHelper("lambda_call"+e,()=>{this.lambdaCall(e),this.writeFailBranch()})}else null!=i.virtualIndex||null!=i.ifaceIndex?null!=i.ifaceIndex?i.isSet?(b.assert(2==t.args.length),this.emitIfaceCall(i,t.args.length,"set")):this.emitIfaceCall(i,t.args.length,i.noArgs?"get":""):this.emitClassCall(i):(_=i.proc,y=_.seqNo,this.write(this.t.call_lbl(_.label()+(i.isThis?"_nochk":"")))),this.write(l+":");this.calls.push({procIndex:y,stack:0,addr:0,callLabel:l}),a&&t.args[0].isStateless()?this.clearArgs([t.args[0]],t.args.slice(1)):this.clearArgs([],t.args)}lambdaCall(t){this.write("; lambda call"),this.loadVTable(),b.target.switches.skipClassCheck||this.checkSubtype(this.builtInClassNo(pxt.BuiltInType.RefAction)),this.write(`
                movs r4, #${t}
                ldrh r1, [r0, #4]
                cmp r1, #0
                bne .pushR5
                ldr r1, [r0, #8]
                bx r1 ; keep lr from the caller
            .pushR5:
                sub sp, #8
            `);for(let e=0;e<t;++e)this.write(`ldr r1, [sp, #4*${e+2}]`),this.write(`str r1, [sp, #4*${e}]`);this.write(`
                str r5, [sp, #4*${t}]
                mov r1, lr
                str r1, [sp, #4*${t+1}]
                mov r5, r0
                ldr r7, [r5, #8]
                blx r7 ; exec actual lambda
                ldr r4, [sp, #4*${t+1}] ; restore what was in LR
                ldr r5, [sp, #4*${t}] ; restore lambda ctx
            `);for(let e=0;e<t;++e)this.write(`ldr r1, [sp, #4*${e}]`),this.write(`str r1, [sp, #4*${e+2}]`);this.write(`
                add sp, #8
                bx r4
            `),this.write("; end lambda call")}emitStore(e,t){switch(e.exprKind){case b.ir.EK.CellRef:var r=e.data;if(this.emitExpr(t),r.isGlobal()){var n=this.bitSizeInfo(r.bitSize);let e="#"+r.index;r.index>=n.immLimit&&(this.write(this.t.emit_int(r.index,"r1")),e="r1"),this.write(this.t.load_reg_src_off("r7","r6","#0")),this.write(this.t.load_reg_src_off("r0","r7",e,!1,!0,n))}else{var[n,r,i]=this.cellref(r);this.write(this.t.load_reg_src_off("r0",n,r,i,!0))}break;case b.ir.EK.FieldAccess:this.emitRtCall(b.ir.rtcall("dummy",[e.args[0],t]),()=>this.emitFieldAccess(e,!0));break;default:b.oops()}}cellref(e){var t;if(e.isGlobal())throw b.oops();return e.iscap?(t=e.index+3,b.assert(0<=t&&t<32),["r5",t.toString(),!0]):e.isarg?["sp","args@"+e.index.toString()+":"+this.baseStackSize,!1]:["sp","locals@"+e.index,!1]}emitLambdaWrapper(n){if(this.write(""),this.write(".section code"),this.write(".balign 4"),n&&(this.proc.info.usedAsValue=!0),this.proc.info.usedAsValue||this.proc.info.usedAsIface){this.proc.info.usedAsValue&&(this.write(this.proc.label()+"_Lit:"),this.write(this.t.obj_header("pxt::RefAction_vtable")),this.write(".short 0, 0 ; no captured vars"),this.write(`.word ${this.proc.label()}_args@fn`)),this.write(this.proc.label()+"_args:");let r=this.proc.args.length;if(0!=r){this.write("cmp r4, #"+r),this.write(`bge ${this.proc.label()}_nochk`);let e=this.stackAlignmentNeeded(r+1),t=e?r+2:r+1;this.write("push {lr}"),this.emitLabelledHelper("expand_args_"+r,()=>{this.write("movs r0, #0"),this.write("movs r1, #0"),e&&this.write("push {r0}");for(let e=r;0<e;e--)e!=r&&(this.write("cmp r4, #"+e),this.write("blt .zero"+e),this.write(`ldr r0, [sp, #${t-1}*4]`),this.write(`str r1, [sp, #${t-1}*4] ; clear existing`),this.write(`.zero${e}:`)),this.write("push {r0}");this.write("bx lr")}),this.write(`bl ${this.proc.label()}_nochk`);n=r+(e?1:0);this.write("@dummystack "+n),this.write("add sp, #4*"+n),this.write("pop {pc}")}}}emitCallRaw(e){var t=b.hexfile.lookupFunc(e);b.assert(!!t,"unimplemented raw function: "+e),this.alignedCall(e)}}})(ts=ts||{}),(e=>{{var D=e.pxtc||(e.pxtc={});let A={"numops::adds":"+","numops::subs":"-","numops::div":"/","numops::mod":"%","numops::muls":"*","numops::ands":"&","numops::orrs":"|","numops::eors":"^","numops::bnot":"~","numops::lsls":"<<","numops::asrs":">>","numops::lsrs":">>>","numops::le":"<=","numops::lt":"<","numops::lt_bool":"<","numops::ge":">=","numops::gt":">","numops::eq":"==","pxt::eq_bool":"==","pxt::eqq_bool":"===","numops::eqq":"===","numops::neqq":"!==","numops::neq":"!="},d={"pxsim.Boolean_":"","pxsim.pxtcore":"","pxsim.String_":"","pxsim.ImageMethods":"","pxsim.Array_":"","pxsim.pxtrt":"","pxsim.numops":""},p={"pxsim.Array_.getAt":"","pxsim.Array_.length":"","pxsim.Array_.mk":"","pxsim.Array_.push":"","pxsim.Boolean_.bang":"","pxsim.String_.concat":"","pxsim.String_.stringConv":"","pxsim.numops.toBool":"","pxsim.numops.toBoolDecr":"","pxsim.pxtcore.mkAction":"","pxsim.pxtcore.mkClassInstance":"","pxsim.pxtrt.ldlocRef":"","pxsim.pxtrt.mapGetByString":"","pxsim.pxtrt.stclo":"","pxsim.pxtrt.stlocRef":""};function m(e){let t="";for(var r of Object.keys(e)){var n=r.replace(/\./g,"_");e[r]=n,t+=`const ${n} = ${r};
`}return t}function N(e){e="pxsim."+(e="pxt."==(e=e.replace(/::/g,".")).slice(0,4)?"pxtcore."+e.slice(4):e);if(p.hasOwnProperty(e))return p[e];var t=e.lastIndexOf(".");if(0<t){var r=e.slice(0,t);if(d.hasOwnProperty(r))return d[r]+e.slice(t)}return e}D.isBuiltinSimOp=function(e){return!!D.U.lookup(A,e.replace(/\./g,"::"))},D.shimToJs=N;let h=["runtime","oops","doNothing","pxsim","globals","maybeYield","setupDebugger","isBreakFrame","breakpoint","trace","checkStack","leave","checkResumeConsumed","setupResume","setupLambda","checkSubtype","failedCast","buildResume","mkVTable","bind","leaveAccessor"];D.jsEmit=function(r,e){let n="(function (ectx) {\n'use strict';\n";for(var t of h)n+=`const ${t} = ectx.${t};
`;n=(n=(n=n+`const __this = runtime;
`+`const pxtrt = pxsim.pxtrt;
`)+`let yieldSteps = 1;
`+`ectx.setupYield(function() { yieldSteps = 100; })
`)+"pxsim.setTitle("+JSON.stringify(r.getTitle())+");\n";var i,s={},a={};for(i of e.configData||[])s[i.key+""]=i.value,a[i.name]=i.key;n=(n+="pxsim.setConfigData("+JSON.stringify(s,null,1)+", "+JSON.stringify(a,null,1)+");\n")+"pxtrt.mapKeyNames = "+JSON.stringify(r.ifaceMembers,null,1)+";\n";var o=r.setPerfCounters(["SysScreen"]);n=(n=(n+="__this.setupPerfCounters("+JSON.stringify(o,null,1)+");\n")+m(p))+m(d);let l=0,c=0,u=(r.procs.forEach(e=>{let t;e.cachedJS?(t=e.cachedJS,l+=t.length):(t=((g,f)=>{if(f.cachedJS)return f.cachedJS;let t="",_=e=>{t+=e+"\n"},y=e=>{t+="    "+e+"\n"},b=D.ir.EK,v=[],r=0,n={},i="",T=(_(`
function ${f.label()}(s) {
let r0 = s.r0, step = s.pc;
s.pc = -1;
`),f.perfCounterNo&&_(`if (step == 0) __this.startPerfCounter(${f.perfCounterNo});
`),_(`
while (true) {
if (yieldSteps-- < 0 && maybeYield(s, step, r0) || runtime !== pxsim.runtime) return null;
switch (step) {
  case 0:
`),f.locals.forEach(e=>{y(E(e)+" = undefined;")}),f.args.length&&(y("if (s.lambdaArgs) {"),f.args.forEach((e,t)=>{y(`  ${E(e)} = (s.lambdaArgs[${t}]);`)}),y("  s.lambdaArgs = null;"),y("}")),f.classInfo&&f.info.thisParameter&&(y("r0 = s.arg0;"),I(f.classInfo,"validate")),0),k=[];for(var e of f.body)e.stmtKind==D.ir.SK.Label&&0<e.lblNumUses&&(e.lblId=++T);let s=0;for(var a of f.body){switch(a.stmtKind){case D.ir.SK.Expr:w(a.expr);break;case D.ir.SK.StackEmpty:u();break;case D.ir.SK.Jmp:let t=!1;for(let e=s+1;e<f.body.length&&f.body[e].stmtKind==D.ir.SK.Label;++e)if(a.lbl==f.body[e]){t=!0;break}((e,t)=>{e.lbl.lblNumUses==D.ir.lblNumUsesJmpNext||t?(D.assert(e.jmpMode==D.ir.JmpMode.Always),e.expr&&w(e.expr)):(D.assert(0<e.lbl.lblNumUses),t=`{ step = ${e.lbl.lblId}; continue; }`,e.jmpMode==D.ir.JmpMode.Always?(e.expr&&w(e.expr),y(t)):(w(e.expr),e.jmpMode==D.ir.JmpMode.IfNotZero?y("if (r0) "+t):y("if (!r0) "+t)))})(a,t);break;case D.ir.SK.Label:0<a.lblNumUses&&_(`  case ${a.lblId}:`);break;case D.ir.SK.Comment:_("// "+a.expr.data);break;case D.ir.SK.Breakpoint:(e=>{let t=e.breakpointInfo.id,r;if(y(`s.lastBrkId = ${t};`),g.breakpoints){var n=`return breakpoint(s, ${r=++T}, ${t}, r0);`;e.breakpointInfo.isDebuggerStmt?y(n):(y(`if ((breakpoints[0] && isBreakFrame(s)) || breakpoints[${t}]) `+n),g.trace&&y(`else return trace(${t}, s, ${r}, ${f.label()}.info);`))}else{if(!g.trace)return;r=++T,y(`return trace(${t}, s, ${r}, ${f.label()}.info);`)}_(`  case ${r}:`)})(a);break;default:D.oops()}s++}u(),f.perfCounterNo&&_(`__this.stopPerfCounter(${f.perfCounterNo});
`),f.isGetter()?y("return leaveAccessor(s, r0)"):y("return leave(s, r0)"),_("  default: oops()"),_("} } }");var o=D.nodeLocationInfo(f.action);return o.functionName=f.getName(),o.argumentNames=f.args&&f.args.map(e=>e.getName()),_(f.label()+".info = "+JSON.stringify(o)),f.isGetter()&&_(f.label()+".isGetter = true;"),f.isRoot&&_(`${f.label()}.continuations = [ ${k.join(",")} ]`),_(x(f.label()+"_mk",f.label(),r,Object.keys(n))),_(i),f.cachedJS=t;function x(e,t,r,n){let i="";i+=`
function ${e}(s) {
    checkStack(s.depth);
    return {
        parent: s, fn: ${t}, depth: s.depth + 1,
        pc: 0, retval: undefined, r0: undefined, overwrittenPC: false, lambdaArgs: null,
`;for(let e=0;e<r;++e)i+=`  tmp_${e}: undefined,
`;for(var s of n)i+=`  ${s}: undefined,
`;return i+=`} }
`}function E(e){return e.isGlobal()?"globals."+e.uniqueName():e.iscap?`s.caps[${e.index}]`:(e=e.uniqueName(),n[e]=!0,"s."+e)}function S(e){return(e=>{switch(e.exprKind){case b.NumberLiteral:case b.PointerLiteral:case b.SharedRef:case b.CellRef:return 1;default:return}})(e)?C(e):(w(e),"r0")}function C(e){switch(e.exprKind){case b.NumberLiteral:if(!0===e.data)return"true";if(!1===e.data)return"false";if(null===e.data)return"null";if(void 0===e.data)return"undefined";if("number"==typeof e.data)return e.data+"";if("string"==typeof e.data)return`"${e.data}"`;throw D.oops("invalid data: "+typeof e.data);case b.PointerLiteral:if(e.ptrlabel())return e.ptrlabel().lblId+"";if(null!=e.hexlit())return i+=`const ${e.data} = pxsim.BufferMethods.createBufferFromHex("${e.hexlit()}")
`,e.data;if("string"==typeof e.jsInfo)return e.jsInfo;D.U.oops();case b.SharedRef:var t=e.args[0],t=(D.U.assert(!!t.currUses),D.U.assert(t.currUses<t.totalUses),t.currUses++,v.indexOf(t));return D.U.assert(0<=t),"s.tmp_"+t;case b.CellRef:return E(e.data);default:throw D.oops()}}function w(a){switch(a.exprKind){case b.JmpValue:y("// jmp value (already in r0)");break;case b.Nop:y("// nop");break;case b.FieldAccess:var t=a.data,r=t.shimName,n=S(a.args[0]);return r?void y(`r0 = ${n}${r};`):void y(`r0 = ${n}.fields["${t.name}"];`);case b.Store:var i=a.args[0],s=a.args[1];switch(i.exprKind){case b.CellRef:var o=i.data,l=S(s);y(`${E(o)} = ${(e=>{switch(e){case 0:return"";case 1:return"pxtrt.toInt8";case 3:return"pxtrt.toInt16";case 5:return"pxtrt.toInt32";case 2:return"pxtrt.toUInt8";case 4:return"pxtrt.toUInt16";case 6:return"pxtrt.toUInt32";default:throw D.oops()}})(o.bitSize)}(${l});`);break;case b.FieldAccess:o=i.data;let e=o.shimName;e=e||`.fields["${o.name}"]`,w(D.ir.rtcall("="+e,[i.args[0],s]));break;default:D.oops()}return;case b.RuntimeCall:r=a;(n=D.ir.flattenArgs(r.args)).precomp.forEach(w);t=r.data,n=n.flattened.map(C);if("langsupp::ignore"!=t){let e="";e="."==t[0]?""+n[0]+t+`(${n.slice(1).join(", ")})`:"="==t[0]?`(${n[0]})${t.slice(1)} = (${n[1]})`:D.U.startsWith(t,"new ")?`new ${N(t.slice(4))}(${n.join(", ")})`:D.U.lookup(A,t)?2==n.length?`(${n[0]} ${D.U.lookup(A,t)} ${n[1]})`:`(${D.U.lookup(A,t)} ${n[0]})`:`${N(t)}(${n.join(", ")})`,0==r.callingConvention?y(`r0 = ${e};`):(c=++T,k.push(c),"String_::stringConv"==t&&y(`if ((${n[0]}) && (${n[0]}).vtable) {`),2==r.callingConvention?y(`(function(cb) { ${e}.then(cb) })(buildResume(s, ${c}));`):(y(`setupResume(s, ${c});`),y(e+";")),y("checkResumeConsumed();"),y("return;"),"String_::stringConv"==t&&y(`} else { s.retval = (${n[0]}) + ""; }`),_(`  case ${c}:`),y("r0 = s.retval;"))}return;case b.ProcCall:{var c=a;var u,d=c.data,p=d.proc;if(p&&p.inlineBody)return w(p.inlineSelf(c.args));let e=D.ir.rtcall("<frame>",[]),t=(e.totalUses=1,e.currUses=0,v.length),n=(v.push(e),"s.tmp_"+t),r=++T,i=-1==d.virtualIndex;if(p)y(n+` = ${p.label()}_mk(s);`);else{let t="generic",r=(null!=d.ifaceIndex?t="if_"+g.ifaceMembers[d.ifaceIndex]:i?t="lambda":null!=d.virtualIndex?t=d.classInfo.id+"_v"+d.virtualIndex:D.U.oops(),c.args.length);t+="_"+r+"_mk",g.recordHelper(f.usingCtx,t,()=>{var e=D.U.range(r).map(e=>"arg"+e);return x(t,"null",5,e)}),y(n+` = ${t}(s);`)}c.args.forEach((e,t)=>{let r="arg"+t;i&&(r=0==t?"argL":"arg"+(t-1)),y(n+`.${r} = ${S(e)};`)});let s=`s.pc = ${r}; return ${n};`;null!=d.callLocationIndex&&(s=`s.callLocIdx = ${d.callLocationIndex}; `+s),null!=d.ifaceIndex?(D.U.assert(null==p),h=g.ifaceMembers[d.ifaceIndex],D.U.assert(!!h,"no name for "+d.ifaceIndex),y(`if (!${n}.arg0.vtable.iface) {`),(u=c.args.map((e,t)=>n+".arg"+t)).splice(1,0,JSON.stringify(h)),m=`pxsim_pxtrt.map${d.isSet?"Set":"Get"}ByString`,d.noArgs?y(`  s.retval = ${m}(${u.join(", ")});`):(D.U.assert(!d.isSet),y(`  setupLambda(${n}, ${m}(${u.slice(0,2).join(", ")}), ${c.args.length});`),y("  "+s)),y("} else {"),y(`  ${n}.fn = ${n}.arg0.vtable.iface["${d.isSet?"set/":""}${h}"];`),m=n+`.arg0.fields["${h}"]`,d.isSet?(y(`  if (${n}.fn === null) { ${m} = ${n}.arg1; }`),y(`  else if (${n}.fn === undefined) { failedCast(${n}.arg0) } `)):d.noArgs?(y(`  if (${n}.fn == null) { s.retval = ${m}; }`),y(`  else if (!${n}.fn.isGetter) { s.retval = bind(${n}); }`)):(y(`  if (${n}.fn == null) { setupLambda(${n}, ${m}, ${c.args.length}); ${s} }`),y(`  else if (${n}.fn.isGetter) { ${n}.stage2Call = true; ${s}; }`)),y(` else { ${s} }`),y("}"),s=""):-1==d.virtualIndex?(D.U.assert(null==p),y(`setupLambda(${n}, ${n}.argL);`)):null!=d.virtualIndex?(D.U.assert(null==p),D.assert(0<=d.virtualIndex),I(d.classInfo,"validate",n+".arg0"),u=d.classInfo.vtable[d.virtualIndex],y(n+`.fn = ${n}.arg0.vtable.methods.${u.getName()};`)):D.U.assert(null!=p),s&&y(s),_(`  case ${r}:`),y("r0 = s.retval;"),e.currUses=1;return}case b.SharedDef:var h=a;if(h=h.args[0],D.U.assert(1<=h.totalUses),D.U.assert(0===h.currUses),(h.currUses=1)==h.totalUses)return w(h);{var m=v.length;v.push(h);let e=S(h);"r0"!=e&&(e="r0 = "+e),y(`s.tmp_${m} = ${e};`)}return;case b.Sequence:return a.args.forEach(w);case b.InstanceOf:return w(a.args[0]),void I(a.data,a.jsInfo);default:y(`r0 = ${C(a)};`)}}function l(e){return e.id+"_VT"}function c(e,t="r0"){return`checkSubtype(${t}, ${l(e)})`}function I(e,t,r="r0"){"bool"==t?y(`r0 = ${c(e)};`):"validate"==t?y(`if (!${c(e,r)}) failedCast(${r}, ${l(e)});`):D.U.oops()}function u(){for(var e of v)e.totalUses!==e.currUses&&D.oops();r=Math.max(v.length,r),v=[]}})(r,e),c+=t.length),n+="\n"+t+"\n"}),n+=D.U.values(r.codeHelpers).join("\n")+"\n",r.usedClassInfos.forEach(e=>{n+=(e=>{D.U.assert(void 0!==e.classNo),D.U.assert(void 0!==e.lastSubtypeNo);let t=parseInt(e.attrs.maxBgInstances),r=(t=t||null,`const ${e.id}_VT = mkVTable({
`+`  name: ${JSON.stringify(D.getName(e.decl))},
`+`  numFields: ${e.allfields.length},
`+`  classNo: ${e.classNo},
`+`  lastSubtypeNo: ${e.lastSubtypeNo},
`+`  maxBgInstances: ${t},
`+`  methods: {
`);for(var n of e.vtable)r+=`    "${n.getName()}": ${n.label()},
`;r+="  },\n  iface: {\n";for(var i of e.itable)r+=`    "${i.name}": ${i.proc?i.proc.label():"null"},
`,i.setProc?r+=`    "set/${i.name}": ${i.setProc.label()},
`:i.proc||(r+=`    "set/${i.name}": null,
`);return r+="  },\n",e.toStringMethod&&(r+="  toStringMethod: "+e.toStringMethod.label()+",\n"),r+="});\n"})(e)}),e.breakpoints&&(n+=`
const breakpoints = setupDebugger(${e.breakpoints.length}, [${r.globals.filter(e=>e.isUserVariable).map(e=>`"${e.uniqueName()}"`).join(",")}])
`),(n+=`
return ${r.procs[0]?r.procs[0].label():"null"}
})
`).length);o=e=>(100*e/u).toFixed(2)+"%",e=`// total=${n.length} new=${o(c)} cached=${o(l)} other=${o(u-c-l)}
`,r.writeFile(D.BINARY_JS,e+n)}}})(ts=ts||{}),(e=>{{var c=e.pxtc||(e.pxtc={});c.thumbCmpMap={"numops::lt":"_cmp_lt","numops::gt":"_cmp_gt","numops::le":"_cmp_le","numops::ge":"_cmp_ge","numops::eq":"_cmp_eq","numops::eqq":"_cmp_eqq","numops::neq":"_cmp_neq","numops::neqq":"_cmp_neqq"};let i={"numops::adds":"_numops_adds","numops::subs":"_numops_subs","numops::orrs":"_numops_orrs","numops::eors":"_numops_eors","numops::ands":"_numops_ands","numops::lsls":"_numops_lsls","numops::asrs":"_numops_asrs","numops::lsrs":"_numops_lsrs","pxt::toInt":"_numops_toInt","pxt::fromInt":"_numops_fromInt"};class t extends c.AssemblerSnippets{stackAligned(){return c.target.stackAlign&&1<c.target.stackAlign}pushLR(){return this.stackAligned()?"push {lr, r5}  ; r5 for align":"push {lr}"}popPC(){return this.stackAligned()?"pop {pc, r5}  ; r5 for align":"pop {pc}"}nop(){return"nop"}mov(e,t){return`mov ${e}, `+t}helper_ret(){return"bx r4"}reg_gets_imm(e,t){return`movs ${e}, #`+t}push_fixed(e){return"push {"+e.join(", ")+"}"}pop_fixed(e){return"pop {"+e.join(", ")+"}"}proc_setup(t,e){let r="";if(0<t){r+="    movs r0, #0\n";for(let e=0;e<t;++e)r+="    push {r0} ;loc\n"}return r}proc_return(){return"pop {pc}"}debugger_stmt(e){return c.oops(),`
    @stackempty locals
    ldr r0, [r6, #0] ; debugger
    subs r0, r0, #4  ; debugger
${e}:
    ldr r0, [r0, #0] ; debugger
`}debugger_bkpt(e){return c.oops(),`
    @stackempty locals
    ldr r0, [r6, #0] ; brk
${e}:
    ldr r0, [r0, #0] ; brk
`}debugger_proc(e){return c.oops(),`
    ldr r0, [r6, #0]  ; brk-entry
    ldr r0, [r0, #4]  ; brk-entry
${e}:`}push_local(e){return`push {${e}}`}push_locals(e){return`sub sp, #4*${e} ; push locals ${e} (align)`}pop_locals(e){return`add sp, #4*${e} ; pop locals `+e}unconditional_branch(e){return"bb "+e}beq(e){return"beq "+e}bne(e){return"bne "+e}cmp(e,t){return"cmp "+e+", "+t}cmp_zero(e){return"cmp "+e+", #0"}load_reg_src_off(e,t,r,n,i,s){r=r.replace(/:\d+$/,""),n&&(r="#4*"+r);let a="str",o="ldr";return s&&(32==s.immLimit?a="strb":64==s.immLimit&&(a="strh"),o=s.needsSignExt?a.replace("str","ldrs"):a.replace("str","ldr")),i?a+` ${e}, [${t}, ${r}]`:o+` ${e}, [${t}, ${r}]`}rt_call(e,t,r){return e+" "+t+", "+r}alignedCall(e,t){return t?this.push_locals(t)+`
bl ${e}
`+this.pop_locals(t):"bl "+e}call_lbl(e,t,r){var n=c.U.lookup(i,e);return n&&(e=n,t=!1),(t=!t&&0<e.indexOf("::")?!0:t)?this.callCPP(e,r):this.alignedCall(e,r)}call_reg(e){return"blx "+e}helper_prologue(){return`
    @stackmark args
    ${this.pushLR()}
`}helper_epilogue(){return`
    ${this.popPC()}
    @stackempty args
`}load_ptr_full(e,t){return c.assert(!!e),`
    ldlit ${t}, ${e}
`}load_vtable(e,t){return`ldr ${e}, [${t}, #0]`}lambda_init(){return`
    mov r5, r0
    mov r4, lr
    bl pxtrt::getGlobalsPtr
    mov r6, r0
    bx r4
`}saveThreadStack(){return"mov r7, sp\n    str r7, [r6, #4]\n"}restoreThreadStack(){return c.target.switches.gcDebug?"movs r7, #0\n    str r7, [r6, #4]\n":""}callCPPPush(e){return this.pushLR()+"\n"+this.callCPP(e)+"\n"+this.popPC()+"\n"}callCPP(e,t){return this.saveThreadStack()+this.alignedCall(e,t)+"\n"+this.restoreThreadStack()}inline_decr(e){return`
    lsls r1, r0, #30
    bne .tag${e}
    bl _pxt_decr
.tag${e}:
`}arithmetic(){let t="",r=e=>{var t=".boxed:\n";return t+=`
                    ${this.pushLR()}
                    push {r0, r1}
                    ${this.saveThreadStack()}
                    ${e}
                    ${this.restoreThreadStack()}
                    add sp, #8
                    ${this.popPC()}
                `};var e,n,i,s,a=e=>{t+=`
_numops_${e}:
    @scope _numops_${e}
    lsls r2, r0, #31
    beq .boxed
    lsls r2, r1, #31
    beq .boxed
`},o=e=>{t=(t+=`    blx lr
`)+r("bl numops::"+e)};for(e of["adds","subs"])a(e),t+=`
    subs r2, r1, #1
    ${e} r2, r0, r2
    bvs .boxed
    movs r0, r2
`,o(e);for(n of["ands","orrs","eors"])a(n),t+=`    ${n} r0, r1
`,"eors"==n&&(t+=`    adds r0, r0, #1
`),o(n);for(i of["lsls","lsrs","asrs"])a(i),t+=`
    ; r3 := (r1 >> 1) & 0x1f
    lsls r3, r1, #26
    lsrs r3, r3, #27
`,"asrs"==i?t+=`
    asrs r0, r3
    movs r2, #1
    orrs r0, r2
`:("lsrs"==i?t+=`
    asrs r2, r0, #1
    lsrs r2, r3
    lsrs r3, r2, #30
    bne .boxed
`:t+=`
    asrs r2, r0, #1
    lsls r2, r3
    lsrs r3, r2, #30
    beq .ok
    cmp r3, #3
    bne .boxed
.ok:
`,t+=`
    lsls r0, r2, #1
    adds r0, r0, #1
`),o(i);t+=`
@scope _numops_toInt
_numops_toInt:
    asrs r0, r0, #1
    bcc .over
    blx lr
.over:
    lsls r0, r0, #1
    ${this.callCPPPush("pxt::toInt")}

_numops_fromInt:
    lsls r2, r0, #1
    asrs r1, r2, #1
    cmp r0, r1
    bne .over2
    adds r0, r2, #1
    blx lr
.over2:
    ${this.callCPPPush("pxt::fromInt")}
`;for(s of Object.keys(c.thumbCmpMap))s=s.replace(/.*::/,""),t=(t+=`
.section code
.object _pxt_helper_cmp_${s}
_cmp_${s}:
    lsls r2, r0, #31
    beq .boxed
    lsls r2, r1, #31
    beq .boxed
    subs r0, r1
    b${s.replace("qq","q").replace("neq","ne")} .true
.false:
    movs r0, #0
    bx lr
.true:
    movs r0, #1
    bx lr
`)+r(`
                        bl numops::${s}
                        bl numops::toBoolDecr
                        cmp r0, #0`);return t}emit_int(e,r){let n=!1;function t(e){c.assert(0<=e&&e<=255);let t="";return n?e&&(t=`adds ${r}, #${e}
`):t=`movs ${r}, #${e}
`,n=!0,t}function i(e=8){return`lsls ${r}, ${r}, #${e}
`}c.assert(null!=e);let s=Math.floor(e),a=!1,o=(s<0&&(a=!0,s=-s),0);if(255<s){let e=s;for(;0==(1&e);)e>>>=1,o++;c.numBytes(e)<c.numBytes(s)?s=e:o=0}let l="";switch(c.numBytes(s)){case 4:l=(l+=t(s>>>24&255))+i();case 3:l=(l+=t(s>>>16&255))+i();case 2:l=(l+=t(s>>>8&255))+i();case 1:l+=t(255&s);break;default:c.oops()}return o&&(l+=i(o)),a&&(l+=`negs ${r}, ${r}
`),4<l.split("\n").length?`ldlit ${r}, ${Math.floor(e)}
`:l}}c.ThumbSnippets=t}})(ts=ts||{}),(E=>{var e;{var w=E.pxtc||(E.pxtc={});let S={"pxtrt::mapSetGeneric":"mapset","pxtrt::mapGetGeneric":"mapget"},C={};function I(e,t,r){for(var n=w.computeHashMultiplier(e.itable.map(e=>e.idx)),i=w.U.toArray(n.mapping);3&i.length;)i.push(0);let s=`
${D(e)}_start:
        .short ${8*e.allfields.length+8}  ; size in bytes
        .byte ${pxt.ValTypeObject}, ${pxt.VTABLE_MAGIC} ; magic
        .short ${i.length} ; entries in iface hashmap
        .short ${e.lastSubtypeNo||e.classNo} ; last sub class-id
        .short ${e.classNo} ; class-id
        .short 0 ; reserved
        .word ${n.mult} ; hash-mult
`;N()?s+=`
            .word pxt::RefRecord_destroy
            .word pxt::RefRecord_print
            .word pxt::RefRecord_scan
            .word pxt::RefRecord_gcsize
            .word 0,0,0,0 ; keep in sync with VM_NUM_CPP_METHODS
`:s+=`
            .word 0,0, 0,0, 0,0, 0,0 ; space for 4 (VM_NUM_CPP_METHODS) native methods
`,s+=`
        .balign 4
${e.id}_IfaceVT:
`;var a;let o=i.length>>2,l="",c=o,u={};for(a of e.itable){u[a.idx+""]=c;var d=a.proc?a.proc.isGetter()?1:2:0;l=(l+=`  .short ${a.idx}, ${d} ; ${a.name}
`)+`  .word ${a.proc?a.proc.vtLabel()+"@fn":a.info}
`,c+=1,a.setProc&&(l=(l+=`  .short ${a.idx}, 2 ; set ${a.name}
`)+`  .word ${a.setProc.vtLabel()}@fn
`,c+=1)}l+="  .word 0, 0, 0, 0 ; the end\n",c+=1;for(let e=0;e<i.length;++e)r.itEntries++,i[e]&&r.itFullEntries++;return s=(s+="  .short "+w.U.toArray(i).map((e,t)=>u[e+""]||o).join(", ")+"\n")+l+"\n"}let k;function A(e){e=e.getTime()/1e3;return`${e>>>0}, `+(e/4294967296|0)}(e=k=k||{})[e.Invalid=0]="Invalid",e[e.InfoHeader=1]="InfoHeader",e[e.OpCodeMap=2]="OpCodeMap",e[e.NumberLiterals=3]="NumberLiterals",e[e.ConfigData=4]="ConfigData",e[e.IfaceMemberNames=5]="IfaceMemberNames",e[e.NumberBoxes=6]="NumberBoxes",e[e.Function=32]="Function",e[e.Literal=33]="Literal",e[e.VTable=34]="VTable";let x={};function D(e){return e.classNo||(x[e.id]=e),e.id+"_VT"}function N(){return w.target.useESP}function O(e){return N()?"0xffffffff, "+e:"0xffffffff, 0xffffffff ; -> "+e}w.vmEmit=function(l,t,r){let a=`; VM start
_img_start:
${w.hexfile.hexPrelude()}
`,c=(x={},{dblText:[],dblBoxText:[],dbls:{},opcodeMap:{},opcodes:w.vm.opcodes.map(e=>"pxt::op_"+e.replace(/ .*/,""))});for(c.opcodes.unshift(null);c.opcodes.length<128;)c.opcodes.push(null);let o=0;function i(e,t,r,n,i=0){if(a+=`
; --- ${e}
.section code
    .set ${e} = ${o}
`,n)for(var s of n)a+=`    .set ${s} = ${o}
`;a=(a+=`
_start_${e}:
    .byte ${t}, 0x00
    .short ${i}
    .word _end_${e}-_start_${e}
`)+r()+`
.balign 8
_end_${e}:
`,o++}let e=new Date(0),n=w.U.toUTF8(t.name,!0),s=(n=100<n.length?n.slice(0,100):n).length+1,u=(1&s&&s++,128-s),d=(i("_info",k.InfoHeader,()=>`
                ; magic - \\0 added by assembler
                .string "\\nPXT64\\n"
                .hex 5471fe2b5e213768 ; magic
                .hex ${w.hexfile.hexTemplateHash()} ; hex template hash
                .hex 0000000000000000 ; @SRCHASH@
                .word ${l.globalsWords}   ; num. globals
                .word ${l.nonPtrGlobals} ; non-ptr globals
                .word 0, 0 ; last usage time
                .word ${A(e)} ; installation time
                .word ${A(e)} ; publication time - TODO
                .word _img_end-_img_start ; total image size
                .space 60 ; reserved
                .string ${JSON.stringify(n)}
                .space ${u} ; pad to 128 bytes
`),l.procs.forEach(n=>{i(n.label(),k.Function,()=>{{var y=c,b=l,a=n,e;let t="",i=e=>{t+=e+"\n"},p=e=>{t+="    "+e+"\n"},h=w.ir.EK,m=[],g=[],f=!1,s=0,_=0,o=8388607;pxt.options.debug&&pxt.log("EMIT",a.toString()),r(),t="";for(e of m)e.reset();return f=!0,w.U.assert(0==_),r(),t;function r(){i(`;
; ${a.getFullName()}
;`),p(".section code"),b.procs[0]==a&&i("; main"),p(".word "+O("pxt::RefAction_vtable")),p(`.short 0, ${a.args.length} ; #args`),p(`.short ${a.captured.length}, 0 ; #cap`),p(".word .fnstart-_img_start, 0  ; func+possible padding"),s=a.locals.length+g.length,p(".fnstart:"),p(`pushmany ${s} ; incl. ${g.length} tmps`);for(var e of a.body)switch(e.stmtKind){case w.ir.SK.Expr:k(e.expr);break;case w.ir.SK.StackEmpty:E();for(var t of g)t&&w.oops(`uses: ${t.currUses}/${t.totalUses} `+t.toString());break;case w.ir.SK.Jmp:r=e,n=void 0,n=r.lbl.lblName,r.jmpMode==w.ir.JmpMode.Always?(r.expr&&k(r.expr),p("jmp "+n)):(k(r.expr),r.jmpMode==w.ir.JmpMode.IfNotZero?p("jmpnz "+n):r.jmpMode==w.ir.JmpMode.IfZero?p("jmpz "+n):w.oops());break;case w.ir.SK.Label:i(e.lblName+":");break;case w.ir.SK.Comment:i("; "+e.expr.data);break;case w.ir.SK.Breakpoint:break;default:w.oops()}var r,n;p(`ret ${a.args.length}, `+s)}function v(e){var t;return e.isGlobal()?(w.U.assert(0==(3&e.index)),"glb "+(e.index>>2)+" ; "+e.getName()):e.iscap?"cap "+e.index+" ; "+e.getName():e.isarg?(t=a.args.length-e.index-1,w.assert(0<=t,"arg#"+t),`loc ${_+s+2+t} ; `+e.getName()):(t=e.index+g.length,w.assert(!f||t<s,"cell#"+t),w.assert(0<=t,"cell#"+t),"loc "+(_+t))}function T(n){switch(n.exprKind){case h.NumberLiteral:var i=w.taggedSpecial(n.data);if(null!=i)p(`ldspecial ${i} ; `+n.data);else{i=n.data;let e=0,t=0;var s=i<<1>>1!=i;if((0|i)==i){if(Math.abs(i)<=o)return void(i<0?p("ldintneg "+-i):p("ldint "+i));e=(i<<1|1)>>>0,t=i<0?1:0}else{var a=new Float64Array(1),a=(a[0]=i,new Uint32Array(a.buffer));a[1]+=65536,e=a[0],t=a[1]}a=e+","+t;let r=w.U.lookup(y.dbls,a);null==r&&(r=y.dblText.length,y.dblText.push(`.word ${e}, ${t}  ; ${r}: `+n.data),s&&(s="pxt::number_vt",y.dblBoxText.push(`.word ${N()?s:"0xffffffff ; "+s}
`),(s=new Float64Array(1))[0]=i,s=new Uint32Array(s.buffer),y.dblBoxText.push(`.word ${s[0]}, ${s[1]} ; ${i}
`)),y.dbls[a]=r),p(`ldnumber ${r} ; `+n.data)}return;case h.PointerLiteral:return void p("ldlit "+n.data);case h.SharedRef:s=n.args[0],i=((!s.currUses||s.currUses>=s.totalUses)&&(pxt.log(s.sharingInfo()),w.U.assert(!1)),s.currUses++,g.indexOf(s));return i<0&&(pxt.log(g,s),w.assert(!1)),p("ldloc "+(i+_)+(s.currUses==s.totalUses?" ; LAST":"")),void E();case h.CellRef:return void p("ld"+v(n.data));case h.InstanceOf:k(n.args[0]),a=n.data,"bool"==n.jsInfo?p("checkinst "+D(a)):w.U.oops();break;default:throw w.oops("kind: "+n.exprKind)}}function k(n){switch(n.exprKind){case h.JmpValue:p("; jmp value (already in r0)");break;case h.Nop:p("; nop");break;case h.FieldAccess:var e=n.data;k(n.args[0]),p(`ldfld ${e.idx}, `+D(e.classInfo));break;case h.Store:var t=n.args[0],r=n.args[1];switch(t.exprKind){case h.CellRef:k(r);var i=t.data,s="st"+v(i);i.isGlobal()&&0!=i.bitSize&&(i=w.sizeOfBitSize(i.bitSize)|(w.isBitSizeSigned(i.bitSize)?16:0),p("bitconv "+i)),p(s);break;case h.FieldAccess:i=t.data;k(t.args[0]),x(),k(r),p(`stfld ${i.idx}, `+D(i.classInfo)),_--;break;default:w.oops()}return;case h.RuntimeCall:var e=n,a=e.data;if("pxt::beginTry"==a)p("try "+e.args[0].data);else{a=w.U.lookup(C,a)||a,E();var o=w.U.lookup(S,a),l=e.args;let t=0;if("pxt::mkClassInstance"==a)p("newobj "+l[0].data);else{for(let e=0;e<l.length;++e)k(l[e]),e<l.length-1&&(x(),t++);"langsupp::ignore"==a?t&&p(`popmany ${t} ; ignore`):o?p(o):(e=>{var t=w.hexfile.lookupFunc(e),r=(t||w.U.oops("missing function: "+e),y.opcodeMap[t.name]);null==r&&(r=y.opcodes.length,y.opcodes.push(t.name),y.opcodeMap[t.name]=r,t.value=r),p("callrt "+e)})(a),_-=t}}return;case h.ProcCall:{o=n;var c,a=o.data,u=a.proc;if(u&&u.inlineBody)return d=u.inlineSelf(o.args),pxt.options.debug&&pxt.log("INLINE",o.toString(),"->",d.toString()),k(d);let e=0,t=o.args.slice(),r=-1==a.virtualIndex?t.shift():null;for(c of t)k(c),x(),e++;var d=t.length;r?(k(r),p("callind "+d)):null!=a.ifaceIndex?(o=a.ifaceIndex+" ; ."+b.ifaceMembers[a.ifaceIndex],a.isSet?(p("callset "+o),w.U.assert(2==d)):a.noArgs?(p("callget "+o),w.U.assert(1==d)):p(`calliface ${d}, `+o)):null!=a.virtualIndex?w.U.oops():p("callproc "+u.label()),_-=e;return}case h.SharedDef:u=n;if(u=u.args[0],w.U.assert(1<=u.totalUses),w.U.assert(0===u.currUses),u.currUses=1,m.push(u),1==u.totalUses)return k(u);{k(u);let t=-1;for(let e=0;e<g.length;++e)if(null==g[e]){t=e;break}t<0?(f&&(pxt.log(u,g),w.assert(!1,"missed tmp")),t=g.length,g.push(u)):g[t]=u,p("stloc "+(t+_))}return;case h.Sequence:return n.args.forEach(k);default:return T(n)}}function x(){p("push"),_++}function E(){for(let e=0;e<g.length;++e){var t=g[e];t&&t.currUses==t.totalUses&&(f||m.push(t),g[e]=null)}}}},[n.label()+"_Lit"])}),a=a+"_code_end:\n\n"+"_helpers_end:\n\n",l.usedClassInfos.forEach(e=>{i(D(e),k.VTable,()=>I(e,0,l))}),w.U.values(x).forEach(e=>{e.itable=[],e.classNo=65520,i(D(e),k.VTable,()=>I(e,0,l))}),x={},0),p=(i("ifaceMemberNames",k.IfaceMemberNames,()=>`    .word ${l.ifaceMembers.length} ; num. entries
`+l.ifaceMembers.map(e=>`    .word ${l.emitString(e)}  ; ${d++} .`+e).join("\n")),a+="_vtables_end:\n\n",w.U.iterMap(l.hexlits,(e,t)=>{i(t,k.Literal,()=>`.word ${O("pxt::buffer_vt")}
`+w.hexLiteralAsm(e),[],pxt.BuiltInType.BoxedBuffer)}),w.U.unique(l.ifaceMembers.concat(Object.keys(l.strings)),e=>e).forEach(e=>{var t=w.utf8AsmStringLiteral(e);let r=pxt.BuiltInType.BoxedString,n=("pxt::string_inline_ascii_vt"==t.vt?r=pxt.BuiltInType.BoxedString_ASCII:"pxt::string_skiplist16_packed_vt"==t.vt?r=pxt.BuiltInType.BoxedString_SkipList:"pxt::string_inline_utf8_vt"==t.vt?r=pxt.BuiltInType.BoxedString:w.oops("invalid vt"),`.word ${O(t.vt)}
`+t.asm);i(l.strings[e],k.Literal,()=>n,[],r)}),i("numberBoxes",k.NumberBoxes,()=>c.dblBoxText.join("\n")+"\n.word 0, 0, 0 ; dummy entry to make sure not empty"),i("numberLiterals",k.NumberLiterals,()=>c.dblText.join("\n")+"\n.word 0, 0 ; dummy entry to make sure not empty"),r.configData||[]),h=(i("configData",k.ConfigData,()=>p.map(e=>`    .word ${e.key}, ${e.value}  ; ${e.name}=`+e.value).join("\n")+"\n    .word 0, 0"),c.opcodes.map(e=>null==e?"":e).join("\0")+"\0"),m="";for(;h;){let e=h.slice(0,64);h=h.slice(64),1&e.length&&(e+="\0"),m+=".hex "+w.U.toHex(w.U.stringToUint8Array(e))+"\n"}i("opcodeMap",k.OpCodeMap,()=>m),a=(a+="_literals_end:\n")+"_img_end:\n\n; The end.\n",l.writeFile(w.BINARY_ASM,a);var g=w.assemble(t.target,l,a,r),f=(e=>{let i=[83,82,67,77,136,21,78,45,170,134,153,113,0,0,0,0];for(var n of Object.keys(e)){for(var s of w.U.stringToUint8Array(n))i.push(s);i.push(0);var a=e[n];let t=0,r=0;for(let e=0;e<a.length;e+=3)o(a[e]-t),o(a[e+1]-r>>1),o(a[e+2]>>1),t=a[e],r=a[e+1];i.push(255)}i.push(0),1&i.length&&i.push(0);var t=[];for(let e=0;e<i.length;e+=2)t.push(i[e]|i[e+1]<<8);return t;function o(r){if(0<=r&&r<240)i.push(r);else{let e=240;r<0&&(r=-r,e|=8);var n=i.length;i.push(null);let t=0;for(;0!=r;)i.push(255&r),r>>>=8,t++;i[n]=e|t}}})(r=g.thumbFile.getSourceMap());g.src&&l.writeFile(w.BINARY_ASM,`; srcmap size: ${f.length<<1} bytes
`+g.src);{let e="";for(var _ of g.buf)e+=String.fromCharCode(255&_,_>>8);var y=w.U.sha256(e);for(let e=0;e<4;++e)g.buf[16+e]=parseInt(y.slice(4*e,4*e+4),16);r.__meta={name:t.name,programHash:g.buf[16]|g.buf[17]<<16}}if(l.writeFile(w.BINARY_SRCMAP,JSON.stringify(r)),pxt.options.debug){let r=g.thumbFile.peepCounts;var b,t=Object.keys(r);t.sort((e,t)=>r[t]-r[e]);for(b of t.slice(0,50))pxt.log(b+"  "+r[b])}if(g.buf){let e="";for(var v,T=g.buf;15&T.length;)T.push(0);w.U.pushRange(T,f);for(v of T)e+=String.fromCharCode(255&v,v>>8);e=E.pxtc.encodeBase64(e),N()?(l.writeFile(w.BINARY_PXT64,e),r=w.hexfile.patchHex(l,T,!1,!!w.target.useUF2)[0],l.writeFile(pxt.outputName(w.target),E.pxtc.encodeBase64(r))):l.writeFile(pxt.outputName(w.target),e)}}}})(ts=ts||{}),(xe=>{var e,Ee=xe.pxtc||(xe.pxtc={});{var Se=Ee.decompiler||(Ee.decompiler={});let pe;(e=pe=Se.DecompileParamKeys||(Se.DecompileParamKeys={})).DecompileLiterals="decompileLiterals",e.TaggedTemplate="taggedTemplate",e.DecompileIndirectFixedInstances="decompileIndirectFixedInstances",e.DecompileArgumentAsString="decompileArgumentAsString";let he,me=((e=he=Se.CommentKind||(Se.CommentKind={}))[e.SingleLine=0]="SingleLine",e[e.MultiLine=1]="MultiLine",Se.DECOMPILER_ERROR=9267,xe.SyntaxKind),o=97,l=122,c=/^[^\f\n\r\t\v\u00a0\u1680\u180e\u2000-\u200a\u2028\u2029\u202f\u205f\u3000\ufeff]*$/,r=/^(?:Array<(.+)>)|(?:(.+)\[\])$/,ge="math_number",fe="math_number_minmax",_e="math_integer",ye="math_whole_number",be="text",ve="logic_boolean",Te={"+":{type:"math_arithmetic",op:"ADD"},"-":{type:"math_arithmetic",op:"MINUS"},"/":{type:"math_arithmetic",op:"DIVIDE"},"*":{type:"math_arithmetic",op:"MULTIPLY"},"**":{type:"math_arithmetic",op:"POWER"},"%":{type:"math_modulo",leftName:"DIVIDEND",rightName:"DIVISOR"},"<":{type:"logic_compare",op:"LT"},"<=":{type:"logic_compare",op:"LTE"},">":{type:"logic_compare",op:"GT"},">=":{type:"logic_compare",op:"GTE"},"==":{type:"logic_compare",op:"EQ"},"===":{type:"logic_compare",op:"EQ"},"!=":{type:"logic_compare",op:"NEQ"},"!==":{type:"logic_compare",op:"NEQ"},"&&":{type:"logic_operation",op:"AND"},"||":{type:"logic_operation",op:"OR"}},u=/^\s*\/\/\s*(.*)$/,d=/^\s*(?:(?:(?:\/\*\*?)|(?:\*))(?!\/))?\s*(.*?)(?:\*?\*\/)?$/;class t{constructor(e){this.renames=e,this.renames.sort((e,t)=>e.span.start-t.span.start)}getRenamesInSpan(e,t){var r,n=[];for(r of this.renames){if(r.span.start>t)break;r.span.start>=e&&n.push(r)}return n}getRenameForPosition(e){for(var t of this.renames){if(t.span.start>e)return;if(t.span.start===e)return t}}}function p(t,r,n=!0){if(1===t.length&&"x"!==t&&"y"!==t&&"z"!==t){var e=t.charCodeAt(0);if(e>=o&&e<=l){var i=e-o;for(let e=1;e<26;e++){var s=String.fromCharCode(o+(i+e)%26);if("x"!==s&&"y"!==s&&"z"!==s&&!r[s])return n&&(r[s]=!0),s}}}for(let e=2;;e++){var a=t+e;if(!r[a])return n&&(r[a]=!0),a}}Se.RenameMap=t,Se.buildRenameMap=function(e,i,{declarations:r,takenNames:s}={declarations:"variables",takenNames:{}}){let a=xe.createLanguageService(new Ee.LSHost(e)),o=[];return function t(e){xe.forEachChild(e,e=>{if(xe.isDeclarationName(e)&&("all"===r||xe.isVariableDeclaration(e.parent))){let r=e.getText();if(s[r]){let t=p(r,s);var n=a.findRenameLocations(i.fileName,e.pos+1,!1,!1);n&&n.forEach(e=>{o.push({name:t,diff:t.length-r.length,span:e.textSpan})})}else s[r]=!0}t(e)})}(i),e=s,[new t(o),e]},Se.getNewName=p;let ke;function Ce(r,i,t=!1,s=!1){switch(r.kind){case me.WhileStatement:case me.IfStatement:case me.Block:return;case me.ExpressionStatement:return Ce(r.expression,i,t,s);case me.VariableStatement:var e,n=i;for(e of r.declarationList.declarations){e=k(e,n);if(e)return e}return;case me.CallExpression:{var[a,c,o=!1,u=!1]=[r,i,t,s];let n=Ee.pxtInfo(a).callInfo;if(!n)return Ee.Util.lf("Function call not supported in the blocks");let l=c.attrs(n),e;if(xe.isIdentifier(a.expression)&&(e=c.declaredFunctions[a.expression.text]),o){if(l.forceStatement||l.handlerStatement)return Ee.Util.lf("Function with forceStatement cannot be used as an expression.")}else if(Ve(a,c)&&!e)if(c.aliasBlocks[n.qName])n.decompilerBlockAlias=c.aliasBlocks[n.qName];else if(!c.opts.snippetMode)return Ee.Util.lf("No output expressions as statements");if("Math.pow"!=n.qName){if(pxt.Util.startsWith(n.qName,"Math."))if(He(n.qName.substring(5)))return;if(l.blockId===Ee.PAUSE_UNTIL_TYPE)return o=a.arguments[0],1===a.arguments.length&&(e=>{if(e.kind===me.FunctionExpression||e.kind===me.ArrowFunction){if(Ve(e.body,c))return 1;e=e.body;if(1===e.statements.length)if(Re(e.statements[0]).kind===me.ReturnStatement)return 1}})(o)?void 0:Ee.Util.lf("Predicates must be inline expressions that return a value");o=Me(n,l);if(o&&!l.handlerStatement&&!l.forceStatement&&!u)return Ee.Util.lf("Events must be top level");if(!l.blockId||!l.block){u=pxt.blocks.builtinFunctionInfo[n.qName];if(!u)return e?e.parameters.length!==n.args.length?Ee.Util.lf("Function calls in blocks must have the same number of arguments as the function definition"):void 0:Ee.Util.lf("Call statements must have a valid declared function");l.blockId=u.blockId}var u=$e(n,c),d=c.blocks.apis.byQName[n.qName],p=c.compInfo(n),h=p.parameters.length+(p.thisParameter?1:0);if(l.imageLiteral||l.gridLiteral){if(1<n.args.length-h)return Ee.Util.lf("Function call has more arguments than are supported by its block");a=a.arguments[0];if(a.kind!=me.StringLiteral&&a.kind!=me.NoSubstitutionTemplateLiteral)return Ee.Util.lf("Only string literals supported for image literals");var a=(a.text||"").replace(/\s+/g,""),m=l.imageLiteralRows||5,g=(l.imageLiteralColumns||5)*(l.imageLiteral||l.gridLiteral);if(g*m!=a.length)return Ee.Util.lf("Invalid image pattern ({0} expected vs {1} actual)",g*m,a.length)}else{let r=n.args.length-h;if(0<r&&!(()=>{if(l.mutatePropertyEnum&&2==r&&2<=n.args.length){var e=n.args[n.args.length-2],t=n.args[n.args.length-1];if(e.kind===me.ArrayLiteralExpression&&Be(t)){let r=[];if(!e.elements.some(e=>e.kind!==me.PropertyAccessExpression||e.expression.kind!==me.Identifier||(r.push(e.name.text),e.expression.text!==l.mutatePropertyEnum))){e=De(t);if(e){let t=e[0];return t.length===r.length&&!r.some(e=>-1===t.indexOf(e))}}}}})()){let e=r;if(o&&e--,l.defaultInstance&&e--,0<e)return Ee.Util.lf("Function call has more arguments than are supported by its block")}if(p.parameters.length||o){let r,n=l.defaultInstance||!!p.thisParameter;if(u.forEach((e,t)=>{r||n&&0===t||(n&&t--,r=(t=>{let r=Re(t.value),n=t.info,i=t.param;if(n.isEnum){if(o(r))return;if(r.kind===me.CallExpression){var s=Ee.pxtInfo(r).callInfo;let e=c.attrs(s);if(s&&"TD_ID"===e.shim&&s.args&&1===s.args.length){let e=Re(s.args[0]);if(o(e))return}}else if(r.kind===me.Identifier){let e=Ee.pxtInfo(r).commentAttrs;if(e&&e.enumIdentity)return}return Ee.Util.lf("Enum arguments may only be literal property access expressions")}if(Fe(r)&&(i.fieldEditor||i.shadowBlockId)){let e=!(!i.fieldOptions||!i.fieldOptions[pe.DecompileLiterals]);if(!e&&i.shadowBlockId&&(t=c.blocks.blocksById[i.shadowBlockId],e=!(t&&t.parameters&&t.parameters.length&&(s=t.parameters[0].name,t.attributes.paramFieldEditorOptions)&&t.attributes.paramFieldEditorOptions[s]&&!t.attributes.paramFieldEditorOptions[s][pe.DecompileLiterals])),!e)return Ee.Util.lf("Field editor does not support literal arguments")}else if(r.kind===me.TaggedTemplateExpression&&i.fieldEditor){t=i.fieldOptions&&i.fieldOptions[pe.TaggedTemplate];if(!t)return Ee.Util.lf("Tagged templates only supported in custom fields with param.fieldOptions.taggedTemplate set");var a=Re(r.tag).getText(),t=t.split(";").map(e=>e.trim());if(-1===t.indexOf(a))return Ee.Util.lf("Function only supports template literals with tag '{0}'",t.join(", "));if(r.template.kind!==me.NoSubstitutionTemplateLiteral)return Ee.Util.lf("Tagged template literals cannot have substitutions")}else if(r.kind===me.ArrowFunction){a=r;if(a.parameters.length)if("objectdestructuring"===l.mutate){let e=Re(a.parameters[0]);if(e.kind===me.Parameter&&e.name.kind!==me.ObjectBindingPattern)return Ee.Util.lf("Object destructuring mutation callbacks can only have destructuring patters as arguments")}else for(let e of a.parameters)if(e.name.kind!==me.Identifier)return Ee.Util.lf("Only identifiers allowed as function arguments")}else if(c.blocks.apis.byQName[n.type])if(c.blocks.apis.byQName[n.type].attributes.fixedInstances){if(x(i))return;if(i.shadowBlockId){t=c.blocks.blocksById[i.shadowBlockId];if(t){t=pxt.blocks.compileInfo(t);if(t.parameters&&x(t.parameters[0]))return}}t=Ee.pxtInfo(r).callInfo;return t&&c.attrs(t).fixedInstance?void 0:Ee.Util.lf("Arguments of a fixed instance type must be a reference to a fixed instance declaration")}function o(e){for(var t=n.type.split("."),r=[];e.kind===me.PropertyAccessExpression;)r.unshift(e.name.text),e=e.expression;if(e.kind===me.Identifier){r.unshift(e.text);for(let e=0;e<t.length;e++)if(t[e]!==r[e])return;return 1}}})(e))}),r)return r}if(d){g=c.blocks.apis.byQName[d.namespace];if(g&&g.attributes.fixedInstances&&!g.attributes.decompileIndirectFixedInstances&&n.args.length){m=Ee.pxtInfo(n.args[0]).callInfo;if(!m||!c.attrs(m).fixedInstance)return Ee.Util.lf("Fixed instance APIs can only be called directly from the fixed instance")}}}}return}case me.VariableDeclaration:return k(r,i);case me.PostfixUnaryExpression:case me.PrefixUnaryExpression:a=r;return a.operand.kind!=me.Identifier?Ee.Util.lf("-- and ++ may only be used on an identifier"):a.operator!==me.PlusPlusToken&&a.operator!==me.MinusMinusToken?Ee.Util.lf("Only ++ and -- supported as prefix or postfix unary operators in a statement"):void 0;case me.FunctionExpression:case me.ArrowFunction:{h=r;o=i;let e=!1;if(h.parameters.length&&(p=Oe(h)[0])&&Ee.pxtInfo(p).callInfo&&(p=Ee.pxtInfo(p).callInfo,e="objectdestructuring"===o.attrs(p).mutate?h.parameters[0].name.kind!==me.ObjectBindingPattern:h.parameters.some(e=>e.name.kind!==me.Identifier)),e)return Ee.Util.lf("Unsupported parameters in error function");return}case me.BinaryExpression:var l=r,f=i;if(l.left.kind===me.ElementAccessExpression){if(l.operatorToken.kind!==me.EqualsToken)return Ee.Util.lf("Element access expressions may only be assigned to using the equals operator")}else{if(l.left.kind===me.PropertyAccessExpression)return l.operatorToken.kind!==me.EqualsToken&&l.operatorToken.kind!==me.PlusEqualsToken?Ee.Util.lf("Property access expressions may only be assigned to using the = and += operators"):Ne(l.left,f);if(l.left.kind!==me.Identifier)return Ee.Util.lf("This expression cannot be assigned to");switch(l.operatorToken.kind){case me.EqualsToken:return Ne(l.right,f);case me.PlusEqualsToken:case me.MinusEqualsToken:return;default:return Ee.Util.lf("Unsupported operator token in statement {0}",me[l.operatorToken.kind])}}return;case me.ForStatement:var _=r;return _.initializer&&_.incrementor&&_.condition?_.initializer.kind!==me.VariableDeclarationList?Ee.Util.lf("only variable declarations are permitted in for loop initializers"):(u=_.initializer).declarations?1!=u.declarations.length?Ee.Util.lf("for loop with multiple variables not supported"):(u=u.declarations[0]).initializer.kind!==me.NumericLiteral||"0"!==u.initializer.text?Ee.Util.lf("for loop initializers must be initialized to 0"):(e=>{if(_.incrementor.kind===me.PostfixUnaryExpression||_.incrementor.kind===me.PrefixUnaryExpression){var t=_.incrementor;if(t.operator===me.PlusPlusToken&&t.operand.kind===me.Identifier)return t.operand.text===e}})(u=u.name.text)?_.condition.kind!==me.BinaryExpression?Ee.Util.lf("for loop conditionals must be binary comparison operations"):(d=_.condition).left.kind!==me.Identifier||d.left.text!==u?Ee.Util.lf("left side of for loop conditional must be the variable declared in the initializer"):d.operatorToken.kind!==me.LessThanToken&&d.operatorToken.kind!==me.LessThanEqualsToken?Ee.Util.lf("for loop conditional operator must be either < or <="):void 0:Ee.Util.lf("for loop incrementors may only increment the variable declared in the initializer"):Ee.Util.lf("for loop with out-of-scope variables not supported"):Ee.Util.lf("for loops must have an initializer, incrementor, and condition");case me.ForOfStatement:return r.initializer.kind!==me.VariableDeclarationList?Ee.Util.lf("only variable declarations are permitted in for of loop initializers"):void 0;case me.FunctionDeclaration:var y=r;if(!s)return Ee.Util.lf("Function declarations must be top level");if(0<y.parameters.length&&i.opts.allowedArgumentTypes)for(var b of y.parameters){if(b.initializer||b.questionToken)return Ee.Util.lf("Function parameters cannot be optional");b=b.type?b.type.getText():void 0;if(!b)return Ee.Util.lf("Function parameters must declare a type");b=ze(b);if(-1===i.opts.allowedArgumentTypes.indexOf(b)&&!Ee.U.endsWith(b,"[]"))return Ee.Util.lf("Only types that can be added in blocks can be used for function arguments")}return;case me.EnumDeclaration:{y=r;var v=s;if(!v)return Ee.Util.lf("Enum declarations must be top level");if(v=y.name.text,!(v=i.blocks.enumsByName[v]))return Ee.Util.lf("Enum declarations in user code must have a block");let t=!1;return y.members.forEach(e=>{if(!(t=e.name.kind!==me.Identifier||t)&&e.initializer&&e.initializer.kind!==me.NumericLiteral){if(e.initializer.kind===me.BinaryExpression){e=e.initializer;if(e.operatorToken.kind===me.LessThanLessThanToken&&e.left.kind===me.NumericLiteral&&e.right.kind===me.NumericLiteral&&"1"==e.left.text)return}t=!0}}),t?Ee.Util.lf("Invalid initializer for enum member"):void 0;return}case me.ModuleDeclaration:var v=r,T=we(v,i);return T&&(v=Ie(v))?T:void 0;case me.ReturnStatement:return function e(t){let r=xe.getEnclosingBlockScopeContainer(t);if(r)switch(r.kind){case me.SourceFile:case me.ArrowFunction:case me.FunctionExpression:return!1;case me.FunctionDeclaration:return r.parent&&r.parent.kind===me.SourceFile&&!Ce(r,i,!1,!0);default:return e(r)}return!1}(r)?void 0:Ee.Util.lf("Return statements can only be used within top-level function declarations");case me.BreakStatement:case me.ContinueStatement:case me.DebuggerStatement:case me.EmptyStatement:return}return Ee.Util.lf("Unsupported statement in block: {0}",me[r.kind]);function k(e,t){let r;return e.name.kind!==me.Identifier?r=Ee.Util.lf("Variable declarations may not use binding patterns"):e.initializer?Ae(e)||(r=Ne(e.initializer,t)):r=Ee.Util.lf("Variable declarations must have an initializer"),r}}function we(e,t){if(!xe.isModuleBlock(e.body))return Ee.Util.lf("Namespaces cannot be nested.");var r=t.blocks.kindsByName[e.name.text];if(!r)return Ee.Util.lf("Only namespaces with 'kind' blocks can be decompiled");var n,i=Ee.Util.lf("Namespaces may only contain valid 'kind' exports");for(n of e.body.statements){if((e=>(e=xe.getLeadingCommentRangesOfNode(e,e.getSourceFile()))&&e.length)(n))return i;if(!xe.isVariableStatement(n)||!n.declarationList.declarations)return i;var s=1===n.declarationList.declarations.length,a=n.modifiers&&1===n.modifiers.length&&n.modifiers[0].kind===me.ExportKeyword,o=n.declarationList.flags&xe.NodeFlags.Const;if(!(s&&a&&o))return i;s=n.declarationList.declarations[0];if(!s.initializer||!xe.isCallExpression(s.initializer)||!xe.isIdentifier(s.name))return i;a=s.initializer;if(a.arguments.length)return i;if(xe.isPropertyAccessExpression(a.expression)&&xe.isIdentifier(a.expression.expression)){if(a.expression.expression.text!==r.name||a.expression.name.text!==r.createFunctionName)return i}else{if(!xe.isIdentifier(a.expression))return i;if(a.expression.text!==r.createFunctionName)return i}}}function Ie(e){if(!xe.isModuleBlock(e.body))return Ee.Util.lf("Namespaces cannot be nested.");if(e.name.text!==pxt.sprite.TILE_NAMESPACE)return Ee.Util.lf("Tileset namespace must be named myTiles");var r=Ee.Util.lf("The myTiles namespace can only export tile variables with image literal initializers and no duplicate ids"),n=Ee.Util.lf("Tileset members must have a blockIdentity comment and no other annotations"),i=new RegExp(pxt.sprite.TILE_PREFIX+"(\\d+)"),s=[],a=/^\s*\/\/%\s*blockIdentity=[^\s]+\s*$/;for(let t of e.body.statements){var o=xe.getLeadingCommentRangesOfNode(t,t.getSourceFile());if(!o||!o.length)return n;o=o.map(e=>t.getSourceFile().text.substr(e.pos,e.end-e.pos)).filter(e=>!!e);if(1!==o.length||!a.test(o[0]))return n;if(!xe.isVariableStatement(t)||!t.declarationList.declarations)return r;var o=1===t.declarationList.declarations.length,l=t.modifiers&&1===t.modifiers.length&&t.modifiers[0].kind===me.ExportKeyword,c=t.declarationList.flags&xe.NodeFlags.Const;if(!(o&&l&&c))return r;o=t.declarationList.declarations[0];if(!o.initializer||!xe.isTaggedTemplateExpression(o.initializer)||!xe.isIdentifier(o.name))return r;l=o.initializer;if(!xe.isIdentifier(l.tag)||"img"!==l.tag.text)return r;c=i.exec(o.name.text);if(!c||-1!==s.indexOf(c[1]))return r;s.push(c[1])}}function Ae(e){if(e.initializer){if(e.initializer.kind===xe.SyntaxKind.NullKeyword||e.initializer.kind===xe.SyntaxKind.FalseKeyword||(t=e.initializer).kind===me.ArrayLiteralExpression&&0===t.elements.length)return 1;if(xe.isStringOrNumericLiteral(e.initializer))return"0"===(t=e.initializer.getText())||Le(t);e=Ee.pxtInfo(e.initializer).callInfo;if(e&&e.isAutoCreate)return 1}var t}function De(e){if(1===e.parameters.length&&e.parameters[0].name.kind===me.ObjectBindingPattern){e=e.parameters[0].name.elements;let r={};return[e.map(e=>{var t;return n(e.propertyName)&&n(e.name)?(t=e.name.text,e.propertyName?(e=e.propertyName.text,r[e]=t,e):t):""}),r]}function n(e){return!e||e.kind===me.Identifier}}function Ne(e,t){switch(e.kind){case me.NumericLiteral:case me.TrueKeyword:case me.FalseKeyword:case me.ExpressionStatement:case me.ArrayLiteralExpression:case me.ElementAccessExpression:return;case me.ParenthesizedExpression:return Ne(e.expression,t);case me.StringLiteral:case me.FirstTemplateToken:case me.NoSubstitutionTemplateLiteral:var r=e;return r=e.text,c.test(r)?void 0:Ee.Util.lf("Only whitespace character allowed in string literals is space");case me.Identifier:r=Ee.pxtInfo(e);return(l=e)&&l.kind===me.Identifier&&"undefined"===l.text?Ee.Util.lf("Undefined is not supported in blocks"):!Pe(e)||r.commentAttrs&&r.commentAttrs.blockIdentity&&r.commentAttrs.enumIdentity&&t.blocks.apis.byQName[r.commentAttrs.blockIdentity]?void 0:Ee.Util.lf("Variable is declared in another file");case me.BinaryExpression:l=e.operatorToken.getText();return Te[l]?void 0:Ee.Util.lf("Could not find operator {0}",l);case me.PrefixUnaryExpression:var n=e.operator;return n===me.MinusToken||n===me.PlusToken||n===me.ExclamationToken?void 0:Ee.Util.lf("Unsupported prefix unary operator{0}",n);case me.PropertyAccessExpression:var n=e,a=t,o=Ee.pxtInfo(n).callInfo;if(o){var i=a.attrs(o),s=a.compInfo(o);if(i.blockIdentity&&a.blocks.apis.byQName[i.blockIdentity]||"lists_length"===i.blockId||"text_length"===i.blockId)return;if(o.decl.kind===me.EnumMember){if(n.expression.kind===me.Identifier){o=n.expression.text;if(a.declaredEnums[o])return}let[e,i]=Oe(n),s=!0;if(e){o=Ee.pxtInfo(e).callInfo;if(o&&o.args){let r=a.blocks.apis.byQName[o.qName],n=1==r.kind||2==r.kind;r&&o.args.forEach((e,t)=>{e===i&&r.parameters[n?t-1:t].isEnum&&(s=!1)})}}return s?Ee.Util.lf("Enum value without a corresponding block"):void 0}if(i.fixedInstance&&n.parent){if(n.parent.parent&&n.parent.kind===me.PropertyAccessExpression&&n.parent.parent.kind===me.CallExpression){if(n.parent.parent.expression===n.parent)return}else if(n.parent.kind===me.CallExpression&&n.parent.expression!==n)return}else{if(i.blockCombine||i.blockId&&s&&s.thisParameter)return Ne(n.expression,a);if(xe.isIdentifier(n.expression)&&a.declaredKinds[n.expression.text]){o=n.name.text,i=a.declaredKinds[n.expression.text];if(i&&(-1!==i.kindInfo.initialMembers.indexOf(o)||-1!==i.declaredNames.indexOf(o)))return}}}return Ee.Util.lf("No call info found");case me.CallExpression:return Ce(e,t,!0,void 0);case me.TaggedTemplateExpression:s=e,a=t;return(s=Ee.pxtInfo(s).callInfo)?(s=a.attrs(s)).blockIdentity&&a.blocks.apis.byQName[s.blockIdentity]?(a=a.blocks.apis.byQName[s.blockIdentity])?1!==(s=pxt.blocks.compileInfo(a)).parameters.length?Ee.Util.lf("Tagged template functions must have 1 argument"):void 0:Ee.Util.lf("Could not find blockIdentity for tagged template"):Ee.Util.lf("Tagged template does not have blockIdentity set"):Ee.Util.lf("Invalid tagged template");case me.AsExpression:if("any"===(i=e).type.getText().trim()&&(xe.isStringOrNumericLiteral(i.expression)||i.expression.kind===me.TrueKeyword||i.expression.kind===me.FalseKeyword)){var[i]=Oe(i);if(i.kind===me.BinaryExpression)switch(i.operatorToken.kind){case me.EqualsEqualsToken:case me.EqualsEqualsEqualsToken:case me.ExclamationEqualsToken:case me.ExclamationEqualsEqualsToken:case me.LessThanToken:case me.LessThanEqualsToken:case me.GreaterThanToken:case me.GreaterThanEqualsToken:return}}return Ee.Util.lf("Casting not supported in blocks")}var l;return Ee.Util.lf("Unsupported syntax kind for output expression block: {0}",me[e.kind])}function Oe(e){return e.parent?e.parent.kind===me.ParenthesizedExpression?Oe(e.parent):[e.parent,e]:[void 0,e]}function Re(e){for(;e.kind===me.ParenthesizedExpression;)e=e.expression;return e}function Le(e){return'""'===e||"''"===e||"``"===e}function Pe(e){return 4&Ee.pxtInfo(e).flags}function Me(e,t){return t.blockId!==Ee.PAUSE_UNTIL_TYPE&&(e.decl.parameters,e.args.some((e,t)=>e&&Be(e)))}function Fe(e){if(!e)return!1;switch(e.kind){case me.ParenthesizedExpression:return Fe(e.expression);case me.ArrayLiteralExpression:var t;for(t of e.elements)if(!Fe(t)&&t.kind!==me.TaggedTemplateExpression)return!1;return!0;case me.NumericLiteral:case me.StringLiteral:case me.NoSubstitutionTemplateLiteral:case me.TrueKeyword:case me.FalseKeyword:return!0;case me.PrefixUnaryExpression:var r=e;return(r.operator===me.PlusToken||r.operator===me.MinusToken)&&Fe(r.operand);default:return!1}}function Be(e){return e.kind===me.ArrowFunction||e.kind===me.FunctionExpression}function $e(r,e){var n=[],i=e.blocks.apis.byQName[r.qName];if(i){var s=e.blocks.apis.byQName[r.qName].attributes,a=e.compInfo(r);let t=s.imageLiteral?1:0;a.thisParameter?n.push({value:Re(r.args[0]),info:null,param:a.thisParameter}):s.defaultInstance&&n.push({value:Re(r.args[0]),info:i.parameters[0],param:{definitionName:"__instance__",actualName:"this"}});var o=!(!a.thisParameter&&!s.defaultInstance);o&&t++;for(let e=t;e<r.args.length;e++)n.push({value:Re(r.args[e]),info:i.parameters[o?e-1:e],param:a.parameters[e-t]})}return n}function Ue(e){return e.body.statements.map(e=>{e=e.declarationList.declarations[0];return{name:e.name.text,initializer:e.initializer.getText()}})}function Ve(e,t){switch(e.kind){case me.BinaryExpression:var r=e.operatorToken.kind;return r!=me.PlusEqualsToken&&r!=me.MinusEqualsToken&&r!=me.EqualsToken;case me.PrefixUnaryExpression:r=e.operator;return r!=me.PlusPlusToken&&r!=me.MinusMinusToken;case me.PostfixUnaryExpression:r=e.operator;return r!=me.PlusPlusToken&&r!=me.MinusMinusToken;case me.CallExpression:var r=Ee.pxtInfo(e).callInfo,n=(Ee.assert(!!r),t.attrs(r));return r.isExpression&&!n.forceStatement&&!n.handlerStatement;case me.Identifier:case me.ParenthesizedExpression:case me.NumericLiteral:case me.StringLiteral:case me.NoSubstitutionTemplateLiteral:case me.TrueKeyword:case me.FalseKeyword:case me.NullKeyword:case me.TaggedTemplateExpression:return 1;default:return}}function x(e){return e&&e.fieldOptions&&e.fieldOptions[pe.DecompileIndirectFixedInstances]}function He(e){return Ge(e)||je(e)||Ke(e)||-1!==pxt.blocks.MATH_FUNCTIONS.binary.indexOf(e)}function Ge(e){return-1!==pxt.blocks.MATH_FUNCTIONS.unary.indexOf(e)}function je(e){return-1!==pxt.blocks.MATH_FUNCTIONS.infix.indexOf(e)}function Ke(e){return-1!==pxt.blocks.ROUNDING_FUNCTIONS.indexOf(e)}function ze(e){var t=r.exec(e);return t?`${t[1]||t[2]}[]`:e}function h(t,e,r=!1){var n=[],i=t.getFullText();if(e&&e.length)for(var s of e){var a=xe.getLineOfLocalPosition(t,s.end),o=xe.getStartPositionOfLine(a+1,t)||i.length,a=xe.getStartPositionOfLine(a+2,t)||i.length,a=!r&&!i.substr(o,a-o).trim();let e=i.substr(s.pos,s.end-s.pos);e=e&&e.replace(/\r\n/g,"\n"),s.kind===xe.SyntaxKind.SingleLineCommentTrivia?(o=u.exec(e),n.push(o?{kind:he.SingleLine,text:o[1],start:s.pos,end:s.end,hasTrailingNewline:!!s.hasTrailingNewLine,followedByEmptyLine:a,isTrailingComment:r}:{kind:he.SingleLine,text:"",start:s.pos,end:s.end,hasTrailingNewline:!!s.hasTrailingNewLine,followedByEmptyLine:a,isTrailingComment:r})):(o=e.split("\n").map(e=>{e=d.exec(e);return e?e[1]:""}),n.push({kind:he.MultiLine,lines:o,start:s.pos,end:s.end,hasTrailingNewline:!!s.hasTrailingNewLine,followedByEmptyLine:a,isTrailingComment:r}))}return n}function We(e){let t="";for(var r of e)if(r.kind===he.SingleLine)r.text!==Ee.ON_START_COMMENT&&r.text!==Ee.HANDLER_COMMENT&&(t+=r.text.trim()+"\n");else for(var n of r.lines)t+=n.trim()+"\n";return t.trim()}function qe(e){var t=e.getFullText(),r=xe.createScanner(e.languageVersion,!1,e.languageVariant,t,void 0,e.getFullStart()),n=[];let i,s;for(;r.getTextPos()<e.end;){var a=r.scan();if(a===me.SingleLineCommentTrivia||a===me.MultiLineCommentTrivia){i=xe.getLeadingCommentRanges(t,r.getTokenPos())||[],s=(s=xe.getTrailingCommentRanges(t,r.getTokenPos())||[]).filter(t=>!i.some(e=>e.pos===t.pos)),n.push(...h(e,i,!1)),n.push(...h(e,s,!0));for(var o of n)o.end>r.getTextPos()&&r.setTextPos(o.end)}}return n.sort((e,t)=>e.start-t.start),n}function Je(t,r){var n;for(let e=0;e<r.length;e++)!(n=r[e]).owner&&n.start>=t.pos&&n.end<=t.end&&(n.owner=t)}function Ye(e){if(void 0!==e.emitShadowOnly)return e.emitShadowOnly;let t=!1;if("expr"===e.value.kind){var r=e.value;if(r.type===ge&&e.shadowType===fe&&(r.type=fe,r.fields[0].name="SLIDER",r.mutation=e.shadowMutation),!(t=r.type===e.shadowType))switch(r.type){case"math_number":case"math_number_minmax":case"math_integer":case"math_whole_number":case"logic_boolean":case"text":t=!e.shadowType}if(t&&r.inputs)for(var n of r.inputs)if(!Ye(n)){t=!1;break}}return e.emitShadowOnly=t}(e=ke=ke||{})[e.None=0]="None",e[e.InBlocksOnly=1]="InBlocksOnly",e[e.InTextBlocks=2]="InTextBlocks",Se.decompileToBlocks=function(v,o,c,r){var e=o.statements;let n={blocksInfo:v,outfiles:{},diagnostics:[],success:!0,times:{}},T=(c.generateSourceMap&&(n.blockSourceMap=[]),{blocks:v,declaredFunctions:{},declaredEnums:{},declaredKinds:{},functionParamIds:{},attrs:k,compInfo:x,localReporters:[],tileset:[],opts:c||{},aliasBlocks:{}}),M=(o.getFullText(),""),i=[],p={},l=[],F=[],B=(()=>{let e=0;return()=>""+e++})(),t=v.apis.byQName,h=(Object.keys(t).forEach(e=>{e=t[e];e.attributes.blockAliasFor&&t[e.attributes.blockAliasFor]&&(T.aliasBlocks[e.attributes.blockAliasFor]=e.qName)}),qe(o)),$=e=>{if(e.kind!==me.FunctionDeclaration||Ce(e,T,!1,!0))if(e.kind!==me.EnumDeclaration||Ce(e,T,!1,!0)){var t,r;xe.isModuleDeclaration(e)?we(e,T)?Ie(e)||(T.tileset=Ue(e).map(({name:e,initializer:t})=>({projectId:parseInt(e.substr(pxt.sprite.TILE_PREFIX.length)),data:pxt.sprite.imageLiteralToBitmap(t).data()}))):(t=e.name.text,r=Ue(e),T.declaredKinds[t]&&T.declaredKinds[t].declaredNames.push(...r.map(({name:e})=>e))):e.kind===me.Block&&xe.forEachChild(e,$)}else{let r=e.name.text;T.declaredEnums[r]=!0,(e=>{let n=[];return e.members.forEach(e=>{Ee.U.assert(e.name.kind===me.Identifier);var t=e.name.text;let r;r=e.initializer?e.initializer.kind===me.NumericLiteral?parseInt(e.initializer.text):(e=e.initializer,Ee.U.assert(e.left.kind===me.NumericLiteral),Ee.U.assert("1"===e.left.text),Ee.U.assert(e.operatorToken.kind===me.LessThanLessThanToken),Ee.U.assert(e.right.kind===me.NumericLiteral),1<<parseInt(e.right.text)):0===n.length?0:n[n.length-1][1]+1,n.push([t,r])}),n})(e).forEach(([e,t])=>{i.push({name:t+e,type:r})})}else T.declaredFunctions[P(e.name)]=e},U=(Object.keys(v.kindsByName).forEach(e=>{var t=v.kindsByName[e];T.declaredKinds[e]={kindInfo:t,declaredNames:[]}}),xe.forEachChild(o,$),()=>(Math.PI*Math.random()).toString(36).slice(2));Object.keys(T.declaredFunctions).forEach(t=>{T.functionParamIds[t]={},T.declaredFunctions[t].parameters.forEach(e=>{T.functionParamIds[t][e.name.getText()]=U()+U()})}),Object.keys(T.declaredKinds).forEach(e=>{let t="KIND_"+e;T.declaredKinds[e].declaredNames.forEach(e=>i.push({name:e,type:t}))}),(i.length||T.tileset.length)&&(a("<variables>"),i.forEach(e=>{a(`<variable type="${Ee.U.htmlEscape(e.type)}">${Ee.U.htmlEscape(e.name)}</variable>`)}),T.tileset.forEach(e=>{a(`<variable type="${pxt.sprite.BLOCKLY_TILESET_TYPE}">${pxt.sprite.legacy.tileToBlocklyVariable(e)}</variable>`)}),a("</variables>"));let s;try{s=ce(e,void 0,!0,void 0,!c.snippetMode);for(var V of h)V.owner||l.push({refId:B(),comment:[V]})}catch(e){return pxt.reportException(e),n.success=!1,n.diagnostics=Ee.patchUpDiagnostics([{file:o,start:o.getFullStart(),length:o.getFullWidth(),messageText:e.message,category:xe.DiagnosticCategory.Error,code:Se.DECOMPILER_ERROR}]),n}return s?f(s):c.snippetMode||e.length||(u(xe.pxtc.ON_START_TYPE,E(xe.pxtc.ON_START_TYPE,e[0])),d()),l.forEach(r=>{{let t=0,e=We(r.comment);var n,i;e.trim()&&((n=e.split("\n")).forEach(e=>t=Math.max(t,e.length)),i=Math.max(Math.min(10*t,480),160),a(`<comment h="${Math.max(Math.min(40*n.length,360),120)}" w="${i}" data="${Ee.U.htmlEscape(r.refId)}">`),a(Ee.U.htmlEscape(e)),a("</comment>"))}}),n.outfiles[o.fileName.replace(/(\.blocks)?\.\w*$/i,"")+".blocks"]=`<xml xmlns="http://www.w3.org/1999/xhtml">
${M}</xml>`,n;function a(e,t="\n"){M+=e+t}function m(e,t){t=t||`Language feature "${e.getFullText().trim()}"" not supported in blocks`,e=Ee.patchUpDiagnostics([{file:o,start:e.getFullStart(),length:e.getFullWidth(),messageText:t,category:xe.DiagnosticCategory.Error,code:1001}]);pxt.debug("decompilation error: "+t),Ee.U.pushRange(n.diagnostics,e),n.success=!1}function k(e){var t=v.apis.byQName[e.decompilerBlockAlias||e.qName];if(t){var r=t.attributes;if(!r.blockId||v.blocksById[r.blockId]||r.blockId===Ee.PAUSE_UNTIL_TYPE)return t.attributes}else if(e.decl){r=Ee.parseComments(e.decl);if(r)return r}return{paramDefl:{},callingConvention:0}}function x(e){e=v.apis.byQName[e.decompilerBlockAlias||e.qName];if(e)return pxt.blocks.compileInfo(e)}function g(e){if(!e)return"";switch(e.kind){case me.ParenthesizedExpression:case me.AsExpression:return g(e.expression);case me.Identifier:return e.text;case me.StringLiteral:case me.FirstTemplateToken:case me.NoSubstitutionTemplateLiteral:return`"${e.text}"`;case me.NumericLiteral:return e.text;case me.TrueKeyword:return"true";case me.FalseKeyword:return"false";case me.BinaryExpression:return`{${g(e.left)}${e.operatorToken.getText()}${g(e.right)}}`;case me.PrefixUnaryExpression:return e.operator+g(e.operand);case me.PropertyAccessExpression:return g(e.expression)+"."+g(e.name);case me.ArrayLiteralExpression:return`[${e.elements.map(e=>g(e))}]`;case me.ElementAccessExpression:return e.expression+`[${e.argumentExpression}]`;case me.TaggedTemplateExpression:return`${g(e.tag)}\`${e.template.getText()}\``;case me.CallExpression:return`${g(e.expression)}(${e.arguments.map(g).join(",")})`;default:return e.getText()}}function H(e,t){var r;return e==xe.pxtc.ON_START_TYPE?"xRRgvHNlG#rZ^u`HECiY":(e=(()=>{var t="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=t.length,n=[];for(let e=0;e<20;e++)n[e]=t.charAt(Math.random()*r);return n.join("")})(),t&&(r=t.getFullStart(),n.blockSourceMap.push({id:e,startPos:r,endPos:r+t.getFullWidth()})),e)}function E(e,t){var r={kind:"statement",type:e};return n.blockSourceMap&&(r.id=H(e,t)),r}function S(e){return{kind:"expr",type:e}}function C(e,t,r,n){return{kind:"value",name:e,value:t,shadowType:r=(!r||r===ge)&&n&&n.min&&n.max?fe:r,shadowMutation:n}}function f(e){e&&(u(e.type,e),j(e),void 0!==e.data&&a(`<data>${Ee.U.htmlEscape(e.data)}</data>`),e.handlers&&e.handlers.forEach(W),e.next&&(a("<next>"),f(e.next),a("</next>")),void 0!==e.comment&&a(`<comment pinned="false">${Ee.U.htmlEscape(We(e.comment))}</comment>`),d())}function G(t,e){a("<mutation ",""),Object.keys(t).forEach(e=>{void 0!==t[e]&&a(`${e}="${t[e]}" `,"")}),e?(a(">"),e.forEach(t=>{a(`<${t.nodeName} `,""),Object.keys(t.attributes).forEach(e=>{a(`${e}="${t.attributes[e]}" `,"")}),a("/>")}),a("</mutation>")):a("/>")}function j(e){e.mutation&&G(e.mutation,e.mutationChildren),e.fields&&e.fields.forEach(z),e.inputs&&e.inputs.forEach(K)}function K(e){if(a(`<value name="${e.name}">`),Ye(e))q(e.value,!0);else{if(void 0!==e.shadowType)switch(e.shadowType){case ge:case _e:case ye:a(`<shadow type="${e.shadowType}"><field name="NUM">0</field></shadow>`);break;case fe:a(`<shadow type="${fe}">`),e.shadowMutation&&G(e.shadowMutation),a('<field name="SLIDER">0</field></shadow>');break;case ve:a(`<shadow type="${ve}"><field name="BOOL">TRUE</field></shadow>`);break;case be:a(`<shadow type="${be}"><field name="TEXT"></field></shadow>`);break;default:a(`<shadow type="${e.shadowType}"/>`)}q(e.value)}a("</value>")}function z(e){a(`<field name="${Ee.U.htmlEscape(e.name)}">${Ee.U.htmlEscape(e.value.toString())}</field>`)}function W(e){a(`<statement name="${Ee.U.htmlEscape(e.name)}">`),f(e.statement),a("</statement>")}function q(e,t=!1){"text"===e.kind?a(e.value):(e=e,a(`<${t=t||e.isShadow?"shadow":"block"} ${e.id?`id="${e.id}" `:""}type="${Ee.U.htmlEscape(e.type)}">`),j(e),a(`</${t}>`))}function u(e,t){a(`<block ${t&&t.id?`id="${t.id}" `:""}type="${Ee.U.htmlEscape(e)}">`)}function d(){a("</block>")}function w(o){if(Ne(o,T))return Y(o);switch(o.kind){case me.ExpressionStatement:case me.ParenthesizedExpression:return w(o.expression);case me.Identifier:{var i=o;if(Pe(i))return s=Ee.pxtInfo(i),ne(v.apis.byQName[s.commentAttrs.blockIdentity],s.commentAttrs.enumIdentity);let e=P(i),r=i.text,n=null;return T.localReporters.some(t=>{for(let e=0;e<t.length;++e)if(t[e].name===r)return n=t[e],!0;return!1}),n?ee(e,n.type,!1):(L(e,ke.InBlocksOnly),D("variables_get","VAR",e));return}case me.StringLiteral:case me.FirstTemplateToken:case me.NoSubstitutionTemplateLiteral:return Z(o.text);case me.NumericLiteral:return A(o.text);case me.TrueKeyword:return y(!0);case me.FalseKeyword:return y(!1);case me.BinaryExpression:{var s=o;var i=s.operatorToken.getText(),a=Te[i];if(_(s))return X(s);let e=a.leftName||"A",t=a.rightName||"B",r,n;return n="&&"===i||"||"===i?(r=b(e,s.left),b(t,s.right)):(r=I(e,s.left,ge),I(t,s.right,ge)),(i=S(a.type)).fields=[],a.op&&i.fields.push(N("OP",a.op)),i.inputs=[r,n],i;return}case me.PrefixUnaryExpression:var e=o;switch(e.operator){case me.ExclamationToken:var t=S("logic_negate");return t.inputs=[b("BOOL",e.operand)],t;case me.PlusToken:return w(e.operand);case me.MinusToken:return e.operand.kind==me.NumericLiteral?A("-"+e.operand.text):te(e.operand);default:m(e)}return;case me.PropertyAccessExpression:return re(o);case me.ArrayLiteralExpression:return a=o,(r=S("lists_create_with")).inputs=a.elements.map((e,t)=>I("ADD"+t,e)),r.mutation={items:a.elements.length.toString()},r;case me.ElementAccessExpression:return r=o,(c=S("lists_index_get")).inputs=[I("LIST",r.expression),I("INDEX",r.argumentExpression,ge)],c;case me.TaggedTemplateExpression:{c=o;let e=Ee.pxtInfo(c).callInfo,t,r=(e=>{if(e.parent&&e.parent.kind===me.CallExpression){var t=e.parent,r=Ee.pxtInfo(t).callInfo,t=t.arguments.indexOf(e);if(r&&-1!==t)return(e=x(r))&&e.parameters[t]}})(c);var l;t=(t=r&&r.shadowBlockId&&(l=T.blocks.blocksById[r.shadowBlockId])&&"TD_ID"===l.attributes.shim?l:t)||T.blocks.apis.byQName[k(e).blockIdentity];let n=pxt.blocks.compileInfo(t),i=S(t.attributes.blockId),s,a=n.parameters[0];return s=a.fieldOptions&&a.fieldOptions[pe.DecompileArgumentAsString]?c.getText():c.template.text,i.fields=[N(a.actualName,s)],i;return}case me.CallExpression:return O(o,void 0,void 0,!0);case me.AsExpression:return w(o.expression);default:m(o,Ee.Util.lf("Unsupported syntax kind for output expression block: {0}",me[o.kind]))}var c,r}function J(i,s,e){if(r){e=r.getRenamesInSpan(s,e);if(e.length){let n=0;e.forEach(e=>{var t=e.span.start+n-s,r=t+e.span.length;n+=e.diff,i=i.slice(0,t)+e.name+i.slice(r)})}}return i}function Y(e){var t=J(e.getFullText(),e.getFullStart(),e.getEnd()).trim();return de(e),Je(e,h),D(Ee.TS_OUTPUT_TYPE,"EXPRESSION",t)}function _(e){if(e.kind===me.BinaryExpression){var t=e;if("+"===t.operatorToken.getText()||t.operatorToken.kind==me.PlusEqualsToken)return Ee.pxtInfo(e).exprInfo}}function X(e){var t=[],r=(!function e(t,r){_(t)?(e(t.left,r),e(t.right,r)):r.push(t)}(e,t),[]);for(let e=0;e<t.length;e++)(0<e||!Le(t[e].getText()))&&r.push(I("ADD"+r.length,t[e],be));e=S("text_join");return e.inputs=r,e.mutation={items:r.length.toString()},e}function I(e,t,r,n){let i;return"expr"==(i="number"==typeof t?A(t.toString()):("boolean"==typeof t?y:"string"==typeof t?Z:w)(t)).kind&&"math_number"==i.type&&(t=i.fields[0].value,"math_integer"==r&&t%1==0&&(i.type="math_integer"),"math_whole_number"==r)&&t%1==0&&0<t&&(i.type="math_whole_number"),C(e,i,r,n)}function A(e){return D("math_number","NUM",e)}function Z(e){return D("text","TEXT",e)}function y(e){return D("logic_boolean","BOOL",e?"TRUE":"FALSE")}function D(e,t,r,n){e=S(e);return e.fields=[N(t,r)],e.isShadow=n,e}function Q(e,t){t=D("variables_get_reporter","VAR",t);return t.mutation={duplicateondrag:"true"},C(e,t,void 0,t.mutation)}function ee(e,t,r){var n=pxt.blocks.reporterTypeForArgType(t),e=D(n,"VALUE",e);return"argument_reporter_custom"===n&&(e.mutation={typename:t}),r&&(e.mutation||(e.mutation={}),e.mutation.duplicateondrag="true"),e}function N(e,t){return{kind:"field",name:e,value:t}}function te(e){var t=S("math_arithmetic");return t.inputs=[I("A",0,ge),I("B",e,ge)],t.fields=[N("OP","MINUS")],t}function re(n,i=!1,s){var a=Ee.pxtInfo(n).callInfo;if(a){if(n.expression.kind===me.Identifier){var o=n.expression.text;if(T.declaredEnums[o]){var l=v.enumsByName[o];if(l&&l.blockId)return D(l.blockId,"MEMBER",n.name.text)}else if(T.declaredKinds[o]){let e=T.declaredKinds[o];return D(e.kindInfo.blockId,"MEMBER",n.name.text)}}l=k(a);if(s=l.blockId||s,l.blockCombine)return oe(n,n,null,"@get@");if("lists_length"===l.blockId||"text_length"===l.blockId)return(o=S(Ee.U.htmlEscape(l.blockId))).inputs=[I("VALUE",n.expression)],o;let e=Ee.U.htmlEscape(l.blockId)||a.qName;var[o]=Oe(n),o=o&&Ee.pxtInfo(o).callInfo;if(i||!s&&!l.blockIdentity||o&&o.qName===l.blockIdentity)return{kind:"text",value:e};l.enumval&&o&&l.useEnumVal&&(e=l.enumval);let t=T.compInfo(a);if(s&&t&&t.thisParameter)return(i=S(s)).inputs=[I(Ee.U.htmlEscape(t.thisParameter.definitionName),n.expression,t.thisParameter.shadowBlockId)],i;let r=l.blockIdentity?v.apis.byQName[l.blockIdentity]:v.blocksById[s];return ne(r=s&&r.attributes.blockId!==s&&r.attributes.decompilerShadowAlias===s?v.blocksById[s]:r,e)}m(n)}function ne(e,t){var r=/(?:%|\$)([a-zA-Z0-9_]+)/.exec(e.attributes.block),e=S(Ee.U.htmlEscape(e.attributes.blockId));return e.fields=[{kind:"field",name:Ee.U.htmlEscape(r[1]),value:t}],e}function ie(t,n){let s=[],r;for(let e=0;e<h.length&&(!(r=h[e]).owner&&r.start>=t.pos&&r.end<=t.end&&(r.owner=t,r.ownerStatement=n,s.push(r)),!(r.start>t.end));e++);if(r&&r.isTrailingComment){var e=xe.getLineAndCharacterOfPosition(o,t.end),i=xe.getLineAndCharacterOfPosition(o,r.start);if(e.line===i.line){if(r.ownerStatement){r.ownerStatement.comment.splice(r.ownerStatement.comment.indexOf(r),1);for(var a of l)a.comment.splice(a.comment.indexOf(r),1)}r.owner=t,r.ownerStatement=n,s.push(r)}}if(s.length){let r=[];if(function e(t){let[r]=Oe(t);if(!r||r.kind==me.SourceFile)return!0;if(r.kind==me.ExpressionStatement)return e(r);if(r.kind==me.VariableDeclarationList)return e(r.parent);return!1}(t)){let n=[],i=[];s.forEach((e,t)=>{var r=e.owner&&e.start<e.owner.getStart();e.kind===he.MultiLine&&r&&(n.length&&(i.push(n),n=[]),t!=s.length-1)?i.push([e]):(n.push(e),e.followedByEmptyLine&&r&&(i.push(n),n=[]))}),s=n,i.forEach(e=>{var t=B();r.push(t),l.push({comment:e,refId:t})})}n&&(r.length&&(n.data?n.data+=";"+r.join(";"):n.data=r.join(";")),s)&&s.length&&(n.comment?n.comment=n.comment.concat(s):n.comment=s)}}function O(e,t,r,n=!1,i=!1){var s=e;let a,o=!1;var l,c,u,e=Ce(s,T,n,i);if(e)a=se(s,void 0,e);else switch(s.kind){case me.Block:return ce(s.statements,t,i);case me.ExpressionStatement:return O(s.expression,t,r||s,n,i);case me.VariableStatement:if(!(a=ce(s.declarationList.declarations,void 0,!1,r||s)))return p();o=!0;break;case me.FunctionExpression:case me.ArrowFunction:return O(s.body,t);case me.BinaryExpression:a=(e=>{switch(e.left.text,e.operatorToken.kind){case me.EqualsToken:return e.left.kind===me.Identifier?R(e,e.left,e.right):e.left.kind==me.PropertyAccessExpression?ae(e,e.left,e.right,"@set@"):((e,t,r)=>((e=E("lists_index_set",e)).inputs=[I("LIST",t.expression),I("INDEX",t.argumentExpression,ge),I("VALUE",r)],e))(e,e.left,e.right);case me.PlusEqualsToken:var t;return _(e)?(t=E("variables_set",e),L(r=P(e.left),ke.InBlocksOnly),t.inputs=[C("VALUE",X(e),ge)],t.fields=[N("VAR",r)],t):e.left.kind==me.PropertyAccessExpression?ae(e,e.left,e.right,"@change@"):R(e,e.left,e.right,!0);case me.MinusEqualsToken:var r=E("variables_change",e);return r.inputs=[C("VALUE",te(e.right),ge)],r.fields=[N("VAR",P(e.left))],r;default:return void m(e,Ee.Util.lf("Unsupported operator token in statement {0}",me[e.operatorToken.kind]))}})(s);break;case me.PostfixUnaryExpression:case me.PrefixUnaryExpression:a=(e=>{var t=e.operator===me.PlusPlusToken;if(t||e.operator===me.MinusMinusToken)return R(e,e.operand,t?1:-1,!0);m(e)})(s);break;case me.VariableDeclaration:var d=s;if(Ae(d))return d=d,F.push([P(d.name),d]),p();a=(e=>{if((e=>{if(e.name.kind!==me.Identifier)m(e,Ee.Util.lf("Variable declarations may not use binding patterns"));else{if(e.initializer)return 1;m(e,Ee.Util.lf("Variable declarations must have an initializer"))}})(e))return R(e,e.name,e.initializer)})(s);break;case me.WhileStatement:a=((u=E("device_while",d=s)).inputs=[b("COND",d.expression)],u.handlers=[{name:"DO",statement:O(d.statement)}],u);break;case me.IfStatement:a=(e=>{let t=function t(r){let n={ifStatements:[{expression:r.expression,thenStatement:r.thenStatement}],elseStatement:r.elseStatement};if(r.elseStatement&&r.elseStatement.kind==me.IfStatement){let e=t(r.elseStatement);n.ifStatements=n.ifStatements.concat(e.ifStatements),n.elseStatement=e.elseStatement}return n}(e),n=E("controls_if",e);return n.mutation={elseif:(t.ifStatements.length-1).toString(),else:t.elseStatement?"1":"0"},n.inputs=[],n.handlers=[],t.ifStatements.forEach((e,t)=>{var r=O(e.thenStatement);n.inputs.push(b("IF"+t,e.expression)),n.handlers.push({name:"DO"+t,statement:r})}),t.elseStatement&&(e=O(t.elseStatement),n.handlers.push({name:"ELSE",statement:e})),n})(s);break;case me.ForStatement:a=(e=>{let t=e.initializer,r=(t.declarations[0].name.text,e.condition),n=P(t.declarations[0].name),i;r.operatorToken.kind!==me.LessThanToken||function e(t){if(t.kind===me.Identifier&&P(t)===n)return!0;return xe.forEachChild(t,e)}(e.statement)?((i=E("pxt_controls_for",e)).fields=[],i.inputs=[],i.handlers=[],i.inputs=[Q("VAR",n)],r.operatorToken.kind===me.LessThanToken?(a=Re(r.right)).kind===me.NumericLiteral?(s=A(parseFloat(a.text)-1+""),i.inputs.push(C("TO",s,ye))):((s=S("math_arithmetic")).fields=[N("OP","MINUS")],s.inputs=[I("A",a,ge),I("B",1,ge)],i.inputs.push(C("TO",s,ye))):r.operatorToken.kind===me.LessThanEqualsToken&&i.inputs.push(I("TO",r.right,ye))):((i=E("controls_repeat_ext",e)).fields=[],i.inputs=[I("TIMES",r.right,ye)],i.handlers=[]);var s,a=O(e.statement);return i.handlers=[{name:"DO",statement:a}],i})(s);break;case me.ForOfStatement:a=(l=P((l=(u=s).initializer).declarations[0].name),(c=E("pxt_controls_for_of",u)).inputs=[I("LIST",u.expression),Q("VAR",l)],l=O(u.statement),c.handlers=[{name:"DO",statement:l}],c);break;case me.FunctionDeclaration:a=(e=>{let n=P(e.name),t=(T.localReporters.push(e.parameters.map(e=>({name:e.name.getText(),type:e.type.getText()}))),O(e.body));T.localReporters.pop();let i;return(i=E("function_definition",e)).mutation={name:n},e.parameters&&(i.mutationChildren=[],e.parameters.forEach(e=>{var t=e.name.getText();let r=ze(e.type.getText());pxt.U.endsWith(r,"[]")&&(r="Array"),i.mutationChildren.push({nodeName:"arg",attributes:{name:t,type:r,id:T.functionParamIds[n][t]}})})),i.handlers=[{name:"STACK",statement:t}],i})(s);break;case me.CallExpression:a=((n,e)=>{let y=Ee.pxtInfo(n).callInfo,b=k(y);if("Math.pow"==y.qName){let e=S("math_arithmetic");return e.inputs=[C("A",w(n.arguments[0]),ge),C("B",w(n.arguments[1]),ge)],e.fields=[N("OP","POWER")],e}if(pxt.Util.startsWith(y.qName,"Math.")){var r=y.qName.substring(5);if(He(r)){let t;if(Ke(r))t=S("math_js_round");else{t=S("math_js_op");let e;e=Ge(r)?"unary":je(r)?"infix":"binary",t.mutation={"op-type":e}}return t.inputs=y.args.map((e,t)=>C("ARG"+t,w(e),"math_number")),t.fields=[N("OP",r)],t}}if(b.blockId===Ee.PAUSE_UNTIL_TYPE){let e=E(Ee.PAUSE_UNTIL_TYPE,n);r=n.arguments[0];let t;return t=r.body.kind===me.Block?r.body.statements[0].expression:r.body,e.inputs=[C("PREDICATE",w(t),"logic_boolean")],e}if(!b.blockId||!b.block){var t=pxt.blocks.builtinFunctionInfo[y.qName];if(!t){let a=P(n.expression);if(T.declaredFunctions[a]){let s,e=!0;return Ve(n,T)&&([o]=Oe(n),e=o&&o.kind===me.ExpressionStatement),s=E(e?"function_call":"function_call_output",n),y.args.length&&(s.mutationChildren=[],s.inputs=[],T.declaredFunctions[a].parameters.forEach((e,t)=>{var r=e.name.getText(),n=T.functionParamIds[a][r];let i=ze(e.type.getText());pxt.U.endsWith(i,"[]")&&(i="Array"),s.mutationChildren.push({nodeName:"arg",attributes:{name:r,type:i,id:n}});e=C(n,w(y.args[t]));s.inputs.push(e)})),s.mutation={name:a},s}return se(n)}b.blockId=t.blockId}if(!b.imageLiteral&&!b.gridLiteral){xe.isFunctionLike(y.decl);let t=$e(y,T),m=x(y),g=e?S(b.blockId):E(b.blockId,n),f=e=>(g.inputs||(g.inputs=[])).push(e),_=e=>(g.fields||(g.fields=[])).push(e),r=("Math.max"==y.qName&&_({kind:"field",name:"op",value:"max"}),0);if(t.forEach((e,i)=>{let s=e.value,a;var t,o=e.param,l=e.info,e=m.parameters[m.thisParameter?i-1:i],e=e&&e.range;if(e&&(t=e.min,e=e.max,a={min:t.toString(),max:e.toString()}),0===i&&b.defaultInstance){if(s.getText()===b.defaultInstance)return;g.mutation={showing:"true"}}if(!b.mutatePropertyEnum||i!==y.args.length-2){o&&o.isOptional&&++r;let n;if(o&&o.shadowBlockId&&(n=v.blocksById[o.shadowBlockId]),s.kind===me.CallExpression&&(e=(t=Ee.pxtInfo(s).callInfo)&&k(t))&&"TD_ID"===e.shim&&l.isEnum&&(s=Re(t.args[0])),o&&l&&l.isEnum&&s.kind===me.Identifier)_(N(Ee.U.htmlEscape(o.definitionName),Ee.pxtInfo(s).commentAttrs.enumIdentity));else if(o&&o.fieldOptions&&o.fieldOptions[pe.DecompileArgumentAsString])_(N(Ee.U.htmlEscape(o.definitionName),Ee.Util.htmlEscape(s.getText())));else switch(s.kind){case me.FunctionExpression:case me.ArrowFunction:var c=(e=>{if(e=De(e))return{callbackproperties:e[0].join(","),renamemap:Ee.Util.htmlEscape(JSON.stringify(e[1]))}})(s);let e=!1;if(c)g.mutation=c;else{c=s;let r=v.blocksById[b.blockId].parameters[m.thisParameter?i-1:i],n=(e,t)=>{"reporter"===b.draggableParameters?f(C("HANDLER_DRAG_PARAM_"+e.name,ee(t,e.type,!0),void 0)):f(Q("HANDLER_DRAG_PARAM_"+e.name,t))};if(c.parameters.length&&(b.optionalVariableArgs?(g.mutation={numargs:c.parameters.length.toString()},"reporter"===b.draggableParameters?c.parameters.forEach((e,t)=>{t=r.handlerParameters[t];n(t,e.name.text)}):c.parameters.forEach((e,t)=>{g.mutation["arg"+t]=e.name.text})):c.parameters.forEach((e,t)=>{t=r.handlerParameters[t];b.draggableParameters?n(t,e.name.text):_(N("HANDLER_"+t.name,e.name.text))})),b.draggableParameters){if(c.parameters.length<r.handlerParameters.length&&!b.optionalVariableArgs)for(let t=c.parameters.length;t<r.handlerParameters.length;t++){let e=r.handlerParameters[t];n(e,e.name)}"reporter"===b.draggableParameters&&(T.localReporters.push(r.handlerParameters),e=!0)}}c=O(s);(g.handlers||(g.handlers=[])).push({name:"HANDLER",statement:c}),e&&T.localReporters.pop();break;case me.PropertyAccessExpression:var c=Ee.pxtInfo(s).callInfo,u=Ee.U.htmlEscape(o.definitionName),d=k(c);n&&"TD_ID"===n.attributes.shim?f(C(u,re(s,!1,o.shadowBlockId),o.shadowBlockId,a)):l&&l.isEnum||c&&(d.fixedInstance||d.blockIdentity===y.qName)?_(N(u,re(s,!0).value)):f(I(u,s,o.shadowBlockId,a));break;case me.BinaryExpression:if(o&&o.shadowOptions&&o.shadowOptions.toString){c=s;if(c.operatorToken.kind===me.PlusToken&&((d=c.left).kind===me.StringLiteral||d.kind===me.NoSubstitutionTemplateLiteral)&&""===d.text){f(I(Ee.U.htmlEscape(o.definitionName),c.right,o.shadowBlockId||"text"));break}}f(I(Ee.U.htmlEscape(o.definitionName),s,o.shadowBlockId,a));break;default:let t;u=Ee.U.htmlEscape(o.definitionName);let r=!0;if("Math.random"==y.qName)t=C(u,(e=>{switch(e.kind){case me.NumericLiteral:return A((parseInt(e.text)-1).toString());case me.BinaryExpression:var t=e;if(t.operatorToken.kind==me.PlusToken&&"1"==t.right.text)return w(t.left);default:return w(e)}})(s),ge,a),r=!1;else if(Fe(s)){var p="text"==o.fieldEditor?s.text:s.getText(),h=o.shadowBlockId&&!(e=>{switch(e){case ge:case fe:case _e:case ye:case be:case ve:return 1;default:return}})(o.shadowBlockId);if(le(o)&&o.fieldOptions.onParentBlock)return void _(N(u,p));h&&(h=(e=>{if(v.blocksById[e]){e=pxt.blocks.compileInfo(v.blocksById[e]);if(!e.thisParameter&&1===e.parameters.length)return e.parameters[0]}})(o.shadowBlockId))&&le(h)&&(h=D(o.shadowBlockId,h.definitionName,p,!0),o.shadowOptions&&(h.mutation={customfield:Ee.Util.htmlEscape(JSON.stringify(o.shadowOptions))}),t=C(u,h,o.shadowBlockId,a),r=!1)}else if(s.kind===me.TaggedTemplateExpression&&o.fieldOptions&&o.fieldOptions[pe.TaggedTemplate])return void _(N(u,Ee.Util.htmlEscape(s.getText())));r&&(t=I(u,s,o.shadowBlockId,a)),f(t)}}}),r)if(g.mutation||(g.mutation={}),b.compileHiddenArguments){let e=0,r=0;for(var i of t){let t=Ee.U.htmlEscape(i.param.definitionName);var s=g.inputs.find(e=>e.name===t);i.param.isOptional?s&&!Ye(s)&&(r=Math.max(i.param.definitionIndex-e+1,r)):e++}g.mutation._expanded=r.toString()}else g.mutation._expanded=r.toString();return g}var o=n,t=y;if((e=o.arguments[0]).kind!=me.StringLiteral&&e.kind!=me.NoSubstitutionTemplateLiteral)m(o);else{var n=E((t=k(t)).blockId,o),a=(n.fields=[],(e.text||"").replace(/\s+/g,"")),l=(t.imageLiteralColumns||5)*(t.imageLiteral||t.gridLiteral),c=t.imageLiteralRows||5;if((e=l*c)==a.length){let r="";for(let t=0;t<c;++t){for(let e=0;e<l;++e)r+=/[#*1]/.test(a[t*l+e])?"#":".";r+="\n"}return n.fields.push(N("LEDS",`\`${r}\``)),n}m(o,Ee.Util.lf("Invalid image pattern ({0} expected vs {1} actual)",e,a.length))}})(s,n);break;case me.DebuggerStatement:a=(e=>e=E(Ee.TS_DEBUGGER_TYPE,e))(s);break;case me.BreakStatement:a=(e=>e=E(Ee.TS_BREAK_TYPE,e))(s);break;case me.ContinueStatement:a=(e=>e=E(Ee.TS_CONTINUE_TYPE,e))(s);break;case me.EmptyStatement:a=void 0;break;case me.EnumDeclaration:case me.ModuleDeclaration:return Je(s,h),p();case me.ReturnStatement:a=(e=>{var t=E(Ee.TS_RETURN_STATEMENT_TYPE,e);return e.expression?t.inputs=[C("RETURN_VALUE",w(e.expression),ge)]:t.mutation={no_return_value:"true"},t})(s);break;default:return void m(s,t?Ee.Util.lf("Unsupported statement in block: {0}",me[s.kind]):Ee.Util.lf("Statement kind unsupported in blocks: {0}",me[s.kind]))}if(a){let e=a;for(;e.next;)e=e.next;e.next=p(),e.next&&(e.next.prev=e)}return o||ie(r||s,a),a;function p(){if(t&&t.length)return O(t.shift(),t,void 0,!1,i)}}function se(e,t,r){c.errorOnGreyBlocks&&m(e);let n=E(Ee.TS_STATEMENT_TYPE,e),i=(n.mutation={},de(e),e.getText());var s=e.getStart(),a=e.getEnd(),o=(i=J(i,s,a),Je(e,h),t&&(i=t+i),[]);if(e.kind===me.VariableStatement)for(var l of e.declarationList.declarations)o.push(P(l.name));else e.kind===me.VariableDeclaration&&o.push(P(e.name));o.length&&(n.mutation.declaredvars=o.join(","));s=i.split("\n");return n.mutation.numlines=s.length.toString(),r&&c.includeGreyBlockMessages&&(n.mutation.error=Ee.U.htmlEscape(r)),s.forEach((e,t)=>{n.mutation["line"+t]=Ee.U.htmlEscape(e)}),n}function b(e,t){return(e=>{var t=Re(e);switch(t.kind){case me.TrueKeyword:case me.FalseKeyword:case me.Identifier:case me.ElementAccessExpression:return;case me.BinaryExpression:return(e=>{switch(e.operatorToken.kind){case me.EqualsEqualsToken:case me.EqualsEqualsEqualsToken:case me.ExclamationEqualsToken:case me.ExclamationEqualsEqualsToken:case me.LessThanToken:case me.LessThanEqualsToken:case me.GreaterThanToken:case me.GreaterThanEqualsToken:case me.AmpersandAmpersandToken:case me.BarBarToken:return;default:return Ee.Util.lf("Binary expressions in conditionals must evaluate to booleans")}})(t);case me.CallExpression:return(e=>{var t=Ee.pxtInfo(e).callInfo;if(t){t=T.blocks.apis.byQName[t.qName];if(t&&"boolean"==t.retType)return;if(xe.isIdentifier(e.expression)&&T.declaredFunctions[e.expression.text])return}return Ee.Util.lf("Only functions that return booleans are allowed as conditions")})(t);case me.PrefixUnaryExpression:if(t.operator===me.ExclamationToken)return;default:return Ee.Util.lf("Conditions must evaluate to booleans or identifiers")}})(t)?C(e,Y(t),ve):I(e,t,ve)}function R(e,t,r,n=!1){t=P(t),L(t,ke.InBlocksOnly),n=E(n?"variables_change":"variables_set",e.parent||e);return n.inputs=[I("VALUE",r,ge)],n.fields=[N("VAR",t)],n}function ae(e,t,r,n){return oe(e,t,r,n)}function oe(e,n,i,s){let a=Ee.pxtInfo(n).callInfo;var o=T.blocks.apis.byQName[a?a.qName:""];if(o&&o.attributes.blockCombine){let t=o.namespace+`.${o.retType}.`+s;o=T.blocks.blocks.find(e=>e.qName==t),s=i?E(o.attributes.blockId,e):S(o.attributes.blockId),e=o.attributes._def.parameters;let r=a.qName;return o.combinedProperties&&o.combinedProperties.forEach(e=>{0===e.indexOf(a.qName)&&"@"===e.charAt(a.qName.length)&&(r=e)}),s.inputs=[I(e[0].name,n.expression)],s.fields=[N(e[1].name,r)],i&&s.inputs.push(I(e[2].name,i)),s}m(n)}function le(e){return e&&e.fieldOptions&&e.fieldOptions[pe.DecompileLiterals]}function ce(t,e,r=!1,a,n=!1){var i=[],o=e||[];for(let e=t.length-1;0<=e;e--){var s=t[e];((s.kind===me.FunctionDeclaration||s.kind==me.ExpressionStatement&&(t=>{if(t.expression.kind==me.CallExpression){var r=t.expression,r=Ee.pxtInfo(r).callInfo;if(!r)return m(t),0;let e=k(r);return e.block||T.aliasBlocks[r.qName]&&(r.decompilerBlockAlias=T.aliasBlocks[r.qName],e=k(r)),e.blockId&&!e.handlerStatement&&!e.forceStatement&&!r.isExpression&&Me(r,e)}})(s))&&!Ce(s,T,!1,r)?i:o).unshift(s)}var l,c=[],u={};for(l of i){var d=l.kind===me.FunctionDeclaration?void 0:(e=>{var e=e.expression,t=k(e=Ee.pxtInfo(e).callInfo);if(!t.blockAllowMultiple)return t.blockHandlerKey||(e=e.args.filter(e=>!xe.isArrowFunction(e)&&!Be(e)).map(e=>g(e)).join("$$"),t.blockId+"-"+e)})(l);d&&u[d]?c.push(O(l,void 0,void 0,!1,!1)):(u[d]=!0,c.push(O(l,void 0,void 0,!1,r)))}if(c.forEach(f),o.length){let s=o.shift();e=O(s,o,a,!1,r);if(n){let n=e,i=s;if(F.forEach(([t,r])=>{if(p[t]!==ke.InBlocksOnly){r.initializer;let e;(e=p[t]===ke.InTextBlocks?se(r,"let "):R(s,r.name,r.initializer,!1)).next=n,n=e,ie((i=r).parent,n)}}),n)return(a=E(xe.pxtc.ON_START_TYPE,i)).handlers=[{name:"HANDLER",statement:n}],a;ue(e)}return e}n&&ue(void 0)}function ue(e){c.alwaysEmitOnStart&&(u(xe.pxtc.ON_START_TYPE,e),d())}function L(e,t){p[e]!==ke.InTextBlocks&&(p[e]=t)}function de(e){xe.forEachChild(e,e=>{e.kind===me.Identifier&&L(P(e),ke.InTextBlocks),de(e)})}function P(e){if(r){var t=r.getRenameForPosition(e.getStart());if(t)return t.name}return e.text}},Se.getLeadingComments=function(e,t,r){return h(t,r||xe.getLeadingCommentRangesOfNode(e,t))},Se.getTrailingComments=function(e,t){return h(t,xe.getTrailingCommentRanges(t.getFullText(),e.end))},Se.getCommentsForStatement=function(t,r){var n,i=[];for(let e=0;e<r.length&&(!(n=r[e]).owner&&n.start>=t.pos&&n.end<=t.end&&(n.owner=t,i.push(n)),!(n.start>t.end));e++);return i},Se.buildCommentMap=qe}})(ts=ts||{}),(e=>{function p(e,t){var r;switch(e){case"void":return"None";case"boolean":return"bool";case"string":return"str"}return null!=(r=t.byQName[e])&&r.pyQName?t.byQName[e].pyQName:(r=/^(?:Array<(.+)>)|(?:(.+)\[\])|(?:\[.+\])$/.exec(e))?`List[${p(r[1]||r[2],t)}]`:e}function h(e,t){return`\`\`\`${t?"python":"ts"}
${e}
\`\`\``}(e=(e=e.pxtc||(e.pxtc={})).service||(e.service={})).displayStringForSymbol=function(n,i,s){if(n){switch(n.kind){case 3:case 1:{var a=n;var o=i;var l=s;let e="",t=(3===a.kind?e+=o?"def ":"function ":e+="(method) ",e+=o?a.pyQName:a.qName,""),r=(a.parameters&&a.parameters.length&&(t=a.parameters.map(e=>e.name+": "+(o?e.pyTypeString:e.type)).join(", ")),a.retType||"void");return o&&(r=p(r,l)),h(`${e}(${t}): `+r,o);return}case 6:case 7:{a=n;l=i;var t=l?a.pyQName:a.qName;if(6===a.kind)return h("enum "+t,l);let e="(enum member) "+t;return a.attributes.enumval&&(e+=" = "+a.attributes.enumval),h(e,!1);return}case 5:return t=n,h("namespace "+(i?t.pyQName:t.qName),!1);case 9:return e=n,h("interface "+(i?e.pyQName:e.qName),!1);case 8:return e=n,h("class "+(i?e.pyQName:e.qName),i);case 4:var r=n,c=i,u=s,d=c?r.pyQName:"let "+r.qName;if(r.retType){let e=r.retType;return c&&(e=p(e,u)),h(d+": "+e,c)}return h(d,c);case 2:r=n,u=i,d=s,c="(property) "+(u?r.pyQName:r.qName);if(r.retType){let e=r.retType;return u&&(e=p(e,d)),h(c+": "+e,!1)}return h(c,!1)}var e;return`**${n.qName}**`}},e.displayStringForKeyword=function(e,t){return`\`\`\`${t?"py":"ts"}
(keyword) ${e}
\`\`\``}})(ts=ts||{}),(e=>{var _=e.pxtc||(e.pxtc={});{e=_.thumb||(_.thumb={});let t={r0:0,r1:1,r2:2,r3:3,r4:4,r5:5,r6:6,r7:7,r8:8,r9:9,r10:10,r11:10,r12:12,sp:13,r13:13,lr:14,r14:14,pc:15,r15:15};class r extends _.assembler.AbstractProcessor{constructor(){super(),this.addEnc("$r0","R0-7",e=>this.inrange(7,e,e)),this.addEnc("$r1","R0-7",e=>this.inrange(7,e,e<<3)),this.addEnc("$r2","R0-15",e=>this.inrange(15,e,7&e|(8&e)<<4)),this.addEnc("$r3","R0-15",e=>this.inrange(15,e,e<<3)),this.addEnc("$r4","R0-7",e=>this.inrange(7,e,e<<6)),this.addEnc("$r5","R0-7",e=>this.inrange(7,e,e<<8)),this.addEnc("$r01","R0-7",e=>this.inrange(7,e,e|e<<3)),this.addEnc("$i0","#0-255",e=>this.inrange(255,e,e)),this.addEnc("$i1","#0-1020",e=>this.inrange(255,e/4,e>>2)),this.addEnc("$i2","#0-510",e=>this.inrange(127,e/4,e>>2)),this.addEnc("$i3","#0-7",e=>this.inrange(7,e,e<<6)),this.addEnc("$i4","#0-31",e=>this.inrange(31,e,e<<6)),this.addEnc("$i5","#0-124",e=>this.inrange(31,e/4,e>>2<<6)),this.addEnc("$i6","#1-32",e=>0==e?null:32==e?0:this.inrange(31,e,e<<6)),this.addEnc("$i7","#0-62",e=>this.inrange(31,e/2,e>>1<<6)),this.addEnc("$i32","#0-2^32",e=>1),this.addEnc("$rl0","{R0-7,...}",e=>this.inrange(255,e,e)),this.addEnc("$rl1","{LR,R0-7,...}",e=>16384&e?this.inrange(255,-16385&e,256|255&e):this.inrange(255,e,e)),this.addEnc("$rl2","{PC,R0-7,...}",e=>32768&e?this.inrange(255,-32769&e,256|255&e):this.inrange(255,e,e)),this.addEnc("$la","LABEL",e=>this.inrange(255,e/4,e>>2)).isWordAligned=!0,this.addEnc("$lb","LABEL",e=>this.inrangeSigned(127,e/2,e>>1)),this.addEnc("$lb11","LABEL",e=>this.inrangeSigned(1023,e/2,e>>1)),this.addInst("adcs  $r0, $r1",16704,65472),this.addInst("add   $r2, $r3",17408,65280),this.addInst("add   $r5, pc, $i1",40960,63488),this.addInst("add   $r5, sp, $i1",43008,63488),this.addInst("add   sp, $i2",45056,65408).canBeShared=!0,this.addInst("adds  $r0, $r1, $i3",7168,65024),this.addInst("adds  $r0, $r1, $r4",6144,65024),this.addInst("adds  $r01, $r4",6144,65024),this.addInst("adds  $r5, $i0",12288,63488),this.addInst("adr   $r5, $la",40960,63488),this.addInst("ands  $r0, $r1",16384,65472),this.addInst("asrs  $r0, $r1",16640,65472),this.addInst("asrs  $r0, $r1, $i6",4096,63488),this.addInst("bics  $r0, $r1",17280,65472),this.addInst("bkpt  $i0",48640,65280),this.addInst("blx   $r3",18304,65415),this.addInst("bx    $r3",18176,65408),this.addInst("cmn   $r0, $r1",17088,65472),this.addInst("cmp   $r0, $r1",17024,65472),this.addInst("cmp   $r2, $r3",17664,65280),this.addInst("cmp   $r5, $i0",10240,63488),this.addInst("eors  $r0, $r1",16448,65472),this.addInst("ldmia $r5!, $rl0",51200,63488),this.addInst("ldmia $r5, $rl0",51200,63488),this.addInst("ldr   $r0, [$r1, $i5]",26624,63488),this.addInst("ldr   $r0, [$r1, $r4]",22528,65024),this.addInst("ldr   $r5, [pc, $i1]",18432,63488),this.addInst("ldr   $r5, $la",18432,63488),this.addInst("ldr   $r5, [sp, $i1]",38912,63488).canBeShared=!0,this.addInst("ldr   $r5, [sp]",38912,63488).canBeShared=!0,this.addInst("ldrb  $r0, [$r1, $i4]",30720,63488),this.addInst("ldrb  $r0, [$r1, $r4]",23552,65024),this.addInst("ldrh  $r0, [$r1, $i7]",34816,63488),this.addInst("ldrh  $r0, [$r1, $r4]",23040,65024),this.addInst("ldrsb $r0, [$r1, $r4]",22016,65024),this.addInst("ldrsh $r0, [$r1, $r4]",24064,65024),this.addInst("lsls  $r0, $r1",16512,65472),this.addInst("lsls  $r0, $r1, $i4",0,63488),this.addInst("lsrs  $r0, $r1",16576,65472),this.addInst("lsrs  $r0, $r1, $i6",2048,63488),this.addInst("mov   $r2, $r3",17920,65280),this.addInst("movs  $r0, $r1",0,65472),this.addInst("movs  $r5, $i0",8192,63488),this.addInst("muls  $r0, $r1",17216,65472),this.addInst("mvns  $r0, $r1",17344,65472),this.addInst("negs  $r0, $r1",16960,65472),this.addInst("nop",18112,65535),this.addInst("orrs  $r0, $r1",17152,65472),this.addInst("pop   $rl2",48128,65024),this.addInst("push  $rl1",46080,65024),this.addInst("rev   $r0, $r1",47616,65472),this.addInst("rev16 $r0, $r1",47680,65472),this.addInst("revsh $r0, $r1",47808,65472),this.addInst("rors  $r0, $r1",16832,65472),this.addInst("sbcs  $r0, $r1",16768,65472),this.addInst("sev",48960,65535),this.addInst("stm   $r5!, $rl0",49152,63488),this.addInst("stmia $r5!, $rl0",49152,63488),this.addInst("stmea $r5!, $rl0",49152,63488),this.addInst("str   $r0, [$r1, $i5]",24576,63488).canBeShared=!0,this.addInst("str   $r0, [$r1]",24576,63488).canBeShared=!0,this.addInst("str   $r0, [$r1, $r4]",20480,65024),this.addInst("str   $r5, [sp, $i1]",36864,63488).canBeShared=!0,this.addInst("str   $r5, [sp]",36864,63488).canBeShared=!0,this.addInst("strb  $r0, [$r1, $i4]",28672,63488),this.addInst("strb  $r0, [$r1, $r4]",21504,65024),this.addInst("strh  $r0, [$r1, $i7]",32768,63488),this.addInst("strh  $r0, [$r1, $r4]",20992,65024),this.addInst("sub   sp, $i2",45184,65408),this.addInst("subs  $r0, $r1, $i3",7680,65024),this.addInst("subs  $r0, $r1, $r4",6656,65024),this.addInst("subs  $r01, $r4",6656,65024),this.addInst("subs  $r5, $i0",14336,63488),this.addInst("svc   $i0",57088,65280),this.addInst("sxtb  $r0, $r1",45632,65472),this.addInst("sxth  $r0, $r1",45568,65472),this.addInst("tst   $r0, $r1",16896,65472),this.addInst("udf   $i0",56832,65280),this.addInst("uxtb  $r0, $r1",45760,65472),this.addInst("uxth  $r0, $r1",45696,65472),this.addInst("wfe",48928,65535),this.addInst("wfi",48944,65535),this.addInst("yield",48912,65535),this.addInst("cpsid i",46706,65535),this.addInst("cpsie i",46690,65535),this.addInst("beq   $lb",53248,65280),this.addInst("bne   $lb",53504,65280),this.addInst("bcs   $lb",53760,65280),this.addInst("bcc   $lb",54016,65280),this.addInst("bmi   $lb",54272,65280),this.addInst("bpl   $lb",54528,65280),this.addInst("bvs   $lb",54784,65280),this.addInst("bvc   $lb",55040,65280),this.addInst("bhi   $lb",55296,65280),this.addInst("bls   $lb",55552,65280),this.addInst("bge   $lb",55808,65280),this.addInst("blt   $lb",56064,65280),this.addInst("bgt   $lb",56320,65280),this.addInst("ble   $lb",56576,65280),this.addInst("bhs   $lb",53760,65280),this.addInst("blo   $lb",54016,65280),this.addInst("b     $lb11",57344,63488),this.addInst("bal   $lb11",57344,63488),this.addInst("bl    $lb",61440,63488,!0),this.addInst("bb    $lb",57344,63488,!0),this.addInst("ldlit   $r5, $i32",18432,63488)}toFnPtr(e,t,r){return _.target.runtimeIsARM&&/::/.test(r)?e+t&-2:e+t|1}wordSize(){return 4}is32bit(e){return"bl"==e.name||"bb"==e.name}postProcessAbsAddress(e,t){return t=(t^1)-e.baseOffset}emit32(e,t,r){var n,i,s=!!(t%2),a=(t=s?t+1&-4:t)>>1;return _.assert(null!=a),(0|a)==a&&-2097152<a&&a<2097152?(n=2047&a,i=a>>11&1023,{opcode:4026531840&a?62464|i:61440|i,opcode2:s?59392|n:63488|n,stack:0,numArgs:[t],labelName:r}):_.assembler.emitErr("jump out of range",r)}expandLdlit(r){let n,i=!1;var e=[];let s={},a=1;for(let t=0;t<r.lines.length;++t){var o=r.lines[t];if(e.push(o),"instruction"==o.type&&o.instruction&&"ldlit"==o.instruction.name){if(!n){var l=o.location+900;let e=t+1;for(;e<r.lines.length&&!(r.lines[e].location>l);++e){var c=r.lines[e].getOp();("b"==c||"bb"==c||"pop"==c&&"pc"==r.lines[e].words[2])&&(n=r.lines[e])}if(n)i=!1;else for(i=!0;--e>t;)if("instruction"==r.lines[e].type){n=r.lines[e];break}}var u=o.words[1],d="#"+o.words[3];let e=_.U.lookup(s,d);e||(e="_ldlit_"+ ++a,s[d]=e),o.ldlitLabel=o.words[3],o.update(`ldr ${u}, ${e} ; `+o.ldlitLabel)}if(o===n){n=null;var p,h,m=[],d="_jmpwords_"+ ++a;i&&m.push("bb "+d),m.push(".object PUSH"),m.push(".balign 4");for(p of Object.keys(s)){var g=s[p];m.push(g+": .word "+p.slice(1))}i&&m.push(d+":"),m.push(".object POP");for(h of m){r.buildLine(h,e);var f=e[e.length-1];f.scope=o.scope,f.lineNo=o.lineNo}s={}}}r.lines=e}getAddressFromLabel(e,t,r,n=!1){r=e.lookupLabel(r);if(null==r)return null;let i=e.location()+4;return n&&(i&=4294967292),r-i}isPop(e){return 48128==e}isPush(e){return 46080==e}isAddSP(e){return 45056==e}isSubSP(e){return 45184==e}peephole(e,t,r){var n=this.encoders.$lb11,i=this.encoders.$lb;function s(e,t){return null!=e.encode(t.numArgs[0]+8)&&null!=e.encode(t.numArgs[0]-8)&&null!=e.encode(t.numArgs[0])}var a=e.getOp();let o=!1;"bne"!=a&&"beq"!=a||("b"==t.getOp()&&0==e.numArgs[0]&&(o=!0),"bb"==t.getOp()&&2==e.numArgs[0]&&(o=!0)),"bb"==a&&s(n,e)?e.update("b "+e.words[1]):"b"==a&&-2==e.numArgs[0]?e.update(""):"bne"==a&&o&&s(i,t)?(e.update("beq "+t.words[1]),t.update("")):"beq"==a&&o&&s(i,t)?(e.update("bne "+t.words[1]),t.update("")):"push"!=a||16384!=e.numArgs[0]||"push"!=t.getOp()||16384&t.numArgs[0]?"pop"==a&&"pop"==t.getOp()&&32768==t.numArgs[0]?(e.update(e.text.replace("}",", pc}")),t.update("")):"push"==a&&"pop"==t.getOp()&&e.numArgs[0]==t.numArgs[0]?(_.assert(0<e.numArgs[0]),e.update(""),t.update("")):"push"==a&&"pop"==t.getOp()&&4==e.words.length&&4==t.words.length?(_.assert("{"==e.words[1]),e.update("mov "+t.words[2]+", "+e.words[2]),t.update("")):r&&"movs $r5, $i0"==e.getOpExt()&&"mov $r0, $r1"==t.getOpExt()&&e.numArgs[0]==t.numArgs[1]&&(n=r,i=e.numArgs[0],!!("pop"==n.getOp()&&n.numArgs[0]&1<<i))?(e.update("movs r"+t.numArgs[0]+", #"+e.numArgs[1]),t.update("")):"pop"==a&&0<=l(e)&&"push"==t.getOp()&&l(e)==l(t)?(e.update("ldr r"+l(e)+", [sp, #0]"),t.update("")):"push"==a&&"ldr $r5, [sp, $i1]"==t.getOpExt()&&l(e)==t.numArgs[0]&&0==t.numArgs[1]?t.update(""):r&&"push"==a&&0<=l(e)&&(n=t,i=l(e),"movs $r5, $i0"==n.getOpExt())&&n.numArgs[0]!=i&&"pop"==r.getOp()&&l(e)==l(r)&&(e.update(""),r.update("")):(e.update(t.text.replace("{","{lr, ")),t.update(""))}registerNo(e){if(!e)return null;e=e.toLowerCase();e=t[e];return void 0===e?null:e}testAssembler(){_.assembler.expectError(this,"lsl r0, r0, #8"),_.assembler.expectError(this,"push {pc,lr}"),_.assembler.expectError(this,"push {r17}"),_.assembler.expectError(this,"mov r0, r1 foo"),_.assembler.expectError(this,"movs r14, #100"),_.assembler.expectError(this,"push {r0"),_.assembler.expectError(this,"push lr,r0}"),_.assembler.expectError(this,"pop {lr,r0}"),_.assembler.expectError(this,"b #+11"),_.assembler.expectError(this,"b #+102400"),_.assembler.expectError(this,"bne undefined_label"),_.assembler.expectError(this,".foobar"),_.assembler.expect(this,"0200      lsls    r0, r0, #8\nb500      push    {lr}\n2064      movs    r0, #100        ; 0x64\nb401      push    {r0}\nbc08      pop     {r3}\nb501      push    {r0, lr}\nbd20      pop {r5, pc}\nbc01      pop {r0}\n4770      bx      lr\n0000      .balign 4\ne6c0      .word   -72000\nfffe\n"),_.assembler.expect(this,"4291      cmp     r1, r2\nd100      bne     l6\ne000      b       l8\n1840  l6: adds    r0, r0, r1\n4718  l8: bx      r3\n"),_.assembler.expect(this,"          @stackmark base\nb403      push    {r0, r1}\n          @stackmark locals\n9801      ldr     r0, [sp, locals@1]\nb401      push    {r0}\n9802      ldr     r0, [sp, locals@1]\nbc01      pop     {r0}\n          @stackempty locals\n9901      ldr     r1, [sp, locals@1]\n9102      str     r1, [sp, base@0]\n          @stackempty locals\nb002      add     sp, #8\n          @stackempty base\n"),_.assembler.expect(this,"b090      sub sp, #4*16\nb010      add sp, #4*16\n"),_.assembler.expect(this,'6261      .string "abc"\n0063      \n'),_.assembler.expect(this,'6261      .string "abcde"\n6463      \n0065      \n'),_.assembler.expect(this,"3042      adds r0, 0x42\n1c0d      adds r5, r1, #0\nd100      bne #0\n2800      cmp r0, #0\n6b28      ldr r0, [r5, #48]\n0200      lsls r0, r0, #8\n2063      movs r0, 0x63\n4240      negs r0, r0\n46c0      nop\nb500      push {lr}\nb401      push {r0}\nb402      push {r1}\nb404      push {r2}\nb408      push {r3}\nb520      push {r5, lr}\nbd00      pop {pc}\nbc01      pop {r0}\nbc02      pop {r1}\nbc04      pop {r2}\nbc08      pop {r3}\nbd20      pop {r5, pc}\n9003      str r0, [sp, #4*3]\n")}}function l(e){_.assert("push"==e.getOp()||"pop"==e.getOp());let t=0,r=-1,n=e.numArgs[0];for(;0<n;)1&n&&(r=-1==r?t:-2),n>>=1,t++;return 0<=r?r:-1}e.ThumbProcessor=r}})(ts=ts||{}),(r=>{var t,h=r.pxtc||(r.pxtc={});{var m=h.ir||(h.ir={});let d=h.Util;d.assert;let p,e=((t=p=m.EK||(m.EK={}))[t.None=0]="None",t[t.NumberLiteral=1]="NumberLiteral",t[t.PointerLiteral=2]="PointerLiteral",t[t.RuntimeCall=3]="RuntimeCall",t[t.ProcCall=4]="ProcCall",t[t.SharedRef=5]="SharedRef",t[t.SharedDef=6]="SharedDef",t[t.FieldAccess=7]="FieldAccess",t[t.Store=8]="Store",t[t.CellRef=9]="CellRef",t[t.Sequence=10]="Sequence",t[t.JmpValue=11]="JmpValue",t[t.Nop=12]="Nop",t[t.InstanceOf=13]="InstanceOf",0);class g{isExpr(){return!1}isStmt(){return!1}getId(){return this._id||(this._id=++e),this._id}}m.Node=g;class f extends g{constructor(e,t,r){super(),this.exprKind=e,this.args=t,this.data=r,this.callingConvention=0}static clone(e){var t=new f(e.exprKind,e.args?e.args.slice(0):null,e.data);return e.jsInfo&&(t.jsInfo=e.jsInfo),e.totalUses&&(t.totalUses=e.totalUses,t.currUses=e.currUses),t.callingConvention=e.callingConvention,t.mask=e.mask,t.isStringLiteral=e.isStringLiteral,t}reset(){this.currUses=0,this.prevTotalUses&&(this.totalUses=this.prevTotalUses)}ptrlabel(){return this.jsInfo instanceof _?this.jsInfo:null}hexlit(){var e=this.jsInfo;return null!=e.hexlit?e.hexlit:null}isExpr(){return!0}isPure(){return this.isStateless()||this.exprKind==p.CellRef}isLiteral(){switch(this.exprKind){case p.NumberLiteral:case p.PointerLiteral:return!0;default:return!1}}isStateless(){switch(this.exprKind){case p.NumberLiteral:case p.PointerLiteral:case p.SharedRef:return!0;default:return!1}}sharingInfo(){let e=this,t=this.getId();return this.exprKind!=p.SharedRef&&this.exprKind!=p.SharedDef||((e=this.args[0])?t=e.getId():e={currUses:"",totalUses:""}),`${e.currUses}/${e.totalUses} #`+t}toString(){return n(this)}canUpdateCells(){switch(this.exprKind){case p.NumberLiteral:case p.PointerLiteral:case p.CellRef:case p.JmpValue:case p.SharedRef:case p.Nop:return!1;case p.SharedDef:case p.FieldAccess:case p.InstanceOf:return this.args[0].canUpdateCells();case p.RuntimeCall:case p.ProcCall:case p.Sequence:case p.Store:return!0;default:throw h.oops()}}}m.Expr=f;let i;(t=i=m.SK||(m.SK={}))[t.None=0]="None",t[t.Expr=1]="Expr",t[t.Label=2]="Label",t[t.Jmp=3]="Jmp",t[t.StackEmpty=4]="StackEmpty",t[t.Breakpoint=5]="Breakpoint",t[t.Comment=6]="Comment";let s;(t=s=m.JmpMode||(m.JmpMode={}))[t.Always=1]="Always",t[t.IfZero=2]="IfZero",t[t.IfNotZero=3]="IfNotZero",m.lblNumUsesJmpNext=-101;class _ extends g{constructor(e,t){super(),this.stmtKind=e,this.expr=t}isStmt(){return!0}toString(){return n(this)}}function n(e){return function i(e){if(e.isExpr()){let r=e,n=r.args?r.args[0]:null;switch(r.exprKind){case p.NumberLiteral:case p.PointerLiteral:return r.data+"";case p.CellRef:return r.data.toString();case p.JmpValue:return"JMPVALUE";case p.Nop:return"NOP";case p.SharedRef:return`SHARED_REF(#${n.getId()})`;case p.SharedDef:return`SHARED_DEF(#${n.getId()} u(${n.totalUses}): ${i(n)})`;case p.FieldAccess:return i(n)+"."+r.data.name;case p.RuntimeCall:return r.data+"("+r.args.map(i).join(", ")+")";case p.ProcCall:let e=r.data,t="";return(t=null!=e.ifaceIndex?"IFACE@"+e.ifaceIndex:null!=e.virtualIndex?"VTABLE@"+e.virtualIndex:h.getDeclName(e.proc.action))+"("+r.args.map(i).join(", ")+")";case p.Sequence:return"("+r.args.map(i).join("; ")+")";case p.InstanceOf:return"("+i(r.args[0])+" instanceof "+r.data.id+")";case p.Store:return`{ ${i(r.args[0])} := ${i(r.args[1])} }`;default:throw h.oops()}}else{let t=e,r=t.expr?i(t.expr):"{null}";switch(t.stmtKind){case m.SK.Expr:return"    "+r+"\n";case m.SK.Jmp:let e=`goto ${t.lblName}
`;switch(t.jmpMode){case s.Always:return t.expr?`    { JMPVALUE := ${r} } `+e:"    "+e;case s.IfZero:return`    if (! ${r}) `+e;case s.IfNotZero:return`    if (${r}) `+e;default:throw h.oops()}case m.SK.StackEmpty:return"    ;\n";case m.SK.Breakpoint:return"    // brk "+t.breakpointInfo.id+"\n";case m.SK.Comment:return"    // "+t.expr.data+"\n";case m.SK.Label:return t.lblName+":\n";default:throw h.oops()}}}(e)}m.Stmt=_;class y{constructor(e,t,r){this.index=e,this.def=t,this.info=r,this.isarg=!1,this.iscap=!1,this._isLocal=!1,this._isGlobal=!1,this._debugType="?",this.isUserVariable=!1,this.bitSize=0,t&&(h.isInPxtModules(t)||(this.isUserVariable=!0),r)&&h.setCellProps(this)}getName(){return h.getDeclName(this.def)}getDebugInfo(){return{name:this.getName(),type:this._debugType,index:this.index}}toString(){let e="";return this.def&&(e+=this.getName()||"?"),"["+(e=this.isarg?"ARG "+e:e)+"]"}uniqueName(){return this.isarg?"arg"+this.index:this.getName().replace(/[^\w]/g,"_")+"___"+h.getNodeId(this.def)}isLocal(){return this._isLocal}isGlobal(){return this._isGlobal}loadCore(){return o(p.CellRef,null,this)}load(){var e=this.loadCore();return h.target.isNative&&!h.isStackMachine()&&0!=this.bitSize?6==this.bitSize?c("pxt::fromUInt",[e]):c("pxt::fromInt",[e]):this.isByRefLocal()?c("pxtrt::ldlocRef",[e]):e}isByRefLocal(){return this.isLocal()&&this.info.captured&&this.info.written}storeDirect(e){return o(p.Store,[this.loadCore(),e])}storeByRef(e){var t;return this.isByRefLocal()?c("pxtrt::stlocRef",[this.loadCore(),e]):h.target.isNative&&!h.isStackMachine()&&0!=this.bitSize?(t=6==this.bitSize?"pxt::toUInt":"pxt::toInt",this.storeDirect(c(t,[e],1))):this.storeDirect(e)}get isTemporary(){return!1}}m.Cell=y;class b extends y{constructor(e,t){super(e,null,null),this.index=e,this.owningProc=t,this.uid=b.unnamedCellCounter++}getName(){return"unnamed"+this.uid}uniqueName(){return this.getName()+"___U"+this.index}isByRefLocal(){return!1}get isTemporary(){return!0}}b.unnamedCellCounter=0,m.UnnamedCell=b;class v extends g{constructor(){super(...arguments),this.numArgs=0,this.info=null,this.seqNo=-1,this.isRoot=!1,this.locals=[],this.captured=[],this.args=[],this.parent=null,this.debugInfo=null,this.fillDebugInfo=null,this.classInfo=null,this.perfCounterName=null,this.perfCounterNo=0,this.body=[],this.lblNo=0,this.action=null,this.cachedJS=null,this.usingCtx=null}reset(){this.body=[],this.lblNo=0,this.locals=[],this.captured=[],this.args=[]}isGetter(){return this.action&&this.action.kind==r.SyntaxKind.GetAccessor}vtLabel(){return this.label()+(h.isStackMachine()?"":"_args")}label(){return h.getFunctionLabel(this.action)}toString(){return`
PROC ${h.getDeclName(this.action)}
${this.body.map(e=>e.toString()).join("")}
`}emit(e){this.body.push(e)}emitExpr(e){this.emit(a(i.Expr,e))}mkLabel(e){var t=a(i.Label,null);return t.lblName="."+e+"_"+this.lblNo+++"_"+this.seqNo,t.lbl=t}emitLbl(e){this.emit(e)}emitLblDirect(e){var t=a(i.Label,null);t.lblName=e,this.emit(t.lbl=t)}getFullName(){let e=h.getDeclName(this.action);var t;return this.action&&(t=r.pxtc.nodeLocationInfo(this.action),e=t.fileName.replace("pxt_modules/","")+"("+(t.line+1)+","+(t.column+1)+"): "+e),e}getName(){return(this.action&&this.action.name?this.action.name.text:null)||"inline"}mkLocal(e,t){e=new y(this.locals.length,e,t);return this.locals.push(e),e}mkLocalUnnamed(){var e=new b(this.locals.length,this);return this.locals.push(e),e}localIndex(t,e=!1){return this.captured.filter(e=>e.def==t)[0]||this.locals.filter(e=>e.def==t)[0]||(e?null:this.args.filter(e=>e.def==t)[0])}stackEmpty(){this.emit(a(i.StackEmpty,null))}emitJmpZ(e,t){this.emitJmp(e,t,s.IfZero)}emitJmp(e,t,r=s.Always,n=null){t=a(i.Jmp,t);t.jmpMode=r,n&&n.exprKind==p.NumberLiteral&&(n=null),t.terminateExpr=n,"string"==typeof e?t.lblName=e:(t.lbl=e,t.lblName=t.lbl.lblName),this.emit(t)}inlineSelf(e){let{precomp:t,flattened:r}=u(e,!1,!0);d.assert(r.length==this.args.length),this.args.map((e,t)=>{e.repl=r[t],e.replUses=0});e=function t(r,e){switch((r=f.clone(r)).exprKind){case p.PointerLiteral:case p.NumberLiteral:return r;case p.RuntimeCall:for(let e=0;e<r.args.length;++e)r.args[e]=t(r.args[e],!0);return r;case p.CellRef:var n=r.data;return n.repl?n.repl.exprKind===p.CellRef&&e?f.clone(n.repl):(n.replUses++,n.repl):r;case p.FieldAccess:return r.args[0]=t(r.args[0]),r;default:throw d.oops()}}(this.inlineBody);return this.args.forEach((e,t)=>{e.repl.exprKind==p.SharedRef&&(e.repl.args[0].prevTotalUses||(e.repl.args[0].prevTotalUses=e.repl.args[0].totalUses),e.repl.args[0].totalUses+=e.replUses-1),e.repl=null,e.replUses=0}),t.length?(t.push(e),o(p.Sequence,t)):e}resolve(){let n=(t,r)=>{if(t.args)for(let e=0;e<t.args.length;++e)t.args[e]=r(t.args[e])},r=e=>{switch(e.exprKind){case p.SharedDef:throw d.oops();case p.SharedRef:var t=e.args[0];return t.totalUses?(t.totalUses--,e):(t.totalUses=-1,t.currUses=0,t.irCurrUses=0,(t=f.clone(e)).exprKind=p.SharedDef,t.args[0]=r(t.args[0]),t)}return n(e,r),e},t=r=>(r.exprKind!=p.SharedRef&&(n(r,t),r.exprKind===p.Sequence)&&(r.args=r.args.filter((e,t)=>t==r.args.length-1||!e.isPure()||(e.exprKind==p.SharedRef&&0<e.args[0].totalUses&&e.args[0].totalUses--,!1))),r),i=e=>{switch(e.exprKind){case p.SharedDef:var t=e.args[0];if(d.assert(t.totalUses<0,"arg.totalUses < 0"),d.assert(0===t.currUses,"arg.currUses === 0"),-1==t.totalUses)return i(t);t.totalUses=1;break;case p.SharedRef:return d.assert(0<e.args[0].totalUses,"e.args[0].totalUses > 0"),e.args[0].totalUses++,e;case p.PointerLiteral:t=e.ptrlabel();t&&(t.lblNumUses||(t.lblNumUses=0),t.lblNumUses++)}return n(e,i),e},s=e=>{switch(e.exprKind){case p.SharedDef:n(e,s);case p.SharedRef:var t=e.args[0];return(d.assert(0<t.totalUses,"arg.totalUses > 0"),1==t.totalUses)?(d.assert(e.exprKind==p.SharedDef),t):(t.irCurrUses++,e);default:return n(e,s),e}};this.body=this.body.filter(e=>!e.expr||(e.expr=t(r(e.expr)),e.stmtKind!=m.SK.Expr)||!e.expr.isPure());var e,a=d.toDictionary(this.body.filter(e=>e.stmtKind==m.SK.Label),e=>e.lblName);for(let e=0;e<this.body.length;++e)this.body[e].stmtNo=e;for(e of this.body)switch(e.expr&&(e.expr=i(e.expr)),e.stmtKind){case m.SK.Expr:break;case m.SK.Jmp:e.lbl=d.lookup(a,e.lblName),e.lbl||h.oops("missing label: "+e.lblName),e.lbl.lblNumUses?e.lbl.lblNumUses++:e.lbl.lblNumUses=1;break;case m.SK.StackEmpty:case m.SK.Label:case m.SK.Breakpoint:case m.SK.Comment:break;default:h.oops()}var o;let l=null,c=!h.target.debugMode,u=null;for(o of this.body)o.expr&&(o.expr=t(s(o.expr))),l&&l.lbl==o&&l.stmtKind==m.SK.Jmp&&o.stmtKind==m.SK.Label&&l.jmpMode==m.JmpMode.Always&&1==o.lblNumUses&&(o.lblNumUses=m.lblNumUsesJmpNext),(l=o).stmtKind==m.SK.Breakpoint?(o.breakpointInfo.id,o.breakpointInfo):c&&(o.stmtKind==m.SK.Jmp?o.expr&&(u?c=!1:u=o.expr):o.stmtKind==m.SK.StackEmpty||o.stmtKind==m.SK.Label&&o.lblNumUses==m.lblNumUsesJmpNext||(c=!1));c&&u&&function r(n){var e=()=>{if(!n.args)return 0;let e=0;for(var t of n.args)e+=r(t);return n.mask&&n.mask.conversions&&(e+=4*n.mask.conversions.length),e};switch(n.exprKind){case p.NumberLiteral:return 2;case p.PointerLiteral:return 6;case p.RuntimeCall:return e()+2+2+4;case p.CellRef:return 2;case p.FieldAccess:return e()+(n.data.needsCheck?4:0)+2;case p.ProcCall:case p.SharedRef:case p.SharedDef:case p.Store:case p.Sequence:case p.JmpValue:case p.Nop:case p.InstanceOf:return 1e6;default:throw d.oops()}}(u)<=4*this.args.length+4+2+(h.target.isNative?4:30)&&(this.inlineBody=u),pxt.options.debug&&pxt.debug(this.toString())}}function a(e,t){return new _(e,t)}function o(e,t,r){return new f(e,t,r)}function l(e,t){e=o(p.PointerLiteral,null,e);return e.jsInfo=t,e}function c(e,t,r=0){t=o(p.RuntimeCall,t,e);return r&&(t.mask={refMask:r}),t}function u(e,t=!1,r=!1){let n=!!t&&e.some(e=>e.canUpdateCells()),i=[];for(var s of d.reversed(e))s.isStateless()||s.exprKind==p.CellRef&&!n||(s.canUpdateCells()&&(n=!0),i.push(s));i.reverse(),h.isStackMachine()&&!r&&(i=[]);let a=[];t=e.map(r=>{if(0<=i.indexOf(r)){let e=r,t=r;return r.exprKind==p.SharedDef?(r.args[0].totalUses++,e=m.op(p.SharedRef,[r.args[0]])):(e=m.op(p.SharedRef,[r]),t=m.op(p.SharedDef,[r]),r.totalUses=2,r.currUses=0),a.push(t),e}return r});return{precomp:a,flattened:t}}m.Procedure=v,m.iterExpr=function e(t,r){if(r(t),t.args)for(var n of t.args)e(n,r)},m.stmt=a,m.comment=function(e){return a(i.Comment,l(e,e))},m.op=o,m.numlit=function(e){return o(p.NumberLiteral,null,e)},m.shared=function(e){switch(e.exprKind){case p.SharedRef:e=e.args[0];break;case p.NumberLiteral:return e}return o(p.SharedRef,[e])},m.ptrlit=l,m.rtcall=c,m.rtcallMask=function(e,t,r,n){return d.startsWith(e,"@nomask@")&&(e=e.slice(8),t=0),(e=c(e,n,t)).callingConvention=r,e},m.flattenArgs=u}})(ts=ts||{}),(Bt=>{var e;{var $t=Bt.pxtc||(Bt.pxtc={});class s{constructor(e,t){this.wave=e,this.id=t,this.flags=0,this.resetAll()}refresh(){this.flags&=-9,this.proc&&!this.usedActions&&!Qt(this.proc.action)||this.proc&&!this.proc.cachedJS?this.resetEmit():this.usedNodes&&(this.flags|=32),this.classInfo&&this.classInfo.reset()}resetEmit(){this.flags&=-41,this.proc&&this.proc.classInfo&&this.proc.classInfo.ctor==this.proc&&(this.proc.classInfo.ctor=null),this.functionInfo=null,this.variableInfo=null,this.classInfo=null,this.callInfo=null,this.proc=null,this.cell=null,this.exprInfo=null,this.usedNodes=null,this.usedActions=null}resetTSC(){this.flags&=16,this.typeCache=null,this.symbolCache=null,this.commentAttrs=null,this.valueOverride=null,this.declCache=void 0,this.fullName=null,this.constantFolded=void 0}resetAll(){this.resetTSC(),this.resetEmit()}}$t.PxtNode=s;let n,At=((e=n=n||{})[e.Enum=0]="Enum",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=3]="Boolean",e[e.Unsupported=4]="Unsupported",$t.taggedUndefined=0,$t.taggedNull=6,$t.taggedFalse=10,$t.taggedNaN=14,$t.taggedTrue=66,$t.thumbArithmeticInstr={adds:!0,subs:!0,muls:!0,ands:!0,orrs:!0,eors:!0,lsls:!0,asrs:!0,lsrs:!0},$t.numberArithmeticInstr={div:!0,mod:!0,le:!0,lt:!0,ge:!0,gt:!0,eq:!0,neq:!0},{"Array_::getAt":{name:"_pxt_array_get",argsFmt:["T","T","T"],value:0},"Array_::setAt":{name:"_pxt_array_set",argsFmt:["T","T","T","T"],value:0},"BufferMethods::getByte":{name:"_pxt_buffer_get",argsFmt:["T","T","T"],value:0},"BufferMethods::setByte":{name:"_pxt_buffer_set",argsFmt:["T","T","T","I"],value:0},"pxtrt::mapGetGeneric":{name:"_pxt_map_get",argsFmt:["T","T","S"],value:0},"pxtrt::mapSetGeneric":{name:"_pxt_map_set",argsFmt:["T","T","S","T"],value:0}}),Dt=$t.ir.EK,r=($t.SK=Bt.SyntaxKind,0),Nt=$t.numReservedGlobals=1;function Ut(e){return e.pxt?!!(16&e.pxt.flags):!!(e=Bt.getSourceFileOfNode(e))&&$t.isPxtModulesFilename(e.fileName)}function Vt(e){var t;return e.pxt?((t=e.pxt).wave!=Nt&&(t.wave=Nt,$t.compileOptions&&$t.compileOptions.skipPxtModulesTSC&&16&t.flags?$t.compileOptions.skipPxtModulesEmit?t.refresh():t.resetEmit():t.resetAll()),t):(t=new s(Nt,++r),Ut(e)&&(t.flags|=16),e.pxt=t)}function Ht(e){return Vt(e).id}function Gt(e){return e?Bt.SyntaxKind[e.kind]:"<null>"}function jt(e,t,r=!1){var n=new Error(t);if(n.ksEmitterUserError=!0,n.ksErrorCode=e,r&&Ft)return Pt||(Pt=t,Mt=e),n;throw n}function Kt(){return $t.target.isNative&&$t.target.nativeType==$t.NATIVE_TYPE_VM}function zt(){return $t.target.isNative&&$t.target.nativeType!=$t.NATIVE_TYPE_VM}function Wt(){return $t.target.isNative&&$t.target.nativeType==$t.NATIVE_TYPE_THUMB}function fr(e){return zt()?$t.ir.rtcall("pxt::fromInt",[e]):e}function _r(e){return zt()?$t.ir.rtcall("pxt::fromBool",[e]):e}function qt(e){switch(e){case 0:return $t.target.shortPointers?2:4;case 1:return 1;case 3:return 2;case 5:return 4;case 2:return 1;case 4:return 2;case 6:return 4;default:throw $t.oops()}}function a(e){switch(e){case 1:case 3:case 5:return!0;case 2:case 4:case 6:return!1;default:throw $t.oops()}}function Jt(e){switch(e.kind){case $t.SK.TemplateHead:case $t.SK.TemplateMiddle:case $t.SK.TemplateTail:case $t.SK.StringLiteral:case $t.SK.NoSubstitutionTemplateLiteral:return!0;default:return!1}}function Yt(e){return e&&e.modifiers&&e.modifiers.some(e=>e.kind==$t.SK.StaticKeyword)}function yr(e){return e.modifiers&&e.modifiers.some(e=>e.kind==$t.SK.ReadonlyKeyword)}function br(e,t){return!e.explicitDefaults||e.explicitDefaults.indexOf(t)<0?null:e.paramDefl[t]}function o(e){if(!e)return null;switch(e.kind){case $t.SK.MethodDeclaration:return"";case $t.SK.Constructor:return"new/";case $t.SK.GetAccessor:return"get/";case $t.SK.SetAccessor:return"set/";default:return null}}function Xt(e){return o(e)+sr(e)}function Zt(e){return null!=o(e)}function Qt(e){let t=e,r=!1;for(;;)switch((t=t.parent)||jt(9229,Ot("cannot determine parent of {0}",Gt(e))),t.kind){case $t.SK.MethodDeclaration:case $t.SK.Constructor:case $t.SK.GetAccessor:case $t.SK.SetAccessor:case $t.SK.FunctionDeclaration:case $t.SK.ArrowFunction:case $t.SK.FunctionExpression:return t;case $t.SK.WhileStatement:case $t.SK.DoStatement:case $t.SK.ForInStatement:case $t.SK.ForOfStatement:case $t.SK.ForStatement:r=!0;break;case $t.SK.SourceFile:return r?Lt:null}}function t(e){return"objectFlags"in e}function er(e){return!!e&&(e.kind==$t.SK.VariableDeclaration||e.kind==$t.SK.BindingElement&&er(e.parent.parent))}function tr(e){return!!e&&(er(e)&&!Qt(e)||e.kind==$t.SK.PropertyDeclaration&&Yt(e))}function rr(e){return!!e&&(e.kind==$t.SK.Parameter||e.kind==$t.SK.BindingElement&&rr(e.parent.parent))}$t.isInPxtModules=Ut,$t.pxtInfo=Vt,$t.getNodeId=Ht,$t.stringKind=Gt,$t.isStackMachine=Kt,$t.needsNumberConversions=zt,$t.isThumb=Wt,$t.sizeOfBitSize=qt,$t.isBitSizeSigned=a,$t.setCellProps=function(e){var t;e._isLocal=er(t=e.def)&&!tr(t)||rr(e.def),e._isGlobal=tr(e.def),e.def.isThisParameter||((t=cr(e.def)).flags&Bt.TypeFlags.Void&&$t.oops("void-typed variable, "+e.toString()),e.bitSize=(e=>{if(!e||!e.type)return 0;if(!Cr(cr(e)))return 0;if(e.type.kind!=$t.SK.TypeReference)return 0;switch(e.type.typeName.getText()){case"int8":return 1;case"int16":return 3;case"int32":return 5;case"uint8":return 2;case"uint16":return 4;case"uint32":return 6;default:return 0}})(e.def),0!=e.bitSize?e._debugType=(a(e.bitSize)?"int":"uint")+8*qt(e.bitSize):pr(t)?e._debugType="string":t.flags&Bt.TypeFlags.NumberLike&&(e._debugType="number")),e.isLocal()&&0!=e.bitSize&&(e.bitSize=0,jt(9256,Ot("bit sizes are not supported for locals and parameters")))},$t.isStatic=Yt,$t.isReadOnly=yr,$t.getExplicitDefault=br,$t.isObjectType=t;class wr{constructor(e,t){this.id=e,this.decl=t,this.baseClassInfo=null,this.allfields=[],this.methods={},this.attrs=ir(t),this.reset()}reset(){this.vtable=null,this.itable=null}get isUsed(){return!!(8&Vt(this.decl).flags)}allMethods(){var e,t=[];for(e of Object.keys(this.methods))for(var r of this.methods[e])t.push(r);return t}usedMethods(){var e,t=[];for(e of Object.keys(this.methods))for(var r of this.methods[e])8&Vt(r).flags&&t.push(r);return t}}$t.ClassInfo=wr;let Ot=$t.assembler.lf,Rt,Lt,Pt,Mt=0,Ft=0;function nr(e,t){var r=Vt(t);return null==r.fullName&&(r.fullName=$t.getFullName(e,t.symbol)),r.fullName}function i(e){var t=e=>{let t=Bt.getSourceFileOfNode(e);return t&&(e=Bt.getLeadingCommentRangesOfNode(e,t))?e.map(e=>t.text.slice(e.pos,e.end)).join("\n"):""};return(e=e.kind==$t.SK.VariableDeclaration?e.parent.parent:e).symbol&&e.symbol.declarations&&1<e.symbol.declarations.length?e.symbol.declarations.map(t).join("\n"):t(e)}function vr(e){let t="";for(var r of e.declarations)t+=i(r);return $t.parseCommentString(t)}function ir(e){var t,r=e?Vt(e):null;return!r||2&r.flags?$t.parseCommentString(""):r.commentAttrs||((t=$t.parseCommentString(i(e)))._name=sr(e),r.commentAttrs=t)}function sr(e){return e.name&&e.name.kind==$t.SK.Identifier?e.name.text:"???"}function l(e){if(t(e)&&e.objectFlags&Bt.ObjectFlags.Reference&&(e.typeArguments&&e.typeArguments.length))return e.target;return null}function ar(e){return t(e)&&e.objectFlags&Bt.ObjectFlags.Reference&&e.symbol&&"Array"==e.symbol.name}function Tr(e){return!!(t(e)&&(e.objectFlags&Bt.ObjectFlags.Interface||e.objectFlags&Bt.ObjectFlags.Anonymous))}function or(e){return!!e.isThisType||!!t(e)&&!!(e.objectFlags&Bt.ObjectFlags.Class||e.symbol&&e.symbol.flags&Bt.SymbolFlags.Class)}function lr(e){var t=l(e);return or(t||e)}function kr(e){return ar(e)?e.typeArguments[0]:Rt.getIndexTypeOfType(e,Bt.IndexKind.Number)}function c(e){return e}function xr(e){return null===e?$t.taggedNull:void 0===e?$t.taggedUndefined:!1===e?$t.taggedFalse:!0===e?$t.taggedTrue:isNaN(e)?$t.taggedNaN:null}function cr(e){let t;var r=Vt(e);if(r.typeCache)return r.typeCache;if(!(t=Bt.isExpression(e)?Rt.getContextualType(e):t))try{t=Rt.getTypeAtLocation(e)}catch(e){jt(9203,Ot("Unknown type for expression"))}return t&&(r.typeCache=t),t}function u(e){if(!(e.flags&Bt.TypeFlags.Union))return n.Unsupported;let t=!0,r;return e.types.forEach(e=>{if(void 0===r)e.flags&Bt.TypeFlags.NumberLike?r=n.Number:e.flags&Bt.TypeFlags.BooleanLike?r=n.Boolean:e.flags&Bt.TypeFlags.StringLike?r=n.String:e.flags&Bt.TypeFlags.EnumLike&&(r=n.Enum);else switch(r){case n.Number:t=t&&!!(e.flags&Bt.TypeFlags.NumberLike);break;case n.Boolean:t=t&&!!(e.flags&Bt.TypeFlags.BooleanLike);break;case n.String:t=t&&!!(e.flags&Bt.TypeFlags.StringLike);break;case n.Enum:t=t&&!!(e.flags&Bt.TypeFlags.EnumLike)}}),t?r:n.Unsupported}function ur(e){e=Rt.getSignatureFromDeclaration(e);return!(Rt.getReturnTypeOfSignature(e).flags&Bt.TypeFlags.Void)}function d(e){return e&&e.name}function dr(t){let e=d(t)?t.name.text:null;if(!e){if(t.kind!=$t.SK.Constructor){for(let e=t.parent;e;e=e.parent)if(d(e))return dr(e)+".inline";return"inline"}e="constructor"}return function e(t){if(!t)return"";switch(t.kind){case $t.SK.ModuleBlock:return e(t.parent);case $t.SK.ClassDeclaration:case $t.SK.ModuleDeclaration:return e(t.parent)+t.name.text+".";default:return""}}(t.parent)+e}function Er(e){return dr(e).replace(/[^\w]+/g,"_")}function Sr(e){return Er(e)+"__P"+Ht(e)}$t.getNodeFullName=nr,$t.getComments=i,$t.parseCommentsOnSymbol=vr,$t.parseComments=ir,$t.getName=sr,$t.checkType=c,$t.taggedSpecial=xr,$t.getDeclName=dr,$t.getFunctionLabel=Sr;class Ir{constructor(e){this.decl=e,this.capturedVars=[]}get isUsed(){return!!(8&Vt(this.decl).flags)}}function p(e,t,r){return!!(e.flags&t)||u(e)===r}function pr(e){return p(e,Bt.TypeFlags.String|Bt.TypeFlags.StringLiteral,n.String)}function Cr(e){return p(e,Bt.TypeFlags.Number|Bt.TypeFlags.NumberLiteral,n.Number)}$t.FunctionAddInfo=Ir,$t.compileBinary=function(r,p,y,t){$t.compilerHooks.preBinary&&$t.compilerHooks.preBinary(r,p,y),$t.target=p.target,$t.compileOptions=p,$t.target.debugMode=!!p.breakpoints;let o=Bt.createDiagnosticCollection();Rt=r.getTypeChecker();var c,u=$t.U.cpuUs();let _=[],n=[],V={},a={},H=null,b=null,v=!1,d=[];if(Nt++,p.target.isNative){if(!p.extinfo||!p.extinfo.hexinfo)return{diagnostics:[{file:r.getSourceFiles()[0],start:0,length:0,category:$t.DiagnosticCategory.Error,code:9043,messageText:Ot("The hex file is not available, please connect to internet and try again.")}],emittedFiles:[],emitSkipped:!0};let e=p.extinfo,t=p.target;e&&e.disabledDeps&&(i=(p.otherMultiVariants||[]).find(e=>e.extinfo&&!e.extinfo.disabledDeps))&&(pxt.debug(`using alternative extinfo (due to ${e.disabledDeps})`),e=i.extinfo,t=i.target),$t.hexfile.setupFor(t,e||$t.emptyExtInfo(),y),$t.hexfile.setupInlineAssembly(p)}let T=new Ar,k;function G(){T.reset(),k=null,y.breakpoints=[{id:0,isDebuggerStmt:!1,fileName:"bogus",start:0,length:0,line:0,column:0}],y.procCallLocations=[]}T.trace=p.trace,T.breakpoints=p.breakpoints,T.name=p.name,T.target=p.target,p.computeUsedSymbols&&(y.usedSymbols={},y.usedArguments={}),p.computeUsedParts&&(y.usedParts=[]);let j=[];if(!p.forceEmit||0==y.diagnostics.length){let e=r.getSourceFiles().slice();var i=e.find(e=>e.fileName===pxt.MAIN_TS),i=(i&&(e=e.filter(e=>e.fileName!==pxt.MAIN_TS)).push(i),e.find(e=>e.fileName===pxt.TUTORIAL_CODE_STOP));i&&(e=e.filter(e=>e.fileName!==pxt.TUTORIAL_CODE_STOP)).push(i),e.forEach(e=>{e.statements.forEach(e=>{j.push(e)})})}i=r.getSourceFiles().filter(e=>$t.Util.endsWith(e.fileName,t))[0];let e={kind:$t.SK.FunctionDeclaration,parameters:[],name:{text:"<main>",pos:0,end:0},body:{kind:$t.SK.Block,statements:j},parent:i,pos:0,end:0},K=Vt(Lt=e);for(K.flags|=3,l(e),_=[],G(),v=!0,Ct(e);;){for(k=N(e);0<_.length;)Ct(_.pop());if((()=>{v=!1;var e,t=T.usedClassInfos.length;for(e of T.usedClassInfos){for(var r of e.allMethods()){var n=Vt(r),i=E(r);8&n.flags?i.virtualParent&&A(i.virtualParent.decl):(i.virtualParent&&i.virtualParent.isUsed||ue(r)||(e=>null!=$t.U.lookup(T.explicitlyUsedIfaceMembers,e))(sr(r)))&&A(r)}e=Re(e.decl);e&&A(e)}return v=!0,0==_.length&&t==T.usedClassInfos.length})())break}{(i=T.globals.slice(0)).forEach((e,t)=>e.index=t);let r=e=>0==e?10:qt(e),e=(i.sort((e,t)=>r(e.bitSize)-r(t.bitSize)||e.index-t.index),4*$t.numReservedGlobals),t=0;for(c of i){for(var z=Kt()?0:c.bitSize,W=qt(z);e&W-1;)e++;t||0!=z||(t=e),c.index=e,e+=W}T.globalsWords=e+3>>2,T.nonPtrGlobals=t?t>>2:T.globalsWords}v=!1;{for(var q of T.usedClassInfos)!function e(s){$t.assert(s.isUsed,"inf.isUsed");if(s.vtable)return s.vtable;let a=s.baseClassInfo?e(s.baseClassInfo).slice(0):[];s.derivedClasses=[];s.baseClassInfo&&s.baseClassInfo.derivedClasses.push(s);for(var o of s.usedMethods()){T.numMethods++;let i=E(o),e=ir(o);if(ue(o)&&!e.shim&&(s.toStringMethod=N(o),s.toStringMethod.info.usedAsIface=!0),i.virtualParent){T.numVirtMethods++;let t=Xt(o),r=!1,n=N(o);$t.U.assert(!!n);for(let e=0;e<a.length;++e)Xt(a[e].action)==t&&(a[e]=n,i.virtualIndex=e,r=!0);r||(i.virtualIndex=a.length,a.push(n))}}s.vtable=a;s.itable=[];let r={};for(var n of s.allfields){let e=sr(n),t=qe(s,n,!1);r[e]=!0,s.itable.push({name:e,info:(t.idx+1)*(Kt()?1:4),idx:C(e),proc:null})}for(let e=s;e;e=e.baseClassInfo)for(var l of e.usedMethods()){let i=sr(l),e=ir(l);if(!e.shim){let e=N(l),t=s.itable.find(e=>e.name==i),r=l.kind==$t.SK.SetAccessor,n=l.kind==$t.SK.GetAccessor;t?(r&&!t.setProc?t.setProc=e:n&&!t.proc&&(t.proc=e),t.info=0):s.itable.push({name:i,info:0,idx:C(i),proc:r?null:e,setProc:r?e:null}),e.info.usedAsIface=!0}}return s.vtable}(q);let e=Object.keys(T.ifaceMemberMap),t=(e.sort($t.U.strcmp),e.unshift(""),T.emitString(""),T.ifaceMembers=e,T.ifaceMemberMap={},0);for(var J of e)T.ifaceMemberMap[J]=t++;for(var Y of T.usedClassInfos)for(var X of Y.itable)X.idx=C(X.name);for(var Z of T.usedClassInfos)Z.lastSubtypeNo=void 0,Z.classNo=void 0;let r=pxt.BuiltInType.User0,n=e=>{$t.U.assert(!e.classNo),e.classNo=r++;for(var t of e.derivedClasses)t.isUsed&&n(t);e.lastSubtypeNo=r-1};for(var Q of T.usedClassInfos){let e=Q;for(;e.baseClassInfo;)e=e.baseClassInfo;e.classNo||n(e)}}var ee,te=$t.U.cpuUs();y.times.pass0=te-u;let re=o.getDiagnostics();G(),v=!1,T.finalPass=!0,U(e),$t.U.assert(0==_.length),y.configData=[];for(ee of Object.keys(a))a["!"+ee]||y.configData.push({name:ee.replace(/^\!/,""),key:a[ee].key,value:a[ee].value});return y.configData.sort((e,t)=>e.key-t.key),u=$t.U.cpuUs(),y.times.pass1=u-te,Et(e,function(){if(!p.noEmit){T.writeFile=(e,t)=>{y.outfiles[e]=t};for(var e of T.procs)e.cachedJS&&!e.inlineBody||e.resolve();$t.target.isNative&&(T.procs=T.procs.filter(e=>!(e.inlineBody&&!e.info.usedAsIface&&!e.info.usedAsValue))),p.target.isNative?([...p.otherMultiVariants||[],p].forEach(({extinfo:e})=>{e.yotta&&T.writeFile("yotta.json",JSON.stringify(e.yotta,null,2)),e.codal&&T.writeFile("codal.json",JSON.stringify(e.codal,null,2)),e.platformio&&T.writeFile("platformio.json",JSON.stringify(e.platformio,null,2))}),p.target.nativeType==$t.NATIVE_TYPE_VM?$t.vmEmit(T,p,y):$t.processorEmit(T,p,y)):$t.jsEmit(T,y),T.writeFile=void 0}}),y.times.passFinal=$t.U.cpuUs()-u,p.ast&&(te=$t.U.cpuUs(),$t.annotate(r,t,$t.target),y.times.passAnnotate=$t.U.cpuUs()-te),$t.compileOptions=null,0==re.length&&(re=o.getDiagnostics()),$t.compilerHooks.postBinary&&$t.compilerHooks.postBinary(r,p,y),{diagnostics:re,emittedFiles:void 0,emitSkipped:!!p.noEmit};function ne(e,t,r,n,i,s,a){o.add(Bt.createDiagnosticForNode(t,{code:r,message:n,key:n.replace(/^[a-zA-Z]+/g,"_"),category:e},i,s,a))}function ie(e,t,r,n,i,s){ne($t.DiagnosticCategory.Error,e,t,r,n,i,s)}function x(e,t,r=9202){if(t)return jt(r,t);e||jt(r,Ot("Sorry, this language feature is not supported"));let n=Gt(e),i=!1,s=null;switch(e.kind){case Bt.SyntaxKind.ForInStatement:n=Ot("for in loops");break;case Bt.SyntaxKind.ForOfStatement:n=Ot("for of loops"),i=!0;break;case Bt.SyntaxKind.PropertyAccessExpression:n=Ot("property access");break;case Bt.SyntaxKind.DeleteExpression:n=Ot("delete");break;case Bt.SyntaxKind.GetAccessor:n=Ot("get accessor method"),i=!0;break;case Bt.SyntaxKind.SetAccessor:n=Ot("set accessor method"),i=!0;break;case Bt.SyntaxKind.TaggedTemplateExpression:n=Ot("tagged templates");break;case Bt.SyntaxKind.SpreadElement:n=Ot("spread");break;case Bt.SyntaxKind.TryStatement:case Bt.SyntaxKind.CatchClause:case Bt.SyntaxKind.FinallyKeyword:case Bt.SyntaxKind.ThrowStatement:n=Ot("throwing and catching exceptions");break;case Bt.SyntaxKind.ClassExpression:n=Ot("class expressions"),s=Ot("declare a class as class C {} not let C = class {}")}let a="";return a=i?Ot("{0} not currently supported",n):Ot("{0} not supported",Bt.SyntaxKind[e.kind]),s&&(a+=" - "+s),jt(r,a)}function se(e){return Ht(e)+""}function E(e){var t=Vt(e);return t.functionInfo||(t.functionInfo=new Ir(e)),t.functionInfo}function S(e){e=Vt(e);return e.variableInfo||(e.variableInfo={}),e.variableInfo}function ae(t,e=!1){var r=S(t),n=(e&&(r.written=!0),Qt(t));if(null!=n&&n!=k.action){let e=k.action;for(;e&&e!=n;){var i=E(e);i.capturedVars.indexOf(t)<0&&i.capturedVars.push(t),e=Qt(e)}r.captured=!0}}function C(e,t=!1){return r=T,n=e,i=t,e=v,t=b,gr(r,e,t,e=>{i&&!$t.U.lookup(e.explicitlyUsedIfaceMembers,n)&&($t.U.assert(!e.finalPass),e.explicitlyUsedIfaceMembers[n]=!0);var t=$t.U.lookup(e.ifaceMemberMap,n);return null!=t?t:($t.U.assert(!e.finalPass),e.ifaceMemberMap[n]=-1,e.emitString(n),-1)});var r,n,i}function oe(e){e.flags&Bt.TypeFlags.Void&&jt(9203,Ot("void-typed variables not supported"))}function le(e){var t=Vt(e);oe(cr(e)),t.cell||(t.cell=new $t.ir.Cell(null,e,S(e))),T.globals.indexOf(t.cell)<0&&T.globals.push(t.cell)}function ce(t){var e;if(tr(t))return l(t),(e=Vt(t)).cell||le(t),e.cell;{let e=k.localIndex(t);return e||(T.finalPass?jt(9204,Ot("cannot locate identifer")):e=k.mkLocal(t,S(t))),e}}function ue(e){return e.kind==$t.SK.MethodDeclaration&&0==e.parameters.length&&"toString"==sr(e)}function de(e){if(32&e.flags||16&e.flags&&$t.compileOptions.skipPxtModulesEmit)throw y.needsFullRecompile=!0,jt(9200,Ot("full recompile required"))}function w(e,t=null){e=Vt(t=t||e.symbol.valueDeclaration);if(!e.classInfo){var i=Er(t)+"__C"+Ht(t);let r=new wr(i,t);(e.classInfo=r).attrs.autoCreate&&(V[r.attrs.autoCreate]=!0),r.baseClassInfo=(e=>{if(e.heritageClauses)for(var t of e.heritageClauses)switch(t.token){case $t.SK.ExtendsKeyword:if(!t.types||1!=t.types.length)throw jt(9228,Ot("invalid extends clause"));var r=cr(t.types[0]);if(r&&or(r))return Rt.getTypeAtLocation(e),w(r);throw jt(9228,Ot("cannot inherit from this type"));case $t.SK.ImplementsKeyword:break;default:throw jt(9228,Ot("invalid heritage clause"))}return null})(t);var s,a,o=r.baseClassInfo?$t.U.toDictionary(r.baseClassInfo.allfields,e=>sr(e)):{};let n=(e,t=r.baseClassInfo)=>t?t.methods[e]||n(e,t.baseClassInfo):null;for(s of t.members)if(s.kind==$t.SK.PropertyDeclaration){var l=s,c=(Yt(l)||r.allfields.push(l),sr(l));(n(c)||$t.U.lookup(o,c))&&ie(l,9279,Ot("redefinition of '{0}' as field",c))}else if(s.kind==$t.SK.Constructor)for(var u of s.parameters)hr(u)&&r.allfields.push(u);else Zt(s)&&((l=E(s)).parentClassInfo=r,l.isUsed&&O(r),c=sr(s),r.methods.hasOwnProperty(c)||(r.methods[c]=[]),r.methods[c].push(s),!(a=$t.U.lookup(o,c))||64&(a=Vt(a)).flags||(a.flags|=64,8&a.flags&&C(c,!0),de(a)));if(r.baseClassInfo){r.allfields=r.baseClassInfo.allfields.concat(r.allfields);var d,p=r;for(d of p.allMethods()){let t=null;var h,m,g=Xt(d),f=sr(d);for(let e=p.baseClassInfo;e;e=e.baseClassInfo)if(e.methods.hasOwnProperty(f))for(var _ of e.methods[f])Xt(_)==g&&(t=_);t&&(h=E(d),m=E(t),t.parameters.length!=d.parameters.length&&ie(d,9255,Ot("the overriding method is currently required to have the same number of arguments as the base one")),(h.virtualParent=m).virtualParent||(de(Vt(t)),m.virtualParent=m),$t.assert(m.virtualParent==m,"pinf.virtualParent == pinf"))}}}return e.classInfo}function pe(e){return!!e&&!Jt(e)&&(e.kind!==$t.SK.ArrayLiteralExpression?null==f(e):e.elements.some(pe))}function I(e){var t=et(e);if(t)return L(t.val);if(tr(e)&&ir(e).shim)return Ie(e,e,[]);t=ce(e),ae(e),e=t.load();return e}function he(e){ir(e).shim&&jt(9207,Ot("built-in functions cannot be yet used as values; did you forget ()?"));var t=E(e);return me(t),t.location?t.location.load():($t.assert(!T.finalPass||0==t.capturedVars.length,"!bin.finalPass || info.capturedVars.length == 0"),t.usedAsValue=!0,A(e),Me(e))}function me(e){void 0===e.usedBeforeDecl?e.usedBeforeDecl=!0:T.finalPass&&e.usedBeforeDecl&&e.capturedVars.length&&Qt(e.decl)&&!e.alreadyEmitted&&jt(9278,Ot("function referenced before all variables it uses are defined"))}function ge(e){var t=D(e),r=et(t);if(r)return L(r.val);if(t&&(er(t)||rr(t)))return I(t);if(t&&t.kind==$t.SK.FunctionDeclaration)return he(t);if("undefined"==e.text)return L(void 0);throw x(e,Ot("Unknown or undeclared identifier"),9235)}function fe(e){e=function e(t){return t?Zt(t)?t:e(t.parent):null}(e),e||jt(9208,Ot("'this' used outside of a method")),e=E(e);return e.thisParameter||$t.oops("no this"),I(e.thisParameter)}function _e(e){let t;var r;return(t=""==e?$t.ir.rtcall("String_::mkEmpty",[]):(r=e,r=((e,t,r,n)=>gr(e,r,n,e=>e.emitString(t)))(T,r,v,b),$t.ir.ptrlit(r,JSON.stringify(e)))).isStringLiteral=!0,t}function m(e){var t=Ce(e),r=$(e);return $t.target.isNative||Jt(e)?g(r,t):g($t.ir.rtcallMask("String_::stringConv",1,1,[r]),!0)}function ye(e){let n=0;var t,r=(e,t)=>{var r;return Jt(r=t)&&""==r.text?e:(n++,M("String_::concat",[g(e,!0),m(t)],null))};let i=Vt(m(e.head)).valueOverride;for(t of e.templateSpans)i=r(i=r(i,t.expression),t.literal);return 0==n?M("String_::concat",[g(i,!0),g($t.ir.rtcall("String_::mkEmpty",[]),!1)],null):i}function be(e){e=Bt.getDeclarationOfKind(e.symbol,$t.SK.GetAccessor);if(null==e)throw jt(9281,Ot("setter currently requires a corresponding getter"));return e}function ve(e){if(e.kind==$t.SK.Parameter||e.kind==$t.SK.PropertyDeclaration)return e=Vt(e),$t.target.switches.slowFields||64&e.flags}function Te(e,t=null){var r=cr(e.expression);let n={callingConvention:0,paramDefl:{}},i=null,s=!1;if(!t&&pr(r)?i="String_::charAt":ar(r)?i=t?"Array_::setAt":"Array_::getAt":Tr(r)&&(n=vr(r.symbol),i=t?n.indexerSet:n.indexerGet),!i&&r.flags&(Bt.TypeFlags.Any|Bt.TypeFlags.StructuredOrTypeVariable)&&(i=t?"pxtrt::mapSetGeneric":"pxtrt::mapGetGeneric",s=!0),i){if(s||st(e.argumentExpression))return r=[e.expression,e.argumentExpression],M(i,r,n,t?[t]:[]);throw x(e,Ot("non-numeric indexer on {0}",i),9238)}throw x(e,Ot("unsupported indexer"),9239)}function ke(e){var t=!(!tr(t=e)||pe(t.initializer)&&!ir(t).whenUsed)||(t=e).kind==$t.SK.FunctionDeclaration&&!Qt(t)||Zt(t)||Bt.isClassDeclaration(e);return!$t.target.switches.noTreeShake&&(!p.testMode||!t||Ut(e))&&t}function xe(e){return!ke(e)||(e=Vt(e),T.finalPass?8&e.flags:e==b)}function l(e){var t;if(e){var r,n=Vt(e);if(n.classInfo)O(n.classInfo);else{if(p.computeUsedSymbols&&e.symbol&&(y.usedSymbols[nr(Rt,e)]=null),p.computeUsedParts&&null!=(t=n.commentAttrs)&&t.parts)for(r of n.commentAttrs.parts.split(/[ ,]+/g))-1===y.usedParts.indexOf(r)&&y.usedParts.push(r);Kt()&&Zt(e)&&C(sr(e),!0),Ee(e),8&n.flags||(n.flags|=8,ke(e)&&_.push(e))}}}function A(e){l(e)}function Ee(e){v&&(b?b.usedNodes[se(e)]=e:$t.U.oops("no using ctx for: "+sr(e)))}function Se(e){if(!e)return null;var t=Vt(e);if(void 0!==t.declCache)return t.declCache;t=Rt.getSymbolAtLocation(e);let r;return r=t&&!(r=t.valueDeclaration)&&t.declarations&&(e=t.declarations[0])&&e.kind==Bt.SyntaxKind.ImportEqualsDeclaration&&(t=Rt.getSymbolAtLocation(e.moduleReference))?t.valueDeclaration:r}function D(e){let t=Se(e);return l(t),!t&&e&&e.kind==$t.SK.PropertyAccessExpression&&(e=e,Vt(t={kind:$t.SK.PropertySignature,symbol:{isBogusSymbol:!0,name:e.name.getText()},name:e.name}).flags|=2),K.declCache=t||null,t}function Ce(e){return e.kind==$t.SK.NullKeyword||e.kind==$t.SK.NumericLiteral?!!e.isRefOverride:!Jt(e)}function we(e){$t.assert(e.length<=8,"args.length <= 8");let r=0;return e.forEach((e,t)=>{Ce(e)&&(r|=1<<t)}),r}function Ie(e,t,r,n=null){var i=ir(e),s=!(cr(t).flags&Bt.TypeFlags.Void);let a=n||i.shim;if(0<=a.indexOf("(")){n=/(.*)\((.*)\)$/.exec(a);if(n){r.length&&$t.U.userError("no arguments expected");var o=[];if(n[2].replace(/\s/g,"")){for(var l of n[2].split(/,/)){let e=parseInt(l);isNaN(e)&&null==(e=null==(e=nt(t,l))?((e,t)=>{let r=rt(e,t,"userconfig");return r=null==r?rt(e,t,"config"):r})(t,l):e)&&$t.U.userError("invalid argument: "+l+" in "+a),o.push($t.ir.numlit(e))}4<o.length&&$t.U.userError("too many args")}return a=n[1],p.target.isNative&&$t.hexfile.validateShim(dr(e),a,i,!0,o.map(e=>!0)),$t.ir.rtcallMask(a,0,i.callingConvention,o)}}return"TD_NOOP"==a?($t.assert(!s,"!hasRet"),$t.target.switches.profile&&"perfCounter"==i.shimArgument&&(r[0]&&r[0].kind==$t.SK.StringLiteral&&(k.perfCounterName=r[0].text),k.perfCounterName||(k.perfCounterName=k.getFullName())),L(void 0)):"TD_ID"==a||"ENUM_GET"===a?($t.assert(1==r.length,"args.length == 1"),$(r[0])):(p.target.shimRenames&&$t.U.lookup(p.target.shimRenames,a)&&(a=p.target.shimRenames[a]),p.target.isNative&&$t.hexfile.validateShim(dr(e),a,i,s,r.map(st)),M(a,r,i))}function Ae(e,r,n){if(e){var t=e.getParameters(),i=r.length;t.length>r.length&&t.slice(r.length).forEach(t=>{if(t.valueDeclaration&&t.valueDeclaration.kind==$t.SK.Parameter){t=t.valueDeclaration;if(t.initializer)p.unfetteredInitializers||(e=>{switch(e.kind){case $t.SK.UndefinedKeyword:case $t.SK.NullKeyword:case $t.SK.TrueKeyword:case $t.SK.FalseKeyword:case $t.SK.NumericLiteral:return 1;case $t.SK.PropertyAccessExpression:return $(e).exprKind==Dt.NumberLiteral;default:return}})(t.initializer)||jt(9212,Ot("only numbers, null, true and false supported as default arguments")),r.push(t.initializer);else{t=br(n,sr(t));let e=t?L(parseInt(t)):null;null==e&&(e=L(void 0)),r.push(g(e))}}else jt(9213,Ot("unsupported default argument (shouldn't happen)"))});for(let e=0;e<i;e++){var s=t[e];s&&s.valueDeclaration&&s.valueDeclaration.kind==$t.SK.Parameter&&(r[e],s.valueDeclaration)}n.imageLiteral&&(Jt(r[0])||jt(9214,Ot("Only image literals (string literals) supported here; {0}",Gt(r[0]))),r[0]=(t=>{t=t||"0 0 0 0 0\n0 0 0 0 0\n0 0 0 0 0\n0 0 0 0 0\n0 0 0 0 0\n";let r=0,n=0,i=0,s="",a=0;t+="\n";for(let e=0;e<t.length;++e)switch(t[e]){case".":case"_":case"0":s+="0,",r++,a++;break;case"#":case"*":case"1":s+="255,",r++,a++;break;case"\t":case"\r":case" ":break;case"\n":r&&(0==n?n=r:r!=n&&jt(9205,Ot("lines in image literal have to have the same width (got {0} and then {1} pixels)",n,r)),r=0,i++);break;default:jt(9206,Ot("Only 0 . _ (off) and 1 # * (on) are allowed in image literals"))}var e="_img"+T.lblNo++,o=(a%2!=0&&(s+="0"),T.otherLiterals.push(`
.balign 4
${e}: .short 0xffff
        .short ${n}, ${i}
        .byte ${s}
`),"new pxsim.Image("+n+", ["+s+"])");return{kind:$t.SK.NumericLiteral,imageLiteral:e,jsLit:o}})(r[0].text))}}function s(r,e,n,t,i=null,s=null){var a;i=i||D(e);let o=!1,l=!1,c=!1;var u=r===e;if(i)switch(i.kind){case $t.SK.PropertySignature:case $t.SK.PropertyAssignment:case $t.SK.PropertyDeclaration:case $t.SK.MethodSignature:o=!0;break;case $t.SK.Parameter:hr(i)&&(o=!0);break;case $t.SK.GetAccessor:case $t.SK.SetAccessor:case $t.SK.MethodDeclaration:o=!0,l=!0,c=Yt(i);break;case $t.SK.FunctionDeclaration:c=!0;break;case $t.SK.ModuleDeclaration:break;default:i=null}else e.kind==$t.SK.PropertyAccessExpression&&(o=!0);$t.target.switches.slowMethods&&(l=!1);var d=ir(i);let p=n.slice(0);if((o=o&&Yt(i)?!1:o)&&!s&&e.kind==$t.SK.PropertyAccessExpression&&(s=e.expression),y.usedArguments&&d.trackArgs){let t=s?[s].concat(p):p;var n=d.trackArgs.map(e=>t[e]).map(e=>{var t=D(e);return!t||t.kind!=$t.SK.EnumMember&&t.kind!=$t.SK.VariableDeclaration?e&&e.kind==$t.SK.StringLiteral?e.text:"*":nr(Rt,t)}).join(","),h=nr(Rt,i);let e=y.usedArguments[h];(e=e||(y.usedArguments[h]=[])).indexOf(n)<0&&e.push(n)}function m(){var e=Oe(i,r,p.map(e=>$(e))),t=e.data;return p[0]&&t.proc&&t.proc.classInfo&&(t.isThis=p[0].kind==$t.SK.ThisKeyword),e}if((Ae(t,p,d),c)&&!E(i).location)return d.shim&&!He(i)?Ie(i,r,p):(A(i),m());if(e.kind==$t.SK.SuperKeyword){let t=k.classInfo.baseClassInfo.ctor;for(let e=k.classInfo.baseClassInfo;e&&!t;e=e.baseClassInfo)t=e.ctor;if(!t&&T.finalPass)throw jt(9280,Ot("super() call requires an explicit constructor in base class"));h=p.map(e=>$(e));return h.unshift(fe(e)),De(t,r,h)}if(o){if($t.U.assert(!Yt(i)),s?p.unshift(s):x(r,Ot("strange method call"),9241),!i)return $t.U.assert(e.kind==$t.SK.PropertyAccessExpression),n=e.name.text,Ne(p.map(e=>$(e)),{ifaceIndex:C(n,!0),callLocationIndex:It(r),noArgs:u});t=E(i);if(t.parentClassInfo&&O(t.parentClassInfo),A(i),s.kind==$t.SK.SuperKeyword)return m();var g,h=!!t.virtualParent,n=!!Kt()||!!$t.target.switches.slowMethods;if(h&&!n)return i.kind==$t.SK.MethodDeclaration?$t.U.assert(!u):i.kind==$t.SK.GetAccessor||i.kind==$t.SK.SetAccessor?$t.U.assert(u):$t.U.assert(!1),$t.U.assert(!T.finalPass||null!=t.virtualIndex,"!bin.finalPass || info.virtualIndex != null"),Ne(p.map(e=>$(e)),{classInfo:t.parentClassInfo,virtualIndex:t.virtualIndex,noArgs:u,isThis:p[0].kind==$t.SK.ThisKeyword});if(d.shim&&!He(i)){let e=void 0;return r.kind===$t.SK.PropertyAccessExpression&&1<p.length&&(e=d.shim+"_set"),Ie(i,r,p,e)}if(d.helper){let e;for(g of Rt.getSymbolsInScope(r,Bt.SymbolFlags.Module))if("helpers"==g.name)for(var f of g.declarations||[g.valueDeclaration])if(f.kind==$t.SK.ModuleDeclaration)for(var _ of f.body.statements)(null==(a=_.symbol)?void 0:a.name)==d.helper&&(e=_);return e||jt(9215,Ot("helpers.{0} not found",d.helper)),e.kind!=$t.SK.FunctionDeclaration&&jt(9216,Ot("helpers.{0} isn't a function",d.helper)),A(i=e),m()}return h||$t.target.switches.slowMethods||!l?Ne(p.map(e=>$(e)),{ifaceIndex:C(sr(i),!0),isSet:u&&2==p.length,callLocationIndex:It(r),noArgs:u}):($t.U.assert(i.kind!=$t.SK.MethodSignature),m())}return i&&i.kind==$t.SK.ModuleDeclaration&&("String"==sr(i)?jt(9219,Ot('to convert X to string use: X + ""')):jt(9220,Ot("namespaces cannot be called directly"))),p.unshift(e),$t.U.assert(!u),Ne(p.map(e=>$(e)),{virtualIndex:-1,callLocationIndex:It(r),noArgs:u})}function De(e,t,r){$t.U.assert(!T.finalPass||!!e);e={proc:e,callLocationIndex:It(t),virtualIndex:null,ifaceIndex:null};return $t.ir.op(Dt.ProcCall,r,e)}function Ne(e,t){return $t.ir.op(Dt.ProcCall,e,t)}function N(e){return Vt(e).proc}function Oe(e,t,r){var n=N(e);return e.kind==$t.SK.FunctionDeclaration&&me(E(e)),$t.assert(!!n||!T.finalPass,"!!proc || !bin.finalPass"),De(n,t,r)}function Re(e){return e.members.filter(e=>e.kind==$t.SK.Constructor)[0]}function O(e){Ee(e.decl),e.isUsed||(Vt(e.decl).flags|=8,e.baseClassInfo&&O(e.baseClassInfo),T.usedClassInfos.push(e))}function Le(o){function u(e){return/^[0-9a-f]$/i.test(e)}var e=D(o.tag);if(!e)throw x(o,Ot("invalid tagged template"),9265);let l=ir(e),t;e={decl:e,qName:e?nr(Rt,e):"?",args:[o.template],isExpression:!0};function r(e){t=((t,n)=>{let e=H;if("_"==n[0]&&"_"==n[1]&&p.jres[n]&&(e=p.jres[n],n=""),""==n&&e){var i=/font\/x-mkcd-b(\d+)/.exec(e.mimeType);if(i)if(T.finalPass){var s=parseInt(i[1]),a=atob(e.data),o=T.usedChars;let t="",r="";if(p.target.isNative)for(let e=0;e<a.length;e+=s){var l=a.charCodeAt(e)+(a.charCodeAt(e+1)<<8);(l<128||o[l>>5]&1<<(31&l))&&(t+=a.slice(e,e+s),r+=l+", ")}else t=a;n=$t.U.toHex($t.U.stringToUint8Array(t))}else n="aabbccdd";else e.dataEncoding&&"base64"!=e.dataEncoding?"hex"==e.dataEncoding?n=e.data:jt(9271,Ot("invalid jres encoding '{0}' on '{1}'",e.dataEncoding,e.id)):n=$t.U.toHex($t.U.stringToUint8Array(Bt.pxtc.decodeBase64(e.data)))}/^e[14]/i.test(n)&&t.parent&&t.parent.kind==$t.SK.CallExpression&&"image.ofBuffer"==t.parent.expression.getText()&&(n=`870${(i=/^e([14])(..)(..)..(.*)/i.exec(n))[1]}${i[2]}00${i[3]}000000`+i[4]);let r="";for(let e=0;e<n.length;++e){var c=n[e];if(u(c))u(n[e+1])&&(r+=c+n[e+1],e++);else if(!/^[\s\.]$/.test(c))throw x(t,Ot("invalid character in hex literal '{0}'",c),9265)}return $t.target.isNative?(i=T.emitHexLiteral(r.toLowerCase()),$t.ir.ptrlit(i,i)):(i="_hex"+se(t),$t.ir.ptrlit(i,{hexlit:r.toLowerCase()}))})(o,e(o.template.text))}if(Vt(o).callInfo=e,o.template.kind!=$t.SK.NoSubstitutionTemplateLiteral)throw x(o,Ot("substitution not supported in hex literal",l.shim),9265);switch(l.shim){case"@hex":r(e=>e);break;case"@f4":r(function(t){if(!Array.isArray(l.groups))throw x(o,Ot("missing groups in @f4 literal"),9272);let r=[],n=[],i={},s=0;l.groups.forEach((e,t)=>{for(var r of e)i[r]=t}),t+="\n";for(let e=0;e<t.length;++e){var a=t[e];switch(a){case" ":case"\t":break;case"\n":0<n.length&&(r.push(n),s=Math.max(n.length,s),n=[]);break;default:let e=$t.U.lookup(i,a);if(null==e){if(2!=l.groups.length)throw x(o,Ot("invalid character in image literal: '{0}'",e),9273);e=1}n.push(e)}}let e=8;return l.groups.length<=2?e=1:l.groups.length<=16&&(e=4),$t.f4EncodeImg(s,r.length,e,(e,t)=>r[t][e]||0)});break;default:if(void 0===l.shim&&l.helper){var n=o.template;var i=l;let e,t=Rt.getSymbolsInScope(n,Bt.SymbolFlags.Module),r;for(var s of t)if("helpers"==s.name)for(var a of s.declarations||[s.valueDeclaration])if(a.kind==$t.SK.ModuleDeclaration)for(var c of a.body.statements)(null==(e=c.symbol)?void 0:e.name)==i.helper&&(r=c);r||jt(9215,Ot("helpers.{0} not found",i.helper)),r.kind!=$t.SK.FunctionDeclaration&&jt(9216,Ot("helpers.{0} isn't a function",i.helper));var d=r;return A(d),d=Oe(d,n,[_e(n.text)]);return}throw x(o,Ot("invalid shim '{0}' on tagged template",l.shim),9265)}return t=l.helper?$t.ir.rtcall(l.helper,[t]):t}function Pe(e){var t,r=e.parameters.slice(0);return!Yt(e)&&Zt(e)&&((t=E(e)).thisParameter||(t.thisParameter={kind:$t.SK.Parameter,name:{text:"this"},isThisParameter:!0,parent:e}),r.unshift(t.thisParameter)),r}function Me(e){e=Sr(e);return $t.ir.ptrlit(e+"_Lit",e)}function Fe(){var e=d;if(0<e.length){d=[];for(var t of e){var r=k;try{$e(t)}finally{k=r}}}}function Be(e){T.finalPass&&e.functionsToDefine&&$t.U.pushRange(d,e.functionsToDefine)}function $e(r){var e=E(r);let n=null;if(T.finalPass){if(e.alreadyEmitted)return $t.U.assert(e.usedBeforeDecl),null;e.alreadyEmitted=!0}var t,i,s,a,o=r.kind==$t.SK.ArrowFunction||r.kind==$t.SK.FunctionExpression,l=e.capturedVars.slice(0),c=l.map((e,t)=>{t=new $t.ir.Cell(t,e,S(e));return t.iscap=!0,t}),l=(void 0===e.usedBeforeDecl&&(e.usedBeforeDecl=!1),0<l.length?($t.assert(null!=Qt(r),"getEnclosingFunction(node) != null)"),n=$t.ir.shared($t.ir.rtcall("pxt::mkAction",[$t.ir.numlit(l.length),Me(r)])),e.usedAsValue=!0,l.forEach((e,t)=>{var r=k.localIndex(e),e=(r||jt(9223,Ot("cannot find captured value: {0}",Rt.symbolToString(e.symbol))),r.loadCore());k.emitExpr($t.ir.rtcall("pxtrt::stclo",[n,$t.ir.numlit(t),e]))}),r.kind==$t.SK.FunctionDeclaration&&(e.location=k.mkLocal(r,S(r)),k.emitExpr(e.location.storeDirect(n)),n=null)):o&&(n=Me(r),e.usedAsValue=!0),$t.assert(!!n==o,"!!lit == isExpression"),N(r)),u=(l?(k=l).reset():($t.assert(!T.finalPass,"!bin.finalPass"),o=Vt(r),(l=new $t.ir.Procedure).isRoot=!!(1&o.flags),l.action=r,l.info=e,(o.proc=l).usingCtx=b,k=l,o=T,t=l,l=v,a=b,gr(o,l,a,e=>e.addProc(t))),k.captured=c,[]);if(r.parent.kind==$t.SK.ClassDeclaration){o=w(null,r.parent);if(k.classInfo?$t.assert(k.classInfo==o,"proc.classInfo == classInfo"):k.classInfo=o,r.kind==$t.SK.Constructor){if(o.baseClassInfo)for(var d of o.baseClassInfo.decl.members)d.kind==$t.SK.Constructor&&A(d);o.ctor?$t.assert(o.ctor==k,"classInfo.ctor == proc"):o.ctor=k;for(var p of o.allfields)p.kind!=$t.SK.PropertyDeclaration||Yt(p)||(p=p).initializer&&u.push(p)}}let h=[],m=[];k.args=Pe(r).map((e,t)=>{e.name.kind===$t.SK.ObjectBindingPattern&&h.push(e),r.kind==$t.SK.Constructor&&hr(e)&&m.push(e);t=new $t.ir.Cell(t,e,S(e));return Be(t.info),t.isarg=!0,t}),k.args.forEach(e=>{var t;e.isByRefLocal()&&(t=$t.ir.shared($t.ir.rtcall("pxtrt::mklocRef",[])),k.emitExpr($t.ir.rtcall("pxtrt::stlocRef",[t,e.loadCore()],1)),k.emitExpr(e.storeDirect(t)))}),h.forEach(e=>Tt(e));for(i of m){var g=qe(k.classInfo,R(k.classInfo,sr(i)),!1),g=$t.ir.op(Dt.FieldAccess,[I(e.thisParameter)],g);k.emitExpr($t.ir.op(Dt.Store,[g,I(i)]))}for(s of u){var f=qe(k.classInfo,R(k.classInfo,sr(s)),!1),f=$t.ir.op(Dt.FieldAccess,[I(e.thisParameter)],f);k.emitExpr($t.ir.op(Dt.Store,[f,$(s.initializer)]))}Fe(),r.body.kind==$t.SK.Block?(U(r.body),!ur(k.action)||(l=k.body[k.body.length-1])&&l.stmtKind==$t.ir.SK.Jmp&&l.jmpMode==$t.ir.JmpMode.Always||k.emitJmp(B(r).ret,L(void 0),$t.ir.JmpMode.Always)):(a=$(r.body),k.emitJmp(B(r).ret,a,$t.ir.JmpMode.Always)),k.emitLblDirect(B(r).ret),k.stackEmpty();c=k.mkLabel("final");return ur(k.action)?k.emitJmp(c):k.emitJmp(c,L(void 0)),k.emitLbl(c),e.capturedVars.length&&e.usedBeforeDecl&&r.kind==$t.SK.FunctionDeclaration&&!T.finalPass&&(e.capturedVars.sort((e,t)=>t.pos-e.pos),(o=S(e.capturedVars[0])).functionsToDefine||(o.functionsToDefine=[]),o.functionsToDefine.push(r)),$t.assert(!T.finalPass||0==_.length,"!bin.finalPass || usedWorkList.length == 0"),n}function Ue(e){e=$t.ir.shared(e);return k.emitExpr(e),e}function Ve(){return Ue($t.ir.op(Dt.JmpValue,[]))}function He(e){return!p.target.isNative&&e.body&&(e.body.kind!=$t.SK.Block||0<e.body.statements.length)}function Ge(t){if(xe(t)&&!(32&Vt(t).flags)){var r=ir(t);if(null!=r.shim){if("@"==r.shim[0])return;if(p.target.isNative&&$t.hexfile.validateShim(dr(t),r.shim,r,ur(t),Pe(t).map(e=>mr(cr(e)))),!He(t))return}if(!Bt.isInAmbientContext(t)&&t.body){let e=null;r=k;try{e=$e(t)}finally{k=r}return e}}}function je(){}function Ke(e){e.needsIRCache=!0,n.push(e)}function ze(e,t=null){let r=n.length;return e.kind!=$t.SK.PropertyAccessExpression&&e.kind!=$t.SK.ElementAccessExpression||Ke(e.expression),t&&Ke(t),n.length==r?je:()=>{for(let e=r;e<n.length;++e)n[e].cachedIR=null,n[e].needsIRCache=!1;n.splice(r,n.length-r)}}function g(e,t=!1){t={kind:$t.SK.NullKeyword,isRefOverride:t};return Vt(t).valueOverride=e,t}function We(e,t,r,n=null){var i=ze(e),n=n?$(n):L(1),s=$t.ir.shared($(e)),t=$t.ir.shared(Ze(t,s,n));return Ye(e,g(t,!0)),i(),r?s:t}function qe(e,t,r=!0){Yt(t)&&$t.U.oops("fieldIndex on static field: "+sr(t));var n=ir(t),i=e.allfields.indexOf(t);return i<0&&T.finalPass&&$t.U.oops("missing field"),{idx:i,name:sr(t),isRef:!0,shimName:n.shim,classInfo:e,needsCheck:r}}function Je(t){var r=cr(t.expression);if(lr(r)){r=w(r);let e=t.expression.kind==$t.SK.ThisKeyword;return $t.target.switches.noThisCheckOpt&&(e=!1),qe(r,R(r,t.name.text),!e)}throw x(t,Ot("bad field access"),9247)}function R(e,t){e=e.allfields.filter(e=>e.name.text==t)[0];return e||jt(9224,Ot("field {0} not found",t)),e}function Ye(t,n){var e=D(t),r=tr(e);if(t.kind==$t.SK.Identifier||r)e&&(r||er(e)||rr(e))?(r=ce(e),ae(e,!0),k.emitExpr(r.storeByRef($(n)))):x(t,Ot("bad target identifier"),9248);else if(t.kind==$t.SK.PropertyAccessExpression){let e=D(t);if(!e||e.kind!=$t.SK.GetAccessor&&e.kind!=$t.SK.SetAccessor)if(e&&(e.kind==$t.SK.PropertySignature||e.kind==$t.SK.PropertyAssignment||ve(e)))k.emitExpr(s(t,t,[n],null,e));else for(;;){if(t.kind===$t.SK.PropertyAccessExpression){var i=Je(t);if(ir(R(i.classInfo,i.name)).shim){k.emitExpr(s(t,t,[n],null,e));break}}i=$(t);k.emitExpr($t.ir.op(Dt.Store,[i,$(n)]));break}else be(e),(e=Bt.getDeclarationOfKind(e.symbol,$t.SK.SetAccessor))||x(t,Ot("setter not available"),9253),k.emitExpr(s(t,t,[n],null,e))}else if(t.kind==$t.SK.ElementAccessExpression)k.emitExpr(Te(t,n));else if(t.kind==$t.SK.ArrayLiteralExpression)if(n.kind==$t.SK.ArrayLiteralExpression){let r=n.elements.map(e=>{e=$t.ir.shared($(e));return k.emitExpr(e),e});t.elements.forEach((e,t)=>{Ye(e,g(r[t]))})}else{let r=$t.ir.shared($(n));t.elements.forEach((e,t)=>{Ye(e,g(P("Array_::getAt",[r,$t.ir.numlit(t)])))})}else x(t,Ot("bad assignment target"),9249)}function Xe(e){if(Wt())switch(e){case"numops::adds":case"numops::subs":case"numops::eors":case"numops::ands":case"numops::orrs":return"@nomask@"+e}return Kt()&&"pxt::switch_eq"===e?"numops::eq":e}function Ze(e,t,r){return P(Xe(e),[t,r])}function Qe(e,t){if(t){var r=t.val;switch(function e(t){if(t.kind==$t.SK.Identifier)return t.text;if(t.kind==$t.SK.PropertyAccessExpression){var r=e(t.expression);if(r)return r+"."+t.name.text}return null}(e)){case"Math.floor":return{val:Math.floor(r)};case"Math.ceil":return{val:Math.ceil(r)};case"Math.round":return{val:Math.round(r)}}}return null}function et(e){var t,r,n;return e?(void 0===(t=Vt(e)).constantFolded&&(er(e)&&e.parent.flags&Bt.NodeFlags.Const?e.initializer&&(t.constantFolded=f(e.initializer)):e.kind==$t.SK.EnumMember?null==(r=(e=>{let t=ir(e).enumval;if(!t){e=Rt.getConstantValue(e);if(null==e)return null;t=e+""}return/^[+-]?\d+$/.test(t)||/^0x[A-Fa-f\d]{2,8}$/.test(t)||p.unfetteredInitializers?t:($t.U.userError("enumval only support number literals"),"0")})(n=e))?t.constantFolded=f(n.initializer):p.unfetteredInitializers?t.constantFolded={val:r}:(n=parseInt(r),isNaN(n)||(t.constantFolded={val:n})):e.kind==$t.SK.PropertyDeclaration&&Yt(e)&&yr(e)&&(t.constantFolded=f(e.initializer))),t.constantFolded):null}function f(e){var t;return e?(void 0===(t=Vt(e)).constantFolded&&(t.constantFolded=null,e=(e=>{if(!e)return null;switch(e.kind){case $t.SK.PrefixUnaryExpression:var t=e,r=f(t.operand);return((e,t)=>{if(!t)return null;var r=t.val;switch(e){case $t.SK.PlusToken:return{val:+r};case $t.SK.MinusToken:return{val:-r};case $t.SK.TildeToken:return{val:~r};case $t.SK.ExclamationToken:return{val:!r};default:return null}})(t.operator,r);case $t.SK.BinaryExpression:t=e,r=f(t.left);return r?(n=f(t.right))?((e,t,r)=>{if(!t||!r)return null;var n=t.val,i=r.val;switch(e){case $t.SK.PlusToken:return{val:n+i};case $t.SK.MinusToken:return{val:n-i};case $t.SK.SlashToken:return{val:n/i};case $t.SK.PercentToken:return{val:n%i};case $t.SK.AsteriskToken:return{val:n*i};case $t.SK.AsteriskAsteriskToken:return{val:n**i};case $t.SK.AmpersandToken:return{val:n&i};case $t.SK.BarToken:return{val:n|i};case $t.SK.CaretToken:return{val:n^i};case $t.SK.LessThanLessThanToken:return{val:n<<i};case $t.SK.GreaterThanGreaterThanToken:return{val:n>>i};case $t.SK.GreaterThanGreaterThanGreaterThanToken:return{val:n>>>i};case $t.SK.LessThanEqualsToken:return{val:n<=i};case $t.SK.LessThanToken:return{val:n<i};case $t.SK.GreaterThanEqualsToken:return{val:i<=n};case $t.SK.GreaterThanToken:return{val:i<n};case $t.SK.EqualsEqualsToken:return{val:n==i};case $t.SK.EqualsEqualsEqualsToken:return{val:n===i};case $t.SK.ExclamationEqualsEqualsToken:return{val:n!==i};case $t.SK.ExclamationEqualsToken:return{val:n!=i};case $t.SK.BarBarToken:return{val:n||i};case $t.SK.AmpersandAmpersandToken:return{val:n&&i};default:return null}})(t.operatorToken.kind,r,n):null:null;case $t.SK.NumericLiteral:var n=parseFloat(e.text);return isNaN(n)?null:{val:n};case $t.SK.NullKeyword:return{val:null};case $t.SK.TrueKeyword:return{val:!0};case $t.SK.FalseKeyword:return{val:!1};case $t.SK.UndefinedKeyword:return{val:void 0};case $t.SK.CallExpression:return 1==e.arguments.length?Qe(e.expression,f(e.arguments[0])):null;case $t.SK.PropertyAccessExpression:case $t.SK.Identifier:return et(Se(e));case $t.SK.AsExpression:return f(e.expression);default:return null}})(e),t.constantFolded=e),t.constantFolded):null}function tt(e){var t=$t.target.switches.boxDebug;let r=null;if(t)try{$t.target.switches.boxDebug=!1,r=$(e)}finally{$t.target.switches.boxDebug=t}else r=$(e);t=it(r);if(void 0===t)throw jt(9267,Ot("a constant number-like expression is required here"));return t}function rt(e,t,r){var n,e=Rt.getSymbolsInScope(e,Bt.SymbolFlags.Module).filter(e=>e.name==r&&!!e.valueDeclaration)[0];if(e)for(var i of e.valueDeclaration.body.statements)if(i.kind==$t.SK.VariableStatement)for(n of i.declarationList.declarations)if(n.symbol.name==t)return tt(n.initializer);return null}function nt(e,t){var e=Rt.getSymbolsInScope(e,Bt.SymbolFlags.Enum).filter(e=>"DAL"==e.name&&!!e.valueDeclaration)[0];return(e=e&&e.valueDeclaration.members.filter(e=>e.symbol.name==t)[0])?Rt.getConstantValue(e):null}function it(e){if(e.exprKind==$t.ir.EK.NumberLiteral){var t=e.data;if(p.target.isNative&&!Kt()){if(t==$t.taggedNull||t==$t.taggedUndefined||t==$t.taggedFalse)return 0;if(t==$t.taggedTrue)return 1;if("number"==typeof t)return t>>1}else if("number"==typeof t)return t}else if(e.exprKind==$t.ir.EK.RuntimeCall&&2==e.args.length){var r=it(e.args[0]),n=it(e.args[1]);if(void 0===r||void 0===n)return;switch(e.data){case"numops::orrs":return r|n;case"numops::adds":return r+n;default:return void pxt.log(e)}}}function L(e){if(!p.target.isNative||Kt())return $t.ir.numlit(e);var t=xr(e);if(null!=t)return $t.ir.numlit(t);if("number"==typeof e)return t=e,!$t.target.switches.boxDebug&&(0|t)==t&&-1073741824<=t&&t<=1073741823?$t.ir.numlit(e<<1|1):(t=T.emitDouble(e),$t.ir.ptrlit(t,JSON.stringify(e)));throw $t.U.oops("bad literal: "+e)}function st(e){if(e.kind==$t.SK.NullKeyword){var t=Vt(e).valueOverride;if(null!=t)return t.exprKind==Dt.NumberLiteral?!p.target.isNative||!!(1&t.data):t.exprKind==Dt.RuntimeCall&&"pxt::ptrOfLiteral"==t.data?t.args[0].exprKind==Dt.PointerLiteral&&!isNaN(parseFloat(t.args[0].jsInfo)):t.exprKind==Dt.PointerLiteral&&!isNaN(parseFloat(t.jsInfo))}return e.kind==$t.SK.NumericLiteral||mr(cr(e))}function P(e,t){return $t.ir.rtcallMask(e,(1<<t.length)-1,0,t)}function M(a,e,o,t=null){let l=[],r=$t.hexfile.lookupFunc(a);Wt()&&(n=$t.U.lookup(At,a))&&(r=n,a=n.name),r&&(l=r.argsFmt);let c=we(e=t?e.concat(t):e),u=[];var n=e.map((e,t)=>{var r=$(e);if(!zt())return r;let n=l[t+1];var i,s=st(e);if(n=!n&&a.indexOf("::")<0?s?"I":"_":n){if("_"==n[0]||"T"==n||"N"==n)return(i=(e=>{switch(e){case"_Buffer":return pxt.BuiltInType.BoxedBuffer;case"_Image":return $t.target.imageRefTag||pxt.BuiltInType.RefImage;case"_Action":return pxt.BuiltInType.RefAction;case"_RefCollection":return pxt.BuiltInType.RefCollection;default:return null}})(n))&&u.push({argIdx:t,method:"_validate",refTag:i,refTagNullable:!!o.argsNullable}),r;if("I"==n)return r.exprKind==Dt.NumberLiteral&&"number"==typeof r.data?$t.ir.numlit(r.data>>1):(u.push({argIdx:t,method:"pxt::toInt"}),r);if("B"==n)return c&=~(1<<t),F(e,r);if("S"==n)return r.isStringLiteral||(u.push({argIdx:t,method:"_pxt_stringConv",returnsRef:!0}),c|=1<<t),r;if("F"==n||"D"==n)return"D"==n&&$t.U.oops("double arguments not yet supported"),s||$t.U.userError("argsFmt=...F/D... but argument not a number in "+a),u.push({argIdx:t,method:"D"==n?"pxt::toDouble":"pxt::toFloat"}),r;throw $t.U.oops("invalid format specifier: "+n)}throw $t.U.userError("not enough args for "+a)});let i=$t.ir.rtcallMask(a,c,o?o.callingConvention:0,n);return i.mask||(i.mask={refMask:0}),i.mask.conversions=u,p.target.isNative&&("I"==(t=l[0])?i=fr(i):"B"==t?i=_r(i):"F"==t?i=(e=i,zt()?$t.ir.rtcall("pxt::fromFloat",[e]):e):"D"==t&&($t.U.oops("double returns not yet supported"),i=(n=i,zt()?$t.ir.rtcall("pxt::fromDouble",[n]):n))),i}function h(r){T.numStmts++;var n=$t.assembler.debug||$t.target.switches.size||$t.target.sourceMap;let e=!!p.breakpoints;if(n||e){var i=Bt.getSourceFileOfNode(r);if(p.justMyCode&&Ut(i)&&(e=!1),n||e){let t=r.pos;for(;/^\s$/.exec(i.text[t]);)t++;for(;"/"==i.text[t]&&"/"==i.text[t+1];){for(;i.text[t]&&"\n"!=i.text[t];)t++;t++}var s=Bt.getLineAndCharacterOfPosition(i,t);if(n){let e=r.end;80<e-t&&(e=t+80);var n=i.text.slice(t,e).trim().replace(/\n[^]*/,"...");k.emit($t.ir.comment(`${i.fileName.replace(/pxt_modules\//,"")}(${s.line+1},${s.character+1}): `+n))}e&&(n=Bt.getLineAndCharacterOfPosition(i,r.end),r={id:y.breakpoints.length,isDebuggerStmt:r.kind==$t.SK.DebuggerStatement,fileName:i.fileName,start:t,length:r.end-t,line:s.line,endLine:n.line,column:s.character,endColumn:n.character},y.breakpoints.push(r),(s=$t.ir.stmt($t.ir.SK.Breakpoint,null)).breakpointInfo=r,k.emit(s))}}}function at(e,t){switch(t){case $t.SK.PlusToken:return"numops::adds";case $t.SK.MinusToken:return"numops::subs";case $t.SK.SlashToken:return"numops::div";case $t.SK.PercentToken:return"numops::mod";case $t.SK.AsteriskToken:return"numops::muls";case $t.SK.AsteriskAsteriskToken:return"Math_::pow";case $t.SK.AmpersandToken:return"numops::ands";case $t.SK.BarToken:return"numops::orrs";case $t.SK.CaretToken:return"numops::eors";case $t.SK.LessThanLessThanToken:return"numops::lsls";case $t.SK.GreaterThanGreaterThanToken:return"numops::asrs";case $t.SK.GreaterThanGreaterThanGreaterThanToken:return"numops::lsrs";case $t.SK.LessThanEqualsToken:return"numops::le";case $t.SK.LessThanToken:return"numops::lt";case $t.SK.GreaterThanEqualsToken:return"numops::ge";case $t.SK.GreaterThanToken:return"numops::gt";case $t.SK.EqualsEqualsToken:return"numops::eq";case $t.SK.EqualsEqualsEqualsToken:return"numops::eqq";case $t.SK.ExclamationEqualsEqualsToken:return"numops::neqq";case $t.SK.ExclamationEqualsToken:return"numops::neq";default:return null}}function ot(r){if(r.operatorToken.kind==$t.SK.EqualsToken){var n=r;let e=n.right;n.parent.kind==$t.SK.ExpressionStatement&&(e=null);var i=ze(n.left,e),n=(Ye(n.left,n.right),e?$(e):L(void 0));return i(),n}{i=f(r);if(i)return L(i.val);let e=null,t=null;(r.operatorToken.kind==$t.SK.PlusToken||r.operatorToken.kind==$t.SK.PlusEqualsToken)&&(e=cr(r.left),t=cr(r.right),pr(e)||pr(t)&&r.operatorToken.kind==$t.SK.PlusToken)&&(Vt(r).exprInfo={leftType:Rt.typeToString(e),rightType:Rt.typeToString(t)});var s,a,o,l,c,u,d,p,h;if(r.operatorToken.kind==$t.SK.CommaToken)return dt(r.left)?$(r.right):(n=pt(r.left),$t.ir.op(Dt.Sequence,[n,$(r.right)]));switch(r.operatorToken.kind){case $t.SK.BarBarToken:case $t.SK.AmpersandAmpersandToken:return a=$((s=r).left),pr(cr(s.left)),o=k.mkLabel("lazy"),a=$t.ir.shared(a),l=$t.ir.rtcall("numops::toBool",[a]),c=k.mkLabel("lazySkip"),u=s.operatorToken.kind==$t.SK.BarBarToken?$t.ir.JmpMode.IfZero:s.operatorToken.kind==$t.SK.AmpersandAmpersandToken?$t.ir.JmpMode.IfNotZero:$t.U.oops(),k.emitJmp(c,l,u),k.emitJmp(o,a,$t.ir.JmpMode.Always,a),k.emitLbl(c),k.emitExpr(P("langsupp::ignore",[a])),k.emitJmp(o,$(s.right),$t.ir.JmpMode.Always),k.emitLbl(o),Ve();case $t.SK.InstanceOfKeyword:return u=cr((l=r).right),(c=lr(u)?D(l.right):null)&&c.kind==$t.SK.ClassDeclaration||jt(9275,Ot("unsupported instanceof expression")),O(u=w(u,c)),(c=$t.ir.op($t.ir.EK.InstanceOf,[$(l.left)],u)).jsInfo="bool",c}return r.operatorToken.kind==$t.SK.PlusToken&&(pr(e)||pr(t))?M("String_::concat",[m(r.left),m(r.right)],null):r.operatorToken.kind==$t.SK.PlusEqualsToken&&pr(e)?(p=ze(r.left),d=$t.ir.shared(M("String_::concat",[m(r.left),m(r.right)],null)),Ye(r.left,g(d)),p(),d):(p=(e=>{switch(e){case $t.SK.PlusEqualsToken:return $t.SK.PlusToken;case $t.SK.MinusEqualsToken:return $t.SK.MinusToken;case $t.SK.AsteriskEqualsToken:return $t.SK.AsteriskToken;case $t.SK.AsteriskAsteriskEqualsToken:return $t.SK.AsteriskAsteriskToken;case $t.SK.SlashEqualsToken:return $t.SK.SlashToken;case $t.SK.PercentEqualsToken:return $t.SK.PercentToken;case $t.SK.LessThanLessThanEqualsToken:return $t.SK.LessThanLessThanToken;case $t.SK.GreaterThanGreaterThanEqualsToken:return $t.SK.GreaterThanGreaterThanToken;case $t.SK.GreaterThanGreaterThanGreaterThanEqualsToken:return $t.SK.GreaterThanGreaterThanGreaterThanToken;case $t.SK.AmpersandEqualsToken:return $t.SK.AmpersandToken;case $t.SK.BarEqualsToken:return $t.SK.BarToken;case $t.SK.CaretEqualsToken:return $t.SK.CaretToken;default:return $t.SK.Unknown}})(r.operatorToken.kind),(d=at(0,p||r.operatorToken.kind))||x(r.operatorToken,Ot("unsupported operator"),9250),p?We(r.left,d,!1,r.right):(p=Xe(p=d),h=[r.left,r.right],$t.ir.rtcallMask(p,we(h),0,h.map(e=>$(e)))))}}function lt(e){e.statements.forEach(U)}function ct(e){if(!(e.flags&Bt.NodeFlags.Let||e.flags&Bt.NodeFlags.Const))throw jt(9260,Ot("variable needs to be defined using 'let' instead of 'var'"))}function ut(e){if(e.declarationList.flags&Bt.NodeFlags.Const){var r=e.parent&&e.parent.kind==$t.SK.ModuleBlock?sr(e.parent.parent):"?";if("config"==r||"userconfig"==r)for(var n of e.declarationList.declarations){let t=dr(n);if(n.initializer){var n=tt(n.initializer),i=nt(e,"CFG_"+t);if(null==i||0==i)throw jt(9268,Ot("can't find DAL.CFG_{0}",t));"userconfig"==r&&(t="!"+t);{s=void 0;var s={name:t,key:i,value:n};let e=$t.U.lookup(a,s.name);if(e||(e=s,a[s.name]=e),e.value!=s.value)throw jt(9269,Ot("conflicting values for config.{0}",s.name))}}}}Bt.isInAmbientContext(e)||(ct(e.declarationList),e.declarationList.declarations.forEach(U))}function F(e,t=null){if(!t&&Wt()&&e.kind==$t.SK.BinaryExpression){var r=e,n=$t.U.lookup($t.thumbCmpMap,at(0,r.operatorToken.kind));if(n)return $t.ir.rtcall(n,[$(r.left),$(r.right)])}return t=t||$(e),Kt()?t:$t.ir.rtcall("numops::toBoolDecr",[t])}function B(e){e=Ht(e);return{fortop:".fortop."+e,cont:".cont."+e,brk:".brk."+e,ret:".ret."+e}}function dt(e){if(!e)return 1;switch(e.kind){case $t.SK.Identifier:case $t.SK.StringLiteral:case $t.SK.NumericLiteral:case $t.SK.NullKeyword:return 1}}function pt(e){return $(e)}function ht(e){dt(e)||(h(e),e=pt(e),k.emitExpr(e),k.stackEmpty())}function mt(r){if(r.initializer&&r.initializer.kind==$t.SK.VariableDeclarationList){var n=r.initializer;if(1!=n.declarations.length)x(r,"only a single variable may be used to iterate a collection");else{ct(n);var i=cr(r.expression);let e="",t="";if(pr(i))e="String_::charAt",t="String_::length";else{if(!ar(i))return void x(r.expression,"cannot use for...of with this expression");e="Array_::getAt",t="Array_::length"}l(n.declarations[0]);var i=Tt(n.declarations[0]),n=($t.U.assert(!!i||!T.finalPass),k.stackEmpty(),k.mkLocalUnnamed()),s=(k.emitExpr(n.storeByRef($(r.expression))),k.mkLocalUnnamed()),a=(k.emitExpr(s.storeByRef(L(0))),k.stackEmpty(),h(r),B(r)),o=(k.emitLblDirect(a.fortop),$t.ir.rtcall(t,[n.loadCore()])),o=Ze("numops::lt_bool",s.load(),fr(o));k.emitJmpZ(a.brk,o);i&&(k.emitExpr(i.storeByRef($t.ir.rtcall(e,[n.loadCore(),(o=s.loadCore(),zt()?$t.ir.rtcall("pxt::toInt",[o]):o)]))),h(r.initializer)),Fe(),U(r.statement),k.emitLblDirect(a.cont),k.emitExpr(s.storeByRef(Ze("numops::adds",s.load(),L(1)))),k.emitJmp(a.fortop),k.emitLblDirect(a.brk),k.emitExpr(n.storeByRef(L(void 0)))}}else x(r,"only a single variable may be used to iterate a collection")}function gt(e){h(e);let r=e.label?e.label.text:null,n=e.kind==$t.SK.BreakStatement,i=0;var t,s=function e(t){return t?r&&t.kind==$t.SK.LabeledStatement&&t.label.text==r?t.statement:t.kind==$t.SK.SwitchStatement&&!r&&n||!r&&Bt.isIterationStatement(t,!1)?t:(i+=yt(t),e(t.parent)):null}(e);s?(t=B(s),ft(i),e.kind==$t.SK.ContinueStatement?Bt.isIterationStatement(s,!1)?k.emitJmp(t.cont):ie(e,9231,Ot("continue on non-loop")):e.kind==$t.SK.BreakStatement?k.emitJmp(t.brk):$t.oops()):ie(e,9230,Ot("cannot find outer loop"))}function ft(e=1){for(;e--;)k.emitExpr(P("pxt::endTry",[]))}function _t(){jt(9282,Ot("jumps (return, break, continue) through finally blocks not supported yet"))}function yt(e){let t=0;var r;return e.kind==Bt.SyntaxKind.Block&&e.parent&&(e.parent.kind==Bt.SyntaxKind.CatchClause?e.parent.parent.finallyBlock&&(t++,_t()):e.parent.kind==Bt.SyntaxKind.TryStatement&&(r=e.parent).tryBlock==e&&(r.catchClause&&t++,r.finallyBlock)&&(t++,_t())),t}function bt(e){for(;e;){if((e=>{switch(e.kind){case $t.SK.WhileStatement:case $t.SK.ForInStatement:case $t.SK.ForOfStatement:case $t.SK.ForStatement:case $t.SK.DoStatement:return 1;default:return}})(e))return 1;e=e.parent}}function vt(t,r,n){if(t.name.kind===$t.SK.ObjectBindingPattern||t.name.kind==$t.SK.ArrayBindingPattern)return r||(r=t.initializer?$t.ir.shared($(t.initializer)):I(t),n=cr(t.initializer||t)),t.name.elements.forEach(e=>vt(e,r,n)),k.stackEmpty(),null;if(!xe(t))return null;if(et(t))return null;let e;if(Be((e=tr(t)?(le(t),ce(t)):k.mkLocal(t,S(t))).info),e.isByRefLocal()&&k.emitExpr(e.storeDirect($t.ir.rtcall("pxtrt::mklocRef",[]))),oe(cr(t)),t.kind===$t.SK.BindingElement){h(t);var[i,,]=function t(r,n,i){let s=r.parent.parent;if(s.kind===$t.SK.BindingElement){let e=t(s,n,i);n=e[0],i=e[1]}{if(r.parent.kind==$t.SK.ArrayBindingPattern){let e=r.parent.elements.indexOf(r),t=(r.dotDotDotToken&&jt(9203,Ot("spread operator not supported yet")),kr(i,e));return[P("Array_::getAt",[n,$t.ir.numlit(e)]),t]}{let e=r.propertyName||r.name;return kt(r,n,i,e.text)}}}(t,r,n);k.emitExpr(e.storeByRef(i))}else if(t.initializer){if(h(t),tr(t)){let e=ir(t).jres;e&&("true"==e&&(e=nr(Rt,t)),(i=$t.U.lookup(p.jres||{},e))?H=i:jt(9270,Ot("resource '{0}' not found in any .jres file",e)))}t.initializer,k.emitExpr(e.storeByRef($(t.initializer))),H=null,k.stackEmpty()}else bt(t)&&(h(t),k.emitExpr(e.storeByRef(L(void 0))),k.stackEmpty());return e}function Tt(e){return vt(e,null,null)}function kt(e,t,r,n){var i=Rt.getPropertyOfType(r,n),i=($t.U.assert(!!i,"field sym"),Rt.getTypeOfSymbolAtLocation(i,e));let s;return[s=lr(r)?(r=w(r),$t.ir.op(Dt.FieldAccess,[t],qe(r,R(r,n)))):Ne([t],{ifaceIndex:C(n,!0),callLocationIndex:It(e),noArgs:!0}),i]}function xt(e){T;var t=e,r=e=>{e&&e.kind==$t.SK.ClassDeclaration&&jt(9261,Ot("Interface with same name as a class not supported"))};if(r(t.symbol.valueDeclaration),t.symbol.declarations&&t.symbol.declarations.forEach(r),t.heritageClauses)for(var n of t.heritageClauses)n.token===$t.SK.ExtendsKeyword&&or(cr(n.types[0]))&&jt(9262,Ot("Extending a class by an interface not supported."));r=ir(e);r.autoCreate&&(V[r.autoCreate]=!0)}function Et(t,e){var r=Pt;Ft++;try{Pt=null;var n=e(t);return Pt&&jt(Mt,Pt),Pt=r,Ft--,n}catch(e){return Ft--,Pt=null,ie(t,e.ksErrorCode||9200,e.message),pxt.debug(e.stack),null}}function $(e,t=!0){var r;return t&&e.cachedIR?e.cachedIR:(r=Et(e,St)||L(void 0),t&&e.needsIRCache?(e.cachedIR=$t.ir.shared(r),e.cachedIR):r)}function St(e){e=(e=>{switch(e.kind){case $t.SK.NullKeyword:var t=Vt(e).valueOverride;return t?t:L(null);case $t.SK.TrueKeyword:return L(!0);case $t.SK.FalseKeyword:return L(!1);case $t.SK.TemplateHead:case $t.SK.TemplateMiddle:case $t.SK.TemplateTail:case $t.SK.NumericLiteral:case $t.SK.StringLiteral:case $t.SK.NoSubstitutionTemplateLiteral:return(e=>{if(e.kind==$t.SK.NumericLiteral)return e.imageLiteral?$t.ir.ptrlit(e.imageLiteral,e.jsLit):L(parseFloat(e.text));if(Jt(e))return _e(e.text);throw $t.oops()})(e);case $t.SK.TaggedTemplateExpression:return Le(e);case $t.SK.PropertyAccessExpression:return(e=>{let t=D(e);var r,n=et(t);if(n)return L(n.val);if((t=t.kind==$t.SK.SetAccessor?be(t):t).kind==$t.SK.GetAccessor)return s(e,e,[],null,t);if(t.kind==$t.SK.EnumMember)throw jt(9210,Ot("Cannot compute enum value"));if(t.kind==$t.SK.PropertySignature||t.kind==$t.SK.PropertyAssignment)return s(e,e,[],null,t,e.expression);if(t.kind==$t.SK.PropertyDeclaration||t.kind==$t.SK.Parameter)return Yt(t)?I(t):ve(t)?s(e,e,[],null,t,e.expression):ir(r=R((n=Je(e)).classInfo,n.name)).shim?Ie(r,t,[e.expression]):$t.ir.op(Dt.FieldAccess,[$(e.expression)],n);if(Zt(t)||t.kind==$t.SK.MethodSignature)throw jt(9211,Ot("cannot use method as lambda; did you forget '()' ?"));if(t.kind==$t.SK.FunctionDeclaration)return he(t);if(er(t))return I(t);throw x(e,Ot("Unknown property access for {0}",Gt(t)),9237)})(e);case $t.SK.BinaryExpression:return ot(e);case $t.SK.PrefixUnaryExpression:return(e=>{var t=f(e);if(t)return L(t.val);switch(e.operator){case $t.SK.ExclamationToken:return _r($t.ir.rtcall("Boolean_::bang",[F(e.operand)]));case $t.SK.PlusPlusToken:return We(e.operand,"numops::adds",!1);case $t.SK.MinusMinusToken:return We(e.operand,"numops::subs",!1);case $t.SK.PlusToken:case $t.SK.MinusToken:var r=$(e.operand),n=it(r);return null!=n?L(-n):e.operator==$t.SK.MinusToken?Ze("numops::subs",L(0),r):Ze("numops::subs",r,L(0));case $t.SK.TildeToken:n=$(e.operand),r=it(n);return null!=r?L(~r):P(Xe("numops::bnot"),[n]);default:throw x(e,Ot("unsupported prefix unary operation"),9245)}})(e);case $t.SK.PostfixUnaryExpression:return(e=>{if(Cr(cr(e.operand)))switch(e.operator){case $t.SK.PlusPlusToken:return We(e.operand,"numops::adds",!0);case $t.SK.MinusMinusToken:return We(e.operand,"numops::subs",!0)}throw x(e,Ot("unsupported postfix unary operation"),9246)})(e);case $t.SK.ElementAccessExpression:return Te(e);case $t.SK.ParenthesizedExpression:return(e=>$(e.expression))(e);case $t.SK.TypeAssertionExpression:return(e=>(e.expression,$(e.expression)))(e);case $t.SK.ArrayLiteralExpression:return(e=>{kr(cr(e));var t,r=$t.ir.shared($t.ir.rtcall("Array_::mk",[]));for(t of e.elements){var n=Ce(t)?2:0;k.emitExpr($t.ir.rtcall("Array_::push",[r,$(t)],n))}return r})(e);case $t.SK.NewExpression:return(r=>{if((i=Rt.getTypeAtLocation(r))&&ar(i))throw $t.oops();if(i&&lr(i)){i=D(r.expression);i.kind!=$t.SK.ClassDeclaration&&jt(9221,Ot("new expression only supported on class types"));let t;i=w(cr(r),i);for(let e=i;e&&!(t=Re(e.decl));e=e.baseClassInfo);O(i);var n,i=i.id+"_VT";let e=$t.ir.rtcall("pxt::mkClassInstance",[$t.ir.ptrlit(i,i)]);return t?(e=Ue(e),l(t),i=(r.arguments||[]).slice(0),n=ir(t),Ae(Rt.getResolvedSignature(r),i,n),i=i.map(e=>$(e)),n.shim?$t.ir.rtcall(n.shim,i):(i.unshift(e),k.emitExpr(Oe(t,r,i)),e)):(r.arguments&&r.arguments.length&&jt(9222,Ot("constructor with arguments not found")),e)}throw x(r,Ot("unknown type for new"),9243)})(e);case $t.SK.SuperKeyword:case $t.SK.ThisKeyword:return fe(e);case $t.SK.CallExpression:return(e=>{var t=Rt.getResolvedSignature(e);return s(e,e.expression,e.arguments,t)})(e);case $t.SK.FunctionExpression:case $t.SK.ArrowFunction:return Ge(e);case $t.SK.Identifier:return ge(e);case $t.SK.ConditionalExpression:return(e=>{var t=k.mkLabel("condexprz"),r=k.mkLabel("condexprfin");return k.emitJmp(t,F(e.condition),$t.ir.JmpMode.IfZero),k.emitJmp(r,$(e.whenTrue),$t.ir.JmpMode.Always),k.emitLbl(t),k.emitJmp(r,$(e.whenFalse),$t.ir.JmpMode.Always),k.emitLbl(r),Ve()})(e);case $t.SK.AsExpression:return(e=>(e.expression,$(e.expression)))(e);case $t.SK.TemplateExpression:return ye(e);case $t.SK.ObjectLiteralExpression:return(e=>{let i=$t.ir.shared($t.ir.rtcall("pxtrt::mkMap",[]));return e.properties.forEach(e=>{$t.assert(!e.questionToken);let t,r;if(e.kind==$t.SK.ShorthandPropertyAssignment){$t.assert(!e.equalsToken&&!e.objectAssignmentInitializer),t=e.name.text;var n=Rt.getShorthandAssignmentValueSymbol(e),n=n&&n.valueDeclaration&&n.valueDeclaration.name;if(!n||n.kind!=$t.SK.Identifier)throw x(e);r=ge(n)}else{if(e.name.kind==$t.SK.ComputedPropertyName)return n=e.name.expression,void k.emitExpr(M("pxtrt::mapSetByString",[g(i,!0),n,e.initializer],null));t=e.name.kind==$t.SK.StringLiteral?e.name.text:e.name.getText(),r=$(e.initializer)}n=$t.target.isNative?$t.ir.numlit(C(t)):$t.ir.ptrlit(null,JSON.stringify(t)),e=[i,n,r];k.emitExpr($t.ir.rtcall($t.target.isNative?"pxtrt::mapSet":"pxtrt::mapSetByString",e))}),i})(e);case $t.SK.TypeOfExpression:return(e=>M("pxt::typeOf",[e.expression],null))(e);case Bt.SyntaxKind.DeleteExpression:return(e=>{let t,r;if(e.expression.kind==$t.SK.PropertyAccessExpression){var n=e.expression;t=n.expression,r=g(_e(n.name.text))}else{if(e.expression.kind!=$t.SK.ElementAccessExpression)throw jt(9276,Ot("expression not supported as argument to 'delete'"));n=e.expression;t=n.expression,r=n.argumentExpression}if(or(e=cr(t)))throw jt(9277,Ot("'delete' not supported on class types"));if(ar(e))throw jt(9277,Ot("'delete' not supported on array"));return M("pxtrt::mapDeleteByString",[t,r],null)})(e);default:return x(e),null}})(e);if(e.isExpr())return e;throw new Error("expecting expression")}function Ct(e){var t=Vt(e);if(t.usedNodes){v=!1;for(var r of $t.U.values(t.usedNodes))l(r);for(var n of t.usedActions)n(T);v=!0}else tr(e)||Bt.isClassDeclaration(e)?(v=!1,(b=t).usedNodes=null,b.usedActions=null,tr(e)&&!et(e)&&le(e),U(e),v=!0):((b=t).usedNodes={},b.usedActions=[],U(e),b=null)}function U(e){Et(e,wt)}function wt(n){switch(n.kind){case $t.SK.SourceFile:return void n.statements.forEach(U);case $t.SK.InterfaceDeclaration:return xt(n);case $t.SK.VariableStatement:return ut(n);case $t.SK.ModuleDeclaration:return void U(n.body);case $t.SK.EnumDeclaration:return;case $t.SK.FunctionDeclaration:case $t.SK.Constructor:case $t.SK.MethodDeclaration:return void Ge(n);case $t.SK.ExpressionStatement:return void ht(n.expression);case $t.SK.Block:case $t.SK.ModuleBlock:return lt(n);case $t.SK.VariableDeclaration:return Tt(n),void Fe();case $t.SK.IfStatement:return h(u=n),d=k.mkLabel("else"),k.emitJmpZ(d,F(u.expression)),U(u.thenStatement),p=k.mkLabel("afterif"),k.emitJmp(p),k.emitLbl(d),u.elseStatement&&U(u.elseStatement),void k.emitLbl(p);case $t.SK.WhileStatement:return h(d=n),u=B(d),k.emitLblDirect(u.cont),h(d.expression),k.emitJmpZ(u.brk,F(d.expression)),U(d.statement),k.emitJmp(u.cont),void k.emitLblDirect(u.brk);case $t.SK.DoStatement:return h(p=n),c=B(p),k.emitLblDirect(c.cont),U(p.statement),h(p.expression),k.emitJmpZ(c.brk,F(p.expression)),k.emitJmp(c.cont),void k.emitLblDirect(c.brk);case $t.SK.ForStatement:return(c=n).initializer&&c.initializer.kind==$t.SK.VariableDeclarationList?(ct(c.initializer),c.initializer.declarations.forEach(U)):ht(c.initializer),h(c),l=B(c),k.emitLblDirect(l.fortop),c.condition&&(h(c.condition),k.emitJmpZ(l.brk,F(c.condition))),U(c.statement),k.emitLblDirect(l.cont),ht(c.incrementor),k.emitJmp(l.fortop),void k.emitLblDirect(l.brk);case $t.SK.ForOfStatement:return mt(n);case $t.SK.ContinueStatement:case $t.SK.BreakStatement:return gt(n);case $t.SK.LabeledStatement:return o=B((l=n).statement),U(l.statement),void k.emitLblDirect(o.brk);case $t.SK.ReturnStatement:{o=n;h(o);let e=null,t=(o.expression?e=$(o.expression):ur(k.action)&&(e=L(void 0)),0);for(let e=o;e&&e!=k.action;e=e.parent)t+=yt(e);ft(t),k.emitJmp(B(k.action).ret,e,$t.ir.JmpMode.Always);return}case $t.SK.ClassDeclaration:return(s=w(null,a=n)).isUsed&&T.usedClassInfos.indexOf(s)<0&&T.usedClassInfos.push(s),void a.members.forEach(U);case $t.SK.PropertyDeclaration:case $t.SK.PropertyAssignment:return void(Yt(s=n)?Tt(s):s.initializer&&(s=w(cr(s.parent)),T.finalPass)&&s.isUsed&&!s.ctor&&jt(9209,Ot("class field initializers currently require an explicit constructor")));case $t.SK.SwitchStatement:{a=n;h(a);var e=B(a);let i,s=$t.ir.shared($(a.expression)),r=a.caseBlock.clauses.map(e=>{var t,r,n=k.mkLabel("switch");return e.kind==$t.SK.CaseClause?(t=$((r=e).expression),r=Ce(r.expression)?1:0,r=$t.ir.rtcallMask(Xe("pxt::switch_eq"),r,0,[t,s]),k.emitJmp(n,r,$t.ir.JmpMode.IfNotZero,s)):e.kind==$t.SK.DefaultClause?($t.assert(!i,"!defaultLabel"),i=n):$t.oops(),n});i?k.emitJmp(i,s):k.emitJmp(e.brk,s),a.caseBlock.clauses.forEach((e,t)=>{k.emitLbl(r[t]),e.statements.forEach(U)}),k.emitLblDirect(e.brk);return}case $t.SK.TypeAliasDeclaration:return;case Bt.SyntaxKind.TryStatement:return e=e=>P("pxt::beginTry",[$t.ir.ptrlit(e.lblName,e)]),h(t=n),(r=k.mkLabel("catch")).lblName="_catch_"+Ht(t),(i=k.mkLabel("finally")).lblName="_finally_"+Ht(t),t.finallyBlock&&k.emitExpr(e(i)),t.catchClause&&k.emitExpr(e(r)),k.stackEmpty(),lt(t.tryBlock),k.stackEmpty(),t.catchClause&&(e=k.mkLabel("catchend"),ft(),k.emitJmp(e),k.emitLbl(r),(r=t.catchClause.variableDeclaration)&&(Tt(r),r=ce(r),k.emitExpr(r.storeByRef(P("pxt::getThrownValue",[])))),Fe(),lt(t.catchClause.block),k.emitLbl(e)),void(t.finallyBlock&&(ft(),k.emitLbl(i),lt(t.finallyBlock),k.emitExpr(P("pxt::endFinally",[]))));case Bt.SyntaxKind.ThrowStatement:return h(r=n),void k.emitExpr(P("pxt::throwValue",[$(r.expression)]));case $t.SK.DebuggerStatement:return void h(n);case $t.SK.GetAccessor:case $t.SK.SetAccessor:return void Ge(n);case $t.SK.ImportEqualsDeclaration:case $t.SK.EmptyStatement:case $t.SK.SemicolonClassElement:return;default:x(n)}var t,r,i,a,s,o,l,c,u,d,p}function It(e){return y.procCallLocations.push($t.nodeLocationInfo(e))-1}},$t.isStringType=pr;class Ar{constructor(){this.procs=[],this.globals=[],this.finalPass=!1,this.writeFile=(e,t)=>{},this.usedClassInfos=[],this.numStmts=1,this.commSize=0,this.itEntries=0,this.itFullEntries=0,this.numMethods=0,this.numVirtMethods=0,this.usedChars=new Uint32Array(2048),this.explicitlyUsedIfaceMembers={},this.ifaceMemberMap={},this.strings={},this.hexlits={},this.doubles={},this.otherLiterals=[],this.codeHelpers={},this.lblNo=0}reset(){this.lblNo=0,this.otherLiterals=[],this.strings={},this.hexlits={},this.doubles={},this.numStmts=0}getTitle(){var e=this.name||$t.U.lf("Untitled");return 90<=e.length?e.slice(0,87)+"...":e}addProc(e){$t.assert(!this.finalPass,"!this.finalPass"),this.procs.push(e),e.seqNo=this.procs.length}recordHelper(e,t,r){var n=e=>{e.codeHelpers[t]||(e.codeHelpers[t]=r(e))};n(this),this.recordAction(e,n)}recordAction(e,t){e?e.usedActions&&e.usedActions.push(t):$t.U.oops("no using ctx!")}emitLabelled(e,t,r){var n=$t.U.lookup(t,e);return null!=n?n:(n=r+this.lblNo++,t[e]=n)}emitDouble(e){return this.emitLabelled($t.target.switches.numFloat?(t=e,(r=new Float32Array(1))[0]=t,$t.U.toHex(new Uint8Array(r.buffer))):(t=e,(r=new Float64Array(1))[0]=t,$t.U.toHex(new Uint8Array(r.buffer))),this.doubles,"_dbl");var t,r}emitString(t){if(!this.finalPass)for(let e=0;e<t.length;++e){var r=t.charCodeAt(e);128<=r&&(this.usedChars[r>>5]|=1<<(31&r))}return this.emitLabelled(t,this.strings,"_str")}emitHexLiteral(e){return this.emitLabelled(e,this.hexlits,"_hexlit")}setPerfCounters(e){if(!$t.target.switches.profile)return[];let t=e.slice();return this.procs.forEach(e=>{e.perfCounterName&&($t.U.assert($t.target.switches.profile),e.perfCounterNo=t.length,t.push(e.perfCounterName))}),t}}function hr(e){if(e.modifiers&&e.parent.kind==$t.SK.Constructor)for(var t of e.modifiers)if(t.kind==$t.SK.PrivateKeyword||t.kind==$t.SK.PublicKeyword||t.kind==$t.SK.ProtectedKeyword)return!0;return!1}function mr(e){return e.flags&Bt.TypeFlags.Union?e.types.every(e=>mr(e)):!!(e.flags&(Bt.TypeFlags.NumberLike|Bt.TypeFlags.EnumLike|Bt.TypeFlags.BooleanLike))}function gr(e,t,r,n){var i=n(e);return t&&e.recordAction(r,n),i}$t.Binary=Ar,$t.isCtorField=hr}})(ts=ts||{}),!function(ts){var pxtc;!function(pxtc){function getTsCompilerOptions(e){var t=ts.getDefaultCompilerOptions();return t.target=ts.ScriptTarget.ES5,t.module=ts.ModuleKind.None,t.noImplicitAny=!0,t.noImplicitReturns=!0,t.allowUnreachableCode=!0,Object.assign(Object.assign({},t),null==e?void 0:e.tsCompileOptions)}function nodeLocationInfo(e){var t=ts.getSourceFileOfNode(e),r=e.getStart?e.getStart():e.pos,{line:n,character:i}=ts.getLineAndCharacterOfPosition(t,r),{line:s,character:a}=ts.getLineAndCharacterOfPosition(t,e.end);return{start:r,length:e.end-r,line:n,column:i,endLine:s,endColumn:a,fileName:t.fileName}}function patchUpDiagnostics(e,t=!1){t=(e=t?e.filter(e=>5012!==e.code):e).filter(e=>1148==e.code);return(e=0<t.length?t:e).map(e=>{var t;return e.file?(t=ts.getLineAndCharacterOfPosition(e.file,e.start),1148==(t={code:e.code,start:e.start,length:e.length,line:t.line,column:t.character,messageText:ts.flattenDiagnosticMessageText(e.messageText,"\n"),category:e.category,fileName:e.file.fileName}).code&&(t.messageText=pxtc.Util.lf("all symbols in top-level scope are always exported; please use a namespace if you want to export only some")),t):{code:e.code,start:e.start,length:e.length,line:0,column:0,messageText:ts.flattenDiagnosticMessageText(e.messageText,"\n"),category:e.category,fileName:"?"}})}function py2tsIfNecessary(e){if(e.target.preferredEditor==pxt.PYTHON_PROJECT_NAME)return pxtc.transpile.pyToTs(e)}function mkCompileResult(){return{outfiles:{},diagnostics:[],success:!1,times:{}}}function storeGeneratedFiles(e,t){for(var r of e.generatedFiles||[])t.outfiles[r]=e.fileSystem[r]}function runConversionsAndStoreResults(e,t){var r=pxtc.U.cpuUs(),n=(t=t||mkCompileResult(),py2tsIfNecessary(e)),n=(storeGeneratedFiles(e,t=n?Object.assign(Object.assign({},t),{diagnostics:n.diagnostics,sourceMap:n.sourceMap,globalNames:n.globalNames}):t),e.sourceFiles||(e.sourceFiles=Object.keys(e.fileSystem)),e.sourceFiles.indexOf(pxt.MAIN_TS)),n=(0<=n&&(e.sourceFiles.splice(n,1),e.sourceFiles.push(pxt.MAIN_TS)),e.sourceFiles.indexOf(pxt.TUTORIAL_CODE_STOP));return 0<=n&&(e.sourceFiles.splice(n,1),e.sourceFiles.push(pxt.TUTORIAL_CODE_STOP)),t.times.conversions=pxtc.U.cpuUs()-r,t}function timesToMs(e){for(var t of Object.keys(e.times))e.times[t]=Math.round(e.times[t])/1e3}function buildProgram(e,i){let s={};for(var t in e.fileSystem)s[normalizePath(t)]=e.fileSystem[t];var r=getTsCompilerOptions(e),n={getSourceFile:(e,t,r)=>{e=normalizePath(e);let n="";return s.hasOwnProperty(e)?n=s[e]:r&&r("File not found: "+e),null==n&&(r("File not found: "+e),n=""),ts.createSourceFile(e,n,t,!0)},fileExists:e=>(e=normalizePath(e),s.hasOwnProperty(e)),getCanonicalFileName:e=>e,getDefaultLibFileName:()=>"no-default-lib.d.ts",writeFile:(e,t,r,n)=>{i.outfiles[e]=t},getCurrentDirectory:()=>".",useCaseSensitiveFileNames:()=>!0,getNewLine:()=>"\n",readFile:e=>(e=normalizePath(e),s[e]||""),directoryExists:e=>!0,getDirectories:()=>[]},a=e.sourceFiles.filter(e=>pxtc.U.endsWith(e,".ts"));return ts.createProgram(a,r,n)}function isPxtModulesFilename(e){return pxtc.U.startsWith(e,"pxt_modules/")}function compile(opts,service){pxtc.compilerHooks||(pxtc.compilerHooks={},opts.target.compilerExtension&&eval(opts.target.compilerExtension)),pxtc.compilerHooks.init&&pxtc.compilerHooks.init(opts,service);let startTime=pxtc.U.cpuUs(),res=mkCompileResult(),program;if(service)storeGeneratedFiles(opts,res),program=service.getProgram();else{if(runConversionsAndStoreResults(opts,res),0<res.diagnostics.length)return res;program=buildProgram(opts,res)}let entryPoint=opts.sourceFiles.filter(e=>pxtc.U.endsWith(e,".ts")).pop().replace(/.*\//,"");if(res.diagnostics=patchUpDiagnostics(program.getSyntacticDiagnostics(),opts.ignoreFileResolutionErrors),0<res.diagnostics.length)opts.forceEmit&&(pxt.debug("syntactic errors, forcing emit"),pxtc.compileBinary(program,opts,res,entryPoint));else{res.diagnostics=patchUpDiagnostics(program.getOptionsDiagnostics().concat(pxtc.Util.toArray(program.getGlobalDiagnostics())),opts.ignoreFileResolutionErrors);let semStart=pxtc.U.cpuUs(),emitStart=(0==res.diagnostics.length&&(res.diagnostics=patchUpDiagnostics(program.getSemanticDiagnostics(),opts.ignoreFileResolutionErrors)),pxtc.U.cpuUs());if(res.times["typescript-syn"]=semStart-startTime,res.times["typescript-sem"]=emitStart-semStart,res.times.typescript=emitStart-startTime,opts.ast&&(res.ast=program),opts.ast||opts.forceEmit||0==res.diagnostics.length){let binOutput=pxtc.compileBinary(program,opts,res,entryPoint);res.times.compilebinary=pxtc.U.cpuUs()-emitStart,res.diagnostics=res.diagnostics.concat(patchUpDiagnostics(binOutput.diagnostics))}0==res.diagnostics.length&&(res.success=!0);for(var f of opts.sourceFiles)pxtc.Util.startsWith(f,"built/")&&(res.outfiles[f.slice(6)]=opts.fileSystem[f]);res.times.all=pxtc.U.cpuUs()-startTime,pxt.tickEvent("compile",res.times)}return res}function decompile(e,t,r,n=!1){var i=e.getSourceFile(r),r=(pxtc.annotate(e,r,pxtc.target||pxt.appTarget&&pxt.appTarget.compile),pxtc.getApiInfo(e,t.jres)),r=pxtc.getBlocksInfo(r,t.bannedCategories),n={snippetMode:t.snippetMode||!1,alwaysEmitOnStart:t.alwaysDecompileOnStart,includeGreyBlockMessages:n,generateSourceMap:void 0!==t.generateSourceMap?t.generateSourceMap:!!t.ast,allowedArgumentTypes:t.allowedArgumentTypes||["number","boolean","string"],errorOnGreyBlocks:!!t.errorOnGreyBlocks},[t,,]=pxtc.decompiler.buildRenameMap(e,i,{declarations:"variables",takenNames:{}});return pxtc.decompiler.decompileToBlocks(r,i,n,t)}function decompileSnippets(e,t,r=!1){var e=pxtc.getApiInfo(e,t.jres),n=pxtc.getBlocksInfo(e,t.bannedCategories),i=new pxtc.decompiler.RenameMap([]),s={snippetMode:t.snippetMode||!1,alwaysEmitOnStart:t.alwaysDecompileOnStart,includeGreyBlockMessages:r,generateSourceMap:void 0!==t.generateSourceMap?t.generateSourceMap:!!t.ast,allowedArgumentTypes:t.allowedArgumentTypes||["number","boolean","string"],errorOnGreyBlocks:!!t.errorOnGreyBlocks};let a;var o=[];if(t.sourceTexts)for(let e=0;e<t.sourceTexts.length;e++){t.fileSystem[pxt.MAIN_TS]=t.sourceTexts[e],t.fileSystem[pxt.MAIN_BLOCKS]="";var l=getTSProgram(t,a),c=l.getSourceFile(pxt.MAIN_TS),c=pxtc.decompiler.decompileToBlocks(n,c,s,i);o.push(c.outfiles[pxt.MAIN_BLOCKS]),a=l}return o}function getTSProgram(e,t){let i={},s={};for(var r in e.fileSystem)s[normalizePath(r)]=e.fileSystem[r];let a=getTsCompilerOptions(e);var n={getSourceFile:(e,t,r)=>{e=normalizePath(e);let n="";return s.hasOwnProperty(e)?n=s[e]:r&&r("File not found: "+e),null==n&&(r("File not found: "+e),n=""),ts.createSourceFile(e,n,t,!0,void 0,a)},fileExists:e=>(e=normalizePath(e),s.hasOwnProperty(e)),getCanonicalFileName:e=>e,getDefaultLibFileName:()=>"no-default-lib.d.ts",writeFile:(e,t,r,n)=>{i[e]=t},getCurrentDirectory:()=>".",useCaseSensitiveFileNames:()=>!0,getNewLine:()=>"\n",readFile:e=>(e=normalizePath(e),s[e]||""),directoryExists:e=>!0,getDirectories:()=>[]};e.sourceFiles||(e.sourceFiles=Object.keys(e.fileSystem));let o=e.sourceFiles.filter(e=>pxtc.U.endsWith(e,".ts"));var l=o.filter(e=>e!=pxt.MAIN_TS),l=(o.length>l.length&&(o=l).push(pxt.MAIN_TS),o.indexOf(pxt.TUTORIAL_CODE_STOP)),l=(0<=l&&(o.splice(l,1),o.push(pxt.TUTORIAL_CODE_STOP)),ts.createProgram(o,a,n,t));return pxtc.annotate(l,pxt.MAIN_TS,pxtc.target||pxt.appTarget&&pxt.appTarget.compile),l}function normalizePath(e){e=e.replace(/\\/g,"/");let t=[];return e.split("/").forEach(e=>{".."===e&&t.length?t.pop():"."!==e&&t.push(e)}),t.join("/")}pxtc.getTsCompilerOptions=getTsCompilerOptions,pxtc.nodeLocationInfo=nodeLocationInfo,pxtc.patchUpDiagnostics=patchUpDiagnostics,pxtc.py2tsIfNecessary=py2tsIfNecessary,pxtc.storeGeneratedFiles=storeGeneratedFiles,pxtc.runConversionsAndStoreResults=runConversionsAndStoreResults,pxtc.timesToMs=timesToMs,pxtc.isPxtModulesFilename=isPxtModulesFilename,pxtc.compile=compile,pxtc.decompile=decompile,pxtc.decompileSnippets=decompileSnippets,pxtc.getTSProgram=getTSProgram}(pxtc=ts.pxtc||(ts.pxtc={}))}(ts=ts||{}),(h=>{{var e=h.elf||(h.elf={});let u=["type","offset","vaddr","paddr","filesz","memsz","flags","align"],d=h.HF2.read32,p=h.HF2.read16;e.parse=function(s){1179403647!=d(s,0)&&h.U.userError("no magic"),1!=s[4]&&h.U.userError("not 32 bit"),1!=s[5]&&h.U.userError("not little endian"),1!=s[6]&&h.U.userError("bad version"),2!=p(s,16)&&h.U.userError("wrong object type"),40!=p(s,18)&&h.U.userError("not ARM");let a=d(s,28),o=(d(s,32),0==a&&h.U.userError("expecting program headers"),p(s,42));var e,t=p(s,44),t=h.U.range(t).map(e=>{var t,r=a+e*o,n={},e=r;for(t of u)n[t]=d(s,r),r+=4;var i=n;return i._filepos=e,i});let r=s.length+1;for(;15&r;)r++;let n=0;for(e of t)1==e.type&&(n=Math.max(n,e.vaddr+e.memsz));var i,l=(n+4096-1&-4096)+(4095&r);let c=-1;for(i of t)4==i.type&&(c=i._filepos);return{imageMemStart:l,imageFileStart:r,phOffset:c,template:s}},e.patch=function(t,e){var r=new Uint8Array(t.imageFileStart+e.length),t=(r.fill(0),h.U.memcpy(r,0,t.template),h.U.memcpy(r,t.imageFileStart,e),{_filepos:t.phOffset,type:1,offset:t.imageFileStart,vaddr:t.imageMemStart,paddr:t.imageMemStart,filesz:e.length,memsz:e.length,flags:5,align:4096});{var n,i=r,s=t;let e=s._filepos;for(n of u)h.HF2.write32(i,e,s[n]||0),e+=4}return r}}})(pxt=pxt||{}),(h=>{{var e=h.esp||(h.esp={});let c=h.HF2.read32,u=h.HF2.read16,d=[{name:"esp32",chipId:0,memmap:[{from:0,to:65536,id:"PADDING"},{from:1061158912,to:1065353216,id:"DROM"},{from:1065353216,to:1069547520,id:"EXTRAM_DATA"},{from:1073217536,to:1073225728,id:"RTC_DRAM"},{from:1073283072,to:1073741824,id:"BYTE_ACCESSIBLE"},{from:1073405952,to:1073741824,id:"DRAM"},{from:1073610752,to:1073741820,id:"DIRAM_DRAM"},{from:1073741824,to:1074200576,id:"IROM"},{from:1074200576,to:1074233344,id:"CACHE_PRO"},{from:1074233344,to:1074266112,id:"CACHE_APP"},{from:1074266112,to:1074397184,id:"IRAM"},{from:1074397184,to:1074528252,id:"DIRAM_IRAM"},{from:1074528256,to:1074536448,id:"RTC_IRAM"},{from:1074593792,to:1077936128,id:"IROM"},{from:1342177280,to:1342185472,id:"RTC_DATA"}]},{name:"esp32-s2",chipId:2,memmap:[{from:0,to:65536,id:"PADDING"},{from:1056964608,to:1073217536,id:"DROM"},{from:1062207488,to:1073217536,id:"EXTRAM_DATA"},{from:1073340416,to:1073348608,id:"RTC_DRAM"},{from:1073340416,to:1073741824,id:"BYTE_ACCESSIBLE"},{from:1073340416,to:1074208768,id:"MEM_INTERNAL"},{from:1073414144,to:1073741824,id:"DRAM"},{from:1073741824,to:1073848576,id:"IROM_MASK"},{from:1073872896,to:1074200576,id:"IRAM"},{from:1074200576,to:1074208768,id:"RTC_IRAM"},{from:1074266112,to:1082130432,id:"IROM"},{from:1342177280,to:1342185472,id:"RTC_DATA"}]},{name:"esp32-s3",chipId:4,memmap:[{from:0,to:65536,id:"PADDING"},{from:1006632960,to:1023410176,id:"DROM"},{from:1023410176,to:1040187392,id:"EXTRAM_DATA"},{from:1611653120,to:1611661312,id:"RTC_DRAM"},{from:1070104576,to:1070596096,id:"BYTE_ACCESSIBLE"},{from:1070104576,to:1077813248,id:"MEM_INTERNAL"},{from:1070104576,to:1070596096,id:"DRAM"},{from:1073741824,to:1073848576,id:"IROM_MASK"},{from:1077346304,to:1077805056,id:"IRAM"},{from:1611653120,to:1611661312,id:"RTC_IRAM"},{from:1107296256,to:1115684864,id:"IROM"},{from:1342177280,to:1342185472,id:"RTC_DATA"}]},{name:"esp32-c3",chipId:5,memmap:[{from:0,to:65536,id:"PADDING"},{from:1006632960,to:1015021568,id:"DROM"},{from:1070071808,to:1070465024,id:"DRAM"},{from:1070104576,to:1070596096,id:"BYTE_ACCESSIBLE"},{from:1072693248,to:1072824320,id:"DROM_MASK"},{from:1073741824,to:1074135040,id:"IROM_MASK"},{from:1107296256,to:1115684864,id:"IROM"},{from:1077395456,to:1077805056,id:"IRAM"},{from:1342177280,to:1342185472,id:"RTC_IRAM"},{from:1342177280,to:1342185472,id:"RTC_DRAM"},{from:1611653120,to:1611661312,id:"MEM_INTERNAL2"}]}],p=8;function o(e){return`0x${e.addr.toString(16)} 0x${e.data.length.toString(16)} bytes; `+(e.isDROM?"drom ":"")+(e.isMapped?"mapped ":"")+h.U.toHex(e.data.slice(0,20))+"..."}function l(t){(t=m(t)).segments.sort((e,t)=>e.addr-t.addr),h.debug("esp padding:\n"+t.segments.map(o).join("\n")+"\n");var e,r=t.segments.filter(e=>e.isMapped);let n=t.segments.filter(e=>!e.isMapped),i=(t.segments=[],t.header.length);for(e of r){var s=e.addr+e.data.length&65535;s<36&&(s=new Uint8Array(36-s),e.data=h.U.uint8ArrayConcat([e.data,s]))}for(;0<r.length;){let e=r[0];var a=(e=>{let t=e.addr-p&65535,r=t-i&65535;return 0==r?0:((r-=p)<0&&(r+=65536),r)})(e);if(0<a)e=(e=>{var t,r;return!n.length||e<=p?{addr:0,isMapped:!1,isDROM:!1,data:new Uint8Array(e)}:(t=n[0],r={addr:t.addr,isMapped:t.isMapped,isDROM:t.isDROM,data:t.data.slice(0,e)},t.data=t.data.slice(e),t.addr+=r.data.length,0==t.data.length&&n.shift(),r)})(a);else{if((i+p&65535)!=(65535&e.addr))throw new Error(`pad oops 0 ${i}+${p} != ${e.addr} (mod mask)`);r.shift()}if(t.segments.push(e),3&(i+=p+e.data.length))throw new Error("pad oops 1")}return t.segments=t.segments.concat(n),h.debug("esp padded:\n"+t.segments.map(o).join("\n")+"\n"),t}function t(r){if(233!=r[0])throw new Error("ESP: invalid magic: "+r[0]);let n=24,t=u(r,12),e=d.find(e=>e.chipId==t);if(!e)throw new Error("ESP: unknown chipid: "+t);var i={header:r.slice(0,n),chipName:e.name,segments:[]},s=r[1];for(let e=0;e<s;++e){let t=c(r,n);var a=c(r,n+4),o=(n+=p,r.slice(n,n+a));if(o.length!=a)throw new Error("too short file");n+=a,l(t,"PADDING")||((a=i.segments.filter(e=>e.addr+e.data.length==t)[0])?a.data=h.U.uint8ArrayConcat([a.data,o]):i.segments.push({addr:t,isMapped:l(t,"DROM")||l(t,"IROM"),isDROM:l(t,"DROM"),data:o}))}return i;function l(t,r){return e.memmap.some(e=>e.id==r&&e.from<=t&&t<=e.to)}}function m(e){e=h.U.flatClone(e);return e.segments=e.segments.map(h.U.flatClone),e}e.toBuffer=function(e,t=!0){let r=(e=l(e)).header.length;for(var n of e.segments)r+=p+n.data.length;r=r+16&-16;let i=new Uint8Array(r),s=(i.set(e.header),i[1]=e.segments.length,e.header.length),a=239;for(var o of e.segments){h.HF2.write32(i,s,o.addr),h.HF2.write32(i,s+4,o.data.length),i.set(o.data,s+p),s+=p+o.data.length;for(let e=0;e<o.data.length;++e)a^=o.data[e]}if(i[i.length-1]=a,t){i[23]=1;let e=ts.pxtc.BrowserImpl.sha256buffer(i);i=h.U.uint8ArrayConcat([i,h.U.fromHex(e)])}else i[23]=0;return i},e.parseBuffer=t,e.parseB64=function(e){return t(h.U.stringToUint8Array(atob(e.join(""))))},e.cloneStruct=m}})(pxt=pxt||{}),(l=>{var e;{var y=l.pxtc||(l.pxtc={});let f,a=((e=f=f||{})[e.None=0]="None",e[e.Whitespace=1]="Whitespace",e[e.Identifier=2]="Identifier",e[e.Keyword=3]="Keyword",e[e.Operator=4]="Operator",e[e.CommentLine=5]="CommentLine",e[e.CommentBlock=6]="CommentBlock",e[e.NewLine=7]="NewLine",e[e.Literal=8]="Literal",e[e.Tree=9]="Tree",e[e.Block=10]="Block",e[e.EOF=11]="EOF",""),_=l.SyntaxKind;function b(e){switch(e){case _.CommaToken:return 1;case _.EqualsToken:case _.PlusEqualsToken:case _.MinusEqualsToken:case _.AsteriskEqualsToken:case _.AsteriskAsteriskEqualsToken:case _.SlashEqualsToken:case _.PercentEqualsToken:case _.LessThanLessThanEqualsToken:case _.GreaterThanGreaterThanEqualsToken:case _.GreaterThanGreaterThanGreaterThanEqualsToken:case _.AmpersandEqualsToken:case _.BarEqualsToken:case _.CaretEqualsToken:return 1;case _.QuestionToken:case _.ColonToken:case _.BarBarToken:case _.AmpersandAmpersandToken:case _.BarToken:case _.CaretToken:case _.AmpersandToken:return 1;case _.EqualsEqualsToken:case _.ExclamationEqualsToken:case _.EqualsEqualsEqualsToken:case _.ExclamationEqualsEqualsToken:return 1;case _.LessThanToken:case _.GreaterThanToken:case _.LessThanEqualsToken:case _.GreaterThanEqualsToken:case _.InstanceOfKeyword:case _.InKeyword:case _.AsKeyword:return 1;case _.LessThanLessThanToken:case _.GreaterThanGreaterThanToken:case _.GreaterThanGreaterThanGreaterThanToken:return 1;case _.PlusToken:case _.MinusToken:return 1;case _.AsteriskToken:case _.SlashToken:case _.PercentToken:case _.AsteriskAsteriskToken:case _.DotToken:return 1;default:return}}let o=!1;function s(e){a=e;let r=l.createScanner(l.ScriptTarget.Latest,!1,l.LanguageVariant.Standard,e,e=>{var t=r.getTextPos();pxt.log("scanner error",t,e.message)});var t=[];let n=0,i=-1;for(;;){let e=r.scan();e==_.CloseBraceToken&&n==i&&(i=-1,e=r.reScanTemplateToken());var s={kind:(e=>{switch(e){case _.EndOfFileToken:return f.EOF;case _.SingleLineCommentTrivia:return f.CommentLine;case _.MultiLineCommentTrivia:return f.CommentBlock;case _.NewLineTrivia:return f.NewLine;case _.WhitespaceTrivia:return f.Whitespace;case _.ShebangTrivia:case _.ConflictMarkerTrivia:return f.CommentBlock;case _.NumericLiteral:case _.StringLiteral:case _.RegularExpressionLiteral:case _.NoSubstitutionTemplateLiteral:case _.TemplateHead:case _.TemplateMiddle:case _.TemplateTail:return f.Literal;case _.Identifier:return f.Identifier;default:return e<_.Identifier?f.Operator:f.Keyword}})(e=(e=(o&&e==_.SlashToken||e==_.SlashEqualsToken)&&(s=r.reScanSlashToken())==_.RegularExpressionLiteral?s:e)==_.GreaterThanToken?r.reScanGreaterToken():e),synKind:e,lineNo:0,pos:r.getTokenPos(),text:r.getTokenText()};if(e==_.OpenBraceToken&&n++,e==_.CloseBraceToken&&--n<0&&(n=-1e7),t.push(s),e!=_.TemplateHead&&e!=_.TemplateMiddle||(i=n),s.kind==f.EOF)break}return{tokens:t,braceBalance:n}}function d(e,t){for(;e[t]&&e[t].kind==f.Whitespace;)t++;return t}function p(r){let n=[];var i,s;n.push({synKind:_.EndOfFileToken,token:{children:[]}});for(let t=0;t<r.length;++t){var a=r[t];let e=n[n.length-1];if(e.token.children.push(a),a.kind===f.Operator)switch(a.synKind){case _.OpenBraceToken:case _.OpenParenToken:case _.OpenBracketToken:s=(i=a).synKind+1,i.children=[],i.kind=f.Tree,n.push({synKind:s,token:i});break;case _.CloseBraceToken:case _.CloseParenToken:case _.CloseBracketToken:for(e.token.children.pop();;){if((e=n.pop()).synKind==a.synKind){e.token.endToken=a;break}if(0==n.length||e.synKind==_.CloseBraceToken){n.push(e);break}}}}return n[0].token.children}function v(){return{kind:f.EOF,synKind:_.EndOfFileToken,pos:0,lineNo:0,text:""}}function T(e,t){return{kind:f.Whitespace,synKind:_.WhitespaceTrivia,pos:e.pos-t.length,lineNo:e.lineNo,text:t}}function k(e){return{kind:f.Block,synKind:_.OpenBraceToken,pos:e[0].pos,lineNo:e[0].lineNo,stmts:[{tokens:e}],text:"{",endToken:null}}function x(e){return{kind:f.Tree,synKind:_.WhitespaceTrivia,pos:e[0].pos,lineNo:e[0].lineNo,children:e,endToken:null,text:""}}function E(n,i,s=null){let a=[],o=0,l,c=!1;for(n=n.concat([v()]);n[o].kind!=f.EOF;){var e=o;g(),y.Util.assert(o>e,"Error at "+n[o].text),(e=>{if(0!=(e=i?S(e):e).length){e.forEach(u),e=function r(n){let i=[];let s=0;for(;s<n.length;)if(n[s].blockSpanLength){let e=n.slice(s,s+n[s].blockSpanLength),t=!!e[0].blockSpanIsVirtual;delete e[0].blockSpanLength,delete e[0].blockSpanIsVirtual,s+=e.length,e=r(e),t?i.push(x(e)):(i.push(T(e[0]," ")),i.push(k(S(e))))}else i.push(n[s++]);return i}(e);if(i&&0<a.length){var t=a[a.length-1].tokens[0].synKind,r=e[0].synKind;if(t==_.IfKeyword&&r==_.ElseKeyword||t==_.TryKeyword&&r==_.CatchKeyword||t==_.TryKeyword&&r==_.FinallyKeyword||t==_.CatchKeyword&&r==_.FinallyKeyword)return e.unshift(T(e[0]," ")),y.Util.pushRange(a[a.length-1].tokens,e)}a.push({tokens:e})}})(n.slice(e,o))}return a;function u(e){e.kind==f.Tree&&(e.children=y.Util.concat(E(e.children,!1,e).map(e=>e.tokens)))}function d(){for(;;)switch(o++,n[o].kind){case f.Whitespace:case f.CommentBlock:case f.CommentLine:case f.NewLine:break;default:return}}function p(){for(;n[o].kind==f.Whitespace;)o++;n[o].kind==f.NewLine&&o++}function h(){y.Util.assert(n[o].synKind==_.OpenBraceToken);var e=n[o],t=(y.Util.assert(e.kind==f.Tree),n[o]);t.stmts=E(e.children,!0,l),delete e.children,t.kind=f.Block,o++,c=!0}function m(){var e=o+1;d(),n[o].synKind==_.OpenBraceToken?(h(),p()):(g(),n[e].blockSpanLength=o-e)}function g(){for(;;){let e=n[o];var t=o;if(l=e,c=!1,e.kind==f.EOF)return;if(i&&e.synKind==_.SemicolonToken)return o++,void p();if(e.synKind==_.EqualsGreaterThanToken){if(d(),n[o].synKind==_.OpenBraceToken){h();continue}{var r=o;g();let e=o;for(;n[e].kind==f.NewLine;)e--;return n[r].blockSpanLength=e-r,void(n[r].blockSpanIsVirtual=!0)}}if(i&&b(e.synKind)){r=o;if(d(),!(e=>{if(e)switch(e.synKind){case _.IfKeyword:case _.ElseKeyword:case _.LetKeyword:case _.ConstKeyword:case _.VarKeyword:case _.DoKeyword:case _.WhileKeyword:case _.SwitchKeyword:case _.CaseKeyword:case _.DefaultKeyword:case _.ForKeyword:case _.ReturnKeyword:case _.BreakKeyword:case _.ContinueKeyword:case _.TryKeyword:case _.CatchKeyword:case _.FinallyKeyword:case _.DeleteKeyword:case _.FunctionKeyword:case _.ClassKeyword:case _.YieldKeyword:case _.DebuggerKeyword:return 1;default:return}})(n[o]))continue;o=r}if(i&&e.kind==f.NewLine){if(d(),b((e=n[o]).synKind)&&e.synKind!=_.PlusToken&&e.synKind!=_.MinusToken)continue;return void(o=t+1)}if(e.synKind==_.OpenBraceToken&&s&&s.synKind==_.ClassKeyword){let e=o-1;for(;0<=e&&n[e].kind==f.Whitespace;)e--;if(e<0||n[e].synKind!=_.EqualsToken)return o--,void m()}switch(y.Util.assert(t==o),e.synKind){case _.ForKeyword:case _.WhileKeyword:case _.IfKeyword:case _.CatchKeyword:if(d(),n[o].synKind!=_.OpenParenToken)continue;return void m();case _.DoKeyword:if(m(),o--,d(),n[o].synKind!=_.WhileKeyword)return;o++;continue;case _.ElseKeyword:if(d(),n[o].synKind==_.IfKeyword)continue;return o=t,void m();case _.TryKeyword:case _.FinallyKeyword:return void m();case _.ClassKeyword:case _.NamespaceKeyword:case _.ModuleKeyword:case _.InterfaceKeyword:case _.FunctionKeyword:for(;;)switch(o++,n[o].kind){case f.EOF:return;case f.Tree:if(n[o].synKind==_.OpenBraceToken)return void(o--,m())}return}y.Util.assert(!c,"forgot continue/return after expectBlock"),o++}}}function t(e){return e&&(e.kind==f.Whitespace||e.kind==f.NewLine)}function h(t){var r=[];let n=!1;for(let e=0;e<t.length;++e)t[e=n?d(t,e):e]&&(r.push(t[e]),n=t[e].kind==f.NewLine);return r}function S(e){for(e=e.slice(0);t(e[0]);)e.shift();for(;t(e[e.length-1]);)e.pop();return e}function m(e){var t=[];let r=0,n=v();for(e=e.concat([v()]);r<e.length;){var i=e[r=d(e,r)];if(i.kind==f.EOF)break;var s=d(e,r+1);if(i.kind==f.NewLine&&e[s].synKind==_.OpenBraceToken)r=s;else{let e=!0;var a=0==t.length?(s=i,{kind:f.NewLine,synKind:_.NewLineTrivia,pos:s.pos,lineNo:s.lineNo,text:"\n"}):t[t.length-1];switch(a.synKind){case _.ExclamationToken:case _.TildeToken:case _.DotToken:e=!1;break;case _.PlusToken:case _.MinusToken:case _.PlusPlusToken:case _.MinusMinusToken:a.isPrefix&&(e=!1)}switch(i.synKind){case _.DotToken:case _.CommaToken:case _.NewLineTrivia:case _.ColonToken:case _.SemicolonToken:case _.OpenBracketToken:e=!1;break;case _.PlusPlusToken:case _.MinusMinusToken:a.kind!=f.Tree&&a.kind!=f.Identifier&&a.kind!=f.Keyword||(e=!1);case _.PlusToken:case _.MinusToken:n.kind!=f.EOF&&!b(n.synKind)&&n.synKind!=_.SemicolonToken||(i.isPrefix=!0);break;case _.OpenParenToken:if(a.kind==f.Identifier&&(e=!1),a.kind==f.Keyword)switch(a.synKind){case _.IfKeyword:case _.ForKeyword:case _.WhileKeyword:case _.SwitchKeyword:case _.ReturnKeyword:case _.ThrowKeyword:case _.CatchKeyword:break;default:e=!1}}(e=a.kind==f.NewLine?!1:e)&&t.push(T(i," ")),t.push(i),i.kind!=f.NewLine&&(n=i),r++}}return t}function g(i,e){if(e.synKind==_.NoSubstitutionTemplateLiteral&&/^`[\s\.#01]*`$/.test(e.text)){var s=e.text.slice(1,e.text.length-1).split("\n").map(e=>e.replace(/\s/g,"")).filter(e=>!!e);if(!(s.length<4||5<s.length)){let r=Math.floor((Math.max(...s.map(e=>e.length))+2)/5),n=(r<=0&&(r=1),"`\n");for(let t=0;t<5;++t){let e=s[t]||"";for(;e.length<5*r;)e+=".";e=(e=(e=e.replace(/0/g,".")).replace(/1/g,"#")).replace(/...../g,e=>"/"+e),n+=i+e.replace(/./g,e=>" "+e).replace(/\//g," ").slice(3)+"\n"}n+=i+"`",e.text=n}}}y.toStr=function e(t){return Array.isArray(t)?"[[ "+t.map(e).join("  ")+" ]]":"string"==typeof t.text?JSON.stringify(t.text):t+""},y.format=function(e,t){e=E(p(((r,n)=>{var i=[];let e=!0,s=1;for(let t=0;t<r.length;++t){if(e){var a=t;if(r[t=d(r,t)].kind==f.NewLine){let e=!1;0<=n&&r[t].pos>=n&&(n=-1,e=!0),i.push({text:"",kind:f.CommentLine,pos:r[t].pos,lineNo:s,synKind:_.SingleLineCommentTrivia,isCursor:e})}else t=a}i.push(r[t]),r[t].lineNo=s,r[t].kind==f.NewLine?(e=!0,s++):e=!1,0<=n&&r[t].pos>=n&&(n=-1)}return i})(s(e).tokens,t)),!0);let a="",o="",r=-1,n=0;return e.forEach(c),e.forEach(e=>e.tokens.forEach(i)),-1==r&&(r=o.length),{formatted:o,pos:r};function i(e){var t;e.kind==f.Tree?((t=e).synKind,_.OpenBraceToken,t.children.forEach(i)):e.kind==f.Block&&e.stmts.forEach(e=>e.tokens.forEach(i))}function l(e,t){n==e.lineNo?t():(n=e.lineNo,e=a,a+="    ",t(),a=e)}function c(e){let t=h(e.tokens);(1!=t.length||t[0].isCursor||""!=t[0].text)&&(o+=a,l(t[0],()=>{!function i(s){s=m(s);for(let n=0;n<s.length;++n){let r=s[n];switch(g(a,r),u(r),r.kind){case f.Tree:let e=r;l(r,()=>{i(h(e.children))}),e.endToken&&u(e.endToken);break;case f.Block:let t=r;0==t.stmts.length?o+=" ":(o+="\n",t.stmts.forEach(c),o+=a.slice(4)),t.endToken?u(t.endToken):o+="}";break;case f.NewLine:s[n+1]&&s[n+1].kind==f.CommentLine&&""==s[n+1].text&&!s[n+1].isCursor||(n==s.length-1?o+=a.slice(4):o+=a);break;case f.Whitespace:}}}(t)}),"\n"==o[o.length-1])||(o+="\n")}function u(e){-1==r&&e.pos+e.text.length>=t&&(r=o.length+(t-e.pos)),o+=e.text}}}})(ts=ts||{}),(T=>{{var E=T.pxtc||(T.pxtc={});let v;{var a=v=E.hexfile||(E.hexfile={});a.asmTotalSource="";let o={},t=[];function S(){return{commBase:0,funcInfo:{},codeStartIdx:-1,codePaddingSize:0,sha:null,codeStartAddrPadded:void 0,hexlines:void 0,jmpStartAddr:void 0,jmpStartIdx:void 0,codeStartAddr:void 0,elfInfo:void 0,espInfo:void 0,topFlashAddr:0}}let k=S();function C(e){let t="",r=0;for(;r<e.length;r+=2)t=e[r]+e[r+1]+t;return E.assert(r==e.length),t}function w(e){if(!(e=e.replace(/^[\s:]/,"")))return[];let t=[];if(e.replace(/([a-f0-9][a-f0-9])/gi,e=>(t.push(parseInt(e,16)),"")))throw E.oops("bad bytes "+e);return t}function I(e){return e.flashCodeAlign||1024}a.getCommBase=function(){return k.commBase},a.getStartAddress=function(){return k.codeStartAddrPadded},a.getTopFlashAddress=function(){return k.topFlashAddr},a.setupInlineAssembly=function(e){o={};var t,r=e.sourceFiles.filter(e=>E.U.endsWith(e,".asm"));a.asmTotalSource="";let n=0;for(t of r){var i=e.fileSystem[t],i=(i.replace(/^\s*(\w+):/gm,(e,t)=>(o[t]=!0,"")),".object inlineasm\n.section code\n@stackmark func\n@scope user"+n+++"\n"+i+"\n@stackempty func\n@scope\n");a.asmTotalSource+=i}},a.parseHexBytes=w,a.parseHexRecord=function(e){return{len:(e=w(e))[0],addr:e[1]<<8|e[2],type:e[3],data:e.slice(4,e.length-1),checksum:e[e.length-1]}},a.flashCodeAlign=I;let x="0108010842424242010801083ed8e98d";function l(e){return k.funcInfo[e]}function A(){let e=k.sha?k.sha.slice(0,16):"";for(;e.length<16;)e+="0";return e.toUpperCase()}function D(e){let t=0,r=":";return e.forEach(e=>t+=e),e.push(255&-t),e.forEach(e=>r+=("0"+e.toString(16)).slice(-2)),r.toUpperCase()}a.setupFor=function(l,r,n){if(!(k=t.find(e=>e.sha==r.sha))){k=S(),(t=10<t.length?[]:t).push(k);let a=r.functions,o=(k.commBase=r.commBase||0,k.sha=r.sha,r.hexinfo.hex);if(k.hexlines=o,E.target.nativeType==E.NATIVE_TYPE_VM){k.codeStartAddr=0,k.codeStartAddrPadded=0,k.jmpStartAddr=-1,k.jmpStartIdx=-1;for(var e of a)(k.funcInfo[e.name]=e).value=16777215;if(E.target.useESP){var i=pxt.esp.parseB64(o);let n=E.U.fromHex(x);var s=i.segments.filter(e=>e.isDROM);E.U.assert(1==s.length);let t=!1;var c=s[0];k.codeStartAddr=c.addr+c.data.length,k.codeStartAddrPadded=k.codeStartAddr+255&-256,k.codePaddingSize=k.codeStartAddrPadded-k.codeStartAddr,pxt.debug(`user code start: 0x${k.codeStartAddrPadded.toString(16)}; dromlen=${c.data.length} pad=`+k.codePaddingSize);for(let e=0;e<c.data.length;e+=32)if(((t,r)=>{for(let e=0;e<n.length;++e)if(t[r+e]!=n[e])return!1;return!0})(c.data,e)){t=!0,e+=n.length,k.topFlashAddr=pxt.HF2.read32(c.data,e);var u,d=e+=4;for(u of r.vmPointers||[])"0"!=u&&(u=u.replace(/^&/,""),k.funcInfo[u]={name:u,argsFmt:[],value:pxt.HF2.read32(c.data,e)},e+=4);pxt.HF2.write32(c.data,d,k.codeStartAddrPadded);break}E.U.assert(t||0==(r.vmPointers||[]).length),k.espInfo=i,k.codeStartAddrPadded=0}}else{if(o.length<=2)(s=E.U.fromHex(o[0]))[2]<=2&&96==s[3]?(i=s.length+4096-1&-4096,k.elfInfo={template:s,imageMemStart:1610612736+i,imageFileStart:i,phOffset:-1e3}):k.elfInfo=pxt.elf.parse(s),k.codeStartAddr=k.elfInfo.imageMemStart,k.codeStartAddrPadded=k.elfInfo.imageMemStart,(i=o[0].indexOf(x))<0&&E.oops("no jmp table in elf"),k.jmpStartAddr=i/2,k.jmpStartIdx=-1,s=o[0].slice(i+32,i+40),k.topFlashAddr=parseInt(C(s),16),v(o[0].slice(i+40,i+40+8*a.length+16));else{var p,h=o;for(let e=0;e<h.length;++e)"2"==h[e][8]&&(p=/^:02....02(....)..$/.exec(h[e]),E.U.assert(!!p),p=16*parseInt(p[1],16),E.U.assert(0==(65535&p)),h[e]=D([2,0,0,4,0,p>>16]));let e=0,t="0000",i=0,s=0;k.codeStartAddr=0;for(var m=()=>{if(!k.codeStartAddr){var e=w(o[s]),t=16-(i+e[0]&15)&15;if(t)if(15&e[2]){var r=i+e[0],n=[t,r>>8,255&r,0];for(let e=0;e<t;++e)n.push(0);s++,o.splice(s,0,D(n)),k.codeStartAddr=r+t}else{if(16!=e[0]){for(e.pop(),e[0]=16;e.length<20;)e.push(0);o[s]=D(e)}k.codeStartAddr=i+16}else k.codeStartAddr=i+e[0];k.codeStartIdx=s+1;r=I(l),r=(k.codeStartAddrPadded=(k.codeStartAddr&~(r-1))+r,k.codeStartAddrPadded-k.codeStartAddr);E.assert(0==(15&r)),k.codePaddingSize=r}};e<o.length;++e){var g,f,_=/:02000004(....)/.exec(o[e]);_&&(t=_[1]),(_=/^:..(....)00/.exec(o[e]))&&(0<=k.jmpStartIdx&&k.jmpStartIdx+1==e&&(g=/^:..(....)00(.{4,})/.exec(o[e]))&&(f=l.shortPointers?4:8,g=C(g[2].slice(0,f)),k.topFlashAddr=parseInt(g,16)),f=parseInt(t+_[1],16),!l.flashUsableEnd&&i&&65536<f-i&&m(),l.flashUsableEnd&&O(l,n)<=f&&m(),s=e,i=f),/^:00000001/.test(o[e])&&m(),/^:10....000108010842424242010801083ED8E98D/.exec(o[e])&&(k.jmpStartAddr=i,k.jmpStartIdx=e)}pxt.debug(`code start: ${k.codeStartAddrPadded}, jmptbl: `+k.jmpStartAddr),k.jmpStartAddr||E.oops("No hex start"),k.codeStartAddr||E.oops("No hex end"),k.funcInfo={};for(let e=k.jmpStartIdx+1;e<o.length;++e){var y,b=/^:..(....)00(.{4,})/.exec(o[e]);if(b)if(e===k.jmpStartIdx+1?(y=l.shortPointers?4:8,v(b[2].slice(y))):v(b[2]),0==a.length)break}function v(t){for(var r=l.shortPointers?4:8;t.length>=r;){var n=t.slice(0,r);let e=parseInt(C(n),16);t=t.slice(r);var i=a.shift();if(!i)break;k.funcInfo[i.name]=i,e||E.U.oops("No value for "+i.name+" / "+n),0==i.argsFmt.length?e^=1:l.runtimeIsARM||l.nativeType!=E.NATIVE_TYPE_THUMB||1&e||E.U.oops("Non-thumb addr for "+i.name+" / "+n),i.value=e}}function T(){a.length&&E.oops("premature EOF in hex file; missing: "+a.map(e=>e.name).join(", "))}}T()}}},a.validateShim=function(e,t,r,n,i){if("TD_ID"!=t&&"TD_NOOP"!=t&&"ENUM_GET"!=t&&!E.U.lookup(o,t)){var s=e+`(...) (shim=${t})`,a=l(t);if(a){n?"V"==a.argsFmt[0]&&E.U.userError("expecting function for "+s):"V"!=a.argsFmt[0]&&E.U.userError("expecting procedure for "+s);for(let e=0;e<i.length;++e)a.argsFmt[e+1]||E.U.userError("excessive parameters passed to "+s);i.length!=a.argsFmt.length-1&&E.U.userError(`not enough arguments for ${s} (got ${i.length}; fmt=${a.argsFmt.join(",")})`)}else E.U.userError("function not found: "+s)}},a.lookupFunc=l,a.lookupFunctionAddr=function(e){return"_pxt_comm_base"==e?k.commBase:(e=l(e))?e.value:null},a.hexTemplateHash=A,a.hexPrelude=function(){return`    .startaddr 0x${k.codeStartAddrPadded.toString(16)}
`},a.hexBytes=D,a.patchHex=function(r,n,e,i){let s=k.hexlines.slice(0,k.codeStartIdx);r.target.useESP||(h=2*n.length+7>>3,E.assert(h<64e3,"program too large, bytes: "+2*n.length),n[17]=h,n[20]=r.commSize);var t=[];for(let e=0;e<k.codePaddingSize>>1;++e)t.push(0);n=t.concat(n);let a=0;function o(t,e){var r=[16,e>>8&255,255&e,0];for(let e=0;e<8;++e)r.push(255&(t[a]||0)),r.push((t[a]||0)>>>8),a++;return r}var l=[16912,0,65535&k.codeStartAddrPadded,k.codeStartAddrPadded>>>16],c=A();for(let e=0;e<4;++e)l.push(parseInt(C(c.slice(4*e,4*e+4)),16));var u=i?E.UF2.newBlockFile(E.target.uf2Family):null;if(k.elfInfo){var d=new Uint8Array(2*n.length);for(let e=0;e<n.length;++e)pxt.HF2.write16(d,2*e,n[e]);var p=pxt.elf.patch(k.elfInfo,d);for(let e=0;e<l.length;++e)pxt.HF2.write16(p,2*e+k.jmpStartAddr,l[e]);if(!u||r.target.switches.rawELF)return[E.U.uint8ArrayToString(p)];{let e=r.name||"pxt";return e=e.replace(/[^a-zA-Z0-9\-\.]+/g,"_"),u.filename="Projects/"+e+".elf",E.UF2.writeBytes(u,0,p),[E.UF2.serializeFile(u)]}}if(k.espInfo){var h=pxt.esp.cloneStruct(k.espInfo),i=h.segments.find(e=>e.isDROM);let t=i.data.length;var m=new Uint8Array(t+2*n.length+255&-256);m.set(i.data);for(let e=0;e<n.length;++e)pxt.HF2.write16(m,t,n[e]),t+=2;i.data=m;i=pxt.esp.toBuffer(h);return u?(E.UF2.writeBytes(u,0,i),N(u,r),[E.UF2.serializeFile(u)]):[E.U.uint8ArrayToString(i)]}if(u){if(E.UF2.writeHex(u,s),E.UF2.writeBytes(u,k.jmpStartAddr,o(l,k.jmpStartIdx).slice(4)),r.checksumBlock){var g,f=[];for(g of r.checksumBlock)f.push(255&g,g>>8);E.UF2.writeBytes(u,r.target.flashChecksumAddr,f)}}else s[k.jmpStartIdx]=D(o(l,k.jmpStartAddr)),r.checksumBlock&&E.U.oops("checksum block in HEX not implemented yet");a=0,e&&(s=[]);let _=k.codeStartAddr,y=_-16>>16;for(;a<n.length;)u?E.UF2.writeBytes(u,_,o(n,_).slice(4)):(_>>16!=y&&(y=_>>16,s.push(D([2,0,0,4,y>>8,255&y]))),s.push(D(o(n,_)))),_+=16;if(e||(h=k.hexlines.slice(k.codeStartIdx),u?E.UF2.writeHex(u,h):E.Util.pushRange(s,h)),!u&&r.target.moveHexEof){for(;!s[s.length-1];)s.pop();":00000001FF"==s[s.length-1]&&s.pop()}if(r.packedSource)if(u)N(u,r);else{let e=0;for(let t=0;t<r.packedSource.length;t+=16){var b=[16,e>>8&255,255&e,14];for(let e=0;e<16;++e)b.push(255&(r.packedSource.charCodeAt(t+e)||0));s.push(D(b)),e+=16}}return!u&&r.target.moveHexEof&&s.push(":00000001FF"),u?[E.UF2.serializeFile(u)]:s}}function N(r,n){if(n.packedSource){let e=r.currPtr+4096&-256;var i=new Uint8Array(256);for(let t=0;t<n.packedSource.length;t+=256){for(let e=0;e<256;++e)i[e]=n.packedSource.charCodeAt(t+e);E.UF2.writeBytes(r,e,i,E.UF2.UF2_FLAG_NOFLASH),e+=256}}}E.hexDump=function(n,e=0){function i(e,t=8){let r=e.toString(16);for(;r.length<t;)r="0"+r;return r}let s="";for(let r=0;r<n.length;r+=16){s+=i(e+r)+": ";let t="";for(let e=0;e<16;e++){0==(3&e)&&(s+=" ");var a=n[r+e];null==a?s+="   ":(s+=i(a,2)+" ",t+=32<=a&&a<127?String.fromCharCode(a):".")}s+=" "+t+"\n"}return s},E.asmline=function(e){return 0<=e.indexOf("\n")?(e=e.replace(/^\s*/gm,"").replace(/^(.*)$/gm,(e,t)=>";"==t[0]&&" "==t[1]||/:\*$/.test(t)?t:"    "+t))+"\n":(e=/(^[\s;])|(:$)/.test(e)?e:"    "+e)+"\n"},E.firstMethodOffset=function(){return 9};let r=[21078089,22513679,15655169,18636881,19658081,21486649,21919277,20041213,20548751,16180187,18361627,19338023,19772677,16506547,23530697,22998697,21225203,19815283,23679599,19822889,21136133,19540043,21837031,18095489,23924267,23434627,22582379,21584111,22615171,23403001,19640683,19998031,18460439,20105387,17595791,16482043,23199959,18881641,21578371,22765747,20170273,16547639,16434589,21435019,20226751,19506731,21454393,23224541,23431973,23745511];function _(s){let a=32;E.U.assert(E.U.unique(s,e=>""+e).length==s.length,"non unique");for(let i=2;;i<<=1)if(a--,!(i<s.length)){let e=-1,t=-1,n;for(var o of r){var l=o<<8|a,c=new Uint16Array(i+E.vtLookups+1);E.U.assert(0==(1&c.length));let r=0;var u,d=[];for(u of s){E.U.assert(0<u);var p=Math.imul(u,l)>>>a;d.push(p);let t=!1;for(let e=0;e<E.vtLookups;e++){if(!c[p+e]){t=!0,c[p+e]=u;break}r++}if(!t){r=-1;break}}(-1==e||e>r)&&(e=r,t=l,n=c)}if(0<=e)return{mult:t,mapping:n,size:i}}}function k(e,t,r,n){var i=_(e.itable.map(e=>e.idx));let s=E.target.shortPointers?".short":".word",a=`
        .object ${e.id}_VT
        .balign 4
${e.id}_VT:
        .short ${4*e.allfields.length+4}  ; size in bytes
        .byte ${pxt.ValTypeObject}, ${pxt.VTABLE_MAGIC} ; magic
        ${s} ${e.id}_IfaceVT
        .short ${e.classNo} ; class-id
        .short 0 ; reserved
        .word ${i.mult} ; hash-mult
`;var o,l=e=>{"0"!=e&&(e+="@fn"),a+=`        ${s} ${e}
`},c=(l("pxt::RefRecord_destroy"),l("pxt::RefRecord_print"),l("pxt::RefRecord_scan"),l("pxt::RefRecord_gcsize"),e.toStringMethod);l(c?c.vtLabel():"0");for(o of e.vtable)l(o.label()+"_nochk");a+=`
        .balign ${E.target.shortPointers?2:4}
${e.id}_IfaceVT:
`;var u;let d=2*i.mapping.length,p="",h=d,m={};for(u of e.itable){m[u.idx+""]=h;var g=u.proc?u.proc.isGetter()?1:2:0;p=(p+=`  .short ${u.idx}, ${g} ; ${u.name}
`)+`  .word ${u.proc?u.proc.vtLabel()+"@fn":u.info}
`,h+=8,u.setProc&&(p=(p+=`  .short ${u.idx}, 0 ; set ${u.name}
`)+`  .word ${u.setProc.vtLabel()}@fn
`,h+=8)}p+="  .word 0, 0 ; the end\n",h+=8;var f=i.mapping;for(let e=0;e<f.length;++e)r.itEntries++,f[e]&&r.itFullEntries++;return a=(a+="  .short "+E.U.toArray(f).map((e,t)=>(m[e+""]||d)-2*t).join(", ")+"\n")+p+"\n"}E.vtLookups=3,E.computeHashMultiplier=_,E.vtableToAsm=k;let b=["GC"];function c(t,e,r){let n=`
    .short ${t.globalsWords}   ; num. globals
    .short 0 ; patched with number of 64 bit words resulting from assembly
    .word _pxt_config_data
    .short 0 ; patched with comm section size
    .short ${t.nonPtrGlobals} ; number of globals that are not pointers (they come first)
    .word _pxt_iface_member_names
    .word _pxt_lambda_trampoline@fn
    .word _pxt_perf_counters
    .word _pxt_restore_exception_state@fn
    .word ${t.emitString(t.getTitle())} ; name
`,i=null;i=new E.ThumbSnippets;var s,a,o,l,c,u=t.setPerfCounters(b),d=(t.procs.forEach(e=>{e=new E.ProctoAssembler(i,t,e);n+="\n"+e.getAssembly()+"\n"}),new E.ProctoAssembler(i,t,null));d.emitHelpers(),n=(n+="\n"+d.getAssembly()+"\n")+v.asmTotalSource+"_code_end:\n\n",E.U.iterMap(t.codeHelpers,(e,t)=>{n+=`    .section code
`+`    .object _code_helper_${t}
`+t+`:
`+e+`
`}),n=n+i.arithmetic()+"_helpers_end:\n\n",t.usedClassInfos.forEach(e=>{n+=k(e,0,t)}),n=(n+=`
.balign 4
.object _pxt_iface_member_names
_pxt_iface_member_names:
`)+`    .word ${t.ifaceMembers.length}
`;let p=0;for(s of t.ifaceMembers){var h=t.emitString(s);n+=`    .word ${h}  ; ${p++} .${s}
`}n=(n+=`    .word 0
`)+"_vtables_end:\n\n"+`
.balign 4
.object _pxt_config_data
_pxt_config_data:
`;for(a of r.configData||[])n+=`    .word ${a.key}, ${a.value}  ; ${a.name}=${a.value}
`;n+=`    .word 0

`;var m=i,g=t;for(o of E.U.unique(g.ifaceMembers.concat(Object.keys(g.strings)),e=>e))g.otherLiterals.push(m.string_literal(g.strings[o],o));for(l of Object.keys(g.doubles)){var f=g.doubles[l];g.otherLiterals.push(`
.object ${f}
.balign 4
${f}: ${m.obj_header("pxt::number_vt")}
        .hex ${l}
`)}for(c of Object.keys(g.hexlits))g.otherLiterals.push(m.hex_literal(g.hexlits[c],c)),g.otherLiterals.push();n=(n=n+t.otherLiterals.join("")+`
.balign 4
.section code
.object _perf_counters
_pxt_perf_counters:
`)+`    .word ${u.length}
`;let _="";for(let e=0;e<u.length;++e){var y=".perf"+e;n+=`    .word ${y}
`,_+=y+`: .string ${JSON.stringify(u[e])}
`}return n=n+_+"_literals_end:\n"}function o(e){let t;return(t=e.nativeType==E.NATIVE_TYPE_VM?new E.assembler.VMFile(new E.vm.VmProcessor(e)):new E.assembler.File(new E.thumb.ThumbProcessor)).ei.testAssembler(),e.switches.noPeepHole&&(t.disablePeepHole=!0),e.switches.size&&(t.codeSizeStats=!0),t.lookupExternalLabel=v.lookupFunctionAddr,t.normalizeExternalLabel=e=>{var t=v.lookupFunc(e);return t?t.name:e},t}function u(e){if(0<e.errors.length){let r="";throw e.errors.forEach(e=>{var t=/^user(\d+)/.exec(e.scope);t&&(parseInt(t[1]),r=(r+=E.U.lf("At inline assembly:\n"))+e.message)}),r&&(pxt.log(E.U.lf("errors in inline assembly")),pxt.log(r)),new Error(e.errors[0].message)}}function O(e,t){let r=0;t.configData&&(n=t.configData.find(e=>"SETTINGS_SIZE_DEFL"===e.name),t=t.configData.find(e=>"SETTINGS_SIZE"===e.name),r=t?t.value:n?n.value:0);var n,t=v.getTopFlashAddress();return(0<t?t:e.flashUsableEnd||e.flashEnd)-r}let s=!(E.processorInlineAssemble=function(e,t){var r=o(e),n=(r.disablePeepHole=!0,r.emit(t),u(r),[]);for(let e=0;e<r.buf.length;e+=2)n.push(((r.buf[e+1]||0)<<16|r.buf[e])>>>0);return n});function x(e,t,r,n){var i=o(e);return i.emit(r),r=`; Interface tables: ${t.itFullEntries}/${t.itEntries} (${Math.round(100*t.itFullEntries/t.itEntries)}%)
`+`; Virtual methods: ${t.numVirtMethods} / ${t.numMethods}
`+i.getSource(!s,t.numStmts,O(e,n)),u(i),{src:r,buf:i.buf,thumbFile:i}}function d(n,i,s,e){var a=s.extinfo.disabledDeps,o=(n=a?v.hexPrelude()+`
`+`; compilation disabled on this variant due to ${s.extinfo.disabledDeps}
`+`.hex 718E3B92C615A841C49866C975EE5197
`+`.string "${s.extinfo.disabledDeps}"`:`; start
${v.hexPrelude()}
    .hex 708E3B92C615A841C49866C975EE5197 ; magic number
    .hex ${v.hexTemplateHash()} ; hex template hash
    .hex 873266330af9dbdb ; replaced in binary by program hash
`+n,s.embedBlob&&(i.packedSource=((e,t)=>{(e=E.Util.toUTF8(e)).length,t.length;let r="A//";return(r=(r+=E.U.uint8ArrayToString([255&e.length,e.length>>8,255&t.length,t.length>>8,0,0,0,0]))+e+t).length%2&&(r+="\0"),r})(s.embedMeta,T.pxtc.decodeBase64(s.embedBlob)),!i.target.noSourceInFlash)&&i.packedSource.length<4e4&&(n+=(t=>{let r="";for(let e=0;e<t.length;++e){var n=255&t.charCodeAt(e);r+=n<=15?"0"+n.toString(16):n.toString(16)}return`
    .balign 16
    .object _stored_program
_stored_program: .hex ${r}
`})(i.packedSource),i.packedSource=null),v.flashCodeAlign(s.target));if(!a&&s.target.flashChecksumAddr){let e=0;for(;o>1<<e;)e++;var l=parseInt(v.hexTemplateHash().slice(8,16),16),c=v.getStartAddress()/o,l=4294967040&l|e;let t=0,r=c;s.target.flashChecksumAddr<v.getStartAddress()&&(t=Math.ceil((s.target.flashChecksumAddr+32)/o),r-=t),n+=`
    .balign 4
__end_marker:
    .word ${l}

; ------- this will get removed from the final binary ------
__flash_checksums:
    .word 0x87eeb07c ; magic
    .word __end_marker ; end marker position
    .word ${l} ; end marker
    ; template region
    .short ${t}, ${r}
    .word 0x${v.hexTemplateHash().slice(0,8)}
    ; user region
    .short ${c}, 0xffff
    .hex 87326633 ; replaced later
    .word 0x0 ; terminator
`}let t=s.extinfo.outputPrefix||"",u=(i.writeFile(t+E.BINARY_ASM,n),x(s.target,i,n,e));if(u.thumbFile.commPtr&&(i.commSize=u.thumbFile.commPtr-v.getCommBase()),u.src&&i.writeFile(t+E.BINARY_ASM,u.src),a)b();else{l=e.configData||[];if(l.some(e=>"BOOTLOADER_BOARD_ID"==e.name)){let e=`const uint32_t configData[] = {
`;e=(e+=`    0x1e9e10f1, 0x20227a79, // magic
`)+`    ${l.length}, 0, // num. entries; reserved
`;for(var r of l)e+=`    ${r.key}, 0x${r.value.toString(16)}, // ${r.name}
`;e+="    0, 0\n};\n",i.writeFile(t+"config.c",e)}if(u.buf){var d=u.buf;let t="";for(let e=0;e<d.length;++e)t+=String.fromCharCode(255&d[e],d[e]>>8);let r=E.U.sha256(t).slice(0,16);var p=E.U.range(4).map(e=>parseInt(r.slice(2*e,2*e+2),16));E.U.assert(12935==d[12]);for(let e=0;e<p.length;++e)d[12+e]=p[e];s.target.flashChecksumAddr&&(c=u.thumbFile.lookupLabel("__flash_checksums")/2,E.U.assert(c==d.length-16),n=d.slice(d.length-16),d.splice(d.length-16,16),a=Math.ceil(2*d.length/o),E.U.assert(12935==n[n.length-4]),n[n.length-4]=p[0],n[n.length-3]=p[1],n[n.length-5]=a,i.checksumBlock=n),b()}if(!e.procDebugInfo){for(var h of e.breakpoints){var m=E.U.lookup(u.thumbFile.getLabels(),"__brkp_"+h.id);null!=m&&(h.binAddr=m)}for(var g of i.procs)g.fillDebugInfo(u.thumbFile);if(e.procDebugInfo=i.procs.map(e=>e.debugInfo),i.target.switches.size){var f,_=[];for(f of i.procs){var y=T.pxtc.nodeLocationInfo(f.action),y=[y.fileName.replace("pxt_modules/",""),E.getDeclName(f.action),f.debugInfo.size,"function",y.line+1];_.push(y.map(e=>`"${e}"`).join(","))}_.sort(),_.unshift("filename,name,size,type,line"),i.writeFile(t+"size.csv",_.join("\n"))}}}function b(){var e;pxt.isOutputText(E.target)?(e=v.patchHex(i,u.buf,!1,!1).join("\r\n")+"\r\n",i.writeFile(t+pxt.outputName(E.target),e)):(e=T.pxtc.encodeBase64(v.patchHex(i,u.buf,!1,!!E.target.useUF2)[0]),i.writeFile(t+pxt.outputName(E.target),e))}}E.assemble=x,E.processorEmit=function(e,t,r){var n,i=c(e,0,r),s=E.U.flatClone(t);if(v.setupFor(t.target,t.extinfo||E.emptyExtInfo(),r),d(i,e,t,r),r.builtVariants||(r.builtVariants=[]),r.builtVariants.push(null==(t=t.extinfo)?void 0:t.appVariant),(t=s.otherMultiVariants||[]).length)try{for(var a of t){var o=E.U.flatClone(s);o.extinfo=a.extinfo,a.target.isNative=!0,o.target=a.target,v.setupFor(o.target,o.extinfo,r),d(i,e,o,r),r.builtVariants.push(null==(n=a.extinfo)?void 0:n.appVariant)}}finally{v.setupFor(s.target,s.extinfo,r)}},E.validateShim=v.validateShim}})(ts=ts||{}),(e=>{(e.pxtc||(e.pxtc={})).getHelpForKeyword=function(e,t){var r={abstract:null,any:null,as:null,break:null,case:null,catch:null,class:null,continue:null,const:null,constructor:null,debugger:null,declare:null,delete:null,do:null,else:null,enum:null,export:null,extends:null,false:lf("Represents the negative outcome of a logical expression"),finally:null,for:null,from:null,function:null,get:null,if:null,implements:null,in:null,instanceof:null,interface:null,is:null,let:null,namespace:null,new:null,null:null,private:null,protected:null,public:null,return:null,set:null,static:null,super:null,switch:null,this:null,throw:null,true:lf("Represents the positive outcome of a logical expression"),try:null,type:null,typeof:null,undefined:null,void:null,while:null,with:null,of:null};return(t?{True:r.true,False:r.false,None:null,abs:null,all:null,any:null,ascii:null,bin:null,bool:null,bytearray:null,bytes:null,callable:null,chr:null,classmethod:null,compile:null,complex:null,copyright:null,credits:null,delattr:null,dict:null,dir:null,divmod:null,enumerate:null,eval:null,exec:null,exit:null,filter:null,float:null,format:null,frozenset:null,getattr:null,globals:null,hasattr:null,hash:null,help:null,hex:null,id:null,input:null,int:null,isinstance:null,issubclass:null,iter:null,len:null,license:null,list:null,locals:null,map:null,max:null,memoryview:null,min:null,next:null,object:null,oct:null,open:null,ord:null,pow:null,print:null,property:null,quit:null,range:null,repr:null,reversed:null,round:null,set:null,setattr:null,slice:null,sorted:null,staticmethod:null,str:null,sum:null,super:null,tuple:null,type:null,vars:null}:r)[e]}})(ts=ts||{}),(e=>{(e.pxtc||(e.pxtc={})).LSHost=class{constructor(e){this.p=e}getCompilationSettings(){var e=this.p.getCompilerOptions();return e.noLib=!0,e}getNewLine(){return"\n"}getScriptFileNames(){return this.p.getSourceFiles().map(e=>e.fileName)}getScriptVersion(e){return"0"}getScriptSnapshot(e){let t=this.p.getSourceFile(e);return{getLength:()=>t.getFullText().length,getText:()=>t.getFullText(),getChangeRange:()=>{}}}getCurrentDirectory(){return"."}getDefaultLibFileName(e){return""}useCaseSensitiveFileNames(){return!0}}})(ts=ts||{}),(S=>{var C,w;function I(e){e=null==(e=null==(e=null==e?void 0:e.pxt)?void 0:e.callInfo)?void 0:e.qName;return w.lastApiInfo.apis.byQName[e]}function A(t,r,n){if(t&&!(r<0)){let e=t.parameters[r];return e=t.attributes._def&&(t=t.attributes._def.parameters[r].shadowBlockId)&&(r=n.blocksById[t],"TD_ID"===(n=w.lastApiInfo.apis.byQName[r.qName]).attributes.shim)&&1===n.parameters.length?n.parameters[0]:e}}function D(e,t,r,n,s=!1){let a={};n.forEach(e=>{let t,r,n=e.symbol.retType;var i;s&&(7==e.symbol.kind?n=e.symbol.namespace:4==e.symbol.kind&&1<(null==(i=null==(r=null==(t=e.symbol.attributes)?void 0:t.enumIdentity)?void 0:r.split("."))?void 0:i.length)&&(n=i[0])),a[n]=[...a[n]||[],e]});var i,n=a[e]||[];let o=[];for(i of n){var l=c(i.symbol,t,S.SymbolFlags.Enum);if(l){l=r.getTypeOfSymbolAtLocation(l,t);let e=C.getEnumMembers(r,l).map(e=>C.enumMemberToQName(r,e)).map(e=>w.lastApiInfo.apis.byQName[e]);o=[...o,...e]}}return[...n,...M(o,1)]}function s(e){return e.flags&S.SymbolFlags.Variable?4:e.flags&S.SymbolFlags.Class?8:e.flags&S.SymbolFlags.Enum?6:e.flags&S.SymbolFlags.EnumMember?7:e.flags&S.SymbolFlags.Method?1:e.flags&S.SymbolFlags.Module?5:e.flags&S.SymbolFlags.Property?2:0}function N(e){return{kind:0,name:e,pyName:e,qName:e,pyQName:e,namespace:"",attributes:{callingConvention:0,paramDefl:{}},fileName:pxt.MAIN_TS,parameters:[],retType:"any"}}function O(e,t){var r=e.getName(),n=/(.*)\.(.*)/.exec(r),i=n?n[2]:r,n=n?n[1]:"",t=null!=(t=null==(t=t.getSymbol())?void 0:t.getName())?t:"any";return{kind:s(e),name:i,pyName:i,qName:r,pyQName:r,namespace:n,attributes:{callingConvention:0,paramDefl:{}},fileName:pxt.MAIN_TS,parameters:[],retType:t}}function R(e,t,r){if(e)return t.byQName[r.getFullyQualifiedName(e)]}function L(e,t){return e.weight!==t.weight?t.weight-e.weight:C.compareSymbols(e.symbol,t.symbol)}function P(e,t){return{symbol:e,weight:t}}function M(e,t){return e.map(e=>P(e,t))}function F(e,t){return e.flags&S.TypeFlags.NumberLiteral?"Number":e.flags&S.TypeFlags.StringLiteral?"String":e.flags&S.TypeFlags.BooleanLiteral?"Boolean":null!=(e={number:"Number",string:"String",boolean:"Boolean"}[t=t.typeToString(e)])?e:t}function n(e,t){return"."===t.charAt(0)&&(t=t.substr(1)),e.substr(0,e.lastIndexOf(".")+1)+t}function c(e,t,r){var n,i=w.service&&w.service.getProgram().getTypeChecker();if(i)for(n of i.getSymbolsInScope(t,r))if(n.escapedName.toString()===e.qName)return n;return null}function B({symbol:e}){return!(/^__/.test(e.name)||/^__/.test(e.namespace)||e.attributes.hidden||e.attributes.deprecated||"TD_ID"==e.attributes.shim||e.attributes.blockAliasFor)}C=S.pxtc||(S.pxtc={}),(w=C.service||(C.service={})).getCallSymbol=I,w.getParameter=A,w.getApisForTsType=D,w.getBasicKindDefault=function(e,t){switch(e){case C.SK.StringKeyword:return'""';case C.SK.NumberKeyword:return"0";case C.SK.BooleanKeyword:return t?"False":"false";case C.SK.ArrayType:return"[]";case C.SK.NullKeyword:return t?"None":"null";default:return}},w.tsSymbolToPxtSymbolKind=s,w.makePxtSymbolFromKeyword=N,w.makePxtSymbolFromTsSymbol=O,w.getPxtSymbolFromTsSymbol=R,w.compareCompletionSymbols=L,w.completionSymbol=P,w.completionSymbols=M,w.getNodeAndSymbolAtLocation=function(e,t,r,n){if(t=e.getSourceFile(t),e=e.getTypeChecker(),t=C.findInnerMostNodeAtPosition(t,r)){r=e.getSymbolAtLocation(t);if(r)return[t,R(r,n,e)]}return null},w.tsTypeToPxtTypeString=F,w.filenameWithExtension=n,w.getWordAtPosition=function(t,e){let r=e,n=e;for(;0<r&&i(r);)--r;for(;n<t.length-1&&i(n);)++n;return r!=n?{text:t.substring(r+1,n),start:r+1,end:n}:null;function i(e){e=t.charCodeAt(e);return 65<=e&&e<=90||97<=e&&e<=122}},w.getTsSymbolFromPxtSymbol=c,w.getDefaultEnumValue=function(e,t){var r,n,i,s=w.service&&w.service.getProgram().getTypeChecker();for(r of C.getEnumMembers(s,e))if(r.name.kind===C.SK.Identifier)return n=C.enumMemberToQName(s,r),(i=w.lastApiInfo.apis.byQName[n])?i.attributes.alias?t&&i.attributes.pyAlias||i.attributes.alias:t?i.pyQName:i.qName:n;return"0"},w.getCompletions=function(p){let h,m,{fileName:e,fileContent:t,position:r,wordStartPos:g,wordEndPos:s,runtime:f}=p,_=t,y=(t&&w.host.setFile(e,t),n(e,"ts"));var b={startPos:g,endPos:s};let v=/\.py$/.test(e);var T={entries:[],isMemberCompletion:!1,isNewIdentifierLocation:!0,isTypeLocation:!1,namespace:[]},k=_.lastIndexOf("\n",r-1),k=Math.max(0,k),k=_.substring(k+1,r),x=v?"#":"//";if(!k.trim().startsWith(x)){let n=-1,t=-1;for(let e=r-1;0<=e;--e){if("."==_[e]){n=e;break}if(!/\w/.test(_[e]))break;-1==t&&(t=e)}n==r-1?_=_.slice(0,r)+"_"+_.slice(r):-1==t&&(_=_.slice(0,r)+"_"+_.slice(r),t=r);let i=-1!==n,a=(T.isMemberCompletion=i)?_.slice(n+1,s):_.slice(g,s);i&&(t=n);let o={};k=w.cloneCompileOpts(w.host.opts);k.fileSystem[e]=_,w.addApiInfo(k),k.syntaxInfo={position:t,type:T.isMemberCompletion?"memberCompletion":"identifierCompletion"};let l=[],c;if(v){let t=C.transpile.pyToTs(k);t.syntaxInfo&&t.syntaxInfo.symbols&&(l=M(t.syntaxInfo.symbols,1)),t.globalNames&&(w.lastGlobalNames=t.globalNames),!l.length&&t.globalNames&&(l=M(pxt.U.values(t.globalNames),1)),Object.keys(t.outfiles).forEach(e=>{e===y&&w.host.setFile(e,t.outfiles[e])}),t.sourceMap&&(x=_,E=t.outfiles[y]||"",E=C.BuildSourceMapHelpers(t.sourceMap,E,x).py.smallestOverlap(b))&&(c=E.ts.startPos),!i&&50<l.length&&(l=l.filter(e=>0<=(v?e.symbol.pyQName:e.symbol.qName).toLowerCase().indexOf(a.toLowerCase()))),k.ast=!0,C.compile(k,w.service)}else{c=r,k.ast=!0,w.host.setOpts(k);w.runConversionsAndCompileUsingService()}x=w.service.getProgram(),b=x.getSourceFile(y);let u=x.getTypeChecker(),d=C.findInnerMostNodeAtPosition(b,c);var E=C.decompiler.buildCommentMap(b).some(e=>e.start<=r&&r<=e.end);if(!E){if(d)if([C.SK.StringLiteral,C.SK.FirstTemplateToken,C.SK.NoSubstitutionTemplateLiteral].some(e=>d.kind===e))return T;T.namespace=C.getCurrentNamespaces(d);let r=!1;if(i){k=C.findInnerMostNodeAtPosition(b,v?c:n-1);if(k){let e;x=u.getSymbolAtLocation(k);if(e=0<(null==(h=null==x?void 0:x.members)?void 0:h.size)?u.getDeclaredTypeOfSymbol(x):x?u.getTypeOfSymbolAtLocation(x,k):u.getTypeAtLocation(k)){let t=e.symbol?u.getFullyQualifiedName(e.symbol):F(e,u);t&&(E=e.getApparentProperties().map(e=>t+"."+e.getName()).map(e=>w.lastApiInfo.apis.byQName[e]).filter(e=>!!e).map(e=>P(e,1)),l=E,r=!0)}}}x=pxt.U.values(w.lastApiInfo.apis.byQName);if(0===l.length&&(k=x.filter(e=>0<=(v?e.pyQName:e.qName).toLowerCase().indexOf(a.toLowerCase())),l=M(k,1)),!v&&!r){d=(d=C.findInnerMostNodeAtPosition(b,g))||b.getSourceFile();E=S.SymbolFlags.Variable;let e=u.getSymbolsInScope(d,E),t=d.getText();x=(e="_"!==t?e.filter(e=>0<=e.name.indexOf(t)):e).map(e=>{let t=R(e,w.lastApiInfo.apis,u);var r;return t||(r=u.getTypeOfSymbolAtLocation(e,d),t=O(e,r)),t}).filter(e=>!!e).map(e=>P(e,1));x.forEach(e=>e.weight+=5),l=[...l,...x]}k=C.getParentCallExpression(d);if(k){let t=C.findCurrentCallArgIdx(k,d,c);if(0<=t){let e=w.blocksInfoOp(w.lastApiInfo.apis,f.bannedCategories);b=I(k);b&&(E=A(b,t=t>=b.parameters.length?b.parameters.length-1:t,e))&&D(E.type,k,u,l,E.isEnum).forEach(e=>e.weight=10)}}if(!i){let e;b=(e=v?(x=pxt.py.keywords,Object.keys(x)):[...ts.pxtc.reservedWords,...ts.pxtc.keywordTypes]).filter(e=>0<=e.indexOf(a)).map(N).map(e=>P(e,0));l=[...l,...b]}let e={};e=v&&w.lastGlobalNames?w.lastGlobalNames:w.lastApiInfo.apis.byQName,l.map(e=>!e.symbol.attributes.alias||i&&7===e.symbol.kind?e:P(w.lastApiInfo.apis.byQName[e.symbol.attributes.alias],e.weight)).filter(B).forEach(e=>{o[e.symbol.qName]=e}),(l=pxt.Util.values(o).filter(e=>!!e&&!!e.symbol)).sort(L),p.light&&100<l.length&&(l=l.splice(0,100));var{bannedCategories:k,screenSize:E}=p.runtime;let t=w.blocksInfoOp(w.lastApiInfo.apis,k),s={takenNames:e,blocksInfo:t,screenSize:E,apis:w.lastApiInfo.apis,checker:null==(m=null==w.service?void 0:w.service.getProgram())?void 0:m.getTypeChecker()};l.forEach(e=>{var t,e=e.symbol,r=v,n=s,i=w.lastApiInfo.decls[e.qName];S.isFunctionLike(i)&&(e.snippetAddsDefinitions||r&&!e.pySnippet||!r&&!e.snippet)&&(n=w.getSnippet(n,e,i,r),i=w.snippetStringify(n),t=w.snippetStringify(n,!0),n=w.snippetAddsDefinitions(n),r?(e.pySnippet=i,e.pySnippetWithMarkers=t):(e.snippet=i,e.snippetWithMarkers=t),e.snippetAddsDefinitions=n)}),T.entries=l.map(e=>e.symbol)}}return T}})(ts=ts||{}),(o=>{{var a=o.pxtc||(o.pxtc={});let r=function(e){e=t(e);o.sys.write(e)};function l(e){for(var t of e)r(t)}function t(e){let n;var t,r,i;n=void 0!==e.file?({line:r,character:i}=o.getLineAndCharacterOfPosition((t=e).file,t.start),s=t.file.fileName,Object.assign({fileName:s,line:r,column:i},t)):Object.assign({fileName:void 0,line:void 0,column:void 0},e);{var s=n;let e="",t=(s.fileName&&(e+=s.fileName+`(${s.line+1},${s.column+1}): `),o.sys?o.sys.newLine:"\n"),r=a.DiagnosticCategory[s.category].toLowerCase();return e+=`${r} TS${s.code}: `+a.flattenDiagnosticMessageText(s.messageText,t)+t}}function n(e,t){var r=o.createCompilerHost(t),e=(r.getDefaultLibFileName=()=>"node_modules/pxt-core/pxtcompiler/ext-typescript/lib/lib.d.ts",o.createProgram(e,t,r));return e}function c(e){let t=e.getSyntacticDiagnostics();return(t=0===t.length&&0===(t=e.getOptionsDiagnostics().concat(a.Util.toArray(e.getGlobalDiagnostics()))).length?e.getSemanticDiagnostics():t).slice(0)}a.getDiagnosticString=t,a.plainTscCompileDir=function(i){let s=o.parseCommandLine([]),a=o.findConfigFile(i,o.sys.fileExists);var e=(()=>{let e=o.sys.readFile(a),t=o.parseConfigFileTextToJson(a,e),r=t.config;if(r){var n=o.parseJsonConfigFileContent(r,o.sys,i,s.options,a);if(!(0<n.errors.length))return n;l(n.errors)}else l([t.error]);o.sys.exit(o.ExitStatus.DiagnosticsPresent_OutputsSkipped)})();return c(e=n(e.fileNames,e.options)).forEach(r),e},a.plainTscCompileFiles=n,a.getProgramDiagnostics=c}})(ts=ts||{}),(g=>{{var f=g.pxtc||(g.pxtc={});function _(e){if(!e||!e.kind)return null;switch(e.kind){case g.SyntaxKind.StringKeyword:return"str";case g.SyntaxKind.NumberKeyword:return"number";case g.SyntaxKind.BooleanKeyword:return"bool";case g.SyntaxKind.VoidKeyword:return"None";case g.SyntaxKind.FunctionType:return r=_((t=e).type),`(${(t=t.parameters.map(e=>e.type).map(_)).join(", ")}) -> `+r;case g.SyntaxKind.ArrayType:return`List[${_(e.elementType)}]`;case g.SyntaxKind.TypeReference:t=e;return t.typeName&&t.typeName.getText?t.typeName.getText():"";case g.SyntaxKind.AnyKeyword:return"any";default:return pxt.tickEvent("depython.todo.tstypenodetopytype",{kind:e.kind}),""}var t,r}function y(e){if(!e||!e.flags)return null;switch(e.flags){case g.TypeFlags.String:return"str";case g.TypeFlags.Number:return"number";case g.TypeFlags.Boolean:return"bool";case g.TypeFlags.Void:return"None";case g.TypeFlags.Any:return"any";default:return pxt.tickEvent("depython.todo.tstypetopytype",{kind:e.flags}),""}}function b(p,r,n){function h(e,t,r=!1){let n=p.getTypeAtLocation(t);if(!n)return"None";r&&(n=n.getCallSignatures()[0].getReturnType());t=p.typeToString(n,void 0,g.TypeFormatFlags.UseFullyQualifiedType);return/^\d/.test(t)?"number":"this"==t?v(p,n.symbol):t}var i=(e=>{switch(e.kind){case f.SK.MethodDeclaration:case f.SK.MethodSignature:return 1;case f.SK.PropertyDeclaration:case f.SK.PropertySignature:case f.SK.GetAccessor:case f.SK.SetAccessor:return 2;case f.SK.Constructor:case f.SK.FunctionDeclaration:return 3;case f.SK.VariableDeclaration:return 4;case f.SK.ModuleDeclaration:return 5;case f.SK.EnumDeclaration:return 6;case f.SK.EnumMember:return 7;case f.SK.ClassDeclaration:return 8;case f.SK.InterfaceDeclaration:return 9;default:return 0}})(n);if(0==i)return null;{var s=n;let d=f.parseComments(s);if(d.weight<0)return null;var a=/^(.*)\.(.*)/.exec(r),o=3==i||1==i;let e=null;var l=g.getSourceFileOfNode(n);l&&(l=/^pxt_modules\/([^\/]+)/.exec(l.fileName))&&(e=l[1]);let t=void 0;if(8==i||9==i)if(t=[],n.heritageClauses)for(var c of n.heritageClauses)if(c.types)for(var u of c.types)t.push(h(0,u));6!=i&&7!==i||(t=t||[]).push("Number");var m={kind:i,qName:r,namespace:a?a[1]:"",name:a?a[2]:r,fileName:n.getSourceFile().fileName,attributes:d,pkg:e,pkgs:null,extendsTypes:t,isStatic:null==(l=s.modifiers)?void 0:l.some(e=>e.kind===g.SyntaxKind.StaticKeyword),retType:n.kind==g.SyntaxKind.Constructor?"void":5==i?"":h(s.type,s,o),parameters:o?f.Util.toArray(s.parameters).map((r,e)=>{var t=f.getName(r),n=d.paramHelp[t]||"",i=d.paramMin&&d.paramMin[t],s=d.paramMax&&d.paramMax[t];/\beg\.?:\s*(.+)/.exec(n);let a,o;if(r.type&&r.type.kind===f.SK.FunctionType){let t=p.getSignatureFromDeclaration(r.type).getParameters();"objectdestructuring"===d.mutate?(f.assert(0<t.length),a=p.getTypeAtLocation(t[0].valueDeclaration).getProperties().map(e=>({name:e.getName(),type:p.typeToString(p.getTypeOfSymbolAtLocation(e,t[0].valueDeclaration))}))):o=t.map((e,t)=>({name:e.getName(),type:p.typeToString(p.getTypeOfSymbolAtLocation(e,r),void 0,g.TypeFormatFlags.UseFullyQualifiedType)}))}var l={},c=p.getTypeAtLocation(r),u=c&&!!(c.flags&(g.TypeFlags.Enum|g.TypeFlags.EnumLiteral));if(d.block&&d.paramShadowOptions){let r=[];d.block.replace(/%(\w+)/g,(e,t)=>(r.push(t),"")),d.paramShadowOptions[r[e]]&&(l.fieldEditorOptions={value:d.paramShadowOptions[r[e]]})}i&&(l.min={value:i}),s&&(l.max={value:s});e=r.type&&_(r.type)||c&&y(c)||"unknown",i=r.initializer?r.initializer.getText():f.getExplicitDefault(d,t)||(r.questionToken?"undefined":void 0);return{name:t,description:n,type:h(0,r),pyTypeString:e,initializer:i,default:d.paramDefl[t],properties:a,handlerParameters:o,options:l,isEnum:u}}):null,snippet:g.isFunctionLike(n)?null:void 0};switch(m.kind){case 7:m.pyName=f.U.snakify(m.name).toUpperCase();break;case 4:case 1:case 2:case 3:m.pyName=f.U.snakify(m.name);break;default:m.pyName=m.name}return n.kind!==f.SK.GetAccessor&&(n.kind!==f.SK.PropertyDeclaration&&n.kind!==f.SK.PropertySignature||!f.isReadonly(n))||(m.isReadOnly=!0),m}}function s(e){return!!e.attributes.block&&!!e.attributes.blockId}f.placeholderChar="",f.ts2PyFunNameMap={"Math.trunc":{n:"int",t:g.SyntaxKind.NumberKeyword,snippet:"int(0)"},"Math.min":{n:"min",t:g.SyntaxKind.NumberKeyword,snippet:"min(0, 0)"},"Math.max":{n:"max",t:g.SyntaxKind.NumberKeyword,snippet:"max(0, 0)"},"Math.abs":{n:"abs",t:g.SyntaxKind.NumberKeyword,snippet:"abs(0)"},"console.log":{n:"print",t:g.SyntaxKind.VoidKeyword,snippet:'print(":)")'},".length":{n:"len",t:g.SyntaxKind.NumberKeyword},".toLowerCase()":{n:"string.lower",t:g.SyntaxKind.StringKeyword},".toUpperCase()":{n:"string.upper",t:g.SyntaxKind.StringKeyword},".charCodeAt(0)":{n:"ord",t:g.SyntaxKind.NumberKeyword},"pins.createBuffer":{n:"bytearray",t:g.SyntaxKind.Unknown},"pins.createBufferFromArray":{n:"bytes",t:g.SyntaxKind.Unknown},"control.createBuffer":{n:"bytearray",t:g.SyntaxKind.Unknown},"control.createBufferFromArray":{n:"bytes",t:g.SyntaxKind.Unknown},"!!":{n:"bool",t:g.SyntaxKind.BooleanKeyword},"Array.push":{n:"Array.append",t:g.SyntaxKind.Unknown},parseInt:{n:"int",t:g.SyntaxKind.NumberKeyword,snippet:'int("0")'},"_py.range":{n:"range",t:g.SyntaxKind.Unknown,snippet:"range(4)"}},f.emitPyTypeFromTypeNode=_,f.emitPyTypeFromTsType=y,f.genDocs=function(n,e,i={}){pxt.debug("generating docs for "+n),pxt.debug(JSON.stringify(Object.keys(e.byQName),null,2));let s={};var r=f.Util.values(e.byQName),e=r.filter(e=>7==e.kind).sort(c);let a={},o={},l={};var t=(r,e)=>{if(i.locs){let t={};Object.keys(r).sort().forEach(e=>t[e]=r[e]),s[n+e+"-strings.json"]=JSON.stringify(t,null,2)}};for(let t of r){if(5==t.kind){if(!r.filter(e=>e.namespace==t.name&&!!e.attributes.jsDoc)[0])continue;t.attributes.block||(t.attributes.block=t.name)}(t=>{var e;if(i.locs&&t.qName&&(!/^__/.test(t.name)&&(pxt.debug("loc: "+t.qName),7!=t.kind&&(r=g.pxtc.blocksCategory(t))&&(o["{id:category}"+r]=r),t.attributes.jsDoc&&(l[t.qName]=t.attributes.jsDoc),t.attributes.group&&(o["{id:group}"+t.attributes.group]=t.attributes.group),t.attributes.subcategory&&(o["{id:subcategory}"+t.attributes.subcategory]=t.attributes.subcategory),t.parameters&&t.parameters.filter(e=>!!e.description).forEach(e=>{l[t.qName+"|param|"+e.name]=e.description}),t.attributes.block))){o[t.qName+"|block"]=t.attributes.block;var r=pxt.blocks.compileInfo(t);if(null!=(e=r.handlerArgs)&&e.length)for(var n of r.handlerArgs)o[n.localizationKey]=n.name}})(t)}return i.locs&&e.forEach(e=>{e.attributes.block&&(o[e.qName+"|block"]=e.attributes.block),e.attributes.jsDoc&&(o[e.qName]=e.attributes.jsDoc)}),t(o,""),t(l,"-jsdoc"),i.pxtsnippet&&(i.pxtsnippet.forEach(t=>{{var r=a;let e=["label","title","hint","errorMessage"];r[t.label]=t.label,t.questions.forEach(t=>{e.forEach(e=>{t[e]&&(r[t[e]]=t[e])})})}}),t(a,"-snippet")),s},f.hasBlock=s;let i;function c(t,r){function e(e){return-e(t)+e(r)}var n=e(e=>s(e)?1:-1);return n||e(e=>e.namespace?-1:1)||(i=i||{4:100,5:101,3:99,2:98,1:97,8:89,6:81,7:80},e(e=>i[e.kind]||0)||e(e=>e.attributes.weight||50))||f.U.strcmp(t.name,r.name)}function n(e,t,r=!1){let a={byQName:{},jres:t},o={},l=e.getTypeChecker(),c=n=>{if(n.kind==f.SK.VariableStatement)n.declarationList.declarations.forEach(c);else{if(f.isExported(n)){if(!n.symbol)return void pxt.warn("no symbol",n);let e=v(l,n.symbol),r=(n.kind==f.SK.SetAccessor&&(e+="@set"),o[e]=n,b(l,e,n));if(r){let t=f.U.lookup(a.byQName,e);if(t)if(9==t.kind&&9!=r.kind)a.byQName[e+"@type"]=t;else if(9!=t.kind&&9==r.kind)a.byQName[e+"@type"]=r,r=t;else{var i=null==(i=t.attributes._source)?void 0:i.trim(),s=null==(s=r.attributes._source)?void 0:s.trim();let e=i+"\n"+s;i&&0<=(null==s?void 0:s.indexOf(i))?e=s:s&&0<=(null==i?void 0:i.indexOf(s))&&(e=i),r.attributes=f.parseCommentString(e),5===t.kind&&(r.pkgs=t.pkgs||[],t.pkg===r.pkg||r.pkgs.find(e=>e===t.pkg)||r.pkgs.push(t.pkg)),t.extendsTypes&&(r.extendsTypes=r.extendsTypes||[],t.extendsTypes.forEach(e=>{-1===r.extendsTypes.indexOf(e)&&r.extendsTypes.push(e)}))}!n.parent||n.parent.kind!=f.SK.ClassDeclaration&&n.parent.kind!=f.SK.InterfaceDeclaration||f.isStatic(n)||(r.isInstance=!0),a.byQName[e]=r}}n.kind==f.SK.ModuleDeclaration?(s=n).body.kind==f.SK.ModuleBlock?s.body.statements.forEach(c):s.body.kind==f.SK.ModuleDeclaration&&c(s.body):n.kind!=f.SK.InterfaceDeclaration&&n.kind!=f.SK.ClassDeclaration&&n.kind!=f.SK.EnumDeclaration||n.members.forEach(c)}};for(var n of e.getSourceFiles())n.statements.forEach(c);var i,s=[];for(i in a.byQName){var u,d,p=a.byQName[i];p.qName=i,p.attributes._source=null,p.extendsTypes&&p.extendsTypes.length&&s.push(p);let e=p.attributes.jres;e&&("true"==e&&(e=i),(u=f.U.lookup(t||{},e))&&u.icon&&!p.attributes.iconURL&&(p.attributes.iconURL=u.icon),u)&&u.data&&!p.attributes.jresURL&&(p.attributes.jresURL="data:"+u.mimeType+";base64,"+u.data),p.pyName&&((u=f.U.lookup(f.ts2PyFunNameMap,p.qName))&&u.n?(p.pyQName=u.n,p.pySnippet=u.snippet,p.pySnippetName=u.n,p.pySnippetWithMarkers=void 0):p.namespace?(d=a.byQName[p.namespace])?p.pyQName=d.pyQName+"."+p.pyName:(pxt.log("namespace missing: "+p.namespace),p.pyQName=p.namespace+"."+p.pyName):p.pyQName=p.pyName)}let h={},m=e=>{if(!f.U.lookup(h,e.qName)){h[e.qName]=!0;var t,r={};r[e.qName]=!0;for(t of e.extendsTypes||[]){r[t]=!0;var n=a.byQName[t];if(n){m(n);for(var i of n.extendsTypes)r[i]=!0}}e.extendsTypes=Object.keys(r)}};return s.forEach(m),r&&delete a.byQName["Array.map"],{apis:a,decls:o}}function v(e,t){return t.isBogusSymbol?t.name:e.getFullyQualifiedName(t)}f.compareSymbols=c,f.getApiInfo=function(e,t,r=!1){return n(e,t,r).apis},f.internalGetApiInfo=n,f.getFullName=v}})(ts=ts||{}),(c=>{var u=c.pxtc||(c.pxtc={});{var d=u.service||(u.service={});let e={fileSystem:{},sourceFiles:[],target:{isNative:!1,hasHex:!1,switches:{}}};class s{constructor(){this.opts=e,this.fileVersions={},this.projectVer=0,this.pxtModulesOK=null}getProjectVersion(){return this.projectVer+""}setFile(e,t){this.opts.fileSystem[e]!=t&&(this.fileVersions[e]=(this.fileVersions[e]||0)+1,this.opts.fileSystem[e]=t,this.projectVer++)}reset(){this.setOpts(e),this.pxtModulesOK=null}setOpts(e){u.Util.iterMap(e.fileSystem,(e,t)=>{this.opts.fileSystem[e]!=t&&(this.fileVersions[e]=(this.fileVersions[e]||0)+1)}),this.opts=Object.assign(Object.assign({},e),{fileSystem:Object.assign({},e.fileSystem)}),this.projectVer++}getCompilationSettings(){return u.getTsCompilerOptions(this.opts)}getScriptFileNames(){return this.opts.sourceFiles.filter(e=>u.U.endsWith(e,".ts"))}getScriptVersion(e){return(this.fileVersions[e]||0).toString()}getScriptSnapshot(e){e=this.opts.fileSystem[e];return null!=e?c.ScriptSnapshot.fromString(e):null}getNewLine(){return"\n"}getCurrentDirectory(){return"."}getDefaultLibFileName(e){return"no-default-lib.d.ts"}log(e){pxt.log("LOG",e)}trace(e){pxt.log("TRACE",e)}error(e){pxt.error("ERROR",e)}useCaseSensitiveFileNames(){return!0}}let l,n;function p(e,t){return e?(d.lastLocBlocksInfo||(d.lastLocBlocksInfo=u.getBlocksInfo(e,t)),d.lastLocBlocksInfo):(d.lastBlocksInfo||(d.lastBlocksInfo=u.getBlocksInfo(d.lastApiInfo.apis,t)),d.lastBlocksInfo)}function h(e){return d.lastApiInfo||(d.lastApiInfo=u.internalGetApiInfo(d.service.getProgram(),e.jres)),d.lastApiInfo}function m(e){var t;e.apisInfo||(t=h(e),e.apisInfo=u.U.clone(t.apis))}function g(e){e=pxt.U.flatClone(e);return e.fileSystem=pxt.U.flatClone(e.fileSystem),e}d.blocksInfoOp=p,d.getLastApiInfo=h,d.addApiInfo=m,d.cloneCompileOpts=g,d.IsOpErr=function(e){return!!e.errorMessage};let i={reset:()=>{d.service=c.createLanguageService(d.host),d.lastApiInfo=void 0,d.lastGlobalNames=void 0,d.host.reset()},setOptions:e=>{d.host.setOpts(e.options)},syntaxInfo:e=>{var r=e.fileContent,n=(e.fileContent&&d.host.setFile(e.fileName,e.fileContent),g(d.host.opts));n.fileSystem[e.fileName]=r,m(n),n.syntaxInfo={position:e.position,type:e.infoType};let i=e.fileName.endsWith(".py");var t,s,a,r="symbol"===n.syntaxInfo.type,o="signature"===n.syntaxInfo.type;if(i?(t=u.transpile.pyToTs(n)).globalNames&&(d.lastGlobalNames=t.globalNames):(n.ast=!0,d.host.setOpts(n),f(),s=(t=d.service.getProgram()).getSourceFile(e.fileName),t=t.getTypeChecker(),(r||o)&&(s=u.findInnerMostNodeAtPosition(s,e.position))&&(r?(a=t.getSymbolAtLocation(s))&&(a=d.getPxtSymbolFromTsSymbol(a,n.apisInfo,t),n.syntaxInfo.symbols=[a],n.syntaxInfo.beginPos=s.getStart(),n.syntaxInfo.endPos=s.getEnd()):o&&(a=null==(t=null==s?void 0:s.pxt)?void 0:t.callInfo)&&(o=n.apisInfo.byQName[a.qName],n.syntaxInfo.symbols=[o],n.syntaxInfo.beginPos=s.getStart(),n.syntaxInfo.endPos=s.getEnd(),t=u.getParentCallExpression(s))&&(a=u.findCurrentCallArgIdx(t,s,e.position),n.syntaxInfo.auxResult=a))),!r||null!=(o=n.syntaxInfo.symbols)&&o.length||(t=d.getWordAtPosition(e.fileContent,e.position))&&(i&&"range"===t.text?(s=h(n).apis).byQName["_py.range"]&&(n.syntaxInfo.symbols=[s.byQName["_py.range"]],n.syntaxInfo.beginPos=t.start,n.syntaxInfo.endPos=t.end):(a=u.getHelpForKeyword(t.text,i))&&(n.syntaxInfo.auxResult={documentation:a,displayString:d.displayStringForKeyword(t.text,i)},n.syntaxInfo.beginPos=t.start,n.syntaxInfo.endPos=t.end)),null!=(o=n.syntaxInfo.symbols)&&o.length){let t=h(n).apis;i&&(n.syntaxInfo.symbols=n.syntaxInfo.symbols.map(e=>t.byQName[e.qName]||e)),r&&(n.syntaxInfo.auxResult=n.syntaxInfo.symbols.map(e=>d.displayStringForSymbol(e,i,t)))}return n.syntaxInfo},getCompletions:e=>d.getCompletions(e),compile:e=>{d.host.setOpts(e.options);e=f();return u.timesToMs(e),e},decompile:e=>(d.host.setOpts(e.options),u.decompile(d.service.getProgram(),e.options,e.fileName,!1)),pydecompile:e=>(d.host.setOpts(e.options),u.transpile.tsToPy(d.service.getProgram(),e.fileName)),decompileSnippets:e=>(d.host.setOpts(e.options),u.decompileSnippets(d.service.getProgram(),e.options,!1)),assemble:e=>({words:u.processorInlineAssemble(d.host.opts.target,e.fileContent)}),py2ts:e=>(m(e.options),u.transpile.pyToTs(e.options)),fileDiags:e=>u.patchUpDiagnostics((e=>{if(!/\.ts$/.test(e))return[];let t=d.service.getSyntacticDiagnostics(e);return t=(t=t&&t.length?t:d.service.getSemanticDiagnostics(e))||[]})(e.fileName)),allDiags:()=>{var e=f();return u.timesToMs(e),d.host.opts.target.switches.time&&pxt.log("DIAG-TIME",e.times),e},format:e=>{e=e.format;return u.format(e.input,e.pos)},apiInfo:()=>{if(d.lastBlocksInfo=void 0,l=void 0,d.host.opts!==e)return d.lastApiInfo=u.internalGetApiInfo(d.service.getProgram(),d.host.opts.jres),d.lastApiInfo.apis},snippet:t=>{var r=t.snippet;if(d.lastApiInfo){var n=d.lastApiInfo.apis.byQName[r.qName],i=d.lastApiInfo.decls[r.qName];if(n&&i&&c.isFunctionLike(i)){r=!!r.python;let e={};e=r&&d.lastGlobalNames?d.lastGlobalNames:d.lastApiInfo.apis.byQName;var{bannedCategories:t,screenSize:s}=t.runtime,a=d.lastApiInfo.apis,o=p(a,t),l=d.service&&d.service.getProgram().getTypeChecker(),a={apis:a,blocksInfo:o,takenNames:e,bannedCategories:t,screenSize:s,checker:l,includeParentSnippet:!0},o=d.getSnippet(a,n,i,r);return d.snippetStringify(o)}}},blocksInfo:e=>p(e,e.blocks&&e.blocks.bannedCategories),apiSearch:n=>{var a=n.search;let c=p(a.localizedApis,n.blocks&&n.blocks.bannedCategories);a.localizedStrings&&pxt.Util.setLocalizedStrings(a.localizedStrings);var e=(t,e,r)=>{if(t)return"string"==typeof t?t:e?t[e]:Object.keys(t).map(e=>t[e]).join(" ")};let u=(t,r=!1,n)=>{var e=(null==(e=t.attributes)?void 0:e.toolboxParent)||(null==(e=t.attributes)?void 0:e.duplicateWithToolboxParent),i=(null==(i=t.attributes)?void 0:i.toolboxParentArgument)||(null==(i=t.attributes)?void 0:i.duplicateWithToolboxParentArgument);if(e&&!r){r=c.blocksById[e];if(r){let e={[i||"*"]:u(t,!0)};return u(r,!0,e)}}if(null!=(e=t.attributes)&&e._def){var s,a=[],i=t.attributes._def,o=pxt.blocks.compileInfo(t);for(s of i.parts)switch(s.kind){case"label":a.push(s.text);break;case"param":var l=o.definitionNameToParam[s.name];let e=(null==l?void 0:l.defaultValue)||s.varName||(null==l?void 0:l.actualName)||s.name;null!=n&&n["*"]?(e=n["*"],delete n["*"]):null!=n&&n[l.definitionName]&&(e=n[l.definitionName]),a.push(e)}return a.join(" ")}return t.attributes.block};if(!d.builtinItems){d.builtinItems=[],d.blockDefinitions=pxt.blocks.blockDefinitions();for(let n in d.blockDefinitions){let r=d.blockDefinitions[n];if(r.operators)for(let t in r.operators)r.operators[t].forEach(e=>d.builtinItems.push({id:n,name:r.name,jsdoc:"string"==typeof r.tooltip?r.tooltip:r.tooltip[e],block:e,field:[t,e],builtinBlock:!0}));else d.builtinItems.push({id:n,name:r.name,jsdoc:e(r.tooltip,r.tooltipSearch,r),block:e(r.block,r.blockTextSearch,r),builtinBlock:!0})}}let o;if(!l||a.subset){let i={},e=[],t=(a.subset&&(d.tbSubset=a.subset,e=d.builtinItems.filter(e=>!!d.tbSubset[e.id])),d.tbSubset?o=c.blocks.filter(e=>!!d.tbSubset[e.attributes.blockId]):(o=c.blocks,e=d.builtinItems),o.map(e=>({id:e.attributes.blockId,qName:e.qName,name:e.name,namespace:e.namespace,block:u(e),params:(e=>{let t,r=null==(t=e.attributes)?void 0:t.paramHelp;return r?Object.keys(r).map(e=>r[e]).join(" "):""})(e),jsdoc:e.attributes.jsDoc,localizedCategory:d.tbSubset&&"string"==typeof d.tbSubset[e.attributes.blockId]?d.tbSubset[e.attributes.blockId]:void 0,dropdownOptions:(t=>{let n=[];return t.parameters&&t.parameters.forEach(r=>{if(r.options&&r.options.fieldEditorOptions&&(e=r.options.fieldEditorOptions.value)&&Array.isArray(e)&&e.forEach(e=>{Array.isArray(e)&&2<=e.length&&("string"==typeof e[0]?n.push(e[0]):"object"==typeof e[0]&&e[0].alt&&n.push(e[0].alt))}),r.isEnum&&r.type){let t=c.apis.byQName[r.type];t&&6===t.kind&&Object.keys(c.apis.byQName).forEach(e=>{e=c.apis.byQName[e];7===e.kind&&e.namespace===t.name&&n.push(e.name)})}var e=c.apis.byQName[r.type];e&&e.attributes.fixedInstances&&pxt.Util.values(c.apis.byQName).filter(e=>4===e.kind&&e.attributes.fixedInstance&&e.retType===r.type).forEach(e=>{e=e.attributes.block||e.attributes.blockId||e.name;n.push(e)}),t.attributes.constantShim&&pxt.Util.values(c.apis.byQName).filter(e=>e.attributes.blockIdentity===t.qName).forEach(e=>{e=e.attributes.block||e.attributes.blockId||e.name;n.push(e)}),"@combined@"===r.type&&t.combinedProperties&&t.combinedProperties.forEach(e=>{var e=c.apis.byQName[e];e&&(e=e.attributes.block||e.attributes.blockId||e.name,n.push(e))})}),n.join(" ")})(e)}))),r={},s=(e.forEach(e=>r[e.id]=!0),t=t.filter(e=>!(e.id in r)),0);o.forEach(e=>{var t,r=i[e.qName]=(r=(e=e).attributes.weight||50,(1e3*((t=c.apis.byQName[e.namespace])&&t.attributes.weight||50)+r)*(!!t&&t.attributes.advanced||e.attributes.advanced?1:1e6));s=Math.max(s,r)}),t=t.concat(e);n={shouldSort:!0,threshold:.4,location:0,distance:1e3,maxPatternLength:16,minMatchCharLength:2,findAllMatches:!1,caseSensitive:!1,keys:[{name:"name",weight:.3},{name:"dropdownOptions",weight:.15},{name:"namespace",weight:.1},{name:"localizedCategory",weight:.1},{name:"block",weight:.4375},{name:"params",weight:.0625},{name:"jsdoc",weight:.0625}],sortFn:function(e,t){var r=e.qName?1-i[e.item.qName]/s:1,n=t.qName?1-i[t.item.qName]/s:1;return e.score*(1+r/10)-t.score*(1+n/10)}};l=new Fuse(t,n)}return l.search(a.term).slice(0,7)},projectSearch:e=>{var t,e=e.projectSearch,r=e.headers,r=(n||(t={shouldSort:!0,threshold:.6,location:0,distance:100,maxPatternLength:16,minMatchCharLength:2,findAllMatches:!1,caseSensitive:!1,keys:[{name:"name",weight:.3}]},n=new Fuse(r,t)),n.search(e.term));return r},projectSearchClear:()=>{n=void 0}};function f(){m(d.host.opts);var e=u.U.flatClone(d.host.opts.fileSystem);let t=u.runConversionsAndStoreResults(d.host.opts);null!=t&&t.globalNames&&(d.lastGlobalNames=t.globalNames);var r,n,i=d.host.opts.fileSystem;d.host.opts.fileSystem=e;for(r of Object.keys(i))d.host.setFile(r,i[r]);return t.fileSystem=u.U.flatClone(i),0==t.diagnostics.length&&(d.host.opts.skipPxtModulesEmit=!1,d.host.opts.skipPxtModulesTSC=!1,e=d.host.opts.target.isNative?"native":"js",!d.host.opts.target.switches.noIncr&&d.host.pxtModulesOK&&(d.host.opts.skipPxtModulesTSC=!0,d.host.opts.noEmit?d.host.opts.skipPxtModulesEmit=!0:d.host.opts.target.isNative?d.host.opts.skipPxtModulesEmit=!1:"js"!=d.host.pxtModulesOK||d.host.opts.breakpoints&&!d.host.opts.justMyCode||(d.host.opts.skipPxtModulesEmit=!0)),n=u.compile(d.host.opts,d.service),((t=Object.assign({sourceMap:t.sourceMap,fileSystem:t.fileSystem},n)).needsFullRecompile||(!t.success||t.diagnostics.length)&&d.host.opts.clearIncrBuildAndRetryOnError)&&(pxt.debug("triggering full recompile"),pxt.tickEvent("compile.fullrecompile"),d.host.opts.skipPxtModulesEmit=!1,n=u.compile(d.host.opts,d.service),t=Object.assign({sourceMap:t.sourceMap},n)),t.diagnostics.every(e=>!u.isPxtModulesFilename(e.fileName))&&(d.host.pxtModulesOK=e),t.ast)&&(n=u.internalGetApiInfo(t.ast))&&(d.lastApiInfo=n),t}d.runConversionsAndCompileUsingService=f,d.performOperation=function(e,t){d.service||(d.host=new s,d.service=c.createLanguageService(d.host));let r=null;if(i.hasOwnProperty(e))try{var n=i[e];r=n(t)||{}}catch(e){r={errorMessage:e.stack}}else r={errorMessage:"No such operation: "+e};return r}}})(ts=ts||{}),(G=>{var j,K;function r(e){return"object"==typeof e&&void 0!==e.default}function a(e){return"object"==typeof e&&"number"==typeof e.length}function z(e,t=!1){let i={},s=1;return function n(e){{if(r(e)){if(t){if(o(e.default))return n(e.default);let t=z(e.default,!1),r=i[t];if(r&&!e.isLiteral||(r=s,s++,i[t]=r),0<=t.indexOf(".")&&t.indexOf(" ")<0){let e=t.split(".");return e[e.length-1]="${"+r+":"+e[e.length-1]+"}",e.join(".")}return"${"+r+":"+t+"}"}return n(e.default)}return a(e)?e.map(e=>n(e)).join(""):e}}(e)}function o(e){return!!r(e)||!!a(e)&&e.map(o).reduce((e,t)=>e||t,!1)}function W(e){return e.attributes.shim&&"@"==e.attributes.shim[0]||e.attributes.pyConvertToTaggedTemplate}j=G.pxtc||(G.pxtc={}),(K=j.service||(j.service={})).snippetStringify=z,K.snippetHasReplacementPoints=o,K.snippetAddsDefinitions=function e(t){return r(t)?t.isDefinition||e(t.default):!!a(t)&&t.map(e).reduce((e,t)=>e||t,!1)},K.getSnippet=function a(o,l,e,c,u=0){let t,r,n,{apis:d,takenNames:i,blocksInfo:M,screenSize:p,checker:h,parameterOverride:s,includeParentSnippet:F}=o,m=pxt.py.INDENT,B=c?"python":"typescript",g=l.namespace,f=!1,_="",y=0;let b,v,T=(s&&(b=null==(t=Object.keys(s))?void 0:t[0])&&(v=s[b]),[]);if(W(l))return c?l.name+'(""" """)':l.name+"``";let k="",x=(k=e.kind==j.SK.Constructor?P(e.symbol)||e.parent.name.getText():P(e.symbol)||e.name.getText(),c&&(k=j.U.snakify(k)),l.attributes);if("TD_ID"===x.shim&&u&&e.parameters.length)return R(e.parameters[0]);var E=l;let S=pxt.blocks.compileInfo(E),C=M.blocksById,$=(null==(r=x._def)?void 0:r.parameters.filter(e=>!!S.definitionNameToParam[e.name]).map(e=>S.definitionNameToParam[e.name].actualName))||[],w=e.parameters?e.parameters.filter(e=>!e.initializer&&!e.questionToken||0<=$.indexOf(e.name.getText())):[];e=w.map(R).map(e=>({default:e,isLiteral:!0}));if(E.attributes.block)if(E.attributes.defaultInstance)g=E.attributes.defaultInstance,c&&(g=g&&j.U.snakify(g));else if("variables_get"===(null==(n=S.thisParameter)?void 0:n.shadowBlockId))g=S.thisParameter.defaultValue||S.thisParameter.definitionName,c&&(g=g&&j.U.snakify(g));else if(E.namespace){let n=d.byQName[E.namespace];if(n.attributes.fixedInstances){let t=j.Util.values(d.byQName);var I=t.filter(e=>4===e.kind&&e.attributes.fixedInstance);let e;var A=I.filter(e=>e.retType==n.qName).sort((e,t)=>e.name.localeCompare(t.name));e=(A.length?A:I.filter(e=>{return-1!==(r=n.qName,t.filter(e=>e.extendsTypes).filter(e=>e.extendsTypes.reduce((e,t)=>e||-1!=t.indexOf(r),!1)).reduce((e,t)=>e.concat(t.extendsTypes),[]).indexOf(e.retType));var r}).sort((e,t)=>e.name.localeCompare(t.name)))[0],(_=(e?(g=""+U(e),e):n).namespace)&&(f=!0)}else if(1==E.kind||2==E.kind){if(S.thisParameter){let e=void 0;S.thisParameter.definitionName&&(e="my"+(e=(e=S.thisParameter.definitionName)[0].toUpperCase()+e.substring(1))),g=S.thisParameter.defaultValue||e,c&&(g=g&&j.U.snakify(g))}}else if(8===n.kind)return}A=x&&(c?x.pySnippet:x.snippet);let D,N=(A?(D=[A],g=void 0):(D=[k],(null!=e&&e.length||1==E.kind||3==E.kind||8==E.kind)&&(I=e.reduce((e,t)=>[...e,e.length?", ":"",t],[]),D=D.concat(["(",...I,")"]))),g?[g,".",...D]:D);return N=f?[(A=_,(e=A.indexOf("."))<0?A:A.substring(0,e)),".",...N]:N,x&&x.blockSetVariable&&(N=c?[{default:O(j.U.snakify(x.blockSetVariable)),isDefinition:!0}," = ",...N]:["let ",{default:O(x.blockSetVariable),isDefinition:!0}," = ",...N]),F&&E.attributes.toolboxParent&&0===u?(v=[T,N],s={[b=E.attributes.toolboxParentArgument]:v},I=C[l.attributes.toolboxParent],a(Object.assign(Object.assign({},o),{parameterOverride:s}),I,K.lastApiInfo.decls[I.qName],c,u+1)):[T,N];function O(e){return i[e]?G.pxtc.decompiler.getNewName(e,i,!1):e}function R(r){var n=r.type;if(n){if(v&&r.symbol.escapedName===b)return z(v);var t=r.name.kind===j.SK.Identifier?r.name.text:void 0,i=null==(i=x.paramSnippets)?void 0:i[t];if(i)if(c){if(i.python)return i.python}else if(i.ts)return i.ts;if(i=null==(i=null==x?void 0:x.paramDefl)?void 0:i[t]){let e;if(n.kind==j.SK.AnyKeyword&&(s=i.toUpperCase(),e=Number.isNaN(+s)?"FALSE"==s||"TRUE"==s?j.SK.BooleanKeyword:s.includes(".")?j.SK.EnumKeyword:j.SK.StringKeyword:j.SK.NumberKeyword),n.kind===j.SK.StringKeyword||e===j.SK.StringKeyword)return 0!=i.indexOf('"')?`"${i}"`:i;let t=null==h?void 0:h.getTypeAtLocation(r);return null!=(s=K.getPxtSymbolFromTsSymbol(null==t?void 0:t.symbol,d,h))&&s.attributes.fixedInstances&&c?pxt.Util.snakify(i):c?j.tsSnippetToPySnippet(i,s):i}if(s=(t=>{var e=pxt.blocks.compileInfo(l);if(null!=(e=null==(e=e.parameters)?void 0:e.find(e=>e.actualName===t))&&e.shadowBlockId&&(e=C[e.shadowBlockId])){var r=null==(r=e.attributes)?void 0:r.paramFieldEditor;if((r=r&&r[t])&&(e=e.attributes.paramFieldEditorOptions||{},"sprite"===r))return(e=>{var t={initColor:0,initWidth:16,initHeight:16};if(null!=e&&e.sizes){var r=e.sizes.split(";"),n=[];for(let e=0;e<r.length;e++){var i=r[e].split(",");if(2===i.length){let e=parseInt(i[0]),t=parseInt(i[1]);isNaN(e)||isNaN(t)||(e<0&&p&&(e=p.width),t<0&&p&&(t=p.height),n.push([e,t]))}}0<n.length&&(t.initWidth=n[0][0],t.initHeight=n[0][1])}return t.initColor=s(null==e?void 0:e.initColor,t.initColor),t.initWidth=s(null==e?void 0:e.initWidth,t.initWidth),t.initHeight=s(null==e?void 0:e.initHeight,t.initHeight),pxt.sprite.imageLiteralFromDimensions(t.initWidth,t.initHeight,t.initColor,B);function s(e,t){return e=parseInt(e),isNaN(e)?t:e}})(e[t])}return null})(t))return s;if(i=(e=>{let t=(x._shadowOverrides||{})[e];var r,n;if(!t)for(r of pxt.blocks.compileInfo(l).parameters)if(r.actualName===e){t=r.shadowBlockId;break}if(!t)return null;let i=C[t];return i?("TD_ID"===i.attributes.shim&&i.parameters.length&&(n=i.parameters[0].type,n=d.byQName[n],i=n||i),i):null})(t)){var s=K.getTsSymbolFromPxtSymbol(i,r,G.SymbolFlags.Enum);if(s=(s=s&&h.getTypeOfSymbolAtLocation(s,r))&&L(s))return s;if("KIND_GET"===(s=i.attributes).shim&&s.blockId){let t=s.kindNamespace||l.namespace;if(s=j.Util.values(d.byQName).find(e=>e.namespace===t&&e.attributes.isKind))return c?s.pyQName:s.qName}if(u<3&&K.lastApiInfo.decls[i.qName]&&(s=a(o,i,K.lastApiInfo.decls[i.qName],c,u+1)))return s}if(n.kind===j.SK.StringKeyword&&"leds"===t)return c?`"""
. . . . .
. . . . .
. . # . .
. . . . .
. . . . .
"""`:`\`
. . . . .
. . . . .
. . # . .
. . . . .
. . . . .
\``;if(n.kind===j.SK.FunctionType)return i=n,(s=h?h.getSignatureFromDeclaration(i):void 0)?V(s,!0):H(t);if(void 0!==(i=K.getBasicKindDefault(n.kind,c)))return i;let e=h&&h.getTypeAtLocation(r);if(e&&(s=L(e)))return s}return c?"None":"null"}function L(e){if(e.symbol&&e.symbol.flags&G.SymbolFlags.Enum)return K.getDefaultEnumValue(e,c);var t,r=K.getPxtSymbolFromTsSymbol(e.symbol,d,h);if(j.isObjectType(e)){var n=r&&r.attributes&&(c?r.attributes.pySnippet:r.attributes.snippet);if(n)return n;if(e.objectFlags&G.ObjectFlags.Anonymous)return(n=h.getSignaturesOfType(e,G.SignatureKind.Call))&&n.length?V(n[0],!1):H()}return e.flags&G.TypeFlags.NumberLike?"0":r&&r.attributes.fixedInstances&&(t=r,(n=pxt.Util.values(d.byQName).filter(e=>4===e.kind&&e.attributes.fixedInstance&&((e,t,r)=>t==r||!(!(e=e.byQName[t])||!e.extendsTypes)&&0<=e.extendsTypes.indexOf(r))(d,e.retType,t.qName))).length)?(e=n[0],c?e.pyQName:e.qName):void 0}function P(e){if(h&&(e=j.getFullName(h,e),e=d.byQName[e]))return U(e)}function U(e){return c?e.pyName:e.name}function V(r,n){let i="";var s=h.getReturnTypeOfSignature(r);if(s.flags&G.TypeFlags.NumberLike?i="return 0":s.flags&G.TypeFlags.StringLike?i='return ""':s.flags&(G.TypeFlags.Boolean|G.TypeFlags.BooleanLiteral)&&(i=c?"return False":"return false"),c){let e,t=(e=x.optionalVariableArgs?"()":`(${r.parameters.map(e=>e.name).join(", ")})`,k||"fn");return 0<y++&&(t+=y),n&&!/^on/i.test(t)&&(t="on"+pxt.Util.capitalize(t)),(s=w.filter(e=>!!((e=h&&h.getTypeAtLocation(e))&&e.symbol&&e.symbol.flags&G.SymbolFlags.Enum)).map(e=>{var t=(e=z(R(e)).toLowerCase()).lastIndexOf(".");return-1!==t?e.substr(t+1):e}).join("_"))&&(t+="_"+s),t=O(t=j.U.snakify(t)),T=[...T,T.length?"\n":"","def ",{default:t,isDefinition:!0},e,`:
`+m,{default:i||"pass"},`
`],{default:t}}{let e="()";return x.optionalVariableArgs||(n=G.mapToDisplayParts(e=>{h.getSymbolDisplayBuilder().buildSignatureDisplay(r,e,void 0,G.TypeFormatFlags.UseFullyQualifiedType)}),s=G.displayPartsToString(n),e=s.substr(0,s.lastIndexOf(":"))),["function",e,` {
`+m,{default:i},`
}`]}}function H(e){return c?(e=O(e=j.U.snakify(e=e||"fn")),T=[...T,T.length?"\n":"","def ",{default:e,isDefinition:!0},`():
`+m,{default:"pass"},`
`],{default:e}):"function () {}"}},K.isTaggedTemplate=W})(ts=ts||{}),(e=>{(e=(e=e.pxtc||(e.pxtc={})).transpile||(e.transpile={})).pyToTs=function(e,t=0){return pxt.py.py2ts(e)},e.tsToPy=function(e,t="main.ts"){return pxt.py.decompileToPython(e,t)}})(ts=ts||{}),(a=>{var e;{var o=a.pxtc||(a.pxtc={});o.getParentCallExpression=function(e){return i(e,e=>a.isCallExpression(e)?n.Found:a.isBlock(e)?n.Abort:n.Continue)},o.findCurrentCallArgIdx=function(e,t,r){let n=e.arguments.map(e=>e===t).indexOf(!0);if(!(0<=n)){var i;if(!(e.arguments.pos<=r&&r<e.end))return-1;if(0===e.arguments.length)return 0;n=0;for(i of e.arguments){if(!(i.end<=r))break;n++}e.arguments.hasTrailingComma||(n=Math.max(0,n-1))}return n};let n;function i(e,t){var r;if(e)return(r=t(e))===n.Continue?i(e.parent,t):r!==n.Abort?r===n.Found?e:r:void 0}function s(e){return i(e,e=>a.isModuleDeclaration(e)?n.Found:n.Continue)}(e=n=o.TraverseCheck||(o.TraverseCheck={}))[e.Found=0]="Found",e[e.Continue=1]="Continue",e[e.Abort=2]="Abort",o.traverseUp=i,o.enumMemberToQName=function(e,t){if(t.name.kind===o.SK.Identifier)return e.getFullyQualifiedName(e.getSymbolAtLocation(t.name))},o.findInnerMostNodeAtPosition=function e(t,r){for(var n of t.getChildren())if(!(n.kind>=a.SyntaxKind.FirstPunctuation&&n.kind<=a.SyntaxKind.LastPunctuation)){var i=n.getStart(),s=n.getEnd();if(i<=r&&r<s)return e(n,r)}return t&&t.kind===o.SK.SourceFile?null:t},o.getParentNamespace=s,o.getCurrentNamespaces=function e(t){var r;return(t=t&&s(t))?(r=t.name.getText(),[...e(t.parent),r]):[]},o.getEnumMembers=function(e,t){if(e&&t.symbol&&t.symbol.declarations&&t.symbol.declarations.length)for(let e=0;e<t.symbol.declarations.length;e++){var r=t.symbol.declarations[e];if(r.kind===o.SK.EnumDeclaration)return r.members}},o.isExported=function(e){if(e.modifiers&&e.modifiers.some(e=>e.kind==o.SK.PrivateKeyword||e.kind==o.SK.ProtectedKeyword))return!1;let t=e.symbol;if(!t)return!1;for(;;){var r=t.parent;if(!r)break;t=r}let n=t.valueDeclaration||t.declarations[0];return!(!(n=n.kind==o.SK.VariableDeclaration?n.parent.parent:n).parent||n.parent.kind!=o.SK.SourceFile)},o.isReadonly=function(e){return e.modifiers&&e.modifiers.some(e=>e.kind==o.SK.ReadonlyKeyword)}}})(ts=ts||{}),(e=>{var h=e.pxtc||(e.pxtc={});{var o=h.vm||(h.vm={});let p=h.assembler.emitErr,e=p("opcode name doesn't match","<name>");class i extends h.assembler.Instruction{constructor(e,t,r){super(e,t,r,r,!1)}emit(r){var n=r.words;if(n[0]!=this.name)return e;let i=this.opcode,s=1;var a=[];let o=null,l=null;for(let e=0;e<this.args.length;++e){var c=this.args[e];let t=n[s++];if("$"==c[0]){var u=this.ei.encoders[c];let e=null;if(u.isImmediate||u.isLabel){if(!t)return p("expecting number",t);if(t=t.replace(/^#/,""),null==(e=r.bin.parseOneInt(t)))return p("expecting number",t)}else h.oops();if(null==e)return p("didn't understand it",t);h.U.assert(0<=e),11111!=e&&"$lbl"==c&&(e=e-(r.bin.location()+2)>>1),a.push(e);var d=e;if(null==(e=u.encode(e)))return p(`argument (${d}) out of range or mis-aligned`,t);"$i3"==c?e=l|e<<6:"$i5"==c&&(e=l|e<<8),"$i2"==c||"$i4"==c?l=e:"$rt"==c?(11111!=e&&4096<e&&h.U.oops("label: "+t+" v="+e),i=32768|e,"callrt.p"==this.name&&(i|=8192)):r.isLong||e<0||255<e?(r.isLong=!0,"$lbl"==c&&--e,i=e>>9&65535|49152,o=this.opcode+(e<<7)&65535):i=this.opcode+(e<<7)&65535}else if(c!=t)return p("expecting "+c,t)}return n[s]?p("trailing tokens",n[s]):{stack:0,opcode:i,opcode2:o,numArgs:a,labelName:r.bin.normalizeExternalLabel(null)}}}o.VmInstruction=i,o.withPush={},o.opcodes=["stloc     $i1","ldloc     $i1","stfld     $i4, $i5","ldfld     $i4, $i5","newobj    $i1","ldcap     $i1","bitconv   $i1","stglb     $i1","ldglb     $i1","ldint     $i1","ldintneg  $i1","ldspecial $i1","ldnumber  $i1","ldlit     $i1","checkinst $i1","mapget","mapset","ret       $i2, $i3","popmany   $i1","pushmany  $i1","callind   $i1","callproc  $i1","calliface $i2, $i3","callget   $i1","callset   $i1","jmp       $lbl","jmpnz     $lbl","jmpz      $lbl","try       $lbl","push","pop"];class t extends h.assembler.AbstractProcessor{constructor(e){super(),this.addEnc("$i1","#0-8388607",e=>this.inrange(8388607,e,e)),this.addEnc("$i2","#0-31",e=>this.inrange(31,e,e)),this.addEnc("$i3","#0-262143",e=>this.inrange(262143,e,e)),this.addEnc("$i4","#0-255",e=>this.inrange(255,e,e)),this.addEnc("$i5","#0-32767",e=>this.inrange(32767,e,e)),this.addEnc("$lbl","LABEL",e=>this.inminmax(-4194304,4194303,e,e)).isLabel=!0;let t=1,r=this.addEnc("$rt","SHIM",e=>this.inrange(8388607,e,e)).isLabel=!0;for(var n of o.opcodes.concat(["callrt $rt"])){let e=new i(this,n,t);this.instructions[e.name]=[e],!r&&"callrt"!=e.name||(o.withPush[e.name]=!0,e=new i(this,n.replace(/\w+/,e=>e+".p"),64|t),this.instructions[e.name]=[e]),"mapset.p"==e.name&&(r=!1),t++}}testAssembler(){}postProcessRelAddress(e,t){return t}postProcessAbsAddress(e,t){return t}getAddressFromLabel(e,t,r,n=0){r=e.lookupLabel(r);return null==r?null:t.is32bit?r:r-(e.pc()+2)}toFnPtr(e,t){return e}wordSize(){return 8}peephole(e,t,r){var n,i,s=e.getOp();let a="";t&&(n=s+";"+(a=t.getOp()),(i=this.file.peepCounts)[n]=(i[n]||0)+1),"stloc"==s&&"ldloc"==a&&e.numArgs[0]==t.numArgs[0]?(/LAST/.test(t.text)&&e.update(""),t.update("")):o.withPush[s]&&"push"==a&&(e.update(e.text.replace(/\w+/,e=>e+".p")),t.update(""))}}o.VmProcessor=t}})(ts=ts||{}),(e=>{var t;e=e.py||(e.py={}),(t=e.VarModifier||(e.VarModifier={}))[t.NonLocal=0]="NonLocal",t[t.Global=1]="Global",e.isIndex=function(e){return"Index"===e.kind},e.isSubscript=function(e){return"Subscript"===e.kind}})(pxt=pxt||{}),(M=>{{var F=M.py||(M.py={}),B=M.blocks;let w,I,x,_=0,t=0,A=0,i="???",r=!1,s=void 0,D,N,O,R,L=void 0,P;function me(e){return null==e}function ge(e){return null!=e}function b(e){return M.tickEvent("python.todo.statement",{kind:e.kind}),B.mkStmt(B.mkText("TODO: "+e.kind))}function v(e){return M.tickEvent("python.todo.expression",{kind:e.kind}),B.mkText(" {TODO: "+e.kind+"} ")}let E=V({primType:"string"}),l=V({primType:"number"}),n=V({primType:"boolean"}),g=V({primType:"void"}),S=V({primType:"any"}),a=void 0,o={str:E,string:E,number:l,bool:n,void:g,any:S};function fe(e){e=M.U.flatClone(e);return delete e.pyAST,delete e.pyInstanceType,delete e.pyRetType,delete e.pySymbolType,delete e.moduleTypeMarker,delete e.declared,e.parameters&&(e.parameters=e.parameters.map(e=>(delete(e=M.U.flatClone(e)).pyType,e))),e}function T(e){if("("==e[0]&&M.U.endsWith(e,")"))return T(e.slice(1,-1));var t=e.indexOf(" => ");if(0<t){var r=e.slice(t+4);if(-1==r.indexOf(")[]"))return ye(T(r),((r=e.slice(1,t-1))?r.split(/, /):[]).map(e=>T(e.replace(/\w+\??: /,""))))}if(M.U.endsWith(e,"[]"))return H(T(e.slice(0,-2)));if("_py.Array"===e)return H(S);t=M.U.lookup(o,e);if(t)return t;if(!!e&&!isNaN(e))return l;if("T"==e||"U"==e)return V({primType:"'"+e});if(0<=e.indexOf("|"))return V({primType:"@union",typeArgs:e.split("|").map(e=>e.trim()).map(T)});r=$(e+"@type")||$(e);if(r){if(7==r.kind)return l;if(8==r.kind||9==r.kind)return r.pyInstanceType||V({classType:r});if(6==r.kind)return l;q(null,9502,M.U.lf("'{0}' is not a type near '{1}'",e,i||"???"))}else q(null,9501,M.U.lf("unknown type '{0}' near '{1}'",e,i||"???"));return V({primType:e})}function k(e){if(!e.pySymbolType){if(i=e.pyQName,e.parameters){pxtc.service.isTaggedTemplate(e)&&(e.parameters=[{name:"literal",description:"",type:"string",options:{}}]);for(var t of e.parameters)t.pyType||(t.pyType=T(t.type))}var r=e.pyRetType;if(Me(e)?e.pyRetType=V({moduleType:e}):e.retType?null!=(n=e.qName)&&n.endsWith(".__constructor")&&"void"===e.retType?(n=U(e.qName.substring(0,e.qName.lastIndexOf("."))),e.pyRetType=n?V({classType:n}):T(e.retType)):e.pyRetType=T(e.retType):e.pyRetType||(M.U.oops("no type for: "+e.pyQName),e.pyRetType=V({})),r&&X(e.pyAST,r,e.pyRetType),3==e.kind||1==e.kind){var n=e.parameters.map(e=>e.pyType);if(n.some(me))return q(null,9526,M.U.lf("function symbol is missing parameter types near '{1}'",i||"???")),V({});e.pySymbolType=ye(e.pyRetType,n.filter(ge))}else e.pySymbolType=e.pyRetType;8!=e.kind&&9!=e.kind||(e.pyInstanceType=V({classType:e})),i=void 0}return e.pySymbolType}function $(e){return M.U.lookup(I,e)||M.U.lookup(w,e)}function U(e){var t;if(e){var r=$(e);if(r)k(r);else if(e.indexOf(".")&&!e.endsWith(".__constructor")){var n=e.substring(0,e.lastIndexOf(".")),i=U(n);if(8===(null==i?void 0:i.kind)&&null!=(t=i.extendsTypes)&&t.length)return U(i.extendsTypes[0]+e.substring(n.length))}return r}}function _e(e,t){I={},w={};var r,n=M.U.toDictionary(t,e=>e);for(r of M.U.values(e.byQName))if(!n.hasOwnProperty(r.fileName)){let t=r;t.extendsTypes&&(t.extendsTypes=t.extendsTypes.filter(e=>e!=t.qName)),t.pyQName&&t.qName||q(null,9526,M.U.lf("Symbol '{0}' is missing qName for '{1}'",t.name,t.pyQName?"ts":"py")),w[t.pyQName]=t,w[t.qName]=t}a=T("Buffer")}function V(e={}){e=M.U.flatClone(e);return e.tid=++t,e}function H(e){return V({primType:"@array",typeArgs:[e]})}function ye(e,t){return V({primType:"@fn"+t.length,typeArgs:[e].concat(t)})}function be(e){return M.U.startsWith(e.primType||"","@fn")}function ve(e){return e.primType&&!M.U.startsWith(e.primType,"@")}function Te(e){return M.U.startsWith(e.primType||"","@union")}function G(){return x.currFun||x.currClass||x.currModule}function ke(){let e=G();for(;e&&e.parent;)e=e.parent;return e}function xe(){return"main"==x.currModule.name&&!x.currFun&&!x.currClass}function j(t,e,r,n){let i=(n=n||G()).vars[t],s=null==i?void 0:i.symbol;if(!s){let e=z(n);e&&(e+=".");var a=e+t;s="ClassDef"===n.kind?Q(2,a):!De(n)||r!==F.VarModifier.Global&&r!==F.VarModifier.NonLocal?De(n)?Z(4,t):Q(4,a):Q(4,t),i={symbol:s,modifier:r},n.vars[t]=i}for(var o of Object.keys(e))s[o]=e[o];return i}function K(e){return e.unifyWith?(e.unifyWith=K(e.unifyWith),e.unifyWith):e}function z(e){let t="";return e.parent&&"FunctionDef"!==e.parent.kind&&"AsyncFunctionDef"!==e.parent.kind&&((t=z(e.parent))?t+=".":t=""),"Module"==e.kind&&"main"==e.name?"":e.name?t+e.name:t+"?"+e.kind}function Ee(e){var t,r=M.U.lookup(h,e);if(r)return r;for(t of M.U.values(x.currModule.vars)){var n=t.symbol;if(n.isImport){if(n.expandsTo==e)return n.pyName||q(null,9553,lf("missing pyName")),n.pyName;if(n.isImport&&M.U.startsWith(e,(n.expandsTo||"")+"."))return n.pyName+e.slice(n.expandsTo.length)}}return e}function W(e){var t=e=>r?e:"";return(e=K(e)).primType?e.typeArgs&&"@array"==e.primType?W(e.typeArgs[0])+"[]":be(e)&&e.typeArgs?"("+e.typeArgs.slice(1).map(e=>"_: "+W(e)).join(", ")+") => "+W(e.typeArgs[0]):Te(e)&&e.typeArgs?e.typeArgs.map(W).join(" | "):e.primType+t("/P"):e.classType&&e.classType.pyQName?Ee(e.classType.pyQName)+t("/C"):e.moduleType&&e.moduleType.pyQName?Ee(e.moduleType.pyQName)+t("/M"):"any"}function q(e,t,r){var n;N.push((e=e,n=pxtc.DiagnosticCategory.Error,t=t,r=r,(e=e||s)&&x&&x.currModule?{fileName:D,start:e.startPos,length:e.endPos-e.startPos,line:void 0,column:void 0,code:t,category:n,messageText:r}:{fileName:D,start:0,length:0,line:void 0,column:void 0,code:t,category:n,messageText:r}))}function J(e){return e.primType||e.classType||(e.moduleType?(e.moduleType.moduleTypeMarker||(e.moduleType.moduleTypeMarker={}),e.moduleType.moduleTypeMarker):null)}function Se(e){return!J(K(e))}function Ce(e,t,r){(t=K(t)).classType!=r&&(Se(t)?t.classType=r:X(e,t,(k(e=r),e.pyInstanceType||q(null,9527,M.U.lf("Instance type symbol '{0}' is missing pyInstanceType",e)),e.pyInstanceType)))}function Y(e,t){X(e,ne(e),t)}function X(t,r,n){if(r!==n&&(r=K(r))!==(n=K(n))&&!Ae(r)&&!Ae(n))if("any"===r.primType)r.unifyWith=n;else{var e,i,s=J(r),a=J(n);if(s&&a)if(s===a){if(r.unifyWith=n,r.typeArgs&&n.typeArgs)for(let e=0;e<Math.min(r.typeArgs.length,n.typeArgs.length);++e)X(t,r.typeArgs[e],n.typeArgs[e]);r.unifyWith=n}else e=r,i=n,q(t,9500,M.U.lf("types not compatible: {0} and {1}",W(e),W(i)));else s&&!a?X(t,n,r):(A++,r.unifyWith=n)}}function we(e,t){var r=K(ne(e)),t=K(t);!function e(t,r){var n=K(t),t=K(r);if(n===t)return 1;r=J(n);let i=J(t);if(r===i)return 1;if(r&&i){if(Ie(r)&&Ie(i)&&r.extendsTypes&&r.extendsTypes.length&&r.extendsTypes.some(e=>e===i.qName))return 1;if(Te(t))for(var s of t.typeArgs||[])if(e(n,s))return 1}}(r,t)&&(be(r)||be(t)||ve(r)||ve(t))&&X(e,r,t)}function Ie(e){return!(null==e||!e.name)}function Ae(e){return null!=(e=null==e?void 0:e.primType)&&e.startsWith("'")}function Z(e,t){var r=/(.*)\.(.*)/.exec(t),n=r?r[2]:t;return{kind:e,name:n,pyName:n,qName:t,pyQName:t,namespace:r?r[1]:"",attributes:{},pyRetType:V()}}function Q(e,t){let r=I[t];return r?r.kind=e:((r=Z(e,t)).pyQName||q(null,9527,M.U.lf("Symbol '{0}' is missing pyQName",t)),I[r.pyQName]=r),r}function De(e){let t=e;for(;t;){if("FunctionDef"==t.kind)return 1;t=t.parent}}function Ne(t,r,n){if(!r.symInfo){let e=z(r);M.U.endsWith(e,".__init__")&&(e=e.slice(0,-9)+".__constructor"),De(n=n||G())?r.symInfo=Z(t,e):r.symInfo=Q(t,e);t=r.symInfo;t.pyAST=r,t.pyName||q(null,9528,M.U.lf("Symbol '{0}' is missing pyName",t.qName||t.name)),n.vars[t.pyName]={symbol:t}}return r.symInfo}function Oe(e){let t=e.symInfo.qName;return M.U.values(I).filter(e=>e.namespace==t&&2==e.kind)}function ee(e,t,r,n=!1,i=!1){let s;var a=U(s="__init__"===t?e.pyQName+".__constructor":t.startsWith(e.pyQName+".")?t:e.pyQName+"."+t);if(a)return a;if(!i)for(var o of e.extendsTypes||[]){o=U(o);if(o){o==e&&M.U.userError("field lookup loop on: "+o.qName+" / "+t);o=ee(o,t,r,!0);if(o)return o}}return!n&&e.pyAST&&"ClassDef"==e.pyAST.kind?((a=Q(2,s)).isInstance=!r,a):null}function Re(e,t,r=!1){var n,i=ne(e),s=[(s=K(s=i)).classType,...Le(s.primType),s.moduleType].filter(ge);for(n of s){var a=!!i.moduleType,o=ee(n,t,a,r);if(o)return a?o.isInstance&&q(null,9505,M.U.lf("the field '{0}' of '{1}' is not static",t,n.pyQName)):(We(e)||"Name"==(a=e).kind&&"self"==a.id&&(x.currClass||q(null,9529,M.U.lf("no class context found for {0}",o.pyQName)),o.namespace!=x.currClass.symInfo.qName))&&(o.isProtected=!0),o}return null}function Le(e){let t=[];return"@array"==e?t=[$("_py.Array"),$("Array")]:"string"==e&&(t=[$("_py.String"),$("String")]),t.filter(e=>!!e)}function Pe(e){let t=G();var r=M.U.lookup(t.vars,e);if(r)return r;for(;t;){var n=M.U.lookup(t.vars,e);if(n)return n;for(;(t=t.parent)&&"ClassDef"==t.kind;);}return null}function te(e){if(!e)return null;var t=e.indexOf(".");if(0<t){var r=Pe(e.slice(0,t)),r=null==r?void 0:r.symbol;r&&r.pyQName!=r.pyName&&(e=r.pyQName+e.slice(t))}else{r=Pe(e);if(r)return r}t=U(e);return t?{symbol:t}:void 0}function re(e){return null==(e=te(e))?void 0:e.symbol}function ne(e){return e.tsType?K(e.tsType):(e.tsType=V(),e.tsType)}function Me(e){if(e)switch(e.kind){case 5:case 9:case 8:case 6:return 1;default:return}}function Fe(e){var t=M.U.flatClone(x);let r;try{r=e()}finally{x=t}return r}function ie(e,t){return 0==t.length?B.mkText(""):B.mkGroup([B.mkText("/* TODO: "+e+" "),B.mkGroup(t),B.mkText(" */"),B.mkNewLine()])}function Be(e){var t=pe(e.value);return e.arg?B.mkInfix(B.mkText(e.arg),"=",t):B.mkGroup([B.mkText("**"),t])}function $e(e){if(!e)return V();var t=oe(e);if(t){var r=$(t+"@type")||$(t);if(r){if(k(r),6==r.kind)return l;if(r.pyInstanceType)return r.pyInstanceType}else if(o[t])return o[t];q(e,9506,M.U.lf("cannot find type '{0}'",t))}else if(F.isSubscript(e)){r="List"===oe(e.value);if(r)if(F.isIndex(e.slice))return H($e(e.slice.value))}return q(e,9507,M.U.lf("invalid type syntax")),V({})}function Ue(e){return e.pyName&&"_"==e.pyName[0]?e.isProtected?B.mkText("protected "):B.mkText("private "):B.mkText("")}let c={Sub:1,Div:1,Pow:1,LShift:1,RShift:1,BitOr:1,BitXor:1,BitAnd:1,FloorDiv:1,Mult:1},u={Eq:1,NotEq:1,Lt:1,LtE:1,Gt:1,GtE:1},d={Add:"+",Sub:"-",Mult:"*",MatMult:"Math.matrixMult",Div:"/",Mod:"%",Pow:"**",LShift:"<<",RShift:">>",BitOr:"|",BitXor:"^",BitAnd:"&",FloorDiv:"Math.idiv",And:"&&",Or:"||",Eq:"==",NotEq:"!=",Lt:"<",LtE:"<=",Gt:">",GtE:">=",Is:"===",IsNot:"!==",In:"py.In",NotIn:"py.NotIn"},p={Invert:"~",Not:"!",UAdd:"P+",USub:"P-"},h={"adafruit_bus_device.i2c_device.I2CDevice":"pins.I2CDevice"};function se(e){x.blockDepth++;e=B.mkBlock(e.map(he));return x.blockDepth--,e}function Ve(e){e.vars||(e.vars={},e.parent=G(),e.blockDepth=x.blockDepth)}function He(e,t=!1){return"any"===W(e)?t?B.mkText(": any"):B.mkText(""):B.mkText(": "+W(e))}function e(t,e){try{return Fe(e)}catch(e){return M.log(e),B.mkStmt(ie("conversion failed for "+(t.name||t.kind),[]))}}function Ge(e){return e&&e.pyAST&&"FunctionDef"==e.pyAST.kind&&(e=e.pyAST).callers&&1==e.callers.length?!e.callers[0].inCalledPosition:void 0}function je(h,m=!1){return e(h,()=>{var e=!!x.currClass&&!x.currFun,t=xe(),r=!!x.currFun,n=(Ve(h),re(z(h))),i=Ne(e?1:3,h);if(!m&&(n&&n.declared===_&&q(h,9520,lf("Duplicate function declaration")),i.declared=_,Ge(i)))return B.mkText("");e&&(i.isInstance=!0),x.currFun=h;let s="",a=h.name;var o,n=[ie("decorators",h.decorator_list.filter(e=>"property"==oe(e)?!(s="get"):"Attribute"!=e.kind||"setter"!=e.attr||"Name"!=e.value.kind||(a=e.value.id,!(s="set"))).map(pe))],l=(1<=h.body.length&&"Raise"==h.body[0].kind&&(h.alwaysThrows=!0),e?(x.currClass||q(h,9531,lf("method '{0}' is missing current class context",i.pyQName)),i.pyRetType||q(h,9532,lf("method '{0}' is missing a return type",i.pyQName)),"__init__"==h.name?(n.push(B.mkText("constructor")),Ce(h,i.pyRetType,x.currClass.symInfo)):("__get__"!=a&&"__set__"!=a||(l=null==(l=h.vars.value)?void 0:l.symbol,"__set__"==a&&l&&(d=ee(x.currClass.symInfo,"__get__",!1))&&d.pyAST&&"FunctionDef"==d.pyAST.kind&&X(h,l.pyRetType,d.pyRetType),a=a.replace(/_/g,"")),s||(s="_"==a[0]?i.isProtected?"protected":"private":"public",h.symInfo.isStatic&&(s+=" static")),n.push(B.mkText(s+" "),ce(a)))):(M.U.assert(!s),"_"==h.name[0]||t||m||r?n.push(B.mkText("function "),ce(a)):n.push(B.mkText("export function "),ce(a))),"__init__"==h.name?void 0:h.returns?$e(h.returns):i.pyRetType),c=(n.push(((i,e)=>{let t,s=i.args;s.kwonlyargs.length&&q(i,9517,M.U.lf("keyword-only arguments not supported yet"));var r=s.args.slice();if(e?"self"!==(null==(t=r[0])?void 0:t.arg)?i.symInfo.isStatic=!0:r.shift():r.some(e=>"self"==e.arg)&&q(i,9519,M.U.lf("non-methods cannot have an argument called 'self'")),!i.symInfo.parameters){let n=s.defaults.length-r.length;i.symInfo.parameters=r.map(e=>{e.annotation||q(i,9519,M.U.lf("Arg '{0}' missing annotation",e.arg));var t=$e(e.annotation);let r="";return 0<=n&&(r=B.flattenNode([pe(s.defaults[n])]).output,X(e,t,ne(s.defaults[n]))),n++,{name:e.arg,description:"",type:"",initializer:r,default:r,pyType:t}})}return e=i.symInfo.parameters.map(e=>{var t=j(e.name,{isParam:!0}),t=null==t?void 0:t.symbol,t=(e.pyType||q(i,9530,M.U.lf("parameter '{0}' missing pyType",e.name)),X(i,k(t),e.pyType),[ce(e.name),He(e.pyType,!0)]);return e.default&&t.push(B.mkText(" = "+e.default)),B.mkGroup(t)}),s.vararg&&e.push(B.mkText("TODO *"+s.vararg.arg)),s.kwarg&&e.push(B.mkText("TODO **"+s.kwarg.arg)),B.H.mkParenthesizedExpression(B.mkCommaSep(e))})(h,e),l&&K(l)!=g?He(l):B.mkText("")),k(i),h.body.map(he));if("__init__"==h.name){x.currClass||q(h,9533,lf("__init__ method '{0}' is missing current class context",i.pyQName)),null!=(d=x.currClass)&&d.baseClass&&(t=h.body[0],r=x.currClass.baseClass.pyQName+".__constructor",(null==(i=null==(l=null==(e=t.value)?void 0:e.func)?void 0:l.symbolInfo)?void 0:i.pyQName)!==r)&&q(h,9575,lf("Sub classes must call 'super().__init__' as the first statement inside an __init__ method"));for(o of Oe(x.currClass)){var u=o.pyAST;u&&u.value&&c.push(B.mkStmt(B.mkText(`this.${ae(o.pyName)} = `),pe(u.value)))}}var d=nt(h);n.push(B.mkBlock(d.concat(c)));let p=B.mkGroup(n);return m?n[n.length-1].noFinalNewline=!0:p=B.mkStmt(p),p})}let m={FunctionDef:e=>je(e),ClassDef:a=>e(a,()=>{Ve(a);var e=Ne(8,a),t=(M.U.assert(!x.currClass),xe());(x.currClass=a).isNamespace=a.decorator_list.some(e=>"Name"==e.kind&&"namespace"==e.id);let r=a.isNamespace?[B.mkText("namespace "),ce(a.name)]:[ie("keywords",a.keywords.map(Be)),ie("decorators",a.decorator_list.map(pe)),B.mkText(t?"class ":"export class "),ce(a.name)],n=(!a.isNamespace&&0<a.bases.length&&("Enum"==oe(a.bases[0])?a.isEnum=!0:(r.push(B.mkText(" extends ")),r.push(B.mkCommaSep(a.bases.map(pe))),(t=(t=re(le(t=a.bases[0])))&&t.pyAST&&"ClassDef"==t.pyAST.kind?t.pyAST:null)?(a.baseClass=t.symInfo,e.extendsTypes=[t.symInfo.pyQName]):(t=oe(a.bases[0]))&&(i=re(t),t=U(t),a.baseClass=i||t,a.baseClass)&&(e.extendsTypes=[a.baseClass.pyQName]))),a.body.filter(e=>a.isNamespace||"FunctionDef"===e.kind));var i=a.isNamespace?[]:a.body.filter(e=>-1===n.indexOf(e)&&"Pass"!==e.kind),t=se(n);r.push(t);let s=!1;return i.length&&(s=!0,e=se(i),i=B.mkStmt(B.mkGroup([B.mkText(`public static __init${a.name}() `),e])),t.children.unshift(i)),a.isNamespace||(i=(e=Oe(a).map(e=>(e.pyName&&e.pyRetType||q(a,9535,lf("field definition missing py name or return type",e.qName)),e))).filter(e=>!e.isInstance),e=e.filter(e=>e.isInstance).map(e=>B.mkStmt(Ue(e),ce(e.pyName),He(e.pyRetType))),i=i.map(e=>{return B.mkGroup([B.mkStmt(Ue(e),B.mkText("static "),ce(e.pyName),He(e.pyRetType)),(t=ae(a.name),r=ae(e.pyName),e=W(e.pyRetType),n=`___${r}_is_set`,i="___"+r,B.mkStmt(B.mkStmt(B.mkText(`private ${n}: boolean`)),B.mkStmt(B.mkText(`private ${i}: `+e)),B.mkStmt(B.mkText(`get ${r}(): `+e),B.mkBlock([B.mkText(`return this.${n} ? this.${i} : ${t}.`+r)])),B.mkStmt(B.mkText(`set ${r}(value: ${e})`),B.mkBlock([B.mkStmt(B.mkText(`this.${n} = true`)),B.mkStmt(B.mkText(`this.${i} = value`))]))))]);var t,r,n,i}),t.children=i.concat(e).concat(t.children)),s&&(r=[B.mkStmt(B.mkGroup(r)),B.mkStmt(B.mkText(a.name+`.__init${a.name}()`))]),B.mkStmt(B.mkGroup(r))}),Return:e=>{var t;return e.value?((t=x.currFun)&&(t.symInfo.pyRetType||q(e,9536,lf("function '{0}' missing return type",t.symInfo.pyQName)),Y(e.value,t.symInfo.pyRetType)),B.mkStmt(B.mkText("return "),pe(e.value))):B.mkStmt(B.mkText("return"))},AugAssign:e=>{var t=d[e.op];return 3<t.length?B.mkStmt(B.mkInfix(pe(e.target),"=",B.H.mkCall(t,[pe(e.target),pe(e.value)]))):B.mkStmt(pe(e.target),B.mkText(" "+t+"= "),pe(e.value))},Assign:e=>Ke(e),AnnAssign:e=>Ke(e),For:t=>{if(M.U.assert(0==t.orelse.length),t.target.forTargetEndPos=t.endPos,ue(t.iter,"range")){var r,n=t.iter,i=pe(t.target),s=ce(le(t.target)),a=(Y(t.target,l),1==n.args.length?B.mkText("0"):pe(n.args[0])),o=pe(n.args[1==n.args.length?0:1]);if(n.args.length<=2)return B.mkStmt(B.mkText("for ("),B.mkInfix(i,"=",a),B.mkText("; "),B.mkInfix(s,"<",o),B.mkText("; "),B.mkPostfix([s],"++"),B.mkText(")"),se(t.body));let e="Num"===n.args[2].kind?n.args[2].n:void 0;if(null==e&&"UnaryOp"===n.args[2].kind&&"Num"===(r=n.args[2]).operand.kind&&("UAdd"===r.op?e=r.operand.n:"USub"===r.op&&(e=-r.operand.n)),void 0!==e)return r=0<e?"<":">",B.mkStmt(B.mkText("for ("),B.mkInfix(i,"=",a),B.mkText("; "),B.mkInfix(s,r,o),B.mkText("; "),B.mkInfix(s,"+=",pe(n.args[2])),B.mkText(")"),se(t.body))}return 1<_&&(i=ne(t.target),Y(t.iter,ne(t.iter)==E?i:H(i))),B.mkStmt(B.mkText("for ("),pe(t.target),B.mkText(" of "),pe(t.iter),B.mkText(")"),se(t.body))},While:e=>(M.U.assert(0==e.orelse.length),B.mkStmt(B.mkText("while ("),pe(e.test),B.mkText(")"),se(e.body))),If:e=>{let r=e=>{var t=[B.mkText("if ("),pe(e.test),B.mkText(")"),se(e.body)];return e.orelse.length&&(t[t.length-1].noFinalNewline=!0,1==e.orelse.length&&"If"==e.orelse[0].kind?(t.push(B.mkText(" else ")),M.U.pushRange(t,r(e.orelse[0]))):t.push(B.mkText(" else"),se(e.orelse))),t};return B.mkStmt(B.mkGroup(r(e)))},With:t=>{if(1==t.items.length&&(i=t.items[0].context_expr,s="pins.I2CDevice",(i=ne(i)).classType&&i.classType.pyQName==s||W(i)==s)){var r,n,i=t.items[0],s=[];let e=pe(i.context_expr);return i.optional_vars&&(n=oe(i.optional_vars))&&(r=null==(r=j(n,{isLocal:!0}))?void 0:r.symbol,n=ae(n),s.push(B.mkStmt(B.mkText("const "+n+" = "),e)),r.pyRetType||q(t,9537,lf("function '{0}' missing return type",r.pyQName)),Y(i.context_expr,r.pyRetType),e=B.mkText(n)),s.push(B.mkStmt(B.mkInfix(e,".",B.mkText("begin()")))),M.U.pushRange(s,t.body.map(he)),s.push(B.mkStmt(B.mkInfix(e,".",B.mkText("end()")))),B.mkGroup(s)}var s;let a=[];var i=t.items.map((e,t)=>{let r="with"+t;return e.optional_vars&&(j(t=le(e.optional_vars),{isLocal:!0}),r=ae(t)),a.push(B.mkStmt(B.mkText(r+".end()"))),B.mkStmt(B.mkText("const "+r+" = "),B.mkInfix(pe(e.context_expr),".",B.mkText("begin()")))});return M.U.pushRange(i,t.body.map(he)),M.U.pushRange(i,a),B.mkBlock(i)},Raise:e=>{e=e.exc||e.cause;if(!e)return B.mkStmt(B.mkText("throw"));let t=void 0;return t=(t=e&&"Call"==e.kind&&1==e.args.length?pe(e.args[0]):t)||B.mkGroup([B.mkText("`"),pe(e),B.mkText("`")]),B.mkStmt(B.H.mkCall("control.fail",[t]))},Assert:e=>(e.msg||q(e,9537,lf("assert missing message")),B.mkStmt(B.H.mkCall("control.assert",[e.test,e.msg].filter(e=>!!e).map(pe)))),Import:e=>{for(var t of e.names)t.asname&&j(t.asname,{expandsTo:t.name}),r=e,t=t.name,U(t)||q(r,9503,M.U.lf("No module named '{0}'",t));var r;return B.mkText("")},ImportFrom:e=>{var t,r,n,i,s=[];for(t of e.names)"*"==t.name?(e.module||q(e,9538,lf("import missing module name")),j(e.module,{isImportStar:!0})):(n=U(r=e.module+"."+t.name),i=t.asname||t.name,Me(n)?(j(i,{isImport:n,expandsTo:r}),s.push(B.mkStmt(B.mkText(`import ${ae(i)} = `+r)))):j(i,{expandsTo:r}));return B.mkGroup(s)},ExprStmt:e=>{return"Str"==e.value.kind?((t=e.value.s).trim().split(/\n/).length<=1?t=t.trim():t+="\n",B.mkStmt(B.mkText("/** "+t+" */"))):B.mkStmt(pe(e.value));var t},Pass:e=>B.mkStmt(B.mkText("")),Break:e=>B.mkStmt(B.mkText("break")),Continue:e=>B.mkStmt(B.mkText("continue")),Delete:e=>(q(e,9550,M.U.lf("delete statements are unsupported")),b(e)),Try:e=>{var t,r=[B.mkText("try"),se(e.body.concat(e.orelse))];for(t of e.handlers)r.push(B.mkText("catch ("),t.name?ce(t.name):B.mkText("_")),t.type&&r.push(B.mkText("/* instanceof "),pe(t.type),B.mkText(" */")),r.push(B.mkText(")"),se(t.body));return e.finalbody.length&&r.push(B.mkText("finally"),se(e.finalbody)),B.mkStmt(B.mkGroup(r))},AsyncFunctionDef:e=>(q(e,9551,M.U.lf("async function definitions are unsupported")),b(e)),AsyncFor:e=>(q(e,9552,M.U.lf("async for statements are unsupported")),b(e)),AsyncWith:e=>(q(e,9553,M.U.lf("async with statements are unsupported")),b(e)),Global:e=>{var t,r=ke();G();for(t of e.names){M.U.lookup(r.vars,t)||q(e,9521,M.U.lf("No binding found for global variable"));var n=j(t,{},F.VarModifier.Global);n.firstRefPos<e.startPos&&q(e,9522,M.U.lf("Variable referenced before global declaration"))}return B.mkStmt(B.mkText(""))},Nonlocal:e=>{var t,r=ke(),n=G();for(t of e.names){var i=rt(t,n),i=(i&&i!==r&&i.vars[t].modifier!==F.VarModifier.Global||q(e,9523,M.U.lf("No binding found for nonlocal variable")),j(t,{},F.VarModifier.NonLocal));i.firstRefPos<e.startPos&&q(e,9524,M.U.lf("Variable referenced before nonlocal declaration"))}return B.mkStmt(B.mkText(""))}};function Ke(e){let t,r,n,i;if("Assign"===e.kind){if(1!=e.targets.length)return q(e,9553,M.U.lf("multi-target assignment statements are unsupported")),b(e);i=e.targets[0],n=e.value,t=null,r=null}else{if("AnnAssign"!==e.kind)return e;i=e.target,n=e.value||null,t=e.annotation,r=$e(t),Y(i,r)}let s="",a=!!n&&ue(n,"const");var o=oe(i)||"";if(xe()||x.currClass||x.currFun||"_"==o[0]||(s="export "),o&&x.currClass&&!x.currFun){a=!(!n||!x.currClass.isNamespace);var l=ee(x.currClass.symInfo,o,!0);if(l||q(e,9544,lf("cannot get class field")),0==_)return B.mkText("/* skip for now */");l.pyRetType||q(e,9539,lf("function '{0}' missing return type",l.pyQName)),Y(i,l.pyRetType),l.isInstance=!1,x.currClass.isNamespace&&(s=`export ${a?"const":"let"} `)}if(!n)return q(e,9555,M.U.lf("unable to determine value of assignment")),b(e);if(Y(i,ne(n)),a)return j(le(i),{}),/^static /.test(s)||/const/.test(s)||(s+="const "),B.mkStmt(B.mkText(s),B.mkInfix(pe(i),"=",pe(n)));if(!s&&"Tuple"==i.kind){var l=e,c=i,e=n,u=c.elts.filter(e=>"Name"!==e.kind);if(u.length)return q(l,9556,M.U.lf("non-trivial tuple assignment unsupported")),b(l);var d=(u=c.elts.map(oe)).map(e=>e?G().vars[e]:void 0);if(d.some(e=>void 0!==(null==e?void 0:e.modifier))){var p=(()=>{var e=G();return void 0===e.nextHelperVariableId&&(e.nextHelperVariableId=0),"___tempvar"+e.nextHelperVariableId++})(),h=[B.mkStmt(B.mkInfix(B.mkGroup([B.mkText("let "),B.mkText(p)]),"=",pe(e)))];for(let e=0;e<d.length;e++){var m=g(c.elts[e]);h.push(B.mkStmt(B.mkInfix(m,"=",B.mkGroup([B.mkText(p),B.mkText(`[${e}]`)]))))}return B.mkGroup(h)}return l=[B.mkText("let "),B.mkText("[")],u=c.elts.map(e=>e).map(e=>g(e,!0)),l.push(B.mkCommaSep(u)),l.push(B.mkText("]")),B.mkStmt(B.mkInfix(B.mkGroup(l),"=",pe(e)));function g(e,t=!1){Je(e,"identifierCompletion"),ne(e);Xe(e);return ze(e,t)}}"Name"===i.kind&&(e=null==(u=G().vars[o])?void 0:u.symbol)&&4===e.kind&&void 0===u.modifier&&(void 0===u.firstAssignPos||u.firstAssignPos>i.startPos)&&(u.firstAssignPos=i.startPos,u.firstAssignDepth=x.blockDepth);let f=void 0;return t&&r&&("NameConstant"===n.kind&&null===n.value||"List"===n.kind&&0===n.elts.length)&&(o=W(r),f=B.mkInfix(pe(i),":",B.mkText(o))),f=f||pe(i),B.mkStmt(B.mkText(s),B.mkInfix(f,"=",pe(n)))}function ze(e,t=!1){var r=e.id;let n=te(r),i=null==n?void 0:n.symbol;var s=G().vars[r],s=null==s?void 0:s.symbol;return void 0===e.isdef&&(!i||4===i.kind&&i!==s?(n=x.currClass&&!x.currFun?(e.isdef=!1,j(r,{})):j(r,{isLocal:e.isdef=!0}),i=n.symbol):e.isdef=!1,e.symbolInfo=i,e.tsType||q(e,9540,lf("definition missing ts type")),i.pyRetType||q(e,9568,lf("missing py return type")),X(e,e.tsType,i.pyRetType)),e.isdef&&it(n,G())&&(e.isdef=!1),Ze(n,e),e.isdef&&!t?B.mkGroup([B.mkText("let "),ce(r)]):null==i||!i.namespace||null==i||!i.qName||null!=(s=x.currClass)&&s.isNamespace&&(null==(e=x.currClass)?void 0:e.name)===(null==i?void 0:i.namespace)?ce(r):ce(i.qName)}function ae(e){return B.isReservedWord(e)?e+"_":e}function oe(e){if("Name"==e.kind){var t=e.id,r=Pe(t),n=null==r?void 0:r.symbol;if(n){if(n.expandsTo)return n.expandsTo;if(x.currClass&&!x.currFun&&(null==r||!r.modifier)&&n.qName)return n.qName}return t}if("Attribute"==e.kind){r=oe(e.value);if(r)return r+"."+e.attr}if(We(e)&&null!=(n=x.currClass)&&n.baseClass)return x.currClass.baseClass.qName}function le(e){var t=oe(e);return t||q(null,9542,lf("Cannot get name of unknown expression kind '{0}'",e.kind)),t}function ce(e){return"self"==e?B.mkText("this"):B.mkText(ae(e))}function ue(e,t){return"Call"==e.kind&&oe(e.func)===t}function de(e,t,r){t=d[t];return M.U.assert(!!t),3<t.length?B.H.mkCall(t,[e,r]):B.mkInfix(e,t,r)}let f={memoryview:{n:"",t:a},const:{n:"",t:l},"micropython.const":{n:"",t:l}},C=(()=>{let r={};return Object.keys(pxtc.ts2PyFunNameMap).forEach(e=>{var t=pxtc.ts2PyFunNameMap[e];t&&t.n&&(e={n:e,t:(e=>{switch(e){case ts.SyntaxKind.StringKeyword:return E;case ts.SyntaxKind.NumberKeyword:return l;case ts.SyntaxKind.BooleanKeyword:return n;case ts.SyntaxKind.VoidKeyword:return g;case ts.SyntaxKind.AnyKeyword:return S;default:return a}})(t.t),scale:t.scale},r[t.n]=e)}),Object.keys(f).forEach(e=>{r[e]=f[e]}),r})();function We(e){return ue(e,"super")&&0==e.args.length}function qe(e){return R&&e.startPos<=R.position&&R.position<=e.endPos}function Je(e,t){100<_&&R&&null==L&&(R.type==t||"symbol"==R.type)&&qe(e)&&(L=e,P=G())}function Ye(e,t){t&&t.pyAST&&"FunctionDef"==t.pyAST.kind&&((t=t.pyAST).callers||(t.callers=[]),t.callers.indexOf(e)<0)&&t.callers.push(e)}let y={BoolOp:t=>{let r=pe(t.values[0]);for(let e=1;e<t.values.length;++e)r=de(r,t.op,pe(t.values[e]));return r},BinOp:e=>{var t=(e=>{if("Mod"!=e.op||"Str"!=e.left.kind||"Tuple"!=e.right.kind&&"List"!=e.right.kind)return null;{var t=e.left.s;let i=e.right.elts,s=(i=i.slice(),[B.mkText("`")]);return t.replace(/([^%]+)|(%[\d\.]*([a-zA-Z%]))/g,(e,t,r,n)=>(t?s.push(B.mkText(t.replace(/[`\\$]/g,e=>"\\"+e))):(t=(t=i.shift())?pe(t):B.mkText("???"),s.push(B.mkText("${"),t,B.mkText("}"))),"")),s.push(B.mkText("`")),B.mkGroup(s)}})(e);if(!t){var r=pe(e.left),n=pe(e.right);if(ot(e.left)&&ot(e.right)&&"Add"===e.op)return B.H.extensionCall("concat",[r,n],!1);t=de(r,e.op,n),c[e.op]&&(Y(e.left,l),Y(e.right,l),e.tsType||q(e,9570,lf("binary op missing ts type")),X(e,e.tsType,l))}return t},UnaryOp:e=>{var t=p[e.op];return"Not"!==e.op?(Y(e,l),Y(e.operand,l)):Y(e,n),M.U.assert(!!t),B.mkInfix(null,t,pe(e.operand))},Lambda:e=>(q(e,9574,M.U.lf("lambda expressions are not supported yet")),v(e)),IfExp:e=>B.mkInfix(B.mkInfix(pe(e.test),"?",pe(e.body)),":",pe(e.orelse)),Dict:r=>{x.blockDepth++;var e=r.keys.map((e,t)=>{t=r.values[t];return void 0===e?v(r):B.mkStmt(B.mkInfix(pe(e),":",pe(t)),B.mkText(","))}),e=B.mkBlock(e);return x.blockDepth--,e},Set:e=>v(e),ListComp:e=>v(e),SetComp:e=>v(e),DictComp:e=>v(e),GeneratorExp:r=>{if(1==r.generators.length&&"Comprehension"==r.generators[0].kind){let t=r.generators[0];if(0==t.ifs.length)return Fe(()=>{var e=le(t.target);return j(e,{isParam:!0}),B.mkInfix(pe(t.iter),".",B.H.mkCall("map",[B.mkGroup([ce(e),B.mkText(" => "),pe(r.elt)])]))})}return v(r)},Await:e=>v(e),Yield:e=>v(e),YieldFrom:e=>v(e),Compare:t=>{var e;if(1==t.ops.length&&("In"==t.ops[0]||"NotIn"==t.ops[0]))return K(ne(t.comparators[0]))==E&&Y(t.left,E),e=B.mkInfix(pe(t.comparators[0]),".",B.H.mkCall("indexOf",[pe(t.left)])),B.mkInfix(e,"In"==t.ops[0]?">=":"<",B.mkText("0"));let n=pe(t.left),i=pe(t.comparators[0]);var r=(e,t,r)=>{u[e]&&lt(t)&&lt(r)&&B.flattenNode([n])!==B.flattenNode([i])&&(n=B.H.mkParenthesizedExpression(B.mkGroup([n,B.mkText(" as any")])),i=B.H.mkParenthesizedExpression(B.mkGroup([i,B.mkText(" as any")])))};r(t.ops[0],t.left,t.comparators[0]);let s=de(n,t.ops[0],i);for(let e=1;e<t.ops.length;++e)n=pe(t.comparators[e-1]),i=pe(t.comparators[e]),r(t.ops[e],t.comparators[e-1],t.comparators[e]),s=de(s,"And",de(n,t.ops[e],i));return s},Call:r=>{r.func.inCalledPosition=!0;let t=oe(r.func);var e=re(t),n=e&&8==e.kind;let i=e,s=void 0,a=void 0,o="",l=(n?i=(i=re(e.pyQName+".__constructor"))||Ne(3,ct(null==e?void 0:e.pyAST)):"Attribute"==r.func.kind&&(c=r.func,a=c.value,(s=ne(a)).classType||s.primType)&&(o=c.attr,i=Re(a,o,!0))&&(o=i.name),r.args.slice());if("super"==t&&0==l.length)return x.currClass&&x.currClass.baseClass&&(r.tsType||q(r,9543,lf("call expr missing ts type")),Ce(r,r.tsType,x.currClass.baseClass)),B.mkText("super");if(ue(r,"int")&&1===l.length&&l[0]){var c=l[0],u=pe(c),c=ne(c);if("string"===c.primType)return B.mkGroup([B.mkText("parseInt"),B.mkText("("),u,B.mkText(")")]);if("number"===c.primType)return B.mkGroup([B.mkInfix(B.mkText("Math"),".",B.mkText("trunc")),B.mkText("("),u,B.mkText(")")])}if(!i){let e=M.U.lookup(C,t);if((o=e?"":o)&&(t=W(s)+"."+o,(e=M.U.lookup(C,t))||"@array"!=J(K(s))||(t="Array."+o,e=M.U.lookup(C,t))),o="",e)if("."==e.n[0]&&l.length){if(a=l.shift(),s=ne(a),o=e.n.slice(1),(i=Re(a,o))&&2==i.kind)return B.mkInfix(pe(a),".",B.mkText(o))}else i=U(e.n)}if(ue(r,"str"))return X(r,r.tsType,E),B.mkInfix(B.mkText('""'),"+",pe(r.args[0]));var c="Attribute"===r.func.kind&&We(r.func.value),u=(!i&&c&&(i=U(t)),"__init__"===(null==(u=x.currFun)?void 0:u.name)&&"__constructor"===(null==i?void 0:i.name)&&(null==(u=null==(u=x.currClass)?void 0:u.baseClass)?void 0:u.pyQName)===(null==i?void 0:i.namespace)&&c),d=((i=u?re((null==(c=null==(c=x.currClass)?void 0:c.baseClass)?void 0:c.pyQName)+".__constructor"):i)||q(r,9508,M.U.lf("can't find called function '{0}'",t)),i?i.parameters:null);let p=[];if(d){for(l.length>d.length&&q(r,9510,M.U.lf("too many arguments in call to '{0}'",i.pyQName));l.length<d.length;)l.push(null);l=l.slice(0,d.length);for(let t of r.keywords){var h=d.findIndex(e=>e.name==t.arg);h<0?q(t,9511,M.U.lf("'{0}' doesn't have argument named '{1}'",i.pyQName,t.arg)):null!=l[h]?q(t,9512,M.U.lf("argument '{0} already specified in call to '{1}'",t.arg,i.pyQName)):l[h]=t.value}for(let e=l.length-1;0<=e&&(d[e].initializer&&null==l[e]);e--)l.pop();for(let e=0;e<l.length;++e){var m,g=l[e];null!=g||d[e].initializer?g?(d[e].pyType||q(r,9545,lf("formal arg missing py type")),"any"!==(m=d[e].pyType).primType&&we(g,m),"Name"==g.kind&&Ge(g.symbolInfo)?p.push(je(g.symbolInfo.pyAST,!0)):p.push(pe(g))):(d[e].initializer||q(r,9547,lf("formal arg missing initializer")),p.push(B.mkText(d[e].initializer))):(q(r,9513,M.U.lf("missing argument '{0}' in call to '{1}'",d[e].name,i.pyQName)),p.push(B.mkText("null")))}}else i&&q(r,9509,M.U.lf("calling non-function")),p=l.map(pe);if(!L&&R&&"signature"==R.type&&qe(r)){L=r,P=G();for(let e=R.auxResult=0;e<l.length;++e){R.auxResult=e;var f=l[e];if(!f)break;if(f.startPos<=R.position&&R.position<=f.endPos)break}}if(i){if(i.pyRetType||q(r,9549,lf("function missing pyRetType")),a&&ot(a)&&s){var _,y=r,b=i,v=s;switch(b.qName){case"Array.pop":case"Array.removeAt":case"Array.shift":case"Array.find":case"Array.get":case"Array._pickRandom":Y(y,v.typeArgs[0]);break;case"Array.concat":case"Array.slice":case"Array.filter":case"Array.fill":Y(y,v);break;case"Array.reduce":"Call"===y.kind&&1<y.args.length&&(_=ne(y.args[1]))&&Y(y,_);break;case"Array.map":Y(y,H(S));break;default:Y(y,b.pyRetType)}}else Y(r,i.pyRetType);if((r.symbolInfo=i).attributes.py2tsOverride){c=(e=>{let t=new RegExp(/([^\$]*\()?([^\$\(]*)\$(\d)(?:(?:(?:=(\d+|'[a-zA-Z0-9_]*'|false|true|null|undefined))|(\?)|))/,"y"),r=[],n,i=0;for(;i=t.lastIndex,(n=t.exec(e))&&(n[1]&&r.push({kind:"text",text:n[1]}),r.push({kind:"arg",prefix:n[2],index:parseInt(n[3]),default:n[4],isOptional:!!n[5]})),n;);return null!=i?r.push({kind:"text",text:e.substr(i)}):r.push({kind:"text",text:e}),{parts:r}})(i.attributes.py2tsOverride);if(c)return o&&!a&&q(r,9550,lf("missing recv")),(c=((e,t,r)=>{var n,i=[];for(n of e.parts)if("text"===n.kind)i.push(B.mkText(n.text));else if(t[n.index]||n.default)n.prefix&&i.push(B.mkText(n.prefix)),t[n.index]?i.push(t[n.index]):i.push(B.mkText(n.default));else if(!n.isOptional)return;return r?B.mkInfix(r,".",B.mkGroup(i)):B.mkGroup(i)})(c,p,o?pe(a):void 0))||q(r,9555,lf("buildOverride failed unexpectedly")),c}else if(i.attributes.pyHelper)return B.mkGroup([B.mkInfix(B.mkText("_py"),".",B.mkText(i.attributes.pyHelper)),B.mkText("("),B.mkCommaSep(a?[pe(a)].concat(p):p),B.mkText(")")])}let T,k=(u?T=B.mkText("super"):o?(T=B.mkInfix(pe(a),".",B.mkText(o)),Je(r.func,"memberCompletion")):T=pe(r.func),[T,B.mkText("("),B.mkCommaSep(p),B.mkText(")")]);return i&&1==p.length&&pxtc.service.isTaggedTemplate(i)&&(k=[T,(c=p[0]).type==B.NT.Prefix&&'"'==c.op[0]?B.mkText(B.backtickLit(JSON.parse(c.op))):c]),n&&(e&&e.pyQName||q(r,9551,lf("missing namedSymbol or pyQName")),k[0]=B.mkText(Ee(e.pyQName)),k.unshift(B.mkText("new "))),B.mkGroup(k)},Num:e=>(e.tsType||q(e,9556,lf("tsType missing")),X(e,e.tsType,l),B.mkText(e.ns)),Str:e=>(e.tsType||q(e,9557,lf("tsType missing")),X(e,e.tsType,E),B.mkText(B.stringLit(e.s))),FormattedValue:e=>v(e),JoinedStr:e=>v(e),Bytes:e=>B.mkText(`hex\`${M.U.toHex(new Uint8Array(e.s))}\``),NameConstant:e=>(null!==e.value&&(e.tsType||q(e,9558,lf("tsType missing")),X(e,e.tsType,n)),B.mkText(JSON.stringify(e.value))),Ellipsis:e=>v(e),Constant:e=>v(e),Attribute:e=>{var t=pe(e.value),r=ne(e.value),n=Re(e.value,e.attr);let i=e.attr;return Je(e,"memberCompletion"),n?(e.symbolInfo=n,Ye(e,n),e.tsType&&n.pyRetType||q(e,9559,lf("tsType or pyRetType missing")),X(e,e.tsType,n.pyRetType),i=n.name):r.moduleType?(n=U(r.moduleType.pyQName+"."+e.attr))?(e.symbolInfo=n,Ye(e,n),Y(e,k(n)),i=n.name):q(e,9514,M.U.lf("module '{0}' has no attribute '{1}'",r.moduleType.pyQName,e.attr)):2<_&&q(e,9515,M.U.lf("unknown object type; cannot lookup attribute '{0}'",e.attr)),B.mkInfix(t,".",B.mkText(ae(i)))},Subscript:e=>{var t,r;return"Index"==e.slice.kind?(r=K(ne(e.value)),ot(e.value)?Y(e,r.typeArgs[0]):"string"===r.primType?Y(e,r):2<_&&Se(ne(e))&&Y(e,S),r=e.slice.value,2<_&&Se(ne(r))&&Y(r,l),B.mkGroup([pe(e.value),B.mkText("["),pe(r),B.mkText("]")])):"Slice"==e.slice.kind?(Y(e,r=ne(e.value)),(t=e.slice).step?(r="string"===(null==r?void 0:r.primType),B.H.mkCall(r?"_py.stringSlice":"_py.slice",[pe(e.value),t.lower?pe(t.lower):B.mkText("null"),t.upper?pe(t.upper):B.mkText("null"),pe(t.step)])):B.mkInfix(pe(e.value),".",B.H.mkCall("slice",[t.lower?pe(t.lower):B.mkText("0"),t.upper?pe(t.upper):null].filter(ge)))):v(e)},Starred:e=>B.mkGroup([B.mkText("... "),pe(e.value)]),Name:e=>{var t,r;return Je(e,"identifierCompletion"),"self"==e.id&&x.currClass?(e.tsType||q(e,9560,lf("missing tsType")),Ce(e,e.tsType,x.currClass.symInfo),B.mkText("this")):(r=null==(t=Xe(e))?void 0:t.symbol)&&r.isImport?ce(r.name):(Ze(t,e),0<=e.ctx.indexOf("Load")?r?null!=r&&r.qName?ce(r.qName.replace("@type","")):(q(e,9561,lf("missing qName")),ce("unknown")):ce(le(e)):ze(e))},List:Qe,Tuple:Qe};function Xe(e){let t=te(e.id);var r,n=null==t?void 0:t.symbol;if(t||(r=M.U.lookup(C,e.id))&&(t=te(r.n)),t&&n){if(e.symbolInfo=n,e.tsType||q(e,9562,lf("missing tsType")),X(e,e.tsType,k(n)),n.isImport)return t;Ye(e,n),e.forTargetEndPos&&t.forVariableEndPos!==e.forTargetEndPos&&(t.forVariableEndPos?t.lastRefPos=t.forVariableEndPos+1:t.forVariableEndPos=e.forTargetEndPos)}else 0<_&&q(e,9516,M.U.lf("name '{0}' is not defined",e.id));return t}function Ze(e,t){var r;e&&(e.modifier===F.VarModifier.Global?(r=ke())&&r.vars[e.symbol.name]&&(e=r.vars[e.symbol.name]):e.modifier===F.VarModifier.NonLocal&&(r=rt(e.symbol.name,G()))&&(e=r.vars[e.symbol.name]),(void 0===e.firstRefPos||e.firstRefPos>t.startPos)&&(e.firstRefPos=t.startPos),void 0===e.lastRefPos||e.lastRefPos<t.startPos)&&(e.lastRefPos=t.startPos)}function Qe(e){return e.tsType||q(e,9563,lf("missing tsType")),X(e,e.tsType,H(e.elts[0]?ne(e.elts[0]):V())),B.mkGroup([B.mkText("["),B.mkCommaSep(e.elts.map(pe)),B.mkText("]")])}function et(e){return e.startPos+":"+e.endPos}function pe(e){s=e;var t=y[e.kind],t=(t||M.U.oops(e.kind+" - unknown expr"),ne(e),t(e));return t.id=et(e),t}function he(e){s=e;var t=m[e.kind],r=(t||M.U.oops(e.kind+" - unknown stmt"),(e._comments||[]).map(e=>e.value));let n=t(e);return(n=r.length?B.mkGroup(r.map(e=>B.mkStmt(B.H.mkComment(e))).concat(n)):n).id=et(e),n}function tt(e){return!e||(e.type==B.NT.Prefix&&""==e.op?e.children.every(tt):e.type==B.NT.NewLine)}function rt(e,t){var r;if(t)return(r=t.vars&&t.vars[e])&&r.modifier!=F.VarModifier.NonLocal?t:rt(e,t.parent)}function nt(e){var t,r,n,i=[];for(t of Object.keys(e.vars))it(r=e.vars[t],e)&&i.push((r=null==r?void 0:r.symbol,n=void 0,n=ce(r.name),r=W(k(r)),B.mkStmt(B.mkGroup([B.mkText("let "),n,B.mkText(": "+r+";")]))));return i}function it(e,t){return 4===e.symbol.kind&&!e.symbol.isParam&&void 0===e.modifier&&(e.lastRefPos>e.forVariableEndPos||e.firstRefPos<e.firstAssignPos||e.firstAssignDepth>t.blockDepth)&&!("Module"===(t=t).kind&&"main"===t.name&&0===e.firstAssignDepth)}function st(e){if(M.U.assert("Module"==e.kind),!e.tsBody){t=e,x={currClass:void 0,currFun:void 0,currModule:t,blockDepth:0},D=t.tsFilename.replace(/\.ts$/,".py"),e.vars||(e.vars={});var t=nt(e).concat(e.body.map(he));if(!t.every(tt))return"main"==e.name?t:[B.mkText("namespace "+e.name+" "),B.mkBlock(t)]}}function at(e){_=e,N=[],A=0,s=void 0}function ot(e){e=K(ne(e));return e&&"@array"===e.primType}function lt(e){switch(e.kind){case"Num":case"Str":return 1;case"NameConstant":return null!==e.value}}function ct(e,t=e.symInfo){var r=$(t.pyQName+".__constructor");if(!r&&null!=(n=t.extendsTypes)&&n.length){var n=re(t.extendsTypes[0])||U(t.extendsTypes[0]);if(n)return ct(e,n)}t={kind:"FunctionDef",name:"__init__",startPos:e.startPos,endPos:e.endPos,parent:e,body:[],args:{kind:"Arguments",startPos:0,endPos:0,args:[{startPos:0,endPos:0,kind:"Arg",arg:"self"}],kw_defaults:[],kwonlyargs:[],defaults:[]},decorator_list:[],vars:{},symInfo:Z(3,e.symInfo.qName+".__constructor")};return t.symInfo.parameters=[],t.symInfo.pyRetType=V({classType:e.symInfo}),r&&(t.args.args.push(...r.parameters.map(e=>({startPos:0,endPos:0,kind:"Arg",arg:e.name}))),t.symInfo.parameters.push(...r.parameters.map(e=>e.pyType?e:Object.assign(Object.assign({},e),{pyType:T(e.type)})))),t}F.py2ts=function(t){var r=[],e={},n=(N=[],M.U.assert(!!t.sourceFiles,"missing sourceFiles! Cannot convert py to ts"),t.sourceFiles.filter(e=>M.U.endsWith(e,".py")));if(0==n.length)return{outfiles:e,diagnostics:N,success:0===N.length,sourceMap:[]};let i=(e,t)=>e.substr(0,e.length-t.length),s=M.U.toDictionary(n,e=>i(e,".py"));var a,o=t.sourceFiles.filter(e=>M.U.endsWith(e,".ts")).filter(e=>i(e,".ts")in s);M.U.assert(!!t.apisInfo,"missing apisInfo! Cannot convert py to ts"),D=n[0],_e(t.apisInfo,o),O=t,R=void 0,t.generatedFiles||(t.generatedFiles=[]);for(a of n){var l=a,c=a.replace(/\.py$/,"").replace(/.*\//,""),u=t.fileSystem[a];try{D=a;var d=M.py.lex(u),p=M.py.parse(u,l,d);M.U.pushRange(N,p.diagnostics),r.push({kind:"Module",body:p.stmts,blockDepth:0,name:c,source:u,tsFilename:l.replace(/\.py$/,".ts")})}catch(e){M.log("Parse error",e)}}var h,o=N;for(let e=0;e<5;++e){at(e);for(var m of r)try{st(m)}catch(e){M.log("Conv pass error",e)}if(0==A)break}at(1e3),L=void 0,R=t.syntaxInfo||{position:0,type:"symbol"};let g=[];for(h of r)try{var f,_,y=st(h);function b(e){var t=e.id.split(":");if(2==t.length)return{py:{startPos:(t=t.map(e=>parseInt(e)))[0],endPos:t[1]},ts:{startPos:e.startPos,endPos:e.endPos}}}y&&(f=B.flattenNode(y),t.sourceFiles.push(h.tsFilename),t.generatedFiles.push(h.tsFilename),t.fileSystem[h.tsFilename]=f.output,e[h.tsFilename]=f.output,_=f.sourceMap,g=_.map(b).filter(e=>!!e))}catch(e){M.log("Conv error",e)}N=o.concat(N);let v={},T=(n=M.U.values(w).concat(M.U.values(I)),[]);var k=e=>{(e=>{switch(e.kind){case 6:case 7:case 4:case 3:case 5:return!0;case 2:case 1:return!e.isInstance;default:return!1}})(e)&&T.indexOf(e)<0&&(e=fe(e),v[e.qName||e.name]=e)};for(let e=P;e;e=e.parent)e&&e.vars&&M.U.values(e.vars).map(e=>e.symbol).forEach(k);if(n.forEach(k),R&&L){if(L=L,R.beginPos=L.startPos,R.endPos=L.endPos,R.symbols||(R.symbols=[]),T=R.symbols.slice(),"memberCompletion"==R.type&&"Attribute"==L.kind){var x=ne(L.value);if(x.moduleType)for(var E of n)E.isInstance||E.namespace!=x.moduleType.qName||R.symbols.push(E);else if(x.classType||x.primType){o=x.classType||Le(x.primType).reduce((e,t)=>e||t,null);if(o){o.extendsTypes&&o.qName||q(null,9567,lf("missing extendsTypes or qName"));var S,C=o.extendsTypes.concat(o.qName);for(S of n)S.isInstance&&0<=C.indexOf(S.namespace)&&R.symbols.push(S)}}}else"identifierCompletion"==R.type?R.symbols=M.U.values(v):(o=L.symbolInfo)&&R.symbols.push(o);R.symbols=R.symbols.map(fe)}return n=(()=>{for(var e of N)F.patchPosition(e,t.fileSystem[e.fileName]);return N})(),{outfiles:e,success:0===n.length,diagnostics:n,syntaxInfo:R,globalNames:v,sourceMap:g}}}})(pxt=pxt||{}),(L=>{var e;{var P=L.py||(L.py={});let k,x=((e=k=P.TokenType||(P.TokenType={}))[e.Id=0]="Id",e[e.Op=1]="Op",e[e.Keyword=2]="Keyword",e[e.Number=3]="Number",e[e.String=4]="String",e[e.NewLine=5]="NewLine",e[e.Comment=6]="Comment",e[e.Indent=7]="Indent",e[e.Dedent=8]="Dedent",e[e.EOF=9]="EOF",e[e.Error=10]="Error",P.keywords={False:!0,None:!0,True:!0,and:!0,as:!0,assert:!0,async:!0,await:!0,break:!0,class:!0,continue:!0,def:!0,del:!0,elif:!0,else:!0,except:!0,finally:!0,for:!0,from:!0,global:!0,if:!0,import:!0,in:!0,is:!0,lambda:!0,nonlocal:!0,not:!0,or:!0,pass:!0,raise:!0,return:!0,try:!0,while:!0,with:!0,yield:!0},[]),E,S,C={"%":"Mod","&":"BitAnd","*":"Mult","**":"Pow","+":"Add","-":"Sub","/":"Div","//":"FloorDiv","<<":"LShift",">>":"RShift","@":"MatMult","^":"BitXor","|":"BitOr"},w={"!":"Bang","!=":"NotEq","(":"LParen",")":"RParen",",":"Comma","->":"Arrow",".":"Dot",":":"Colon",";":"Semicolon","<":"Lt","<=":"LtE","=":"Assign","==":"Eq",">":"Gt",">=":"GtE","[":"LSquare","]":"RSquare","{":"LBracket","}":"RBracket","~":"Invert"},I={b:/^[_0-1]$/,B:/^[_0-1]$/,o:/^[_0-7]$/,O:/^[_0-7]$/,x:/^[_0-9a-fA-F]$/,X:/^[_0-9a-fA-F]$/},A={b:2,B:2,o:8,O:8,x:16,X:16},D,N,O=0,R=0;function n(t,r){let n=0,i=0;for(let e=0;e<t;++e)10==r.charCodeAt(e)&&(n++,i=e);return{line:n,column:t-i-1}}function s(e){switch(e.type){case k.Id:return`id(${e.value})`;case k.Op:return"'"+S[e.value]+"'";case k.Keyword:return e.value;case k.Number:return`num(${e.value})`;case k.String:return e.stringPrefix+JSON.stringify(e.value);case k.NewLine:return"<nl>";case k.Comment:return`/* ${e.value} */`;case k.Indent:return"indent"+e.value;case k.Dedent:return"dedent";case k.Error:return`[ERR: ${e.value}]`;case k.EOF:return"End of file";default:return"???"}}P.position=n,P.patchPosition=function(e,t){var r;e.start||e.length?(r=n(e.start,t),e.line=r.line,e.column=r.column,0<e.length&&(r=n(e.start+e.length-1,t),e.endLine=r.line,e.endColumn=r.column+2)):(e.start=0,e.length=0,e.line=0,e.column=0)},P.tokenToString=s,P.friendlyTokenToString=function(e,t){var r=e.endPos-e.startPos;let n="";return n=(n=0==r?s(e):20<r?"`"+t.slice(e.startPos,e.startPos+20)+"`...":"`"+t.slice(e.startPos,e.endPos)+"`").replace(/\r/g,"").replace(/\n/g,"\\n").replace(/\t/g,"\\t")},P.tokensToString=function(e){let t="",r=0;for(var n of e){var i=s(n);70<r+i.length&&(r=0,t+="\n"),0!=r&&(t+=" "),t+=i,r+=i.length,n.type!=k.NewLine&&n.type!=k.Comment||(r=0,t+="\n")}return t},P.lex=function(e){if(0==x.length){var t,r,n={'"':h,"'":h,"#":_,"\\":f,".":b};E=L.U.clone(w);for(t of Object.keys(C))E[t]=C[t],E[t+"="]=C[t]+"Assign";S={};for(r of Object.keys(E))S[E[r]]=r;for(let t=0;t<128;++t)if(P.rx.isIdentifierStart(t))x[t]=o;else{var i=String.fromCharCode(t);if(n.hasOwnProperty(i))x[t]=n[i];else if(E.hasOwnProperty(i)){let e=!1,n=E[i];for(var s of Object.keys(E))s!=i&&s.startsWith(i)&&(e=!0);e?x[t]=()=>{var e,t=n,r=N.slice(R,O+1);2==r.length&&E.hasOwnProperty(r)&&(e=N.slice(R,O+2),t=3==e.length&&E.hasOwnProperty(e)?(O+=2,E[e]):(O++,E[r])),l(t)}:x[t]=()=>l(n)}else P.rx.isSpace(t)?x[t]=()=>{}:13==t?x[t]=()=>{10==N.charCodeAt(O)&&O++,m()}:P.rx.isNewline(t)?x[t]=m:v(t)?x[t]=y:x[t]=T}}for(N=e,D=[],O=0,R=0,g();O<N.length;){R=O;var a=N.charCodeAt(O++);a<128?x[a]():P.rx.isIdentifierStart(a)?o():P.rx.isSpace(a)||(P.rx.isNewline(a)?m:T)()}return R=O,m(),u(k.EOF,""),D;function u(e,t,r){e={type:e,value:t,startPos:R,endPos:O,auxValue:r};return D.push(e),e}function d(e){u(k.Error,e)}function o(){for(;P.rx.isIdentifierChar(N.charCodeAt(O));)O++;var e=N.slice(R,O),t=N.charCodeAt(O);P.keywords.hasOwnProperty(e)?u(k.Keyword,e):34==t||39==t?c(e):u(k.Id,e)}function l(e){u(k.Op,e)}function p(e){switch(e){case 97:return 7;case 98:return 8;case 102:return 12;case 110:return 10;case 114:return 13;case 116:return 9;case 118:return 11;default:return 0}}function c(e){var t=N.charCodeAt(O++);let r=!1;N.charCodeAt(O)==t&&N.charCodeAt(O+1)==t&&(O+=2,r=!0);var n=0<=(e=e.toLowerCase()).indexOf("r");let i="",s="";for(;;){var a,o,l=N.charCodeAt(O++);if(l==t){if(!r)break;if(N.charCodeAt(O)==t&&N.charCodeAt(O+1)==t){O+=2;break}s+="\\"+String.fromCharCode(t),i+=String.fromCharCode(t)}else if(92==l){let e=N.charCodeAt(O++);13==e&&10==N.charCodeAt(O)&&(e=10,O++),34==e||39==e||92==e?(n&&(s+="\\",i+="\\"),s+="\\"+String.fromCharCode(e),i+=String.fromCharCode(e)):!n&&p(e)?(s+="\\"+String.fromCharCode(e),i+=String.fromCharCode(p(e))):P.rx.isNewline(e)?n&&(i+="\\"+String.fromCharCode(e),s+="\\\\",10==e?s+="\\n":s+="\\u"+("0000"+e.toString(16)).slice(-4)):n||48!=e?n||117!=e&&120!=e?(s+="\\\\"+String.fromCharCode(e),i+="\\"+String.fromCharCode(e)):(o=117==e?4:2,a=N.slice(O,O+o),O+=o,o=parseInt(a,16),isNaN(o)&&d(L.U.lf("invalid unicode or hex escape")),s+="\\"+String.fromCharCode(e)+a,i+=String.fromCharCode(o)):(s+="\\\\x00",i+="\0")}else{if(isNaN(l)){d(L.U.lf("end of file in a string"));break}if(P.rx.isNewline(l)&&!r){d(L.U.lf("new line in a string"));break}i+=String.fromCharCode(l),s+=String.fromCharCode(l)}}var c=u(k.String,i);c.quoted=s,c.stringPrefix=e}function h(){O--,c("")}function m(){u(k.NewLine,""),g()}function g(){let e=0;for(;;){var t=N.charCodeAt(O);if(9==t)e=e+8&-8;else{if(32!=t)break;e++}O++}u(k.Indent,""+e)}function f(){var e=N.charCodeAt(O);P.rx.isNewline(e)?(O++,13==e&&10==N.charCodeAt(O)&&O++):d(L.U.lf("unexpected character after line continuation character"))}function _(){for(u(k.NewLine,"");O<N.length&&!P.rx.isNewline(N.charCodeAt(O));)O++;u(k.Comment,N.slice(R+1,O)),13==N.charCodeAt(O)&&10==N.charCodeAt(O+1)&&O++,O++,g()}function y(){var e=N[R];let t="";if("0"==e){var r,n=N[O],i=I[n];if(i){for(O++;;){var s=N[O];if(!i.test(s))break;t+=s,O++}return void(t?(r=parseInt(t,A[n]),isNaN(r)&&d(L.U.lf("invalid number")),u(k.Number,e+n+t,r)):d(L.U.lf("expecting numbers to follow 0b, 0o, 0x")))}}let a=!1,o=!1,l=!1;for(O=R;;){var c=N.charCodeAt(O);if((!l||43!=c&&45!=c)&&(l=!1,95!=c)&&!v(c))if(o||a||46!=c){if(o||69!=c&&101!=c)break;o=!0,l=!0}else a=!0;t+=String.fromCharCode(c),O++}!a&&!o&&"0"==e&&1<t.length&&!/^0+/.test(t)&&d(L.U.lf("unexpected leading zero"));n=parseFloat(t);isNaN(n)&&d(L.U.lf("invalid number")),u(k.Number,t,n)}function b(){v(N.charCodeAt(O))?y():u(k.Op,"Dot")}function v(e){return 48<=e&&e<=57}function T(){d(L.U.lf("invalid token"))}}}})(pxt=pxt||{}),(T=>{{var k=T.py||(T.py={});let u,i,s,a,o,d,l,p,h,m=!1,g="";function x(){return i[o]}function c(){for(;i[o];o++){var t=i[o];if(t.type==k.TokenType.Comment)d.push(t);else{if(0<=u&&t.type==k.TokenType.Op)switch(t.value){case"LParen":case"LSquare":case"LBracket":u++;break;case"RParen":case"RSquare":case"RBracket":u--}if(t.type!=k.TokenType.Error){if(0<u){if(t.type==k.TokenType.NewLine||t.type==k.TokenType.Indent)continue}else if(t.type==k.TokenType.Indent){if(i[o+1].type==k.TokenType.NewLine){o++;continue}var r=parseInt(t.value),e=l[l.length-1];if(r==e)continue;if(e<r)return void l.push(r);{t.type=k.TokenType.Dedent;let e=0;for(;l.length;){var n=l[l.length-1];if(!(r<n)){for(n!=r&&S(9552,T.U.lf("inconsitent indentation"));1<e;)i.splice(o,0,t),e--;return}l.pop(),e++}}}return}S(9551,t.value)}}}function E(){(p=x()).type!=k.TokenType.EOF&&(o++,c())}function S(e,t){t=t||T.U.lf("invalid syntax"),e=e||9550;var r=x(),t={code:e,category:pxtc.DiagnosticCategory.Error,messageText:T.U.lf("{0} near {1}",t,k.friendlyTokenToString(r,s)),fileName:a,start:r.startPos,length:r.endPos?r.endPos-r.startPos:0,line:0,column:0};k.patchPosition(t,s),m&&T.log(g+`TS${e} ${t.messageText} at ${t.line+1},`+(t.column+1)),h.push(t),9572!=e&&100<h.length&&T.U.userError(T.U.lf("too many parse errors"))}function n(e,t){var r=x();(r.type==e&&r.value==t||(S(9553,T.U.lf("expecting {0}",k.tokenToString({type:e,value:t,startPos:0,endPos:0}))),r.type!=k.TokenType.NewLine))&&E()}function C(){n(k.TokenType.NewLine,"")}function w(e){n(k.TokenType.Keyword,e)}function I(e){n(k.TokenType.Op,e)}function A(){var e=x();return e.type==k.TokenType.Keyword?e.value:""}function D(){var e=x();return e.type==k.TokenType.Op?e.value:""}let f={if:function e(){let t=O("If");E();t.test=j();t.body=N();"elif"==A()?t.orelse=[e()]:t.orelse=L();return R(t)},while:function(){var e=O("While");return w("while"),e.test=j(),e.body=N(),e.orelse=L(),R(e)},for:function(){var e=O("For");return w("for"),e.target=se(),H(e.target),w("in"),e.iter=V(),e.body=N(),e.orelse=L(),R(e)},try:function(){let e=O("Try"),t=(w("try"),e.body=N(),e.handlers=[],!1);for(;"except"==A();){var r=O("ExceptHandler");e.handlers.push(r),E(),"Colon"!=D()?(t&&S(),r.type=j(),"as"==A()?(E(),r.name=Q()):r.name=void 0):(t=!0,r.type=void 0,r.name=void 0),r.body=N()}e.orelse=L(),0==e.handlers.length&&e.orelse.length&&S();"finally"==A()?(E(),e.finalbody=N()):e.finalbody=[];return R(e)},with:function(){var e=O("With");return w("with"),e.items=Ee(T.U.lf("with item"),te),e.body=N(),R(e)},def:function(){var e=O("FunctionDef");w("def"),e.name=Q(),I("LParen"),e.args=le(!0),I("RParen"),e.returns=void 0,"Arrow"==D()&&(E(),e.returns=j());return e.body=N(),R(e)},class:function(){var e=O("ClassDef");{var t;w("class"),e.name=Q(),"LParen"==D()?(t=Ce(),e.bases=t.args,e.keywords=t.keywords):(e.bases=[],e.keywords=[])}return e.body=N(),R(e)}},t={del:function(){var e=O("Delete");return w("del"),e.targets=X(T.U.lf("expression"),W),R(e)},pass:function(){var e=O("Pass");return w("pass"),R(e)},break:function(){var e=O("Break");return E(),R(e)},continue:function(){var e=O("Continue");return E(),R(e)},return:function(){var e=O("Return");E(),M()?e.value=void 0:e.value=V();return R(e)},raise:function(){var e=O("Raise");w("raise"),e.exc=void 0,e.cause=void 0,M()||(e.exc=j(),"from"==A()&&(E(),e.cause=j()));return R(e)},global:F,nonlocal:function(){var e=F();return e.kind="Nonlocal",e},import:function(){var e=O("Import");return E(),e.names=Ee(T.U.lf("import name"),re),R(e)},from:function(){var e=O("ImportFrom");E(),e.level=(()=>{let e=0;for(;;){if("Dot"==D())e+=1;else{if("Ellipsis"!=D())return e;e+=3}E()}})(),x().type==k.TokenType.Id?e.module=B():e.module=void 0;e.level||e.module||S();{var t;w("import"),"Mult"==D()?(E(),(t=O("Alias")).name="*",e.names=[t]):"LParen"==D()?(E(),e.names=X(T.U.lf("import name"),$),I("RParen")):e.names=X(T.U.lf("import name"),$)}return R(e)},assert:function(){var e=O("Assert");E(),e.test=j(),"Comma"==D()?(E(),e.msg=j()):e.msg=void 0;return R(e)},yield:function(){x();if(E(),"from"==A())return(e=O("YieldFrom")).value=j(),P(R(e));var e=O("Yield");M()||(e.value=V());return P(R(e))}};function N(){if(I("Colon"),x().type!=k.TokenType.NewLine)return oe();{var t=g;m&&(T.log(g+"{"),g+="  "),E();let e;if(x().type!=k.TokenType.Indent)S(9554,T.U.lf("expected an indented block")),e=G();else{var r=parseInt(x().value);for(E(),e=G();;){if(x().type==k.TokenType.Dedent){var n=isNaN(r)||parseInt(x().value)<r;if(E(),n)break}if(T.U.pushRange(e,G()),x().type==k.TokenType.EOF)break}}return m&&(g=t,T.log(g+"}")),e}}function O(e,t){t=t||x();return{startPos:t.startPos,endPos:t.endPos,kind:e}}function R(e){return e.endPos=p.endPos,e}function L(){return"else"==A()?(E(),N()):[]}function te(){var e=O("WithItem");return e.context_expr=j(),e.optional_vars=void 0,"as"==A()&&(E(),e.optional_vars=W()),R(e)}function P(e){var t=O("ExprStmt");return t.startPos=e.startPos,t.endPos=e.endPos,t.value=e,t}function M(){var e=x();return e.type==k.TokenType.NewLine||e.type==k.TokenType.Op&&"Semicolon"==e.value}function F(){var e=O("Global");for(E(),e.names=[];e.names.push(Q()),"Comma"==D();)E();return R(e)}function B(){let e="";for(;;){if(e+=Q(),"Dot"!=D())return e;e+=".",E()}}function re(){var e=O("Alias");return e.name=B(),"as"==A()?(E(),e.asname=Q()):e.asname=void 0,R(e)}function $(){var e=O("Alias");return e.name=Q(),"as"==A()?(E(),e.asname=Q()):e.asname=void 0,R(e)}function ne(e,t){e=O("Tuple",e);return e.elts=t,R(e)}function U(e){var t=x(),e=X(T.U.lf("expression"),e),r=e[0];return 1!=e.length?ne(t,e):r}function ie(){return U(q)}function V(){return U(j)}function se(){return U(W)}function H(e){"Tuple"==e.kind?e.elts.forEach(H):e.ctx="Store"}function ae(){var e=T.U.lookup(t,A());return(e||(()=>{var e,t=x();let r=ie(),n=D();if("Assign"!=n)return"Colon"==n?((e=O("AnnAssign")).target=r,E(),e.annotation=j(),"Assign"==D()&&(E(),e.value=j()),e.simple=t.type==k.TokenType.Id&&"Name"==r.kind?1:0,H(e.target),R(e)):T.U.endsWith(n,"Assign")?((t=O("AugAssign")).target=r,t.op=n.replace("Assign",""),E(),t.value=V(),H(t.target),R(t)):"Semicolon"==n||x().type==k.TokenType.NewLine?((e=O("ExprStmt")).value=r,R(e)):(S(9555,T.U.lf("unexpected token")),E(),null);var i=O("Assign");for(i.targets=[r];;){if(E(),r=ie(),"Assign"!=(n=D())){i.value=r;break}i.targets.push(r)}return i.targets.forEach(H),R(i)}))()}function oe(){for(var e=[ae()];"Semicolon"==D()&&(E(),x().type!=k.TokenType.NewLine);)e.push(ae());return C(),e.filter(e=>!!e)}function G(){for(var e=h.length,t=x().type==k.TokenType.Indent,r=(t&&(E(),S(9573,T.U.lf("unexpected indent"))),[]);"MatMult"==D();)E(),r.push(we()),C();var n=A(),i=T.U.lookup(f,A());let s=[];var a,o=d,l=(d=[],"class"==n||"def"==n?((n=i()).decorator_list=r,s=[n]):r.length?S(9556,T.U.lf("decorators not allowed here")):s=i?[i()]:oe(),o.length&&s.length&&(s[0]._comments=o),[]);if(h.length>e){for(u=-1;p.type!=k.TokenType.Dedent&&p.type!=k.TokenType.NewLine&&(E(),m&&l.push(k.tokenToString(x())),x().type!=k.TokenType.EOF););t&&x().type===k.TokenType.Dedent&&E(),u=0,m&&T.log(g+"skip: "+l.join(", "))}if(m)for(var c of s)a="stmt",c=c,m&&T.log(g+a+": "+c.kind);return s}function le(t){var r=O("Arguments");for(r.args=[],r.defaults=[],r.kwonlyargs=[],r.kw_defaults=[],r.vararg=void 0;;){var n=D();if("Colon"==n||"RParen"==n)break;if("Mult"==n)r.vararg&&S(9557,T.U.lf("multiple *arg")),E(),x().type==k.TokenType.Id?r.vararg=i():r.vararg=void 0;else if("Pow"==n)r.kwarg&&S(9558,T.U.lf("multiple **arg")),E(),r.kwarg=i();else{r.kwarg&&S(9559,T.U.lf("arguments after **"));n=i();let e=void 0;"Assign"==D()&&(E(),e=j()),void 0!==r.vararg&&e?(r.kwonlyargs.push(n),r.kw_defaults.push(e)):(r.args.push(n),e?r.defaults.push(e):r.defaults.length&&S(9560,T.U.lf("non-default argument follows default argument")))}if("Comma"!=D())break;E()}return r.kwarg||(r.kwarg=void 0),r.vararg||(r.vararg=void 0),R(r);function i(){var e=O("Arg");return e.arg=Q(),e.annotation=void 0,t&&"Colon"==D()&&(E(),e.annotation=j()),e}}function ce(e){var t=O("Lambda");return E(),t.args=le(!1),I("Colon"),t.body=(e?ve:j)(),R(t)}function j(){var e,t;return"lambda"==A()?ce():(t=x(),e=K(),"if"==A()?((t=O("IfExp",t)).body=e,w("if"),t.test=K(),w("else"),t.orelse=j(),R(t)):e)}function ue(e,t){var r=x(),n=t();if(A()!=e)return n;var i=O("BoolOp",r);for(i.op="or"==e?"Or":"And",i.values=[n];A()==e;)w(e),i.values.push(t());return R(i)}function de(){return ue("and",pe)}function K(){return ue("or",de)}function pe(){if("not"==A())return e=O("UnaryOp"),E(),e.op="Not",e.operand=pe(),R(e);var e=x(),t=W();if(!he())return t;var r=O("Compare",e);for(r.left=t,r.comparators=[],r.ops=[];;){let e=he();if(!e)break;E(),"NotIn"==e?w("in"):"Is"==e&&"not"==A()&&(E(),e="IsNot"),r.ops.push(e),r.comparators.push(W())}return R(r)}let e={Lt:"Lt",Gt:"Gt",Eq:"Eq",GtE:"GtE",LtE:"LtE",NotEq:"NotEq",in:"In",not:"NotIn",is:"Is"};function he(){return e[D()]||e[A()]||null}let r={Invert:"Invert",Sub:"USub",Add:"UAdd"};function z(e,t){var r=x();let n=e();for(;;){var i=D();if(!(i&&0<=t.indexOf(","+i+",")))return n;var s=O("BinOp",r);s.left=n,s.op=i,E(),s.right=e(),n=s}}function me(){return z(ee,",Mult,MatMult,Div,Mod,FloorDiv,")}function ge(){return z(me,",Add,Sub,")}function fe(){return z(ge,",LShift,RShift,")}function _e(){return z(fe,",BitAnd,")}function ye(){return z(_e,",BitXor,")}function W(){return z(ye,",BitOr,")}function be(){var e,t=x();let r=void 0;return"Colon"!=D()&&(r=j()),"Colon"==D()?((t=O("Slice",t)).lower=r,E(),e=D(),t.upper="Colon"!=e&&"Comma"!=e&&"RSquare"!=e?j():void 0,t.step=void 0,"Colon"==D()&&(E(),"Comma"!=(e=D()))&&"RSquare"!=e&&(t.step=j()),R(t)):(r||S(9570,T.U.lf("unable to parse lower subscript")),(e=O("Index")).value=r,R(e))}function q(){var e;return"Mult"==D()?((e=O("Starred")).value=W(),R(e)):j()}function ve(){return"lambda"==A()?ce(!0):K()}function J(){for(var e=[];;){var t=O("Comprehension");for(t.is_async=0,e.push(t),w("for"),t.target=se(),H(t.target),w("in"),t.iter=K(),t.ifs=[];"if"==A();)E(),t.ifs.push(ve());if("for"!=A())return e}}function Te(){var e,t,r=x();return"Mult"==D()?(e=O("Starred"),E(),e.value=j(),R(e)):"Pow"==D()?(e=O("Keyword"),E(),e.arg=void 0,e.value=j(),R(e)):(e=j(),"Assign"==D()?("Name"!=e.kind&&S(9561,T.U.lf("invalid keyword argument; did you mean ==?")),E(),(t=O("Keyword",r)).arg=e.id||"???",t.value=j(),R(t)):"for"==A()?((t=O("GeneratorExp",r)).elt=e,t.generators=J(),R(t)):e)}function ke(){let s=x();var e,t,r;return E(),"Pow"==D()?(E(),n(void 0,W())):"RBracket"==D()?(e=O("Dict",s),E(),e.keys=[],e.values=[],R(e)):"Starred"!=(e=q()).kind&&"Colon"==D()?(E(),n(e,j())):(e=e,"for"==A()?("Starred"==e.kind&&S(9562,T.U.lf("iterable unpacking cannot be used in comprehension")),(t=O("SetComp",s)).elt=e,t.generators=J()):((t=O("Set",s)).elts=[e],"Comma"==D()?(r=Z("RBracket",T.U.lf("set element"),q),t.elts=[e].concat(r)):I("RBracket")),R(t));function a(){var e;return"Pow"==D()?(E(),[null,W()]):(e=j(),I("Colon"),[e,j()])}function n(e,t){var r;if("for"==A())return e||S(9563,T.U.lf("dict unpacking cannot be used in dict comprehension")),(r=O("DictComp",s)).key=e,r.value=t,r.generators=J(),R(r);var n,i=O("Dict",s);if(i.keys=[e],i.values=[t],"Comma"==D())for(n of Z("RBracket",T.U.lf("dict element"),a))2<=n.length&&n[0]&&n[1]&&(i.keys.push(n[0]),i.values.push(n[1]));else I("RBracket");return R(i)}}function Y(){var e=O("NameConstant");return e.value=null,E(),R(e)}function xe(){var e=D();return"RParen"==e||"RSquare"==e||"RBracket"==e||"Colon"==e||"Semicolon"==e||T.U.endsWith(e,"Assign")||"in"==A()||x().type==k.TokenType.NewLine}function X(e,t){var r=[];if(xe())return r;for(;;){r.push(t());var n="Comma"==D();if(n&&E(),xe())return r;if(!n)return S(9567,T.U.lf("expecting {0}",e)),r}}function Ee(e,t){for(var r=[];r.push(t()),"Comma"==D();)E();return r}function Z(e,t,r){E();var n=[];if(D()!=e)for(;;){n.push(r());var i="Comma"==D();if(i&&E(),D()==e)break;if(!i){S(9568,T.U.lf("expecting {0}",t));break}}return I(e),n}function Se(e,t,r){var n,i=x();return E(),D()==e?(E(),(n=O(t,i)).elts=[],R(n)):(n=q(),"for"==A()?((r=O(r,i)).elt=n,r.generators=J(),I(e),R(r)):"Comma"==D()?(r=O(t,i),E(),r.elts=X(T.U.lf("expression"),q),r.elts.unshift(n),I(e),R(r)):(I(e),"List"==t?((r=O(t,i)).elts=[n],R(r)):n))}function Q(){var e=x();return e.type!=k.TokenType.Id&&S(9569,T.U.lf("expecting identifier")),E(),e.value}function Ce(){var e,t=[],r=[];for(e of Z("RParen",T.U.lf("argument"),Te))("Keyword"==e.kind?r:(r.length&&S(9570,T.U.lf("positional argument follows keyword argument")),t)).push(e);return{args:t,keywords:r}}function we(){var e,t,r,n,i,s,a=x();let o=(()=>{var t,r=x();if(r.type==k.TokenType.Id)return t=O("Name"),E(),t.id=r.value,t.ctx="Load",R(t);if(r.type==k.TokenType.Number)return t=O("Num"),E(),t.ns=r.value,t.n=r.auxValue,R(t);if(r.type!=k.TokenType.String)return r.type==k.TokenType.Keyword?"None"==r.value||"True"==r.value||"False"==r.value?(t=O("NameConstant"),E(),t.value="True"==r.value||"False"!=r.value&&null,R(t)):(S(9564,T.U.lf("expecting atom")),Y()):r.type==k.TokenType.Op?"LParen"==(t=r.value)?Se("RParen","Tuple","GeneratorExp"):"LSquare"==t?Se("RSquare","List","ListComp"):("LBracket"==t?ke:(S(9565,T.U.lf("unexpected operator")),Y))():(S(9566,T.U.lf("unexpected token")),Y());{E();let e=r.value;for(;x().type==k.TokenType.String;)e+=x().value,E();return"b"==r.stringPrefix?((t=O("Bytes",r)).s=T.U.toArray(T.U.stringToUint8Array(e)),R(t)):((t=O("Str",r)).s=e,R(t))}})();for(;;){e=a,t=o,s=i=n=l=r=void 0;var l="LParen"==(s=D())?((r=O("Call",e)).func=t,i=Ce(),r.args=i.args,r.keywords=i.keywords,R(r)):"LSquare"==s?(i=x(),(r=O("Subscript",e)).value=t,0==(l=Z("RSquare",T.U.lf("subscript"),be)).length?S(9571,T.U.lf("need non-empty index list")):1==l.length?r.slice=l[0]:l.every(e=>"Index"==e.kind)?((n=l[0]).value=ne(i,l.map(e=>e.value)),r.slice=n):((n=O("ExtSlice",i)).dims=l,r.slice=R(n)),R(r)):"Dot"==s?((i=O("Attribute",e)).value=t,E(),i.attr=Q(),R(i)):t;if(l===o)return o;o=l}}function ee(){var e,t;return r[D()]?((t=O("UnaryOp")).op=r[D()],E(),t.operand=ee(),R(t)):(x(),t=we(),"Pow"==D()?(e=O("BinOp"),E(),e.left=t,e.op="Pow",e.right=ee(),R(e)):t)}let _={kind:1,id:2,n:3,s:4,func:5,key:6,elt:7,elts:8,keys:9,left:10,ops:11,comparators:12,names:13,items:14,test:15,targets:16,dims:17,context_expr:18,name:19,bases:20,type:21,inClass:22,target:23,annotation:24,simple:25,op:26,operand:27,right:28,values:29,iter:30,ifs:31,is_async:32,value:33,slice:34,attr:35,generators:36,args:37,keywords:38,body:39,handlers:40,orelse:41,finalbody:42,decorator_list:43,kwonlyargs:44,kw_defaults:45,defaults:46,arg:47},y={lineno:1,col_offset:1,startPos:1,endPos:1,kind:1},b={body:1,orelse:1,finalbody:1},v={_comments:1,ctx:1,ns:1};k.dump=function(e,c=!1){let u=(r,n)=>{if(Array.isArray(n)){let t="";for(let e=0;e<n.length;++e)0<e&&(t+=", "),t+=u(r,n[e]);return"["+t+"]"}if(!n||!n.kind)return JSON.stringify(n);let e="";var t,i=Object.keys(n);i.sort((e,t)=>(_[e]||100)-(_[t]||100)||T.U.strcmp(e,t));for(t of i)if(!(T.U.lookup(y,t)||c&&T.U.lookup(v,t)))if(e&&(e+=", "),e+=t+"=",Array.isArray(n[t])&&n[t].length&&T.U.lookup(b,t)){e+="[\n";var s,a=r+"  ";for(s of n[t])e+=a+u(a,s)+"\n";e+=r+"]"}else if("_comments"==t){e+="[\n";var o,l=r+"  ";for(o of n[t])e+=l+JSON.stringify(o.value)+"\n";e+=r+"]"}else e+=u(r,n[t]);return n.kind+"("+e+")"},t="";for(var r of e)t+=u("",r)+"\n";return t},k.parse=function(e,t,r){s=e,a=t,i=r,u=0,o=0,d=[],l=[0],h=[];let n=[];try{if(p=i[0],c(),x().type!=k.TokenType.EOF)for(n=G();x().type!=k.TokenType.EOF;)T.U.pushRange(n,G())}catch(e){S(9572,T.U.lf("exception: {0}",e.message))}return{stmts:n,diagnostics:h}}}})(pxt=pxt||{}),(j=>{{var K=j.py||(j.py={});function z(e,t,r){e={fileName:e.getSourceFile().fileName,start:e.getStart(),length:e.getEnd()-e.getStart(),line:void 0,column:void 0,code:t,category:pxtc.DiagnosticCategory.Error,messageText:r},t=new Error(r);throw t.pyDiagnostic=e,t}let H=!(K.decompileToPython=function(e,t){var r={blocksInfo:void 0,outfiles:{},diagnostics:[],success:!0,times:{}};try{var n=((e,r)=>{let d=e.getTypeChecker(),n=(new ts.pxtc.LSHost(e),e.getSourceFile(r)),i=pxtc.decompiler.buildCommentMap(n),t=j.U.toSet((()=>["ArithmeticError","AssertionError","AttributeError","BaseException","BlockingIOError","BrokenPipeError","BufferError","BytesWarning","ChildProcessError","ConnectionAbortedError","ConnectionError","ConnectionRefusedError","ConnectionResetError","DeprecationWarning","EOFError","Ellipsis","EnvironmentError","Exception","False","FileExistsError","FileNotFoundError","FloatingPointError","FutureWarning","GeneratorExit","IOError","ImportError","ImportWarning","IndentationError","IndexError","InterruptedError","IsADirectoryError","KeyError","KeyboardInterrupt","LookupError","MemoryError","NameError","None","NotADirectoryError","NotImplemented","NotImplementedError","OSError","OverflowError","PendingDeprecationWarning","PermissionError","ProcessLookupError","RecursionError","ReferenceError","ResourceWarning","RuntimeError","RuntimeWarning","StopAsyncIteration","StopIteration","SyntaxError","SyntaxWarning","SystemError","SystemExit","TabError","TimeoutError","True","TypeError","UnboundLocalError","UnicodeDecodeError","UnicodeEncodeError","UnicodeError","UnicodeTranslateError","UnicodeWarning","UserWarning","ValueError","Warning","ZeroDivisionError","_","__build_class__","__debug__","__doc__","__import__","__loader__","__name__","__package__","__spec__","abs","all","any","ascii","bin","bool","bytearray","bytes","callable","chr","classmethod","compile","complex","copyright","credits","delattr","dict","dir","divmod","enumerate","eval","exec","exit","filter","float","format","frozenset","getattr","globals","hasattr","hash","help","hex","id","input","int","isinstance","issubclass","iter","len","license","list","locals","map","max","memoryview","min","next","object","oct","open","ord","pow","print","property","quit","range","repr","reversed","round","set","setattr","slice","sorted","staticmethod","str","sum","super","tuple","type","vars","zip",...Object.keys(j.py.keywords)])(),e=>e),[f,a]=ts.pxtc.decompiler.buildRenameMap(e,n,{takenNames:t,declarations:"all"}),_=pxtc.getApiInfo(e),o=j.U.mapMap(_.byQName,(e,t)=>t.fileName==r?void 0:t),l=K.computeScopeVariableLookup(n);{let t=(e=n).getChildren().map(b).reduce((e,t)=>e.concat(t),[]).reduce((e,t)=>t||e[e.length-1]?[...e,t]:e,[]);return i.filter(e=>!e.owner).forEach(e=>t.push(...c(e))),t.join("\n")}function T(e){if(!e.getSourceFile())return null;let t=e.getText();var r=d.getSymbolAtLocation(e),r=(r&&(t=d.getFullyQualifiedName(r)),o[t]);if(r&&r.attributes.alias)return r.attributes.alias;if(r&&r.pyQName){if(r.isInstance){if(ts.isPropertyAccessExpression(e))return null;e=new RegExp(`(?:^|.)${r.namespace}.(.+)`).exec(r.pyQName);if(e)return e[1]}return r.pyQName}return t in pxtc.ts2PyFunNameMap?pxtc.ts2PyFunNameMap[t].n:null}function k(e){var t=T(e);if(t)return t;if(!ts.isIdentifier(e))return j.tickEvent("depython.todo.advancedname"),z(e,3001,"Unsupported advanced name format: "+e.getText());let r=e.text;var t=e.getSourceFile();return r=t&&(t=f.getRenameForPosition(e.getStart()))?t.name:r}function p(e,t){return 0!=(e.flags&t)}function s(e,t){return p(d.getTypeAtLocation(e),t)}function x(e){return s(e,ts.TypeFlags.StringLike)}function y(e){return s(e,ts.TypeFlags.NumberLike)}function b(e){switch(e.kind){case ts.SyntaxKind.SyntaxList:return e._children.map(b).reduce((e,t)=>e.concat(t),[]);case ts.SyntaxKind.EndOfFileToken:case ts.SyntaxKind.OpenBraceToken:case ts.SyntaxKind.CloseBraceToken:return[];default:return r=v(t=e),(t=pxtc.decompiler.getCommentsForStatement(t,i).map(c).reduce((e,t)=>e.concat(t),[])).concat(r)}var t,r}function c(e){var t=[];if(e.kind===pxtc.decompiler.CommentKind.SingleLine)t.push("# "+e.text);else{t.push('"""');for(var r of e.lines)t.push(r);t.push('"""')}return t}function v(s){var e,t,r,n,i,a;if(ts.isVariableStatement(s))return s.declarationList.declarations.map(I).reduce((e,t)=>e.concat(t),[]);if(ts.isClassDeclaration(s)){var o=s;if(!G)return j.tickEvent("depython.todo.classes"),z(o,3016,"Unsupported: classes are not supported in Python right now.");let e=[];return o.name?(d=o.members.every(B),l=k(o.name),d?e.push(`class ${l}(Enum):`):e.push(`class ${l}:`),d=o.members.map($).reduce((e,t)=>e.concat(t),[]).filter(e=>e),e=d.length?e.concat(d.map(K.indent1)):e):(j.tickEvent("depython.todo.anonymousclass"),z(o,3011,"Unsupported: anonymous class"))}if(ts.isEnumDeclaration(s)){var l=s;var c,u=[],d=(u.push(`class ${k(l.name)}(Enum):`),l.members.every(e=>!!e.initializer)),o=!l.members.every(e=>!!e.initializer);if(!d&&!o)return j.tickEvent("depython.todo.enummix"),z(l,3005,"Unsupported enum decleration: has mixture of explicit and implicit initialization");if(d)return j.tickEvent("depython.todo.enuminit"),z(l,3006,"Unsupported: explicit enum initialization");let e=0;for(c of l.members)u.push(K.indent1(k(c.name)+" = "+e++));return u}if(ts.isExpressionStatement(s))return(t=S((e=s).expression))||([t,e]=F(e.expression),e.length?["",...e,...t,""]:[...e,...t]);if(ts.isFunctionDeclaration(s))return w(s);if(ts.isIfStatement(s))return{supportStmts:e,ifStmt:t,rest:p}=function i(s){let a=[];let[e,t]=F(s.expression);a=a.concat(t);let r=`if ${D(e)}:`;let o=[];let n=E(s.thenStatement);o=o.concat(n);if(s.elseStatement)if(ts.isIfStatement(s.elseStatement)){let{supportStmts:e,ifStmt:t,rest:r}=i(s.elseStatement),n="el"+t;a=a.concat(e),o.push(n),o=o.concat(r)}else{o.push("else:");let e=E(s.elseStatement);o=o.concat(e)}return{supportStmts:a,ifStmt:r,rest:o}}(e=s),e.concat([t]).concat(p);if(ts.isForStatement(s)){var p=s;var h,m,g,f=(e=>{if(!e.initializer)return null;if(e.initializer.kind!==ts.SyntaxKind.VariableDeclarationList)return null;if(1!==(r=e.initializer).declarations.length)return null;var t=k((r=r.declarations[0]).name);if(!r.initializer||!(e=>function t(e,r){let n=e=>t(e,r);{if(ts.isBinaryExpression(e))return n(e.left)&&n(e.right);if(ts.isPropertyAccessExpression(e))return n(e.expression);if(ts.isPrefixUnaryExpression(e)||ts.isPostfixUnaryExpression(e))return e.operator!==ts.SyntaxKind.PlusPlusToken&&e.operator!==ts.SyntaxKind.MinusMinusToken&&n(e.operand);if(ts.isParenthesizedExpression(e))return n(e.expression);if(ts.isArrayLiteralExpression(e))return e.elements.map(n).reduce((e,t)=>e&&t,!0);if(ts.isElementAccessExpression(e))return n(e.expression)&&(!e.argumentExpression||n(e.argumentExpression))}return r(e)}(e,e=>{switch(e.kind){case ts.SyntaxKind.PropertyAccessExpression:case ts.SyntaxKind.BinaryExpression:case ts.SyntaxKind.ParenthesizedExpression:case ts.SyntaxKind.ArrayLiteralExpression:case ts.SyntaxKind.ElementAccessExpression:case ts.SyntaxKind.TrueKeyword:case ts.SyntaxKind.FalseKeyword:case ts.SyntaxKind.NullKeyword:case ts.SyntaxKind.UndefinedKeyword:case ts.SyntaxKind.NumericLiteral:case ts.SyntaxKind.StringLiteral:case ts.SyntaxKind.NoSubstitutionTemplateLiteral:return!0;case ts.SyntaxKind.CallExpression:case ts.SyntaxKind.NewExpression:case ts.SyntaxKind.FunctionExpression:case ts.SyntaxKind.ArrowFunction:case ts.SyntaxKind.Identifier:case ts.SyntaxKind.ThisKeyword:return!1;case ts.SyntaxKind.PrefixUnaryExpression:case ts.SyntaxKind.PostfixUnaryExpression:return e.operator!==ts.SyntaxKind.PlusPlusToken&&e.operator!==ts.SyntaxKind.MinusMinusToken}return!1}))(r.initializer)||!y(r.initializer))return null;var[r,n]=F(r.initializer);if(n.length)return null;if(n=D(r),!e.condition)return null;if(!ts.isBinaryExpression(e.condition))return null;if(!ts.isIdentifier(e.condition.left))return null;if(k(e.condition.left)!=t)return null;if(!y(e.condition.right))return null;var[r,i]=F(e.condition.right);if(i.length)return null;let s=D(r),a=s;if(e.condition.operatorToken.kind===ts.SyntaxKind.LessThanEqualsToken&&(e=>{var t=Math.floor(Number(e));return t!==1/0&&String(t)===e})(s))a=""+(Number(s)+1);else if(e.condition.operatorToken.kind!==ts.SyntaxKind.LessThanToken)return null;return e.incrementor&&(ts.isPostfixUnaryExpression(e.incrementor)||ts.isPrefixUnaryExpression(e.incrementor))&&e.incrementor.operator===ts.SyntaxKind.PlusPlusToken&&n<a?i={name:t,fromIncl:n,toExcl:a}:null})(p);if(f)return{name:f,fromIncl:m,toExcl:h}=f,f="0"===m?`for ${f} in range(${h}):`:`for ${f} in range(${m}, ${h}):`,m=E(p.statement),[f].concat(m);let e=[];p.initializer&&(e=ts.isVariableDeclarationList(p.initializer)?(h=p.initializer.declarations.map(I).reduce((e,t)=>e.concat(t),[]),e.concat(h)):([f,m]=F(p.initializer),e.concat(m).concat(f)));let t,r=`while ${t=p.condition?([f,g]=F(p.condition),e=e.concat(g),D(f)):"True"}:`,n=(e.push(r),v(p.statement).map(K.indent1));return 0!==n.length||p.incrementor||(n=[K.indent1("pass")]),e=e.concat(n),p.incrementor&&(g=S(p.incrementor),e=g?e.concat(g.map(K.indent1)):([f,p]=F(p.incrementor),e.concat(p).concat(f.map(K.indent1)))),e}if(ts.isForOfStatement(s)){f=s;if(!ts.isVariableDeclarationList(f.initializer))return j.tickEvent("depython.todo.forof.complexexp"),z(f,3003,"Unsupported expression in for..of initializer: "+f.initializer.getText());var _=f.initializer.declarations.map(e=>k(e.name));if(1!==_.length)return j.tickEvent("depython.todo.forof.multidecl"),z(f,3004,"Unsupported multiple declerations in for..of: "+f.initializer.getText());let e=_[0],[t,r]=F(f.expression),n=r,i=(n=n.concat(N(`for ${e} in `,t,":")),E(f.statement));return n=n.concat(i)}return ts.isWhileStatement(s)?([n,r]=F((_=s).expression),_=E(_.statement),n=N("while ",n,":"),r.concat(n).concat(_)):ts.isReturnStatement(s)?(r=s).expression?([r,n]=F(r.expression),r=N("return ",r),n.concat(r)):["return"]:ts.isBlock(s)?C(s):ts.isTypeAliasDeclaration(s)?(i=s,a=pxtc.emitPyTypeFromTypeNode(i.type),[(i=k(i.name))+" = "+a]):ts.isEmptyStatement(s)?[]:ts.isModuleDeclaration(s)?(a=k((i=s).name),i=i.body&&i.body.getChildren().map(b).reduce((e,t)=>e.concat(t),[]).map(e=>K.indent1(e)),["@namespace",`class ${a}:`].concat(i||[])):ts.isBreakStatement(s)?["break"]:ts.isContinueStatement(s)?["continue"]:(j.tickEvent("depython.todo.statement",{statement:s.kind}),z(s,3002,`Not supported in MakeCode Python: ${ts.SyntaxKind[s.kind]} (${s.kind})`))}function E(e){let t=v(e).map(K.indent1);return t=t.length<1?[K.indent1("pass")]:t}function B(e){if(e.kind!==ts.SyntaxKind.PropertyDeclaration)return!1;var t;if(!e.modifiers||1!==e.modifiers.length)return!1;for(t of e.modifiers)if(t.kind!==ts.SyntaxKind.StaticKeyword)return!1;return!!e.initializer&&e.initializer.kind===ts.SyntaxKind.NumericLiteral}function $(r){if(ts.isPropertyDeclaration(r))return u(r);if(ts.isMethodDeclaration(r))return w(r);if(ts.isConstructorDeclaration(r)){var n=r;let t=[],e=n.parameters.filter(ts.isParameterPropertyDeclaration);return e.forEach(e=>{t=[...t,...u(e)]}),t=[...t,...w(n,"__init__")],e.length&&t.slice(-1)[0].endsWith("pass")&&t.pop(),e.forEach(e=>{e=k(e.name);t.push(K.indent1(`self.${e} = `+e))}),t}return["# unknown ClassElement "+r.kind]}function u(e){var t,r=k(e.name);if(e.initializer)return[t,n]=F(e.initializer),[...n,r+" = "+D(t)];if(ts.isParameterPropertyDeclaration(e)&&e.type){var n=d.getTypeFromTypeNode(e.type),i=p(t=n,ts.TypeFlags.NumberLike)?"0":p(t,ts.TypeFlags.StringLike)?'""':p(t,ts.TypeFlags.BooleanLike)?"False":void 0;if(i)return[r+" = "+i]}return j.tickEvent("depython.todo.classwithoutinit"),z(e,3006,"Unsupported: class properties without initializers")}function S(e){var t,r;return t=e,!ts.isPrefixUnaryExpression(t)&&!ts.isPostfixUnaryExpression(t)||t.operator!==ts.SyntaxKind.MinusMinusToken&&t.operator!==ts.SyntaxKind.PlusPlusToken?null:([t,r]=F(e.operand),e=e.operator===ts.SyntaxKind.MinusMinusToken?" -= 1":" += 1",(r=r).push(D(t)+e),r)}function C(e){return e.getChildren().map(b).reduce((e,t)=>e.concat(t),[])}function w(e,t,r,n){let i=[];e.kind!==ts.SyntaxKind.MethodDeclaration&&e.kind!==ts.SyntaxKind.Constructor||i.push("self");var r=(r?g(e.parameters,r):e.parameters).map(e=>h(e,!n)),r=(i=i.concat(r)).join(", ");let s=[],a;if(t)a=t;else{if(!e.name)return j.tickEvent("depython.todo.anonymousfunc"),z(e,3012,"Unsupported: anonymous function decleration");a=k(e.name)}if(s.push(`def ${a}(${r}):`),!e.body)return j.tickEvent("depython.todo.funcwithoutbody"),z(e,3013,"Unsupported: function decleration without body");let o=[];return ts.isBlock(e.body)?o=C(e.body):([t,r]=F(e.body),(o=o.concat(r)).concat(t)),o.length?((r=l.getExplicitGlobals(e).map(e=>k(e)))&&r.length&&o.unshift("global "+r.join(", ")),(t=l.getExplicitNonlocals(e).map(e=>k(e)))&&t.length&&o.unshift("nonlocal "+t.join(", ")),s=s.concat(o.map(K.indent1))):s.push(K.indent1("pass")),s}function h(e,t=!0){var r=e.altName||k(e.name);let n="",i=(e.type&&t&&(t=pxtc.emitPyTypeFromTypeNode(e.type))&&-1===t.indexOf("(TODO")&&(n=": "+t),"");if(e.initializer){var[t,s]=F(e.initializer);if(s.length)return j.tickEvent("depython.todo.complexinit"),z(e,3007,"Unsupported: complex expression in parameter default value not supported. Expression: "+e.initializer.getText());i=" = "+D(t)}return""+r+n+i}function I(t){let r=[];var n=k(t.name);if(t.initializer){var[i,s]=F(t.initializer);r=r.concat(s);let e;e=t.type?n+`: ${pxtc.emitPyTypeFromTypeNode(t.type)} = `+D(i):n+" = "+D(i),r.push(e)}return r}function A(e,t){return[[e],t||[]]}function D(e,t="\n"){return e.join(t)}function N(e="",t,r=""){return t[0]=e+t[0],t[t.length-1]=t[t.length-1]+r,t}function O(e,t){switch(e){case ts.SyntaxKind.BarBarToken:return"or";case ts.SyntaxKind.AmpersandAmpersandToken:return"and";case ts.SyntaxKind.ExclamationToken:return"not";case ts.SyntaxKind.LessThanToken:return"<";case ts.SyntaxKind.LessThanEqualsToken:return"<=";case ts.SyntaxKind.GreaterThanToken:return">";case ts.SyntaxKind.GreaterThanEqualsToken:return">=";case ts.SyntaxKind.EqualsEqualsEqualsToken:case ts.SyntaxKind.EqualsEqualsToken:return"==";case ts.SyntaxKind.ExclamationEqualsEqualsToken:case ts.SyntaxKind.ExclamationEqualsToken:return"!=";case ts.SyntaxKind.EqualsToken:return"=";case ts.SyntaxKind.PlusToken:return"+";case ts.SyntaxKind.MinusToken:return"-";case ts.SyntaxKind.AsteriskToken:return"*";case ts.SyntaxKind.PlusEqualsToken:return"+=";case ts.SyntaxKind.MinusEqualsToken:return"-=";case ts.SyntaxKind.PercentToken:return"%";case ts.SyntaxKind.SlashToken:return"/";case ts.SyntaxKind.PlusPlusToken:case ts.SyntaxKind.MinusMinusToken:return j.tickEvent("depython.todo.unsupportedop",{op:e}),z(t,3008,"Unsupported ++ and -- in an expression (not a statement or for loop)");case ts.SyntaxKind.AmpersandToken:return"&";case ts.SyntaxKind.CaretToken:return"^";case ts.SyntaxKind.LessThanLessThanToken:return"<<";case ts.SyntaxKind.GreaterThanGreaterThanToken:return">>";case ts.SyntaxKind.GreaterThanGreaterThanGreaterThanToken:return j.tickEvent("depython.todo.unsupportedop",{op:e}),z(t,3009,"Unsupported operator: >>>");case ts.SyntaxKind.AsteriskAsteriskToken:return"**";case ts.SyntaxKind.AsteriskAsteriskEqualsToken:return"**=";case ts.SyntaxKind.PercentEqualsToken:return"%=";case ts.SyntaxKind.AsteriskEqualsToken:return"*=";case ts.SyntaxKind.SlashEqualsToken:return"/=";default:return j.tickEvent("depython.todo.unsupportedop",{op:e}),z(t,3008,`Unsupported Python operator (code: ${e})`)}}function m(e){var t;return ts.isPropertyAccessExpression(e)?(t=(t=k(e.name)).substr(t.lastIndexOf(".")+1),ts.isIdentifier(e.expression)?[t]:m(e.expression).concat([t])):ts.isIdentifier(e)?[k(e)]:[]}function U(e,t,r,n){let i="",s=(t&&(i=m(t).map(j.U.snakify).join("_")),[]);if(r&&1<r.length&&n&&1<n.length)for(let e=0;e<r.length&&e<n.length;e++){var a=n[e];p(d.getTypeAtLocation(a),ts.TypeFlags.EnumLike)&&(a=m(a).map(j.U.snakify),s=s.concat(a))}t=s.join("_");let o="",l=(i||t||!e||(o=k(e.name)),([i,t,o].filter(e=>e).map(j.U.snakify).map(e=>e.toLowerCase()).join("_")||"my_callback").split("_"));4<l.length&&(l=(e=>{var t,r={},n=[];for(t of e)t in r||(r[t]=!0,n.push(t));return n})(l));for(var c=j.U.toDictionary(["any","on","event"],e=>e);2<l.length;){var u=((e,t)=>{let r=[],n=!1;for(var i of e)i in t&&!n?n=!0:r.push(i);return r})(l,c);if(u.length==l.length)break;l=u}return(l=["on",...l]).join("_")}function R(i){var e=i.join(", ");return 60<e.length&&1<i.length?i.map((e,t)=>{var r,n=","==e.charAt(e.length-1)?"":",";return 0==t?(e=1<(r=e.split("\n")).length?r.shift()+"\n"+K.indent1(r.join("\n")):e)+n:t==i.length-1?K.indent1(e):K.indent1(e+n)}):[e]}function L(s){var t=d.getTypeAtLocation(s.expression),t=d.typeToTypeNode(t);let a=ts.createNodeArray([]);if(ts.isFunctionTypeNode(t)&&(a=t.parameters,s.arguments)&&a.length<s.arguments.length)return j.tickEvent("depython.todo.argparammismatch",{kind:s.kind}),z(s,3010,"TODO: Unsupported call site where caller the arguments outnumber the callee parameters: "+s.getText());t=(t=s.expression).getSourceFile()&&(t=t.getText(),o[t])||null;if(s.arguments&&t&&"TD_ID"==t.attributes.shim)return F(s.arguments[0]);if(ts.isPropertyAccessExpression(s.expression)&&"toString"===s.expression.name.getText())return[t,r]=F(s.expression.expression),[N("str(",t,")"),r];var[t,r]=F(s.expression);let n=D(t);t=(s.arguments||ts.createNodeArray()).map((e,t,r)=>{return e=e,t=a[t],n=s.expression,i=a,r=r,(ts.isFunctionExpression(e)||ts.isArrowFunction(e))&&t&&t.type&&ts.isFunctionTypeNode(t.type)?P(e,U(t,n,i,r),void 0,!0):F(e);var n,i}),r=t.map(([,e])=>e).reduce((e,t)=>e.concat(t),r);if(0===n.indexOf("_py.py_")){if(t.length<=0)return j.tickEvent("depython.todo._pynoargs"),z(s,3014,"Unsupported: call expression has no arguments for _py.py_ fn");n=n.substr(7).split("_").filter((e,t)=>0!==t).join("_");var i=t.shift()[0];let e=R(t.map(([e])=>e).reduce((e,t)=>e.concat(t),[]));return[N(`${i}.${n}(`,e,")"),r]}let e=R(t.map(([e])=>e).reduce((e,t)=>e.concat(t),[]));return[N(n+"(",e,")"),r]}function g(r,n){var i,s=[],a={};for(let t=0;t<Math.max(r.length,n.length);t++){let e;r[t]?a[k((e=r[t]).name)]=!0:a[i=k((e=n[t]).name)]&&(i=pxtc.decompiler.getNewName(i,a),e=Object.assign({altName:i},n[t])),s.push(e)}return ts.createNodeArray(s,!1)}function P(e,t,r,n){if(H&&!ts.isBlock(e.body)){var[i,s]=F(e.body);if(0===s.length)return A((s=(r?g(e.parameters,r):e.parameters).map(e=>h(e,!1)).join(", ")).length?`lambda ${s}: `+D(i):"lambda: "+D(i))}i=e.name?k(e.name):("string"!=typeof(s=t||"my_function")&&(s=k(s)),a[s]?pxtc.decompiler.getNewName(s,a):(a[s]=!0,s));return A(i,w(e,i,r,n))}function M(e){switch(e){case ts.SyntaxKind.ExclamationToken:return" ";case ts.SyntaxKind.PlusToken:case ts.SyntaxKind.MinusToken:return"";default:return" "}}function V(e){if("any"===e.type.getText().trim()&&(ts.isNumericLiteral(e.expression)||ts.isStringLiteral(e.expression)||e.expression.kind===ts.SyntaxKind.TrueKeyword||e.expression.kind===ts.SyntaxKind.FalseKeyword)){e=function e(t){if(t.parent)return t.parent.kind===ts.SyntaxKind.ParenthesizedExpression?e(t.parent):t.parent}(e);if((null==e?void 0:e.kind)===ts.SyntaxKind.BinaryExpression)switch(e.operatorToken.kind){case ts.SyntaxKind.EqualsEqualsToken:case ts.SyntaxKind.EqualsEqualsEqualsToken:case ts.SyntaxKind.ExclamationEqualsToken:case ts.SyntaxKind.ExclamationEqualsEqualsToken:case ts.SyntaxKind.LessThanToken:case ts.SyntaxKind.LessThanEqualsToken:case ts.SyntaxKind.GreaterThanToken:case ts.SyntaxKind.GreaterThanEqualsToken:return 1}}}function F(i){if(ts.isBinaryExpression(i)){var s=i,a=x(s.left),o=x(s.right),l=s.operatorToken.kind===ts.SyntaxKind.PlusToken&&(a||o);let[e,t]=F(s.left),[r,n]=(l&&!a&&(e=N("str(",e,")")),a=O(s.operatorToken.kind,s),F(s.right));return l&&!o&&(r=N("str(",r,")")),s=t.concat(n),[N(D(e)+" "+a+" ",r),s]}if(ts.isPropertyAccessExpression(i))return(o=T(l=i))?A(o):([o,a]=F(l.expression),A("length"===(l=k(l.name))?`len(${D(o)})`:D(o)+"."+l,a));var e,t,r,n,c,u,d,p,h,m,g,f,_,y,b,v;if(ts.isCallExpression(i))return L(i);if(ts.isNewExpression(i))return L(i);if(ts.isFunctionExpression(i)||ts.isArrowFunction(i))return P(i);if(ts.isPrefixUnaryExpression(i))return p=O((s=i).operator,s),[u,d]=F(s.operand),A(""+p+M(s.operator)+D(u),d);if(ts.isPostfixUnaryExpression(i))return u=O((p=i).operator,p),[d,h]=F(p.operand),p=M(p.operator),A(""+D(d)+p+u,h);if(ts.isParenthesizedExpression(i))return[h,m]=F((h=i).expression),A(`(${D(h)})`,m);if(ts.isArrayLiteralExpression(i))return e=(m=(m=i).elements.map(F)).map(([,e])=>e).reduce((e,t)=>e.concat(t),[]),[N("[",R(m.map(([e])=>e).reduce((e,t)=>e.concat(t),[])),"]"),e];if(ts.isElementAccessExpression(i))return(e=i).argumentExpression?([r,n]=F(e.expression),[c,t]=F(e.argumentExpression),n=n.concat(t),A(`${D(r)}[${D(c)}]`,n)):(j.tickEvent("depython.todo.accesswithoutexp"),z(e,3015,"Unsupported: element access expression without an argument expression"));if(ts.isNoSubstitutionTemplateLiteral(i)||ts.isTaggedTemplateExpression(i))return t=i,ts.isNoSubstitutionTemplateLiteral(t)?A(`"""
${t.text.trim().split("\n").map(e=>""+K.INDENT+e.trim()).join("\n")}
${K.INDENT}"""`):([r,c]=F(t.tag),[t,n]=F(t.template),c=c.concat(n),A(`${D(r)}(${D(t)})`,c));switch(i.kind){case ts.SyntaxKind.TrueKeyword:return A("True");case ts.SyntaxKind.FalseKeyword:return A("False");case ts.SyntaxKind.ThisKeyword:return A("self");case ts.SyntaxKind.NullKeyword:case ts.SyntaxKind.UndefinedKeyword:return A("None")}return ts.isIdentifier(i)?"undefined"==(y=i).text?A("None"):A(k(y)):ts.isNumericLiteral(i)||ts.isStringLiteral(i)?A(i.getText()):ts.isConditionalExpression(i)?([g,v]=F((y=i).condition),[f,_]=F(y.whenTrue),[y,b]=F(y.whenFalse),v=v.concat(_).concat(b),A(`${f} if ${D(g)} else `+D(y),v)):ts.isAsExpression(i)&&V(i)?F(i.expression):(j.tickEvent("depython.todo.expression",{kind:i.kind}),z(i,3017,"Unsupported expression kind: "+i.kind))}})(e,t),i=t.replace(/(\.py)?\.\w*$/i,"")+".py";r.outfiles[i]=n}catch(e){e.pyDiagnostic?r.diagnostics=[e.pyDiagnostic]:j.reportException(e),r.success=!1}return r}),G=!1;function e(t){return e=>(e||"").split("\n").map(e=>""+K.INDENT.repeat(t)+e).join("\n")}K.INDENT="    ",K.indent=e,K.indent1=e(1)}})(pxt=pxt||{}),(e=>{e=e.py||(e.py={});{e=e.rx||(e.rx={});let t=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/;e.isIdentifierStart=function(e){return ts.pxtc.isIdentifierStart(e,ts.pxtc.ScriptTarget.ES5)},e.isIdentifierChar=function(e){return ts.pxtc.isIdentifierPart(e,ts.pxtc.ScriptTarget.ES5)},e.isSpace=function(e){return!!(32===e||9===e||11===e||12===e||160===e||5760<=e&&t.test(String.fromCharCode(e)))},e.isNewline=function(e){return 10===e||13===e||8232===e||8233===e}}})(pxt=pxt||{}),(e=>{var a;function t(t){var e=[ts.SyntaxKind.EqualsToken,ts.SyntaxKind.PlusEqualsToken,ts.SyntaxKind.MinusEqualsToken,ts.SyntaxKind.AsteriskEqualsToken,ts.SyntaxKind.AsteriskAsteriskEqualsToken,ts.SyntaxKind.SlashEqualsToken,ts.SyntaxKind.PercentEqualsToken,ts.SyntaxKind.LessThanLessThanEqualsToken,ts.SyntaxKind.GreaterThanGreaterThanEqualsToken,ts.SyntaxKind.GreaterThanGreaterThanGreaterThanEqualsToken,ts.SyntaxKind.AmpersandEqualsToken,ts.SyntaxKind.BarEqualsToken,ts.SyntaxKind.CaretEqualsToken];return ts.isBinaryExpression(t)&&e.some(e=>t.operatorToken.kind===e)}function r(e){let l={refs:[],children:[],owner:void 0};return function s(a){var o;if(!a)return l;if(ts.isPropertyAccessOrQualifiedName(a))return l;if(ts.isIdentifier(a))return{refs:[{kind:"read",node:a,varName:a.text}],children:[],owner:void 0};if(ts.isVariableDeclaration(a)||ts.isParameter(a)){let e=s(a.initializer);return{refs:[...e.refs,{kind:"decl",node:a,varName:a.name.getText()}],children:e.children,owner:void 0}}if(ts.isPrefixUnaryExpression(a)||ts.isPostfixUnaryExpression(a)){let e=s(a.operand),t=a.operand.getText(),r={refs:[{kind:"assign",node:a,varName:t}],children:[],owner:void 0};return c(e,r)}if(t(a)){let e=s(a.right),t,r=(a.operatorToken.kind!==ts.SyntaxKind.EqualsToken&&(t=s(a.left)),a.left.getText()),n={refs:[{kind:"assign",node:a,varName:r}],children:[],owner:void 0};return c(t,c(e,n))}if(ts.isFunctionExpression(a)||ts.isArrowFunction(a)||ts.isFunctionDeclaration(a)||ts.isMethodDeclaration(a)){let e=null==(o=a.name)?void 0:o.getText(),t=void 0,r=(e&&(t={kind:"decl",node:a,varName:e}),a.parameters.map(e=>s(e)).reduce(c,l)),n=s(a.body),i=c(r,n);return i.owner=a,{refs:t?[t]:[],children:[i],owner:void 0}}return a.getChildren().map(s).reduce(c,l)}(e);function c(e,t){return e&&t?{refs:[...e.refs,...t.refs],children:[...e.children,...t.children],owner:e.owner||t.owner}:e||t||l}}function o(e){return[...e.globalUsage,...e.environmentUsage].filter(e=>"assign"===e.kind).map(e=>e)}function l(e){return e.nonlocalUsage.filter(e=>"assign"===e.kind).map(e=>e)}function d(e,t,r=[]){var n,i=[],s=[],a=[],o=[],l={};for(n of e.refs)"read"===n.kind||"assign"===n.kind?(l[n.varName]?a:(t=>r.map(e=>e[t.varName]).reduce((e,t)=>t||e,void 0))(n)?s:t&&t[n.varName]?i:o).push(n):l[n.varName]=n;let c=t||l,u=t?[...r,l]:[];return{globalUsage:i,nonlocalUsage:s,localUsage:a,environmentUsage:o,children:e.children.map(e=>d(e,c,u)),owner:e.owner}}function c(e){return e.kind+":"+e.varName}function n(e){return function e(t){return[t.refs.map(c).join(", "),...t.children.map(e).map(e=>e.map(a.indent1)).map(e=>["{",...e,"}"]).reduce((e,t)=>[...e,...t],[])]}(e).join("\n")}function i(e){return function e(t){var r=t.globalUsage.map(c).join(", "),n=t.nonlocalUsage.map(c).join(", "),i=t.localUsage.map(c).join(", "),s=t.environmentUsage.map(c).join(", ");return[r?"global "+r:"",n?"nonlocal "+n:"",i?"local "+i:"",s?"env "+s:"",...t.children.map(e).map(e=>e.map(a.indent1)).map(e=>["{",...e,"}"]).reduce((e,t)=>[...e,...t],[])].filter(e=>!!e)}(e).join("\n")}(a=e.py||(e.py={})).computeScopeVariableLookup=function(e){e=d(r(e));let i=new Map,s=new Map;return function e(t){let r=a(o(t));i.set(t.owner,r);let n=a(l(t));s.set(t.owner,n);t.children.forEach(e)}(e),{getExplicitGlobals:e=>i.get(e)||[],getExplicitNonlocals:e=>s.get(e)||[]};function t(e){e=e.node.operand||e.node.left;return ts.isIdentifier(e)?e:void 0}function a(e){return e.map(t).filter(e=>!!e).map(e=>e).reduce((e,t)=>e.find(e=>e.text===t.text)?e:[...e,t],[])}},a.toStringVariableScopes=function(e){var t=d(e=r(e));return n(e)+"\n\n\n"+i(t)}})(pxt=pxt||{}),(r=>{{var n=r.accessibility||(r.accessibility={});let t,e=!1;function i(e){var t=window.navigator&&/Mac/i.test(window.navigator.platform)?e.metaKey:e.ctrlKey;return"Escape"===e.key?(e.preventDefault(),"escape"):"/"===e.key&&t?(e.preventDefault(),"togglekeyboardcontrolshelp"):"b"===e.key&&t?(e.preventDefault(),"toggleareamenu"):null}n.makeFocusable=function(e){e.setAttribute("focusable","true"),e.setAttribute("tabindex","0")},n.getGlobalAction=i,n.postKeyboardEvent=function(){e||(e=!0,document.addEventListener("keydown",e=>{e=i(e);e&&r.Runtime.postMessage({type:"action",action:e})}))},n.enableKeyboardInteraction=function(e,t,r){t&&e.addEventListener("keydown",e=>{e="number"==typeof e.which?e.which:e.keyCode;32!==e&&13!==e||t()}),r&&e.addEventListener("keyup",e=>{e="number"==typeof e.which?e.which:e.keyCode;32!==e&&13!==e||r()})},n.setAria=function(e,t,r){t&&!e.hasAttribute("role")&&e.setAttribute("role",t),r&&!e.hasAttribute("aria-label")&&e.setAttribute("aria-label",r)},n.setLiveContent=function(e){t||((t=document.createElement("div")).setAttribute("role","status"),t.setAttribute("aria-live","polite"),t.setAttribute("aria-hidden","false"),t.setAttribute("style","position: absolute !important;display: block;visibility: visible;overflow: hidden;width: 1px;height: 1px;margin: -1px;border: 0;padding: 0;clip: rect(0 0 0 0);"),document.body.appendChild(t)),t.textContent!==e&&(t.textContent=e)}}})(pxsim=pxsim||{}),(p=>{let u="blue",d="orange",t=e=>e.reduce((e,t)=>e+(t?1:0),0),i=e=>0<t(e);function s(e){var e=[e.start,e.end],t=e.map(e=>"ground"===e),r=e.map(e=>"threeVolt"===e),n=e.map(e=>"fiveVolt"===e),e=e.map(t=>{{let e=!1;return"string"!=typeof t&&"breadboard"===t.type&&(t=t.row,e=0<=["a","b","c","d","e"].indexOf(t)),e}}),t=i(t),r=i(r),n=i(n),e=i(e);return{topGround:t&&!e,topThreeVolt:r&&!e,topFiveVolt:n&&!e,bottomGround:t&&e,bottomThreeVolt:r&&e,bottomFiveVolt:n&&e,singleGround:t,singleThreeVolt:r,singleFiveVolt:n}}function h(e,t){var r,n,i={};for(r in e)i[r]=e[r];for(n in t)i[n]=t[n];return i}function c(e){p.U.assert(!!e,"Invalid pin: "+e);e=/^(\w+)\.\s*(?:[a-z]*)?([A-Z][A-Z\d_]+)$/.exec(e);return e?e[2]:void 0}function m(e){return"-Z"===e.orientation&&"male"===e.style}p.readPin=c;class r{constructor(e){this.availablePowerPins={top:{fiveVolt:p.mkRange(26,51).map(e=>({type:"breadboard",row:"+",col:""+e})),threeVolt:p.mkRange(26,51).map(e=>({type:"breadboard",row:"+",col:""+e})),ground:p.mkRange(26,51).map(e=>({type:"breadboard",row:"-",col:""+e}))},bottom:{fiveVolt:p.mkRange(1,26).map(e=>({type:"breadboard",row:"+",col:""+e})),threeVolt:p.mkRange(1,26).map(e=>({type:"breadboard",row:"+",col:""+e})),ground:p.mkRange(1,26).map(e=>({type:"breadboard",row:"-",col:""+e}))}},this.opts=e}allocPartIRs(s,a,d){let o=[],l=(r,e,n,t)=>{var i=[];for(let t=0;t<r.numberOfPins;t++){var s=r.pinDefinitions[t];let e;if("string"==typeof s.target)e=s.target;else{var a=s.target.pinInstantiationIdx;if(!n||void 0===n[a])return void p.log(`error: parts no pin found for PinInstantiationIdx: ${a}. (Is the part missing an ArgumentRole or "trackArgs=" annotations?)`);e=n[a]}var a=r.visual.pinLocations[t],o=d.yOffset+a.y,l=Math.round(o/r.visual.pinDistance),o=o-l*r.visual.pinDistance,c=d.xOffset+a.x,u=Math.round(c/r.visual.pinDistance),c=c-u*r.visual.pinDistance;i.push({def:s,loc:a,target:e,bbFit:{partRelativeRowIdx:l,partRelativeColIdx:u,xOffset:c,yOffset:o}})}return{name:e,def:r,pins:i,partParams:t||{},bbFit:d}};var e=s.instantiations||[];return s.instantiation&&e.push(s.instantiation),e.forEach(e=>{if("singleton"===e.kind)o.push(l(s,a));else if("function"===e.kind){let i=e,t=i.fullyQualifiedName.split(","),r={};t.forEach(e=>{this.opts.fnArgs[e]&&this.opts.fnArgs[e].forEach(e=>{r[e]=1})});e=Object.keys(r);e&&e.length?e.forEach(e=>{e=e.split(",");if(e.length!=i.argumentRoles.length)p.log(`error: parts mismatch between number of arguments at callsite (function name: ${t}) vs number of argument roles in part definition (part: ${a}).`);else{let r=[],n={};e.forEach((e,t)=>{var t=i.argumentRoles[t];void 0!==t.partParameter&&(n[t.partParameter]=e),void 0!==t.pinInstantiationIdx&&(t=t.pinInstantiationIdx,e=c(e),r[t]=e)}),o.push(l(s,a,r,n))}}):p.log("error: parts failed to read pin(s) from callsite for: "+t)}}),o.filter(e=>!!e)}computePartDimensions(e,t){var r=e.visual.pinLocations;let n=e.pinDefinitions;var i=e.numberOfPins;p.U.assert(r.length===i,`Mismatch between "numberOfPins" and length of "visual.pinLocations" for "${t}"`),p.U.assert(n.length===i,`Mismatch between "numberOfPins" and length of "pinDefinitions" for "${t}"`),p.U.assert(0<i,`Part "${t}" has no pins`);var s,i=r.map((e,t)=>{return r={idx:t},e=e,t=n[t],h(h(r,e),t);var r}).filter(e=>"-Z"===e.orientation),t=0<i.length,r=e.visual.pinDistance;let a,o,l,c;return t?(t=i[0],i=Math.ceil(t.x/r),s=Math.ceil(t.y/r),a=i*r-t.x,o=s*r-t.y,l=Math.ceil((a+e.visual.width)/r)+1,c=Math.ceil((o+e.visual.height)/r)+1):(l=Math.ceil(e.visual.width/r),c=Math.ceil(e.visual.height/r),a=l*r-e.visual.width,o=c*r-e.visual.height),{xOffset:a,yOffset:o,rowCount:c,colCount:l}}allocColumns(e){var t=e.length,r=p.visuals.BREADBOARD_MID_COLS-e.map(e=>e.colCount).reduce((e,t)=>e+t,0),n=(r<=0&&p.log("Not enough breadboard space!"),Math.floor(r/(t-1+2)));let i=n;n=r-i*(t-1),r=Math.floor(n/2);Math.ceil(n/2);let s=1+r;return e.map(e=>{var t=s;return s+=e.colCount+i,t})}placeParts(e){let r=p.visuals.BREADBOARD_MID_ROWS+2,n=this.allocColumns(e.map(e=>e.bbFit)),i=e.map(e=>{e=r-e.bbFit.rowCount;let t=Math.floor(e/2);return t=(t=4<t?4:t)<1?1:t});return e.map((e,t)=>{var r=i[t];return h({startColumnIdx:n[t],startRowIdx:r},e)})}nextColor(){return(!this.availableWireColors||this.availableWireColors.length<=0)&&(this.availableWireColors=p.visuals.GPIO_WIRE_COLORS.map(e=>e)),this.availableWireColors.pop()}allocWireIRs(o){let l=[];var e=o.pins.map((e,t)=>{var r=e.target;let n;var i=o.startColumnIdx+e.bbFit.partRelativeColIdx,i=p.visuals.getColumnName(i);let s=o.startRowIdx+e.bbFit.partRelativeRowIdx;7<=s&&(s-=2),n=m(e.def)?{type:"breadboard",row:s<5?"j":"a",col:i,style:e.def.style}:{type:"breadboard",row:p.visuals.getRowName(s),col:i,xOffset:e.bbFit.xOffset/o.def.visual.pinDistance,yOffset:e.bbFit.yOffset/o.def.visual.pinDistance,style:e.def.style};let a;return a="ground"===r?u:"threeVolt"===r?"red":"fiveVolt"===r?d:"number"==typeof e.def.colorGroup?l[e.def.colorGroup]||(l[e.def.colorGroup]=this.nextColor()):this.nextColor(),{start:n,end:r,color:a,pinIdx:t}});return h(o,{wires:e})}allocLocation(t,r){if("ground"===t||"threeVolt"===t||"fiveVolt"==t){if("ground"===t&&this.powerUsage.singleGround)return{type:"dalboard",pin:this.getBoardGroundPin()};if("threeVolt"===t&&this.powerUsage.singleThreeVolt)return{type:"dalboard",pin:this.getBoardThreeVoltPin()};if("fiveVolt"===t&&this.powerUsage.singleFiveVolt)return{type:"dalboard",pin:this.getBoardFiveVoltPin()};p.U.assert(!!r.referenceBBPin);var r=this.opts.getBBCoord(r.referenceBBPin),n=[this.availablePowerPins.top.ground[0]||this.availablePowerPins.top.threeVolt[0],this.availablePowerPins.bottom.ground[0]||this.availablePowerPins.bottom.threeVolt[0]].map(e=>this.opts.getBBCoord(e)),n=(n[0]&&n[1]||p.debug(`No more available "${t}" locations!`),0==p.visuals.findClosestCoordIdx(r,n));let e;n?"ground"===t?e=this.availablePowerPins.top.ground:"threeVolt"===t?e=this.availablePowerPins.top.threeVolt:"fiveVolt"===t&&(e=this.availablePowerPins.top.fiveVolt):"ground"===t?e=this.availablePowerPins.bottom.ground:"threeVolt"===t?e=this.availablePowerPins.bottom.threeVolt:"fiveVolt"===t&&(e=this.availablePowerPins.bottom.fiveVolt);var i=e.map(e=>this.opts.getBBCoord(e)),r=p.visuals.findClosestCoordIdx(r,i),i=e[r];return(n?(this.availablePowerPins.top.ground.splice(r,1),this.availablePowerPins.top):(this.availablePowerPins.bottom.ground.splice(r,1),this.availablePowerPins.bottom)).threeVolt.splice(r,1),i}if("breadboard"===t.type)return t;if("MOSI"===t||"MISO"===t||"SCK"===t)return this.opts.boardDef.spiPins||p.debug("No SPI pin mappings found!"),{type:"dalboard",pin:this.opts.boardDef.spiPins[t]};if("SDA"===t||"SCL"===t)return this.opts.boardDef.i2cPins||p.debug("No I2C pin mappings found!"),{type:"dalboard",pin:this.opts.boardDef.i2cPins[t]};p.U.assert("string"==typeof t,"Unknown location type: "+t);n=this.opts.boardDef.gpioPinMap[t]||t;if(n)return{type:"dalboard",pin:n};p.debug("unknown pin location for "+t)}getBoardGroundPin(){var e=this.opts.boardDef.groundPins&&this.opts.boardDef.groundPins[0]||null;return e||p.debug("No available ground pin on board!"),e}getBoardThreeVoltPin(){var e=this.opts.boardDef.threeVoltPins&&this.opts.boardDef.threeVoltPins[0]||null;return e||p.debug("No available 3.3V pin on board!"),e}getBoardFiveVoltPin(){var e=this.opts.boardDef.fiveVoltPins&&this.opts.boardDef.fiveVoltPins[0]||null;return e||p.debug("No available 5V pin on board!"),e}allocPowerWires(e){var t=this.getBoardGroundPin(),r=this.getBoardThreeVoltPin(),n=this.getBoardFiveVoltPin();let i,s;s=this.opts.boardDef.attachPowerOnRight?(i={type:"breadboard",row:"-",col:"50"},{type:"breadboard",row:"-",col:"25"}):(i={type:"breadboard",row:"-",col:"26"},{type:"breadboard",row:"-",col:"1"});var a=[];let o=[];var l=[],t=(e.bottomGround&&e.topGround&&a.push({start:this.allocLocation("ground",{referenceBBPin:i}),end:this.allocLocation("ground",{referenceBBPin:s}),color:u}),e.topGround?a.push({start:this.allocLocation("ground",{referenceBBPin:i}),end:{type:"dalboard",pin:t},color:u}):e.bottomGround&&a.push({start:this.allocLocation("ground",{referenceBBPin:s}),end:{type:"dalboard",pin:t},color:u}),e.bottomThreeVolt&&e.bottomGround?o.push({start:this.allocLocation("threeVolt",{referenceBBPin:i}),end:this.allocLocation("threeVolt",{referenceBBPin:s}),color:"red"}):e.bottomFiveVolt&&e.bottomGround&&l.push({start:this.allocLocation("fiveVolt",{referenceBBPin:i}),end:this.allocLocation("fiveVolt",{referenceBBPin:s}),color:d}),e.topThreeVolt?o.push({start:this.allocLocation("threeVolt",{referenceBBPin:i}),end:{type:"dalboard",pin:r},color:"red"}):e.bottomThreeVolt&&o.push({start:this.allocLocation("threeVolt",{referenceBBPin:s}),end:{type:"dalboard",pin:r},color:d}),e.topFiveVolt&&!e.topThreeVolt?l.push({start:this.allocLocation("fiveVolt",{referenceBBPin:i}),end:{type:"dalboard",pin:n},color:"red"}):e.bottomFiveVolt&&!e.bottomThreeVolt&&l.push({start:this.allocLocation("fiveVolt",{referenceBBPin:s}),end:{type:"dalboard",pin:n},color:d}),[]);0<a.length&&t.push({wireIndices:a.map((e,t)=>t)});let c=a.length;return 0<o.length&&t.push({wireIndices:o.map((e,t)=>t+c)}),0<l.length&&t.push({wireIndices:o.map((e,t)=>t+c+o.length)}),{wires:a.concat(o).concat(l),assembly:t}}allocWire(e){let r=[e.start,e.end],n=r.map(e=>"ground"===e||"threeVolt"===e||"fiveVolt"===e),i=r.map((e,t)=>n[t]?void 0:this.allocLocation(e,{}));if((i=i.map((e,t)=>e||(e=i[1-t],this.allocLocation(r[t],{referenceBBPin:e}))))[0]&&i[1])return{start:i[0],end:i[1],color:e.color}}allocPart(n){var e=n.pins.filter(e=>m(e.def)).map(e=>{let t=n.startRowIdx+e.bbFit.partRelativeRowIdx;7<=t&&(t-=2);var r=p.visuals.getRowName(t),e=n.startColumnIdx+e.bbFit.partRelativeColIdx;return{type:"breadboard",row:r,col:p.visuals.getColumnName(e)}});return{name:n.name,visual:n.def.visual,bbFit:n.bbFit,startColumnIdx:n.startColumnIdx,startRowIdx:n.startRowIdx,breadboardConnections:e,params:n.partParams,simulationBehavior:n.def.simulationBehavior}}allocAll(){var e=this.opts.partsList.map(e=>({name:e,def:this.opts.partDefs[e]})).filter(e=>!!e.def);if(0<e.length){let r=e.map(e=>this.computePartDimensions(e.def,e.name)),n=[];e.forEach((e,t)=>{t=r[t],e=this.allocPartIRs(e.def,e.name,t);n=n.concat(e)});var e=this.placeParts(n).map(e=>this.allocWireIRs(e)),t=e.map(e=>e.wires).reduce((e,t)=>e.concat(t),[]).map(e=>s(e)),t=(this.powerUsage=((t=(t=t).reduce((e,t)=>({topGround:e.topGround||t.topGround,topThreeVolt:e.topThreeVolt||t.topThreeVolt,topFiveVolt:e.topFiveVolt||t.topFiveVolt,bottomGround:e.bottomGround||t.bottomGround,bottomThreeVolt:e.bottomThreeVolt||t.bottomThreeVolt,bottomFiveVolt:e.bottomFiveVolt||t.bottomFiveVolt,singleGround:t.singleGround?null===e.singleGround:e.singleGround,singleThreeVolt:t.singleThreeVolt?null===e.singleThreeVolt:e.singleThreeVolt,singleFiveVolt:t.singleFiveVolt?null===e.singleFiveVolt:e.singleFiveVolt}),{topGround:!1,topThreeVolt:!1,topFiveVolt:!1,bottomGround:!1,bottomThreeVolt:!1,bottomFiveVolt:!1,singleGround:null,singleThreeVolt:null,singleFiveVolt:null})).singleGround&&(t.topGround=t.bottomGround=!1),t.singleThreeVolt&&(t.topThreeVolt=t.bottomThreeVolt=!1),t.singleFiveVolt&&(t.topFiveVolt=t.bottomFiveVolt=!1),t),this.allocPowerWires(this.powerUsage)),e=e.map((e,t)=>{var n=this.allocPart(e),i=e.wires.map(e=>this.allocWire(e));if(!i.some(e=>!e)){let r=[];return e.wires.forEach((e,t)=>{r[e.pinIdx]=t}),{part:n,wires:i,assembly:e.def.assembly.map(e=>({part:e.part,wireIndices:(e.pinIndices||[]).map(e=>r[e])}))}}}).filter(e=>!!e),t=[t].concat(e).filter(e=>e.assembly&&e.assembly.length),e=!t.some(e=>e.part&&e.part.breadboardConnections&&0<e.part.breadboardConnections.length||e.wires&&e.wires.some(e=>"breadboard"==e.end.type&&"croc"!=e.end.style||"breadboard"==e.start.type&&"croc"!=e.start.style));return{partsAndWires:t,wires:[],parts:[],hideBreadboard:e}}return{partsAndWires:[],wires:[],parts:[]}}}p.allocateDefinitions=function(e){return new r(e).allocAll()}})(pxsim=pxsim||{}),(t=>{{var s=t.protocol||(t.protocol={});class e{constructor(e){this.seq=0,this.type=e}}s.Message=e;class r extends e{constructor(e,t){super("response"),this.request_seq=e.seq,this.command=e.command,t?(this.success=!1,this.message=t):this.success=!0}}s.Response=r;class n extends e{constructor(e,t){super("event"),this.event=e,t&&(this.body=t)}}s.Event=n,s.Source=class{constructor(e,t,r=0,n,i){this.name=e,this.path=t,this.sourceReference=r,n&&(this.origin=n),i&&(this.adapterData=i)}},s.Scope=class{constructor(e,t,r=!1){this.name=e,this.variablesReference=t,this.expensive=r}},s.StackFrame=class{constructor(e,t,r,n=0,i=0){this.id=e,this.source=r,this.line=n,this.column=i,this.name=t}},s.Thread=class{constructor(e,t){this.id=e,this.name=t||"Thread #"+e}},s.Variable=class{constructor(e,t,r=0,n,i){this.name=e,this.value=t,this.variablesReference=r,"number"==typeof i&&(this.namedVariables=i),"number"==typeof n&&(this.indexedVariables=n)}},s.Breakpoint=class{constructor(e,t,r,n){this.verified=e;"number"==typeof t&&(this.line=t),"number"==typeof r&&(this.column=r),n&&(this.source=n)}},s.Module=class{constructor(e,t){this.id=e,this.name=t}},s.CompletionItem=class{constructor(e,t,r=0){this.label=e,this.start=t,this.length=r}};class i extends n{constructor(e,t,r=null){super("stopped"),this.body={reason:e,threadId:t},r&&(this.body.text=r)}}s.StoppedEvent=i;class a extends n{constructor(e,t){super("continued"),this.body={threadId:e},"boolean"==typeof t&&(this.body.allThreadsContinued=t)}}s.ContinuedEvent=a;class o extends n{constructor(){super("initialized")}}s.InitializedEvent=o;class l extends n{constructor(e){super("terminated"),"boolean"==typeof e&&(this.body={restart:e})}}s.TerminatedEvent=l;class c extends n{constructor(e,t="console",r){super("output"),this.body={category:t,output:e},void 0!==r&&(this.body.data=r)}}s.OutputEvent=c;class u extends n{constructor(e,t){super("thread"),this.body={reason:e,threadId:t}}}s.ThreadEvent=u;class d extends n{constructor(e,t){super("breakpoint"),this.body={reason:e,breakpoint:t}}}s.BreakpointEvent=d;class p extends n{constructor(e,t){super("module"),this.body={reason:e,module:t}}}s.ModuleEvent=p;class h{constructor(){this._pendingRequests={}}start(e){this._sequence=1,this.host=e,this.host.onData(e=>{var t;"request"===e.type?this.dispatchRequest(e):"response"===e.type&&(t=this._pendingRequests[(e=e).seq])&&(delete this._pendingRequests[e.seq],t(e))})}stop(){this.host&&this.host.close()}sendEvent(e){this.send("event",e)}sendResponse(e){0<e.seq?t.error("attempt to send more than one response for command "+e.command):this.send("response",e)}sendRequest(e,t,r,n){let i={command:e};if(t&&0<Object.keys(t).length&&(i.arguments=t),this.send("request",i),n){this._pendingRequests[i.seq]=n;let t=setTimeout(()=>{clearTimeout(t);var e=this._pendingRequests[i.seq];e&&(delete this._pendingRequests[i.seq],e(new s.Response(i,"timeout")))},r)}}send(e,t){t.type=e,t.seq=this._sequence++,this.host&&(e=JSON.stringify(t),this.host.send(e))}dispatchRequest(e){}}s.ProtocolServer=h;class m extends h{constructor(){super(...arguments),this._debuggerLinesStartAt1=!1,this._debuggerColumnsStartAt1=!1,this._clientLinesStartAt1=!0,this._clientColumnsStartAt1=!0}shutdown(){}dispatchRequest(e){var t,r,n=new s.Response(e);try{"initialize"===e.command?("boolean"==typeof(t=e.arguments).linesStartAt1&&(this._clientLinesStartAt1=t.linesStartAt1),"boolean"==typeof t.columnsStartAt1&&(this._clientColumnsStartAt1=t.columnsStartAt1),"path"!==t.pathFormat?this.sendErrorResponse(n,2018,"debug adapter only supports native paths",null):((r=n).body={},this.initializeRequest(r,t))):"launch"===e.command?this.launchRequest(n,e.arguments):"attach"===e.command?this.attachRequest(n,e.arguments):"disconnect"===e.command?this.disconnectRequest(n,e.arguments):"setBreakpoints"===e.command?this.setBreakPointsRequest(n,e.arguments):"setFunctionBreakpoints"===e.command?this.setFunctionBreakPointsRequest(n,e.arguments):"setExceptionBreakpoints"===e.command?this.setExceptionBreakPointsRequest(n,e.arguments):"configurationDone"===e.command?this.configurationDoneRequest(n,e.arguments):"continue"===e.command?this.continueRequest(n,e.arguments):"next"===e.command?this.nextRequest(n,e.arguments):"stepIn"===e.command?this.stepInRequest(n,e.arguments):"stepOut"===e.command?this.stepOutRequest(n,e.arguments):"stepBack"===e.command?this.stepBackRequest(n,e.arguments):"restartFrame"===e.command?this.restartFrameRequest(n,e.arguments):"goto"===e.command?this.gotoRequest(n,e.arguments):"pause"===e.command?this.pauseRequest(n,e.arguments):"stackTrace"===e.command?this.stackTraceRequest(n,e.arguments):"scopes"===e.command?this.scopesRequest(n,e.arguments):"variables"===e.command?this.variablesRequest(n,e.arguments):"setVariable"===e.command?this.setVariableRequest(n,e.arguments):"source"===e.command?this.sourceRequest(n,e.arguments):"threads"===e.command?this.threadsRequest(n):"evaluate"===e.command?this.evaluateRequest(n,e.arguments):"stepInTargets"===e.command?this.stepInTargetsRequest(n,e.arguments):"gotoTargets"===e.command?this.gotoTargetsRequest(n,e.arguments):"completions"===e.command?this.completionsRequest(n,e.arguments):this.customRequest(e.command,n,e.arguments)}catch(e){this.sendErrorResponse(n,1104,"{_stack}",{_exception:e.message,_stack:e.stack})}}initializeRequest(e,t){e.body.supportsConditionalBreakpoints=!1,e.body.supportsHitConditionalBreakpoints=!1,e.body.supportsFunctionBreakpoints=!1,e.body.supportsConfigurationDoneRequest=!0,e.body.supportsEvaluateForHovers=!1,e.body.supportsStepBack=!1,e.body.supportsSetVariable=!1,e.body.supportsRestartFrame=!1,e.body.supportsStepInTargetsRequest=!1,e.body.supportsGotoTargetsRequest=!1,e.body.supportsCompletionsRequest=!1,this.sendResponse(e)}disconnectRequest(e,t){this.sendResponse(e),this.shutdown()}launchRequest(e,t){this.sendResponse(e)}attachRequest(e,t){this.sendResponse(e)}setBreakPointsRequest(e,t){this.sendResponse(e)}setFunctionBreakPointsRequest(e,t){this.sendResponse(e)}setExceptionBreakPointsRequest(e,t){this.sendResponse(e)}configurationDoneRequest(e,t){this.sendResponse(e)}continueRequest(e,t){this.sendResponse(e)}nextRequest(e,t){this.sendResponse(e)}stepInRequest(e,t){this.sendResponse(e)}stepOutRequest(e,t){this.sendResponse(e)}stepBackRequest(e,t){this.sendResponse(e)}restartFrameRequest(e,t){this.sendResponse(e)}gotoRequest(e,t){this.sendResponse(e)}pauseRequest(e,t){this.sendResponse(e)}sourceRequest(e,t){this.sendResponse(e)}threadsRequest(e){this.sendResponse(e)}stackTraceRequest(e,t){this.sendResponse(e)}scopesRequest(e,t){this.sendResponse(e)}variablesRequest(e,t){this.sendResponse(e)}setVariableRequest(e,t){this.sendResponse(e)}evaluateRequest(e,t){this.sendResponse(e)}stepInTargetsRequest(e,t){this.sendResponse(e)}gotoTargetsRequest(e,t){this.sendResponse(e)}completionsRequest(e,t){this.sendResponse(e)}customRequest(e,t,r){this.sendErrorResponse(t,1014,"unrecognized request",null)}sendErrorResponse(e,t,r,n){let i;"number"==typeof t?(i={id:t,format:r},n&&(i.variables=n),i.showUser=!0):i=t,e.success=!1,m.formatPII(i.format,!0,i.variables),e.body||(e.body={}),e.body.error=i,this.sendResponse(e)}convertClientLineToDebugger(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e+1:this._clientLinesStartAt1?e-1:e}convertDebuggerLineToClient(e){return this._debuggerLinesStartAt1?this._clientLinesStartAt1?e:e-1:this._clientLinesStartAt1?e+1:e}convertClientColumnToDebugger(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e+1:this._clientColumnsStartAt1?e-1:e}convertDebuggerColumnToClient(e){return this._debuggerColumnsStartAt1?this._clientColumnsStartAt1?e:e-1:this._clientColumnsStartAt1?e+1:e}convertClientPathToDebugger(e){return this._clientPathsAreURIs!=this._debuggerPathsAreURIs?this._clientPathsAreURIs?m.uri2path(e):m.path2uri(e):e}convertDebuggerPathToClient(e){return this._debuggerPathsAreURIs!=this._clientPathsAreURIs?this._debuggerPathsAreURIs?m.uri2path(e):m.path2uri(e):e}static path2uri(e){let t=e.replace(/\\/g,"/");return"/"!==t[0]&&(t="/"+t),encodeURI("file://"+t)}static uri2path(e){return e}static formatPII(e,r,n){return e.replace(m._formatPIIRegexp,function(e,t){return!(r&&0<t.length&&"_"!==t[0])&&n[t]&&n.hasOwnProperty(t)?n[t]:e})}}m._formatPIIRegexp=/{([^}]+)}/g,s.DebugSession=m}})(pxsim=pxsim||{}),(e=>{function o(e){e=e.replace(/\\/g,"/");let t=[];return e.split("/").forEach(e=>{".."===e&&t.length?t.pop():e&&"."!==e&&t.push(e)}),t}(e=e.util||(e.util={})).injectPolyphils=function(){String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){return void 0!==e&&null!=e&&this.substring(t=!t||t<0?0:+t,t+e.length)===e}}),Array.prototype.fill||Object.defineProperty(Array.prototype,"fill",{writable:!0,enumerable:!0,value:function(e){if(null==this)throw new TypeError("this is null or not defined");var t=Object(this),r=t.length>>>0,n=arguments[1]>>0;let i=n<0?Math.max(r+n,0):Math.min(n,r);for(var n=arguments[2],n=void 0===n?r:n>>0,s=n<0?Math.max(r+n,0):Math.min(n,r);i<s;)t[i]=e,i++;return t}}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{writable:!0,enumerable:!0,value:function(e){if(null==this)throw new TypeError('"this" is null or not defined');var t=Object(this),r=t.length>>>0;if("function"!=typeof e)throw new TypeError("predicate must be a function");var n=arguments[1];let i=0;for(;i<r;){var s=t[i];if(e.call(n,s,i,t))return s;i++}}}),Uint8Array.prototype.slice||Object.defineProperty(Uint8Array.prototype,"slice",{value:Array.prototype.slice,writable:!0,enumerable:!0}),Uint16Array.prototype.slice||Object.defineProperty(Uint16Array.prototype,"slice",{value:Array.prototype.slice,writable:!0,enumerable:!0}),Uint32Array.prototype.slice||Object.defineProperty(Uint32Array.prototype,"slice",{value:Array.prototype.slice,writable:!0,enumerable:!0}),Uint8Array.prototype.fill||Object.defineProperty(Uint8Array.prototype,"fill",{value:Array.prototype.fill,writable:!0,enumerable:!0}),Uint16Array.prototype.fill||Object.defineProperty(Uint16Array.prototype,"fill",{value:Array.prototype.fill,writable:!0,enumerable:!0}),Uint32Array.prototype.fill||Object.defineProperty(Uint32Array.prototype,"fill",{value:Array.prototype.fill,writable:!0,enumerable:!0}),Uint8Array.prototype.some||Object.defineProperty(Uint8Array.prototype,"some",{value:Array.prototype.some,writable:!0,enumerable:!0}),Uint16Array.prototype.some||Object.defineProperty(Uint16Array.prototype,"some",{value:Array.prototype.some,writable:!0,enumerable:!0}),Uint32Array.prototype.some||Object.defineProperty(Uint32Array.prototype,"some",{value:Array.prototype.some,writable:!0,enumerable:!0}),Uint8Array.prototype.reverse||Object.defineProperty(Uint8Array.prototype,"reverse",{value:Array.prototype.reverse,writable:!0,enumerable:!0}),Uint16Array.prototype.reverse||Object.defineProperty(Uint16Array.prototype,"reverse",{value:Array.prototype.reverse,writable:!0,enumerable:!0}),Uint32Array.prototype.reverse||Object.defineProperty(Uint32Array.prototype,"reverse",{value:Array.prototype.reverse,writable:!0,enumerable:!0}),Math.imul||(Math.imul=function(e,t){var r=65535&e,n=65535&t;return r*n+((e>>>16&65535)*n+r*(t>>>16&65535)<<16>>>0)|0}),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");var r=Object(e);for(let e=1;e<arguments.length;e++){var n=arguments[e];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},writable:!0,configurable:!0}),Promise.prototype.finally||(Promise.prototype.finally=Promise.prototype.finally||{finally(t){let r=e=>Promise.resolve(t()).then(e);return this.then(e=>r(()=>e),e=>r(()=>Promise.reject(e)))}}.finally)},e.Lazy=class{constructor(e){this._func=e,this._evaluated=!1}get value(){return this._evaluated||(this._value=this._func(),this._evaluated=!0),this._value}},e.getNormalizedParts=o,e.normalizePath=function(e){return o(e).join("/")},e.relativePath=function(e,t){var r=o(e),n=o(t);let i=0;for(;r[i]===n[i]&&++i!==r.length&&i!==n.length;);var s=r.slice(i),a=n.slice(i);for(let e=0;e<s.length;e++)a.unshift("..");return a.join("/")},e.pathJoin=function(...e){let t="";return e.forEach(e=>{e.replace(/\\/g,"/"),e.lastIndexOf("/")===e.length-1&&(e=e.slice(0,e.length-1)),t+="/"+e}),t},e.toArray=function(t){if(Array.isArray(t))return t;var r=[];for(let e=0;e<t.length;++e)r.push(t[e]);return r}})(pxsim=pxsim||{}),(d=>{function p(e,t){switch(typeof e){case"string":case"number":case"boolean":return e;case"function":return{text:"(function)",type:"function"};case"undefined":return null;case"object":var r,n;return e?e instanceof d.RefObject?(t&&(t[e.id]=e),n=(r=d.RefObject.toDebugString(e)).startsWith("[")?"array":r,{id:e.id,preview:r,hasFields:null!==e.fields||r.startsWith("["),type:n}):e._width&&e._height?{text:e._width+"x"+e._height,type:"image"}:{text:"(object)",type:"object"}:null;default:throw new Error}}function a(e,n,t,i,s=!1){{var a=e,o;e=t;let r={};for(o of Object.keys(a))/^__/.test(o)||!/___\d+$/.test(o)||i&&-1===i.indexOf(o)||(r[o]=p(a[o],n));if(a.fields&&e)for(var l of e)l=l.substring(l.lastIndexOf(".")+1),r[l]=p(((e,t)=>{let r={pc:0,arg0:t,fn:e,parent:{}};for(;r.fn;)r=r.fn(r);return r.retval})(a.vtable.iface[l],a),n);if(a.fields)for(var c of Object.keys(a.fields).filter(e=>s||!e.startsWith("_")))r[c]=p(a.fields[c],n);else if(a instanceof d.RefMap)for(var u of a.data)r[u.key]=p(u.val,n);else Array.isArray(a.data)?a.data.forEach((e,t)=>{r[t]=p(e,n)}):void 0!==a._width&&void 0!==a._height&&(r.width=a._width,r.height=a._height,s)&&void 0!==a._bpp&&(r.isMono=1===a._bpp);return r}}d.getWarningMessage=function(e){var t={type:"debugger",subtype:"warning",breakpointIds:[],message:e};let r=d.runtime.currFrame;for(;null!=r;)t.breakpointIds.push(r.lastBrkId),r=r.parent;return t},d.BreakpointMap=class{constructor(e){for(var t in this.fileMap={},this.idMap={},e.forEach(e=>{var[t,r]=e;this.fileMap[r.source.path]||(this.fileMap[r.source.path]=[]),this.fileMap[r.source.path].push(e),this.idMap[t]=r}),this.fileMap){var r=this.fileMap[t];this.fileMap[t]=r.sort(([,e],[,t])=>e.line===t.line?t.endLine===e.endLine?e.column-t.column:t.endLine-e.endLine:e.line-t.line)}}getById(e){return this.idMap[e]}verifyBreakpoint(e,t){e=this.fileMap[e];let r;if(e)for(var[n,i]of e)i.line<=t.line&&i.endLine>=t.line&&(r=[n,i]);return r?(r[1].verified=!0,r):[-1,{verified:!1}]}},d.dumpHeap=a,d.injectEnvironmentGlobals=function(e,r){var n=d.runtime.environmentGlobals;if(Object.keys(n).length){let t=e.environmentGlobals={};Object.keys(n).forEach(e=>t[e]=p(d.runtime.environmentGlobals[e],r))}},d.getBreakpointMsg=function(e,t,r){for(var n={},i={type:"debugger",subtype:"breakpoint",breakpointId:t,globals:a(d.runtime.globals,n,void 0,r),stackframes:[]};null!=e;){var s=((r,n)=>{var e,t,i=r.fn?r.fn.info:null;if(i)return e={thisParam:p(r.argL,n),params:[]},i.argumentNames&&(t=i.argumentNames,e.params=t.map((e,t)=>({name:e,value:p(r["arg"+t],n)}))),{locals:a(r,n),funcInfo:i,breakpointId:r.lastBrkId,callLocationId:r.callLocIdx,arguments:e}})(e,n);s&&i.stackframes.push(s),e=e.parent}return{msg:i,heap:n}};class t extends d.protocol.DebugSession{constructor(e){super(),this.driver=new d.SimulatorDriver(e,{onDebuggerBreakpoint:e=>this.onDebuggerBreakpoint(e),onDebuggerWarning:e=>this.onDebuggerWarning(e),onDebuggerResume:()=>this.onDebuggerResume(),onStateChanged:e=>this.onStateChanged(e)})}runCode(e,t,r,n,i){this.breakpoints=n,this.projectDir&&this.fixBreakpoints(),this.sendEvent(new d.protocol.InitializedEvent),this.driver.run(e,{parts:t,fnArgs:r,boardDefinition:i})}stopSimulator(e=!1){this.driver.stop(e)}initializeRequest(e,t){e.body.supportsConditionalBreakpoints=!1,e.body.supportsHitConditionalBreakpoints=!1,e.body.supportsFunctionBreakpoints=!1,e.body.supportsEvaluateForHovers=!1,e.body.supportsStepBack=!1,e.body.supportsSetVariable=!1,e.body.supportsRestartFrame=!1,e.body.supportsStepInTargetsRequest=!1,e.body.supportsGotoTargetsRequest=!1,e.body.supportsCompletionsRequest=!1,e.body.supportsConfigurationDoneRequest=!0,this.sendResponse(e)}disconnectRequest(e,t){this.sendResponse(e),this.shutdown()}launchRequest(e,t){this.projectDir||(this.projectDir=d.util.normalizePath(t.projectDir),this.breakpoints&&this.fixBreakpoints()),this.sendResponse(e)}setBreakPointsRequest(r,n){r.body={breakpoints:[]};let i=[];n.breakpoints.forEach(e=>{var t;this.breakpoints?([e,t]=this.breakpoints.verifyBreakpoint(d.util.relativePath(this.projectDir,n.source.path),e),r.body.breakpoints.push(t),t.verified&&i.push(e)):r.body.breakpoints.push({verified:!1})}),this.driver.setBreakpoints(i),this.sendResponse(r)}continueRequest(e,t){this.driver.resume(d.SimulatorDebuggerCommand.Resume),this.sendResponse(e)}nextRequest(e,t){this.driver.resume(d.SimulatorDebuggerCommand.StepOver),this.sendResponse(e)}stepInRequest(e,t){this.driver.resume(d.SimulatorDebuggerCommand.StepInto),this.sendResponse(e)}stepOutRequest(e,t){this.driver.resume(d.SimulatorDebuggerCommand.StepOut),this.sendResponse(e)}pauseRequest(e,t){this.driver.resume(d.SimulatorDebuggerCommand.Pause),this.sendResponse(e)}threadsRequest(e){e.body={threads:[{id:t.THREAD_ID,name:"main"}]},this.sendResponse(e)}stackTraceRequest(e,t){var r;this.lastBreak&&(r=this.state.getFrames(),e.body={stackFrames:r}),this.sendResponse(e)}scopesRequest(e,t){this.state&&(e.body={scopes:this.state.getScopes(t.frameId)}),this.sendResponse(e)}variablesRequest(e,t){this.state&&(e.body={variables:this.state.getVariables(t.variablesReference)}),this.sendResponse(e)}onDebuggerBreakpoint(e){this.lastBreak=e,this.state=new r(this.lastBreak,this.breakpoints,this.projectDir),e.exceptionMessage?(e=e.exceptionMessage.replace(/___\d+/g,""),this.sendEvent(new d.protocol.StoppedEvent("exception",t.THREAD_ID,e))):this.sendEvent(new d.protocol.StoppedEvent("breakpoint",t.THREAD_ID))}onDebuggerWarning(e){}onDebuggerResume(){this.sendEvent(new d.protocol.ContinuedEvent(t.THREAD_ID,!0))}onStateChanged(e){switch(e){case d.SimulatorState.Paused:break;case d.SimulatorState.Running:this.sendEvent(new d.protocol.ContinuedEvent(t.THREAD_ID,!0));break;case d.SimulatorState.Stopped:this.sendEvent(new d.protocol.TerminatedEvent)}}fixBreakpoints(){for(var e in this.breakpoints.idMap){e=this.breakpoints.idMap[e];e.source.path=d.util.pathJoin(this.projectDir,e.source.path),e.line=this.convertDebuggerLineToClient(e.line),e.endLine=this.convertDebuggerLineToClient(e.endLine),e.column=this.convertDebuggerColumnToClient(e.column),e.endColumn=this.convertDebuggerColumnToClient(e.endColumn)}}}t.THREAD_ID=1,d.SimDebugSession=t;class r{constructor(e,t,r){this._message=e,this._map=t,this._dir=r,this._currentId=1,this._frames={},this._vars={};e=this.nextId();this._vars[e]=this.getVariableValues(this._message.globals),this._globalScope={name:"Globals",variablesReference:e,expensive:!1}}getFrames(){return this._message.stackframes.map((e,t)=>{var r=this._map.getById(e.breakpointId);if(r)return{id:(this._frames[e.breakpointId]=e).breakpointId,name:e.funcInfo?e.funcInfo.functionName:0===t?"main":"anonymous",line:r.line,column:r.column,endLine:r.endLine,endColumn:r.endLine,source:r.source}}).filter(e=>!!e)}getScopes(e){var t,e=this._frames[e];return e?(t=this.nextId(),this._vars[t]=this.getVariableValues(e.locals),[{name:"Locals",variablesReference:t,expensive:!1},this._globalScope]):[this._globalScope]}getVariables(e){e=this._vars[e];return e&&e.value||[]}getVariableValues(s){return new d.util.Lazy(()=>{var r,n=[];for(r in s){var i=s[r];let e,t=0;null===i?e="null":void 0===i?e="undefined":"object"==typeof i?(e="(object)",t=this.nextId(),this._vars[t]=this.getVariableValues(i)):e=i.toString();i=r.substr(0,r.lastIndexOf("___"));n.push({name:i,value:e,variablesReference:t})}return n})}nextId(){return this._currentId++}}})(pxsim=pxsim||{}),(a=>{var e;function o(e=0){function t(){try{window.print()}catch(e){}}e?setTimeout(t,e):t()}(e=(e=a.multiplayer||(a.multiplayer={})).IconType||(e.IconType={}))[e.Player=0]="Player",e[e.Reaction=1]="Reaction",a.print=o;{var t=a.Embed||(a.Embed={});function r(e){e.origin;var t,r=e.data||{},e=r.type;if(e)switch(e){case"run":c(r);break;case"instructions":a.instructions.renderInstructions(r);break;case"stop":l();break;case"mute":u(r.mute);break;case"stopsound":a.AudioContextManager.stopAll();break;case"print":o();break;case"recorder":var n=r;if(s)switch(n.action){case"start":s.startRecording(n.width);break;case"stop":s.stopRecording()}break;case"screenshot":a.Runtime.postScreenshotAsync(r);break;case"custom":a.handleCustomMessage&&a.handleCustomMessage(r);break;case"pxteditor":break;case"debugger":s&&s.handleDebuggerMsg(r);break;case"simulator":var i=r;switch(i.command){case"focus":d("simulator.focus",{timestamp:i.timestamp});break;case"blur":d("simulator.blur",{timestamp:i.timestamp})}default:t=r,s&&!s.dead&&s.board.receiveMessage(t)}}t.start=function(){if(window.addEventListener("message",r,!1),t.frameid=window.location.hash.slice(1),"serviceWorker"in navigator&&-1!==window.location.href.indexOf("---simulator")&&!a.U.isLocalHost()){var e=window.location.pathname;let t=e.substring(1,e.indexOf("---"));navigator.serviceWorker.controller&&navigator.serviceWorker.addEventListener("message",e=>{e=e.data;e&&"serviceworker"===e.type&&"activated"===e.state&&e.ref===t&&i()});e=window.location.href.replace(/---simulator.*$/,"---simserviceworker");navigator.serviceWorker.register(e).then(function(e){a.log("Simulator ServiceWorker registration successful with scope: ",e.scope)},function(e){a.log("Simulator ServiceWorker registration failed: ",e)})}a.Runtime.postMessage({type:"ready",frameid:t.frameid})};let s;function l(){s&&(s.kill(),s.board)&&s.board.kill()}function c(e){l(),e.mute&&u(e.mute),e.localizedStrings&&a.localization.setLocalizedStrings(e.localizedStrings);let t=new a.Runtime(e);(s=t).board.initAsync(e).then(()=>{t===s&&t.run(e=>{a.dumpLivePointers(),a.Runtime.postMessage({type:"toplevelcodefinished"})})})}function u(e){a.AudioContextManager.mute(e)}t.stop=l,t.run=c}function d(e,t){n({type:"pxtsim",action:"event",tick:e,data:t})}function n(e){"undefined"!=typeof window&&window.parent&&window.parent!==window&&window.parent.postMessage(e,"*")}function i(){setInterval(()=>{a.Runtime.postMessage({type:"simulator",command:"reload"})},3e3)}a.tickEvent=d,a.reportError=function(e,t,r){n({type:"pxtsim",action:"event",tick:"error",category:e,message:t,data:r})},a.reload=i})(pxsim=pxsim||{}),pxsim.util.injectPolyphils(),"undefined"!=typeof window&&window.addEventListener("load",function(e){pxsim.Embed.start()}),(E=>{{var e=E.instructions||(E.instructions={});let d=10,r=30,s=e=>e+"x",a=20,v=3,T=5,k=5,p=40,h=50,m=1.5;var[n,i]=[816*.95,1056*.95],[_,y]=[1,1];let g=465,o=(y=((n=(n-86.4)/y-48*y)-g)/2+24,400),x=1.7,t=.17,l=.25,c=.3,u=.23,f=`
            .instr-panel {
                margin: 20px;
                padding: 24px;
                border-width: 4px;
                border-color: gray;
                border-style: solid;
                border-radius: 20px;
                display: inline-block;
                width: ${n}px;
                height: ${(i-86.4)/_-48*_}px;
                position: relative;
                overflow: hidden;
                page-break-inside: avoid;
            }
            .board-svg {
                margin: 0 auto;
                display: block;
                position: absolute;
                bottom: 24px;
                left: ${y}px;
            }
            .panel-num-outer {
                position: absolute;
                left: -4px;
                top: -4px;
                width: 120px;
                height: 120px;
                border-width: 4px;
                border-style: solid;
                border-color: gray;
                border-radius: 20px 0 20px 0;
            }
            .panel-num {
                margin: 10px 0;
                text-align: center;
                font-size: 80px;
            }
            .cmp-div {
                display: inline-block;
            }
            .reqs-div {
                margin-left: 144px;
                margin-top: 5px;
            }
            .partslist-wire,
            .partslist-cmp {
                margin: 10px;
            }
            .partslist-wire {
                display: inline-block;
            }
            `;function b(e,t){var r=document.createElementNS("http://www.w3.org/2000/svg","svg");let n={l:0,t:0,w:0,h:0};var i=document.createElementNS("http://www.w3.org/2000/svg","svg");r.appendChild(i),i.appendChild(e.el);let s={viewBox:e.x+` ${e.y} ${e.w} `+e.h,preserveAspectRatio:"xMidYMid"};n.w=e.w,n.h=e.h;e=e=>{n.h*=e,n.w*=e,s.width=n.w,s.height=n.h};t.cmpScale&&e(t.cmpScale),t.cmpWidth&&t.cmpWidth<n.w?e(t.cmpWidth/n.w):t.cmpHeight&&t.cmpHeight<n.h&&e(t.cmpHeight/n.h),E.svg.hydrate(i,s);let a=n.l,o=n.t,l=n.w,c=n.h;var u,d,p,h,e=e=>{var t;e<n.l&&(t=n.l-e,n.l=e,n.w+=t)},i=e=>{var t=n.l+n.w;t<e&&(e=e-t,n.w+=e)},m=e=>{var t;e<n.t&&(t=n.t-e,n.t=e,n.h+=t)},g=e=>{var t=n.t+n.h;t<e&&(e=e-t,n.h+=e)},[f,_]=[-.3,.3],y=[1.4,1],y=(t&&t.top&&(p=(h=t.topSize)/y[0],d=h/y[1],[u,b]=[a+l/2,o-v-d/2],h=E.visuals.mkTxt(u,b,h,0,t.top,f,_),E.U.addClass(h,"cmp-lbl"),r.appendChild(h),h=p*t.top.length,m(b-d/2),e(u-h/2),i(u+h/2)),t&&t.bot&&(b=(p=t.botSize)/y[0],d=p/y[1],[u,h]=[a+l/2,o+c+v+d/2],p=E.visuals.mkTxt(u,h,p,0,t.bot,f,_),E.U.addClass(p,"cmp-lbl"),r.appendChild(p),p=b*t.bot.length,g(h+d/2),e(u-p/2),i(u+p/2)),t&&t.right&&(h=(b=t.rightSize)/y[1],d=b/y[0]*t.right.length,[u,p]=[a+l+T+d/2,o+c/2],b=E.visuals.mkTxt(u,p,b,0,t.right,f,_),E.U.addClass(b,"cmp-lbl"),r.appendChild(b),m(p-h/2),i(u+d/2),g(p+h/2)),t&&t.left&&(i=(b=t.leftSize)/y[1],u=b/y[0]*t.left.length,[d,p]=[a-k-u/2,o+c/2],h=E.visuals.mkTxt(d,p,b,0,t.left,f,_),E.U.addClass(h,"cmp-lbl"),r.appendChild(h),m(p-i/2),e(d-u/2),g(p+i/2)),{viewBox:`${n.l} ${n.t} ${n.w} `+n.h,width:n.w*x,height:n.h*x,preserveAspectRatio:"xMidYMid"}),b=(E.svg.hydrate(r,y),document.createElement("div"));return b.appendChild(r),b}function S(e,t){var r=E.runtime.board;let n;return b(n="wire"==e?E.visuals.mkWirePart([0,0],t.wireClr||"red",t.crocClips):"string"==typeof(e=e).builtIn?(0,r.builtinPartVisuals[e.builtIn])([0,0]):E.visuals.mkGenericPartSVG(e),t)}function C(e,t,r=!1){t={state:E.runtime.board,boardDef:e.boardDef,forceBreadboardLayout:!0,forceBreadboardRender:e.allAlloc.requiresBreadboard,partDefs:e.cmpDefs,maxWidth:t+"px",fnArgs:e.fnArgs,wireframe:r,partsList:[]},e=new E.visuals.BoardHost(E.visuals.mkBoardView({visual:t.boardDef.visual,boardDef:t.boardDef,wireframe:t.wireframe}),t),r=e.getView();return E.U.addClass(r,"board-svg"),e}function w(){var e=document.createElement("div");return E.U.addClass(e,"instr-panel"),e}function I(n){let i=w();e=n.boardDef;var e=b(E.visuals.mkBoardView({visual:e.visual,boardDef:e}).getView(),{left:s(1),leftSize:r,cmpScale:t}),e=(i.appendChild(e),new E.visuals.Breadboard({}).getSVGAndSize()),e=b(e,{left:s(1),leftSize:r,cmpScale:l});return i.appendChild(e),n.allCmps.forEach(e=>{let t=1;"buttonpair"===e.visual.builtIn&&(t=2);e=S(e.visual,{left:s(t),leftSize:r,cmpScale:c});E.U.addClass(e,"partslist-cmp"),i.appendChild(e)}),n.allWireColors.forEach(e=>{var t=n.colorToWires[e].length,r=n.boardDef.pinStyles[e]||"female",t=S("wire",{left:s(t),leftSize:a,wireClr:e,cmpScale:u,crocClips:"croc"==r});E.U.addClass(t,"partslist-wire"),i.appendChild(t)}),i}function A(e,r){var t=w(),n=C(r,g,!0),i=n,s=e,a=r,o=i.getView();0<s&&E.U.addClass(o,"grayed");for(let r=0;r<=s;r++){var l=a.stepToCmps[r],l=(l&&l.forEach(e=>{var t=i.addPart(e);r===s&&(e.breadboardConnections.forEach(e=>i.highlightBreadboardPin(e)),E.U.addClass(t.element,"notgrayed"))}),a.stepToWires[r]);l&&l.forEach(e=>{var t=i.addWire(e);t&&r===s&&("breadboard"==e.start.type?i.highlightBreadboardPin(e.start):i.highlightBoardPin(e.start.pin),"breadboard"==e.end.type?i.highlightBreadboardPin(e.end):i.highlightBoardPin(e.end.pin),i.highlightWire(t))})}t.appendChild(n.getView());o=document.createElement("div"),E.U.addClass(o,"panel-num-outer"),E.U.addClass(o,"noselect"),t.appendChild(o),n=document.createElement("div");E.U.addClass(n,"panel-num"),n.textContent=e+1+"",o.appendChild(n);let c=document.createElement("div");E.U.addClass(c,"reqs-div"),t.appendChild(c);o=r.stepToWires[e]||[];let u=e=>{var t,r;return"breadboard"===e.type?({row:t,col:r}=e,`(${t},${r})`):e.pin};return o.forEach(e=>{let t=!1;"dalboard"==e.end.type&&(t="croc"==r.boardDef.pinStyles[e.end.pin]);e=S("wire",{top:u(e.end),topSize:d,bot:u(e.start),botSize:d,wireClr:e.color,cmpHeight:p,crocClips:t});E.U.addClass(e,"cmp-div"),c.appendChild(e)}),(r.stepToCmps[e]||[]).forEach(s=>{let e;(e="buttonpair"===s.visual.builtIn?[s.breadboardConnections[0],s.breadboardConnections[2]]:[s.breadboardConnections[0]]).forEach((e,t)=>{let r;var n;r=e?({row:e,col:n}=e,`(${e},${n})`):"";let i=m;"buttonpair"===s.visual.builtIn&&(i*=.5);e=S(s.visual,{top:r,topSize:d,cmpHeight:h,cmpScale:i});E.U.addClass(e,"cmp-div"),c.appendChild(e)})}),t}function D(t,e){e.boardDef.pinStyles||(e.boardDef.pinStyles={}),e.configData&&E.setConfigData(e.configData.cfg,e.configData.cfgKey);var r,n={type:"run",code:"",boardDefinition:e.boardDef,partDefinitions:e.partDefinitions},n=(E.runtime=new E.Runtime(n),E.runtime.board=null,E.initCurrentRuntime(n),document.createElement("style")),n=(n.textContent+=f,document.head.appendChild(n),e.partDefinitions),i=new E.visuals.Breadboard({}),s=(e=>{var t=E.allocateDefinitions(e);let i=[],s=[],a=1;t.partsAndWires.forEach(e=>{let r=e.part,n=e.wires;e.assembly.forEach((e,t)=>{e.part&&r&&(s[a+t]=[r]),e.wireIndices&&0<e.wireIndices.length&&n&&(i[a+t]=e.wireIndices.map(e=>n[e]))}),a+=e.assembly.length});var r=a-1,n=t.partsAndWires.map(e=>e.part).filter(e=>!!e),o=t.partsAndWires.map(e=>e.wires||[]).reduce((e,t)=>e.concat(t),[]);let l={},c=[];return o.forEach(e=>{l[e.color]||(l[e.color]=[],c.push(e.color)),l[e.color].push(e)}),{boardDef:e.boardDef,cmpDefs:e.partDefs,fnArgs:e.fnArgs,allAlloc:t,stepToWires:i,stepToCmps:s,allWires:o,allCmps:n,lastStep:r,colorToWires:l,allWireColors:c}})({boardDef:e.boardDef,partDefs:n,partsList:e.parts,fnArgs:e.fnArgs,getBBCoord:i.getCoord.bind(i)}),n=(s.allAlloc.requiresBreadboard=!0,n=s,i=document.getElementById("front-panel"),(r=C(n,o,!1)).addAll(n.allAlloc),i.appendChild(r.getView()),I(s));t.appendChild(n);for(let e=0;e<=s.lastStep;e++){var a=A(e,s);t.appendChild(a)}e.print&&E.print(2e3)}e.renderParts=D,e.renderInstructions=function(e){document.getElementById("proj-title").innerText=e.options.name||"",D(document.body,e.options)}}})(pxsim=pxsim||{}),(u=>{function n(e,t="sim: check failed"){if(!e)throw new Error(t)}u.quiet=!1,u.check=n,u.title="";let r={},i={};u.getConfig=function(e){return i.hasOwnProperty(e+"")?i[e+""]:null},u.getConfigKey=function(e){return r.hasOwnProperty(e)?r[e]:null},u.getAllConfigKeys=function(){return Object.keys(r)},u.setConfigKey=function(e,t){r[e]=t},u.setConfig=function(e,t){i[e]=t},u.setConfigData=function(e,t){i=e,r=t},u.getConfigData=function(){return{cfg:i,cfgKey:r}},u.setTitle=function(e){u.title=e};class s{constructor(){u.runtime?this.id=u.runtime.registerLiveObject(this):this.id=0}destroy(){}scan(e){throw u.U.userError("scan not implemented")}gcKey(){throw u.U.userError("gcKey not implemented")}gcSize(){throw u.U.userError("gcSize not implemented")}gcIsStatic(){return!1}print(){u.runtime&&u.runtime.refCountingDebug&&u.log("RefObject id:"+this.id)}toDebugString(){return"(object)"}static toAny(e){return e&&e.toAny?e.toAny():e}static fromAny(e){return e&&(e instanceof s?e:Array.isArray(e)?u.RefCollection.fromAny(e):"object"==typeof e?o.fromAny(e):e)}static toDebugString(e){return null===e?"null":void 0===e?"undefined;":e.vtable&&e.vtable.name?"_Map"===e.vtable.name&&e instanceof p?"(object)":e.vtable.name:e.toDebugString?e.toDebugString():e.vtable&&e.vtable.name?e.vtable.name:"string"==typeof e?JSON.stringify(e):e.toString()}}u.RefObject=s;class a{constructor(e,t,r){this.func=e,this.caps=t,this.args=r}}u.FnWrapper=a;class o extends s{constructor(){super(...arguments),this.fields={}}scan(e){for(var t of Object.keys(this.fields))e(t,this.fields[t])}gcKey(){return this.vtable.name}gcSize(){return this.vtable.numFields+1}destroy(){this.fields=null,this.vtable=null}print(){u.runtime&&u.runtime.refCountingDebug&&u.log(`RefRecord id:${this.id} (${this.vtable.name})`)}toDebugString(){let t="RefRecord: {";var r=Object.keys(this.fields);for(let e=0;e<r.length;++e)0<e&&(t+=", "),t+=r[e]+": "+s.toDebugString(this.fields[r[e]]);return t+"}"}toAny(){var e,t={};for(e of Object.keys(this.fields))t[e]=s.toAny(this.fields[e]);return t}static fromAny(e){var t,r=new o;for(t of Object.keys(e))r.fields[t]=s.fromAny(e[t]);return r}}u.RefRecord=o;class l extends s{constructor(){super(...arguments),this.fields=[]}scan(t){for(let e=0;e<this.fields.length;++e)t("_cap"+e,this.fields[e])}gcKey(){return u.functionName(this.func)}gcSize(){return this.fields.length+3}isRef(e){return n(0<=e&&e<this.fields.length),e<this.len}ldclo(e){return n(0<=(e>>=2)&&e<this.fields.length),this.fields[e]}destroy(){this.fields=null,this.func=null}print(){u.runtime&&u.runtime.refCountingDebug&&u.log(`RefAction id:${this.id} len:`+this.fields.length)}}var c;u.RefAction=l;{var e=u.pxtcore||(u.pxtcore={});e.seedAddRandom=function(e){},e.mkAction=function(t,e){var r=new l;r.len=t,r.func=e;for(let e=0;e<t;++e)r.fields.push(null);return r},e.runAction=function(e,t){var r=u.getResume();e instanceof l?r(new a(e.func,e.fields,t)):r(new a(e,null,t))};let c={};function d(e){let r="",n=(e,t)=>{r+=e.length>=t?e:("              "+e).slice(-t)};let i=e=>n(""+Math.round(e),6);var t,s=(e,t)=>{n(Math.round(t)+"",8),r+=" /",i(e),r+=" =",i(t/e)};for(t of e.split(/\n/))if(t&&/^\d/.test(t)){var a=t.split(/,/);let e=c[a[2]];e||(c[a[2]]=e={stops:0,us:0,meds:[]}),o=a[2],l=25,r+=o.length>=l?o:(o+"                         ").slice(0,l);var o=parseInt(a[0]),l=parseInt(a[1]),a=(s(o,l),r+=" |",s(o-e.stops,l-e.us),r+=" ~",parseInt(a[3])),a=(i(a),10<e.meds.length&&e.meds.shift(),e.meds.push(a),e.meds.slice()),a=(a.sort((e,t)=>e-t),a[a.length>>1]);r+=" ~~",i(a),e.stops=o,e.us=l,r+="\n"}u.log(r)}e.dumpPerfCounters=function(){if(u.runtime&&u.runtime.perfCounters){let e="calls,us,name\n";for(var t of u.runtime.perfCounters){t.lastFew.sort();var r=t.lastFew[t.lastFew.length>>1];e+=`${t.numstops},${t.value},${t.name},${r}\n`}d(e)}}}class t extends s{constructor(){super(...arguments),this.v=void 0}scan(e){e("*",this.v)}gcKey(){return"LOC"}gcSize(){return 2}destroy(){}print(){u.runtime&&u.runtime.refCountingDebug&&u.log(`RefRefLocal id:${this.id} v:`+this.v)}}u.RefRefLocal=t;class p extends s{constructor(){super(...arguments),this.vtable=u.mkMapVTable(),this.data=[]}scan(e){for(var t of this.data)e(t.key,t.val)}gcKey(){return"{...}"}gcSize(){return 2*this.data.length+4}findIdx(t){t+="";for(let e=0;e<this.data.length;++e)if(this.data[e].key==t)return e;return-1}destroy(){super.destroy();for(let e=0;e<this.data.length;++e)this.data[e].val=0;this.data=[]}print(){u.runtime&&u.runtime.refCountingDebug&&u.log(`RefMap id:${this.id} size:`+this.data.length)}toDebugString(){let t="RefMap: {";for(let e=0;e<this.data.length;++e)0<e&&(t+=", "),t+=this.data[e].key+": "+s.toDebugString(this.data[e].val);return t+"}"}toAny(){let t={};return this.data.forEach(e=>{t[e.key]=s.toAny(e.val)}),t}static fromAny(e){var t,r=new p;for(t of Object.keys(e))r.data.push({key:t,val:s.fromAny(e[t])});return r}}function h(){u.runtime&&u.runtime.dumpLivePointers()}u.RefMap=p,u.dumpLivePointers=h,(e=u.numops||(u.numops={})).toString=function(e){return null===e?"null":void 0===e?"undefined":e.toString()},e.toBoolDecr=function(e){return!!e},e.toBool=function(e){return!!e},(e=u.langsupp||(u.langsupp={})).toInt=function(e){return 0|e},e.toFloat=function(e){return e},e.ignore=function(e){return e},(e=u.pxtcore||(u.pxtcore={})).ptrOfLiteral=function(e){return e},e.debugMemLeaks=function(){h()},e.templateHash=function(){return 0},e.programHash=function(){return 0},e.programName=function(){return u.title},e.programSize=function(){return 0},e.afterProgramPage=function(){return 0},e.getConfig=function(e,t){return null==(e=u.getConfig(e))?t:e},e.toInt=function(e){return e>>0},e.toUInt=function(e){return e>>>0},e.toDouble=function(e){return e},e.toFloat=function(e){return e},e.fromInt=function(e){return e},e.fromUInt=function(e){return e},e.fromDouble=function(e){return e},e.fromFloat=function(e){return e},e.fromBool=function(e){return!!e};let m;function g(e,t){return e||u.throwFailedPropertyAccessError(e,t),t+="",e instanceof o?e.fields[t]:(t=e.findIdx(t))<0?void 0:e.data[t].val}function f(e,t,r){var n;e||u.throwFailedPropertyAccessError(e,t),t+="",e instanceof o?e.fields[t]=r:(n=e.findIdx(t))<0?e.data.push({key:t,val:r}):e.data[n].val=r}function _(e){e&&(e instanceof l||e.info)||u.throwFailedCastError(e,"function")}(c=m=u.pxtrt||(u.pxtrt={})).toInt8=function(e){return(255&e)<<24>>24},c.toInt16=function(e){return(65535&e)<<16>>16},c.toInt32=function(e){return 0|e},c.toUInt32=function(e){return e>>>0},c.toUInt8=function(e){return 255&e},c.toUInt16=function(e){return 65535&e},c.nullFix=function(e){return null==e||!1===e?0:!0===e?1:e},c.nullCheck=function(e){null==e&&u.U.userError("Dereferencing null/undefined value.")},c.panic=function(e){u.U.userError("PANIC! Code "+e)},c.stringToBool=function(e){return e?1:0},c.ptrToBool=function(e){return e?1:0},c.emptyToNull=function(e){return""==e?0:e},c.ldlocRef=function(e){return e.v},c.stlocRef=function(e,t){e.v=t},c.mklocRef=function(){return new t},c.stclo=function(e,t,r){return n(0<=t&&t<e.fields.length),n(null===e.fields[t]),e.fields[t]=r,e},c.runtimeWarning=function(e){u.Runtime.postMessage(u.getWarningMessage(e))},c.mkMap=function(){return new p},c.mapGet=function(e,t){return g(e,c.mapKeyNames[t])},c.mapSet=function(e,t,r){return f(e,c.mapKeyNames[t],r)},c.mapGetByString=g,c.mapDeleteByString=function(e,t){return null==e&&u.throwNullUndefinedAsObjectError(),e instanceof p||u.throwFailedCastError(e,"object"),0<=(t=e.findIdx(t))&&e.data.splice(t,1),!0},c.mapSetGeneric=f,c.mapGetGeneric=g,c.mapSetByString=f,c.keysOf=function(e){null==e&&u.throwNullUndefinedAsObjectError();var t=new u.RefCollection;if(e instanceof p)for(var r of e.data)t.push(r.key);return t},(e=u.pxtcore||(u.pxtcore={})).mkClassInstance=function(e){n(!!e.methods);var t=new o;return t.vtable=e,t},e.switch_eq=function(e,t){return e==t},e.typeOf=function(e){return typeof e},(e=u.thread||(u.thread={})).panic=m.panic,e.pause=function(e){let t=u.getResume();u.runtime.schedule(()=>{t()},e)},e.runInBackground=function(e){_(e),u.runtime.runFiberAsync(e)},e.forever=function(t){_(t),function e(){u.runtime.runFiberAsync(t).then(()=>u.U.delay(20)).then(e)}()},e.typeCheck=_})(pxsim=pxsim||{}),(s=>{class n extends s.RefObject{constructor(){super(),this.data=[]}scan(t){for(let e=0;e<this.data.length;++e)t("["+e+"]",this.data[e])}gcKey(){return"[...]"}gcSize(){return this.data.length+2}toArray(){return this.data.slice(0)}toAny(){return this.data.map(e=>s.RefObject.toAny(e))}static fromAny(e,t=!0){var r=new n;return r.data=t?e.map(e=>s.RefObject.fromAny(e)):e.slice(0),r}toDebugString(){let t="[";for(let e=0;e<this.data.length;++e){0<e&&(t+=",");var r=s.RefObject.toDebugString(this.data[e]);if(100<t.length+r.length){0==e&&(t+=r.substr(0,100)),t+="...";break}t+=r}return t+="]"}destroy(){var t=this.data;for(let e=0;e<t.length;++e)t[e]=0;this.data=[]}isValidIndex(e){return 0<=e&&e<this.data.length}push(e){this.data.push(e)}pop(){return this.data.pop()}getLength(){return this.data.length}setLength(e){this.data.length=e}getAt(e){return this.data[e]}setAt(e,t){this.data[e]=t}insertAt(e,t){this.data.splice(e,0,t)}removeAt(e){return this.data.splice(e,1)[0]}indexOf(e,t){return this.data.indexOf(e,t)}print(){}}var e;function r(e,t){if(a(e),e.isValidIndex(t))return e.removeAt(t)}function i(e,t,r){return a(e),e.indexOf(t,r)}function a(e){e instanceof n||s.throwFailedCastError(e,"Array")}s.RefCollection=n,(h=s.Array_||(s.Array_={})).mk=function(){return new n},h.isArray=function(e){return e instanceof n},h.length=function(e){return a(e),e.getLength()},h.setLength=function(e,t){a(e),e.setLength(t)},h.push=function(e,t){a(e),e.push(t)},h.pop=function(e,t){return a(e),e.pop()},h.getAt=function(e,t){return a(e),e.getAt(t)},h.removeAt=r,h.insertAt=function(e,t,r){a(e),e.insertAt(t,r)},h.setAt=function(e,t,r){a(e),e.setAt(t,r)},h.indexOf=i,h.removeElement=function(e,t){return a(e),0<=(t=i(e,t,0))?(r(e,t),1):0},h.typeCheck=a;let o;function l(e,t){return s.pxtrt.nullFix(e)==s.pxtrt.nullFix(t)}function c(e){return e<<16>>16}(h=o=s.Math_||(s.Math_={})).imul=Math.imul||function(e,t){var r=65535&e,n=65535&t;return r*n+((e>>>16&65535)*n+r*(t>>>16&65535)<<16>>>0)|0},h.idiv=function(e,t){return(0|e)/(0|t)|0},h.round=function(e){return Math.round(e)},h.roundWithPrecision=function(e,t){if((t|=0)<=0)return Math.round(e);if(0==e)return 0;let r=0;for(;0==r&&t<21;){var n=Math.pow(10,t++);r=Math.round(e*n+Number.EPSILON)/n}return r},h.ceil=function(e){return Math.ceil(e)},h.floor=function(e){return Math.floor(e)},h.sqrt=function(e){return Math.sqrt(e)},h.pow=function(e,t){return Math.pow(e,t)},h.clz32=function(e){return Math.clz32(e)},h.log=function(e){return Math.log(e)},h.log10=function(e){return Math.log10(e)},h.log2=function(e){return Math.log2(e)},h.exp=function(e){return Math.exp(e)},h.sin=function(e){return Math.sin(e)},h.sinh=function(e){return Math.sinh(e)},h.cos=function(e){return Math.cos(e)},h.cosh=function(e){return Math.cosh(e)},h.tan=function(e){return Math.tan(e)},h.tanh=function(e){return Math.tanh(e)},h.asin=function(e){return Math.asin(e)},h.asinh=function(e){return Math.asinh(e)},h.acos=function(e){return Math.acos(e)},h.acosh=function(e){return Math.acosh(e)},h.atan=function(e){return Math.atan(e)},h.atanh=function(e){return Math.atanh(e)},h.atan2=function(e,t){return Math.atan2(e,t)},h.trunc=function(e){return 0<e?Math.floor(e):Math.ceil(e)},h.random=function(){return Math.random()},h.randomRange=function(e,t){var r;return e==t?e:(t<e&&(r=e,e=t,t=r),Math.floor(e)==e&&Math.floor(t)==t?e+Math.floor(Math.random()*(t-e+1)):e+Math.random()*(t-e))},(h=s.Number_||(s.Number_={})).lt=function(e,t){return e<t},h.le=function(e,t){return e<=t},h.neq=function(e,t){return!l(e,t)},h.eq=l,h.eqDecr=function(e,t){return s.pxtrt.nullFix(e)==s.pxtrt.nullFix(t)},h.gt=function(e,t){return t<e},h.ge=function(e,t){return t<=e},h.div=function(e,t){return 0|Math.floor(e/t)},h.mod=function(e,t){return e%t},h.bnot=function(e){return~e},h.toString=function(e){return e+""},(h=s.thumb||(s.thumb={})).adds=function(e,t){return e+t|0},h.subs=function(e,t){return e-t|0},h.divs=function(e,t){return 0|Math.floor(e/t)},h.muls=function(e,t){return o.imul(e,t)},h.ands=function(e,t){return e&t},h.orrs=function(e,t){return e|t},h.eors=function(e,t){return e^t},h.lsls=function(e,t){return e<<t},h.lsrs=function(e,t){return e>>>t},h.asrs=function(e,t){return e>>t},h.bnot=function(e){return~e},h.ignore=function(e){return e},(h=s.avr||(s.avr={})).adds=function(e,t){return c(e+t)},h.subs=function(e,t){return c(e-t)},h.divs=function(e,t){return c(Math.floor(e/t))},h.muls=function(e,t){return c(o.imul(e,t))},h.ands=function(e,t){return c(e&t)},h.orrs=function(e,t){return c(e|t)},h.eors=function(e,t){return c(e^t)},h.lsls=function(e,t){return c(e<<t)},h.lsrs=function(e,t){return(65535&e)>>>t},h.asrs=function(e,t){return c(e>>t)},h.bnot=function(e){return~e},h.ignore=function(e){return e};let d;function u(e){"string"!=typeof e&&s.throwFailedCastError(e,"string")}(h=d=s.String_||(s.String_={})).stringConv=function(e){let t=s.getResume();e instanceof s.RefRecord&&e.vtable.toStringMethod?s.runtime.runFiberAsync(e.vtable.toStringMethod,e).then(()=>{t(s.runtime.currFrame.retval+"")}):t(e+"")},h.mkEmpty=function(){return""},h.fromCharCode=function(e){return String.fromCharCode(e)},h.toNumber=function(e){return u(e),parseFloat(e)},h.concat=function(e,t){return u(e),e+t},h.substring=function(e,t,r){return u(e),e.slice(t,t+r)},h.equals=function(e,t){return u(e),e==t},h.compare=function(e,t){return u(e),e==t?0:e<t?-1:1},h.compareDecr=function(e,t){return u(e),e==t?0:e<t?-1:1},h.length=function(e){return u(e),e.length},h.substr=function(e,t,r){return u(e),e.substr(t,r)},h.charAt=function(e,t){return u(e),e.charAt(t)},h.charCodeAt=function(e,t){return u(e),n=t,u(r=e),0<=n&&n<r.length?e.charCodeAt(t):0;var r,n},h.indexOf=function(e,t,r){return u(e),null==t?-1:e.indexOf(t,r)},h.lastIndexOf=function(e,t,r){return u(e),null==t?-1:e.lastIndexOf(t,r)},h.includes=function(e,t,r){return u(e),null!=t&&e.includes(t,r)},h.typeCheck=u,(h=s.Boolean_||(s.Boolean_={})).toString=function(e){return e?"true":"false"},h.bang=function(e){return!e};class p extends s.RefObject{constructor(e){super(),this.data=e,this.isStatic=!1}scan(e){}gcKey(){return"Buffer"}gcSize(){return 2+(this.data.length+3>>2)}gcIsStatic(){return this.isStatic}print(){}toDebugString(){return t.toHex(this)}}s.RefBuffer=p;let t;{var h=t=s.BufferMethods||(s.BufferMethods={});let i;function m(e){let t=(e=>{switch(e){case i.Int8LE:return-1;case i.UInt8LE:return 1;case i.Int16LE:return-2;case i.UInt16LE:return 2;case i.Int32LE:return-4;case i.UInt32LE:return 4;case i.Int8BE:return-10;case i.UInt8BE:return 10;case i.Int16BE:return-20;case i.UInt16BE:return 20;case i.Int32BE:return-40;case i.UInt32BE:return 40;case i.Float32LE:return 4;case i.Float32BE:return 40;case i.Float64LE:return 8;case i.Float64BE:return 80;default:throw s.U.userError("bad format")}})(e),r=!1,n=(t<0&&(r=!0,t=-t),!1);10<=t&&(n=!0,t/=10);e=e>=i.Float32LE;return{size:t,signed:r,swap:n,isFloat:e}}function g(e){return new p(new Uint8Array(e))}function f(e,t){return 0<=t&&t<e.data.length}function _(e,t){return k(e),f(e,t)?e.data[t]:0}function y(e){e.isStatic&&s.U.userError("Writing to read only buffer.")}function b(e,t,r){k(e),f(e,t)&&(y(e),e.data[t]=r)}function v(e,t,r=0,n=-1){k(e),r<0||r>e.data.length||(n<0&&(n=e.data.length),n=Math.min(n,e.data.length-r),y(e),e.data.fill(t,r,r+n))}function T(t,r,n,i,s){if(n.buffer===t.buffer)T(t,r,n.slice(i,i+s),0,s);else for(let e=0;e<s;++e)t[r+e]=n[i+e]}(e=i=h.NumberFormat||(h.NumberFormat={}))[e.Int8LE=1]="Int8LE",e[e.UInt8LE=2]="UInt8LE",e[e.Int16LE=3]="Int16LE",e[e.UInt16LE=4]="UInt16LE",e[e.Int32LE=5]="Int32LE",e[e.Int8BE=6]="Int8BE",e[e.UInt8BE=7]="UInt8BE",e[e.Int16BE=8]="Int16BE",e[e.UInt16BE=9]="UInt16BE",e[e.Int32BE=10]="Int32BE",e[e.UInt32LE=11]="UInt32LE",e[e.UInt32BE=12]="UInt32BE",e[e.Float32LE=13]="Float32LE",e[e.Float64LE=14]="Float64LE",e[e.Float32BE=15]="Float32BE",e[e.Float64BE=16]="Float64BE",h.fmtInfo=m,h.getNumber=function(t,e,r){k(t);var n=m(e);if(n.isFloat)return e=t.data.buffer.slice(r,r+n.size),n.swap&&new Uint8Array(e).reverse(),new(4==n.size?Float32Array:Float64Array)(e)[0];let i=0;for(let e=0;e<n.size;++e){i<<=8;var s=n.swap?r+e:r+n.size-e-1;i|=t.data[s]}return n.signed?(e=32-8*n.size,i=i<<e>>e):i>>>=0,i},h.setNumber=function(t,e,r,n){k(t);var i=m(e);if(i.isFloat){var s=new Uint8Array(i.size);4==i.size?new Float32Array(s.buffer)[0]=n:new Float64Array(s.buffer)[0]=n,i.swap&&s.reverse();for(let e=0;e<i.size;++e)t.data[r+e]=s[e]}else for(let e=0;e<i.size;++e){var a=i.swap?r+i.size-e-1:r+e;t.data[a]=255&n,n>>=8}},h.createBuffer=g,h.createBufferFromHex=function(t){d.typeCheck(t);var r=g(t.length>>1);for(let e=0;e<t.length;e+=2)r.data[e>>1]=parseInt(t.slice(e,e+2),16);return r.isStatic=!0,r},h.isReadOnly=function(e){return k(e),e.isStatic},h.getBytes=function(e){return k(e),e.data},h.getUint8=function(e,t){return k(e),_(e,t)},h.getByte=_,h.setUint8=function(e,t,r){k(e),b(e,t,r)},h.setByte=b,h.length=function(e){return k(e),e.data.length},h.fill=v,h.slice=function(e,t,r){return k(e),t=Math.min(e.data.length,t),r<0&&(r=e.data.length),r=Math.min(r,e.data.length-t),new p(e.data.slice(t,t+r))},h.toHex=function(t){k(t);var r="0123456789abcdef";let n="";for(let e=0;e<t.data.length;++e)n=(n+=r[t.data[e]>>4])+r[15&t.data[e]];return n},h.toString=function(e){return k(e),s.U.fromUTF8Array(e.data)};let u=-2147483648;function k(e){e instanceof p||s.throwFailedCastError(e,"Buffer")}h.shift=function(e,t,r,n){k(e),n<0&&(n=e.data.length-r),r<0||r+n>e.data.length||r+n<r||0==n||0==t||t==u||0!=n&&0!=t&&t!=u&&(t<=-n||n<=t?v(e,0):(y(e),t<0?(T(e.data,r+(t=-t),e.data,r,n-t),e.data.fill(0,r,r+t)):(T(e.data,r,e.data,r+t,n-=t),e.data.fill(0,r+n,r+n+t))))},h.rotate=function(n,i,s,a){if(k(n),a<0&&(a=n.data.length-s),!(s<0||s+a>n.data.length||s+a<s||0==a||0==i||i==u)){y(n),i<0&&(i+=a<<8),(i%=a)<0&&(i+=a);var o=n.data;let e=i,t=0,r=e;for(var l=a;t!=r;){var c=o[t+s];o[t+++s]=o[r+s],o[r+++s]=c,r==l?r=e:t==e&&(e=r)}}},h.write=function(e,t,r,n=0,i=-1){k(e),k(r),i<0&&(i=r.data.length),n<0||t<0||t>e.data.length||(i=Math.min(r.data.length-n,e.data.length-t))<0||(y(e),T(e.data,t,r.data,n,i))},h.typeCheck=k}})(pxsim=pxsim||{}),(t=>{(t.control||(t.control={})).createBufferFromUTF8=function(e){return t.String_.typeCheck(e),new t.RefBuffer(t.U.toUTF8Array(e))}})(pxsim=pxsim||{}),(e=>{{e=e.localization||(e.localization={});let n={};function i(e,o){return 0==o.length?e:e.replace(/\{([0-9]+)(\:[^\}]+)?\}/g,function(e,r,t){r=o[parseInt(r)];let n="";var i=/^:f(\d*)\.(\d+)/.exec(t);if(i){var s=parseInt(i[2]);let e=parseInt(i[1])||0;var a=/^0/.test(i[1])?"0":" ";let t=r.toFixed(s);if(0<e&&0<s&&(e+=s+1),0<e)for(;t.length<e;)t=a+t;n=t}else n=":x"==t?"0x"+r.toString(16):void 0===r?"(undef)":null===r?"(null)":r.toString?r.toString():r+"";return":a"==t?/^\s*[euioah]/.test(n.toLowerCase())?n="an "+n:/^\s*[bcdfgjklmnpqrstvwxz]/.test(n.toLowerCase())&&(n="a "+n):":s"==t?n=1==r?"":"s":":q"==t?n=l(n):":jq"==t?n=c(n):":uri"==t?n=encodeURIComponent(n).replace(/'/g,"%27").replace(/"/g,"%22"):":url"==t?n=encodeURI(n).replace(/'/g,"%27").replace(/"/g,"%22"):":%"==t&&(n=(100*r).toFixed(1).toString()+"%"),n})}function l(e){return e&&e.replace(/([^\w .!?\-$])/g,e=>"&#"+e.charCodeAt(0)+";")}function c(e){return e.replace(/[^\w .!?\-$]/g,e=>{e=e.charCodeAt(0).toString(16);return"\\u"+"0000".substr(0,4-e.length)+e})}e.setLocalizedStrings=function(e){n=e||{}},e.lf=function(e,...t){let r=n[e]||e;return i(r=r.replace(/^\{(id|loc):[^\}]+\}/g,""),t)},e.fmt_va=i,e.htmlEscape=l,e.jsStringQuote=c}})(pxsim=pxsim||{}),(e=>{let t;var r;(r=t=e.LogLevel||(e.LogLevel={}))[r.Debug=0]="Debug",r[r.Info=1]="Info",r[r.Log=1]="Log",r[r.Warning=2]="Warning",r[r.Error=3]="Error",e.ConsoleLogger=class{constructor(){this.setLogLevel(t.Info)}setLogLevel(e){this.logLevel=e}getLogLevel(){return this.logLevel}info(...e){this.shouldLog(t.Info)&&null!=console&&console.info&&console.info.call(null,...e)}log(...e){this.shouldLog(t.Log)&&null!=console&&console.log&&console.log.call(null,...e)}debug(...e){this.shouldLog(t.Debug)&&null!=console&&console.debug&&console.debug.call(null,...e)}error(...e){this.shouldLog(t.Error)&&null!=console&&console.error&&console.error.call(null,...e)}warn(...e){this.shouldLog(t.Warning)&&null!=console&&console.warn&&console.warn.call(null,...e)}shouldLog(e){return e>=this.logLevel}};let n=new e.ConsoleLogger;e.info=function(...e){n.info(...e)},e.log=function(...e){n.log(...e)},e.debug=function(...e){n.debug(...e)},e.error=function(...e){n.error(...e)},e.warn=function(...e){n.warn(...e)},e.setLogger=function(e){var t=null==n?void 0:n.getLogLevel();n=e,void 0!==t&&n.setLogLevel(t)},e.setLogLevel=function(e){n.setLogLevel(e)}})(pxsim=pxsim||{}),!function(pxsim){let MIN_MESSAGE_WAIT_MS=200,tracePauseMs=0,MessageListenerFlags;(e=>{e[e.MESSAGE_BUS_LISTENER_REENTRANT=8]="MESSAGE_BUS_LISTENER_REENTRANT",e[e.MESSAGE_BUS_LISTENER_QUEUE_IF_BUSY=16]="MESSAGE_BUS_LISTENER_QUEUE_IF_BUSY",e[e.MESSAGE_BUS_LISTENER_DROP_IF_BUSY=32]="MESSAGE_BUS_LISTENER_DROP_IF_BUSY",e[e.MESSAGE_BUS_LISTENER_IMMEDIATE=192]="MESSAGE_BUS_LISTENER_IMMEDIATE"})(MessageListenerFlags=MessageListenerFlags||{});let U;(e=>{function t(e){return e.split(/\s+/).filter(e=>!!e)}function r(e){for(;e.firstChild;)e.removeChild(e.firstChild)}e.containsClass=function(r,e){return t(e).every(e=>{return e=e,(t=r).classList?t.classList.contains(e):!((t.className+"").split(/\s+/).indexOf(e)<0);var t})},e.addClass=function(r,e){t(e).forEach(e=>{var t;e=e,(t=r).classList?t.classList.add(e):(t.className+"").split(/\s+/).indexOf(e)<0&&(t.className.baseVal+=" "+e)})},e.removeClass=function(r,e){t(e).forEach(e=>{var t;t=e,(e=r).classList?e.classList.remove(t):e.className.baseVal=(e.className+"").split(/\s+/).filter(e=>e!=t).join(" ")})},e.remove=function(e){e.parentElement.removeChild(e)},e.removeChildren=r,e.clear=function(e){r(e)},e.assert=function(e,t="Assertion failed"){if(!e)throw new Error(t)},e.repeatMap=function(t,r){t=t||0;var n=[];for(let e=0;e<t;++e)n.push(r(e));return n},e.userError=function(e){throw(e=new Error(e)).isUserError=!0,e},e.now=function(){return Date.now()};let n,i=(e.perfNowUs=function(){return 1e3*(n=n||("undefined"!=typeof performance?performance.now.bind(performance)||performance.moznow.bind(performance)||performance.msNow.bind(performance)||performance.webkitNow.bind(performance)||performance.oNow.bind(performance):Date.now))()},Promise.resolve());async function s(t,r,n){let i=0;var s=[];let a=[];for(let e=0;e<t;e++){var o=(async()=>{for(;i<r.length;){var e=i++,t=r[e];a[e]=await n(t)}})();s.push(o)}try{await Promise.all(s)}catch(e){throw i=r.length,e}return a}function a(){return"undefined"!=typeof window&&!!window.pxtElectron}function o(){return"undefined"!=typeof window&&!!window.ipcRenderer}function l(){return a()||o()}function c(e){return/^http:\/\/(?:localhost|127\.0\.0\.1|192\.168\.\d{1,3}\.\d{1,3}|[a-zA-Z0-9.-]+\.local):\d+\/?/.test(e)&&!/nolocalhost=1/.test(e)}function u(){try{return"undefined"!=typeof window&&c(window.location.href)}catch(e){return!1}}e.nextTick=function(e){i.then(e)},e.delay=async function(t,e){return e=await e,await new Promise(e=>setTimeout(()=>e(),t)),e},e.throttle=function(n,i,s){let a;return function(){let e=this,t=arguments;var r=s&&!a;a=a||setTimeout(function(){a=null,s||n.apply(e,t)},i),r&&n.apply(e,t)}},e.promiseMapAll=function(e,t){return Promise.all(e.map(e=>t(e)))},e.promiseMapAllSeries=function(e,t){return s(1,e,t)},e.promisePoolAsync=s,e.promiseTimeout=async function(r,e,n){let i,s;var t=new Promise((e,t)=>{s=e,i=setTimeout(()=>{s=void 0,clearTimeout(i),t(n||`Promise timed out after ${r}ms`)},r)});return Promise.race([e,t]).then(e=>(s&&(clearTimeout(i),s()),e))},e.stringToUint8Array=function(t){var r=t.length,n=new Uint8Array(r);for(let e=0;e<r;++e)n[e]=255&t.charCodeAt(e);return n},e.uint8ArrayToString=function(t){var r=t.length;let n="";for(let e=0;e<r;++e)n+=String.fromCharCode(t[e]);return n},e.fromUTF8=function(t){if(!t)return"";let r="";for(let e=0;e<t.length;++e){var n=255&t.charCodeAt(e);r+=37==n||127<n?"%"+n.toString(16):t.charAt(e)}return decodeURIComponent(r)},e.toUTF8=function(r,n){let i="";if(r)for(let t=0;t<r.length;++t){let e=r.charCodeAt(t);var s;e<=127?i+=r.charAt(t):e<=2047?i+=String.fromCharCode(192|e>>6,128|63&e):(!n&&55296<=e&&e<=56319&&(s=r.charCodeAt(++t),isNaN(s)||(e=65536+(e-55296<<10)+(s-56320))),e<=65535?i+=String.fromCharCode(224|e>>12,128|e>>6&63,128|63&e):i+=String.fromCharCode(240|e>>18,128|e>>12&63,128|e>>6&63,128|63&e))}return i},e.toUTF8Array=function(e){return(new TextEncoder).encode(e)},e.fromUTF8Array=function(e){return(new TextDecoder).decode(e)},e.isPxtElectron=a,e.isIpcRenderer=o,e.isElectron=l,e.testLocalhost=c,e.isLocalHost=u,e.isLocalHostDev=function(){return u()&&!l()},e.unique=function(e,r){let n=[],i={};return e.forEach(e=>{var t=r(e);i.hasOwnProperty(t)||(i[t]=null,n.push(e))}),n},e.sanitizeCssName=function(e){let t=e.replace(/[^a-zA-Z0-9-_]/g,"_");return t=/^[a-zA-Z_]/.test(t)?t:"cls_"+t}})(U=pxsim.U||(pxsim.U={}));class BreakLoopException{}pxsim.BreakLoopException=BreakLoopException;let pxtcore;function getResume(){return pxsim.runtime.getResume()}(e=>{function t(e){var t=pxsim.runtime.currTryFrame(),r=(t||U.userError("unhandled exception: "+e),t.handlerFrame);throw(pxsim.runtime.currFrame=r).pc=t.handlerPC,r.tryFrame=t.parent,r.thrownValue=e,r.hasThrownValue=!0,new BreakLoopException}e.beginTry=function(e){pxsim.runtime.currFrame.tryFrame={parent:pxsim.runtime.currTryFrame(),handlerPC:e,handlerFrame:pxsim.runtime.currFrame}},e.endTry=function(){var e=pxsim.runtime.currFrame;e.tryFrame=e.tryFrame.parent},e.throwValue=t,e.getThrownValue=function(){var e=pxsim.runtime.currFrame;return U.assert(e.hasThrownValue),e.hasThrownValue=!1,e.thrownValue},e.endFinally=function(){var e=pxsim.runtime.currFrame;e.hasThrownValue&&(e.hasThrownValue=!1,t(e.thrownValue))}})(pxtcore=pxsim.pxtcore||(pxsim.pxtcore={})),pxsim.getResume=getResume;let SERIAL_BUFFER_LENGTH=16;class BaseBoard{constructor(){this.messageListeners=[],this.serialOutBuffer="",this.messages=[],this.lastSerialTime=0,this.debouncedPostAll=()=>{var e=Date.now();e-this.lastSerialTime>MIN_MESSAGE_WAIT_MS?(clearTimeout(this.serialTimeout),this.messages.length&&(Runtime.postMessage({type:"bulkserial",data:this.messages,id:pxsim.runtime.id,sim:!0}),this.messages=[],this.lastSerialTime=e)):this.serialTimeout=setTimeout(this.debouncedPostAll,50)},this.id=pxsim.Embed.frameid||"b"+Math.round(2147483647*Math.random()),this.bus=new pxsim.EventBus(pxsim.runtime,this)}updateView(){}receiveMessage(e){pxsim.runtime&&!pxsim.runtime.dead&&this.dispatchMessage(e)}dispatchMessage(e){for(var t of this.messageListeners)t(e)}addMessageListener(e){this.messageListeners.push(e)}get storedState(){return this.runOptions?(this.runOptions.storedState||(this.runOptions.storedState={}),this.runOptions.storedState):{}}initAsync(e){return this.runOptions=e,Promise.resolve()}setStoredState(e,t){null==t?delete this.storedState[e]:this.storedState[e]=t,Runtime.postMessage({type:"simulator",command:"setstate",stateKey:e,stateValue:t})}onDebuggerResume(){}screenshotAsync(e){return Promise.resolve(void 0)}kill(){}writeSerial(e){this.serialOutBuffer+=e,(/\n/.test(this.serialOutBuffer)||this.serialOutBuffer.length>SERIAL_BUFFER_LENGTH)&&(this.messages.push({time:Date.now(),data:this.serialOutBuffer}),this.debouncedPostAll(),this.serialOutBuffer="")}}pxsim.BaseBoard=BaseBoard;class CoreBoard extends BaseBoard{constructor(){super(),this.updateSubscribers=[],this.updateView=()=>{this.updateSubscribers.forEach(e=>e())},this.builtinParts={},this.builtinVisuals={},this.builtinPartVisuals={}}kill(){super.kill(),pxsim.codal.music.__stopSoundExpressions(),pxsim.AudioContextManager.stopAll()}}pxsim.CoreBoard=CoreBoard;class BareBoard extends BaseBoard{}function initBareRuntime(){pxsim.runtime.board=new BareBoard;var e=pxsim;e.basic={pause:pxsim.thread.pause,showNumber:e=>{var t=getResume();pxsim.log("SHOW NUMBER:",e),U.nextTick(t)}},e.serial={writeString:e=>pxsim.runtime.board.writeSerial(e)},e.pins={createBuffer:pxsim.BufferMethods.createBuffer},e.control={inBackground:pxsim.thread.runInBackground,createBuffer:pxsim.BufferMethods.createBuffer,dmesg:e=>pxsim.log("DMESG: "+e),deviceDalVersion:()=>"sim",__log:(e,t)=>pxsim.log("LOG: "+t.trim())}}pxsim.initBareRuntime=initBareRuntime;let LogType;(e=>{e[e.UserSet=0]="UserSet",e[e.BackAdd=1]="BackAdd",e[e.BackRemove=2]="BackRemove"})(LogType=LogType||{});class EventHandler{constructor(e,t){this.handler=e,this.flags=t,this.busy=0}async runAsync(e,t,r){var n=this.flags||MessageListenerFlags.MESSAGE_BUS_LISTENER_QUEUE_IF_BUSY;if(n!==MessageListenerFlags.MESSAGE_BUS_LISTENER_IMMEDIATE)return n===MessageListenerFlags.MESSAGE_BUS_LISTENER_QUEUE_IF_BUSY?this.runFiberAsync(e,t,r):void(n===MessageListenerFlags.MESSAGE_BUS_LISTENER_DROP_IF_BUSY&&this.busy||this.runFiberAsync(e,t,r));U.userError("MESSAGE_BUS_LISTENER_IMMEDIATE is not supported!")}async runFiberAsync(e,t,r){this.busy++,await t.runFiberAsync(this.handler,...r?r(e):[e]),this.busy--}}class EventQueue{constructor(e,t){this.runtime=e,this.valueToArgs=t,this.max=5,this.events=[],this.awaiters=[],this._handlers=[],this._addRemoveLog=[]}push(e,t){return 0<this.awaiters.length&&(t?(t=this.awaiters.shift())&&t():(t=this.awaiters.slice(),this.awaiters=[],t.forEach(e=>e()))),0==this.handlers.length||this.events.length>this.max||(this.events.push(e),this.lock)?Promise.resolve():this.poke()}async poke(){this.lock=!0;var e,t,r=this.events;this.events=[];for(e of r)for(var n of this.handlers)await n.runAsync(e,this.runtime,this.valueToArgs);if(0<this.events.length)return this.poke();this.lock=!1;for(t of this._addRemoveLog)t.log===LogType.BackAdd?this.addHandler(t.act,t.flags):t.log===LogType.BackRemove?this.removeHandler(t.act):this.setHandler(t.act,t.flags);this._addRemoveLog=[]}get handlers(){return this._handlers}setHandler(e,t=0){this.lock?this._addRemoveLog.push({act:e,log:LogType.UserSet,flags:t}):this._handlers=[new EventHandler(e,t)]}addHandler(t,e=0){this.lock?this._addRemoveLog.push({act:t,log:LogType.BackAdd,flags:e}):this._handlers.some(e=>e.handler===t)||this._handlers.push(new EventHandler(t,e))}removeHandler(t){var e;this.lock?this._addRemoveLog.push({act:t,log:LogType.BackRemove,flags:0}):-1!=(e=this._handlers.findIndex(e=>e.handler===t))&&this._handlers.splice(e,1)}addAwaiter(e){this.awaiters.push(e)}}function bind(e){let n=e.arg0,i=e.fn;return e=>{let t=0;for(;e.hasOwnProperty("arg"+t);)t++;var r=e;for(let e=t;0<e;e--)r["arg"+e]=r["arg"+(e-1)];return e.arg0=n,i(e)}}function _leave(e,t){return e.parent.retval=t,e.parent}function syntheticRefAction(t){return pxtcore.mkAction(0,e=>_leave(e,t(e)))}pxsim.EventQueue=EventQueue,pxsim.initCurrentRuntime=void 0,pxsim.handleCustomMessage=void 0,pxsim.syntheticRefAction=syntheticRefAction;class TimeoutScheduled{constructor(e,t,r,n){this.id=e,this.fn=t,this.totalRuntime=r,this.timestampCall=n}}pxsim.TimeoutScheduled=TimeoutScheduled;class PausedTimeout{constructor(e,t){this.fn=e,this.timeRemaining=t}}function mkVTable(e){return{name:e.name,numFields:e.numFields,classNo:e.classNo,methods:e.methods,iface:e.iface,lastSubtypeNo:e.lastSubtypeNo,toStringMethod:e.toStringMethod,maxBgInstances:e.maxBgInstances}}pxsim.PausedTimeout=PausedTimeout,pxsim.mkVTable=mkVTable;let mapVTable=null;function mkMapVTable(){return mapVTable=mapVTable||mkVTable({name:"_Map",numFields:0,classNo:0,lastSubtypeNo:0,methods:null})}function functionName(e){e=e.info;return e?`${e.functionName} (${e.fileName}:${e.line+1}:${e.column+1})`:"()"}pxsim.mkMapVTable=mkMapVTable,pxsim.functionName=functionName;class Runtime{constructor(msg){this.numGlobals=1e3,this.dead=!1,this.running=!1,this.idleTimer=void 0,this.recording=!1,this.recordingTimer=0,this.recordingLastImageData=void 0,this.recordingWidth=void 0,this.startTime=0,this.startTimeUs=0,this.pausedTime=0,this.lastPauseTimestamp=0,this.globals={},this.environmentGlobals={},this.otherFrames=[],this.loopLock=null,this.loopLockWaitList=[],this.heapSnapshots=[],this.timeoutsScheduled=[],this.timeoutsPausedOnBreakpoint=[],this.pausedOnBreakpoint=!1,this.traceDisabled=!1,this.perfOffset=0,this.perfElapsed=0,this.perfStack=0,this.refCountingDebug=!1,this.refObjId=1,this.numDisplayUpdates=0,U.assert(!!pxsim.initCurrentRuntime),this.id=msg.id,this.refCountingDebug=!!msg.refCountingDebug;let threadId=0,breakpoints=null,currResume,dbgHeap,dbgResume,breakFrame=null,lastYield=Date.now(),userGlobals,__this=this,yieldDelay=(this.traceDisabled=!!msg.traceDisabled,void 0!==msg.yieldDelay?msg.yieldDelay:5),evalIface={runtime:this,oops:oops,doNothing:doNothing,pxsim:pxsim,globals:this.globals,setupYield:setupYield,maybeYield:maybeYield,setupDebugger:setupDebugger,isBreakFrame:isBreakFrame,breakpoint:breakpoint,trace:trace,checkStack:checkStack,leave:_leave,checkResumeConsumed:checkResumeConsumed,setupResume:setupResume,setupLambda:setupLambda,checkSubtype:checkSubtype,failedCast:failedCast,buildResume:buildResume,mkVTable:mkVTable,bind:bind,leaveAccessor:leaveAccessor};function oops(e){throw new Error("sim error: "+e)}function doNothing(e){return e.pc=-1,_leave(e,e.parent.retval)}function flushLoopLock(){for(;0<__this.loopLockWaitList.length&&!__this.loopLock;)__this.loopLockWaitList.shift()()}let yieldReset=()=>{};function setupYield(e){yieldReset=e}function loopForSchedule(e){let t=new Object,r=e.pc;return __this.loopLock=t,__this.otherFrames.push(e),()=>{__this.dead||(U.assert(e.pc==r),U.assert(__this.loopLock===t),__this.loopLock=null,loop(e),flushLoopLock())}}function maybeYield(e,t,r){if(__this.pausedOnBreakpoint)return!1;__this.cleanScheduledExpired(),yieldReset();var n=Date.now();return 20<=n-lastYield&&(lastYield=n,e.pc=t,e.r0=r,setTimeout(loopForSchedule(e),yieldDelay),!0)}function setupDebugger(e,t){return(breakpoints=new Uint8Array(e))[0]=msg.breakOnStart?1:0,userGlobals=t,breakpoints}function isBreakFrame(t){if(!breakFrame)return!0;for(let e=breakFrame;e;e=e.parent)if(e==t)return!0;return!1}function breakpoint(t,r,e,n){let i={};__this.loopLock=i,U.assert(!dbgResume),U.assert(!dbgHeap),t.pc=r,t.r0=n;var{msg:n,heap:e}=pxsim.getBreakpointMsg(t,e,userGlobals);return dbgHeap=e,pxsim.injectEnvironmentGlobals(n,e),Runtime.postMessage(n),breakpoints[0]=0,breakFrame=null,__this.pauseScheduled(),dbgResume=e=>{if(dbgResume=null,dbgHeap=null,__this.dead)return null;switch(__this.resumeAllPausedScheduled(),__this.board.onDebuggerResume(),pxsim.runtime=__this,U.assert(t.pc==r),breakpoints[0]=0,breakFrame=null,e.subtype){case"resume":break;case"stepover":breakpoints[0]=1,breakFrame=t;break;case"stepinto":breakpoints[0]=1;break;case"stepout":breakpoints[0]=1,breakFrame=t.parent||t}U.assert(__this.loopLock==i),__this.loopLock=null,__this.otherFrames.push(t),loop(t),flushLoopLock()},null}function trace(e,t,r,n){setupResume(t,r),"<main>"===n.functionName||"main.ts"===n.fileName?(pxsim.runtime.traceDisabled||(r=pxsim.getBreakpointMsg(t,e,userGlobals).msg,r.subtype="trace",Runtime.postMessage(r)),pxsim.thread.pause(tracePauseMs||1)):pxsim.thread.pause(0),checkResumeConsumed()}function handleDebuggerMsg(t){switch(t.subtype){case"config":var r=t;if(r.setBreakpoints&&breakpoints){breakpoints.fill(0);for(var n of r.setBreakpoints)breakpoints[n]=1}break;case"traceConfig":r=t;tracePauseMs=r.interval;break;case"pause":breakpoints[0]=1,breakFrame=null;break;case"resume":case"stepover":case"stepinto":case"stepout":dbgResume&&dbgResume(t);break;case"variables":var i,r=t;let e=void 0;dbgHeap&&void 0!==(i=dbgHeap[r.variablesReference])&&(e=pxsim.dumpHeap(i,dbgHeap,r.fields,void 0,r.includeAll)),Runtime.postMessage({type:"debugger",subtype:"variables",req_seq:t.seq,variables:e})}}function removeFrame(t){var r=__this.otherFrames;for(let e=r.length-1;0<=e;--e)if(r[e]===t)return void r.splice(e,1);U.userError("frame cannot be removed!")}function loop(t){if(__this.dead)pxsim.log("Runtime terminated");else{U.assert(!__this.loopLock),__this.perfStartRuntime(),removeFrame(t);try{for(pxsim.runtime=__this;t;)__this.currFrame=t,__this.currFrame.overwrittenPC=!1,t=t.fn(t),__this.maybeUpdateDisplay(),__this.currFrame.overwrittenPC&&(t=__this.currFrame);__this.perfStopRuntime()}catch(e){var r,n;e instanceof BreakLoopException?U.nextTick(loopForSchedule(__this.currFrame)):(__this.perfStopRuntime(),__this.errorHandler?__this.errorHandler(e):(pxsim.error("Simulator crashed, no error handler",e.stack),{msg:r,heap:n}=pxsim.getBreakpointMsg(t,t.lastBrkId,userGlobals),pxsim.injectEnvironmentGlobals(r,n),r.exceptionMessage=e.message,r.exceptionStack=e.stack,Runtime.postMessage(r),__this.postError&&__this.postError(e)))}}}function checkStack(e){100<e&&U.userError("Stack overflow")}function actionCall(e){return e.depth=e.parent.depth+1,checkStack(e.depth),e.pc=0,e}function setupTop(e){e=setupTopCore(e);return setupResume(e,0),e}function setupTopCore(e){let t={parent:null,pc:0,depth:0,threadId:++threadId,fn:()=>(e&&e(t.retval),null)};return t}function topCall(e,t){U.assert(!!__this.board),U.assert(!__this.running),__this.setRunning(!0);t={parent:setupTopCore(t),fn:e,depth:0,pc:0};__this.otherFrames=[t],loop(actionCall(t))}function checkResumeConsumed(){currResume&&oops("getResume() not called")}function setupResume(e,t){currResume=buildResume(e,t)}function leaveAccessor(t,r){if(t.stage2Call){var n={pc:0,fn:null,depth:t.depth,parent:t.parent};let e=1;for(;t.hasOwnProperty("arg"+e);)n["arg"+(e-1)]=t["arg"+e],e++;return setupLambda(n,r),n}return t.parent.retval=r,t.parent}function setupLambda(e,t,r){if(r){var n=e;for(let e=1;e<r;++e)n["arg"+(e-1)]=n["arg"+e];delete n["arg"+(r-1)]}t instanceof pxsim.RefAction?(e.fn=t.func,e.caps=t.fields):"function"==typeof t?e.fn=t:oops("calling non-function")}function checkSubtype(e,t){return!!e&&(t===(e=e.vtable)||e&&t.classNo<=e.classNo&&e.classNo<=t.lastSubtypeNo)}function failedCast(e,t){pxsim.control&&pxsim.control.dmesgValue&&pxsim.control.dmesgValue(e),throwFailedCastError(e,null==t?void 0:t.name)}function buildResume(n,t){currResume&&oops("already has resume"),n.pc=t;let i=Date.now(),s=(__this.otherFrames.push(n),r=>{if(!__this.dead){if(!__this.loopLock){pxsim.runtime=__this;var e=Date.now();if(3<e-i&&(lastYield=e),U.assert(n.pc==t),r instanceof pxsim.FnWrapper){let e={parent:n,fn:r.func,lambdaArgs:r.args,pc:0,caps:r.caps,depth:n.depth+1},t={};return __this.loopLock=t,removeFrame(n),__this.otherFrames.push(e),U.nextTick(()=>{U.assert(__this.loopLock===t),__this.loopLock=null,loop(actionCall(e)),flushLoopLock()})}return n.retval=r,loop(n)}__this.loopLockWaitList.push(()=>s(r))}});return s}let entryPoint=msg.code&&eval(msg.code)(evalIface);this.run=e=>topCall(entryPoint,e),this.getResume=()=>{currResume||oops("noresume");var e=currResume;return currResume=null,e},this.setupTop=setupTop,this.handleDebuggerMsg=handleDebuggerMsg,this.entry=entryPoint,this.overwriteResume=e=>{currResume=null,0<=e&&(this.currFrame.pc=e),this.currFrame.overwrittenPC=!0},pxsim.runtime=this,pxsim.initCurrentRuntime(msg)}registerLiveObject(e){return this.refObjId++}runningTime(){return U.now()-this.startTime-this.pausedTime}runningTimeUs(){return 4294967295&U.perfNowUs()-this.startTimeUs>>0}runFiberAsync(r,n,i,s){return new Promise((e,t)=>U.nextTick(()=>{(pxsim.runtime=this).setupTop(e),pxtcore.runAction(r,[n,i,s])}))}currTryFrame(){for(let e=this.currFrame;e;e=e.parent)if(e.tryFrame)return e.tryFrame;return null}traceObjects(){let i={};for(;2<this.heapSnapshots.length;)this.heapSnapshots.shift();var e,t={count:0,size:0,name:"TOTAL"};let n={TOTAL:t};function s(e,t,n=null){if(t instanceof pxsim.RefObject)if(!t.gcIsStatic()){var r=i[t.id];if(r)n&&r.pointers.push([n,e]);else{let r={obj:t,path:null,pointers:[[n,e]]};i[t.id]=r,t.scan((e,t)=>{t instanceof pxsim.RefObject&&!i[t.id]&&s(e,t,r)})}}}this.heapSnapshots.push({visited:i,statsByType:n});for(e of Object.keys(this.globals))s(e.replace(/___\d+$/,""),this.globals[e]);var r,a=this.otherFrames.slice();this.currFrame&&a.indexOf(this.currFrame)<0&&a.unshift(this.currFrame);for(r of this.getThreads()){var o="Thread-"+this.rootFrame(r).threadId;for(let e=r;e;e=e.parent){var l,c,u=o+"."+functionName(e.fn);for(l of Object.keys(e))/^(r0|arg\d+|.*___\d+)/.test(l)&&(c=e[l])instanceof pxsim.RefObject&&s(u+"."+(l=l.replace(/___.*/,"")),c);if(e.caps)for(var d of e.caps)s(u+".cap",d)}}a=Object.keys(i).map(e=>i[e]);a.sort((e,t)=>t.obj.gcSize()-e.obj.gcSize());let p=t=>{if(null==t.path){let e="";t.path="(cycle)";for(var[r,n]of t.pointers){if(null==r)return void(t.path=n);p(r);r=r.path+"."+n;(!e||e.length>r.length)&&(e=r)}t.path=e}};a.forEach(p);var h,m,g=[t];for(h of a){var f=h.obj.gcSize(),_=h.obj.gcKey(),_=(n.hasOwnProperty(_)||g.push(n[_]={count:0,size:0,name:_}),n[_]);_.size+=f,_.count++,t.size+=f,t.count++}g.sort((e,t)=>e.size-t.size);let y="",b=e=>("        "+e.toString()).slice(-7);for(m of g)y+=b(4*m.size)+b(m.count)+" "+m.name+"\n";var v=e=>b(4*e.obj.gcSize())+" "+e.obj.gcKey()+" "+e.path,T=a.slice(0,20).map(v).join("\n");let k="";if(3<=this.heapSnapshots.length){let t=this.heapSnapshots[this.heapSnapshots.length-3].visited,r=this.heapSnapshots[this.heapSnapshots.length-2].visited;a=a.filter(e=>!t[e.obj.id]&&r[e.obj.id]).filter(e=>!((e=e.obj)instanceof pxsim.RefRecord&&!!(e.vtable&&e.vtable.maxBgInstances&&n[e.gcKey()].count<=e.vtable.maxBgInstances)));k=a.map(v).join("\n")}return"Threads:\n"+this.threadInfo()+"\n\nSummary:\n"+y+"\n\nLarge Objects:\n"+T+"\n\nNew Objects:\n"+k}getThreads(){var e=this.otherFrames.slice();return this.currFrame&&e.indexOf(this.currFrame)<0&&e.unshift(this.currFrame),e}rootFrame(e){let t=e;for(;t.parent;)t=t.parent;return t}threadInfo(){var e;let t="";for(e of this.getThreads()){t+=`Thread ${this.rootFrame(e).threadId}:
`;for(var r of pxsim.getBreakpointMsg(e,e.lastBrkId).msg.stackframes){r=r.funcInfo;t+=`   at ${r.functionName} (${r.fileName}:${r.line+1}:${r.column+1})
`}t+="\n"}return t}static postMessage(e){e&&("undefined"!=typeof window&&window.parent&&window.parent.postMessage&&window.parent.postMessage(e,"*"),Runtime.messagePosted)&&Runtime.messagePosted(e)}static async postScreenshotAsync(e){var t=pxsim.runtime&&pxsim.runtime.board;t&&(t=await t.screenshotAsync(),Runtime.postMessage({type:"screenshot",data:t,delay:e&&e.delay}))}static requestToggleRecording(){var e=pxsim.runtime;e&&Runtime.postMessage({type:"recorder",action:e.recording?"stop":"start"})}restart(){this.kill(),setTimeout(()=>pxsim.Runtime.postMessage({type:"simulator",command:"restart"}),500)}kill(){this.dead=!0,this.stopRecording(),this.stopIdle(),this.setRunning(!1)}updateDisplay(){this.board.updateView(),this.postFrame()}startRecording(e){!this.recording&&this.running&&(this.recording=!0,this.recordingTimer=setInterval(()=>this.postFrame(),66),this.recordingLastImageData=void 0,this.recordingWidth=e)}stopRecording(){this.recording&&(this.recordingTimer&&clearInterval(this.recordingTimer),this.recording=!1,this.recordingTimer=0,this.recordingLastImageData=void 0,this.recordingWidth=void 0)}postFrame(){if(this.recording&&this.running){let t=pxsim.U.now();this.board.screenshotAsync(this.recordingWidth).then(e=>{this.recordingLastImageData&&isImageDataEqual(this.recordingLastImageData,e)||(this.recordingLastImageData=e,Runtime.postMessage({type:"screenshot",data:e,time:t}))})}}queueDisplayUpdate(){this.numDisplayUpdates++}maybeUpdateDisplay(){this.numDisplayUpdates&&(this.numDisplayUpdates=0,this.updateDisplay())}setRunning(e){this.running!=e&&(this.running=e,this.running?(this.startTime=U.now(),this.startTimeUs=U.perfNowUs(),Runtime.postMessage({type:"status",frameid:pxsim.Embed.frameid,runtimeid:this.id,state:"running"})):(this.stopRecording(),this.stopIdle(),Runtime.postMessage({type:"status",frameid:pxsim.Embed.frameid,runtimeid:this.id,state:"killed"})),this.stateChanged)&&this.stateChanged()}dumpLivePointers(){}setupPerfCounters(e){e&&e.length&&(this.perfCounters=e.map(e=>new PerfCounter(e)))}perfStartRuntime(){0!==this.perfOffset?this.perfStack++:this.perfOffset=U.perfNowUs()-this.perfElapsed}perfStopRuntime(){this.perfStack?this.perfStack--:(this.perfElapsed=this.perfNow(),this.perfOffset=0)}perfNow(){return 0===this.perfOffset&&U.userError("bad time now"),U.perfNowUs()-this.perfOffset|0}startPerfCounter(e){this.perfCounters&&((e=this.perfCounters[e]).start&&U.userError("startPerf"),e.start=this.perfNow())}stopPerfCounter(t){if(this.perfCounters){var t=this.perfCounters[t],r=(t.start||U.userError("stopPerf"),this.perfNow()-t.start);t.start=0,t.value+=r,t.numstops++;let e=t.lastFewPtr++;e>=t.lastFew.length&&(e=0,t.lastFewPtr=1),t.lastFew[e]=r}}startIdle(){void 0===this.idleTimer&&(this.idleTimer=setInterval(()=>{var e;this.running&&!this.pausedOnBreakpoint&&(e=this.board.bus)&&e.queueIdle()},20))}stopIdle(){void 0!==this.idleTimer&&(clearInterval(this.idleTimer),this.idleTimer=void 0)}schedule(t,e){if(e<=0&&(e=0),this.pausedOnBreakpoint)return this.timeoutsPausedOnBreakpoint.push(new PausedTimeout(t,e)),-1;var r=U.now();let n=new TimeoutScheduled(-1,t,e,r);return n.id=setTimeout(()=>{var e=this.timeoutsScheduled.indexOf(n);0<=e&&this.timeoutsScheduled.splice(e,1),t()},e),this.timeoutsScheduled.push(n),n.id}pauseScheduled(){this.pausedOnBreakpoint=!0,this.timeoutsScheduled.forEach(e=>{clearTimeout(e.id);var t=U.now()-e.timestampCall;let r=e.totalRuntime-t;r<=0&&(r=1),this.timeoutsPausedOnBreakpoint.push(new PausedTimeout(e.fn,r))}),this.lastPauseTimestamp=U.now(),this.timeoutsScheduled=[]}resumeAllPausedScheduled(){this.pausedOnBreakpoint=!1,this.timeoutsPausedOnBreakpoint.forEach(e=>{this.schedule(e.fn,e.timeRemaining)}),this.lastPauseTimestamp&&(this.pausedTime+=U.now()-this.lastPauseTimestamp,this.lastPauseTimestamp=0),this.timeoutsPausedOnBreakpoint=[]}cleanScheduledExpired(){let t=U.now();this.timeoutsScheduled=this.timeoutsScheduled.filter(e=>t-e.timestampCall<e.totalRuntime)}registerUserInteraction(){this.lastInteractionTime=Date.now(),this.thumbnailRecordingIntervalRef||this.lastThumbnailTime&&this.lastInteractionTime-this.lastThumbnailTime<1e3||(this.thumbnailFrames=[],this.thumbnailRecordingIntervalRef=setInterval(async()=>{var e=await this.board.screenshotAsync();this.thumbnailFrames.length&&isImageDataEqual(e,this.thumbnailFrames[this.thumbnailFrames.length-1])||(this.thumbnailFrames.push(e),(1e4<Date.now()-this.lastInteractionTime||30<this.thumbnailFrames.length)&&(clearInterval(this.thumbnailRecordingIntervalRef),this.thumbnailRecordingIntervalRef=void 0,this.lastThumbnailTime=Date.now(),Runtime.postMessage({type:"thumbnail",frames:this.thumbnailFrames})))},66))}}function throwUserException(e){throw new Error(e)}function throwTypeError(e){throwUserException(pxsim.localization.lf("TypeError: {0}",e))}function throwFailedCastError(e,t){var r=getType(e);throwTypeError(t?null==e?pxsim.localization.lf("Expected type {0} but received type {1}. Did you forget to assign a variable?",t,r):pxsim.localization.lf("Expected type {0} but received type {1}",t,r):pxsim.localization.lf("Cannot read properties of {0}",r))}function throwFailedPropertyAccessError(e,t){e=getType(e);throwTypeError(t?pxsim.localization.lf("Cannot read properties of {0} (reading '{1}')",e,t):pxsim.localization.lf("Cannot read properties of {0}",e))}function throwNullUndefinedAsObjectError(){throwTypeError(pxsim.localization.lf("Cannot convert undefined or null to object"))}function getType(e){let t;var r=null==e?void 0:e.vtable;return t=r?r.name:null===e?"null":void 0===e?"undefined":e instanceof pxsim.RefCollection?"Array":e instanceof pxsim.RefBuffer?"Buffer":e instanceof pxsim.RefAction?"function":typeof e}function setParentMuteState(e){Runtime.postMessage({type:"setmutebuttonstate",state:e})}pxsim.Runtime=Runtime,pxsim.throwUserException=throwUserException,pxsim.throwTypeError=throwTypeError,pxsim.throwFailedCastError=throwFailedCastError,pxsim.throwFailedPropertyAccessError=throwFailedPropertyAccessError,pxsim.throwNullUndefinedAsObjectError=throwNullUndefinedAsObjectError,pxsim.setParentMuteState=setParentMuteState;class PerfCounter{constructor(e){this.name=e,this.start=0,this.numstops=0,this.value=0,this.lastFew=new Uint32Array(32),this.lastFewPtr=0}}function isImageDataEqual(t,r){if(t.data.byteLength===r.data.byteLength){var n=t.data.byteLength;let e=0;for(e=0;e<n&&t.data[e]==r.data[e];++e);return e===n}}pxsim.PerfCounter=PerfCounter}(pxsim=pxsim||{}),(u=>{let a;var e;(e=a=u.SimulatorState||(u.SimulatorState={}))[e.Unloaded=0]="Unloaded",e[e.Stopped=1]="Stopped",e[e.Pending=2]="Pending",e[e.Starting=3]="Starting",e[e.Running=4]="Running",e[e.Paused=5]="Paused",e[e.Suspended=6]="Suspended";let o,d=((e=o=u.SimulatorDebuggerCommand||(u.SimulatorDebuggerCommand={}))[e.StepInto=0]="StepInto",e[e.StepOver=1]="StepOver",e[e.StepOut=2]="StepOut",e[e.Resume=3]="Resume",e[e.Pause=4]="Pause","messagechannel"),p="aspectratio",i="pxtdriver";u.SimulatorDriver=class{constructor(e,t={}){this.container=e,this.options=t,this.themes=["blue","red","green","yellow"],this.runId="",this.nextFrameId=0,this.frameCounter=0,this.singleSimulator=!1,this.traceInterval=0,this.breakpointsSet=!1,this._runOptions={},this.state=a.Unloaded,this._allowedOrigins=[],this.newJacdacSimulator=!1,this.frameCleanupTimeout=void 0,this.debuggerSeq=1,this.debuggerResolvers={},this._allowedOrigins.push(window.location.origin),t.parentOrigin&&this._allowedOrigins.push(t.parentOrigin),this._allowedOrigins.push(this.getSimUrl().origin);let r=(null==t?void 0:t.messageSimulators)||{},n=(Object.keys(r).map(e=>r[e]).forEach(e=>{this._allowedOrigins.push(new URL(e.url).origin),e.localHostUrl&&this._allowedOrigins.push(new URL(e.localHostUrl).origin)}),u.U.isLocalHost()&&/[?&]simxdev(?:[=&#]|$)/i.test(window.location.href));Object.entries((null==t?void 0:t.simulatorExtensions)||{}).forEach(([e,t])=>{var r;t&&t.index&&t.aspectRatio&&void 0!==t.permanent&&(n&&t.devUrl?t.url=new URL(t.index,t.devUrl).toString():(e=[(r=this.getSimUrl()).pathname.replace(/---?.*/,""),"simx",e,"-",t.index].join("/"),t.url=new URL(e.replace(/^\/+/,""),r.origin).toString()),this._allowedOrigins.push(new URL(t.url).origin))}),this._allowedOrigins=u.U.unique(this._allowedOrigins,e=>e)}isDebug(){return this._runOptions&&!!this._runOptions.debug}isTracing(){return this._runOptions&&!!this._runOptions.trace}hasParts(){return this._runOptions&&this._runOptions.parts&&!!this._runOptions.parts.length}setDirty(){this.state==u.SimulatorState.Running&&this.suspend()}setPending(){this.setState(a.Pending)}focus(){var e=this.simFrames()[0];e&&e.focus()}registerDependentEditor(e){e&&(this._dependentEditors||(this._dependentEditors=[]),this._dependentEditors.push(e))}dependentEditors(){return this._dependentEditors&&(this._dependentEditors=this._dependentEditors.filter(e=>!!e.parent),this._dependentEditors.length||(this._dependentEditors=void 0)),this._dependentEditors}setStarting(){this.setState(a.Starting)}setHwDebugger(e){e?(this.hwdbg=e,this.setState(a.Running),this.container.style.opacity="0.3"):(delete this.container.style.opacity,this.hwdbg=null,this.setState(a.Running),this.stop())}handleHwDebuggerMsg(e){this.hwdbg&&this.handleMessage(e)}setThemes(e){u.U.assert(e&&0<e.length),this.themes=e}startRecording(e){this.simFrames()[0]&&this.postMessage({type:"recorder",action:"start",source:i,width:e})}stopRecording(){this.postMessage({type:"recorder",source:i,action:"stop"})}setFrameState(e){var t=e.nextElementSibling,r=t.nextElementSibling;switch(this.state){case a.Pending:case a.Starting:t.style.display="",t.className="",r.style.display="";break;case a.Stopped:case a.Suspended:u.U.addClass(e,this.state==a.Stopped||this._runOptions&&this._runOptions.autoRun?this.stoppedClass:this.invalidatedClass),this._runOptions&&this._runOptions.autoRun?t.style.display="none":(t.style.display="",t.className="videoplay xicon icon"),r.style.display="none",this.scheduleFrameCleanup();break;default:u.U.removeClass(e,this.stoppedClass),u.U.removeClass(e,this.invalidatedClass),t.style.display="none",r.style.display="none"}}setState(e){this.state!=e&&(this.state=e,this.freeze(this.state==a.Paused),this.simFrames().forEach(e=>this.setFrameState(e)),this.options.onStateChanged)&&this.options.onStateChanged(this.state)}freeze(e){let r="pause-overlay";e?u.util.toArray(this.container.querySelectorAll("div.simframe")).forEach(e=>{var t;e.querySelector("div."+r)||((t=document.createElement("div")).className=r,t.onclick=e=>(e.preventDefault(),!1),e.appendChild(t))}):u.util.toArray(this.container.querySelectorAll("div.simframe div."+r)).forEach(e=>e.parentElement.removeChild(e))}simFrames(e=!1){var t=u.util.toArray(this.container.getElementsByTagName("iframe")),r=this.loanedIFrame();return r&&!e&&t.unshift(r),t}getSimUrl(){var t=this.options.simUrl||(null==(t=window.pxtConfig)?void 0:t.simUrl)||(null==(t=pxt.webConfig)?void 0:t.simUrl)||location.origin+"/sim/simulator.html";try{return new URL(t)}catch(e){return new URL(t,location.origin)}}setSingleSimulator(){this.singleSimulator=!0}postMessage(r,n,i){if(this.hwdbg)this.hwdbg.postMessage(r);else{var e=this.dependentEditors();let s=this.simFrames(),t=(i&&(s=s.filter(e=>e.id===i)),!1);var a=r;if(n&&null!=a&&a.broadcast){a.srcFrameIndex=this.simFrames().findIndex(e=>e.contentWindow===n);var o=!(null==(o=this._currentRuntime)||!o.single),l=window.parent&&window.parent!==window.window?window.parent:window.opener;if(l&&n!==l&&l.postMessage(r,"*"),!(this.options.nestedEditorSim||null!=a&&a.toParentIFrameOnly))if(e)e.forEach(e=>{n!==e&&e.postMessage(r,window.location.origin)});else if(!o){let i="messagepacket"===r.type&&r.channel;var l=i&&this.options.messageSimulators&&this.options.messageSimulators[i],a=i&&this.options.simulatorExtensions&&this.options.simulatorExtensions[i],e=(e,t,r)=>{r=r||(null==(n=this._runOptions)?void 0:n.aspectRatio)||1.22;var n=this.createFrame(e),e=(this.container.appendChild(n),n.firstElementChild);e.dataset[d]=i,e.dataset[p]=r+"",u.U.addClass(n,"simmsg"),u.U.addClass(n,"simmsg"+u.U.sanitizeCssName(i)),t&&(e.dataset.permanent="true"),this.startFrame(e),s=this.simFrames()};a?(o=s.find(e=>e.dataset[d]===i),"jacdac/pxt-jacdac"===i&&(this.newJacdacSimulator=!0),o?o.dataset.runid!=this.runId&&this.startFrame(o):(o=new URL(a.url),this.options.parentOrigin&&o.searchParams.set("parentOrigin",encodeURIComponent(this.options.parentOrigin)),this.options.userLanguage&&o.searchParams.set("language",encodeURIComponent(this.options.userLanguage)),e(o.toString(),a.permanent,a.aspectRatio))):l?(o=s.find(e=>e.dataset[d]===i))?o.dataset.runid!=this.runId&&this.startFrame(o):"jacdac"===i&&this.newJacdacSimulator||e((u.U.isLocalHost()&&/localhostmessagesims=1/i.test(window.location.href)&&l.localHostUrl||l.url).replace("$PARENT_ORIGIN$",encodeURIComponent(this.options.parentOrigin||"")).replace("$LANGUAGE$",encodeURIComponent(this.options.userLanguage)),l.permanent,l.aspectRatio):(t=!0,a=s.filter(e=>!e.dataset[d]),i||0!=a.length&&(1!=a.length||this.singleSimulator)?2==a.length&&a[1].dataset.runid!=this.runId&&this.startFrame(a[1]):(this.container.appendChild(this.createFrame()),s=this.simFrames()))}}for(let e=0;e<s.length;++e){var c=s[e];if((!n||c.contentWindow!=n)&&(c.contentWindow&&(t?this.postDeferrableMessage(c,r):this.postMessageCore(c,r),"recorder"==r.type)&&"start"==r.action))break}}}postDeferrableMessage(e,t){!e.dataset.loading?this.postMessageCore(e,t):(this.deferredMessages||(this.deferredMessages=[]),this.deferredMessages.push([e,t]))}postMessageCore(e,t){var r=u.U.isLocalHostDev()?"*":e.dataset.origin;e.contentWindow.postMessage(t,r)}setRunOptionQueryParams(e){var t,r=new URL(e);if(null!=(e=this._runOptions)&&e.hideSimButtons&&r.searchParams.set("hideSimButtons","1"),null!=(e=this._runOptions)&&e.queryParameters)for(t of this._runOptions.queryParameters.split("&")){var[n,i]=t.split(/[:=]/);n&&i&&r.searchParams.set(n,i)}return r.toString()}createFrame(e){var t=document.createElement("div");t.className="simframe ui embed";let r=document.createElement("iframe");r.id="sim-frame-"+this.nextId(),r.title=u.localization.lf("Simulator"),r.allowFullscreen=!0,r.setAttribute("allow","autoplay;microphone"),r.setAttribute("sandbox","allow-same-origin allow-scripts"),r.className="no-select";var e=this.setRunOptionQueryParams(e||this.getSimUrl().toString()),e=(e+="#"+r.id,r.src=e,r.frameBorder="0",r.dataset.runid=this.runId,r.dataset.origin=new URL(e).origin||"*",r.dataset.loading="true",null!=(e=this._runOptions)&&e.autofocus&&r.setAttribute("autofocus","true"),t.appendChild(r),document.createElement("i")),n=(e.className="videoplay xicon icon",e.style.display="none",e.onclick=e=>(e.preventDefault(),this.state!=a.Running&&this.state!=a.Starting&&(this.options.restart?this.options.restart():this.start()),r.focus(),!1),t.appendChild(e),document.createElement("div"));return n.className="ui active loader",e.style.display="none",t.appendChild(n),this._runOptions&&this.applyAspectRatioToFrame(r),t}preload(e,t){this.addEventListeners(),t&&(this._currentRuntime=void 0,this.container.textContent=""),this.simFrames().length||(this.container.appendChild(this.createFrame()),this.applyAspectRatio(e),this.setStarting())}stop(e=!1,t=!1){this.state!==a.Stopped&&this.state!==a.Unloaded&&(this.clearDebugger(),this.stopSound(),this.postMessage({type:"stop",source:i}),this.setState(t?a.Starting:a.Stopped)),e&&this.unload()}suspend(){this.stopSound(),this.postMessage({type:"stop",source:i}),this.setState(a.Suspended)}unload(){this.cancelFrameCleanup(),u.U.removeChildren(this.container),this.setState(a.Unloaded),this._runOptions=void 0,this._currentRuntime=void 0,this.runId=void 0,this.deferredMessages=void 0}mute(e){this._currentRuntime&&(this._currentRuntime.mute=e),this.postMessage({type:"mute",source:i,mute:e})}stopSound(){this.postMessage({type:"stopsound",source:i})}isLoanedSimulator(e){return!!this.loanedSimulator&&this.loanedIFrame()==e}loanSimulator(){return this.loanedSimulator||(this.loanedSimulator=this.container.firstElementChild||this.createFrame(),this.loanedSimulator.parentNode&&this.container.removeChild(this.loanedSimulator)),this.loanedSimulator}unloanSimulator(){this.loanedSimulator&&(this.loanedSimulator.parentNode&&this.loanedSimulator.parentNode.removeChild(this.loanedSimulator),this.container.insertBefore(this.loanedSimulator,this.container.firstElementChild),delete this.loanedSimulator)}loanedIFrame(){return this.loanedSimulator&&this.loanedSimulator.parentNode&&this.loanedSimulator.querySelector("iframe")}cancelFrameCleanup(){this.frameCleanupTimeout&&(clearTimeout(this.frameCleanupTimeout),this.frameCleanupTimeout=void 0)}scheduleFrameCleanup(){this.cancelFrameCleanup(),this.frameCleanupTimeout=setTimeout(()=>{this.frameCleanupTimeout=void 0,this.cleanupFrames()},5e3)}applyAspectRatio(t){(t||this._runOptions)&&this.simFrames().forEach(e=>this.applyAspectRatioToFrame(e,t))}applyAspectRatioToFrame(e,t){let r,n,i,s,a=t;void 0===a&&(t=parseFloat(e.dataset[p]),isNaN(t)||(a=t)),void 0===(a=void 0===a&&(t=e.dataset[d])&&(t=null==(i=null==(n=null==(r=this.options)?void 0:r.messageSimulators)?void 0:n[t])?void 0:i.aspectRatio)?t:a)&&(a=(null==(s=this._runOptions)?void 0:s.aspectRatio)||1.22),e.parentElement.style.paddingBottom=100/a+"%"}cleanupFrames(){var e=this.simFrames(!0);e.shift(),e.filter(e=>!e.dataset.permanent).forEach(e=>{this.state!=a.Stopped&&e.dataset.runid==this.runId||(this.options.removeElement?this.options.removeElement(e.parentElement):e.parentElement.remove())})}hide(t){var e;this.suspend(),this.options.removeElement&&((e=this.simFrames()).forEach(e=>{this.options.removeElement(e.parentElement,t)}),0==e.length)&&t&&t()}unhide(){this.options.unhideElement&&this.simFrames().forEach(e=>{this.options.unhideElement(e.parentElement)})}setRunOptions(e={}){this._runOptions=e}run(e,t={}){this.setRunOptions(t),this.runId=this.nextId(),this._currentRuntime={type:"run",source:i,boardDefinition:t.boardDefinition,parts:t.parts,builtinParts:t.builtinParts,fnArgs:t.fnArgs,code:e,partDefinitions:t.partDefinitions,mute:t.mute,highContrast:t.highContrast,light:t.light,cdnUrl:t.cdnUrl,localizedStrings:t.localizedStrings,refCountingDebug:t.refCountingDebug,version:t.version,clickTrigger:t.clickTrigger,breakOnStart:t.breakOnStart,storedState:t.storedState,ipc:t.ipc,single:t.single,dependencies:t.dependencies,activePlayer:t.activePlayer,theme:t.theme},this.stopSound(),this.start()}restart(){this.stop(),this.cleanupFrames(),this.start()}areBreakpointsSet(){return this.breakpointsSet}start(){if(this.clearDebugger(),this.addEventListeners(),this.applyAspectRatio(),this.scheduleFrameCleanup(),this._currentRuntime){this.singleSimulator=!1,this.breakpointsSet=!1;let e=this.simFrames()[0];var t;e||(t=this.createFrame(),this.container.appendChild(t),e=t.firstElementChild),this.startFrame(e),this.debuggingFrame=e.id,this.setState(a.Running),this.setTraceInterval(this.traceInterval)}}startFrame(e){var t,r;return!(!this._currentRuntime||!e.contentWindow||((t=JSON.parse(JSON.stringify(this._currentRuntime))).frameCounter=++this.frameCounter,r=(null==(r=this._runOptions)?void 0:r.mpRole)||(null==(r=null==(r=/[\&\?]mp=(server|client)/i.exec(window.location.href))?void 0:r[1])?void 0:r.toLowerCase()),t.options={theme:this.themes[this.nextFrameId++%this.themes.length],mpRole:r},t.id=t.options.theme+"-"+this.nextId(),e.dataset.runid=this.runId,e.dataset.runtimeid=t.id,e.id!==this.debuggingFrame&&(t.traceDisabled=!0,t.breakOnStart=!1),this.postMessageCore(e,t),this.traceInterval&&this.setTraceInterval(this.traceInterval),this.applyAspectRatioToFrame(e),this.setFrameState(e),0))}handleDeferredMessages(t){var e;t.dataset.loading&&(delete t.dataset.loading,null!=(e=null==(e=this.deferredMessages)?void 0:e.filter(e=>e[0]===t))&&e.forEach(e=>{var[,e]=e;this.postMessageCore(t,e)}),this.deferredMessages=null==(e=this.deferredMessages)?void 0:e.filter(e=>e[0]!==t))}handleMessage(e,t){switch(e.type||""){case"ready":var r=e.frameid,r=document.getElementById(r);r&&(null!=(n=this._runOptions)&&n.autofocus&&r.focus(),this.startFrame(r),this.options.revealElement&&this.options.revealElement(r),this.handleDeferredMessages(r)),this.options.onSimulatorReady&&this.options.onSimulatorReady();break;case"status":var n=e.frameid,i=document.getElementById(n);if(i)if(e.runtimeid==i.dataset.runtimeid)switch(e.state){case"running":this.setState(a.Running),this.handleDeferredMessages(i);break;case"killed":this.setState(a.Stopped)}break;case"simulator":this.handleSimulatorCommand(e);break;case"serial":case"pxteditor":case"screenshot":case"custom":case"recorder":case"addextensions":break;case"aspectratio":var r=e,n=r.frameid,n=document.getElementById(n);n&&(n.dataset[p]=r.value+"",this.applyAspectRatioToFrame(n));break;case"debugger":this.handleDebuggerMessage(e);break;case"toplevelcodefinished":this.options.onTopLevelCodeEnd&&this.options.onTopLevelCodeEnd();break;case"setmutebuttonstate":null!=(n=(r=this.options).onMuteButtonStateChange)&&n.call(r,e.state);break;default:this.postMessage(e,t)}}addEventListeners(){this.listener||(this.listener=e=>{this.hwdbg||!u.U.isLocalHost()&&this._allowedOrigins.indexOf(e.origin)<0||this.handleMessage(e.data,e.source)},window.addEventListener("message",this.listener,!1))}removeEventListeners(){this.listener&&(window.removeEventListener("message",this.listener,!1),this.listener=void 0)}resume(e){let t;switch(e){case o.Resume:t="resume",this.setState(a.Running);break;case o.StepInto:t="stepinto",this.setState(a.Running);break;case o.StepOut:t="stepout",this.setState(a.Running);break;case o.StepOver:t="stepover",this.setState(a.Running);break;case o.Pause:t="pause";break;default:return void u.debug("unknown command")}this.postMessage({type:"debugger",subtype:t,source:i})}setBreakpoints(e){this.breakpointsSet=!0,this.postDebuggerMessage("config",{setBreakpoints:e},void 0,this.debuggingFrame)}setTraceInterval(e){this.traceInterval=e,this.postDebuggerMessage("traceConfig",{interval:e})}variablesAsync(e,t,r=!1){return this.postDebuggerMessageAsync("variables",{variablesReference:e,fields:t,includeAll:r},this.debuggingFrame).then(e=>e,e=>{})}handleSimulatorCommand(e){this.options.onSimulatorCommand&&this.options.onSimulatorCommand(e)}clearDebugger(){let t=new Error("Debugging cancelled");Object.keys(this.debuggerResolvers).forEach(e=>{e=this.debuggerResolvers[e].reject;e(t)}),this.debuggerResolvers={},this.debuggerSeq++}handleDebuggerMessage(e){var t;switch("trace"!==e.subtype&&u.log("DBG-MSG",e.subtype,e),e.seq&&(t=this.debuggerResolvers[e.seq].resolve,t)&&t(e),e.subtype){case"warning":this.options.onDebuggerWarning&&this.options.onDebuggerWarning(e);break;case"breakpoint":var r,n=e;if(this.state==a.Running){n.exceptionMessage?this.suspend():(this.setState(a.Paused),1<this.simFrames(!0).length&&this.resume(o.Pause)),this.options.onDebuggerBreakpoint&&this.options.onDebuggerBreakpoint(n);let e=n.exceptionMessage+"\n";for(r of n.stackframes){var i=r.funcInfo;e+=`   at ${i.functionName} (${i.fileName}:${i.line+1}:${i.column+1})
`}n.exceptionMessage&&u.error(e)}else u.error("debugger: trying to pause from "+this.state);break;case"trace":n=e;this.state==a.Running&&this.options.onTraceMessage&&this.options.onTraceMessage(n);break;default:var s,n=e.req_seq;n&&(s=this.debuggerResolvers[n].resolve,s)&&(delete this.debuggerResolvers[n],s(e))}}postDebuggerMessageAsync(n,i={},s){return new Promise((e,t)=>{var r=this.debuggerSeq++;this.debuggerResolvers[r.toString()]={resolve:e,reject:t},this.postDebuggerMessage(n,i,r,s)})}postDebuggerMessage(e,t={},r,n){t=JSON.parse(JSON.stringify(t));t.type="debugger",t.subtype=e,t.source=i,r&&(t.seq=r),this.postMessage(t,void 0,n)}nextId(){return this.nextFrameId+++(Math.random()+""+Math.random()).replace(/[^\d]/,"")}get stoppedClass(){return this.options&&this.options.stoppedClass||"grayscale"}get invalidatedClass(){return this.options&&this.options.invalidatedClass||"sepia"}}})(pxsim=pxsim||{}),(S=>{S.mkRange=function(e,t){for(var r=[];e<t;e++)r.push(e);return r},S.EventBus=class{constructor(e,t,r){this.runtime=e,this.board=t,this.valueToArgs=r,this.queues={},this.backgroundHandlerFlag=!1,this.nextNotifyEvent=1024,this.schedulerID=15,this.idleEventID=2,this.board.addMessageListener(this.handleMessage.bind(this))}handleMessage(e){"eventbus"===e.type&&this.queue(e.id,e.eventid,e.value)}setBackgroundHandlerFlag(){this.backgroundHandlerFlag=!0}setNotify(e,t){this.notifyID=e,this.notifyOneID=t}setIdle(e,t){this.schedulerID=e,this.idleEventID=t}start(e,t,r,n=!1){r=(r?"back":"fore")+":"+e+":"+t;return!this.queues[r]&&n&&(this.queues[r]=new S.EventQueue(this.runtime,this.valueToArgs)),this.queues[r]}listen(e,t,r,n=0){e==this.schedulerID&&t==this.idleEventID&&this.runtime.startIdle();e=this.start(e,t,this.backgroundHandlerFlag,!0);this.backgroundHandlerFlag?e.addHandler(r,n):e.setHandler(r,n),this.backgroundHandlerFlag=!1}removeBackgroundHandler(t){Object.keys(this.queues).forEach(e=>{e.startsWith("back:")&&this.queues[e].removeHandler(t)})}getQueues(e,t,r){var n=[this.start(0,0,r)];return 0==e&&0==t||(t&&n.push(this.start(0,t,r)),e&&n.push(this.start(e,0,r)),e&&t&&n.push(this.start(e,t,r))),n}queue(e,r,n=null){if(!S.runtime.pausedOnBreakpoint){let t=this.notifyID&&this.notifyOneID&&e==this.notifyOneID;t&&(e=this.notifyID);e=this.getQueues(e,r,!0).concat(this.getQueues(e,r,!1));this.lastEventValue=r,this.lastEventTimestampUs=S.U.perfNowUs(),S.U.promiseMapAllSeries(e,e=>e?e.push(n,t):Promise.resolve())}}queueIdle(){this.schedulerID&&this.idleEventID&&this.queue(this.schedulerID,this.idleEventID)}wait(e,t,r){this.start(e,t,!1,!0).addAwaiter(r)}getLastEventValue(){return this.lastEventValue}getLastEventTime(){return 4294967295&this.lastEventTimestampUs-S.runtime.startTimeUs}},S.AnimationQueue=class{constructor(r){this.runtime=r,this.queue=[],this.process=()=>{var e,t=this.queue[0];t&&!this.runtime.dead&&(r=this.runtime,e=t.frame(),r.queueDisplayUpdate(),r.maybeUpdateDisplay(),!1===e?(this.queue.shift(),this.queue[0]&&(this.queue[0].setTimeoutHandle=setTimeout(this.process,this.queue[0].interval)),t.whenDone(!1)):t.setTimeoutHandle=setTimeout(this.process,t.interval))}}cancelAll(){var e,t=this.queue;this.queue=[];for(e of t)e.whenDone(!0),e.setTimeoutHandle&&clearTimeout(e.setTimeoutHandle)}cancelCurrent(){var e=this.queue[0];e&&(this.queue.shift(),e.whenDone(!0),e.setTimeoutHandle)&&clearTimeout(e.setTimeoutHandle)}enqueue(e){e.whenDone||(e.whenDone=()=>{}),this.queue.push(e),1==this.queue.length&&this.process()}executeAsync(r){return S.U.assert(!r.whenDone),new Promise((e,t)=>{r.whenDone=e,this.enqueue(r)})}};{var e=S.AudioContextManager||(S.AudioContextManager={});let n=0,t,i,s,a=!1,o,r=[],l=[],c;function C(){return t||(t=(()=>{if(window.AudioContext=window.AudioContext||window.webkitAudioContext,window.AudioContext)try{return new window.AudioContext}catch(e){}})())&&((c=t.createGain()).connect(t.destination),c.gain.setValueAtTime(1,0)),t}function f(){v(0),n=0,o&&o.pause()}function _(e,t){e.gain.value&&e.gain.setTargetAtTime(0,C().currentTime,.015),setTimeout(()=>{e.disconnect(),t&&t.disconnect()},450)}e.isAudioElementActive=function(){return!!s},e.mute=function(e){a=e;var t=C();e?c.gain.setTargetAtTime(0,t.currentTime,.015):c.gain.setTargetAtTime(1,t.currentTime,.015),!e&&t&&"suspended"===t.state&&t.resume()},e.isMuted=function(){return a},e.stopAll=function(){f(),y();for(var e of l)e()},e.stop=function(){if(f(),s){try{_(s,i)}catch(e){}s=void 0,i=void 0}},e.onStopAll=function(e){l.push(e)},e.frequency=function(){return n};let u=[null,"triangle","sawtooth","sine"],d,p,h=[],m=[];function w(e,t){var r=u[e];if(r)return(i=C().createOscillator()).type=r,i.frequency.value=t,i;let n;if(4==e)n=(()=>{if(!p){var r=(p=C().createBuffer(1,131072,C().sampleRate)).getChannelData(0);let t=251771520;for(let e=0;e<131072;e+=4)32768&(t=(t=(t^=t<<13)^t>>17)^t<<5)?(r[e]=1,r[e+1]=1,r[e+2]=-1,r[e+3]=-1):(r[e]=0,r[e+1]=0,r[e+2]=0,r[e+3]=0)}return p})();else if(5==e)n=(()=>{if(!d){var r=(d=C().createBuffer(1,1e5,C().sampleRate)).getChannelData(0);let t=251771520;for(let e=0;e<1e5;e++)t=(t=(t^=t<<13)^t>>17)^t<<5,r[e]=(1023&t)/512-1}return d})();else if(11<=e&&e<=15)n=(t=>{if(!m[t]){var e=C().createBuffer(1,1024,C().sampleRate),r=e.getChannelData(0);for(let e=0;e<1024;e++)r[e]=e<t/100*1024?1:-1;m[t]=e}return m[t]})(10*(e-10));else{if(!(16<=e&&e<=18))return null;n=(t=>{if(!h[t]){var e=C().createBuffer(1,1024,C().sampleRate),r=e.getChannelData(0),n=[770763591,3356908179],i=[15,31,63];for(let e=0;e<1024;e+=4){var s=e/4;0!=(n[(s&=i[t-4])>>5]&1<<(31&s))?(r[e]=1,r[e+1]=1,r[e+2]=-1,r[e+3]=-1):(r[e]=0,r[e+1]=0,r[e+2]=0,r[e+3]=0)}h[t]=e}return h[t]})(e-16+4)}var r=C().createBufferSource(),i=(r.buffer=n,r.loop=!0,4==e||16<=e&&e<=18);return i?r.playbackRate.value=t/(C().sampleRate/4):5!=e&&(r.playbackRate.value=t/(C().sampleRate/1024)),r}class k{constructor(){this.gain=C().createGain(),this.gain.connect(c),this.gain.gain.value=0}disconnectNodes(){this.gain?_(this.gain,this.generator):this.generator&&(this.generator.stop&&this.generator.stop(),this.generator.disconnect()),this.gain=null,this.generator=null}remove(){var e=r.indexOf(this);0<=e&&r.splice(e,1),this.disconnectNodes()}}let g=1;function y(){for(null!=e.soundEventCallback&&e.soundEventCallback("muteallchannels"),g++;r.length;)r[0].remove()}function b(e,t){if(!(e<0)){n=e;var r=C();if(r){t=Math.max(0,Math.min(1,t));try{i||(i=r.createOscillator(),(s=r.createGain()).gain.value=0,i.type="triangle",i.connect(s),s.connect(c),i.start(0)),v(t)}catch(e){return i=void 0,void(s=void 0)}i.frequency.value=e,v(t)}}}function v(e){null!=s&&s.gain&&s.gain.setTargetAtTime(e,t.currentTime,.015)}function T(k,x,E){return new Promise(async t=>{null!=e.soundEventCallback&&e.soundEventCallback("playinstructions",k);let r=!1,n=C(),i=A(),s=(i.gain.gain.value=1,{}),a={},o=n.currentTime,l=o,c=0,u=0;var d=(e,t)=>e/1024/4*(t?.5:1);let p=()=>{if(!r){r=!0,i.disconnectNodes();for(var e of Object.keys(s))s[e].stop(),s[e].disconnect(),a[e].disconnect();t()}};for(let e=0;e<k.length;e+=12){var h,m,g,f=k[e],_=I(k,e+2),y=I(k,e+4)/1e3,b=I(k,e+6),v=I(k,e+8),T=I(k,e+10);u+=y,0===f?l+=y:(h=11<=f&&f<=15,m=(s[f]||(s[f]=w(f,_),a[f]=n.createGain(),a[f].gain.value=0,a[f].connect(i.gain),s[f].connect(a[f]),s[f].start()),c&&f!==c&&a[c].gain.setTargetAtTime(0,l,.015),s[f]),g=a[f],m instanceof OscillatorNode?(m.frequency.setValueAtTime(_,l),m.frequency.linearRampToValueAtTime(T,l+y)):4==f||16<=f&&f<=18?m.playbackRate.linearRampToValueAtTime(T/(n.sampleRate/4),l+y):5!=f&&m.playbackRate.linearRampToValueAtTime(T/(n.sampleRate/1024),l+y),g.gain.setValueAtTime(d(b,h),l),g.gain.linearRampToValueAtTime(d(v,h),l+y),c=f,l+=y)}if(i.gain.gain.setTargetAtTime(0,l,.015),x||E){let r=()=>{var e,t=n.currentTime;t>o+u||(x&&x()?p():({frequency:t,volume:e}=((t,r)=>{let n=0;for(let e=0;e<r.length;e+=12){var i,s=I(r,e+2),a=I(r,e+4),o=I(r,e+6),l=I(r,e+8),c=I(r,e+10);if(!(n+a<t))return i=(t-n)/a,{frequency:s+(c-s)*i,volume:o+(l-o)*i};n+=a}return{frequency:-1,volume:-1}})(1e3*(t-o),k),E&&E(t,e/1024),requestAnimationFrame(r)))};requestAnimationFrame(r)}await S.U.delay(1e3*u),p()})}function I(e,t){var r=new Uint8Array(2);return r[0]=e[t],r[1]=e[t+1],new Uint16Array(r.buffer)[0]}function A(){20<r.length&&r[0].remove();var e=new k;return r.push(e),e}e.muteAllChannels=y,e.queuePlayInstructions=function(e,t){let r=g;S.U.delay(e).then(()=>r!=g?Promise.resolve():T(t.data))},e.tone=b,e.setCurrentToneGain=v,e.playBufferAsync=function(n){return n?new Promise(e=>{function t(){e&&e(),e=void 0}var r="data:audio/wav;base64,"+window.btoa((t=>{var r=t.length;let n="";for(let e=0;e<r;++e)n+=String.fromCharCode(t[e]);return n})(n.data));o=new Audio(r),a&&(o.volume=0),o.onended=()=>t(),o.onpause=()=>t(),o.onerror=()=>t(),o.play()}):Promise.resolve()},e.playPCMBufferStreamAsync=function(p,h,e=.3,t){return new Promise(s=>{let a=[],o=C().currentTime,l=!1,c=A(),u=(c.gain.gain.setValueAtTime(e,C().currentTime),()=>!!(t&&t()||!c.gain)&&(s&&s(),s=void 0,c.remove(),!0));function d(){for(;!l&&a.length<3&&!u();){var e=p();if(!e||!e.length){l=!0;break}n=i=r=t=void 0;var t=e;if(!u()){var r=C().createBuffer(1,t.length,h);if(r.copyToChannel)r.copyToChannel(t,0);else{var n=r.getChannelData(0);for(let e=0;e<t.length;e++)n[e]=t[e]}var i=C().createBufferSource();a.push(i),i.connect(c.gain),i.buffer=r,i.addEventListener("ended",()=>{a.shift().disconnect(),d()}),i.start(o),o+=r.duration}}l&&0===a.length&&(c.remove(),s&&s(),s=void 0)}d()})},e.playInstructionsAsync=T,e.sendMidiMessage=function(e){var t,r,n;(e=e.data).length&&(t=e[0]>>4,r=15&e[0],n=440*Math.pow(2,((e[1]||0)-69)/12),8==t||9==t&&0==(e[2]||0)?f():9==t&&(b(n,1),9==r)&&setTimeout(()=>f(),500))},e.startSamplePlayback=function(a,o,l,c,u){let d,p;return{promise:new Promise(e=>{p=e;let t=1;c<3e3?(t=c/3e3,c=3e3):768e3<c&&(t=c/768e3,c=768e3);var r=S.BufferMethods.fmtInfo(o).size,n=C().createBuffer(1,a.data.length/r,c),i=n.getChannelData(0);for(let e=0;e<n.length;e++)i[e]=S.BufferMethods.getNumber(a,o,e*r)/l*2-1;d=A();var s=C().createBufferSource();s.playbackRate.value=t,d.gain.gain.value=u,d.generator=s,d.generator.buffer=n,d.generator.connect(d.gain),d.generator.start(0),d.generator.addEventListener("ended",()=>{d.remove(),d=void 0,e()})}),cancel:()=>{d&&(d.remove(),d=void 0,p())}}},e.createAudioSourceNode=function(e,t,r){var e=new Audio(e),n=C().createMediaElementSource(e),i=C().createWaveShaper();return i.curve=(e=>{var t=new Float32Array(44100),r=1/(e=Math.max(.01,Math.min(1,e)));for(let e=0;e<44100;e++){var n=(2*e/44100-1)*r;t[e]=Math.max(-1,Math.min(1,n))}return t})(t),i.oversample="4x",(t=A()).generator=i,t.generator.connect(t.gain),n.connect(i),t.gain.gain.value=.1*r,e}}function t(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator&&0<navigator.maxTouchPoints)}function r(){return"undefined"!=typeof window&&!!window.PointerEvent}S.isTouchEnabled=t,S.hasPointerEvents=r,S.pointerEvents=r()?{up:"pointerup",down:["pointerdown"],move:"pointermove",enter:"pointerenter",leave:"pointerleave"}:t()?{up:"mouseup",down:["mousedown","touchstart"],move:"touchmove",enter:"touchenter",leave:"touchend"}:{up:"mouseup",down:["mousedown"],move:"mousemove",enter:"mouseenter",leave:"mouseleave"}})(pxsim=pxsim||{}),(v=>{var t;function i(t,r){return e=>e*(r/t)}function r(e,t){var r=e[0]-t[0],e=e[1]-t[1];return r*r+e*e}(t=v.visuals||(v.visuals={})).translateEl=function(e,t){v.svg.hydrate(e,{transform:`translate(${t[0]} ${t[1]})`})},t.composeSVG=function(e){var[t,r]=[e.el1,e.el2],n=(v.U.assert(0==t.x&&0==t.y&&0==r.x&&0==r.y,"el1 and el2 x,y offsets not supported"),(e,t,r)=>v.svg.hydrate(e,{x:t,y:r})),i=(e,t,r)=>v.svg.hydrate(e,{width:t+"px",height:r+"px"}),s=e.scaleUnit2;let a=e.scaleUnit2/e.scaleUnit1;var o=t.w*a,l=t.h*a,c=(i(t.el,o,l),+r.w),u=+r.h,[i,d,p,h]=(i(r.el,c,u),e.margin),m=e.middleMargin,g=Math.max(o,c);let f=d+(g-o)/2,_=i,y=(n(t.el,f,_),d+(g-c)/2),b=_+l+m;return n(r.el,y,b),o=[_,_+l,b,b+u],c=v.svg.elt("svg",{version:"1.0",viewBox:`0 0 ${d+g+h} `+(i+l+m+u+p),class:"sim-bb"}),d=c,g=e.maxWidth,h=e.maxHeight,g&&v.svg.hydrate(d,{width:g}),h&&v.svg.hydrate(d,{height:h}),n(c,0,0),i=v.svg.child(c,"g"),c.appendChild(t.el),c.appendChild(r.el),l=v.svg.child(c,"g"),{under:i,over:l,host:c,edges:o,scaleUnit:s,toHostCoord1:e=>{var[e,t]=e;return[e*a+f,t*a+_]},toHostCoord2:e=>{var[e,t]=e;return[+e+y,+t+b]}}},t.mkScaleFn=i,t.mkImageSVG=function(e){var t=(r=i(e.imageUnitDist,e.targetUnitDist))(e.width),r=r(e.height),n=v.svg.elt("image",{width:t,height:r});return n.setAttributeNS("http://www.w3.org/1999/xlink","href",""+e.image),{el:n,w:t,h:r,x:0,y:0}},t.findDistSqrd=r,t.findClosestCoordIdx=function(t,e){return e.map(e=>r(t,e)).reduce((e,t,r,n)=>t<n[e]?r:e,0)},t.mkTxt=function(e,t,r,n,i,s,a){var o=v.svg.elt("text"),s=(s=s||-.33333)*r*i.length;return v.svg.hydrate(o,{style:`font-size:${r}px;`,transform:`translate(${e} ${t}) rotate(${n}) translate(${s} ${(a=a||.3)*r})`}),v.U.addClass(o,"noselect"),o.textContent=i,o},t.GPIO_WIRE_COLORS=["pink","orange","yellow","green","purple"],t.WIRE_COLOR_MAP={black:"#514f4d",white:"#fcfdfc",gray:"#acabab",purple:"#a772a1",blue:"#01a6e8",green:"#3cce73",yellow:"#ece600",orange:"#fdb262",red:"#f44f43",brown:"#c89764",pink:"#ff80fa"},t.mapWireColor=function(e){return t.WIRE_COLOR_MAP[e]||e},t.PIN_DIST=15,t.rgbToHsl=function(e){var[e,t,r]=e,[e,t,r]=[e/255,t/255,r/255],n=Math.min(e,t,r),i=Math.max(e,t,r),s=i-n;let a,o,l;return n=i+n,l=n/2*100,o=0==s?a=0:(i===e?a=(t-r)/s%6*60:i===t?a=60*((r-e)/s+2):i===r&&(a=60*((e-t)/s+4)),50<l?s/(2-n)*100:s/n*100),[Math.floor(a),Math.floor(o),Math.floor(l)]}})(pxsim=pxsim||{}),(o=>{var n,e;function i(e,t,r){e={class:e,d:t},r&&(e.title=r),t=n.elt("path");return n.hydrate(t,e),t}function s(e,t=!1){var r=n.elt("linearGradient");n.hydrate(r,{id:e,x1:"0%",y1:"0%",x2:t?"100%":"0%",y2:t?"0%":"100%"}),n.child(r,"stop",{offset:"0%"}),n.child(r,"stop",{offset:"100%"}),n.child(r,"stop",{offset:"100%"}),n.child(r,"stop",{offset:"100%"});return r}function r(e){var t=n.elt("title");return t.textContent=e,t}(e=n=o.svg||(o.svg={})).parseString=function(e){return(new DOMParser).parseFromString(e,"image/svg+xml").getElementsByTagName("svg").item(0)},e.toDataUri=function(e){return"data:image/svg+xml,"+encodeURI(e)},e.cursorPoint=function(e,t,r){return e.x=null!=r.clientX?r.clientX:r.pageX,e.y=null!=r.clientY?r.clientY:r.pageY,e.matrixTransform(t.getScreenCTM().inverse())},e.rotateElement=function(e,t,r,n){e.setAttribute("transform",`translate(${t},${r}) rotate(${n+90}) translate(${-t},${-r})`)},e.hydrate=function(e,t){for(var r in t)"title"==r?n.title(e,t[r]):e.setAttributeNS(null,r,t[r])},e.elt=function(e,t){return e=document.createElementNS("http://www.w3.org/2000/svg",e),t&&n.hydrate(e,t),e},e.child=function(e,t,r){return t=n.elt(t,r),e.appendChild(t),t},e.mkPath=i,e.path=function(e,t,r,n){return t=i(t,r,n),e.appendChild(t),t},e.fill=function(e,t){e.style.fill=t},e.filter=function(e,t){e.style.filter=t},e.fills=function(e,t){e.forEach(e=>e.style.fill=t)},e.isTouchEnabled=function(){return"undefined"!=typeof window&&("ontouchstart"in window||0<navigator.maxTouchPoints)},e.onClick=function(t,r){let n=!1;o.pointerEvents.down.forEach(e=>t.addEventListener(e,e=>n=!0,!1)),t.addEventListener(o.pointerEvents.up,e=>!n||(n=!1,r(e),e.preventDefault(),!1),!1)},e.buttonEvents=function(t,r,n,i,s){let a=!1;o.pointerEvents.down.forEach(e=>t.addEventListener(e,e=>(a=!0,n&&n(e),!0),!1)),t.addEventListener(o.pointerEvents.move,e=>!a||(r&&r(e),e.preventDefault(),!1),!1),t.addEventListener(o.pointerEvents.up,e=>{a=!1,i&&i(e)},!1),t.addEventListener(o.pointerEvents.leave,e=>{a=!1,i&&i(e)},!1),t.addEventListener("keydown",e=>{a=!1,s&&s(e)})},e.mkLinearGradient=s,e.linearGradient=function(e,t,r=!1){return t=s(t,r),e.appendChild(t),t},e.setGradientColors=function(e,t,r){e&&(e.childNodes[0].style.stopColor=t,e.childNodes[1].style.stopColor=t,e.childNodes[2].style.stopColor=r,e.childNodes[3].style.stopColor=r)},e.setGradientValue=function(e,t){e.childNodes[1].getAttribute("offset")!=t&&(e.childNodes[1].setAttribute("offset",t),e.childNodes[2].setAttribute("offset",t))},e.animate=function(e,t){o.U.addClass(e,t),(t=e.parentElement)&&(t.removeChild(e),t.appendChild(e))},e.mkTitle=r,e.title=function(e,t){return t=r(t),e.appendChild(t),t},e.toHtmlColor=function(e){return`rgba(${e>>16&255}, ${e>>8&255}, ${255&e}, ${e>>24&1})`}})(pxsim=pxsim||{}),(t=>{{(t.music||(t.music={})).Metronome=class{constructor(){this.tickListeners=[],this.onTick=()=>{for(var e of this.tickListeners)e()}}initAsync(){if(!this.metronomeLoadPromise){if(this.metronomeWorker)return this.metronomeWorker;this.metronomeLoadPromise=new Promise(t=>{this.metronomeWorker=new Worker("data:application/javascript,"+encodeURIComponent(e));let r=e=>{"ready"===e.data&&(t(this.metronomeWorker),this.metronomeWorker.removeEventListener("message",r),this.metronomeWorker.addEventListener("message",this.onTick))};this.metronomeWorker.addEventListener("message",r)})}return this.metronomeLoadPromise}stop(){this.postMessage({type:"stop"})}setInterval(e){this.currentInterval=e,this.postMessage({type:"set-interval",interval:e})}start(e){this.currentInterval=e,this.postMessage({type:"start",interval:e})}addTickListener(e){this.tickListeners.push(e)}removeTickListener(t){this.tickListeners=this.tickListeners.filter(e=>e!==t)}interval(){return this.currentInterval}dispose(){this.metronomeWorker?(this.metronomeWorker.terminate(),this.metronomeWorker=void 0,this.metronomeLoadPromise=void 0,this.tickListeners=[],this.interval=void 0):this.metronomeLoadPromise&&this.metronomeLoadPromise.then(()=>this.dispose())}postMessage(e){if(!this.metronomeWorker)throw new Error("initAsync not called on metronome");this.metronomeWorker.postMessage(e)}};let e=`
/**
 * Adpated from https://github.com/cwilso/metronome/
 */

let timerRef;
let interval;

addEventListener("message", ev => {
    const message = ev.data;

    if (message.type === "start") {
        updateInterval(message.interval, true);
    }
    else if (message.type === "stop") {
        clearInterval(timerRef);
        timerRef = undefined;
    }
    else if (message.type === "set-interval") {
        updateInterval(message.interval, false);
    }
})

postMessage("ready");

function updateInterval(interval, startIfStopped) {
    if (timerRef) {
        clearInterval(timerRef);
        startIfStopped = true;
    }
    interval = interval;

    if (startIfStopped) {
        timerRef = setInterval(() => postMessage("tick"), interval);
    }
}
`}})(pxsim=pxsim||{}),(e=>{(e=(e=(e=e.codal||(e.codal={})).music||(e.music={})).MusicalIntervals||(e.MusicalIntervals={})).chromaticInterval=[1,1.0417,1.125,1.2,1.25,1.3333,1.4063,1.5,1.6,1.6667,1.8,1.875],e.majorScaleInterval=[e.chromaticInterval[0],e.chromaticInterval[2],e.chromaticInterval[4],e.chromaticInterval[5],e.chromaticInterval[7],e.chromaticInterval[9],e.chromaticInterval[11]],e.minorScaleInterval=[e.chromaticInterval[0],e.chromaticInterval[2],e.chromaticInterval[3],e.chromaticInterval[5],e.chromaticInterval[7],e.chromaticInterval[8],e.chromaticInterval[10]],e.pentatonicScaleInterval=[e.chromaticInterval[0],e.chromaticInterval[2],e.chromaticInterval[4],e.chromaticInterval[7],e.chromaticInterval[9]],e.majorTriadInterval=[e.chromaticInterval[0],e.chromaticInterval[4],e.chromaticInterval[7]],e.minorTriadInterval=[e.chromaticInterval[0],e.chromaticInterval[3],e.chromaticInterval[7]],e.diminishedInterval=[e.chromaticInterval[0],e.chromaticInterval[3],e.chromaticInterval[6],e.chromaticInterval[9]],e.wholeToneInterval=[e.chromaticInterval[0],e.chromaticInterval[2],e.chromaticInterval[4],e.chromaticInterval[6],e.chromaticInterval[8],e.chromaticInterval[10]]})(pxsim=pxsim||{}),(e=>{var t;e=(e=e.codal||(e.codal={})).music||(e.music={}),(t=e.MusicalProgressions||(e.MusicalProgressions={})).chromatic={interval:e.MusicalIntervals.chromaticInterval,length:12},t.majorScale={interval:e.MusicalIntervals.majorScaleInterval,length:7},t.minorScale={interval:e.MusicalIntervals.minorScaleInterval,length:7},t.pentatonicScale={interval:e.MusicalIntervals.pentatonicScaleInterval,length:5},t.majorTriad={interval:e.MusicalIntervals.majorTriadInterval,length:3},t.minorTriad={interval:e.MusicalIntervals.minorTriadInterval,length:3},t.diminished={interval:e.MusicalIntervals.diminishedInterval,length:4},t.wholeTone={interval:e.MusicalIntervals.wholeToneInterval,length:6},t.calculateFrequencyFromProgression=function(e,t,r){var n=Math.floor(r/t.length),r=r%t.length;return e*Math.pow(2,n)*t.interval[r]}})(pxsim=pxsim||{}),(a=>{{var e=a.music||(a.music={});let s=[31,33,35,37,39,41,44,46,49,52,55,58,62,65,69,73,78,82,87,92,98,104,110,117,123,131,139,147,156,165,175,185,196,208,220,233,247,262,277,294,311,330,349,370,392,415,440,466,494,523,554,587,622,659,698,740,784,831,880,932,988,1047,1109,1175,1245,1319,1397,1480,1568,1661,1760,1865,1976,2093,2217,2349,2489,2637,2794,2960,3136,3322,3520,3729,3951,4186,4435,4699,4978,5274,5588,5920,6272,6645,7040,7459,7902];async function o(e,t,r,n,i=100){await a.AudioContextManager.playInstructionsAsync(a.music.renderInstrument(t,s[e],r,i),n)}async function l(e,t,r=100){await a.AudioContextManager.playInstructionsAsync(a.music.renderDrumInstrument(e,r),t)}function c(e,t,r){return 6e4/e/t*r}e.Sequencer=class{constructor(){this._currentTick=0,this._state="stop",this.listeners={},this.globalVolume=1024,this.trackVolumes=[],this.drumTrackVolumes=[],this.currentCancelToken={cancelled:!1},this.onTick=()=>{let t=this.currentCancelToken;for(let e=0;e<this.currentlyPlaying.tracks.length;e++){var r,n=this.currentlyPlaying.tracks[e];for(r of n.notes)if(r.startTick===this._currentTick)for(var i of r.notes)n.drums?l(n.drums[i.note],()=>t.cancelled,this.getDrumTrackVolume(e,i.note)):o(i.note,n.instrument,c(this.currentlyPlaying.beatsPerMinute,this.currentlyPlaying.ticksPerBeat,r.endTick-r.startTick),()=>t.cancelled,this.getMelodicTrackVolume(e));else if(r.startTick>this._currentTick)break}this.fireEvent("tick"),this._currentTick++,this._currentTick>=this.maxTick()&&("loop"===this._state?(this._currentTick=0,this.fireEvent("looped")):this.stop(!0))}}async initAsync(){this.metronome?await this.metronome.initAsync():(this.metronome=new e.Metronome,await this.metronome.initAsync(),this.metronome.addTickListener(this.onTick))}dispose(){this.metronome&&this.metronome.dispose(),this.metronome=void 0,this.stop(),this.currentlyPlaying=void 0,this.listeners={}}state(){return this._state}currentTick(){return this._currentTick}currentTime(){return 6e4/this.currentlyPlaying.beatsPerMinute/this.currentlyPlaying.ticksPerBeat*this.currentTick()}maxTick(){return this.currentlyPlaying?this.currentlyPlaying.measures*this.currentlyPlaying.beatsPerMeasure*this.currentlyPlaying.ticksPerBeat:0}duration(){return 6e4/this.currentlyPlaying.beatsPerMinute/this.currentlyPlaying.ticksPerBeat*this.maxTick()}start(e,t){this.startFrom(e,t,0)}startFrom(e,t,r){"stop"!==this._state&&this.stop(),void 0!==t&&(this.shouldLoop=t),this._currentTick=null!=r?r:0,this.currentlyPlaying=e,this.metronome.start(6e4/e.beatsPerMinute/e.ticksPerBeat*1),this._state=this.shouldLoop?"loop":"play",this.fireStateChange()}stop(e=!1){"stop"!==this._state&&(this._state="stop",this.metronome&&this.metronome.stop(),this.fireStateChange(),e||(this.currentCancelToken.cancelled=!0),this.currentCancelToken={cancelled:!1})}updateSong(e){this.currentlyPlaying=e,"stop"!==this._state&&this.metronome.setInterval(6e4/e.beatsPerMinute/e.ticksPerBeat*1)}setLooping(e){e&&"play"===this._state?(this._state="loop",this.fireStateChange()):e||"loop"!==this._state||(this._state="play",this.fireStateChange()),this.shouldLoop=e}addEventListener(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}removeEventListener(e,t){this.listeners[e]&&(this.listeners[e]=this.listeners[e].filter(e=>e!==t))}setVolume(e){this.globalVolume=Math.min(Math.max(e,0),1024)}setTrackVolume(e,t){for(t=Math.min(Math.max(t,0),1024);this.trackVolumes.length<e;)this.trackVolumes.push(1024);this.trackVolumes[e]=t}setDrumTrackVolume(e,t,r){for(r=Math.min(Math.max(r,0),1024);this.drumTrackVolumes.length<e;)this.drumTrackVolumes.push([]);for(;this.drumTrackVolumes[e].length<t;)this.drumTrackVolumes[e].push(1024);this.drumTrackVolumes[e][t]=r}getMelodicTrackVolume(e){let t=1024;return e<this.trackVolumes.length&&(t=this.trackVolumes[e]),this.globalVolume*(t/1024)}getDrumTrackVolume(e,t){let r=1024;return this.getMelodicTrackVolume(e)*((r=e<this.drumTrackVolumes.length&&t<this.drumTrackVolumes[e].length?this.drumTrackVolumes[e][t]:r)/1024)}fireStateChange(){this.fireEvent(this._state),this.fireEvent("state-change")}fireEvent(e){if(this.listeners[e])for(var t of this.listeners[e])t()}},e.playNoteAsync=o,e.playDrumAsync=l,e.tickToMs=c}})(pxsim=pxsim||{}),(e=>{{e=e.music||(e.music={});let v=12;function T(e,t,r,n){let i,s,a=0;return null!=(i=e.pitchEnvelope)&&i.amplitude&&(a+=o(e.pitchEnvelope,n,r)),null!=(s=e.pitchLFO)&&s.amplitude&&(a+=l(e.pitchLFO,n)),Math.max(t+a,0)}function k(e,t,r,n){let i,s=0;return e.ampEnvelope.amplitude&&(s+=o(e.ampEnvelope,r,t)),null!=(i=e.ampLFO)&&i.amplitude&&(s+=l(e.ampLFO,r)),Math.max(Math.min(s,e.ampEnvelope.amplitude),0)/1024*n|0}function o(e,t,r){var n,i=e.sustain/1024*e.amplitude;return r<t?t-r>e.release?0:t<e.attack?(n=e.amplitude/e.attack*r)-n/e.release*(t-r):t<e.attack+e.decay?(n=e.amplitude-(e.amplitude-i)/e.decay*(r-e.attack))-n/e.release*(t-r):i-i/e.release*(t-r):t<e.attack?e.amplitude/e.attack*t:t<e.attack+e.decay?e.amplitude-(e.amplitude-i)/e.decay*(t-e.attack):i}function l(e,t){return Math.cos(t/1e3*e.frequency*2*Math.PI)*e.amplitude}function x(e,t,r,n,i,s,a,o){0<r&&(e[t]=s,e[t+1]=0,c(e,t+2,a),c(e,t+4,r),c(e,t+6,255*n>>6),c(e,t+8,255*i>>6),c(e,t+10,o),t+=v),e[t]=0}function c(e,t,r){var n=new Uint8Array(2);new Uint16Array(n.buffer)[0]=0|r,e[t]=n[0],e[t+1]=n[1]}function u(e,t){var r=new Uint8Array(2);return r[0]=e[t],r[1]=e[t+1],new Uint16Array(r.buffer)[0]}function d(t,r,n,i){var s={startTick:u(t,r),endTick:u(t,r+2),notes:[]};for(let e=0;e<t[r+4];e++)s.notes.push(((e,t,r)=>{var n=e>>6,r={note:r?e:(63&e)+12*(t-2),enharmonicSpelling:"normal"};return 1==n?r.enharmonicSpelling="flat":2==n&&(r.enharmonicSpelling="sharp"),r})(t[r+5+e],n,i));return s}e.renderInstrument=function(t,r,n,i){var e,s,a,o=n+t.ampEnvelope.release,l=null!=(e=t.ampLFO)&&e.amplitude?Math.max(500/t.ampLFO.frequency,50):50,c=null!=(e=t.pitchLFO)&&e.amplitude?Math.max(500/t.pitchLFO.frequency,50):50,u=[0];let d=t.ampEnvelope.attack,p=null!=(e=t.pitchEnvelope)&&e.amplitude?t.pitchEnvelope.attack:o,h=null!=(e=t.pitchLFO)&&e.amplitude?c:o,m=null!=(e=t.ampLFO)&&e.amplitude?l:o,g=0;for(;g<o&&(d<=p&&d<=h&&d<=m?(g=d,u.push(d),d=g<t.ampEnvelope.attack+t.ampEnvelope.decay&&t.ampEnvelope.attack+t.ampEnvelope.decay<n?t.ampEnvelope.attack+t.ampEnvelope.decay:g<n?n:o):p<=h&&p<=m&&p<o?(g=p,u.push(p),p=g<t.pitchEnvelope.attack+t.pitchEnvelope.decay&&t.pitchEnvelope.attack+t.pitchEnvelope.decay<n?t.pitchEnvelope.attack+t.pitchEnvelope.decay:g<n?n:g<n+t.pitchEnvelope.release?Math.min(o,n+t.pitchEnvelope.release):o):h<=m&&h<o?(g=h,u.push(h),h+=c):m<o&&(g=m,u.push(m),m+=l),!(g>=o));){for(d<=g&&(d=g<t.ampEnvelope.attack+t.ampEnvelope.decay&&t.ampEnvelope.attack+t.ampEnvelope.decay<n?t.ampEnvelope.attack+t.ampEnvelope.decay:g<n?n:o),p<=g&&(p=g<t.pitchEnvelope.attack+t.pitchEnvelope.decay&&t.pitchEnvelope.attack+t.pitchEnvelope.decay<n?t.pitchEnvelope.attack+t.pitchEnvelope.decay:g<n?n:g<n+t.pitchEnvelope.release?Math.min(o,n+t.pitchEnvelope.release):o);m<=g;)m+=l;for(;h<=g;)h+=c}let f=0|k(t,n,0,i),_=0|T(t,r,n,0),y=0;var b=new Uint8Array(v*(u.length+1));for(let e=1;e<u.length;e++)y=(u[e]-y<5||(s=0|k(t,n,u[e],i),a=0|T(t,r,n,u[e]),x(b,12*(e-1),u[e]-y|0,f,s,t.waveform,_,a),f=s,_=a),u[e]);return x(b,12*u.length,10,f,0,t.waveform,_,_),b},e.renderDrumInstrument=function(t,r){let n=t.startVolume,i=t.startFrequency;var s=e=>e/1024*r,a=new Uint8Array((t.steps.length+1)*v);for(let e=0;e<t.steps.length;e++)x(a,e*v,t.steps[e].duration,s(n),s(t.steps[e].volume),t.steps[e].waveform,i,t.steps[e].frequency),n=t.steps[e].volume,i=t.steps[e].frequency;return x(a,t.steps.length*v,10,s(n),0,t.steps[t.steps.length-1].waveform,i,i),a},e.decodeSong=function(e){var t={beatsPerMinute:u(e,1),beatsPerMeasure:e[3],ticksPerBeat:e[4],measures:e[5],tracks:[]};let r=7;for(;r<e.length;){var[n,i]=((i,s)=>{if(i[s+1]){var n=i,a=s;let e={id:n[a],instrument:{ampEnvelope:{attack:0,decay:0,sustain:0,release:0,amplitude:0},waveform:0},notes:[],drums:[]},t=u(n,a+2),r=a+4;for(;r<a+4+t;)e.drums.push(((t,r)=>{var n={startFrequency:u(t,r+1),startVolume:u(t,r+3),steps:[]};for(let e=0;e<t[r];e++){var i=r+5+7*e;n.steps.push({waveform:t[i],frequency:u(t,i+1),volume:u(t,i+3),duration:u(t,i+5)})}return n})(n,r)),r+=5+7*e.drums[e.drums.length-1].steps.length;var o=u(n,r);for(r+=2;r<a+4+t+o;)e.notes.push(d(n,r,0,!0)),r+=5+e.notes[e.notes.length-1].notes.length;return[e,r]}{var l=i,i=s;let e={id:l[i],instrument:((e,t)=>({waveform:e[t],ampEnvelope:{attack:u(e,t+1),decay:u(e,t+3),sustain:u(e,t+5),release:u(e,t+7),amplitude:u(e,t+9)},pitchEnvelope:{attack:u(e,t+11),decay:u(e,t+13),sustain:u(e,t+15),release:u(e,t+17),amplitude:u(e,t+19)},ampLFO:{frequency:e[t+21],amplitude:u(e,22)},pitchLFO:{frequency:e[t+24],amplitude:u(e,25)},octave:e[t+27]}))(l,i+4),notes:[]},t=i+4+u(l,i+2),r=u(l,t),n=t+2;for(;n<t+2+r;)e.notes.push(d(l,n,e.instrument.octave,!1)),n+=5+e.notes[e.notes.length-1].notes.length;return[e,n]}})(e,r);r=i,t.tracks.push(n)}return t}}})(pxsim=pxsim||{}),(e=>{var u;e=e.codal||(e.codal={}),(u=e.music||(e.music={})).EMOJI_SYNTHESIZER_SAMPLE_RATE=44100,u.EMOJI_SYNTHESIZER_TONE_WIDTH_F=1024,u.EMOJI_SYNTHESIZER_TONE_WIDTH=1024,u.EMOJI_SYNTHESIZER_BUFFER_SIZE=512,u.EMOJI_SYNTHESIZER_TONE_EFFECT_PARAMETERS=2,u.EMOJI_SYNTHESIZER_TONE_EFFECTS=3,u.EMOJI_SYNTHESIZER_STATUS_ACTIVE=1,u.EMOJI_SYNTHESIZER_STATUS_OUTPUT_SILENCE_AS_EMPTY=2,u.EMOJI_SYNTHESIZER_STATUS_STOPPING=4,u.SoundEmojiSynthesizer=class{constructor(e,t=u.EMOJI_SYNTHESIZER_SAMPLE_RATE){this.samplesPerStep=[],this.status=0,this.effectPointer=0,this.position=0,this.bufferSize=u.EMOJI_SYNTHESIZER_BUFFER_SIZE,this.sampleRate=t,this.samplesToWrite=0,this.samplesWritten=0,this.sampleRange=1023,this.orMask=0,this.effectPointer=-1,this.volume=1}get effect(){return this.effectBuffer[this.effectPointer]}play(e){this.effectBuffer=e,this.effectPointer=-1,this.nextSoundEffect()}nextSoundEffect(){var e=null!=this.effect;if(this.status&u.EMOJI_SYNTHESIZER_STATUS_STOPPING&&(this.effectPointer=null,this.effectBuffer=[]),this.effect?this.effectPointer++:this.effectPointer=0,this.effectPointer>=this.effectBuffer.length&&(this.effectPointer=0)<=this.effect.duration)return this.effectPointer=-1,this.effectBuffer=[],this.samplesWritten=0,this.samplesToWrite=0,this.position=0,e;this.samplesToWrite=this.determineSampleCount(this.effect.duration),this.frequency=this.effect.frequency,this.volume=this.effect.volume;for(let e=this.samplesWritten=0;e<u.EMOJI_SYNTHESIZER_TONE_EFFECTS;e++)this.effect.effects[e].step=0,this.effect.effects[e].steps=Math.max(this.effect.effects[e].steps,1),this.samplesPerStep[e]=Math.floor(this.samplesToWrite/this.effect.effects[e].steps);return!1}pull(){let e=!1,r,n;for(;!e;){var t;for((this.samplesWritten==this.samplesToWrite||this.status&u.EMOJI_SYNTHESIZER_STATUS_STOPPING)&&(t=this.nextSoundEffect(),0==this.samplesToWrite||this.status&u.EMOJI_SYNTHESIZER_STATUS_STOPPING)&&(e=!0,t||this.status&u.EMOJI_SYNTHESIZER_STATUS_STOPPING)&&(this.status&=~u.EMOJI_SYNTHESIZER_STATUS_STOPPING),!(this.samplesWritten<this.samplesToWrite)&&this.status&u.EMOJI_SYNTHESIZER_STATUS_OUTPUT_SILENCE_AS_EMPTY||null!=r||(this.buffer=new Array(this.bufferSize),r=0,n=this.buffer.length);this.samplesWritten<this.samplesToWrite;){var i=u.EMOJI_SYNTHESIZER_TONE_WIDTH_F*this.frequency/this.sampleRate,s=this.sampleRange*this.volume/1024,a=512-512*s,o=[];for(let e=0;e<u.EMOJI_SYNTHESIZER_TONE_EFFECTS;e++)o[e]=this.samplesPerStep[e]*this.effect.effects[e].step,this.effect.effects[e].step==this.effect.effects[e].steps-1&&(o[e]=this.samplesToWrite);let t=o[0];for(let e=1;e<u.EMOJI_SYNTHESIZER_TONE_EFFECTS;e++)t=Math.min(t,o[e]);for(;this.samplesWritten<t;){if(r==n)return this.buffer;var l=this.effect.tone.tonePrint(this.effect.tone.parameter,Math.max(this.position,0));for(this.buffer[r]=l*s+a,r++,this.samplesWritten++,this.position+=i;this.position>u.EMOJI_SYNTHESIZER_TONE_WIDTH_F;)this.position-=u.EMOJI_SYNTHESIZER_TONE_WIDTH_F}for(let e=0;e<u.EMOJI_SYNTHESIZER_TONE_EFFECTS;e++)this.samplesWritten==o[e]&&this.effect.effects[e].step<this.effect.effects[e].steps&&(this.effect.effects[e].effect&&this.effect.effects[e].effect(this,this.effect.effects[e]),this.effect.effects[e].step++)}}if(null==r)this.buffer=[];else for(var c=.5*this.sampleRange;r<n;)this.buffer[r]=c,r++;return this.buffer}determineSampleCount(e){return e<0&&(e=-e),Math.floor(this.sampleRate*(e/1e3))}totalDuration(){let e=0;for(var t of this.effectBuffer)e+=t.duration;return e}}})(pxsim=pxsim||{}),(e=>{e=(e=e.codal||(e.codal={})).music||(e.music={});{e=e.Synthesizer||(e.Synthesizer={});let n=[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,3,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,11,11,12,13,13,14,15,16,16,17,18,19,20,21,22,22,23,24,25,26,27,28,29,30,32,33,34,35,36,37,38,40,41,42,43,45,46,47,49,50,51,53,54,56,57,58,60,61,63,64,66,68,69,71,72,74,76,77,79,81,82,84,86,87,89,91,93,95,96,98,100,102,104,106,108,110,112,114,116,118,120,122,124,126,128,130,132,134,136,138,141,143,145,147,149,152,154,156,158,161,163,165,167,170,172,175,177,179,182,184,187,189,191,194,196,199,201,204,206,209,211,214,216,219,222,224,227,229,232,235,237,240,243,245,248,251,253,256,259,262,264,267,270,273,275,278,281,284,287,289,292,295,298,301,304,307,309,312,315,318,321,324,327,330,333,336,339,342,345,348,351,354,357,360,363,366,369,372,375,378,381,384,387,390,393,396,399,402,405,408,411,414,417,420,424,427,430,433,436,439,442,445,448,452,455,458,461,464,467,470,473,477,480,483,486,489,492,495,498,502,505,508,511,514,517,520,524,527,530,533,536,539,542,545,549,552,555,558,561,564,567,570,574,577,580,583,586,589,592,595,598,602,605,608,611,614,617,620,623,626,629,632,635,638,641,644,647,650,653,656,659,662,665,668,671,674,677,680,683,686,689,692,695,698,701,704,707,710,713,715,718,721,724,727,730,733,735,738,741,744,747,749,752,755,758,760,763,766,769,771,774,777,779,782,785,787,790,793,795,798,800,803,806,808,811,813,816,818,821,823,826,828,831,833,835,838,840,843,845,847,850,852,855,857,859,861,864,866,868,870,873,875,877,879,881,884,886,888,890,892,894,896,898,900,902,904,906,908,910,912,914,916,918,920,922,924,926,927,929,931,933,935,936,938,940,941,943,945,946,948,950,951,953,954,956,958,959,961,962,964,965,966,968,969,971,972,973,975,976,977,979,980,981,982,984,985,986,987,988,989,990,992,993,994,995,996,997,998,999,1e3,1e3,1001,1002,1003,1004,1005,1006,1006,1007,1008,1009,1009,1010,1011,1011,1012,1013,1013,1014,1014,1015,1015,1016,1016,1017,1017,1018,1018,1019,1019,1019,1020,1020,1020,1021,1021,1021,1021,1022,1022,1022,1022,1022,1022,1022,1022,1022,1022,1023,1022];e.SineTone=function(e,t){var r=1024-(t|=0);return r<512&&(t=r),n[t]},e.SawtoothTone=function(e,t){return t},e.TriangleTone=function(e,t){return t<512?2*t:2*(1023-t)},e.NoiseTone=function(e,t){let r=e[0];return t*(r=0==r?7919:r)&1023},e.SquareWaveTone=function(e,t){return t<512?1023:0}}})(pxsim=pxsim||{}),(e=>{var r;e=e.codal||(e.codal={}),(e=(r=e.music||(e.music={})).SoundSynthesizerEffects||(r.SoundSynthesizerEffects={})).noInterpolation=function(e,t){},e.linearInterpolation=function(e,t){var r=(t.parameter[0]-e.effect.frequency)/t.steps;e.frequency=e.effect.frequency+r*t.step},e.logarithmicInterpolation=function(e,t){e.frequency=e.effect.frequency+Math.log10(Math.max(t.step,.1))*(t.parameter[0]-e.effect.frequency)/1.95},e.curveInterpolation=function(e,t){e.frequency=Math.sin(3.12159*t.step/180)*(t.parameter[0]-e.effect.frequency)+e.effect.frequency},e.slowVibratoInterpolation=function(e,t){e.frequency=Math.sin(t.step/10)*t.parameter[0]+e.effect.frequency},e.warbleInterpolation=function(e,t){e.frequency=Math.sin(t.step)*(t.parameter[0]-e.effect.frequency)+e.effect.frequency},e.vibratoInterpolation=function(e,t){e.frequency=e.effect.frequency+Math.sin(t.step)*t.parameter[0]},e.exponentialRisingInterpolation=function(e,t){e.frequency=e.effect.frequency+Math.sin(.01745329*t.step)*t.parameter[0]},e.exponentialFallingInterpolation=function(e,t){e.frequency=e.effect.frequency+Math.cos(.01745329*t.step)*t.parameter[0]},e.appregrioAscending=function(e,t){e.frequency=r.MusicalProgressions.calculateFrequencyFromProgression(e.effect.frequency,t.parameter_p[0],t.step)},e.appregrioDescending=function(e,t){e.frequency=r.MusicalProgressions.calculateFrequencyFromProgression(e.effect.frequency,t.parameter_p[0],t.steps-t.step-1)},e.frequencyVibratoEffect=function(e,t){0!=t.step&&(t.step%2==0?e.frequency/=t.parameter[0]:e.frequency*=t.parameter[0])},e.volumeVibratoEffect=function(e,t){0!=t.step&&(t.step%2==0?e.volume/=t.parameter[0]:e.volume*=t.parameter[0])},e.adsrVolumeEffect=function(e,t){var r,n=.5*t.steps;t.step<=n?(r=(t.parameter[0]-e.effect.volume)/n,e.volume=e.effect.volume+t.step*r):(r=(t.parameter[1]-t.parameter[0])/n,e.volume=t.parameter[0]+(t.step-n)*r)},e.volumeRampEffect=function(e,t){var r=(t.parameter[0]-e.effect.volume)/t.steps;e.volume=e.effect.volume+t.step*r}})(pxsim=pxsim||{}),(c=>{var e=c.codal||(c.codal={});{var m=e.music||(e.music={});(e=m.WaveShape||(m.WaveShape={}))[e.Sine=0]="Sine",e[e.Sawtooth=1]="Sawtooth",e[e.Triangle=2]="Triangle",e[e.Square=3]="Square",e[e.Noise=4]="Noise",(e=m.InterpolationEffect||(m.InterpolationEffect={}))[e.None=0]="None",e[e.Linear=1]="Linear",e[e.Curve=2]="Curve",e[e.ExponentialRising=5]="ExponentialRising",e[e.ExponentialFalling=6]="ExponentialFalling",e[e.ArpeggioRisingMajor=8]="ArpeggioRisingMajor",e[e.ArpeggioRisingMinor=10]="ArpeggioRisingMinor",e[e.ArpeggioRisingDiminished=12]="ArpeggioRisingDiminished",e[e.ArpeggioRisingChromatic=14]="ArpeggioRisingChromatic",e[e.ArpeggioRisingWholeTone=16]="ArpeggioRisingWholeTone",e[e.ArpeggioFallingMajor=9]="ArpeggioFallingMajor",e[e.ArpeggioFallingMinor=11]="ArpeggioFallingMinor",e[e.ArpeggioFallingDiminished=13]="ArpeggioFallingDiminished",e[e.ArpeggioFallingChromatic=15]="ArpeggioFallingChromatic",e[e.ArpeggioFallingWholeTone=17]="ArpeggioFallingWholeTone",e[e.Logarithmic=18]="Logarithmic",(e=m.Effect||(m.Effect={}))[e.None=0]="None",e[e.Vibrato=1]="Vibrato",e[e.Tremolo=2]="Tremolo",e[e.Warble=3]="Warble";class r{constructor(){this.src="000000000000000000000000000000000000000000000000000000000000000000000000"}get wave(){return this.getValue(0,1)}set wave(e){this.setValue(0,n(e,0,4),1)}get volume(){return this.getValue(1,4)}set volume(e){this.setValue(1,n(e,0,1023),4)}get frequency(){return this.getValue(5,4)}set frequency(e){this.setValue(5,e,4)}get duration(){return this.getValue(9,4)}set duration(e){this.setValue(9,e,4)}get shape(){return this.getValue(13,2)}set shape(e){this.setValue(13,e,2)}get endFrequency(){return this.getValue(18,4)}set endFrequency(e){this.setValue(18,e,4)}get endVolume(){return this.getValue(26,4)}set endVolume(e){this.setValue(26,n(e,0,1023),4)}get steps(){return this.getValue(30,4)}set steps(e){this.setValue(30,e,4)}get fx(){return this.getValue(34,2)}set fx(e){this.setValue(34,n(e,0,3),2)}get fxParam(){return this.getValue(36,4)}set fxParam(e){this.setValue(36,e,4)}get fxnSteps(){return this.getValue(40,4)}set fxnSteps(e){this.setValue(40,e,4)}get frequencyRandomness(){return this.getValue(44,4)}set frequencyRandomness(e){this.setValue(44,e,4)}get endFrequencyRandomness(){return this.getValue(48,4)}set endFrequencyRandomness(e){this.setValue(48,e,4)}get volumeRandomness(){return this.getValue(52,4)}set volumeRandomness(e){this.setValue(52,e,4)}get endVolumeRandomness(){return this.getValue(56,4)}set endVolumeRandomness(e){this.setValue(56,e,4)}get durationRandomness(){return this.getValue(60,4)}set durationRandomness(e){this.setValue(60,e,4)}get fxParamRandomness(){return this.getValue(64,4)}set fxParamRandomness(e){this.setValue(64,e,4)}get fxnStepsRandomness(){return this.getValue(68,4)}set fxnStepsRandomness(e){this.setValue(68,e,4)}copy(){var e=new r;return e.src=this.src.slice(0),e}setValue(e,t,r){t=n(0|t,0,Math.pow(10,r)-1),this.src=this.src.substr(0,e)+((e,t)=>{let r=e+"";for(;r.length<t;)r="0"+r;return r})(t,r)+this.src.substr(e+r)}getValue(e,t){return parseInt(this.src.substr(e,t))}}m.Sound=r;let a=!1,o,l={cancelled:!1};function t(){o=[],l.cancelled=!0,l={cancelled:!1}}function u(e,t,n,r=.03){let i=new m.SoundEmojiSynthesizer(0);var s,e=(t=>{var r=Math.floor((t.length+1)/73),e=73*r-1;if(t.length!=e)return[];var n=[];for(let e=0;e<r;++e){var i=72*e+e;if(0<i&&","!=t[i-1])return[];var s=(()=>{var t={frequency:0,volume:1,duration:0,tone:{tonePrint:void 0,parameter:[0]},effects:[]};for(let e=0;e<m.EMOJI_SYNTHESIZER_TONE_EFFECTS;e++)t.effects.push({effect:void 0,step:0,steps:0,parameter:[],parameter_p:[]});return t})();if(!d(t.substr(i),s))return[];n.push(s)}return n})(e);i.play(e);let a=!1;return Promise.race([(s=i.totalDuration(),new Promise(e=>setTimeout(e,s)).then(()=>{a=!0})),c.AudioContextManager.playPCMBufferStreamAsync(()=>{if(i.effect){var t=i.pull(),r=(n&&n(i.frequency,i.volume),new Float32Array(t.length));for(let e=0;e<t.length;e++)r[e]=(t[e]-512)/512;return r}},i.sampleRate,r,()=>a||t&&t())])}function d(e,t){var r=parseInt(e.substr(0,1)),n=parseInt(e.substr(1,4)),i=parseInt(e.substr(5,4)),s=parseInt(e.substr(9,4)),a=parseInt(e.substr(13,2)),o=parseInt(e.substr(18,4)),l=parseInt(e.substr(26,4)),c=parseInt(e.substr(30,4)),u=parseInt(e.substr(34,2)),d=parseInt(e.substr(36,4)),p=parseInt(e.substr(40,4)),i=f(i,parseInt(e.substr(44,4))),o=f(o,parseInt(e.substr(48,4))),n=f(n,parseInt(e.substr(52,4))),l=f(l,parseInt(e.substr(56,4))),s=f(s,parseInt(e.substr(60,4))),d=f(d,parseInt(e.substr(64,4))),p=f(p,parseInt(e.substr(68,4)));if(-1==i||-1==o||-1==n||-1==l||-1==s||-1==d||-1==p)return!1;switch(r){case 0:t.tone.tonePrint=m.Synthesizer.SineTone;break;case 1:t.tone.tonePrint=m.Synthesizer.SawtoothTone;break;case 2:t.tone.tonePrint=m.Synthesizer.TriangleTone;break;case 3:t.tone.tonePrint=m.Synthesizer.SquareWaveTone;break;case 4:t.tone.tonePrint=m.Synthesizer.NoiseTone}switch(t.frequency=i,t.duration=s,t.effects[0].steps=c,a){case 0:t.effects[0].effect=m.SoundSynthesizerEffects.noInterpolation;break;case 1:t.effects[0].effect=m.SoundSynthesizerEffects.linearInterpolation,t.effects[0].parameter[0]=o;break;case 2:t.effects[0].effect=m.SoundSynthesizerEffects.curveInterpolation,t.effects[0].parameter[0]=o;break;case 5:t.effects[0].effect=m.SoundSynthesizerEffects.exponentialRisingInterpolation,t.effects[0].parameter[0]=o;break;case 6:t.effects[0].effect=m.SoundSynthesizerEffects.exponentialFallingInterpolation,t.effects[0].parameter[0]=o;break;case 8:case 10:case 12:case 14:case 16:t.effects[0].effect=m.SoundSynthesizerEffects.appregrioAscending;break;case 9:case 11:case 13:case 15:case 17:t.effects[0].effect=m.SoundSynthesizerEffects.appregrioDescending;break;case 18:t.effects[0].effect=m.SoundSynthesizerEffects.logarithmicInterpolation,t.effects[0].parameter[0]=o}switch(a){case 8:case 9:t.effects[0].parameter_p[0]=m.MusicalProgressions.majorScale;break;case 10:case 11:t.effects[0].parameter_p[0]=m.MusicalProgressions.minorScale;break;case 12:case 13:t.effects[0].parameter_p[0]=m.MusicalProgressions.diminished;break;case 14:case 15:t.effects[0].parameter_p[0]=m.MusicalProgressions.chromatic;break;case 16:case 17:t.effects[0].parameter_p[0]=m.MusicalProgressions.wholeTone}var e=g(0,n,1023)/1023,r=g(0,l,1023)/1023,h=(t.volume=e,t.effects[1].effect=m.SoundSynthesizerEffects.volumeRampEffect,t.effects[1].steps=36,t.effects[1].parameter[0]=r,Math.round(t.duration/1e4*p));switch(u){case 1:t.effects[2].steps=h,t.effects[2].effect=m.SoundSynthesizerEffects.frequencyVibratoEffect,t.effects[2].parameter[0]=d;break;case 2:t.effects[2].steps=h,t.effects[2].effect=m.SoundSynthesizerEffects.volumeVibratoEffect,t.effects[2].parameter[0]=d;break;case 3:t.effects[2].steps=h,t.effects[2].effect=m.SoundSynthesizerEffects.warbleInterpolation,t.effects[2].parameter[0]=d}return!0}function g(e,t,r){return Math.min(r,Math.max(e,t))}function f(e,t){var r;return e<0||t<0?-1:(r=2*t+1,r=Math.floor(Math.random()*r)-t,Math.abs(e+r))}function n(e,t,r){return Math.min(Math.max(e,t),r)}m.isSoundExpPlaying=function(){return a},m.__playSoundExpression=function(r,n,i=.03){o=o||[];let s=c.getResume();var e=new Promise((e,t)=>{o.push({notes:r,volume:i,onStarted:()=>{n||s()},onFinished:e,onCancelled:e})});a||!async function r(){if(o.length){a=!0;let t=o.shift(),e=l;try{t.onStarted(),await u(t.notes,()=>e.cancelled,void 0,t.volume),e.cancelled?t.onCancelled():t.onFinished()}catch(e){t.onCancelled()}r()}else a=!1}(),n&&e.then(s)},m.clearSoundQueue=t,m.playSoundExpressionAsync=u,m.__stopSoundExpressions=function(){t(),c.AudioContextManager.stopAll()},m.parseSoundExpression=d}})(pxsim=pxsim||{}),(e=>{class t{constructor(e){this.id=e}}e.Button=t,e.ButtonPairState=class{constructor(e){this.props=e,this.usesButtonAB=!1,this.aBtn=new t(this.props.ID_BUTTON_A),this.bBtn=new t(this.props.ID_BUTTON_B),this.abBtn=new t(this.props.ID_BUTTON_AB),this.abBtn.virtual=!0}}})(pxsim=pxsim||{}),(pxsim||(pxsim={})).CompassState=class{constructor(){this.usesHeading=!1,this.heading=90}},(pxsim||(pxsim={})).FileSystemState=class{constructor(){this.files={}}append(e,t){this.files[e]=(this.files[e]||"")+t}remove(e){delete this.files[e]}},(pxsim||(pxsim={})).LightSensorState=class{constructor(){this.usesLightLevel=!1,this.lightLevel=128}},(o=>{var l=o.visuals||(o.visuals={});l.mkBoardView=e=>{var t=e.visual;return new l.GenericBoardSvg({visualDef:t,boardDef:e.boardDef,wireframe:e.wireframe})},l.BoardHost=class{constructor(e,t){this.parts=[],this.boardView=e,(this.opts=t).boardDef.pinStyles||(t.boardDef.pinStyles={}),this.state=t.state;var r,n,i,s,e=t.partsList;let a=0<e.length||t.forceBreadboardLayout;a&&(this.breadboard=new l.Breadboard({wireframe:t.wireframe}),i=t.boardDef.marginWhenBreadboarding||[0,0,40,0],s=(i=l.composeSVG({el1:this.boardView.getView(),scaleUnit1:this.boardView.getPinDist(),el2:this.breadboard.getSVGAndSize(),scaleUnit2:this.breadboard.getPinDist(),margin:[i[0],i[1],20,i[3]],middleMargin:i[2],maxWidth:t.maxWidth,maxHeight:t.maxHeight})).under,r=i.over,this.view=i.host,n=i.edges,this.fromMBCoord=i.toHostCoord1,this.fromBBCoord=i.toHostCoord2,this.partGroup=r,this.partOverGroup=o.svg.child(this.view,"g"),this.style=o.svg.child(this.view,"style",{}),this.defs=o.svg.child(this.view,"defs",{}),this.wireFactory=new l.WireFactory(s,r,n,this.style,this.getLocCoord.bind(this),this.getPinStyle.bind(this)),((i=o.allocateDefinitions({boardDef:t.boardDef,partDefs:t.partDefs,fnArgs:t.fnArgs,getBBCoord:this.breadboard.getCoord.bind(this.breadboard),partsList:e})).partsAndWires.length||t.forceBreadboardLayout)&&(this.addAll(i),i.requiresBreadboard||t.forceBreadboardRender)?i.hideBreadboard&&this.breadboard&&this.breadboard.hide():a=!1),a||(delete this.breadboard,delete this.wireFactory,delete this.partOverGroup,delete this.partGroup,delete this.style,delete this.defs,delete this.fromBBCoord,delete this.fromMBCoord,s=this.boardView.getView().el,this.view=s,this.partGroup=o.svg.child(this.view,"g"),this.partOverGroup=o.svg.child(this.view,"g"),t.maxWidth&&o.svg.hydrate(this.view,{width:t.maxWidth}),t.maxHeight&&o.svg.hydrate(this.view,{height:t.maxHeight})),this.state.updateSubscribers.push(()=>this.updateState())}highlightBoardPin(e){this.boardView.highlightPin(e)}removeEventListeners(){this.boardView.removeEventListeners&&this.boardView.removeEventListeners()}highlightBreadboardPin(e){this.breadboard.highlightLoc(e)}highlightWire(e){e.wires.forEach(e=>{o.U.addClass(e,"highlight"),e.style.visibility="visible"}),o.U.addClass(e.endG,"highlight")}getView(){return this.view}screenshotAsync(i){var e=this.view.classList.contains("sim")?this.view:this.view.querySelector(".sim"),e=(e||this.view).cloneNode(!0),e=(e.setAttribute("width",e.viewBox.baseVal.width+""),e.setAttribute("height",e.viewBox.baseVal.height+""),(new XMLSerializer).serializeToString(e));let t="data:image/svg+xml,"+encodeURIComponent(e.replace(/\s+/g," ").replace(/"/g,"'"));return new Promise((r,e)=>{let n=document.createElement("img");n.onload=()=>{var e=document.createElement("canvas"),t=(e.width=n.width,e.height=n.height,0<i?(e.width=i,e.height=n.height*i/n.width|0):e.width<200?(e.width*=2,e.height*=2):480<e.width&&(e.width/=2,e.height/=2),e.getContext("2d"));t.drawImage(n,0,0,e.width,e.height),r(t.getImageData(0,0,e.width,e.height))},n.onerror=e=>{o.log(e),r(void 0)},n.src=t})}updateState(){this.parts.forEach(e=>e.updateState())}getBBCoord(e){e=this.breadboard.getCoord(e);return this.fromBBCoord(e)}getPinCoord(e){var t=this.boardView.getCoord(e);if(t)return this.fromMBCoord(t);o.error("Unable to find coord for pin: "+e)}getLocCoord(e){let t;return(t="breadboard"===e.type?this.getBBCoord(e):(e=e.pin,this.getPinCoord(e)))||o.debug("Unknown location: "+name),t}getPinStyle(e){return"breadboard"!=e.type&&this.opts.boardDef.pinStyles[e.pin]||"female"}addPart(e){let t=null;e.simulationBehavior?(r=e.simulationBehavior,n=this.state.builtinVisuals[r],r=this.state.builtinParts[r],(t=n()).init(this.state.bus,r,this.view,e.params)):(n=e.visual,t=new l.GenericPart(n)),this.parts.push(t),this.partGroup.appendChild(t.element),t.overElement&&this.partOverGroup.appendChild(t.overElement),t.defs&&t.defs.forEach(e=>this.defs.appendChild(e)),this.style.textContent+=t.style||"";var r=e.startColumnIdx,n=l.getRowName(e.startRowIdx),r=l.getColumnName(r),i=e.bbFit.xOffset/e.visual.pinDistance,s=e.bbFit.yOffset/e.visual.pinDistance,n=this.getBBCoord({type:"breadboard",row:n,col:r,xOffset:i,yOffset:s}),r=(t.moveToCoord(n),`sim-${e.name}-cmp`);return o.U.addClass(t.element,r),o.U.addClass(t.element,"sim-cmp"),t.updateTheme(),t.updateState(),t}addWire(e){return this.wireFactory.addWire(e.start,e.end,e.color)}addAll(n){n.partsAndWires.forEach(e=>{var t=e.wires,r=t&&t.every(e=>this.wireFactory.checkWire(e.start,e.end)),e=(r&&t.forEach(e=>n.wires.push(this.addWire(e))),e.part);!e||t&&!r||n.parts.push(this.addPart(e))}),n.requiresBreadboard=!!n.wires.length||!!n.parts.length}}})(pxsim=pxsim||{}),(F=>{{var B=F.visuals||(F.visuals={});B.BREADBOARD_MID_ROWS=10,B.BREADBOARD_MID_COLS=30;let x=[4,4];var e=B.BREADBOARD_MID_ROWS+x.length;let E=[4,9,14,19];var t=25+E.length;let S=15*(B.BREADBOARD_MID_COLS+3),C=15*(e+4+5.5),w=C*(2/3),I=C*(.5*(1-2/3)),A=(S-15*(B.BREADBOARD_MID_COLS-1))/2,D=I+(w-15*(e-1))/2,N=15*(t-1),O=(S-N)/2,R=(I-15)/2,L=O,P=R+I+w,M="abcdefghij".split("").reverse();function $(e){return""+(e+1)}function U(e){return M[e]}function V(i){var s=i.xOffset||0,t=i.yOffset||0,a=[];let o=F.svg.elt("g");var l=i.colStartIdx||0,c=i.rowStartIdx||0,u=e=>e?e.slice(0,e.length):[],d=(e,t)=>{let r=0;for(var n;0<=(n=e.indexOf(t));)e.splice(n,1),r+=1;return r};let p=0;var h=u(i.rowIdxsWithGap);for(let e=0;e<i.rowCount;e++){let r=0;var m=u(i.colIdxsWithGap);let n=t+e*i.pinDist+p*i.pinDist;var g=e+c;for(let e=0;e<i.colCount;e++){let t=s+e*i.pinDist+r*i.pinDist;var f=e+l,_=e=>(F.svg.hydrate(e.el,"circle"==e.el.tagName?{cx:t,cy:n}:{x:t-.5*e.w,y:n-.5*e.h}),o.appendChild(e.el),e.el),y=_(i.mkPin()),_=_(i.mkHoverPin()),b=i.getRowName(g),v=i.getColName(f),T=i.getGroupName?i.getGroupName(g,f):null,y={el:y,hoverEl:_,cx:t,cy:n,row:b,col:v,group:T};a.push(y),r+=d(m,f)}p+=d(h,g)}return{g:o,allPins:a}}function H(){var e=F.svg.elt("rect");return F.svg.hydrate(e,{class:"sim-bb-pin",rx:2,ry:2,width:6,height:6}),{el:e,w:6,h:6,x:0,y:0}}function G(){var e=F.svg.elt("rect");return F.svg.hydrate(e,{class:"sim-bb-pin-hover",rx:2,ry:2,width:6*1.3,height:6*1.3}),{el:e,w:6*1.3,h:6*1.3,x:0,y:0}}function j(e,t,r,n,i,s,a){let o=B.mkTxt(e,t,r,n,i),l=(F.U.addClass(o,"sim-bb-label"),a&&a.forEach(e=>F.U.addClass(o,e)),B.mkTxt(e,t,1.3*r,n,i));return F.U.addClass(l,"sim-bb-label-hover"),a&&a.forEach(e=>F.U.addClass(l,e)),{el:o,hoverEl:l,txt:i,group:s}}B.getColumnName=$,B.getRowName=U,B.mkGrid=V,B.Breadboard=class{constructor(e){this.allPins=[],this.allLabels=[],this.allPowerBars=[],this.rowColToPin={},this.rowColToLbls={},this.buildDom(),e.wireframe&&F.U.addClass(this.bb,"sim-bb-outline")}hide(){this.bb.style.display="none"}updateLocation(e,t){F.svg.hydrate(this.bb,{x:e+"px",y:t+"px"})}getPin(e,t){e=this.rowColToPin[e];return e&&e[t]||null}getCoord(e){var{row:e,col:t,xOffset:r,yOffset:n}=e,e=this.getPin(e,t);return e?[e.cx+15*(r||0),e.cy+15*(n||0)]:null}getPinDist(){return 15}buildDom(){this.bb=F.svg.elt("svg",{version:"1.0",viewBox:`0 0 ${S} `+C,class:"sim-bb",width:S+"px",height:C+"px"}),this.styleEl=F.svg.child(this.bb,"style",{}),this.styleEl.textContent+='\n        /* bread board */\n        .sim-bb-background {\n            fill:#E0E0E0;\n        }\n        .sim-bb-pin {\n            fill:#999;\n        }\n        .sim-bb-pin-hover {\n            visibility: hidden;\n            pointer-events: all;\n            stroke-width: 7.5px;\n            stroke: transparent;\n            fill: #777;\n        }\n        .sim-bb-pin-hover:hover {\n            visibility: visible;\n            fill:#444;\n        }\n        .sim-bb-group-wire {\n            stroke: #999;\n            stroke-width: 3.75px;\n            visibility: hidden;\n        }\n        .sim-bb-pin-group {\n            pointer-events: all;\n        }\n        .sim-bb-label,\n        .sim-bb-label-hover {\n            font-family:"Lucida Console", Monaco, monospace;\n            fill:#555;\n            pointer-events: all;\n            stroke-width: 0;\n            cursor: default;\n        }\n        .sim-bb-label-hover {\n            visibility: hidden;\n            fill:#000;\n            font-weight: bold;\n        }\n        .sim-bb-bar {\n            stroke-width: 0;\n        }\n        .sim-bb-blue {\n            fill:#1AA5D7;\n            stroke:#1AA5D7\n        }\n        .sim-bb-red {\n            fill:#DD4BA0;\n            stroke:#DD4BA0;\n        }\n        .sim-bb-pin-group:hover .sim-bb-pin-hover,\n        .sim-bb-pin-group:hover .sim-bb-group-wire,\n        .sim-bb-pin-group:hover .sim-bb-label-hover {\n            visibility: visible;\n        }\n        .sim-bb-pin-group:hover .sim-bb-label {\n            visibility: hidden;\n        }\n        /* outline mode */\n        .sim-bb-outline .sim-bb-background {\n            stroke-width: 2.142857142857143px;\n            fill: #FFF;\n            stroke: #000;\n        }\n        .sim-bb-outline .sim-bb-mid-channel {\n            fill: #FFF;\n            stroke: #888;\n            stroke-width: 2px;\n        }\n        /* grayed out */\n        .grayed .sim-bb-background {\n            stroke-width: 3px;\n        }\n        .grayed .sim-bb-red,\n        .grayed .sim-bb-blue {\n            fill: #BBB;\n        }\n        .grayed .sim-bb-bar {\n            fill: #FFF;\n        }\n        .grayed .sim-bb-pin {\n            fill: #000;\n            stroke: #FFF;\n            stroke-width: 3px;\n        }\n        .grayed .sim-bb-label {\n            fill: none;\n        }\n        .grayed .sim-bb-background {\n            stroke-width: 7.5px;\n            stroke: #555;\n        }\n        .grayed .sim-bb-group-wire {\n            stroke: #DDD;\n        }\n        .grayed .sim-bb-channel {\n            visibility: hidden;\n        }\n        /* highlighted */\n        .sim-bb-label.highlight {\n            visibility: hidden;\n        }\n        .sim-bb-label-hover.highlight {\n            visibility: visible;\n        }\n        .sim-bb-blue.highlight {\n            fill:#1AA5D7;\n        }\n        .sim-bb-red.highlight {\n            fill:#DD4BA0;\n        }\n        .sim-bb-bar.highlight {\n            stroke-width: 0px;\n        }\n        ',this.defs=F.svg.child(this.bb,"defs",{}),F.svg.child(this.bb,"rect",{class:"sim-bb-background",width:S,height:C,rx:4.5,ry:4.5});let n="sim-bb-channel-grad";var e=F.svg.elt("linearGradient"),e=(F.svg.hydrate(e,{id:n,x1:"0%",y1:"0%",x2:"0%",y2:"100%"}),this.defs.appendChild(e),F.svg.child(e,"stop",{offset:"0%",style:"stop-color: #AAA;"}),F.svg.child(e,"stop",{offset:"20%",style:"stop-color: #CCC;"}),F.svg.child(e,"stop",{offset:"80%",style:"stop-color: #CCC;"}),F.svg.child(e,"stop",{offset:"100%",style:"stop-color: #AAA;"}),(e,t,r)=>{r=F.svg.child(this.bb,"rect",{class:"sim-bb-channel "+(r||""),y:e-t/2,width:S,height:t});return r.setAttribute("fill",`url(#${n})`),r});e(I+w/2,15,"sim-bb-mid-channel"),e(I,.75,"sim-bb-sml-channel"),e(I+w,.75,"sim-bb-sml-channel");let r=e=>e<B.BREADBOARD_MID_ROWS/2?"b":"t",i=e=>e<25?"b":"t";var t=(e,t)=>""+r(e)+$(t);let s=e=>0===e?"-":"+";var e=(e,t)=>{t=i(t);return""+s(e)+t},a=V({xOffset:A,yOffset:D,rowCount:B.BREADBOARD_MID_ROWS,colCount:B.BREADBOARD_MID_COLS,pinDist:15,mkPin:H,mkHoverPin:G,getRowName:U,getColName:$,getGroupName:t,rowIdxsWithGap:x}),a=(a.g,this.allPins=this.allPins.concat(a.allPins),V({xOffset:L,yOffset:P,rowCount:2,colCount:25,pinDist:15,mkPin:H,mkHoverPin:G,getRowName:s,getColName:$,getGroupName:e,colIdxsWithGap:E})),a=(a.g,this.allPins=this.allPins.concat(a.allPins),V({xOffset:O,yOffset:R,rowCount:2,colCount:25,colStartIdx:25,pinDist:15,mkPin:H,mkHoverPin:G,getRowName:s,getColName:$,getGroupName:e,colIdxsWithGap:E.map(e=>e+25)})),o=(a.g,this.allPins=this.allPins.concat(a.allPins),this.allPins.forEach(e=>{var{el:e,row:t,col:r,hoverEl:n}=e,t=`(${t},${r})`;F.svg.hydrate(e,{title:t}),F.svg.hydrate(n,{title:t})}),this.allPins.forEach(e=>{let t=this.rowColToPin[e.row];(t=t||(this.rowColToPin[e.row]={}))[e.col]=e}),(e,t,r,n,i,s)=>{var[e,t]=this.getCoord({type:"breadboard",row:e,col:t});return j(e+r,t+n,10.5,-90,i,s)});for(let e=0;e<B.BREADBOARD_MID_COLS;e++){var l=$(e),c=o(M[0],l,0,-15,l,t(0,e)),c=(this.allLabels.push(c),B.BREADBOARD_MID_ROWS-1),l=o(U(c),l,0,15,l,t(c,e));this.allLabels.push(l)}for(let e=0;e<B.BREADBOARD_MID_ROWS;e++){var u=U(e),d=o(u,"1",-15,0,u),d=(this.allLabels.push(d),B.BREADBOARD_MID_COLS-1),d=o(u,$(d),15,0,u);this.allLabels.push(d)}let p=[j(13.05,I+w+12,30,-90,"-",e(0,0),["sim-bb-blue"]),j(12,I+w+I-12,25.5,-90,"+",e(1,0),["sim-bb-red"]),j(S-12+1.05,I+w+12,30,-90,"-",e(0,24),["sim-bb-blue"]),j(S-12,I+w+I-12,25.5,-90,"+",e(1,24),["sim-bb-red"])],h=(this.allLabels=this.allLabels.concat(p),[j(13.05,12,30,-90,"-",e(0,25),["sim-bb-blue"]),j(12,I-12,25.5,-90,"+",e(1,25),["sim-bb-red"]),j(S-12+1.05,12,30,-90,"-",e(0,49),["sim-bb-blue"]),j(S-12,I-12,25.5,-90,"+",e(1,49),["sim-bb-red"])]),m=(this.allLabels=this.allLabels.concat(h),{}),g=(this.allLabels.forEach(e=>{var t=e.txt;(m[t]=m[t]||[]).push(e)}),this.allPins.forEach(t=>{var{row:e,col:r}=t,n=this.rowColToLbls[e]||(this.rowColToLbls[e]={});let i=n[r]||(n[r]=[]);"-"===(n=t).row||"+"===n.row?Number(r)<=25?p.filter(e=>e.group==t.group).forEach(e=>i.push(e)):h.filter(e=>e.group==t.group).forEach(e=>i.push(e)):(m[e].forEach(e=>i.push(e)),m[r].forEach(e=>i.push(e)))}),22.5+N),f=3;var a=(g-N)/2,_=(e,t,r,n)=>{var i=F.svg.elt("rect"),n=(F.svg.hydrate(i,{class:"sim-bb-bar "+n,x:e,y:t-f/2,width:g,height:f}),{el:i,group:r});return n},_=[_(L-a,P-9,e(0,49),"sim-bb-blue"),_(L-a,15+P+9,e(1,49),"sim-bb-red"),_(O-a,R-9,e(0,0),"sim-bb-blue"),_(O-a,15+R+9,e(1,0),"sim-bb-red")];this.allPowerBars=this.allPowerBars.concat(_),this.allPowerBars.forEach(e=>this.bb.appendChild(e.el));let y=this.allPins.map(e=>e.group).filter((e,t,r)=>r.indexOf(e)==t),b=y.map(e=>F.svg.elt("g")),v=(b.forEach(e=>F.U.addClass(e,"sim-bb-pin-group")),b.forEach((e,t)=>F.U.addClass(e,"group-"+y[t])),{}),T=(y.forEach((e,t)=>v[e]=b[t]),{}),k=(this.allPins.forEach((e,t)=>{var r=e.group;(T[r]||(T[r]=[])).push(e)}),y.forEach(e=>{var t=T[e],[t,r]=[t.map(e=>e.cx),t.map(e=>e.cy)],n=e=>e.reduce((e,t)=>e<t?e:t),i=e=>e.reduce((e,t)=>t<e?e:t),[t,n,i,r]=[n(t),i(t),n(r),i(r)],s=F.svg.elt("rect"),n=Math.max(n-t,1e-4),r=Math.max(r-i,1e-4);F.svg.hydrate(s,{x:t,y:i,width:n,height:r}),F.U.addClass(s,"sim-bb-group-wire"),v[e].appendChild(s)}),this.allPins.forEach(e=>{var t=v[e.group];t.appendChild(e.el),t.appendChild(e.hoverEl)}),F.svg.elt("g"));F.svg.hydrate(k,{class:"sim-bb-group-misc"}),b.push(k),this.allLabels.forEach(e=>{var t;(e.group?((t=v[e.group]).appendChild(e.el),t):(k.appendChild(e.el),k)).appendChild(e.hoverEl)}),b.forEach(e=>this.bb.appendChild(e))}getSVGAndSize(){return{el:this.bb,y:0,x:0,w:S,h:C}}highlightLoc(e){var{row:e,col:t}=e,{}=this.rowColToPin[e][t];this.rowColToLbls[e][t].forEach(e=>{F.U.addClass(e.el,"highlight"),F.U.addClass(e.hoverEl,"highlight")})}}}})(pxsim=pxsim||{}),(g=>{{var f=g.visuals||(g.visuals={});f.BOARD_SYTLE=`
        .noselect {
            -webkit-touch-callout: none; /* iOS Safari */
            -webkit-user-select: none;   /* Chrome/Safari/Opera */
            -khtml-user-select: none;    /* Konqueror */
            -moz-user-select: none;      /* Firefox */
            -ms-user-select: none;       /* Internet Explorer/Microsoft Edge */
            user-select: none;           /* Non-prefixed version, currently
                                            not supported by any browser */
        }

        .sim-board-pin {
            fill:#999;
            stroke:#000;
            stroke-width:${f.PIN_DIST/3}px;
        }
        .sim-board-pin-lbl {
            fill: #333;
        }
        .gray-cover {
            fill:#FFF;
            opacity: 0.3;
            stroke-width:0;
            visibility: hidden;
        }
        .sim-board-pin-hover {
            visibility: hidden;
            pointer-events: all;
            stroke-width:${f.PIN_DIST/6}px;
        }
        .sim-board-pin-hover:hover {
            visibility: visible;
        }
        .sim-board-pin-lbl {
            visibility: hidden;
        }
        .sim-board-outline .sim-board-pin-lbl {
            visibility: visible;
        }
        .sim-board-pin-lbl {
            fill: #555;
        }
        .sim-board-pin-lbl-hover {
            fill: red;
        }
        .sim-board-outline .sim-board-pin-lbl-hover {
            fill: black;
        }
        .sim-board-pin-lbl,
        .sim-board-pin-lbl-hover {
            font-family:"Lucida Console", Monaco, monospace;
            pointer-events: all;
            stroke-width: 0;
        }
        .sim-board-pin-lbl-hover {
            visibility: hidden;
        }
        .sim-board-outline .sim-board-pin-hover:hover + .sim-board-pin-lbl,
        .sim-board-pin-lbl.highlight {
            visibility: hidden;
        }
        .sim-board-outline .sim-board-pin-hover:hover + * + .sim-board-pin-lbl-hover,
        .sim-board-pin-lbl-hover.highlight {
            visibility: visible;
        }
        /* Graying out */
        .grayed .sim-board-pin-lbl:not(.highlight) {
            fill: #AAA;
        }
        .grayed .sim-board-pin:not(.highlight) {
            fill:#BBB;
            stroke:#777;
        }
        .grayed .gray-cover {
            visibility: inherit;
        }
        .grayed .sim-cmp:not(.notgrayed) {
            opacity: 0.3;
        }
        /* Highlighting */
        .sim-board-pin-lbl.highlight {
            fill: #000;
            font-weight: bold;
        }
        .sim-board-pin.highlight {
            fill:#999;
            stroke:#000;
        }
        `;let h=.7*f.PIN_DIST,m=1.5*h,r=.66666*f.PIN_DIST,n=.66666*f.PIN_DIST+f.PIN_DIST/3,i=0;class e{constructor(e){this.props=e,this.allPins=[],this.allLabels=[],this.pinNmToLbl={},this.pinNmToPin={},this.id=i++;let s=e.visualDef;var t=e.wireframe&&s.outlineImage?s.outlineImage:s.image,t=f.mkImageSVG({image:t,width:s.width,height:s.height,imageUnitDist:s.pinDist,targetUnitDist:f.PIN_DIST});let a=f.mkScaleFn(s.pinDist,f.PIN_DIST);this.width=t.w,this.height=t.h;t=t.el;this.element=g.svg.elt("svg"),g.svg.hydrate(this.element,{version:"1.0",viewBox:`0 0 ${this.width} `+this.height,class:"sim sim-board-id-"+this.id,x:"0px",y:"0px"}),e.wireframe&&g.U.addClass(this.element,"sim-board-outline"),this.style=g.svg.child(this.element,"style",{}),this.style.textContent+=f.BOARD_SYTLE,this.defs=g.svg.child(this.element,"defs",{}),this.g=g.svg.elt("g"),this.element.appendChild(this.g),this.g.appendChild(t),this.background=t,g.svg.hydrate(t,{class:"sim-board"});let o=()=>{var e=g.svg.elt("circle"),t=r;return g.svg.hydrate(e,{class:"sim-board-pin",r:t/2}),{el:e,w:t,h:t,x:0,y:0}},l=()=>{var e=g.svg.elt("circle"),t=n;return g.svg.hydrate(e,{class:"sim-board-pin-hover",r:t/2}),{el:e,w:t,h:t,x:0,y:0}},c=()=>{var e=g.svg.elt("rect"),t=r;return g.svg.hydrate(e,{class:"sim-board-pin",width:t,height:t}),{el:e,w:t,h:t,x:0,y:0}},u=()=>{var e=g.svg.elt("rect"),t=n;return g.svg.hydrate(e,{class:"sim-board-pin-hover",width:t,height:t}),{el:e,w:t,h:t,x:0,y:0}};e=s.pinBlocks.map((t,e)=>{var r=a(t.x)+f.PIN_DIST/2,n=a(t.y)+f.PIN_DIST/2,i=t.labels.length,r=f.mkGrid({xOffset:r,yOffset:n,rowCount:1,colCount:i,pinDist:f.PIN_DIST,mkPin:s.useCrocClips?o:c,mkHoverPin:s.useCrocClips?l:u,getRowName:()=>""+(e+1),getColName:e=>t.labels[e],getGroupName:()=>t.labels.join(" ")});r.allPins;return g.U.addClass(r.g,"sim-board-pin-group"),r});let d=[],p=(e.forEach((e,r)=>e.allPins.forEach((e,t)=>{this.allPins.push(e),d.push(s.pinBlocks[r])})),this.allPins.forEach(e=>{var t=e.col;g.svg.hydrate(e.el,{title:t}),g.svg.hydrate(e.hoverEl,{title:t})}),this.allPins.forEach(e=>{this.pinNmToPin[e.col]=e}),(e,t,r,n,i)=>{let s,a;s="below"===i?(i=.25*r*n.length,a=e,t+12+i):(i=.32*r*n.length,a=e,t-11-i);e=f.mkTxt(a,s,r,-90,n);return e});this.allLabels=this.allPins.map((e,t)=>{var r,n,i,t=d[t];return r=e.cx,n=e.cy,e=e.col,t=t.labelPosition||"above",i=p(r,n,h,e,t),g.U.addClass(i,"sim-board-pin-lbl"),r=p(r,n,m,e,t),g.U.addClass(r,"sim-board-pin-lbl-hover"),n={el:i,hoverEl:r,txt:e}}),this.allPins.forEach((e,t)=>{t=this.allLabels[t];this.pinNmToLbl[e.col]=t}),this.allPins.forEach((e,t)=>{t=this.allLabels[t];this.g.appendChild(e.el),this.g.appendChild(e.hoverEl),this.g.appendChild(t.el),this.g.appendChild(t.hoverEl)})}findPin(e){let t=this.pinNmToPin[e];return t=!t&&this.props.boardDef.gpioPinMap&&(e=this.props.boardDef.gpioPinMap[e])?this.pinNmToPin[e]:t}findPinLabel(e){let t=this.pinNmToLbl[e];return t=!t&&this.props.boardDef.gpioPinMap&&(e=this.props.boardDef.gpioPinMap[e])?this.pinNmToLbl[e]:t}getCoord(e){e=this.findPin(e);return e?[e.cx,e.cy]:null}mkGrayCover(e,t,r,n){var i=g.svg.elt("rect");return g.svg.hydrate(i,{x:e,y:t,width:r,height:n,class:"gray-cover"}),i}getView(){return{el:this.element,w:this.width,h:this.height,x:0,y:0}}getPinDist(){return f.PIN_DIST}highlightPin(e){var t=this.findPinLabel(e),e=this.findPin(e);t&&e&&(g.U.addClass(t.el,"highlight"),g.U.addClass(t.hoverEl,"highlight"),g.U.addClass(e.el,"highlight"),g.U.addClass(e.hoverEl,"highlight"))}}f.GenericBoardSvg=e}})(pxsim=pxsim||{}),(t=>{var r=t.visuals||(t.visuals={});function n(e){return r.mkImageSVG({image:e.image,width:e.width,height:e.height,imageUnitDist:e.pinDistance,targetUnitDist:r.PIN_DIST})}r.mkGenericPartSVG=n,r.GenericPart=class{constructor(e){this.style="",this.defs=[];e=n(e).el;this.element=t.svg.elt("g"),this.element.appendChild(e)}moveToCoord(e){r.translateEl(this.element,e)}init(e,t,r){}updateState(){}updateTheme(){}}})(pxsim=pxsim||{}),(g=>{var e;{var f=g.visuals||(g.visuals={});let a=f.PIN_DIST/2.5;function _(e){return e.replace(/\#/g,"-").replace(/\(/g,"-").replace(/\)/g,"-").replace(/\,/g,"-").replace(/\./g,"-").replace(/\s/g,"")}function y(e,t,r,n){var i=e=>e[0]+", "+e[1],[s,a]=e,[o,l]=t,c=l-a,e=g.svg.mkPath("sim-bb-wire",`M${i(e)} C${i([s,a+c*r])} ${i([o,l-c*r])} `+i(t));return g.U.addClass(e,"wire-stroke-"+n),e}function b(e,t,r){var n=e=>e[0]+", "+e[1],e=g.svg.mkPath("sim-bb-wire",`M${n(e)} L`+n(t));return g.U.addClass(e,"wire-stroke-"+r),e}function v(e,t){var r=f.PIN_DIST/4,n=g.svg.elt("circle"),i=e[0],e=e[1],s=a/2+r/2;return g.svg.hydrate(n,{cx:i,cy:e,r:s,class:"sim-bb-wire-end"}),g.U.addClass(n,"wire-fill-"+t),n.style["stroke-width"]=r+"px",n}function o(e,t){var r=.24*f.PIN_DIST,n=10*r,i=2*r,s=6*r,a=f.PIN_DIST/4,[e,o]=e,t=t?-1:1,l=g.svg.elt("g"),c=g.svg.elt("rect"),u=e-i/2,d=o-n/2,p=(g.svg.hydrate(c,{x:u,y:d,width:i,height:n,rx:.5,ry:.5,class:"sim-bb-wire-end"}),c.style["stroke-width"]=a+"px",g.svg.elt("rect")),o=o+t*(n/2+s/2)-s/2;return g.svg.hydrate(p,{x:e-r/2,y:o,width:r,height:s,class:"sim-bb-wire-bare-end"}),p.style.fill="#bbb",l.appendChild(p),l.appendChild(c),{el:l,x:u-a,y:Math.min(d,o),w:i+2*a,h:n+s}}function T(e,t){var r=.24*f.PIN_DIST,n=4*r,i=10*r,s=3.5*r,r=3.5*r,a=f.PIN_DIST/4,[e,o]=e,l=t?-1:1,c=g.svg.elt("g"),u=g.svg.elt("polygon"),d=e-n/2,p=o-i/2;var h=t?.15:.3,m=t?.7:1-.7,t=t?.3:.15,h=(g.svg.hydrate(u,{points:[[d+n*h,p],[d+n*(1-h),p],[d+n,p+i*m],[d+n*(1-t),p+i],[d+n*t,p+i],[d,p+i*m]].map(e=>e[0]+","+e[1]).join(" ")}),g.svg.hydrate(u,{rx:.5,ry:.5,class:"sim-bb-wire-end"}),u.style["stroke-width"]=a+"px",g.svg.elt("rect")),t=s,m=o+l*(i/2+t/2)-t/2;return g.svg.hydrate(h,{x:e-r/2,y:m,width:r,height:t,class:"sim-bb-wire-bare-end"}),c.appendChild(h),c.appendChild(u),{el:c,x:d-a,y:Math.min(p,m),w:n+2*a,h:i+t}}f.WIRES_CSS=`
        .sim-bb-wire {
            fill:none;
            stroke-linecap: round;
            stroke-width:${a}px;
            pointer-events: none;
        }
        .sim-bb-wire-end {
            stroke:#333;
            fill:#333;
        }
        .sim-bb-wire-bare-end {
            fill: #ccc;
        }
        .sim-bb-wire-hover {
            stroke-width: ${a}px;
            visibility: hidden;
            stroke-dasharray: ${f.PIN_DIST/10},${f.PIN_DIST/1.5};
            /*stroke-opacity: 0.4;*/
        }
        .grayed .sim-bb-wire-ends-g:not(.highlight) .sim-bb-wire-end {
            stroke: #777;
            fill: #777;
        }
        .grayed .sim-bb-wire:not(.highlight) {
            stroke: #CCC;
        }
        .sim-bb-wire-ends-g:hover .sim-bb-wire-end {
            stroke: red;
            fill: red;
        }
        .sim-bb-wire-ends-g:hover .sim-bb-wire-bare-end {
            stroke: #FFF;
            fill: #FFF;
        }
        `,(e=f.WireEndStyle||(f.WireEndStyle={}))[e.BBJumper=0]="BBJumper",e[e.OpenJumper=1]="OpenJumper",e[e.Croc=2]="Croc",f.mkWirePart=function(e,t,r=!1){var n=g.svg.elt("g"),[e,i]=e,s=[e-15,i-50],e=[e+15,i+50];t=f.mapWireColor(t);let a;return a=(r?T:o)(s,!0,t),i=((e,t,r)=>{let n=e=>e[0]+", "+e[1],[i,s]=e,[a,o]=t,l=o-s,c=[i,s+.8*l],u=[a,o-.8*l],d=g.svg.mkPath("sim-bb-wire",`M${n(e)} C${n(c)} ${n(u)} `+n(t));return d.style.stroke=r,{el:d,x:Math.min(i,a),y:Math.min(s,o),w:Math.abs(i-a),h:Math.abs(s-o)}})(s,e,t),r=o(e,!1),n.appendChild(i.el),n.appendChild(a.el),n.appendChild(r.el),s=Math.min(a.x,r.x),e=Math.max(a.x+a.w,r.x+r.w),t=Math.min(a.y,r.y),{el:n,x:s,y:t,w:e-s,h:Math.max(a.y+a.h,r.y+r.h)-t}};class t{constructor(e,t,r,n,i,s){this.nextWireId=0,this.styleEl=n,this.styleEl.textContent+=f.WIRES_CSS,this.underboard=e,this.overboard=t,this.boardEdges=r,this.getLocCoord=i,this.getPinStyle=s}indexOfMin(t){let r=0,n=t[0];for(let e=1;e<t.length;e++)t[e]<n&&(n=t[e],r=e);return r}closestEdgeIdx(t){var e=this.boardEdges.map(e=>Math.abs(t[1]-e));return this.indexOfMin(e)}closestEdge(e){return this.boardEdges[this.closestEdgeIdx(e)]}drawWire(n,i,e){var s=[],a=g.svg.child(this.overboard,"g",{class:"sim-bb-wire-group"}),o=e=>{var t=f.PIN_DIST/2,r=this.closestEdge(e);let n;return n=r-e[1]<0?r-t:r+t,[e[0],n]},l=this.nextWireId++,c=_(e),t=v(n,c),r=v(i,c),u=g.svg.child(a,"g",{class:"sim-bb-wire-ends-g"}),d=(u.appendChild(t),u.appendChild(r),this.closestEdgeIdx(n)),p=this.closestEdgeIdx(i);if(d==p){var h=b(n,i,c);a.appendChild(h),s.push(h)}else{h=o(n),o=o(i),n=b(n,h,c),i=b(i,o,c);let e,t,r=(t=!(1!=d&&2!=d||1!=p&&2!=p)?(e=y(h,o,.7,c),y(h,o,.7,c)):(e=b(h,o,c),b(h,o,c)),g.U.addClass(t,"sim-bb-wire-hover"),a.appendChild(n),s.push(n),a.appendChild(i),s.push(i),this.underboard.appendChild(e),s.push(e),a.appendChild(t),s.push(t),"sim-bb-wire-id-"+l);d=e=>g.U.addClass(e,r);d(u),d(t),this.styleEl.textContent+=`
                    .${r}:hover ~ .${r}.sim-bb-wire-hover {
                        visibility: visible;
                    }`}p=`
                .wire-stroke-${c} {
                    stroke: ${f.mapWireColor(e)};
                }
                .wire-fill-${c} {
                    fill: ${f.mapWireColor(e)};
                }
                `;return this.styleEl.textContent+=p,{endG:u,end1:t,end2:r,wires:s}}drawWireWithCrocs(n,i,e,s=!1){var a=[],o=g.svg.child(this.overboard,"g",{class:"sim-bb-wire-group"}),l=e=>{var t=f.PIN_DIST/2,r=this.closestEdge(e);let n;return n=r-e[1]<0?r-t:r+t,[e[0],n]},c=this.nextWireId++,u=_(e),t=v(n,u),d=i,[p,r]=i,p=([p,r]=i=[p,r+40],[p,r+-17]);let h;r=(h=(s?(e,t)=>{var r=.24*f.PIN_DIST,n=4*r,i=1.2*r,s=10*r,a=f.PIN_DIST/4,[e,o]=e,t=t?-1:1,l=g.svg.elt("g"),c=g.svg.elt("rect"),u=e-i/2,d=o+10-n/2,p=(g.svg.hydrate(c,{x:u,y:d,width:i,height:n,rx:.5,ry:.5,class:"sim-bb-wire-end"}),c.style["stroke-width"]=a+"px",g.svg.elt("rect")),o=o+10+t*(n/2+s/2)-s/2;return g.svg.hydrate(p,{x:e-r/2,y:o,width:r,height:s,class:"sim-bb-wire-bare-end"}),p.style.fill="#bbb",l.appendChild(p),l.appendChild(c),{el:l,x:u-a,y:Math.min(d,o),w:i+2*a,h:n+s}}:T)(p,!0)).el,s=g.svg.child(o,"g",{class:"sim-bb-wire-ends-g"}),s.appendChild(t),p=this.closestEdgeIdx(n),d=this.closestEdgeIdx(d);if(p==d){var m=b(n,i,u);o.appendChild(m),a.push(m)}else{m=l(n),l=b(n,m,u);let e,t,r=(t=!(1!=p&&2!=p||1!=d&&2!=d)?(e=y(m,i,.7,u),y(m,i,.7,u)):(e=b(m,i,u),b(m,i,u)),g.U.addClass(t,"sim-bb-wire-hover"),o.appendChild(l),a.push(l),this.underboard.appendChild(e),a.push(e),"sim-bb-wire-id-"+c);n=e=>g.U.addClass(e,r);n(s),n(t),this.styleEl.textContent+=`
                    .${r}:hover ~ .${r}.sim-bb-wire-hover {
                        visibility: visible;
                    }`}s.appendChild(r);p=`
                .wire-stroke-${u} {
                    stroke: ${f.mapWireColor(e)};
                }
                .wire-fill-${u} {
                    fill: ${f.mapWireColor(e)};
                }
                `;return this.styleEl.textContent+=p,{endG:s,end1:t,end2:r,wires:a}}checkWire(e,t){e=this.getLocCoord(e),t=this.getLocCoord(t);return!!e&&!!t}addWire(e,t,r){var n=this.getLocCoord(e),i=this.getLocCoord(t);if(n&&i){var s=this.getPinStyle(t);let e;return e="dalboard"==t.type&&"croc"==s?this.drawWireWithCrocs(n,i,r):this.drawWire(n,i,r)}g.debug(`unable to allocate wire for ${e} or `+t)}}f.WireFactory=t}})(pxsim=pxsim||{}),!function n(i,s,a){function o(t,e){if(!s[t]){if(!i[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(l)return l(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}r=s[t]={exports:{}},i[t][0].call(r.exports,function(e){return o(i[t][1][e]||e)},r,r.exports,n,i,s,a)}return s[t].exports}for(var l="function"==typeof require&&require,e=0;e<a.length;e++)o(a[e]);return o}({1:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.BlockDragger=void 0;let o=e("blockly");class n extends o.dragging.Dragger{onDrag(e,t){super.onDrag(e,t);var r,n,i,t=document.getElementsByClassName("blocklyToolbox")[0],s=document.getElementsByClassName("blocklyTreeRoot")[0]||document.getElementsByClassName("blocklyFlyout")[0],a=document.getElementById("blocklyTrashIcon");s&&a&&(r=s.getBoundingClientRect(),n=s.getBoundingClientRect(),i=e.clientX,i=Math.abs(i-(n.left+n.width/2)),(n=o.Gesture.inProgress())&&i<200||!n&&e.clientX-(r.left+r.width)<0?(a.style.opacity=""+(1-(n=i/200)),a.style.display="block",t&&(s.style.opacity=""+n,i<50)&&pxt.BrowserUtils.addClass(t,"blocklyToolboxDeleting")):(a.style.display="none",s.style.opacity="1",t&&pxt.BrowserUtils.removeClass(t,"blocklyToolboxDeleting")))}onDragEnd(e){super.onDragEnd(e);var e=document.getElementsByClassName("blocklyToolbox")[0],t=document.getElementsByClassName("blocklyTreeRoot")[0]||document.getElementsByClassName("blocklyFlyout")[0],r=document.getElementById("blocklyTrashIcon");r&&t&&(r.style.display="none",t.style.opacity="1",e)&&pxt.BrowserUtils.removeClass(e,"blocklyToolboxDeleting")}}r.BlockDragger=n},{blockly:175}],2:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.BreakpointIcon=void 0;let n=e("blockly");class i extends n.icons.Icon{constructor(e,t){super(e),this.onStateChange=t,this.isSet_=!1}getType(){return i.type}initView(e){super.initView(e),this.breakpointSvg||(this.breakpointSvg=n.utils.dom.createSvgElement("circle",{class:"blocklyBreakpointSymbol",stroke:"white","stroke-width":2,cx:7,cy:11.5,r:8},this.svgRoot),this.updateColor())}getSize(){return new n.utils.Size(25,25)}onClick(){this.isSet_=!this.isSet_,this.updateColor(),this.onStateChange(this.sourceBlock,this.isSet_)}isEnabled(){return this.isSet_}setEnabled(e){this.isSet_=e,this.updateColor()}updateColor(){this.breakpointSvg&&this.breakpointSvg.setAttribute("fill",this.isSet_?"#FF0000":"#CCCCCC")}}(r.BreakpointIcon=i).type=new n.icons.IconType("breakpoint")},{blockly:175}],3:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.initFunctions=void 0;let p=e("blockly"),d=e("../help"),h=e("../plugins/functions"),u=e("../toolbox"),m=e("../fields"),g=e("../loader"),f=e("../importer"),_=e("../fields/field_imagenotext");function y(a,e){if(!e)return[];let t=[];pxt.appTarget.appTheme.hideFlyoutHeadings||(e=(0,u.createFlyoutHeadingLabel)(lf("Functions"),pxt.toolbox.getNamespaceColor("functions"),pxt.toolbox.getNamespaceIcon("functions"),"blocklyFlyoutIconfunctions"),t.push(e));let r=lf("Make a Function..."),n=lf("New function name:");e=p.utils.xml.createElement("button");e.setAttribute("text",r),e.setAttribute("callbackKey","CREATE_FUNCTION");a.registerButtonCallback("CREATE_FUNCTION",function(e){let t=e=>{p.dialog.prompt(n,e,function(e){pxt.tickEvent("blocks.makeafunction"),(e=e&&(e=e.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""))==r?null:e)&&(a.getVariableMap().getVariable(e)?p.dialog.alert(p.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",e.toLowerCase()),function(){t(e)}):p.Procedures.isNameUsed(e,a)?(e=>{var t=a.getTopBlocks(!0)[0];let r=10,n=10;t&&(i=t.getRelativeToSurfaceXY(),r=i.x+p.SNAP_RADIUS*(t.RTL?-1:1),n=i.y+2*p.SNAP_RADIUS);var t=p.utils.xml.createElement("xml"),i=p.utils.xml.createElement("block"),s=(i.setAttribute("type","procedures_defnoreturn"),i.setAttribute("x",String(r)),i.setAttribute("y",String(n)),p.utils.xml.createElement("field")),e=(s.setAttribute("name","NAME"),s.appendChild(document.createTextNode(e)),i.appendChild(s),t.appendChild(i),(0,f.domToWorkspaceNoEvents)(t,a)),s=(p.hideChaff(),a.getBlockById(e[0]));s.select(),a.centerOnBlock(s.id,!0)})(e):p.dialog.alert(p.Msg.PROCEDURE_ALREADY_EXISTS.replace("%1",e.toLowerCase()),function(){t(e)}))})};t("doSomething")}),t.push(e);var i=p.Procedures.allProcedures(a)[0],s="procedures_callnoreturn";for(let e=0;e<i.length;e++){var o=i[e][0],l=(i[e][1],p.utils.xml.createElement("block")),c=(l.setAttribute("type",s),l.setAttribute("gap","16"),l.setAttribute("colour",pxt.toolbox.getNamespaceColor("functions")),p.utils.xml.createElement("field"));c.textContent=o,c.setAttribute("name","NAME"),l.appendChild(c),t.push(l)}return t}r.initFunctions=function(){var e,t,r=p.Msg,n=(r.FUNCTION_CREATE_NEW=lf("Make a Function..."),r.FUNCTION_WARNING_DUPLICATE_ARG=lf("Functions cannot use the same argument name more than once."),r.FUNCTION_WARNING_ARG_NAME_IS_FUNCTION_NAME=lf("Argument names must not be the same as the function name."),r.FUNCTION_WARNING_EMPTY_NAME=lf("Function and argument names cannot be empty."),r.FUNCTIONS_DEFAULT_FUNCTION_NAME=lf("doSomething"),r.FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME=lf("bool"),r.FUNCTIONS_DEFAULT_STRING_ARG_NAME=lf("text"),r.FUNCTIONS_DEFAULT_NUMBER_ARG_NAME=lf("num"),r.FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME=lf("arg"),r.FUNCTION_FLYOUT_LABEL=lf("Your Functions"),r.FUNCTIONS_CREATE_CALL_OPTION=lf("Create 'call {0}'","%1"),r.FUNCTIONS_DEFNORETURN_TITLE=lf("function"),r.PROCEDURES_HUE=pxt.toolbox.getNamespaceColor("functions"),r.REPORTERS_HUE=pxt.toolbox.getNamespaceColor("variables"),"procedures_defnoreturn"),i=pxt.blocks.getBlockDefinition(n),n=(r.PROCEDURES_DEFNORETURN_TITLE=i.block.PROCEDURES_DEFNORETURN_TITLE,r.PROCEDURE_ALREADY_EXISTS=i.block.PROCEDURE_ALREADY_EXISTS,p.Blocks.procedures_defnoreturn.init=function(){var e=new p.FieldTextInput("",p.Procedures.rename);this.appendDummyInput().appendField(p.Msg.PROCEDURES_DEFNORETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.setColour(pxt.toolbox.getNamespaceColor("functions")),this.arguments_=[],this.argumentVarModels_=[],this.hat="cap",this.setStatements_(!0),this.statementConnection_=null},(0,d.installBuiltinHelpInfo)(n),"procedures_callnoreturn");let s=pxt.blocks.getBlockDefinition(n),a=(r.PROCEDURES_CALLRETURN_TOOLTIP=i.tooltip.toString(),p.Blocks.procedures_callnoreturn={init:function(){var e=new m.FieldProcedure("");this.appendDummyInput("TOPROW").appendField(s.block.PROCEDURES_CALLNORETURN_TITLE).appendField(e,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setColour(pxt.toolbox.getNamespaceColor("functions")),this.arguments_=[],this.quarkConnections_={},this.quarkIds_=null},getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(e,t){p.Names.equals(e,this.getProcedureCall())&&this.setFieldValue(t,"NAME")},onchange:function(t){if(this.workspace&&!this.workspace.isFlyout&&!this.isInsertionMarker())if(t.type==p.Events.CREATE&&-1!=t.ids.indexOf(this.id)){var r,n,i=this.getProcedureCall();let e=p.Procedures.getDefinition(i,this.workspace);(e=!e||e.type==this.defType_&&JSON.stringify(e.arguments_)==JSON.stringify(this.arguments_)?e:null)||(p.Events.setGroup(t.group),i=p.utils.xml.createElement("xml"),(r=p.utils.xml.createElement("block")).setAttribute("type",this.defType_),n=(s=this.getRelativeToSurfaceXY()).x+p.SNAP_RADIUS*(this.RTL?-1:1),s=s.y+2*p.SNAP_RADIUS,r.setAttribute("x",n),r.setAttribute("y",s),(n=p.utils.xml.createElement("field")).setAttribute("name","NAME"),n.appendChild(document.createTextNode(this.getProcedureCall())),r.appendChild(n),i.appendChild(r),(0,f.domToWorkspaceNoEvents)(i,this.workspace),p.Events.setGroup(!1))}else{var s;t.type==p.Events.DELETE&&(s=this.getProcedureCall(),p.Procedures.getDefinition(s,this.workspace)||(p.Events.setGroup(t.group),this.dispose(!0,!1),p.Events.setGroup(!1)))}},mutationToDom:function(){var e=document.createElement("mutation");return e.setAttribute("name",this.getProcedureCall()),e},domToMutation:function(e){e=e.getAttribute("name");this.renameProcedure(this.getProcedureCall(),e)},customContextMenu:function(e){var t={enabled:!0};t.text=p.Msg.PROCEDURES_HIGHLIGHT_DEF;let r=this.getProcedureCall(),n=this.workspace;t.callback=function(){var e=p.Procedures.getDefinition(r,n);e&&e.select()},e.push(t)},defType_:"procedures_defnoreturn"},(0,d.installBuiltinHelpInfo)(n),"function_definition"),o=(i=pxt.blocks.getBlockDefinition(a),r.FUNCTIONS_EDIT_OPTION=i.block.FUNCTIONS_EDIT_OPTION,(0,d.installBuiltinHelpInfo)(a),n="function_call",i=pxt.blocks.getBlockDefinition(n),r.FUNCTIONS_CALL_TITLE=i.block.FUNCTIONS_CALL_TITLE,r.FUNCTIONS_GO_TO_DEFINITION_OPTION=i.block.FUNCTIONS_GO_TO_DEFINITION_OPTION,(0,d.installBuiltinHelpInfo)(n),(0,d.installBuiltinHelpInfo)("function_call_output"),"function_return"),l=(p.Blocks[o]={init:function(){{var o=this;let r=pxt.blocks.getBlockDefinition("function_return"),n="0_add_button",i="0_rem_button",s=(p.Extensions.apply("inline-svgs",o,!1),!0),a;function l(){var e,t=o.getInput("RETURN_VALUE");if(s){if(!t){for(;o.getInput("");)o.removeInput("");o.jsonInit({message0:r.block.message_with_value,args0:[{type:"input_value",name:"RETURN_VALUE",check:null}],previousStatement:null,colour:pxt.toolbox.getNamespaceColor("functions")})}o.getInput(n)&&o.removeInput(n),o.getInput(i)||d(i,o.REMOVE_IMAGE_DATAURI,lf("Remove return value")),a&&((e=o.workspace.getBlockById(a))&&e.outputConnection&&!e.outputConnection.targetBlock()&&o.getInput("RETURN_VALUE").connection.connect(e.outputConnection),a=void 0)}else t&&((e=t.connection.targetBlock())&&(e.isShadow()&&e.setShadow(!1),t.connection.disconnect(),a=e.id),o.removeInput("RETURN_VALUE"),o.jsonInit({message0:r.block.message_no_value,args0:[],previousStatement:null,colour:pxt.toolbox.getNamespaceColor("functions")})),o.getInput(i)&&o.removeInput(i),o.getInput(n)||d(n,o.ADD_IMAGE_DATAURI,lf("Add return value"));o.setInputsInline(!0)}function c(){return p.Xml.domToText(o.mutationToDom())}function u(e,t){e!==t&&p.Events.fire(new p.Events.BlockChange(o,"mutation",null,e,t))}function d(e,t,r){o.appendDummyInput(e).appendField(new _.FieldImageNoText(t,24,24,r,()=>{var e=c(),t=(s=!s,c()),e=(u(e,t),l(),c());u(t,e)},!1))}l(),o.domToMutation=e=>{e.hasAttribute("last_connected_id")&&(a=e.getAttribute("last_connected_id")),s="true"!==e.getAttribute("no_return_value"),l()},o.mutationToDom=()=>{var e,t,r=document.createElement("mutation");return e=r,t=!!o.getInput("RETURN_VALUE"),e.setAttribute("no_return_value",t?"false":"true"),a&&r.setAttribute("last_connected_id",a),r}}},onchange:function(e){let t=this;var r,n;t.workspace&&!t.workspace.isFlyout&&(n=e.type===p.Events.BLOCK_CREATE&&-1!=e.ids.indexOf(t.id),r=e.type===p.Events.BLOCK_DRAG&&e.blocks.some(e=>e.id===t.id),n||r)&&(n=t.getRootBlock()).type!==o&&null==n.previousConnection&&n.type!==a&&(p.Events.setGroup(e.group),t.previousConnection.disconnect(),p.Events.setGroup(!1))}},(0,d.installBuiltinHelpInfo)(o),p.Procedures.flyoutCategory=y,{number:pxt.blocks.defaultIconForArgType("number"),boolean:pxt.blocks.defaultIconForArgType("boolean"),string:pxt.blocks.defaultIconForArgType("string"),Array:pxt.blocks.defaultIconForArgType("Array")}),c={};(r=pxt.appTarget.runtime&&pxt.appTarget.runtime.functionsOptions)&&r.extraFunctionEditorTypes&&r.extraFunctionEditorTypes.forEach(e=>{l[e.typeName]=e.icon||pxt.blocks.defaultIconForArgType(),e.defaultName&&(c[e.typeName]=e.defaultName)});for(e of Object.keys(l))h.FunctionManager.getInstance().setIconForType(e,l[e]);for(t of Object.keys(c))h.FunctionManager.getInstance().setArgumentNameForType(t,c[t]);p.Blocks.argument_reporter_custom&&(p.Blocks.argument_reporter_custom.domToMutation=function(e){e=e.getAttribute("typename");this.typeName_=e,(0,g.setOutputCheck)(this,e,g.cachedBlockInfo)});let u=p.Blocks.function_definition.makeCallOption;p.Blocks.function_definition.makeCallOption=function(){var e=u.call(this),t=this.getName();return e.text=pxt.Util.lf("Create 'call {0}'",t),e}}},{"../fields":70,"../fields/field_imagenotext":38,"../help":72,"../importer":73,"../loader":77,"../plugins/functions":111,"../toolbox":139,blockly:175}],4:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.initLists=void 0;let o=e("blockly"),l=e("../help"),c=e("../constants");r.initLists=function(){let e=o.Msg;var t="lists_create_with",r=pxt.blocks.getBlockDefinition(t),r=(e.LISTS_CREATE_EMPTY_TITLE=r.block.LISTS_CREATE_EMPTY_TITLE,e.LISTS_CREATE_WITH_INPUT_WITH=r.block.LISTS_CREATE_WITH_INPUT_WITH,e.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD=r.block.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD,e.LISTS_CREATE_WITH_ITEM_TITLE=r.block.LISTS_CREATE_WITH_ITEM_TITLE,(0,l.installBuiltinHelpInfo)(t),"lists_length"),t=pxt.blocks.getBlockDefinition(r);e.LISTS_LENGTH_TITLE=t.block.LISTS_LENGTH_TITLE,o.Blocks[r].init=function(){this.jsonInit({message0:e.LISTS_LENGTH_TITLE,args0:[{type:"input_value",name:"VALUE",check:["Array"]}],output:"Number",outputShape:c.provider.SHAPES.ROUND})},(0,l.installBuiltinHelpInfo)(r);let n="lists_index_get",i=pxt.blocks.getBlockDefinition(n),s=(o.Blocks.lists_index_get={init:function(){this.jsonInit({message0:i.block.message0,args0:[{type:"input_value",name:"LIST",check:"Array"},{type:"input_value",name:"INDEX",check:"Number"}],colour:pxt.toolbox.blockColors.arrays,outputShape:c.provider.SHAPES.ROUND,inputsInline:!0}),this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0),(0,l.setBuiltinHelpInfo)(this,n)}},"lists_index_set"),a=pxt.blocks.getBlockDefinition(s);o.Blocks[s]={init:function(){this.jsonInit({message0:a.block.message0,args0:[{type:"input_value",name:"LIST",check:"Array"},{type:"input_value",name:"INDEX",check:"Number"},{type:"input_value",name:"VALUE",check:null}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.blockColors.arrays,inputsInline:!0}),(0,l.setBuiltinHelpInfo)(this,s)}}}},{"../constants":18,"../help":72,blockly:175}],5:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.initLogic=void 0;let i=e("blockly"),s=e("../help");r.initLogic=function(){var e=i.Msg,t="controls_if",r=(n=pxt.blocks.getBlockDefinition(t)).tooltip,n=(e.CONTROLS_IF_MSG_IF=n.block.CONTROLS_IF_MSG_IF,e.CONTROLS_IF_MSG_THEN=n.block.CONTROLS_IF_MSG_THEN,e.CONTROLS_IF_MSG_ELSE=n.block.CONTROLS_IF_MSG_ELSE,e.CONTROLS_IF_MSG_ELSEIF=n.block.CONTROLS_IF_MSG_ELSEIF,e.CONTROLS_IF_TOOLTIP_1=r.CONTROLS_IF_TOOLTIP_1,e.CONTROLS_IF_TOOLTIP_2=r.CONTROLS_IF_TOOLTIP_2,e.CONTROLS_IF_TOOLTIP_3=r.CONTROLS_IF_TOOLTIP_3,e.CONTROLS_IF_TOOLTIP_4=r.CONTROLS_IF_TOOLTIP_4,(0,s.installBuiltinHelpInfo)(t),"logic_compare"),r=pxt.blocks.getBlockDefinition(n).tooltip,t=(e.LOGIC_COMPARE_TOOLTIP_EQ=r.LOGIC_COMPARE_TOOLTIP_EQ,e.LOGIC_COMPARE_TOOLTIP_NEQ=r.LOGIC_COMPARE_TOOLTIP_NEQ,e.LOGIC_COMPARE_TOOLTIP_LT=r.LOGIC_COMPARE_TOOLTIP_LT,e.LOGIC_COMPARE_TOOLTIP_LTE=r.LOGIC_COMPARE_TOOLTIP_LTE,e.LOGIC_COMPARE_TOOLTIP_GT=r.LOGIC_COMPARE_TOOLTIP_GT,e.LOGIC_COMPARE_TOOLTIP_GTE=r.LOGIC_COMPARE_TOOLTIP_GTE,(0,s.installBuiltinHelpInfo)(n),"logic_operation"),n=(r=pxt.blocks.getBlockDefinition(t)).tooltip,r=(e.LOGIC_OPERATION_AND=r.block.LOGIC_OPERATION_AND,e.LOGIC_OPERATION_OR=r.block.LOGIC_OPERATION_OR,e.LOGIC_OPERATION_TOOLTIP_AND=n.LOGIC_OPERATION_TOOLTIP_AND,e.LOGIC_OPERATION_TOOLTIP_OR=n.LOGIC_OPERATION_TOOLTIP_OR,(0,s.installBuiltinHelpInfo)(t),"logic_negate"),n=pxt.blocks.getBlockDefinition(r),t=(e.LOGIC_NEGATE_TITLE=n.block.LOGIC_NEGATE_TITLE,(0,s.installBuiltinHelpInfo)(r),"logic_boolean"),n=pxt.blocks.getBlockDefinition(t);e.LOGIC_BOOLEAN_TRUE=n.block.LOGIC_BOOLEAN_TRUE,e.LOGIC_BOOLEAN_FALSE=n.block.LOGIC_BOOLEAN_FALSE,(0,s.installBuiltinHelpInfo)(t)}},{"../help":72,blockly:175}],6:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.initLoops=void 0;let g=e("blockly"),f=e("../help"),_=e("../plugins/duplicateOnDrag");r.initLoops=function(){var e=g.Msg,t="controls_repeat_ext",r=pxt.blocks.getBlockDefinition(t);e.CONTROLS_REPEAT_TITLE=r.block.CONTROLS_REPEAT_TITLE,e.CONTROLS_REPEAT_INPUT_DO=r.block.CONTROLS_REPEAT_INPUT_DO,(0,f.installBuiltinHelpInfo)(t);let n="device_while",i=pxt.blocks.getBlockDefinition(n),s=(g.Blocks[n]={init:function(){this.jsonInit({message0:i.block.message0,args0:[{type:"input_value",name:"COND",check:"Boolean"}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.getNamespaceColor("loops")}),this.appendStatementInput("DO").appendField(i.block.appendField),(0,f.setBuiltinHelpInfo)(this,n)}},"pxt_controls_for"),a=pxt.blocks.getBlockDefinition(s),o=(g.Blocks[s]={init:function(){this.jsonInit({message0:a.block.message0,args0:[{type:"input_value",name:"VAR",variable:a.block.variable,check:"Variable"},{type:"input_value",name:"TO",check:"Number"}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.getNamespaceColor("loops"),inputsInline:!0}),this.appendStatementInput("DO").appendField(a.block.appendField);let e=this;(0,f.setHelpResources)(this,s,a.name,function(){return pxt.U.rlf(a.tooltip,e.getInputTargetBlock("VAR")?e.getInputTargetBlock("VAR").getField("VAR").getText():"")},a.url,String(pxt.toolbox.getNamespaceColor("loops")))},getVars:function(){return[this.getField("VAR").getText()]},renameVar:function(e,t){var r=this.getField("VAR");g.Names.equals(e,r.getText())&&r.setValue(t)}},(0,_.setDuplicateOnDrag)(s,"VAR"),"controls_simple_for"),l=pxt.blocks.getBlockDefinition(o),c=(g.Blocks[o]={init:function(){this.jsonInit({message0:l.block.message0,args0:[{type:"field_variable",name:"VAR",variable:l.block.variable,variableTypes:[""]},{type:"input_value",name:"TO",check:"Number"}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.getNamespaceColor("loops"),inputsInline:!0}),this.appendStatementInput("DO").appendField(l.block.appendField);let e=this;(0,f.setHelpResources)(this,o,l.name,function(){return pxt.U.rlf(l.tooltip,e.getField("VAR").getText())},l.url,String(pxt.toolbox.getNamespaceColor("loops")))},getVars:function(){return[this.getField("VAR").getText()]},renameVar:function(e,t){var r=this.getField("VAR");g.Names.equals(e,r.getText())&&r.setValue(t)},customContextMenu:function(e){var t,r,n;this.isCollapsed()||null!=(t=null==(t=this.workspace)?void 0:t.options)&&t.readOnly||(t={enabled:!0},n=this.getField("VAR").getText(),t.text=lf("Create 'get {0}'",n),(r=g.utils.xml.createElement("field")).textContent=n,r.setAttribute("name","VAR"),(n=g.utils.xml.createElement("block")).setAttribute("type","variables_get"),n.appendChild(r),t.callback=g.ContextMenu.callbackFactory(this,n),e.push(t))}},pxt.blocks.getBlockDefinition(ts.pxtc.TS_BREAK_TYPE)),u=(g.Blocks[pxtc.TS_BREAK_TYPE]={init:function(){var e=pxt.toolbox.getNamespaceColor("loops");this.jsonInit({message0:c.block.message0,inputsInline:!0,previousStatement:null,nextStatement:null,colour:e}),(0,f.setHelpResources)(this,ts.pxtc.TS_BREAK_TYPE,c.name,c.tooltip,c.url,e,void 0,void 0,!1)}},pxt.blocks.getBlockDefinition(ts.pxtc.TS_CONTINUE_TYPE)),d=(g.Blocks[pxtc.TS_CONTINUE_TYPE]={init:function(){var e=pxt.toolbox.getNamespaceColor("loops");this.jsonInit({message0:u.block.message0,inputsInline:!0,previousStatement:null,nextStatement:null,colour:e}),(0,f.setHelpResources)(this,ts.pxtc.TS_CONTINUE_TYPE,u.name,u.tooltip,u.url,e,void 0,void 0,!1)}},g.Blocks[pxtc.COLLAPSED_BLOCK]={init:function(){this.jsonInit({message0:"...",inputsInline:!0,previousStatement:null,nextStatement:null,colour:"#cccccc"}),(0,f.setHelpResources)(this,ts.pxtc.COLLAPSED_BLOCK,"...",lf("a few blocks"),void 0,"#cccccc",void 0,void 0,!1)}},"pxt_controls_for_of"),p=pxt.blocks.getBlockDefinition(d),h=(g.Blocks[d]={init:function(){this.jsonInit({message0:p.block.message0,args0:[{type:"input_value",name:"VAR",variable:p.block.variable,check:"Variable"},{type:"input_value",name:"LIST",check:["Array","String"]}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.blockColors.loops,inputsInline:!0}),this.appendStatementInput("DO").appendField(p.block.appendField);let e=this;(0,f.setHelpResources)(this,d,p.name,function(){return pxt.Util.rlf(p.tooltip,e.getInputTargetBlock("VAR")?e.getInputTargetBlock("VAR").getField("VAR").getText():"")},p.url,String(pxt.toolbox.getNamespaceColor("loops")))}},(0,_.setDuplicateOnDrag)(d,"VAR"),"controls_for_of"),m=pxt.blocks.getBlockDefinition(h);g.Blocks[h]={init:function(){this.jsonInit({message0:m.block.message0,args0:[{type:"field_variable",name:"VAR",variable:m.block.variable,variableTypes:[""]},{type:"input_value",name:"LIST",check:"Array"}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.blockColors.loops,inputsInline:!0}),this.appendStatementInput("DO").appendField(m.block.appendField);let e=this;(0,f.setHelpResources)(this,h,m.name,function(){return pxt.Util.rlf(m.tooltip,e.getField("VAR").getText())},m.url,String(pxt.toolbox.getNamespaceColor("loops")))}}}},{"../help":72,"../plugins/duplicateOnDrag":91,blockly:175}],7:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.initMathRoundBlock=r.initMathOpBlock=r.initMath=void 0;let c=e("blockly"),u=e("../help"),d=e("../constants"),a=e("../composableMutations"),o=e("../fields/field_dropdown");function p(){let e=pxt.blocks.MATH_FUNCTIONS.unary.concat(pxt.blocks.MATH_FUNCTIONS.binary).concat(pxt.blocks.MATH_FUNCTIONS.infix);var t="math_js_op";let r=pxt.blocks.getBlockDefinition(t);function i(e,t){e=e.appendValueInput("ARG"+(t?1:0));e.setCheck("Number"),t&&(e.connection.setShadowDom((()=>{var e;return n||((n=document.createElement("shadow")).setAttribute("type","math_number"),(e=document.createElement("field")).setAttribute("name","NUM"),e.textContent="0",n.appendChild(e)),n})()),e.connection.respawnShadow_())}function s(e,t){var r=!!e.getInput("ARG1");t?(r&&e.moveInputBefore("op_dropdown","ARG1"),e.moveInputBefore("ARG0","op_dropdown")):(r&&e.moveInputBefore("ARG0","ARG1"),e.moveInputBefore("op_dropdown","ARG0"))}c.Blocks[t]={init:function(){let n=this;n.setPreviousStatement(!1),n.setNextStatement(!1),n.setOutput(!0,"Number"),n.setOutputShape(d.provider.SHAPES.ROUND),n.setInputsInline(!0),n.appendDummyInput("op_dropdown").appendField(new o.FieldDropdown(e.map(e=>[r.block[e],e]),e=>{var t=n;return(e=>-1!==pxt.blocks.MATH_FUNCTIONS.unary.indexOf(e))(e)?t.removeInput("ARG1",!0):t.getInput("ARG1")||i(t,!0),s(t,(e=>-1!==pxt.blocks.MATH_FUNCTIONS.infix.indexOf(e))(e)),e}),"OP"),i(n,!1),(0,a.appendMutation)(n,{mutationToDom:e=>{let t;for(let e=0;e<n.inputList.length;e++){var r=n.inputList[e];if("op_dropdown"===r.name){t=!1;break}if("ARG0"===r.name){t=!0;break}}return e.setAttribute("op-type",(n.getInput("ARG1")?t?"infix":"binary":"unary").toString()),e},domToMutation:e=>{e.hasAttribute("op-type")&&("unary"!=(e=e.getAttribute("op-type"))&&i(n,!0),s(n,"infix"===e))}})}},(0,u.installHelpResources)(t,r.name,function(e){return r.tooltip[e.getFieldValue("OP")]},r.url,pxt.toolbox.getNamespaceColor(r.category))}r.initMath=function(e){let t="math_op2",r=pxt.blocks.getBlockDefinition(t),n=r.tooltip,i=(c.Blocks[t]={init:function(){this.jsonInit({message0:lf("%1 of %2 and %3"),args0:[{type:"field_dropdown",name:"op",options:[[lf("{id:op}min"),"min"],[lf("{id:op}max"),"max"]]},{type:"input_value",name:"x",check:"Number"},{type:"input_value",name:"y",check:"Number"}],inputsInline:!0,output:"Number",outputShape:d.provider.SHAPES.ROUND,colour:pxt.toolbox.getNamespaceColor("math")}),(0,u.setHelpResources)(this,t,r.name,function(e){return n[e.getFieldValue("op")]},r.url,pxt.toolbox.getNamespaceColor(r.category))},codeCard:(0,u.attachCardInfo)(e,"Math.min")},"math_op3"),s=pxt.blocks.getBlockDefinition(i);c.Blocks[i]={init:function(){this.jsonInit({message0:s.block.message0,args0:[{type:"input_value",name:"x",check:"Number"}],inputsInline:!0,output:"Number",outputShape:d.provider.SHAPES.ROUND,colour:pxt.toolbox.getNamespaceColor("math")}),(0,u.setBuiltinHelpInfo)(this,i)},codeCard:(0,u.attachCardInfo)(e,"Math.abs")},["math_number","math_integer","math_whole_number","math_number_minmax"].forEach(e=>{var t=pxt.blocks.getBlockDefinition(e);(0,u.installHelpResources)(e,t.name,t.tooltip,t.url,"#fff","#fff","#fff")});var e=c.Msg,a="math_arithmetic",o=pxt.blocks.getBlockDefinition(a);let l=o.tooltip;e.MATH_ADDITION_SYMBOL=o.block.MATH_ADDITION_SYMBOL,e.MATH_SUBTRACTION_SYMBOL=o.block.MATH_SUBTRACTION_SYMBOL,e.MATH_MULTIPLICATION_SYMBOL=o.block.MATH_MULTIPLICATION_SYMBOL,e.MATH_DIVISION_SYMBOL=o.block.MATH_DIVISION_SYMBOL,e.MATH_POWER_SYMBOL=o.block.MATH_POWER_SYMBOL,(0,u.installHelpResources)(a,o.name,function(e){return l[e.getFieldValue("OP")]},o.url,pxt.toolbox.getNamespaceColor(o.category)),a="math_modulo",o=pxt.blocks.getBlockDefinition(a),e.MATH_MODULO_TITLE=o.block.MATH_MODULO_TITLE,(0,u.installBuiltinHelpInfo)(a),p(),h()},r.initMathOpBlock=p;let n;function h(){let t=pxt.blocks.ROUNDING_FUNCTIONS;var e="math_js_round";let r=pxt.blocks.getBlockDefinition(e);c.Blocks[e]={init:function(){this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0,"Number"),this.setOutputShape(d.provider.SHAPES.ROUND),this.setInputsInline(!0),this.appendDummyInput("round_dropdown").appendField(new o.FieldDropdown(t.map(e=>[r.block[e],e])),"OP");var e=this;(e=e.appendValueInput("ARG0")).setCheck("Number")}},(0,u.installHelpResources)(e,r.name,function(e){return r.tooltip[e.getFieldValue("OP")]},r.url,pxt.toolbox.getNamespaceColor(r.category))}r.initMathRoundBlock=h},{"../composableMutations":17,"../constants":18,"../fields/field_dropdown":34,"../help":72,blockly:175}],8:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.initOnStart=void 0;let n=e("blockly"),i=e("../fields"),a=e("../help");r.initOnStart=function(){let r=pxt.blocks.getBlockDefinition(ts.pxtc.ON_START_TYPE);if(n.Blocks[ts.pxtc.ON_START_TYPE]={init:function(){let e,t=null==(e=pxt.appTarget.runtime)?void 0:e.onStartColor;t=t&&pxt.toolbox.getAccessibleBackground(t),this.jsonInit({message0:r.block.message0,args0:[{type:"input_dummy"},{type:"input_statement",name:"HANDLER"}],colour:t||pxt.toolbox.getNamespaceColor("loops")}),(0,a.setHelpResources)(this,ts.pxtc.ON_START_TYPE,r.name,r.tooltip,r.url,t||pxt.toolbox.getNamespaceColor("loops"),void 0,void 0,!!pxt.appTarget.runtime&&pxt.appTarget.runtime.onStartUnDeletable)}},n.Blocks[pxtc.TS_STATEMENT_TYPE]={init:function(){let i=this;i.setColour("#717171"),i.setPreviousStatement(!0),i.setNextStatement(!0),i.setInputsInline(!1);let t,s;i.domToMutation=t=>{var r=parseInt(t.getAttribute("numlines"));i.declaredVariables=t.getAttribute("declaredvars"),s=[];for(let e=0;e<r;e++){var n=t.getAttribute("line"+e);s.push(n)}i.setPythonEnabled(!1)},i.mutationToDom=()=>{let r=document.createElement("mutation");return s&&(s.forEach((e,t)=>r.setAttribute("line"+t,e)),r.setAttribute("numlines",s.length.toString())),i.declaredVariables&&r.setAttribute("declaredvars",this.declaredVariables),r},i.setPythonEnabled=e=>{if(t!==e){for(;i.inputList.length;)i.removeInput(i.inputList[0].name);(t=e)?(i.appendDummyInput().appendField(pxt.Util.lf("<python code>"),"LINE0"),i.setTooltip(lf("A Python statement that could not be converted to blocks"))):(s.forEach((e,t)=>{i.appendDummyInput().appendField(e,"LINE"+t)}),i.setTooltip(lf("A JavaScript statement that could not be converted to blocks")))}},i.getLines=()=>s,i.setEditable(!1),(0,a.setHelpResources)(this,pxtc.TS_STATEMENT_TYPE,lf("JavaScript statement"),lf("A JavaScript statement that could not be converted to blocks"),"/blocks/javascript-blocks","#717171")}},n.Blocks[pxtc.TS_OUTPUT_TYPE]={init:function(){let t=this;t.setColour("#717171"),t.setPreviousStatement(!1),t.setNextStatement(!1),t.setOutput(!0),t.setEditable(!1),t.appendDummyInput().appendField(new i.FieldTsExpression(""),"EXPRESSION"),t.setPythonEnabled=e=>{t.getField("EXPRESSION").setPythonEnabled(e),e?t.setTooltip(lf("A Python expression that could not be converted to blocks")):t.setTooltip(lf("A JavaScript expression that could not be converted to blocks"))},(0,a.setHelpResources)(t,pxtc.TS_OUTPUT_TYPE,lf("JavaScript expression"),lf("A JavaScript expression that could not be converted to blocks"),"/blocks/javascript-blocks","#717171")}},pxt.appTarget.runtime&&pxt.appTarget.runtime.pauseUntilBlock){let t=pxt.appTarget.runtime.pauseUntilBlock,r=pxt.blocks.getBlockDefinition(ts.pxtc.PAUSE_UNTIL_TYPE);n.Blocks[pxtc.PAUSE_UNTIL_TYPE]={init:function(){var e=t.color||pxt.toolbox.getNamespaceColor("loops");this.jsonInit({message0:r.block.message0,args0:[{type:"input_value",name:"PREDICATE",check:"Boolean"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:e}),(0,a.setHelpResources)(this,ts.pxtc.PAUSE_UNTIL_TYPE,r.name,r.tooltip,r.url,e,void 0,void 0,!1)}}}}},{"../fields":70,"../help":72,blockly:175}],9:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.initText=void 0;let n=e("blockly"),i=e("../help"),s=e("../constants");r.initText=function(){var e=pxt.blocks.getBlockDefinition("text"),e=((0,i.installHelpResources)("text",e.name,e.tooltip,e.url,"#fff","#fff","#fff"),"text_length"),t=pxt.blocks.getBlockDefinition(e);n.Msg.TEXT_LENGTH_TITLE=t.block.TEXT_LENGTH_TITLE,n.Blocks[e].init=function(){this.jsonInit({message0:n.Msg.TEXT_LENGTH_TITLE,args0:[{type:"input_value",name:"VALUE",check:["String"]}],output:"Number",outputShape:s.provider.SHAPES.ROUND})},(0,i.installBuiltinHelpInfo)(e),t=pxt.blocks.getBlockDefinition("text_join"),n.Msg.TEXT_JOIN_TITLE_CREATEWITH=t.block.TEXT_JOIN_TITLE_CREATEWITH,(0,i.installBuiltinHelpInfo)("text_join")}},{"../constants":18,"../help":72,blockly:175}],10:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.initVariables=i.CREATE_VAR_BTN_ID=void 0;let l=e("blockly"),c=e("../toolbox"),o=e("../help");function u(e,t){let r=[];pxt.appTarget.appTheme.hideFlyoutHeadings||(n=(0,c.createFlyoutHeadingLabel)(lf("Variables"),pxt.toolbox.getNamespaceColor("variables"),pxt.toolbox.getNamespaceIcon("variables")),r.push(n));var n=document.createElement("button"),n=(n.setAttribute("text",lf("Make a Variable...")),n.setAttribute("callbackKey","CREATE_VARIABLE"),n.setAttribute("id",i.CREATE_VAR_BTN_ID),e.registerButtonCallback("CREATE_VARIABLE",function(e){l.Variables.createVariableButtonHandler(e.getTargetWorkspace())}),r.push(n),l.Variables.flyoutCategoryBlocks(e));return r=r.concat(n)}i.CREATE_VAR_BTN_ID="create-variable-btn",i.initVariables=function(){let e=lf("{id:var}item");l.Variables.flyoutCategory=u,l.Variables.flyoutCategoryBlocks=function(e){var t=e.getVariableMap().getVariablesOfType(""),r=[];if(0<t.length){var n,i,s,a,e=t[t.length-1];t.sort(l.Variables.compareByName);for(let e=0;e<t.length;e++){var o=t[e];l.Blocks.variables_get&&((o=(0,c.mkVariableFieldBlock)("variables_get",o.getId(),o.getType(),o.getName(),!1)).setAttribute("gap","8"),r.push(o))}r[r.length-1].setAttribute("gap","24"),(l.Blocks.variables_change||l.Blocks.variables_set)&&r.unshift((0,c.createFlyoutGroupLabel)(lf("Your Variables"))),l.Blocks.variables_change&&(s=l.Blocks.variables_get?20:8,(a=(0,c.mkVariableFieldBlock)("variables_change",e.getId(),e.getType(),e.getName(),!1)).setAttribute("gap",s+""),(s=l.utils.xml.createElement("value")).setAttribute("name","VALUE"),(n=l.utils.xml.createElement("shadow")).setAttribute("type","math_number"),s.appendChild(n),(i=l.utils.xml.createElement("field")).setAttribute("name","NUM"),i.appendChild(document.createTextNode("1")),n.appendChild(i),a.appendChild(s),r.unshift(a)),l.Blocks.variables_set&&(n=l.Blocks.variables_change?8:24,(i=(0,c.mkVariableFieldBlock)("variables_set",e.getId(),e.getType(),e.getName(),!1)).setAttribute("gap",n+""),(s=l.utils.xml.createElement("value")).setAttribute("name","VALUE"),(a=l.utils.xml.createElement("shadow")).setAttribute("type","math_number"),s.appendChild(a),(e=l.utils.xml.createElement("field")).setAttribute("name","NUM"),e.appendChild(document.createTextNode("0")),a.appendChild(e),i.appendChild(s),r.unshift(i))}return r};var t=l.Msg;let r="variables_get";var n=pxt.blocks.getBlockDefinition(r);t.VARIABLES_GET_CREATE_SET=n.block.VARIABLES_GET_CREATE_SET,l.Blocks[r]={init:function(){this.jsonInit({type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}",variableTypes:[""]}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]}),(0,o.setBuiltinHelpInfo)(this,r)}},(0,o.installBuiltinHelpInfo)("variables_get_reporter"),t.RENAME_VARIABLE=lf("Rename variable..."),t.DELETE_VARIABLE=lf('Delete the "%1" variable'),t.DELETE_VARIABLE_CONFIRMATION=lf('Delete %1 uses of the "%2" variable?'),t.NEW_VARIABLE_DROPDOWN=lf("New variable...");let i="variables_set",s=(n=pxt.blocks.getBlockDefinition(i),t.VARIABLES_SET=n.block.VARIABLES_SET,t.VARIABLES_DEFAULT_NAME=e,t.VARIABLES_SET_CREATE_GET=lf("Create 'get %1'"),l.Blocks[i]={init:function(){this.jsonInit({type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}",variableTypes:[""]},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}),(0,o.setBuiltinHelpInfo)(this,i)}},"variables_change"),a=pxt.blocks.getBlockDefinition(s);l.Blocks[s]={init:function(){this.jsonInit({message0:a.block.message0,args0:[{type:"field_variable",name:"VAR",variable:e,variableTypes:[""]},{type:"input_value",name:"VALUE",check:"Number"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:pxt.toolbox.getNamespaceColor("variables")}),(0,o.setBuiltinHelpInfo)(this,s)},customContextMenu:function(e){var t,r,n;null!=(t=null==(t=this.workspace)?void 0:t.options)&&t.readOnly||this.isInFlyout||(t={enabled:0<this.workspace.remainingCapacity()},n=this.getField("VAR").getText(),t.text=lf("Create 'get {0}'",n),(r=l.utils.xml.createElement("field")).textContent=n,r.setAttribute("name","VAR"),(n=l.utils.xml.createElement("block")).setAttribute("type","variables_get"),n.appendChild(r),t.callback=l.ContextMenu.callbackFactory(this,n),e.push(t))}},t.NEW_VARIABLE_TITLE=lf("New variable name:"),t.RENAME_VARIABLE_TITLE=lf("Rename all '%1' variables to:")}},{"../help":72,"../toolbox":139,blockly:175}],11:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.renderCodeCard=void 0;let o=e("./render");r.renderCodeCard=function(t,r={}){var n=!!(s=t.url?/^[^:]+:\/\//.test(t.url)?t.url:"/"+t.url.replace(/^\.?\/?/,""):t.youTubeId?"https://youtu.be/"+t.youTubeId:void 0),i=(e,t,r="div",n="")=>{r=document.createElement(r);return t&&(r.className=t),e&&e.appendChild(r),n&&r.appendChild(document.createTextNode(n+"")),r},e=i(null,"ui "+(t.style||"card")+" "+(t.color||"")+(n?" link":""),n?"a":"div"),n=(r.role&&e.setAttribute("role",r.role),"option"===r.role&&e.setAttribute("aria-selected","true"),n&&((n=e).href=s,/^https?:\/\//.test(s))&&(n.target="_blank"),!r.hideHeader&&t.header&&(s=i(e,"ui content "+(t.responsive?" tall desktop only":"")),t.header)&&i(s,"description","span",t.header),(r.shortName?t.shortName:"")||t.name),s=i(e,"ui image"+(t.responsive?" tall landscape only":""));if(t.label&&((r=document.createElement("label")).className=`ui ${t.labelClass||"orange right ribbon"} label`,r.textContent=t.label,s.appendChild(r)),t.blocksXml&&((r=(0,o.render)(t.blocksXml))?((a=i(s,"")).setAttribute("style","width:100%; min-height:10em"),a.appendChild(r)):(pxt.error("failed to render blocks"),pxt.debug(t.blocksXml))),t.typeScript&&((a=document.createElement("pre")).appendChild(document.createTextNode(t.typeScript)),s.appendChild(a)),(r=t.imageUrl||(t.youTubeId?`https://img.youtube.com/vi/${t.youTubeId}/0.jpg`:void 0))&&((a=document.createElement("div")).className="ui imagewrapper",(r=document.createElement("div")).className="ui cardimage",r.style.backgroundImage=`url("${t.imageUrl}")`,r.title=n,r.setAttribute("role","presentation"),a.appendChild(r),s.appendChild(a)),"file"==t.cardType&&(r=i(e,"ui fileimage"),s.appendChild(r)),n||t.description){var a=i(e,"ui content");if(n&&(e.setAttribute("aria-label",n),i(a,"header","div",n)),t.description){s=i(a,"ui description"),r=/((?:\.{1,3})|[\!\?])/.exec(t.description);let e=t.description+".";r&&(n=r[1],e=t.description.split(n)[0]+n),s.appendChild(document.createTextNode(e))}}return t.time&&(a=i(e,"meta"),t.time)&&i(a,"date","span").appendChild(document.createTextNode(pxt.Util.timeSince(t.time))),t.extracontent&&i(e,"extra content","div").appendChild(document.createTextNode(t.extracontent)),e}},{"./render":137}],12:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.workerOpAsync=n.compileExpression=n.AUTO_DISABLED_REASON=n.callKey=n.compileAsync=n.compileBlockAsync=n.PXT_WARNING_ID=void 0;let d=e("blockly"),I=e("./environment"),A=e("./typeChecker"),D=e("./util"),u=e("../toolbox"),N=e("../legacyMutations"),p=e("./variables"),h=e("../fields");function m(e,t){var r;return e.type===ts.pxtc.ON_START_TYPE?0:(r=t.stdCallTable[e.type],t=g(0,e),e=1+ts.pxtc.Util.codalHash16(t),r&&r.attrs.afterOnStart?e:-e)}function g(e,t){return t.type==ts.pxtc.ON_START_TYPE?JSON.stringify({name:ts.pxtc.ON_START_TYPE}):t.type==ts.pxtc.FUNCTION_DEFINITION_TYPE?JSON.stringify({type:"function",name:t.getFieldValue("function_name")}):JSON.stringify(function e(t){let r=[];let n=[];for(var i of t.inputList){for(var s of i.fieldRow)s.name&&r.push(s.getText());i.type===d.inputs.inputTypes.VALUE&&(i.connection.targetBlock()?n.push(e(i.connection.targetBlock())):n.push(null))}return{type:t.type,fields:r,inputs:n}}(t)).replace(/"id"\s*:\s*"[^"]+"/g,"")}function f(e,t){var r;e.setDisabledReason(!t,n.AUTO_DISABLED_REASON);for(r of e.getDescendants(!1))r.setDisabledReason(!t,n.AUTO_DISABLED_REASON)}function _(e){e.setDisabledReason(!1,n.AUTO_DISABLED_REASON),e.setDisabledReason(!1,d.constants.MANUALLY_DISABLED),e.setDisabledReason(!1,"ORPHANED_BLOCK")}function y(e,t){if(t.isInsertionMarker())return[];let r;var n,i,s,a,o,l,c,u,d,p,h,m,g,f,_,y,b,v=[];switch(e.stats[t.type]=(e.stats[t.type]||0)+1,P(t,v),t.type){case"controls_if":r=((r,n,i)=>{var e,s=[];for(let t=0;t<=n.elseifCount_;++t){var a=O(r,(0,D.getInputTargetBlock)(r,n,"IF"+t),i),o=R(r,(0,D.getInputTargetBlock)(r,n,"DO"+t));let e=pxt.blocks.mkText("if (");0<t&&((e=pxt.blocks.mkText("else if (")).glueToBlock=pxt.blocks.GlueMode.WithSpace),(0,D.append)(s,[e,a,pxt.blocks.mkText(")"),o])}return n.elseCount_&&((e=pxt.blocks.mkText("else")).glueToBlock=pxt.blocks.GlueMode.WithSpace,(0,D.append)(s,[e,R(r,(0,D.getInputTargetBlock)(r,n,"ELSE"))])),s})(e,t,v);break;case"pxt_controls_for":case"controls_for":case"controls_simple_for":r=(p=e,h=t,m=v,g=(0,D.getInputTargetBlock)(p,h,"TO"),f=(0,D.getInputTargetBlock)(p,h,"DO"),_=(0,D.getInputTargetBlock)(p,h,"BY"),y=(0,D.getInputTargetBlock)(p,h,"FROM"),b=!_||_.type.match(/^math_number/)&&1==$(_),h=(0,A.lookup)(p,h,(0,D.getLoopVariableField)(p,h).getField("VAR").getText()),[pxt.blocks.mkText("for (let "+h.escapedName+" = "),y?O(p,y,m):pxt.blocks.mkText("0"),pxt.blocks.mkText("; "),pxt.blocks.mkInfix(pxt.blocks.mkText(h.escapedName),"<=",O(p,g,m)),pxt.blocks.mkText("; "),b?pxt.blocks.mkText(h.escapedName+"++"):pxt.blocks.mkInfix(pxt.blocks.mkText(h.escapedName),"+=",O(p,_,m)),pxt.blocks.mkText(")"),R(p,f)]);break;case"pxt_controls_for_of":case"controls_for_of":r=((e,t,r)=>{let n=(0,D.getInputTargetBlock)(e,t,"LIST"),i=(0,D.getInputTargetBlock)(e,t,"DO"),s;return s=n&&"placeholder"!==n.type?O(e,n,r):pxt.blocks.mkText("[0]"),r=(0,A.lookup)(e,t,(0,D.getLoopVariableField)(e,t).getField("VAR").getText()),[pxt.blocks.mkText("for (let "+r.escapedName+" of "),s,pxt.blocks.mkText(")"),R(e,i)]})(e,t,v);break;case"variables_set":r=[((t,e,r)=>{let n=(0,D.getInputTargetBlock)(t,e,"VALUE"),i=(0,A.lookup)(t,e,e.getField("VAR").getText()),s=t.idToScope[e.id],a=s.declaredVars[i.name]===i&&!i.firstReference&&!i.alreadyDeclared,o=(a&&(0,D.forEachChildExpression)(e,e=>{"variables_get"===e.type&&(0,A.lookup)(t,e,e.getField("VAR").getText())===i&&(a=!1)},!0),O(t,n,r)),l=i.escapedName+" = ";var c;return i.isAssigned=!0,a?(i.alreadyDeclared=I.BlockDeclarationType.Assigned,r=(0,A.getConcreteType)(i.type),l=`let ${i.escapedName} = `,r&&(c=(0,A.getConcreteType)((0,A.returnType)(t,n)),r.type!==c.type)&&(l=`let ${i.escapedName}: ${r.type} = `)):i.firstReference||(i.firstReference=e),pxt.blocks.mkStmt(pxt.blocks.mkText(l),o)})(e,t,v)];break;case"variables_change":r=[(y=e,g=t,b=v,h=(0,D.getInputTargetBlock)(y,g,"VALUE"),g=(0,A.lookup)(y,g,g.getField("VAR").getText()),y=O(y,h,b),h=pxt.blocks.mkText(g.escapedName),pxt.blocks.mkStmt(pxt.blocks.mkInfix(h,"+=",y)))];break;case"controls_repeat_ext":r=((t,r,e)=>{let n=O(t,(0,D.getInputTargetBlock)(t,r,"TIMES"),e),i=R(t,(0,D.getInputTargetBlock)(t,r,"DO")),s="index";for(let e=2;!(e=>!(0,A.lookup)(t,r,e))(s);e++)s="index"+e;return[pxt.blocks.mkText("for (let "+s+" = 0; "),pxt.blocks.mkInfix(pxt.blocks.mkText(s),"<",n),pxt.blocks.mkText("; "+s+"++)"),i]})(e,t,v);break;case"device_while":r=((e,t,r)=>(r=O(e,(0,D.getInputTargetBlock)(e,t,"COND"),r),e=R(e,(0,D.getInputTargetBlock)(e,t,"DO")),[pxt.blocks.mkText("while ("),r,pxt.blocks.mkText(")"),e]))(e,t,v);break;case"procedures_defnoreturn":r=(_=e,m=t,p=(0,D.escapeVarName)(m.getFieldValue("NAME"),_,!0),m=(0,D.getInputTargetBlock)(_,m,"STACK"),[pxt.blocks.mkText("function "+p+"() "),R(_,m)]);break;case"function_definition":r=(o=e,l=t,f=(0,D.escapeVarName)(l.getField("function_name").getText(),o,!0),c=(0,D.getInputTargetBlock)(o,l,"STACK"),u=l.getArguments().map(e=>{var t;return"Array"==e.type?(t=(0,A.lookup)(o,l,e.name),t=null!=(t=(0,A.getConcreteType)(t.type))&&t.type&&"Array"!==t.type?t.type:"any[]",(0,D.escapeVarName)(e.name,o)+": "+t):(0,D.escapeVarName)(e.name,o)+": "+e.type}),d=(0,A.isFunctionRecursive)(o,l,!1),[pxt.blocks.mkText(`function ${f} (${u.join(", ")})`+(d?": any":"")),R(o,c)]);break;case"procedures_callnoreturn":r=[((e,t)=>(t=(0,D.escapeVarName)(t.getFieldValue("NAME"),e,!0),pxt.blocks.mkStmt(pxt.blocks.mkText(t+"()"))))(e,t)];break;case"function_call":r=[M(e,t,v,!0)];break;case pxtc.TS_RETURN_STATEMENT_TYPE:r=[((e,t,r)=>(t=(0,D.getInputTargetBlock)(e,t,"RETURN_VALUE"))&&"placeholder"!=t.type?pxt.blocks.mkStmt(pxt.blocks.mkText("return "),O(e,t,r)):pxt.blocks.mkStmt(pxt.blocks.mkText("return")))(e,t,v)];break;case ts.pxtc.ON_START_TYPE:r=((e,t)=>(t=(0,D.getInputTargetBlock)(e,t,"HANDLER"),e=R(e,t),pxt.appTarget.compile&&pxt.appTarget.compile.onStartText&&e&&e.children&&e.children.unshift(pxt.blocks.mkStmt(pxt.blocks.mkText(`// ${pxtc.ON_START_COMMENT}
`))),e))(e,t).children;break;case pxtc.TS_STATEMENT_TYPE:r=t.getLines().map(e=>pxt.blocks.mkText(e+"\n"));break;case pxtc.PAUSE_UNTIL_TYPE:r=(u=e,d=t,c=v,a=pxt.appTarget.runtime&&pxt.appTarget.runtime.pauseUntilBlock,pxt.U.assert(!!a,"target has block enabled"),T=a.namespace,a=a.callName||"pauseUntil",u=F(u,d,{definitionName:"PREDICATE",actualName:"PREDICATE"},c),d=[pxt.blocks.mkGroup([pxt.blocks.mkText("() => "),u])],T?[pxt.blocks.mkStmt(pxt.blocks.H.namespaceCall(T,a,d,!1))]:[pxt.blocks.mkStmt(pxt.blocks.H.mkCall(a,d,!1,!1))]);break;case pxtc.TS_DEBUGGER_TYPE:r="1"!=t.getFieldValue("ON_OFF")?[]:[pxt.blocks.mkText("debugger;\n")];break;case pxtc.TS_BREAK_TYPE:r=[pxt.blocks.mkText("break;\n")];break;case pxtc.TS_CONTINUE_TYPE:r=[pxt.blocks.mkText("continue;\n")];break;default:var T=e.stdCallTable[t.type];r=T?[(i=t,s=v,(a=(n=e).stdCallTable[i.type]).imageLiteral?pxt.blocks.mkStmt(L(0,i,a.imageLiteral,a.imageLiteralColumns,a.imageLiteralRows,a.namespace,a.f,(0,D.visibleParams)(a,(0,D.countOptionals)(i,a)).map(e=>F(n,i,e,s)))):a.hasHandler?((t,r,n,i,s,a)=>{var e,i=i.map(e=>F(t,r,e,a)),o=(0,D.getInputTargetBlock)(t,r,"HANDLER"),o=R(t,o);pxt.appTarget.compile&&pxt.appTarget.compile.emptyEventHandlerComments&&0===o.children.length&&o.children.unshift(pxt.blocks.mkStmt(pxt.blocks.mkText("// "+pxtc.HANDLER_COMMENT)));let l,c=((0,D.isMutatingBlock)(r)&&r.mutation.getMutationType()===N.MutatorTypes.ObjectDestructuringMutator?l=r.mutation.compileMutation(t,a):n.comp.handlerArgs.length&&(e=(0,A.getEscapedCBParameters)(r,n,t),l=pxt.blocks.mkText(`function (${e.join(", ")})`)),s),u=n.f;n.attrs.blockAliasFor&&(e=t.blocksInfo.apis.byQName[n.attrs.blockAliasFor])&&(u=e.name,c=e.namespace);{var[s,i,o,n,d,p=!1]=[c,u,i,o,l,n.isExtensionMethod];n.noFinalNewline=!0;let e;return e=d?pxt.blocks.mkGroup([d,n]):pxt.blocks.mkGroup([pxt.blocks.mkText("function ()"),n]),p?pxt.blocks.mkStmt(pxt.blocks.H.extensionCall(i,o.concat([e]),!1)):s?pxt.blocks.mkStmt(pxt.blocks.H.namespaceCall(s,i,o.concat([e]),!1)):pxt.blocks.mkStmt(pxt.blocks.H.mkCall(i,o.concat([e]),!1))}})(n,i,a,((e,t)=>(0,D.visibleParams)(e,(0,D.countOptionals)(t,e)).filter(e=>!!e.definitionName))(a,i),a.namespace,s):pxt.blocks.mkStmt(B(n,i,a,s)))]:[pxt.blocks.mkStmt(O(e,t,v))]}var k=r[r.length-1];if(k&&!k.id&&(k.id=t.id),v.length){var x,E,S=r,C=[];for(x of v)for(var w of x.split("\n"))C.push(pxt.blocks.mkText("// "+w)),C.push(pxt.blocks.mkNewLine());for(E of C.reverse())S.unshift(E)}return r.forEach(e=>{!(e.type===pxt.blocks.NT.Block||e.type===pxt.blocks.NT.Prefix&&pxt.Util.startsWith(e.op,"//"))||t.type==pxtc.ON_START_TYPE&&e.id||(e.id=t.id)}),r}function O(t,r,n){pxt.U.assert(null!=r),t.stats[r.type]=(t.stats[r.type]||0)+1,P(r,n);let i;var e,s,a,o,l,c,u,d,p,h,m,g,f;if("placeholder"!=r.type&&r.isEnabled&&r.isEnabled())switch(r.type){case"math_number":case"math_integer":case"math_whole_number":case"math_number_minmax":i=S(0,r);break;case"math_op2":i=(p=t,m=n,g=(h=r).getFieldValue("op"),f=O(p,(0,D.getInputTargetBlock)(p,h,"x"),m),p=O(p,(0,D.getInputTargetBlock)(p,h,"y"),m),pxt.blocks.H.mathCall(g,[f,p]));break;case"math_op3":i=((e,t,r)=>(e=O(e,(0,D.getInputTargetBlock)(e,t,"x"),r),pxt.blocks.H.mathCall("abs",[e])))(t,r,n);break;case"math_arithmetic":case"logic_compare":case"logic_operation":i=((e,t,r)=>{let n=t.getFieldValue("OP"),i=(0,D.getInputTargetBlock)(e,t,"A"),s=(0,D.getInputTargetBlock)(e,t,"B"),a=[O(e,i,r),O(e,s,r)];if(-1!==["LT","LTE","GT","GTE","EQ","NEQ"].indexOf(n)&&E(e,i)&&E(e,s)&&pxt.blocks.flattenNode([a[0]]).output!==pxt.blocks.flattenNode([a[1]]).output&&(a=a.map(e=>pxt.blocks.H.mkParenthesizedExpression(pxt.blocks.mkGroup([e,pxt.blocks.mkText(" as any")])))),t=(0,A.returnType)(e,i),(0,A.isStringType)(t)){if("EQ"==n)return pxt.blocks.H.mkSimpleCall("==",a);if("NEQ"==n)return pxt.blocks.H.mkSimpleCall("!=",a)}else if((0,A.isBooleanType)(t))return pxt.blocks.H.mkSimpleCall(k[n],a);return pxt.U.assert(n in k),pxt.blocks.H.mkSimpleCall(k[n],a)})(t,r,n);break;case"math_modulo":i=(h=t,m=r,g=n,f=(0,D.getInputTargetBlock)(h,m,"DIVIDEND"),m=(0,D.getInputTargetBlock)(h,m,"DIVISOR"),f=[O(h,f,g),O(h,m,g)],pxt.blocks.H.mkSimpleCall("%",f));break;case"logic_boolean":i=pxt.blocks.H.mkBooleanLiteral("TRUE"==r.getFieldValue("BOOL"));break;case"logic_negate":i=((e,t,r)=>(e=O(e,(0,D.getInputTargetBlock)(e,t,"BOOL"),r),pxt.blocks.mkPrefix("!",[pxt.blocks.H.mkParenthesizedExpression(e)])))(t,r,n);break;case"variables_get":case"variables_get_reporter":i=((e,t)=>{let r=t.getField("VAR").getText(),n=(0,A.lookup)(e,t,r);return n?(n.firstReference||(n.firstReference=t),pxt.U.assert(null!=n&&null!=n.type),pxt.blocks.mkText(n.escapedName)):pxt.blocks.mkText(r)})(t,r);break;case"text":i=pxt.blocks.H.mkStringLiteral(r.getFieldValue("TEXT"));break;case"text_join":i=((e,t,r)=>{let n,i=0;for(;;){var s=(0,D.getInputTargetBlock)(e,t,"ADD"+i);if(i++,!s){if(i<t.inputList.length)continue;break}var a=O(e,s,r);n=n?pxt.blocks.H.mkSimpleCall("+",[n,a]):0===s.type.indexOf("text")?a:pxt.blocks.H.mkSimpleCall("+",[pxt.blocks.H.mkStringLiteral(""),a])}return n||pxt.blocks.H.mkStringLiteral("")})(t,r,n);break;case"lists_create_with":i=(c=t,u=n,d=(p=r).inputList.map(e=>e.connection&&e.connection.targetBlock()?O(c,e.connection.targetBlock(),u):void 0).filter(e=>!!e),pxt.blocks.H.mkArrayLiteral(d,!p.getInputsInline()));break;case"lists_index_get":i=(d=t,a=r,o=n,l=(0,D.getInputTargetBlock)(d,a,"LIST"),l=O(d,l,o),d=O(d,(0,D.getInputTargetBlock)(d,a,"INDEX"),o),a=pxt.blocks.mkGroup([l,pxt.blocks.mkText("["),d,pxt.blocks.mkText("]")]));break;case"lists_index_set":i=(o=t,l=r,a=n,e=(0,D.getInputTargetBlock)(o,l,"LIST"),_=O(o,e,a),s=O(o,(0,D.getInputTargetBlock)(o,l,"INDEX"),a),o=O(o,(0,D.getInputTargetBlock)(o,l,"VALUE"),a),l=pxt.blocks.mkGroup([_,pxt.blocks.mkText("["),s,pxt.blocks.mkText("] = "),o]),"lists_create_with"===e.type?b(l):l);break;case"math_js_op":case"math_js_round":i=((e,t,r)=>{var n=t.getFieldValue("OP"),i=[O(e,(0,D.getInputTargetBlock)(e,t,"ARG0"),r)];return t.getInput("ARG1")&&i.push(O(e,(0,D.getInputTargetBlock)(e,t,"ARG1"),r)),pxt.blocks.H.mathCall(n,i)})(t,r,n);break;case pxtc.TS_OUTPUT_TYPE:i=pxt.blocks.mkText(r.getFieldValue("EXPRESSION").trim());break;case"argument_reporter_boolean":case"argument_reporter_number":case"argument_reporter_string":case"argument_reporter_array":case"argument_reporter_custom":i=((e,t)=>(t=(0,D.escapeVarName)(t.getFieldValue("VALUE"),e),pxt.blocks.mkText(t)))(t,r);break;case"function_call_output":i=M(t,r,n,!1);break;default:var _=t.stdCallTable[r.type];i=_?_.imageLiteral?L(0,r,_.imageLiteral,_.imageLiteralColumns,_.imageLiteralRows,_.namespace,_.f,(0,D.visibleParams)(_,(0,D.countOptionals)(r,_)).map(e=>F(t,r,e,n))):B(t,r,_,n):(pxt.reportError("blocks","unable to compile expression",{details:r.type}),(0,A.defaultValueForType)((0,A.returnType)(t,r)))}else if("Array"===(0,A.find)((0,A.returnType)(t,r)).type){let e="lists_index_get"===r.getParent().type;e||(y=t.stdCallTable[r.getParent().type],e=y&&y.isExpression);var y=pxt.blocks.mkText("[0]");i=e?y:b(y)}else i=(0,A.defaultValueForType)((0,A.returnType)(t,r));return i.id=r.id,i}function R(t,e){let r=[];for(var n=e;e;)e.isEnabled()&&(0,D.append)(r,y(t,e)),e=e.getNextBlock();return n&&t.blockDeclarations[n.id]&&t.blockDeclarations[n.id].filter(e=>!e.alreadyDeclared).forEach(e=>{r.unshift(v(e,t.blocksInfo)),e.alreadyDeclared=I.BlockDeclarationType.Implicit}),pxt.blocks.mkBlock(r)}function b(e){var t=pxt.blocks.mkStmt(pxt.blocks.mkText(";"));return t.glueToBlock=pxt.blocks.GlueMode.NoSpace,pxt.blocks.mkGroup([t,e])}function L(e,t,r,n,i,s,a,o){o=void 0===o?[]:o;let l="\n",c=(i=i||5,n=(n||5)*r,t.getFieldValue("LEDS"));c=c.replace(/[ `\n]+/g,"");for(let t=0;t<i;++t){for(let e=0;e<n;++e)0<e&&(l+=" "),l+="#"===c[t*n+e]?"#":".";l+="\n"}r=pxt.blocks.H.mkStringLiteral(l);return r.canIndentInside=!0,pxt.blocks.H.namespaceCall(s,a,[r].concat(o),!1)}function i(e,t,r){let n=pxt.blocks.flattenNode(t);return s("format",{format:{input:n.output,pos:1}}).then(()=>({source:n.output,sourceMap:n.sourceMap,stats:e.stats,diagnostics:r||[]}))}function P(e,t){var r=null==(r=e.getCommentText)?void 0:r.call(e);r&&t.push(r)}function v(e,t){var r=(0,A.getConcreteType)(e.type);let n,i="";if("null"==(n="Array"===r.type?pxt.blocks.mkText("[]"):(0,A.defaultValueForType)(r)).op||"[]"==n.op){let e=r.type;"Array"!==e&&"null[]"!==e||(e="number[]");r=t.apis.byQName[e];r&&r.attributes.autoCreate?n=pxt.blocks.mkText(r.attributes.autoCreate+"()"):i=": "+e}return pxt.blocks.mkStmt(pxt.blocks.mkText("let "+e.escapedName+i+" = "),n)}function T(e,t,r,n,i){e=s(e,i.x,i.x+i.width)||s(i.x,e,e+r),r=s(t,i.y,i.y+i.height)||s(i.y,t,t+n);return e&&r;function s(e,t,r){return t<=e&&e<=r}}n.PXT_WARNING_ID="WARNING_MESSAGE",n.compileBlockAsync=function(e,t){var r=e.workspace,t=(0,I.mkEnv)(r,t),r=((0,A.infer)(r&&r.getAllBlocks(!1),t,r),y(t,e));return t.placeholders={},i(t,r)},n.compileAsync=function(e,t,r={}){var[e,t]=((s,a,o)=>{try{let e=a.getAllBlocks(!1),t=(pxt.react.getTilemapProject&&pxt.react.getTilemapProject().removeInactiveBlockAssets(e.map(e=>e.id)),a.getTopBlocks(!0)),r=(t=t.sort((e,t)=>m(e,s)-m(t,s)),((r,e,t)=>{var n=d.Events.isEnabled();n&&d.Events.disable(),e.forEach(_);let i={};function s(e,t){i[e]?f(t,!1):(f(t,!0),i[e]=t)}t.forEach(t=>{var e=r.stdCallTable[t.type];if(t.type==ts.pxtc.ON_START_TYPE)s(ts.pxtc.ON_START_TYPE,t);else if(!((0,D.isFunctionDefinition)(t)||e&&e.attrs.blockAllowMultiple&&!e.attrs.handlerStatement&&!e.attrs.forceStatement))if(e&&e.hasHandler&&!e.attrs.handlerStatement&&!e.attrs.forceStatement)s(e.attrs.blockHandlerKey||g(0,t),t);else{let e=t;for(;e;)f(t,!1),e=e.getNextBlock()}}),n&&d.Events.enable()})(s,e,t),e=e.filter(e=>e.isEnabled()),t=t.filter(e=>e.isEnabled()),(0,p.trackAllVariables)(t,s),(0,A.infer)(e,s,a),[]);var l=a.getTopComments(!0);let n=((e,t)=>{if(!e.length||e.some(e=>!e.rendered))return{orphans:t,idToComments:{}};var r,n=e.map(e=>{var t=e.getBoundingRectangle(),r=e.getHeightWidth();return{id:e.id,x:t.left,y:t.top,width:r.width,height:r.height}}),i={orphans:[],idToComments:{}};for(r of t){var s,a=r.getBoundingRectangle(),o=r.getSize(),l=a.left,c=a.top;let e;for(s of n)(T(l,c,o.width,o.height,s)||!e&&T(l-20,c-20,o.width+40,o.height+40,s))&&(e=s);(e?(i.idToComments[e.id]||(i.idToComments[e.id]=[]),i.idToComments[e.id]):i.orphans).push(r)}return i})(t,l),i=(n.orphans.forEach(e=>(0,D.append)(r,x(e).children)),t.forEach(e=>{n.idToComments[e.id]&&n.idToComments[e.id].forEach(e=>{(0,D.append)(r,x(e).children)}),e.type==ts.pxtc.ON_START_TYPE?(0,D.append)(r,y(s,e)):(e=pxt.blocks.mkBlock(y(s,e))).type==pxt.blocks.NT.Block?(0,D.append)(r,e.children):r.push(e)}),[]);s.enums.forEach(o=>{var e=a.getVariableMap().getVariablesOfType(o.name);if(e&&e.length){e=e.map(e=>{var t=/^(\d+)([^0-9].*)$/.exec(e.getName());return t?[t[2],parseInt(t[1])]:[e.getName(),-1]});e.sort((e,t)=>e[1]-t[1]);let s=[],a=-1;e.forEach(([e,t],r)=>{let n;var i;o.isBitMask?0<=(i=Math.log2(t))&&Math.floor(i)===i&&(n=pxt.blocks.H.mkAssign(pxt.blocks.mkText(e),pxt.blocks.H.mkSimpleCall("<<",[pxt.blocks.H.mkNumberLiteral(1),pxt.blocks.H.mkNumberLiteral(i)]))):o.isHash&&(i=ts.pxtc.Util.codalHash16(e.toLowerCase()),n=pxt.blocks.H.mkAssign(pxt.blocks.mkText(e),pxt.blocks.H.mkNumberLiteral(i))),n=n||(t===a+1?pxt.blocks.mkText(e):pxt.blocks.H.mkAssign(pxt.blocks.mkText(e),pxt.blocks.H.mkNumberLiteral(t))),s.push(n),a=t});e=pxt.blocks.mkCommaSep(s,!0);e.glueToBlock=pxt.blocks.GlueMode.NoSpace,i.push(pxt.blocks.mkGroup([pxt.blocks.mkText("enum "+o.name),pxt.blocks.mkBlock([e])]))}}),s.kinds.forEach(t=>{var e=a.getVariableMap().getVariablesOfType("KIND_"+t.name);e&&e.length&&(e=e.map(e=>e.getName()).filter(e=>-1===t.initialMembers.indexOf(e))).length&&i.push(pxt.blocks.mkGroup([pxt.blocks.mkText("namespace "+t.name),pxt.blocks.mkBlock(e.map(e=>pxt.blocks.mkStmt(pxt.blocks.mkText(`export const ${e} = ${t.name}.${t.createFunctionName}()`))))]))});var c=s.allVariables.filter(e=>!e.alreadyDeclared).map(e=>v(e,o));return s.allVariables.filter(e=>e.alreadyDeclared===I.BlockDeclarationType.Implicit&&!e.isAssigned).forEach(e=>{var t=(0,A.getConcreteType)(e.type);"string"===t.type||"number"===t.type||"boolean"===t.type||(0,u.isArrayType)(t.type)||s.diagnostics.push({blockId:e.firstReference&&e.firstReference.id,message:lf("Variable '{0}' is never assigned",e.name)})}),[i.concat(c.concat(r)),s.diagnostics]}catch(e){var t=e.block;if(!t)throw e;t.setWarningText(e+"",n.PXT_WARNING_ID),s.errors.push(t)}finally{s.placeholders={}}return[null,null]})(r=(0,I.mkEnv)(e,t,r),e,t);return i(r,e,t)},n.callKey=g,n.AUTO_DISABLED_REASON="pxt_automatic_disabled",n.compileExpression=O;let k={ADD:"+",MINUS:"-",MULTIPLY:"*",DIVIDE:"/",LT:"<",LTE:"<=",GT:">",GTE:">=",AND:"&&",OR:"||",EQ:"==",NEQ:"!=",POWER:"**"};function M(t,r,n,e){var i=(0,D.escapeVarName)(r.getField("function_name").getText(),t,!0),s=!r.getInputsInline(),a=r.getArguments().map(e=>({actualName:e.name,definitionName:e.id})).map(e=>F(t,r,e,n)),i=pxt.blocks.H.stdCall(i,a,s);return e?pxt.blocks.mkStmt(i):i}function F(e,t,r,n,i=!1){var s=t.getFieldValue(r.definitionName);if(null==s)return(0,A.attachPlaceholderIf)(e,t,r.definitionName),a=(0,D.getInputTargetBlock)(e,t,r.definitionName),i&&"lists_create_with"===a.type?b(O(e,a,n)):r.shadowOptions&&r.shadowOptions.toString&&!(0,A.isStringType)((0,A.returnType)(e,a))?pxt.blocks.H.mkSimpleCall("+",[pxt.blocks.H.mkStringLiteral(""),pxt.blocks.H.mkParenthesizedExpression(O(e,a,n))]):O(e,a,n);i=t.getField(r.definitionName);if(i instanceof d.FieldTextInput||i instanceof h.FieldTextInput)return pxt.blocks.H.mkStringLiteral(s);if(i instanceof h.FieldTilemap&&!i.isGreyBlock){var a=pxt.react.getTilemapProject(),n=i.getValue();if(n.startsWith("tilemap`"))return pxt.blocks.mkText(n);if(e.options.emitTilemapLiterals)try{var o,l=pxt.sprite.decodeTilemap(n,"typescript",a);if(l)return[o]=a.createNewTilemapFromData(l),pxt.blocks.mkText(`tilemap\`${o}\``)}catch(e){}}t=e.blocksInfo.apis.byQName[r.type];if(t&&t.attributes.emitAsConstant)for(var c of Object.keys(e.blocksInfo.apis.byQName)){var u=e.blocksInfo.apis.byQName[c];if(u&&u.attributes&&u.attributes.enumIdentity===s)return pxt.blocks.mkText(c)}i=pxt.blocks.mkText(s);return i.canIndentInside="string"==typeof s&&0<=s.indexOf("\n"),i}function B(r,n,i,s){let t;if((0,D.isMutatingBlock)(n)&&n.mutation.getMutationType()===N.MutatorTypes.RestParameterMutator)t=n.mutation.compileMutation(r,s).children;else{if("ENUM_GET"===i.attrs.shim)return o=i.attrs.enumName,l=n.getFieldValue("MEMBER").replace(/^\d+/,""),pxt.blocks.H.mkPropertyAccess(l,pxt.blocks.mkText(o));if("KIND_GET"===i.attrs.shim)return l=r.kinds.filter(e=>e.blockId===i.attrs.blockId)[0],pxt.blocks.H.mkPropertyAccess(n.getFieldValue("MEMBER"),pxt.blocks.mkText(l.name));t=(0,D.visibleParams)(i,(0,D.countOptionals)(n,i)).map((e,t)=>F(r,n,e,s,i.isExtensionMethod&&0===t&&!i.isExpression))}let e=i.namespace,a=i.f;i.attrs.blockAliasFor&&(o=r.blocksInfo.apis.byQName[i.attrs.blockAliasFor])&&(a=o.name,e=o.namespace);var o,l=!n.getInputsInline();if(i.isIdentity)return t[0];if(i.property)return pxt.blocks.H.mkPropertyAccess(a,t[0]);if("@get@"==a)return pxt.blocks.H.mkPropertyAccess(t[1].op.replace(/.*\./,""),t[0]);if("@set@"==a)return pxt.blocks.H.mkAssign(pxt.blocks.H.mkPropertyAccess(t[1].op.replace(/.*\./,"").replace(/@set/,""),t[0]),t[2]);if("@change@"==a)return pxt.blocks.H.mkSimpleCall("+=",[pxt.blocks.H.mkPropertyAccess(t[1].op.replace(/.*\./,"").replace(/@set/,""),t[0]),t[2]]);if(i.isExtensionMethod){if(i.attrs.defaultInstance){let e;(e=(0,D.isMutatingBlock)(n)&&n.mutation.getMutationType()===N.MutatorTypes.DefaultInstanceMutator?n.mutation.compileMutation(r,s):e)?t.unshift(e):t.unshift(pxt.blocks.mkText(i.attrs.defaultInstance))}return pxt.blocks.H.extensionCall(a,t,l)}return e?pxt.blocks.H.namespaceCall(e,a,t,l):pxt.blocks.H.stdCall(a,t,l)}function x(e){e=e.getText();return pxt.blocks.H.mkMultiComment(e.trim())}function E(e,t){return function t(r,n){if(!n)return!1;if("math_number"===n.type||"math_integer"===n.type||"math_number_minmax"===n.type||"math_whole_number"===n.type)return!0;let e=r.stdCallTable[n.type];if(!e)return!1;let i=e.comp;if("TD_ID"===e.attrs.shim&&1===i.parameters.length){let e=n.getFieldValue(i.parameters[0].definitionName);return e?!isNaN(parseInt(e)):t(r,(0,D.getInputTargetBlock)(r,n,i.parameters[0].definitionName))}return!1}(e,t)||"logic_boolean"===t.type||"text"===t.type}function $(e){var t=e.getFieldValue("math_number_minmax"===e.type?"SLIDER":"NUM"),t=parseFloat(t);if(r=t,e=e,isFinite(r)&&!isNaN(r))return t;var r=lf("Number entered is either too large or too small"),t=e;throw(r=new Error(r)).block=t,r}function S(e,t){return pxt.blocks.H.mkNumberLiteral($(t))}function s(e,t){return pxt.worker.getWorker(pxt.webConfig.workerjs).opAsync(e,t)}n.workerOpAsync=s},{"../fields":70,"../legacyMutations":76,"../toolbox":139,"./environment":13,"./typeChecker":14,"./util":15,"./variables":16,blockly:175}],13:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.mkEnv=r.emptyEnv=r.BlockDeclarationType=r.Point=void 0;let i=e("./util");function s(e,t){return{workspace:e,options:t,stdCallTable:{},userFunctionReturnValues:{},diagnostics:[],errors:[],renames:{oldToNew:{},takenNames:{},oldToNewFunctions:{}},stats:{},enums:[],kinds:[],idToScope:{},blockDeclarations:{},allVariables:[],blocksInfo:null,placeholders:{}}}r.Point=class{constructor(e,t,r,n,i){this.link=e,this.type=t,this.parentType=r,this.childType=n,this.isArrayType=i}},(e=r.BlockDeclarationType||(r.BlockDeclarationType={}))[e.None=0]="None",e[e.Argument=1]="Argument",e[e.Assigned=2]="Assigned",e[e.Implicit=3]="Implicit",r.emptyEnv=s,r.mkEnv=function(e,t,r={}){let n=s(e,r);return(n.blocksInfo=t)&&(Object.keys(t.apis.byQName).forEach(e=>{e=t.apis.byQName[e];!e.pkg||6!==e.kind&&3!==e.kind&&5!==e.kind&&4!==e.kind||(n.renames.takenNames[e.qName]=!0)}),t.enumsByName&&Object.keys(t.enumsByName).forEach(e=>n.enums.push(t.enumsByName[e])),t.kindsByName&&Object.keys(t.kindsByName).forEach(e=>n.kinds.push(t.kindsByName[e])),t.blocks.forEach(e=>{var t,r;n.stdCallTable[e.attributes.blockId]?pxt.reportError("blocks","function already defined",{details:e.attributes.blockId,qualifiedName:e.qName,packageName:e.pkg}):(n.renames.takenNames[e.namespace]=!0,r=!!(t=pxt.blocks.compileInfo(e)).thisParameter,n.stdCallTable[e.attributes.blockId]={namespace:e.namespace,f:e.name,comp:t,attrs:e.attributes,isExtensionMethod:r,isExpression:e.retType&&"void"!==e.retType,imageLiteral:e.attributes.imageLiteral||e.attributes.gridLiteral,imageLiteralColumns:e.attributes.imageLiteralColumns,imageLiteralRows:e.attributes.imageLiteralRows,hasHandler:pxt.blocks.hasHandler(e),property:!e.parameters,isIdentity:"TD_ID"==e.attributes.shim})}),e.getTopBlocks(!1).filter(i.isFunctionDefinition).forEach(e=>{e="procedures_defnoreturn"===e.type?e.getFieldValue("NAME"):e.getField("function_name").getText();(0,i.escapeVarName)(e,n,!0)})),n}},{"./util":15}],14:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isBooleanType=r.isStringType=r.defaultValueForType=r.getEscapedCBParameters=r.isFunctionRecursive=r.getDeclaredVariables=r.lookup=r.getConcreteType=r.attachPlaceholderIf=r.returnType=r.find=r.mkPoint=r.infer=void 0;let n=e("./environment"),m=e("./util"),l=e("../plugins/functions"),g=e("./compiler"),c=e("../loader");function f(e,t){var r,n=T(e),i=T(t);I(null==n.link&&null==i.link),n!=i&&(s(n)?o(e.type,t.type):s(i)?(o(e.type,t.type),e.type=null,n.link=e.link=i,n.isArrayType=i.isArrayType):(n.childType&&i.childType?(r=n.childType,n.childType=null,f(r,i.childType)):n.childType&&!i.childType&&(i.childType=n.childType),n.parentType&&i.parentType?(r=n.parentType,n.parentType=null,f(r,i.parentType)):!n.parentType||i.parentType||i.type||(i.parentType=n.parentType),r=o(n.type,i.type),e.link=i,n.link=i,n.isArrayType=i.isArrayType,e.type=null,t.type=r))}function _(e,t,r,n){E(e,t,r);try{f(k(e,(0,m.getInputTargetBlock)(e,t,r)),n)}catch(e){}}function u(e,t=!1){return new n.Point(null,e,null,null,t)}r.infer=function(e,d,t){function p(e){var t=null==(t=null==(t=e.connection)?void 0:t.getCheck())?void 0:t[0];return e.name?t||"T":void 0}function h(e,t){var r=e.inputList.filter(e=>"T"===p(e));if(r.length){var n,r=(0,m.getInputTargetBlock)(d,e,r[0].name);if(r)return S(r=(n=k(d,r)).type?v(k(d,r).type+"[]"):v(null),n),_(d,e,t,r),!0}return!1}e&&e.filter(e=>e.isEnabled()).forEach(o=>{try{switch(o.type){case"math_op2":_(d,o,"x",v(y.type)),_(d,o,"y",v(y.type));break;case"math_op3":_(d,o,"x",v(y.type));break;case"math_arithmetic":case"logic_compare":switch(o.getFieldValue("OP")){case"ADD":case"MINUS":case"MULTIPLY":case"DIVIDE":case"LT":case"LTE":case"GT":case"GTE":case"POWER":_(d,o,"A",v(y.type)),_(d,o,"B",v(y.type));break;case"AND":case"OR":E(d,o,"A",b.type),E(d,o,"B",b.type);break;case"EQ":case"NEQ":E(d,o,"A"),E(d,o,"B");var e=k(d,(0,m.getInputTargetBlock)(d,o,"A")),t=k(d,(0,m.getInputTargetBlock)(d,o,"B"));try{f(e,t)}catch(e){}}break;case"logic_operation":E(d,o,"A",b.type),E(d,o,"B",b.type);break;case"logic_negate":E(d,o,"BOOL",b.type);break;case"controls_if":for(let e=0;e<=o.elseifCount_;++e)E(d,o,"IF"+e,b.type);break;case"pxt_controls_for":case"controls_simple_for":_(d,o,"TO",v(y.type));break;case"pxt_controls_for_of":case"controls_for_of":var r=(0,m.getInputTargetBlock)(d,o,"LIST");r&&"placeholder"!==r.type?S(k(d,r),w(d,o,(0,m.getLoopVariableField)(d,o).getField("VAR").getText()).type):d.diagnostics.push({blockId:o.id,message:lf("The 'for of' block must have a list input")});break;case"variables_set":case"variables_change":var n=w(d,o,o.getField("VAR").getText()).type,i=(E(d,o,"VALUE"),(0,m.getInputTargetBlock)(d,o,"VALUE"));if(i){l=d;var s=null!=(u=null==(u=(c=i).outputConnection)?void 0:u.getCheck())&&u.length&&"Array"!==u[0]&&"T"!==u[0]?u.map(e=>v(e)):[k(l,c)];let t=T(n);if(t.type&&s.slice(1).some(e=>e.type===t.type))n.link=T(s[0]);else try{f(n,s[0])}catch(e){}}break;case"controls_repeat_ext":_(d,o,"TIMES",v(y.type));break;case"device_while":E(d,o,"COND",b.type);break;case"lists_index_get":_(d,o,"LIST",v("Array")),_(d,o,"INDEX",v(y.type)),S(k(d,(0,m.getInputTargetBlock)(d,o,"LIST")),k(d,o));break;case"lists_index_set":_(d,o,"LIST",v("Array")),E(d,o,"VALUE"),h(o,"LIST"),_(d,o,"INDEX",v(y.type));break;case"function_definition":x(d,o.getField("function_name").getText());break;case"function_call":case"function_call_output":o.getArguments().forEach(e=>{_(d,o,e.id,v(e.type))});break;case pxtc.TS_RETURN_STATEMENT_TYPE:E(d,o,"RETURN_VALUE");break;case pxtc.PAUSE_UNTIL_TYPE:_(d,o,"PREDICATE",b);break;default:if(o.type in d.stdCallTable){let a=d.stdCallTable[o.type];"ENUM_GET"!==a.attrs.shim&&"KIND_GET"!==a.attrs.shim&&(0,m.visibleParams)(a,(0,m.countOptionals)(o,a)).forEach((t,e)=>{var r,e=a.isExtensionMethod&&0===e;if(t.definitionName&&!o.getFieldValue(t.definitionName)){var n=o.inputList.find(e=>e.name==t.definitionName),i=null==(r=null==n?void 0:n.connection)?void 0:r.getCheck();if(i){if(e&&"Array"===p(n))if(h(o,t.definitionName))return;for(let e=0;e<i.length;e++)try{var s=i[e];_(d,o,t.definitionName,v(s));break}catch(e){}}}})}}}catch(e){var a=e.block||o;a.setWarningText(e+"",g.PXT_WARNING_ID),d.errors.push(a)}var l,c,u}),d.allVariables.forEach(e=>{null==C(e.type).type&&(e.isFunctionParameter?e.type.isArrayType&&(e.type.type="any[]"):f(e.type,v(e.type.isArrayType?"number[]":y.type)))})};let y=(r.mkPoint=u)("number"),b=u("boolean"),i=u("string"),a=u("void");function v(e){if(!e)return u(e);switch(e.toLowerCase()){case"number":return y;case"boolean":return b;case"string":return i;case"void":return a;default:return u(e)}}function T(e){return e.link?T(e.link):e}function s(e){return e===y||e===b||e===i||e===a}function k(r,n){var e;if(I(null!=n),"placeholder"==(i=n).type||i.type===pxtc.TS_OUTPUT_TYPE)return n.p||(n.p=u(null)),T(n.p);if("variables_get"==n.type)return T(w(r,n,n.getField("VAR").getText()).type);if("function_call_output"==n.type)return i=r,e=(e=n).getField("function_name").getText(),x(i,e);if(!n.outputConnection)return v(a.type);var i=(null==(e=null==(i=n.outputConnection)?void 0:i.getCheck())?void 0:e[0])||"T";if("Array"===i){var s=n.outputConnection.getCheck();if(1<s.length)return v(s[1]);let e;if("lists_create_with"==n.type){if(n.inputList&&n.inputList.length)for(var t of n.inputList)if(t.connection&&t.connection.targetBlock()){t=T(k(r,t.connection.targetBlock()));if(t){if(t.parentType)return t.parentType;S(e=t.type?v(t.type+"[]"):u(null),t);break}}}else"argument_reporter_array"==n.type&&(e=e||w(r,n,n.getFieldValue("VALUE")).type);return e&&(e.isArrayType=!0),e||u(null,!0)}if("T"!==i)return v(i);{let t=r.stdCallTable[n.type];var s="lists_index_get"===n.type;if(s||t&&t.comp.thisParameter){let e;if((e=s?n.inputList.find(e=>"LIST"===e.name):n.inputList.find(e=>e.name===t.comp.thisParameter.definitionName)).connection&&e.connection.targetBlock())return(i=k(r,e.connection.targetBlock())).childType||(s=d(i.type)&&"Array"!==i.type?u(i.type.substr(0,i.type.length-2)):u(null),S(i,s),s)}return u(null)}}function x(r,n){if(!r.userFunctionReturnValues[n]){var i=(0,l.getDefinition)(n,r.workspace);let t=u("void");if(p(r,i,!0))t=u("any");else{var e,s=[];for(e of i.getDescendants(!1))"function_return"===e.type&&(E(r,e,"RETURN_VALUE"),s.push(k(r,(0,m.getInputTargetBlock)(r,e,"RETURN_VALUE"))));if(s.length)try{var a,o=u(null);for(a of s)f(o,a);t=o}catch(e){r.diagnostics.push({blockId:i.id,message:pxt.Util.lf("Function '{0}' has an invalid return type",n)}),t=u("any")}}r.userFunctionReturnValues[n]=t}return r.userFunctionReturnValues[n]}function o(e,t){if(null==e||"Array"===e&&d(t))return t;if(null==t||"Array"===t&&d(e))return e;if(e==t)return e;throw new Error("cannot mix "+e+" with "+t)}function d(e){return e&&(-1!==e.indexOf("[]")||"Array"==e)}function E(e,t,r,n){var i,s=t.getInputTargetBlock(r);s?s.type!==pxtc.TS_OUTPUT_TYPE||s.p||(s.p=u(null)):(e.placeholders[t.id]||(e.placeholders[t.id]={}),e.placeholders[t.id][r]||(e.placeholders[t.id][r]=(s=e,i=t,{type:"placeholder",p:u(n||null),workspace:s.workspace,parentBlock_:i,getParent:()=>i})))}function S(e,t){e=T(e),t=T(t);e.childType?f(e.childType,t):e.type||(e.childType=t),t.parentType?f(t.parentType,e):t.type||(t.parentType=e),d(e.type)&&(e.isArrayType=!0)}function C(e,t=[]){e=T(e);if(-1===t.indexOf(e)&&(t.push(e),!e.type||"Array"===e.type)){if(e.parentType){var r=C(e.parentType,t);if(r.type&&"Array"!==r.type)return d(r.type)?e.type=r.type.substr(0,r.type.length-2):e.type=r.type,e}if(e.childType){r=C(e.childType,t);if(r.type)e.type=r.type+"[]"}}return e}function w(e,t,r){return function e(t,r){return r&&r.declaredVars[t]?r.declaredVars[t]:r&&r.parent?e(t,r.parent):null}(r,e.idToScope[t.id])}function p(i,e,s){let a=(0,m.getFunctionName)(e),o={};return function t(e){let r;r=s?e.getDescendants(!1).filter(e=>"function_return"==e.type).map(e=>(0,m.getInputTargetBlock)(i,e,"RETURN_VALUE")).filter(e=>e&&"function_call_output"===e.type):e.getDescendants(!1).filter(e=>"function_call_output"==e.type);for(var n of r){let e=(0,m.getFunctionName)(n);if(e===a)return!0;if(!o[e]&&(o[e]=!0,t((0,l.getDefinition)(e,n.workspace))))return!0}return!1}(e)}function h(r,n,i){var s=[];if(n.attrs.draggableParameters)for(let t=0;t<n.comp.handlerArgs.length;t++){var a=n.comp.handlerArgs[t];let e;var o=(0,m.getInputTargetBlock)(i,r,c.DRAGGABLE_PARAM_INPUT_PREFIX+a.name);if(null==(e="reporter"===n.attrs.draggableParameters?o&&o.getFieldValue("VALUE"):o&&o.getField("VAR").getText()))break;s.push({name:e,type:u(a.type)})}else for(let e=0;e<n.comp.handlerArgs.length;e++){var t=n.comp.handlerArgs[e],l=r.getField("HANDLER_"+t.name),l=l&&l.getText();if(null===l)break;s.push({name:l,type:u(t.type)})}return s}function I(e){if(!e)throw new Error("Assertion failure")}r.find=T,r.returnType=k,r.attachPlaceholderIf=E,r.getConcreteType=C,r.lookup=w,r.getDeclaredVariables=function(e,t){switch(e.type){case"pxt_controls_for":case"controls_simple_for":return[{name:(0,m.getLoopVariableField)(t,e).getField("VAR").getText(),type:y}];case"pxt_controls_for_of":case"controls_for_of":return[{name:(0,m.getLoopVariableField)(t,e).getField("VAR").getText(),type:u(null)}];case"function_definition":return e.getArguments().filter(e=>"Array"===e.type).map(e=>{var t=u(null);return t.isArrayType=!0,{name:e.name,type:t,isFunctionParameter:!0}})}if((0,m.isMutatingBlock)(e)){let t=e.mutation.getDeclaredVariables();if(t)return Object.keys(t).map(e=>({name:e,type:u(t[e])}))}var r=t.stdCallTable[e.type];return r&&r.comp.handlerArgs.length?h(e,r,t):[]},r.isFunctionRecursive=p,r.getEscapedCBParameters=function(t,e,r){return h(t,e,r).map(e=>w(r,t,e.name).escapedName)},r.defaultValueForType=function(e){if(null==e.type&&(f(e,v(y.type)),e=T(e)),d(e.type)||e.isArrayType)return pxt.blocks.mkText("[]");switch(e.type){case"boolean":return pxt.blocks.H.mkBooleanLiteral(!1);case"number":return pxt.blocks.H.mkNumberLiteral(0);case"string":return pxt.blocks.H.mkStringLiteral("");default:return pxt.blocks.mkText("null")}},r.isStringType=function(e){return e===i},r.isBooleanType=function(e){return e===b}},{"../loader":77,"../plugins/functions":111,"./compiler":12,"./environment":13,"./util":15}],15:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isFunctionDefinition=r.append=r.escapeVarName=r.isMutatingBlock=r.getInputTargetBlock=r.countOptionals=r.visibleParams=r.getFunctionName=r.getLoopVariableField=r.printScope=r.forEachStatementInput=r.forEachChildExpression=void 0;let i=e("blockly");function s(t){let r="";for(let e=0;e<t;e++)r+="    ";return r}function n(e,t,r){var n=t.getInputTargetBlock(r);return n||(null==(n=e.placeholders[t.id])?void 0:n[r])}r.forEachChildExpression=function t(e,r,n=!1){e.inputList.filter(e=>e.type===i.inputs.inputTypes.VALUE).forEach(e=>{e.connection&&e.connection.targetBlock()&&(r(e.connection.targetBlock()),n)&&t(e.connection.targetBlock(),r,n)})},r.forEachStatementInput=function(e,t){e.inputList.filter(e=>e.type===i.inputs.inputTypes.STATEMENT).forEach(e=>{e.connection&&e.connection.targetBlock()&&t(e.connection.targetBlock())})},r.printScope=function t(r,n=0){var e=Object.keys(r.declaredVars).map(e=>`${e}(${r.declaredVars[e].id})`).join(",");r.referencedVars.join(", ");pxt.log(s(n)+"SCOPE: "+(r.firstStatement?r.firstStatement.type:"TOP-LEVEL")),e.length&&pxt.log(s(n)+"DECS: "+e),r.children.forEach(e=>t(e,n+1))},r.getLoopVariableField=function(e,t){return"pxt_controls_for"==t.type||"pxt_controls_for_of"==t.type?n(e,t,"VAR"):t},r.getFunctionName=function(e){return e.getField("function_name").getText()},r.visibleParams=function({comp:e},t){let r=[];return e.thisParameter&&r.push(e.thisParameter),e.parameters.forEach(e=>{e.isOptional&&0<t?(r.push(e),--t):e.isOptional||r.push(e)}),r},r.countOptionals=function(e,t){if(t.attrs.compileHiddenArguments)return t.comp.parameters.reduce((e,t)=>(t.isOptional&&e++,e),0);if(e.mutationToDom){t=e.mutationToDom();if(t.hasAttribute("_expanded"))return e=parseInt(t.getAttribute("_expanded")),isNaN(e)?0:Math.max(e,0)}return 0},r.getInputTargetBlock=n,r.isMutatingBlock=function(e){return!!e.mutation},r.escapeVarName=function(e,t,r=!1){if(!e)return"_";if(r){if(t.renames.oldToNewFunctions[e])return t.renames.oldToNewFunctions[e]}else if(t.renames.oldToNew[e])return t.renames.oldToNew[e];let n=ts.pxtc.escapeIdentifier(e);if(t.renames.takenNames[n]){let e=2;for(;t.renames.takenNames[n+e];)e++;n+=e}return r?(t.renames.oldToNewFunctions[e]=n,t.renames.takenNames[n]=!0):t.renames.oldToNew[e]=n,n},r.append=function(e,t){e.push.apply(e,t)},r.isFunctionDefinition=function(e){return"procedures_defnoreturn"===e.type||"function_definition"===e.type}},{blockly:175}],16:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.trackAllVariables=void 0;let l=e("blockly"),c=e("./environment"),u=e("./typeChecker"),d=e("./util");function p(e,t){if(-1!==e.referencedVars.indexOf(t))return!0;for(var r of e.children)if(p(r,t))return!0;return!1}function h(e,t){if(-1!==e.assignedVars.indexOf(t))return!0;for(var r of e.children)if(h(r,t))return!0;return!1}r.trackAllVariables=function(e,t){let s=1,r;return e.forEach(e=>{e.type===ts.pxtc.ON_START_TYPE&&(e=e.getInputTargetBlock("HANDLER"))&&a(e,r={firstStatement:e,declaredVars:{},referencedVars:[],children:[],assignedVars:[]},t)}),r=r||{firstStatement:null,declaredVars:{},referencedVars:[],children:[],assignedVars:[]},e.forEach(e=>{e.type!==ts.pxtc.ON_START_TYPE&&a(e,r,t)}),Object.keys(r.declaredVars).forEach(e=>{var t=r.declaredVars[e];delete r.declaredVars[e],(function e(t,r){let n;if(-1!==t.referencedVars.indexOf(r))return t;for(var i of t.children)if(p(i,r)){if(h(i,r))return t;if(n)return t;n=i}return n?e(n,r):void 0}(r,t.id)||r).declaredVars[e]=t}),function t(r,n){let i=Object.keys(r.declaredVars);if(i.length){let e=i.map(e=>r.declaredVars[e]);r.firstStatement&&(n.blockDeclarations[r.firstStatement.id]=e.concat(n.blockDeclarations[r.firstStatement.id]||[])),e.forEach(e=>n.allVariables.push(e))}r.children.forEach(e=>t(e,n))}(r,t),function t(n,i){for(var r of Object.keys(n.declaredVars)){let e=n.declaredVars[r];e.escapedName||(e.escapedName=s(r))}n.children.forEach(e=>t(e,i));function s(t){if(!t)return"_";let r=ts.pxtc.escapeIdentifier(t);if(i.renames.takenNames[r]||a(r,n,t)){let e=2;for(;i.renames.takenNames[r+e]||a(r+e,n,t);)e++;r+=e}return r}function a(t,r,n){if(r){for(var i of Object.keys(r.declaredVars)){let e=r.declaredVars[i];if((n!==e.name||e.name!==e.escapedName)&&e.escapedName===t)return!0}return a(t,r.parent,n)}return!1}}(r,t),r;function a(e,t,n){if(n.idToScope[e.id]=t,"variables_get"===e.type?(i=o(e.getField("VAR").getText(),t),t.referencedVars.push(i.id)):"variables_set"===e.type||"variables_change"===e.type?(i=o(e.getField("VAR").getText(),t),t.assignedVars.push(i.id),t.referencedVars.push(i.id)):e.type===pxtc.TS_STATEMENT_TYPE&&(i=e.declaredVariables)&&i.split(",").forEach(e=>{o(e,t).alreadyDeclared=c.BlockDeclarationType.Argument}),e.inputList.some(e=>e.type===l.inputs.inputTypes.STATEMENT)){var i=(0,u.getDeclaredVariables)(e,n).map(e=>Object.assign(Object.assign({},e),{id:s++}));let r=t;i.length&&(r={parent:t,firstStatement:e,declaredVars:{},referencedVars:[],assignedVars:[],children:[]},i.forEach(e=>{e.alreadyDeclared=c.BlockDeclarationType.Assigned,r.declaredVars[e.name]=e}),n.idToScope[e.id]=r),t!==r&&t.children.push(r),(0,d.forEachChildExpression)(e,e=>{a(e,r,n)}),(0,d.forEachStatementInput)(e,e=>{var t={parent:r,firstStatement:e,declaredVars:{},referencedVars:[],assignedVars:[],children:[]};r.children.push(t),a(e,t,n)})}else(0,d.forEachChildExpression)(e,e=>{a(e,t,n)});e.nextConnection&&e.nextConnection.targetBlock()&&a(e.nextConnection.targetBlock(),t,n)}function o(e,t){return t.declaredVars[e]||(t.parent?o(e,t.parent):(t.declaredVars[e]={name:e,type:(0,u.mkPoint)(null),id:s++},t.declaredVars[e]))}}},{"./environment":13,"./typeChecker":14,"./util":15,blockly:175}],17:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.initVariableReporterArgs=r.initExpandableBlock=r.initVariableArgsBlock=r.appendMutation=void 0;let A=e("blockly"),D=e("./toolbox"),N=e("./constants"),u=e("./fields"),h=e("./loader"),O=e("./fields/field_imagenotext"),m=e("./plugins/duplicateOnDrag");function R(e,t){let r=e.mutationToDom,n=e.domToMutation;e.mutationToDom=()=>{var e=r?r():document.createElement("mutation");return t.mutationToDom(e)},e.domToMutation=e=>{n&&n(e),t.domToMutation(e)}}r.appendMutation=R,r.initVariableArgsBlock=function(s,a){let o=0,l=0,c=s.appendDummyInput(),i=()=>{if(o!==l){if(o>l){var t=o-l;for(let e=0;e<t;e++){var r=a[l+e],r=(c.insertFieldAt(c.fieldRow.length-1,new u.FieldArgumentVariable(r.name),"HANDLER_"+r.name),s);null!=r&&r.initSvg&&r.initSvg()}}else{var n=l-o;for(let e=0;e<n;e++){var i=a[l-e-1];c.removeField("HANDLER_"+i.name)}}o>=a.length?c.removeField("_HANDLER_ADD"):l>=a.length&&e(),l=o}};function e(){c.appendField(new O.FieldImageNoText(s.ADD_IMAGE_DATAURI,24,24,lf("Add argument"),()=>{o=Math.min(o+1,a.length),i()},!1),"_HANDLER_ADD")}A.Extensions.apply("inline-svgs",s,!1),e(),R(s,{mutationToDom:t=>{t.setAttribute("numArgs",o.toString());for(let e=0;e<o;e++){var r=s.getField("HANDLER_"+a[e].name),r=r&&r.getText();t.setAttribute("arg"+e,r)}return t},domToMutation:t=>{var e=parseInt(t.getAttribute("numargs"));o=Math.min(isNaN(e)?0:e,a.length),i();for(let e=0;e<o;e++){var r=t.getAttribute("arg"+e),n="HANDLER_"+a[e].name;s.getField(n)&&(0,h.setVarFieldValue)(s,n,r)}}})},r.initExpandableBlock=function(n,a,o,l,e,t){let r="0_add_button",i="0_rem_button",s="0_add_rem_button",c="_expanded",u="_input_init",d=o.parameters.map(e=>e.name),p=o.parameters.length,h=e?p:1,m="variable"===n.blocksById[a.type].attributes.inlineInputMode,g=n.blocksById[a.type].attributes.inlineInputModeLimit||4;var e=n.blocksById[a.type].attributes.compileHiddenArguments,f=n.blocksById[a.type].attributes.expandableArgumentBreaks;let _,y=(f&&(_=f.split(/[;,]/).map(e=>parseInt(e))),new L(a)),b=(y.setEventsEnabled(!1),y.setValue(c,0),y.setValue(u,!1),y.setEventsEnabled(!0),A.Extensions.apply("inline-svgs",a,!1),!1),v=!0;if(R(a,{mutationToDom:e=>(e.setAttribute(c,y.getString(c)),e.setAttribute(u,y.getString(u)),e),domToMutation:e=>{y.setEventsEnabled(!1),e.hasAttribute(u)&&"true"==e.getAttribute(u)&&!y.getBoolean(u)&&y.setValue(u,!0),S(),e.hasAttribute(c)&&(e=parseInt(e.getAttribute(c)),isNaN(e)||(e=e-(y.getNumber(c)||0),y.getBoolean(u)?a.rendered||a.isInsertionMarker()?k(e,!0,a.isInsertionMarker()):(y.setValue(c,C(e)),E()):k(e,!0))),y.setEventsEnabled(!0)}}),S(),e){let t=0;for(let e=0;e<a.inputList.length;e++){var T=a.inputList[e];!pxt.Util.startsWith(T.name,N.optionalInputWithFieldPrefix)&&-1===d.indexOf(T.name)||(!T.connection||T.connection.isConnected()||a.isInsertionMarker()||I(T,l.definitionNameToParam[o.parameters[t].name]),++t)}}function k(e,r=!1,t=!1){e=C(e);if(t||r||e!==y.getNumber(c)){y.setValue(c,e);var n=e;if(y.getBoolean(u)||!(0<n)||(S(),a.rendered)){let t=0;for(let e=0;e<a.inputList.length;e++){var i,s=a.inputList[e];pxt.Util.startsWith(s.name,N.optionalDummyInputPrefix)?w(s,t<n||n===p):!pxt.Util.startsWith(s.name,N.optionalInputWithFieldPrefix)&&-1===d.indexOf(s.name)||(w(s,i=t<n),i&&s.connection&&!s.connection.isConnected()&&!a.isInsertionMarker()&&I(s,l.definitionNameToParam[o.parameters[t].name]),++t)}E(),m&&a.setInputsInline(n<g),r||a.queueRender()}}}function x(e,t,r,n){a.appendDummyInput(e).appendField(new O.FieldImageNoText(t,24,24,r,()=>k(n),!1))}function E(){var e,t;b||(e=(t=y.getNumber(c))!==p,t=0!==t,a.inputList.some(e=>e.name===r)&&a.removeInput(r,!0),a.inputList.some(e=>e.name===i)&&a.removeInput(i,!0),a.inputList.some(e=>e.name===s)&&a.removeInput(s,!0),e&&t?a.appendDummyInput(s).appendField(new O.FieldImageNoText(a.REMOVE_IMAGE_DATAURI,24,24,lf("Hide optional arguments"),()=>k(-1*h),!1)).appendField(new O.FieldImageNoText(a.ADD_IMAGE_DATAURI,24,24,lf("Reveal optional arguments"),()=>k(h),!1)):e?x(r,a.ADD_IMAGE_DATAURI,lf("Reveal optional arguments"),h):t&&x(i,a.REMOVE_IMAGE_DATAURI,lf("Hide optional arguments"),-1*h))}function S(){y.setValue(u,!0),t(),E()}function C(e){var t=Math.min(Math.max(y.getNumber(c)+e,0),p);if(_){if(0<=e){if(0===t)return 0;for(var r of _)if(r>=t)return r;return p}for(let e=0;e<_.length;e++)if(_[e]>=t)return 0<e?_[e-1]:0;return _[_.length-1]}return t}function w(e,t){e.setVisible(t)}function I(t,e){let r=(0,D.createShadowValue)(n,e);"value"===r.tagName.toLowerCase()&&(r=r.firstElementChild),A.Events.disable();try{let e;a.initialized?e=A.Xml.domToBlock(r,a.workspace):(e=A.Xml.domToBlockInternal(r,a.workspace),setTimeout(()=>{e.isInsertionMarker()&&(A.Events.disable(),e.dispose(),A.Events.enable())})),e&&t.connection.connect(e.outputConnection)}catch(e){}A.Events.enable()}a.mixin({updateBeforeRender:()=>{b||v&&(v=!1,k(0,void 0,b=!0),b=!1)}})},r.initVariableReporterArgs=function(a,o,l){let c="0_add_button",u="numargs",d=new L(a),e=(d.setEventsEnabled(!1),d.setValue(u,0),d.setEventsEnabled(!0),A.Extensions.apply("inline-svgs",a,!1),()=>{for(var e of o){var t,r,n,i=a.getInput(h.DRAGGABLE_PARAM_INPUT_PREFIX+e.name);if(!i)break;i.connection.targetConnection||(A.Events.disable(),n=pxt.blocks.reporterTypeForArgType(e.type),(t=document.createElement("block")).setAttribute("type",n),(r=document.createElement("field")).setAttribute("name","VALUE"),r.textContent=e.name,t.appendChild(r),"argument_reporter_custom"===n&&((r=document.createElement("mutation")).setAttribute("type",e.type),t.appendChild(r)),n=A.Xml.domToBlock(t,a.workspace),i.connection.connect(n.outputConnection),!a.isInsertionMarker()&&n instanceof A.BlockSvg&&(n.initSvg(),n.queueRender()),A.Events.enable())}}),p=()=>{var t=a.inputList.filter(e=>e.name.startsWith(h.DRAGGABLE_PARAM_INPUT_PREFIX)).length,r=a.inputList.some(e=>e.name===c);if(t<d.getNumber(u))for(let e=t;e<d.getNumber(u);e++){var n,i=o[e];i&&((n=a.appendValueInput(h.DRAGGABLE_PARAM_INPUT_PREFIX+i.name)).setCheck((0,h.getBlocklyCheckForType)(i.type,l)),(0,m.setDuplicateOnDrag)(a.type,n.name),r?a.moveInputBefore(n.name,c):a.moveInputBefore(n.name,"HANDLER"))}else if(t>d.getNumber(u))for(let e=t-1;e>=d.getNumber(u);e--){var s=o[e];s&&((s=a.getInput(h.DRAGGABLE_PARAM_INPUT_PREFIX+s.name)).connection.targetConnection&&(A.Events.disable(),s.connection.targetBlock().dispose(),A.Events.enable()),a.removeInput(s.name,!0))}d.getNumber(u)<o.length?r||(a.appendDummyInput(c).appendField(new O.FieldImageNoText(a.ADD_IMAGE_DATAURI,24,24,lf("Add argument"),()=>{d.setValue(u,d.getNumber(u)+1),p()},!1)),a.moveInputBefore(c,"HANDLER")):r&&a.removeInput(c,!0),setTimeout(e)};p(),R(a,{mutationToDom:e=>(e.setAttribute(u,d.getString(u)),e),domToMutation:e=>{d.setEventsEnabled(!1),e.hasAttribute(u)&&(e=parseInt(e.getAttribute(u)),isNaN(e)||(d.setValue(u,e),p())),d.setEventsEnabled(!0)}})};class L{constructor(e,t){this.block=e,this.fireEvents=!0,this.state=t||{}}setValue(e,n){if(this.fireEvents&&this.block.mutationToDom){let t=this.block.mutationToDom(),r=(this.state[e]=n.toString(),this.block.mutationToDom());Object.keys(this.state).forEach(e=>{t.getAttribute(e)!==this.state[e]&&r.setAttribute(e,this.state[e])});var i=A.Xml.domToText(t),s=A.Xml.domToText(r);i!=s&&A.Events.fire(new A.Events.BlockChange(this.block,"mutation",null,i,s))}else this.state[e]=n.toString()}getNumber(e){return parseInt(this.state[e])}getBoolean(e){return"false"!=this.state[e]}getString(e){return this.state[e]}setEventsEnabled(e){this.fireEvents=e}}},{"./constants":18,"./fields":70,"./fields/field_imagenotext":38,"./loader":77,"./plugins/duplicateOnDrag":91,"./toolbox":139,blockly:175}],18:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.optionalInputWithFieldPrefix=r.optionalDummyInputPrefix=r.provider=void 0;e=e("blockly");r.provider=new e.zelos.ConstantProvider,r.optionalDummyInputPrefix="0_optional_dummy",r.optionalInputWithFieldPrefix="0_optional_field"},{blockly:175}],19:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.registerBlockitems=r.BlockContextWeight=void 0;let n=e("blockly"),i=e("../external");var s;(e=s=r.BlockContextWeight||(r.BlockContextWeight={}))[e.Duplicate=10]="Duplicate",e[e.Copy=15]="Copy",e[e.AddComment=20]="AddComment",e[e.ExpandCollapse=30]="ExpandCollapse",e[e.DeleteBlock=40]="DeleteBlock",e[e.Help=50]="Help",r.registerBlockitems=function(){n.ContextMenuRegistry.registry.unregister("blockDuplicate"),n.ContextMenuRegistry.registry.unregister("blockCollapseExpand"),n.ContextMenuRegistry.registry.unregister("blockHelp"),n.ContextMenuRegistry.registry.unregister("blockInline"),e={displayText(){return lf("Duplicate")},preconditionFn(e){e=e.block;return!e.isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden"},callback(t){if(t.block){let e=!1;t.block.duplicateOnDrag_&&(t.block.duplicateOnDrag_=!1,e=!0);var r=t.block.toCopyData();e&&(t.block.duplicateOnDrag_=!0),r&&n.clipboard.paste(r,t.block.workspace)}},scopeType:n.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDuplicate",weight:s.Duplicate},n.ContextMenuRegistry.registry.register(e),e={displayText(e){return e.block.isCollapsed()?pxt.U.lf("Expand Block"):pxt.U.lf("Collapse Block")},preconditionFn(e){let t=e.block;return t.workspace.getTopBlocks(!1).some(e=>e===t)&&0<t.statementInputCount&&!t.previousConnection&&!t.isInFlyout&&t.isMovable()&&t.workspace.options.collapse?"enabled":"hidden"},callback(e){e.block&&(pxt.tickEvent("blocks.context.expandCollapseBlock",void 0,{interactiveConsent:!0}),e.block.setCollapsed(!e.block.isCollapsed()))},scopeType:n.ContextMenuRegistry.ScopeType.BLOCK,id:"pxtExpandCollapseBlock",weight:s.ExpandCollapse},n.ContextMenuRegistry.registry.register(e),e={displayText(){return pxt.U.lf("Help")},preconditionFn(e){e=e.block;return("function"==typeof e.helpUrl?e.helpUrl():e.helpUrl)?"enabled":"hidden"},callback(e){e.block&&(e="function"==typeof(e=e.block).helpUrl?e.helpUrl():e.helpUrl)&&(0,i.openHelpUrl)(e)},scopeType:n.ContextMenuRegistry.ScopeType.BLOCK,id:"pxtHelpBlock",weight:s.Help},n.ContextMenuRegistry.registry.register(e);var e=n.ContextMenuRegistry.registry.getItem("blockDelete");e&&(e.weight=s.DeleteBlock),(e=n.ContextMenuRegistry.registry.getItem("blockComment"))&&(e.weight=s.AddComment)}},{"../external":25,blockly:175}],20:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.setupWorkspaceContextMenu=r.initContextMenu=void 0;let n=e("blockly"),i=e("./workspaceItems"),s=e("../external"),a=e("./blockItems"),o=!1;r.initContextMenu=function(){var e=n.Msg;e.DUPLICATE_BLOCK=lf("{id:block}Duplicate"),e.DUPLICATE_COMMENT=lf("Duplicate Comment"),e.REMOVE_COMMENT=lf("Remove Comment"),e.ADD_COMMENT=lf("Add Comment"),e.EXTERNAL_INPUTS=lf("External Inputs"),e.INLINE_INPUTS=lf("Inline Inputs"),e.EXPAND_BLOCK=lf("Expand Block"),e.COLLAPSE_BLOCK=lf("Collapse Block"),e.ENABLE_BLOCK=lf("Enable Block"),e.DISABLE_BLOCK=lf("Disable Block"),e.DELETE_BLOCK=lf("Delete Block"),e.DELETE_X_BLOCKS=lf("Delete Blocks"),e.DELETE_ALL_BLOCKS=lf("Delete All Blocks"),e.HELP=lf("Help"),o||(o=!0,(0,i.registerWorkspaceItems)(),(0,a.registerBlockitems)())},r.setupWorkspaceContextMenu=function(r){try{n.ContextMenuItems.registerCommentOptions()}catch(e){}r.configureContextMenu=(e,t)=>{(0,s.onWorkspaceContextMenu)(r,e)}}},{"../external":25,"./blockItems":19,"./workspaceItems":22,blockly:175}],21:[function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./contextMenu"),r)},{"./contextMenu":20}],22:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.registerWorkspaceItems=r.WorkspaceContextWeight=void 0;let a=e("blockly"),i=e("../layout"),n=e("../external");var o;(e=o=r.WorkspaceContextWeight||(r.WorkspaceContextWeight={}))[e.Paste=10]="Paste",e[e.DeleteAll=20]="DeleteAll",e[e.FormatCode=30]="FormatCode",e[e.CollapseBlocks=40]="CollapseBlocks",e[e.ExpandBlocks=50]="ExpandBlocks",e[e.Snapshot=60]="Snapshot",e[e.Find=70]="Find",r.registerWorkspaceItems=function(){var e;e={displayText(){return pxt.U.lf("Format Code")},preconditionFn(e){return e.workspace.options.readOnly?"hidden":"enabled"},callback(e){e.workspace&&(pxt.tickEvent("blocks.context.format",void 0,{interactiveConsent:!0}),(0,i.flow)(e.workspace,{useViewWidth:!0}))},scopeType:a.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtFormatCode",weight:o.FormatCode},a.ContextMenuRegistry.registry.register(e),e={displayText(){return pxt.U.lf("Snapshot")},preconditionFn(e){var t;return(0,i.screenshotEnabled)()?(t=(e=e.workspace).getTopBlocks(!1),e=e.getTopComments(!1),0===t.length&&0===e.length?"disabled":"enabled"):"hidden"},callback(n){n.workspace&&(pxt.tickEvent("blocks.context.screenshot",void 0,{interactiveConsent:!0}),(async()=>{let e,t,r=await(0,i.screenshotAsync)(n.workspace,null,null==(e=pxt.appTarget.appTheme)?void 0:e.embedBlocksInSnapshot);pxt.BrowserUtils.isSafari()&&(r=await(0,i.screenshotAsync)(n.workspace,null,null==(t=pxt.appTarget.appTheme)?void 0:t.embedBlocksInSnapshot)),pxt.BrowserUtils.isSafari()&&(r=r.replace(/^data:image\/[^;]/,"data:application/octet-stream")),pxt.BrowserUtils.browserDownloadDataUri(r,`${pxt.appTarget.nickname||pxt.appTarget.id}-${lf("screenshot")}.png`)})())},scopeType:a.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtSnapshotCode",weight:o.Snapshot},a.ContextMenuRegistry.registry.register(e),e={displayText(){return pxt.U.lf("Collapse Blocks")},preconditionFn(e){e=e.workspace;return e.options.readOnly||!pxt.appTarget.appTheme.blocksCollapsing?"hidden":e.getTopBlocks(!1).some(e=>e.isEnabled()&&!e.isCollapsed())?"enabled":"disabled"},callback(e){e.workspace&&(pxt.tickEvent("blocks.context.collapse",void 0,{interactiveConsent:!0}),(0,i.setCollapsedAll)(e.workspace,!0))},scopeType:a.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtCollapseBlocks",weight:o.CollapseBlocks},a.ContextMenuRegistry.registry.register(e),e={displayText(){return pxt.U.lf("Expand Blocks")},preconditionFn(e){e=e.workspace;return e.options.readOnly||!pxt.appTarget.appTheme.blocksCollapsing?"hidden":e.getTopBlocks(!1).some(e=>e.isEnabled()&&e.isCollapsed())?"enabled":"disabled"},callback(e){e.workspace&&(pxt.tickEvent("blocks.context.expand",void 0,{interactiveConsent:!0}),(0,i.setCollapsedAll)(e.workspace,!1))},scopeType:a.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtExpandBlocks",weight:o.ExpandBlocks},a.ContextMenuRegistry.registry.register(e);{let s=e=>{let r=[],n=e=>{if(e.isDeletable())r.push(...e.getDescendants(!1));else for(var t of e.getChildren(!1))n(t)};for(var t of e.getTopBlocks())n(t);return r},e={displayText(e){return 1<s(e.workspace).filter(e=>!e.isShadow()).length?pxt.U.lf("Delete All Blocks"):pxt.U.lf("Delete Block")},preconditionFn(e){return e.workspace.options.readOnly?"hidden":0===s(e.workspace).filter(e=>!e.isShadow()).length?"disabled":"enabled"},callback(e){if(e.workspace){let t=s(e.workspace);e=t.filter(e=>!e.isShadow()).length;let r=10,n=a.utils.idGenerator.genUid(),i=()=>{var e=t.shift();e&&(e.isDeadOrDying()?i():(a.Events.setGroup(n),e.dispose(!1,!0),a.Events.setGroup(!1),setTimeout(i,r)))};pxt.tickEvent("blocks.context.delete",void 0,{interactiveConsent:!0}),e<2?i():a.dialog.confirm(lf("Delete all {0} blocks?",e),e=>{e&&i()})}},scopeType:a.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtDeleteAllBlocks",weight:o.DeleteAll};a.ContextMenuRegistry.registry.register(e)}e={displayText(){return pxt.U.lf("Find")},preconditionFn(e){return e.workspace.options.readOnly||!pxt.appTarget.appTheme.workspaceSearch?"hidden":"enabled"},callback(e){e.workspace&&(pxt.tickEvent("blocks.context.find",void 0,{interactiveConsent:!0}),(0,n.openWorkspaceSearch)())},scopeType:a.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtWorkspaceFind",weight:o.Find},a.ContextMenuRegistry.registry.register(e),a.ContextMenuRegistry.registry.unregister("workspaceDelete"),a.ContextMenuRegistry.registry.unregister("expandWorkspace"),a.ContextMenuRegistry.registry.unregister("collapseWorkspace"),a.ContextMenuRegistry.registry.unregister("cleanWorkspace"),a.ContextMenuRegistry.registry.unregister("redoWorkspace"),a.ContextMenuRegistry.registry.unregister("undoWorkspace")}},{"../external":25,"../layout":75,blockly:175}],23:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.initAccessibleBlocksCopyPasteContextMenu=r.initCopyPaste=void 0;let i=e("blockly"),s=e("./external"),n=e("./contextMenu/blockItems"),a=e("./contextMenu/workspaceItems"),o=e("./plugins/duplicateOnDrag"),l,c,u;r.initCopyPaste=function(e){var t;l||!(0,s.getCopyPasteHandlers)()||(t=i.ShortcutRegistry.registry.getRegistry(),l=Object.assign({},t[i.ShortcutItems.names.COPY]),c=Object.assign({},t[i.ShortcutItems.names.CUT]),u=Object.assign({},t[i.ShortcutItems.names.PASTE]),i.ShortcutRegistry.registry.unregister(i.ShortcutItems.names.COPY),i.ShortcutRegistry.registry.unregister(i.ShortcutItems.names.CUT),i.ShortcutRegistry.registry.unregister(i.ShortcutItems.names.PASTE),t={name:i.ShortcutItems.names.COPY,preconditionFn(e,t){return m(e,t,l.preconditionFn)},callback:p,keyCodes:l.keyCodes},i.ShortcutRegistry.registry.register(t),t={name:i.ShortcutItems.names.CUT,preconditionFn(e,t){return m(e,t,c.preconditionFn)},callback(e,t,r,n){var i=null==(i=(0,s.getCopyPasteHandlers)())?void 0:i.cut;return i?i(e,t,r,n):c.callback(e,t,r,n)},keyCodes:c.keyCodes},i.ShortcutRegistry.registry.register(t),t={name:i.ShortcutItems.names.PASTE,preconditionFn(e,t){return!e.isReadOnly()&&!e.isDragging()&&!i.getFocusManager().ephemeralFocusTaken()},callback:h,keyCodes:u.keyCodes},i.ShortcutRegistry.registry.register(t),e)||(t={displayText:()=>lf("Copy"),preconditionFn:e=>{var t=e.block;return!t.isInFlyout&&t.isMovable()&&t.isEditable()?(t=(0,s.getCopyPasteHandlers)())?t.copyPrecondition(e):"enabled":"hidden"},callback:function(e,t){var r=e.block;r&&(r.select(),p(r.workspace,t,void 0,e))},scopeType:i.ContextMenuRegistry.ScopeType.BLOCK,weight:n.BlockContextWeight.Copy,id:"makecode-copy-block"},e={displayText:()=>lf("Copy"),preconditionFn:e=>{var t=e.comment;return t.isMovable()&&t.isEditable()?(t=(0,s.getCopyPasteHandlers)())?t.copyPrecondition(e):"enabled":"hidden"},callback:function(e,t){var r=e.comment;r&&(r.select(),p(r.workspace,t,void 0,e))},scopeType:i.ContextMenuRegistry.ScopeType.COMMENT,weight:n.BlockContextWeight.Copy,id:"makecode-copy-comment"},i.ContextMenuRegistry.registry.register(t),i.ContextMenuRegistry.registry.register(e),t={displayText:()=>lf("Paste"),preconditionFn:d,callback:function(e,t){var r=e.workspace;r&&h(r,t,void 0,e)},scopeType:i.ContextMenuRegistry.ScopeType.WORKSPACE,weight:a.WorkspaceContextWeight.Paste,id:"makecode-paste"},i.ContextMenuRegistry.registry.register(t))},r.initAccessibleBlocksCopyPasteContextMenu=function(){var e=i.ContextMenuRegistry.registry.getItem("blockPasteFromContextMenu");if("separator"in e)throw new Error(`RegistryItem ${e.id} is not of type ActionRegistryItem`);if(e=Object.assign(Object.assign({},e),{preconditionFn:d}),i.ContextMenuRegistry.registry.unregister("blockPasteFromContextMenu"),i.ContextMenuRegistry.registry.register(e),"separator"in(e=i.ContextMenuRegistry.registry.getItem("blockCutFromContextMenu")))throw new Error(`RegistryItem ${e.id} is not of type ActionRegistryItem`);e=Object.assign(Object.assign({},e),{preconditionFn:e=>{var t,r=e.focusedNode;return r&&i.isCopyable(r)&&(t=r.workspace,!r.workspace.isFlyout)&&t instanceof i.WorkspaceSvg&&c.preconditionFn(t,e)?"enabled":"hidden"}}),i.ContextMenuRegistry.registry.unregister("blockCutFromContextMenu"),i.ContextMenuRegistry.registry.register(e)};let d=e=>{var t;return pxt.shell.isReadOnly()||null!=(t=e.workspace)&&t.options.readOnly?"hidden":(t=(0,s.getCopyPasteHandlers)())?t.pastePrecondition(e):"enabled"},p=(e,t,r,n)=>{var i=null==(i=(0,s.getCopyPasteHandlers)())?void 0:i.copy;return i?i(e,t,r,n):l.callback(e,t,r,n)},h=(e,t,r,n)=>{var i=null==(i=(0,s.getCopyPasteHandlers)())?void 0:i.paste;return i?i(e,t,r,n):u.callback(e,t,r,n)};function m(e,t,r){var n=i.getFocusManager().getFocusedNode(),r=(n instanceof i.BlockSvg&&(0,o.shouldDuplicateOnDrag)(n)&&n.setDeletable(!0),r(e,t));return(0,o.updateDuplicateOnDragState)(n),r}},{"./contextMenu/blockItems":19,"./contextMenu/workspaceItems":22,"./external":25,"./plugins/duplicateOnDrag":91,blockly:175}],24:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.decompiledDiffAsync=r.mergeXml=r.diffXml=r.needsDecompiledDiff=void 0;let w=e("blockly"),I=e("./importer"),A=e("./render");r.needsDecompiledDiff=function(e,t){if(!e||!t)return!1;let r={};if(e.replace(/id="([^"]+)"/g,(e,t)=>(r[t]=!0,"")),!Object.keys(r).length)return!1;let n=0,i=0;return t.replace(/id="([^"]+)"/g,(e,t)=>(n++,r[t]&&i++,"")),0<n&&0==i},r.diffXml=function(e,t,r){return i((0,I.loadWorkspaceXml)(e,!0),(0,I.loadWorkspaceXml)(t,!0),r)};let D="#d0d0d0";function i(h,m,g){try{w.Events.disable();{var f=h;var _=m;var y=g;pxt.tickEvent("blocks.diff",{started:1}),y=y||{};let i=N();if(!f)return{ws:void 0,message:lf("All blocks are new."),added:0,deleted:0,modified:1};if(!_)return{ws:void 0,message:lf("The current blocks seem corrupted."),added:0,deleted:0,modified:1};let n=pxt.Util.toDictionary(f.getTopBlocks(!1),e=>R(e,!0)),e=(_.getTopBlocks(!1).forEach(e=>{var t=R(e,!0),r=f.getBlockById(e.id)||n[t];r&&t==R(r,!0)&&(i("fast unmodified top ",e.id),e.dispose(!1),r.dispose(!1))}),f.getAllBlocks(!1).filter(e=>e.isEnabled())),t=f.getTopBlocks(!1).filter(e=>e.isEnabled()),r=_.getAllBlocks(!1).filter(e=>e.isEnabled());if(i("blocks",r.map(e=>e.toDevString())),i(r),0==e.length&&0==r.length)return pxt.tickEvent("blocks.diff",{moves:1}),{ws:void 0,message:lf("Some blocks were moved or changed."),added:0,deleted:0,modified:1};let s=t.filter(e=>!_.getBlockById(e.id)),a=e.filter(e=>!_.getBlockById(e.id)),o=r.filter(e=>!f.getBlockById(e.id)),l=(0,A.initRenderingWorkspace)(),c=(0,I.saveWorkspaceXml)(_,!0),u=((0,I.domToWorkspaceNoEvents)(w.utils.xml.textToDom(c),l),l.getAllBlocks(!1).filter(e=>!e.isEnabled()).forEach(e=>{i("disabled ",e.toDevString()),e.dispose(!1)}),pxt.Util.toDictionary(l.getAllBlocks(!1),e=>e.id)),d=(i("todo blocks",u),C("start"),y.hideDeletedTopBlocks||(s.forEach(e=>{i("deleted top "+e.toDevString()),S(e);e=x(e);S(e),e.setDisabledReason(!0,O)}),C("deleted top")),o.map(e=>l.getBlockById(e.id)).filter(e=>!!e).forEach(e=>{i("added "+e.toDevString()),S(e)}),C("added"),{}),p=(y.hideDeletedBlocks||((b=a.filter(e=>!(u[e.id]||k(e)||e.outputConnection&&e.outputConnection.isConnected()))).forEach(e=>{var t=x(e);d[e.id]=t.id,i(`deleted block ${e.toDevString()}->`+t.toDevString())}),b.forEach(e=>{i(`stitching ${e.toDevString()}->`+d[e.id]);var t=l.getBlockById(d[e.id]),r=(t.setDisabledReason(!0,O),T(t),S(t),e.getPreviousBlock());r&&(r=l.getBlockById(d[r.id])||l.getBlockById(r.id),i(`previous ${e.id}->${t.toDevString()}: `+r.toDevString()),r)&&(r.nextConnection?t.previousConnection.connect(r.nextConnection):(r=r.inputList.slice().reverse().find(e=>e.connection&&e.connection.type==w.NEXT_STATEMENT))&&t.previousConnection.connect(r.connection)),(r=e.getNextBlock())&&(r=l.getBlockById(d[r.id])||l.getBlockById(r.id))&&(i(`next ${e.id}->${t.toDevString()}: `+r.toDevString()),t.nextConnection.connect(r.previousConnection))})),0);if(pxt.Util.values(u).filter(e=>{var t,r,n=f.getBlockById(e.id);return!!n&&!((t=e.getPreviousBlock())&&!u[t.id]||(e=e.getNextBlock())&&!u[e.id]||!(r=n.getPreviousBlock())&&!t||!!r==!!t&&r.id==t.id&&(!(r=n.getNextBlock())&&!e||!!r==!!e&&r.id==e.id))}).forEach(e=>{i("moved "+e.toDevString()),delete u[e.id],T(e),p++}),C("moved"),pxt.Util.values(u).filter(e=>{var t,r,n=f.getBlockById(e.id);return!!n&&(t=R(n),r=R(e),t!=r)&&(i("old "+n.toDevString(),t),i("new "+e.toDevString(),r),!0)}).forEach(e=>{i("changed "+e.toDevString()),delete u[e.id],T(e),p++}),C("changed"),l.getTopBlocks(!1).forEach(e=>{e.getDescendants(!1).find(e=>k(e))||(i("unmodified top "+e.toDevString()),delete u[e.id],e.dispose(!1))}),C("cleaned"),pxt.Util.values(u).filter(e=>!!l.getBlockById(e.id)).forEach(e=>{!function t(e){e.setColour(D);E(e);y.statementsOnly&&(e.inputList||[]).map(e=>e.type==w.inputs.inputTypes.VALUE&&e.connection&&e.connection.targetBlock()).filter(e=>!!e).forEach(e=>t(e))}(e)}),C("unmodified"),!l.getAllBlocks(!1).length)return pxt.tickEvent("blocks.diff",{missed:1}),{ws:l,message:lf("Some blocks were changed."),deleted:a.length,added:o.length,modified:p};l.resize(),w.svgResize(l);var b=(0,A.renderWorkspace)(y.renderOptions||{emPixels:20,layout:4,aspectRatio:.5,useViewWidth:!0}),v={ws:l,svg:b,deleted:a.length,added:o.length,modified:p};return pxt.tickEvent("blocks.diff",{deleted:v.deleted,added:v.added,modified:v.modified}),v;function T(e){e.__pxt_used=!0}function k(e){return!!e.__pxt_used}function x(e){e=w.Xml.blockToDom(e,!1),e=w.Xml.domToBlock(e,l);return e.nextConnection&&e.nextConnection.targetConnection&&e.nextConnection.disconnect(),e.previousConnection&&e.previousConnection.targetConnection&&e.previousConnection.disconnect(),e}function E(e){e.inputList.forEach(e=>e.fieldRow.forEach(e=>{e.init()}))}function S(e){e.getDescendants(!1).forEach(e=>{delete u[e.id],T(e)})}function C(e){i(e+":",pxt.Util.values(u).map(e=>e.toDevString()))}return}}catch(e){return pxt.reportException(e),{ws:void 0,message:lf("Oops, we could not diff those blocks."),error:e,deleted:0,added:0,modified:0}}finally{w.Events.enable()}}function N(){return pxt.options.debug||window&&/diffdbg=1/.test(window.location.href)?pxt.log:e=>{}}let O="disabled_for_diff";function R(e,t){e=w.Xml.blockToDom(e,!0);return n(e),function e(t,r){if(!t)return;r(t);for(var n of pxt.Util.toArray(t.children))e(n,r)}(e,e=>{n(e),t||"next"!=e.localName&&"statement"!=e.localName&&"shadow"!=e.localName||e.remove()}),w.Xml.domToText(e)}function n(e){e.removeAttribute("id"),e.removeAttribute("x"),e.removeAttribute("y"),e.removeAttribute("deletable"),e.removeAttribute("editable"),e.removeAttribute("movable")}function m(n,i){if(i){let t,r;for(let e=0;e<n.length;++e){var s=n[e];s.startPos<=i.start&&s.endPos>=i.start+i.length&&(!t||r>s.endPos-s.startPos)&&(t=s,r=s.endPos-s.startPos)}return t?t.id:void 0}}r.mergeXml=function(e,t,r){return e==t?r:r==t?e:void 0},r.decompiledDiffAsync=function(e,o,t,l,r={}){let c=N();var n=o.outfiles[pxt.MAIN_BLOCKS];let u=l.outfiles[pxt.MAIN_BLOCKS],d=(c(n),c(u),e=pxt.diff.computeFormattedDiff(e,t,{ignoreWhitespace:!0,full:!0}),c(e),{}),p=0,h=0;return e.forEach((e,t)=>{var r=e[0],n=e.substr(2);let i=n.length;switch(r){case"-":p+=i+1;break;case"+":h+=i+1;break;default:var s,a=/^\s+/.exec(n),a=(a&&(a=a[0].length,p+=a,h+=a,i-=a),m(l.blockSourceMap,{start:h,length:i}));a&&!d[a]&&(s=m(o.blockSourceMap,{start:p,length:i}))&&(c(e),c(`id ${p}:${n.length}>${s} ==> ${h}:${n.length}>`+a),d[a]=s,u=u.replace(a,s)),p+=i+1,h+=i+1}}),t=(0,I.loadWorkspaceXml)(n,!0),e=(0,I.loadWorkspaceXml)(u,!0),r.statementsOnly=!0,i(t,e,r)}},{"./importer":73,"./render":137,blockly:175}],25:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getCopyPasteHandlers=r.setCopyPaste=r.openWorkspaceSearch=r.setOpenWorkspaceSearch=r.prompt=r.setPrompt=r.setOnWorkspaceContextMenu=r.onWorkspaceContextMenu=r.setOpenHelpUrl=r.openHelpUrl=r.setExtensionBlocklyPatch=r.extensionBlocklyPatch=r.setPromptTranslateBlock=r.promptTranslateBlock=void 0;let i=e("blockly"),n;r.promptTranslateBlock=function(e,t){n&&n(e,t)},r.setPromptTranslateBlock=function(e){n=e};let s;r.extensionBlocklyPatch=function(e,t){s&&s(e,t)},r.setExtensionBlocklyPatch=function(e){s=e};let a;r.openHelpUrl=function(e){a?a(e):window.open(e)},r.setOpenHelpUrl=function(e){a=e};let o;r.onWorkspaceContextMenu=function(e,t){o&&o(e,t)},r.setOnWorkspaceContextMenu=function(e){o=e};let l;r.setPrompt=function(e,t){t&&i.dialog.setPrompt(e),l=e},r.prompt=function(e,t,r,n){l?l(e,t,r,n):i.dialog.prompt(e,t,r)};let c;r.setOpenWorkspaceSearch=function(e){c=e},r.openWorkspaceSearch=function(){c&&c()};let u,d,p,h,m;r.setCopyPaste=function(e,t,r,n,i){u=e,d=t,p=r,h=n,m=i},r.getCopyPasteHandlers=function(){return u?{copy:u,cut:d,paste:p,copyPrecondition:h,pastePrecondition:m}:null}},{blockly:175}],26:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createFieldEditor=r.registerFieldEditor=r.initFieldEditors=void 0;let n=e("./field_animation"),i=e("./field_tilemap"),s=e("./field_textinput"),a=e("./field_sprite"),o=e("./field_gridpicker"),l=e("./field_colour"),c=e("./field_images"),u=e("./field_textdropdown"),d=e("./field_numberdropdown"),p=e("./field_imagedropdown"),h=e("./field_note"),m=e("./field_melodySandbox"),g=e("./field_toggle"),f=e("./field_toggle_downup"),_=e("./field_toggle_highlow"),y=e("./field_toggle_onoff"),b=e("./field_toggle_updown"),v=e("./field_toggle_winlose"),T=e("./field_toggle_yesno"),k=e("./field_protractor"),x=e("./field_position"),E=e("./field_speed"),S=e("./field_tileset"),C=e("./field_turnratio"),w=e("./field_musiceditor"),I=e("./field_sound_effect"),A=e("./field_autocomplete"),D=e("./field_colorwheel"),N=e("./field_scopedvalueselector"),O={};function R(e,t,r){null==O[e]&&(O[e]={field:t,validator:r})}r.initFieldEditors=function(){var e;R("text",s.FieldTextInput),R("note",h.FieldNote),R("gridpicker",o.FieldGridPicker),R("textdropdown",u.FieldTextDropdown),R("numberdropdown",d.FieldNumberDropdown),R("imagedropdown",p.FieldImageDropdown),R("colorwheel",D.FieldColorWheel),R("toggle",g.FieldToggle),R("toggleonoff",y.FieldToggleOnOff),R("toggleyesno",T.FieldToggleYesNo),R("toggleupdown",b.FieldToggleUpDown),R("toggledownup",f.FieldToggleDownUp),R("togglehighlow",_.FieldToggleHighLow),R("togglewinlose",v.FieldToggleWinLose),R("colornumber",l.FieldColorNumber),R("images",c.FieldImages),R("sprite",a.FieldSpriteEditor),R("animation",n.FieldAnimationEditor),R("tilemap",i.FieldTilemap),R("tileset",S.FieldTileset),R("speed",E.FieldSpeed),R("turnratio",C.FieldTurnRatio),R("protractor",k.FieldProtractor),R("position",x.FieldPosition),R("melody",m.FieldCustomMelody),R("soundeffect",I.FieldSoundEffect),R("autocomplete",A.FieldAutoComplete),R("scopedvalueselector",N.FieldScopedValueSelector),null!=(e=pxt.appTarget.appTheme)&&e.songEditor&&R("musiceditor",w.FieldMusicEditor)},r.registerFieldEditor=R,r.createFieldEditor=function(e,t,r){return null==O[e]?(pxt.error(`Field editor ${e} not registered`),null):(pxt.Util.assert(null==(r=r||{}).lightMode,"lightMode is a reserved parameter for custom fields"),r.lightMode=pxt.options.light,new(e=O[e]).field(t,r,e.validator))}},{"./field_animation":27,"./field_autocomplete":30,"./field_colorwheel":32,"./field_colour":33,"./field_gridpicker":36,"./field_imagedropdown":37,"./field_images":39,"./field_melodySandbox":43,"./field_musiceditor":44,"./field_note":45,"./field_numberdropdown":46,"./field_position":47,"./field_protractor":49,"./field_scopedvalueselector":50,"./field_sound_effect":51,"./field_speed":52,"./field_sprite":53,"./field_textdropdown":55,"./field_textinput":56,"./field_tilemap":57,"./field_tileset":58,"./field_toggle":59,"./field_toggle_downup":60,"./field_toggle_highlow":61,"./field_toggle_onoff":62,"./field_toggle_updown":63,"./field_toggle_winlose":64,"./field_toggle_yesno":65,"./field_turnratio":67}],27:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldAnimationEditor=void 0;var n=pxt.svgUtil,i=e("./field_asset");let s=e("./field_utils");class a extends i.FieldAssetEditor{constructor(){super(...arguments),this.onMouseEnter=()=>{if(!this.animateRef&&this.asset){var t=this.getParentInterval()||this.asset.interval;let e=0;this.animateRef=setInterval(()=>{this.preview&&this.frames[e]&&this.preview.src(this.frames[e]),e=(e+1)%this.frames.length},50<t?t:50)}},this.onMouseLeave=()=>{this.animateRef&&clearInterval(this.animateRef),this.animateRef=void 0,this.preview&&this.frames[0]&&this.preview.src(this.frames[0])}}initView(){this.sourceBlock_.getSvgRoot().addEventListener("mouseenter",this.onMouseEnter),this.sourceBlock_.getSvgRoot().addEventListener("mouseleave",this.onMouseLeave)}showEditor_(){this.asset&&(this.asset.interval=this.getParentInterval()||this.asset.interval),super.showEditor_()}render_(){super.render_(),this.size_.height=42,this.size_.width=80}getAssetType(){return"animation"}createNewAsset(e){var t,r=pxt.react.getTilemapProject();if(e){var n=pxt.lookupProjectAssetByTSReference(e,r);if(n)return n;n=e,t=this.params.taggedTemplate;n=-1===n.indexOf("[")?null:(n=n.replace(/[\[\]]/gm,"")).split(",").map(e=>pxt.sprite.imageLiteralToBitmap(e,t).data()).filter(e=>e.height&&e.width);if(n&&n.length){let e=this.temporaryAssetId(),t={internalID:-1,id:e,type:"animation",frames:n,interval:this.getParentInterval(),meta:{}};return t}n=r.lookupAssetByName("animation",e.trim());if(n)return n}let i=this.temporaryAssetId();r=new pxt.sprite.Bitmap(this.params.initWidth,this.params.initHeight).data();let s={internalID:-1,id:i,type:"animation",frames:[r],interval:500,meta:{}};return s}onEditorClose(e){this.setParentInterval(e.interval)}getValueText(){return this.asset?this.isTemporaryAsset()?"["+this.asset.frames.map(e=>pxt.sprite.bitmapToImageLiteral(pxt.sprite.Bitmap.fromData(e),"typescript",this.params.taggedTemplate)).join(",")+"]":pxt.getTSReferenceForAsset(this.asset):this.valueText||"[]"}redrawPreview(){var e;this.fieldGroup_&&(pxsim.U.clear(this.fieldGroup_),e=(new n.Rect).at(35,1).size(40,40).corner(4).setClass("blocklyAnimationField"),this.fieldGroup_.appendChild(e.el),e=new n.Text("").at(5,26).setClass("semanticIcon"),this.fieldGroup_.appendChild(e.el),this.asset)&&(this.frames=this.asset.frames.map(e=>(0,s.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(e),32,this.lightMode)),this.preview=(new n.Image).src(this.frames[0]).at(39,5).size(32,32),this.fieldGroup_.appendChild(this.preview.el))}getParentIntervalBlock(){var e,t=this.sourceBlock_;if(t.getParent())for(e of t.getParent().inputList)if("frameInterval"===e.name)return e.connection.targetBlock()}setParentInterval(e){var t,r=this.getParentIntervalBlock();r&&(t=o(r))&&r.setFieldValue(String(e),t)}getParentInterval(){var e=this.getParentIntervalBlock();if(e){var t=o(e);if(t)return Number(e.getFieldValue(t))}return 100}parseFieldOptions(e){return r={initWidth:16,initHeight:16,disableResize:!1,lightMode:!1},(e=e)&&(r.lightMode=e.lightMode,e.filter&&(r.filter=e.filter),r.initWidth=t(e.initWidth,r.initWidth),r.initHeight=t(e.initHeight,r.initHeight),r.taggedTemplate=e.taggedTemplate),r;function t(e,t){e=parseInt(e);return isNaN(e)?t:e}var r}}function o(e){var t;return"math_number_minmax"===e.type?"SLIDER":"math_number"===(t=e.type)||"math_integer"===t||"math_whole_number"===t?"NUM":"timePicker"===e.type?"ms":null}r.FieldAnimationEditor=a},{"./field_asset":29,"./field_utils":69}],28:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldArgumentVariable=void 0;let n=e("blockly");class i extends n.FieldVariable{constructor(e){super(e),this.menuGenerator_=this.generateMenu}generateMenu(){return n.FieldVariable.dropdownCreate.call(this).filter(e=>e[1]!=n.DELETE_VARIABLE_ID)}}r.FieldArgumentVariable=i},{blockly:175}],29:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.BlocklyTilemapChange=r.FieldAssetEditor=void 0;let u=e("blockly");var n=pxt.svgUtil,i=e("./field_base");let d=e("./field_utils");class s extends i.FieldBase{constructor(e,t,r){super(e,t,r),this.pendingEdit=!1,this.isEmpty=!1,this.assetChangeListener=()=>{var e;this.pendingEdit||((e=this.getBlockData())&&(this.asset=pxt.react.getTilemapProject().lookupAsset(this.getAssetType(),e)),this.redrawPreview())},this.lightMode=t.lightMode,this.params=this.parseFieldOptions(t),this.blocksInfo=t.blocksInfo}onInit(){this.redrawPreview()}onValueChanged(e){return this.parseValueText(e),this.redrawPreview(),this.getValueText()}saveState(e){return this.asset&&!this.isTemporaryAsset()?(0,d.getAssetSaveState)(this.asset):super.saveState(e)}loadState(e){"string"==typeof e?super.loadState(e):(e=(0,d.loadAssetFromSaveState)(e),super.loadState(pxt.getTSReferenceForAsset(e)),this.asset=e,this.setBlockData(this.asset.id))}showEditor_(){if(!this.isGreyBlock){var t=Object.assign({},this.params);t.blocksInfo=this.blocksInfo;let e;switch(this.asset.type){case"tile":case"image":e="image-editor",t.temporaryAssets=(0,d.getTemporaryAssets)(this.sourceBlock_.workspace,"image");break;case"animation":e="animation-editor",t.temporaryAssets=(0,d.getTemporaryAssets)(this.sourceBlock_.workspace,"image").concat((0,d.getTemporaryAssets)(this.sourceBlock_.workspace,"animation"));break;case"tilemap":e="tilemap-editor";var r,n=pxt.react.getTilemapProject();pxt.sprite.addMissingTilemapTilesAndReferences(n,this.asset);for(r of(0,d.getTilesReferencedByTilesets)(this.sourceBlock_.workspace))-1===this.asset.data.projectReferences.indexOf(r.id)&&this.asset.data.projectReferences.push(r.id);break;case"song":e="music-editor",t.temporaryAssets=(0,d.getTemporaryAssets)(this.sourceBlock_.workspace,"song"),(0,d.setMelodyEditorOpen)(this.sourceBlock_,!0)}this.isFullscreen()?this.showEditorFullscreen(e,t):this.showEditorInWidgetDiv(e,t)}}getFieldDescription(){var e;return(null==(e=null==(e=this.asset)?void 0:e.meta)?void 0:e.displayName)||this.getAssetType().toString()}showEditorFullscreen(e,t){let r=pxt.react.getFieldEditorView(e,this.asset,t);this.undoRedoState&&r.restorePersistentData(this.undoRedoState),pxt.react.getTilemapProject().pushUndo(),r.onHide(()=>{this.onFieldEditorHide(r)}),r.show()}showEditorInWidgetDiv(e,t){let r,n={getScaledBBox:()=>r},i=(u.WidgetDiv.show(n,this.sourceBlock_.RTL,()=>{document.activeElement&&"INPUT"===document.activeElement.tagName&&document.activeElement.blur(),s.hide(),i.classList.remove("sound-effect-editor-widget"),i.style.transform="",i.style.position="",i.style.left="",i.style.top="",i.style.width="",i.style.height="",i.style.opacity="",i.style.transition="",i.style.alignItems="",this.onFieldEditorHide(s)}),u.WidgetDiv.getDiv()),s=pxt.react.getFieldEditorView(e,this.asset,t,i);var e=this.sourceBlock_,t=e.getBoundingRectangle(),a=(0,d.workspaceToScreenCoordinates)(e.workspace,new u.utils.Coordinate(t.right,t.top));var o=a.x-400,a=a.y+60-20,o=(i.style.opacity="0",i.classList.add("sound-effect-editor-widget"),i.style.position="absolute",i.style.left=o+"px",i.style.top=a+"px",i.style.width="50rem",i.style.height="34.25rem",i.style.display="flex",i.style.alignItems="center",i.style.transition="transform 0.25s ease 0s, opacity 0.25s ease 0s",i.style.borderRadius="",s.onHide(()=>{u.WidgetDiv.hideIfOwner(n)}),s.show(),i.getBoundingClientRect()),a=e.workspace.getInjectionDiv().getBoundingClientRect(),l=(o.height>a.height?(i.style.height="",i.style.top="calc(1rem - 20px)",i.style.bottom="calc(1rem + 20px)"):(o.bottom>a.bottom||o.top<a.top)&&(i.style.top=a.top+a.height/2-o.height/2-20+"px"),e.workspace.getToolbox().getWidth()),c=a.left+l,t=(o.width>a.width-l?(i.style.width="",i.style.left="1rem",i.style.right="1rem"):o.left+o.width>=a.right?(e=(0,d.workspaceToScreenCoordinates)(e.workspace,new u.utils.Coordinate(t.left,t.top))).x-o.width-20>c?i.style.left=e.x-o.width-20+"px":i.style.left=c+(a.width-l)/2-o.width/2+"px":o.left<a.left&&(i.style.left=c+"px"),i.getBoundingClientRect());r=new u.utils.Rect(t.top,t.bottom,t.left,t.right),requestAnimationFrame(()=>{i.style.opacity="1",i.style.transform="translateY(20px)"})}onFieldEditorHide(e){var t,r,n,i,s=e.getResult(),a=pxt.react.getTilemapProject();"song"===this.asset.type&&(0,d.setMelodyEditorOpen)(this.sourceBlock_,!1),s&&(t=this.getValue(),pxt.assetEquals(this.asset,s)||(s=pxt.patchTemporaryAsset(this.asset,s,a),r=o(this.asset)?null:this.asset.id,n=o(s)?null:s.id,this.pendingEdit=!0,null!=(i=s.meta)&&i.displayName&&this.disposeOfTemporaryAsset(),this.asset=s,i=a.revision(),this.onEditorClose(this.asset),this.updateAssetListener(),this.updateAssetMeta(),this.redrawPreview(),this.undoRedoState=e.getPersistentData(),this.sourceBlock_&&u.Events.isEnabled()&&(s=new l(this.sourceBlock_,"field",this.name,t,this.getValue(),i,a.revision()),r!==n&&(s.oldAssetId=r,s.newAssetId=n),u.Events.fire(s)),this.pendingEdit=!1))}render_(){this.isGreyBlock&&!this.textElement_&&this.createTextElement_(),super.render_(),this.isGreyBlock||(this.size_.height=42,this.size_.width=50)}getDisplayText_(){var e;return this.isGreyBlock?(e=pxt.Util.htmlUnescape(this.valueText)).substr(0,e.indexOf("("))+"(...)":""}updateEditable(){var e;this.isGreyBlock&&this.fieldGroup_?(e=this.fieldGroup_,u.utils.dom.removeClass(e,"blocklyNonEditableText"),u.utils.dom.removeClass(e,"blocklyEditableText"),e.style.cursor=""):super.updateEditable()}getValue(){return this.isGreyBlock?pxt.Util.htmlUnescape(this.valueText):this.getValueText()}onDispose(){var e;null!=(e=this.sourceBlock_)&&e.workspace&&!this.sourceBlock_.workspace.rendered&&this.disposeOfTemporaryAsset(),pxt.react.getTilemapProject().removeChangeListener(this.getAssetType(),this.assetChangeListener)}disposeOfTemporaryAsset(){this.isTemporaryAsset()&&(pxt.react.getTilemapProject().removeAsset(this.asset),this.setBlockData(null),this.asset=void 0)}clearTemporaryAssetData(){this.isTemporaryAsset()&&this.setBlockData(null)}isTemporaryAsset(){return o(this.asset)}getAsset(){return this.asset}updateAsset(e){this.asset=e,this.setValue(this.getValue())}onEditorClose(e){}redrawPreview(){if(this.fieldGroup_)if(pxsim.U.clear(this.fieldGroup_),this.isGreyBlock)this.createTextElement_(),this.render_(),this.updateEditable();else{var t=(new n.Rect).at(5,1).size(40,40).setClass("blocklySpriteField").stroke("#898989",1).corner(4);if(this.fieldGroup_.appendChild(t.el),this.asset){let e;switch(this.asset.type){case"image":case"tile":e=(0,d.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(this.asset.bitmap),32,this.lightMode);break;case"animation":e=(0,d.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(this.asset.frames[0]),32,this.lightMode);break;case"tilemap":e=(0,d.tilemapToImageURI)(this.asset.data,32,this.lightMode);break;case"song":e=(0,d.songToDataURI)(this.asset.song,60,20,this.lightMode)}e&&(t=(new n.Image).src(e).at(9,5).size(32,32),this.fieldGroup_.appendChild(t.el))}}}parseValueText(e){var t,r;e=pxt.Util.htmlUnescape(e),this.sourceBlock_&&(t=pxt.react.getTilemapProject(),r=this.getBlockData(),!(r=t.lookupAsset(this.getAssetType(),r))||e&&this.isEmpty?(this.setBlockData(null),this.asset&&this.sourceBlock_&&this.asset.meta.blockIDs&&(this.asset.meta.blockIDs=this.asset.meta.blockIDs.filter(e=>e!==this.sourceBlock_.id),this.isTemporaryAsset()||t.updateAsset(this.asset)),this.isEmpty=!e,this.asset=this.createNewAsset(e)):this.asset=r,this.updateAssetMeta(),this.updateAssetListener())}parseFieldOptions(e){var t={initWidth:16,initHeight:16,disableResize:!1,lightMode:!1};return e&&(e.disableResize&&(t.disableResize="true"===e.disableResize.toLowerCase()||"1"===e.disableResize),t.initWidth=r(e.initWidth,t.initWidth),t.initHeight=r(e.initHeight,t.initHeight),t.lightMode=e.lightMode),t;function r(e,t){e=parseInt(e);return isNaN(e)?t:e}}updateAssetMeta(){var e;this.asset&&(this.asset.meta||(this.asset.meta={}),this.asset.meta.blockIDs||(this.asset.meta.blockIDs=[]),this.sourceBlock_&&(-1===this.asset.meta.blockIDs.indexOf(this.sourceBlock_.id)&&((e=this.asset.meta.blockIDs).length&&this.isTemporaryAsset()&&e.some(e=>this.sourceBlock_.workspace.getBlockById(e))&&(this.asset=pxt.cloneAsset(this.asset),this.asset.meta.blockIDs=[]),this.asset.meta.blockIDs.push(this.sourceBlock_.id)),this.setBlockData(this.isTemporaryAsset()?null:this.asset.id)),this.isTemporaryAsset()?this.asset.meta.temporaryInfo={blockId:this.sourceBlock_.id,fieldName:this.name}:pxt.react.getTilemapProject().updateAsset(this.asset))}updateAssetListener(){pxt.react.getTilemapProject().removeChangeListener(this.getAssetType(),this.assetChangeListener),this.asset&&!this.isTemporaryAsset()&&pxt.react.getTilemapProject().addChangeListener(this.asset,this.assetChangeListener)}isFullscreen(){return!0}temporaryAssetId(){return this.sourceBlock_.id+"_"+this.name}}function o(e){return e&&!e.meta.displayName}r.FieldAssetEditor=s;class l extends u.Events.BlockChange{constructor(e,t,r,n,i,s,a){super(e,t,r,n,i),this.oldRevision=s,this.newRevision=a,this.fieldName=r}isNull(){return this.oldRevision===this.newRevision&&super.isNull()}run(e){(this.newAssetId||this.oldAssetId)&&(t=this.getEventWorkspace_().getBlockById(this.blockId),e?(0,d.setBlockDataForField)(t,this.fieldName,this.newAssetId):(0,d.setBlockDataForField)(t,this.fieldName,this.oldAssetId)),e?pxt.react.getTilemapProject().redo():pxt.react.getTilemapProject().undo(),super.run(e);var t=this.getEventWorkspace_(),e=new l(t.getBlockById(this.blockId),"tilemap-revision","revision",null,pxt.react.getTilemapProject().revision(),0,0);e.recordUndo=!1,u.Events.fire(e)}}r.BlocklyTilemapChange=l},{"./field_base":31,"./field_utils":69,blockly:175}],30:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldAutoComplete=void 0;let n=e("blockly"),i=e("./field_utils");var s=e("./field_textdropdown");let a=e("../plugins/text");class o extends s.FieldTextDropdown{constructor(e,t,r){super(e,t,r),this.isFieldCustom_=!0,this.key=t.key,this.isTextValid_=!0}isOptionListDynamic(){return!0}getDisplayText_(){return this.parsedValue||""}getFieldDescription(){return this.getDisplayText_()}doValueUpdate_(e){this.isDirty_=!0,null!==e&&(/['"`].*['"`]/.test(e)?this.parsedValue=JSON.parse(e):this.parsedValue=e,this.value_=this.parsedValue)}getValue(){return this.parsedValue||""}getOptions(){var e=null==(e=this.sourceBlock_)?void 0:e.workspace;if(!e)return[];var r=[];for(let t of(0,i.getAllFields)(e,e=>e instanceof o&&e.getKey()===this.key).map(e=>e.ref.getDisplayText_()))t.trim()&&!r.some(e=>e[0]===t)&&r.push([t,t]);return r.sort((e,t)=>e[0].localeCompare(t[0])),r}showDropdown_(){this.getOptions().length&&super.showDropdown_()}getKey(){return this.key||(this.sourceBlock_?this.sourceBlock_.type:void 0)}initView(){this.quoteSize_=16,this.quoteWidth_=8,this.quoteLeftX_=0,this.quoteRightX_=0,this.quoteY_=10,this.quoteLeft_&&this.quoteLeft_.parentNode.removeChild(this.quoteLeft_),this.quoteLeft_=n.utils.dom.createSvgElement("text",{"font-size":this.quoteSize_+"px",class:"field-text-quote"},this.fieldGroup_),super.initView(),this.quoteRight_&&this.quoteRight_.parentNode.removeChild(this.quoteRight_),this.quoteRight_=n.utils.dom.createSvgElement("text",{"font-size":this.quoteSize_+"px",class:"field-text-quote"},this.fieldGroup_),this.quoteLeft_.appendChild(document.createTextNode('"')),this.quoteRight_.appendChild(document.createTextNode('"'))}updateSize_(){super.updateSize_();var e=Math.max(this.size_.width,1);let t=this.positionLeft(e+3);this.textElement_.setAttribute("x",t.toString()),t+=this.positionRight(t+e+3),this.size_.width=e+t}positionRight(e){if(!this.quoteRight_)return 0;let t=0;return t=(this.sourceBlock_.RTL?this.quoteRightX_=a.FieldString.quotePadding:this.quoteRightX_=e+a.FieldString.quotePadding,this.quoteWidth_+a.FieldString.quotePadding),this.quoteRight_.setAttribute("transform","translate("+this.quoteRightX_+","+this.quoteY_+")"),t}positionLeft(e){if(!this.quoteLeft_)return 0;let t=0;return t=(this.sourceBlock_.RTL?this.quoteLeftX_=e+this.quoteWidth_+2*a.FieldString.quotePadding:this.quoteLeftX_=0,this.quoteWidth_+a.FieldString.quotePadding),this.quoteLeft_.setAttribute("transform","translate("+this.quoteLeftX_+","+this.quoteY_+")"),t}createSVGArrow(){}}r.FieldAutoComplete=o},{"../plugins/text":134,"./field_textdropdown":55,"./field_utils":69,blockly:175}],31:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldBase=void 0;var n=e("blockly");let i=e("./field_utils");class s extends n.Field{constructor(e,t,r){super(e,r),this.SERIALIZABLE=!0,this.options=t,e&&!this.valueText&&(this.valueText=e)}static enqueueInit(e){s.pendingInit.push(e),this.pendingTimeout||(s.pendingTimeout=setTimeout(()=>s.flushInitQueue()))}static flushInitQueue(){for(var e of s.pendingInit)e.onLoadedIntoWorkspace();s.pendingTimeout=void 0,s.pendingInit=[]}init(){super.init(),this.onInit(),s.enqueueInit(this)}dispose(){this.onDispose()}getValue(){return this.valueText}doValueUpdate_(e){null!==e&&(this.valueText=this.loaded?this.onValueChanged(e):e)}getDisplayText_(){return this.valueText}onLoadedIntoWorkspace(){this.loaded||(this.loaded=!0,this.valueText=this.onValueChanged(this.valueText))}getFieldDescription(){return this.getDisplayText_()}getAnchorDimensions(){var e=this.getScaledBBox();return this.sourceBlock_.RTL?e.right+=s.CHECKMARK_OVERHANG:e.left-=s.CHECKMARK_OVERHANG,e}isInitialized(){return!!this.fieldGroup_}getBlockData(){return(0,i.getBlockDataForField)(this.sourceBlock_,this.name)}setBlockData(e){(0,i.setBlockDataForField)(this.sourceBlock_,this.name,e)}getSiblingBlock(e,t=!1){t=t?this.sourceBlock_.getParent():this.sourceBlock_;if(t&&t.inputList)for(var r of t.inputList)if(r.name===e)return r.connection.targetBlock()}getSiblingField(e,t=!1){t=t?this.sourceBlock_.getParent():this.sourceBlock_;if(t)return t.getField(e)}}(r.FieldBase=s).CHECKMARK_OVERHANG=25,s.pendingInit=[]},{"./field_utils":69,blockly:175}],32:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldColorWheel=void 0;e=e("../plugins/math");class n extends e.FieldSlider{constructor(e,t,r){super(String(e),"0","255","1","10","Color",r),this.isFieldCustom_=!0,this.params=t,this.params.min&&(this.min_=parseFloat(this.params.min)),this.params.max&&(this.max_=parseFloat(this.params.max)),this.params.label&&(this.labelText_=this.params.label),this.params.channel&&(this.channel_=this.params.channel)}setBackground_(e){var t=this.createColourStops_().join(",");e.style.background=`linear-gradient(left, ${t})`,this.params.sliderWidth&&(e.style.width=this.params.sliderWidth+"px")}setReadout_(e,t){var t=this.colorWheel(parseInt(t),this.channel_),r=document.createElement("span");r.className="blocklyColorReadout",r.style.backgroundColor=""+t,pxsim.U.clear(e),e.appendChild(r)}createColourStops_(){var t=[];for(let e=0;e<=255;e+=20)t.push(this.colorWheel(e,this.channel_));return t}colorWheel(e,t){return"hsvfast"==t?this.hsvFast(e,255,255):(e=255-e)<85?this.hex(3*e,255,255-3*e):e<170?this.hex(255,255-3*(e-=85),3*e):this.hex(255-3*(e-=170),3*e,255)}hsvFast(e,t,r){let n=e%255>>0;n<0&&(n+=255);var e=r*(255-t)/255>>0,t=r-e,r=(n=192*n/255>>0)/64>>0,i=n%64>>0,s=(i*t/63.75>>0)+e,i=((63-i)*t/63.75>>0)+e;let a,o,l;return l=r?1==r?(a=e,o=i,s):(a=s,o=e,i):(a=i,o=s,e),this.hex(a,o,l)}hex(e,t,r){return"#"+this.componentToHex(255&e)+this.componentToHex(255&t)+this.componentToHex(255&r)}componentToHex(e){e=e.toString(16);return 1==e.length?"0"+e:e}}r.FieldColorWheel=n},{"../plugins/math":119}],33:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldColorNumber=void 0;var n=e("@blockly/field-grid-dropdown");let i=e("blockly/core");class s extends n.FieldGridDropdown{constructor(e,t,r){let n,i,s;var a,o,l,c=null!=(n=t.valueMode)?n:"rgb";t.colours?0<(i=JSON.parse(t.colours)).lastIndexOf(i[0])&&(i[0]="#dedede"):pxt.appTarget.runtime&&pxt.appTarget.runtime.palette&&((i=pxt.Util.clone(pxt.appTarget.runtime.palette))[0]="#dedede",pxt.appTarget.runtime.paletteNames)&&((s=pxt.Util.clone(pxt.appTarget.runtime.paletteNames))[0]=lf("transparent")),super((a=c,o=i,l=s,o.map(e=>u(e,a,o)).map((e,t)=>{var r=document.createElement("div");return r.className="blocklyColourSwatch",r.style.backgroundColor=o[t],l&&t<l.length&&(r.title=l[t]),[r,e]})),r,{primaryColour:"white",borderColour:"#dadce0",columns:t.columns?parseInt(t.columns):7}),this.isFieldCustom_=!0,this.isDirty_=!1,this.allColoursCSSFormat_=i,this.valueMode_=c,this.setValue(e)}trimOptions(e){return{options:e}}initView(){var e=this.getConstants();if(!e)throw Error("Constants not found");this.size_=new i.utils.Size(e.FIELD_COLOUR_DEFAULT_WIDTH,e.FIELD_COLOUR_DEFAULT_HEIGHT),this.createBorderRect_(),this.getBorderRect().style.fillOpacity="1",this.getBorderRect().setAttribute("stroke","#fff"),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}showEditor_(e){super.showEditor_(e),i.DropDownDiv.getContentDiv().classList.add("blocklyFieldColour"),i.DropDownDiv.repositionForWindowResize()}isFullBlockField(){var e;if(this.getSourceBlock())return e=this.getConstants(),this.blockIsSimpleReporter()&&Boolean(null==e?void 0:e.FIELD_COLOUR_FULL_BLOCK);throw new i.UnattachedFieldError}blockIsSimpleReporter(){var e,t=this.getSourceBlock();if(!t)throw new i.UnattachedFieldError;if(!t.outputConnection)return!1;for(e of t.inputList)if(e.connection||1<e.fieldRow.length)return!1;return!0}applyColour(){var e=this.getSourceBlock();if(!e)throw new i.UnattachedFieldError;if(this.fieldGroup_){var t=this.borderRect_;if(!t)throw new Error("The border rect has not been initialized");this.isFullBlockField()?(t.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getCSSValue()),e.pathObject.svgPath.setAttribute("stroke","#fff")):(t.style.display="block",t.style.fill=this.getCSSValue())}}getSize(){var e;return null!=(e=this.getConstants())&&e.FIELD_COLOUR_FULL_BLOCK&&(this.render_(),this.isDirty_=!1),super.getSize()}render_(){this.updateSize_();var e=this.getSourceBlock();if(!e)throw new i.UnattachedFieldError;e.applyColour()}updateSize_(r){var n=this.getConstants();if(n){let e,t;t=this.isFullBlockField()?(e=2*(null!=r?r:0),n.FIELD_TEXT_HEIGHT):(e=n.FIELD_COLOUR_DEFAULT_WIDTH,n.FIELD_COLOUR_DEFAULT_HEIGHT),this.size_.height=t,this.size_.width=e,this.positionBorderRect_()}}doClassValidation_(e){return this.allColoursCSSFormat_?"string"!=typeof e?null:u(a(e,this.allColoursCSSFormat_),this.valueMode_,this.allColoursCSSFormat_):e}getText(){let e=this.getCSSValue();return e=/^#(.)\1(.)\2(.)\3$/.test(e)?"#"+e[1]+e[3]+e[5]:e}getFieldDescription(){var e=this.getCSSValue();return e?lf("color ${0}",e):lf("color")}getCSSValue(){return a(this.getValue(),this.allColoursCSSFormat_)}}function u(t,e,r){switch(e){case"hex":return`"${t}"`;case"rgb":return-1<t.indexOf("#")?"0x"+t.replace(/^#/,""):t;case"index":if(!t)return"-1";for(let e=0;e<r.length;e++)if(t.toUpperCase()===r[e].toUpperCase())return e+""}return t}function a(e,t){if(e){var r=/Colors\.([a-zA-Z]+)/.exec(e),n=/(0x|#)([0-9a-fA-F]+)/.exec(e);if(r)switch(r[1].toLocaleLowerCase()){case"red":return"#FF0000";case"orange":return"#FF7F00";case"yellow":return"#FFFF00";case"green":return"#00FF00";case"blue":return"#0000FF";case"indigo":return"#4B0082";case"violet":return"#8A2BE2";case"purple":return"#A033E5";case"pink":return"#FF007F";case"white":return"#FFFFFF";case"black":return"#000000";default:return e}else if(n){var i=n[2];if(3===i.length){let t="#";for(let e=0;e<i.length;e++){var s=i.charAt(e);t+=s+s}return t}if(6===i.length)return"#"+i}r=parseInt(e);return isNaN(r)||null==t[r]?t[0]:t[r]}return e}r.FieldColorNumber=s,i.Css.register(`
.blocklyColourSwatch {
    width: 22px;
    height: 22px;
}

.blocklyFieldColour.blocklyFieldGridContainer {
    padding: 0px;
}

.blocklyFieldColour .blocklyFieldGrid {
    grid-gap: 0px;
    row-gap: 0px;
    outline: none;
}

.blocklyFieldColour .blocklyFieldGrid .blocklyFieldGridItem {
    padding: 0;
    border: none;
    margin: 2px;
}

.blocklyFieldColour .blocklyFieldGrid .blocklyFieldGridItem .blocklyColourSwatch {
    border: 2px solid rgba(0,0,0,.1);
    border-radius: 4px;
}

.blocklyFieldColour .blocklyFieldGridItem:focus .blocklyColourSwatch {
    box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);
    border-color: #eee;
    border-width: 1px;
}

.blocklyFieldColour .blocklyFieldGrid .blocklyFieldGridItemSelected .blocklyColourSwatch {
    outline: 1px solid #000;
    border-color: #eee;
    border-width: 1px;
}
`)},{"@blockly/field-grid-dropdown":169,"blockly/core":174}],34:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldDropdown=void 0;let n=e("blockly"),i=e("../plugins/newVariableField/fieldDropdownMixin");class s extends n.FieldDropdown{constructor(){super(...arguments),this.svgRootBinding=null,this.fieldRootBinding=null}initView(){super.initView(),this.fieldGroup_&&this.fieldGroup_.classList.add("pxtFieldDropdown"),this.shouldAddBorderRect_()||(this.createBorderRect_(),this.clickTargetRect=this.borderRect_,this.clickTargetRect.setAttribute("stroke-opacity","0"),this.clickTargetRect.setAttribute("fill-opacity","0"),this.borderRect_=void 0)}shouldAddBorderRect_(){if("variables_get"===this.sourceBlock_.type)return!1;for(var e of this.sourceBlock_.inputList)for(var t of e.fieldRow)if(t!==this&&t.EDITABLE)return!0;return!this.sourceBlock_.getInputsInline()||super.shouldAddBorderRect_()}bindEvents_(){this.shouldAddBorderRect_()?super.bindEvents_():(this.svgRootBinding=n.browserEvents.conditionalBind(this.sourceBlock_.getSvgRoot(),"pointerdown",this,e=>{this.sourceBlock_.icons.length||this.onMouseDown_(e)},!1),this.fieldRootBinding=n.browserEvents.conditionalBind(this.getSvgRoot(),"pointerdown",this,e=>{this.sourceBlock_.icons.length&&this.onMouseDown_(e)},!1))}dispose(){super.dispose(),this.svgRootBinding&&(n.browserEvents.unbind(this.svgRootBinding),n.browserEvents.unbind(this.fieldRootBinding))}positionBorderRect_(){super.positionBorderRect_(),this.clickTargetRect&&(this.clickTargetRect.setAttribute("width",String(this.size_.width)),this.clickTargetRect.setAttribute("height",String(this.size_.height)),this.clickTargetRect.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.clickTargetRect.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}showEditor_(e){i.showEditorMixin.call(this,e)}}r.FieldDropdown=s,n.Css.register(`
.pxtFieldDropdown.blocklyActiveFocus > .blocklyFieldRect, .pxtFieldDropdown.blocklyPassiveFocus > .blocklyFieldRect {
    stroke-opacity: 1;
}
`)},{"../plugins/newVariableField/fieldDropdownMixin":121,blockly:175}],35:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldDropdownGrid=void 0;let s=e("blockly");e=e("./field_dropdown");class n extends e.FieldDropdown{constructor(){super(...arguments),this.isFieldCustom_=!0,this.gridItems=[],this.keyDownBinding=null,this.pointerMoveBinding=null}setFocusedItem(e,t){this.lastUserInputAction="keymove",this.setFocusedItem_(e),e.setAttribute("aria-activedescendant",":"+this.activeDescendantIndex),t.preventDefault(),t.stopPropagation()}setOpeningPointerCoords(e){var t;e&&({pageX:e,pageY:t}=e,void 0!==e)&&void 0!==t&&(this.openingPointerCoords={x:e,y:t})}addKeyDownHandler(r){let n=pxt.Util.isUserLanguageRtl()?"ArrowLeft":"ArrowRight",i=pxt.Util.isUserLanguageRtl()?"ArrowRight":"ArrowLeft";this.keyDownBinding=s.browserEvents.bind(r,"keydown",this,e=>{if(void 0===this.activeDescendantIndex){if("ArrowDown"===e.code||e.code===n||"Home"===e.code)return this.activeDescendantIndex=0,this.setFocusedItem(r,e);if("ArrowUp"===e.code||e.code===i||"End"===e.code)return this.activeDescendantIndex=this.gridItems.length-1,this.setFocusedItem(r,e)}var t=pxt.BrowserUtils.isMac()?e.metaKey:e.ctrlKey;switch(e.code){case"ArrowUp":0<=this.activeDescendantIndex-this.columns_&&(this.activeDescendantIndex-=this.columns_);break;case"ArrowDown":this.activeDescendantIndex+this.columns_<this.gridItems.length&&(this.activeDescendantIndex+=this.columns_);break;case n:this.activeDescendantIndex<this.gridItems.length-1&&this.activeDescendantIndex++;break;case i:0!==this.activeDescendantIndex&&this.activeDescendantIndex--;break;case"Home":if(t)this.activeDescendantIndex=0;else for(;this.activeDescendantIndex%this.columns_!=0;)this.activeDescendantIndex--;break;case"End":if(t)this.activeDescendantIndex=this.gridItems.length-1;else for(;this.activeDescendantIndex%this.columns_!=this.columns_-1&&this.activeDescendantIndex<this.gridItems.length-1;)this.activeDescendantIndex++;break;case"Enter":case"Space":return this.buttonClickAndClose_(this.gridItems[this.activeDescendantIndex].getAttribute("data-value")),e.preventDefault(),void e.stopPropagation();default:return}this.setFocusedItem(r,e)})}addPointerListener(e){this.pointerMoveBinding=s.browserEvents.bind(e,"pointermove",this,()=>{this.lastUserInputAction="pointermove"})}pointerMoveTriggeredByUser(){return this.openingPointerCoords&&!this.lastUserInputAction||"pointermove"===this.lastUserInputAction}pointerOutTriggeredByUser(){return"pointermove"===this.lastUserInputAction}disposeGrid(){this.keyDownBinding&&s.browserEvents.unbind(this.keyDownBinding),this.pointerMoveBinding&&s.browserEvents.unbind(this.pointerMoveBinding),this.keyDownBinding=null,this.pointerMoveBinding=null,this.openingPointerCoords=void 0,this.lastUserInputAction=void 0,this.activeDescendantIndex=void 0,this.gridItems=[]}}r.FieldDropdownGrid=n},{"./field_dropdown":34,blockly:175}],36:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldGridPicker=void 0;let d=e("blockly"),i=e("./field_utils"),n=e("./field_base");e=e("./field_dropdowngrid");class p extends e.FieldDropdownGrid{constructor(e,t,r){super(t.data),this.tabKeyBind=null,this.buttonClick_=e=>{null!==e&&(this.setValue(e),this.closeModal_)&&(this.close(),this.closeModal_=!1)},this.buttonClickAndClose_=e=>{this.closeModal_=!0,this.buttonClick_(e)},this.columns_=parseInt(t.columns)||4,this.maxRows_=parseInt(t.maxRows)||0,this.width_=parseInt(t.width)||void 0,this.backgroundColour_=(0,i.parseColour)(t.colour),this.borderColour_=pxt.toolbox.fadeColor(this.backgroundColour_,.4,!1);var n={xOffset:parseInt(t.tooltipsXOffset)||15,yOffset:parseInt(t.tooltipsYOffset)||-10};this.tooltipConfig_=n,this.hasSearchBar_=!!t.hasSearchBar||!1}setFocusedItem_(e){this.gridItems.forEach(e=>e.classList.remove("gridpicker-option-focused","gridpicker-menuitem-highlight"));var t=this.gridItems[this.activeDescendantIndex],r=(t.classList.add("gridpicker-option-focused"),d.utils.style.scrollIntoContainerView(t,this.scrollContainer),t.getBoundingClientRect());this.gridTooltip_&&(t=t.title||t.alt,this.gridTooltip_.textContent=t,this.gridTooltip_.style.visibility=t?"visible":"hidden",this.gridTooltip_.style.display=t?"":"none",this.gridTooltip_.style.top=r.bottom+5+"px",this.gridTooltip_.style.left=r.left+"px"),this.addKeyboardNavigableClass()}dispose(){super.dispose(),this.disposeGrid(),this.disposeTooltip(),this.disposeIntersectionObserver()}createTooltip_(){this.gridTooltip_||(this.gridTooltip_=document.createElement("div"),this.gridTooltip_.className="blocklyGridPickerTooltip",this.gridTooltip_.style.position="absolute",this.gridTooltip_.style.display="none",this.gridTooltip_.style.visibility="hidden",document.body.appendChild(this.gridTooltip_))}populateTableContainer(t,r,e){this.gridItems=[],this.activeDescendantIndex=0,pxsim.U.removeChildren(r),0==t.length&&(this.firstItem_=void 0);for(let e=0;e<t.length/this.columns_;e++){var n=this.populateRow(e,t,r);r.appendChild(n)}}populateRow(e,t,o){var r=this.columns_,l=document.createElement("div");l.className="blocklyGridPickerRow";for(let a=r*e;a<Math.min(r*e+r,t.length);a++){let r=t[a][0],n=t[a][1],i=document.createElement("div");i.className="gridpicker-menuitem gridpicker-option",i.setAttribute("id",":"+a),i.setAttribute("role","gridcell"),i.setAttribute("aria-selected","false"),i.style.userSelect="none",i.title=r.alt||r,i.setAttribute("data-value",n);var c,u=document.createElement("div");u.setAttribute("class","gridpicker-menuitem-content"),u.title=r.alt||r,u.setAttribute("data-value",n);let s="object"==typeof r,e=this.backgroundColour_;if(n==this.getValue()&&(i.setAttribute("aria-selected","true"),this.activeDescendantIndex=a,pxt.BrowserUtils.addClass(i,"gridpicker-option-selected "+(this.openingPointerCoords?"":"gridpicker-option-focused")),e=this.sourceBlock_.getColourTertiary(),this.selectedItemDom=i,s)&&!this.shouldShowTooltips()&&this.updateSelectedBar_(r,n),i.style.backgroundColor=e,i.style.borderColor=this.borderColour_,s?((c=new Image(r.width,r.height)).setAttribute("draggable","false"),"IntersectionObserver"in window?(c.src=p.DEFAULT_IMG,c.setAttribute("data-src",r.src),this.observer.observe(c)):c.src=r.src,c.alt=r.alt||"",c.setAttribute("data-value",n),u.appendChild(c)):u.textContent=r,this.shouldShowTooltips()){d.browserEvents.conditionalBind(i,"click",this,()=>this.buttonClickAndClose_(n));let t=this.sourceBlock_.RTL?-this.tooltipConfig_.xOffset:this.tooltipConfig_.xOffset,r=this.tooltipConfig_.yOffset;d.browserEvents.bind(i,"pointermove",this,e=>{this.pointerMoveTriggeredByUser()&&(this.gridItems.forEach(e=>e.classList.remove("gridpicker-option-focused")),this.activeDescendantIndex=a,s&&(this.gridTooltip_.style.top=e.clientY+r+"px",this.gridTooltip_.style.left=e.clientX+t+"px",e=(e=document.elementFromPoint(e.clientX,e.clientY)).title||e.alt,this.gridTooltip_.textContent=e,this.gridTooltip_.style.visibility=e?"visible":"hidden",this.gridTooltip_.style.display=e?"":"none"),pxt.BrowserUtils.addClass(i,"gridpicker-menuitem-highlight"),o.setAttribute("aria-activedescendant",i.id))}),d.browserEvents.bind(i,"pointerout",this,e=>{this.pointerOutTriggeredByUser()&&(this.gridItems.forEach(e=>e.classList.remove("gridpicker-option-focused")),s&&(this.gridTooltip_.style.visibility="hidden",this.gridTooltip_.style.display="none"),pxt.BrowserUtils.removeClass(i,"gridpicker-menuitem-highlight"),o.removeAttribute("aria-activedescendant"),this.activeDescendantIndex=void 0)})}else s?(this.selectedBar_.style.display="",d.browserEvents.conditionalBind(i,"click",this,e=>{if(this.closeModal_)this.buttonClick_(n);else{var t=o.getElementsByClassName("gridpicker-menuitem-highlight");for(let e=0;e<t.length;e++)pxt.BrowserUtils.removeClass(t[e],"gridpicker-menuitem-highlight");pxt.BrowserUtils.addClass(i,"gridpicker-menuitem-highlight"),this.updateSelectedBar_(r,n)}})):(d.browserEvents.conditionalBind(i,"click",this,()=>this.buttonClickAndClose_(n)),d.browserEvents.conditionalBind(i,"mouseup",this,()=>this.buttonClickAndClose_(n)));i.appendChild(u),this.gridItems.push(i),l.appendChild(i),0==a&&(this.firstItem_=i)}return l}doClassValidation_(e){return e}getFieldDescription(){return this.getValue()}close(){this.disposeTooltip(),this.disposeGrid(),d.WidgetDiv.hideIfOwner(this),d.Events.setGroup(!1),this.tabKeyBind&&d.browserEvents.unbind(this.tabKeyBind)}highlightFirstItem(e){var r=e.childNodes;if(r.length&&r[0].childNodes){for(let t=0;t<r.length;++t){var n=r[t].childNodes.length;for(let e=0;e<n;++e){var i=r[t].childNodes[e];pxt.BrowserUtils.removeClass(i,"gridpicker-menuitem-highlight"),pxt.BrowserUtils.removeClass(i,"gridpicker-option-selected")}}r[0].childNodes[0].className+=" gridpicker-menuitem-highlight"}}highlightAndScrollSelected(e,t){this.selectedItemDom&&d.utils.style.scrollIntoContainerView(this.selectedItemDom,t,!0)}showEditor_(e){this.setOpeningPointerCoords(e),d.WidgetDiv.show(this,this.sourceBlock_.RTL,()=>{this.onClose_()}),this.setupIntersectionObserver_(),this.createTooltip_();var t=document.createElement("div");this.positionMenu_(t),t.focus(),e||this.addKeyboardNavigableClass()}positionMenu_(t){var e,r=d.utils.svgMath.getViewportBBox(),n=this.getAnchorDimensions_(),{paddingContainer:i,scrollContainer:s}=this.createWidget_(t),i=(this.scrollContainer=s,{width:i.offsetWidth,height:i.offsetHeight}),a=window.outerHeight||window.innerHeight;this.width_&&(e=window.outerWidth||window.innerWidth,this.width_>e&&(this.width_=e),t.style.width=this.width_+"px");let o=0;if(this.hasSearchBar_&&(o+=50),this.selectedBar_&&(o+=50),this.maxRows_){let e=t.children[0].offsetHeight*(this.maxRows_+.3);a<e+o&&(e=a-o),i.height>e&&(s.style.overflowY="auto",s.style.height=e+"px",i.height=e)}i.height+=o,d.WidgetDiv.positionWithAnchor(r,n,i,this.sourceBlock_.RTL),this.highlightAndScrollSelected(t,s)}shouldShowTooltips(){return!pxt.BrowserUtils.isMobile()}getAnchorDimensions_(){var e=this.getScaledBBox();return this.sourceBlock_.RTL?e.right+=n.FieldBase.CHECKMARK_OVERHANG:e.left-=n.FieldBase.CHECKMARK_OVERHANG,e}createWidget_(e){var t,r,n=d.WidgetDiv.getDiv(),i=this.getOptions(),s=(e.setAttribute("role","grid"),e.setAttribute("tabindex","0"),this.addPointerListener(n),this.addKeyDownHandler(e),document.createElement("div")),a=document.createElement("div");a.style.border="solid 1px "+this.borderColour_,e.style.backgroundColor=this.backgroundColour_,s.style.backgroundColor=this.backgroundColour_,a.style.backgroundColor=this.backgroundColour_,e.className="blocklyGridPickerMenu",s.className="blocklyGridPickerScroller",a.className="blocklyGridPickerPadder",a.appendChild(s),s.appendChild(e),n.appendChild(a);let o;this.hasSearchBar_&&({searchBarDiv:t,searchBar:r}=this.createSearchBar_(e,s,i),a.insertBefore(t,a.childNodes[0]),o=r);let l;return this.shouldShowTooltips()||({selectedBar:t,cancelButton:r}=this.createSelectedBar_(),this.selectedBar_=t,l=r,a.appendChild(this.selectedBar_)),this.populateTableContainer(i,e,s),(this.hasSearchBar_||this.selectedBar_)&&(this.firstFocusableElement=o||e,this.lastFocusableElement=l||e,this.tabKeyBind=d.browserEvents.bind(n,"keydown",this,this.handleTabKey.bind(this))),{paddingContainer:a,scrollContainer:s}}createSearchBar_(n,i,s){var e=document.createElement("div"),t=(e.setAttribute("class","ui fluid icon input"),document.createElement("i"));t.setAttribute("class","search icon");let a=document.createElement("input");return a.setAttribute("type","search"),a.setAttribute("id","search-bar"),a.setAttribute("class","blocklyGridPickerSearchBar"),a.setAttribute("placeholder",pxt.Util.lf("Search")),a.setAttribute("tabindex","0"),a.addEventListener("click",()=>{a.focus(),a.setSelectionRange(0,a.value.length)}),a.addEventListener("keyup",pxt.Util.debounce(e=>{if("Tab"!==e.code){e=a.value;let r=new RegExp(e,"i");var t=s.filter(e=>{var t=e[0].alt,e=e[1];return t?r.test(t):r.test(e)});this.populateTableContainer(t,n,i),e?this.highlightFirstItem(n):this.highlightAndScrollSelected(n,i),this.gridTooltip_.style.visibility="hidden",this.gridTooltip_.style.display="none"}},300,!1)),a.addEventListener("keyup",e=>{13==e.which&&(e=n.childNodes[0])&&(e=e.childNodes[0])&&(this.closeModal_=!0,e.click())}),e.appendChild(a),e.appendChild(t),{searchBarDiv:e,searchBar:a}}createSelectedBar_(){var e=document.createElement("div"),t=(e.setAttribute("class","blocklyGridPickerSelectedBar"),e.style.display="none",document.createElement("div")),r=document.createElement("div"),r=(r.className="blocklyGridPickerSelectedImage",t.appendChild(r),this.selectedImg_=document.createElement("img"),this.selectedImg_.setAttribute("width","30px"),this.selectedImg_.setAttribute("height","30px"),this.selectedImg_.setAttribute("draggable","false"),this.selectedImg_.style.display="none",this.selectedImg_.src=p.DEFAULT_IMG,r.appendChild(this.selectedImg_),this.selectedBarText_=document.createElement("span"),this.selectedBarText_.className="blocklyGridPickerTooltip",t.appendChild(this.selectedBarText_),document.createElement("div")),n=document.createElement("div"),i=(n.className="ui buttons mini",r.appendChild(n),document.createElement("button")),s=(i.className="ui button icon green",document.createElement("i")),s=(s.className="icon check",i.appendChild(s),d.browserEvents.conditionalBind(i,"click",this,()=>{this.setValue(this.selectedBarValue_),this.close()}),document.createElement("button")),a=(s.className="ui button icon red",document.createElement("i"));return a.className="icon cancel",s.appendChild(a),d.browserEvents.conditionalBind(s,"click",this,()=>{this.close()}),n.appendChild(i),n.appendChild(s),e.appendChild(t),e.appendChild(r),{selectedBar:e,cancelButton:s}}updateSelectedBar_(e,t){e.src&&(this.selectedImg_.src=e.src,this.selectedImg_.style.display=""),this.selectedImg_.alt=e.alt||e,this.selectedBarText_.textContent=e.alt||e,this.selectedBarValue_=t}setupIntersectionObserver_(){if("IntersectionObserver"in window){this.disposeIntersectionObserver();let t=e=>{var t=e.getAttribute("data-src");t&&(e.src=t,e.removeAttribute("data-src"))};this.observer=new IntersectionObserver(e=>{e.forEach(e=>{0<e.intersectionRatio&&(this.observer.unobserve(e.target),t(e.target))})},{rootMargin:"20px 0px",threshold:.01})}}disposeIntersectionObserver(){this.observer&&(this.observer=null)}disposeTooltip(){this.gridTooltip_&&(pxsim.U.remove(this.gridTooltip_),this.gridTooltip_=null)}onClose_(){this.disposeTooltip(),this.disposeGrid()}handleTabKey(e){"Tab"===e.code&&(this.addKeyboardNavigableClass(),document.activeElement!==this.lastFocusableElement||e.shiftKey?document.activeElement===this.firstFocusableElement&&e.shiftKey&&(this.lastFocusableElement.focus(),e.preventDefault()):(this.firstFocusableElement.focus(),e.preventDefault()))}addKeyboardNavigableClass(){this.scrollContainer&&this.scrollContainer.classList.add("keyboardNavigable")}}(r.FieldGridPicker=p).DEFAULT_IMG="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",d.Css.register(`
.blocklyGridPickerTooltip {
    z-index: 995;
}

.blocklyGridPickerPadder {
    outline: none;
    box-shadow: 0px 0px 8px 1px rgba(0, 0, 0, .3)
}

.blocklyWidgetDiv .blocklyGridPickerRow {
    display: table-row;
}

.blocklyWidgetDiv .blocklyGridPickerMenu {
    display: table;
    outline: none;
    border-spacing: 7px;
}

.blocklyGridPickerScroller {
    outline: none;
    padding: 4px;
    border-radius: 4px;
    position: relative;
    -webkit-overflow-scrolling: touch;
}

.blocklyGridPickerScroller.keyboardNavigable:has(:focus-visible) {
    outline: 4px solid var(--pxt-focus-border);
}

.blocklyGridPickerPadder {
    border-radius: 4px;
    outline: none;
    position: relative;
}

.blocklyGridPickerPadder .ui.input i.search.icon {
    margin-top: -0.2rem;
}

.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-menuitem {
    background: white;
    cursor: pointer;
    min-width: unset;
}

.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-menuitem-highlight, .blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-menuitem-hover {
    background: #d6e9f8;
    box-shadow: 0px 0px 0px 4px rgba(255, 255, 255, 0.2);
}

.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-option {
    border: solid 1px black;
    border-radius: 4px;
    color: #fff;
    font-size: 12pt;
    font-weight: bold;
    display: table-cell;
    padding: 8px;
    text-align: center;
    vertical-align: top;
    -webkit-user-select: none;
    -moz-user-select: -moz-none;
    -ms-user-select: none;
        user-select: none;
}

.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-menuitem-content {
    color: #fff;
    font-size: 13px;
    font-family: var(--pxt-page-font);
}

.blocklyWidgetDiv .blocklyGridPickerMenu .floatLeft {
    float: left;
}

.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-option.gridpicker-option-selected {
    position: relative;
}

.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-menuitem .gridpicker-menuitem-checkbox {
    display: none;
}

.blocklyWidgetDiv .blocklyGridPickerMenu:focus .blocklyGridPickerRow .gridpicker-menuitem.gridpicker-option-focused {
    outline: 3px solid var(--pxt-focus-border);
}

.blocklyGridPickerTooltip {
    z-index: 995;
}

.blocklyGridPickerSelectedBar {
    display: flex;
    padding-top: 5px;
    justify-content: space-between;
}

.blocklyGridPickerSelectedImage {
    padding: 3px;
    display: inline-block;
    vertical-align: middle;
}

.ui.input input.blocklyGridPickerSearchBar {
    background: none;
    border: none;
    color: white;
}

.ui.input input.blocklyGridPickerSearchBar::placeholder {
    color: white;
}

.ui.input input.blocklyGridPickerSearchBar::-webkit-input-placeholder {
    color: white;
}

.ui.input input.blocklyGridPickerSearchBar::-moz-placeholder {
    color: white;
}

.ui.input input.blocklyGridPickerSearchBar:-ms-input-placeholder {
    color: white;
}

.ui.input input.blocklyGridPickerSearchBar:-moz-placeholder {
    color: white;
}
`)},{"./field_base":31,"./field_dropdowngrid":35,"./field_utils":69,blockly:175}],37:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldImageDropdown=void 0;let f=e("blockly"),_=e("./field_utils");e=e("./field_dropdowngrid");class n extends e.FieldDropdownGrid{constructor(e,t,r){super(t.data),this.buttonClickAndClose_=e=>{e&&(this.setValue(e),f.DropDownDiv.hide())},this.columns_=parseInt(t.columns),this.maxRows_=parseInt(t.maxRows)||0,this.width_=parseInt(t.width)||300,this.backgroundColour_=(0,_.parseColour)(t.colour),this.borderColour_=pxt.toolbox.fadeColor(this.backgroundColour_,.4,!1)}setFocusedItem_(e){this.gridItems.forEach(e=>e.setAttribute("class","blocklyDropDownButton"));var t=this.gridItems[this.activeDescendantIndex],r=t.parentElement,t=(t.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonFocus"),r.getBoundingClientRect()),e=e.parentElement.getBoundingClientRect();t.bottom>e.bottom?r.scrollIntoView({block:"end"}):t.top<e.top&&r.scrollIntoView({block:"start"})}createRow(){var e=document.createElement("div");return e.setAttribute("role","row"),e}showEditor_(t){if(this.setOpeningPointerCoords(t),!f.DropDownDiv.hideIfOwner(this)){f.DropDownDiv.hideWithoutAnimation(),(0,_.clearDropDownDiv)();t=f.DropDownDiv.getContentDiv();let i=document.createElement("div");i.setAttribute("role","grid"),i.setAttribute("tabindex","0"),i.classList.add("blocklyMenu","blocklyDropdownMenu"),this.addPointerListener(t),this.addKeyDownHandler(i);var o=[];let n={height:0,width:0,items:[]};var e,l=this.getOptions(),c=this.columns_?this.width_/this.columns_-8:0;for(let r=0;r<l.length;r++){var u=l[r][0];let e=u.width,t=u.height;"placeholder"!=u.type&&this.columns_&&(e=c,t=c),n.height&&n.width+e+8>this.width_?(o.push(n),n={width:e+8,height:t+8,items:[l[r]]}):(n.width+=e+8,n.height=Math.max(n.height,t+8),n.items.push(l[r]))}o.push(n);let s,a=0;for(e of o){var d,p=this.createRow();p.style.width=e.width+"px",p.style.height=e.height+"px",i.appendChild(p);for(d of e.items){let r=a;var h=d[0];let n=d[1];if("placeholder"==h.type){var m=document.createElement("span");m.setAttribute("class","blocklyDropDownPlaceholder"),m.style.width=h.width+"px",m.style.height=e.height+"px",p.appendChild(m)}else{m=document.createElement("div");m.setAttribute("class","blocklyDropDownButtonContainer");let e=document.createElement("div"),t=(e.setAttribute("id",":"+r),e.setAttribute("role","gridcell"),e.setAttribute("aria-selected","false"),e.classList.add("blocklyDropDownButton"),e.title=h.alt,e.style.width=(c||h.width)+"px",e.style.height=(c||h.height)+"px",this.backgroundColour_);n==this.getValue()&&(t=this.sourceBlock_.getColourTertiary(),e.setAttribute("aria-selected","true"),this.activeDescendantIndex=r,i.setAttribute("aria-activedescendant",e.id),e.setAttribute("class","blocklyDropDownButton "+(this.openingPointerCoords?"blocklyDropDownButtonHover":"blocklyDropDownButtonFocus")),s=m),e.style.backgroundColor=t,e.style.borderColor=this.borderColour_,f.browserEvents.bind(e,"click",this,()=>this.buttonClickAndClose_(n)),f.browserEvents.bind(e,"pointermove",this,()=>{this.pointerMoveTriggeredByUser()&&(this.gridItems.forEach(e=>e.setAttribute("class","blocklyDropDownButton")),this.activeDescendantIndex=r,e.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonHover"),i.setAttribute("aria-activedescendant",e.id))}),f.browserEvents.bind(e,"pointerout",this,()=>{this.pointerOutTriggeredByUser()&&(e.setAttribute("class","blocklyDropDownButton"),i.removeAttribute("aria-activedescendant"),this.activeDescendantIndex=void 0)});var g=document.createElement("img");g.src=h.src,e.setAttribute("data-value",n),g.setAttribute("data-value",n),e.appendChild(g),this.gridItems.push(e),m.appendChild(e),p.append(m),a++}}}if(t.appendChild(i),this.maxRows_){var r=y(o);let e=y(o.slice(0,this.maxRows_));o.length>this.maxRows_&&(e+=.4*o[this.maxRows_].height),t.style.maxHeight=e+"px",t.style.height=r+"px"}pxt.BrowserUtils.isFirefox()&&(t.style.paddingRight="20px"),f.DropDownDiv.setColour(this.backgroundColour_,this.borderColour_),f.DropDownDiv.showPositionedByField(this,this.onHide_.bind(this)),i.focus(),s&&s.scrollIntoView({block:"end"});r=this.sourceBlock_;this.savedPrimary_=null==r?void 0:r.getColour(),null!=r&&r.isShadow()?r.setColour(r.getColourTertiary()):this.borderRect_&&this.borderRect_.setAttribute("fill",r.getColourTertiary())}}doValueUpdate_(e){this.selectedOption_=void 0,super.doValueUpdate_(e)}getFieldDescription(){return lf("image")}onHide_(){this.disposeGrid();var e=f.DropDownDiv.getContentDiv(),e=(e.removeAttribute("role"),e.removeAttribute("aria-activedescendant"),e.style.width="",e.style.paddingRight="",e.style.maxHeight="",this.sourceBlock_);null!=e&&e.isShadow()?this.sourceBlock_.setColour(this.savedPrimary_):this.borderRect_&&this.borderRect_.setAttribute("fill",this.savedPrimary_)}}function y(e){return e.reduce((e,t)=>e+t.height,0)}r.FieldImageDropdown=n,f.Css.register(`
.blocklyDropDownButtonContainer,
.blocklyDropDownButton {
    display: inline-block;
    float: left;
    border-radius: 4px;
    text-align: center;
    margin: 0;
}

.blocklyDropDownButtonContainer {
    padding: 4px;
}

.blocklyDropDownButton {
    border: 1px solid;
    transition: box-shadow .1s;
    cursor: pointer;
    outline: none;
}

.blocklyDropDownButtonHover {
    box-shadow: 0px 0px 0px 4px rgba(255, 255, 255, 0.2);
}

.blocklyDropDownButtonFocus {
    box-shadow: 0px 0px 0px 4px rgb(255, 255, 255);
}

.blocklyDropDownButton:active {
    box-shadow: 0px 0px 0px 6px rgba(255, 255, 255, 0.2);
}

.blocklyDropDownButton > img {
    width: 80%;
    height: 80%;
    position: relative;
    top: 50%;
    transform: translateY(-50%);
}
`)},{"./field_dropdowngrid":35,"./field_utils":69,blockly:175}],38:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldImageNoText=void 0;let n=e("blockly");class i extends n.FieldImage{constructor(e,t,r,n,i,s,a){super(e,t,r,n,i,s,a),this.isFieldCustom_=!0}getFieldDescription(){}showEditor_(){super.showEditor_(),this.getSourceBlock()instanceof n.BlockSvg&&n.getFocusManager().focusNode(this.getSourceBlock())}}r.FieldImageNoText=i},{blockly:175}],39:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldImages=void 0;let u=e("blockly");var n=e("./field_imagedropdown");let d=e("./field_utils");class i extends n.FieldImageDropdown{constructor(e,t,r){super(e,t,r),this.shouldSort_=t.sort,this.addLabel_=!!t.addLabel}showEditor_(e){if(this.setOpeningPointerCoords(e),!u.DropDownDiv.hideIfOwner(this)){var a=this.sourceBlock_,e=(u.DropDownDiv.hideWithoutAnimation(),(0,d.clearDropDownDiv)(),u.DropDownDiv.getContentDiv());let i=document.createElement("div");i.setAttribute("role","grid"),i.setAttribute("tabindex","0"),i.setAttribute("class","blocklyMenu blocklyImageMenu"),this.addPointerListener(e),this.addKeyDownHandler(i);var t=this.getOptions();this.shouldSort_&&t.sort();let s=this.createRow();for(let n=0;n<t.length;n++){var o=t[n][0];let r=t[n][1];if("placeholder"==o.type){var l=document.createElement("span");l.setAttribute("class","blocklyDropDownPlaceholder"),l.style.width=o.width+"px",l.style.height=o.height+"px",i.appendChild(l)}else{l=document.createElement("div");l.setAttribute("class","blocklyDropDownButtonContainer");let e=document.createElement("div"),t=(e.setAttribute("id",":"+n),e.setAttribute("role","gridcell"),e.setAttribute("aria-selected","false"),e.setAttribute("class","blocklyDropDownButton"),e.title=o.alt,this.columns_?e.style.width=this.width_/this.columns_-8+"px":(e.style.width=o.width+"px",e.style.height=o.height+"px"),a.getColour());r==this.getValue()&&(t=a.getColourTertiary(),e.setAttribute("aria-selected","true"),this.activeDescendantIndex=n,i.setAttribute("aria-activedescendant",e.id),e.setAttribute("class","blocklyDropDownButton "+(this.openingPointerCoords?"blocklyDropDownButtonHover":"blocklyDropDownButtonFocus"))),e.style.backgroundColor=t,e.style.borderColor=a.getColourTertiary(),u.browserEvents.bind(e,"click",this,()=>this.buttonClickAndClose_(r)),u.browserEvents.bind(e,"pointermove",this,()=>{this.pointerMoveTriggeredByUser()&&(this.gridItems.forEach(e=>e.setAttribute("class","blocklyDropDownButton")),this.activeDescendantIndex=n,e.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonHover"),i.setAttribute("aria-activedescendant",e.id))}),u.browserEvents.bind(e,"pointerout",this,()=>{this.pointerOutTriggeredByUser()&&(e.setAttribute("class","blocklyDropDownButton"),i.removeAttribute("aria-activedescendant"),this.activeDescendantIndex=void 0)});var c=document.createElement("img");c.src=o.src,e.setAttribute("data-value",r),c.setAttribute("data-value",r),e.appendChild(c),this.addLabel_&&((c=this.createTextNode_(o.alt)).setAttribute("data-value",r),e.appendChild(c)),this.gridItems.push(e),l.appendChild(e),s.append(l),s.childElementCount===this.columns_&&(i.appendChild(s),s=this.createRow())}}s.childElementCount&&i.appendChild(s),i.style.width=this.width_+"px",e.appendChild(i),u.DropDownDiv.setColour(a.getColour(),a.getColourTertiary()),u.DropDownDiv.showPositionedByField(this,this.onHideCallback.bind(this)),i.focus(),this.savedPrimary_=null==a?void 0:a.getColour(),null!=a&&a.isShadow()?a.setColour(a.style.colourTertiary):this.borderRect_&&this.borderRect_.setAttribute("fill",a.style.colourTertiary)}}onHideCallback(){this.disposeGrid();var e=u.DropDownDiv.getContentDiv(),e=(e.removeAttribute("role"),e.removeAttribute("aria-activedescendant"),this.sourceBlock_);null!=e&&e.isShadow()?e.setColour(this.savedPrimary_):this.borderRect_&&this.borderRect_.setAttribute("fill",this.savedPrimary_)}createTextNode_(e){var t=document.createElement("span");return t.setAttribute("class","blocklyDropdownTextLabel"),t.textContent=e,t}}r.FieldImages=i,u.Css.register(`
.blocklyImageMenu .blocklyDropDownButton > img {
    top: unset;
    transform: unset;
    margin-top: 4px;
}
.blocklyImageMenu .blocklyDropdownTextLabel {
    line-height: 1.15;
    margin-top: 2px;
}
`)},{"./field_imagedropdown":37,"./field_utils":69,blockly:175}],40:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldKind=void 0;let c=e("blockly"),s=e("./field_utils"),n=e("../external");e=e("./field_dropdown");class a extends e.FieldDropdown{constructor(e){var r;super((r=e,function(){let t=[];var e=this.getSourceBlock();return null!=e&&e.workspace&&!e.isInFlyout?e.workspace.getVariableMap().getVariablesOfType(p(r.name)).forEach(e=>{t.push([e.getName(),e.getName()])}):r.initialMembers.forEach(e=>t.push([e,e])),t.push([lf("Add a new {0}...",r.memberName),"CREATE"]),t.push([void 0,"SEPARATOR"]),t.push([lf("Rename {0}...",r.memberName),"RENAME"]),t.push([lf("Delete {0}...",r.memberName),"DELETE"]),t})),this.opts=e}initView(){super.initView()}onItemSelected_(e,t){var r=t.getValue();if("CREATE"===r)o(this.sourceBlock_.workspace,this.opts,lf("New {0}:",this.opts.memberName),e=>e&&this.setValue(e));else if("RENAME"===r){let r=this.sourceBlock_.workspace;var i=r.getVariableMap().getVariable(this.value_,p(this.opts.name));let n=i.getName();-1!==this.opts.initialMembers.indexOf(n)?c.dialog.alert(lf("The built-in {0} '{1}' cannot be renamed. Try creating a new kind instead!",this.opts.memberName,n)):l(r,Object.assign(Object.assign({},this.opts),{toRename:i}),lf("Rename '{0}':",n),e=>{var t;for(t of(0,s.getAllFields)(r,e=>e instanceof a&&e.getValue()===n&&e.opts.name===this.opts.name))t.ref.setValue(e)})}else if("DELETE"===r){let n=this.sourceBlock_.workspace,i=n.getVariableMap().getVariable(this.value_,p(this.opts.name)),t=i.getName();if(-1!==this.opts.initialMembers.indexOf(t))c.dialog.alert(lf("The built-in {0} '{1}' cannot be deleted.",this.opts.memberName,t));else{let r=(0,s.getAllFields)(n,e=>e instanceof a&&e.getValue()===t&&e.opts.name===this.opts.name);1<r.length?c.dialog.confirm(lf('Delete {0} uses of the "{1}" {2}?',r.length,t,this.opts.memberName),e=>{if(e){c.Events.setGroup(!0);for(var t of r)t.block.dispose(!0);n.getVariableMap().deleteVariable(i),this.setValue(this.opts.initialMembers[0]),c.Events.setGroup(!1)}}):(n.getVariableMap().deleteVariable(i),this.setValue(this.opts.initialMembers[0]))}}else super.onItemSelected_(e,t)}doClassValidation_(t){var e;return null!=(e=this.opts)&&e.initialMembers&&!this.opts.initialMembers.find(e=>e==t)&&this.getOptions(),super.doClassValidation_(t)}getOptions(e){return this.initVariables(),super.getOptions(e)}initVariables(){if(this.sourceBlock_&&this.sourceBlock_.workspace){let t=this.sourceBlock_.workspace,r=d(t,this.opts.name);this.opts.initialMembers.forEach(e=>{-1===r.indexOf(e)&&i(t,this.opts,e)}),"CREATE"!==this.getValue()&&"RENAME"!==this.getValue()&&"DELETE"!==this.getValue()||this.opts.initialMembers.length&&this.setValue(this.opts.initialMembers[0])}}}function u(i,s,a,o,l){(0,n.prompt)(a,null,r=>{if(r){let t=!1;if(pxtc.isIdentifierStart(r.charCodeAt(0),2)){t=!0;for(let e=1;e<r.length;e++)pxtc.isIdentifierPart(r.charCodeAt(e),2)||(t=!1)}if(t)if(pxt.blocks.isReservedWord(r)||"CREATE"===r||"RENAME"===r||"DELETE"===r)c.dialog.alert(lf("'{0}' is a reserved word and cannot be used.",r),()=>u(i,s,a,o,l));else{var n=d(i,s.name);for(let e=0;e<n.length;e++)if(n[e]===r)return void c.dialog.alert(lf("A {0} named '{1}' already exists.",s.memberName,r),()=>u(i,s,a,o,l));r===s.createFunctionName&&c.dialog.alert(lf("'{0}' is a reserved name.",s.createFunctionName),()=>u(i,s,a,o,l)),o(r)}else c.dialog.alert(lf("Names must start with a letter and can only contain letters, numbers, '$', and '_'."),()=>u(i,s,a,o,l))}},{placeholder:s.promptHint})}function o(t,r,e,n){u(t,r,e,e=>{n(i(t,r,e))},o)}function l(t,r,e,n){u(t,r,e,e=>{t.getVariableMap().renameVariable(r.toRename,e),n(e)},l)}function d(e,t){e=e.getVariableMap().getVariablesOfType(p(t));return e&&e.length?e.map(e=>e.getName()):[]}function i(e,t,r){return c.Variables.getOrCreateVariablePackage(e,null,r,p(t.name)),r}function p(e){return"KIND_"+e}r.FieldKind=a},{"../external":25,"./field_dropdown":34,"./field_utils":69,blockly:175}],41:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldLedMatrix=void 0;let s=e("blockly");var a,n,e=e("./field_matrix");let o=/^.*[\.#].*$/;(n=a=a||{})[n.None=0]="None",n[n.Number=1]="Number",n[n.Letter=2]="Letter";class l extends e.FieldMatrix{constructor(e,t,r){super(e,r),this.isFieldCustom_=!0,this.SERIALIZABLE=!0,this.onColor="#FFFFFF",this.scale=1,this.numMatrixCols=5,this.numMatrixRows=5,this.yAxisLabel=a.None,this.xAxisLabel=a.None,this.cellState=[],this.clearSelectionOnBlur=!0,this.forceFocusVisible=!0,this.dontHandleMouseEvent_=e=>{e.stopPropagation(),e.preventDefault()},this.clearLedDragHandler=e=>{let t=this.sourceBlock_.getSvgRoot();pxsim.pointerEvents.down.forEach(e=>t.removeEventListener(e,this.dontHandleMouseEvent_)),t.removeEventListener(pxsim.pointerEvents.move,this.dontHandleMouseEvent_),document.removeEventListener(pxsim.pointerEvents.up,this.clearLedDragHandler),document.removeEventListener(pxsim.pointerEvents.leave,this.clearLedDragHandler),s.Touch.clearTouchIdentifier(),this.matrixSvg.removeEventListener(pxsim.pointerEvents.move,this.handleRootMouseMoveListener),e.stopPropagation(),e.preventDefault()},this.toggleCell=(e,t,r)=>{this.cellState[e][t]=null!=r?r:this.currentDragState_,this.updateValue()},this.handleRootMouseMoveListener=r=>{if(this.sourceBlock_.isEditable()){let e,t;t=(r.changedTouches&&1==r.changedTouches.length?(e=r.changedTouches[0].clientX,r.changedTouches[0]):(e=r.clientX,r)).clientY;var n,r=document.elementFromPoint(e,t);r&&(n=r.getAttribute("data-x"),r=r.getAttribute("data-y"),null!=n)&&null!=r&&this.toggleCell(parseInt(n),parseInt(r))}},this.params=t,void 0!==this.params.rows&&(e=parseInt(this.params.rows),isNaN(e)||(this.numMatrixRows=e)),void 0!==this.params.columns&&(r=parseInt(this.params.columns),isNaN(r)||(this.numMatrixCols=r)),void 0!==this.params.onColor&&(this.onColor=this.params.onColor),void 0!==this.params.offColor&&(this.offColor=this.params.offColor),void 0!==this.params.scale?this.scale=Math.max(.6,Math.min(2,Number(this.params.scale))):15<Math.max(this.numMatrixCols,this.numMatrixRows)?this.scale=.85:10<Math.max(this.numMatrixCols,this.numMatrixRows)&&(this.scale=.9),this.size_.height=this.scale*Number(this.numMatrixRows)*(l.CELL_WIDTH+l.CELL_VERTICAL_MARGIN)+2*l.CELL_VERTICAL_MARGIN+l.BOTTOM_MARGIN+this.getXAxisHeight(),this.size_.width=this.scale*Number(this.numMatrixCols)*(l.CELL_WIDTH+l.CELL_HORIZONTAL_MARGIN)+l.CELL_HORIZONTAL_MARGIN+this.getYAxisWidth()}getCellToggled(e,t){return this.cellState[e][t]}useTwoToneFocusIndicator(e,t){return this.getCellToggled(e,t)}showEditor_(){this.selected=[0,0];var e=this.matrixSvg.getBoundingClientRect();let t=s.WidgetDiv.getDiv();t.append(this.matrixSvg),this.addKeyboardFocusHandlers(),t.style.left=e.left+"px",t.style.top=e.top+"px",t.style.transform=`scale(${s.getMainWorkspace().getScale()})`,t.style.transformOrigin="0 0",s.WidgetDiv.show(this,this.sourceBlock_.RTL,()=>{this.removeKeyboardFocusHandlers(),this.clearCellSelection(),this.fieldGroup_.append(this.matrixSvg),t.style.left="",t.style.top="",t.style.transform="",t.style.transformOrigin=""}),this.matrixSvg.focus(),this.focusCell(0,0)}initMatrix(){if(!this.sourceBlock_.isInsertionMarker()){this.matrixSvg=pxsim.svg.parseString(`<svg xmlns="http://www.w3.org/2000/svg" id="field-matrix" class="blocklyMatrix" tabindex="-1" role="grid" width="${this.size_.width}" height="${this.size_.height}"/>`),this.matrixSvg.ariaLabel=lf("LED grid");var e=s.getMainWorkspace();this.matrixSvg.style.boxShadow=`rgba(255, 255, 255, 0.3) 0 0 0 ${4*e.getAbsoluteScale()}px`,this.matrixSvg.style.transition="box-shadow 0.25s",this.matrixSvg.style.borderRadius=4*e.getAbsoluteScale()+"px";for(let t=0;t<this.numMatrixCols;t++){this.cellState.push([]);for(let e=0;e<this.numMatrixRows;e++)this.cellState[t].push(!1)}if(this.restoreStateFromString(),this.createMatrixDisplay({cellWidth:l.CELL_WIDTH,cellHeight:l.CELL_WIDTH,cellLabel:lf("LED"),cellHorizontalMargin:l.CELL_HORIZONTAL_MARGIN,cellVerticalMargin:l.CELL_VERTICAL_MARGIN,cornerRadius:l.CELL_CORNER_RADIUS,cellFill:this.offColor,padLeft:this.getYAxisWidth(),scale:this.scale}),this.updateValue(),this.xAxisLabel!==a.None){var e=this.scale*this.numMatrixRows*(l.CELL_WIDTH+l.CELL_VERTICAL_MARGIN)+2*l.CELL_VERTICAL_MARGIN+l.BOTTOM_MARGIN,t=pxsim.svg.child(this.matrixSvg,"g",{transform:`translate(0 ${e})`});for(let e=0;e<this.numMatrixCols;e++){var r=this.getYAxisWidth()+this.scale*e*(l.CELL_WIDTH+l.CELL_HORIZONTAL_MARGIN)+l.CELL_WIDTH/2+l.CELL_HORIZONTAL_MARGIN/2;pxsim.svg.child(t,"text",{x:r,class:"blocklyText"}).textContent=this.getLabel(e,this.xAxisLabel)}}if(this.yAxisLabel!==a.None){var n=pxsim.svg.child(this.matrixSvg,"g",{});for(let e=0;e<this.numMatrixRows;e++){var i=this.scale*e*(l.CELL_WIDTH+l.CELL_VERTICAL_MARGIN)+l.CELL_WIDTH/2+2*l.CELL_VERTICAL_MARGIN;pxsim.svg.child(n,"text",{x:0,y:i,class:"blocklyText"}).textContent=this.getLabel(e,this.yAxisLabel)}}e=s.utils.dom.createSvgElement("rect",{x:0,y:0,fill:"none",width:this.size_.width,height:this.size_.height},null);this.matrixSvg.append(e),this.fieldGroup_.classList.add("blocklyFieldLedMatrixGroup"),this.fieldGroup_.append(this.matrixSvg),this.attachEventHandlersToMatrix()}}getLabel(e,t){return t!==a.Letter?(e+1).toString():String.fromCharCode(e+65)}updateEditable(){var e=this.fieldGroup_;this.EDITABLE&&e&&(this.sourceBlock_.isEditable()?this.fieldGroup_.setAttribute("cursor","pointer"):this.fieldGroup_.removeAttribute("cursor"),super.updateEditable())}attachPointerEventHandlersToCell(r,n,t){pxsim.pointerEvents.down.forEach(e=>t.addEventListener(e,e=>{if(this.sourceBlock_.isEditable()){let t=this.sourceBlock_.getSvgRoot();this.currentDragState_=!this.cellState[r][n],s.hideChaff(),s.common.setSelected(this.sourceBlock_),this.toggleCell(r,n),pxsim.pointerEvents.down.forEach(e=>t.addEventListener(e,this.dontHandleMouseEvent_)),t.addEventListener(pxsim.pointerEvents.move,this.dontHandleMouseEvent_),document.addEventListener(pxsim.pointerEvents.up,this.clearLedDragHandler),document.addEventListener(pxsim.pointerEvents.leave,this.clearLedDragHandler),this.matrixSvg.addEventListener(pxsim.pointerEvents.move,this.handleRootMouseMoveListener),e.stopPropagation(),e.preventDefault(),this.returnEphemeralFocus()}},!1))}getColor(e,t){return this.cellState[e][t]?this.onColor:this.offColor||l.DEFAULT_OFF_COLOR}getOpacity(e,t){var r=this.offColor?"1.0":"0.2";return this.cellState[e][t]?"1.0":r}updateCell(e,t){var r=this.cells[e][t];r.setAttribute("fill",this.getColor(e,t)),r.setAttribute("fill-opacity",this.getOpacity(e,t)),r.setAttribute("class","blocklyLed"+(this.cellState[e][t]?"On":"Off")),r.setAttribute("aria-checked",this.cellState[e][t].toString())}setValue(e,t=!0){var r=e!==this.value_;if(super.setValue(String(e),r),this.matrixSvg){t&&this.restoreStateFromString();for(let t=0;t<this.numMatrixCols;t++)for(let e=0;e<this.numMatrixRows;e++)this.updateCell(t,e)}}render_(){this.visible_?this.matrixSvg||this.initMatrix():this.markDirty()}getValue(){e=this.value_;var e,t=(t=(e=(e||"").trim()).charAt(0))!==e.charAt(e.length-1)||-1===i.indexOf(t)?e:e.substr(1,e.length-2).trim();return`\`
${l.TAB}${t}
${l.TAB}\``}getFieldDescription(){return lf("{0}x{1} LED Grid",this.numMatrixCols,this.numMatrixRows)}restoreStateFromString(){var n,e=this.value_;if(e){var i=e.split("\n").filter(e=>o.test(e));for(let r=0;r<i.length&&r<this.numMatrixRows;r++){let t=0;var s=i[r];for(let e=0;e<s.length&&t<this.numMatrixCols;e++)"."===(n=s[e])||"_"===n||"0"===n?(this.cellState[t][r]=!1,t++):"#"!==(n=s[e])&&"*"!==n&&"1"!==n||(this.cellState[t][r]=!0,t++)}}}updateValue(){let r="";for(let t=0;t<this.numMatrixRows;t++){for(let e=0;e<this.numMatrixCols;e++)r+=(this.cellState[e][t]?"#":".")+" ";r+="\n"+l.TAB}this.setValue(r,!1)}getYAxisWidth(){return this.yAxisLabel===a.None?0:l.Y_AXIS_WIDTH}getXAxisHeight(){return this.xAxisLabel===a.None?0:l.X_AXIS_HEIGHT}}(r.FieldLedMatrix=l).CELL_WIDTH=25,l.CELL_HORIZONTAL_MARGIN=7,l.CELL_VERTICAL_MARGIN=5,l.CELL_CORNER_RADIUS=5,l.BOTTOM_MARGIN=9,l.Y_AXIS_WIDTH=9,l.X_AXIS_HEIGHT=10,l.TAB="        ",l.DEFAULT_OFF_COLOR="#000000";let i=["'",'"',"`"];s.Css.register(`
.pxt-renderer.classic-theme .blocklyDraggable:not(.blocklyDisabled) .blocklyFieldLedMatrixGroup.blocklyEditableField:not(.blocklyEditing):hover>rect {
    stroke: none;
}
.pxt-renderer.classic-theme .blocklyDraggable:not(.blocklyDisabled) .blocklyFieldLedMatrixGroup.blocklyActiveFocus.blocklyEditableField:not(.blocklyEditing):hover>rect {
    stroke: var(--blockly-active-node-color);
    stroke-width: var(--blockly-selection-width);
}
.pxt-renderer.classic-theme .blocklyDraggable:not(.blocklyDisabled) .blocklyFieldLedMatrixGroup.blocklyPassiveFocus.blocklyEditableField:not(.blocklyEditing):hover>rect {
    stroke: var(--blockly-active-node-color);
    stroke-dasharray: 5px 3px;
    stroke-width: var(--blockly-selection-width);
}
.blocklyFieldLedMatrixGroup > .blocklyFieldRect {
    fill: none !important;
}`)},{"./field_matrix":42,blockly:175}],42:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldMatrix=void 0;let n=e("blockly");class i extends n.Field{constructor(){super(...arguments),this.cells=[],this.keyDownBinding=null,this.blurBinding=null,this.selected=void 0,this.forceFocusVisible=!1,this.returnEphemeralFocusFn=void 0,this.getCellId=(e,t)=>this.sourceBlock_.id+`:${e}-`+t}createMatrixDisplay({cellWidth:r,cellHeight:n,cellLabel:i,cellHorizontalMargin:s,cellVerticalMargin:a,cornerRadius:o=0,cellFill:l,cellStroke:c,padLeft:u=0,scale:d=1}){for(let e=0;e<this.numMatrixCols;e++)this.cells.push([]);for(let t=0;t<this.numMatrixRows;t++){var p=pxsim.svg.child(this.matrixSvg,"g",{role:"row"});for(let e=0;e<this.numMatrixCols;e++){var h=d*e*(r+s)+s+u,m=d*t*(n+a)+a,h=pxsim.svg.child(p,"g",{transform:`translate(${h} ${m})`,role:"gridcell"}),m={id:this.getCellId(e,t),"aria-label":i,role:"switch","aria-checked":"false",width:d*r,height:d*n,fill:null!=l?l:"none",stroke:c,"data-x":e,"data-y":t,rx:Math.max(2,d*o)},h=pxsim.svg.child(h,"rect",m);this.cells[e][t]=h}}}handleArrowUp(e,t){this.selected=[e,t-1]}handleArrowDown(e,t){this.selected=[e,t+1]}handleArrowLeft(e,t){0!==e?this.selected=[e-1,t]:0!==t&&(this.selected=[this.numMatrixCols-1,t-1])}handleArrowRight(e,t){e!==this.cells.length-1?this.selected=[e+1,t]:t!==this.numMatrixRows-1&&(this.selected=[0,t+1])}addKeyDownHandler(){this.keyDownBinding=n.browserEvents.bind(this.matrixSvg,"keydown",this,e=>{if(this.selected){var[t,r]=this.selected,n=pxt.BrowserUtils.isMac()?e.metaKey:e.ctrlKey;switch(e.code){case"ArrowUp":0!==r&&this.handleArrowUp(t,r);break;case"ArrowDown":r!==this.cells[0].length-1&&this.handleArrowDown(t,r);break;case"ArrowLeft":this.handleArrowLeft(t,r);break;case"ArrowRight":this.handleArrowRight(t,r);break;case"Home":this.selected=n?[0,0]:[0,r];break;case"End":this.selected=n?[this.numMatrixCols-1,this.numMatrixRows-1]:[this.numMatrixCols-1,r];break;case"Enter":case"Space":this.toggleCell(t,r,!this.getCellToggled(t,r));break;case"Escape":return this.sourceBlock_.workspace.markFocused(),void this.returnEphemeralFocus();default:return}var[i,s]=this.selected;this.focusCell(i,s),e.preventDefault(),e.stopPropagation()}})}addBlurHandler(){this.blurBinding=n.browserEvents.bind(this.matrixSvg,"blur",this,e=>{this.clearSelectionOnBlur?(this.removeKeyboardFocusHandlers(),this.clearCellSelection()):this.clearFocusIndicator()})}focusCell(e,t){this.setCellSelection(e,t),this.setFocusIndicator(this.cells[e][t],this.useTwoToneFocusIndicator(e,t))}setCellSelection(e,t){this.matrixSvg.setAttribute("aria-activedescendant",this.getCellId(e,t))}clearCellSelection(){this.selected&&(this.clearFocusIndicator(),this.selected=void 0),this.matrixSvg.removeAttribute("aria-activedescendant")}setFocusIndicator(e,t){var r,n;this.clearFocusIndicator(),(this.matrixSvg.matches(":focus-visible")||this.forceFocusVisible)&&(r=e.parentNode,n=parseInt(e.getAttribute("width")),e=parseInt(e.getAttribute("rx")),pxsim.svg.child(r,"rect",{transform:"translate(-2, -2)",width:n+4,height:n+4,rx:Math.max(2,e)+"px",stroke:"#fff","stroke-width":4,fill:"none"}),t)&&pxsim.svg.child(r,"rect",{transform:"translate(-1, -1)",width:n+2,height:n+2,rx:Math.max(2,e)+"px",stroke:"#000","stroke-width":2,fill:"none"})}clearFocusIndicator(){this.cells.forEach(e=>e.forEach(e=>{for(;e.nextElementSibling;)e.nextElementSibling.remove()}))}addKeyboardFocusHandlers(){this.sourceBlock_.isInFlyout||(this.addKeyDownHandler(),this.addBlurHandler())}attachEventHandlersToMatrix(){if(!this.sourceBlock_.isInFlyout)for(let t=0;t<this.numMatrixCols;++t)for(let e=0;e<this.numMatrixRows;++e)this.attachPointerEventHandlersToCell(t,e,this.cells[t][e])}returnEphemeralFocus(){var e;this.returnEphemeralFocusFn&&(e=this.returnEphemeralFocusFn,this.returnEphemeralFocusFn=void 0,e())}removeKeyboardFocusHandlers(){this.keyDownBinding&&(n.browserEvents.unbind(this.keyDownBinding),this.keyDownBinding=void 0),this.blurBinding&&(n.browserEvents.unbind(this.blurBinding),this.blurBinding=void 0)}}r.FieldMatrix=i,n.Css.register(`
    .blocklyMatrix:focus-visible {
        outline: none;
    }
`)},{blockly:175}],43:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldCustomMelody=n.TOTAL_WIDTH=n.HEADER_HEIGHT=void 0;let r=e("blockly");var i=pxt.svgUtil;let s=e("./field_utils");e=e("./field_matrix");n.HEADER_HEIGHT=50,n.TOTAL_WIDTH=300;class a extends e.FieldMatrix{constructor(e,t,r){super(e,r),this.isFieldCustom_=!0,this.SERIALIZABLE=!0,this.soundingKeys=0,this.numMatrixRows=8,this.numMatrixCols=8,this.tempo=120,this.isPlaying=!1,this.timeouts=[],this.clearSelectionOnBlur=!1,this.matrixFocusBind=null,this.tabKeyBind=null,this.params=t,this.createMelodyIfDoesntExist()}init(){super.init(),this.onInit()}showEditor_(e){e=!e;r.DropDownDiv.hideWithoutAnimation(),(0,s.clearDropDownDiv)(),r.DropDownDiv.setColour(this.getDropdownBackgroundColour(),this.getDropdownBorderColour());let t=r.DropDownDiv.getContentDiv();pxt.BrowserUtils.addClass(t,"melody-content-div"),pxt.BrowserUtils.addClass(t.parentElement,"melody-editor-dropdown"),this.gallery=new pxtmelody.MelodyGallery,this.renderEditor(t),this.addKeyboardFocusHandlers(),this.attachEventHandlersToMatrix(),this.matrixFocusBind=r.browserEvents.bind(this.matrixSvg,"focus",this,this.handleMatrixFocus.bind(this)),this.tabKeyBind=r.browserEvents.bind(t,"keydown",this,this.handleTabKey.bind(this)),this.prevString=this.getValue(),(0,s.setMelodyEditorOpen)(this.sourceBlock_,!0),r.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_,()=>{this.onEditorClose(),pxt.BrowserUtils.removeClass(t,"melody-content-div"),pxt.BrowserUtils.removeClass(t.parentElement,"melody-editor-dropdown"),(0,s.setMelodyEditorOpen)(this.sourceBlock_,!1)}),e&&this.toggle.getRootElement().focus()}getValue(){return this.stringRep=this.getTypeScriptValue(),this.stringRep}doValueUpdate_(e){null==e||""==e||'""'==e||this.stringRep&&this.stringRep===e||(this.stringRep=e,this.parseTypeScriptValue(e),super.doValueUpdate_(this.getValue()))}getText_(){return this.invalidString?pxt.Util.lf("Invalid Input"):this.getValue()}getFieldDescription(){var e;return(null==(e=null==(e=this.melody.getStringRepresentation())?void 0:e.replace(/-/g,""))?void 0:e.trim())||lf("empty")}onInit(){this.render_(),this.createMelodyIfDoesntExist(),this.invalidString||(this.fieldGroup_||(this.fieldGroup_=r.utils.dom.createSvgElement("g",{},null)),this.visible_||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.updateFieldLabel())}render_(){super.render_(),this.invalidString||(this.size_.width=a.MUSIC_ICON_WIDTH+(a.COLOR_BLOCK_WIDTH+a.COLOR_BLOCK_SPACING)*this.numMatrixCols),this.size_.height=34,this.sourceBlock_.setColour("#ffffff")}renderEditor(e){var t=this.getDropdownBackgroundColour(),r=this.getDropdownBorderColour();this.topDiv=document.createElement("div"),pxt.BrowserUtils.addClass(this.topDiv,"melody-top-bar-div"),this.root=new i.SVG(this.topDiv).id("melody-editor-header-controls"),this.toggle=new l(this.root,{leftText:lf("Editor"),rightText:lf("Gallery"),baseColor:t}),this.toggle.onStateChange(e=>{e?this.hideGallery():this.showGallery()}),this.firstFocusableElement=this.toggle.getRootElement(),this.toggle.layout(),this.toggle.translate((n.TOTAL_WIDTH-this.toggle.width())/2,o),e.appendChild(this.topDiv),e.appendChild(this.gallery.getElement()),this.editorDiv=document.createElement("div"),pxt.BrowserUtils.addClass(this.editorDiv,"melody-editor-div"),this.editorDiv.style.setProperty("background-color",r),this.gridDiv=this.createGridDisplay(),this.editorDiv.appendChild(this.gridDiv),this.bottomDiv=document.createElement("div"),pxt.BrowserUtils.addClass(this.bottomDiv,"melody-bottom-bar-div"),this.doneButton=document.createElement("button"),pxt.BrowserUtils.addClass(this.doneButton,"melody-confirm-button"),this.doneButton.innerText=lf("Done"),this.doneButton.addEventListener("click",()=>this.onDone()),this.doneButton.style.setProperty("background-color",t),this.lastFocusableElement=this.doneButton,this.playButton=document.createElement("button"),this.playButton.id="melody-play-button",this.playButton.addEventListener("click",()=>this.togglePlay()),this.playIcon=document.createElement("i"),this.playIcon.id="melody-play-icon",pxt.BrowserUtils.addClass(this.playIcon,"play icon"),this.playButton.appendChild(this.playIcon),this.tempoInput=document.createElement("input"),pxt.BrowserUtils.addClass(this.tempoInput,"ui input"),this.tempoInput.type="number",this.tempoInput.title=lf("tempo"),this.tempoInput.id="melody-tempo-input",this.tempoInput.addEventListener("input",()=>this.setTempo(+this.tempoInput.value)),this.syncTempoField(!0),this.bottomDiv.appendChild(this.tempoInput),this.bottomDiv.appendChild(this.playButton),this.bottomDiv.appendChild(this.doneButton),this.editorDiv.appendChild(this.bottomDiv),e.appendChild(this.editorDiv)}onEditorClose(){this.stopMelody(),this.gallery&&this.gallery.stopMelody(),this.matrixFocusBind&&(r.browserEvents.unbind(this.matrixFocusBind),this.matrixFocusBind=void 0),this.tabKeyBind&&(r.browserEvents.unbind(this.tabKeyBind),this.tabKeyBind=void 0),this.clearCellSelection(),this.removeKeyboardFocusHandlers(),this.clearDomReferences(),this.sourceBlock_&&r.Events.isEnabled()&&this.getValue()!==this.prevString&&r.Events.fire(new r.Events.BlockChange(this.sourceBlock_,"field",this.name,this.prevString,this.getValue())),this.prevString=void 0}onDone(){r.DropDownDiv.hideIfOwner(this)}clearDomReferences(){this.topDiv=null,this.editorDiv=null,this.gridDiv=null,this.bottomDiv=null,this.doneButton=null,this.playButton=null,this.playIcon=null,this.tempoInput=null,this.matrixSvg=null,this.cells=[],this.toggle=null,this.root=null,this.firstFocusableElement=null,this.lastFocusableElement=null,this.gallery.clearDomReferences()}getTypeScriptValue(){return this.invalidString||(this.melody?'"'+this.melody.getStringRepresentation()+'"':"")}parseTypeScriptValue(e){var t=e;try{e=(e=e.slice(1,-1)).trim(),this.createMelodyIfDoesntExist();var r,n=e.split(" ");n.forEach(e=>{if(!this.isValidNote(e))throw new Error(lf("Invalid note '{0}'. Notes can be C D E F G A B C5",e))}),this.melody.resetMelody();for(let e=0;e<n.length;e++)"-"!=n[e]&&(r=pxtmelody.noteToRow(n[e]),this.melody.updateMelody(r,e));this.updateFieldLabel()}catch(e){pxt.log(e),this.invalidString=t}}isValidNote(e){switch(e){case"C":case"D":case"E":case"F":case"G":case"A":case"B":case"C5":case"-":return!0}return!1}getPreviewWidth(){return this.updateSize_(),this.size_.width}getPreviewHeight(){var e;return(null==(e=this.getConstants())?void 0:e.FIELD_BORDER_RECT_HEIGHT)||16}getDropdownBackgroundColour(){var e=this.sourceBlock_.getParent();return e?e.getColour():"#3D3D3D"}getDropdownBorderColour(){var e=this.sourceBlock_.getParent();return e?e.getColourTertiary():"#2A2A2A"}updateFieldLabel(){if(this.fieldGroup_){pxsim.U.clear(this.fieldGroup_);var e=c("").appendClass("melody-editor-field-icon").at(6,15),t=(this.fieldGroup_.appendChild(e.el),this.melody.getStringRepresentation().trim().split(" "));for(let e=0;e<t.length;e++){var r=pxtmelody.getColorClass(pxtmelody.noteToRow(t[e])),n=(new i.Rect).at((a.COLOR_BLOCK_WIDTH+a.COLOR_BLOCK_SPACING)*e+a.COLOR_BLOCK_X,a.COLOR_BLOCK_Y).size(a.COLOR_BLOCK_WIDTH,a.COLOR_BLOCK_HEIGHT).stroke("#898989",1).fill((e=>{switch(e){case 0:return"#A80000";case 1:return"#D83B01";case 2:return"#FFB900";case 3:return"#107C10";case 4:return"#008272";case 5:return"#0078D7";case 6:return"#5C2D91";case 7:return"#B4009E"}return"#DCDCDC"})(pxtmelody.noteToRow(t[e]))).corners(3,2);pxt.BrowserUtils.addClass(n.el,r),this.fieldGroup_.appendChild(n.el)}}}setTempo(e){(isNaN(e)||e<=0)&&this.tempoInput?this.tempoInput.value=this.tempo+"":this.tempo!=e&&(this.tempo=e,this.melody&&this.melody.setTempo(this.tempo),this.tempoInput&&(this.tempoInput.value=this.tempo+""),this.syncTempoField(!1))}syncTempoField(e){var t=this.sourceBlock_.getParent();if(t)for(var r of t.inputList)if("tempo"===r.name||"bpm"===r.name){r=r.connection.targetBlock();r&&(e?r.getFieldValue("SLIDER")?(this.tempoInput.value=r.getFieldValue("SLIDER"),this.tempo=+this.tempoInput.value):this.tempoInput.value=this.tempo+"":("math_number_minmax"===r.type?r.setFieldValue(this.tempoInput.value,"SLIDER"):r.setFieldValue(this.tempoInput.value,"NUM"),this.tempoInput.focus()));break}}getDuration(){return 6e4/this.tempo}createMelodyIfDoesntExist(){return!this.melody&&(this.melody=new pxtmelody.MelodyArray,!0)}toggleCell(e,t){this.invalidString=null,this.melody.updateMelody(t,e),this.melody.getValue(t,e)&&!this.isPlaying&&this.playNote(t,e),this.updateGrid(),this.updateFieldLabel()}getCellToggled(e,t){return this.melody.getValue(t,e)}useTwoToneFocusIndicator(e,t){return!0}updateGrid(){for(let t=0;t<this.numMatrixRows;t++){var r=pxtmelody.getColorClass(t);for(let e=0;e<this.numMatrixCols;e++){var n=this.cells[e][t];this.melody.getValue(t,e)?(pxt.BrowserUtils.removeClass(n,"melody-default"),pxt.BrowserUtils.addClass(n,r)):(pxt.BrowserUtils.addClass(n,"melody-default"),pxt.BrowserUtils.removeClass(n,r))}}}playNote(e,t){let r=++this.soundingKeys;this.isPlaying?(this.timeouts.push(setTimeout(()=>{this.playToneCore(e)},t*this.getDuration())),this.timeouts.push(setTimeout(()=>{pxt.AudioContextManager.stop()},(t+1)*this.getDuration()))):(this.playToneCore(e),this.timeouts.push(setTimeout(()=>{this.soundingKeys==r&&pxt.AudioContextManager.stop()},this.getDuration())))}queueToneForColumn(t,e,r){let n=setTimeout(()=>{++this.soundingKeys,pxt.AudioContextManager.stop();for(let e=0;e<this.numMatrixRows;e++)this.melody.getValue(e,t)&&this.playToneCore(e);this.highlightColumn(t,!0),this.timeouts=this.timeouts.filter(e=>e!==n)},e),i=setTimeout(()=>{this.timeouts=this.timeouts.filter(e=>e!==i),this.highlightColumn(t,!1)},e+r);this.timeouts.push(n),this.timeouts.push(i)}playToneCore(e){let t=0;switch(e){case 0:t=523;break;case 1:t=494;break;case 2:t=440;break;case 3:t=392;break;case 4:t=349;break;case 5:t=330;break;case 6:t=294;break;case 7:t=262}pxt.AudioContextManager.tone(t)}highlightColumn(e,t){this.cells[e].forEach(e=>{t?pxt.BrowserUtils.addClass(e,"playing"):pxt.BrowserUtils.removeClass(e,"playing")})}createGridDisplay(){return a.VIEWBOX_WIDTH=(a.CELL_WIDTH+a.CELL_HORIZONTAL_MARGIN)*this.numMatrixCols+a.CELL_HORIZONTAL_MARGIN,pxt.BrowserUtils.isEdge()&&(a.VIEWBOX_WIDTH+=37),a.VIEWBOX_HEIGHT=(a.CELL_WIDTH+a.CELL_VERTICAL_MARGIN)*this.numMatrixRows+a.CELL_VERTICAL_MARGIN,this.matrixSvg=pxsim.svg.parseString(`<svg xmlns="http://www.w3.org/2000/svg" class="melody-grid-div blocklyMatrix" role="grid" viewBox="0 0 ${a.VIEWBOX_WIDTH} ${a.VIEWBOX_HEIGHT}" tabindex="0" />`),this.matrixSvg.ariaLabel=lf("Melody grid"),this.createMatrixDisplay({cellWidth:a.CELL_WIDTH,cellHeight:a.CELL_WIDTH,cellLabel:lf("Note"),cellStroke:"white",cellHorizontalMargin:a.CELL_HORIZONTAL_MARGIN,cellVerticalMargin:a.CELL_VERTICAL_MARGIN,cornerRadius:a.CELL_CORNER_RADIUS}),this.updateGrid(),this.matrixSvg}handleMatrixFocus(e){this.selected||(t=null!=(t=this.getMelodyNote(0))?t:0,this.selected=[0,t]);var[t,r]=this.selected;this.focusCell(t,r)}handleTabKey(e){"Tab"===e.code&&(document.activeElement!==this.lastFocusableElement||e.shiftKey?document.activeElement===this.firstFocusableElement&&e.shiftKey&&(this.lastFocusableElement.focus(),e.preventDefault()):(this.firstFocusableElement.focus(),e.preventDefault()))}attachPointerEventHandlersToCell(t,r,n){pxsim.pointerEvents.down.forEach(e=>n.addEventListener(e,e=>{this.toggleCell(t,r),this.clearFocusIndicator(),e.stopPropagation(),e.preventDefault()},!1))}handleArrowUp(e,t){var r=void 0!==this.getMelodyNote(e);this.selected=[e,t-1],r&&this.toggleCell(this.selected[0],this.selected[1])}handleArrowDown(e,t){var r=void 0!==this.getMelodyNote(e);this.selected=[e,t+1],r&&this.toggleCell(this.selected[0],this.selected[1])}handleArrowLeft(e,t){var e=(e+this.numMatrixCols-1)%this.numMatrixCols,r=null!=(r=this.getMelodyNote(e))?r:t;this.selected=[e,r]}handleArrowRight(e,t){var e=(e+this.numMatrixCols+1)%this.numMatrixCols,r=null!=(r=this.getMelodyNote(e))?r:t;this.selected=[e,r]}getMelodyNote(t){for(let e=0;e<this.numMatrixRows;++e)if(this.melody.getValue(e,t))return e}togglePlay(){this.isPlaying?this.stopMelody():(this.isPlaying=!0,this.playMelody()),this.updatePlayButton()}updatePlayButton(){this.isPlaying?(pxt.BrowserUtils.removeClass(this.playIcon,"play icon"),pxt.BrowserUtils.addClass(this.playIcon,"stop icon")):(pxt.BrowserUtils.removeClass(this.playIcon,"stop icon"),pxt.BrowserUtils.addClass(this.playIcon,"play icon"))}playMelody(){if(this.isPlaying){for(let e=0;e<this.numMatrixCols;e++)this.queueToneForColumn(e,e*this.getDuration(),this.getDuration());this.timeouts.push(setTimeout(()=>this.playMelody(),this.numMatrixCols*this.getDuration()))}else this.stopMelody()}stopMelody(){if(this.isPlaying){for(;this.timeouts.length;)clearTimeout(this.timeouts.shift());pxt.AudioContextManager.stop(),this.isPlaying=!1,this.cells.forEach(e=>e.forEach(e=>pxt.BrowserUtils.removeClass(e,"playing")))}}showGallery(){this.stopMelody(),this.updatePlayButton(),this.gallery.show(e=>{e&&(this.melody.parseNotes(e),this.toggle.toggle(),this.toggle.getRootElement().focus(),this.updateFieldLabel(),this.updateGrid())}),this.lastFocusableElement=this.gallery.getLastFocusableElement()}hideGallery(){this.gallery.hide(),this.lastFocusableElement=this.doneButton}isFullBlockField(){return!0}}(n.FieldCustomMelody=a).CELL_WIDTH=25,a.CELL_HORIZONTAL_MARGIN=5,a.CELL_VERTICAL_MARGIN=7,a.CELL_CORNER_RADIUS=5,a.COLOR_BLOCK_WIDTH=10,a.COLOR_BLOCK_HEIGHT=20,a.COLOR_BLOCK_X=20,a.COLOR_BLOCK_Y=5,a.COLOR_BLOCK_SPACING=2,a.MUSIC_ICON_WIDTH=20;let o=6;class l{constructor(e,t){this.props=(e=>(e.baseColor||(e.baseColor="#e95153"),e.backgroundColor||(e.backgroundColor="rgba(52,73,94,.2)"),e.borderColor||(e.borderColor="rgba(52,73,94,.4)"),e.selectedTextColor||(e.selectedTextColor=e.baseColor),e.unselectedTextColor||(e.unselectedTextColor="hsla(0,0%,100%,.9)"),e.switchColor||(e.switchColor="#ffffff"),e))(t),this.root=e.group(),this.buildDom(),this.isLeft=!0}buildDom(){this.root.style().content(`
        .toggle-left {
            transform: translateX(0px);
            animation: mvleft 0.2s 0s ease;
        }

        .toggle-right {
            transform: translateX(100px);
            animation: mvright 0.2s 0s ease;
        }

        @keyframes mvright {
            0% {
                transform: translateX(0px);
            }
            100% {
                transform: translateX(100px);
            }
        }

        @keyframes mvleft {
            0% {
                transform: translateX(100px);
            }
            100% {
                transform: translateX(0px);
            }
        }
        `),this.root.def().create("clipPath","sprite-editor-toggle-border").clipPathUnits(!0).draw("rect").at(0,0).corners(.02,.1).size(1,1),this.root.draw("rect").size(200,40).fill(this.props.baseColor).stroke(this.props.borderColor,4).corners(4,4).clipPath("url(#sprite-editor-toggle-border)"),this.root.draw("rect").at(2,2).size(196,36).fill(this.props.backgroundColor).corners(4,4),this.switch=this.root.draw("rect").at(2,2).size(98,36).fill(this.props.switchColor).corners(4,4),this.leftElement=this.root.group(),this.leftText=c(this.props.leftText).appendClass("sprite-editor-text").fill(this.props.selectedTextColor),this.leftElement.appendChild(this.leftText),this.rightElement=this.root.group(),this.rightText=c(this.props.rightText).appendClass("sprite-editor-text").fill(this.props.unselectedTextColor),this.rightElement.appendChild(this.rightText),this.root.onClick(()=>this.toggle()),this.root.el.tabIndex=0,this.root.el.classList.add("melody-editor-toggle-buttons"),this.root.el.addEventListener("keydown",e=>{["Space","ArrowLeft","ArrowRight","Enter"].includes(e.code)&&(this.toggle(),e.preventDefault())})}toggle(e=!1){this.isLeft?(this.switch.removeClass("toggle-left"),this.switch.appendClass("toggle-right"),this.leftText.fill(this.props.unselectedTextColor),this.rightText.fill(this.props.selectedTextColor)):(this.switch.removeClass("toggle-right"),this.switch.appendClass("toggle-left"),this.leftText.fill(this.props.selectedTextColor),this.rightText.fill(this.props.unselectedTextColor)),this.isLeft=!this.isLeft,!e&&this.changeHandler&&this.changeHandler(this.isLeft)}onStateChange(e){this.changeHandler=e}layout(){this.leftText.moveTo(51,20),this.rightText.moveTo(149,20)}translate(e,t){this.root.translate(e,t)}height(){return 40}width(){return 200}getRootElement(){return this.root.el}}function c(e){return new i.Text(e).anchor("middle").setAttribute("dominant-baseline","middle").setAttribute("dy",pxt.BrowserUtils.isIE()||pxt.BrowserUtils.isEdge()?"0.3em":"0.1em")}},{"./field_matrix":42,"./field_utils":69,blockly:175}],44:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldMusicEditor=void 0;var n=pxt.svgUtil,i=e("./field_asset");let s=e("./field_utils");class a extends i.FieldAssetEditor{getAssetType(){return"song"}createNewAsset(e){var t=pxt.react.getTilemapProject();if(e){var r=pxt.lookupProjectAssetByTSReference(e,t);if(r)return r}if(this.getBlockData())return t.lookupAsset("song",this.getBlockData());let n;if(e?(r=/^\s*hex\s*`([a-fA-F0-9]+)`\s*(?:;?)\s*$/.exec(e))&&(n=pxt.assets.music.decodeSongFromHex(r[1])):n=pxt.assets.music.getEmptySong(2),n)return pxt.assets.music.inflateSong(n),{internalID:-1,id:this.temporaryAssetId(),type:"song",meta:{},song:n};this.isGreyBlock=!0,this.valueText=e}render_(){super.render_(),this.isGreyBlock||(this.size_.height=42,this.size_.width=18+this.previewWidth())}getValueText(){return this.asset&&!this.isTemporaryAsset()?pxt.getTSReferenceForAsset(this.asset):this.asset?`hex\`${pxt.assets.music.encodeSongToHex(this.asset.song)}\``:this.valueText||""}parseFieldOptions(e){return{}}redrawPreview(){var e,t;this.fieldGroup_&&(pxsim.U.clear(this.fieldGroup_),this.isGreyBlock?super.redrawPreview():(e=18+this.previewWidth(),t=(new n.Rect).at(5,1).size(8+this.previewWidth(),40).setClass("blocklySpriteField").stroke("#898989",1).corner(4),this.fieldGroup_.appendChild(t.el),this.asset&&(t=(0,s.songToDataURI)(this.asset.song,this.previewWidth(),32,this.lightMode))&&(t=(new n.Image).src(t).at(9,5).size(this.previewWidth(),32),this.fieldGroup_.appendChild(t.el)),(null==(t=this.size_)?void 0:t.width)!=e&&this.forceRerender()))}previewWidth(){return 32*(this.asset?this.asset.song.measures:2)}}r.FieldMusicEditor=a},{"./field_asset":29,"./field_utils":69}],45:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldNote=void 0;let u=e("blockly"),d=e("./field_utils");var n;(e=n=n||{})[e.C=262]="C",e[e.CSharp=277]="CSharp",e[e.D=294]="D",e[e.Eb=311]="Eb",e[e.E=330]="E",e[e.F=349]="F",e[e.FSharp=370]="FSharp",e[e.G=392]="G",e[e.GSharp=415]="GSharp",e[e.A=440]="A",e[e.Bb=466]="Bb",e[e.B=494]="B",e[e.C3=131]="C3",e[e.CSharp3=139]="CSharp3",e[e.D3=147]="D3",e[e.Eb3=156]="Eb3",e[e.E3=165]="E3",e[e.F3=175]="F3",e[e.FSharp3=185]="FSharp3",e[e.G3=196]="G3",e[e.GSharp3=208]="GSharp3",e[e.A3=220]="A3",e[e.Bb3=233]="Bb3",e[e.B3=247]="B3",e[e.C4=262]="C4",e[e.CSharp4=277]="CSharp4",e[e.D4=294]="D4",e[e.Eb4=311]="Eb4",e[e.E4=330]="E4",e[e.F4=349]="F4",e[e.FSharp4=370]="FSharp4",e[e.G4=392]="G4",e[e.GSharp4=415]="GSharp4",e[e.A4=440]="A4",e[e.Bb4=466]="Bb4",e[e.B4=494]="B4",e[e.C5=523]="C5",e[e.CSharp5=555]="CSharp5",e[e.D5=587]="D5",e[e.Eb5=622]="Eb5",e[e.E5=659]="E5",e[e.F5=698]="F5",e[e.FSharp5=740]="FSharp5",e[e.G5=784]="G5",e[e.GSharp5=831]="GSharp5",e[e.A5=880]="A5",e[e.Bb5=932]="Bb5",e[e.B5=988]="B5",e[e.C6=1047]="C6",e[e.CSharp6=1109]="CSharp6",e[e.D6=1175]="D6",e[e.Eb6=1245]="Eb6",e[e.E6=1319]="E6",e[e.F6=1397]="F6",e[e.FSharp6=1480]="FSharp6",e[e.G6=1568]="G6",e[e.GSharp6=1568]="GSharp6",e[e.A6=1760]="A6",e[e.Bb6=1865]="Bb6",e[e.B6=1976]="B6",e[e.C7=2093]="C7";class p extends u.FieldNumber{constructor(e,t,r){super(null,0,null,null,r),this.isFieldCustom_=!0,this.SERIALIZABLE=!0,this.isTextValid_=!0,this.nKeys_=36,this.minNote_=28,this.maxNote_=63,this.eps=2,this.keyHandler=e=>{var t,r="string"==typeof this.value_?parseFloat(this.value_):this.value_;"ArrowUp"!==e.code&&"ArrowDown"!==e.code||({keyAbove:r,keyBelow:t}=this.getNeighboringKeys(r),r="ArrowUp"===e.code?r:t,t=this.getKeyFreq(r),this.setValue(t),this.playKey(this.piano[r-this.minNote_],t),this.noteLabel.textContent=this.getKeyName(r),e.stopPropagation(),e.preventDefault())},this.setSpellcheck(!1),this.prepareNotes(),this.isExpanded=!1,this.currentPage=0,this.totalPlayCount=0,t.editorColour&&(this.primaryColour=(0,d.parseColour)(t.editorColour),this.borderColour=u.utils.colour.blend("#000000",this.primaryColour,.2));r=parseInt(t.eps),!Number.isNaN(r)&&0<=r&&(this.eps=r),r=parseInt(t.minNote)||this.minNote_,t=parseInt(t.maxNote)||this.maxNote_;28<=r&&t<=75&&r<t&&(this.minNote_=r,this.maxNote_=t,this.nKeys_=this.maxNote_-this.minNote_+1),this.setValue(e)}doClassValidation_(e){var t=/^Note\.(.+)$/.exec(e),t=t&&1<t.length?t[1]:null;return null===(e=n[t]||String(parseFloat(e||"0")))||(t=parseFloat(e||"0"),isNaN(t))||t<0?null:(e=Math.floor(t)!=t,Number(t.toFixed(e?2:0)))}getValue(){return this.value_+""}doValueUpdate_(e){isNaN(Number(e))||Number(e)<0||(this.sourceBlock_&&u.Events.isEnabled()&&this.value_!=e&&u.Events.fire(new u.Events.BlockChange(this.sourceBlock_,"field",this.name,this.value_,e)),this.value_=e,this.refreshText())}getText(){return this.isExpanded?""+this.value_:this.getNoteString()}getFieldDescription(){return this.getNoteString()||lf("note")}getNoteString(){var t=+this.value_;for(let e=0;e<this.nKeys_;e++)if(Math.abs(this.getKeyFreq(e+this.minNote_)-t)<this.eps)return this.getKeyName(e+this.minNote_);let e=t.toString();return isNaN(t)||(e+=" Hz"),e}refreshText(){this.forceRerender()}onFinishEditing_(e){this.refreshText()}onHide(){this.isExpanded=!1,this.refreshText()}widgetDispose_(){this.htmlInput_.removeEventListener("keydown",this.keyHandler),super.widgetDispose_()}showEditor_(e){this.isExpanded=!0,this.updateColor(),u.DropDownDiv.hideWithoutAnimation(),(0,d.clearDropDownDiv)();var t=pxt.BrowserUtils.isMobile()||pxt.BrowserUtils.isIOS(),e=(super.showEditor_(e,t),this.refreshText(),u.Events.setGroup(!0),this.piano=[],this.currentSelectedKey=void 0,this.nKeys_-this.nKeys_/p.notesPerOctave*p.blackKeysPerOctave),r=p.notesPerOctave-p.blackKeysPerOctave;let n=p.keyWidth*e,i=p.keyHeight+p.labelHeight;var s=window.innerWidth<n,a=(s&&(n=r*p.keyWidth,i=p.keyHeight+p.labelHeight+p.prevNextHeight),h("blocklyPianoDiv",`width: ${n}px;
            height: ${i}px;`));u.DropDownDiv.getContentDiv().appendChild(a),this.noteLabel=h("blocklyNoteLabel",`top: ${p.keyHeight}px;
            width: ${n}px;
            background-color: ${this.primaryColour};
            border-color: ${this.primaryColour};`),a.appendChild(this.noteLabel),this.noteLabel.textContent="-";let o=0;for(let t=0;t<this.nKeys_;t++){var l=Math.floor(t/p.notesPerOctave);let e=this.getPosition(t+this.minNote_);s&&t>=p.notesPerOctave&&(e-=r*l*p.keyWidth);var c=this.getKeyDiv(t+this.minNote_,e);this.piano.push(c),a.appendChild(c),Math.abs(this.getKeyFreq(t+this.minNote_)-Number(this.getValue()))<this.eps&&(pxt.BrowserUtils.addClass(c,"selected"),this.currentSelectedKey=c,o=l)}s&&(this.setPage(o),a.appendChild(this.getNextPrevDiv(!0,n)),a.appendChild(this.getNextPrevDiv(!1,n))),u.DropDownDiv.setColour(this.primaryColour,this.borderColour),u.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_,()=>this.onHide(),void 0,!1),this.htmlInput_.addEventListener("keydown",this.keyHandler)}playKey(e,t){let r=++this.totalPlayCount;this.currentSelectedKey!==e&&(this.currentSelectedKey&&pxt.BrowserUtils.removeClass(this.currentSelectedKey,"selected"),pxt.BrowserUtils.addClass(e,"selected"),this.setValue(t)),this.currentSelectedKey=e,this.htmlInput_.value=this.getText(),pxt.AudioContextManager.tone(t),setTimeout(()=>{this.totalPlayCount==r&&pxt.AudioContextManager.stop()},300)}dispose(){u.DropDownDiv.hideIfOwner(this),super.dispose()}updateColor(){var e,t=this.sourceBlock_.getParent();t&&(this.sourceBlock_.isShadow()||1===(e=this.sourceBlock_).inputList.length&&1===e.inputList[0].fieldRow.length)?(this.primaryColour=t.getColour(),this.borderColour=t.getColourTertiary()):(this.primaryColour="#3D3D3D",this.borderColour="#2A2A2A")}setPage(e){var t=this.nKeys_/p.notesPerOctave,r=(e=Math.max(Math.min(e,t-1),0),this.noteLabel.textContent="Octave #"+(e+1),e*p.notesPerOctave);for(let e=0;e<this.piano.length;++e){var n=e>=r&&e<r+p.notesPerOctave;this.piano[e].style.display=n?"block":"none"}this.currentPage=e}getNextPrevDiv(t,e){var r=t?0:e/2;let n=h("blocklyNotePrevNext",`top: ${p.keyHeight+p.labelHeight}px;
            left: ${r}px;
            width: ${Math.ceil(e/2)}px;
            ${t?"border-left-color":"border-right-color"}: ${this.primaryColour};
            background-color: ${this.primaryColour};
            border-bottom-color: ${this.primaryColour};`);return pxt.BrowserUtils.pointerEvents.down.forEach(e=>{u.browserEvents.conditionalBind(n,e,this,()=>this.setPage(t?this.currentPage-1:this.currentPage+1),!0)}),n.textContent=t?"<":">",n}getKeyDiv(t,e){let r=h("blocklyNote "+(this.isWhite(t)?"":"black"),`width: ${this.getKeyWidth(t)}px;
            height: ${this.getKeyHeight(t)}px;
            left: ${e}px;
            border-color: ${this.primaryColour};`);return pxt.BrowserUtils.pointerEvents.down.forEach(e=>{u.browserEvents.conditionalBind(r,e,this,()=>this.playKey(r,this.getKeyFreq(t)),!0)}),u.browserEvents.conditionalBind(r,"mouseover",this,e=>{this.noteLabel.textContent=this.getKeyName(t),e.buttons&&this.playKey(r,this.getKeyFreq(t))},!0),r}isWhite(e){switch((e+=8)%12){case 1:case 3:case 6:case 8:case 10:return!1;default:return!0}}whiteKeysBefore(e){switch((e+=8)%12){case 0:return 0;case 1:case 2:return 1;case 3:case 4:return 2;case 5:return 3;case 6:case 7:return 4;case 8:case 9:return 5;case 10:case 11:return 6}return-1}getKeyWidth(e){return this.isWhite(e)?p.keyWidth:p.keyWidth/2}getKeyHeight(e){return this.isWhite(e)?p.keyHeight:p.keyHeight/2}getNeighboringKeys(t){let r,n;for(let e=this.minNote_;e<=this.maxNote_;++e){if(this.getKeyFreq(e)+this.eps>t){n=e;break}r=e}return r?n&&n!==this.maxNote_?(t<this.getKeyFreq(r)+this.eps?n=r:t>this.getKeyFreq(n)-this.eps&&(r=n),{keyAbove:r+1,keyBelow:n-1}):{keyAbove:this.maxNote_,keyBelow:t-this.eps<this.getKeyFreq(this.maxNote_)?this.maxNote_-1:this.maxNote_}:{keyAbove:t+this.eps>this.getKeyFreq(this.minNote_)?this.minNote_+1:this.minNote_,keyBelow:this.minNote_}}getKeyFreq(e){return this.getKeyNoteData(e).freq}getKeyName(e){e=this.getKeyNoteData(e);let t=e.prefixedName;return this.nKeys_<=p.notesPerOctave?t=e.name:28<=this.minNote_&&this.maxNote_<=63&&(t=e.altPrefixedName||t),t}getKeyNoteData(e){return p.Notes[e]}getPosition(e){if(e===this.minNote_)return 0;var t,r=p.keyWidth/4,n=Math.floor((this.minNote_+8)/p.notesPerOctave),i=Math.floor((e+8)/p.notesPerOctave);let s=this.whiteKeysBefore(this.minNote_)*p.keyWidth;return this.isWhite(this.minNote_)||(s-=r),n<i?(i=(t=7*p.keyWidth)-s+(i-n-1)*t,this.whiteKeysBefore(e)*p.keyWidth+i-(this.isWhite(e)?0:r)):this.whiteKeysBefore(e)*p.keyWidth-s-(this.isWhite(e)?0:r)}prepareNotes(){p.Notes||(p.Notes={28:{name:lf("{id:note}C"),prefixedName:lf("Low C"),freq:131},29:{name:lf("C#"),prefixedName:lf("Low C#"),freq:139},30:{name:lf("{id:note}D"),prefixedName:lf("Low D"),freq:147},31:{name:lf("D#"),prefixedName:lf("Low D#"),freq:156},32:{name:lf("{id:note}E"),prefixedName:lf("Low E"),freq:165},33:{name:lf("{id:note}F"),prefixedName:lf("Low F"),freq:175},34:{name:lf("F#"),prefixedName:lf("Low F#"),freq:185},35:{name:lf("{id:note}G"),prefixedName:lf("Low G"),freq:196},36:{name:lf("G#"),prefixedName:lf("Low G#"),freq:208},37:{name:lf("{id:note}A"),prefixedName:lf("Low A"),freq:220},38:{name:lf("A#"),prefixedName:lf("Low A#"),freq:233},39:{name:lf("{id:note}B"),prefixedName:lf("Low B"),freq:247},40:{name:lf("{id:note}C"),prefixedName:lf("Middle C"),freq:262},41:{name:lf("C#"),prefixedName:lf("Middle C#"),freq:277},42:{name:lf("{id:note}D"),prefixedName:lf("Middle D"),freq:294},43:{name:lf("D#"),prefixedName:lf("Middle D#"),freq:311},44:{name:lf("{id:note}E"),prefixedName:lf("Middle E"),freq:330},45:{name:lf("{id:note}F"),prefixedName:lf("Middle F"),freq:349},46:{name:lf("F#"),prefixedName:lf("Middle F#"),freq:370},47:{name:lf("{id:note}G"),prefixedName:lf("Middle G"),freq:392},48:{name:lf("G#"),prefixedName:lf("Middle G#"),freq:415},49:{name:lf("{id:note}A"),prefixedName:lf("Middle A"),freq:440},50:{name:lf("A#"),prefixedName:lf("Middle A#"),freq:466},51:{name:lf("{id:note}B"),prefixedName:lf("Middle B"),freq:494},52:{name:lf("{id:note}C"),prefixedName:lf("Tenor C"),altPrefixedName:lf("High C"),freq:523},53:{name:lf("C#"),prefixedName:lf("Tenor C#"),altPrefixedName:lf("High C#"),freq:554},54:{name:lf("{id:note}D"),prefixedName:lf("Tenor D"),altPrefixedName:lf("High D"),freq:587},55:{name:lf("D#"),prefixedName:lf("Tenor D#"),altPrefixedName:lf("High D#"),freq:622},56:{name:lf("{id:note}E"),prefixedName:lf("Tenor E"),altPrefixedName:lf("High E"),freq:659},57:{name:lf("{id:note}F"),prefixedName:lf("Tenor F"),altPrefixedName:lf("High F"),freq:698},58:{name:lf("F#"),prefixedName:lf("Tenor F#"),altPrefixedName:lf("High F#"),freq:740},59:{name:lf("{id:note}G"),prefixedName:lf("Tenor G"),altPrefixedName:lf("High G"),freq:784},60:{name:lf("G#"),prefixedName:lf("Tenor G#"),altPrefixedName:lf("High G#"),freq:831},61:{name:lf("{id:note}A"),prefixedName:lf("Tenor A"),altPrefixedName:lf("High A"),freq:880},62:{name:lf("A#"),prefixedName:lf("Tenor A#"),altPrefixedName:lf("High A#"),freq:932},63:{name:lf("{id:note}B"),prefixedName:lf("Tenor B"),altPrefixedName:lf("High B"),freq:988},64:{name:lf("{id:note}C"),prefixedName:lf("High C"),freq:1046},65:{name:lf("C#"),prefixedName:lf("High C#"),freq:1109},66:{name:lf("{id:note}D"),prefixedName:lf("High D"),freq:1175},67:{name:lf("D#"),prefixedName:lf("High D#"),freq:1245},68:{name:lf("{id:note}E"),prefixedName:lf("High E"),freq:1319},69:{name:lf("{id:note}F"),prefixedName:lf("High F"),freq:1397},70:{name:lf("F#"),prefixedName:lf("High F#"),freq:1478},71:{name:lf("{id:note}G"),prefixedName:lf("High G"),freq:1568},72:{name:lf("G#"),prefixedName:lf("High G#"),freq:1661},73:{name:lf("{id:note}A"),prefixedName:lf("High A"),freq:1760},74:{name:lf("A#"),prefixedName:lf("High A#"),freq:1865},75:{name:lf("{id:note}B"),prefixedName:lf("High B"),freq:1976}})}}function h(e,t){var r=document.createElement("div");return pxt.BrowserUtils.addClass(r,e),r.setAttribute("style",t.replace(/\s+/g," ")),r}(r.FieldNote=p).keyWidth=22,p.keyHeight=90,p.labelHeight=24,p.prevNextHeight=20,p.notesPerOctave=12,p.blackKeysPerOctave=5},{"./field_utils":69,blockly:175}],46:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldNumberDropdown=void 0;e=e("./field_textdropdown");class n extends e.BaseFieldTextDropdown{constructor(e,t,r,n,i,s){super(e+"",t,s),this.setConstraints(r,n,i)}setConstraints(e,t,r){this.setMinInternal(e),this.setMaxInternal(t),this.setPrecisionInternal(r),this.setValue(this.getValue())}getValue(){return Number(super.getValue())}setMinInternal(e){null==e?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}setMaxInternal(e){null==e?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}setPrecisionInternal(e){this.precision_=Number(e)||0;let t=String(this.precision_);var r=(t=-1!==t.indexOf("e")?this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}):t).indexOf(".");this.decimalPlaces=-1===r?e?0:null:t.length-r-1}doClassValidation_(e){if(null===e)return null;e=(e=(e=(e=""+e).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity");let t=Number(e||0);return isNaN(t)?null:(void 0!==this.min_&&(t=Math.max(t,this.min_)),void 0!==this.max_&&(t=Math.min(t,this.max_)),this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_),(t=null!==this.decimalPlaces?Number(t.toFixed(this.decimalPlaces)):t)+"")}}class i extends n{constructor(e,t,r){super(e,(t=>{let r;if(t.values){var n,i=[],s=t.values.split(",");let e=!1;for(n of s){var a=parseFloat(n);if(Number.isNaN(a)){e=!0;break}i.push([n,a])}e||(r=i)}else if(t.data)try{var o=JSON.parse(t.data);if(Array.isArray(o)&&o.length){if((e=>{for(var t of e)if("number"!=typeof t)return;return 1})(o))return o.map(e=>[""+e,e]);{let e=!1;for(var l of o)if(!Array.isArray(l)||"string"!=typeof l[0]||"number"!=typeof l[1]){e=!0;break}e||(r=o)}}}catch(e){}return r||(pxt.warn("Could not parse numberdropdown data field"),[])})(t),t.min,t.max,t.precision,r),this.isFieldCustom_=!0}getOptions(){let e;return this.menuGenerator_&&("string"==typeof this.menuGenerator_&&(this.menuGenerator_=JSON.parse(this.menuGenerator_)),e=this.menuGenerator_.map(e=>"object"==typeof e?[pxt.Util.rlf(e[0]),e[1]]:[String(e),String(e)])),e}}r.FieldNumberDropdown=i},{"./field_textdropdown":55}],47:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldPosition=void 0;let u=e("blockly");e=e("../plugins/math");class n extends e.FieldSlider{constructor(e,t,r){super(e,"0","100","1","1","Value",r),this.isFieldCustom_=!0,this.params=t,this.params.screenHeight||(this.params.screenHeight=120),this.params.screenWidth||(this.params.screenWidth=160),this.params.xInputName||(this.params.xInputName="x"),this.params.yInputName||(this.params.yInputName="y"),this.params.min&&(this.min_=parseInt(this.params.min)),this.params.max&&(this.max_=parseInt(this.params.max))}showEditor_(e){this.getFieldByName(this.params.xInputName)===this&&(this.max_=this.params.screenWidth,this.labelText_=this.params.xInputName);var t=this.getFieldByName(this.params.yInputName);t===this&&(this.max_=this.params.screenHeight,this.labelText_=this.params.yInputName),super.showEditor_(e),this.renderScreenPicker()}doValueUpdate_(e){super.doValueUpdate_(e),this.resetCrosshair&&this.resetCrosshair()}renderScreenPicker(){var e=u.DropDownDiv.getContentDiv();this.selectorDiv_=document.createElement("div"),this.selectorDiv_.className="blocklyCanvasOverlayOuter",e.appendChild(this.selectorDiv_);let n=document.createElement("div"),i=(n.className="blocklyCanvasOverlayDiv",this.selectorDiv_.appendChild(n),document.createElement("div")),s=(i.className="cross-x",n.appendChild(i),document.createElement("div")),a=(s.className="cross-y",n.appendChild(s),document.createElement("div")),o=(a.className="label",n.appendChild(a),1.5*this.params.screenWidth),l=1.5*this.params.screenHeight;n.style.height=l+"px",n.style.width=o+"px";var e=e.getElementsByClassName("goog-slider-horizontal")[0];e&&(e.style.width=o+"px",e=Number(this.getValue()),!isNaN(e))&&e>this.getMin()&&(this.setValue(e-1+""),this.setValue(e+""));let c=(e,t)=>{e=Math.round(Math.max(0,Math.min(o,e))),t=Math.round(Math.max(0,Math.min(l,t))),i.style.top=t+"px",s.style.left=e+"px",e=Math.round(Math.max(0,Math.min(this.params.screenWidth,e/o*this.params.screenWidth))),t=Math.round(Math.max(0,Math.min(this.params.screenHeight,t/l*this.params.screenHeight))),isNaN(e)?a.textContent=this.params.yInputName+"="+t:isNaN(t)?a.textContent=this.params.xInputName+"="+e:a.textContent=`${this.params.xInputName}=${e} ${this.params.yInputName}=`+t;var r=a.getBoundingClientRect();e>this.params.screenWidth/2?a.style.left=e*(o/this.params.screenWidth)-r.width-8+"px":a.style.left=e*(o/this.params.screenWidth)+4+"px",t>this.params.screenHeight/2?a.style.top=t*(l/this.params.screenHeight)-r.height-6+"px":a.style.top=t*(l/this.params.screenHeight)+"px"};this.resetCrosshair=()=>{var{currentX:e,currentY:t}=this.getXY();c(e/this.params.screenWidth*o,t/this.params.screenHeight*l)},this.resetCrosshair(),u.browserEvents.bind(this.selectorDiv_,"mousemove",this,e=>{var t=n.getBoundingClientRect(),r=e.clientX-t.left,e=e.clientY-t.top;c(r,e)}),u.browserEvents.bind(this.selectorDiv_,"mouseleave",this,this.resetCrosshair),u.browserEvents.bind(this.selectorDiv_,"click",this,e=>{var t=n.getBoundingClientRect(),r=e.clientX-t.left,e=e.clientY-t.top,t=Math.round(r/o*this.params.screenWidth),r=Math.round(e/l*this.params.screenHeight);this.close(),this.setXY(t,r)})}resizeHandler(){this.close()}setXY(e,t){var r=this.getFieldByName(this.params.xInputName),r=(r&&"number"==typeof r.getValue()&&r.setValue(String(e)),this.getFieldByName(this.params.yInputName));r&&"number"==typeof r.getValue()&&r.setValue(String(t))}getFieldByName(t){var r=this.sourceBlock_.getParent();if(r)for(let e=0;e<r.inputList.length;e++){var n=r.inputList[e];if(n.name===t)return this.getTargetField(n)}}getXY(){let e,t;var r=this.getFieldByName(this.params.xInputName),r=(r&&(e=r.getValue()),this.getFieldByName(this.params.yInputName));return r&&(t=r.getValue()),{currentX:parseInt(e),currentY:parseInt(t)}}getTargetField(e){var e=e.connection.targetBlock();return(e=e&&e.inputList[0])?e.fieldRow[0]:null}widgetDispose_(){super.widgetDispose_(),this.close(!0)}close(e){e||(u.WidgetDiv.hideIfOwner(this),u.DropDownDiv.hideIfOwner(this)),window.removeEventListener("resize",this.resizeHandler),this.resetCrosshair=void 0,this.selectorDiv_&&(u.utils.dom.removeNode(this.selectorDiv_),this.selectorDiv_=void 0)}}r.FieldPosition=n},{"../plugins/math":119,blockly:175}],48:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldProcedure=void 0;e=e("./field_dropdown");class n extends e.FieldDropdown{constructor(e,t){super(function(){var t=[];if(this.sourceBlock_&&this.sourceBlock_.workspace){var r,n=this.sourceBlock_.workspace.getAllBlocks(!1);for(let e=0;e<n.length;e++)n[e].getProcedureDef&&(r=n[e].getProcedureDef(),t.push(r[0]))}var e=this.getValue(),i=(e&&-1==t.indexOf(e)&&t.push(e),t.sort((e,t)=>{e=e.toLowerCase(),t=t.toLowerCase();return e===t?0:t<e?1:-1}),t.length||t.push("Temp"),this.rawValue&&-1===t.indexOf(this.rawValue)&&t.push(this.rawValue),[]);for(let e=0;e<t.length;e++)i[e]=[t[e],t[e]];return i},t),this.setValue(e||"")}getOptions(e){return this.menuGenerator_()}doClassValidation_(e){return void 0===e?null:e}doValueUpdate_(e){this.rawValue=e,super.doValueUpdate_(e)}init(){this.fieldGroup_||super.init.call(this)}setSourceBlock(e){pxt.Util.assert(!e.isShadow(),"Procedure fields are not allowed to exist on shadow blocks."),super.setSourceBlock.call(this,e)}}r.FieldProcedure=n},{"./field_dropdown":34}],49:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldProtractor=void 0;e=e("../plugins/math");class n extends e.FieldSlider{constructor(e,t,r){super(String(e),"0","180","1","15",lf("Angle"),r),this.isFieldCustom_=!0,this.params=t}createLabelDom_(e){var t=document.createElement("div"),r=(this.circleSVG=document.createElementNS("http://www.w3.org/2000/svg","svg"),pxsim.svg.hydrate(this.circleSVG,{viewBox:"0 0 200 100",width:"170"}),t.appendChild(this.circleSVG),pxsim.svg.child(this.circleSVG,"circle",{"stroke-dasharray":"565.48","stroke-dashoffset":"0",cx:100,cy:100,r:"90",style:"fill:transparent; transition: stroke-dashoffset 0.1s linear;",stroke:"#a8aaa8","stroke-width":"1rem"}),this.circleBar=pxsim.svg.child(this.circleSVG,"circle",{"stroke-dasharray":"565.48","stroke-dashoffset":"0",cx:100,cy:100,r:"90",style:"fill:transparent; transition: stroke-dashoffset 0.1s linear;",stroke:"#f12a21","stroke-width":"1rem"}),this.reporter=pxsim.svg.child(this.circleSVG,"text",{x:100,y:80,"text-anchor":"middle","dominant-baseline":"middle",style:"font-size: 50px",class:"sim-text inverted number"}),document.createElement("span"));return r.setAttribute("class","blocklyFieldSliderReadout"),[t,r]}setReadout(e){this.updateAngle("string"==typeof e?parseFloat(e):e),this.reporter&&(this.reporter.textContent=e+"")}updateAngle(e){this.circleBar&&(e=(180-(e=Math.max(0,Math.min(180,e))))/180*Math.PI*90,this.circleBar.setAttribute("stroke-dashoffset",""+e))}}r.FieldProtractor=n},{"../plugins/math":119}],50:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldScopedValueSelector=void 0;let n=e("blockly"),i=e("./field_utils");class s extends n.FieldLabel{constructor(e,t){super(e),this.isFieldCustom_=!0,this.types=[],this.dragging=!1,this.onDragEvent=t=>{if(t.blocks.find(e=>e.id===this.sourceBlock_.id))if(this.dragging=t.isStart,t.isStart)this.forceRerender();else{var r=[];{let e=null==(t=this.sourceBlock_.getParent())?void 0:t.getParent();for(;e;)r.push(e),e=e.getParent()}let n=pxt.getBundledApiInfo();var e;this.scopedValue=null;for(e of r)if("variables_set"===e.type){var i=e.inputList.find(e=>"VALUE"===e.name);if(i){i=i.fieldRow;if(i){i=i.find(e=>"VAR"===e.name);if(i){i=i.getVariable();if(i)return this.setValue(i.getName())}}}}else{i=(e=>{var t,r=e.codeCard;if(!r||!r.name)return null;for(t of Object.values(n))if(t.apis.byQName[r.name])return t.apis.byQName[r.name]})(e);if(i)for(var s of i.parameters)if(s.handlerParameters)for(var a of s.handlerParameters)if(this.types.includes(a.type))return this.setValue(a.name)}this.setValue(this.defl)}},this.onWorkspaceChange=e=>this.sourceBlock_&&this.sourceBlock_.workspace&&!this.sourceBlock_.disposed&&e.type===n.Events.BLOCK_DRAG?this.onDragEvent(e):void 0,this.defl=t.defl,t.types?this.types=t.types.split(","):t.type&&(this.types=[t.type]),this.types=this.types.map(e=>e.trim().replace(/['"]+/g,""))}init(){super.init(),this.sourceBlock_&&(this.scopedValue=(0,i.getBlockDataForField)(this.sourceBlock_,"scopedValue"),this.sourceBlock_.workspace.addChangeListener(this.onWorkspaceChange))}dispose(){this.sourceBlock_&&this.sourceBlock_.workspace.removeChangeListener(this.onWorkspaceChange),super.dispose()}getValue(){var e;return null!=(e=this.sourceBlock_)&&e.isInFlyout?lf("(dynamic)"):this.dragging?lf("what will it be?"):(this.sourceBlock_&&!this.scopedValue&&(this.scopedValue=(0,i.getBlockDataForField)(this.sourceBlock_,"scopedValue")),this.scopedValue||this.defl||lf("unknown"))}setValue(e,t){this.scopedValue=e||this.defl||lf("unknown"),this.sourceBlock_&&(0,i.setBlockDataForField)(this.sourceBlock_,"scopedValue",this.scopedValue||""),super.setValue(this.scopedValue,t),this.forceRerender()}getFieldDescription(){return this.scopedValue||this.defl||lf("value")}}r.FieldScopedValueSelector=s},{"./field_utils":69,blockly:175}],51:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldSoundEffect=void 0;let u=e("blockly");var i=pxt.svgUtil,n=e("./field_base");let d=e("./field_utils");class s extends n.FieldBase{constructor(){super(...arguments),this.registeredChangeListener=!1,this.onWorkspaceChange=e=>{e.type!==u.Events.CHANGE||!(e=this.sourceBlock_.workspace.getBlockById(e.blockId))||e!==this.sourceBlock_&&e.getParent()!==this.sourceBlock_||this.redrawPreview()}}onInit(){this.options||(this.options={}),this.options.durationInputName||(this.options.durationInputName="duration"),this.options.startFrequencyInputName||(this.options.startFrequencyInputName="startFrequency"),this.options.endFrequencyInputName||(this.options.endFrequencyInputName="endFrequency"),this.options.startVolumeInputName||(this.options.startVolumeInputName="startVolume"),this.options.endVolumeInputName||(this.options.endVolumeInputName="endVolume"),this.options.waveFieldName||(this.options.waveFieldName="waveShape"),this.options.interpolationFieldName||(this.options.interpolationFieldName="interpolation"),this.options.effectFieldName||(this.options.effectFieldName="effect"),this.options.useMixerSynthesizer||(this.options.useMixerSynthesizer=!1),this.redrawPreview(),this.sourceBlock_.workspace&&(this.workspace=this.sourceBlock_.workspace,this.sourceBlock_.isShadow()||this.sourceBlock_.isInsertionMarker()||(this.registeredChangeListener=!0,this.workspace.addChangeListener(this.onWorkspaceChange)))}onDispose(){this.workspace&&this.registeredChangeListener&&(this.workspace.removeChangeListener(this.onWorkspaceChange),this.registeredChangeListener=!1)}onValueChanged(e){return e}redrawPreview(){if(this.fieldGroup_){if(this.drawnSound){var e=this.readCurrentSound();if(e.startFrequency===this.drawnSound.startFrequency&&e.endFrequency===this.drawnSound.endFrequency&&e.startVolume===this.drawnSound.startVolume&&e.endVolume===this.drawnSound.endVolume&&e.wave===this.drawnSound.wave&&e.interpolation===this.drawnSound.interpolation)return}pxsim.U.clear(this.fieldGroup_);var e=(new i.Rect).at(5,4).size(160,40).setClass("blocklyFieldRect blocklySpriteField").stroke("#fff",1).fill("#dedede").corner(20),t="preview-clip-"+pxt.U.guidGen(),r=(new i.ClipPath).id(t).clipPathUnits(!1),n=(new i.Rect).size(115,40).fill("#FFF").at(0,0),n=(r.appendChild(n),this.drawnSound=this.readCurrentSound(),(new i.Path).stroke("grey",2).fill("none").setD(pxt.assets.renderSoundPath(this.drawnSound,120,32)).clipPath("url('#"+t+"')")),t=(new i.Group).translate(35,7),r=(t.appendChild(r),t.appendChild(n),new i.Text("").appendClass("melody-editor-field-icon").setAttribute("alignment-baseline","middle").anchor("middle").at(20,24));this.fieldGroup_.appendChild(e.el),this.fieldGroup_.appendChild(r.el),this.fieldGroup_.appendChild(t.el)}}showEditor_(e){e=!e;let t=this.readCurrentSound();u.Events.disable();let r,n={getScaledBBox:()=>r},i=(u.WidgetDiv.show(n,this.sourceBlock_.RTL,()=>{document.activeElement&&"INPUT"===document.activeElement.tagName&&document.activeElement.blur(),a.hide(),i.classList.remove("sound-effect-editor-widget"),i.style.transform="",i.style.position="",i.style.left="",i.style.top="",i.style.width="",i.style.height="",i.style.opacity="",i.style.transition="",i.style.alignItems="",u.Events.enable(),u.Events.setGroup(!0),this.fireNumberInputUpdate(this.options.durationInputName,t.duration),this.fireNumberInputUpdate(this.options.startFrequencyInputName,t.startFrequency),this.fireNumberInputUpdate(this.options.endFrequencyInputName,t.endFrequency),this.fireNumberInputUpdate(this.options.startVolumeInputName,t.startVolume),this.fireNumberInputUpdate(this.options.endVolumeInputName,t.endVolume),this.fireFieldDropdownUpdate(this.options.waveFieldName,p[t.wave]),this.fireFieldDropdownUpdate(this.options.interpolationFieldName,m[t.interpolation]),this.fireFieldDropdownUpdate(this.options.effectFieldName,h[t.effect]),u.Events.setGroup(!1),this.mostRecentValue&&this.setBlockData(JSON.stringify(this.mostRecentValue))}),u.WidgetDiv.getDiv());var s={onClose:()=>{u.WidgetDiv.hideIfOwner(n),a.hide()},onSoundChange:e=>{this.mostRecentValue=e,this.updateSiblingBlocks(e),this.redrawPreview()},initialSound:t,useMixerSynthesizer:(e=>{if(!e)return!1;if("string"==typeof e)switch(e.toLowerCase().trim()){case"1":case"yes":case"y":case"on":case"true":return!0;default:return!1}return!!e})(this.options.useMixerSynthesizer)};let a=pxt.react.getFieldEditorView("soundeffect-editor",t,s,i,e);var s=this.sourceBlock_,e=s.getBoundingRectangle(),o=(0,d.workspaceToScreenCoordinates)(s.workspace,new u.utils.Coordinate(e.right,e.top));var l=o.x+20,o=o.y-20,l=(i.style.opacity="0",i.classList.add("sound-effect-editor-widget"),i.style.position="absolute",i.style.left=l+"px",i.style.top=o+"px",i.style.width="30rem",i.style.height="40rem",i.style.display="flex",i.style.alignItems="center",i.style.transition="transform 0.25s ease 0s, opacity 0.25s ease 0s",i.style.borderRadius="",a.onHide(()=>{}),a.show(),i.getBoundingClientRect()),o=s.workspace.getInjectionDiv().getBoundingClientRect(),c=(l.height>o.height?(i.style.height="",i.style.top="calc(1rem - 20px)",i.style.bottom="calc(1rem + 20px)"):(l.bottom>o.bottom||l.top<o.top)&&(i.style.top=o.top+o.height/2-l.height/2-20+"px"),s.workspace.getToolbox().getWidth()),s=(l.width>o.width-c?(i.style.width="",i.style.left="1rem",i.style.right="1rem"):l.left+l.width>=o.right&&(s=(0,d.workspaceToScreenCoordinates)(s.workspace,new u.utils.Coordinate(e.left,e.top)),e=o.left+c,s.x-l.width-20>e?i.style.left=s.x-l.width-20+"px":i.style.left=e+(o.width-c)/2-l.width/2+"px"),i.getBoundingClientRect());r=new u.utils.Rect(s.top,s.bottom,s.left,s.right),requestAnimationFrame(()=>{i.style.opacity="1",i.style.transform="translateY(20px)"})}render_(){super.render_(),this.size_.height=48,this.size_.width=165}getFieldDescription(){return lf("sound effect")}updateSiblingBlocks(e){this.setNumberInputValue(this.options.durationInputName,e.duration),this.setNumberInputValue(this.options.startFrequencyInputName,e.startFrequency),this.setNumberInputValue(this.options.endFrequencyInputName,e.endFrequency),this.setNumberInputValue(this.options.startVolumeInputName,e.startVolume),this.setNumberInputValue(this.options.endVolumeInputName,e.endVolume),this.setFieldDropdownValue(this.options.waveFieldName,p[e.wave]),this.setFieldDropdownValue(this.options.interpolationFieldName,m[e.interpolation]),this.setFieldDropdownValue(this.options.effectFieldName,h[e.effect])}setNumberInputValue(e,t){e=this.getSiblingBlock(e)||this.getSiblingBlock(e,!0);e&&("math_number"===e.type||"math_integer"===e.type||"math_whole_number"===e.type?e.setFieldValue(Math.round(t),"NUM"):"math_number_minmax"===e.type&&e.setFieldValue(Math.round(t),"SLIDER"))}getNumberInputValue(e,t){e=this.getSiblingBlock(e)||this.getSiblingBlock(e,!0);return e?"math_number"===e.type||"math_integer"===e.type||"math_whole_number"===e.type?parseInt(e.getFieldValue("NUM")+""):"math_number_minmax"===e.type?parseInt(e.getFieldValue("SLIDER")+""):t:t}fireNumberInputUpdate(t,r){var n=this.getSiblingBlock(t)||this.getSiblingBlock(t,!0);if(n){let e;"math_number"===n.type||"math_integer"===n.type||"math_whole_number"===n.type?e="NUM":"math_number_minmax"===n.type&&(e="SLIDER"),e&&u.Events.fire(new u.Events.BlockChange(n,"field",e,r,this.getNumberInputValue(t,r)))}}setFieldDropdownValue(e,t){e=this.getSiblingField(e)||this.getSiblingField(e,!0);e&&e.setValue(t)}getFieldDropdownValue(e){e=this.getSiblingField(e)||this.getSiblingField(e,!0);if(e)return e.getValue()}fireFieldDropdownUpdate(e,t){var r=this.getSiblingField(e)||this.getSiblingField(e,!0);r&&u.Events.fire(new u.Events.BlockChange(r.getSourceBlock(),"field",r.name,t,this.getFieldDropdownValue(e)))}readCurrentSound(){var e=this.readBlockDataSound();return{duration:this.getNumberInputValue(this.options.durationInputName,e.duration),startFrequency:this.getNumberInputValue(this.options.startFrequencyInputName,e.startFrequency),endFrequency:this.getNumberInputValue(this.options.endFrequencyInputName,e.endFrequency),startVolume:this.getNumberInputValue(this.options.startVolumeInputName,e.startVolume),endVolume:this.getNumberInputValue(this.options.endVolumeInputName,e.endVolume),wave:a(p,this.getFieldDropdownValue(this.options.waveFieldName))||e.wave,interpolation:a(m,this.getFieldDropdownValue(this.options.interpolationFieldName))||e.interpolation,effect:a(h,this.getFieldDropdownValue(this.options.effectFieldName))||e.effect}}readBlockDataSound(){var e=this.getBlockData();let t;try{t=JSON.parse(e)}catch(e){t={duration:1e3,startFrequency:100,endFrequency:4800,startVolume:100,endVolume:0,wave:"sine",interpolation:"linear",effect:"none"}}return t}}r.FieldSoundEffect=s;let p={sine:"WaveShape.Sine",square:"WaveShape.Square",sawtooth:"WaveShape.Sawtooth",triangle:"WaveShape.Triangle",noise:"WaveShape.Noise"},h={none:"SoundExpressionEffect.None",vibrato:"SoundExpressionEffect.Vibrato",tremolo:"SoundExpressionEffect.Tremolo",warble:"SoundExpressionEffect.Warble"},m={linear:"InterpolationCurve.Linear",curve:"InterpolationCurve.Curve",logarithmic:"InterpolationCurve.Logarithmic"};function a(t,r){return Object.keys(t).find(e=>t[e]===r)}},{"./field_base":31,"./field_utils":69,blockly:175}],52:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldSpeed=void 0;e=e("../plugins/math");class n extends e.FieldSlider{constructor(e,t,r){super(String(e),"-100","100","1","10","Speed",r),this.isFieldCustom_=!0,this.params=t,this.params.min&&(this.min_=parseFloat(this.params.min)),this.params.max&&(this.max_=parseFloat(this.params.max)),this.params.label&&(this.labelText_=this.params.label),this.params.format||(this.params.format="{0}%")}createLabelDom_(e){var t=document.createElement("div"),r=(this.speedSVG=document.createElementNS("http://www.w3.org/2000/svg","svg"),pxsim.svg.hydrate(this.speedSVG,{viewBox:"0 0 200 100",width:"170"}),t.appendChild(this.speedSVG),pxsim.svg.child(this.speedSVG,"circle",{"stroke-dasharray":"565.48","stroke-dashoffset":"0",cx:100,cy:100,r:"90",style:"fill:transparent; transition: stroke-dashoffset 0.1s linear;",stroke:"#a8aaa8","stroke-width":"1rem"}),this.circleBar=pxsim.svg.child(this.speedSVG,"circle",{"stroke-dasharray":"565.48","stroke-dashoffset":"0",cx:100,cy:100,r:"90",style:"fill:transparent; transition: stroke-dashoffset 0.1s linear;",stroke:"#f12a21","stroke-width":"1rem"}),this.reporter=pxsim.svg.child(this.speedSVG,"text",{x:100,y:80,"text-anchor":"middle","dominant-baseline":"middle",style:`font-size: ${Math.max(14,50-5*(this.params.format.length-4))}px`,class:"sim-text inverted number"}),document.createElement("span"));return r.setAttribute("class","blocklyFieldSliderReadout"),[t,r]}setReadout(e){this.updateSpeed("string"==typeof e?parseFloat(e):e),this.params&&this.reporter&&(this.reporter.textContent=ts.pxtc.U.rlf(this.params.format,e))}updateSpeed(e){var t;this.circleBar&&(t=this.sign(e),e=Math.abs(e)/100*50+50,-1==t&&(e=50-e),t=180*Math.PI,this.circleBar.setAttribute("stroke-dashoffset",""+(100-e)/100*t))}sign(e){return e?e<0?-1:1:0}}r.FieldSpeed=n},{"../plugins/math":119}],53:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldSpriteEditor=void 0;e=e("./field_asset");class n extends e.FieldAssetEditor{getAssetType(){return"image"}createNewAsset(e){var t=pxt.react.getTilemapProject();if(e){var r=pxt.lookupProjectAssetByTSReference(e,t);if(r)return r}if(this.getBlockData())return t.lookupAsset("image",this.getBlockData());r=e?pxt.sprite.imageLiteralToBitmap(e,this.params.taggedTemplate):new pxt.sprite.Bitmap(this.params.initWidth,this.params.initHeight);let n;if(!r){if(!(n=i(e)))return this.isGreyBlock=!0,void(this.valueText=e);this.qName=e}return n=n||r.data(),{internalID:-1,id:this.temporaryAssetId(),type:"image",jresData:pxt.sprite.base64EncodeBitmap(n),meta:{},bitmap:n}}getValueText(){if(!this.asset)return this.valueText||"";if(this.asset&&!this.isTemporaryAsset())return pxt.getTSReferenceForAsset(this.asset);if(this.qName){var e=i(this.qName);if(e&&pxt.sprite.bitmapEquals(e,this.asset.bitmap))return this.qName}return pxt.sprite.bitmapToImageLiteral(this.asset&&pxt.sprite.Bitmap.fromData(this.asset.bitmap),"typescript",this.params.taggedTemplate)}parseFieldOptions(e){var t={initColor:1,initWidth:16,initHeight:16,disableResize:!1,lightMode:!1};if(e){if(t.lightMode=e.lightMode,e.sizes){var r=e.sizes.split(";"),n=[];for(let e=0;e<r.length;e++){var i=r[e].split(",");if(2===i.length){let e=parseInt(i[0]),t=parseInt(i[1]);isNaN(e)||isNaN(t)||(i=pxt.appTarget.runtime&&pxt.appTarget.runtime.screenSize,e<0&&i&&(e=i.width),t<0&&i&&(t=i.height),n.push([e,t]))}}0<n.length&&(t.initWidth=n[0][0],t.initHeight=n[0][1])}e.filter&&(t.filter=e.filter),e.disableResize&&(t.disableResize="true"===e.disableResize.toLowerCase()||"1"===e.disableResize),t.initColor=s(e.initColor,t.initColor),t.initWidth=s(e.initWidth,t.initWidth),t.initHeight=s(e.initHeight,t.initHeight),t.taggedTemplate=e.taggedTemplate}return t;function s(e,t){e=parseInt(e);return isNaN(e)?t:e}}}function i(t){var e=pxt.react.getTilemapProject().getGalleryAssets("image").filter(e=>e.id===t),e=e.length&&e[0];if(e)return e.bitmap}r.FieldSpriteEditor=n},{"./field_asset":29}],54:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldStyledLabel=void 0;e=e("blockly");class n extends e.FieldLabel{constructor(e,t,r){super(e,(e=>{if(e){if(e.bold&&e.italics)return"blocklyBoldItalicizedText";if(e.bold)return"blocklyBoldText";if(e.italics)return"blocklyItalicizedText"}})(t)),this.isFieldCustom_=!0}getFieldDescription(){return this.getText()}}r.FieldStyledLabel=n},{blockly:175}],55:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldTextDropdown=r.BaseFieldTextDropdown=void 0;let o=e("blockly"),l=e("./field_utils");class n extends o.FieldTextInput{constructor(e,t,r){super(e,r),this.menuGenerator_=t,this.selectedMenuItem=null,this.menu_=null,this.svgArrow=null,this.generatedOptions=null,this.menuItems=[],this.lastHighlightedMenuElement=null}initView(){super.initView(),this.createSVGArrow()}inputKeydownListener(e){"ArrowDown"===e.key&&(e.preventDefault(),this.menu_.focus(),this.selectedMenuItem?this.menu_.setHighlighted(this.selectedMenuItem):this.menu_.setHighlighted(this.menuItems[0]))}dropdownKeydownListener(e){var t=this.menu_.getElement().querySelector(".blocklyMenuItemHighlight");"ArrowUp"!==e.key||t!==this.lastHighlightedMenuElement&&this.lastHighlightedMenuElement||(e.preventDefault(),this.selectedMenuItem=null,this.menu_.setHighlighted(null),this.htmlInput_.focus()),this.lastHighlightedMenuElement=t}showEditor_(e,t){super.showEditor_(e,!0),this.dropDownOpen_||this.showDropdown_(),o.Touch.clearTouchIdentifier(),this.inputKeydownHandler=this.inputKeydownListener.bind(this),this.htmlInput_.addEventListener("keydown",this.inputKeydownHandler),t||this.htmlInput_.focus()}doValueUpdate_(e){1<(null==e?void 0:e.length)&&e.charAt(0)===e.charAt(e.length-1)&&("'"===e.charAt(0)||'"'===e.charAt(0))&&(e=e.slice(1,e.length-1)),super.doValueUpdate_(e)}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");if(Array.isArray(this.menuGenerator_))return this.menuGenerator_;if(!e||!this.generatedOptions){var r=this.generatedOptions;if(!Array.isArray(r))throw TypeError("FieldDropdown options must be an array.");if(!r.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=!1;for(let e=0;e<r.length;e++){var n=r[e];Array.isArray(n)?"string"!=typeof n[1]?(t=!0,pxt.error("Invalid option["+e+"]: Each FieldDropdown option id must be a string. Found "+n[1]+" in: ",n)):n[0]&&"string"!=typeof n[0]&&!(0,l.isImageProperties)(n[0])&&(t=!0,pxt.error("Invalid option["+e+"]: Each FieldDropdown option must have a string label or image description. Found"+n[0]+" in: ",n)):(t=!0,pxt.error("Invalid option["+e+"]: Each FieldDropdown option must be an array. Found: ",n))}if(t)throw TypeError("Found invalid FieldDropdown options.")}return this.generatedOptions}isOptionListDynamic(){return"function"==typeof this.menuGenerator_}getFieldDescription(){return this.getText()}dropdownDispose_(){o.WidgetDiv.getDiv().removeEventListener("keydown",this.inputKeydownHandler),this.menu_.getElement().removeEventListener("keydown",this.dropdownKeydownHandler),this.dropDownOpen_=!1,this.menu_&&this.menu_.dispose(),this.menu_=null,this.selectedMenuItem=null,this.menuItems=[],this.applyColour()}dropdownCreate(){var n=this.getSourceBlock();if(!n)throw new o.UnattachedFieldError;var i=new o.Menu,s=(i.setRole(o.utils.aria.Role.LISTBOX),this.menu_=i,this.getOptions(!1));this.selectedMenuItem=null;for(let r=0;r<s.length;r++){let[e,t]=s[r];var a=(a=void 0,l.isImageProperties)(e)?((a=new Image(e.width,e.height)).src=e.src,a.alt=e.alt,a):e,a=new o.MenuItem(a,t);a.setRole(o.utils.aria.Role.OPTION),a.setRightToLeft(n.RTL),a.setCheckable(!0),i.addChild(a),a.setChecked(t===this.value_),t===this.value_&&(this.selectedMenuItem=a),a.onAction(this.handleMenuActionEvent,this),this.menuItems.push(a)}}showDropdown_(e){var t=this.getSourceBlock();if(!t)throw new o.UnattachedFieldError;this.dropdownCreate(),e&&"number"==typeof e.clientX?this.menu_.openingCoords=new o.utils.Coordinate(e.clientX,e.clientY):this.menu_.openingCoords=null,(0,l.clearDropDownDiv)();var e=this.menu_.render(o.DropDownDiv.getContentDiv()),e=(o.utils.dom.addClass(e,"blocklyDropdownMenu"),t.getParent()),r=(e||t).getColour(),e=(e||t).style.colourTertiary;o.DropDownDiv.setColour(r,e),this.dropDownOpen_=!0,o.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this),void 0,!1),this.dropdownKeydownHandler=this.dropdownKeydownListener.bind(this),this.menu_.getElement().addEventListener("keydown",this.dropdownKeydownHandler),this.selectedMenuItem&&(this.menu_.setHighlighted(this.selectedMenuItem),o.utils.style.scrollIntoContainerView(this.selectedMenuItem.getElement(),o.DropDownDiv.getContentDiv(),!0)),this.applyColour()}updateSize_(e){super.updateSize_(e);var t,e=this.positionSVGArrow(this.size_.width,this.size_.height/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2);this.sourceBlock_.RTL&&this.textElement_&&(t=this.getConstants(),t=o.utils.dom.getFastTextWidth(this.textElement_,t.FIELD_TEXT_FONTSIZE,t.FIELD_TEXT_FONTWEIGHT,t.FIELD_TEXT_FONTFAMILY),this.positionTextElement_(-e,t)),this.size_.width+=e}positionSVGArrow(e,t){if(!this.svgArrow)return 0;var r,n,i,s=this.getSourceBlock();if(s)return r=!!this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,n=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,i=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE,s=s.RTL?r/2:e+n,this.svgArrow.setAttribute("transform","translate("+s+","+t+")"),i+n;throw new o.UnattachedFieldError}createSVGArrow(){this.svgArrow=o.utils.dom.createSvgElement("image",{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(o.utils.dom.XLINK_NS,"xlink:href",i.DROPDOWN_SVG_DATAURI)}handleMenuActionEvent(e){o.DropDownDiv.hideIfOwner(this,!0),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue()),o.WidgetDiv.hideIfOwner(this)}}(r.BaseFieldTextDropdown=n).DROPDOWN_SVG_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiM1NzVFNzUiLz48L3N2Zz4K";class i extends n{constructor(e,t,r){super(e,(e=>{if(e.values)return e.values.split(",").map(e=>[e,e]);if(e.data){let t;try{var r=JSON.parse(e.data);if(Array.isArray(r)&&r.length)if(s(r))t=r.map(e=>[e,e]);else{let e=!1;for(var n of r)if(!Array.isArray(n)||2!==n.length||!s(n)){e=!0;break}e||(t=r)}}catch(e){}if(t)return t;pxt.warn("Could not parse textdropdown data field")}return[]})(t),r),this.isFieldCustom_=!0}}function s(e){for(var t of e)if("string"!=typeof t)return;return 1}r.FieldTextDropdown=i},{"./field_utils":69,blockly:175}],56:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldTextInput=void 0;e=e("blockly");class n extends e.FieldTextInput{constructor(e,t,r){super(e,r),this.isFieldCustom_=!0}getFieldDescription(){return this.getValue()}}r.FieldTextInput=n},{blockly:175}],57:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldTilemap=void 0;e=e("./field_asset");class n extends e.FieldAssetEditor{getInitText(){return this.initText}getTileset(){var e;return null==(e=this.asset)?void 0:e.data.tileset}getAssetType(){return"tilemap"}createNewAsset(t=""){t=t&&t.replace(/&#96;/g,"`");var r=pxt.react.getTilemapProject(),n=pxt.lookupProjectAssetByTSReference(t,r);if(n)return n;if(null==(n=this.sourceBlock_)||!n.isInFlyout){var i,n=pxt.sprite.decodeTilemap(t,"typescript",r)||r.blankTilemap(this.params.tileWidth,this.params.initWidth,this.params.initHeight);let e;return(i=n)&&i.tilemap&&i.tilemap.width&&i.tilemap.height&&!(!i.layers||i.layers.width!==i.tilemap.width||i.layers.height!==i.tilemap.height||!i.tileset)?(this.initText=t,this.isGreyBlock=!1,[i]=r.createNewTilemapFromData(n),e=r.getTilemap(i)):t.trim()&&(this.isGreyBlock=!0,this.valueText=t),e}}onEditorClose(e){pxt.sprite.updateTilemapReferencesFromResult(pxt.react.getTilemapProject(),e)}getValueText(){return this.isGreyBlock?pxt.Util.htmlUnescape(this.valueText):this.asset?pxt.getTSReferenceForAsset(this.asset):this.initText?this.getInitText():this.valueText||""}parseFieldOptions(e){var t={initWidth:16,initHeight:16,disableResize:!1,tileWidth:16,lightMode:!1};if(e){if(t.lightMode=e.lightMode,e.filter&&(t.filter=e.filter),e.tileWidth)if("number"==typeof e.tileWidth)switch(e.tileWidth){case 4:t.tileWidth=4;break;case 8:t.tileWidth=8;break;case 16:t.tileWidth=16;break;case 32:t.tileWidth=32}else switch(e.tileWidth.trim().toLowerCase()){case"4":case"four":t.tileWidth=4;break;case"8":case"eight":t.tileWidth=8;break;case"16":case"sixteen":t.tileWidth=16;break;case"32":case"thirtytwo":t.tileWidth=32}t.initWidth=r(e.initWidth,t.initWidth),t.initHeight=r(e.initHeight,t.initHeight)}return t;function r(e,t){e=parseInt(e);return isNaN(e)?t:e}}}r.FieldTilemap=n},{"./field_asset":29}],58:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldTileset=void 0;var n=e("./field_images");let a=e("./field_utils");class o extends n.FieldImages{constructor(e,t,r){super(e,t,r),this.isFieldCustom_=!0,this.menuGenerator_=()=>{var e;return null!=(e=this.sourceBlock_)&&e.workspace&&(0,a.needsTilemapUpgrade)(null==(e=this.sourceBlock_)?void 0:e.workspace)?[i()]:o.getReferencedTiles(this.sourceBlock_.workspace)},this.assetChangeListener=()=>{this.doValueUpdate_(this.getValue()),this.forceRerender()},this.blocksInfo=t.blocksInfo}static getReferencedTiles(e){var t=pxt.react.getTilemapProject();if(t.revision()!==o.cachedRevision||e.id!=o.cachedWorkspaceId){o.cachedRevision=t.revision(),o.cachedWorkspaceId=e.id;var n,i=(0,a.getAllReferencedTiles)(e);for(n of[16,4,8,32]){var s=t.getProjectTiles(n,16===n);if(s)for(let t of s.tiles)i.find(e=>e.id===t.id)||i.push(t)}let r={};i.sort((e,t)=>e.id===t.id?0:e.bitmap.width!==t.bitmap.width?e.bitmap.width-t.bitmap.width:e.isProjectTile!==t.isProjectTile?e.isProjectTile?-1:1:(r[e.id]||(r[e.id]=c(e.id)))-(r[t.id]||(r[t.id]=c(t.id))));o.referencedTiles=i.map(e=>{return[{src:c((t=e).id)<=2?l(t.bitmap.width):(0,a.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(t.bitmap),32,!1),width:32,height:32,alt:u(e)},e.id,e];var t})}return o.referencedTiles}initView(){super.initView(),this.sourceBlock_&&this.sourceBlock_.isInFlyout&&this.setValue(this.getOptions()[0][1])}getValue(){var e=pxt.react.getTilemapProject();if(this.selectedOption_)return t=this.selectedOption_[2],(t=e.lookupAsset(t.type,t.id))?pxt.getTSReferenceForAsset(t):super.getValue();var t=super.getValue();if("string"==typeof t){if(-1!==t.indexOf(".")){e=e.lookupAsset("tile",t);if(e)return pxt.getTSReferenceForAsset(e)}if(-1===t.indexOf("`"))return`img\`${t}\``}return t}getText(){var e=this.getValue();return"string"==typeof e&&-1!==e.indexOf("`")?e:super.getText()}render_(){var e;this.value_&&this.selectedOption_&&this.selectedOption_[1]!==this.value_&&(e=pxt.react.getTilemapProject().resolveTile(this.value_),o.cachedRevision=-1,e)&&(this.selectedOption_=[{src:(0,a.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(e.bitmap),32,!1),width:32,height:32,alt:u(e)},this.value_,e]),super.render_()}doValueUpdate_(e){let t=!1;var r=this.getOptions(!0);if(e){var n,i=pxt.parseAssetTSReference(e);e=(e=i?i.name:e).trim();for(n of r)if(e===n[2].id||e===n[2].meta.displayName||e===pxt.getShortIDForAsset(n[2]))return this.selectedOption_=n,this.value_=this.getValue(),this.updateAssetListener(),super.doValueUpdate_(n[1]),void(t=!0);t||super.doValueUpdate_(e),this.selectedOption_=null,this.updateAssetListener()}}doClassValidation_(t){if(this.getOptions(!0).some(([,e])=>e===t))return t;if(t){var r=pxt.react.getTilemapProject(),n=/^\s*assets\s*\.\s*tile\s*`([^`]*)`\s*$/.exec(t);let e;if(e=n?r.lookupAssetByName("tile",n[1]):t.startsWith(pxt.sprite.TILE_NAMESPACE)?r.lookupAsset("tile",t.trim()):r.lookupAssetByName("tile",t.trim()))return this.localTile=e,pxt.getTSReferenceForAsset(e,!1)}return this.sourceBlock_&&pxt.warn(`Trying to set tile reference to nonexistent tile. Block type: ${this.sourceBlock_.type}, Field name: ${this.name}, Value: `+t),null}getOptions(e){var t;return"function"!=typeof this.menuGenerator_?(this.transparent=i(),t=[this.transparent],this.localTile&&t.push([{src:(0,a.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(this.localTile.bitmap),32,!1),width:32,height:32,alt:u(this.localTile)},this.localTile.id,this.localTile]),t):this.menuGenerator_.call(this)}dispose(){super.dispose(),pxt.react.getTilemapProject().removeChangeListener("tile",this.assetChangeListener)}updateAssetListener(){var e=pxt.react.getTilemapProject();e.removeChangeListener("tile",this.assetChangeListener),this.selectedOption_&&e.addChangeListener(this.selectedOption_[2],this.assetChangeListener)}saveState(e){let t,r=this.localTile||(null==(t=this.selectedOption_)?void 0:t[2]);var n,i,s=pxt.react.getTilemapProject();return r||(n=this.getValue(),i=pxt.parseAssetTSReference(n),r=(r=i?s.lookupAssetByName("tile",i.name):r)||s.lookupAsset("tile",n)),null!=r&&r.isProjectTile?(0,a.getAssetSaveState)(r):super.saveState(e)}loadState(e){"string"==typeof e?super.loadState(e):(e=(0,a.loadAssetFromSaveState)(e),this.localTile=e,super.loadState(pxt.getTSReferenceForAsset(e)))}getFieldDescription(){return lf("tile")}}function i(){var e=pxt.react.getTilemapProject().getTransparency(16);return[{src:l(16),width:32,height:32,alt:pxt.U.lf("transparency")},e.id,e]}function l(r){var e=document.createElement("canvas"),n=e.getContext("2d");e.width=r,e.height=r,n.fillStyle="#aeaeae",n.fillRect(0,0,r,r),n.fillStyle="#dedede";for(let t=0;t<r;t+=4)for(let e=0;e<r;e+=4)t+e>>2&1&&n.fillRect(t,e,4,4);return e.toDataURL()}function c(e){switch(e){case"myTiles.transparency16":return 1;case"myTiles.transparency4":case"myTiles.transparency8":case"myTiles.transparency32":return 2;default:if(e.startsWith("myTiles.tile")){var t=parseInt(e.slice(12));if(!Number.isNaN(t))return t+2}return 9999999999}}function u(e){return e.meta.displayName||pxt.getShortIDForAsset(e)}r.FieldTileset=o},{"./field_images":39,"./field_utils":69}],59:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldToggle=r.BaseFieldToggle=void 0;let n=e("blockly"),l=e("../constants");class i extends n.FieldNumber{constructor(e,t,r,n,i){super(e,void 0,void 0,void 0,i),this.trueText=r,this.falseText=n,this.isFieldCustom_=!0,this.CURSOR="pointer",this.params=t,this.setValue(e),this.type_=t.type}initView(){if(this.fieldGroup_){this.clickTarget_=this.sourceBlock_.getSvgRoot(),!this.sourceBlock_.isShadow()&&this.sourceBlock_.inputList&&1<this.sourceBlock_.inputList.length&&(this.borderRect_=n.utils.dom.createSvgElement("rect",{rx:this.getConstants().CORNER_RADIUS,ry:this.getConstants().CORNER_RADIUS,x:0,y:0,width:this.size_.width,height:this.size_.height,fill:this.sourceBlock_.getColour(),stroke:this.sourceBlock_.getColourTertiary()},null),this.fieldGroup_.insertBefore(this.borderRect_,this.textElement_));var e=this.getSize();switch(this.checkElement_=n.utils.dom.createSvgElement("g",{class:"blocklyToggle "+(this.state_?"blocklyToggleOn":"blocklyToggleOff"),transform:`translate(8, ${e.height/2})`},this.fieldGroup_),this.getOutputShape()){case l.provider.SHAPES.HEXAGONAL:this.toggleThumb_=n.utils.dom.createSvgElement("polygon",{class:"blocklyToggleRect",points:"-7,-14 -21,0 -7,14 7,14 21,0 7,-14",cursor:"pointer"},this.checkElement_);break;case l.provider.SHAPES.ROUND:this.toggleThumb_=n.utils.dom.createSvgElement("rect",{class:"blocklyToggleCircle",x:-6,y:-14,height:28,width:28,rx:14,ry:14,cursor:"pointer"},this.checkElement_);break;case l.provider.SHAPES.SQUARE:this.toggleThumb_=n.utils.dom.createSvgElement("rect",{class:"blocklyToggleRect",x:-6,y:-14,height:28,width:28,rx:3,ry:3,cursor:"pointer"},this.checkElement_)}var t=this.sourceBlock_.RTL?-e.width/2:e.width/2;this.textElement_=n.utils.dom.createSvgElement("text",{class:"blocklyText",x:t,dy:"0.6ex",y:e.height/2},this.fieldGroup_),this.updateEditable(),this.switchToggle(this.state_),this.setValue(this.getValue()),this.markDirty()}}getDisplayText_(){return this.state_?this.getTrueText():this.getFalseText()}getTrueText(){return this.trueText}getFalseText(){return this.falseText}getFieldDescription(){return this.getDisplayText_()}updateSize_(){switch(this.getOutputShape()){case l.provider.SHAPES.ROUND:this.size_.width=2*this.getInnerWidth()-7;break;case l.provider.SHAPES.HEXAGONAL:this.size_.width=2*this.getInnerWidth()+8-Math.floor(this.getInnerWidth()/2);break;case l.provider.SHAPES.SQUARE:this.size_.width=9+2*this.getInnerWidth()}}getInnerWidth(){return 10*this.getMaxLength()}getMaxLength(){return Math.max(this.getTrueText().length,this.getFalseText().length)}getOutputShape(){return this.sourceBlock_.isShadow()?this.sourceBlock_.getOutputShape():l.provider.SHAPES.SQUARE}doClassValidation_(e){return"boolean"==typeof this.fromVal(e)?e:"false"}applyColour(){var e=this.sourceBlock_.getColourTertiary();this.borderRect_?this.borderRect_.setAttribute("stroke",e):this.sourceBlock_.pathObject.svgPath.setAttribute("fill",e)}getValue(){return this.toVal(this.state_)}doValueUpdate_(e){e=this.fromVal(e);this.state_!==e&&(this.sourceBlock_&&n.Events.isEnabled()&&n.Events.fire(new n.Events.BlockChange(this.sourceBlock_,"field",this.name,this.state_,e)),this.state_=e,this.switchToggle(this.state_),this.isDirty_=!0)}switchToggle(i){if(this.checkElement_){this.updateSize_();var s=this.getSize(),a=this.getInnerWidth(),o=(i?(pxt.BrowserUtils.addClass(this.checkElement_,"blocklyToggleOn"),pxt.BrowserUtils.removeClass(this.checkElement_,"blocklyToggleOff")):(pxt.BrowserUtils.removeClass(this.checkElement_,"blocklyToggleOn"),pxt.BrowserUtils.addClass(this.checkElement_,"blocklyToggleOff")),this.getOutputShape());let e=0,t=0,r=0,n=0;switch(o){case l.provider.SHAPES.HEXAGONAL:e=s.width/2,t=e/2,r=-t,n=t-a,this.toggleThumb_.setAttribute("points",`0,-14 -14,0 0,14 ${e},14 ${e+14},0 ${e},-14`);break;case l.provider.SHAPES.ROUND:case l.provider.SHAPES.SQUARE:e=5+a,t=e/2,this.toggleThumb_.setAttribute("width",""+e),this.toggleThumb_.setAttribute("x","-"+t),r=n=o==l.provider.SHAPES.SQUARE?2:-6}this.checkElement_.setAttribute("transform",`translate(${i?n+a+t:t+r}, ${s.height/2})`)}}render_(){if(this.visible_&&this.textElement_){for(;this.textElement_.firstChild;)this.textElement_.firstChild.remove();var e=document.createTextNode(this.getDisplayText_()),e=(this.textElement_.appendChild(e),pxt.BrowserUtils.addClass(this.textElement_,"blocklyToggleText"),this.updateSize_(),this.size_.width),t=this.state_?e+e/8:e/2;this.textElement_.setAttribute("x",""+(t-e/2))}this.borderRect_&&(this.borderRect_.setAttribute("width",""+this.size_.width),this.borderRect_.setAttribute("height",""+this.size_.height))}showEditor_(){var e=!this.state_;null!==e&&this.setValue(this.toVal(e))}toVal(e){return"number"==this.type_?String(e?"1":"0"):String(e?"true":"false")}fromVal(e){return"string"==typeof e?"1"==e||"TRUE"==e.toUpperCase():!!e}}r.BaseFieldToggle=i;class s extends i{constructor(e,t,r){super(e,t,lf("True"),lf("False"),r)}}r.FieldToggle=s},{"../constants":18,blockly:175}],60:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldToggleDownUp=void 0;e=e("./field_toggle");class n extends e.BaseFieldToggle{constructor(e,t,r){super(e,t,lf("DOWN"),lf("UP"),r)}}r.FieldToggleDownUp=n},{"./field_toggle":59}],61:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldToggleHighLow=void 0;e=e("./field_toggle");class n extends e.BaseFieldToggle{constructor(e,t,r){super(e,t,lf("HIGH"),lf("LOW"),r)}}r.FieldToggleHighLow=n},{"./field_toggle":59}],62:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldToggleOnOff=void 0;e=e("./field_toggle");class n extends e.BaseFieldToggle{constructor(e,t,r){super(e,t,lf("ON"),lf("OFF"),r)}}r.FieldToggleOnOff=n},{"./field_toggle":59}],63:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldToggleUpDown=void 0;e=e("./field_toggle");class n extends e.BaseFieldToggle{constructor(e,t,r){super(e,t,lf("UP"),lf("DOWN"),r)}}r.FieldToggleUpDown=n},{"./field_toggle":59}],64:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldToggleWinLose=void 0;e=e("./field_toggle");class n extends e.BaseFieldToggle{constructor(e,t,r){super(e,t,lf("WIN"),lf("LOSE"),r)}}r.FieldToggleWinLose=n},{"./field_toggle":59}],65:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldToggleYesNo=void 0;e=e("./field_toggle");class n extends e.BaseFieldToggle{constructor(e,t,r){super(e,t,lf("Yes"),lf("No"),r)}}r.FieldToggleYesNo=n},{"./field_toggle":59}],66:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldTsExpression=void 0;e=e("blockly");class n extends e.FieldTextInput{constructor(){super(...arguments),this.isFieldCustom_=!0,this.pythonMode=!1}updateEditable(){var e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(pxt.BrowserUtils.addClass(e,"blocklyEditableText"),pxt.BrowserUtils.removeClass(e,"blocklyGreyExpressionBlockText")):(pxt.BrowserUtils.addClass(e,"blocklyGreyExpressionBlockText"),pxt.BrowserUtils.removeClass(e,"blocklyEditableText")))}setPythonEnabled(e){e!==this.pythonMode&&(this.pythonMode=e,this.forceRerender())}getText(){return this.pythonMode?pxt.Util.lf("<python code>"):this.getValue()}getFieldDescription(){return this.pythonMode?pxt.Util.lf("<python code>"):pxt.Util.lf("<typescript code>")}applyColour(){var e;this.sourceBlock_&&null!=(e=this.getConstants())&&e.FULL_BLOCK_FIELDS&&this.borderRect_&&(this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourPrimary),this.borderRect_.setAttribute("fill",this.sourceBlock_.style.colourPrimary))}}r.FieldTsExpression=n},{blockly:175}],67:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldTurnRatio=void 0;let i=e("blockly");e=e("../plugins/math");class u extends e.FieldSlider{constructor(e,t,r){super(String(e),"-200","200","1","10","TurnRatio",r),this.isFieldCustom_=!0,this.params=t,this.sliderColor_="#a8aaa8"}createLabelDom_(e){var t=document.createElement("div"),r=i.utils.dom.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",height:u.HALF+u.HANDLE_RADIUS+10+"px",width:2*u.HALF+"px"},t),n=i.utils.dom.createSvgElement("defs",{},r),n=i.utils.dom.createSvgElement("marker",{id:"head",orient:"auto",markerWidth:"2",markerHeight:"4",refX:"0.1",refY:"1.5"},n),n=(i.utils.dom.createSvgElement("path",{d:"M0,0 V3 L1.5,1.5 Z",fill:"#f12a21"},n),this.reporter_=pxsim.svg.child(r,"text",{x:u.HALF,y:96,"text-anchor":"middle","dominant-baseline":"middle",style:"font-size: 50px",class:"sim-text inverted number"}),this.path_=i.utils.dom.createSvgElement("path",{x1:u.HALF,y1:u.HALF,"marker-end":"url(#head)",style:"fill: none; stroke: #f12a21; stroke-width: 10"},r),this.updateGraph_(),document.createElement("span"));return n.setAttribute("class","blocklyFieldSliderReadout"),[t,n]}updateGraph_(){if(this.path_){var t=Math.min(Math.max(Number(this.getValue())||0,-200),200),r=t/100,n=Math.max(-1,Math.min(1,r)),i=Math.max(n)*Math.PI/2,s=u.RADIUS-6;let e=u.HALF;var a=u.HALF-22,r=(1<Math.abs(r)&&(e-=(r-(0<r?1:-1))*s/2),.2+.5*Math.abs(n)),n=s*r,o=s*Math.sin(Math.PI/2-i),l=s*Math.cos(Math.PI/2-i),c=o-s*r*Math.cos(2*i),s=l-s*r*Math.sin(2*i),r=`M ${e} ${a} C ${e} ${a-n} ${e+s} ${a-c} ${e+l} `+(a-o);this.path_.setAttribute("d",r),this.reporter_.textContent=""+t}}setReadout(e){this.updateGraph_()}}(r.FieldTurnRatio=u).HALF=80,u.HANDLE_RADIUS=30,u.RADIUS=u.HALF-u.HANDLE_RADIUS-1},{"../plugins/math":119,blockly:175}],68:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getNextValue=r.FieldUserEnum=void 0;let u=e("blockly"),n=e("../external");e=e("./field_dropdown");class i extends e.FieldDropdown{constructor(e){var t;super((t=e,function(){let r=[];return this.sourceBlock_&&this.sourceBlock_.workspace?this.sourceBlock_.workspace.getVariableMap().getVariablesOfType(t.name).forEach(e=>{var t=e.getName().replace(/^\d+/,"");r.push([t,e.getName()])}):t.initialMembers.forEach(e=>r.push([e,e])),r.push([lf("Add a new {0}...",t.memberName),"CREATE"]),r})),this.opts=e}init(){super.init(),this.initVariables()}onItemSelected_(e,t){"CREATE"===t.getValue()?function s(a,o,l,c){(0,n.prompt)(l,null,i=>{if(i){let t=!1;if(pxtc.isIdentifierStart(i.charCodeAt(0),2)){t=!0;for(let e=1;e<i.length;e++)pxtc.isIdentifierPart(i.charCodeAt(e),2)||(t=!1)}if(t){let n=d(a,o.name);for(let r=0;r<n.length;r++){let[e,t]=n[r];if(e===i)return void u.dialog.alert(lf("A {0} named '{1}' already exists.",o.memberName,i),()=>s(a,o,l,c))}c(p(a,o,i))}else u.dialog.alert(lf("Names must start with a letter and can only contain letters, numbers, '$', and '_'."),()=>s(a,o,l,c))}},{placeholder:o.promptHint})}(this.sourceBlock_.workspace,this.opts,lf("New {0}:",this.opts.memberName),e=>e&&this.setValue(e)):super.onItemSelected_(e,t)}doClassValidation_(t){var e;return null!=(e=this.opts)&&e.initialMembers&&!this.opts.initialMembers.find(e=>e==t)&&this.getOptions(),super.doClassValidation_(t)}initVariables(){if(this.sourceBlock_&&this.sourceBlock_.workspace){let e=this.sourceBlock_.workspace,r=d(e,this.opts.name);var t;this.opts.initialMembers.forEach(t=>{r.some(([e])=>e===t)||p(e,this.opts,t)}),"CREATE"===this.getValue()&&(t=((e,t,r)=>{var n=e.getVariableMap().getVariablesOfType(t);if(n&&n.length)for(let e=0;e<n.length;e++){var[i]=s(n[e]);if(i===r)return n[e].getName()}})(e,this.opts.name,this.opts.initialMembers[0]))&&this.setValue(t)}}}function s(e){var t=/^(\d+)([^0-9].*)$/.exec(e.getName());return t?[t[2],parseInt(t[1])]:[e.getName(),-1]}function d(e,t){e=e.getVariableMap().getVariablesOfType(t);return e&&e.length?e.map(s):[]}function a(e,t){var r=e.map(([,e])=>e);if(t.isBitMask){for(let e=0;e<r.length;e++){var n=1<<e;if(r.indexOf(n)<0)return n}return 1<<r.length}if(t.isHash)return 0;var i=t.firstValue||0;for(let e=0;e<r.length;e++)if(r.indexOf(i+e)<0)return i+e;return i+r.length}function p(e,t,r){r=a(d(e,t.name),t)+r;return u.Variables.getOrCreateVariablePackage(e,null,r,t.name),r}r.FieldUserEnum=i,r.getNextValue=a},{"../external":25,"./field_dropdown":34,blockly:175}],69:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isImageProperties=r.clearDropDownDiv=r.deleteBlockDataForField=r.getBlockDataForField=r.setBlockDataForField=r.setBlockData=r.getBlockData=r.workspaceToScreenCoordinates=r.setMelodyEditorOpen=r.FieldEditorOpenEvent=r.FIELD_EDITOR_OPEN_EVENT_TYPE=r.loadAssetFromSaveState=r.getAssetSaveState=r.getTemporaryAssets=r.getTilesReferencedByTilesets=r.getAllReferencedTiles=r.getAllFields=r.updateTilemapXml=r.needsTilemapUpgrade=r.getAllBlocksWithTilesets=r.getAllBlocksWithTilemaps=r.songToDataURI=r.tilemapToImageURI=r.bitmapToImageURI=r.parseColour=r.svg=void 0;let n=e("blockly"),i=e("./field_tilemap"),s=e("./field_animation"),a=e("./field_musiceditor"),o=e("./field_sprite"),l=e("./field_tileset"),c;function h(e){return u(e,e=>e instanceof i.FieldTilemap&&!e.isGreyBlock)}function m(e){return u(e,e=>e instanceof l.FieldTileset)}function u(e,i){let s=[];return e.getTopBlocks(!1).forEach(e=>function e(t){for(var r of t.inputList){for(var n of r.fieldRow)i(n)&&s.push({block:t,field:n.name,ref:n});r.connection&&r.connection.targetBlock()&&e(r.connection.targetBlock())}t.nextConnection&&t.nextConnection.targetBlock()&&e(t.nextConnection.targetBlock())}(e)),s}(e=c=r.svg||(r.svg={})).hasClass=function(e,t){return pxt.BrowserUtils.containsClass(e,t)},e.addClass=function(e,t){pxt.BrowserUtils.addClass(e,t)},e.removeClass=function(e,t){pxt.BrowserUtils.removeClass(e,t)},r.parseColour=function(e){var t=Number(e);return isNaN(t)?"string"==typeof e&&e.match(/^#[0-9a-fA-F]{6}$/)?e:"#000":n.utils.colour.hueToHex(t)},r.bitmapToImageURI=function(r,e,n){var i=pxt.appTarget.runtime.palette.slice(1),t=document.createElement("canvas"),s=(t.width=e,t.height=e,Math.min(e/r.width,e/r.height)),a=Math.max(Math.floor(e*(1-r.width/r.height)/2),0),o=Math.max(Math.floor(e*(1-r.height/r.width)/2),0);let l;n?((l=t.getContext("2d",{alpha:!1})).fillStyle="#dedede",l.fillRect(0,0,e,e)):l=t.getContext("2d");for(let t=0;t<r.width;t++)for(let e=0;e<r.height;e++){var c=r.get(t,e);c?(l.fillStyle=i[c-1],l.fillRect(a+t*s,o+e*s,s,s)):n&&(l.fillStyle="#dedede",l.fillRect(a+t*s,o+e*s,s,s))}return t.toDataURL()},r.tilemapToImageURI=function(r,e,n){var i=pxt.appTarget.runtime.palette.slice(),t=document.createElement("canvas"),s=(t.width=e,t.height=e,Math.min(e/r.tilemap.width,e/r.tilemap.height)),a=Math.max(Math.floor(e*(1-r.tilemap.width/r.tilemap.height)/2),0),o=Math.max(Math.floor(e*(1-r.tilemap.height/r.tilemap.width)/2),0);let l;n?((l=t.getContext("2d",{alpha:!1})).fillStyle="#dedede",l.fillRect(0,0,e,e)):l=t.getContext("2d");var c=[];for(let t=0;t<r.tilemap.width;t++)for(let e=0;e<r.tilemap.height;e++){var u,d=r.tilemap.get(t,e);d?(c[d]||(u=r.tileset.tiles[d],c[d]=u?pxt.sprite.computeAverageColor(pxt.sprite.Bitmap.fromData(u.bitmap),i):"#dedede"),l.fillStyle=c[d],l.fillRect(a+t*s,o+e*s,s,s)):n&&(l.fillStyle="#dedede",l.fillRect(a+t*s,o+e*s,s,s))}return t.toDataURL()},r.songToDataURI=function(e,t,r,n,i){var s=pxt.appTarget.runtime.palette.slice(),a=document.createElement("canvas");a.width=t,a.height=r;let o;n?((o=a.getContext("2d",{alpha:!1})).fillStyle="#dedede",o.fillRect(0,0,t,r)):o=a.getContext("2d");var l,c=[5,11,5,4,2,6,14,2,5,1],u=(i=i||e.measures,Math.max(Math.floor(t/(e.beatsPerMeasure*i*2)),1)),d=Math.floor(t/u),p=Math.max(Math.floor(r/12),1),h=Math.floor(r/p);for(l of e.tracks)for(var m of l.notes){var g,f=Math.floor(m.startTick/(e.ticksPerBeat/2));if(d<f)break;for(g of m.notes){var _=12-g.note%12;h<_||(o.fillStyle=s[c[l.id||e.tracks.indexOf(l)]],o.fillRect(f*u,_*p,u,p))}}return a.toDataURL()},r.getAllBlocksWithTilemaps=h,r.getAllBlocksWithTilesets=m,r.needsTilemapUpgrade=function(e){return!!e.getVariableMap().getVariablesOfType(pxt.sprite.BLOCKLY_TILESET_TYPE).map(e=>pxt.sprite.legacy.blocklyVariableToTile(e.getName())).length},r.updateTilemapXml=function(e,n){let t=!1,i={};for(var r of e.children)if("variables"===r.tagName.toLowerCase()){var s,a,o,l,c=[];for(s of r.children)s.getAttribute("type")===pxt.sprite.BLOCKLY_TILESET_TYPE&&(t=!0,o=s.textContent,(o=pxt.sprite.legacy.blocklyVariableToTile(o)).qualifiedName||(a="myTiles.tile"+o.projectId,o=n.createNewTile(o.data,a),i[a]=o),c.push(s));for(l of c)l.remove()}if(t)for(var u of e.getElementsByTagName("field")){var d=u.textContent,p=d.trim();if(i[p])u.textContent=pxt.getTSReferenceForAsset(i[p]);else if(p.startsWith("tiles.createTilemap(")){p=pxt.sprite.legacy.decodeTilemap(d,"typescript");let r=[];var d=new pxt.sprite.TilemapData(p.tilemap,{tileWidth:p.tileset.tileWidth,tiles:p.tileset.tiles.map((e,t)=>null!=e.projectId?i["myTiles.tile"+e.projectId]:(r[t]||(r[t]=n.resolveTile(e.qualifiedName)),r[t]))},p.layers),[p]=n.createNewTilemapFromData(d),d=n.lookupAsset("tilemap",p);u.textContent=pxt.getTSReferenceForAsset(d)}}},r.getAllFields=u,r.getAllReferencedTiles=function(e,t){let r,n={};var i,s,a,o=h(e),l=pxt.react.getTilemapProject();for(i of o)if(i.block.id!==t)for(var c of(null==(r=i.ref.getTileset())?void 0:r.tiles)||[])n[c.id]=l.lookupAsset("tile",c.id);for(s of l.getAssets("tilemap"))for(var u of s.data.tileset.tiles)n[u.id]=l.lookupAsset("tile",u.id);for(a of m(e)){var d=a.ref.getValue(),p=/^\s*assets\s*\.\s*tile\s*`([^`]*)`\s*$/.exec(d);p?(p=l.lookupAssetByName("tile",p[1]))&&!n[p.id]&&(n[p.id]=p):n[d]||(n[d]=l.resolveTile(d))}return Object.keys(n).map(e=>n[e]).filter(e=>!!e)},r.getTilesReferencedByTilesets=function(e){let t={};var r,n=pxt.react.getTilemapProject();for(r of m(e)){var i=r.ref.getValue(),s=/^\s*assets\s*\.\s*tile\s*`([^`]*)`\s*$/.exec(i);s?(s=n.lookupAssetByName("tile",s[1]))&&!t[s.id]&&(t[s.id]=s):t[i]||(t[i]=n.resolveTile(i))}return Object.keys(t).map(e=>t[e]).filter(e=>!!e)},r.getTemporaryAssets=function(e,t){switch(t){case"image":return u(e,e=>e instanceof o.FieldSpriteEditor&&e.isTemporaryAsset()).map(e=>e.ref.getAsset());case"animation":return u(e,e=>e instanceof s.FieldAnimationEditor&&e.isTemporaryAsset()).map(e=>e.ref.getAsset());case"song":return u(e,e=>e instanceof a.FieldMusicEditor&&e.isTemporaryAsset()).map(e=>e.ref.getAsset());default:return[]}},r.getAssetSaveState=function(e){var t={version:1,assetType:e.type,assetId:e.id,jres:{}},r=pxt.react.getTilemapProject();if("tilemap"===e.type){var n,i=r.getProjectTilesetJRes();for(n of Object.keys(i))if("*"!==n){var s=i[n];if(s.mimeType===pxt.TILEMAP_MIME_TYPE)s.id!==e.id&&delete i[n];else{let t=f(i["*"].namespace)+n;e.data.tileset.tiles.some(e=>e.id===t)||delete i[n]}}t.jres=i}else{var r="tile"===e.type?r.getProjectTilesetJRes():r.getProjectAssetsJRes(),[r,a]=(t.jres["*"]=r["*"],_(r,e.id));t.jres[r]=a}return t},r.loadAssetFromSaveState=function(e){let t=e.assetId;e.jres=(e=>{var t,r,n=e["*"],i={"*":n};for(t of Object.keys(e))"*"!==t&&(r=e[t],i[t]="string"==typeof r?{id:void 0,data:r,mimeType:n.mimeType}:r);return i})(e.jres);var r=pxt.react.getTilemapProject();if(s=r.lookupAsset(e.assetType,e.assetId)){var n=new pxt.TilemapProject,n=(n.loadGallerySnapshot(r.saveGallerySnapshot()),"tilemap"===e.assetType||"tile"===e.assetType?n.loadTilemapJRes(e.jres):n.loadAssetsJRes(e.jres),n.lookupAsset(e.assetType,e.assetId));if(pxt.assetEquals(n,s,!0))return s;s=r.lookupAssetByValue(n.type,n);if(s)return s;t=r.generateNewID(e.assetType);var i,[n,s]=_(e.jres,e.assetId);delete e.jres[n],"tilemap"===e.assetType?(s.id=t,e.jres[t]=s):([n,i]=t.split("."),f(n)!==f(e.jres["*"].namespace)&&(s.namespace=f(n)),s.id=t,e.jres[i]=s)}return"tilemap"===e.assetType||"tile"===e.assetType?r.loadTilemapJRes(e.jres,!0):r.loadAssetsJRes(e.jres),r.lookupAsset(e.assetType,t)},r.FIELD_EDITOR_OPEN_EVENT_TYPE="field_editor_open";class d extends n.Events.UiBase{constructor(e,t){super(e.workspace.id),this.type=r.FIELD_EDITOR_OPEN_EVENT_TYPE,this.blockId=e.id,this.isOpen=t}}function p(e){return e.data?/^(?:\d+;?)+$/.test(e.data)?{commentRefs:e.data.split(";"),fieldData:{}}:JSON.parse(e.data):{commentRefs:[],fieldData:{}}}function g(e,t){e.data=JSON.stringify(t)}function f(e){return e.endsWith(".")?e:e+"."}function _(t,r){var n,i=t["*"].namespace;for(n of Object.keys(t))if("*"!==n){var s=t[n];let e;if((e=s.id?s.namespace?f(s.namespace)+s.id:s.id:s.namespace?f(s.namespace)+n:f(i)+n)===r)return[n,t[n]]}}r.FieldEditorOpenEvent=d,r.setMelodyEditorOpen=function(e,t){n.Events.fire(new d(e,t))},r.workspaceToScreenCoordinates=function(e,t){var t=t.scale(e.scale),r=e.getOriginOffsetInPixels(),t=n.utils.Coordinate.sum(t,r),r=e.getInjectionDiv().getBoundingClientRect();return new n.utils.Coordinate(t.x+r.left,t.y+r.top)},r.getBlockData=p,r.setBlockData=g,r.setBlockDataForField=function(e,t,r){var n=p(e);n.fieldData[t]=r,g(e,n)},r.getBlockDataForField=function(e,t){return p(e).fieldData[t]},r.deleteBlockDataForField=function(e,t){var r=p(e);delete r.fieldData[t],g(e,r)},r.clearDropDownDiv=function(){n.DropDownDiv.clearContent(),n.DropDownDiv.getContentDiv().style.height=""},r.isImageProperties=function(e){return e&&"object"==typeof e&&"src"in e&&"string"==typeof e.src&&"alt"in e&&"string"==typeof e.alt&&"width"in e&&"number"==typeof e.width&&"height"in e&&"number"==typeof e.height}},{"./field_animation":27,"./field_musiceditor":44,"./field_sprite":53,"./field_tilemap":57,"./field_tileset":58,blockly:175}],70:[function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./field_utils"),r),i(e("./fieldEditorRegistry"),r),i(e("./field_animation"),r),i(e("./field_argumentvariable"),r),i(e("./field_kind"),r),i(e("./field_asset"),r),i(e("./field_ledmatrix"),r),i(e("./field_styledlabel"),r),i(e("./field_base"),r),i(e("./field_tsexpression"),r),i(e("./field_textinput"),r),i(e("./field_tilemap"),r),i(e("./field_userenum"),r),i(e("./field_procedure"),r),i(e("./field_sprite"),r),i(e("./field_imagedropdown"),r),i(e("./field_protractor"),r),i(e("./field_toggle_highlow"),r),i(e("./field_images"),r),i(e("./field_sound_effect"),r),i(e("./field_toggle_onoff"),r),i(e("./field_speed"),r),i(e("./field_toggle_updown"),r),i(e("./field_toggle_winlose"),r),i(e("./field_autocomplete"),r),i(e("./field_melodySandbox"),r),i(e("./field_toggle_yesno"),r),i(e("./field_musiceditor"),r),i(e("./field_textdropdown"),r),i(e("./field_note"),r),i(e("./field_turnratio"),r),i(e("./field_colorwheel"),r),i(e("./field_numberdropdown"),r),i(e("./field_colour"),r),i(e("./field_position"),r),i(e("./field_tileset"),r),i(e("./field_gridpicker"),r),i(e("./field_toggle"),r)},{"./fieldEditorRegistry":26,"./field_animation":27,"./field_argumentvariable":28,"./field_asset":29,"./field_autocomplete":30,"./field_base":31,"./field_colorwheel":32,"./field_colour":33,"./field_gridpicker":36,"./field_imagedropdown":37,"./field_images":39,"./field_kind":40,"./field_ledmatrix":41,"./field_melodySandbox":43,"./field_musiceditor":44,"./field_note":45,"./field_numberdropdown":46,"./field_position":47,"./field_procedure":48,"./field_protractor":49,"./field_sound_effect":51,"./field_speed":52,"./field_sprite":53,"./field_styledlabel":54,"./field_textdropdown":55,"./field_textinput":56,"./field_tilemap":57,"./field_tileset":58,"./field_toggle":59,"./field_toggle_highlow":61,"./field_toggle_onoff":62,"./field_toggle_updown":63,"./field_toggle_winlose":64,"./field_toggle_yesno":65,"./field_tsexpression":66,"./field_turnratio":67,"./field_userenum":68,"./field_utils":69}],71:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getBlockText=void 0;let a=e("blockly");r.getBlockText=function e(t){var r,n,i=[];for(r of t.inputList)if(r.isVisible()){if(0<r.fieldRow.length)for(var s of r.fieldRow)s.isVisible()&&(s=s.getFieldDescription?s.getFieldDescription():s.getText())&&i.push(s);r.connection&&r.connection.targetBlock()&&r.connection.type===a.INPUT_VALUE&&(n=e(r.connection.targetBlock()))&&i.push(`[${n}]`)}return i.join(" ")}},{blockly:175}],72:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.attachCardInfo=r.mkCard=r.installHelpResources=r.setHelpResources=r.installBuiltinHelpInfo=r.setBuiltinHelpInfo=void 0;let c=e("blockly"),u=e("./xml"),d=e("./external"),n=e("./toolbox"),p=e("./plugins/duplicateOnDrag");function h(r,n,e,t,i,s,a,o,l){!t||"string"!=typeof t&&"function"!=typeof t||r.setTooltip(t),i&&r.setHelpUrl(i),s&&r.setColour(s),l&&r.setDeletable(!1),(0,p.setDuplicateOnDragStrategy)(r);s=document.getElementById("blocklyToolboxDefinition"),l=s?(0,u.getFirstChildWithAttr)(s,"block","type",n):void 0;r.codeCard={header:e,name:e,software:1,description:"function"==typeof t?t(r):t,blocksXml:l?'<xml xmlns="http://www.w3.org/1999/xhtml">'+((0,u.cleanOuterHTML)(l)||`<block type="${n}"></block>`)+"</xml>":void 0,url:i},pxt.Util.isTranslationMode()&&(r.customContextMenu=e=>{let t=pxt.blocks.getBlockDefinition(r.type);t&&t.translationIds&&e.push({enabled:!0,text:lf("Translate this block"),callback:function(){(0,d.promptTranslateBlock)(n,t.translationIds)}})})}function i(e,t,r,n,i,s,a){var o=c.Blocks[e];let l=o.init;l&&(o.init=function(){l.call(this),h(this,e,t,r,n,i)})}function s(e,t){return{name:e.namespace+"."+e.name,shortName:e.name,description:e.attributes.jsDoc,url:e.attributes.help?"reference/"+e.attributes.help.replace(/^\//,""):void 0,blocksXml:`<xml xmlns="http://www.w3.org/1999/xhtml">${(0,u.cleanOuterHTML)(t)}</xml>`}}r.setBuiltinHelpInfo=function(e,t){var r=pxt.blocks.getBlockDefinition(t);h(e,t,r.name,r.tooltip,r.url,pxt.toolbox.getNamespaceColor(r.category))},r.installBuiltinHelpInfo=function(e){var t=pxt.blocks.getBlockDefinition(e);i(e,t.name,t.tooltip,t.url,pxt.toolbox.getNamespaceColor(t.category))},r.setHelpResources=h,r.installHelpResources=i,r.mkCard=s,r.attachCardInfo=function(e,t){var r;if(t=e.apis.byQName[t])return r=pxt.blocks.compileInfo(t),s(t,(0,n.createToolboxBlock)(e,t,r))}},{"./external":25,"./plugins/duplicateOnDrag":91,"./toolbox":139,"./xml":141,blockly:175}],73:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.validateAllReferencedBlocksExist=r.patchShadows=r.patchCommentIds=r.importXml=r.loadWorkspaceXml=r.loadBlocksXml=r.getFirstChildWithAttr=r.getChildrenWithAttr=r.getBlocksWithType=r.getDirectChildren=r.saveBlocksXml=r.workspaceToDom=r.saveWorkspaceXml=r.clearWithoutEvents=r.domToWorkspaceNoEvents=void 0;let f=e("blockly"),_=e("./loader"),y=e("./external"),o=e("./fields");function i(e,t,r){pxt.tickEvent("blocks.domtow");let n=[];x(e),E(e,!1),pxt.react.getTilemapProject&&(0,o.updateTilemapXml)(e,pxt.react.getTilemapProject());try{f.Events.disable(),n=f.Xml.domToWorkspace(e,t),o.FieldBase.flushInitQueue();for(var i of t.getAllBlocks())i.afterWorkspaceLoad&&i.afterWorkspaceLoad.call(i);a=r,(s=t).getAllBlocks(!1).filter(e=>!!e.getCommentText()).forEach(t=>{var r,n=t.getCommentText();if(/@hide/.test(n)&&null!=a&&a.applyHideMetaComment)t.dispose(!0);else{let e=n;/@highlight/.test(e)&&(e=e.replace(/@highlight/g,"").trim(),null!=(r=s.highlightBlock))&&r.call(s,t.id,!0),/@collapsed/.test(e)&&!t.getParent()&&(e=e.replace(/@collapsed/g,"").trim(),t.setCollapsed(!0)),n===(e=e.replace(/@validate-\S+/g,"").trim())||null!=a&&a.keepMetaComments||t.setCommentText(e||null)}})}catch(e){pxt.reportException(e)}finally{f.Events.enable()}var s,a;return n.filter(e=>!!t.getBlockById(e))}function n(e,t){var r,t=f.Xml.workspaceToDom(e,t),e=f.Xml.variablesToDom(e.getVariableMap().getAllVariables());for(r of b(t,"variables"))r.remove();return s(t.getElementsByTagName("block")),s(t.getElementsByTagName("shadow")),s(t.getElementsByTagName("comment")),t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e),t}function s(t){for(let e=0;e<t.length;e++){var r=t.item(e);r.hasAttribute("editable")&&r.removeAttribute("editable"),r.hasAttribute("movable")&&r.removeAttribute("movable")}}function b(t,r){var n=[];for(let e=0;e<t.childNodes.length;e++){var i=t.childNodes.item(e);i.tagName===r&&n.push(i)}return n}function v(e,t){return T(e,"block","type",t).concat(T(e,"shadow","type",t))}function T(e,t,r,n){return pxt.Util.toArray(e.getElementsByTagName(t)).filter(e=>e.getAttribute(r)===n)}function k(e,t,r,n){e=T(e,t,r,n);return e.length?e[0]:void 0}function x(e){var t,r;for(t of b(e,"comment"))t.hasAttribute("id")||t.setAttribute("id",f.utils.idGenerator.genUid());for(r of e.querySelectorAll("comment:not([h])"))r.setAttribute("h","80"),r.setAttribute("w","160")}function a(e){var t;if(2!==e.parentElement.childElementCount)return t=l(e),e.parentElement.appendChild(t),e.remove(),t;e.remove()}function l(e){var t,r,n=f.utils.xml.createElement("block");for(t of e.getAttributeNames())n.setAttribute(t,e.getAttribute(t));for(r of e.childNodes)n.appendChild(r.cloneNode(!0));return n}function E(t,e){if("shadow"===t.tagName)if("xml"===(null==(r=t.parentElement)?void 0:r.tagName)){pxt.warn(`Shadow block of type '${t.getAttribute("type")}' found at top level. Converting to non-shadow block`),pxt.tickEvent("blocks.import.topLevelShadow",{blockId:t.getAttribute("type")});var r=l(t),r=(t.parentElement.insertBefore(r,t),t.remove(),b(t=r,"mutation")[0]);null!=r&&r.hasAttribute("dupliacteondrag")&&r.removeAttribute("dupliacteondrag")}else{r=t.getAttribute("type");let e=!1;switch(r){case"variables_get_reporter":case"argument_reporter_boolean":case"argument_reporter_number":case"argument_reporter_string":case"argument_reporter_array":case"argument_reporter_custom":e=!0}if(e){if(!(t=a(t)))return;let e=b(t,"mutation")[0];e?e.setAttribute("duplicateondrag","true"):((e=f.utils.xml.createElement("mutation")).setAttribute("duplicateondrag","true"),t.appendChild(e))}else"variables_get"!==r&&!function e(t){for(var r of t.children)if("block"===r.tagName.toLowerCase()||e(r))return!0;return!1}(t)||(t=a(t))}if(t)for(var n of t.children)E(n,e||"shadow"===t.tagName)}r.domToWorkspaceNoEvents=i,r.clearWithoutEvents=function(e){if(pxt.tickEvent("blocks.clear"),e)try{f.Events.disable(),e.clear(),e.clearUndo()}finally{f.Events.enable()}},r.saveWorkspaceXml=function(e,t){return e=n(e,!t),f.Xml.domToText(e)},r.workspaceToDom=n,r.saveBlocksXml=function(e,t){return e.getTopBlocks(!1).map(e=>f.Xml.domToText(f.Xml.blockToDom(e,!t)))},r.getDirectChildren=b,r.getBlocksWithType=v,r.getChildrenWithAttr=T,r.getFirstChildWithAttr=k,r.loadBlocksXml=function(e,t){var r,t=f.utils.xml.textToDom(t),t=f.Xml.domToBlock(t,e);e.getMetrics&&(e=e.getMetrics(),r=t.getHeightWidth(),t.moveBy(e.viewLeft+e.viewWidth/2-r.width/2,e.viewTop+e.viewHeight/2-r.height/2))},r.loadWorkspaceXml=function(e,t=!1,r){var n=new f.Workspace;try{return i(f.utils.xml.textToDom(e),n,r),n}catch(e){return t||pxt.reportException(e),null}},r.importXml=function(e,r,i,t=!1){try{(0,_.initializeAndInject)(i);let n=(new DOMParser).parseFromString(r,"application/xml");var s=pxt.patching.computePatches(e),a=(s&&(s.filter(e=>"blockId"==e.type).forEach(r=>Object.keys(r.map).forEach(t=>{v(n,t).forEach(e=>{e.setAttribute("type",r.map[t]),pxt.debug(`patched block ${t} -> `+r.map[t])})})),s.filter(e=>"blockValue"==e.type).forEach(r=>Object.keys(r.map).forEach(t=>{var e=t.split("."),e=e[0];v(n,e).reduce((e,t)=>e.concat(b(t,"value")),[]).forEach(e=>{e.setAttribute("name",r.map[t]),pxt.debug(`patched block value ${t} -> `+r.map[t])})})),s.filter(e=>"userenum"==e.type).forEach(r=>Object.keys(r.map).forEach(t=>{T(n,"variable","type",t).forEach(e=>{e.setAttribute("type",r.map[t]),pxt.debug(`patched enum variable type ${t} -> `+r.map[t])})}))),b(n.children.item(0),"shadow"));for(let r of a){let t=n.createElement("block");r.getAttributeNames().forEach(e=>t.setAttribute(e,r.getAttribute(e)));for(let e=0;e<r.childNodes.length;e++)t.appendChild(r.childNodes.item(e));r.replaceWith(t)}E(n.documentElement,!1),x(n.documentElement);let t={};Object.keys(i.apis.byQName).forEach(e=>{e=i.apis.byQName[e];7==e.kind&&(t[e.namespace+"."+(e.attributes.blockImportId||e.attributes.block||e.attributes.blockId||e.name)]=e.namespace+"."+e.name)});var o=n.getElementsByTagName("block");for(let e=0;e<o.length;++e)((i,s,a)=>{let e,t=a.getAttribute("type"),r=f.Blocks[t],o=(0,_.blockSymbol)(t);if(o&&r){let n=pxt.blocks.compileInfo(o);null!=(e=o.parameters)&&e.forEach((e,t)=>{var r=i.apis.byQName[e.type];r&&6==r.kind&&(e=k(a,"field","name",n.actualNameToParam[e.name].definitionName))&&(r=s[r.name+"."+e.textContent])&&(e.textContent=r)})}})(i,t,o[e]);{var l=n.documentElement;var c=i;var u=v(l,ts.pxtc.ON_START_TYPE);let r=u.length?u[0]:void 0;if(r)r.removeAttribute("deletable");else{var d=[],p=c.blocksById;let e=l.firstElementChild,t=void 0;for(;e;){var h=e.nextElementSibling,m=e.getAttribute("type");e.getAttribute("disabled")||e.getElementsByTagName("statement").length||!(_.buildinBlockStatements[m]||p[m]&&"void"==p[m].retType&&!(0,_.hasArrowFunction)(p[m]))||(t=(t?((m=l.ownerDocument.createElement("next")).appendChild(e),t.appendChild(m)):((t=l.ownerDocument.createElement("statement")).setAttribute("name","HANDLER"),r||((r=l.ownerDocument.createElement("block")).setAttribute("type",ts.pxtc.ON_START_TYPE),d.push(r)),r.appendChild(t),t.appendChild(e)),e.removeAttribute("x"),e.removeAttribute("y"),e)),e=h}d.forEach(e=>l.appendChild(e))}}return g=n.documentElement,pxt.U.toArray(g.querySelectorAll("block[type=procedures_defnoreturn]")).forEach(e=>{e.setAttribute("type","function_definition"),e.querySelector("field[name=NAME]").setAttribute("name","function_name")}),pxt.U.toArray(g.querySelectorAll("block[type=procedures_callnoreturn]")).forEach(e=>{e.setAttribute("type","function_call"),e.querySelector("field[name=NAME]").setAttribute("name","function_name")}),(0,y.extensionBlocklyPatch)(e,n.documentElement),(new XMLSerializer).serializeToString(n)}catch(e){return t||pxt.reportException(e),r}var g},r.patchCommentIds=x,r.patchShadows=E,r.validateAllReferencedBlocksExist=function(e){pxt.U.assert(!(null==f||!f.Blocks),"Called validateAllReferencedBlocksExist before initializing Blockly");var t=(e=f.utils.xml.textToDom(e)).querySelectorAll("block");for(let e=0;e<t.length;e++)if(!f.Blocks[t.item(e).getAttribute("type")])return!1;var r=e.querySelectorAll("shadow");for(let e=0;e<r.length;e++)if(!f.Blocks[r.item(e).getAttribute("type")])return!1;return!0}},{"./external":25,"./fields":70,"./loader":77,blockly:175}],74:[function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},s=(Object.defineProperty(r,"__esModule",{value:!0}),r.external=r.contextMenu=void 0,i(e("./plugins/arrays"),r),i(e("./plugins/functions"),r),i(e("./plugins/logic"),r),i(e("./plugins/math"),r),i(e("./plugins/text"),r),i(e("./plugins/renderer"),r),i(e("./plugins/flyout"),r),i(e("./plugins/newVariableField"),r),i(e("./plugins/comments"),r),i(e("./compiler/compiler"),r),i(e("./compiler/environment"),r),i(e("./loader"),r),i(e("./layout"),r),i(e("./render"),r),i(e("./toolbox"),r),i(e("./fields"),r),i(e("./sourceMap"),r),i(e("./importer"),r),i(e("./diff"),r),i(e("./legacyMutations"),r),i(e("./blockDragger"),r),i(e("./workspaceSearch"),r),i(e("./monkeyPatches"),r),i(e("./getBlockText"),r),e("./contextMenu")),s=(r.contextMenu=s,e("./external"));r.external=s,i(e("./breakpointIcon"),r)},{"./blockDragger":1,"./breakpointIcon":2,"./compiler/compiler":12,"./compiler/environment":13,"./contextMenu":21,"./diff":24,"./external":25,"./fields":70,"./getBlockText":71,"./importer":73,"./layout":75,"./legacyMutations":76,"./loader":77,"./monkeyPatches":81,"./plugins/arrays":83,"./plugins/comments":86,"./plugins/flyout":97,"./plugins/functions":111,"./plugins/logic":117,"./plugins/math":119,"./plugins/newVariableField":123,"./plugins/renderer":129,"./plugins/text":134,"./render":137,"./sourceMap":138,"./toolbox":139,"./workspaceSearch":140}],75:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.documentToSvg=r.blocklyToSvgAsync=r.cleanUpBlocklySvg=r.serializeSvgString=r.serializeNode=r.toSvgAsync=r.toPngAsync=r.screenshotAsync=r.screenshotEnabled=r.flow=r.setCollapsedAll=r.verticalAlign=r.splitSvg=r.patchBlocksFromOldWorkspace=void 0;let E=e("blockly"),S=e("./compiler/environment"),b=e("./fields"),C=e("./compiler/compiler"),s=e("./importer");function w(e){return(e=e.replace(/\n/g,"")).trim()}r.patchBlocksFromOldWorkspace=function(o,l,c){c=(0,s.loadWorkspaceXml)(c,!0);{var u,d=o,p=l;o=c;let e,t,r=p.getTopBlocks(!1).filter(e=>e.isEnabled()),n=o.getTopBlocks(!1),i,s=p.getTopComments(!1),a=o.getTopComments(!1);for(_ of r){var h=_.getRelativeToSurfaceXY();if(h&&0!=h.x&&0!=h.y){if(!e){e=(0,S.mkEnv)(p,d),t={};for(var m of n){var g=(0,C.callKey)(e,m),f=t[g]||[];f.push(m),t[g]=f}}var _=(0,C.callKey)(e,_),_=(t[_]||[]).shift();_&&((_=_.getRelativeToSurfaceXY()).x=h.x,_.y=h.y)}}for(u of s){var y=u.getRelativeToSurfaceXY();if(y&&0!=y.x&&0!=y.y){if(!i){i={};for(var b of a){var v=w(b.getText()),T=i[v]||[];T.push(b),i[v]=T}}var k,x=w(u.getText()),x=(i[x]||[]).shift();x&&(k=u.getSize(),x.setText(u.getText()),x.setSize(k),(u=x.getRelativeToSurfaceXY()).x=y.x,u.y=y.y)}}}var e,o=(0,s.workspaceToDom)(l,!0),t=(0,s.workspaceToDom)(c,!0);for(e of o.childNodes)pxt.BrowserUtils.isElement(e)&&"block"===e.localName&&"true"===e.getAttribute("disabled")&&t.appendChild(t.ownerDocument.importNode(e,!0));return E.Xml.domToText(t)},r.splitSvg=function(u,e,d=18){var t=e.getTopComments(!0),r=e.getTopBlocks(!0);if(t.length+r.length<2)return u;let p=document.createElement("div");function i(e,t,r,n,i,s,a){var o=u.cloneNode(!0),l=o.querySelector("g.blocklyWorkspace > g."+e),t=o.querySelector("g.blocklyWorkspace > g."+t),e=pxt.Util.toArray(l.querySelectorAll(`g.blocklyWorkspace > g.${e} > `+(a?"."+a:"g[transform]")));let c=e.splice(r,1)[0];c?(e.filter(e=>e!=c).forEach(e=>{e.parentNode.removeChild(e)}),l.removeAttribute("transform"),t.parentNode.removeChild(t),c.setAttribute("transform",`translate(${i.x}, ${i.y})`),a=n.width/d+"em",r=n.height/d+"em",o.setAttribute("viewBox",`0 0 ${n.width} `+n.height),o.style.width=a,o.style.height=r,o.setAttribute("width",a),o.setAttribute("height",r),o.setAttribute("aria-label",s),p.appendChild(o)):pxt.log("missing block, did block failed to load?")}return p.className="blocks-svg-list "+e.getInjectionDiv().className,t.forEach((e,t)=>i("blocklyBubbleCanvas","blocklyBlockCanvas",t,e.getSize(),{x:0,y:0},lf("blockly comment"),"blocklyComment")),r.forEach((e,t)=>{var r=e.getHeightWidth(),n={x:0,y:0},e=(e.hat&&(r.height+=d,n.y+=d),e.toString());i("blocklyBlockCanvas","blocklyBubbleCanvas",t,r,n,e+" blocks")}),p},r.verticalAlign=function(e,r){let n=0;e.getTopComments(!0).forEach(e=>{e.moveBy(0,n),n=(n+=e.getSize().height)+r}),e.getTopBlocks(!0).forEach((e,t)=>{e.hat&&(n+=r),e.moveBy(0,n),n=(n+=e.getHeightWidth().height)+r})},r.setCollapsedAll=function(e,t){e.getTopBlocks(!1).filter(e=>e.isEnabled()).forEach(e=>e.setCollapsed(t))};let v=20,T=20;function n(e,t,r){let n,i=(r&&(n={target:pxt.appTarget.id,versions:pxt.appTarget.versions,xml:(0,s.saveBlocksXml)(e).map(e=>pxt.Util.htmlEscape(e))}),0|t||4);return a(e,i).then(e=>e?pxt.BrowserUtils.encodeToPngAsync(e.xml,{width:e.width,height:e.height,pixelDensity:i,text:r?JSON.stringify(n,null,2):null}):Promise.resolve(void 0)).catch(e=>{pxt.reportException(e)})}r.flow=function(e,t){if(t){if(t.useViewWidth){var r=e.getMetrics();if(r.viewHeight>r.viewWidth)return o(e.getTopComments(!0),e.getTopBlocks(!0),void 0,r.viewWidth),void e.scroll(v,T)}o(e.getTopComments(!0),e.getTopBlocks(!0),t.ratio)}else o(e.getTopComments(!0),e.getTopBlocks(!0));e.scroll(v,T)},r.screenshotEnabled=function(){return pxt.BrowserUtils.hasFileAccess()&&!pxt.BrowserUtils.isIE()},r.screenshotAsync=n,r.toPngAsync=n;let k="http://www.w3.org/1999/xlink",c=12e7;function a(e,t){if(!e)return Promise.resolve(void 0);var r,n,i,s=e.getBlocksBoundingBox(),a=e.getParentSvg().cloneNode(!0);u(a);for(r of e.getAllBlocks())r.hasIcon(E.icons.IconType.COMMENT)&&(n=(i=r.getIcon(E.icons.IconType.COMMENT)).getBubbleLocation())&&(i=i.getBubbleSize(),s.left=Math.min(n.x,s.left),s.top=Math.min(n.y,s.top),s.right=Math.max(n.x+i.width,s.right),s.bottom=Math.max(n.y+i.height,s.bottom));--s.left,--s.top,s.right+=1,s.bottom+=1;var e=s.right-s.left,o=s.bottom-s.top;let l=1;t=e*o*Math.pow(t,2);return t>c&&(l=Math.sqrt(c/t)),d(a,s.left,s.top,e,o,l)}function x(e){return i((new XMLSerializer).serializeToString(e))}function i(e){return e.replace(new RegExp("&nbsp;","g"),"&#160;")}function u(e){pxt.BrowserUtils.removeClass(e,"blocklySvg"),pxt.BrowserUtils.addClass(e,"blocklyPreview pxt-renderer classic-theme"),pxt.U.toArray(e.querySelectorAll(".blocklyMainBackground,.blocklyScrollbarBackground")).forEach(e=>{e&&e.parentNode.removeChild(e)}),pxt.U.toArray(e.querySelectorAll(".blocklyConnectionIndicator,.blocklyInputConnectionIndicator")).forEach(e=>{e&&e.parentNode.removeChild(e)}),e.removeAttribute("width"),e.removeAttribute("height"),pxt.U.toArray(e.querySelectorAll(".blocklyBlockCanvas,.blocklyBubbleCanvas")).forEach(e=>e.removeAttribute("transform")),e.querySelectorAll("[tabindex]").forEach(e=>{e.removeAttribute("tabindex")});let r=new DOMParser;return pxt.U.toArray(e.querySelectorAll(".blocklyTextarea")).forEach(e=>{var t=r.parseFromString("<!doctype html><body>"+pxt.docs.html2Quote(e.value),"text/html");e.textContent=t.body.textContent}),e}async function d(e,t,r,n,i,s){if(e.childNodes[0]){e.removeAttribute("width"),e.removeAttribute("height"),e.removeAttribute("transform");var a,o=Math.round(n*(s||1)),s=Math.round(i*(s||1)),e=x(e).replace(/^\s*<svg[^>]+>/i,"").replace(/<\/svg>\s*$/i,""),t=`<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="${k}" width="${o}" height="${s}" viewBox="${t} ${r} ${n} ${i}" class="pxt-renderer classic-theme injectionDiv">${e}</svg>`,r=(new DOMParser).parseFromString(t,"image/svg+xml"),n=r.createElementNS("http://www.w3.org/1999/xhtml","style"),i=pxt.Util.isUserLanguageRtl(),e=document.getElementById(`style-${i?"rtl":""}blockly.css`).href,t=pxt.Util.toArray(document.head.getElementsByTagName("link")).filter(e=>pxt.Util.endsWith(e.getAttribute("href"),"semantic.css"))[0].href,i=await Promise.all([pxt.BrowserUtils.loadAjaxAsync(e),pxt.BrowserUtils.loadAjaxAsync(t)]),e=pxt.Util.toArray(document.head.querySelectorAll("style")).filter(e=>/\.blocklySvg/.test(e.innerText))[0],t=(i.unshift((null==(t=document.getElementById("blockly-common-style"))?void 0:t.innerText)||""),i.unshift((null==(t=document.getElementById("blockly-renderer-style-pxt-classic"))?void 0:t.innerText)||""),(e?e.innerText:"")+"\n\n"+i.map(e=>e+"\n\n")),e=(n.appendChild(r.createCDATASection(t)),r.documentElement.insertBefore(n,r.documentElement.firstElementChild),r);A=A||{};var l,c,i=(e=pxt.Util.toArray(e.getElementsByTagName("image"))).filter(e=>{e=e.getAttributeNS(k,"href");return e&&!/^data:/.test(e)});for(l of i){var u=l.getAttributeNS(k,"href");let t=A[u];if(!t)try{var d=await pxt.BrowserUtils.loadImageAsync(l.getAttributeNS(k,"href")),p=document.createElement("canvas"),h=p.getContext("2d"),m=d.width,g=d.height;p.width=m,p.height=g,h.drawImage(d,0,0,m,g,0,0,p.width,p.height),t=p.toDataURL("image/png"),A[u]=t}catch(e){pxt.debug("svg render: failed to load "+u),t=""}l.setAttributeNS(k,"href",u)}for(c of i=e.filter(e=>{e=e.getAttribute("href");return(null==e?void 0:e.endsWith(".svg"))&&(e.startsWith("/")||e.startsWith(pxt.webConfig.cdnUrl))})){var f=c.getAttribute("href");let e=24,t=24,r=(c.hasAttribute("width")&&c.hasAttribute("height")?(e=parseInt(c.getAttribute("width").replace(/[^0-9]/g,"")),t=parseInt(c.getAttribute("height").replace(/[^0-9]/g,""))):c.classList.contains("blocklyResizeHandle")&&(e=12,t=12),A[f]);r=r||await pxt.BrowserUtils.encodeToPngAsync(f,{width:e,height:t,pixelDensity:2}),A[f]=r,c.setAttribute("href",r)}await 0;n=r;if(D=D||{},pxt.BrowserUtils.isEdge())for(a of pxt.Util.toArray(n.getElementsByTagName("image")).filter(e=>/^data:image\/svg\+xml/.test(e.getAttributeNS(k,"href")))){var _=a.getAttributeNS(k,"href"),y=parseInt(a.getAttribute("width").replace(/[^0-9]/g,"")),b=parseInt(a.getAttribute("height").replace(/[^0-9]/g,""));let e=D[_];e||(e=await pxt.BrowserUtils.encodeToPngAsync(_,{width:y,height:b,pixelDensity:2}),pxt.log("HREF: "+e)),D[_]=e,a.setAttributeNS(k,"href",e)}return await 0,{width:o,height:s,svg:x(r).replace('<style xmlns="http://www.w3.org/1999/xhtml">',"<style>"),xml:I(r),css:t}}}function I(e){e=(new XMLSerializer).serializeToString(e);return"data:image/svg+xml;base64,"+ts.pxtc.encodeBase64(unescape(encodeURIComponent(e)))}r.toSvgAsync=a,r.serializeNode=x,r.serializeSvgString=i,r.cleanUpBlocklySvg=u,r.blocklyToSvgAsync=d,r.documentToSvg=I;let A;let D;function o(e,t,r=1.62,n){let s=[],a={};e.forEach(e=>{var t=e.data;null!=t&&(a[t]=e)});let o,i=(t.sort((e,t)=>e.isEnabled()===t.isEnabled()?e.type===t.type?0:"function_definition"===e.type?1:"function_definition"===t.type?-1:e.type.localeCompare(t.type):e.isEnabled()?-1:1),t.forEach(e=>{var t=(0,b.getBlockData)(e).commentRefs;if(t.length){var r=[];for(let e=0;e<t.length;e++){var n=a[t[e]];n&&(r.push(N(n)),delete a[t[e]])}if(r.length)return void s.push({value:e,width:-1,height:-1,children:r})}var i=N(e);!o&&e.isEnabled()&&e.type===pxtc.ON_START_TYPE?o=i:s.push(i)}),o&&s.unshift(o),Object.keys(a).sort((e,t)=>e.length===t.length?t<e?-1:1:e.length>t.length?-1:1).forEach(e=>{a[e]&&s.push(N(a[e]))}),e.forEach(e=>{null==e.data&&s.push(N(e))}),0);for(let e=0;e<s.length;e++){var l=s[e];if(l.children){var c=l.value.getHeightWidth(),u=(l.x=0,l.y=0,c.width+13);let t=0;for(let e=0;e<l.children.length;e++){var d=l.children[e];d.x=u,d.y=t,t+=d.height+13,l.width=Math.max(l.width,u+d.width)}l.height=Math.max(t-13,c.height)}i+=(l.height+13)*(l.width+13)}let p,h=(p=n>v?n-v:Math.sqrt(i)*r,v),m=T,g=0;for(let e=0;e<s.length;e++){var f=s[e];if(f.children){y(f,h+f.x,m+f.y);for(let e=0;e<f.children.length;e++){var _=f.children[e];y(_,h+_.x,m+_.y)}}else y(f,h,m);h+=f.width+45,g=Math.max(g,m+f.height+45),h>p&&(h=v,m=g)}function y(e,t,r){var n=e.value.getBoundingRectangle();e.value.moveBy(t-n.left,r-n.top)}}function N(e){var t=e instanceof E.BlockSvg?e.getHeightWidth():e.getSize();return{value:e,height:t.height,width:t.width}}},{"./compiler/compiler":12,"./compiler/environment":13,"./fields":70,"./importer":73,blockly:175}],76:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.mutateToolboxBlock=r.addMutation=r.MutatorTypes=void 0;let n=e("blockly"),i=e("./compiler/util"),s=e("./compiler/compiler"),a=e("./loader"),o=e("./plugins/newVariableField/fieldVariable");var l;(e=l=r.MutatorTypes||(r.MutatorTypes={})).ObjectDestructuringMutator="objectdestructuring",e.RestParameterMutator="restparameter",e.DefaultInstanceMutator="defaultinstance",r.addMutation=function(e,t,r){let n;switch(r){case l.ObjectDestructuringMutator:if(!t.parameters||t.parameters.length<1)pxt.error("Destructuring mutations require at least one parameter");else{let e=!1;for(var i of t.parameters)if(-1!==i.type.indexOf("=>")){if(!i.properties||0===i.properties.length)return void pxt.error("Destructuring mutations only supported for functions with an event parameter that has multiple properties");e=!0}if(!e)return void pxt.error("Destructuring mutations must have an event parameter")}n=new u(e,t);break;case l.RestParameterMutator:n=new d(e,t);break;case l.DefaultInstanceMutator:n=new p(e,t);break;default:return void pxt.warn("Ignoring unknown mutation type: "+r)}e.mutationToDom=n.mutationToDom.bind(n),e.domToMutation=n.domToMutation.bind(n),e.compose=n.compose.bind(n),e.decompose=n.decompose.bind(n),e.mutation=n},r.mutateToolboxBlock=function(e,t,r){var n=document.createElement("mutation");switch(t){case l.ObjectDestructuringMutator:n.setAttribute(u.propertiesAttributeName,r);break;case l.RestParameterMutator:n.setAttribute(d.countAttributeName,r);break;case l.DefaultInstanceMutator:n.setAttribute(p.attributeName,r);default:return void pxt.warn("Ignoring unknown mutation type: "+t)}e.appendChild(n)};class c{constructor(e,t){this.info=t,this.block=e,this.topBlockType=this.block.type+"_mutator";t=this.getSubBlockNames(),this.initializeMutatorTopBlock(),this.initializeMutatorSubBlocks(t),t=t.map(e=>e.type);this.block.setMutator(new n.icons.MutatorIcon(t,e))}compose(e){e=e.getDescendants(!1).map(e=>({type:e.type,name:e.inputList[0].name}));e.shift(),this.updateBlock(e)}decompose(r){var e,t=r.newBlock(this.topBlockType);t.initSvg();for(e of t.inputList)if(e.name===c.mutatorStatmentInput){let t=e.connection;this.getVisibleBlockTypes().forEach(e=>{e=r.newBlock(e);e.initSvg(),t.connect(e.previousConnection),t=e.nextConnection});break}return t}compileMutation(e,t){}getDeclaredVariables(){}isDeclaredByMutation(e){return!1}initializeMutatorSubBlock(e,t,r){e.appendDummyInput(t).appendField(t),e.setColour(r),e.setNextStatement(!0),e.setPreviousStatement(!0)}initializeMutatorTopBlock(){let e=this.info.attributes.mutateText,t=this.block.getColour();n.Blocks[this.topBlockType]=n.Blocks[this.topBlockType]||{init:function(){this.appendDummyInput().appendField(e),this.setColour(t),this.appendStatementInput(c.mutatorStatmentInput)}}}initializeMutatorSubBlocks(e){let t=this.block.getColour(),r=this.initializeMutatorSubBlock.bind(this);e.forEach(e=>{n.Blocks[e.type]=n.Blocks[e.type]||{init:function(){r(this,e.name,t)}}})}}c.mutatorStatmentInput="PROPERTIES",c.mutatedVariableInputName="properties";class u extends c{constructor(e,t){super(e,t),this.currentlyVisible=[],this.parameterRenames={},this.prefix=this.info.attributes.mutatePrefix,this.block.appendDummyInput(c.mutatedVariableInputName),this.block.appendStatementInput("HANDLER").setCheck("null")}getMutationType(){return l.ObjectDestructuringMutator}compileMutation(n,e){var t;if(this.info.attributes.mutatePropertyEnum||this.parameters.length)return t=`function ({ ${this.parameters.map(e=>{var t=this.block.getField(e),t=t&&t.getText(),r=(0,i.escapeVarName)(e,n);return t!==e?(this.parameterRenames[e]=t,e+": "+(0,i.escapeVarName)(t,n)):r}).join(", ")} })`,this.info.attributes.mutatePropertyEnum?pxt.blocks.mkText(` [${this.parameters.map(e=>this.info.attributes.mutatePropertyEnum+"."+e).join(", ")}],`+t):pxt.blocks.mkText(t)}getDeclaredVariables(){let t={};return this.parameters.forEach(e=>{t[this.getVarFieldValue(e)]=this.parameterTypes[e]}),t}isDeclaredByMutation(t){return this.parameters.some(e=>this.getVarFieldValue(e)===t)}mutationToDom(){var e,t=document.createElement("mutation"),r=this.parameters.map(e=>{var t=this.getVarFieldValue(e);return t!==e&&(this.parameterRenames[e]=pxt.Util.htmlEscape(t)),pxt.Util.htmlEscape(e)}).join(",");for(e in t.setAttribute(u.propertiesAttributeName,r),this.parameterRenames)e===this.parameterRenames[e]&&delete this.parameterRenames[e];return t.setAttribute(u.renameAttributeName,JSON.stringify(this.parameterRenames)),t}domToMutation(e){var t=e.getAttribute(u.propertiesAttributeName);if(t){t=t.split(",");let r=[];if(void 0===this.paramIndex&&(this.paramIndex=this.getParameterIndex()),t.forEach(e=>{let t=e.split(":");this.info.parameters[this.paramIndex].properties.some(e=>e.name===t[0])&&r.push({property:t[0],newName:t[1]})}),this.parameterRenames=void 0,e.hasAttribute(u.renameAttributeName))try{this.parameterRenames=JSON.parse(e.getAttribute(u.renameAttributeName))}catch(e){pxt.warn("Ignoring invalid rename map in saved block mutation")}this.parameterRenames=this.parameterRenames||{},this.parameters=[],r.forEach(e=>{this.parameters.push(e.property),e.newName&&e.newName!==e.property&&(this.parameterRenames[e.property]=e.newName)}),this.updateVisibleProperties(),r.filter(e=>!!e.newName).forEach(e=>this.setVarFieldValue(e.property,e.newName))}}getVarFieldValue(e){e=this.block.getField(e);return e&&e.getText()}setVarFieldValue(e,t){this.block.getField(e);this.block.getField(e)&&(0,a.setVarFieldValue)(this.block,e,t)}updateBlock(e){this.parameters=[],e.forEach(e=>{-1===this.parameters.indexOf(e.name)&&this.parameters.push(e.name)}),this.updateVisibleProperties()}getSubBlockNames(){return this.parameters=[],this.parameterTypes={},void 0===this.paramIndex&&(this.paramIndex=this.getParameterIndex()),this.info.parameters[this.paramIndex].properties.map(e=>(this.parameterTypes[e.name]=e.type,{type:this.propertyId(e.name),name:e.name}))}getVisibleBlockTypes(){return this.currentlyVisible.map(e=>this.propertyId(e))}updateVisibleProperties(){if(!pxt.Util.listsEqual(this.currentlyVisible,this.parameters)){let r=this.block.inputList.find(e=>e.name===c.mutatedVariableInputName);this.prefix&&0===this.currentlyVisible.length&&r.appendField(this.prefix,u.prefixLabel),this.currentlyVisible.forEach(e=>{var t;-1===this.parameters.indexOf(e)&&((t=this.getVarFieldValue(e))!==e&&(this.parameterRenames[e]=t),r.removeField(e))}),this.parameters.forEach(e=>{var t;-1===this.currentlyVisible.indexOf(e)&&(t=this.parameterRenames[e]||e,r.appendField(new o.FieldVariable(t),e))}),this.prefix&&0===this.parameters.length&&r.removeField(u.prefixLabel),this.currentlyVisible=this.parameters}}propertyId(e){return this.block.type+"_"+e}getParameterIndex(){for(let e=0;e<this.info.parameters.length;e++)if(-1!==this.info.parameters[e].type.indexOf("=>"))return e}}u.propertiesAttributeName="callbackproperties",u.renameAttributeName="renamemap",u.prefixLabel="0prefix_label_";class d extends c{constructor(){super(...arguments),this.count=0}getMutationType(){return l.RestParameterMutator}compileMutation(t,r){let n=[];return this.forEachInput(e=>n.push((0,s.compileExpression)(t,e,r))),pxt.blocks.mkGroup(n)}mutationToDom(){var e=document.createElement("mutation");return e.setAttribute(d.countAttributeName,this.count.toString()),e}domToMutation(e){e=e.getAttribute(d.countAttributeName);if(e){try{this.count=parseInt(e)}catch(e){return}for(let e=0;e<this.count;e++)this.addNumberField(!1,e)}}updateBlock(e){if(e){var t=Math.abs(this.count-e.length);if(this.count<e.length)for(let e=0;e<t;e++)this.addNumberField(!0,this.count);else if(this.count>e.length)for(let e=0;e<t;e++)this.removeNumberField()}}getSubBlockNames(){return[{name:"Value",type:d.entryTypeName}]}getVisibleBlockTypes(){let e=[];return this.forEachInput(()=>e.push(d.entryTypeName)),e}addNumberField(e,t){t=this.block.appendValueInput(d.valueInputPrefix+t).setCheck("Number");e&&((e=this.block.workspace.newBlock("math_number")).initSvg(),e.setShadow(!0),t.connection.connect(e.outputConnection),this.block.workspace.render(),this.count++)}removeNumberField(){0<this.count&&this.block.removeInput(d.valueInputPrefix+(this.count-1)),this.count--}forEachInput(t){for(let e=0;e<this.count;e++)t(this.block.getInputTargetBlock(d.valueInputPrefix+e),e)}}d.countAttributeName="count",d.entryTypeName="entry",d.valueInputPrefix="value_input_";class p extends c{constructor(){super(...arguments),this.showing=!1}getMutationType(){return l.DefaultInstanceMutator}compileMutation(e,t){if(this.showing){var r=this.block.getInputTargetBlock(p.instanceInputName);if(r)return(0,s.compileExpression)(e,r,t)}}mutationToDom(){var e=document.createElement("mutation");return e.setAttribute(p.attributeName,this.showing?"true":"false"),e}domToMutation(e){e=e.getAttribute(p.attributeName);e?this.updateShape("true"===e):this.updateShape(!1)}updateBlock(e){this.updateShape(!(!e||!e.length))}getSubBlockNames(){return[{name:"Instance",type:p.instanceSubBlockType}]}getVisibleBlockTypes(){var e=[];return this.showing&&e.push(p.instanceSubBlockType),e}updateShape(e){this.showing!==e&&(e&&!this.block.getInputTargetBlock(p.instanceInputName)?this.block.appendValueInput(p.instanceInputName):this.block.removeInput(p.instanceInputName),this.showing=e)}}p.attributeName="showing",p.instanceInputName="__instance__",p.instanceSubBlockType="instance"},{"./compiler/compiler":12,"./compiler/util":15,"./loader":77,"./plugins/newVariableField/fieldVariable":122,blockly:175}],77:[function(e,v,S){Object.defineProperty(S,"__esModule",{value:!0}),S.setVarFieldValue=S.generateIcons=S.getFixedInstanceDropdownValues=S.setOutputCheck=S.getBlocklyCheckForType=S.initAccessibleBlocksContextMenuItems=S.initialize=S.initializeAndInject=S.cleanBlocks=S.hasArrowFunction=S.injectBlocks=S.blockSymbol=S.cachedBlockInfo=S.buildinBlockStatements=S.builtinBlocks=S.isTupleType=S.DRAGGABLE_PARAM_INPUT_PREFIX=S.initCopyPaste=void 0;let C=e("blockly"),w=e("./constants"),b=e("./composableMutations"),I=e("./legacyMutations"),t=e("./builtins/math"),A=e("./fields"),r=e("./builtins/functions"),n=e("./builtins/lists"),i=e("./builtins/logic"),s=e("./builtins/loops"),a=e("./builtins/text"),o=e("./toolbox"),c=e("./help"),D=e("./fields"),N=e("./fields"),O=e("./fields"),R=e("./fields"),u=e("./external"),l=e("./builtins/variables"),d=e("./builtins/misc"),T=e("./contextMenu"),k=e("./codecardRenderer"),V=e("./fields/field_dropdown"),L=e("./plugins/duplicateOnDrag"),p=e("./copyPaste");var x=e("./copyPaste");Object.defineProperty(S,"initCopyPaste",{enumerable:!0,get:function(){return x.initCopyPaste}});let H=e("./plugins/newVariableField/fieldVariable"),E=e("./plugins/functions"),G=e("./plugins/functions/utils"),j=e("./compiler/util"),K=e("./compiler/compiler");S.DRAGGABLE_PARAM_INPUT_PREFIX="HANDLER_DRAG_PARAM_",S.isTupleType=function(e){if(e=/^\[(.+)\]$/.exec(e))return e[1].split(/,\s*/)};let h;function m(){return h||(h={},Object.keys(C.Blocks).forEach(e=>h[e]={block:C.Blocks[e]})),h}S.builtinBlocks=m,S.buildinBlockStatements={controls_if:!0,controls_for:!0,pxt_controls_for:!0,controls_simple_for:!0,controls_repeat_ext:!0,pxt_controls_for_of:!0,controls_for_of:!0,variables_set:!0,variables_change:!0,device_while:!0};let g={};function f(l){return S.cachedBlockInfo=l,(0,L.setDraggableShadowBlocks)(l.blocks.filter(e=>e.attributes.duplicateShadowOnDrag).map(e=>e.attributes.blockId)),(0,E.setArgumentReporterLocalizeFunction)((n,i)=>{{var s=l,a=n;let e,t=void 0,r=(n=i).getLocalizationName();r&&(o=pxt.U.rlf(r),t=o!==r?o:pxtc.getBlockTranslationsCacheKey(r));var o=(0,G.getArgumentReporterParent)(n,n);if(o&&!(0,j.isFunctionDefinition)(o)){n=s.blocksById[o.type];if(n){s=pxt.blocks.compileInfo(n),n=null==(e=s.handlerArgs)?void 0:e.find(e=>e.name===a.getValue());if(n)return pxtc.getBlockTranslationsCacheKey(n.localizationKey)}}return t}}),l.blocks.map(e=>{var t,r=pxt.blocks.compileInfo(e),n=(0,o.createToolboxBlock)(l,e,r,!1,2);return e.attributes.blockBuiltin?(pxt.Util.assert(!!m()[e.attributes.blockId]),(t=m()[e.attributes.blockId]).symbol=e,t.block.codeCard=(0,c.mkCard)(e,n)):((f,_,y,e)=>{let t=_.attributes.blockId;if(m()[t])return pxt.reportError("blocks","trying to override builtin block",{details:t});var r=JSON.stringify(_);if(!g[t]||g[t].hash!=r){if(C.Blocks[_.attributes.blockId])return pxt.error("duplicate block definition: "+t);r={hash:r,fn:_,block:{codeCard:(0,c.mkCard)(_,e),init:function(){{var l=this,k=f,x=_,E=y,c,u;let e,t,r=(x.attributes.blockNamespace||x.namespace).split(".")[0],v=1==x.kind||2==x.kind,n=("boolean"!=typeof x.isInstance||null!=(e=x.attributes)&&e.defaultInstance||(v=x.isInstance),k.apis.byQName[r]),T=x.attributes.blockNamespace&&n&&n.attributes.color||x.attributes.color||n&&n.attributes.color||pxt.toolbox.getNamespaceColor(r)||255,i=pxt.blocks.getHelpUrl(x),s=(i&&l.setHelpUrl(i),(0,L.setDuplicateOnDragStrategy)(l),l.setColour("string"==typeof T?pxt.toolbox.getAccessibleBackground(T):T),w.provider.SHAPES.ROUND),a=("boolean"==x.retType&&(s=w.provider.SHAPES.HEXAGONAL),l.setOutputShape(s),x.attributes.undeletable&&l.setDeletable(!1),g(x.attributes._def),!1),o=!1;if(x.attributes.mutate)(0,I.addMutation)(l,x,x.attributes.mutate);else if(x.attributes.defaultInstance)(0,I.addMutation)(l,x,I.MutatorTypes.DefaultInstanceMutator);else if(x.attributes._expandedDef&&"disabled"!==x.attributes.expandableArgumentMode){var d="toggle"===x.attributes.expandableArgumentMode;(0,b.initExpandableBlock)(k,l,x.attributes._expandedDef,E,d,()=>g(x.attributes._expandedDef,!0))}else if(E.handlerArgs.length)if(a=!0,x.attributes.optionalVariableArgs)"reporter"===x.attributes.draggableParameters?o=!0:(0,b.initVariableArgsBlock)(l,E.handlerArgs);else if(x.attributes.draggableParameters)E.handlerArgs.filter(e=>!e.inBlockDef).forEach(e=>{var t=l.appendValueInput(S.DRAGGABLE_PARAM_INPUT_PREFIX+e.name);"reporter"==x.attributes.draggableParameters?t.setCheck(M(e.type,k)):t.setCheck("Variable")}),E.handlerArgs.forEach(e=>{(0,L.setDuplicateOnDrag)(l.type,S.DRAGGABLE_PARAM_INPUT_PREFIX+e.name)});else{let t=l.appendDummyInput();E.handlerArgs.filter(e=>!e.inBlockDef).forEach(e=>{t.appendField(new H.FieldVariable(e.name),"HANDLER_"+e.name)})}(0,b.appendMutation)(l,{mutationToDom:t=>(l.inputList.forEach(e=>{e.fieldRow.forEach(e=>{e.isFieldCustom_&&e.saveOptions&&(e=e.saveOptions())&&t.setAttribute("customfield",JSON.stringify(e))})}),t),domToMutation:r=>{l.inputList.forEach(e=>{e.fieldRow.forEach(e=>{var t;e.isFieldCustom_&&e.restoreOptions&&(t=JSON.parse(r.getAttribute("customfield")))&&e.restoreOptions(t)})})}}),(d=x.attributes.imageLiteral||x.attributes.gridLiteral)&&(p=(x.attributes.imageLiteralColumns||5)*d,h=x.attributes.imageLiteralRows||5,m=x.attributes.imageLiteralScale,c=x.attributes.gridLiteralOnColor,u=x.attributes.gridLiteralOffColor,l.appendDummyInput().appendField(new D.FieldLedMatrix("",{columns:p,rows:h,scale:m,onColor:c,offColor:u}),"LEDS")),"external"===x.attributes.inlineInputMode?l.setInputsInline(!1):"inline"===x.attributes.inlineInputMode?l.setInputsInline(!0):l.setInputsInline(!x.parameters||x.parameters.length<4&&!d),((p=null==(t=x.parameters)?void 0:t.find(e=>pxtc.parameterTypeIsArrowFunction(e)))||a)&&(l.appendStatementInput("HANDLER").setCheck(null),l.setInputsInline(!0));var p,h=P(x),m=!!x.attributes.handlerStatement||!!x.attributes.forceStatement||"void"===x.retType&&!h;function g(e,n=!1){let i=0,y=!n&&!!E.thisParameter;e=(e=>{let t=[],r=[];return e.parts.forEach(e=>{switch(e.kind){case"break":n();break;case"param":r.push(e),n();break;case"image":case"label":r.push(e)}}),n(),t;function n(){r.length&&(t.push(r),r=[])}})(e);let b=new pxt.ImageConverter;if("ENUM_GET"!==x.attributes.shim&&"KIND_GET"!==x.attributes.shim||!(1<E.parameters.length||E.thisParameter)){let r=t=>{var e;return null==(e=l.inputList)?void 0:e.some(e=>e.name===t)};e.forEach(e=>{let m=[],g,f,_=!1;e.forEach(e=>{if("param"!==e.kind){var t=(e=>{if("image"===e.kind){var t=e.uri,r=B[t];if(r)return new C.FieldImage(r,40,40,"",null,pxt.Util.isUserLanguageRtl());pxt.log("missing jres icon "+t)}else{var n=(e=>{if(" "===e)return"";if(1<e.length){var t=" "==e.charAt(0),r=" "==e.charAt(e.length-1);if(t||r)return e.substring(t?1:0,r?e.length-1:e.length)}return e})(e.text);if(n)return e.cssClass?new C.FieldLabel(n,e.cssClass):e.style.length?new N.FieldStyledLabel(n,{bold:-1!==e.style.indexOf("bold"),italics:-1!==e.style.indexOf("italics"),blocksInfo:void 0}):new C.FieldLabel(n,void 0)}})(e);t&&m.push({field:t})}else if("ENUM_GET"===x.attributes.shim)pxt.Util.assert(!!x.attributes.enumName,"Trying to create an ENUM_GET block without a valid enum name"),m.push({name:"MEMBER",field:new O.FieldUserEnum(k.enumsByName[x.attributes.enumName])});else if("KIND_GET"===x.attributes.shim)m.push({name:"MEMBER",field:new A.FieldKind(k.kindsByName[x.attributes.kindNamespace||x.attributes.blockNamespace||x.namespace])});else{let n=((r,e,t=!1)=>{if(r.ref){var n="this"===r.name?e.thisParameter:e.actualNameToParam[r.name];if(!n){let t;if(e.handlerArgs.forEach(e=>{e.name===r.name&&(t=e)}),t)return t}return n}return t?e.thisParameter:e.definitionNameToParam[r.name]})(e,E,y);if(y=!1,n)if(n.definitionName){var t=pxt.Util.lookup(k.apis.byQName,n.type),r=(_=!0,n.definitionName),i=n.actualName,s=t&&6==t.kind,a=t&&!!t.attributes.fixedInstances&&!n.shadowBlockId,o=!!x.attributes.constantShim,l="@combined@"==n.type,c=n.fieldEditor,u=r.charAt(0).toUpperCase()+r.slice(1),d=n.type;if(s||a||o||l){let e;0==(e=s?(o=k.apis,h=n.type,pxt.Util.values(o.byQName).filter(e=>e.namespace===h&&!e.attributes.blockHidden)):a?U(k.apis,t.qName):l?x.combinedProperties.map(e=>pxt.Util.lookup(k.apis.byQName,e)):(s=k.apis,p=x.qName,pxt.Util.values(s.byQName).filter(e=>e.attributes.blockIdentity===p))).length&&pxt.error(`no instances of ${t.qName} found`);o=e.map(e=>{let t=e.attributes.block||e.attributes.blockId||e.name;var r=e.attributes.blockCombine;return e.attributes.jresURL&&!e.attributes.iconURL&&pxt.Util.startsWith(e.attributes.jresURL,"data:image/x-mkcd-f")&&(e.attributes.iconURL=b.convert(e.attributes.jresURL)),r&&(t=t.replace(/@set/,"")),[e.attributes.iconURL||e.attributes.blockImage?{src:e.attributes.iconURL||pxt.Util.pathJoin(pxt.webConfig.commitCdnUrl,`blocks/${e.namespace.toLowerCase()}/${e.name.toLowerCase()}.png`),alt:t,width:36,height:36,value:e.name}:t,e.namespace+"."+e.name]});if(n.defaultValue){let r=-1;o.some((e,t)=>e[1]===n.defaultValue&&(r=t,!0)),-1<r&&(a=o.splice(r,1)[0],o.unshift(a))}c?(l=x.attributes.paramDefl[i]||"",s={data:o,colour:T,label:u,type:d,blocksInfo:k},pxt.Util.jsonMergeFrom(s,x.attributes.paramFieldEditorOptions&&x.attributes.paramFieldEditorOptions[i]||{}),m.push($((0,R.createFieldEditor)(c,l,s),r))):m.push($(new V.FieldDropdown(o),r))}else c?(t=x.attributes.paramDefl[n.actualName]||"",a={colour:T,label:u,type:d,blocksInfo:k},pxt.Util.jsonMergeFrom(a,x.attributes.paramFieldEditorOptions&&x.attributes.paramFieldEditorOptions[n.actualName]||{}),m.push($((0,R.createFieldEditor)(c,t,a),n.definitionName))):(g=r,v&&"this"===e.name?f=n.type:"number"==n.type&&n.shadowBlockId&&"value"==n.shadowBlockId?(g=void 0,m.push($(new C.FieldNumber("0"),r))):f="string"==n.type&&n.shadowOptions&&n.shadowOptions.toString?null:M(n.type,k))}else g=S.DRAGGABLE_PARAM_INPUT_PREFIX+n.name,f="reporter"===x.attributes.draggableParameters?M(n.type,k):"Variable";else pxt.error("block "+x.attributes.blockId+": unknown parameter "+e.name+(e.ref?` (${e.ref})`:""))}var p,h});let t;if(g){if(r(g))return;(t=l.appendValueInput(g)).setAlign(C.inputs.Align.LEFT)}else if(n){e=_?w.optionalInputWithFieldPrefix:w.optionalDummyInputPrefix;if(g=e+i++,r(g))return;t=l.appendDummyInput(g)}else t=l.appendDummyInput();f&&t.setCheck(f),m.forEach(e=>t.appendField(e.field,e.name))}),b.logTime()}else pxt.warn(`Enum blocks may only have 1 parameter but ${x.attributes.blockId} has `+E.parameters.length)}m||F(l,x.retType,k),l.setPreviousStatement(m),l.setNextStatement(m),o&&(0,b.initVariableReporterArgs)(l,E.handlerArgs,k),l.setTooltip(/^__/.test(x.namespace)?"":x.attributes.jsDoc)}}}};pxt.Util.isTranslationMode()&&(r.block.customContextMenu=e=>{_.attributes.translationId&&e.push({enabled:!0,text:lf("Translate this block"),callback:function(){(0,u.promptTranslateBlock)(t,[_.attributes.translationId])}})}),g[t]=r,C.Blocks[t]=r.block}})(l,e,r,n),e})}function P(e){return!(null==(e=e.parameters)||!e.some(e=>pxtc.parameterTypeIsArrowFunction(e)))}S.blockSymbol=function(e){return(e=g[e])?e.fn:void 0},S.injectBlocks=f,S.hasArrowFunction=P,S.cleanBlocks=function(){for(var e in pxt.debug("removing all custom blocks"),g)e=g[e].fn,delete C.Blocks[e.attributes.blockId],delete g[e.attributes.blockId]},S.initializeAndInject=function(e){y(e),(0,T.initContextMenu)(),(0,p.initCopyPaste)(!1),f(e)};let _=!(S.initialize=function(e){y(e);{B={};let r=e.apis.jres;r&&Object.keys(r).forEach(e=>{var t=r[e];t&&t.icon&&(B[e]=t.icon)})}});function y(e){if(!_){_=!0,(0,R.initFieldEditors)(),(0,d.initOnStart)(),(0,t.initMath)(e),(0,l.initVariables)(),(0,r.initFunctions)(),(0,n.initLists)(),(0,s.initLoops)(),(0,i.initLogic)(),(0,a.initText)(),C.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="";{let s=e=>{var t;if(null!=(t=e.hasDisabledReason)&&t.call(e,K.AUTO_DISABLED_REASON))return lf("This block is disabled and will not run. Attach this block to an event to enable it.");let r=e.tooltip;for(;"function"==typeof r;)r=r(e);return r};C.Tooltip.setCustomTooltip((t,e)=>{if(e.codeCard){var r=(0,k.renderCodeCard)({header:s(e)});t.appendChild(r)}else{var r=s(e),n=(r=C.utils.string.wrap(r,C.Tooltip.LIMIT)).split("\n");for(let e=0;e<n.length;e++){var i=document.createElement("div");i.appendChild(document.createTextNode(n[e])),t.appendChild(i)}}})}pxt.BrowserUtils.isSafari()&&pxt.BrowserUtils.isIOS()&&document.addEventListener("pointerup",e=>{setTimeout(()=>{C.Touch.checkTouchIdentifier(e)&&C.Touch.clearTouchIdentifier()})})}}function M(e,t){var r,n=e.split(/\s*\|\s*/),i=[];for(r of n)switch(r){case"number":i.push("Number");break;case"string":i.push("String");break;case"boolean":i.push("Boolean");break;case"T":case"any":return null;case"void":return;default:if((0,o.isArrayType)(r)){if(1<n.length)return null;i.push("Array")}var s=t.apis.byQName[r];s&&s.extendsTypes&&0<s.extendsTypes.length?i.push(...s.extendsTypes):i.push(r)}return i}function F(e,t,r){t=M(t,r);!t&&null!==t||e.setOutput(!0,t)}S.initAccessibleBlocksContextMenuItems=function(){(0,p.initAccessibleBlocksCopyPasteContextMenu)()},S.getBlocklyCheckForType=M,S.setOutputCheck=F;let B={};function $(e,t){return{field:e,name:t}}function U(n,i){return pxt.Util.values(n.byQName).filter(e=>{return 4===e.kind&&e.attributes.fixedInstance&&(t=n,(e=e.retType)==(r=i)||!(!(t=t.byQName[e])||!t.extendsTypes)&&0<=t.extendsTypes.indexOf(r));var t,r}).sort((e,t)=>(t.attributes.weight||50)-(e.attributes.weight||50))}S.getFixedInstanceDropdownValues=U,S.generateIcons=function(e){let t=new pxt.ImageConverter;e.forEach(e=>{e.attributes.jresURL&&!e.attributes.iconURL&&pxt.Util.startsWith(e.attributes.jresURL,"data:image/x-mkcd-f")&&(e.attributes.iconURL=t.convert(e.attributes.jresURL))})},S.setVarFieldValue=function(e,t,r){var n=e.getField(t),i=e.workspace.getVariableMap().getAllVariables();let s=!1;if(i&&i.length)for(let e=0;e<i.length;e++){var a=i[e];a.getName()===r&&(n.setValue(a.getId()),s=!0)}s||(n.initModel(),(t=n.getVariable()).setName(r),n.setValue(t.getId()))}},{"./builtins/functions":3,"./builtins/lists":4,"./builtins/logic":5,"./builtins/loops":6,"./builtins/math":7,"./builtins/misc":8,"./builtins/text":9,"./builtins/variables":10,"./codecardRenderer":11,"./compiler/compiler":12,"./compiler/util":15,"./composableMutations":17,"./constants":18,"./contextMenu":21,"./copyPaste":23,"./external":25,"./fields":70,"./fields/field_dropdown":34,"./help":72,"./legacyMutations":76,"./plugins/duplicateOnDrag":91,"./plugins/functions":111,"./plugins/functions/utils":114,"./plugins/newVariableField/fieldVariable":122,"./toolbox":139,blockly:175}],78:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.monkeyPatchBlockSvg=void 0;let i=e("blockly"),s=e("../fields/field_imagenotext"),a=e("../plugins/renderer/constants");r.monkeyPatchBlockSvg=function(){let n=i.BlockSvg.prototype.setCollapsed;i.BlockSvg.prototype.setCollapsed=function(e){var t,r;e!==this.isCollapsed()&&(n.call(this,e),this.isCollapsed())&&(t=this.getInput(i.constants.COLLAPSED_INPUT_NAME),r=a.ConstantProvider.EXPAND_IMAGE_DATAURI)&&t.appendField(new s.FieldImageNoText(r,24,24,"",()=>{this.setCollapsed(!1)},!1))}}},{"../fields/field_imagenotext":38,"../plugins/renderer/constants":126,blockly:175}],79:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.monkeyPatchGesture=void 0;let n=e("blockly");r.monkeyPatchGesture=function(){if(pxt.BrowserUtils.isAndroid()&&pxt.BrowserUtils.isInGame()){let t=n.Gesture.prototype.doStart,r=(n.Gesture.prototype.doStart=function(e){this.id?(e.stopPropagation(),e.preventDefault()):(this.id=e.pointerId,t.call(this,e))},n.Gesture.prototype.bindMouseEvents=function(e){this.boundEvents_||(this.boundEvents_=[]);let r=e=>{var t=new PointerEvent(e.type,Object.assign(Object.assign({},e),{clientX:e.clientX,clientY:e.clientY,pointerId:this.id}));return t.stopPropagation=()=>e.stopPropagation(),t.stopImmediatePropagation=()=>e.stopImmediatePropagation(),t.preventDefault=()=>e.preventDefault(),t};var t=t=>e=>{if("pointerup"===e.type)e=r(e);else if(e.pointerId!==this.id)return;try{t.call(this,e)}catch(e){pxt.error("Uncaught error while executing gesture handler",e),this.cancel(),this.dispose()}};this.boundEvents_.push(n.browserEvents.conditionalBind(document,"pointerdown",null,t(this.handleStart),!0)),this.boundEvents_.push(n.browserEvents.conditionalBind(document,"pointermove",null,t(this.handleMove),!0)),this.boundEvents_.push(n.browserEvents.conditionalBind(document,"pointerup",null,t(this.handleUp),!0)),e.preventDefault(),e.stopPropagation()},n.Gesture.prototype.dispose);n.Gesture.prototype.dispose=function(){if(r.call(this),this.boundEvents_){for(var e of this.boundEvents_)n.browserEvents.unbind(e);this.boundEvents_.length=0}}}}},{blockly:175}],80:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.monkeyPatchGrid=void 0;let i=e("blockly");r.monkeyPatchGrid=function(){let e,t,o=null==(e=pxt.appTarget.appTheme.blocklyOptions)?void 0:e.grid;if(null!=(t=null==o?void 0:o.image)&&t.path){let s=[],a=(i.Grid.createDom=function(e,t,r,n){e="blocklyGridPattern"+e,r=i.utils.dom.createSvgElement(i.utils.Svg.PATTERN,{id:e,patternUnits:"userSpaceOnUse",width:o.image.width,height:o.image.height},r);return s.push(e),i.utils.dom.createSvgElement(i.utils.Svg.IMAGE,{width:o.image.width,height:o.image.height,opacity:o.image.opacity},r).setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o.image.path),n&&n.style.setProperty("--blocklyGridPattern",`url(#${r.id})`),r},i.Grid.prototype.update);i.Grid.prototype.update=function(e){a.call(this,e);var t,r,n=[];for(t of s){var i=document.getElementById(t);i?(i.setAttribute("width",o.image.width),i.setAttribute("height",o.image.height),i.setAttribute("patternTransform","scale("+e+")")):n.push(t)}for(r of n)s.splice(s.indexOf(r),1)}}}},{blockly:175}],81:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.applyMonkeyPatches=void 0;let n=e("./blockSvg"),i=e("./gesture"),s=e("./grid");r.applyMonkeyPatches=function(){(0,n.monkeyPatchBlockSvg)(),(0,s.monkeyPatchGrid)(),(0,i.monkeyPatchGesture)()}},{"./blockSvg":78,"./gesture":79,"./grid":80}],82:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});let g=e("blockly"),f=e("../functions/constants"),n=e("../../fields/field_imagenotext");g.Blocks.lists_create_with=Object.assign(Object.assign({},{valueConnections_:[],horizontalAfter_:3,itemCount_:3,mutationToDom:function(){var e=g.utils.xml.createElement("mutation");return e.setAttribute("items",this.itemCount_+""),this.horizontalAfter_&&e.setAttribute("horizontalafter",this.horizontalAfter_+""),e},domToMutation:function(e){this.itemCount_=parseInt(e.getAttribute("items"),10);e=e.getAttribute("horizontalafter");e&&(this.horizontalAfter_=parseInt(e,10)),this.updateShape_()},storeConnections_:function(){this.valueConnections_=[];for(let e=0;e<this.itemCount_;e++)this.valueConnections_.push(this.getInput("ADD"+e).connection.targetConnection)},restoreConnections_:function(){var t;for(let e=0;e<this.itemCount_;e++)null!=(t=this.valueConnections_[e])&&t.reconnect(this,"ADD"+e)},addItem_:function(){this.storeConnections_();if(this.update_(()=>{this.itemCount_++}),this.restoreConnections_(),1<this.itemCount_){var e=this.getInput("ADD0");if(e&&e.connection.targetConnection){var t=this.getInput("ADD"+(this.itemCount_-1)),r=e.connection.getShadowDom(),n=r&&r.getAttribute("type");if(n){var i=m("shadow",n),s=p(r,"value");for(let e=0;e<s.length;e++){var a=s[e],o=a.getAttribute("name"),a=p(a,"shadow")[0];h(i,o,a&&a.getAttribute("type"))}t.connection.setShadowDom(i)}var r=e.connection.targetConnection,l=r&&r.getSourceBlock(),e=l&&l.type;if(e&&e!==n){var c=m("block",e);if(l)if(e===f.FUNCTION_CALL_OUTPUT_BLOCK_TYPE){r=g.utils.xml.createElement("mutation");r.setAttribute("name",l.getName()),c.appendChild(r)}else if(l.inputList)for(let e=0;e<l.inputList.length;e++){var u=l.inputList[e],d=u.connection&&u.connection.getShadowDom(),d=d&&d.getAttribute("type");h(c,u.name,d)}n=g.Xml.domToBlock(c,this.workspace);t.connection.connect(n.outputConnection)}else t.connection.setShadowDom(t.connection.getShadowDom())}}function p(t,r){var n=[];if(t&&t.children)for(let e=0;e<t.children.length;e++){var i=t.children[e];i.tagName===r&&n.push(i)}return n}function h(e,t,r){var n;t&&r&&((n=g.utils.xml.createElement("value")).setAttribute("name",t),n.appendChild(m("shadow",r)),e.appendChild(n))}function m(e,t){e=g.utils.xml.createElement(e);return e.setAttribute("type",t),e.setAttribute("id",g.utils.idGenerator.genUid()),e}},removeItem_:function(){this.storeConnections_();this.update_(()=>{this.itemCount_--}),this.restoreConnections_()},update_:function(e){g.Events.setGroup(!0);let t=this;var r=t.mutationToDom(),r=r&&g.Xml.domToText(r);e&&e.call(this),this.updateShape_(),t instanceof g.BlockSvg&&t.initSvg();let n=g.Events.getGroup();e=t.mutationToDom(),e=e&&g.Xml.domToText(e);r!=e&&(g.Events.fire(new g.Events.BlockChange(t,"mutation",null,r,e)),setTimeout(function(){g.Events.setGroup(n),t.bumpNeighbours(),g.Events.setGroup(!1)},g.config.bumpDelay)),t.rendered&&t instanceof g.BlockSvg&&t.queueRender(),g.Events.setGroup(!1)},updateShape_:function(){var e=()=>{this.removeItem_()};this.itemCount_?(this.getInput("EMPTY")&&this.removeInput("EMPTY"),this.getInput("TITLE")||this.appendDummyInput("TITLE").appendField(g.Msg.LISTS_CREATE_WITH_INPUT_WITH)):(this.getInput("TITLE")&&this.removeInput("TITLE"),this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(g.Msg.LISTS_CREATE_EMPTY_TITLE));let t=0;for(t=0;t<this.itemCount_;t++)this.getInput("ADD"+t)||this.appendValueInput("ADD"+t);for(;this.getInput("ADD"+t);)this.removeInput("ADD"+t),t++;this.getInput("BUTTONS")&&this.removeInput("BUTTONS");var r=this.appendDummyInput("BUTTONS"),e=(0<this.itemCount_&&r.appendField(new n.FieldImageNoText(this.REMOVE_IMAGE_DATAURI,24,24,"*",e,!1)),r.appendField(new n.FieldImageNoText(this.ADD_IMAGE_DATAURI,24,24,"*",()=>{this.addItem_()},!1)),this.itemCount_<=this.horizontalAfter_);this.setInputsInline(e),this.workspace instanceof g.WorkspaceSvg&&(r=this.workspace.getRenderer(),this.setOutputShape(e?r.getConstants().SHAPES.ROUND:r.getConstants().SHAPES.SQUARE))}}),{init:function(){var e;g.Extensions.apply("inline-svgs",this,!1),this.setHelpUrl(g.Msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.updateShape_(),this.setOutput(!0,"Array"),this.workspace instanceof g.WorkspaceSvg&&(e=this.workspace.getRenderer(),this.setOutputShape(e.getConstants().SHAPES.ROUND)),this.setInputsInline(!0),this.setTooltip(g.Msg.LISTS_CREATE_WITH_TOOLTIP)}})},{"../../fields/field_imagenotext":38,"../functions/constants":105,blockly:175}],83:[function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./createList"),r)},{"./createList":82}],84:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.CommentIcon=void 0;let n=e("blockly"),i=e("./textinput_bubble"),s=e("../../fields"),a=n.Events,o="~commentOffsetX",l="~commentOffsetY";class c extends n.icons.Icon{constructor(e){super(e),this.sourceBlock=e,this.textInputBubble=null,this.text="",this.bubbleSize=new n.utils.Size(160,80),this.bubbleVisiblity=!1}getType(){return c.TYPE}initView(e){this.svgRoot||(super.initView(e),n.utils.dom.createSvgElement(n.utils.Svg.PATH,{class:"blocklyIconShape",d:"m 2,2 0,9.2211 3.0026599,0 1.6008929,1.5989 1.8138195,-1.5989 6.6046683,0 0,-9.2211 -13.0220406,0 z",style:"fill: #fff;"},this.svgRoot),n.utils.dom.createSvgElement("rect",{class:"blocklyIconSymbol",x:"4",y:"8",height:"1",width:"6",style:"fill: #575E75;"},this.svgRoot),n.utils.dom.createSvgElement(n.utils.Svg.RECT,{class:"blocklyIconSymbol",x:"4",y:"6",height:"1",width:"6",style:"fill: #575E75;"},this.svgRoot),n.utils.dom.createSvgElement("rect",{class:"blocklyIconSymbol",x:"4",y:"4",height:"1",width:"8",style:"fill: #575E75;"},this.svgRoot),n.utils.dom.addClass(this.svgRoot,"blockly-icon-comment"))}dispose(){var e;super.dispose(),null!=(e=this.textInputBubble)&&e.dispose()}getWeight(){return c.WEIGHT}getSize(){return new n.utils.Size(17,17)}applyColour(){super.applyColour();var e,t=this.sourceBlock.style.colourPrimary,r=this.sourceBlock.style.colourTertiary;null!=(e=this.textInputBubble)&&e.setColour(t,r)}async updateEditable(){super.updateEditable(),this.bubbleIsVisible()&&(await this.setBubbleVisible(!1),await this.setBubbleVisible(!0))}onLocationChange(e){super.onLocationChange(e);var t,e=this.getAnchorLocation();null!=(t=this.textInputBubble)&&t.setAnchorLocation(e)}setText(e){this.text||e||this.clearSavedOffsetData();var t=this.text;a.fire(new(a.get(a.BLOCK_CHANGE))(this.sourceBlock,"comment",null,t,e)),this.text=e,null!=(t=this.textInputBubble)&&t.setText(this.text)}getText(){return this.text}setBubbleSize(e){this.bubbleSize=e,null!=(e=this.textInputBubble)&&e.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}saveState(){return this.text?{text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width}:null}loadState(e){var t;this.text=null!=(t=e.text)?t:"",this.bubbleSize=new n.utils.Size(null!=(t=e.width)?t:160,null!=(t=e.height)?t:80),this.bubbleVisiblity=null!=(t=e.pinned)&&t,this.setBubbleVisible(this.bubbleVisiblity)}setBubbleLocation(e){}getBubbleLocation(){var e;return!this.bubbleIsVisible()||null==(e=this.textInputBubble)?void 0:e.getRelativeToSurfaceXY()}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){var e;this.textInputBubble&&(e=this.textInputBubble.getText(),this.text!==e)&&(a.fire(new(a.get(a.BLOCK_CHANGE))(this.sourceBlock,"comment",null,this.text,e)),this.text=e)}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}onPositionChange(){var e;this.textInputBubble&&(e=this.textInputBubble.getPositionRelativeToAnchor(),(0,s.setBlockDataForField)(this.sourceBlock,o,e.x+""),(0,s.setBlockDataForField)(this.sourceBlock,l,e.y+""))}bubbleIsVisible(){return this.bubbleVisiblity}async setBubbleVisible(e){this.bubbleVisiblity===e||e&&this.textInputBubble||(e||this.textInputBubble)&&(this.bubbleVisiblity=e,!this.sourceBlock.rendered||this.sourceBlock.isInFlyout||this.sourceBlock.isInsertionMarker()||(await n.renderManagement.finishQueuedRenders(),!this.sourceBlock.rendered)||this.sourceBlock.isInFlyout||this.sourceBlock.isInsertionMarker()||(e?(this.sourceBlock.isEditable()?this.showEditableBubble():this.showNonEditableBubble(),this.applyColour()):this.hideBubble(),this.sourceBlock.isEditable()&&a.fire(new(a.get(a.BUBBLE_OPEN))(this.sourceBlock,e,"comment"))))}getBubble(){return this.textInputBubble}showEditableBubble(){var e=this.getSavedOffsetData();this.textInputBubble=new i.TextInputBubble(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.textInputBubble.addTextChangeListener(()=>this.onTextChange()),this.textInputBubble.addSizeChangeListener(()=>this.onSizeChange()),this.textInputBubble.addPositionChangeListener(()=>this.onPositionChange()),this.textInputBubble.setDeleteHandler(()=>{this.setBubbleVisible(!1),this.sourceBlock.setCommentText(null),this.clearSavedOffsetData()}),this.textInputBubble.setCollapseHandler(()=>{this.setBubbleVisible(!1)}),e&&this.textInputBubble.setPositionRelativeToAnchor(e.x,e.y),n.getFocusManager().focusNode(this.textInputBubble)}showNonEditableBubble(){var e=this.getSavedOffsetData();this.textInputBubble=new i.TextInputBubble(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect(),!0),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.textInputBubble.setCollapseHandler(()=>{this.setBubbleVisible(!1)}),e&&this.textInputBubble.setPositionRelativeToAnchor(e.x,e.y),n.getFocusManager().focusNode(this.textInputBubble)}hideBubble(){var e;null!=(e=this.textInputBubble)&&e.dispose(),this.textInputBubble=null,n.getFocusManager().focusNode(this.getSourceBlock())}getAnchorLocation(){return n.utils.Coordinate.sum(this.workspaceLocation,new n.utils.Coordinate(8.5,8.5))}getBubbleOwnerRect(){var e=this.sourceBlock.getSvgRoot().getBBox();return new n.utils.Rect(e.y,e.y+e.height,e.x,e.x+e.width)}getSavedOffsetData(){var e=(0,s.getBlockDataForField)(this.sourceBlock,o),t=(0,s.getBlockDataForField)(this.sourceBlock,l);return e&&t?new n.utils.Coordinate(parseFloat(e),parseFloat(t)):new n.utils.Coordinate(16,16)}clearSavedOffsetData(){(0,s.deleteBlockDataForField)(this.sourceBlock,o),(0,s.deleteBlockDataForField)(this.sourceBlock,l)}}(r.CommentIcon=c).TYPE=n.icons.IconType.COMMENT,c.WEIGHT=3,n.icons.registry.unregister(c.TYPE.toString()),n.icons.registry.register(c.TYPE,c)},{"../../fields":70,"./textinput_bubble":87,blockly:175}],85:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Bubble=void 0;let l=e("blockly");var i=l.utils.dom;class s{constructor(e,t,r,n){this.workspace=e,this.anchor=t,this.ownerRect=r,this.size=new l.utils.Size(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeTop=0,this.relativeLeft=0,this.dragStrategy=new l.dragging.BubbleDragStrategy(this,this.workspace),this.id=l.utils.idGenerator.getNextUniqueId(),this.svgRoot=i.createSvgElement(l.utils.Svg.G,{class:"blocklyBubble"},e.getBubbleCanvas());t=i.createSvgElement(l.utils.Svg.G,{},this.svgRoot);this.tail=i.createSvgElement(l.utils.Svg.LINE,{"stroke-width":"3","stroke-linecap":"round"},t),this.background=i.createSvgElement(l.utils.Svg.RECT,{class:"blocklyDraggable","stroke-width":"3",x:0,y:0},t),this.contentContainer=i.createSvgElement(l.utils.Svg.G,{},this.svgRoot),this.topBar=i.createSvgElement(l.utils.Svg.RECT,{class:"blocklyCommentTopbarBackground",x:s.BORDER_WIDTH,y:s.BORDER_WIDTH},t),this.deleteIcon=i.createSvgElement(l.utils.Svg.IMAGE,{class:"blocklyDeleteIcon",href:e.options.pathToMedia+"delete-icon.svg"},t),this.collapseIcon=i.createSvgElement(l.utils.Svg.IMAGE,{class:"blocklyFoldoutIcon",href:e.options.pathToMedia+"foldout-icon.svg"},t),this.focusableElement=null!=n?n:this.svgRoot,this.focusableElement.setAttribute("id",this.id),l.browserEvents.conditionalBind(this.background,"pointerdown",this,this.onMouseDown),l.browserEvents.conditionalBind(this.topBar,"pointerdown",this,this.onMouseDown),l.browserEvents.conditionalBind(this.collapseIcon,"pointerdown",this,this.onCollapseDown),l.browserEvents.conditionalBind(this.deleteIcon,"pointerdown",this,this.onDeleteDown)}dispose(){this.disposed||(i.removeNode(this.svgRoot),this.disposed=!0,this.isDragDelete&&this.deleteHandler&&this.deleteHandler())}setAnchorLocation(e,t=!1){this.anchor=e,t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(e,t){this.relativeLeft=e,this.relativeTop=t,this.positionRelativeToAnchor(),this.renderTail()}getPositionRelativeToAnchor(){return new l.utils.Coordinate(this.relativeLeft,this.relativeTop)}getSize(){return this.size}setSize(e,t=!1){var r=this.topBar.getBBox(),n=this.deleteIcon.getBBox(),i=this.collapseIcon.getBBox();e.width=Math.max(e.width,s.MIN_SIZE),e.height=Math.max(e.height,s.MIN_SIZE),this.size=e,this.background.setAttribute("width",""+e.width),this.background.setAttribute("height",""+e.height),this.topBar.setAttribute("width",""+(e.width-s.DOUBLE_BORDER)),this.updateDeleteIconPosition(e,r,n),this.updateFoldoutIconPosition(r,i),t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(e,t){this.colour=e,this.tail.setAttribute("stroke",t||e),this.background.setAttribute("fill",t||e),this.background.setAttribute("stroke",t||e),this.svgRoot.setAttribute("style","--commentBorderColour: "+e)}onMouseDown(e){var t;null!=(t=this.workspace.getGesture(e))&&t.handleBubbleStart(e,this),l.common.setSelected(this),l.getFocusManager().focusNode(this)}positionRelativeToAnchor(){let e=this.anchor.x;this.workspace.RTL?e-=this.relativeLeft+this.size.width:e+=this.relativeLeft;var t=this.relativeTop+this.anchor.y;this.moveTo(e,t)}moveTo(e,t){this.svgRoot.setAttribute("transform",`translate(${e}, ${t})`)}positionByRect(e=new l.utils.Rect(0,0,0,0)){var t=this.workspace.getMetricsManager().getViewMetrics(!0),r=this.getOptimalRelativeLeft(t),n=this.getOptimalRelativeTop(t),i={x:r,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},s={x:-this.size.width-30,y:n},n={x:e.getWidth(),y:n},r={x:r,y:e.getHeight()},a=e.getWidth()<e.getHeight()?n:r,e=e.getWidth()<e.getHeight()?r:n,r=this.getOverlap(i,t),n=this.getOverlap(s,t),o=this.getOverlap(a,t),t=this.getOverlap(e,t),t=Math.max(r,n,o,t);r===t?(this.relativeLeft=i.x,this.relativeTop=i.y):n===t?(this.relativeLeft=s.x,this.relativeTop=s.y):o===t?(this.relativeLeft=a.x,this.relativeTop=a.y):(this.relativeLeft=e.x,this.relativeTop=e.y),this.positionRelativeToAnchor()}getOverlap(e,t){var e={x:this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x+this.anchor.x,y:e.y+this.anchor.y},r={x:e.x+this.size.width,y:e.y+this.size.height},n={x:t.left,y:t.top},t={x:t.left+t.width,y:t.top+t.height},i=Math.min(r.x,t.x)-Math.max(e.x,n.x),r=Math.min(r.y,t.y)-Math.max(e.y,n.y);return Math.max(0,Math.min(1,i*r/(this.size.width*this.size.height)))}getOptimalRelativeLeft(e){let t=-this.size.width/4;var r,n;return this.size.width>e.width||(e=this.getWorkspaceViewRect(e),this.workspace.RTL?(r=this.anchor.x-t)-this.size.width<e.left?t=-(e.left-this.anchor.x+this.size.width):r>e.right&&(t=-(e.right-this.anchor.x)):(n=(r=t+this.anchor.x)+this.size.width,r<e.left?t=e.left-this.anchor.x:n>e.right&&(t=e.right-this.anchor.x-this.size.width))),t}getOptimalRelativeTop(e){let t=-this.size.height/4;var r,n;return this.size.height>e.height||(r=(n=this.anchor.y+t)+this.size.height,n<(n=this.getWorkspaceViewRect(e)).top?t=n.top-this.anchor.y:r>n.bottom&&(t=n.bottom-this.anchor.y-this.size.height)),t}getWorkspaceViewRect(e){var t=e.top,r=e.top+e.height;let n=e.left,i=e.left+e.width;return r-=this.getScrollbarThickness(),this.workspace.RTL?n-=this.getScrollbarThickness():i-=this.getScrollbarThickness(),new l.utils.Rect(t,r,n,i)}getScrollbarThickness(){return l.Scrollbar.scrollbarThickness/this.workspace.scale}renderTail(){var e=this.size.width/2,t=this.size.height/2,r=-this.relativeLeft,n=-this.relativeTop,i=Math.atan2(t-n,e-r);r+=s.ANCHOR_RADIUS*Math.cos(i),n+=s.ANCHOR_RADIUS*Math.sin(i),this.tail.setAttribute("x1",e+""),this.tail.setAttribute("y1",t+""),this.tail.setAttribute("x2",r+""),this.tail.setAttribute("y2",n+"")}bringToFront(){var e=null==(e=this.svgRoot)?void 0:e.parentNode;return!(!this.svgRoot||(null==e?void 0:e.lastChild)===this.svgRoot||(null!=e&&e.appendChild(this.svgRoot),0))}getRelativeToSurfaceXY(){return new l.utils.Coordinate(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(e){this.moveTo(e.x,e.y),this.workspace.RTL?this.relativeLeft=this.anchor.x-e.x-this.size.width:this.relativeLeft=e.x-this.anchor.x,this.relativeTop=e.y-this.anchor.y,this.renderTail()}setDragging(e){}setDeleteStyle(e){(this.isDragDelete=e)?i.addClass(this.getSvgRoot(),"blocklyDraggingDelete"):i.removeClass(this.getSvgRoot(),"blocklyDraggingDelete")}isDeletable(){return!1}showContextMenu(e){}isMovable(){return!0}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){l.common.fireSelectedEvent(this)}unselect(){l.common.fireSelectedEvent(null)}getFocusableElement(){return this.focusableElement}getFocusableTree(){return this.workspace}onNodeFocus(){this.select(),this.bringToFront()}onNodeBlur(){this.unselect()}canBeFocused(){return!0}contentTop(){var e=this.topBar.getBBox();return s.BORDER_WIDTH+e.height}setDeleteHandler(e){this.deleteHandler=e}setCollapseHandler(e){this.collapseHandler=e}onDeleteDown(e){l.browserEvents.isRightButton(e)||this.deleteHandler&&(e.preventDefault(),this.deleteHandler()),e.stopPropagation()}onCollapseDown(e){l.browserEvents.isRightButton(e)||this.collapseHandler&&(e.preventDefault(),this.collapseHandler()),e.stopPropagation()}updateDeleteIconPosition(e,t,r){t=this.calcDeleteMargin(t,r);this.deleteIcon.setAttribute("y",""+t),this.deleteIcon.setAttribute("x",""+(e.width-r.width-t))}updateFoldoutIconPosition(e,t){e=this.calcFoldoutMargin(e,t);this.collapseIcon.setAttribute("y",""+e),this.collapseIcon.setAttribute("x",""+e)}calcDeleteMargin(e,t){return(e.height-t.height)/2+s.BORDER_WIDTH}calcFoldoutMargin(e,t){return(e.height-t.height)/2+s.BORDER_WIDTH}}(e=r.Bubble=s).BORDER_WIDTH=0,s.DOUBLE_BORDER=2*e.BORDER_WIDTH,s.MIN_SIZE=e.DOUBLE_BORDER,s.ANCHOR_RADIUS=8,l.Css.register(`
.blocklyBubble .blocklyDeleteIcon, .blocklyBubble .blocklyFoldoutIcon {
    filter: grayscale(100%) brightness(100000);
}

.blocklyBubble .blocklyTextarea.blocklyText {
    color: #575E75;
}
`)},{blockly:175}],86:[function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./blockComment"),r)},{"./blockComment":84}],87:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.TextInputBubble=void 0;let i=e("./bubble.js"),s=e("blockly");var a=s.utils.dom,o=s.browserEvents;class l extends i.Bubble{constructor(e,t,r,n){super(e,t,r,l.createTextArea()),this.workspace=e,this.anchor=t,this.ownerRect=r,this.readOnly=n,this.resizePointerUpListener=null,this.resizePointerMoveListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.positionChangeListeners=[],this.text="",this.DEFAULT_SIZE=new s.utils.Size(160+i.Bubble.DOUBLE_BORDER,80+i.Bubble.DOUBLE_BORDER),this.MIN_SIZE=new s.utils.Size(45+i.Bubble.DOUBLE_BORDER,20+i.Bubble.DOUBLE_BORDER),a.addClass(this.svgRoot,"blocklyTextInputBubble"),this.textArea=this.getFocusableElement(),this.inputRoot=this.createEditor(this.contentContainer,this.textArea),this.resizeGroup=this.createResizeHandle(this.svgRoot,e),this.setSize(this.DEFAULT_SIZE,!0),n&&(this.deleteIcon.style.display="none"),o.conditionalBind(this.textArea,"keydown",this,this.onKeyDown)}getText(){return this.text}moveTo(e,t){super.moveTo(e,t),this.onPositionChange()}setText(e){this.text=e,this.textArea.value=e,this.onTextChange()}addTextChangeListener(e){this.textChangeListeners.push(e)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}addPositionChangeListener(e){this.positionChangeListeners.push(e)}static createTextArea(){var e=document.createElementNS(a.HTML_NS,"textarea");return e.className="blocklyTextarea blocklyText",e}createEditor(e,t){let r=a.createSvgElement(s.utils.Svg.FOREIGNOBJECT,{x:i.Bubble.BORDER_WIDTH,y:this.contentTop()},e);setTimeout(()=>{r.setAttribute("y",this.contentTop()+"")});e=document.createElementNS(a.HTML_NS,"body");return e.setAttribute("xmlns",a.HTML_NS),e.className="blocklyMinimalBody",t.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),e.appendChild(t),r.appendChild(e),this.bindTextAreaEvents(t),r}bindTextAreaEvents(e){o.conditionalBind(e,"wheel",this,e=>{e.stopPropagation()}),o.conditionalBind(e,"pointerdown",this,e=>{e.stopPropagation(),s.Touch.clearTouchIdentifier()}),o.conditionalBind(e,"change",this,this.onTextChange)}createResizeHandle(e,t){t=a.createSvgElement(s.utils.Svg.IMAGE,{class:"blocklyResizeHandle",href:t.options.pathToMedia+"resize-handle.svg"},e);return o.conditionalBind(t,"pointerdown",this,this.onResizePointerDown),t}setSize(e,t=!1){e.width=Math.max(e.width,this.MIN_SIZE.width),e.height=Math.max(e.height,this.MIN_SIZE.height+this.contentTop());var r=e.width-i.Bubble.DOUBLE_BORDER,n=e.height-this.contentTop()-i.Bubble.BORDER_WIDTH,n=(this.inputRoot.setAttribute("width",""+r),this.inputRoot.setAttribute("height",""+n),this.textArea.style.width="100%",this.textArea.style.height="100%",this.resizeGroup.getBBox());this.workspace.RTL?this.resizeGroup.setAttribute("transform",`translate(${i.Bubble.BORDER_WIDTH}, ${e.height-i.Bubble.BORDER_WIDTH-n.height}) scale(-1 1)`):this.resizeGroup.setAttribute("transform",`translate(${r-n.width}, ${e.height-i.Bubble.BORDER_WIDTH-n.height})`),super.setSize(e,t),this.onSizeChange()}getSize(){return super.getSize()}isDeletable(){return!this.readOnly}onResizePointerDown(e){this.bringToFront(),o.isRightButton(e)||(this.workspace.startDrag(e,new s.utils.Coordinate(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=o.conditionalBind(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=o.conditionalBind(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation()}onResizePointerUp(e){s.Touch.clearTouchIdentifier(),this.resizePointerUpListener&&(o.unbind(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(o.unbind(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(e){e=this.workspace.moveDrag(e);this.setSize(new s.utils.Size(this.workspace.RTL?-e.x:e.x,e.y),!1),this.onSizeChange()}onTextChange(){this.text=this.textArea.value;for(var e of this.textChangeListeners)e()}onSizeChange(){for(var e of this.sizeChangeListeners)e()}onPositionChange(){for(var e of this.positionChangeListeners)e()}onKeyDown(e){"Escape"===e.key&&(this.collapseHandler(),e.stopPropagation())}}r.TextInputBubble=l,s.Css.register(`
.blocklyTextInputBubble .blocklyTextarea {
  background-color: var(--commentFillColour);
  border: 0;
  display: block;
  margin: 0;
  outline: 0;
  padding: 3px;
  resize: none;
  text-overflow: hidden;
}
`)},{"./bubble.js":85,blockly:175}],88:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.DuplicateOnDragConnectionChecker=void 0;let a=e("blockly"),i=e("./duplicateOnDrag"),s=e("../functions/utils"),o=[];o[a.ConnectionType.INPUT_VALUE]=a.ConnectionType.OUTPUT_VALUE,o[a.ConnectionType.OUTPUT_VALUE]=a.ConnectionType.INPUT_VALUE,o[a.ConnectionType.NEXT_STATEMENT]=a.ConnectionType.PREVIOUS_STATEMENT,o[a.ConnectionType.PREVIOUS_STATEMENT]=a.ConnectionType.NEXT_STATEMENT;class n extends a.ConnectionChecker{doDragChecks(e,t,r){var n;return!!super.doDragChecks(e,t,r)&&!((n=t.targetBlock())&&(0,i.shouldDuplicateOnDrag)(n)&&(!n.isShadow()||!(0,i.isAllowlistedShadow)(n))||!(0,s.doArgumentReporterDragChecks)(e,t,r))}doSafetyChecks(e,t){if(!e||!t)return a.Connection.REASON_TARGET_NULL;let r,n,i,s;return e.isSuperior()?(r=e.getSourceBlock(),n=t.getSourceBlock(),i=e,s=t):(n=e.getSourceBlock(),r=t.getSourceBlock(),s=e,i=t),r===n?a.Connection.REASON_SELF_CONNECTION:s.type!==o[i.type]?a.Connection.REASON_WRONG_TYPE:r.workspace!==n.workspace?a.Connection.REASON_DIFFERENT_WORKSPACES:s.type===a.ConnectionType.OUTPUT_VALUE&&n.previousConnection&&n.previousConnection.isConnected()||s.type===a.ConnectionType.PREVIOUS_STATEMENT&&n.outputConnection&&n.outputConnection.isConnected()?a.Connection.REASON_PREVIOUS_AND_OUTPUT:a.Connection.CAN_CONNECT}}r.DuplicateOnDragConnectionChecker=n},{"../functions/utils":114,"./duplicateOnDrag":90,blockly:175}],89:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.setDuplicateOnDragStrategy=r.DuplicateOnDragStrategy=void 0;let u=e("blockly"),d=e("./duplicateOnDrag");var n=u.Events,i=u.utils.Coordinate,s=u.utils.dom;class a{constructor(e){this.block=e,this.startParentConn=null,this.startChildConn=null,this.startLoc=null,this.connectionCandidate=null,this.connectionPreviewer=null,this.dragging=!1,this.originalEventGroup="",this.dragOffset=new i(0,0),this.workspace=e.workspace}isMovable(){var e;return this.block.isShadow()?null!=(e=null==(e=this.block.getParent())?void 0:e.isMovable())&&e:this.block.isOwnMovable()&&!this.block.isDeadOrDying()&&!this.workspace.options.readOnly&&!this.block.isInFlyout}startDrag(e){var t;this.block.isShadow()&&!(0,d.isAllowlistedShadow)(this.block)?this.startDraggingShadow(e):(this.dragging=!0,n.getGroup()||n.setGroup(!0),this.fireDragStartEvent(),this.startLoc=this.block.getRelativeToSurfaceXY(),t=u.registry.getClassFromOptions(u.registry.Type.CONNECTION_PREVIEWER,this.workspace.options),this.connectionPreviewer=new t(this.block),s.startTextWidthCache(),this.workspace.setResizesEnabled(!1),u.blockAnimations.disconnectUiStop(),t=!!e&&(e.altKey||e.ctrlKey||e.metaKey),this.shouldDisconnect(t)&&this.disconnectBlock(t),this.block.setDragging(!0),null!=(e=this.workspace.getLayerManager())&&e.moveToDragLayer(this.block))}startDraggingShadow(e){var t=this.block.getParent();if(!t)throw new Error("Tried to drag a shadow block with no parent. Shadow blocks should always have parents.");this.dragOffset=i.difference(t.getRelativeToSurfaceXY(),this.block.getRelativeToSurfaceXY()),t.startDrag(e)}shouldDisconnect(e){return!!(this.block.getParent()||e&&this.block.nextConnection&&this.block.nextConnection.targetBlock())}disconnectBlock(e){let t,r,n,i,s,a,o;var l=this.block.isShadow();if(l&&this.block.setShadow(!1),(0,d.shouldDuplicateOnDrag)(this.block)){var c=this.block.outputConnection;if(null==c||!c.targetConnection)return;o=u.Xml.blockToDom(this.block,!0),l||(s=u.Xml.domToBlock(o,this.block.workspace)),a=c.targetConnection}this.startParentConn=null!=(r=null==(t=this.block.outputConnection)?void 0:t.targetConnection)?r:null==(n=this.block.previousConnection)?void 0:n.targetConnection,e&&(this.startChildConn=null==(i=this.block.nextConnection)?void 0:i.targetConnection),a&&l&&a.setShadowDom(o),this.block.unplug(e),u.blockAnimations.disconnectUiEffect(this.block),(0,d.updateDuplicateOnDragState)(this.block),a&&s&&a.connect(s.outputConnection)}fireDragStartEvent(){var e=new(n.get(n.BLOCK_DRAG))(this.block,!0,this.block.getDescendants(!1));n.fire(e)}fireDragEndEvent(){var e=new(n.get(n.BLOCK_DRAG))(this.block,!1,this.block.getDescendants(!1));n.fire(e)}fireMoveEvent(){var e;this.block.isDeadOrDying()||((e=new(n.get(n.BLOCK_MOVE))(this.block)).setReason(["drag"]),e.oldCoordinate=this.startLoc,e.recordNew(),n.fire(e))}drag(e){var t;this.block.isShadow()?null!=(t=this.block.getParent())&&t.drag(i.sum(e,this.dragOffset)):(this.block.moveDuringDrag(e),this.updateConnectionPreview(this.block,i.difference(e,this.startLoc)))}updateConnectionPreview(e,t){var r,n=this.connectionCandidate,i=this.getConnectionCandidate(e,t);i?(t=n&&this.currCandidateIsBetter(n,t,i)?n:i,{local:n,neighbour:i}=this.connectionCandidate=t,t=n.type===u.ConnectionType.OUTPUT_VALUE||n.type===u.ConnectionType.PREVIOUS_STATEMENT,r=i.isConnected()&&!i.targetBlock().isInsertionMarker(),t&&r&&!this.orphanCanConnectAtEnd(e,i.targetBlock(),n.type)?this.connectionPreviewer.previewReplacement(n,i,i.targetBlock()):this.connectionPreviewer.previewConnection(n,i)):(this.connectionPreviewer.hidePreview(),this.connectionCandidate=null)}orphanCanConnectAtEnd(e,t,r){r=r===u.ConnectionType.OUTPUT_VALUE?t.outputConnection:t.previousConnection;return!!u.Connection.getConnectionForOrphanedConnection(e,r)}currCandidateIsBetter(e,t,r){var{local:e,neighbour:n}=e,e=new i(e.x,e.y),n=new i(n.x,n.y),e=i.distance(i.sum(e,t),n);return r.distance>e-u.config.currentConnectionPreference}getConnectionCandidate(e,t){var r,e=this.getLocalConnections(e);let n=this.connectionCandidate?u.config.connectingSnapRadius:u.config.snapRadius,i=null;for(r of e){var{connection:s,radius:a}=r.closest(n,t);s&&(i={local:r,neighbour:s,distance:a},n=a)}return i}getLocalConnections(e){var t=e.getConnections_(!1),r=e.lastConnectionInStack(!0);return r&&r!==e.nextConnection&&t.push(r),t}endDrag(e){var t;this.block.isShadow()?null!=(t=this.block.getParent())&&t.endDrag(e):(this.originalEventGroup=n.getGroup(),this.fireDragEndEvent(),this.fireMoveEvent(),s.stopTextWidthCache(),u.blockAnimations.disconnectUiStop(),this.connectionPreviewer.hidePreview(),!this.block.isDeadOrDying()&&this.dragging&&(null!=(t=this.workspace.getLayerManager())&&t.moveOffDragLayer(this.block,u.layers.BLOCK),this.block.setDragging(!1)),this.connectionCandidate?(this.applyConnections(this.connectionCandidate),this.disposeStep()):this.block.queueRender().then(()=>this.disposeStep()))}disposeStep(){var e=n.getGroup();n.setGroup(this.originalEventGroup),this.block.snapToGrid(),this.connectionPreviewer.dispose(),this.workspace.setResizesEnabled(!0),n.setGroup(e)}applyConnections(e){var{local:e,neighbour:t}=e;e.connect(t);let r=e.isSuperior()?t:e,n=this.block.getRootBlock();u.renderManagement.finishQueuedRenders().then(()=>{u.blockAnimations.connectionUiEffect(r.getSourceBlock()),setTimeout(()=>{n.bringToFront()},0)})}revertDrag(){var e;if(this.block.isShadow())null!=(e=this.block.getParent())&&e.revertDrag();else{if(null!=(e=this.startChildConn)&&e.connect(this.block.nextConnection),this.startParentConn)switch(this.startParentConn.type){case u.ConnectionType.INPUT_VALUE:this.startParentConn.connect(this.block.outputConnection);break;case u.ConnectionType.NEXT_STATEMENT:this.startParentConn.connect(this.block.previousConnection)}else this.block.moveTo(this.startLoc,["drag"]),null!=(e=this.workspace.getLayerManager())&&e.moveOffDragLayer(this.block,50),u.bumpObjects.bumpIntoBounds(this.workspace,this.workspace.getMetricsManager().getScrollMetrics(!0),this.block);this.startChildConn=null,this.startParentConn=null,this.connectionPreviewer.hidePreview(),this.connectionCandidate=null,this.block.setDragging(!1),this.dragging=!1}}}r.DuplicateOnDragStrategy=a,r.setDuplicateOnDragStrategy=function(e){var t;null!=(t=e.setDragStrategy)&&t.call(e,new a(e))}},{"./duplicateOnDrag":90,blockly:175}],90:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.updateDuplicateOnDragState=r.shouldDuplicateOnDrag=r.isAllowlistedShadow=r.setDuplicateOnDrag=r.setDraggableShadowBlocks=void 0;let n,s;function a(e){return!(!n||-1===n.indexOf(e.type))}function i(e){var r,n,i;if(e.isShadow()&&a(e))return!0;if(s){let t=null==(r=e.outputConnection)?void 0:r.targetBlock();if(t)for(i of s.filter(e=>e.parentBlockType===t.type))if(i&&(!i.childBlockType||i.childBlockType===e.type)){if(!i.inputName)return!0;if((null==(n=e.outputConnection.targetConnection.getParentInput())?void 0:n.name)===i.inputName)return!0}}return!1}r.setDraggableShadowBlocks=function(e){n=e},r.setDuplicateOnDrag=function(t,r,n){(s=s||[]).some(e=>e.parentBlockType===t&&e.inputName===r&&e.childBlockType===n)||s.push({parentBlockType:t,inputName:r,childBlockType:n})},r.isAllowlistedShadow=a,r.shouldDuplicateOnDrag=i,r.updateDuplicateOnDragState=function(t){setTimeout(()=>{var e=i(t);t.pathObject&&t.pathObject.setHasDottedOutlineOnHover(e),t.setDeletable(!e)})}},{}],91:[function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./duplicateOnDrag"),r),i(e("./variablesGetReporter"),r),i(e("./connectionChecker"),r),i(e("./dragStrategy"),r)},{"./connectionChecker":88,"./dragStrategy":89,"./duplicateOnDrag":90,"./variablesGetReporter":92}],92:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});let n=e("blockly"),i=e("./duplicateOnDrag");n.Blocks.variables_get_reporter={init:function(){this.jsonInit({type:"variables_get_reporter",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}",variableTypes:[""]}],output:null,colour:"%{BKY_VARIABLES_HUE}",outputShape:(new n.zelos.ConstantProvider).SHAPES.ROUND,helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableReporter"]}),(0,i.updateDuplicateOnDragState)(this)}}},{"./duplicateOnDrag":90,blockly:175}],93:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MultiFlyoutRecyclableBlockInflater=i.HIDDEN_CLASS_NAME=void 0;let s=e("blockly");i.HIDDEN_CLASS_NAME="pxtFlyoutHidden";class r extends s.BlockFlyoutInflater{constructor(){super(...arguments),this.keyToBlock=new Map,this.blockToKey=new Map}static register(){s.registry.register(s.registry.Type.FLYOUT_INFLATER,"block",r,!0)}isBlockRecycleable(e){switch(e.type){case"variables_get":case"variables_set":case"variables_change":return!1}return!0}createBlock(e,t){var r=(e=>e.blockxml?"string"==typeof e.blockxml?e.blockxml:s.Xml.domToText(e.blockxml):e.type)(e);if(!r)return super.createBlock(e,t);let n;return this.keyToBlock.has(r)&&(n=this.keyToBlock.get(r),this.keyToBlock.delete(r)),n=null!=n?n:super.createBlock(e,t),this.blockToKey.set(n,r),n.removeClass(i.HIDDEN_CLASS_NAME),n.setDisabledReason(!1,i.HIDDEN_CLASS_NAME),n}disposeItem(e){var t=e.getElement();if(t instanceof s.BlockSvg&&this.blockToKey.has(t)){if(this.isBlockRecycleable(t))return void this.recycleBlock(t);this.blockToKey.delete(t)}super.disposeItem(e)}clearCache(){this.blockToKey=new Map,this.keyToBlock=new Map}recycleBlock(e){var t=e.getRelativeToSurfaceXY(),t=(e.moveBy(-t.x,-t.y),e.addClass(i.HIDDEN_CLASS_NAME),e.setDisabledReason(!0,i.HIDDEN_CLASS_NAME),this.blockToKey.get(e));this.keyToBlock.set(t,e),this.removeListeners(e.id)}}i.MultiFlyoutRecyclableBlockInflater=r,s.Css.register(`
.${i.HIDDEN_CLASS_NAME} {
    display: none;
}
`)},{blockly:175}],94:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ButtonFlyoutInflater=void 0;let n=e("blockly"),i=e("./flyoutButton");class s extends n.ButtonFlyoutInflater{static register(){n.registry.register(n.registry.Type.FLYOUT_INFLATER,"button",s,!0)}load(e,t){t=new i.FlyoutButton(t.getWorkspace(),t.targetWorkspace,e,!1);return e.id&&t.getSvgRoot().setAttribute("id",e.id),t.show(),new n.FlyoutItem(t,"button")}}r.ButtonFlyoutInflater=s},{"./flyoutButton":96,blockly:175}],95:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.CachingFlyout=void 0;var n=e("blockly");let i=e("./blockInflater");class s extends n.VerticalFlyout{constructor(){super(...arguments),this.forceOpen=!1}clearBlockCache(){var e=this.getInflaterForType("block");e instanceof i.MultiFlyoutRecyclableBlockInflater&&e.clearCache()}getFlyoutElement(){return this.svgGroup_}setForceOpen(e){this.forceOpen=e}}r.CachingFlyout=s},{"./blockInflater":93,blockly:175}],96:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FlyoutButton=void 0;let d=e("blockly"),p={"":"usb","":"accessible-icon","":"adn","":"pied-piper-pp","":"steam","":"bluetooth-b","":"rebel","":"maxcdn","":"joomla","":"sellsy","":"connectdevelop","":"github-alt"};class n extends d.FlyoutButton{constructor(e,t,r,n){super(e,t,r,n);var i=this.getSvgRoot();if(n){var e=r,t=(e["web-class"]&&i.classList.add(e["web-class"]),e["web-icon"]),n=e["web-icon-class"],r=e["web-icon-color"];if(t||n){var s=Object.keys(p).includes(t)?"brandIcon":"",a=d.utils.dom.createSvgElement("text",{class:"blocklyFlyoutLabelIcon"+(n?" "+n:"")+(s?" "+s:""),x:0,y:0,"text-anchor":"start"},i),n=(t&&(a.textContent=t),r&&a.setAttribute("style","fill: "+r),this.getTargetWorkspace()),o=(a.setAttribute("dominant-baseline","central"),a.setAttribute("dy","0"),a.setAttribute("x",(n.RTL?this.width+d.FlyoutButton.TEXT_MARGIN_X:0)+""),a.setAttribute("y",this.height/2+d.FlyoutButton.TEXT_MARGIN_Y+""),d.utils.dom.getTextWidth(a)+2*d.FlyoutButton.TEXT_MARGIN_X),l=(this.width+=o,i.getElementsByClassName("blocklyFlyoutLabelBackground").item(0));l.setAttribute("width",String(this.width));for(let e=0;e<i.children.length;e++){var c,u=i.children.item(e);u!==a&&u!==l&&(c=Number(u.getAttribute("x")),u.setAttribute("x",c+o+""))}}var s=e["web-line"],t=e["web-line-width"];s&&((r=d.utils.dom.createSvgElement("line",{class:"blocklyFlyoutLine","stroke-dasharray":s,"text-anchor":"middle"},i)).setAttribute("x1","0"),r.setAttribute("x2",null!=t?t:this.width+""),r.setAttribute("y1",this.height+10+""),r.setAttribute("y2",this.height+10+""))}else n=this.height,this.width+=2*(17.5-d.FlyoutButton.TEXT_MARGIN_X),this.height+=2*(14-d.FlyoutButton.TEXT_MARGIN_Y),e=i.getElementsByClassName("blocklyFlyoutButtonShadow").item(0),s=i.getElementsByClassName("blocklyFlyoutButtonBackground").item(0),t=i.getElementsByTagName("text").item(0),e.setAttribute("width",String(this.width)),e.setAttribute("height",String(this.height)),s.setAttribute("width",String(this.width)),s.setAttribute("height",String(this.height)),t.setAttribute("x",String(this.width/2)),t.setAttribute("y",String(parseFloat(t.getAttribute("y"))-n/2+this.height/2))}isDisposed(){return null===this.getSvgRoot().parentNode}}r.FlyoutButton=n},{blockly:175}],97:[function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),r.registerFlyoutInflaters=r.MultiFlyoutRecyclableBlockInflater=r.LabelFlyoutInflater=r.ButtonFlyoutInflater=void 0;let s=e("./buttonFlyoutInflater"),a=(Object.defineProperty(r,"ButtonFlyoutInflater",{enumerable:!0,get:function(){return s.ButtonFlyoutInflater}}),e("./labelFlyoutInflater")),o=(Object.defineProperty(r,"LabelFlyoutInflater",{enumerable:!0,get:function(){return a.LabelFlyoutInflater}}),e("./blockInflater"));Object.defineProperty(r,"MultiFlyoutRecyclableBlockInflater",{enumerable:!0,get:function(){return o.MultiFlyoutRecyclableBlockInflater}}),i(e("./cachingFlyout"),r),r.registerFlyoutInflaters=function(){s.ButtonFlyoutInflater.register(),a.LabelFlyoutInflater.register(),o.MultiFlyoutRecyclableBlockInflater.register()}},{"./blockInflater":93,"./buttonFlyoutInflater":94,"./cachingFlyout":95,"./labelFlyoutInflater":98}],98:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.LabelFlyoutInflater=void 0;let n=e("blockly"),i=e("./flyoutButton");class s extends n.LabelFlyoutInflater{static register(){n.registry.register(n.registry.Type.FLYOUT_INFLATER,"label",s,!0)}load(e,t){t=new i.FlyoutButton(t.getWorkspace(),t.targetWorkspace,e,!0);return t.show(),new n.FlyoutItem(t,"label")}}r.LabelFlyoutInflater=s},{"./flyoutButton":96,blockly:175}],99:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});let n=e("blockly");r=e("../constants"),e={typeName_:"",getTypeName(){return this.typeName_},removeFieldCallback(e){var t=this.getParent();null!=t&&t.removeFieldCallback&&t.removeFieldCallback(e)}};n.Blocks[r.ARGUMENT_EDITOR_BOOLEAN_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"bool"}],extensions:["output_boolean","text_field_color"]}),this.typeName_="boolean"}}),n.Blocks[r.ARGUMENT_EDITOR_STRING_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"text"}],extensions:["output_string","text_field_color"]}),this.typeName_="string"}}),n.Blocks[r.ARGUMENT_EDITOR_NUMBER_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"num"}],extensions:["output_number","text_field_color"]}),this.typeName_="number"}}),n.Blocks[r.ARGUMENT_EDITOR_ARRAY_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"list"}],extensions:["output_array","text_field_color"]}),this.typeName_="Array"}}),n.Blocks[r.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"arg"}],outputShape:(new n.zelos.ConstantProvider).SHAPES.ROUND,extensions:["text_field_color"]}),this.typeName_="any"},mutationToDom(){var e=n.utils.xml.createElement("mutation");return e.setAttribute("typename",this.typeName_),e},domToMutation(e){this.typeName_=e.getAttribute("typename"),this.setOutput(!0,this.typeName_)}})},{"../constants":105,blockly:175}],100:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.LOCALIZATION_NAME_MUTATION_KEY=void 0;let n=e("blockly");var i=e("../constants");let s=e("../msg"),a=e("../../duplicateOnDrag"),o=(r.LOCALIZATION_NAME_MUTATION_KEY="localizationname",{typeName_:"",localizationName_:"",getTypeName(){return this.typeName_},getLocalizationName(){return this.localizationName_||this.getFieldValue("VALUE")},mutationToDom(){var e=n.utils.xml.createElement("mutation");return this.localizationName_&&e.setAttribute(r.LOCALIZATION_NAME_MUTATION_KEY,this.localizationName_),e},domToMutation(e){e.hasAttribute(r.LOCALIZATION_NAME_MUTATION_KEY)&&(this.localizationName_=e.getAttribute(r.LOCALIZATION_NAME_MUTATION_KEY))}});function l(e){(0,a.setDuplicateOnDragStrategy)(e),(0,a.updateDuplicateOnDragState)(e)}n.Blocks[i.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE]=Object.assign(Object.assign({},o),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_reporter",name:"VALUE",text:""}],colour:n.Msg[s.MsgKey.REPORTERS_HUE],extensions:["output_boolean"]}),this.typeName_="boolean",l(this)}}),n.Blocks[i.ARGUMENT_REPORTER_STRING_BLOCK_TYPE]=Object.assign(Object.assign({},o),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_reporter",name:"VALUE",text:""}],colour:n.Msg[s.MsgKey.REPORTERS_HUE],extensions:["output_string"]}),this.typeName_="string",l(this)}}),n.Blocks[i.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE]=Object.assign(Object.assign({},o),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_reporter",name:"VALUE",text:""}],colour:n.Msg[s.MsgKey.REPORTERS_HUE],extensions:["output_number"]}),this.typeName_="number",l(this)}}),n.Blocks[i.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE]=Object.assign(Object.assign({},o),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_reporter",name:"VALUE",text:""}],colour:n.Msg[s.MsgKey.REPORTERS_HUE],extensions:["output_array"]}),this.typeName_="Array",l(this)}}),n.Blocks[i.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE]=Object.assign(Object.assign({},o),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_reporter",name:"VALUE",text:""}],colour:n.Msg[s.MsgKey.REPORTERS_HUE],inputsInline:!0,outputShape:(new n.zelos.ConstantProvider).SHAPES.ROUND,output:null}),this.typeName_="",l(this)},mutationToDom(){var e=o.mutationToDom.call(this);return e.setAttribute("typename",this.typeName_),e},domToMutation(e){this.typeName_=e.getAttribute("typename"),this.setOutput(!0,this.typeName_),o.domToMutation.call(this,e)}})},{"../../duplicateOnDrag":91,"../constants":105,"../msg":112,blockly:175}],101:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});let a=e("blockly");r=e("../commonFunctionMixin");let s=e("../constants"),o=e("../utils"),n=e("../msg");e=Object.assign(Object.assign({},r.COMMON_FUNCTION_MIXIN),{populateArgument_:function(t,r,n){let i=null,s=null;r&&t.id in r&&(e=r[t.id],i=e.block,s=e.shadow);var e=null==i?void 0:i.workspace.connectionChecker;a.Events.disable();try{if(i&&!i.isDisposed()&&r&&(null==e?void 0:e.canConnectWithReason(null==i?void 0:i.outputConnection,n.connection,!1))===a.Connection.CAN_CONNECT){i.outputConnection.connect(n.connection);let e;"variables_get"!==(e=i.isShadow()?a.Xml.blockToDom(i):s||this.buildShadowDom_(t.type)).getAttribute("type")&&n.connection.setShadowDom(e),delete r[n.name]}else this.attachShadow_(n,t.type)}finally{a.Events.enable()}},afterWorkspaceLoad:function(){var e,t;for(e of this.inputList)e.type===a.inputs.inputTypes.VALUE&&((t=null==(t=e.connection)?void 0:t.targetBlock())&&t.isShadow()&&t.getVarModels().length&&t.setShadow(!1),t=e.connection&&e.getShadowDom(),(0,o.isVariableBlockType)(null==t?void 0:t.getAttribute("type")))&&e.setShadowDom(null)},addFunctionLabel_:function(e){this.appendDummyInput("function_name").appendField(new a.FieldLabel(e,"functionNameText"),"function_name")},updateFunctionLabel_:function(e){this.getField("function_name").setValue(e)},attachShadow_(e,t){var t=(0,o.getShadowBlockInfoFromType_)(t,this.workspace),r=t[0],n=t[1],t=t[2];a.Events.disable();let i=null;try{(i=this.workspace.newBlock(r)).setFieldValue(t,n),i.setShadow("variables_get"!==r),!this.isInsertionMarker()&&i instanceof a.BlockSvg&&(i.initSvg(),i.queueRender())}finally{a.Events.enable()}i&&(i.setShadow(!0),i.outputConnection.connect(e.connection))},buildShadowDom_(e){var t=a.utils.xml.createElement("shadow"),e=(0,o.getShadowBlockInfoFromType_)(e,this.workspace),r=e[0],n=e[1],e=e[2],i="variables_get"===r,r=(t.setAttribute("type",r),a.utils.xml.createElement("field"));return r.textContent=e,i&&(r.setAttribute("id",e),i=this.workspace.getVariableMap().getVariableById(e),r.textContent=i?i.getName():""),r.setAttribute("name",n),t.appendChild(r),t},onchange(e){var t,r,n,i;this.workspace&&!this.workspace.isFlyout&&(e.type==a.Events.BLOCK_CREATE&&-1!=(null==(i=e.ids)?void 0:i.indexOf(this.id))?(i=this.getName(),(i=(0,o.getDefinition)(i,this.workspace))?(r=i.getArguments().slice(),t=this.arguments_.slice(),JSON.stringify(t)!==JSON.stringify(r)&&(0,o.mutateCallersAndDefinition)(i.getName(),this.workspace,i.mutationToDom()),this.functionId_=i.functionId_):(a.Events.setGroup(e.group),t=a.utils.xml.createElement("xml"),(r=a.utils.xml.createElement("block")).setAttribute("type",s.FUNCTION_DEFINITION_BLOCK_TYPE),n=(i=this.getRelativeToSurfaceXY()).x+a.config.snapRadius*(this.RTL?-1:1),i=i.y+2*a.config.snapRadius,r.setAttribute("x",n+""),r.setAttribute("y",i+""),n=this.mutationToDom(),r.appendChild(n),t.appendChild(r),a.Xml.domToWorkspace(t,this.workspace),a.Events.setGroup(!1))):e.type==a.Events.BLOCK_DELETE&&(i=this.getName(),(0,o.getDefinition)(i,this.workspace)||(a.Events.setGroup(e.group),this.dispose(!0),a.Events.setGroup(!1))))},serializeChangedInputs(e){var t,r,n,i=[],s=(0,o.getArgMap)(e,!0);for(t of this.arguments_)s[t.id]||((n=(r=this.getInput(t.id).connection).targetBlock()).isShadow()?i.push({inputName:t.id,connectedShadow:r.getShadowState(!0)}):i.push({inputName:t.id,connectedBlock:n.id}));return i}});a.Blocks[s.FUNCTION_CALL_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){this.jsonInit({extensions:["function_contextmenu_edit"]}),this.name_="",this.arguments_=[],this.functionId_="",this.setPreviousStatement(!0),this.setNextStatement(!0),this.setColour(a.Msg[n.MsgKey.PROCEDURES_HUE]),this.setHelpUrl(a.Msg[n.MsgKey.PROCEDURES_CALLNORETURN_HELPURL]),this.setTooltip(a.Msg[n.MsgKey.FUNCTION_CALL_TOOLTIP]),this.setInputsInline(!0)}}),a.Blocks[s.FUNCTION_CALL_OUTPUT_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){this.jsonInit({extensions:["function_contextmenu_edit"]}),this.name_="",this.arguments_=[],this.functionId_="",this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0,null),this.setOutputShape((new a.zelos.ConstantProvider).SHAPES.ROUND),this.setColour(a.Msg[n.MsgKey.PROCEDURES_HUE]),this.setHelpUrl(a.Msg[n.MsgKey.PROCEDURES_CALLNORETURN_HELPURL]),this.setTooltip(a.Msg[n.MsgKey.FUNCTION_CALL_TOOLTIP]),this.setInputsInline(!0)}})},{"../commonFunctionMixin":104,"../constants":105,"../msg":112,"../utils":114,blockly:175}],102:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.newFunctionMutation=void 0;let s=e("blockly");var n=e("../commonFunctionMixin");let i=e("../constants"),a=e("../utils"),o=e("../fields/fieldAutocapitalizeTextInput"),l=e("../functionManager"),c=e("../msg");e=Object.assign(Object.assign({},n.COMMON_FUNCTION_MIXIN),{populateArgument_:function(e,t,r){e=this.createArgumentEditor_(e.type,e.name);r.connection.connect(e.outputConnection)},addFunctionLabel_:function(e){e=new o.FieldAutocapitalizeTextInput(e||"",void 0,{spellcheck:!1,disableAutocapitalize:!0});this.appendDummyInput("function_name").appendField(e,"function_name")},updateFunctionLabel_:function(e){s.Events.disable(),this.getField("function_name").setValue(e),s.Events.enable()},createArgumentEditor_:function(t,r){s.Events.disable();let n;try{let e="";switch(t){case"boolean":e=i.ARGUMENT_EDITOR_BOOLEAN_BLOCK_TYPE;break;case"number":e=i.ARGUMENT_EDITOR_NUMBER_BLOCK_TYPE;break;case"string":e=i.ARGUMENT_EDITOR_STRING_BLOCK_TYPE;break;case"Array":e=i.ARGUMENT_EDITOR_ARRAY_BLOCK_TYPE;break;default:e=i.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE}(n=e==i.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE?(0,a.createCustomArgumentEditor)(t,this.workspace):this.workspace.newBlock(e)).setFieldValue(r,"TEXT"),n.setShadow(!0),!this.isInsertionMarker()&&n instanceof s.BlockSvg&&(n.initSvg(),n.queueRender())}finally{s.Events.enable()}return n},async focusLastEditorAsync_(){var e,t;await s.renderManagement.finishQueuedRenders(),0<this.inputList.length&&((t=this.inputList[this.inputList.length-2]).type==s.inputs.inputTypes.DUMMY?((e=this.workspace)instanceof s.WorkspaceSvg&&e.centerOnBlock(this.id,!0),t.fieldRow[0].showEditor()):t.type==s.inputs.inputTypes.VALUE&&((t=(e=t.connection.targetBlock()).workspace)instanceof s.WorkspaceSvg&&t.centerOnBlock(e.id,!0),e.getField("TEXT").showEditor()))},removeFieldCallback(t){let r=null;for(let e=0;e<this.inputList.length&&!r;e++){var n=this.inputList[e];if(n.connection){var i=n.connection.targetBlock();i&&i.getField(t.name)===t&&(r=n.name)}else for(let e=0;e<n.fieldRow.length;e++)n.fieldRow[e]==t&&(r=n.name)}r&&(s.WidgetDiv.hide(),this.removeInput(r),this.updateFunctionSignature(),this.updateDisplay_())},addParam_(e,t){s.WidgetDiv.hide();t=(0,a.findUniqueParamName)(t,this.arguments_.map(e=>e.name));this.arguments_.push({id:s.utils.idGenerator.genUid(),name:t,type:e}),this.updateDisplay_(),this.focusLastEditorAsync_()},addBooleanExternal(){this.addParam_("boolean",s.Msg[c.MsgKey.FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME])},addStringExternal(){this.addParam_("string",s.Msg[c.MsgKey.FUNCTIONS_DEFAULT_STRING_ARG_NAME])},addNumberExternal(){this.addParam_("number",s.Msg[c.MsgKey.FUNCTIONS_DEFAULT_NUMBER_ARG_NAME])},addArrayExternal(){this.addParam_("Array",s.Msg[c.MsgKey.FUNCTIONS_DEFAULT_ARRAY_ARG_NAME])},addCustomExternal(e){this.addParam_(e,l.FunctionManager.getInstance().getArgumentNameForType(e))},updateFunctionSignature(){this.arguments_=[];for(let e=1;e<this.inputList.length;e++){var t=this.inputList[e];switch(t.type){case s.inputs.inputTypes.STATEMENT:break;case s.inputs.inputTypes.DUMMY:this.name_=t.fieldRow[0].getValue()||t.fieldRow[0].getText();break;case s.inputs.inputTypes.VALUE:var r=t.connection.targetBlock();this.arguments_.push({id:t.name,name:r.getFieldValue("TEXT"),type:r.getTypeName()});break;default:pxt.warn("Unexpected input type on a function mutator root: "+t.type)}}}});r.newFunctionMutation=function(e){var e=(0,a.findLegalName)(s.Msg[c.MsgKey.FUNCTIONS_DEFAULT_FUNCTION_NAME],e),t=s.utils.xml.createElement("mutation");return t.setAttribute("name",e),t.setAttribute("functionid",s.utils.idGenerator.genUid()),t},s.Blocks[i.FUNCTION_DECLARATION_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){this.jsonInit({style:{hat:"cap"}}),this.name_="",this.arguments_=[],this.functionId_="",this.createAllInputs_(),this.setColour(s.Msg[c.MsgKey.PROCEDURES_HUE]),this.setStatements_(!0),this.setDeletable(!1),this.setMovable(!1),this.contextMenu=!1,this.setInputsInline(!0)}})},{"../commonFunctionMixin":104,"../constants":105,"../fields/fieldAutocapitalizeTextInput":109,"../functionManager":110,"../msg":112,"../utils":114,blockly:175}],103:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});let n=e("blockly");r=e("../commonFunctionMixin");let i=e("../constants"),s=e("../utils"),a=e("../fields/fieldAutocapitalizeTextInput"),o=e("../msg"),l=e("../functionManager"),c=e("../svgs");var u=e("../../duplicateOnDrag");let d=e("../../../fields/field_imagenotext");e=Object.assign(Object.assign({},r.COMMON_FUNCTION_MIXIN),{populateArgument_:function(e,t,r){let n=null;var i;null!=t&&t[e.id]&&(i=t[e.id],n=i.block);let s;t&&n&&!n.isDisposed()?((s=n).setFieldValue(e.name,"VALUE"),delete t[r.name]):s=this.createArgumentReporter_(e),r.connection.connect(s.outputConnection)},afterWorkspaceLoad:function(){for(let t of this.inputList)if(t.type===n.inputs.inputTypes.VALUE){var r=this.arguments_.find(e=>e.id===t.name);if(r){let e=t.connection.targetBlock();e||(this.populateArgument_(r,null,t),e=t.connection.targetBlock()),e.setFieldValue(r.name,"VALUE"),e.isShadow()&&e.setShadow(!1),t.setShadowDom(null)}}},addFunctionLabel_:function(e){e=new a.FieldAutocapitalizeTextInput(e||"",s.rename,{spellcheck:!1,disableAutocapitalize:!0});this.appendDummyInput("function_name").appendField(e,"function_name")},updateFunctionLabel_:function(e){n.Events.disable(),this.getField("function_name").setValue(e),n.Events.enable()},createArgumentReporter_:function(e){let t="";switch(e.type){case"boolean":t=i.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE;break;case"number":t=i.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE;break;case"string":t=i.ARGUMENT_REPORTER_STRING_BLOCK_TYPE;break;case"Array":t=i.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE;break;default:t=i.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE}n.Events.disable();let r;try{(r=t==i.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE?(0,s.createCustomArgumentReporter)(e.type,this.workspace):this.workspace.newBlock(t)).setFieldValue(e.name,"VALUE"),r.setShadow(!0),!this.isInsertionMarker()&&r instanceof n.BlockSvg&&(r.initSvg(),r.queueRender())}finally{n.Events.enable()}return r},customContextMenu:function(e){var t;this.isInFlyout||null!=(t=null==(t=this.workspace)?void 0:t.options)&&t.readOnly||(e.push(this.makeEditOption()),e.push(this.makeCallOption()))},makeEditOption:function(){var e;return{enabled:!(null!=(e=null==(e=this.workspace)?void 0:e.options)&&e.readOnly),text:n.Msg.FUNCTIONS_EDIT_OPTION,callback:()=>{var e,t=this;t.type!=i.FUNCTION_CALL_BLOCK_TYPE&&t.type!=i.FUNCTION_CALL_OUTPUT_BLOCK_TYPE||(e=t.workspace,t=(0,s.getDefinition)(t.getName(),e)),n.hideChaff(),n.getSelected()&&n.getSelected().unselect(),l.FunctionManager.getInstance().editFunctionExternal(t.mutationToDom(),e=>{e&&((0,s.mutateCallersAndDefinition)(t.getName(),t.workspace,e),t.updateDisplay_()),setTimeout(()=>{t.afterWorkspaceLoad&&t.afterWorkspaceLoad()})})}}},makeCallOption:function(){var e=this.getName(),t=n.utils.xml.createElement("mutation"),r=(t.setAttribute("name",e),n.utils.xml.createElement("block"));return r.appendChild(t),r.setAttribute("type",i.FUNCTION_CALL_BLOCK_TYPE),{enabled:0<this.workspace.remainingCapacity()&&!(null!=(t=null==(t=this.workspace)?void 0:t.options)&&t.readOnly),text:n.Msg.FUNCTIONS_CREATE_CALL_OPTION.replace("%1",e),callback:n.ContextMenu.callbackFactory(this,r)}}});n.Blocks[i.FUNCTION_DEFINITION_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){var e;this.jsonInit({style:{hat:"cap"}}),this.name_="",this.arguments_=[],this.functionId_="",this.createAllInputs_(),this.setColour(n.Msg[o.MsgKey.PROCEDURES_HUE]),this.setTooltip(n.Msg[o.MsgKey.PROCEDURES_DEFNORETURN_TOOLTIP]),this.setHelpUrl(n.Msg[o.MsgKey.PROCEDURES_DEFNORETURN_HELPURL]),this.setStatements_(!0),this.setInputsInline(!0),this.workspace.options.collapse&&(e=c.COLLAPSE_IMAGE_DATAURI,this.appendDummyInput("function_collapse").appendField(new d.FieldImageNoText(e,24,24,"",()=>{this.setCollapsed(!0)},!1)))}}),(0,u.setDuplicateOnDrag)(i.FUNCTION_DEFINITION_BLOCK_TYPE)},{"../../../fields/field_imagenotext":38,"../../duplicateOnDrag":91,"../commonFunctionMixin":104,"../constants":105,"../fields/fieldAutocapitalizeTextInput":109,"../functionManager":110,"../msg":112,"../svgs":113,"../utils":114,blockly:175}],104:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.COMMON_FUNCTION_MIXIN=void 0;let s=e("blockly"),a=e("./constants"),o=e("./utils"),n=e("./msg");r.COMMON_FUNCTION_MIXIN={name_:"",functionId_:"",arguments_:[],mutationToDom:function(){this.ensureIds_();let r=s.utils.xml.createElement("mutation");return r.setAttribute("name",this.name_),r.setAttribute("functionid",this.functionId_),this.arguments_.forEach(function(e){var t=s.utils.xml.createElement("arg");t.setAttribute("name",e.name),t.setAttribute("id",e.id),t.setAttribute("type",e.type),r.appendChild(t)}),r},domToMutation:function(t){var r=[];for(let e=0;e<t.childNodes.length;++e){var n=t.childNodes[e];"arg"==n.nodeName.toLowerCase()&&r.push({id:n.getAttribute("id"),name:n.getAttribute("name"),type:n.getAttribute("type")})}this.arguments_=r,this.name_=t.getAttribute("name"),this.restoreSavedFunctionId(t.getAttribute("functionid"))},saveExtraState:function(){return{name:this.name_,functionid:this.functionId_,arguments:this.arguments_.slice()}},loadExtraState:function(e){this.arguments_=e.arguments.slice(),this.name_=e.name,this.restoreSavedFunctionId(e.functionid)},restoreSavedFunctionId:function(e){(0,o.idsInUse)(this.workspace).indexOf(e)<0&&(this.functionId_=e),this.ensureIds_();let t=null;this instanceof s.BlockSvg&&(t=this.getHeightWidth()),this.type!==a.FUNCTION_DEFINITION_BLOCK_TYPE||t&&!t.height&&!t.width?this.updateDisplay_():!this.getFieldValue("function_name")&&this.name_&&(this.setFieldValue(this.name_,"function_name"),this.updateDisplay_())},getName:function(){return this.name_},getFunctionId:function(){return this.functionId_},getArguments:function(){return this.arguments_},removeValueInputs_:function(){var r=[];for(let e=0,t;t=this.inputList[e];e++)t.type==s.inputs.inputTypes.VALUE?t.dispose():r.push(t);this.inputList=r},createAllInputs_:function(){let t=!1,r=!1;if(this.inputList.forEach(function(e){"function_title"==e.name?t=!0:"function_name"==e.name&&(r=!0)}),!t){let e="";switch(this.type){case a.FUNCTION_CALL_OUTPUT_BLOCK_TYPE:case a.FUNCTION_CALL_BLOCK_TYPE:e=s.Msg[n.MsgKey.FUNCTIONS_CALL_TITLE];break;case a.FUNCTION_DEFINITION_BLOCK_TYPE:case a.FUNCTION_DECLARATION_BLOCK_TYPE:e=s.Msg[n.MsgKey.FUNCTIONS_DEFNORETURN_TITLE]}this.appendDummyInput("function_title").appendField(e,"function_title")}r?this.updateFunctionLabel_(this.getName()):this.addFunctionLabel_(this.getName()),this.updateArgumentInputs_()},updateArgumentInputs_(){var r,e;for(let t of this.inputList)t.type!==s.inputs.inputTypes.VALUE||this.arguments_.some(e=>e.id===t.name)||(this.type===a.FUNCTION_DEFINITION_BLOCK_TYPE&&(e=t.connection.targetBlock())&&e.dispose(),this.removeInput(t.name));let n=this.inputList.findIndex(e=>e.type===s.inputs.inputTypes.VALUE);-1===n&&(n=this.inputList.length);for(let t of this.arguments_){let e=this.inputList.find(e=>e.name===t.id);var i=!e;i&&(e=this.appendValueInput(t.id)),this.inputList.indexOf(e)!==n&&this.moveInputBefore(e.name,null==(r=this.inputList[n+1])?void 0:r.name),(0,o.isCustomType)(t.type)?e.setCheck(t.type):e.setCheck(t.type.charAt(0).toUpperCase()+t.type.slice(1)),!this.isInsertionMarker()&&i&&this.populateArgument_(t,void 0,e),n++}this.inputList.some(e=>"function_collapse"===e.name)&&this.moveInputBefore("function_collapse",null),this.hasStatements_&&this.moveInputBefore("STACK",null)},updateDisplay_:function(){var e=this.rendered;this.createAllInputs_(),e&&!this.isInsertionMarker()&&this instanceof s.BlockSvg&&(this.initSvg(),this.queueRender())},setStatements_:function(e){this.hasStatements_!==e&&(e?this.appendStatementInput("STACK"):this.removeInput("STACK",!0),this.hasStatements_=e)},ensureIds_:function(){switch(this.type){case a.FUNCTION_DEFINITION_BLOCK_TYPE:this.functionId_&&"null"!=this.functionId_||(this.functionId_=s.utils.idGenerator.genUid());for(let e=0;e<this.arguments_.length;++e)this.arguments_[e].id||(this.arguments_[e].id=s.utils.idGenerator.genUid());break;case a.FUNCTION_CALL_OUTPUT_BLOCK_TYPE:case a.FUNCTION_CALL_BLOCK_TYPE:var e=(0,o.getDefinition)(this.name_,this.workspace);if(e){this.functionId_=e.getFunctionId();var r=e.getArguments();for(let t=0;t<this.arguments_.length;++t)for(let e=0;e<r.length;++e)if(r[e].name==this.arguments_[t].name){this.arguments_[t].id=r[e].id;break}}}}}},{"./constants":105,"./msg":112,"./utils":114,blockly:175}],105:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE=r.ARGUMENT_EDITOR_ARRAY_BLOCK_TYPE=r.ARGUMENT_EDITOR_STRING_BLOCK_TYPE=r.ARGUMENT_EDITOR_NUMBER_BLOCK_TYPE=r.ARGUMENT_EDITOR_BOOLEAN_BLOCK_TYPE=r.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE=r.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE=r.ARGUMENT_REPORTER_STRING_BLOCK_TYPE=r.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE=r.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE=r.FUNCTION_CALL_OUTPUT_BLOCK_TYPE=r.FUNCTION_CALL_BLOCK_TYPE=r.FUNCTION_DECLARATION_BLOCK_TYPE=r.FUNCTION_DEFINITION_BLOCK_TYPE=void 0,r.FUNCTION_DEFINITION_BLOCK_TYPE="function_definition",r.FUNCTION_DECLARATION_BLOCK_TYPE="function_declaration",r.FUNCTION_CALL_BLOCK_TYPE="function_call",r.FUNCTION_CALL_OUTPUT_BLOCK_TYPE="function_call_output",r.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE="argument_reporter_boolean",r.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE="argument_reporter_number",r.ARGUMENT_REPORTER_STRING_BLOCK_TYPE="argument_reporter_string",r.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE="argument_reporter_array",r.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE="argument_reporter_custom",r.ARGUMENT_EDITOR_BOOLEAN_BLOCK_TYPE="argument_editor_boolean",r.ARGUMENT_EDITOR_NUMBER_BLOCK_TYPE="argument_editor_number",r.ARGUMENT_EDITOR_STRING_BLOCK_TYPE="argument_editor_string",r.ARGUMENT_EDITOR_ARRAY_BLOCK_TYPE="argument_editor_array",r.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE="argument_editor_custom"},{}],106:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});let n=e("blockly"),i=e("./utils"),s=e("./msg"),a=e("./svgs"),o=new n.zelos.ConstantProvider;r={customContextMenu:function(e){if(!this.isCollapsed()){var t={text:n.Msg.RENAME_VARIABLE,enabled:!this.workspace.options.readOnly,callback:()=>{var e=this.workspace,t=this.getField("VAR").getVariable();n.Variables.renameVariable(e,t)}};if(e.unshift(t),!this.isInFlyout)for(let t of this.workspace.getVariableMap().getVariablesOfType("")){var r={enabled:!this.workspace.options.readOnly,text:t.getName(),callback:()=>{var e=this.getField("VAR");e||pxt.log("Tried to get a variable field on the wrong type of block."),e.setValue(t.getId())}};e.unshift(r)}}}};n.Extensions.registerMixin("function_contextmenu_edit",{customContextMenu:function(e){var t={enabled:!(null!=(t=null==(t=this.workspace)?void 0:t.options)&&t.readOnly),text:n.Msg[s.MsgKey.FUNCTIONS_GO_TO_DEFINITION_OPTION],callback:()=>{var e=this.getField("function_name").getText(),e=(0,i.getDefinition)(e,this.workspace);e&&this.workspace instanceof n.WorkspaceSvg&&this.workspace.centerOnBlock(e.id,!0)}};e.push(t)}}),n.Extensions.registerMixin("contextMenu_variableReporter",r),n.Extensions.register("output_number",function(){this.setInputsInline(!0),this.setOutputShape(o.SHAPES.ROUND),this.setOutput(!0,"Number")}),n.Extensions.register("output_string",function(){this.setInputsInline(!0),this.setOutputShape(o.SHAPES.ROUND),this.setOutput(!0,"String")}),n.Extensions.register("output_boolean",function(){this.setInputsInline(!0),this.setOutputShape(o.SHAPES.HEXAGONAL),this.setOutput(!0,"Boolean")}),n.Extensions.register("output_array",function(){this.setInputsInline(!0),this.setOutputShape(o.SHAPES.ROUND),this.setOutput(!0,"Array")}),n.Extensions.register("text_field_color",function(){var e;this.workspace instanceof n.WorkspaceSvg?(e=this.workspace.getRenderer().getConstants(),this.setColour(e.FIELD_BORDER_RECT_COLOUR)):this.setColour("#fff")}),n.Extensions.register("inline-svgs",function(){this.ADD_IMAGE_DATAURI=a.ADD_IMAGE_DATAURI,this.REMOVE_IMAGE_DATAURI=a.REMOVE_IMAGE_DATAURI})},{"./msg":112,"./svgs":113,"./utils":114,blockly:175}],107:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldArgumentEditor=void 0;let i=e("blockly"),n=e("../functionManager");class s extends i.FieldTextInput{constructor(e,t,r){super(e,t,r)}showEditor(e){super.showEditor(e);var t,e=i.WidgetDiv.getDiv(),r=(e.className+=" argumentEditorInput",document.createElement("img")),r=(r.setAttribute("class","argumentEditorRemoveIcon"),r.setAttribute("src",s.REMOVE_ARG_URI),this.removeButtonMouseWrapper_=i.browserEvents.conditionalBind(r,"mousedown",this,this.removeCallback),e.appendChild(r),null==(r=this.sourceBlock_)?void 0:r.getTypeName());r&&null!=(t=this.sourceBlock_)&&t.workspace&&(t=n.FunctionManager.getInstance().getIconForType(r))&&(r=t+" icon argumentEditorTypeIcon",(t=document.createElement("i")).className=r,e.appendChild(t))}removeCallback(){var t,r=null==(r=this.sourceBlock_)?void 0:r.getParent();if(r){let e;for(var n of r.inputList)if((null==(t=n.connection)?void 0:t.targetBlock())===this.sourceBlock_){e=n.name;break}e&&(i.WidgetDiv.hide(),r.removeInput(e))}}}(r.FieldArgumentEditor=s).REMOVE_ARG_URI="data:image/svg+xml;charset=UTF-8,%3c?xml version='1.0' encoding='UTF-8' standalone='no'?%3e%3csvg width='20px' height='20px' viewBox='0 0 20 20' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3c!-- Generator: Sketch 48.1 (47250) - http://www.bohemiancoding.com/sketch --%3e%3ctitle%3edelete-argument v2%3c/title%3e%3cdesc%3eCreated with Sketch.%3c/desc%3e%3cdefs%3e%3c/defs%3e%3cg id='Page-1' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e%3cg id='delete-argument-v2' stroke='%23FF661A'%3e%3cg id='Group' transform='translate(3.000000, 2.500000)'%3e%3cpath d='M1,3 L13,3 L11.8900496,14.0995037 C11.8389294,14.6107055 11.4087639,15 10.8950124,15 L3.10498756,15 C2.59123611,15 2.16107055,14.6107055 2.10995037,14.0995037 L1,3 Z' id='Rectangle' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3c/path%3e%3cpath d='M7,11 L7,6' id='Line' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3c/path%3e%3cpath d='M9.5,11 L9.5,6' id='Line-Copy' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3c/path%3e%3cpath d='M4.5,11 L4.5,6' id='Line-Copy-2' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3c/path%3e%3crect id='Rectangle-2' fill='%23FF661A' x='0' y='2.5' width='14' height='1' rx='0.5'%3e%3c/rect%3e%3cpath d='M6,0 L8,0 C8.55228475,-1.01453063e-16 9,0.44771525 9,1 L9,3 L5,3 L5,1 C5,0.44771525 5.44771525,1.01453063e-16 6,0 Z' id='Rectangle-3' stroke-width='1.5'%3e%3c/path%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e",i.fieldRegistry.register("field_argument_editor",s),i.Css.register(`

.argumentEditorInput {
    overflow: visible;
}

.functioneditor i.argumentEditorTypeIcon {
    color: var(--pxt-target-foreground1);
    position: absolute;
    width: 24px;
    height: 24px;
    top: 40px;
    left: 50%;
    margin-left: -12px;
}

.argumentEditorRemoveIcon {
    position: absolute;
    width: 24px;
    height: 24px;
    top: -40px;
    left: 50%;
    margin-left: -12px;
    cursor: pointer;
}

`)},{"../functionManager":110,blockly:175}],108:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.setArgumentReporterLocalizeFunction=r.FieldArgumentReporter=void 0;var n=e("blockly");let i=e("../utils"),s;class a extends n.FieldLabelSerializable{getDisplayText_(){var e=this.getSourceBlock();if(e&&(0,i.isFunctionArgumentReporter)(e)&&s){e=s(this,e);if(e)return e}return super.getDisplayText_()}}r.FieldArgumentReporter=a,r.setArgumentReporterLocalizeFunction=function(e){s=e},n.registry.register(n.registry.Type.FIELD,"field_argument_reporter",a)},{"../utils":114,blockly:175}],109:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldAutocapitalizeTextInput=void 0;e=e("blockly");class n extends e.FieldTextInput{constructor(e,t,r){super(e,t,r),this.disableAutocapitalize=!1}setAutocapitalize(e){this.disableAutocapitalize=!e,this.htmlInput_&&(this.disableAutocapitalize?this.htmlInput_.setAttribute("autocapitalize","none"):this.htmlInput_.removeAttribute("autocapitalize"))}configure_(e){super.configure_(e),void 0!==e.disableAutocapitalize&&(this.disableAutocapitalize=e.disableAutocapitalize)}widgetCreate_(){var e=super.widgetCreate_();return this.disableAutocapitalize&&e.setAttribute("autocapitalize","none"),e}}r.FieldAutocapitalizeTextInput=n,e.fieldRegistry.register("field_autocapitalize_text_input",n)},{blockly:175}],110:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FunctionManager=void 0;let n=e("blockly"),i=e("./msg");class s{constructor(){this.typeIcons={},this.typeArgumentNames={}}static getInstance(){return s.instance}getIconForType(e){return this.typeIcons[e]}setIconForType(e,t){this.typeIcons[e]=t}setArgumentNameForType(e,t){this.typeArgumentNames[e]=t}getArgumentNameForType(e){return this.typeArgumentNames[e]||n.Msg[i.MsgKey.FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME]}setEditFunctionExternal(e){this._editFunctionExternal=e}editFunctionExternal(e,t){this._editFunctionExternal?this._editFunctionExternal(e,t):pxt.warn("External function editor must be overriden: Blockly.Functions.editFunctionExternalHandler",e,t)}}(r.FunctionManager=s).instance=new s},{"./msg":112,blockly:175}],111:[function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},s=(Object.defineProperty(r,"__esModule",{value:!0}),r.validateFunctionExternal=r.getAllFunctionDefinitionBlocks=r.getDefinition=r.flyoutCategory=void 0,i(e("./msg"),r),i(e("./extensions"),r),i(e("./fields/fieldArgumentEditor"),r),i(e("./fields/fieldArgumentReporter"),r),i(e("./fields/fieldAutocapitalizeTextInput"),r),i(e("./blocks/argumentEditorBlocks"),r),i(e("./blocks/argumentReporterBlocks"),r),i(e("./blocks/functionDeclarationBlock"),r),i(e("./blocks/functionDefinitionBlock"),r),i(e("./blocks/functionCallBlocks"),r),i(e("./functionManager"),r),e("./utils"));Object.defineProperty(r,"flyoutCategory",{enumerable:!0,get:function(){return s.flyoutCategory}}),Object.defineProperty(r,"getDefinition",{enumerable:!0,get:function(){return s.getDefinition}}),Object.defineProperty(r,"getAllFunctionDefinitionBlocks",{enumerable:!0,get:function(){return s.getAllFunctionDefinitionBlocks}}),Object.defineProperty(r,"validateFunctionExternal",{enumerable:!0,get:function(){return s.validateFunctionExternal}})},{"./blocks/argumentEditorBlocks":99,"./blocks/argumentReporterBlocks":100,"./blocks/functionCallBlocks":101,"./blocks/functionDeclarationBlock":102,"./blocks/functionDefinitionBlock":103,"./extensions":106,"./fields/fieldArgumentEditor":107,"./fields/fieldArgumentReporter":108,"./fields/fieldAutocapitalizeTextInput":109,"./functionManager":110,"./msg":112,"./utils":114}],112:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MsgKey=void 0;let n=e("blockly"),i;function s(e,t){n.Msg[e]||(n.Msg[e]=t)}(e=i=r.MsgKey||(r.MsgKey={})).REPORTERS_HUE="REPORTERS_HUE",e.FUNCTIONS_CALL_TITLE="FUNCTIONS_CALL_TITLE",e.FUNCTIONS_DEFNORETURN_TITLE="FUNCTIONS_DEFNORETURN_TITLE",e.FUNCTIONS_GO_TO_DEFINITION_OPTION="FUNCTIONS_GO_TO_DEFINITION_OPTION",e.FUNCTION_CALL_TOOLTIP="FUNCTION_CALL_TOOLTIP",e.PROCEDURES_HUE="PROCEDURES_HUE",e.PROCEDURES_CALLNORETURN_HELPURL="PROCEDURES_CALLNORETURN_HELPURL",e.FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME="FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME",e.FUNCTIONS_DEFAULT_STRING_ARG_NAME="FUNCTIONS_DEFAULT_STRING_ARG_NAME",e.FUNCTIONS_DEFAULT_NUMBER_ARG_NAME="FUNCTIONS_DEFAULT_NUMBER_ARG_NAME",e.FUNCTIONS_DEFAULT_ARRAY_ARG_NAME="FUNCTIONS_DEFAULT_ARRAY_ARG_NAME",e.PROCEDURES_DEFNORETURN_TOOLTIP="PROCEDURES_DEFNORETURN_TOOLTIP",e.PROCEDURES_DEFNORETURN_HELPURL="PROCEDURES_DEFNORETURN_HELPURL",e.FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME="FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME",e.FUNCTIONS_DEFAULT_FUNCTION_NAME="FUNCTIONS_DEFAULT_FUNCTION_NAME",e.FUNCTION_CREATE_NEW="FUNCTION_CREATE_NEW",e.FUNCTION_FLYOUT_LABEL="FUNCTION_FLYOUT_LABEL",e.FUNCTIONS_EDIT_OPTION="FUNCTIONS_EDIT_OPTION",e.FUNCTIONS_CREATE_CALL_OPTION="FUNCTIONS_CREATE_CALL_OPTION",s(i.REPORTERS_HUE,"#A80000"),s(i.FUNCTIONS_CALL_TITLE,"call"),s(i.FUNCTIONS_DEFNORETURN_TITLE,"function"),s(i.FUNCTIONS_GO_TO_DEFINITION_OPTION,"Go to Definition"),s(i.FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME,"bool"),s(i.FUNCTIONS_DEFAULT_STRING_ARG_NAME,"text"),s(i.FUNCTIONS_DEFAULT_NUMBER_ARG_NAME,"num"),s(i.FUNCTIONS_DEFAULT_ARRAY_ARG_NAME,"array"),s(i.FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME,"value"),s(i.FUNCTIONS_DEFAULT_FUNCTION_NAME,"doSomething"),s(i.FUNCTION_CREATE_NEW,"Make a Function"),s(i.FUNCTION_FLYOUT_LABEL,"Your Functions"),s(i.FUNCTIONS_EDIT_OPTION,"Edit Function"),s(i.FUNCTIONS_CREATE_CALL_OPTION,"Create 'call %1'")},{blockly:175}],113:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.REMOVE_IMAGE_DATAURI=r.ADD_IMAGE_DATAURI=r.COLLAPSE_IMAGE_DATAURI=void 0,r.COLLAPSE_IMAGE_DATAURI="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg enable-background='new 0 0 24 24' version='1.1' viewBox='0 0 24 24' xml:space='preserve' xmlns='http://www.w3.org/2000/svg'%3E%3Cstyle type='text/css'%3E .st0%7Bfill:%23CF8B17;%7D .st1%7Bfill:%23FFFFFF;%7D%0A%3C/style%3E%3Ctitle%3Erepeat%3C/title%3E%3Ccircle cx='12' cy='12' r='10.503' fill='none' stroke='%23fff' stroke-linecap='square' stroke-linejoin='round' stroke-width='2'/%3E%3Cg transform='matrix(.0086269 0 0 -.0086269 4.8224 17.354)'%3E%3Cpath d='m1611 367.42q0 53-37 90l-651 651q-38 38-91 38-54 0-90-38l-651-651q-38-36-38-90 0-53 38-91l74-75q39-37 91-37 53 0 90 37l486 486 486-486q37-37 90-37 52 0 91 37l75 75q37 39 37 91z' fill='%23fff'/%3E%3C/g%3E%3C/svg%3E%0A",r.ADD_IMAGE_DATAURI="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMS4wLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4KCjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgdmVyc2lvbj0iMS4xIgogICBpZD0icmVwZWF0IgogICB4PSIwcHgiCiAgIHk9IjBweCIKICAgdmlld0JveD0iMCAwIDI0IDI0IgogICBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAyNCAyNDsiCiAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgIGlua3NjYXBlOnZlcnNpb249IjAuOTEgcjEzNzI1IgogICBzb2RpcG9kaTpkb2NuYW1lPSJhZGQuc3ZnIj48bWV0YWRhdGEKICAgICBpZD0ibWV0YWRhdGExNSI+PHJkZjpSREY+PGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPjxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PjxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz48ZGM6dGl0bGU+cmVwZWF0PC9kYzp0aXRsZT48L2NjOldvcms+PC9yZGY6UkRGPjwvbWV0YWRhdGE+PGRlZnMKICAgICBpZD0iZGVmczEzIiAvPjxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBwYWdlY29sb3I9IiNmZjQ4MjEiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMSIKICAgICBvYmplY3R0b2xlcmFuY2U9IjEwIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwIgogICAgIGd1aWRldG9sZXJhbmNlPSIxMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTY4MCIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI5NjkiCiAgICAgaWQ9Im5hbWVkdmlldzExIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTp6b29tPSIxOS42NjY2NjciCiAgICAgaW5rc2NhcGU6Y3g9IjEyLjkxNTI1NCIKICAgICBpbmtzY2FwZTpjeT0iMTYuMDY3Nzk2IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIwIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOndpbmRvdy1tYXhpbWl6ZWQ9IjAiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0icmVwZWF0IiAvPjxzdHlsZQogICAgIHR5cGU9InRleHQvY3NzIgogICAgIGlkPSJzdHlsZTMiPgoJLnN0MHtmaWxsOiNDRjhCMTc7fQoJLnN0MXtmaWxsOiNGRkZGRkY7fQo8L3N0eWxlPjx0aXRsZQogICAgIGlkPSJ0aXRsZTUiPnJlcGVhdDwvdGl0bGU+PHJlY3QKICAgICBzdHlsZT0ib3BhY2l0eToxO2ZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MTtzdHJva2UtbGluZWNhcDpzcXVhcmU7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MC4wNzg0MzEzNyIKICAgICBpZD0icmVjdDQxNDMiCiAgICAgd2lkdGg9IjQuMDUwMDAwMiIKICAgICBoZWlnaHQ9IjEyLjM5NzA1IgogICAgIHg9IjkuOTc1MDAwNCIKICAgICB5PSItMTguMTk4NTI2IgogICAgIHJ4PSIwLjgxIgogICAgIHJ5PSIwLjgxIgogICAgIHRyYW5zZm9ybT0ic2NhbGUoMSwtMSkiIC8+PHJlY3QKICAgICBzdHlsZT0ib3BhY2l0eToxO2ZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MTtzdHJva2UtbGluZWNhcDpzcXVhcmU7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MC4wNzg0MzEzNyIKICAgICBpZD0icmVjdDQxNDMtMSIKICAgICB3aWR0aD0iNC4wNTAwMDAyIgogICAgIGhlaWdodD0iMTIuMzk3MTE5IgogICAgIHg9IjkuOTc1MDAwNCIKICAgICB5PSI1LjgwMTQ0MDciCiAgICAgcng9IjAuODEiCiAgICAgcnk9IjAuODEiCiAgICAgdHJhbnNmb3JtPSJtYXRyaXgoMCwxLDEsMCwwLDApIiAvPjxjaXJjbGUKICAgICBzdHlsZT0ib3BhY2l0eToxO2ZpbGw6bm9uZTtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6I2ZmZmZmZjtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpzcXVhcmU7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICBpZD0icGF0aDQxMzYiCiAgICAgY3g9IjEyIgogICAgIGN5PSIxMiIKICAgICByPSIxMC41MDMxOTEiIC8+PC9zdmc+",r.REMOVE_IMAGE_DATAURI="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMS4wLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4KCjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgdmVyc2lvbj0iMS4xIgogICBpZD0icmVwZWF0IgogICB4PSIwcHgiCiAgIHk9IjBweCIKICAgdmlld0JveD0iMCAwIDI0IDI0IgogICBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAyNCAyNDsiCiAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgIGlua3NjYXBlOnZlcnNpb249IjAuOTEgcjEzNzI1IgogICBzb2RpcG9kaTpkb2NuYW1lPSJyZW1vdmUuc3ZnIj48bWV0YWRhdGEKICAgICBpZD0ibWV0YWRhdGExNSI+PHJkZjpSREY+PGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPjxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PjxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz48ZGM6dGl0bGU+cmVwZWF0PC9kYzp0aXRsZT48L2NjOldvcms+PC9yZGY6UkRGPjwvbWV0YWRhdGE+PGRlZnMKICAgICBpZD0iZGVmczEzIiAvPjxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBwYWdlY29sb3I9IiNmZjFhZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMSIKICAgICBvYmplY3R0b2xlcmFuY2U9IjEwIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwIgogICAgIGd1aWRldG9sZXJhbmNlPSIxMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTY4MCIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI5NTAiCiAgICAgaWQ9Im5hbWVkdmlldzExIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTp6b29tPSIxOS42NjY2NjciCiAgICAgaW5rc2NhcGU6Y3g9IjAuMDUwODQ3NTIxIgogICAgIGlua3NjYXBlOmN5PSI5Ljk2NjEwMTciCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjAiCiAgICAgaW5rc2NhcGU6d2luZG93LXk9IjAiCiAgICAgaW5rc2NhcGU6d2luZG93LW1heGltaXplZD0iMCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJyZXBlYXQiIC8+PHN0eWxlCiAgICAgdHlwZT0idGV4dC9jc3MiCiAgICAgaWQ9InN0eWxlMyI+Cgkuc3Qwe2ZpbGw6I0NGOEIxNzt9Cgkuc3Qxe2ZpbGw6I0ZGRkZGRjt9Cjwvc3R5bGU+PHRpdGxlCiAgICAgaWQ9InRpdGxlNSI+cmVwZWF0PC90aXRsZT48cmVjdAogICAgIHN0eWxlPSJvcGFjaXR5OjE7ZmlsbDojZmZmZmZmO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpub256ZXJvO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDoxO3N0cm9rZS1saW5lY2FwOnNxdWFyZTtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eTowLjA3ODQzMTM3IgogICAgIGlkPSJyZWN0NDE0My0xIgogICAgIHdpZHRoPSI0LjA1MDAwMDIiCiAgICAgaGVpZ2h0PSIxMi4zOTcxMTkiCiAgICAgeD0iOS45NzUwMDA0IgogICAgIHk9IjUuODAxNDQwNyIKICAgICByeD0iMC44MSIKICAgICByeT0iMC44MSIKICAgICB0cmFuc2Zvcm09Im1hdHJpeCgwLDEsMSwwLDAsMCkiIC8+PGNpcmNsZQogICAgIHN0eWxlPSJvcGFjaXR5OjE7ZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpub256ZXJvO3N0cm9rZTojZmZmZmZmO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOnNxdWFyZTtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIgogICAgIGlkPSJwYXRoNDEzNiIKICAgICBjeD0iMTIiCiAgICAgY3k9IjEyIgogICAgIHI9IjEwLjUwMzE5MSIgLz48L3N2Zz4="},{}],114:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isVariableBlockType=r.validateFunctionExternal=r.flyoutCategory=r.getShadowBlockInfoFromType_=r.findUniqueParamName=r.getArgumentReporterParent=r.doArgumentReporterDragChecks=r.isFunctionArgumentReporter=r.getArgMap=r.mutateCallersAndDefinition=r.idsInUse=r.findLegalName=r.createCustomArgumentEditor=r.createCustomArgumentReporter=r.isCustomType=r.getAllFunctionDefinitionBlocks=r.getDefinition=r.rename=void 0;let m=e("blockly"),g=e("./constants"),d=e("./functionManager"),p=e("./msg"),h=e("./blocks/functionDeclarationBlock"),a=e("../../compiler/util"),o=e("../../loader");function f(e,t){for(var r of t.getTopBlocks(!1))if(r.type===g.FUNCTION_DEFINITION_BLOCK_TYPE)if(r.getName()===e)return r;return null}function _(e){return e.getTopBlocks(!1).filter(e=>e.type===g.FUNCTION_DEFINITION_BLOCK_TYPE)}function n(e,t,r){r=r.newBlock(e),e=m.utils.xml.createElement("mutation");return e.setAttribute("typename",t),r.domToMutation(e),r}function s(e,t,r){if(null==r||!r.isInFlyout)for(var n=l(t,r);n[e];)e=i(e);return e}function l(e,r,n){let i={};return e.getVariableMap().getAllVariables().forEach(function(e){i[e.getName()]=!0}),e.getAllBlocks(!1).forEach(function(e){var t=e;t==r||n&&t.getFunctionId&&t.getFunctionId()==n||(t.type==g.FUNCTION_DEFINITION_BLOCK_TYPE?i[t.getName()]=!0:"procedures_defreturn"!=e.type&&e.type)}),i}function i(e){var t=e.match(/^(.*?)(\d+)$/);return t?e=t[1]+(parseInt(t[2],10)+1):e+="2",e}function c(e,t,r){var n=f(e,t);if(n){var i,s,a,o,l,c=n.mutationToDom(),u=y(c,!1),d=y(r,!0),p=[];for(i of n.getDescendants(!1))b(i)&&((s=v(i,i))&&s!==n||(s=i.getFieldValue("VALUE"))!==(a=d[u[s]])&&(o=i.outputConnection.targetBlock().id,l=i.outputConnection.targetConnection.getParentInput().name,p.push({id:i.id,type:i.type,oldName:s,newName:a,targetBlockId:o,targetInputName:l})));var h=((e,t)=>{var r,n,i=[];for(r of t.getAllBlocks(!1))r.type!==g.FUNCTION_CALL_BLOCK_TYPE&&r.type!==g.FUNCTION_CALL_OUTPUT_BLOCK_TYPE||(n=r).getName()===e&&i.push(n);return i})(e,n.workspace).map(e=>({id:e.id,oldMutation:m.utils.xml.domToText(e.mutationToDom()),shadows:e.serializeChangedInputs(r)})),h=new T(n.id,h,m.Xml.domToText(c),m.Xml.domToText(r),p);h.workspaceId=t.id,h.run(!0),m.Events.fire(h)}else pxt.warn("Attempted to change function "+e+", but no definition block was found on the workspace")}function y(t,r){var n={};for(let e=0;e<t.childNodes.length;++e){var i=t.childNodes[e],s=r?i.getAttribute("id"):i.getAttribute("name"),i=r?i.getAttribute("name"):i.getAttribute("id");n[s]=i}return n}function b(e){return e.type==g.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE||e.type==g.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE||e.type==g.ARGUMENT_REPORTER_STRING_BLOCK_TYPE||e.type==g.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE||e.type==g.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE}function v(e,t){pxt.U.assert(b(e));let r=e.getFieldValue("VALUE"),n=e.getTypeName();for(;t.getSurroundParent();)for(var i of(t=t.getSurroundParent()).inputList)if(i.connection&&i.name.startsWith(o.DRAGGABLE_PARAM_INPUT_PREFIX)){var s=i.name.slice(o.DRAGGABLE_PARAM_INPUT_PREFIX.length);if(s===r){let e=n;return"string"!==e&&"number"!==e&&"boolean"!==e||(e=e.charAt(0).toUpperCase()+e.slice(1)),-1!==i.connection.getCheck().indexOf(e)?t:void 0}}if(!t.isEnabled())return t;if((0,a.isFunctionDefinition)(t)&&t.getArguments().some(e=>e.name===r&&e.type===n))return t}r.rename=function(e){e=e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"");var t,r=this.sourceBlock_,n=s(e,r.workspace,r),i=this.getValue();return e?n?i?(i!=e&&i!=n&&(r.name_=n,t=r.mutationToDom(),c(r.name_=i,r.workspace,t)),n):r.name_=n:e:i},r.getDefinition=f,r.getAllFunctionDefinitionBlocks=_,r.isCustomType=function(e){return!("boolean"==e||"string"==e||"number"==e)},r.createCustomArgumentReporter=function(e,t){return n(g.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE,e,t)},r.createCustomArgumentEditor=function(e,t){return n(g.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE,e,t)},r.findLegalName=s,r.idsInUse=function(e){let t=[];return e.getAllBlocks(!1).forEach(function(e){e.type==g.FUNCTION_DEFINITION_BLOCK_TYPE&&t.push(e.getFunctionId())}),t},r.mutateCallersAndDefinition=c,r.getArgMap=y,r.isFunctionArgumentReporter=b,r.doArgumentReporterDragChecks=function(e,t,r){return!b(e=e.getSourceBlock())||!(t=t.getSourceBlock())||!!v(e,t)},r.getArgumentReporterParent=v,r.findUniqueParamName=function(e,t){for(;r=e,(n=t)&&-1!=n.indexOf(r);)e=i(e);var r,n;return e},r.getShadowBlockInfoFromType_=function(e,t){let r="",n="",i="";switch(e){case"boolean":r="logic_boolean",n="BOOL",i="TRUE";break;case"number":r="math_number",n="NUM",i="1";break;case"string":r="text",n="TEXT",i="abc";break;case"Array":r="variables_get",n="VAR",i=m.Variables.getOrCreateVariablePackage(t,null,"list","").getId();break;default:r="variables_get",n="VAR",i=m.Variables.getOrCreateVariablePackage(t,null,d.FunctionManager.getInstance().getArgumentNameForType(e),"").getId()}return[r,n,i]},r.flyoutCategory=function(t){var e,r=[],n=document.createElement("button"),i=m.Msg[p.MsgKey.FUNCTION_CREATE_NEW],s="CREATE_FUNCTION";n.setAttribute("text",i),n.setAttribute("callbackKey",s),t.registerButtonCallback(s,()=>{var e=t;m.hideChaff(),m.getSelected()&&m.getSelected().unselect(),d.FunctionManager.getInstance().editFunctionExternal((0,h.newFunctionMutation)(e),(n=>function(t){if(t){var r,t='<xml><block type="'+g.FUNCTION_DEFINITION_BLOCK_TYPE+'">'+m.Xml.domToText(t)+"</block></xml>",t=m.utils.xml.textToDom(t);m.Events.setGroup(!0);let e=m.Xml.domToBlock(t.firstChild,n);e.updateDisplay_(),n.getMetrics&&(t=n.getMetrics(),r=e.getHeightWidth(),e.moveBy(t.viewLeft+t.viewWidth/2-r.width/2,t.viewTop+t.viewHeight/2-r.height/2),e.scheduleSnapAndBump()),n.centerOnBlock(e.id,!0),m.Events.setGroup(!1),setTimeout(()=>{e.afterWorkspaceLoad&&e.afterWorkspaceLoad()})}})(e))}),r.push(n);for(e of _(t)){var a=e.getName(),o=e.getArguments(),l=m.utils.xml.createElement("block"),c=(l.setAttribute("type","function_call"),l.setAttribute("gap","16"),m.utils.xml.createElement("mutation"));c.setAttribute("name",a),l.appendChild(c);for(let e=0;e<o.length;e++){var u=m.utils.xml.createElement("arg");u.setAttribute("name",o[e].name),u.setAttribute("type",o[e].type),u.setAttribute("id",o[e].id),c.appendChild(u)}r.push(l)}return r},r.validateFunctionExternal=function(t,e){var r=t.getAttribute("name");if(!r)return m.dialog.alert(m.Msg.FUNCTION_WARNING_EMPTY_NAME),!1;var n={};for(let e=0;e<t.childNodes.length;++e){var i=t.childNodes[e].getAttribute("name");if(!i)return m.dialog.alert(m.Msg.FUNCTION_WARNING_EMPTY_NAME),!1;if(n[i])return m.dialog.alert(m.Msg.FUNCTION_WARNING_DUPLICATE_ARG),!1;n[i]=!0}return n[r]?(m.dialog.alert(m.Msg.FUNCTION_WARNING_ARG_NAME_IS_FUNCTION_NAME),!1):!l(e,null,t.getAttribute("functionid"))[r]||(m.dialog.alert(m.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",r)),!1)},r.isVariableBlockType=function(e){switch(e){case"argument_reporter_boolean":case"argument_reporter_number":case"argument_reporter_string":case"argument_reporter_array":case"argument_reporter_custom":case"variables_get_reporter":case"variables_get":return!0}return!1};class T extends m.Events.Abstract{constructor(e,t,r,n,i){super(),this.definition=e,this.callers=t,this.oldMutation=r,this.newMutation=n,this.descendantChanges=i,this.type="pxt_mutate_function"}static fromJson(e,t,r){t=r=super.fromJson(e,t,r||new T(e.definition,e.callers,e.oldMutation,e.newMutation,e.descendantChanges));return t.definition=e.definition,t.callers=e.callers,t.oldMutation=e.oldMutation,t.newMutation=e.newMutation,t.descendantChanges=e.descendantChanges,r}toJson(){return{type:this.type,group:this.group,definition:this.definition,callers:this.callers,oldMutation:this.oldMutation,newMutation:this.newMutation,descendantChanges:this.descendantChanges}}run(e){var t,r,n,i,s,a=this.getEventWorkspace_(),o=m.utils.xml.textToDom(e?this.newMutation:this.oldMutation),l=a.getBlockById(this.definition);m.Events.disable(),l.domToMutation(o),l.updateArgumentInputs_(),l.afterWorkspaceLoad();for(t of this.callers){var c,u=a.getBlockById(t.id);if(e)u.domToMutation(o);else{u.domToMutation(m.utils.xml.textToDom(t.oldMutation));for(var d of t.shadows)d.connectedBlock?(c=a.getBlockById(d.connectedBlock),u.getInput(d.inputName).connection.connect(c.outputConnection)):u.getInput(d.inputName).connection.setShadowState(d.connectedShadow)}}for(r of this.descendantChanges)r.newName?a.getBlockById(r.id).setFieldValue(e?r.newName:r.oldName,"VALUE"):e?(n=a.getBlockById(r.id))&&n.dispose():((n=a.newBlock(r.type,r.id)).setFieldValue(r.oldName,"VALUE"),n.initSvg(),(s=(i=a.getBlockById(r.targetBlockId).getInput(r.targetInputName).connection).targetBlock())&&!s.isShadow()&&s.dispose(),i.connect(n.outputConnection));m.Events.enable()}}},{"../../compiler/util":15,"../../loader":77,"./blocks/functionDeclarationBlock":102,"./constants":105,"./functionManager":110,"./msg":112,blockly:175}],115:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r=e("blockly");r.Extensions.unregister("logic_compare"),r.Extensions.register("logic_compare",function(){})},{blockly:175}],116:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});let a=e("blockly"),o=e("../../fields/field_imagenotext");a.Blocks.controls_if=Object.assign(Object.assign({},{elseifCount_:0,elseCount_:0,valueConnections_:[],statementConnections_:[],elseStatementConnection_:null,mutationToDom:function(){var e;return this.elseifCount_||this.elseCount_?(e=a.utils.xml.createElement("mutation"),this.elseifCount_&&e.setAttribute("elseif",this.elseifCount_+""),this.elseCount_&&e.setAttribute("else","1"),e):null},domToMutation:function(e){e&&(this.elseifCount_=parseInt(e.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(e.getAttribute("else"),10)||0,this.rebuildShape_())},storeConnections_:function(t){t=t||0,this.valueConnections_=[null],this.statementConnections_=[null],this.elseStatementConnection_=null;for(let e=1;e<=this.elseifCount_;e++)t!=e&&(this.valueConnections_.push(this.getInput("IF"+e).connection.targetConnection),this.statementConnections_.push(this.getInput("DO"+e).connection.targetConnection));this.getInput("ELSE")&&(this.elseStatementConnection_=this.getInput("ELSE").connection.targetConnection)},restoreConnections_:function(){var t,e;for(let e=1;e<=this.elseifCount_;e++)this.reconnectValueConnection_(e,this.valueConnections_),null!=(t=this.statementConnections_[e])&&t.reconnect(this,"DO"+e);this.getInput("ELSE")&&null!=(e=this.elseStatementConnection_)&&e.reconnect(this,"ELSE")},addElse_:function(){this.update_(()=>{this.elseCount_++})},removeElse_:function(){this.update_(()=>{this.elseCount_--})},addElseIf_:function(){this.update_(()=>{this.elseifCount_++})},removeElseIf_:function(e){this.update_(()=>{this.elseifCount_--},e)},update_:function(e,t){a.Events.setGroup(!0),this.storeConnections_(t);let r=this;t=r.mutationToDom(),t=t&&a.Xml.domToText(t);e&&e.call(this),this.updateShape_(),r instanceof a.BlockSvg&&r.initSvg();let n=a.Events.getGroup();e=r.mutationToDom(),e=e&&a.Xml.domToText(e);t!=e&&(a.Events.fire(new a.Events.BlockChange(r,"mutation",null,t,e)),setTimeout(function(){a.Events.setGroup(n),r.bumpNeighbours(),a.Events.setGroup(!1)},a.config.bumpDelay)),r.rendered&&r instanceof a.BlockSvg&&r.queueRender(),this.restoreConnections_(),a.Events.setGroup(!1)},updateShape_:function(){this.getInput("ELSE")&&(this.removeInput("ELSE"),this.removeInput("ELSETITLE"),this.removeInput("ELSEBUTTONS"));let e=1;for(;this.getInput("IF"+e);)this.removeInput("IF"+e),this.removeInput("IFTITLE"+e),this.removeInput("IFBUTTONS"+e),this.removeInput("DO"+e),e++;for(let e=1;e<=this.elseifCount_;e++){var t=(e=>function(){i.removeElseIf_(e)})(e);this.appendValueInput("IF"+e).setCheck("Boolean").appendField(a.Msg.CONTROLS_IF_MSG_ELSEIF).setShadowDom((n=r=void 0,(r=document.createElement("shadow")).setAttribute("type","logic_boolean"),(n=document.createElement("field")).setAttribute("name","BOOL"),n.textContent="FALSE",r.appendChild(n),r)),this.appendDummyInput("IFTITLE"+e).appendField(a.Msg.CONTROLS_IF_MSG_THEN),this.appendDummyInput("IFBUTTONS"+e).appendField(new o.FieldImageNoText(this.REMOVE_IMAGE_DATAURI,24,24,"*",t,!1)).setAlign(a.inputs.Align.RIGHT),this.appendStatementInput("DO"+e)}var r,n;this.elseCount_&&(this.appendDummyInput("ELSETITLE").appendField(a.Msg.CONTROLS_IF_MSG_ELSE),this.appendDummyInput("ELSEBUTTONS").setAlign(a.inputs.Align.RIGHT).appendField(new o.FieldImageNoText(this.REMOVE_IMAGE_DATAURI,24,24,"*",this.removeElse_.bind(this),!1)),this.appendStatementInput("ELSE")),this.getInput("ADDBUTTON")&&this.removeInput("ADDBUTTON");let i=this;function s(){0==i.elseCount_?i.addElse_():(i.elseifCount_||(i.elseifCount_=0),i.addElseIf_())}this.appendDummyInput("ADDBUTTON").appendField(new o.FieldImageNoText(this.ADD_IMAGE_DATAURI,24,24,"*",s,!1))},rebuildShape_:function(){var e=[null],t=[null];let r=null,n=(this.getInput("ELSE")&&(r=this.getInput("ELSE").connection.targetConnection),1);for(;this.getInput("IF"+n);){var i=this.getInput("IF"+n),s=this.getInput("DO"+n);e.push(i.connection.targetConnection),t.push(s.connection.targetConnection),n++}this.updateShape_(),this.reconnectChildBlocks_(e,t,r)},reconnectChildBlocks_:function(t,r,e){var n;for(let e=1;e<=this.elseifCount_;e++)this.reconnectValueConnection_(e,t),null!=(n=r[e])&&n.reconnect(this,"DO"+e);null!=e&&e.reconnect(this,"ELSE")},reconnectValueConnection_:function(e,t){var r=null==(r=this.getInput("IF"+e))?void 0:r.connection.targetBlock();t[e]&&(t[e].reconnect(this,"IF"+e),r)&&!r.getParent()&&r.dispose()}}),{init(){var e;a.Extensions.apply("inline-svgs",this,!1),this.elseifCount_=0,this.elseCount_=0,this.setHelpUrl(a.Msg.CONTROLS_IF_HELPURL),this.appendValueInput("IF0").setCheck("Boolean").appendField(a.Msg.CONTROLS_IF_MSG_IF),this.appendDummyInput("THEN0").appendField(a.Msg.CONTROLS_IF_MSG_THEN),this.appendStatementInput("DO0"),this.workspace instanceof a.WorkspaceSvg&&(e=this.workspace.getRenderer(),this.setOutputShape(e.getConstants().SHAPES.HEXAGONAL)),this.updateShape_(),this.setInputsInline(!0),this.setColour(a.Msg.LOGIC_HUE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(()=>this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?a.Msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?a.Msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?a.Msg.CONTROLS_IF_TOOLTIP_4:"":a.Msg.CONTROLS_IF_TOOLTIP_1)}})},{"../../fields/field_imagenotext":38,blockly:175}],117:[function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./extensions"),r),i(e("./ifElse"),r)},{"./extensions":115,"./ifElse":116}],118:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldSlider=void 0;let i=e("blockly");class n extends i.FieldNumber{constructor(e,t,r,n,i,s,a,o){super(e,t,r,n,a,o),this.keyboardControlActive=!1,"string"==typeof i?this.step_=parseFloat(i):"number"==typeof i&&(this.step_=i),this.labelText_=s}hasMin(){return this.getMin()>-1/0}hasMax(){return this.getMax()<1/0}getStep(){return this.step_}getLabel(){return this.labelText_}setLabel(e){this.labelText_=e}setOptions(e,t,r,n){this.setConstraints(e,t,n),this.step_=parseFloat(r)||void 0}getFieldDescription(){return this.getValue()+""}doClassValidation_(e){if(null===e)return null;e=(e=(e=(e=""+e).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity");let t=Number(e||0);if(isNaN(t))return null;this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_);let r=String(this.precision_);e=(r=-1!==r.indexOf("e")?this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}):r).indexOf(".");let n;return n=-1===e?this.precision_?0:null:r.length-e-1,t=null!==n?Number(t.toFixed(n)):t}widgetDispose_(){this.removeEventListeners(),super.widgetDispose_()}addEventListeners(){this.inputKeydownHandler=this.inputKeydownListener.bind(this),this.htmlInput_.addEventListener("keydown",this.inputKeydownHandler),this.sliderKeydownHandler=this.sliderKeydownListener.bind(this),this.slider_.addEventListener("keydown",this.sliderKeydownHandler),this.sliderBlurHandler=this.sliderBlurListener.bind(this),this.slider_.addEventListener("blur",this.sliderBlurHandler),this.sliderPointerdownHandler=this.sliderPointerdownListener.bind(this),this.slider_.addEventListener("pointerdown",this.sliderPointerdownHandler)}removeEventListeners(){this.htmlInput_.removeEventListener("keydown",this.inputKeydownHandler),this.slider_.removeEventListener("keydown",this.sliderKeydownHandler),this.slider_.removeEventListener("blur",this.sliderBlurHandler),this.slider_.removeEventListener("pointerdown",this.sliderPointerdownHandler)}inputKeydownListener(e){"ArrowDown"===e.key&&(e.preventDefault(),this.keyboardControlActive=!0,this.slider_.focus())}sliderPointerdownListener(e){this.keyboardControlActive=!1}sliderKeydownListener(e){switch(e.key){case"ArrowUp":e.preventDefault(),this.htmlInput_.focus();break;case"Enter":case" ":e.preventDefault(),e.stopPropagation(),i.hideChaff()}}sliderBlurListener(e){this.keyboardControlActive=!1}showEditor_(e,t){super.showEditor_(e,!0),i.DropDownDiv.hideWithoutAnimation(),i.DropDownDiv.clearContent(),i.DropDownDiv.getContentDiv().style.height="";e=i.DropDownDiv.getContentDiv();e.setAttribute("role","menu"),e.setAttribute("aria-haspopup","true"),this.addSlider_(e),i.DropDownDiv.setColour("#ffffff","#dddddd"),i.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_,void 0,void 0,!1),this.addEventListeners(),t||this.htmlInput_.focus()}addSlider_(e){var t;this.labelText_&&(t=this.createLabelDom_(this.labelText_),e.appendChild(t[0]),this.readout_=t[1],this.setReadout(this.value_)),this.slider_=this.createSlider(),e.appendChild(this.slider_);let n=()=>{pxt.BrowserUtils.isFirefox()||this.keyboardControlActive||this.htmlInput_.focus()};i.browserEvents.bind(this.slider_,"input",this,e=>{var t,r=parseFloat(this.slider_.value)||0;null!==r&&(this.setValue(r),t=this.htmlInput_)&&(t.value=r+"",n())}),i.browserEvents.bind(this.slider_,"focus",this,e=>{n()})}setValue(e,t){super.setValue(e,t),this.updateDom(),this.slider_&&(this.slider_.value=this.getValue()+"")}createSlider(){var e=document.createElement("input");e.setAttribute("class","blocklyFieldSlider"),e.type="range",e.min=this.getMin()+"",e.max=this.getMax()+"",e.value=this.getValue()+"";let t;return this.sourceBlock_ instanceof i.BlockSvg&&("#ffffff"===this.sourceBlock_.getColour()?this.sourceBlock_.getParent()&&(t=this.sourceBlock_.getParent().getColourTertiary()):t=this.sourceBlock_.getColourTertiary()),t&&e.setAttribute("style","--blocklyFieldSliderBackgroundColor: "+t),Number.isNaN(this.step_)||(e.step=this.step_+""),e}updateDom(){this.setReadout(this.getValue())}setReadout(e){this.readout_&&(this.readout_.innerText=e+"")}createLabelDom_(e){var t=document.createElement("div"),r=(t.setAttribute("class","blocklyFieldSliderLabel"),document.createElement("span")),n=(r.setAttribute("class","blocklyFieldSliderReadout"),document.createElement("span"));return n.setAttribute("class","blocklyFieldSliderLabelText"),n.innerText=e,t.appendChild(n),t.appendChild(r),[t,r]}}r.FieldSlider=n,i.fieldRegistry.register("field_slider",n),i.Css.register(`
:root {
    --blocklyFieldSliderBackgroundColor: #547AB2;
}
.blocklyFieldSliderLabel {
    font-family: "Helvetica Neue", "Segoe UI", Helvetica, sans-serif;
    font-size: 0.65rem;
    color: $colour_toolboxText;
    margin: 8px;
}
.blocklyFieldSliderLabelText {
    font-weight: bold;
}
.blocklyFieldSliderReadout {
    margin-left: 10px;
}

input[type=range].blocklyFieldSlider {
    -webkit-appearance: none;
    width: 100%;
}
input[type=range].blocklyFieldSlider:focus {
    outline: none;
}
input[type=range].blocklyFieldSlider::-webkit-slider-runnable-track {
    -webkit-appearance: none;
    margin: 8px;
    height: 22px;
    width: 150px;
    outline: none;
    border-radius: 11px;
    margin-bottom: 20px;
    background: var(--blocklyFieldSliderBackgroundColor);
}
input[type=range].blocklyFieldSlider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 26px;
    height: 26px;
    margin-top: -1px;
    background-color: white;
    border-radius: 100%;
    -webkit-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);
    -moz-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);
    box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);
    cursor: pointer;
}
input[type=range].blocklyFieldSlider:focus-visible::-webkit-slider-thumb {
    outline: 2px solid white; 
    outline-offset: 3px;
    -webkit-box-shadow: 0 0 0 3px var(--pxt-focus-border);
    -moz-box-shadow: 0 0 0 3px var(--pxt-focus-border);
    box-shadow: 0 0 0 3px var(--pxt-focus-border);
}
input[type=range].blocklyFieldSlider::-moz-range-track {
    margin: 8px;
    height: 22px;
    width: 95%;
    outline: none;
    border-radius: 11px;
    margin-bottom: 20px;
    background: #547AB2;
}
input[type=range].blocklyFieldSlider::-moz-range-thumb {
    width: 26px;
    height: 26px;
    margin-top: -1px;
    background-color: white;
    border-radius: 100%;
    -webkit-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);
    -moz-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);
    box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);
    cursor: pointer;
}
`)},{blockly:175}],119:[function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./fieldSlider"),r),i(e("./numberBlocks"),r)},{"./fieldSlider":118,"./numberBlocks":120}],120:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});let n=e("blockly");r=new n.zelos.ConstantProvider,n.defineBlocksWithJsonArray([{type:"math_integer",message0:"%1",args0:[{type:"field_number",name:"NUM",precision:1}],output:"Number",outputShape:r.SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_whole_number",message0:"%1",args0:[{type:"field_number",name:"NUM",min:0,precision:1}],output:"Number",outputShape:r.SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_positive_number",message0:"%1",args0:[{type:"field_number",name:"NUM",min:0}],output:"Number",outputShape:r.SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_number_minmax",message0:"%1",args0:[{type:"field_slider",name:"SLIDER",value:0,step:1,labelText:"Number"}],output:"Number",outputShape:r.SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",mutator:"math_number_minmax_mutator",extensions:["parent_tooltip_when_inline"]}]),e={mutationToDom:function(){var e=this.inputList[0].fieldRow[0],t=n.utils.xml.createElement("mutation");return e.hasMin()&&t.setAttribute("min",e.getMin()+""),e.hasMax()&&t.setAttribute("max",e.getMax()+""),null!=e.getLabel()&&t.setAttribute("label",e.getLabel()),null!=e.getStep()&&t.setAttribute("step",e.getStep()+""),null!=e.getPrecision()&&t.setAttribute("precision",e.getPrecision()+""),t},domToMutation:function(e){var t=this.inputList[0].fieldRow[0],r=e.getAttribute("min"),n=e.getAttribute("max"),i=e.getAttribute("step"),s=e.getAttribute("label"),e=e.getAttribute("precision");t.setLabel(s),t.setOptions(r,n,i,e)}};n.Extensions.registerMutator("math_number_minmax_mutator",e)},{blockly:175}],121:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.showEditorMixin=void 0;let u=e("blockly"),d=e("../../fields");r.showEditorMixin=function(e){var n=this.getSourceBlock();if(!n)throw new u.UnattachedFieldError;var i=new u.Menu,s=(i.setRole(u.utils.aria.Role.LISTBOX),this.menu_=i,this.getOptions(!1));let a=null;var o,l,c=e=>{u.DropDownDiv.hideIfOwner(this,!0),this.onItemSelected_(this.menu_,e)};for(let r=0;r<s.length;r++){let[e,t]=s[r];"SEPARATOR"===t?(l=new p(""),i.addChild(l)):(o=(l=void 0,d.isImageProperties)(e)?((l=new Image(e.width,e.height)).src=e.src,l.alt=e.alt||"",l):e,(o=new u.MenuItem(o,t)).setRole(u.utils.aria.Role.OPTION),o.setRightToLeft(n.RTL),o.setCheckable(!0),i.addChild(o),o.setChecked(t===this.value_),o.onAction(c,this),t===this.value_&&(a=o))}e&&"number"==typeof e.clientX?this.menu_.openingCoords=new u.utils.Coordinate(e.clientX,e.clientY):this.menu_.openingCoords=null,u.DropDownDiv.clearContent(),u.DropDownDiv.getContentDiv().style.height="";var t,e=this.menu_.render(u.DropDownDiv.getContentDiv());u.utils.dom.addClass(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(e=n.getColour(),t=this.sourceBlock_.style.colourTertiary,u.DropDownDiv.setColour(e,t)),u.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),u.DropDownDiv.getContentDiv().style.height=this.menu_.getSize().height+"px",this.menu_.focus(),a&&this.menu_.setHighlighted(a),this.applyColour()};class p extends u.MenuItem{createDom(){var e=document.createElement("div");return e.id=u.utils.idGenerator.getNextUniqueId(),(this.element_=e).className="blockly-menuseparator",e.setAttribute("role","separator"),e}getElement(){return this.element_}getId(){return this.element_.id}isEnabled(){return!1}}u.Css.register(`
.blockly-menuseparator {
    border-top: 1px solid rgba(0, 0, 0, 0.2);
    margin: 4px 0;
    padding: 0;
}
`)},{"../../fields":70,blockly:175}],122:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldVariable=void 0;let n=e("blockly"),i=e("./fieldDropdownMixin");class s extends n.FieldVariable{constructor(e,t,r,n,i){super(e,t,r,n,i),this.svgRootBinding=null,this.fieldRootBinding=null,this.menuGenerator_=s.dropdownCreate}static dropdownCreate(){var e=n.FieldVariable.dropdownCreate.call(this),t=e.findIndex(e=>"RENAME_VARIABLE_ID"===e[1]);return e.splice(t,0,[n.Msg.NEW_VARIABLE_DROPDOWN,s.CREATE_VARIABLE_ID],[void 0,"SEPARATOR"]),e}onItemSelected_(e,t){if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&t.getValue()===s.CREATE_VARIABLE_ID)return void n.Variables.createVariableButtonHandler(this.sourceBlock_.workspace,e=>{e=this.sourceBlock_.workspace.getVariableMap().getVariable(e);e&&this.setValue(e.getId())});super.onItemSelected_(e,t)}initView(){super.initView(),this.shouldAddBorderRect_()||(this.createBorderRect_(),this.clickTargetRect=this.borderRect_,this.clickTargetRect.setAttribute("stroke-opacity","0"),this.clickTargetRect.setAttribute("fill-opacity","0"),this.borderRect_=void 0)}shouldAddBorderRect_(){if("variables_get"===this.sourceBlock_.type)return!1;for(var e of this.sourceBlock_.inputList)for(var t of e.fieldRow)if(t!==this&&t.EDITABLE)return!0;return!this.sourceBlock_.getInputsInline()||super.shouldAddBorderRect_()}bindEvents_(){this.shouldAddBorderRect_()?super.bindEvents_():(this.svgRootBinding=n.browserEvents.conditionalBind(this.sourceBlock_.getSvgRoot(),"pointerdown",this,e=>{this.sourceBlock_.icons.length||this.onMouseDown_(e)},!1),this.fieldRootBinding=n.browserEvents.conditionalBind(this.getSvgRoot(),"pointerdown",this,e=>{this.sourceBlock_.icons.length&&this.onMouseDown_(e)},!1))}dispose(){super.dispose(),this.svgRootBinding&&(n.browserEvents.unbind(this.svgRootBinding),n.browserEvents.unbind(this.fieldRootBinding))}positionBorderRect_(){super.positionBorderRect_(),this.clickTargetRect&&(this.clickTargetRect.setAttribute("width",String(this.size_.width)),this.clickTargetRect.setAttribute("height",String(this.size_.height)),this.clickTargetRect.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.clickTargetRect.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}showEditor_(e){i.showEditorMixin.call(this,e)}getValue(){var e,t=super.getValue();if(null!=(e=this.sourceBlock_)&&e.isInFlyout&&(null==(e=this.sourceBlock_.workspace)?void 0:e.getPotentialVariableMap()).getVariableById(t))return"potential_"+t;return t}}(r.FieldVariable=s).CREATE_VARIABLE_ID="CREATE_VARIABLE",n.fieldRegistry.unregister("field_variable"),n.fieldRegistry.register("field_variable",s)},{"./fieldDropdownMixin":121,blockly:175}],123:[function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./fieldVariable"),r)},{"./fieldVariable":122}],124:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isCollapsedInputRow=r.CollapsedInputRow=void 0;let n=e("blockly");class i extends n.blockRendering.InputRow{constructor(e){super(e),this.type|=n.blockRendering.Types.INPUT_ROW|n.blockRendering.Types.getType("COLLAPSED_INPUT_ROW")}measure(){this.width=this.minWidth,this.height=this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT}}r.CollapsedInputRow=i,r.isCollapsedInputRow=function(e){return!!(e.type&n.blockRendering.Types.getType("COLLAPSED_INPUT_ROW"))}},{blockly:175}],125:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ConnectionPreviewer=void 0;let o=e("blockly");class l extends o.InsertionMarkerPreviewer{previewConnection(e,t){super.previewConnection(e,t),t.type!==o.ConnectionType.INPUT_VALUE&&t.type!==o.ConnectionType.OUTPUT_VALUE||this.showDraggedIndicatorWithLine(e,t)}previewReplacement(e,t,r){super.previewReplacement(e,t,r),this.showDraggedIndicatorWithLine(e,t)}showDraggedIndicatorWithLine(e,t){this.connectionLine||(this.connectionLine=o.utils.dom.createSvgElement("line",{class:"blocklyConnectionLine",x1:0,y1:0,x2:0,y2:0},e.sourceBlock_.getSvgRoot()),this.draggedConnectionIndicator=this.createConnectionIndicator(e.sourceBlock_.getSvgRoot(),e),r=t.sourceBlock_.getSvgRoot().querySelector(":scope>.blocklyConnectionIndicatorParent"),this.staticConnectionIndicator=this.createConnectionIndicator(r,t)),this.staticConnectionIndicator.parentElement.appendChild(this.staticConnectionIndicator);var r=l.CONNECTION_INDICATOR_RADIUS,n=e.getOffsetInBlock(),e=o.utils.Coordinate.sum(e.sourceBlock_.getRelativeToSurfaceXY(),n),t=o.utils.Coordinate.sum(t.sourceBlock_.getRelativeToSurfaceXY(),t.getOffsetInBlock()),i=t.x-e.x,t=t.y-e.y,e=Math.atan2(t,i),s=Math.sqrt(i*i+t*t),a=o.Gesture.inProgress();s<2*r+1||!a?o.utils.dom.addClass(this.connectionLine,"hidden"):a&&(o.utils.dom.removeClass(this.connectionLine,"hidden"),this.connectionLine.setAttribute("x1",String(n.x+Math.cos(e)*r)),this.connectionLine.setAttribute("y1",String(n.y+Math.sin(e)*r)),this.connectionLine.setAttribute("x2",String(n.x+i-Math.cos(e)*r)),this.connectionLine.setAttribute("y2",String(n.y+t-Math.sin(e)*r)))}hidePreview(){super.hidePreview(),this.connectionLine&&(this.connectionLine.remove(),this.connectionLine=null,this.draggedConnectionIndicator.remove(),this.draggedConnectionIndicator=null,this.staticConnectionIndicator.remove(),this.staticConnectionIndicator=null,this.staticConnection=null)}createConnectionIndicator(e,t){e=o.utils.dom.createSvgElement("g",{class:"blocklyInputConnectionIndicator"},e),o.utils.dom.createSvgElement("circle",{r:l.CONNECTION_INDICATOR_RADIUS},e),t=t.getOffsetInBlock();return e.setAttribute("transform","translate("+t.x+","+t.y+")"),e}}(r.ConnectionPreviewer=l).CONNECTION_INDICATOR_RADIUS=9},{blockly:175}],126:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ConstantProvider=void 0;let i=e("blockly");class n extends i.zelos.ConstantProvider{constructor(){super(...arguments),this.FIELD_TEXT_FONTFAMILY='"Consolas", "Monaco", "Menlo", "Ubuntu Mono", "source-code-pro", monospace',this.FIELD_TEXT_FONTWEIGHT="600",this.HIGHLIGHT_GLOW_COLOUR="#FFF200",this.ERROR_HIGHLIGHT_GLOW_COLOR="#FF0000",this.HIGHLIGHT_GLOW_SIZE=1.1,this.ELLIPSES_RADIUS=6,this.ELLIPSES_SPACING=8,this.ellipses=this.makeEllipses()}createDom(e,t,r,n){super.createDom(e,t,r,n);t=i.utils.dom.createSvgElement(i.utils.Svg.DEFS,{},e);this.highlightOutlineFilter=this.createHighlight(t,"blocklyHighlightedGlowFilter",this.HIGHLIGHT_GLOW_COLOUR),this.highlightOutlineFilterId=this.highlightOutlineFilter.id,this.errorOutlineFilter=this.createHighlight(t,"blocklyErrorHighlightedGlowFilter",this.ERROR_HIGHLIGHT_GLOW_COLOR),this.errorOutlineFilterId=this.errorOutlineFilter.id,this.embossFilterOverride=this.createOutline(t,"blocklyBubbleEmbossGlowFilter"),this.embossFilterId=this.embossFilterOverride.id}dispose(){super.dispose(),this.highlightOutlineFilter&&i.utils.dom.removeNode(this.highlightOutlineFilter)}makeEllipses(){var t=this.ELLIPSES_RADIUS,r=this.ELLIPSES_SPACING;let n="";for(let e=0;e<3;e++)n+=i.utils.svgPaths.moveBy(r,0)+i.utils.svgPaths.arc("a","180 1,1",t,i.utils.svgPaths.point(2*t,0));for(let e=0;e<3;e++)n+=i.utils.svgPaths.arc("a","180 1,1",t,i.utils.svgPaths.point(2*-t,0))+i.utils.svgPaths.moveBy(-r,0);return n}getCSS_(e){return super.getCSS_(e).concat([e+" .blocklyConnectionIndicator, "+e+" .blocklyInputConnectionIndicator {","fill: #ff0000;","stroke: #ffff00;","stroke-width: 3px;","}",e+" .blocklyConnectionIndicator {","display: none;","}",e+" .blocklyBlockDragSurface > g > .blocklyDraggable > .blocklyConnectionIndicator {","display: block;","}",e+" .blocklyConnectionLine {","stroke: #ffff00;","stroke-width: 4px;","}",e+" .blocklyConnectionLine.hidden {","display: none;","}",e+" .blocklyFlyoutHeading .blocklyFlyoutLabelText {font-size: 1.5rem;","}"])}createHighlight(e,t,r){t=i.utils.dom.createSvgElement(i.utils.Svg.FILTER,{id:t+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),i.utils.dom.createSvgElement(i.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.HIGHLIGHT_GLOW_SIZE},t),e=i.utils.dom.createSvgElement(i.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},t);return i.utils.dom.createSvgElement(i.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},e),i.utils.dom.createSvgElement(i.utils.Svg.FEFLOOD,{"flood-color":r,"flood-opacity":1,result:"outColor"},t),i.utils.dom.createSvgElement(i.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),t}createOutline(e,t){t=i.utils.dom.createSvgElement(i.utils.Svg.FILTER,{id:t+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),i.utils.dom.createSvgElement(i.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:.92},t),e=i.utils.dom.createSvgElement(i.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},t),i.utils.dom.createSvgElement(i.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},e),i.utils.dom.createSvgElement(i.utils.Svg.FEFLOOD,{"flood-color":"#000000","flood-opacity":.5,result:"outColor"},t),i.utils.dom.createSvgElement(i.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),e=i.utils.dom.createSvgElement("feMerge",{},t);return i.utils.dom.createSvgElement("feMergeNode",{in:"outBlur"},e),i.utils.dom.createSvgElement("feMergeNode",{in:"outGlow"},e),i.utils.dom.createSvgElement("feMergeNode",{in:"SourceGraphic"},e),t}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case i.ConnectionType.INPUT_VALUE:case i.ConnectionType.OUTPUT_VALUE:return t&&t.includes("Boolean")?this.HEXAGONAL:(t&&t.includes("Number")||t&&t.includes("String"),this.ROUNDED);case i.ConnectionType.PREVIOUS_STATEMENT:case i.ConnectionType.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}}(r.ConstantProvider=n).COLLAPSE_IMAGE_DATAURI="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg enable-background='new 0 0 24 24' version='1.1' viewBox='0 0 24 24' xml:space='preserve' xmlns='http://www.w3.org/2000/svg'%3E%3Cstyle type='text/css'%3E .st0%7Bfill:%23CF8B17;%7D .st1%7Bfill:%23FFFFFF;%7D%0A%3C/style%3E%3Ctitle%3Erepeat%3C/title%3E%3Ccircle cx='12' cy='12' r='10.503' fill='none' stroke='%23fff' stroke-linecap='square' stroke-linejoin='round' stroke-width='2'/%3E%3Cg transform='matrix(.0086269 0 0 -.0086269 4.8224 17.354)'%3E%3Cpath d='m1611 367.42q0 53-37 90l-651 651q-38 38-91 38-54 0-90-38l-651-651q-38-36-38-90 0-53 38-91l74-75q39-37 91-37 53 0 90 37l486 486 486-486q37-37 90-37 52 0 91 37l75 75q37 39 37 91z' fill='%23fff'/%3E%3C/g%3E%3C/svg%3E%0A",n.EXPAND_IMAGE_DATAURI="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg enable-background='new 0 0 24 24' version='1.1' viewBox='0 0 24 24' xml:space='preserve' xmlns='http://www.w3.org/2000/svg'%3E%3Cstyle type='text/css'%3E .st0%7Bfill:%23CF8B17;%7D .st1%7Bfill:%23FFFFFF;%7D%0A%3C/style%3E%3Ctitle%3Erepeat%3C/title%3E%3Ccircle cx='12' cy='12' r='10.503' fill='none' stroke='%23fff' stroke-linecap='square' stroke-linejoin='round' stroke-width='2'/%3E%3Cg transform='matrix(.0086269 0 0 -.0086269 4.8224 17.654)'%3E%3Cpath d='m1611 832q0-53-37-90l-651-651q-38-38-91-38-54 0-90 38l-651 651q-38 36-38 90 0 53 38 91l74 75q39 37 91 37 53 0 90-37l486-486 486 486q37 37 90 37 52 0 91-37l75-75q37-39 37-91z' fill='%23fff'/%3E%3C/g%3E%3C/svg%3E%0A"},{blockly:175}],127:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),e("blockly").Css.register(`
.blocklyDropdownMenu .blocklyMenuItemCheckbox {
    filter: contrast(0) brightness(100);
}

.blocklyVerticalMarker {
    fill: none;
}
`)},{blockly:175}],128:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Drawer=void 0;let a=e("blockly"),n=e("./collapsedInputRow");class i extends a.zelos.Drawer{drawCollapsedStack_(e){var t=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.constants_.INSIDE_CORNERS.width,r=this.constants_.STATEMENT_INPUT_PADDING_LEFT+2*this.constants_.INSIDE_CORNERS.width+a.utils.svgPaths.lineOnAxis("h",-this.constants_.INSIDE_CORNERS.width)+this.constants_.INSIDE_CORNERS.pathTop,n=e.height-2*this.constants_.INSIDE_CORNERS.height,i=this.constants_.INSIDE_CORNERS.pathBottom+a.utils.svgPaths.lineOnAxis("h",this.constants_.INSIDE_CORNERS.width),s=this.constants_.ellipses;this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.bottomRight+a.utils.svgPaths.lineOnAxis("H",t)+r+a.utils.svgPaths.lineOnAxis("v",n/2)+s+a.utils.svgPaths.lineOnAxis("v",n/2)+i+a.utils.svgPaths.lineOnAxis("H",e.xPos+e.width-this.constants_.OUTSIDE_CORNERS.rightHeight)+this.constants_.OUTSIDE_CORNERS.topRight}drawOutline_(){if(this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection)this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_();else{this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){var t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):(0,n.isCollapsedInputRow)(t)?this.drawCollapsedStack_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}}drawLeft_(){if(super.drawLeft_(),this.info_.rows.find(function(e){return(0,n.isCollapsedInputRow)(e)})){let e=this.info_.startY;a.blockRendering.Types.isLeftRoundedCorner(this.info_.topRow.elements[0])&&(e+=this.constants_.OUTSIDE_CORNERS.rightHeight),this.outlinePath_=this.outlinePath_.slice(0,-1),this.outlinePath_+=a.utils.svgPaths.lineOnAxis("V",e)}}}r.Drawer=i},{"./collapsedInputRow":124,blockly:175}],129:[function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./renderer"),r),i(e("./connectionPreviewer"),r),i(e("./css"),r)},{"./connectionPreviewer":125,"./css":127,"./renderer":132}],130:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.RenderInfo=void 0;let s=e("blockly"),n=e("./collapsedInputRow");class i extends s.zelos.RenderInfo{measure(){if(this.block_)for(var e of this.block_.inputList)e.init();super.measure()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let n=new s.blockRendering.InputRow(this.constants_);this.inputRows.push(n);var r=this.block_.getIcons();for(let e=0,t;t=r[e];e++){var i=new s.blockRendering.Icon(this.constants_,t);this.isCollapsed&&!t.isShownWhenCollapsed()||n.elements.push(i)}let t=void 0;for(let e=0,r;r=this.block_.inputList[e];e++)if(r.isVisible()){this.shouldStartNewRow_(r,t)&&(this.rows.push(n),n=new s.blockRendering.InputRow(this.constants_),this.inputRows.push(n));for(let e=0,t;t=r.fieldRow[e];e++)n.elements.push(new s.blockRendering.Field(this.constants_,t,r));this.addInput_(r,n),t=r}this.isCollapsed&&(this.block_.inputList.find(function(e){return e.type==s.inputs.inputTypes.STATEMENT})?n=this.addCollapsedRow_(n):(n.hasJaggedEdge=!0,n.elements.push(new s.blockRendering.JaggedEdge(this.constants_)))),(n.elements.length||n.hasDummyInput)&&this.rows.push(n),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection;var e=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof s.inputs.StatementInput||this.rows.some(e=>(0,n.isCollapsedInputRow)(e)),e=(this.bottomRow.minHeight=e?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)),e=(e?this.bottomRow.elements.push(new s.blockRendering.SquareCorner(this.constants_)):this.bottomRow.elements.push(new s.blockRendering.RoundCorner(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new s.blockRendering.NextConnection(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_));e?this.bottomRow.elements.push(new s.blockRendering.SquareCorner(this.constants_,"right")):this.bottomRow.elements.push(new s.blockRendering.RoundCorner(this.constants_,"right"))}addCollapsedRow_(e){this.rows.push(e);e=new n.CollapsedInputRow(this.constants_);return e.hasDummyInput=!0,e}}r.RenderInfo=i},{"./collapsedInputRow":124,blockly:175}],131:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.PathObject=void 0;let s=e("blockly"),n="blockly-dotted-outline-on-hover";class i extends s.zelos.PathObject{constructor(){super(...arguments),this.connectionPointIndicators=new WeakMap}setPath(e){super.setPath(e),this.svgPathHighlighted&&this.svgPathHighlighted.setAttribute("d",e)}updateHighlighted(e){e?this.svgPathHighlighted||(e=this.constants,e=this.hasError?e.errorOutlineFilterId:e.highlightOutlineFilterId,this.svgPathHighlighted=this.svgPath.cloneNode(!0),this.svgPathHighlighted.classList.add("pxtRendererHighlight"),this.svgPathHighlighted.setAttribute("fill","none"),this.svgPathHighlighted.setAttribute("filter","url(#"+e+")"),this.svgRoot.appendChild(this.svgPathHighlighted)):this.svgPathHighlighted&&(this.svgRoot.removeChild(this.svgPathHighlighted),this.svgPathHighlighted=null)}updateSelected(e){e&&this.svgPath.classList.remove("hover"),super.updateSelected(e)}addConnectionHighlight(e,t,r,n){e=super.addConnectionHighlight(e,t,r,n);return this.staticConnectionIndicatorParentGroup?this.svgRoot.appendChild(this.staticConnectionIndicatorParentGroup):this.staticConnectionIndicatorParentGroup=s.utils.dom.createSvgElement("g",{class:"blocklyConnectionIndicatorParent"},this.svgRoot),e}removeConnectionHighlight(e){var t;null!=(t=this.staticConnectionIndicatorParentGroup)&&t.remove(),super.removeConnectionHighlight(e)}applyColour(t){if(super.applyColour(t),t.outputConnection){let e=!1;var r,n,i=t.getParent();i&&(t.isShadow()?(n=i.style.colourTertiary,(.2126*(r=s.utils.colour.hexToRgb(n))[0]+.7152*r[1]+.0722*r[2])/255<.15&&(this.svgPath.setAttribute("stroke",s.utils.colour.blend("#ffffff",n,.3)),e=!0)):(r=i.style.colourPrimary)===(n=t.style.colourPrimary)&&(i=s.utils.colour.blend("#0000000",n,.6),n=s.utils.colour.blend("#ffffff",n,.6),pxt.contrastRatio(i,r)>pxt.contrastRatio(n,r)?this.svgPath.setAttribute("stroke",i):this.svgPath.setAttribute("stroke",n),e=!0)),e||this.svgPath.setAttribute("stroke",t.style.colourTertiary)}}setHasDottedOutlineOnHover(e){(this.hasDottedOutlineOnHover=e)?(this.svgPath.classList.add(n),this.mouseOverData||(this.mouseOverData=s.browserEvents.bind(this.svgRoot,"mouseover",this,()=>{this.svgPath.classList.add("hover")}),this.mouseLeaveData=s.browserEvents.bind(this.svgRoot,"mouseleave",this,()=>{this.svgPath.classList.remove("hover")}))):(this.svgPath.classList.remove(n),this.mouseOverData&&(s.browserEvents.unbind(this.mouseOverData),s.browserEvents.unbind(this.mouseLeaveData),this.mouseOverData=void 0,this.mouseLeaveData=void 0),this.svgPath.classList.remove(n))}setHasError(e){this.hasError=e}isHighlighted(){return!!this.svgPathHighlighted}}(r.PathObject=i).CONNECTION_INDICATOR_RADIUS=9,s.Css.register(`
.blockly-dotted-outline-on-hover {
    transition: stroke .4s;
}
.blockly-dotted-outline-on-hover.hover {
    stroke-dasharray: 2;
    stroke: white;
    stroke-width: 2;
}
.blocklyDisabledPattern>.blocklyPath.pxtRendererHighlight {
    fill: none;
}
`)},{blockly:175}],132:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.Renderer=void 0;var n=e("blockly");let i=e("./pathObject"),s=e("./constants"),a=e("./info"),o=e("./drawer");class l extends n.zelos.Renderer{makePathObject(e,t){return new i.PathObject(e,t,this.getConstants())}makeConstants_(){return new s.ConstantProvider}makeRenderInfo_(e){return new a.RenderInfo(this,e)}makeDrawer_(e,t){return new o.Drawer(e,t)}render(e){e.updateBeforeRender&&e.updateBeforeRender(),super.render(e)}}r.Renderer=l,n.blockRendering.register("pxt",l)},{"./constants":126,"./drawer":128,"./info":130,"./pathObject":131,blockly:175}],133:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.FieldString=void 0;let n=e("blockly");class i extends n.FieldTextInput{initView(){this.quoteSize_=16,this.quoteWidth_=8,this.quoteLeftX_=0,this.quoteRightX_=0,this.quoteY_=10,this.quoteLeft_&&this.quoteLeft_.parentNode.removeChild(this.quoteLeft_),this.quoteLeft_=n.utils.dom.createSvgElement("text",{"font-size":this.quoteSize_+"px",class:"field-text-quote"},this.fieldGroup_),super.initView(),this.quoteRight_&&this.quoteRight_.parentNode.removeChild(this.quoteRight_),this.quoteRight_=n.utils.dom.createSvgElement("text",{"font-size":this.quoteSize_+"px",class:"field-text-quote"},this.fieldGroup_),this.quoteLeft_.appendChild(document.createTextNode('"')),this.quoteRight_.appendChild(document.createTextNode('"'))}updateSize_(e){super.updateSize_(e);var e=this.value_?this.size_.width:1,t=this.positionLeft(e+3);this.textElement_.setAttribute("x",t+""),t+=this.positionRight(t+e+3),this.size_.width=e+t}positionLeft(e){if(!this.quoteLeft_)return 0;let t=0;return t=(this.sourceBlock_.RTL?this.quoteLeftX_=e+this.quoteWidth_+2*i.quotePadding:this.quoteLeftX_=0,this.quoteWidth_+i.quotePadding),this.quoteLeft_.setAttribute("transform","translate("+this.quoteLeftX_+","+this.quoteY_+")"),t}positionRight(e){if(!this.quoteRight_)return 0;let t=0;return t=(this.sourceBlock_.RTL?this.quoteRightX_=i.quotePadding:this.quoteRightX_=e+i.quotePadding,this.quoteWidth_+i.quotePadding),this.quoteRight_.setAttribute("transform","translate("+this.quoteRightX_+","+this.quoteY_+")"),t}}(r.FieldString=i).quotePadding=0,n.Css.register(`
.field-text-quote {
    fill: #a31515 !important;
}
`),n.fieldRegistry.register("field_string",i)},{blockly:175}],134:[function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./fieldString"),r),i(e("./text"),r),i(e("./join"),r)},{"./fieldString":133,"./join":135,"./text":136}],135:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});let i=e("blockly"),s=e("../../fields/field_imagenotext");i.Extensions.registerMutator("pxt_text_join_mutator",{itemCount_:0,valueConnections_:[],mutationToDom:function(){var e=i.utils.xml.createElement("mutation");return e.setAttribute("items",this.itemCount_+""),e},domToMutation:function(e){this.itemCount_=parseInt(e.getAttribute("items"),10),this.updateShape_()},storeValueConnections_:function(){this.valueConnections_=[];for(let e=0;e<this.itemCount_;e++)this.valueConnections_.push(this.getInput("ADD"+e).connection.targetConnection)},restoreValueConnections_:function(){var t;for(let e=0;e<this.itemCount_;e++)null!=(t=this.valueConnections_[e])&&t.reconnect(this,"ADD"+e)},addItem_:function(){this.storeValueConnections_();var e,t,r;this.update_(()=>{this.itemCount_++}),this.restoreValueConnections_(),1<this.itemCount_&&(r=this.getInput("ADD0"))&&r.connection.targetConnection&&(e=this.getInput("ADD"+(this.itemCount_-1)),r=r.connection.getShadowDom())&&(t=i.utils.xml.createElement("shadow"),r=r.getAttribute("type"),t.setAttribute("type",r),t)&&(t.setAttribute("id",i.utils.idGenerator.genUid()),e.connection.setShadowDom(t))},removeItem_:function(){this.storeValueConnections_();this.update_(()=>{this.itemCount_--}),this.restoreValueConnections_()},update_:function(e){i.Events.setGroup(!0);let t=this;var r=t.mutationToDom(),r=r&&i.Xml.domToText(r);e&&e.call(this),this.updateShape_(),t instanceof i.BlockSvg&&t.initSvg();let n=i.Events.getGroup();e=t.mutationToDom(),e=e&&i.Xml.domToText(e);r!=e&&(i.Events.fire(new i.Events.BlockChange(t,"mutation",null,r,e)),setTimeout(function(){i.Events.setGroup(n),t.bumpNeighbours(),i.Events.setGroup(!1)},i.config.bumpDelay)),t.rendered&&t instanceof i.BlockSvg&&t.queueRender(),i.Events.setGroup(!1)},updateShape_:function(){let e=this;this.getInput("EMPTY")&&this.removeInput("EMPTY"),this.getInput("TITLE")||this.appendDummyInput("TITLE").appendField(i.Msg.TEXT_JOIN_TITLE_CREATEWITH);let t;for(t=0;t<this.itemCount_;t++)this.getInput("ADD"+t)||this.appendValueInput("ADD"+t).setAlign(i.inputs.Align.LEFT);for(;this.getInput("ADD"+t);)this.removeInput("ADD"+t),t++;this.getInput("BUTTONS")&&this.removeInput("BUTTONS");var r,n=this.appendDummyInput("BUTTONS"),n=(1<this.itemCount_&&n.appendField(new s.FieldImageNoText(this.REMOVE_IMAGE_DATAURI,24,24,"*",function(){e.removeItem_()},!1)),n.appendField(new s.FieldImageNoText(this.ADD_IMAGE_DATAURI,24,24,"*",function(){e.addItem_()},!1)),this.itemCount_<=4);this.setInputsInline(n),this.workspace instanceof i.WorkspaceSvg&&(r=this.workspace.getRenderer(),this.setOutputShape(n?r.getConstants().SHAPES.ROUND:r.getConstants().SHAPES.SQUARE))}},function(){i.Extensions.apply("inline-svgs",this,!1),this.itemCount_=2,this.updateShape_()}),i.defineBlocksWithJsonArray([{type:"text_join",message0:"",output:"String",outputShape:(new i.zelos.ConstantProvider).SHAPES.ROUND,style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"pxt_text_join_mutator"}])},{"../../fields/field_imagenotext":38,blockly:175}],136:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});r=e("blockly");r.defineBlocksWithJsonArray([{type:"text",message0:"%1",args0:[{type:"field_string",name:"TEXT",text:""}],output:"String",outputShape:(new r.zelos.ConstantProvider).SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]}])},{blockly:175}],137:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.blocksMetrics=r.render=r.renderWorkspace=r.cleanRenderingWorkspace=r.initRenderingWorkspace=void 0;let i=e("blockly"),n=e("./layout"),s=e("./importer"),a,o;function l(){return a||((o=document.createElement("div")).style.position="absolute",o.style.top="0",o.style.left="0",o.style.width="1px",o.style.height="1px",document.body.appendChild(o),a=i.inject(o,{move:{scrollbars:!1},readOnly:!0,sounds:!1,media:pxt.webConfig.commitCdnUrl+"blockly/media/",rtl:pxt.Util.isUserLanguageRtl(),renderer:"pxt"})),(0,s.clearWithoutEvents)(a),a}function c(){a&&a.dispose(),a=void 0}function u(e={emPixels:18,layout:1}){switch(e.splitSvg?1:e.layout||4){case 1:(0,n.verticalAlign)(a,e.emPixels||18);break;case 4:(0,n.flow)(a,{ratio:e.aspectRatio,useViewWidth:e.useViewWidth});break;case 3:a.cleanUp_&&a.cleanUp_()}let t=a.getMetrics();var r=o.querySelectorAll("svg")[0].cloneNode(!0);return(0,n.cleanUpBlocklySvg)(r),pxt.U.toArray(r.querySelectorAll(".blocklyBlockCanvas,.blocklyBubbleCanvas")).forEach(e=>e.setAttribute("transform",`translate(${-t.contentLeft}, ${-t.contentTop}) scale(1)`)),r.setAttribute("viewBox",`0 0 ${t.contentWidth} `+t.contentHeight),e.emPixels&&(r.style.width=t.contentWidth/e.emPixels+"em",r.style.height=t.contentHeight/e.emPixels+"em"),e.splitSvg?(0,n.splitSvg)(r,a,e.emPixels):r}r.initRenderingWorkspace=l,r.cleanRenderingWorkspace=c,r.renderWorkspace=u,r.render=function(e,t={emPixels:18,layout:1}){l();try{var r=e||'<xml xmlns="http://www.w3.org/1999/xhtml"></xml>',n=i.utils.xml.textToDom(r);return(0,s.domToWorkspaceNoEvents)(n,a,{applyHideMetaComment:!0}),u(t)}catch(e){pxt.reportException(e)}finally{c()}},r.blocksMetrics=function(e){if(!(e=e.getTopBlocks(!1)).length)return{width:0,height:0};let t=void 0;return e.forEach(e=>{e=e.getBoundingRectangle();t?(t.l=Math.min(t.l,e.left),t.r=Math.max(t.r,e.right),t.t=Math.min(t.t,e.top),t.b=Math.min(t.b,e.bottom)):t={l:e.left,r:e.right,t:e.top,b:e.bottom}}),{width:t.r-t.l,height:t.b-t.t}}},{"./importer":73,"./layout":75,blockly:175}],138:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.findBlockIdByLine=r.findBlockIdByPosition=void 0,r.findBlockIdByPosition=function(n,i){if(i){let t,r;for(let e=0;e<n.length;++e){var s=n[e];s.startPos<=i.start&&s.endPos>=i.start+i.length&&(!t||r>s.endPos-s.startPos)&&(t=s,r=s.endPos-s.startPos)}return t?t.id:void 0}},r.findBlockIdByLine=function(n,i){if(i){let t,r;for(let e=0;e<n.length;++e){var s=n[e];s.startLine<=i.start&&s.endLine>i.start+i.length&&(!t||r>s.endLine-s.startLine)&&(t=s,r=s.endLine-s.startLine)}return t?t.id:void 0}}},{}],139:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.createFunctionsFlyoutCategory=r.mkReturnStatementBlock=r.mkVariableFieldBlock=r.mkFieldBlock=r.mkPredicateBlock=r.createToolboxBlock=r.createFlyoutGap=r.createFlyoutButton=r.createFlyoutGroupLabel=r.createFlyoutHeadingLabel=r.createShadowValue=r.isArrayType=void 0;let s=e("blockly"),m=e("./plugins/functions"),g=e("./loader"),f=/^(string|number|boolean)$/,_={string:{field:"TEXT",block:"text",defaultValue:""},number:{field:"NUM",block:"math_number",defaultValue:"0"},boolean:{field:"BOOL",block:"logic_boolean",defaultValue:"false"},Array:{field:"VAR",block:"variables_get",defaultValue:"list"}};function y(e){e=/^(?:Array<(.+)>)|(?:(.+)\[\])|(?:\[.+\])$/.exec(e);if(e)return e[1]||e[2]}function b(e,r,n,i,t,s=0){i=i||r.defaultValue,!(n=n||r.shadowBlockId)&&r.range&&(n="math_number_minmax");let a;if(a=i&&'"'==i.slice(0,1)?JSON.parse(i):i,"number"==r.type&&"value"==n)return(o=document.createElement("field")).setAttribute("name",r.definitionName),o.appendChild(document.createTextNode("0")),o;if(r.fieldEditor)return r.defaultValue?((o=document.createElement("field")).setAttribute("name",r.definitionName),o.appendChild(document.createTextNode(r.defaultValue)),o):void 0;var o=pxt.Util.lookup(e.apis.byQName,r.type),l=6==(null==o?void 0:o.kind),o=o&&!!o.attributes.fixedInstances&&!r.shadowBlockId,c="@combined@"==r.type;if(!n&&(l||o||c))return i?((l=document.createElement("field")).setAttribute("name",r.definitionName),l.appendChild(document.createTextNode(i)),l):void 0;o="variables_get"==n,c="text"==n,i=document.createElement("value"),i.setAttribute("name",r.definitionName),l="lists_create_with"!==n&&n?void 0:y(r.type);let u=document.createElement(!o&&!l||t?"shadow":"block");i.appendChild(u);var d=_[l||r.type];if(u.setAttribute("type",n||(l?"lists_create_with":d&&d.block||r.type)),u.setAttribute("colour","#fff"),l){if(d&&!n){let e;switch(l){case"number":e=["0","1"];break;case"string":e=["a","b","c"];break;case"boolean":e=["FALSE","FALSE","FALSE"]}return v(u,d.block,d.field,e),i}if(n&&a)return v(u,a),i}if(!d||n&&d.block!==n&&"math_number_minmax"!==n)a&&((t=document.createElement("field")).textContent=a,o?(t.setAttribute("name","VAR"),u.appendChild(t)):c?(t.setAttribute("name","TEXT"),u.appendChild(t)):n?(l=e.blocksById[n])&&l.attributes._def&&l.attributes._def.parameters.length&&(o=l.attributes._def.parameters[0],t.setAttribute("name",o.name),u.appendChild(t)):(t.setAttribute("name",r.definitionName),u.appendChild(t)));else{c=document.createElement("field");u.appendChild(c);let e;switch(n){case"variables_get":e="VAR";break;case"math_number_minmax":e="SLIDER";break;default:e=d.field}c.setAttribute("name",e);let t;t="boolean"==r.type?document.createTextNode((a||d.defaultValue).toUpperCase()):document.createTextNode(a||d.defaultValue),c.appendChild(t)}let p;if(r.range&&((p=document.createElement("mutation")).setAttribute("min",r.range.min.toString()),p.setAttribute("max",r.range.max.toString()),p.setAttribute("label",r.actualName.charAt(0).toUpperCase()+r.actualName.slice(1)),r.fieldOptions)&&(r.fieldOptions.step&&p.setAttribute("step",r.fieldOptions.step),r.fieldOptions.color&&p.setAttribute("color",r.fieldOptions.color),r.fieldOptions.precision)&&p.setAttribute("precision",r.fieldOptions.precision),r.fieldOptions&&(p=p||document.createElement("mutation")).setAttribute("customfield",JSON.stringify(r.fieldOptions)),p&&u.appendChild(p),s)for(let t of pxt.Util.toArray(i.getElementsByTagName("shadow")))if(!t.innerHTML){var h=e.blocks.find(e=>e.attributes.blockId===t.getAttribute("type"));if(h)for(var m=T(e,h,pxt.blocks.compileInfo(h),!0,s-1);m.firstChild;)t.appendChild(m.firstChild.cloneNode(!0)),m.firstChild.remove()}return i}function v(t,r,n,i){var s=i?i.length:2,e=document.createElement("mutation");e.setAttribute("items",""+s),e.setAttribute("horizontalafter",""+s),t.appendChild(e);for(let e=0;e<s;e++){var a,o=document.createElement("value"),l=(o.setAttribute("name","ADD"+e),document.createElement("shadow"));l.setAttribute("type",r),n&&((a=document.createElement("field")).setAttribute("name",n),i&&a.appendChild(document.createTextNode(i[e])),l.appendChild(a)),o.appendChild(l),t.appendChild(o)}}function o(e,t,r,n){e=i(e,pxt.toolbox.convertColor(t),r,n);return e.setAttribute("web-class","blocklyFlyoutHeading"),e}function l(e,t,r,n){e=i(e,void 0,t);return e.setAttribute("web-class","blocklyFlyoutGroup"),e.setAttribute("web-line","1.5"),r&&e.setAttribute("web-line-width",r),n&&(e.setAttribute("web-help-button","true"),e.setAttribute("callbackKey",n)),e}function i(e,t,r,n){var i=s.utils.xml.createElement("label");return i.setAttribute("text",e),t&&i.setAttribute("web-icon-color",pxt.toolbox.convertColor(t)),r&&(1===r.length?(i.setAttribute("web-icon",r),n&&i.setAttribute("web-icon-class",n)):i.setAttribute("web-icon-class","blocklyFlyoutIcon"+e)),i}function T(r,a,n,i=!1,s=0){let o,e,t,l;if(a.attributes.toolboxParent){var c=r.blocksById[a.attributes.toolboxParent];if(c){var u=pxt.blocks.compileInfo(c);if(t=T(r,c,u,i),a.attributes.toolboxParentArgument)!(l=t.querySelector(`value[name=${a.attributes.toolboxParentArgument}]`))&&u.parameters.some(e=>e.definitionName===a.attributes.toolboxParentArgument)&&((l=document.createElement("value")).setAttribute("name",a.attributes.toolboxParentArgument),t.appendChild(l));else if(!(l=t.querySelector("value")))for(var d of u.parameters)if(!t.querySelector(`field[name=${d.definitionName}]`)){(l=document.createElement("value")).setAttribute("name",d.definitionName),t.appendChild(l);break}if(l)for(;l.firstChild;)l.removeChild(l.firstChild);else t=void 0}}let p=document.createElement(t||i?"shadow":"block");if(p.setAttribute("type",a.attributes.blockId),a.attributes.blockGap?p.setAttribute("gap",a.attributes.blockGap):pxt.appTarget.appTheme&&pxt.appTarget.appTheme.defaultBlockGap&&p.setAttribute("gap",pxt.appTarget.appTheme.defaultBlockGap.toString()),n.thisParameter){c=n.thisParameter,u=!(null==(o=r.apis.byQName[c.type])||!o.attributes.fixedInstances);let e=c.shadowBlockId,t=c.defaultValue;u||e&&"variables_get"!==e||(e="variables_get",t=t||c.definitionName);u=b(r,c,e,t,i,s);u&&p.appendChild(u)}if("ENUM_GET"===a.attributes.shim||"KIND_GET"===a.attributes.shim?null!=(e=a.parameters)&&e.length&&(c=a.parameters[0].default)&&((u=document.createElement("field")).setAttribute("name","MEMBER"),u.textContent=c,p.appendChild(u)):a.parameters&&(n.parameters.filter(e=>f.test(e.type)||f.test(y(e.type))||e.shadowBlockId||e.defaultValue).forEach(e=>{e=b(r,e,void 0,void 0,i,s);e&&p.appendChild(e)}),a.attributes.draggableParameters?n.handlerArgs.forEach(e=>{var t="reporter"===a.attributes.draggableParameters,r=document.createElement("value"),n=(r.setAttribute("name",g.DRAGGABLE_PARAM_INPUT_PREFIX+e.name),t?pxt.blocks.reporterTypeForArgType(e.type):"variables_get_reporter"),i=document.createElement("block"),s=(i.setAttribute("type",n),document.createElement("mutation")),n=(i.appendChild(s),t&&"argument_reporter_custom"===n&&s.setAttribute("typename",e.type),s.setAttribute(m.LOCALIZATION_NAME_MUTATION_KEY,e.localizationKey),document.createElement("field"));n.setAttribute("name",t?"VALUE":"VAR"),n.textContent=pxt.Util.htmlEscape(e.name),i.appendChild(n),r.appendChild(i),p.appendChild(r)}):n.handlerArgs.forEach(e=>{var t=document.createElement("field");t.setAttribute("name","HANDLER_"+e.name),t.textContent=e.name,p.appendChild(t)})),a.attributes.expandArgumentsInToolbox){let e;for(var h of p.children)if("mutation"===h.tagName){e=h;break}e||(e=document.createElement("mutation"),p.appendChild(e)),e.setAttribute("_expanded",""+a.attributes._expandedDef.parameters.length)}return t?(l.appendChild(p),t):p}function n(e,t,r,n){n=document.createElement(n?"shadow":"block"),n.setAttribute("type",pxt.Util.htmlEscape(e)),e=document.createElement("field");return e.setAttribute("name",pxt.Util.htmlEscape(t)),e.textContent=pxt.Util.htmlEscape(r),n.appendChild(e),n}function c(){var e=document.createElement("block"),t=(e.setAttribute("type","function_return"),document.createElement("value")),r=(t.setAttribute("name","RETURN_VALUE"),e.appendChild(t),n("math_number","NUM","0",!0));return t.appendChild(r),e}r.isArrayType=y,r.createShadowValue=b,r.createFlyoutHeadingLabel=o,r.createFlyoutGroupLabel=l,r.createFlyoutButton=function(e,t){var r=s.utils.xml.createElement("button");return r.setAttribute("text",t),r.setAttribute("callbackKey",e),r},r.createFlyoutGap=function(e){var t=s.utils.xml.createElement("sep");return t.setAttribute("gap",e+""),t},r.createToolboxBlock=T,r.mkPredicateBlock=function(e){var t=document.createElement("block");t.setAttribute("type",e);(e=document.createElement("value")).setAttribute("name","PREDICATE"),t.appendChild(e);var r=n("logic_boolean","BOOL","TRUE",!0);return e.appendChild(r),t},r.mkFieldBlock=n,r.mkVariableFieldBlock=function(e,t,r,n,i){return(i=document.createElement(i?"shadow":"block")).setAttribute("type",pxt.Util.htmlEscape(e)),(e=document.createElement("field")).setAttribute("name","VAR"),e.id=t,e.setAttribute("variabletype",pxt.Util.htmlEscape(r)),e.textContent=pxt.Util.htmlEscape(n),i.appendChild(e),i},r.mkReturnStatementBlock=c,r.createFunctionsFlyoutCategory=function(e){var r,t=(0,m.flyoutCategory)(e),n=(1<t.length&&(i=c(),t.splice(1,0,l(lf("Your Functions"))),t.splice(1,0,i)),(0,m.getAllFunctionDefinitionBlocks)(e).filter(e=>e.getDescendants(!1).some(e=>"function_return"===e.type&&e.getInputTargetBlock("RETURN_VALUE"))).map(e=>e.getField("function_name").getText())),i=o(lf("Functions"),pxt.toolbox.getNamespaceColor("functions"),pxt.toolbox.getNamespaceIcon("functions"),"blocklyFlyoutIconfunctions"),s=(t.unshift(i),[]);for(r of t)if(s.push(r),"function_call"===r.getAttribute("type")){var a=r.children.item(0);if(a){let t=a.getAttribute("name");n.some(e=>e===t)&&((a=r.cloneNode(!0)).setAttribute("type","function_call_output"),s.push(a))}}return s}},{"./loader":77,"./plugins/functions":111,blockly:175}],140:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.PxtWorkspaceSearch=void 0;let n=e("blockly");e=e("@blockly/plugin-workspace-search");class i extends e.WorkspaceSearch{constructor(e){super(e),this.injectionDiv=e.getInjectionDiv()}highlightSearchGroup(e){e.forEach(e=>{e=e.pathObject.svgPath;n.utils.dom.addClass(e,"blockly-ws-search-highlight-pxt")})}unhighlightSearchGroup(e){e.forEach(e=>{e=e.pathObject.svgPath;n.utils.dom.removeClass(e,"blockly-ws-search-highlight-pxt")})}open(){super.open(),n.utils.dom.addClass(this.injectionDiv,"blockly-ws-searching")}close(){super.close(),n.utils.dom.removeClass(this.injectionDiv,"blockly-ws-searching")}}r.PxtWorkspaceSearch=i,n.Css.register(`
.blockly-ws-search {
    background: var(--pxt-neutral-background1);
    color: var(--pxt-neutral-foreground1);
    border: solid var(--pxt-neutral-alpha50) 1px;
    border-top: none;
    border-right: none;
    box-shadow: 0px 2px 15px var(--pxt-neutral-alpha50);
}

.blockly-ws-search input {
    -webkit-tap-highlight-color: transparent;
    background: var(--pxt-neutral-background1);
    color: var(--pxt-neutral-foreground1);
    border: none;
}

.blockly-ws-search input::-webkit-input-placeholder {
    color: var(--pxt-neutral-alpha50);
}

.blockly-ws-search input::-moz-placeholder {
    color: var(--pxt-neutral-alpha50);
}

.blockly-ws-search input::-ms-input-placeholder {
    color: var(--pxt-neutral-alpha50);
}

.blockly-ws-search input:active,
.blockly-ws-search input:focus {
    border-color: var(--pxt-neutral-alpha50);
    background: var(--pxt-neutral-background1);
    color: var(--pxt-neutral-foreground1);
}

.blockly-ws-search input::selection {
    color: var(--pxt-neutral-foreground1);
}

.blockly-ws-search button {
    padding-left: 6px;
    padding-right: 6px;
    color: var(--pxt-neutral-foreground1);
}`)},{"@blockly/plugin-workspace-search":170,blockly:175}],141:[function(e,t,r){function i(e,t,r,n){return pxt.Util.toArray(e.getElementsByTagName(t)).filter(e=>e.getAttribute(r)===n)}Object.defineProperty(r,"__esModule",{value:!0}),r.cleanOuterHTML=r.getDirectChildren=r.getFirstChildWithAttr=r.getChildrenWithAttr=r.getBlocksWithType=void 0,r.getBlocksWithType=function(e,t){return i(e,"block","type",t).concat(i(e,"shadow","type",t))},r.getChildrenWithAttr=i,r.getFirstChildWithAttr=function(e,t,r,n){return(e=i(e,t,r,n)).length?e[0]:void 0},r.getDirectChildren=function(t,r){var n=[];for(let e=0;e<t.childNodes.length;e++){var i=t.childNodes.item(e);i.tagName===r&&n.push(i)}return n},r.cleanOuterHTML=function(e){return e.outerHTML.replace(/^<\?[^>]*>/,"")}},{}],142:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getNestedChildBlocks=void 0,r.getNestedChildBlocks=function(t){return t.getDescendants(!0).filter(e=>e.isEnabled()&&e.getSurroundParent()===t)}},{}],143:[function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(r,"__esModule",{value:!0}),i(e("./runValidatorPlan"),r),i(e("./validateBlocksExist"),r),i(e("./validateBlocksInSetExist"),r),i(e("./validateCommentsExist"),r),i(e("./validateSpecificBlockCommentsExist"),r)},{"./runValidatorPlan":144,"./validateBlocksExist":146,"./validateBlocksInSetExist":147,"./validateCommentsExist":148,"./validateSpecificBlockCommentsExist":149}],144:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.runValidatorPlan=void 0;let u=e("./validateBlockFieldValueExists"),d=e("./validateBlocksExist"),p=e("./validateBlocksInSetExist"),h=e("./validateCommentsExist"),m=e("./validateSpecificBlockCommentsExist"),g=e("./getNestedChildBlocks"),f=e("./validateVariableUsage");r.runValidatorPlan=function n(e,t,i){var s,r=Date.now();let a=0,o=[];for(s of t.checks){let r=!1;switch(s.validator){case"blocksExist":[o,r]=[...((e,t)=>{let r=t.blockCounts.reduce((e,t)=>(e[t.blockId]=t.count,e),{}),n=(0,d.validateBlocksExist)({usedBlocks:e,requiredBlockCounts:r}),i=[];if(n.passed)for(var s of t.blockCounts)s=s.blockId,i.push(...n.successfulBlocks[s]);return[i,n.passed]})(e,s)];break;case"blockCommentsExist":r=((e,t)=>(e=(0,h.validateBlockCommentsExist)({usedBlocks:e,numRequired:t.count})).passed)(e,s);break;case"specificBlockCommentsExist":r=((e,t)=>(e=(0,m.validateSpecificBlockCommentsExist)({usedBlocks:e,blockType:t.blockType})).passed)(e,s);break;case"blocksInSetExist":[o,r]=[...((e,t)=>[(e=(0,p.validateBlocksInSetExist)({usedBlocks:e,blockIdsToCheck:t.blocks,count:t.count})).successfulBlocks,e.passed])(e,s)];break;case"blockFieldValueExists":[o,r]=[...((e,t)=>[(e=(0,u.validateBlockFieldValueExists)({usedBlocks:e,fieldType:t.fieldType,fieldValue:t.fieldValue,specifiedBlock:t.blockType})).successfulBlocks,e.passed])(e,s)];break;case"variableUsage":[o,r]=[...((e,t)=>{var r,e=(0,f.validateVariableUsage)({usedBlocks:e,count:t.count,name:t.name}),n=[];for(r of e.passingVarDefinitions.values())n.push(...r);return[n,e.passed]})(e,s)];break;default:return pxt.debug("Unrecognized validator: "+s.validator),pxt.tickEvent("validation.unrecognized_validator",{validator:s.validator}),{executionSuccess:!1,executionErrorMsg:lf("Unrecognized evaluation rule")}}if(r&&s.childValidatorPlans)for(let t of s.childValidatorPlans){let e=0;for(var l of o)l=n((0,g.getNestedChildBlocks)(l),i.find(e=>e.name===t),i),e+=l?1:0;r=r&&0<e}a+=r?1:0}var c=a>=t.threshold;return pxt.tickEvent("validation.evaluation_complete",{plan:t.name,durationMs:Date.now()-r,passed:""+c}),{result:c,executionSuccess:!0}}},{"./getNestedChildBlocks":142,"./validateBlockFieldValueExists":145,"./validateBlocksExist":146,"./validateBlocksInSetExist":147,"./validateCommentsExist":148,"./validateSpecificBlockCommentsExist":149,"./validateVariableUsage":150}],145:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.validateBlockFieldValueExists=void 0,r.validateBlockFieldValueExists=function({usedBlocks:e,fieldType:r,fieldValue:n,specifiedBlock:t}){return{successfulBlocks:e=e.filter(e=>e.isEnabled()&&e.type===t).filter(e=>{var t;return"VAR"===r?(null==(t=e.getVarModels())?void 0:t[0].getName())===n:e.getFieldValue(r)===n}),passed:0<e.length}}},{}],146:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.validateBlocksExist=void 0,r.validateBlocksExist=function({usedBlocks:r,requiredBlockCounts:n}){var i=[],s=[],a=[],o={},l=null==r?void 0:r.reduce((e,t)=>(e[t.type]=(e[t.type]||0)+(t.isEnabled()?1:0),e),{});for(let[t,e]of Object.entries(n||{})){var c=l[t],u=r.filter(e=>e.isEnabled()&&e.type===t);0<u.length&&(o[t]=u),void 0===c?i.push(t):c?c<e&&a.push(t):s.push(t)}return{missingBlocks:i,disabledBlocks:s,insufficientBlocks:a,successfulBlocks:o,passed:0===i.length&&0===s.length&&0===a.length}}},{}],147:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.validateBlocksInSetExist=void 0,r.validateBlocksInSetExist=function({usedBlocks:e,blockIdsToCheck:r,count:t,requireUnique:n}){var i=[],s=e.filter(e=>e.isEnabled());for(let t of r){var a=s.filter(e=>e.type===t);n&&1<=a.length?i.push(a[0]):i.push(...a)}return{successfulBlocks:i,passed:t<=i.length}}},{}],148:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.validateBlockCommentsExist=void 0,r.validateBlockCommentsExist=function({usedBlocks:e,numRequired:t}){return{commentedBlocks:e=e.filter(e=>!!e.getCommentText()),passed:e.length>=t}}},{}],149:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.validateSpecificBlockCommentsExist=void 0,r.validateSpecificBlockCommentsExist=function({usedBlocks:e,blockType:t}){var r=(e=e.filter(e=>e.type===t)).filter(e=>!e.getCommentText());return{uncommentedBlocks:r,passed:0!==e.length&&0===r.length}}},{}],150:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.validateVariableUsage=void 0,r.validateVariableUsage=function({usedBlocks:e,count:t,name:r}){var n,i=new Map,s=new Set;for(n of e)if(n.isEnabled()){var a,o=n.getVarModels();for(a of null!=o?o:[]){var l=a.getName();r&&l!==r||("variables_set"===n.type||"variables_change"===n.type?(i.has(l)||i.set(l,[]),i.get(l).push(n)):s.add(l))}}var c,u,d=new Map;for([c,u]of i)s.has(c)&&d.set(c,u);return{passingVarDefinitions:d,passed:d.size>=t}}},{}],151:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.isBlocks=r.initEditorExtensionsAsync=r.HELP_IMAGE_URI=void 0,r.HELP_IMAGE_URI="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjYiIGhlaWdodD0iMjYiIHZpZXdCb3g9IjAgMCAyNiAyNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMTMiIGN5PSIxMyIgcj0iMTMiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0xNy45NTIgOS4xODQwMkMxNy45NTIgMTAuMjU2IDE3LjgxNiAxMS4wNzIgMTcuNTQ0IDExLjYzMkMxNy4yODggMTIuMTkyIDE2Ljc1MiAxMi43OTIgMTUuOTM2IDEzLjQzMkMxNS4xMiAxNC4wNzIgMTQuNTc2IDE0LjU4NCAxNC4zMDQgMTQuOTY4QzE0LjA0OCAxNS4zMzYgMTMuOTIgMTUuNzM2IDEzLjkyIDE2LjE2OFYxNi45NkgxMS44MDhDMTEuNDI0IDE2LjQ2NCAxMS4yMzIgMTUuODQgMTEuMjMyIDE1LjA4OEMxMS4yMzIgMTQuNjg4IDExLjM4NCAxNC4yODggMTEuNjg4IDEzLjg4OEMxMS45OTIgMTMuNDg4IDEyLjUzNiAxMi45NjggMTMuMzIgMTIuMzI4QzE0LjEwNCAxMS42NzIgMTQuNjI0IDExLjE2OCAxNC44OCAxMC44MTZDMTUuMTM2IDEwLjQ0OCAxNS4yNjQgOS45NjgwMiAxNS4yNjQgOS4zNzYwMkMxNS4yNjQgOC4yMDgwMiAxNC40MTYgNy42MjQwMiAxMi43MiA3LjYyNDAyQzExLjc2IDcuNjI0MDIgMTAuNzUyIDcuNzM2MDIgOS42OTYgNy45NjAwMkw5LjE0NCA4LjA4MDAyTDkgNi4wODgwMkMxMC40ODggNS41NjAwMiAxMS44NCA1LjI5NjAyIDEzLjA1NiA1LjI5NjAyQzE0LjczNiA1LjI5NjAyIDE1Ljk2OCA1LjYwODAyIDE2Ljc1MiA2LjIzMjAyQzE3LjU1MiA2Ljg0MDAyIDE3Ljk1MiA3LjgyNDAyIDE3Ljk1MiA5LjE4NDAyWk0xMS40IDIyVjE4LjY0SDE0LjE4NFYyMkgxMS40WiIgZmlsbD0iIzU5NUU3NCIvPgo8L3N2Zz4K";let n;r.initEditorExtensionsAsync=function(){if(!n&&(n=Promise.resolve(),pxt.appTarget)&&pxt.appTarget.appTheme&&pxt.appTarget.appTheme.extendFieldEditors){let e={};n=n.then(()=>pxt.BrowserUtils.loadBlocklyAsync()).then(()=>pxt.BrowserUtils.loadScriptAsync("fieldeditors.js")).then(()=>pxt.editor.initFieldExtensionsAsync(e)).then(e=>{e.fieldEditors&&e.fieldEditors.forEach(e=>{pxt.blocks.registerFieldEditor(e.selector,e.editor,e.validator)})})}return n},r.isBlocks=function(e){return pxt.U.endsWith(e.name,".blocks")}},{}],152:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.postHostMessageAsync=r.shouldPostHostMessages=r.enableControllerAnalytics=r.bindEditorMessages=void 0;let o=e("./code-validation/runValidatorPlan"),s=e("../pxtservices/iframeEmbeddedClient"),l=e("./projectImport"),c={},a;let u=!(r.bindEditorMessages=function(r){let t=pxt.appTarget.appTheme.allowParentController||pxt.shell.isControllerMode(),n=pxt.appTarget.appTheme.allowPackageExtensions,i=pxt.appTarget.appTheme.allowSimulatorTelemetry;(t||n||i)&&(a=new s.IFrameEmbeddedClient(e=>{let a=e.data;if(!a||!/^pxt(host|editor|pkgext|sim)$/.test(a.type))return!1;if("pxtpkgext"===a.type&&n)r().then(e=>{e.handleExtensionRequest(a)});else if("pxtsim"===a.type&&i){e=a;"event"===e.action&&(e.category||e.message?pxt.reportError(e.category,e.message,e.data):pxt.tickEvent(e.tick,e.data))}else if(t){let t=Promise.resolve(),s=void 0;if("pxthost"==a.type){let e=c[a.id];e?t=t.then(()=>e.resolve(a)):pxt.debug("pxthost: unknown request "+a.id)}else"pxteditor"==a.type&&(t=t.then(()=>r().then(n=>{var e=a;switch(pxt.debug("pxteditor: "+e.action),e.action.toLowerCase()){case"switchjavascript":return Promise.resolve().then(()=>n.openJavaScript());case"switchpython":return Promise.resolve().then(()=>n.openPython());case"switchblocks":return Promise.resolve().then(()=>n.openBlocks());case"startsimulator":return Promise.resolve().then(()=>n.startSimulator());case"restartsimulator":return Promise.resolve().then(()=>n.restartSimulator());case"hidesimulator":return Promise.resolve().then(()=>n.collapseSimulator());case"showsimulator":return Promise.resolve().then(()=>n.expandSimulator());case"closeflyout":return Promise.resolve().then(()=>n.closeFlyout());case"unloadproject":return Promise.resolve().then(()=>n.unloadProjectAsync());case"saveproject":return n.saveProjectAsync();case"compile":return n.compile();case"redo":return Promise.resolve().then(()=>{var e=n.editor;e&&e.hasRedo()&&e.redo()});case"undo":return Promise.resolve().then(()=>{var e=n.editor;e&&e.hasUndo()&&e.undo()});case"setscale":{let e=a;return Promise.resolve().then(()=>n.editor.setScale(e.scale))}case"stopsimulator":{let e=a;return Promise.resolve().then(()=>n.stopSimulator(e.unload))}case"newproject":{let e=a;return Promise.resolve().then(()=>n.newProject(e.options))}case"importproject":{let e=a;return Promise.resolve().then(()=>n.importProjectAsync(e.project,{filters:e.filters,searchBar:e.searchBar}))}case"importexternalproject":var i=a;return(0,l.saveProjectAsync)(i.project).then(e=>{e=location.origin+location.pathname+"#embedimport:"+e;s={importUrl:e}});case"openheader":i=a;return n.openProjectByHeaderIdAsync(i.headerId);case"startactivity":{let e=a,t=e.path,r=void 0;return/^([jt]s|py|blocks?):/i.test(t)&&(r=/^py:/i.test(t)?pxt.PYTHON_PROJECT_NAME:/^[jt]s:/i.test(t)?pxt.JAVASCRIPT_PROJECT_NAME:pxt.BLOCKS_PROJECT_NAME,t=t.substr(t.indexOf(":")+1)),Promise.resolve().then(()=>n.startActivity({activity:e.activityType,path:t,title:e.title,editor:r,previousProjectHeaderId:e.previousProjectHeaderId,carryoverPreviousCode:e.carryoverPreviousCode}))}case"importtutorial":{let e=a;return Promise.resolve().then(()=>n.importTutorialAsync(e.markdown))}case"proxytosim":{let e=a;return Promise.resolve().then(()=>n.proxySimulatorMessage(e.content))}case"renderblocks":{let e=a;return Promise.resolve().then(()=>n.renderBlocksAsync(e)).then(e=>e.xml.then(e=>{s=e.xml}))}case"renderxml":{let e=a;return Promise.resolve().then(()=>n.renderXml(e).resultXml.then(e=>{s=e.xml}))}case"renderbyblockid":{let e=a;return Promise.resolve().then(()=>n.renderByBlockIdAsync(e)).then(e=>e.resultXml.then(e=>{s=e.xml}))}case"runeval":{i=a;let t=i.validatorPlan,r=i.planLib;return Promise.resolve().then(()=>{var e=n.getBlocks();return(0,o.runValidatorPlan)(e,t,r)}).then(e=>{s=e})}case"gettoolboxcategories":{let e=a;return Promise.resolve().then(()=>{s=n.getToolboxCategories(e.advanced)})}case"getblockastext":{let t=a;return Promise.resolve().then(()=>{var e=n.getBlockAsText(t.blockId);s={blockAsText:e}})}case"renderpython":{let e=a;return Promise.resolve().then(()=>n.renderPythonAsync(e)).then(e=>{s=e.python})}case"toggletrace":{let e=a;return Promise.resolve().then(()=>n.toggleTrace(e.intervalSpeed))}case"settracestate":{let e=a;return Promise.resolve().then(()=>n.setTrace(e.enabled,e.intervalSpeed))}case"setsimulatorfullscreen":{let e=a;return Promise.resolve().then(()=>n.setSimulatorFullScreen(e.enabled))}case"showthemepicker":return Promise.resolve().then(()=>n.showThemePicker());case"togglehighcontrast":return Promise.resolve().then(()=>n.toggleHighContrast());case"sethighcontrast":{let e=a;return Promise.resolve().then(()=>n.setHighContrast(e.on))}case"togglegreenscreen":return Promise.resolve().then(()=>n.toggleGreenScreen());case"togglekeyboardcontrols":return Promise.resolve().then(()=>n.toggleAccessibleBlocks("editormessage"));case"print":return Promise.resolve().then(()=>n.printCode());case"pair":return n.pairAsync().then(()=>{});case"info":return Promise.resolve().then(()=>{s={versions:pxt.appTarget.versions,locale:ts.pxtc.Util.userLanguage(),availableLocales:pxt.appTarget.appTheme.availableLocales,keyboardControls:n.isAccessibleBlocks()}});case"shareproject":i=a;return n.anonymousPublishHeaderByIdAsync(i.headerId,i.projectName).then(e=>{s=e});case"savelocalprojectstocloud":i=a;return n.saveLocalProjectsToCloudAsync(i.headerIds).then(e=>{s={headerIdMap:e}});case"requestprojectcloudstatus":i=a;return n.requestProjectCloudStatus(i.headerIds);case"convertcloudprojectstolocal":i=a;return n.convertCloudProjectsToLocal(i.userId);case"setlanguagerestriction":i=a;if("no-blocks"===i.restriction)throw pxt.warn("no-blocks language restriction is not supported"),new Error("no-blocks language restriction is not supported");return n.setLanguageRestrictionAsync(i.restriction);case"precachetutorial":{i=a;let e=i.data,t=i.lang||pxt.Util.userLanguage();return pxt.github.db.cacheReposAsync(e).then(async()=>{"string"==typeof e.markdown&&await(await pxt.BrowserUtils.translationDbAsync()).setAsync(t,e.path,void 0,void 0,e.markdown)})}case"setcolorthemebyid":i=a;return n.setColorThemeById(i.colorThemeId,!!i.savePreference),Promise.resolve()}return Promise.resolve()})));t.then(()=>d(a,s,!0,void 0),e=>d(a,s,!1,e))}return!0}))});function d(e,t,r,n){e.response&&(e={type:e.type,id:e.id,resp:t,success:r,error:n},a?a.postMessage(e):window.parent.postMessage(e,"*"))}function p(n){return new Promise((e,t)=>{var r=pxt.Util.clone(n);if(r.id=ts.pxtc.Util.guidGen(),n.response&&(c[r.id]={resolve:e,reject:t}),a?a.postMessage(r):window.parent.postMessage(r,"*"),pxt.commands.onPostHostMessage)try{pxt.commands.onPostHostMessage(r)}catch(e){pxt.reportException(e)}n.response||e(void 0)})}r.enableControllerAnalytics=function(){if(!u){var e=!!pxt.commands.onPostHostMessage,t=pxt.appTarget.appTheme.allowParentController,r=pxt.BrowserUtils.isIFrame();if(e||t&&r){let r=pxt.tickEvent,n=(pxt.tickEvent=function(e,t){r&&r(e,t),p({type:"pxthost",action:"event",tick:e,response:!1,data:t})},pxt.reportException),i=(pxt.reportException=function(e,t){n&&n(e,t);try{p({type:"pxthost",action:"event",tick:"error",message:e.message,response:!1,data:t})}catch(e){}},pxt.reportError);pxt.reportError=function(e,t,r){i&&i(e,t,r),p({type:"pxthost",action:"event",tick:"error",category:e,message:t,data:r})},u=!0}}},r.shouldPostHostMessages=function(){return pxt.appTarget.appTheme.allowParentController&&pxt.BrowserUtils.isIFrame()},r.postHostMessageAsync=p},{"../pxtservices/iframeEmbeddedClient":168,"./code-validation/runValidatorPlan":144,"./projectImport":163}],153:[function(e,t,r){function n(e){return"experiments-"+("object"==typeof e?e.id:e)}Object.defineProperty(r,"__esModule",{value:!0}),r.setState=r.state=r.toggle=r.isEnabled=r.someEnabled=r.clear=r.all=r.syncTheme=r.setEditorExtensionExperiments=void 0;let i;function s(){let r=pxt.savedAppTheme(),n={};var e=a();return e.forEach(e=>{var t=o(e);r[e.id]=!!t,t&&(n[e.id]=t?1:0)}),e.length&&Object.keys(n).length&&(pxt.tickEvent("experiments.loaded",n),pxt.reloadAppTargetVariant()),pxt.appTarget.appTheme}function a(){let t=pxt.appTarget.appTheme.experiments;return t?[{id:"print",name:lf("Print Code"),description:lf("Print the code from the current project"),feedbackUrl:"https://github.com/microsoft/pxt/issues/4740"},{id:"greenScreen",name:lf("Green screen"),description:lf("Display a webcam video stream or a green background behind the code."),feedbackUrl:"https://github.com/microsoft/pxt/issues/4738"},{id:"allowPackageExtensions",name:lf("Editor Extensions"),description:lf("Allow Extensions to add buttons in the editor."),feedbackUrl:"https://github.com/microsoft/pxt/issues/4741"},{id:"instructions",name:lf("Wiring Instructions"),description:lf("Generate step-by-step assembly instructions for breadboard wiring."),feedbackUrl:"https://github.com/microsoft/pxt/issues/4739"},{id:"debugger",name:lf("Debugger"),description:lf("Step through code and inspect variables in the debugger"),feedbackUrl:"https://github.com/microsoft/pxt/issues/4729"},{id:"bluetoothUartConsole",name:"Bluetooth Console",description:lf("Receives UART message through Web Bluetooth"),feedbackUrl:"https://github.com/microsoft/pxt/issues/4796"},{id:"bluetoothPartialFlashing",name:"Bluetooth Download",description:lf("Download code via Web Bluetooth"),feedbackUrl:"https://github.com/microsoft/pxt/issues/4807"},{id:"simScreenshot",name:lf("Simulator Screenshots"),description:lf("Download screenshots of the simulator"),feedbackUrl:"https://github.com/microsoft/pxt/issues/5232"},{id:"python",name:lf("Static Python"),description:lf("Use Static Python to code your device"),feedbackUrl:"https://github.com/microsoft/pxt/issues/5390"},{id:"simGif",name:lf("Simulator Gifs"),description:lf("Download gifs of the simulator"),feedbackUrl:"https://github.com/microsoft/pxt/issues/5297"},{id:"qrCode",name:lf("Shared QR Code"),description:lf("Generate a QR Code form the shared project url"),feedbackUrl:"https://github.com/microsoft/pxt/issues/5456"},{id:"importExtensionFiles",name:lf("Import Extension Files"),description:lf("Import Extensions from compiled project files")},{id:"debugExtensionCode",name:lf("Debug Extension Code"),description:lf("Use the JavaScript debugger to debug extension code")},{id:"advancedBlockDebugger",name:lf("Advanced Blocks Debugger"),description:lf("Enables extra options and variables in the Blocks debugger")},{id:"snippetBuilder",name:lf("Snippet Builder"),description:lf("Try out the new snippet dialogs.")},{id:"experimentalHw",name:lf("Experimental Hardware"),description:lf("Enable support for hardware marked 'experimental' in the hardware seletion dialog")},{id:"checkForHwVariantWebUSB",name:lf("Detect Hardware with WebUSB"),description:lf("When compiling, use WebUSB to detect hardware configuration.")},{id:"githubEditor",name:lf("GitHub editor"),description:lf("Review, commit and push to GitHub."),feedbackUrl:"https://github.com/microsoft/pxt/issues/6419",enableOnline:!0},{id:"githubCompiledJs",name:lf("GitHub Pages JavaScript"),description:lf("Commit compiled javascript when creating a release"),enableOnline:!0},{id:"blocksCollapsing",name:lf("Collapse blocks"),description:lf("Collapse and expand functions or event blocks")},{id:"tutorialBlocksDiff",name:lf("Tutorial Block Diffs"),description:lf("Automatially render blocks diff in tutorials")},{id:"openProjectNewTab",name:lf("Open in New Tab"),description:lf("Open an editor in a new tab.")},{id:"openProjectNewDependentTab",name:lf("Open in New Connected Tab"),description:lf("Open connected editors in different browser tabs.")},{id:"errorList",name:lf("Error List"),description:lf("Show an error list panel for JavaScript and Python.")},{id:"timeMachine",name:lf("Time Machine"),description:lf("Save and restore past versions of a project")},{id:"forceEnableAiErrorHelp",name:lf("AI Error Explainer"),description:lf("Get AI's help explaining errors in your code"),feedbackUrl:"https://github.com/microsoft/pxt/issues/10694",enableOnline:!0}].filter(e=>-1<t.indexOf(e.id)).concat(i||[]).filter(e=>!(pxt.BrowserUtils.isPxtElectron()&&e.enableOnline)):[]}function o(e){return!!pxt.storage.getLocal(n(e))}function l(e,t){t!=o(e)&&(t?pxt.storage.setLocal(n(e),"1"):pxt.storage.removeLocal(n(e)),s())}r.setEditorExtensionExperiments=function(e){i=e},r.syncTheme=s,r.all=a,r.clear=function(){a().forEach(e=>pxt.storage.removeLocal(n(e))),s()},r.someEnabled=function(){return a().some(e=>o(e))},r.isEnabled=o,r.toggle=function(e){e.onClick?e.onClick():l(e,!o(e))},r.state=function(){let t={};return a().forEach(e=>t[e.id]=o(e)),JSON.stringify(t)},r.setState=l},{}],154:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.patchConfigEditorVersion=r.getTextAtTime=r.updateShareHistory=r.pushSnapshotOnHistory=r.updateHistory=r.parseHistoryFile=r.applySnapshot=r.createSnapshot=r.applyDiff=r.diffScriptText=r.collapseHistory=void 0;let n=3e5,m=18e5,g=864e5;function f(e,t,r,n,i){var s=[],a=e.entries.slice();let o=Object.assign({},t),{interval:l,minTime:c,maxTime:u}=r,d=(void 0===c&&(c=0),void 0===u&&(u=e.lastSaveTime),Object.assign({},o)),p=e.lastSaveTime;for(;a.length;){var h=a.pop();o=y(o,h,i),h.timestamp>u?(s.unshift(h),d=Object.assign({},o),p=h.timestamp):h.timestamp<c?d?(s.unshift({timestamp:h.timestamp,editorVersion:h.editorVersion,changes:_(o,d,h.timestamp,n).changes}),d=void 0):s.unshift(h):p-h.timestamp>=l&&(s.unshift({timestamp:h.timestamp,editorVersion:h.editorVersion,changes:_(o,d,h.timestamp,n).changes}),d=Object.assign({},o),p=h.timestamp)}return d&&p>e.entries[0].timestamp&&s.unshift({timestamp:e.entries[0].timestamp,editorVersion:e.entries[0].editorVersion,changes:_(o,d,e.entries[0].timestamp,n).changes}),Object.assign(Object.assign({},e),{entries:s})}function _(e,t,r,n){var i,s,a=[];for(i of Object.keys(e))(i.endsWith(".ts")||i.endsWith(".jres")||i.endsWith(".py")||i.endsWith(".blocks")||"pxt.json"===i)&&(null==t[i]?a.push({type:"removed",filename:i,value:e[i]}):e[i]!==t[i]&&a.push({type:"edited",filename:i,patch:n(t[i],e[i])}));for(s of Object.keys(t))(s.endsWith(".ts")||s.endsWith(".jres")||s.endsWith(".py")||s.endsWith(".blocks")||"pxt.json"===s)&&null==e[s]&&a.push({type:"added",filename:s,value:t[s]});if(a.length)return{timestamp:r,editorVersion:null==(r=null==(r=pxt.appTarget)?void 0:r.versions)?void 0:r.target,changes:a}}function y(e,t,r){var n,i=Object.assign({},e);for(n of t.changes)"added"===n.type?delete i[n.filename]:"removed"===n.type?i[n.filename]=n.value:i[n.filename]=r(n.patch,e[n.filename]);return i}function i(t){let r;try{r={};var e,n=JSON.parse(t[pxt.CONFIG_NAME]);for(e of n.files)e===pxt.IMAGES_CODE||e===pxt.TILEMAP_CODE?r[e]="":r[e]=t[e];if(r[pxt.CONFIG_NAME]=t[pxt.CONFIG_NAME],n.preferredEditor===pxt.BLOCKS_PROJECT_NAME?r[pxt.MAIN_BLOCKS]&&(r[pxt.MAIN_TS]=""):n.preferredEditor===pxt.PYTHON_PROJECT_NAME&&r[pxt.MAIN_PY]&&(r[pxt.MAIN_TS]=""),n.testFiles)for(var i of n.testFiles)r[i]=t[i]}catch(e){r=Object.assign({},t)}return r[pxt.HISTORY_FILE]&&delete r[pxt.HISTORY_FILE],r}function b(e){e=JSON.parse(e);return e.entries||(e.entries=[]),e.shares||(e.shares=[]),e.snapshots||(e.snapshots=[]),e}function o(e,t){e=Object.assign({},e);try{var r=JSON.parse(e[pxt.CONFIG_NAME]);r.targetVersions&&(r.targetVersions.target=t),e[pxt.CONFIG_NAME]=JSON.stringify(r,null,4)}catch(e){}return{files:e,editorVersion:t}}function v(e,t){return{timestamp:t,editorVersion:pxt.appTarget.versions.target,text:i(e)}}function T(){var e;return null!=(null==(e=null==(e=pxt.appTarget)?void 0:e.appTheme)?void 0:e.timeMachineDiffInterval)?pxt.appTarget.appTheme.timeMachineDiffInterval:n}r.collapseHistory=function(e,t,r,n){e[pxt.HISTORY_FILE]&&(t=f(b(e[pxt.HISTORY_FILE]),e,t,r,n),e[pxt.HISTORY_FILE]=JSON.stringify(t))},r.diffScriptText=_,r.applyDiff=y,r.createSnapshot=i,r.applySnapshot=function(t,r){var e;try{var n,i=Object.assign({},r),s=JSON.parse(t[pxt.CONFIG_NAME]);for(n of Object.keys(t))n===pxt.HISTORY_FILE||-1!==s.files.indexOf(n)||-1!==(null==(e=s.testFiles)?void 0:e.indexOf(n))||i[n]||(i[n]=t[n]);return i}catch(e){var a,o=Object.assign({},t);for(a of Object.keys(r))o[a]=r[a];return o}},r.parseHistoryFile=b,r.updateHistory=function(r,t,n,i,s,a,o=!1){let l;r[pxt.HISTORY_FILE]?void 0===(l=b(r[pxt.HISTORY_FILE])).lastSaveTime&&(l.lastSaveTime=n):l={entries:[],snapshots:[v(r,n-1)],shares:[],lastSaveTime:n};var c,u,d=l.lastSaveTime;for(let t of i)l.shares.some(e=>e.id===t.id)||l.shares.push({id:t.id,timestamp:n});if(!((e,t)=>{var r=Object.keys(e),n=Object.keys(t);if(r.length===n.length){for(var i of r){if(-1===n.indexOf(i))return;if(e[i]!==t[i])return}return 1}})(r,t)){let e=!1;if(1===l.entries.length?n-l.entries[l.entries.length-1].timestamp<T()&&(e=!0):1<l.entries.length&&(i=l.entries[l.entries.length-1].timestamp,c=l.entries[l.entries.length-2].timestamp,n-i<T())&&i-c<T()&&(e=!0),e?(c=_(y(r,i=l.entries.pop(),a),t,i.timestamp,s))&&l.entries.push(c):(i=_(r,t,l.lastSaveTime,s))&&l.entries.push(i),(l=o&&Math.floor(d/g)!==Math.floor(n/g)?f(l,t,{interval:72e5,maxTime:n-g},s,a):l).lastSaveTime=n,0==l.snapshots.length)l.snapshots.push(v(r,n-1));else if(n-l.snapshots[l.snapshots.length-1].timestamp>=(null==(null==(c=null==(c=pxt.appTarget)?void 0:c.appTheme)?void 0:c.timeMachineSnapshotInterval)?m:pxt.appTarget.appTheme.timeMachineSnapshotInterval)){l.snapshots.push(v(r,n));var p=[];let t=Math.floor(n/g)*g;for(let e=0;e<l.snapshots.length;e++){var h=l.snapshots[l.snapshots.length-1-e];n-h.timestamp<g||e===l.snapshots.length-1?p.unshift(h):h.timestamp<t&&(p.unshift(h),t=Math.floor(h.timestamp/g)*g)}l.snapshots=p}for(u of l.snapshots)u.text[pxt.HISTORY_FILE]&&delete u.text[pxt.HISTORY_FILE]}t[pxt.HISTORY_FILE]=JSON.stringify(l)},r.pushSnapshotOnHistory=function(e,t){let r;(r=e[pxt.HISTORY_FILE]?b(e[pxt.HISTORY_FILE]):{entries:[],snapshots:[],shares:[],lastSaveTime:t}).snapshots.push(v(e,t)),e[pxt.HISTORY_FILE]=JSON.stringify(r)},r.updateShareHistory=function(e,r,n){let i;i=e[pxt.HISTORY_FILE]?b(e[pxt.HISTORY_FILE]):{entries:[],snapshots:[],shares:[],lastSaveTime:r};for(let t of n)i.shares.some(e=>e.id===t.id)||i.shares.push({id:t.id,timestamp:r});e[pxt.HISTORY_FILE]=JSON.stringify(i)},r.getTextAtTime=function(e,t,r,n){let i=Object.assign({},e);for(let e=0;e<t.entries.length;e++){var s=t.entries.length-1-e,a=t.entries[s];if(i=y(i,a,n),a.timestamp===r)return s=(0<s?t.entries[s-1]:a).editorVersion,o(i,s)}return{files:i,editorVersion:pxt.appTarget.versions.target}},r.patchConfigEditorVersion=o},{}],155:[function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&("get"in i?t.__esModule:!i.writable&&!i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){e[n=void 0===n?r:n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},s=(Object.defineProperty(r,"__esModule",{value:!0}),r.importDb=r.validation=r.experiments=r.workspace=r.monaco=r.history=void 0,e("./history")),s=(r.history=s,e("./monaco")),s=(r.monaco=s,e("./workspace")),s=(r.workspace=s,e("./experiments")),s=(r.experiments=s,e("./code-validation")),s=(r.validation=s,e("./projectImport"));r.importDb=s,i(e("./editor"),r),i(e("./editorcontroller"),r),i(e("./monaco-fields/monacoFieldEditor"),r),i(e("./monaco-fields/field_tilemap"),r),i(e("./monaco-fields/field_musiceditor"),r),i(e("./monaco-fields/field_soundEffect"),r),i(e("./monaco-fields/field_sprite"),r),i(e("./monaco-fields/field_react"),r)},{"./code-validation":143,"./editor":151,"./editorcontroller":152,"./experiments":153,"./history":154,"./monaco":162,"./monaco-fields/field_musiceditor":156,"./monaco-fields/field_react":157,"./monaco-fields/field_soundEffect":158,"./monaco-fields/field_sprite":159,"./monaco-fields/field_tilemap":160,"./monaco-fields/monacoFieldEditor":161,"./projectImport":163,"./workspace":164}],156:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.songEditorDefinition=r.MonacoSongEditor=void 0;var n=e("./field_react"),e=e("./monacoFieldEditor");let i="music-editor";class s extends n.MonacoReactFieldEditor{textToValue(e){this.isPython=-1===e.indexOf("`"),this.text=e;var t,r,n=pxt.parseAssetTSReference(e);return n?(n=n.name,n=n.trim(),r=pxt.react.getTilemapProject(),this.isAsset=!0,(t=r.lookupAssetByName("song",n))?this.editing=t:(t=r.createNewSong(pxt.assets.music.getEmptySong(2)),n&&!r.isNameTaken("song",n)&&pxt.validateAssetName(n)&&(t.meta.displayName=n),this.editing=t)):(r=/hex\s*(?:`|\(""")\s*([a-fA-F0-9]*)\s*(?:`|"""\))\s*(?:;?)/m.exec(e))?(n=r[1].trim(),this.editing=a(n?pxt.assets.music.decodeSongFromHex(n):pxt.assets.music.getEmptySong(2)),this.editing):void 0}resultToText(e){var t,r=pxt.react.getTilemapProject();if(r.pushUndo(),null!=(t=(e=pxt.patchTemporaryAsset(this.editing,e,r)).meta)&&t.displayName)return e=this.isAsset||r.lookupAsset(e.type,e.id)?r.updateAsset(e):r.createNewSong(e.song,e.meta.displayName),this.isAsset=!0,pxt.getTSReferenceForAsset(e,this.isPython);let n=pxt.assets.music.encodeSongToHex(e.song);return n=this.isPython?`hex("""${n}""")`:"hex`"+n+"`",this.text.replace(/hex\s*(?:`|\(""")\s*([a-fA-F0-9]*)\s*(?:`|"""\))\s*(?:;?)/m,n)}getFieldEditorId(){return i}getOptions(){return{blocksInfo:this.host.blocksInfo()}}}function a(e){return{type:"song",id:"",internalID:0,meta:{},song:e}}r.MonacoSongEditor=s,r.songEditorDefinition={id:i,foldMatches:!0,glyphCssClass:"fas fa-music sprite-focus-hover",heightInPixels:510,matcher:{searchString:'(?:(?:assets\\s*\\.\\s*song)|(?:music\\s*\\.\\s*create(?:S|_s)ong\\s*\\(\\s*hex))\\s*(?:`|\\(\\s*""")(?:(?:[^(){}:\\[\\]"\';?/,+\\-=*&|^%!`~]|\\n)*)\\s*(?:`|"""\\s*\\))',isRegex:!0,matchCase:!0,matchWholeWord:!1},proto:s},(0,e.registerMonacoFieldEditor)(i,r.songEditorDefinition)},{"./field_react":157,"./monacoFieldEditor":161}],157:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.MonacoReactFieldEditor=void 0;r.MonacoReactFieldEditor=class{getId(){return"image-editor"}showEditorAsync(e,t,r){return this.fileType=e,this.editrange=t,this.host=r,this.initAsync().then(()=>{var e=this.textToValue(r.getText(t));return e?(this.fv=pxt.react.getFieldEditorView(this.getFieldEditorId(),e,this.getOptions()),this.fv.onHide(()=>{this.onClosed()}),this.fv.show(),new Promise((e,t)=>{this.resolver=e,this.rejecter=t})):Promise.resolve(null)})}onClosed(){this.resolver&&(this.resolver({range:this.editrange,replacement:this.resultToText(this.fv.getResult())}),this.editrange=void 0,this.resolver=void 0,this.rejecter=void 0)}dispose(){this.onClosed()}initAsync(){return Promise.resolve()}textToValue(e){return null}resultToText(e){return e+""}getFieldEditorId(){return""}getOptions(){return null}}},{}],158:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.soundEditorDefinition=r.MonacoSoundEffectEditor=void 0;var n=e("./field_react"),e=e("./monacoFieldEditor");let i="soundeffect-editor";class s extends n.MonacoReactFieldEditor{textToValue(e){var t={wave:"sine",startFrequency:5e3,endFrequency:0,startVolume:255,endVolume:0,duration:500,effect:"none",interpolation:"linear"};this.value=t;e=/\(([^)]*)\)/.exec(e)[1].split(",").map(e=>e.replace(/\s/g,""));if(8===e.length){switch(e[0]){case"WaveShape.Sawtooth":t.wave="sawtooth";break;case"WaveShape.Square":t.wave="square";break;case"WaveShape.Noise":t.wave="noise";break;case"WaveShape.Triangle":t.wave="triangle";break;default:t.wave="sine"}var r=(e,t)=>isNaN(e)?t:e;switch(t.startFrequency=r(parseInt(e[1]),t.startFrequency),t.endFrequency=r(parseInt(e[2]),t.endFrequency),t.startVolume=r(parseInt(e[3]),t.startVolume),t.endVolume=r(parseInt(e[4]),t.endVolume),t.duration=r(parseInt(e[5]),t.duration),e[6]){case"SoundExpressionEffect.Vibrato":t.effect="vibrato";break;case"SoundExpressionEffect.Tremolo":t.effect="tremolo";break;case"SoundExpressionEffect.Warble":t.effect="warble";break;default:t.effect="none"}switch(e[7]){case"InterpolationCurve.Logarithmic":t.interpolation="logarithmic";break;case"InterpolationCurve.Curve":t.interpolation="curve";break;default:t.interpolation="linear"}}return t}resultToText(e){let t;switch((e=this.value).wave){case"sine":t="WaveShape.Sine";break;case"square":t="WaveShape.Square";break;case"triangle":t="WaveShape.Triangle";break;case"noise":t="WaveShape.Noise";break;case"sawtooth":t="WaveShape.Sawtooth"}let r;switch(e.effect){case"vibrato":r="SoundExpressionEffect.Vibrato";break;case"tremolo":r="SoundExpressionEffect.Tremolo";break;case"warble":r="SoundExpressionEffect.Warble";break;case"none":r="SoundExpressionEffect.None"}let n;switch(e.interpolation){case"curve":n="InterpolationCurve.Curve";break;case"linear":n="InterpolationCurve.Linear";break;case"logarithmic":n="InterpolationCurve.Logarithmic"}return`music.createSoundEffect(${t}, ${Math.round(e.startFrequency)}, ${Math.round(e.endFrequency)}, ${Math.round(e.startVolume)}, ${Math.round(e.endVolume)}, ${Math.round(e.duration)}, ${r}, ${n})`}getFieldEditorId(){return i}getOptions(){return{onClose:()=>this.fv.hide(),onSoundChange:e=>this.value=e,initialSound:this.value,useFlex:!0,useMixerSynthesizer:"microbit"!==pxt.appTarget.id}}}r.MonacoSoundEffectEditor=s,r.soundEditorDefinition={id:i,foldMatches:!0,glyphCssClass:"fas fa-music sprite-focus-hover",heightInPixels:510,matcher:{searchString:"music\\s*\\.\\s*createSoundEffect\\s*\\(",isRegex:!0,matchCase:!0,matchWholeWord:!1,validateRange:function(e,t){let r=e.startLineNumber,n=0,i=!1,s=0;for(var a="createSoundEffect",o=t.getLineCount();r<o;){var l=t.getLineContent(r),c=l.indexOf(a);if(-1!==c&&(i=!0,n=c+a.length),i)for(;n<l.length;){var u=l.charAt(n);if("("===u)s++;else if(")"===u&&0===--s)return new monaco.Range(e.startLineNumber,e.startColumn,r,n+t.getLineMinColumn(r)+1);n++}n=0,r++}}},proto:s},(0,e.registerMonacoFieldEditor)(i,r.soundEditorDefinition)},{"./field_react":157,"./monacoFieldEditor":161}],159:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.spriteEditorDefinition=r.MonacoSpriteEditor=void 0;var n=e("./field_react"),e=e("./monacoFieldEditor"),i="image-editor";class s extends n.MonacoReactFieldEditor{textToValue(e){this.isPython=-1===e.indexOf("`"),this.template=e.startsWith("bmp")?"bmp":"img";var t,r,n=pxt.parseAssetTSReference(e);return n?(n=n.name,n=n.trim(),t=pxt.react.getTilemapProject(),this.isAsset=!0,(r=t.lookupAssetByName("image",n))?this.editing=r:(r=t.createNewImage(),n&&!t.isNameTaken("image",n)&&pxt.validateAssetName(n)&&(r.meta.displayName=n),this.editing=r)):(this.editing={type:"image",id:"",internalID:0,bitmap:pxt.sprite.imageLiteralToBitmap(e,this.template).data(),meta:{},jresData:""},this.editing)}resultToText(e){var t,r=pxt.react.getTilemapProject();return r.pushUndo(),null!=(t=(e=pxt.patchTemporaryAsset(this.editing,e,r)).meta)&&t.displayName?(e=this.isAsset||r.lookupAsset(e.type,e.id)?r.updateAsset(e):r.createNewProjectImage(e.bitmap,e.meta.displayName),this.isAsset=!0,pxt.getTSReferenceForAsset(e,this.isPython)):pxt.sprite.bitmapToImageLiteral(pxt.sprite.Bitmap.fromData(e.bitmap),this.isPython?"python":"typescript",this.template)}getFieldEditorId(){return"image-editor"}getOptions(){return{initWidth:16,initHeight:16,blocksInfo:this.host.blocksInfo()}}}r.MonacoSpriteEditor=s,r.spriteEditorDefinition={id:i,foldMatches:!0,glyphCssClass:"sprite-editor-glyph sprite-focus-hover",heightInPixels:510,matcher:{searchString:'(?:img|bmp|assets\\s*\\.\\s*image)\\s*(?:`|\\(\\s*""")(?:(?:[^(){}:\\[\\]"\';?/,+\\-=*&|^%!`~]|\\n)*)\\s*(?:`|"""\\s*\\))',isRegex:!0,matchCase:!0,matchWholeWord:!1},proto:s},(0,e.registerMonacoFieldEditor)(i,r.spriteEditorDefinition)},{"./field_react":157,"./monacoFieldEditor":161}],160:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.tilemapEditorDefinition=r.MonacoTilemapEditor=void 0;var n=e("./field_react"),e=e("./monacoFieldEditor"),i="tilemap-editor";class s extends n.MonacoReactFieldEditor{textToValue(e){var e=this.readTilemap(e),t=pxt.react.getTilemapProject();return pxt.sprite.addMissingTilemapTilesAndReferences(t,e),this.editing=e}readTilemap(e){var r=pxt.react.getTilemapProject();if(/^\s*tiles\s*\./.test(e)&&(this.isTilemapLiteral=!1,e)){try{return{type:"tilemap",id:"",internalID:0,meta:{},data:pxt.sprite.decodeTilemap(e,"typescript",r)}}catch(e){}return null}this.isTilemapLiteral=!0;e=/^\s*(tilemap(?:4|8|16|32)?)\s*(?:`([^`]*)`)|(?:\(\s*"""([^"]*)"""\s*\))\s*$/.exec(e);let t=(e[2]||e[3]||"").trim();this.tilemapLiteral=e[1];let n,i;if(t&&(i=ts.pxtc.escapeIdentifier(t),n=r.getTilemap(i)||r.lookupAssetByName("tilemap",t)),!n){let e=16,[t]=("tilemap8"===this.tilemapLiteral?e=8:"tilemap32"===this.tilemapLiteral?e=32:"tilemap4"===this.tilemapLiteral&&(e=4),r.createNewTilemap(i,e,16,16));n=r.getTilemap(t),i=t}return n}resultToText(e){var t=pxt.react.getTilemapProject();return t.pushUndo(),e=pxt.patchTemporaryAsset(this.editing,e,t),pxt.sprite.updateTilemapReferencesFromResult(t,e),this.isTilemapLiteral?(t.updateAsset(e),pxt.getTSReferenceForAsset(e,"python"===this.fileType)):pxt.sprite.encodeTilemap(e.data,"typescript"===this.fileType?"typescript":"python")}getFieldEditorId(){return"tilemap-editor"}getOptions(){return{initWidth:16,initHeight:16,blocksInfo:this.host.blocksInfo()}}getCreateTilemapRange(){var t=this.editrange.getStartPosition();let r=this.editrange.getEndPosition(),n=1;for(;;){var i,e=new monaco.Range(r.lineNumber,r.column,r.lineNumber+1,0),s=this.host.getText(e);for(let e=0;e<s.length;e++)if("("===s.charAt(e))n++;else if(")"===s.charAt(e))if(0===--n)return i=new monaco.Position(r.lineNumber,r.column+e+2),monaco.Range.fromPositions(t,i);if((r=e.getEndPosition()).lineNumber>t.lineNumber+20)return null}}}r.MonacoTilemapEditor=s,r.tilemapEditorDefinition={id:i,foldMatches:!0,alwaysBuildOnClose:!0,glyphCssClass:"sprite-focus-hover ms-Icon ms-Icon--Nav2DMapView",heightInPixels:510,weight:5,matcher:{searchString:'(?:tilemap(?:8|16|32)?\\s*(?:`|\\(""")(?:[ a-zA-Z0-9_]|\\n)*\\s*(?:`|"""\\)))|(?:tiles\\s*\\.\\s*createTilemap\\s*\\([^\\)]+\\))',isRegex:!0,matchCase:!0,matchWholeWord:!1},proto:s},(0,e.registerMonacoFieldEditor)(i,r.tilemapEditorDefinition)},{"./field_react":157,"./monacoFieldEditor":161}],161:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.getMonacoFieldEditor=r.registerMonacoFieldEditor=void 0;let n={};r.registerMonacoFieldEditor=function(e,t){n[e]=t},r.getMonacoFieldEditor=function(e){return n[e]}},{}],162:[function(e,t,r){function a(e){var t=pxt.appTarget.appTheme.invertedMonaco,r=!(!pxt.appTarget.appTheme.monacoFieldEditors||!pxt.appTarget.appTheme.monacoFieldEditors.length),e=monaco.editor.create(e,{model:null,ariaLabel:pxt.Util.lf("JavaScript editor"),fontFamily:"'Consolas', 'Monaco', 'Menlo', 'Ubuntu Mono', 'source-code-pro', 'monospace'",scrollBeyondLastLine:!0,language:"typescript",mouseWheelZoom:!1,wordBasedSuggestions:!0,lineNumbersMinChars:3,formatOnPaste:!0,folding:r,glyphMargin:r||pxt.appTarget.appTheme.debugger,minimap:{enabled:!1},fixedOverflowWidgets:!0,autoIndent:"full",useTabStops:!0,dragAndDrop:!0,matchBrackets:"always",occurrencesHighlight:!1,quickSuggestionsDelay:200,theme:t?"vs-dark":"vs",renderIndentGuides:!0,accessibilityHelpUrl:"",quickSuggestions:{other:!0,comments:!0,strings:!0},acceptSuggestionOnCommitCharacter:!0,acceptSuggestionOnEnter:"on",accessibilitySupport:"on"});return e.layout(),e}Object.defineProperty(r,"__esModule",{value:!0}),r.createEditor=r.initMonacoAsync=r.syncModels=void 0,r.syncModels=function(e,i,s,t){if(!t){t=monaco.languages.typescript.typescriptDefaults.getExtraLibs();let n={};e.sortedDeps().forEach(r=>{r.getFiles().forEach(e=>{var t=r.id+"/"+e;/\.(ts)$/.test(e)&&t!=s&&(monaco.languages.typescript.typescriptDefaults.getExtraLibs()[t]||(e=r.readFile(e)||"\n",i[t]=monaco.languages.typescript.typescriptDefaults.addExtraLib(e,t)),n[t]="1")})}),Object.keys(t).filter(e=>/\.(ts)$/.test(e)&&!n[e]).forEach(e=>{i[e].dispose()})}},r.initMonacoAsync=function(s){return new Promise((r,e)=>{if("object"==typeof window.monaco)r(a(s));else{let t=window.MonacoPaths;var n,i=()=>{var e=window.require;e.config({paths:t}),e(["vs/editor/editor.main"],()=>{monaco.languages.register({id:"asm",extensions:[".asm"]}),monaco.languages.setMonarchTokensProvider("asm",{tokenPostfix:"",keywords:["movs","mov","adds","add","adcs","adr","subs","sbcs","sub","rsbs","muls","cmp","cmn","ands","eors","orrs","bics","mvns","tst","lsls","lsrs","asrs","rors","ldr","ldrh","ldrb","ldrsh","ldrsb","ldm","str","strh","strb","stm","push","pop","cbz","cbnz","b","bl","bx","blx","sxth","sxtb","uxth","uxtb","rev","rev16","revsh","svc","cpsid","cpsie","setend","bkpt","nop","sev","wfe","wfi","yield","beq","bne","bcs","bhs","bcc","blo","bmi","bpl","bvs","bvc","bhi","bls","bge","blt","bgt","ble","bal","r0","r1","r2","r3","r4","r5","r6","r7","r8","r9","r10","r11","r12","r13","r14","r15","pc","sp","lr"],typeKeywords:[".startaddr",".hex",".short",".space",".section",".string",".byte"],operators:[],symbols:/[:\*]+/,escapes:/\\(?:[abfnrtv\\"']|x[0-9A-Fa-f]{1,4}|u[0-9A-Fa-f]{4}|U[0-9A-Fa-f]{8})/,tokenizer:{root:[[/(\.)?[a-z_$\.][\w$]*/,{cases:{"@typeKeywords":"keyword","@keywords":"keyword","@default":"identifier"}}],{include:"@whitespace"},[/[{}()\[\]]/,"@brackets"],[/[<>](?!@symbols)/,"@brackets"],[/@symbols/,{cases:{"@operators":"operator","@default":""}}],[/@\s*[a-zA-Z_\$][\w\$]*/,{token:"annotation"}],[/(#|(0[xX]))?[0-9a-fA-F]+/,"number"],[/[;,.]/,"delimiter"],[/"([^"\\]|\\.)*$/,"string.invalid"],[/"/,{token:"string.quote",bracket:"@open",next:"@string"}],[/'[^\\']'/,"string"],[/(')(@escapes)(')/,["string","string.escape","string"]],[/'/,"string.invalid"]],comment:[],string:[[/[^\\"]+/,"string"],[/@escapes/,"string.escape"],[/\\./,"string.escape.invalid"],[/"/,{token:"string.quote",bracket:"@close",next:"@pop"}]],whitespace:[[/[ \t\r\n]+/,"white"],[/\/\*/,"comment","@comment"],[/;.*$/,"comment"]]}}),monaco.languages.typescript&&(monaco.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSyntaxValidation:!0,noSemanticValidation:!0}),monaco.languages.typescript.typescriptDefaults.setWorkerOptions({customWorkerPath:pxt.webConfig.typeScriptWorkerJs}),monaco.languages.typescript.typescriptDefaults.setCompilerOptions({allowUnreachableCode:!0,noImplicitAny:!0,allowJs:!1,allowUnusedLabels:!0,target:monaco.languages.typescript.ScriptTarget.ES5,outDir:"built",rootDir:".",noLib:!0,mouseWheelZoom:!1})),r(a(s))})};window.require?i():((n=document.createElement("script")).type="text/javascript",n.src=t["vs/loader"],n.addEventListener("load",i),document.body.appendChild(n))}})},r.createEditor=a},{}],163:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.removeProjectAsync=r.saveProjectAsync=void 0;let n,i="projects",s="importId";async function a(){var e;return n||(e=pxt.appTarget.id+"-import",await(n=new pxt.BrowserUtils.IDBWrapper(e,1,(e,t)=>{t.result.createObjectStore(i,{keyPath:s})})).openAsync()),n}r.saveProjectAsync=async function(e){var e={importId:pxt.U.guidGen(),project:e},t=await a();return await t.deleteAllAsync(i),await t.setAsync(i,e),e.importId},r.removeProjectAsync=async function(e){var t=await a(),e=await t.getAsync(i,e);return await t.deleteAllAsync(i),null==e?void 0:e.project}},{}],164:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.freshHeader=void 0,r.freshHeader=function(e,t){return{target:pxt.appTarget.id,targetVersion:pxt.appTarget.versions.target,name:e,meta:{},editor:pxt.JAVASCRIPT_PROJECT_NAME,pubId:"",pubCurrent:!1,_rev:null,id:pxt.U.guidGen(),recentUse:t,modificationTime:t,cloudUserId:null,cloudCurrent:!1,cloudVersion:null,cloudLastSyncTime:0,isDeleted:!1}}},{}],165:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0});var r=e("./runner"),n=e("./renderer"),e=e("../pxteditor");window.pxt||(window.pxt={}),window.pxt.runner=Object.assign(Object.assign({},r),n),window.pxt.editor=Object.assign({},e),(r=window.ksRunnerWhenLoaded)&&r()},{"../pxteditor":155,"./renderer":166,"./runner":167}],166:[function(e,i,t){Object.defineProperty(t,"__esModule",{value:!0}),t.renderAsync=t.fireClickOnEnter=t.defaultClientRenderOptions=void 0;let d=e("./runner"),p=e("blockly"),h=e("../pxtblocks"),l=e("../pxtblocks/codecardRenderer"),v="icon xicon js",T="icon xicon python",k="icon xicon blocks";function s(){return{blocksAspectRatio:window.innerHeight<window.innerWidth?1.62:1/1.62,snippetClass:"lang-blocks",signatureClass:"lang-sig",blocksClass:"lang-block",blocksXmlClass:"lang-blocksxml",diffBlocksXmlClass:"lang-diffblocksxml",diffClass:"lang-diff",diffStaticPythonClass:"lang-diffspy",diffBlocksClass:"lang-diffblocks",staticPythonClass:"lang-spy",simulatorClass:"lang-sim",linksClass:"lang-cards",namespacesClass:"lang-namespaces",apisClass:"lang-apis",codeCardClass:"lang-codecard",packageClass:"lang-package",jresClass:"lang-jres",assetJSONClass:"lang-assetsjson",projectClass:"lang-project",snippetReplaceParent:!0,simulator:!0,showEdit:!0,hex:!0,tutorial:!1,showJavaScript:!1,hexName:pxt.appTarget.id}}function o(e){"undefined"!=typeof hljs&&(e.hasClass("highlight")?hljs.highlightBlock(e[0]):e.find("code.highlight").each(function(e,t){hljs.highlightBlock(t)}),c(e))}function c(e){e.find("span.hljs-comment:contains(@highlight)").each((e,t)=>{try{{var n=t;var i=$(n),s=document.createElement("span");s.className="highlight-line";let r=n.nextSibling;if(r&&r.nodeType==Node.TEXT_NODE){let t=r.textContent,e=t.indexOf("\n");if(!(e<0)){for(r.textContent=t.substring(0,e+1),$(document.createTextNode(t.substring(e+1).replace(/^\s+/,""))).insertAfter($(r)),r=r.nextSibling;r;){var a=r.nextSibling;if(r.nodeType==Node.TEXT_NODE){let e=(t=r.textContent).indexOf("\n");if(!(e<0)){s.appendChild(document.createTextNode(t.substring(0,e))),r.textContent=t.substring(e+1);break}}s.appendChild(r),r=a}$(s).insertAfter(i),i.remove()}}return}}catch(e){pxt.reportException(e)}})}function x(e,t){e.append($('<div class="ui content blocks"/>').append(t))}function E(e,t){e.append($('<div class="ui content js"><div class="subheading"><i class="ui icon xicon js"></i>JavaScript</div></div>').append(t)),o(t)}function S(e,t){e.append($('<div class="ui content py"><div class="subheading"><i class="ui icon xicon python"></i>Python</div></div>').append(t)),o(t)}function C(e,t){var r=$('<a class="item" role="button" tabindex="0"><i role="presentation" aria-hidden="true"></i><span class="ui desktop only"></span></a>');return r.attr("aria-label",e),r.attr("title",e),r.find("i").attr("class",t),r.find("span").text(e),r.keypress(n),r}function n(e){var t="number"==typeof e.which?e.which:e.keyCode;13!==t&&32!==t||(e.preventDefault(),e.currentTarget.click())}t.defaultClientRenderOptions=s,t.fireClickOnEnter=n;let w=!1;function m(s,e,a,t,r,n,i={}){var o=$('<div class="ui bottom attached tabular icon small compact menu hideprint"> <div class="right icon menu"></div></div>');let l=$('<div class="ui top attached segment codewidget"></div>'),c=o.find(".right.menu");var u=pxt.appTarget.appTheme||{};if(i.showEdit&&!u.hideDocsEdit&&n){var d=C(lf("Edit"),"edit icon"),{package:p,compileBlocks:n,compilePython:h}=n,m=p.host();if(r&&n?(p.setPreferredEditor(pxt.BLOCKS_PROJECT_NAME),m.writeFile(p,pxt.MAIN_BLOCKS,n.outfiles[pxt.MAIN_BLOCKS])):t&&h?(p.setPreferredEditor(pxt.PYTHON_PROJECT_NAME),m.writeFile(p,pxt.MAIN_PY,n.outfiles[pxt.MAIN_PY])):p.setPreferredEditor(pxt.JAVASCRIPT_PROJECT_NAME),s.assetJSON)for(var g of Object.keys(s.assetJSON))p.config.files.indexOf(g)<0&&p.config.files.push(g),m.writeFile(p,g,s.assetJSON[g]);let e=p.compressToFileAsync();d.click(()=>{pxt.tickEvent("docs.btn",{button:"edit"}),e.then(e=>{window.open((e=>((e=e.pxtUrl||pxt.appTarget.appTheme.homeUrl)||"").replace(/\/$/,""))(s)+"/#project:"+ts.pxtc.encodeBase64(pxt.Util.uint8ArrayToString(e)),"pxt")})}),c.append(d)}s.showJavaScript||!r&&!t?(l.append(a),f(),y()):r?(l.append(r),_(),y()):t&&(l.append(t),f(),_()),i.run&&!u.hideDocsSimulator&&(h=C(lf("Run"),"play icon").click(()=>{if(pxt.tickEvent("docs.btn",{button:"sim"}),l.find(".sim")[0])l.find(".sim").remove(),b(l);else{w||(w=!0,window.addEventListener("message",e=>{var t,e=e.data;"aspectratio"===e.type&&(t=e.value,null!=(e=document.querySelector(`iframe[data-frameid="${e.frameid}"]`)))&&e.parentElement&&(e.parentElement.style.paddingBottom=100/t+"%")}));let e="81.97%";pxt.appTarget.simulator&&(e=100/pxt.appTarget.simulator.aspectRatio+"%");var t=s.package?"&deps="+encodeURIComponent(s.package):"",t=P(s)+"#nofooter=1"+t,r=s.assetJSON?`data-assets="${encodeURIComponent(JSON.stringify(s.assetJSON))}"`:"",n=encodeURIComponent(a.text()),i="sim-"+pxt.Util.guidGen(),t=$(`<div class="ui card sim"><div class="ui content"><div style="position:relative;height:0;padding-bottom:${e};overflow:hidden;"><iframe style="position:absolute;top:0;left:0;width:100%;height:100%;" src="${t}" data-code="${n}" data-frameid="${i}" ${r} allowfullscreen="allowfullscreen" sandbox="allow-popups allow-forms allow-scripts allow-same-origin" frameborder="0"></iframe></div></div></div>`);l.append(t),b(t)}}),c.append(h)),i.hexname&&i.hex&&(n=C(lf("Download"),"download icon").click(()=>{pxt.tickEvent("docs.btn",{button:"hex"}),pxt.BrowserUtils.browserDownloadBinText(i.hex,i.hexname,{contentType:pxt.appTarget.compile.hexMimeType})}),c.append(n));d=$("<div class=codesnippet></div>");function f(){var e;r&&(e=C(lf("Blocks"),k).click(()=>{pxt.tickEvent("docs.btn",{button:"blocks"}),l.find(".blocks")[0]?(l.find(".blocks").remove(),b(l)):(x(a?a.parent():l,r),b(r))}),c.append(e))}function _(){var e;a&&(i.showJs?E(l,a):(e=C("JavaScript",v).click(()=>{pxt.tickEvent("docs.btn",{button:"js"}),l.find(".js")[0]?(l.find(".js").remove(),b(l)):(E(r?r.parent():l,a),b(a))}),c.append(e)))}function y(){var e;t&&(i.showPy?S(l,t):(e=C("Python",T).click(()=>{pxt.tickEvent("docs.btn",{button:"py"}),l.find(".py")[0]?(l.find(".py").remove(),b(l)):(S(r?r.parent():l,t),b(t))}),c.append(e)))}function b(e){null!=(e=e[0])&&e.scrollIntoView({behavior:"smooth",block:"center"})}c.children().length&&d.append(o),d.append(l),e.replaceWith(d)}let u=[];function g(){let s={};return function e(){let t=u.shift();if(!t)return Promise.resolve();let{el:r,options:n,render:i}=t;return(0,d.decompileSnippetAsync)(r.text(),n).then(e=>{let t=e.compileJS&&e.compileJS.diagnostics&&e.compileJS.diagnostics.filter(e=>e.category==pxtc.DiagnosticCategory.Error);t&&t.length&&t.forEach(e=>pxt.reportError("docs.decompile",""+e.messageText,{code:e.code+""})),e.blocksSvg.querySelectorAll("defs *").forEach(e=>{s[e.id]?e.remove():s[e.id]=!0}),i(r,e)},e=>{pxt.reportException(e),r.append($("<div/>").addClass("ui segment warning").text(e.message))}).finally(()=>(r.removeClass("lang-shadow"),e()))}().then(()=>{p.Workspace.getAll().forEach(e=>e.dispose()),(0,h.cleanRenderingWorkspace)()})}function f(e,t,r){var n;return e&&(n=$("."+e).first())[0]?(r.emPixels||(r.emPixels=18),r.layout||(r.layout=1),r.splitSvg=!0,u.push({el:n,source:n.text(),options:r,render:t}),n.addClass("lang-shadow"),n.removeClass(e),f(e,t,r)):Promise.resolve()}function _(e){return e&&e.kind==ts.SyntaxKind.ExpressionStatement&&e.expression&&e.expression.kind==ts.SyntaxKind.CallExpression?pxtc.pxtInfo(e.expression).callInfo:null}function y(r){return r.blocksXmlClass?function t(r,n,i){let s=$("."+r).first();return s[0]?(i.emPixels||(i.emPixels=18),i.splitSvg=!0,(0,d.compileBlocksAsync)(s.text(),i).then(e=>{try{n(s,e)}catch(e){pxt.reportException(e),s.append($("<div/>").addClass("ui segment warning").text(e.message))}return s.removeClass(r),pxt.U.delay(1,t(r,n,i))})):Promise.resolve()}(r.blocksXmlClass,(e,t)=>{t=t.blocksSvg,r.snippetReplaceParent&&(e=e.parent()),t=$('<div class="ui segment codewidget"/>').append(t);e.replaceWith(t)},{package:r.package,snippetMode:!0,aspectRatio:r.blocksAspectRatio,assets:r.assetJSON}):Promise.resolve()}function b(r){return r.diffBlocksXmlClass?function r(n,i,s){let a=$("."+n).first();if(!a[0])return Promise.resolve();s.emPixels||(s.emPixels=18),s.splitSvg=!0;var e=a.text().split(/-{10,}/);let o=e[0],l=e[1];return(0,d.compileBlocksAsync)("",s).then(e=>{a.removeClass(n);try{var t=(0,h.diffXml)(o,l);t?(e.blocksSvg=t.svg,i(a,e)):a.text("no changes")}catch(e){pxt.reportException(e),a.append($("<div/>").addClass("ui segment warning").text(e.message))}return pxt.U.delay(1,r(n,i,s))})}(r.diffBlocksXmlClass,(e,t)=>{t=t.blocksSvg,r.snippetReplaceParent&&(e=e.parent()),t=$('<div class="ui segment codewidget"/>').append(t);e.replaceWith(t)},{package:r.package,snippetMode:!0,aspectRatio:r.blocksAspectRatio,assets:r.assetJSON}):Promise.resolve()}function I(o){return o.diffClass?function e(t){let r=$("."+t).first();if(!r[0])return Promise.resolve();var{fileA:n,fileB:i}=pxt.diff.split(r.text());try{var s=pxt.diff.render(n,i,{hideLineNumbers:!0,hideMarkerLine:!0,hideMarker:!0,hideRemoved:!0,update:!0,ignoreWhitespace:!0}),a=(o.snippetReplaceParent&&(r=r.parent()),$('<div class="ui segment codewidget"/>').append(s));r.removeClass(t),r.replaceWith(a)}catch(e){pxt.reportException(e),r.append($("<div/>").addClass("ui segment warning").text(e.message))}return pxt.U.delay(1,e(t))}(o.diffClass):Promise.resolve()}function A(u){return u.diffBlocksClass?function e(a){let o=$("."+a).first();if(!o[0])return Promise.resolve();let{fileA:l,fileB:c}=pxt.diff.split(o.text(),{removeTrailingSemiColumns:!0});return pxt.U.promiseMapAllSeries([l,c],e=>(0,d.decompileSnippetAsync)(e,{generateSourceMap:!0})).then(t=>{try{var r=(0,h.decompiledDiffAsync)(l,t[0].compileBlocks,c,t[1].compileBlocks,{hideDeletedTopBlocks:!0,hideDeletedBlocks:!0}),n=pxt.diff.render(l,c,{hideLineNumbers:!0,hideMarkerLine:!0,hideMarker:!0,hideRemoved:!0,update:!0,ignoreWhitespace:!0});let e;var[i,s]=t.map(e=>e.compilePython&&e.compilePython.outfiles&&e.compilePython.outfiles[pxt.MAIN_PY]);i&&s&&(e=pxt.diff.render(i,s,{hideLineNumbers:!0,hideMarkerLine:!0,hideMarker:!0,hideRemoved:!0,update:!0,ignoreWhitespace:!0})),m(u,o.parent(),$(n),e&&$(e),$(r.svg),void 0,{showEdit:!1,run:!1,hexname:void 0,hex:void 0})}catch(e){pxt.reportException(e),o.append($("<div/>").addClass("ui segment warning").text(e.message))}return pxt.U.delay(1,e(a))})}(u.diffBlocksClass):Promise.resolve()}let r;function D(e){return r=r||(0,d.decompileSnippetAsync)("",e)}function B(a){(a=pxt.Util.clone(a)).emPixels=18,a.snippetMode=!0;let o=$(":not(pre) > code"),l=0;return function e(){if(l>=o.length)return Promise.resolve();let n=$(o[l++]);var t,r,i=n.text(),s=/^(\|+)([^\|]+)\|+$/.exec(i);return s?(t=((r=/^(([^\:\.]*?)[\:\.])?(.*)$/.exec(s[2]))[2]?r[2].trim().toLowerCase():"").replace(/\(.*?\)/g,""),s=1==s[1].length?"docs inlinebutton "+t:"docs inlineblock "+t,t=r[3].trim(),n.replaceWith($(`<span class="${s}"/>`).text(pxt.U.rlf(t))),e()):(r=/^\[(.+)\]$/.exec(i))?(s=r[1],(0,d.decompileSnippetAsync)(s,a).then(t=>{if(t.blocksSvg){let e=$('<span class="block"/>').append(t.blocksSvg);var r=_(t.compileProgram.getSourceFile(pxt.MAIN_TS).statements[0]);r&&t.apiInfo&&(t=t.apiInfo.byQName[r.qName])&&t.attributes.help&&(e=$('<a class="ui link"/>').attr("href","/reference/"+t.attributes.help).append(e)),n.replaceWith(e)}return pxt.U.delay(1,e())})):e()}()}function U(i){return i.projectClass?function e(){var t=$("."+i.projectClass).first();let r=t[0];if(!r)return Promise.resolve();t.removeClass(i.projectClass);var n,t=pxt.Cloud.parseScriptId(r.innerText);return t?(i.snippetReplaceParent&&(r=r.parentElement,n=document.createElement("div"),r.parentElement.insertBefore(n,r),r.parentElement.removeChild(r),r=n),(0,d.renderProjectAsync)(r,t).then(()=>e())):e()}():Promise.resolve()}function N(e,t){var r,n,i;t&&(i=/^\/(v\d+)/.exec(t.url),r=/^\/(v\d+)/.exec(window.location.pathname),n=/#doc/i.test(window.location.href),t.url&&!i&&r&&!n&&(t.url=`/${r[1]}/`+t.url),(i=document.createElement("div")).setAttribute("role","listitem"),i.append((0,l.renderCodeCard)(t,{hideHeader:!0,shortName:!0})),e.append(i))}function O(e,t,r){var n=t.attributes,i=!n.blockHidden&&p.Blocks[n.blockId];(null==i?void 0:i.codeCard)?(i=pxt.U.clone(i.codeCard),r&&(i.style=r),N(e,i)):N(e,{name:t.qName,description:n.jsDoc,url:n.help||void 0,style:r})}function R(e,t,r,u){return f(t,(e,c)=>{var t=c.compileProgram;if(t){t=t.getSourceFile(pxt.MAIN_TS).statements.slice(0);let l=document.createElement("div");l.setAttribute("role","list"),l.className="card-list",t.forEach(t=>{var e=t.kind,r=_(t);if(r&&c.apiInfo&&c.apiInfo.byQName[r.qName]){var n,r=c.apiInfo.byQName[r.qName],i=r.attributes,s=p.Blocks[i.blockId];u?(n=c.compileBlocks.blocksInfo.apis.byQName[r.namespace],N(l,{name:n.attributes.blockNamespace||n.name,url:n.attributes.help||"reference/"+(n.attributes.blockNamespace||n.name).toLowerCase(),description:n.attributes.jsDoc,blocksXml:s&&s.codeCard?s.codeCard.blocksXml:i.blockId?`<xml xmlns="http://www.w3.org/1999/xhtml"><block type="${i.blockId}"></block></xml>`:void 0})):O(l,r)}else switch(e){case ts.SyntaxKind.ExpressionStatement:var a=t;switch(a.expression.kind){case ts.SyntaxKind.TrueKeyword:case ts.SyntaxKind.FalseKeyword:N(l,{name:"Boolean",url:"blocks/logic/boolean",description:lf("True or false values"),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="logic_boolean"><field name="BOOL">TRUE</field></block></xml>'});break;default:pxt.debug("card expr kind: "+a.expression.kind)}break;case ts.SyntaxKind.IfStatement:N(l,{name:u?"Logic":"if",url:"blocks/logic"+(u?"":"/if"),description:u?lf("Logic operators and constants"):lf("Conditional statement"),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="controls_if"></block></xml>'});break;case ts.SyntaxKind.WhileStatement:N(l,{name:u?"Loops":"while",url:"blocks/loops"+(u?"":"/while"),description:u?lf("Loops and repetition"):lf("Repeat code while a condition is true."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="device_while"></block></xml>'});break;case ts.SyntaxKind.ForOfStatement:N(l,{name:u?"Loops":"for of",url:"blocks/loops"+(u?"":"/for-of"),description:u?lf("Loops and repetition"):lf("Repeat code for each item in a list."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="controls_for_of"></block></xml>'});break;case ts.SyntaxKind.BreakStatement:N(l,{name:u?"Loops":"break",url:"blocks/loops"+(u?"":"/break"),description:u?lf("Loops and repetition"):lf("Break out of the current loop."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="break_keyword"></block></xml>'});break;case ts.SyntaxKind.ContinueStatement:N(l,{name:u?"Loops":"continue",url:"blocks/loops"+(u?"":"/continue"),description:u?lf("Loops and repetition"):lf("Skip iteration and continue the current loop."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="continue_keyboard"></block></xml>'});break;case ts.SyntaxKind.ForStatement:{var o=t;let e=!0;(e=3==o.condition.getChildCount()?!("0"==o.condition.getChildAt(0).getText()||o.condition.getChildAt(1).kind==ts.SyntaxKind.LessThanToken):e)?N(l,{name:u?"Loops":"for",url:"blocks/loops"+(u?"":"/for"),description:u?lf("Loops and repetition"):lf("Repeat code for a given number of times using an index."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="controls_simple_for"></block></xml>'}):N(l,{name:u?"Loops":"repeat",url:"blocks/loops"+(u?"":"/repeat"),description:u?lf("Loops and repetition"):lf("Repeat code for a given number of times."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="controls_repeat_ext"></block></xml>'});break}case ts.SyntaxKind.VariableStatement:N(l,{name:u?"Variables":"variable declaration",url:"blocks/variables"+(u?"":"/assign"),description:u?lf("Variables"):lf("Assign a value to a named variable."),blocksXml:'<xml xmlns="http://www.w3.org/1999/xhtml"><block type="variables_set"></block></xml>'});break;default:pxt.debug("card kind: "+e)}}),(e=r?e.parent():e).replaceWith(l)}},{package:e.package,aspectRatio:e.blocksAspectRatio,assets:e.assetJSON})}function L(e,t){if(!e)return Promise.resolve();let r=$("."+e).first();if(!r[0])return Promise.resolve();r.removeClass(e);var n=pxt.gallery.parseCodeCardsHtml(r[0]);return n||r.append($("<div/>").addClass("ui segment warning").text("invalid codecard format")),((e,t,o)=>{if(t&&0!=t.length)if(0==t.length){var r=(0,l.renderCodeCard)(t[0],o);e.replaceWith(r)}else{let a=document.createElement("div");a.className="card-list",a.setAttribute("role","list"),a.setAttribute("aria-label",o.cardCategory||lf("Content cards")),t.forEach(r=>{var e=/^\/(v\d+)/.exec(r.url),t=/^\/(v\d+)/.exec(window.location.pathname),n=/#doc/i.test(window.location.href);r.url&&!e&&t&&!n&&(r.url="/"+t[1]+r.url);let i=(0,l.renderCodeCard)(r,o),s=document.createElement("div");if(s.setAttribute("role","listitem"),s.appendChild(i),a.appendChild(s),"package"==r.cardType){let t=pxt.github.parseRepoId((r.url||"").replace(/^\/pkg\//,""));t&&pxt.packagesConfigAsync().then(e=>{switch(pxt.github.repoStatus(t,e)){case pxt.github.GitRepoStatus.Banned:i.remove();break;case pxt.github.GitRepoStatus.Approved:r.imageUrl=pxt.github.mkRepoIconUrl(t),s.insertBefore((0,l.renderCodeCard)(r,o),i),i.remove()}}).catch(e=>{pxt.reportException(e),pxt.debug("failed to load repo "+r.url)})}}),e.replaceWith(a)}return Promise.resolve()})(r=t.snippetReplaceParent?r.parent():r,n,{hideHeader:!0,cardCategory:t.hexName}).then(()=>pxt.U.delay(1,L(e,t)))}function P(e){return e.pxtUrl?e.pxtUrl+"/--run":pxt.webConfig&&pxt.webConfig.runUrl?pxt.webConfig.runUrl:"/--run"}function V(e){let n,i;e.jresClass&&$("."+e.jresClass).each((e,t)=>{var r=$(t);i=r.text(),t.parentElement.remove()}),e.assetJSONClass&&$("."+e.assetJSONClass).each((e,t)=>{var r=$(t);n=r.text(),t.parentElement.remove()}),e.assetJSON=((e,t)=>{if(e||t)return e=pxt.tutorial.parseAssetJson(e)||{},t&&(t=JSON.parse(t),e[pxt.TILEMAP_JRES]=JSON.stringify(t),e[pxt.TILEMAP_CODE]=pxt.emitTilemapsFromJRes(t)),e})(n,i)}function H(s){let a={showEdit:!!s.showEdit,run:!!s.simulator};$("code.lang-python").each((e,t)=>{var r,n,i;r=t,n=!1,"undefined"!=typeof hljs&&($(r).text($(r).text().replace(/^\s*\r?\n/,"")),hljs.highlightBlock(r),c($(r))),i=pxt.U.clone(a),n&&(i.run=!1,i.showEdit=!1),m(s,$(r).parent(),$(r),void 0,void 0,void 0,i),$(t).removeClass("lang-python")})}function M(e,t){(e=t.snippetReplaceParent?e.parent():e).remove()}function F(e,t,r){$(`code.lang-${e}\\.`+t).each((e,t)=>{M($(t),r)})}t.renderAsync=function(a){var n,e,l;pxt.analytics.enable(pxt.Util.userLanguage()),(a=a||s()).pxtUrl&&(a.pxtUrl=a.pxtUrl.replace(/\/$/,"")),a.showEdit&&(a.showEdit=!pxt.BrowserUtils.isIFrame()),(n=a).packageClass&&($("."+n.packageClass).each((e,t)=>{let r=$(t);t=r.text().split("\n").map(e=>e.replace(/\s*/g,"")).filter(e=>!!e).join(",");n.package=n.package?n.package+","+t:t,(r=n.snippetReplaceParent?r.parent():r).remove()}),$(".lang-config").each((e,t)=>{let r=$(t);(r=n.snippetReplaceParent?r.parent():r).remove()})),V(a),u=[],e=a,M($("code.lang-ghost"),e),F("blockconfig","local",e=a),F("blockconfig","global",e),e=a,M($("code.lang-template"),e),F("validation","local",e=a),F("validation","global",e),(l=a).simulatorClass&&$("."+l.simulatorClass).each((e,t)=>{let r,n=$(t),i="81.97%";pxt.appTarget.simulator&&(i=100/pxt.appTarget.simulator.aspectRatio+"%");var t=lf("MakeCode {0} Simulator",(null==(r=pxt.appTarget.appTheme)?void 0:r.boardName)||pxt.appTarget.name),t=$(`
            <div class="ui card">
                <div class="ui content">
                    <div style="position:relative;height:0;padding-bottom:${i};overflow:hidden;">
                        <iframe
                            style="position:absolute;top:0;left:0;width:100%;height:100%;"
                            allowfullscreen="allowfullscreen"
                            frameborder="0"
                            sandbox="allow-popups allow-forms allow-scripts allow-same-origin"
                            title="${pxt.U.htmlEscape(t)}"
                        ></iframe>
                    </div>
                </div>
            </div>
        `),s=l.package?"&deps="+encodeURIComponent(l.package):"",s=P(l)+"#nofooter=1"+s,a=encodeURIComponent(n.text().trim()),o=t.find("iframe");o.attr("src",s),o.attr("data-code",a),l.assetJSON&&o.attr("data-assets",JSON.stringify(l.assetJSON)),(n=l.snippetReplaceParent?n.parent():n).replaceWith(t)});{var i=a;let n={showEdit:!!i.showEdit,run:!!i.simulator};function r(e,t){"undefined"!=typeof hljs&&($(e).text($(e).text().replace(/^\s*\r?\n/,"")),hljs.highlightBlock(e),c($(e)));var r=pxt.U.clone(n);t&&(r.run=!1,r.showEdit=!1),m(i,$(e).parent(),$(e),void 0,void 0,void 0,r)}$("code.lang-typescript").each((e,t)=>{r(t,!1),$(t).removeClass("lang-typescript")}),$("code.lang-typescript-ignore").each((e,t)=>{$(t).removeClass("lang-typescript-ignore"),$(t).addClass("lang-typescript"),r(t,!0),$(t).removeClass("lang-typescript")}),$("code.lang-typescript-invalid").each((e,t)=>{$(t).removeClass("lang-typescript-invalid"),$(t).addClass("lang-typescript"),r(t,!0),$(t).removeClass("lang-typescript"),$(t).parent("div").addClass("invalid"),$(t).parent("div").prepend($("<i>",{class:"icon ban"})),$(t).addClass("invalid")}),$("code.lang-typescript-valid").each((e,t)=>{$(t).removeClass("lang-typescript-valid"),$(t).addClass("lang-typescript"),r(t,!0),$(t).removeClass("lang-typescript"),$(t).parent("div").addClass("valid"),$(t).parent("div").prepend($("<i>",{class:"icon check"})),$(t).addClass("valid")})}return H(a),Promise.resolve().then(()=>L(a.codeCardClass,a)).then(()=>(async t=>{if("core"!=pxt.appTarget.id){var r,n,i,s=(await D(t)).compileBlocks.blocksInfo,a={};for(r of s.blocks){var o,l=(r.attributes.blockNamespace||r.namespace).split(".")[0];a[l]||(o=s.apis.byQName[l])&&o.attributes.color&&(a[l]=o.attributes.color)}let e="";for(n of Object.keys(a)){var c=a[n];e+=`
                span.docs.${n.toLowerCase()} {
                    --inline-namespace-color: ${c};
                }
            `}for(i of Object.keys(pxt.toolbox.blockColors)){var u=pxt.toolbox.getNamespaceColor(i);e+=`
                span.docs.${i.toLowerCase()} {
                    --inline-namespace-color: ${u};
                }
            `}t=document.createElement("style");t.id="namespaceColors",t.type="text/css",(document.head||document.getElementsByTagName("head")[0]).appendChild(t),t.appendChild(document.createTextNode(e))}})(a)).then(()=>B(a)).then(()=>R(a,a.linksClass,a.snippetReplaceParent,!1)).then(()=>R(a,a.namespacesClass,a.snippetReplaceParent,!0)).then(()=>{{var e=a,s=a.snippetReplaceParent,r=e.apisClass;if(!r)return Promise.resolve();let t=$("."+r);return t.length?D(e).then(e=>{e=e.compileBlocks.blocksInfo;let i=pxt.Util.values(e.apis.byQName).filter(e=>!(e.attributes.hidden||e.attributes.deprecated||e.attributes.blockAliasFor||!e.attributes.jsDoc||!e.attributes.block||/^__/.test(e.name)));t.each((e,r)=>{let n=$(r),t=pxt.Util.toDictionary(n.text().split("\n"),e=>e);r=i.filter(e=>!!t[e.attributes.blockNamespace||e.namespace]);if(r.length){r.sort((e,t)=>{var r=!e.attributes.blockHidden&&p.Blocks[e.attributes.blockId],n=!t.attributes.blockHidden&&p.Blocks[t.attributes.blockId];return!!r!=!!n?(n?1:0)-(r?1:0):e.name.localeCompare(t.name)});let t=document.createElement("div");t.className="ui divided items",t.setAttribute("role","list"),r.forEach(e=>O(t,e,"item")),(n=s?n.parent():n).replaceWith(t)}})}):Promise.resolve()}}).then(()=>{return f((o=a).signatureClass,(e,t)=>{var r,n,i,s,a=t.compileProgram;a&&(a=_(a.getSourceFile(pxt.MAIN_TS).statements[0]))&&t.apiInfo&&(a=t.apiInfo.byQName[a.qName])&&(r=(r=(r=(null==(r=null==(r=p.Blocks[a.attributes.blockId])?void 0:r.codeCard)?void 0:r.blocksXml)||void 0)?(0,h.render)(r):null!=(r=t.compileBlocks)&&r.success?t.blocksSvg:void 0)?$(r):void 0,n=ts.pxtc.service.displayStringForSymbol(a,!1,t.apiInfo).split("\n")[1]+";",n=$('<code class="lang-typescript highlight"/>').text(n),i=(i=(null==(i=null==(i=pxt.appTarget)?void 0:i.appTheme)?void 0:i.python)&&ts.pxtc.service.displayStringForSymbol(a,!0,t.apiInfo).split("\n")[1])&&$('<code class="lang-python highlight"/>').text(i),o.snippetReplaceParent&&(e=e.parent()),pxt.Util.isTranslationMode()&&((s=$('<div class="ui segment" />')).append($('<div class="ui header"><i class="ui xicon globe"></i></div>')),a.attributes.translationId&&s.append($('<div class="ui message">').text(a.attributes.translationId)),a.attributes.jsDoc&&s.append($('<div class="ui message">').text(a.attributes.jsDoc)),s.insertAfter(e)),m(o,e,n,i,r,t,{showJs:!0,showPy:!0,hideGutter:!0}))},{package:o.package,snippetMode:!0,aspectRatio:o.blocksAspectRatio,assets:o.assetJSON});var o}).then(()=>{{var l=a;if(l.tutorial)return f(l.snippetClass,(e,t)=>{t=t.blocksSvg,l.snippetReplaceParent&&(e=e.parent()),t=$('<div class="ui segment codewidget"/>').append(t);e.replaceWith(t)},{package:l.package,snippetMode:!1,aspectRatio:l.blocksAspectRatio,assets:l.assetJSON});let o=0;return f(l.snippetClass,(e,t)=>{var r=t.compileBlocks&&t.compileBlocks.success?$(t.blocksSvg):void 0,n=t.compilePython&&t.compilePython.success&&t.compilePython.outfiles[pxt.MAIN_PY],i=$('<code class="lang-typescript highlight"/>').text(e.text().trim()),n=n?$('<code class="lang-python highlight"/>').text(n.trim()):void 0,s=(l.snippetReplaceParent&&(e=e.parent()),t.compileJS&&t.compileJS.success),s=l.hex&&s&&t.compileJS.outfiles[pxtc.BINARY_HEX]?t.compileJS.outfiles[pxtc.BINARY_HEX]:void 0,a=`${pxt.appTarget.nickname||pxt.appTarget.id}-${l.hexName||""}-${o++}.hex`;m(l,e,i,n,r,t,{showEdit:l.showEdit,run:l.simulator,hexname:a,hex:s})},{package:l.package,aspectRatio:l.blocksAspectRatio,assets:l.assetJSON})}}).then(()=>{return f((r=a).blocksClass,(e,t)=>{t=t.blocksSvg,r.snippetReplaceParent&&(e=e.parent()),t=$('<div class="ui segment codewidget"/>').append(t);e.replaceWith(t)},{package:r.package,snippetMode:!0,aspectRatio:r.blocksAspectRatio,assets:r.assetJSON});var r}).then(()=>y(a)).then(()=>b(a)).then(()=>A(a)).then(()=>I(a)).then(()=>{{var s=a;let i={showEdit:!!s.showEdit,run:!!s.simulator};return f(s.staticPythonClass,(e,t)=>{var r,n=t.compilePython;n&&n.success&&(n=(r=e.clone().removeClass("lang-shadow").addClass("highlight")).clone().addClass("lang-python").text(n.outfiles[pxt.MAIN_PY]),r.addClass("lang-typescript"),o(n),m(s,e.parent(),r,n,void 0,t,i))},{package:s.package,snippetMode:!0,assets:s.assetJSON})}}).then(()=>U(a)).then(()=>g())}},{"../pxtblocks":74,"../pxtblocks/codecardRenderer":11,"./runner":167,blockly:175}],167:[function(e,M,p){Object.defineProperty(p,"__esModule",{value:!0}),p.init=p.setInitCallbacks=p.compileBlocksAsync=p.decompileSnippetAsync=p.renderMarkdownAsync=p.renderProjectFilesAsync=p.renderProjectAsync=p.startDocsServer=p.startRenderServer=p.setEditorContextAsync=p.editorLanguageMode=p.LanguageMode=p.buildSimJsInfo=p.fetchSimJsInfo=p.postSimMessage=p.currentDriver=p.preloadSim=p.simulateAsync=p.generateVMFileAsync=p.generateHexFileAsync=p.showError=p.initFooter=p.initHost=p.mainPkg=void 0;let h=e("../pxtblocks"),o=e("../pxteditor/editor"),l=e("./renderer"),n=e("../pxtblocks"),t=e("blockly");pxt.blocks.requirePxtBlockly=()=>n,pxt.blocks.requireBlockly=()=>t,pxt.blocks.registerFieldEditor=(e,t,r)=>n.registerFieldEditor(e,t,r);class i{constructor(e,t){this.ksPkg=e,this.topPkg=t,this.files={}}getKsPkg(){return this.ksPkg}getPkgId(){return(this.ksPkg||this).id}isTopLevel(){return this.ksPkg&&0==this.ksPkg.level}setFiles(e){this.files=e}getAllFiles(){return pxt.Util.mapMap(this.files,(e,t)=>t)}}class F{constructor(){this.githubPackageCache={}}readFile(e,t){e=c(e);return pxt.U.lookup(e.files,t)}writeFile(e,t,r){c(e).files[t]=r}getHexInfoAsync(e){return pxt.hexloader.getHexInfoAsync(this,e)}cacheStoreAsync(e,t){return Promise.resolve()}cacheGetAsync(e){return Promise.resolve(null)}patchDependencies(e,t,r){if(r){var n=pxt.github.parseRepoId(r);if(n)for(var i of Object.keys(e.dependencies)){var s=e.dependencies[i],s=pxt.github.parseRepoId(s);if(s&&n.fullName==s.fullName)return pxt.semver.strcmp(n.tag,s.tag)<0&&(e.dependencies[i]=r),!0}}return!1}downloadPackageAsync(r,n){let t=r.verProtocol(),i=void 0,s=("github"==t&&(i=this.githubPackageCache[r._verspec]),c(r));return(i?Promise.resolve(i):r.commonDownloadAsync()).then(e=>{if(e)return"github"!=t||i||(this.githubPackageCache[r._verspec]=pxt.Util.clone(e)),s.setFiles(e),Promise.resolve();if("empty"==t){if(0==Object.keys(s.files).length&&s.setFiles(u()),n&&n.length){e=c(r).files;let t=JSON.parse(e[pxt.CONFIG_NAME]);n.forEach(e=>{a(t,e)}),e[pxt.CONFIG_NAME]=pxt.Package.stringifyConfig(t)}return Promise.resolve()}if("docs"!=t)return"invalid"==t?(pxt.log("skipping invalid pkg "+r.id),Promise.resolve()):Promise.reject(`Cannot download ${r.version()}; unknown protocol`);{e=u();let t=JSON.parse(e[pxt.CONFIG_NAME]);return r.verArgument().split(",").forEach(e=>{a(t,e)}),t.yotta||(t.yotta={}),t.yotta.ignoreConflicts=!0,e[pxt.CONFIG_NAME]=pxt.Package.stringifyConfig(t),s.setFiles(e),Promise.resolve()}})}}let m;function a(e,t){var r=/^([a-zA-Z0-9_-]+)(=(.+))?$/.exec(t);return r?e.dependencies[r[1]]=r[3]||"*":pxt.warn("unknown package syntax "+t),1}function c(e){var t=e._editorPkg;if(t)return t;let r=null;e!=p.mainPkg&&(r=c(p.mainPkg));t=new i(e,r);return e==p.mainPkg&&(t.topPkg=t),e._editorPkg=t}function u(){var e=pxt.appTarget.tsprj,t=pxt.U.clone(e.files);return t[pxt.CONFIG_NAME]=pxt.Package.stringifyConfig(e.config),t[pxt.MAIN_BLOCKS]="",t}function B(){pxt.setAppTarget(window.pxtTargetBundle),pxt.analytics.enable(pxt.Util.userLanguage()),pxt.Util.assert(!!pxt.appTarget);var e,t=window.location.href;let r=!1,n=void 0;/[&?]translate=1/.test(t)&&!pxt.BrowserUtils.isIE()?(n=ts.pxtc.Util.TRANSLATION_LOCALE,r=!0,pxt.Util.enableLiveLocalizationUpdates()):(e=/PXT_LANG=(.*?)(?:;|$)/.exec(document.cookie),t=/(live)?(force)?lang=([a-z]{2,}(-[A-Z]+)?)/i.exec(t),n=t?t[3]:e&&e[1]||pxt.appTarget.appTheme.defaultLocale||navigator.userLanguage||navigator.language,e=pxt.appTarget.appTheme.defaultLocale,i=null==n?void 0:n.toLocaleLowerCase(),e=pxt.BrowserUtils.isLocalHostDev()&&(!i||(e?e.toLocaleLowerCase()===i:"en"===i||"en-us"===i)),(!(pxt.BrowserUtils.isPxtElectron()||e||pxt.appTarget.appTheme.disableLiveTranslations)||null!=t&&t[1])&&pxt.Util.enableLiveLocalizationUpdates(),r=!!t&&!!t[2]);pxt.appTarget.versions;$&&$.fn&&$.fn.embed&&$.fn.embed.settings&&$.fn.embed.settings.sources&&$.fn.embed.settings.sources.youtube&&($.fn.embed.settings.sources.youtube.url="//www.youtube.com/embed/{id}?rel=0");var i=pxt.webConfig;return pxt.Util.updateLocalizationAsync({targetId:pxt.appTarget.id,baseUrl:i.commitCdnUrl,code:n,force:r}).then(()=>s())}function s(){p.mainPkg=new pxt.MainPackage(new F)}function d(e){pxt.error(e)}pxt.react.getTilemapProject||(pxt.react.getTilemapProject=()=>(m||(m=new pxt.TilemapProject).loadPackage(p.mainPkg),m)),p.initHost=s,p.initFooter=function(e,t){if(e){var r=pxt.appTarget.appTheme,n=$("body");let t=$(e);e=$("<a/>").attr("href",r.homeUrl).attr("target","_blank");t.append(e),r.organizationLogo?e.append($("<img/>").attr("src",pxt.Util.toDataUri(r.organizationLogo))):e.append(lf("powered by {0}",r.title)),n.mouseenter(e=>t.fadeOut()),n.mouseleave(e=>t.fadeIn())}},p.showError=d;let g=void 0;function f(e,r,t){var n=e?/\w+:\w+/.test(e)?e:"pub:"+e:"empty:tsprj";let i,s,a;return g&&g._verspec==n?(p.mainPkg=g,i=p.mainPkg.host(),s=Promise.resolve(),a=Promise.resolve()):(i=p.mainPkg.host(),p.mainPkg=new pxt.MainPackage(i),p.mainPkg._verspec=e?/\w+:\w+/.test(e)?e:"pub:"+e:"empty:tsprj",s=i.downloadPackageAsync(p.mainPkg,t),a=p.mainPkg.installAllAsync(),g=p.mainPkg),s.then(()=>i.readFile(p.mainPkg,pxt.CONFIG_NAME)).then(e=>e?a.then(()=>{var e,t;r&&((e=c(p.mainPkg)).files[pxt.MAIN_TS]=r,(t=JSON.parse(e.files[pxt.CONFIG_NAME])).name=window.location.href.split("/").pop().split(/[?#]/)[0],e.files[pxt.CONFIG_NAME]=pxt.Package.stringifyConfig(t),p.mainPkg.config.name=t.name,-1==p.mainPkg.config.files.indexOf(pxt.MAIN_BLOCKS))&&p.mainPkg.config.files.push(pxt.MAIN_BLOCKS)}).catch(e=>{d(lf("Cannot load extension: {0}",e.message))}):Promise.resolve())}function _(e){var t=p.mainPkg.getTargetOptions();return t.isNative=!!e,t.hasHex=!!e,p.mainPkg.getCompileOptionsAsync(t)}function y(e,t){return _(e).then(e=>{t&&t(e);e=pxtc.compile(e);return e.diagnostics&&0<e.diagnostics.length&&e.diagnostics.forEach(e=>{pxt.error(e.messageText)}),e})}p.generateHexFileAsync=function(t){return f(t.id).then(()=>y(!0,e=>{t.code&&(e.fileSystem[pxt.MAIN_TS]=t.code)})).then(e=>(e.diagnostics&&0<e.diagnostics.length&&pxt.error("Diagnostics",e.diagnostics),e.outfiles[pxtc.BINARY_HEX]))},p.generateVMFileAsync=function(t){return pxt.setHwVariant("vm"),f(t.id).then(()=>y(!0,e=>{t.code&&(e.fileSystem[pxt.MAIN_TS]=t.code)})).then(e=>(pxt.log(e),e))},p.simulateAsync=async function(e,a){var t=a.builtJsInfo||await T(a)||await k(a);let o=t.js;if(o){let s=r(e,a,t);return b.options.messageSimulators=null==(e=null==(e=pxt.appTarget)?void 0:e.simulator)?void 0:e.messageSimulators,b.options.onSimulatorCommand=e=>{if("restart"===e.command)s.storedState=x(a.id),b.run(o,s);else if("setstate"===e.command){if(e.stateKey){var t=a.id,r=e.stateKey,n=e.stateValue,i=x(t);if(t){null!=n?i[r]=n:delete i[r];try{window.localStorage.setItem(t,JSON.stringify(i))}catch(e){}}}}else"single"===e.command&&b.setSingleSimulator()},t.breakpoints&&a.debug&&b.setBreakpoints(t.breakpoints),b.run(o,s),t}pxt.error("Program failed to compile")};let b,v;function r(e,t,r){b&&t.embedId&&v===t.embedId?b.container=e:(b=new pxsim.SimulatorDriver(e),v=t.embedId);var{fnArgs:e,parts:r,usedBuiltinParts:n}=r||{},i=pxt.appTarget.simulator.boardDefinition,s=x(t.id),n={debug:t.debug,mute:t.mute,boardDefinition:i,parts:r,builtinParts:n,fnArgs:e,cdnUrl:pxt.webConfig.commitCdnUrl,localizedStrings:pxt.Util.getLocalizedStrings(),partDefinitions:null==p.mainPkg?void 0:p.mainPkg.computePartDefinitions(r),highContrast:t.highContrast,storedState:s,light:t.light,single:t.single,hideSimButtons:t.hideSimButtons,autofocus:t.autofocus,queryParameters:t.additionalQueryParameters,mpRole:t.mpRole,theme:null==(i=p.mainPkg.config)?void 0:i.theme};return pxt.appTarget.simulator&&!t.fullScreen&&(n.aspectRatio=r.length&&pxt.appTarget.simulator.partsAspectRatio?pxt.appTarget.simulator.partsAspectRatio:pxt.appTarget.simulator.aspectRatio),window.parent&&n.aspectRatio&&n.aspectRatio!==pxt.appTarget.simulator.aspectRatio&&(s=null==(e=window.frameElement)?void 0:e.getAttribute("data-frameid"))&&window.parent.postMessage({type:"aspectratio",frameid:s,value:n.aspectRatio},"*"),b.setRunOptions(n),n}async function T(e){try{var t=Date.now(),r=await pxt.Cloud.downloadBuiltSimJsInfoAsync(e.id);return pxt.tickEvent("perfMeasurement",{durationMs:Date.now()-t,operation:"fetchSimJsInfo"}),r}catch(e){pxt.debug(e.toString())}}async function k(o){var e,t=Date.now();await f(o.id,o.code,o.dependencies);let l=!1,c=pxt.appTarget.versions.target,r=await y(!1,e=>{var t;if(e.computeUsedParts=!0,e.computeUsedSymbols=!0,o.debug&&(e.breakpoints=!0),o.assets){var r,n=JSON.parse(o.assets);for(r of Object.keys(n)){var i=n[r];e.fileSystem[r]=i,e.sourceFiles.indexOf(r)<0&&e.sourceFiles.push(r),/\.jres$/.test(r)&&(i=JSON.parse(i),e.jres=pxt.inflateJRes(i,e.jres))}}o.code&&(e.fileSystem[pxt.MAIN_TS]=o.code),e.target.preferredEditor===pxt.PYTHON_PROJECT_NAME&&(e.target.preferredEditor=pxt.JAVASCRIPT_PROJECT_NAME,e.ast=!0,t=O(pxtc.compile(e).ast,e),e.apisInfo=t,e.target.preferredEditor=pxt.PYTHON_PROJECT_NAME);var s=null==(t=p.mainPkg.config.targetVersions)?void 0:t.target;if(s&&c&&pxt.semver.cmp(pxt.semver.parse(s),pxt.semver.parse(c))<0)for(var a of Object.keys(e.fileSystem))!pxt.Util.startsWith(a,"pxt_modules")&&pxt.Util.endsWith(a,".ts")&&(l=!0,e.fileSystem[a]=pxt.patching.patchJavaScript(s,e.fileSystem[a]))});0<(null==(n=r.diagnostics)?void 0:n.length)&&l&&(pxt.log("Compile with upgrade rules failed, trying again with original code"),r=await y(!1,e=>{o.code&&(e.fileSystem[pxt.MAIN_TS]=o.code)})),r.diagnostics&&0<r.diagnostics.length&&pxt.error("Diagnostics",r.diagnostics);var n=pxtc.buildSimJsInfo(r);let i=(null==(e=null==(e=pxt.appTarget.simulator)?void 0:e.boardDefinition)?void 0:e.onboardComponents)||[];return n.allParts=r.usedParts||[],n.usedBuiltinParts=r.usedParts.filter(e=>-1!==i.indexOf(e)),n.parts=r.usedParts.filter(e=>-1===i.indexOf(e)),pxt.tickEvent("perfMeasurement",{durationMs:Date.now()-t,operation:"buildSimJsInfo"}),n}function x(e){let t={};try{var r=window.localStorage.getItem(e);r&&(t=JSON.parse(r))}catch(e){}return t}var E;function S(e,t){return p.editorLanguageMode=e,t!=pxt.Util.localeInfo()?((e=/^live-/).test(t)&&pxt.Util.enableLiveLocalizationUpdates(),pxt.Util.updateLocalizationAsync({targetId:pxt.appTarget.id,baseUrl:pxt.webConfig.commitCdnUrl,code:t.replace(e,"")})):Promise.resolve()}function U(e){var t=e.data;if(t)switch(t.type){case"fileloaded":var r=t,n=r.name;let e=E.Blocks;/\.ts$/i.test(n)?e=E.TypeScript:/\.py$/i.test(n)&&(e=E.Python),S(e,r.locale);break;case"popout":var i,n=/((\/v[0-9+])\/)?[^\/]*#(doc|md):([^&?:]+)/i.exec(window.location.href);n&&(r=pxt.webConfig.docsUrl||"/--docs",i=n[2]||"",r="doc"==n[3]?pxt.webConfig.isStatic?`/docs${n[4]}.html`:""+n[4]:r+"?md="+n[4],window.parent)&&window.parent.postMessage({type:"opendoc",url:pxt.BrowserUtils.urlJoin(i,r)},"*");break;case"localtoken":t&&t.localToken&&(pxt.Cloud.localToken=t.localToken,L.forEach(e=>e()),L=[])}}function C(t,r){return pxt.Cloud.privateGetTextAsync(r+"/text").then(e=>JSON.parse(e)).then(e=>w(t,e,r))}function w(e,t,r=null,n=!1){let i=JSON.parse(t[pxt.CONFIG_NAME])||{},s=`# ${i.name} ${i.version||""}

`,a="README.md";t[a]&&(s+=t[a].replace(/^#+/,"$0#")+"\n"),i.files.filter(e=>e!=pxt.CONFIG_NAME&&e!=a).filter(e=>{var t=e;switch(p.editorLanguageMode){case E.Blocks:return/\.blocks?$/.test(t);case E.TypeScript:return/\.ts?$/.test(t);case E.Python:return/\.py?$/.test(t)}}).forEach(e=>{/^main\.(ts|blocks)$/.test(e)||(s+=`
## ${e}
`),/\.ts$/.test(e)?s+=`\`\`\`typescript
${t[e]}
\`\`\`
`:/\.blocks?$/.test(e)?s+=`\`\`\`blocksxml
${t[e]}
\`\`\`
`:s+=`\`\`\`${e.substr(e.indexOf("."))}
${t[e]}
\`\`\`
`});var o=i&&i.dependencies&&Object.keys(i.dependencies).filter(e=>e!=pxt.appTarget.corepkg);if(o&&o.length&&(s+=`
## ${lf("Extensions")} #extensions

${o.map(e=>`* ${e}, `+i.dependencies[e]).join("\n")}

\`\`\`package
${o.map(e=>e+"="+i.dependencies[e]).join("\n")}
\`\`\`
`),r){let e=(pxt.appTarget.appTheme.shareUrl||"https://makecode.com/")+r;n&&(e="`"+e+"`"),s+=`
${e}

`}pxt.debug("print md: "+s);return I(e,s,{print:!0})}p.preloadSim=function(e,t){r(e,t),b.preload((null==(t=null==(e=pxt.appTarget)?void 0:e.simulator)?void 0:t.aspectRatio)||1,!0)},p.currentDriver=function(){return b},p.postSimMessage=function(e){null!=b&&b.postMessage(e)},p.fetchSimJsInfo=T,p.buildSimJsInfo=k,(e=E=p.LanguageMode||(p.LanguageMode={}))[e.Blocks=0]="Blocks",e[e.TypeScript=1]="TypeScript",e[e.Python=2]="Python",p.editorLanguageMode=E.Blocks,p.setEditorContextAsync=S,p.startRenderServer=function(){pxt.tickEvent("renderer.ready");let t=[],r=void 0;(0,o.initEditorExtensionsAsync)().then(()=>{window.addEventListener("message",function(e){e=e.data;"renderblocks"==e.type&&(t.push(e),function e(){if(!r){let a=t.shift();if(a){let i=a.options||{},s=(i.splitSvg=!1,pxt.tickEvent("renderer.job"),/^\s*<xml/.test(a.code));r=(async()=>{var e=(r=(s?await R(a.code,i):await N(a.code,a.options)).blocksSvg).viewBox.baseVal.width,t=r.viewBox.baseVal.height,r=r?await(0,h.blocklyToSvgAsync)(r,0,0,e,t):void 0;let n;try{n=r?await pxt.BrowserUtils.encodeToPngAsync(r.xml,{width:e,height:t}):void 0}catch(e){pxt.warn(e)}window.parent.postMessage({source:"makecode",type:"renderblocks",id:a.id,width:null==r?void 0:r.width,height:null==r?void 0:r.height,svg:null==r?void 0:r.svg,uri:n||(null==r?void 0:r.xml),css:null==r?void 0:r.css},"*")})().catch(e=>{window.parent.postMessage({source:"makecode",type:"renderblocks",id:a.id,error:e.message},"*")}).finally(()=>{r=void 0,e()})}}}())},!1),window.parent.postMessage({source:"makecode",type:"renderready",versions:pxt.appTarget.versions},"*")})},p.startDocsServer=function(e,s,n){pxt.tickEvent("docrenderer.ready");let r=[];function a(r,i){pxt.debug("rendering "+r),n&&$(n).hide(),$(s).hide(),$(e).show(),pxt.U.delay(100).then(()=>{switch(r){case"print":var e=window.localStorage.printjob;return delete window.localStorage.printjob,w(s,JSON.parse(e),void 0,!0).then(()=>pxsim.print(1e3));case"project":return w(s,JSON.parse(i)).then(()=>pxsim.print(1e3));case"projectid":return C(s,JSON.parse(i)).then(()=>pxsim.print(1e3));case"doc":return(async(e,t)=>{t=t.replace(/^\//,"");var r=await pxt.Cloud.markdownAsync(t,void 0,!0);try{await I(e,r,{path:t})}catch(e){pxt.warn(e)}})(s,i);case"book":{var n=s;var t=i;t=t.replace(/^\//,""),pxt.tickEvent("book",{id:t}),pxt.log("rendering book from "+t),$("#loading").find(".loader").addClass("text").text(lf("Compiling your book (this may take a minute)"));let r;return pxt.U.delay(100).then(()=>pxt.Cloud.markdownAsync(t,void 0,!0)).then(e=>{r=pxt.docs.buildTOC(e),pxt.log("TOC: "+JSON.stringify(r,null,2));let t=[];return pxt.docs.visitTOC(r,e=>{/^\//.test(e.path)&&!/^\/pkg\//.test(e.path)&&t.push(e)}),pxt.U.promisePoolAsync(4,t,async t=>{try{var e=await pxt.Cloud.markdownAsync(t.path,void 0,!0);t.markdown=e}catch(e){t.markdown=`_${t.path} failed to load._`}})}).then(e=>{let t=r[0].name;return pxt.docs.visitTOC(r,e=>{e.markdown&&(t+="\n\n"+e.markdown)}),I(n,t)});return}default:return I(s,i)}}).catch(e=>{$(s).html(`
                <img style="height:4em;" src="${pxt.appTarget.appTheme.docsLogo}" />
                <h1>${lf("Oops")}</h1>
                <h3>${lf("We could not load the documentation, please check your internet connection.")}</h3>
                <button class="ui button primary" id="tryagain">${lf("Try Again")}</button>`),$(s).find("#tryagain").click(()=>{a(r,i)}),window.parent&&window.parent.postMessage({type:"docfailed",docType:r,src:i},"*")}).finally(()=>{$(e).hide(),n&&$(n).show(),$(s).show()}).then(()=>{})}function i(e,t){t?(pxsim.U.addClass(e,"disabled"),e.setAttribute("aria-disabled","true")):(pxsim.U.removeClass(e,"disabled"),e.setAttribute("aria-disabled","false"))}async function t(){var t=/^#(doc|md|tutorial|book|project|projectid|print):([^&?:]+)(:([^&?:]+):([^&?:]+))?/i.exec(window.location.hash);if(t){if(n&&(r.push(window.location.hash),10<r.length&&r.shift(),1<r.length)&&i(n,!1),t[4]){let e=E.TypeScript;/^blocks$/i.test(t[4])?e=E.Blocks:/^python$/i.test(t[4])&&(e=E.Python),await S(e,t[5])}a(t[1],decodeURIComponent(t[2]))}}n&&(n.addEventListener("click",()=>{n&&(1<r.length&&(r.pop(),window.location.hash=r.pop()),r.length<=1)&&i(n,!0)}),n.addEventListener("keydown",l.fireClickOnEnter),i(n,!0)),(0,o.initEditorExtensionsAsync)().then(()=>{window.addEventListener("message",U,!1),window.addEventListener("hashchange",()=>{t()},!1),parent.postMessage({type:"sidedocready"},"*"),setTimeout(()=>t(),1)})},p.renderProjectAsync=C,p.renderProjectFilesAsync=w;let V=`
<aside id=button class=box>
<a class="ui primary button" href="@ARGS@">@BODY@</a>
</aside>

<aside id=vimeo>
<div class="ui two column stackable grid container">
<div class="column">
<div class="ui embed mdvid" data-source="vimeo" data-id="@ARGS@" data-placeholder="/thumbnail/1024/vimeo/@ARGS@" data-icon="video play">
</div>
</div></div>
</aside>

<aside id=youtube>
<div class="ui two column stackable grid container">
<div class="column">
<div class="ui embed mdvid" data-source="youtube" data-id="@ARGS@" data-placeholder="https://img.youtube.com/vi/@ARGS@/0.jpg">
</div>
</div></div>
</aside>

<aside id=section>
<!-- section @ARGS@ -->
</aside>

<aside id=hide class=box>
<div style='display:none'>
    @BODY@
</div>
</aside>

<aside id=avatar class=box>
<div class='avatar @ARGS@'>
    <div class='avatar-image'></div>
    <div class='ui compact message'>
        @BODY@
    </div>
</div>
</aside>

<aside id=hint class=box>
<div class="ui info message">
    <div class="content">
        @BODY@
    </div>
</div>
</aside>

<aside id=codecard class=box>
<pre><code class="lang-codecard">@BODY@</code></pre>
</aside>

<aside id=tutorialhint class=box>
<div class="ui hint message">
    <div class="content">
        @BODY@
    </div>
</div>
</aside>

<aside id=reminder class=box>
<div class="ui warning message">
    <div class="content">
        @BODY@
    </div>
</div>
</aside>

<aside id=alert class=box>
<div class="ui negative message">
    <div class="content">
        @BODY@
    </div>
</div>
</aside>

<aside id=tip class=box>
<div class="ui positive message">
    <div class="content">
        @BODY@
    </div>
</div>
</aside>

<!-- wrapped around ordinary content -->
<aside id=main-container class=box>
<div class="ui text">
    @BODY@
</div>
</aside>

<!-- used for 'column' box - they are collected and wrapped in 'column-container' -->
<aside id=column class=aside>
<div class='column'>
    @BODY@
</div>
</aside>
<aside id=column-container class=box>
<div class="ui three column stackable grid text">
    @BODY@
</div>
</aside>
@breadcrumb@
@body@`;function I(e,t,r={}){var t=pxt.docs.renderMarkdown({template:V,markdown:t,theme:pxt.appTarget.appTheme}),n=r.blocksAspectRatio||window.innerHeight<window.innerWidth?1.62:1/1.62,t=($(e).html(t),$(e).find("a").attr("target","_blank"),(0,l.defaultClientRenderOptions)());return t.tutorial=!!r.tutorial,t.blocksAspectRatio=n||t.blocksAspectRatio,t.showJavaScript=p.editorLanguageMode==E.TypeScript,r.print&&(t.showEdit=!1,t.simulator=!1),(0,l.renderAsync)(t).then(()=>{$(e).find('a[href^="/"]').removeAttr("target").each((e,t)=>{$(t).attr("href","#doc:"+$(t).attr("href").replace(/^\//,""))}),$(e).find(".ui.embed").embed()})}p.renderMarkdownAsync=I;let A,D;function N(r,l){let{assets:c,forceCompilation:n,snippetMode:u,generateSourceMap:d}=l||{};return f(l&&l.packageId?"pub:"+l.packageId:l&&l.package?"docs:"+l.package:null,r).then(()=>_(!!pxt.appTarget.compile&&pxt.appTarget.compile.hasHex)).then(e=>{if(r&&(e.fileSystem[pxt.MAIN_TS]=r),e.ast=!0,c)for(var t of Object.keys(c))e.sourceFiles.indexOf(t)<0&&e.sourceFiles.push(t),e.fileSystem[t]=c[t];let i=void 0,s,a=(s=n?(i=pxtc.compile(e))&&i.ast:pxtc.getTSProgram(e,A),A=s,void 0),o=(pxt.appTarget.appTheme.python&&(a=ts.pxtc.transpile.tsToPy(s,pxt.MAIN_TS)),O(s,e));return ts.pxtc.localizeApisAsync(o,p.mainPkg).then(()=>{var e=pxtc.getBlocksInfo(o),t=((0,h.initializeAndInject)(e),null==c?void 0:c[pxt.TILEMAP_JRES]),r=null==c?void 0:c[pxt.IMAGES_JRES],e=((t||r)&&((m=new pxt.TilemapProject).loadPackage(p.mainPkg),t&&m.loadTilemapJRes(JSON.parse(t),!0),r)&&m.loadAssetsJRes(JSON.parse(r)),pxtc.decompiler.decompileToBlocks(e,s.getSourceFile(pxt.MAIN_TS),{snippetMode:u,generateSourceMap:d}));if(e.diagnostics&&0<e.diagnostics.length&&e.diagnostics.forEach(e=>pxt.error(e.messageText)),!e.success)return{package:p.mainPkg,compileProgram:s,compileJS:i,compileBlocks:e,apiInfo:o};pxt.debug(e.outfiles[pxt.MAIN_BLOCKS]);var n=(0,h.render)(e.outfiles[pxt.MAIN_BLOCKS],l);return(t||r)&&(m=null),{package:p.mainPkg,compileProgram:s,compileJS:i,compileBlocks:e,compilePython:a,apiInfo:o,blocksSvg:n}})})}function O(e,t){D=D||{};var r=Object.keys(t.fileSystem).sort().join(";");return D[r]||(D[r]=pxtc.getApiInfo(e,t.jres)),D[r]}function R(i,s){let a=(s||{}).assets;return f(s&&s.packageId?"pub:"+s.packageId:s&&s.package?"docs:"+s.package:null,"").then(()=>_(!!pxt.appTarget.compile&&pxt.appTarget.compile.hasHex)).then(e=>{if(e.ast=!0,a)for(var t of Object.keys(a))e.sourceFiles.indexOf(t)<0&&e.sourceFiles.push(t),e.fileSystem[t]=a[t];let n=O(pxtc.compile(e).ast,e);return ts.pxtc.localizeApisAsync(n,p.mainPkg).then(()=>{var e=pxtc.getBlocksInfo(n),e=((0,h.initializeAndInject)(e),null==a?void 0:a[pxt.TILEMAP_JRES]),t=null==a?void 0:a[pxt.IMAGES_JRES],r=((e||t)&&((m=new pxt.TilemapProject).loadPackage(p.mainPkg),e&&m.loadTilemapJRes(JSON.parse(e),!0),t)&&m.loadAssetsJRes(JSON.parse(t)),(0,h.render)(i,s));return(e||t)&&(m=null),{package:p.mainPkg,blocksSvg:r,apiInfo:n}})})}p.decompileSnippetAsync=N,p.compileBlocksAsync=R;let L=[];let P=[];p.setInitCallbacks=function(e){P=e},p.init=function(){B().then(()=>{for(let e=0;e<P.length;++e)P[e]()})}},{"../pxtblocks":74,"../pxteditor/editor":151,"./renderer":166,blockly:175}],168:[function(e,t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.IFrameEmbeddedClient=void 0;class n{constructor(e){this.messageHandler=e,this.onMessageReceived=e=>{var t=e.data;if(t){if("iframeclientsetmessageport"===t.type)return this.port=e.ports[0],this.port.onmessage=this.onMessageReceived,void this.postMessage({type:"iframeclientsetmessageport"});if("iframeclientready"===t.type)return void this.sendReadyMessage()}this.messageHandler(e)},this.frameId=(()=>{var e=/frameid=([a-zA-Z0-9\-]+)/i.exec(window.location.href);if(e)return e[1]})(),window.addEventListener("message",this.onMessageReceived),this.sendReadyMessage()}dispose(){window.removeEventListener("message",this.onMessageReceived),this.port&&this.port.close()}postMessage(e){this.postMessageCore(e)}postMessageCore(e){this.frameId&&(e.frameId=this.frameId),this.port?this.port.postMessage(e):window.acquireVsCodeApi?window.acquireVsCodeApi().postMessage(e):window.parent&&window.parent!==window&&window.parent.postMessage(e,"*")}sendReadyMessage(){this.postMessage({type:"iframeclientready"})}}r.IFrameEmbeddedClient=n},{}],169:[function(e,t,r){var n=this,i=t=>{{var r={370:e=>{e.exports=t}},n={};function i(e){var t=n[e];return void 0!==t||(t=n[e]={exports:{}},r[e](t,t.exports,i)),t.exports}i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var e={},o=((i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(e),i.d(e,{FieldGridDropdown:()=>a}),i(370));class l{constructor(e,t,r,n){this.value=r,this.selected=!1,this.selectionCallback=n,this.element=document.createElement("button"),this.element.id=o.utils.idGenerator.getNextUniqueId(),this.element.className="blocklyFieldGridItem",this.clickHandler=o.browserEvents.conditionalBind(this.element,"click",this,this.onClick,!0),e.appendChild(this.element);r="string"==typeof t?document.createTextNode(t):t;this.element.appendChild(r),o.utils.aria.setRole(this.element,o.utils.aria.Role.GRIDCELL)}dispose(){this.selectionCallback=null,this.element.remove(),this.clickHandler&&(o.browserEvents.unbind(this.clickHandler),this.clickHandler=null)}getId(){return this.element.id}getValue(){return this.value}isSelected(){return this.selected}setSelected(e){this.selected=e,o.utils.aria.setState(this.element,o.utils.aria.State.SELECTED,this.selected),this.element.classList.toggle("blocklyFieldGridItemSelected",this.selected),this.isSelected()&&this.focus()}onClick(){var e;this.setSelected(!0),null!=(e=this.selectionCallback)&&e.call(this,this)}focus(){this.element.focus({preventScroll:!0});var e,t,r,n=this.element.offsetParent;n&&(e=this.element.offsetTop,t=n.scrollTop,r=this.getInterItemSpacing(),e<t?n.scrollTo(0,e-r):e+this.element.offsetHeight>t+n.clientHeight&&n.scrollBy(0,e+this.element.clientHeight-(t+n.clientHeight)+r))}getInterItemSpacing(){let e=this.element.closest(".blocklyFieldGrid");if(e){var t=[...e.querySelectorAll(".blocklyFieldGridItem")];if(t.length){var r=t[0].offsetTop,n=t[0].offsetHeight;for(let e of t)if(e.offsetTop!==r)return e.offsetTop-n-r}}return 0}}class s{constructor(e,t,r,n,i){if(this.columns=r,this.rtl=n,this.itemIndices=new Map,this.items=new Array,this.keyDownHandler=null,this.pointerMoveHandler=null,this.selectionCallback=i,this.root=document.createElement("div"),this.root.className="blocklyFieldGrid",this.root.tabIndex=0,o.utils.aria.setRole(this.root,o.utils.aria.Role.GRID),e.appendChild(this.root),this.populateItems(t),this.keyDownHandler=o.browserEvents.conditionalBind(this.root,"keydown",this,this.onKeyDown),this.pointerMoveHandler=o.browserEvents.conditionalBind(this.root,"pointermove",this,this.onPointerMove,!0),!(1<=r))throw new Error("Number of columns must be >= 1; got "+r);this.columns=r,this.root.style.setProperty("--grid-columns",""+this.columns)}populateItems(e){let i=document.createElement("div");for(var[s,a]of e.entries())if(a!==o.FieldDropdown.SEPARATOR){s%this.columns==0&&((i=document.createElement("div")).className="blocklyFieldGridRow",o.utils.aria.setRole(i,o.utils.aria.Role.ROW),this.root.appendChild(i));let[t,e]=a,r=(()=>{if((e=t)&&"object"==typeof e&&"src"in e&&"string"==typeof e.src&&"alt"in e&&"string"==typeof e.alt&&"width"in e&&"number"==typeof e.width&&"height"in e&&"number"==typeof e.height){let e=new Image(t.width,t.height);return e.src=t.src,e.alt=t.alt||"",e}var e;return t})(),n=new l(i,r,e,e=>{var t;this.setSelectedValue(e.getValue()),null!=(t=this.selectionCallback)&&t.call(this,e)});this.itemIndices.set(n.getId(),this.itemIndices.size),this.items.push(n)}}dispose(){this.selectionCallback=void 0;for(var e of this.items)e.dispose();this.itemIndices.clear(),this.items.length=0,this.keyDownHandler&&(o.browserEvents.unbind(this.keyDownHandler),this.keyDownHandler=null),this.pointerMoveHandler&&(o.browserEvents.unbind(this.pointerMoveHandler),this.pointerMoveHandler=null),this.root.remove()}onKeyDown(e){if(!(!this.items.length||e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){switch(e.key){case"ArrowUp":this.moveFocus(-1*this.columns,!0);break;case"ArrowDown":this.moveFocus(this.columns,!0);break;case"ArrowLeft":this.moveFocus(-1*(this.rtl?-1:1),!0);break;case"ArrowRight":this.moveFocus(this.rtl?-1:1,!0);break;case"PageUp":case"Home":this.moveFocus(0,!1);break;case"PageDown":case"End":this.moveFocus(this.items.length-1,!1);break;case"Enter":case"Space":return void e.stopPropagation();default:return}e.preventDefault(),e.stopPropagation()}}onPointerMove(e){(e.movementX||e.movementY)&&e.target instanceof Element&&(e=e.target.closest(".blocklyFieldGridItem"))&&(e=e.id,void 0!==(e=this.itemIndices.get(e)))&&this.moveFocus(e,!1)}setSelectedValue(e){for(var[t,r]of this.items.entries()){var n=r.getValue()===e;r.setSelected(n),n&&this.moveFocus(t,!1)}}moveFocus(e,t){let r=e;if(t){let e=this.getFocusedItem();if(!e)return;r+=this.indexOfItem(e)}e=this.itemAtIndex(r);e&&(e.focus(),o.utils.aria.setState(this.root,o.utils.aria.State.ACTIVEDESCENDANT,e.getId()))}indexOfItem(e){return null!=(e=this.itemIndices.get(e.getId()))?e:-1}itemAtIndex(e){return this.items[e]}getFocusedItem(){var e=null!=(e=this.root.querySelector(".blocklyFieldGridItem:focus"))?e:this.root.querySelector(".blocklyFieldGridItem");return e&&e.id&&void 0!==(e=this.itemIndices.get(e.id))?this.itemAtIndex(e):void 0}}class a extends o.FieldDropdown{constructor(e,t,r){super(e,t,r),this.columns=3,null!=r&&r.columns&&this.setColumns(parseInt(""+r.columns)),r&&r.primaryColour&&(this.primaryColour=r.primaryColour),r&&r.borderColour&&(this.borderColour=r.borderColour)}static fromJson(e){if(e.options)return new this(e.options,void 0,e);throw new Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.")}setColumns(e){!isNaN(e)&&1<=e&&(this.columns=e,o.DropDownDiv.getOwner()===this)&&o.DropDownDiv.isVisible()&&(null!=(e=this.grid)&&e.dispose(),this.showEditor_())}showEditor_(e){o.DropDownDiv.clearContent();var t=!(null==(t=this.getSourceBlock())||!t.workspace.RTL),t=(this.grid=new s(o.DropDownDiv.getContentDiv(),this.getOptions(!1),this.columns,t,e=>{o.DropDownDiv.hideIfOwner(this),this.setValue(e.getValue())}),o.DropDownDiv.getContentDiv().classList.add("blocklyFieldGridContainer"),this.getColours()),t=(t&&t.border&&o.DropDownDiv.setColour(t.primary,t.border),o.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.getValue());t&&this.grid.setSelectedValue(t)}doValueUpdate_(e){var t;super.doValueUpdate_(e),null!=(t=this.grid)&&t.setSelectedValue(e)}getColours(){var e,t;return this.primaryColour&&this.borderColour?{primary:this.primaryColour,border:this.borderColour}:(t=this.getSourceBlock())instanceof o.BlockSvg&&(t=t.isShadow()?t.getParent():t)?{primary:null!=(e=this.primaryColour)?e:t.getColour(),border:null!=(e=this.borderColour)?e:t.getColourTertiary()}:void 0}}return o.fieldRegistry.register("field_grid_dropdown",a),o.Css.register("\n   .blocklyFieldGridContainer {\n     padding: 7px;\n     overflow: auto;\n   }\n   \n  .blocklyFieldGrid {\n    display: grid;\n    grid-gap: 7px;\n    grid-template-columns: repeat(var(--grid-columns), min-content);\n  }\n\n .blocklyFieldGrid .blocklyFieldGridItem {\n   border: 1px solid rgba(1, 1, 1, 0.5);\n   border-radius: 4px;\n   color: white;\n   min-width: auto;\n   background: none;\n   white-space: nowrap;\n   cursor: pointer;\n   padding: 6px 15px;\n }\n \n .blocklyFieldGrid .blocklyFieldGridRow {\n   display: contents;\n }\n \n .blocklyFieldGrid .blocklyFieldGridItem.blocklyFieldGridItemSelected {\n   background-color: rgba(1, 1, 1, 0.25);\n }\n\n .blocklyFieldGrid .blocklyFieldGridItem:focus {\n   box-shadow: 0 0 0 4px hsla(0, 0%, 100%, .2);\n   outline: none;\n }\n "),e}};if("object"==typeof r&&"object"==typeof t)t.exports=i(e("blockly/core"));else if("function"==typeof define&&define.amd)define(["blockly/core"],i);else{var s,a=i("object"==typeof r?e("blockly/core"):n.Blockly);for(s in a)("object"==typeof r?r:n)[s]=a[s]}},{"blockly/core":174}],170:[function(e,t,r){var n=this,i=t=>{{var r={370:e=>{e.exports=t}},n={};function i(e){var t=n[e];return void 0!==t||(t=n[e]={exports:{}},r[e](t,t.exports,i)),t.exports}i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var s={},a=((i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(s),i.d(s,{WorkspaceSearch:()=>o}),i(370));let e=(()=>{let r=!1;return function(){var e,t;r||(r=!0,(e=document.createElement("style")).id="blockly-ws-search-style",t=document.createTextNode("path.blocklyPath.blockly-ws-search-highlight {\n    fill: #000;\n  }\n  path.blocklyPath.blockly-ws-search-highlight.blockly-ws-search-current {\n    fill: grey;\n  }\n  .blockly-ws-search-close-btn {\n    background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aCBkPSJNMTkgNi40MUwxNy41OSA1IDEyIDEwLjU5IDYuNDEgNSA1IDYuNDEgMTAuNTkgMTIgNSAxNy41OSA2LjQxIDE5IDEyIDEzLjQxIDE3LjU5IDE5IDE5IDE3LjU5IDEzLjQxIDEyeiIvPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz48L3N2Zz4=) no-repeat top left;\n  }\n  .blockly-ws-search-next-btn {\n    background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aCBkPSJNNy40MSA4LjU5TDEyIDEzLjE3bDQuNTktNC41OEwxOCAxMGwtNiA2LTYtNiAxLjQxLTEuNDF6Ii8+PHBhdGggZD0iTTAgMGgyNHYyNEgwVjB6IiBmaWxsPSJub25lIi8+PC9zdmc+) no-repeat top left;\n  }\n  .blockly-ws-search-previous-btn {\n    background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aCBkPSJNNy40MSAxNS40MUwxMiAxMC44M2w0LjU5IDQuNThMMTggMTRsLTYtNi02IDZ6Ii8+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjwvc3ZnPg==) no-repeat top left;\n  }\n  .blockly-ws-search {\n    background: #fff;\n    border: solid lightgrey 0.5px;\n    box-shadow: 0px 10px 20px grey;\n    justify-content: center;\n    padding: 0.25em;\n    position: absolute;\n    z-index: 70;\n  }\n  .blockly-ws-search-input input {\n    border: none;\n  }\n  .blockly-ws-search button {\n    border: none;\n    padding-left: 6px;\n    padding-right: 6px;\n  }\n  .blockly-ws-search-actions {\n    display: flex;\n  }\n  .blockly-ws-search-container {\n    display: flex;\n  }\n  .blockly-ws-search-content {\n    display: flex;\n  }"),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild))}})();class o{constructor(e){this.workspace=e,this.id="workspaceSearch",this.htmlDiv=null,this.actionDiv=null,this.inputElement=null,this.textInputPlaceholder="Search",this.blocks=[],this.lastHighlighted=null,this.currentBlockIndex=-1,this.searchText="",this.searchOnInput=!0,this.caseSensitive=!1,this.preserveSelected=!0,this.boundEvents=[]}init(){this.workspace.getComponentManager().addComponent({component:this,weight:0,capabilities:[a.ComponentManager.Capability.POSITIONABLE]}),e(),this.createDom(),this.setVisible(!1),this.workspace.resize()}dispose(){for(var e of this.boundEvents)a.browserEvents.unbind(e);this.boundEvents.length=0,this.htmlDiv&&(this.htmlDiv.remove(),this.htmlDiv=null),this.actionDiv=null,this.inputElement=null}createDom(){var e=this.workspace.getInjectionDiv(),t=(this.addEvent(e,"keydown",this,e=>this.onWorkspaceKeyDown(e)),this.htmlDiv=document.createElement("div"),a.utils.dom.addClass(this.htmlDiv,"blockly-ws-search"),document.createElement("div")),r=(a.utils.dom.addClass(t,"blockly-ws-search-container"),document.createElement("div")),n=(a.utils.dom.addClass(r,"blockly-ws-search-content"),t.appendChild(r),document.createElement("div")),n=(a.utils.dom.addClass(n,"blockly-ws-search-input"),this.inputElement=this.createTextInput(),this.addEvent(this.inputElement,"keydown",this,e=>this.onKeyDown(e)),this.addEvent(this.inputElement,"input",this,()=>this.onInput()),this.addEvent(this.inputElement,"click",this,()=>{var e;this.searchAndHighlight(this.searchText,this.preserveSelected),null!=(e=this.inputElement)&&e.select()}),n.appendChild(this.inputElement),r.appendChild(n),this.actionDiv=document.createElement("div"),a.utils.dom.addClass(this.actionDiv,"blockly-ws-search-actions"),r.appendChild(this.actionDiv),this.createNextBtn()),r=(n&&this.addActionBtn(n,()=>this.next()),this.createPreviousBtn()),n=(r&&this.addActionBtn(r,()=>this.previous()),this.createCloseBtn());n&&(this.addBtnListener(n,()=>this.close()),t.appendChild(n)),this.htmlDiv.appendChild(t),e.insertBefore(this.htmlDiv,this.workspace.getParentSvg())}addEvent(e,t,r,n){e=a.browserEvents.conditionalBind(e,t,r,n);this.boundEvents.push(e)}addActionBtn(e,t){this.addBtnListener(e,t),null!=(t=this.actionDiv)&&t.appendChild(e)}createTextInput(){var e=document.createElement("input");return e.type="text",e.setAttribute("placeholder",this.textInputPlaceholder),e}createNextBtn(){return this.createBtn("blockly-ws-search-next-btn","Find next")}createPreviousBtn(){return this.createBtn("blockly-ws-search-previous-btn","Find previous")}createCloseBtn(){return this.createBtn("blockly-ws-search-close-btn","Close search bar")}createBtn(e,t){var r=document.createElement("button");return a.utils.dom.addClass(r,e),r.setAttribute("aria-label",t),r}addBtnListener(e,t){this.addEvent(e,"click",this,t),this.addEvent(e,"keydown",this,e=>{"Enter"===e.key?(t(e),e.preventDefault()):"Escape"===e.key&&this.close(),e.stopPropagation()})}getBoundingRectangle(){return null}position(e,t){this.htmlDiv&&(this.workspace.RTL?this.htmlDiv.style.left=e.absoluteMetrics.left+"px":e.toolboxMetrics.position===a.TOOLBOX_AT_RIGHT?this.htmlDiv.style.right=e.toolboxMetrics.width+"px":this.htmlDiv.style.right="0",this.htmlDiv.style.top=e.absoluteMetrics.top+"px")}onInput(){var e;this.searchOnInput&&this.inputElement&&(e=this.inputElement.value.trim())!==this.searchText&&this.searchAndHighlight(e,this.preserveSelected)}onKeyDown(e){if("Escape"===e.key)this.close();else if("Enter"===e.key)if(this.searchOnInput)e.shiftKey?this.previous():this.next();else if(this.inputElement){let e=this.inputElement.value.trim();e!==this.searchText&&this.searchAndHighlight(e,this.preserveSelected)}}onWorkspaceKeyDown(e){(e.ctrlKey||e.metaKey)&&"f"===e.key&&(this.open(),e.preventDefault(),e.stopPropagation())}previous(){this.setCurrentBlock(this.currentBlockIndex-1)}next(){this.setCurrentBlock(this.currentBlockIndex+1)}setSearchPlaceholder(e){this.textInputPlaceholder=e,this.inputElement&&this.inputElement.setAttribute("placeholder",this.textInputPlaceholder)}setCurrentBlock(e){var t;this.blocks.length&&((t=this.blocks[this.currentBlockIndex])&&this.unhighlightCurrentSelection(t),this.currentBlockIndex=(e%this.blocks.length+this.blocks.length)%this.blocks.length,t=this.blocks[this.currentBlockIndex],this.highlightCurrentSelection(t),this.workspace.centerOnBlock(t.id,!1),this.lastHighlighted=t)}open(){var e;this.setVisible(!0),null!=(e=this.inputElement)&&e.focus(),null!=(e=this.inputElement)&&e.select(),this.searchText&&this.searchAndHighlight(this.searchText)}close(){this.setVisible(!1);var e=a.FocusManager.getFocusManager();this.lastHighlighted&&!this.lastHighlighted.isDisposed()?e.focusNode(this.lastHighlighted):e.focusTree(this.workspace),this.clearBlocks(),this.lastHighlighted=null}setVisible(e){this.htmlDiv&&(this.htmlDiv.style.display=e?"flex":"none")}searchAndHighlight(e,t){var r=this.blocks[this.currentBlockIndex];this.searchText=e.trim(),this.clearBlocks(),this.blocks=this.getMatchingBlocks(this.workspace,this.searchText,this.caseSensitive),this.highlightSearchGroup(this.blocks);let n=0;t&&(n=-1<(n=this.blocks.indexOf(r))?n:0),this.setCurrentBlock(n)}getSearchPool(e){return e.getAllBlocks(!0).filter(e=>{e=e.getSurroundParent();return!e||!e.isCollapsed()})}isBlockMatch(e,t,r){let n="";if(e.isCollapsed())n=e.toString();else{let t=[];e.inputList.forEach(e=>{e.fieldRow.forEach(e=>{t.push(e.getText())})}),n=t.join(" ").trim()}return-1<(n=r?n:n.toLowerCase()).indexOf(t)}getMatchingBlocks(e,t,r){return t?(this.caseSensitive||(t=t.toLowerCase()),this.getSearchPool(e).filter(e=>this.isBlockMatch(e,t,r))):[]}clearBlocks(){this.unhighlightSearchGroup(this.blocks);var e=this.blocks[this.currentBlockIndex];e&&this.unhighlightCurrentSelection(e),this.currentBlockIndex=-1,this.blocks=[]}highlightCurrentSelection(e){e=e.pathObject.svgPath;a.utils.dom.addClass(e,"blockly-ws-search-current")}unhighlightCurrentSelection(e){e=e.pathObject.svgPath;a.utils.dom.removeClass(e,"blockly-ws-search-current")}highlightSearchGroup(e){e.forEach(e=>{e=e.pathObject.svgPath;a.utils.dom.addClass(e,"blockly-ws-search-highlight")})}unhighlightSearchGroup(e){e.forEach(e=>{e=e.pathObject.svgPath;a.utils.dom.removeClass(e,"blockly-ws-search-highlight")})}}return s}};if("object"==typeof r&&"object"==typeof t)t.exports=i(e("blockly/core"));else if("function"==typeof define&&define.amd)define(["blockly/core"],i);else{var s,a=i("object"==typeof r?e("blockly/core"):n.Blockly);for(s in a)("object"==typeof r?r:n)[s]=a[s]}},{"blockly/core":174}],171:[function(e,r,n){!function(rm){!function(){var e,t;e=this,t=function(){var m,M,F,B,$,U,V,H,g,G,l,c,j,a,K,o,z,W,q,J,Y,X,Z,Q,ee,te,re,ne,ie,se,ae,oe,le,ce,ue,de,pe,he,me,ge,fe,_e,ye,be,ve,Te,ke,xe,Ee,Se,Ce,we,Ie,Ae,De,Ne,Oe,Re,Le,Pe,Me,Fe,Be,$e,Ue,Ve,He,Ge,je,Ke,ze,We,qe,Je,Ye,Xe,Ze,Qe,et,tt,rt,nt,it,st,at,ot,lt,ct,ut,dt,pt,ht,mt,gt,ft,_t,yt,bt,vt,Tt,kt,xt,Et,St,Ct,wt,It,At,Dt,Nt,Ot,Rt,Lt,Pt,Mt,Ft,Bt,$t,Ut,Vt,Ht,Gt,jt,Kt,zt,Wt,qt,Jt,Yt,Xt,Zt,Qt,er,tr,rr,nr,ir,sr,ar,or,lr,cr,ur,dr,pr,hr,mr,gr,fr,_r,yr,br,vr,Tr,kr,xr,Er,Sr,Cr,wr,Ir,Ar,Dr,Nr,Or,Rr,Lr,Pr,Mr,Fr,Br,$r,Ur,Vr,Hr,Gr,jr,Kr,zr,Wr,qr,Jr,Yr,Xr,Zr,Qr,en,tn,rn,nn,sn,an,on,ln,cn,un,dn,pn,hn,mn,gn,fn,_n,yn,bn,vn,Tn,kn,xn,En,Sn,Cn,wn,In,An,Dn,Nn,On,Rn,Ln,Pn,Mn,Fn,Bn,$n,Un,Vn,Hn,Gn,jn,Kn,zn,Wn,qn,Jn,Yn,Xn,Zn,Qn,ei,ti,ri,ni,ii,si,ai,oi,li,u,ci,ui,di,pi,hi,d,mi,gi,fi,_i,yi,bi,vi,Ti,ki,xi,Ei,Si,Ci,wi,Ii,Ai,Di,Ni,Oi,Ri,Li,Pi,Mi,Fi,Bi,$i,Ui,Vi,Hi,Gi,ji,Ki,zi,Wi,qi,Ji,Yi,Xi,Zi,Qi,es,ts,rs,ns,is,ss,as,os,ls,cs,us,ds,ps,hs,ms,gs,fs,_s,ys,bs,vs,Ts,ks,xs,Es,Ss,Cs,ws,Is,As,Ds,Ns,Os,Rs,Ls,Ps,Ms,Fs,Bs,$s,Us,Vs,Hs,Gs,js,Ks,zs,Ws,qs,Js,Ys,Xs,Zs,Qs,ea,ta,ra,na,ia,sa,aa,p,f={},i=function(e,t,r,n){if(!(e instanceof _)&&"string"!=typeof e||""===(""+e).trim())throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e=(""+e).toLowerCase(),"string"!=typeof t||""===t.trim())throw Error('Invalid name "'+t+'". The name must be a non-empty string.');var i=t.toLowerCase();if(!r)throw Error("Can not register a null value");let s=Ma[e],a=Ba[e];if(s||(s=Ma[e]=Object.create(null),a=Ba[e]=Object.create(null)),oa(e,r),!n&&s[i]&&s[i]!==r)throw Error('Name "'+i+'" with type "'+e+'" already registered.');s[i]=r,a[i]=t},oa=function(e,t){if(e===String(_.FIELD))if("function"!=typeof t.fromJson)throw Error('Type "'+e+'" must have a fromJson function')},la=function(e,t){e=(""+e).toLowerCase(),t=t.toLowerCase();var r=Ma[e];r&&r[t]?(delete Ma[e][t],delete Ba[e][t]):console.warn("Unable to unregister ["+t+"]["+e+"] from the registry.")},ca=function(e,t,r){e=(""+e).toLowerCase(),t=t.toLowerCase();var n=Ma[e];if(n&&n[t])return n[t];if(t="Unable to find ["+t+"]["+e+"] in the registry.",r)throw Error(t+" You must require or register a "+e+" plugin.");return console.warn(t),null},ua=function(e,t){return e=(""+e).toLowerCase(),t=t.toLowerCase(),!!(e=Ma[e])&&!!e[t]},da=ca,pa=ca,ha=function(e,t,r){e=(""+e).toLowerCase();var n,i=Ma[e];if(!i){if(i=`Unable to find [${e}] in the registry.`,r)throw Error(i+` You must require or register a ${e} plugin.`);return console.warn(i),null}if(!t)return i;e=Ba[e],r=Object.create(null);for(n of Object.keys(i))r[e[n]]=i[n];return r},ma=function(e,t,r){return"function"==typeof(t=t.plugins[String(e)]||$a)?t:da(e,t,r)},ga=function(e,t){fa(),Ka=setTimeout(function(){t&&t.handleRightClick(e)},Va)},fa=function(){Ka&&(clearTimeout(Ka),Ka=0)},_a=function(){Ga=null},ya=function(e){return!e.type.startsWith("pointer")||e instanceof PointerEvent&&va(e)},ba=function(e){return""+e.pointerId},va=function(e){var t=ba(e);return Ga?Ga===t:"pointerdown"===e.type&&(Ga=t,!0)},h=function(t,r,n,i,s){function a(e){(s||ya(e))&&(n?i.call(n,e):i(e))}var o=[];if(r in ja)for(let e=0;e<ja[r].length;e++){var l=ja[r][e];t.addEventListener(l,a,!1),o.push([t,l,a])}else t.addEventListener(r,a,!1),o.push([t,r,a]);return o},Ta=function(t,r,n,i){function s(e){n?i.call(n,e):i(e)}var a=[];if(r in ja)for(let e=0;e<ja[r].length;e++){var o=ja[r][e];t.addEventListener(o,s,!1),a.push([t,o,s])}else t.addEventListener(r,s,!1),a.push([t,r,s]);return a},s=function(e){for(var t=e[e.length-1][2];e.length;){var[r,n,i]=e.pop();r.removeEventListener(n,i,!1)}return t},ka=function(e){if(e.target instanceof HTMLElement){if(e.target.isContentEditable||"true"===e.target.getAttribute("data-is-text-input"))return!0;if(e.target instanceof HTMLInputElement)return"text"===(e=e.target).type||"number"===e.type||"email"===e.type||"password"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type;if(e.target instanceof HTMLTextAreaElement)return!0}return!1},xa=function(e){return!(!e.ctrlKey||!mo)||2===e.button},Ea=function(e,t,r){var n=t.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,r=r||t.getScreenCTM().inverse(),n.matrixTransform(r)},Sa=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*_o,y:e.deltaY*_o};case 2:return{x:e.deltaX*yo,y:e.deltaY*yo}}},Ca=function(){return"blockly-"+(xo++).toString(36)},wa=function(){return ko.genUid()},Ia=function(e){return e.type===y.BLOCK_CREATE},Aa=function(e){return e.type===y.BLOCK_DELETE},Da=function(e){return e.type===y.BLOCK_CHANGE},Na=function(e){return e.type===y.BLOCK_FIELD_INTERMEDIATE_CHANGE},Oa=function(e){return e.type===y.BLOCK_MOVE},Ra=function(e){return e.type===y.CLICK},La=function(e){return e.type===y.BUBBLE_OPEN},Pa=function(e){return e.type===y.VIEWPORT_CHANGE},Ma=(f.setRecordUndo$$module$build$src$core$events$utils=function(e){So=e},ca=function(){return So},m=function(e){Ao.fireInternal(e)},jo=function(e){if(U()){if(!Io.length)try{requestAnimationFrame(()=>{setTimeout(M,0)})}catch(e){setTimeout(M,0)}F(e)}},M=function(){var e,t,r=B(Io);Io.length=0;for(e of r)e.workspaceId&&null!=(t=re(e.workspaceId))&&t.fireChangeListener(e)},F=function(t){if(Da(t)&&"mutation"===t.element){let e;for(e=Io.length;0<e;e--){var r=Io[e-1];if(r.group!==t.group||r.workspaceId!==t.workspaceId||!Oa(r)||r.newParentId!==t.blockId)break}Io.splice(e,0,t)}else Io.push(t)},B=function(e){var t,r,n=[];for(t of e)e=n[n.length-1],t.isNull()||(e&&e.workspaceId===t.workspaceId&&e.group===t.group?Oa(t)&&Oa(e)&&t.blockId===e.blockId?(e.newParentId=t.newParentId,e.newInputName=t.newInputName,e.newCoordinate=t.newCoordinate,(e.reason||t.reason)&&(e.reason=Array.from(new Set((null!=(r=e.reason)?r:[]).concat(null!=(r=t.reason)?r:[]))))):Da(t)&&Da(e)&&t.blockId===e.blockId&&t.element===e.element&&t.name===e.name?e.newValue=t.newValue:Pa(t)&&Pa(e)?(e.viewTop=t.viewTop,e.viewLeft=t.viewLeft,e.scale=t.scale,e.oldScale=t.oldScale):Ra(t)&&La(e)||n.push(t):n.push(t));return n.filter(e=>!e.isNull())},$=function(){for(let e=0,t;t=Io[e];e++)t.recordUndo=!1},f.disable$$module$build$src$core$events$utils=function(){Co++},f.enable$$module$build$src$core$events$utils=function(){Co--},U=function(){return 0===Co},f.getGroup$$module$build$src$core$events$utils=function(){return Eo},f.setGroup$$module$build$src$core$events$utils=function(e){Ao.setGroupInternal(e)},Ko=function(e){Eo="boolean"==typeof e?e?wa():"":e},V=function(r){var n=[];r=r.getDescendants(!1);for(let e=0,t;t=r[e];e++)n[e]=t.id;return n},H=function(e,t){var r=g(e.type);if(r)return r.fromJson(e,t);throw Error("Unknown event type.")},g=function(e){var t=da(_.EVENT,e);if(t)return t;throw Error(`Event type ${e} not found in registry.`)},G=function(e){if((Oa(e)||Ia(e))&&e.workspaceId){var t=re(e.workspaceId);if(!e.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(e=t.getBlockById(e.blockId)){var r=So;try{So=!1;var n=e.getParent();if(n&&!n.hasDisabledReason(wo)){var i=e.getDescendants(!1);for(let e=0,t;t=i[e];e++)t.setDisabledReason(!1,wo)}else if((e.outputConnection||e.previousConnection)&&!t.isDragging())for(;e.setDisabledReason(!0,wo),e=e.getNextBlock(););}finally{So=r}}}},l=function(e,t,r){for(var n in e=document.createElementNS(Do,""+e),t)e.setAttribute(n,""+t[n]);return r&&r.appendChild(e),e},c=function(t,e){return!(e=e.split(" ")).every(e=>t.classList.contains(e))&&(t.classList.add(...e),!0)},j=function(e,t){e.classList.remove(...t.split(" "))},a=function(t,e){return!(e=e.split(" ")).every(e=>!t.classList.contains(e))&&(t.classList.remove(...e),!0)},K=function(e,t){return e.classList.contains(t)},o=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},z=function(e,t){var r=t.nextSibling;if(!(t=t.parentNode))throw Error("Reference node has no parent.");r?t.insertBefore(e,r):t.appendChild(e)},W=function(e,t){e.style.transform=t,e.style["-webkit-transform"]=t},q=function(){Lo++,Ro=Ro||Object.create(null)},J=function(){--Lo||(Ro=null)},Y=function(e){var t,r=e.textContent+"\n"+e.className.baseVal;return Ro&&(t=Ro[r])||(t=window.getComputedStyle(e),t=X(e,t.fontSize,t.fontWeight,t.fontFamily),Ro&&(Ro[r]=t)),t},Wo=function(e,t,r,n){return X(e,t+"pt",r,n)},X=function(e,t,r,n){var i,s=e.textContent;return e=s+"\n"+e.className.baseVal,Ro&&(i=Ro[e])||(Po||((i=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(i),Po=i.getContext("2d")),i=s&&Po?(Po.font=r+" "+t+" "+n,Po.measureText(s).width):0,Ro&&(Ro[e]=i)),i},Z=function(e,t,r,n){var i=document.createElement("span");i.style.font=r+" "+t+" "+n,i.textContent=e,(e=document.createElement("div")).style.width="1px",e.style.height="0",(t=document.createElement("div")).style.display="flex",t.style.position="fixed",t.style.top="0",t.style.left="0",t.appendChild(i),t.appendChild(e),document.body.appendChild(t),r={height:0,baseline:0};try{t.style.alignItems="baseline",r.baseline=e.offsetTop-i.offsetTop,t.style.alignItems="flex-end",r.height=e.offsetTop-i.offsetTop}finally{document.body.removeChild(t)}return r},f.getFocusManager$$module$build$src$core$focus_manager=function(){return $o.getFocusManager()},Q=function(e){return e&&"function"==typeof e.getFocusableElement&&"function"==typeof e.getFocusableTree&&"function"==typeof e.onNodeFocus&&"function"==typeof e.onNodeBlur&&"function"==typeof e.canBeFocused},ee=function(e){return Q(e)&&"string"==typeof e.id&&"object"==typeof e.workspace&&"function"==typeof e.select&&"function"==typeof e.unselect},te=function(e,t){for(var r in t)null!==t[r]&&Array.isArray(t[r])?e[r]=te(e[r]||[],t[r]):e[r]=null!==t[r]&&"object"==typeof t[r]?te(e[r]||Object.create(null),t[r]):t[r];return e},re=function(e){return Vo[e]||null},ne=function(){var e,t=[];for(e in Vo)t.push(Vo[e]);return t},ie=function(e){Vo[e.id]=e},se=function(e){delete Vo[e.id]},ae=function(){return Ya},oe=function(e){Ya=e},le=function(){var e=f.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode();return e&&ee(e)?e:null},el=function(e){f.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)},ce=function(e){var t=le(),r=new(g(y.SELECTED))(null!=(r=null==t?void 0:t.id)?r:null,null!=(r=null==e?void 0:e.id)?r:null,null!=(e=null!=(r=null==e?void 0:e.workspace.id)?r:null==t?void 0:t.workspace.id)?e:"");m(r)},Zo=function(){return Xa},ue=function(e){Xa=e},de=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;var t,r=e.getParentSvg(),n=e.getCachedParentSvgSize(),i=r.parentElement;i instanceof HTMLElement&&(t=i.offsetWidth,i=i.offsetHeight,n.width!==t&&(r.setAttribute("width",t+"px"),e.setCachedParentSvgSize(t,null)),n.height!==i&&(r.setAttribute("height",i+"px"),e.setCachedParentSvgSize(null,i)),e.resize())},pe=function(e,t){var r=Object.create(null),n=e.getDescendants(!0);t&&(e=e.getNextBlock())&&(e=n.indexOf(e),n.splice(e,n.length-e));for(let e=0,t;t=n[e];e++)r[t.type]?r[t.type]++:r[t.type]=1;return r},he=function(e){return function(){this.jsonInit(e)}},me=function(e){Go.defineBlocksWithJsonArrayInternal(e)},t=function(e){f.defineBlocks$$module$build$src$core$common(f.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(e))},f.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(t){var r={};for(let e=0;e<t.length;e++){var n,i=t[e];i?(n=i.type)?r[n]={init:he(i)}:console.warn(`Block definition #${e} in JSON array is missing a type attribute. `+"Skipping."):console.warn(`Block definition #${e} in JSON array is ${i}. Skipping`)}return r},f.defineBlocks$$module$build$src$core$common=function(e){for(var t of Object.keys(e)){var r=e[t];t in Ua&&console.warn(`Block definition "${t}" overwrites previous definition.`),Ua[t]=r}},ge=function(e){let t=Ya;var r,n=f.getFocusManager$$module$build$src$core$focus_manager().getFocusedTree();for(r of ne())if(n===r){t=r;break}ka(e)||!t||t.rendered&&!t.isFlyout&&!t.isVisible()||T.registry.onKeyDown(t,e)},fe=function(e,t){return-1!==(t=e.indexOf(t))&&(e.splice(t,1),!0)},_e=function(e){if(Yo)throw Error("CSS already injected");Xo+="\n"+e},ye=function(e,t){Yo||(Yo=!0,e&&(e=t.replace(/[\\/]$/,""),t=Xo.replace(/<<<PATH>>>/g,e),Xo="",(e=document.createElement("style")).id="blockly-common-style",t=document.createTextNode(t),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild)))},be=function(e){return Qo.getSizeInternal(e)},ml=function(e){var t,r,n,i,s;return"none"!==Te(e,"display")?ve(e):(r=(t=e.style).display,n=t.visibility,i=t.position,t.visibility="hidden",t.position="absolute",t.display="inline",s=e.offsetWidth,e=e.offsetHeight,t.display=r,t.position=i,t.visibility=n,new S(s,e))},ve=function(e){return new S(e.offsetWidth,e.offsetHeight)},Te=function(e,t){return(e=window.getComputedStyle(e))[t]||e.getPropertyValue(t)},ke=function(e){var t=new k(0,0),r=(e=e.getBoundingClientRect(),document.documentElement),r=new k(window.pageXOffset||r.scrollLeft,window.pageYOffset||r.scrollTop);return t.x=e.left+r.x,t.y=e.top+r.y,t},xe=function(){var e=document.body,t=document.documentElement;return new k(e.scrollLeft||t.scrollLeft,e.scrollTop||t.scrollTop)},Ee=function(e){var t=parseFloat(Te(e,"borderLeftWidth")),r=parseFloat(Te(e,"borderRightWidth")),n=parseFloat(Te(e,"borderTopWidth"));return e=parseFloat(Te(e,"borderBottomWidth")),new E(n,e,t,r)},Se=function(e,t,r){e=Ce(e,t,r),t.scrollLeft=e.x,t.scrollTop=e.y},Ce=function(e,t,r){var n=ke(e),i=ke(t),s=Ee(t),a=n.x-i.x-s.left,n=n.y-i.y-s.top,i=ve(e);return e=t.clientWidth-i.width,i=t.clientHeight-i.height,s=t.scrollLeft,t=t.scrollTop,r?(s+=a-e/2,t+=n-i/2):(s+=Math.min(a,Math.max(a-e,0)),t+=Math.min(n,Math.max(n-i,0))),new k(s,t)},we=function(e){var t=new k(0,0),r=e.x&&e.getAttribute("x"),n=e.y&&e.getAttribute("y");return r&&(t.x=parseInt(r)),n&&(t.y=parseInt(n)),(r=(r=e.getAttribute("transform"))&&r.match(tl))&&(t.x+=Number(r[1]),r[3])&&(t.y+=Number(r[3])),(e=e.getAttribute("style"))&&e.includes("translate")&&(e=e.match(rl))&&(t.x+=Number(e[1]),e[3])&&(t.y+=Number(e[3])),t},Ie=function(e){let t=0,r=0;for(;e;){var n=we(e);if(t+=n.x,r+=n.y,(" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv "))break;e=e.parentNode}return new k(t,r)},Ae=function(){var e=xe();return new E(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},De=function(){var e=document.documentElement,t=window;return new k(t.pageXOffset||e.scrollLeft,t.pageYOffset||e.scrollTop)},Ne=function(e,t){var r=t.x,n=(t=t.y,e.getInjectionDiv().getBoundingClientRect()),r=new k(r-n.left,t-n.top);return t=e.getOriginOffsetInPixels(),k.difference(r,t).scale(1/e.scale)},Oe=function(e,t){var r=t.scale(e.scale),n=(t=r.x,r=r.y,e.getInjectionDiv().getBoundingClientRect());return e=e.getOriginOffsetInPixels(),new k(t+n.left+e.x,r+n.top+e.y)},yl=function(e){({document:al=al,DOMParser:ol=ol,XMLSerializer:ll=ll}=e),il=new ol,sl=new ll},f.createElement$$module$build$src$core$utils$xml=function(e){return al.createElementNS(cl,e)},f.createTextNode$$module$build$src$core$utils$xml=function(e){return al.createTextNode(e)},f.textToDom$$module$build$src$core$utils$xml=function(e){let t=il.parseFromString(e,"text/xml");if(t&&t.documentElement&&!t.getElementsByTagName("parsererror").length)return t.documentElement;if((t=il.parseFromString(e,"text/html"))&&t.body.firstChild&&"xml"===t.body.firstChild.nodeName.toLowerCase())return t.body.firstChild;throw Error("DOMParser was unable to parse: "+e)},Re=function(e){return Le(sl.serializeToString(e))},Le=function(e){return e.replace(ul,e=>`&#${e.charCodeAt(0)};`)},Pe=function(e){return e?((e instanceof Element||"string"==typeof e)&&(e=Ge(e),e=Ue(e)),Me(e),e):null},Me=function(e){var t=e.kind;if(e=e.contents,t&&t!==pl&&t!==dl)throw Error("Invalid toolbox kind "+t+". Please supply either "+pl+" or "+dl);if(!e)throw Error("Toolbox must have a contents attribute.")},Fe=function(e){return e?e.contents||(Array.isArray(e)&&0<e.length&&!e[0].nodeType?e:Ve(e)):[]},Be=function(e){return hl.hasCategoriesInternal(e)},gl=function(e){var t;return!!e&&((t=e.kind)?t===dl:!!e.contents.filter(e=>"CATEGORY"===e.kind.toUpperCase()).length)},$e=function(e){return!(!e||!e.contents||!e.contents.filter(function(e){return"CATEGORY"===e.kind.toUpperCase()}).length)},Ue=function(e){var t={contents:Ve(e)};return e instanceof Node&&He(e,t),t},Ve=function(r){var n,i=[];let s=r.childNodes;s=s||r;for(let e=0,t;t=s[e];e++)t.tagName&&(r={},n=t.tagName.toUpperCase(),"BLOCK"===(r.kind=n)?r.blockxml=t:t.childNodes&&0<t.childNodes.length&&(r.contents=Ve(t)),He(t,r),i.push(r));return i},He=function(t,r){for(let e=0;e<t.attributes.length;e++){var n=t.attributes[e];n.nodeName.includes("css-")?(r.cssconfig=r.cssconfig||{},r.cssconfig[n.nodeName.replace("css-","")]=n.value):r[n.nodeName]=n.value}},Ge=function(e){let t=null;if(e)if("string"==typeof e){if("xml"!==(t=f.textToDom$$module$build$src$core$utils$xml(e)).nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else e instanceof Element&&(t=e);return t},je=function(e,t,r,n,i,s){var a=s.scrollbar&&s.scrollbar.canScrollVertically();return e.horizontal===Qa.LEFT?(r=i.absoluteMetrics.left+r,a&&s.RTL&&(r+=nl.scrollbarThickness)):(r=i.absoluteMetrics.left+i.viewMetrics.width-t.width-r,a&&!s.RTL&&(r-=nl.scrollbarThickness)),e.vertical===Za.TOP?e=i.absoluteMetrics.top+n:(e=i.absoluteMetrics.top+i.viewMetrics.height-t.height-n,s.scrollbar&&s.scrollbar.canScrollHorizontally()&&(e-=nl.scrollbarThickness)),new E(e,e+t.height,r,r+t.width)},Ke=function(e,t){return{horizontal:t.toolboxMetrics.position===b.LEFT||e.horizontalLayout&&!e.RTL?Qa.RIGHT:Qa.LEFT,vertical:t.toolboxMetrics.position===b.BOTTOM?Za.TOP:Za.BOTTOM}},ze=function(t,r,n,i){var s=t.left,a=t.right-t.left,o=t.bottom-t.top;for(let e=0;e<i.length;e++){var l=i[e];t.intersects(l)&&(t=n===eo.UP?l.top-o-r:l.bottom+r,t=new E(t,t+o,s,s+a),e=-1)}return t},Zh=function(e,t){i(_.SERIALIZER,e,t)},bl=function(e){la(_.SERIALIZER,e)},We=function(e,{addCoordinates:t=!1,saveIds:r=!0}={}){var n=e.workspace,i=Object.create(null);return i.height=e.getSize().height,i.width=e.getSize().width,r&&(i.id=e.id),t&&(t=e.getRelativeToSurfaceXY(),i.x=n.RTL?n.getWidth()-t.x:t.x,i.y=t.y),e.getText()&&(i.text=e.getText()),e.isCollapsed()&&(i.collapsed=!0),e.isOwnEditable()||(i.editable=!1),e.isOwnMovable()||(i.movable=!1),e.isOwnDeletable()||(i.deletable=!1),i},qe=function(e,t,{recordUndo:r=!1}={}){var n,i,s,a=So;return f.setRecordUndo$$module$build$src$core$events$utils(r),r=t.newComment(e.id),void 0!==e.text&&r.setText(e.text),void 0===e.x&&void 0===e.y||(n=r.getRelativeToSurfaceXY(),i=null!=(i=e.x)?i:n.x,i=t.RTL?t.getWidth()-i:i,t=null!=(s=e.y)?s:n.y,r.moveTo(new k(i,t))),void 0===e.width&&!e.height||(s=r.getSize(),r.setSize(new S(null!=(n=e.width)?n:s.width,null!=(i=e.height)?i:s.height))),void 0!==e.collapsed&&r.setCollapsed(e.collapsed),void 0!==e.editable&&r.setEditable(e.editable),void 0!==e.movable&&r.setMovable(e.movable),void 0!==e.deletable&&r.setDeletable(e.deletable),f.setRecordUndo$$module$build$src$core$events$utils(a),r},uh=function(e,t){i(_.PASTER,e,t)},C=function(e){la(_.PASTER,e)},Je=function(t){for(var e=t.workspace,r=t.getRelativeToSurfaceXY(),n=new k(0,0),i=e.getTopComments(!1).filter(e=>e.id!==t.id).map(e=>e.getRelativeToSurfaceXY());Ye(k.sum(r,n),i);)n.translate(e.RTL?-30:30,30);t.moveTo(k.sum(r,n))},Ye=function(t,e){return e.some(e=>Math.abs(e.x-t.x)<=1&&Math.abs(e.y-t.y)<=1)},Xe=function(e,t){e.setAttribute(kl,t)},Ze=function(e,t,r){Array.isArray(r)&&(r=r.join(" ")),e.setAttribute(Tl+t,""+r)},Qe=function(e){return e&&"function"==typeof e.saveState&&"function"==typeof e.loadState},et=function(e){return it(e),nt()?(st(),Promise.resolve()):Rl=Rl||new Promise(e=>{Ll=e,Pl=window.requestAnimationFrame(()=>{st(),e()})})},tt=function(){return Rl||Promise.resolve()},rt=function(e){e||window.cancelAnimationFrame(Pl),st(e),!e&&Ll&&Ll()},nt=function(){return lo},it=function(e){Nl.add(e),Ol.set(e,f.getGroup$$module$build$src$core$events$utils());var t=e.getParent();t?it(t):Dl.add(e)},st=function(e){let t=e?new Set([e]):new Set([...Dl].map(e=>e.workspace)),r=[...Dl].filter(ot).filter(e=>t.has(e.workspace));for(var n of r)lt(n);for(var i of t)i.resizeContents();for(var s of r)n=s.getRelativeToSurfaceXY(),s.updateComponentLocations(n);for(var a of r)s=f.getGroup$$module$build$src$core$events$utils(),(n=Ol.get(a))&&f.setGroup$$module$build$src$core$events$utils(n),a.bumpNeighbours(),f.setGroup$$module$build$src$core$events$utils(s);for(var o of r)at(o);e||(Rl=null)},at=function(e){Dl.delete(e),Nl.delete(e),Ol.delete(e);for(var t of e.getChildren(!1))at(t)},ot=function(e){return!e.isDisposed()&&!e.getParent()},lt=function(e){if(Nl.has(e)&&e.initialized){for(var t of e.getChildren(!1))lt(t);e.renderEfficiently()}},ct=function(e,t){Hl(e,t)},w=function(e=Vl){Hl=e},ut=function(e,t){jl(e,t)},tc=function(e=Gl){jl=e},dt=function(e,t,r){zl(e,t,r)},oc=function(e=Kl){zl=e},cc=function(e,t){ql(e,t)},lc=function(e=Wl){ql=e},pt=function(e){return e&&"function"==typeof e.getProcedureDef},ht=function(e){return e&&"function"==typeof e.getProcedureCall&&"function"==typeof e.renameProcedure},mt=function(e){return void 0!==e.getVariableModel},gt=function(e,t,r,n){e=e+" was deprecated in "+t+" and will be deleted in "+r+".",n&&(e+="\nUse "+n+" instead."),Yl.has(e)||(Yl.add(e),console.warn(e))},f.allUsedVarModels$$module$build$src$core$variables=function(t){t=t.getAllBlocks(!1);var r=new Set;for(let e=0;e<t.length;e++){var n=t[e].getVarModels();if(n)for(let e=0;e<n.length;e++){var i=n[e];i.getId()&&r.add(i)}}return Array.from(r.values())},f.allDeveloperVariables$$module$build$src$core$variables=function(r){r=r.getAllBlocks(!1);var n=new Set;for(let e=0,t;t=r[e];e++){var i=t.getDeveloperVariables;if(i){i=i();for(let e=0;e<i.length;e++)n.add(i[e])}}return Array.from(n.values())},ft=function(e){return _t(e,!1)},_t=function(e,t=!0){return Ua.variables_set||Ua.variables_get||console.warn("There are no variable blocks, but there is a variable category."),t?(gt("The XML return value of Blockly.Variables.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),vt(e)):(e.registerButtonCallback("CREATE_VARIABLE",function(e){Et(e.getTargetWorkspace())}),[{kind:"button",text:"%{BKY_NEW_VARIABLE}",callbackkey:"CREATE_VARIABLE"},...bt(e,e.getVariableMap().getVariablesOfType(""),!0)])},yt=function(e){return{VAR:{name:e.getName(),type:e.getType()}}},bt=function(e,t,r,n="variables_get",i="variables_set"){r=r&&Ua.math_change,e=[];var s=t.slice(-1)[0];return s&&(Ua[i]&&e.push({kind:"block",type:i,gap:r?8:24,fields:yt(s)}),r)&&e.push({kind:"block",type:"math_change",gap:Ua[n]?20:8,fields:yt(s),inputs:{DELTA:{shadow:{type:"math_number",fields:{NUM:1}}}}}),Ua[n]&&e.push(...t.sort(Lt).map(e=>({kind:"block",type:n,gap:8,fields:yt(e)}))),e},vt=function(e){let t=[];var r=document.createElement("button");return r.setAttribute("text","%{BKY_NEW_VARIABLE}"),r.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",function(e){Et(e.getTargetWorkspace())}),t.push(r),e=Tt(e),t=t.concat(e)},Tt=function(r){var n=[];if(0<(r=r.getVariableMap().getVariablesOfType("")).length){var e,i=r[r.length-1];if(Ua.variables_set&&((e=f.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_set"),e.setAttribute("gap",Ua.math_change?"8":"24"),e.appendChild(Nt(i)),n.push(e)),Ua.math_change&&((e=f.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","math_change"),e.setAttribute("gap",Ua.variables_get?"20":"8"),e.appendChild(Nt(i)),i=f.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),e.appendChild(i),n.push(e)),Ua.variables_get){r.sort(Lt);for(let e=0,t;t=r[e];e++)(i=f.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get"),i.setAttribute("gap","8"),i.appendChild(Nt(t)),n.push(i)}}return n},kt=function(e){return Ql.generateUniqueNameInternal(e)},hc=function(e){return xt(Zl.charAt(0),e.getVariableMap().getAllVariables().map(e=>e.getName()))},xt=function(n,i){if(i.length){var s=Zl;let e="",r=s.indexOf(n);for(;;){let t=!1;for(let e=0;e<i.length;e++)if(i[e].toLowerCase()===n){t=!0;break}if(!t)break;++r===s.length&&(r=0,e=""+(Number(e)+1)),n=s.charAt(r)+e}}return n},Et=function(i,s,e){let a=e||"";!function n(e){St(f.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,e,function(e){var t,r;e?(t=wt(e,i))?(r=t.getType()===a?f.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",t.getName()):(r=f.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",t.getName()).replace("%2",t.getType()),ct(r,function(){n(e)})):(i.getVariableMap().createVariable(e,a),s&&s(e)):s&&s(null)})}("")},f.renameVariable$$module$build$src$core$variables=function(s,a,o){!function i(e){var t=f.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",a.getName());St(t,e,function(e){var t,r,n;e?(t=Ct(e,a.getType(),s),r=It(a.getName(),e,s),t||r?(n="",t?n=f.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",t.getName()).replace("%2",t.getType()):r&&(n=f.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",e).replace("%2",r)),ct(n,function(){i(e)})):(s.getVariableMap().renameVariable(a,e),o&&o(e))):o&&o(null)})}("")},St=function(e,t,r){dt(e,t,function(e){!e||(e=e.replace(/[\s\xa0]+/g," ").trim())!==f.Msg$$module$build$src$core$msg.RENAME_VARIABLE&&e!==f.Msg$$module$build$src$core$msg.NEW_VARIABLE||(e=null),r(e)})},Ct=function(r,n,i){i=i.getVariableMap().getAllVariables(),r=r.toLowerCase();for(let e=0,t;t=i[e];e++)if(t.getName().toLowerCase()===r&&t.getType()!==n)return t;return null},wt=function(r,n){n=n.getVariableMap().getAllVariables(),r=r.toLowerCase();for(let e=0,t;t=n[e];e++)if(t.getName().toLowerCase()===r)return t;return null},It=function(e,t,r){return(r.getProcedureMap().getProcedures().length?At:Dt)(e,t,r)},At=function(t,r,e){t=t.toLowerCase(),r=r.toLowerCase();for(var n of e=e.getProcedureMap().getProcedures()){var i=n.getParameters().filter(mt).map(e=>e.getVariableModel().getName());if(i&&(e=i.some(e=>e.toLowerCase()===t),i=i.some(e=>e.toLowerCase()===r),e)&&i)return n.getName()}return null},Dt=function(t,r,e){t=t.toLowerCase(),r=r.toLowerCase();for(var n of e=e.getAllBlocks(!1))if(pt(n)){var i=(n=(e=n.getProcedureDef())[1]).some(e=>e.toLowerCase()===t),n=n.some(e=>e.toLowerCase()===r);if(i&&n)return e[0]}return null},Nt=function(e){var t=f.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name","VAR"),t.setAttribute("id",e.getId()),t.setAttribute("variabletype",e.getType()),e=f.createTextNode$$module$build$src$core$utils$xml(e.getName()),t.appendChild(e),t},f.getOrCreateVariablePackage$$module$build$src$core$variables=function(e,t,r,n){let i=f.getVariable$$module$build$src$core$variables(e,t,r,n);return i=i||Ot(e,t,r,n)},f.getVariable$$module$build$src$core$variables=function(e,t,r,n){var i=e.getPotentialVariableMap();let s=null;if((!t||!(s=!(s=e.getVariableById(t))&&i?i.getVariableById(t):s))&&r){if(void 0===n)throw Error("Tried to look up a variable by name without a type");!(s=e.getVariable(r,n))&&i&&(s=i.getVariable(r,n))}return s},Ot=function(e,t,r,n){var i=e.getVariableMap(),s=e.getPotentialVariableMap();return r=r||kt(e.isFlyout?e.targetWorkspace:e),s?s.createVariable(r,n,null!=t?t:void 0):i.createVariable(r,n,t)},Rt=function(t,r){t=t.getAllVariables();var n=[];if(r.length!==t.length)for(let e=0;e<t.length;e++){var i=t[e];r.includes(i)||n.push(i)}return n},Lt=function(e,t){return e.getName().localeCompare(t.getName(),void 0,{sensitivity:"base"})},Pt=function(r,n){var i=[];r=r.getAllBlocks(!1);for(let t=0;t<r.length;t++){var s=r[t].getVarModels();if(s)for(let e=0;e<s.length;e++)s[e].getId()===n&&i.push(r[t])}return i},f.deleteVariable$$module$build$src$core$variables=function(t,r,n){var i=r.getName(),s=Pt(t,r.getId());for(let e=s.length-1;0<=e;e--){var a=s[e];if("procedures_defnoreturn"===a.type||"procedures_defreturn"===a.type)return n=String(a.getFieldValue("NAME")),i=f.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",i).replace("%2",n),void ct(i);a===n&&s.splice(e,1)}n&&s.length||1<s.length?(i=f.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(s.length+(n&&!n.workspace.isFlyout?1:0))).replace("%2",i),ut(i,e=>{e&&r&&t.getVariableMap().deleteVariable(r)})):t.getVariableMap().deleteVariable(r)},Mt=function(e,{addCoordinates:t=!1,addInputBlocks:r=!0,addNextBlocks:n=!0,doFullSerialization:i=!0,saveIds:s=!0}={}){var a;return e.isInsertionMarker()?null:(a={type:e.type,id:s?e.id:void 0},t&&Bt(e,a),Ft(e,a),$t(e,a,i),Ut(e,a,i),Vt(e,a,i),r&&Ht(e,a,i,s),n&&Gt(e,a,i,s),a)},Ft=function(e,t){e.isCollapsed()&&(t.collapsed=!0),e.isEnabled()||(t.disabledReasons=Array.from(e.getDisabledReasons())),e.isOwnDeletable()||(t.deletable=!1),e.isOwnMovable()||(t.movable=!1),e.isOwnEditable()||(t.editable=!1),void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&(t.inline=e.inputsInline),e.data&&(t.data=e.data)},Bt=function(e,t){var r=e.workspace;e=e.getRelativeToSurfaceXY(),t.x=Math.round(r.RTL?r.getWidth()-e.x:e.x),t.y=Math.round(e.y)},$t=function(e,t,r){e.saveExtraState?null!==(e=e.saveExtraState(r))&&(t.extraState=e):e.mutationToDom&&null!==(e=e.mutationToDom())&&(t.extraState=Mn(e).replace(' xmlns="https://developers.google.com/blockly/xml"',""))},Ut=function(e,t,r){var n,i=Object.create(null);for(n of e.getIcons())Qe(n)&&(e=n.saveState(r))&&(i[n.getType().toString()]=e);Object.keys(i).length&&(t.icons=i)},Vt=function(e,t,r){var n,i=Object.create(null);for(n of e.getFields())n.isSerializable()&&(i[n.name]=n.saveState(r));Object.keys(i).length&&(t.fields=i)},Ht=function(t,e,r,n){var i=Object.create(null);for(let e=0;e<t.inputList.length;e++){var s,a=t.inputList[e];a.connection&&(s=jt(a.connection,r,n))&&(i[a.name]=s)}Object.keys(i).length&&(e.inputs=i)},Gt=function(e,t,r,n){e.nextConnection&&(e=jt(e.nextConnection,r,n))&&(t.next=e)},jt=function(e,t,r){var n,i=e.getShadowState(!0);return e=e.targetBlock(),i||e?(n=Object.create(null),i&&(n.shadow=i),e&&!e.isShadow()&&(n.block=Mt(e,{doFullSerialization:t,saveIds:r})),n):null},Kt=function(e,t,{recordUndo:r=!1}={}){return e=zt(e,t,{recordUndo:r}),t.rendered&&rt(),e},zt=function(e,t,{parentConnection:r,isShadow:n=!1,recordUndo:i=!1}={}){var s=So,a=(f.setRecordUndo$$module$build$src$core$events$utils(i),(i=f.getGroup$$module$build$src$core$events$utils())||f.setGroup$$module$build$src$core$events$utils(!0),f.disable$$module$build$src$core$events$utils(),t.getAllVariables());let o;try{o=Wt(e,t,{parentConnection:r,isShadow:n})}finally{f.enable$$module$build$src$core$events$utils()}if(qt(t,a),U()&&m(new(g(y.BLOCK_CREATE))(o)),f.setGroup$$module$build$src$core$events$utils(i),f.setRecordUndo$$module$build$src$core$events$utils(s),t.rendered){let e=o;setTimeout(()=>{e.disposed||e.setConnectionTracking(!0)},1)}return o},Wt=function(e,t,{parentConnection:r,isShadow:n=!1}={}){var i;if(e.type)return(i=t.newBlock(e.type,e.id)).setShadow(n),Jt(i,e),Yt(i,e),Xt(i,e),Zt(r,i,e),Qt(i,e),er(i,e),tr(i,e),rr(i,e),ir(i,t.rendered),i;throw new rc(e)},qt=function(e,t){if(U())for(e=Rt(e,t),t=0;t<e.length;t++){var r=e[t];m(new(g(y.VAR_CREATE))(r))}},Jt=function(e,t){var r=void 0===t.x?0:t.x,n=(t=void 0===t.y?0:t.y,e.workspace),r=n.RTL?n.getWidth()-r:r;e.moveBy(r,t)},Yt=function(e,t){if(t.collapsed&&e.setCollapsed(!0),!1===t.deletable&&e.setDeletable(!1),!1===t.movable&&e.setMovable(!1),!1===t.editable&&e.setEditable(!1),!1===t.enabled&&e.setDisabledReason(!0,Il),Array.isArray(t.disabledReasons))for(var r of t.disabledReasons)e.setDisabledReason(!0,r);void 0!==t.inline&&e.setInputsInline(t.inline),void 0!==t.data&&(e.data=t.data)},Xt=function(e,t){t.extraState&&(e.loadExtraState?e.loadExtraState(t.extraState):e.domToMutation&&e.domToMutation(f.textToDom$$module$build$src$core$utils$xml(t.extraState)))},Zt=function(e,t,r){if(e){if(e.getSourceBlock().isShadow()&&!t.isShadow())throw new sc(r);if(e.type===f.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var n=t.outputConnection;if(!n)throw new nc("output",t,r)}else if(!(n=t.previousConnection))throw new nc("previous",t,r);var i;if(!e.connect(n))throw i=t.workspace.connectionChecker,new ic(i.getErrorMessage(i.canConnectWithReason(n,e,!1),n,e),e.type===f.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",t,r)}},Qt=function(e,t){var r;if(t.icons)for(r of Object.keys(t.icons)){var n=t.icons[r],i=e.getIcon(r);if(!i){if(!(i=da(_.ICON,r,!1)))throw new ac(r,e,t);i=new i(e),e.addIcon(i)}Qe(i)&&i.loadState(n)}},er=function(t,r){if(r.fields){var n=Object.keys(r.fields);for(let e=0;e<n.length;e++){var i=n[e],s=r.fields[i],a=t.getField(i);a?a.loadState(s):console.warn(`Ignoring non-existant field ${i} in block `+t.type)}}},tr=function(t,r){if(r.inputs){var n=Object.keys(r.inputs);for(let e=0;e<n.length;e++){var i=n[e],s=t.getInput(i);if(!s||!s.connection)throw new nc(i,t,r);nr(s.connection,r.inputs[i])}}},rr=function(e,t){if(t.next){if(!e.nextConnection)throw new nc("next",e,t);nr(e.nextConnection,t.next)}},nr=function(e,t){t.shadow&&e.setShadowState(t.shadow),t.block&&Wt(t.block,e.getSourceBlock().workspace,{parentConnection:e})},ir=function(e,t){if(t){e.setConnectionTracking(!1),e.initSvg(),e.queueRender();for(var r of e.getIcons())r.onLocationChange(e.getRelativeToSurfaceXY())}else e.initModel()},sr=function(e){return"function"==typeof e.bubbleIsVisible&&"function"==typeof e.setBubbleVisible&&"function"==typeof e.getBubble},ar=function(e){return e*Math.PI/180},Kc=function(e){return 180*e/Math.PI},or=function(e,t,r){var n;return r<e&&(n=r,r=e,e=n),Math.max(e,Math.min(t,r))},lr=function(){document.querySelector(".blocklyDropDownDiv")||((io=document.createElement("div")).className="blocklyDropDownDiv",io.tabIndex=-1,(Xa||document.body).appendChild(io),(so=document.createElement("div")).className="blocklyDropDownContent",io.appendChild(so),wc=h(so,"keydown",null,ge),(ao=document.createElement("div")).className="blocklyDropDownArrow",io.appendChild(ao),io.style.opacity="0",io.style.transition="transform "+yc+"s, opacity "+yc+"s")},cr=function(e){xc=e},Yc=function(){return Ec},Jc=function(){return so},ur=function(){wc&&(s(wc),wc=null),io.remove(),lr()},dr=function(e,t){io.style.backgroundColor=e,io.style.borderColor=t},cu=function(e,t,r,n,i=!0){return gr(hr(t),e,i,r,n)},pr=function(e,t,r,n=!0){return Sc=!0,gr(mr(e),e,n,t,r)},hr=function(e){var t=e.getSvgRoot(),r=e.workspace.scale,n=e.height*r;return e=e.width*r,t=ke(t),new E(t.y,t.y+n,t.x,t.x+e)},mr=function(e){return e=e.getScaledBBox(),new E(e.top,e.bottom,e.left,e.right)},gr=function(e,t,r,n,i){var s=e.left+(e.right-e.left)/2,a=e.bottom;e=e.top,i&&(e+=i);let o=(i=t.getSourceBlock()).workspace;for(;o.options.parentWorkspace;)o=o.options.parentWorkspace;return cr(o.getParentSvg().parentNode),fr(t,i.RTL,s,a,s,e,r,n)},fr=function(e,t,r,n,i,s,a,o){return Ec=e,vc=o||null,io.style.direction=t?"rtl":"ltr",Tc=(e=Ya).getRenderer().getClassName(),kc=e.getTheme().getClassName(),c(io,Tc),c(io,kc),r=Er(r,n,i,s),a&&(Cc=f.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(io)),r},_r=function(e,t,r,n){return{initialX:(e=vr(e,r.left,r.right,n.width)).divX,initialY:t,finalX:e.divX,finalY:t+_c,arrowX:e.arrowX,arrowY:-(mc/2+gc),arrowAtTop:!0,arrowVisible:!0}},yr=function(e,t,r,n){return{initialX:(e=vr(e,r.left,r.right,n.width)).divX,initialY:t-n.height,finalX:e.divX,finalY:t-n.height-_c,arrowX:e.arrowX,arrowY:n.height-2*gc-mc/2,arrowAtTop:!1,arrowVisible:!0}},br=function(e,t,r){return{initialX:(e=vr(e,t.left,t.right,r.width)).divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},vr=function(e,t,r,n){return t=or(t,e-n/2,r-n),{arrowX:e=or(r=fc,e=e-mc/2-t,n-r-mc),divX:t}},su=function(){return!!Ec},Tr=function(e,t){return Ec===e&&((t?xr:kr)(),!0)},kr=function(){io.style.transform="translate(0, 0)",io.style.opacity="0",bc=setTimeout(function(){xr()},1e3*yc),vc&&(vc(),vc=null)},xr=function(){Ec&&(bc&&clearTimeout(bc),vc&&(vc(),vc=null),ur(),Ec=null,Ya.markFocused(),Cc)&&(Cc(),Cc=null)},Er=function(e,t,r,n){(e=Ic.getPositionMetrics(e,t,r,n)).arrowVisible?(t=e.arrowX,r=e.arrowY,n=e.arrowAtTop?45:225,ao.style.display="",ao.style.transform=`translate(${t}px, ${r}px) rotate(${n}deg)`,ao.setAttribute("class","blocklyDropDownArrow")):ao.style.display="none",t=Math.floor(e.initialX),r=Math.floor(e.initialY),n=Math.floor(e.finalX);var i=Math.floor(e.finalY);return io.style.left=t+"px",io.style.top=r+"px",io.style.display="block",io.style.opacity="1",io.style.transform="translate("+(n-t)+"px,"+(i-r)+"px)",!!e.arrowAtTop},Sr=function(){var e,t;Ec?(e=Ec.getSourceBlock(),t=(e=Sc?mr(Ec):hr(e)).left+(e.right-e.left)/2,Er(t,e.bottom,t,e.top)):kr()},Cr=function(e){return e.length?e.reduce(function(e,t){return e.length<t.length?e:t}).length:0},wr=function(e,t){if(!e.length)return 0;if(1===e.length)return e[0].length;let r=0;t=t||Cr(e);let n;for(n=0;n<t;n++){for(var i=e[0][n],s=1;s<e.length;s++)if(i!==e[s][n])return r;" "===i&&(r=n+1)}for(i=1;i<e.length;i++)if((s=e[i][n])&&" "!==s)return r;return t},Ir=function(e,t){if(!e.length)return 0;if(1===e.length)return e[0].length;let r=0;t=t||Cr(e);let n;for(n=0;n<t;n++){for(var i=e[0].substr(-n-1,1),s=1;s<e.length;s++)if(i!==e[s].substr(-n-1,1))return r;" "===i&&(r=n+1)}for(i=1;i<e.length;i++)if((s=e[i].charAt(e[i].length-n-1))&&" "!==s)return r;return t},f.wrap$$module$build$src$core$utils$string=function(t,r){t=t.split("\n");for(let e=0;e<t.length;e++)t[e]=Ar(t[e],r);return t.join("\n")},Ar=function(r,e){if(r.length<=e)return r;for(var n=r.trim().split(/\s+/),i=0;i<n.length;i++)n[i].length>e&&(e=n[i].length);var s=-1/0;let a,o=1;do{i=s,a=r,r=[],s=n.length/o;let t=1;for(let e=0;e<n.length-1;e++)t<(e+1.5)/s?(t++,r[e]=!0):r[e]=!1}while(r=Nr(n,r,e),s=Dr(n,r,e),r=Or(n,r),o++,i<s);return a},Dr=function(e,t,r){for(var n=[0],i=[],s=0;s<e.length;s++)n[n.length-1]+=e[s].length,!0===t[s]?(n.push(0),i.push(e[s].charAt(e[s].length-1))):!1===t[s]&&n[n.length-1]++;for(e=Math.max(...n),s=t=0;s<n.length;s++)t=(t-=2*Math.pow(Math.abs(r-n[s]),1.5))-Math.pow(e-n[s],1.5),".?!".includes(i[s])?t+=r/3:",;)]}".includes(i[s])&&(t+=r/4);return 1<n.length&&n[n.length-1]<=n[n.length-2]&&(t+=.5),t},Nr=function(t,r,n){let i=Dr(t,r,n),s;for(let e=0;e<r.length-1;e++){var a,o;r[e]!==r[e+1]&&((a=[].concat(r))[e]=!a[e],a[e+1]=!a[e+1],(o=Dr(t,a,n))>i)&&(i=o,s=a)}return s?Nr(t,s,n):r},Or=function(t,r){var n=[];for(let e=0;e<t.length;e++)n.push(t[e]),void 0!==r[e]&&n.push(r[e]?"\n":" ");return n.join("")},f.isNumber$$module$build$src$core$utils$string=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},Eu=function(e){Ac=e},ch=function(){return Ac},du=function(){return Dc},Xp=function(){return jc},Rr=function(e){if(e=Lr(e)){for(e=e.tooltip;"function"==typeof e;)e=e();if("string"!=typeof e)throw Error("Tooltip function must return a string.");return e}return""},Lr=function(e){for(;e&&e.tooltip;){if("string"==typeof e.tooltip||"function"==typeof e.tooltip)return e;e=e.tooltip}return null},Pr=function(){document.querySelector(".blocklyTooltipDiv")||((jc=document.createElement("div")).className="blocklyTooltipDiv",(Xa||document.body).appendChild(jc))},Mr=function(e){e.mouseOverWrapper_=Ta(e,"pointerover",null,Br),e.mouseOutWrapper_=Ta(e,"pointerout",null,$r),e.addEventListener("pointermove",Ur,!1)},Fr=function(e){e&&(s(e.mouseOverWrapper_),s(e.mouseOutWrapper_),e.removeEventListener("pointermove",Ur))},Br=function(e){Nc||(e=Lr(e.currentTarget),Fc!==e&&(Hr(),Bc=null,Fc=e),clearTimeout(Rc))},$r=function(e){Nc||(Rc=setTimeout(function(){Bc=Fc=null,Hr()},1),clearTimeout(Lc),Lc=0)},Ur=function(e){var t;Fc&&Fc.tooltip&&!Nc&&(Dc?(t=Pc-e.pageX,e=Mc-e.pageY,Math.sqrt(t*t+e*e)>Vc&&Hr()):Bc!==Fc&&(clearTimeout(Lc),Pc=e.pageX,Mc=e.pageY,Lc=setTimeout(qr,Hc)))},Vr=function(){Bc=Fc=null,Hr()},Hr=function(){Dc&&(Dc=!1,jc)&&(jc.style.display="none"),Lc&&(clearTimeout(Lc),Lc=0)},Gr=function(){Hr(),Nc=!0},jr=function(){Nc=!1},Kr=function(){jc&&Fc&&("function"==typeof Ac?Ac(jc,Fc):zr())},zr=function(){var t=Rr(Fc);t=(t=f.wrap$$module$build$src$core$utils$string(t,Oc)).split("\n");for(let e=0;e<t.length;e++){var r=document.createElement("div");r.appendChild(document.createTextNode(t[e])),jc.appendChild(r)}},Wr=function(e){var t=document.documentElement.clientWidth,r=document.documentElement.clientHeight;let n=Pc,i=(n=e?n-($c+jc.offsetWidth):n+$c,Mc+Uc);return i+jc.offsetHeight>r+window.scrollY&&(i-=jc.offsetHeight+2*Uc),e?n=Math.max(Gc-window.scrollX,n):n+jc.offsetWidth>t+window.scrollX-2*Gc&&(n=t-jc.offsetWidth-2*Gc),{x:n,y:i}},qr=function(){var e,t;!Nc&&(Bc=Fc,jc)&&(jc.textContent="",Kr(),e=Fc.RTL,{x:e,y:t}=(jc.style.direction=e?"rtl":"ltr",jc.style.display="block",Dc=!0,Wr(e)),jc.style.left=e+"px",jc.style.top=t+"px")},fd=function(){return zc},Gu=function(e){zc=e},Ru=function(){return Wc},ju=function(e){Wc=e},Jr=function(e){e=(""+e).toLowerCase().trim();var t,r=qc[e];return r||(r="#"===(r="0x"===e.substring(0,2)?"#"+e.substring(2):e)[0]?r:"#"+r,/^#[0-9a-f]{6}$/.test(r)?r:/^#[0-9a-f]{3}$/.test(r)?["#",r[1],r[1],r[2],r[2],r[3],r[3]].join(""):(t=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/))&&(e=Number(t[1]),r=Number(t[2]),t=Number(t[3]),0<=e)&&e<256&&0<=r&&r<256&&0<=t&&t<256?Yr(e,r,t):null)},Yr=function(e,t,r){return t=e<<16|t<<8|r,e<16?"#"+(16777216|t).toString(16).substr(1):"#"+t.toString(16)},Xr=function(e){return(e=Jr(e))?[(e=parseInt(e.substr(1),16))>>16,e>>8&255,255&e]:[0,0,0]},Zr=function(e,t,r){let n=0,i=0,s=0;if(0===t)s=i=n=r;else{var a=Math.floor(e/60),o=e/60-a,l=(e=r*(1-t),r*(1-t*o));switch(t=r*(1-t*(1-o)),a){case 1:n=l,i=r,s=e;break;case 2:n=e,i=r,s=t;break;case 3:n=e,i=l,s=r;break;case 4:n=t,i=e,s=r;break;case 5:n=r,i=e,s=l;break;case 6:case 0:n=r,i=t,s=e}}return Yr(Math.floor(n),Math.floor(i),Math.floor(s))},Qr=function(e,t,r){return(e=Jr(e))&&(t=Jr(t))?(e=Xr(e),t=Xr(t),Yr(Math.round(t[0]+r*(e[0]-t[0])),Math.round(t[1]+r*(e[1]-t[1])),Math.round(t[2]+r*(e[2]-t[2])))):null},en=function(e){return Zr(e,zc,255*Wc)},tn=function(t,r,n){var i=[],s=t.split(""),a=(s.push(""),0);t=[];let o=null;for(let e=0;e<s.length;e++){var l,c,u=s[e];0===a?"%"===u?((a=t.join(""))&&i.push(a),t.length=0,a=1):(n&&"\n"===u?((l=t.join(""))&&i.push(l),t.length=0,i):t).push(u):1===a?"%"===u?(t.push(u),a=0):r&&"0"<=u&&u<="9"?(a=2,o=u,(u=t.join(""))&&i.push(u),t.length=0):a="{"===u?3:(t.push("%",u),0):2===a?"0"<=u&&u<="9"?o+=u:(c=void 0,i.push(parseInt(null!=(c=o)?c:"",10)),e--,a=0):3===a&&(""===u?(t.splice(0,0,"%{"),e--,a=0):"}"!==u?t.push(u):(a=t.join(""),/[A-Z]\w*/i.test(a)&&(u=(u=a.toUpperCase()).startsWith("BKY_")?u.substring(4):null)&&u in f.Msg$$module$build$src$core$msg?"string"==typeof(a=f.Msg$$module$build$src$core$msg[u])?Array.prototype.push.apply(i,tn(a,r,n)):i.push(r?""+a:a):i.push("%{"+a+"}"),a=t.length=0))}for((r=t.join(""))&&i.push(r),c=[],s=t.length=0;s<i.length;s++)("string"!=typeof i[s]||n&&"\n"===i[s]?((r=t.join(""))&&c.push(r),t.length=0,c):t).push(i[s]);return(r=t.join(""))&&c.push(r),t.length=0,c},rn=function(e){return tn(e,!0,!0)},nn=function(e){return"string"!=typeof e?e:(e=tn(e,!1,!1)).length?String(e[0]):""},L=function(t){let r=!0;var n=f.Msg$$module$build$src$core$msg,i=t.match(/%{BKY_[A-Z]\w*}/gi);if(i)for(let e=0;e<i.length;e++)void 0===n[i[e].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+i[e]+" in "+t),r=!1);return r},sn=function(e){var t="string"==typeof e?nn(e):e,r=Number(t);if(!isNaN(r)&&0<=r&&r<=360)return{hue:r,hex:Zr(r,zc,255*Wc)};if(r=Jr(t))return{hue:null,hex:r};throw r='Invalid colour: "'+t+'"',e!==t&&(r+=' (from "'+e+'")'),Error(r)},Ku=function(){return oo},zu=function(e){null===(oo=e)&&null!=(e=document.querySelector("."+tu))&&e.remove()},an=function(){var e=Xa||document.body,t=document.querySelector("div."+tu);t?oo=t:((oo=document.createElement("div")).className=tu,oo.tabIndex=-1),h(oo,"keydown",null,ge),e.appendChild(oo)},on=function(e,t,r,n,i=!0){ln(),Zc=e,eu=r,(r=oo)&&(r.style.direction=t?"rtl":"ltr",r.style.display="block",!n&&e instanceof I&&(n=null==(t=e.getSourceBlock())?void 0:t.workspace),Qc=null!=n?n:null,ru=(e=null!=n?n:Ya).getRenderer().getClassName(),nu=e.getTheme().getClassName(),ru&&c(r,ru),nu&&c(r,nu),i)&&(iu=f.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(r))},ln=function(){var e;cn()&&(Zc=null,e=oo)&&(e.style.display="none",e.style.left="",e.style.top="",eu&&(eu(),eu=null),e.textContent="",ru&&(a(e,ru),ru=""),nu&&(a(e,nu),nu=""),Ya.markFocused(),iu)&&(iu(),iu=null)},cn=function(){return!!Zc},un=function(e){Zc===e&&ln()},dn=function(e){let t=null===Qc,r=e;for(;!t&&r;){if(r===e){t=!0;break}r=e.options.parentWorkspace}t&&ln()},pn=function(e,t,r){oo.style.left=e+"px",oo.style.top=t+"px",oo.style.height=r+"px"},hn=function(e,t,r,n){var i=gn(e,t,r);e=mn(e,t,r,n),i<0?pn(e,0,r.height+i):pn(e,i,r.height)},mn=function(e,t,r,n){return n?Math.min(Math.max(t.right-r.width,e.left),e.right-r.width):Math.max(Math.min(t.left,e.right-r.width),e.left)},gn=function(e,t,r){return t.bottom+r.height>=e.bottom?t.top-r.height:t.bottom},fn=function(e){return!(null==e||!e.repositionForWindowResize)},_n=function(){fn(Zc)&&Zc.repositionForWindowResize()||ln()},qu=function(){return au},yn=function(e){au=e},bn=function(e,t,r,n,i){var s;on(ou,r,Sn,n),t.length?(i=i||(e instanceof PointerEvent?new k(e.clientX,e.clientY):(console.warn("Context menu opened with keyboard but no location given"),new k(0,0))),s=vn(t,r,e,i),Tn(lu=s,r,i),setTimeout(function(){s.focus()},1),au=null):En()},vn=function(t,n,i,s){var a,o=new El;o.setRole(to.MENU);for(let e=0;e<t.length;e++){let r=t[e];r.separator?o.addChild(new Sl):((a=new xl(r.text)).setRightToLeft(n),a.setRole(to.MENUITEM),o.addChild(a),a.setEnabled(r.enabled),r.enabled&&a.onAction(function(e,t){En(),requestAnimationFrame(()=>{setTimeout(()=>{r.callback(r.scope,i,t,s)},0)})},{}))}return o},Tn=function(e,t,r){var n=Ae(),i=(r=new E(r.y+n.top,r.y+n.top,r.x+n.left,r.x+n.left),kn(e),e.getSize());t&&(r.left+=i.width,r.right+=i.width,n.left+=i.width,n.right+=i.width),hn(n,r,i,t),e.focus()},kn=function(e){var t=oo;if(!t)throw Error("Attempting to create a context menu when widget div is null");t=e.render(t),c(t,"blocklyContextMenu"),h(t,"contextmenu",null,xn),e.focus()},xn=function(e){e.preventDefault(),e.stopPropagation()},En=function(){un(ou),au=null},Sn=function(){lu&&(lu.dispose(),lu=null)},f.callbackFactory$$module$build$src$core$contextmenu=function(r,n){return()=>{f.disable$$module$build$src$core$events$utils();let e;try{e=(n instanceof Element?Bn:zt)(n,r.workspace);var t=r.getRelativeToSurfaceXY();t.x=r.RTL?t.x-f.config$$module$build$src$core$config.snapRadius:t.x+f.config$$module$build$src$core$config.snapRadius,t.y+=2*f.config$$module$build$src$core$config.snapRadius,e.moveBy(t.x,t.y)}finally{f.enable$$module$build$src$core$events$utils()}return U()&&!e.isShadow()&&m(new(g(y.BLOCK_CREATE))(e)),f.getFocusManager$$module$build$src$core$focus_manager().focusNode(e),e}},Cn=function(e,t){return(t=Ea(t,e.getParentSvg(),e.getInverseScreenCTM())).x/=e.scale,t.y/=e.scale,t},wn=function(e,t,r){t=Cn(e,t),hu.set(e,k.difference(r,t))},In=function(e,t){if(t=Cn(e,t),e=hu.get(e))return k.sum(e,t);throw Error("Drag not initialized")},md=function(e,t=!1){var r,n=f.createElement$$module$build$src$core$utils$xml("xml"),i=Dn(f.allUsedVarModels$$module$build$src$core$variables(e));i.hasChildNodes()&&n.appendChild(i);for(r of e.getTopComments())n.appendChild(An(r,t));for(e=e.getTopBlocks(!0),i=0;i<e.length;i++)n.appendChild(Nn(e[i],t));return n},An=function(e,t=!1){var r=f.createElement$$module$build$src$core$utils$xml("comment"),n=(t||r.setAttribute("id",e.id),t=e.workspace,e.getRelativeToSurfaceXY());return n.x=t.RTL?t.getWidth()-n.x:n.x,r.setAttribute("x",""+n.x),r.setAttribute("y",""+n.y),r.setAttribute("w",""+e.getSize().width),r.setAttribute("h",""+e.getSize().height),e.getText()&&(r.textContent=e.getText()),e.isCollapsed()&&r.setAttribute("collapsed","true"),e.isOwnEditable()||r.setAttribute("editable","false"),e.isOwnMovable()||r.setAttribute("movable","false"),e.isOwnDeletable()||r.setAttribute("deletable","false"),r},Dn=function(t){var r=f.createElement$$module$build$src$core$utils$xml("variables");for(let e=0;e<t.length;e++){var n=t[e],i=f.createElement$$module$build$src$core$utils$xml("variable");i.appendChild(f.createTextNode$$module$build$src$core$utils$xml(n.getName())),n.getType()&&i.setAttribute("type",n.getType()),i.id=n.getId(),r.appendChild(i)}return r},Nn=function(e,t){if(e.isInsertionMarker()&&!(e=e.getChildren(!1)[0]))return new DocumentFragment;let r=0;var n;return e.workspace.RTL&&(r=e.workspace.getWidth()),t=Ln(e,t),Yn(t)&&(n=e.getRelativeToSurfaceXY(),t.setAttribute("x",String(Math.round(e.workspace.RTL?r-n.x:n.x))),t.setAttribute("y",String(Math.round(n.y)))),t},On=function(e){var t;return e.isSerializable()?((t=f.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name",e.name||""),e.toXml(t)):null},Rn=function(e,t){for(var r of e.getFields())(e=On(r))&&t.appendChild(e)},Ln=function(e,t){if(e.isInsertionMarker())return(t=e.getChildren(!1)[0])?Ln(t):new DocumentFragment;var r,n,i,s=f.createElement$$module$build$src$core$utils$xml(e.isShadow()?"shadow":"block");for(s.setAttribute("type",e.type),t||(s.id=e.id),e.mutationToDom&&(r=e.mutationToDom())&&(r.hasChildNodes()||r.hasAttributes())&&s.appendChild(r),Rn(e,s),(r=e.getCommentText())&&(a=(n=e.getIcon(uc.COMMENT)).getBubbleSize(),l=n.bubbleIsVisible(),n=n.getBubbleLocation(),(i=f.createElement$$module$build$src$core$utils$xml("comment")).appendChild(f.createTextNode$$module$build$src$core$utils$xml(r)),i.setAttribute("pinned",""+l),i.setAttribute("h",""+a.height),i.setAttribute("w",""+a.width),n&&(i.setAttribute("x",""+(e.workspace.RTL?e.workspace.getWidth()-(n.x+a.width):n.x)),i.setAttribute("y",""+n.y)),s.appendChild(i)),e.data&&((r=f.createElement$$module$build$src$core$utils$xml("data")).appendChild(f.createTextNode$$module$build$src$core$utils$xml(e.data)),s.appendChild(r)),r=0;r<e.inputList.length;r++){var a,o=void 0,l=!0;(a=e.inputList[r]).type!==f.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&a.type!==f.inputTypes$$module$build$src$core$inputs$input_types.END_ROW&&(n=a.connection.targetBlock(),a.type===f.inputTypes$$module$build$src$core$inputs$input_types.VALUE?o=f.createElement$$module$build$src$core$utils$xml("value"):a.type===f.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(o=f.createElement$$module$build$src$core$utils$xml("statement")),!(i=a.connection.getShadowDom())||n&&n.isShadow()||o.appendChild(Pn(i,t)),n&&(n=Ln(n,t)).nodeType===Ja.ELEMENT_NODE&&(o.appendChild(n),l=!1),o.setAttribute("name",a.name),l||s.appendChild(o))}void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&s.setAttribute("inline",String(e.inputsInline)),e.isCollapsed()&&s.setAttribute("collapsed","true"),e.isEnabled()||s.setAttribute("disabled-reasons",Array.from(e.getDisabledReasons()).map(encodeURIComponent).join(",")),e.isOwnDeletable()||s.setAttribute("deletable","false"),e.isOwnMovable()||s.setAttribute("movable","false"),e.isOwnEditable()||s.setAttribute("editable","false");let c;return(o=e.getNextBlock())&&(r=Ln(o,t)).nodeType===Ja.ELEMENT_NODE&&((c=f.createElement$$module$build$src$core$utils$xml("next")).appendChild(r),s.appendChild(c)),!(e=e.nextConnection&&e.nextConnection.getShadowDom())||o&&o.isShadow()||c.appendChild(Pn(e,t)),s},Pn=function(e,t){let r=e=e.cloneNode(!0),n;for(;r;)if(t&&"shadow"===r.nodeName&&r.removeAttribute("id"),r.firstChild)r=r.firstChild;else{for(;r&&!r.nextSibling;){var i;r=(n=r).parentNode,n.nodeType===Ja.TEXT_NODE&&""===n.data.trim()&&(null==(i=r)?void 0:i.firstChild)!==n&&o(n)}r&&(r=(n=r).nextSibling,n.nodeType===Ja.TEXT_NODE)&&""===n.data.trim()&&o(n)}return e},Mn=function(e){return Re(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},hd=function(t){t=Mn(t).split("<");let r="";for(let e=1;e<t.length;e++){var n=t[e];"/"===n[0]&&(r=r.substring(2)),t[e]=r+"<"+n,"/"!==n[0]&&"/>"!==n.slice(-2)&&(r+="  ")}return(t=(t=t.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},od=function(e,t){return t.setResizesEnabled(!1),t.clear(),e=f.domToWorkspace$$module$build$src$core$xml(e,t),t.setResizesEnabled(!0),e},f.domToWorkspace$$module$build$src$core$xml=function(r,n){let i=0;n.RTL&&(i=n.getWidth());var s=[],e=(q(),f.getGroup$$module$build$src$core$events$utils());e||f.setGroup$$module$build$src$core$events$utils(!0),n.setResizesEnabled&&n.setResizesEnabled(!1);let a=!0;try{for(let e=0,t;t=r.childNodes[e];e++){var o=t.nodeName.toLowerCase(),l=t;if("block"===o||"shadow"===o&&!So){var c,u,d=Bn(l,n),p=(s.push(d.id),parseInt(null!=(c=l.getAttribute("x"))?c:"10",10)),h=parseInt(null!=(u=l.getAttribute("y"))?u:"10",10);isNaN(p)||isNaN(h)||d.moveBy(n.RTL?i-p:p,h,["create"]),a=!1}else{if("shadow"===o)throw TypeError("Shadow block cannot be a top-level block.");if("comment"===o)Fn(l,n);else if("variables"===o){if(!a)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");$n(l,n),a=!1}}}}finally{f.setGroup$$module$build$src$core$events$utils(e),n.setResizesEnabled&&n.setResizesEnabled(!0),n.rendered&&rt(),J()}return m(new(g(y.FINISHED_LOADING))(n)),s},Fn=function(e,t){var r,n,i=null!=(s=e.getAttribute("id"))?s:void 0,s=new(t.rendered?xu:ku)(t,i);return s.setText(null!=(i=e.textContent)?i:""),i=parseInt(null!=(r=e.getAttribute("x"))?r:"",10),r=parseInt(null!=(n=e.getAttribute("y"))?n:"",10),isNaN(i)||isNaN(r)||(i=t.RTL?t.getWidth()-i:i,s.moveTo(new k(i,r))),t=parseInt(null!=(n=e.getAttribute("w"))?n:"",10),n=parseInt(null!=(i=e.getAttribute("h"))?i:"",10),isNaN(t)||isNaN(n)||s.setSize(new S(t,n)),"true"===e.getAttribute("collapsed")&&s.setCollapsed(!0),"false"===e.getAttribute("editable")&&s.setEditable(!1),"false"===e.getAttribute("movable")&&s.setMovable(!1),"false"===e.getAttribute("deletable")&&s.setDeletable(!1),s},ed=function(n,i){if(!i.getBlocksBoundingBox)return f.domToWorkspace$$module$build$src$core$xml(n,i);var e=i.getBlocksBoundingBox();if(n=f.domToWorkspace$$module$build$src$core$xml(n,i),e&&e.top!==e.bottom){var s=e.bottom,e=i.RTL?e.right:e.left,a=1/0;let t=-1/0,r=1/0;for(let e=0;e<n.length;e++){var o=i.getBlockById(n[e]).getRelativeToSurfaceXY();o.y<r&&(r=o.y),o.x<a&&(a=o.x),o.x>t&&(t=o.x)}for(s=s-r+10,e=i.RTL?e-t:e-a,a=0;a<n.length;a++)i.getBlockById(n[a]).moveBy(e,s,["create"])}return n},f.domToBlock$$module$build$src$core$xml=function(e,t){return e=Bn(e,t),t.rendered&&rt(),e},Bn=function(e,r){f.disable$$module$build$src$core$events$utils();var t=r.getAllVariables();let n;try{if(n=qn(e,r),r.rendered){let e=n,t=n.getDescendants(!1);e.setConnectionTracking(!1);for(let e=t.length-1;0<=e;e--)t[e].initSvg();for(let e=t.length-1;0<=e;e--)t[e].queueRender();setTimeout(function(){e.disposed||e.setConnectionTracking(!0)},1),r.resizeContents()}else{var i=n.getDescendants(!1);for(let e=i.length-1;0<=e;e--)i[e].initModel()}}finally{f.enable$$module$build$src$core$events$utils()}if(U()){for(e=Rt(r,t),r=0;r<e.length;r++)t=e[r],m(new(g(y.VAR_CREATE))(t));m(new(g(y.BLOCK_CREATE))(n))}return n},$n=function(t,r){for(let e=0;e<t.children.length;e++){var n=t.children[e],i=n.getAttribute("type"),s=n.getAttribute("id");if(!(n=n.textContent))break;r.getVariableMap().createVariable(n,null!=i?i:void 0,s)}},Un=function(t){var r={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let e=0;e<t.children.length;e++){var n=t.children[e];if(n.nodeType!==Ja.TEXT_NODE)switch(n.nodeName.toLowerCase()){case"mutation":r.mutation.push(n);break;case"comment":r.comment.push(n);break;case"data":r.data.push(n);break;case"title":case"field":r.field.push(n);break;case"value":case"statement":r.input.push(n);break;case"next":r.next.push(n);break;default:console.warn("Ignoring unknown tag: "+n.nodeName)}}return r},Vn=function(t,r){let n=!1;for(let e=0;e<t.length;e++){var i=t[e];r.domToMutation&&(r.domToMutation(i),r.initSvg)&&(n=!0)}return n},Hn=function(u,d){for(let c=0;c<u.length;c++){let e=u[c],t=e.textContent,r="true"===e.getAttribute("pinned");let n=parseInt(null!=(p=e.getAttribute("w"))?p:"50",10);var p=parseInt(null!=(p=e.getAttribute("h"))?p:"50",10);let i,s=parseInt(null!=(i=e.getAttribute("x"))?i:"",10),a,o=parseInt(null!=(a=e.getAttribute("y"))?a:"",10),l=(d.setCommentText(t),d.getIcon(uc.COMMENT));isNaN(n)||isNaN(p)||l.setBubbleSize(new S(n,p)),l.setBubbleVisible(r),setTimeout(()=>{isNaN(s)||isNaN(o)||(s=d.workspace.RTL?d.workspace.getWidth()-(s+n):s,l.setBubbleLocation(new k(s,o))),l.setBubbleVisible(r)},1)}},Gn=function(t,r){for(let e=0;e<t.length;e++)r.data=t[e].textContent},jn=function(t,r){for(let e=0;e<t.length;e++){var n=t[e],i=n.getAttribute("name");i?Jn(r,i,n):console.warn("Ignoring unnamed field in block "+r.type)}},Kn=function(t){let r=null,n=null;for(let e=0;e<t.childNodes.length;e++){var i=t.childNodes[e];Yn(i)&&("block"===i.nodeName.toLowerCase()?r=i:"shadow"===i.nodeName.toLowerCase()&&(n=i))}return{childBlockElement:r,childShadowElement:n}},zn=function(t,r,n,i){for(let e=0;e<t.length;e++){var s=t[e],a=s.getAttribute("name"),o=a?n.getInput(a):null;if(!o){console.warn("Ignoring non-existent input "+a+" in block "+i);break}if((s=Kn(s)).childBlockElement){if(!o.connection)throw TypeError("Input connection does not exist.");qn(s.childBlockElement,r,o.connection,!1)}s.childShadowElement&&null!=(a=o.connection)&&a.setShadowDom(s.childShadowElement)}},Wn=function(t,r,n){for(let e=0;e<t.length;e++){var i=Kn(t[e]);if(i.childBlockElement){if(!n.nextConnection)throw TypeError("Next statement does not exist.");if(n.nextConnection.isConnected())throw TypeError("Next statement is already connected.");qn(i.childBlockElement,r,n.nextConnection,!0)}i.childShadowElement&&n.nextConnection&&n.nextConnection.setShadowDom(i.childShadowElement)}},qn=function(e,t,r,n){var i=e.getAttribute("type");if(!i)throw TypeError("Block type unspecified: "+e.outerHTML);var s=null!=(a=e.getAttribute("id"))?a:void 0,a=t.newBlock(i,s),s=Un(e),o=Vn(s.mutation,a);if(Hn(s.comment,a),Gn(s.data,a),r)if(n){if(!a.previousConnection)throw TypeError("Next block does not have previous statement.");r.connect(a.previousConnection)}else if(a.outputConnection)r.connect(a.outputConnection);else{if(!a.previousConnection)throw TypeError("Child block does not have output or previous statement.");r.connect(a.previousConnection)}if(jn(s.field,a),zn(s.input,t,a,i),Wn(s.next,t,a),o&&a.initSvg(),(t=e.getAttribute("inline"))&&a.setInputsInline("true"===t),(t=e.getAttribute("disabled"))&&a.setDisabledReason("true"===t||"disabled"===t,Il),null!==(t=e.getAttribute("disabled-reasons")))for(var l of t.split(","))a.setDisabledReason(!0,decodeURIComponent(l));if((l=e.getAttribute("deletable"))&&a.setDeletable("true"===l),(l=e.getAttribute("movable"))&&a.setMovable("true"===l),(l=e.getAttribute("editable"))&&a.setEditable("true"===l),(l=e.getAttribute("collapsed"))&&a.setCollapsed("true"===l),"shadow"===e.nodeName.toLowerCase()){for(e=a.getChildren(!1),l=0;l<e.length;l++)if(!e[l].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");a.setShadow(!0)}return a},Jn=function(e,t,r){var n=e.getField(t);n?n.fromXml(r):console.warn("Ignoring non-existent field "+t+" in block "+e.type)},cd=function(t){for(let e=0;e<t.childNodes.length;e++){var r=t.childNodes[e];if("next"===r.nodeName.toLowerCase()){t.removeChild(r);break}}},Yn=function(e){return e.nodeType===Ja.ELEMENT_NODE},Xd=function(e,t){i(_.FIELD,e,t)},Md=function(e){la(_.FIELD,e)},f.fromJson$$module$build$src$core$field_registry=function(e){return Ou.fromJsonInternal(e)},Ld=function(e){var t=pa(_.FIELD,e.type);return t?t.fromJson(e):(console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},Xn=function(e){return e&&"object"==typeof e&&"src"in e&&"string"==typeof e.src&&"alt"in e&&"string"==typeof e.alt&&"width"in e&&"number"==typeof e.width&&"height"in e&&"number"==typeof e.height},f.register$$module$build$src$core$extensions=function(e,t){if("string"!=typeof e||""===e.trim())throw Error('Error: Invalid extension name "'+e+'"');if(Hu[e])throw Error('Error: Extension "'+e+'" is already registered.');if("function"!=typeof t)throw Error('Error: Extension "'+e+'" must be a function');Hu[e]=t},f.registerMixin$$module$build$src$core$extensions=function(e,t){if(!t||"object"!=typeof t)throw Error('Error: Mixin "'+e+'" must be a object');f.register$$module$build$src$core$extensions(e,function(){this.mixin(t)})},f.registerMutator$$module$build$src$core$extensions=function(e,t,r,n){var i='Error when registering mutator "'+e+'": ';si(i,t);let s=ni(t,i);if(r&&"function"!=typeof r)throw Error(i+'Extension "'+e+'" is not a function');f.register$$module$build$src$core$extensions(e,function(){s&&this.setMutator(new f.MutatorIcon$$module$build$src$core$icons$mutator_icon(n||[],this)),this.mixin(t),r&&r.apply(this)})},P=function(e){Zn(e)?delete Hu[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},Zn=function(e){return!!Hu[e]},Qn=function(e,t,r){var n=Hu[e];if("function"!=typeof n)throw Error('Error: Extension "'+e+'" not found.');let i;if(r?ei(e,t):i=ai(t),n.apply(t),r)si('Error after applying mutator "'+e+'": ',t);else if(!oi(i,t))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},ei=function(e,t){if(ai(t).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+t.id)},ti=function(e,t){return ii(e.mutationToDom,e.domToMutation,t+" mutationToDom/domToMutation")},ri=function(e,t){return ii(e.saveExtraState,e.loadExtraState,t+" saveExtraState/loadExtraState")},ni=function(e,t){return ii(e.compose,e.decompose,t+" compose/decompose")},ii=function(e,t,r){if(e&&t){if("function"!=typeof e||"function"!=typeof t)throw Error(r+" must be a function");return!0}if(e||t)throw Error(r+"Must have both or neither functions");return!1},si=function(e,t){var r=ti(t,e),n=ri(t,e);if(!r&&!n)throw Error(e+"Mutations must contain either XML hooks, or JSON hooks, or both");ni(t,e)},ai=function(e){var t=[];return void 0!==e.domToMutation&&t.push(e.domToMutation),void 0!==e.mutationToDom&&t.push(e.mutationToDom),void 0!==e.saveExtraState&&t.push(e.saveExtraState),void 0!==e.loadExtraState&&t.push(e.loadExtraState),void 0!==e.compose&&t.push(e.compose),void 0!==e.decompose&&t.push(e.decompose),t},oi=function(t,r){if((r=ai(r)).length!==t.length)return!1;for(let e=0;e<r.length;e++)if(t[e]!==r[e])return!1;return!0},Wd=function(t){if("object"!=typeof document)throw Error("runAfterPageLoad() requires browser document.");if("complete"===document.readyState)t();else{let e=setInterval(function(){"complete"===document.readyState&&(clearInterval(e),t())},10)}},f.buildTooltipForDropdown$$module$build$src$core$extensions=function(t,r){let e=[];return function(){e.includes(this.type)||(li(this,t,r),e.push(this.type)),this.setTooltip(function(){var e=String(this.getFieldValue(t));return nn(r[e])}.bind(this))}},li=function(e,t,r){var n=e.getField(t);if(n instanceof Lu&&!n.isOptionListDynamic())for(var i of n=n.getOptions())i!==Lu.SEPARATOR&&([,n]=i,void 0===r[n])&&console.warn(`No tooltip mapping for value ${n} of field `+`${t} of block type ${e.type}.`)},f.buildTooltipWithFieldText$$module$build$src$core$extensions=function(t,r){return function(){this.setTooltip(function(){var e=this.getField(r);return nn(t).replace("%1",e?e.getText():"")}.bind(this))}},Hd=function(){let t=this.tooltip;this.setTooltip(function(){var e=this.getParent();return e&&e.getInputsInline()&&e.tooltip||t}.bind(this))},u=function(e,t){return" "+e+","+t+" "},ci=function(e,t){return" "+e+t.join("")},ui=function(e,t){return" M "+e+","+t+" "},di=function(e,t){return" m "+e+","+t+" "},pi=function(e,t){return" l "+e+","+t+" "},hi=function(e){return" l"+e.join("")},d=function(e,t){return" "+e+" "+t+" "},mi=function(e,t,r,n){return e+" "+r+" "+r+" "+t+n},gi=function(e,t){if(!e||!t)throw Error("Cannot connect null connections.");(e.targetConnection=t).targetConnection=e},fi=function(r,n){let i=null;var s=null==(n=n.outputConnection)?void 0:n.getConnectionChecker();for(let e=0,t;t=r.inputList[e];e++){var a=t.connection;if(a&&null!=s&&s.canConnect(n,a,!1)){if(i)return null;i=a}}return i},_i=function(e,t){for(var r;r=fi(e,t);)if(!(e=r.targetBlock())||e.isShadow())return r;return null},yi=function(e){return Q(e)&&"function"==typeof e.getType&&"function"==typeof e.initView&&"function"==typeof e.dispose&&"function"==typeof e.getWeight&&"function"==typeof e.getSize&&"function"==typeof e.applyColour&&"function"==typeof e.hideForInsertionMarker&&"function"==typeof e.updateEditable&&"function"==typeof e.updateCollapsed&&"function"==typeof e.isShownWhenCollapsed&&"function"==typeof e.setOffsetInBlock&&"function"==typeof e.onLocationChange&&"function"==typeof e.onClick},bi=function(e){return yi(e)&&sr(e)&&Qe(e)&&"function"==typeof e.setText&&"function"==typeof e.getText&&"function"==typeof e.setBubbleSize&&"function"==typeof e.getBubbleSize&&"function"==typeof e.setBubbleLocation&&"function"==typeof e.getBubbleLocation&&e.getType()===uc.COMMENT},vi=function(e){var t,r,n,i;100<e.getDescendants(!1).length||(t=e.workspace,i=e.getSvgRoot(),t.getAudioManager().play("delete"),r=e.getRelativeToSurfaceXY(),(n=i.cloneNode(!0)).setAttribute("transform","translate("+r.x+","+r.y+")"),null!=(i=t.getLayerManager())&&i.appendToAnimationLayer({getSvgRoot:()=>n}),Ti(n,{x:r.x,y:r.y,width:e.width,height:e.height},t.RTL,new Date))},Ti=function(e,t,r,n){var i=((new Date).getTime()-n.getTime())/150;1<i?o(e):(e.setAttribute("transform","translate("+(t.x+(r?-1:1)*t.width/2*i)+","+(t.y+t.height/2*i)+") scale("+(1-i)+")"),setTimeout(Ti,10,e,t,r,n))},ki=function(e){var t,r,n=e.workspace,i=n.scale;n.getAudioManager().play("click"),i<1||(t=n.getSvgXY(e.getSvgRoot()),e.outputConnection?(t.x+=(e.RTL?3:-3)*i,t.y+=13*i):e.previousConnection&&(t.x+=(e.RTL?-23:23)*i,t.y+=3*i),r=l(x.CIRCLE,{cx:t.x,cy:t.y,r:0,fill:"none",stroke:"#888","stroke-width":10},n.getParentSvg()),e=l(x.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*i},r),n=l(x.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},r),e.beginElement(),n.beginElement(),setTimeout(()=>{o(r)},150))},xi=function(e){var t;Si(),e.workspace.getAudioManager().play("disconnect"),e.workspace.scale<1||(t=e.getHeightWidth().height,t=Math.atan(10/t)/Math.PI*180,e.RTL||(t*=-1),Ei(ad=e,t,new Date,0))},Ei=function(e,t,r,n){var i=[.66,1,.66,0,-.66,-1,-.66,0];let s="";r.getTime()+200>(new Date).getTime()&&(s=`skewX(${Math.round(i[n%i.length]*t)})`,sd=setTimeout(Ei,15,e,t,r,n+1)),e.getSvgRoot().setAttribute("transform",e.getTranslation()+" "+s)},Si=function(){ad&&(sd&&(clearTimeout(sd),sd=null),ad.getSvgRoot().setAttribute("transform",ad.getTranslation()),ad=null)},Ci=function(t,e){for(var r=t.workspace,n=f.config$$module$build$src$core$config.snapRadius,i=k.difference(e,t.getRelativeToSurfaceXY()),s=new k(0,0),a=r.getAllBlocks(!1).filter(e=>e.id!=t.id).map(e=>e.getRelativeToSurfaceXY());wi(k.sum(e,s),a)||Ii(t,k.sum(i,s),n);)r.RTL?s.translate(-n,2*n):s.translate(n,2*n);t.moveTo(k.sum(e,s))},wi=function(t,e){return e.some(e=>Math.abs(e.x-t.x)<=1&&Math.abs(e.y-t.y)<=1)},Ii=function(e,t,r){return e.getConnections_(!1).some(e=>!!e.closest(r,t).connection)},Ai=function(e,t,r){var n=r.getBoundingRectangle(),i=n.right-n.left,s=or(t.top,n.top,t.top+t.height-(n.bottom-n.top))-n.top;let a=t.left;return t=t.left+t.width-i,e.RTL?a=Math.min(t,a):t=Math.max(a,t),!(!(e=or(a,n.left,t)-n.left)&&!s||(r.moveBy(e,s,["inbounds"]),0))},Di=function(i){return e=>{var t,r,n=i.getMetricsManager();n.hasFixedEdges()&&!i.isDragging()&&(vo.includes(null!=(t=e.type)?t:"")?(t=n.getScrollMetrics(!0),(r=Ni(i,e))&&(n=f.getGroup$$module$build$src$core$events$utils()||!1,f.setGroup$$module$build$src$core$events$utils(e.group),Ai(i,t,r)&&!e.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),f.setGroup$$module$build$src$core$events$utils(n))):Pa(e)&&e.scale&&e.oldScale&&e.scale>e.oldScale&&Oi(i))}},Ni=function(e,t){let r=null;switch(t.type){case y.BLOCK_CREATE:case y.BLOCK_MOVE:r=(r=e.getBlockById(t.blockId))&&r.getRootBlock();break;case y.COMMENT_CREATE:case y.COMMENT_MOVE:case y.COMMENT_RESIZE:r=e.getCommentById(t.commentId)}return r},Oi=function(r){if((n=r.getMetricsManager()).hasFixedEdges()&&!r.isDragging()){var n=n.getScrollMetrics(!0),i=r.getTopBoundedElements();for(let e=0,t;t=i[e];e++)Ai(r,n,t)}},Ri=function(e){return e&&"function"==typeof e.isDeletable&&"function"==typeof e.dispose&&"function"==typeof e.setDeleteStyle},Li=function(e,t){var r,n,i=e.getIcons();for(r of e.inputList)r.isVisible()&&(i.push(...r.fieldRow),null!=(n=r.connection)&&n.targetBlock()?(e=r.connection.targetBlock(),(r.connection.type!==v.NEXT_STATEMENT||t||(e=null==(n=e.lastConnectionInStack(!1))?void 0:n.getSourceBlock()))&&i.push(e)):(null==(n=r.connection)?void 0:n.type)===v.INPUT_VALUE&&i.push(r.connection));return i},Pi=function(e,t){var r=e.workspace.getTopBoundedElements(!0).filter(e=>Q(e));let n=null;return 0<=(e=r.indexOf(e instanceof O?e.getRootBlock():e)+t)&&e<r.length?n=r[e]:e<0?n=r[r.length-1]:e>=r.length&&(n=r[0]),t<0&&n instanceof O&&null!=(r=null==(e=n.lastConnectionInStack(!1))?void 0:e.getSourceBlock())?r:n},Mi=function(e,t){var r,n=e instanceof O?null!=(n=null==(r=e.outputConnection)?void 0:r.targetBlock())?n:e.getSurroundParent():e.getSourceBlock();return n instanceof O&&-1!==(e=(r=Li(n,0<t)).indexOf(e))&&0<=(t=e+t)&&t<r.length?r[t]:null},Fi=function(e){return e&&"function"==typeof e.getRelativeToSurfaceXY&&"function"==typeof e.isMovable&&"function"==typeof e.startDrag&&"function"==typeof e.drag&&"function"==typeof e.endDrag&&"function"==typeof e.revertDrag},Bi=function(e){return e&&"function"==typeof e.autoHide},hh=function(e,t){i(_.ICON,e.toString(),t)},ph=function(e){la(_.ICON,e)},$i=function(e){return"function"==typeof e.getProcedureModel&&"function"==typeof e.doProcedureUpdate&&"function"==typeof e.isProcedureDef},Ui=function(e){return e&&"function"==typeof e.startPublishing&&"function"==typeof e.stopPublishing},Vi=function(e){let t=e.getProcedureMap().getProcedures().filter(e=>!e.getReturnTypes()).map(e=>[e.getName(),e.getParameters().map(e=>e.getName()),!1]),r=(e.getBlocksByType("procedures_defnoreturn",!1).forEach(e=>{!$i(e)&&pt(e)&&t.push(e.getProcedureDef())}),e.getProcedureMap().getProcedures().filter(e=>!!e.getReturnTypes()).map(e=>[e.getName(),e.getParameters().map(e=>e.getName()),!0]));return e.getBlocksByType("procedures_defreturn",!1).forEach(e=>{!$i(e)&&pt(e)&&r.push(e.getProcedureDef())}),t.sort(Hi),r.sort(Hi),[t,r]},Hi=function(e,t){return e[0].localeCompare(t[0],void 0,{sensitivity:"base"})},f.findLegalName$$module$build$src$core$procedures=function(e,t){if(!t.isInFlyout)for(e=e||f.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!Gi(e,t.workspace,t);){var r=e.match(/^(.*?)(\d+)$/);e=r?r[1]+(parseInt(r[2])+1):e+"2"}return e},Gi=function(e,t,r){return!ji(e,t,r)},ji=function(e,t,r){for(var n of t.getAllBlocks(!1))if(n!==r&&pt(n)&&f.Names$$module$build$src$core$names.equals(n.getProcedureDef()[0],e))return!0;r=!r||!$i(r)||null==r?void 0:r.getProcedureModel();for(var i of t.getProcedureMap().getProcedures())if(i!==r&&f.Names$$module$build$src$core$names.equals(i.getName(),e))return!0;return!1},f.rename$$module$build$src$core$procedures=function(e){var t=this.getSourceBlock();if(!t)throw new Xc;e=e.trim();var r=f.findLegalName$$module$build$src$core$procedures(e,t),n=($i(t)&&!t.isInsertionMarker()&&t.getProcedureModel().setName(r),this.getValue());if(n!==e&&n!==r)for(e=t.workspace.getAllBlocks(!1),t=0;t<e.length;t++){var i=e[t];i.renameProcedure&&i.renameProcedure(n,r)}return r},Ki=function(e){function t(t,r){for(let e=0;e<t.length;e++){var n=t[e][0],i=t[e][1],s=f.createElement$$module$build$src$core$utils$xml("block"),a=(s.setAttribute("type",r),s.setAttribute("gap","16"),f.createElement$$module$build$src$core$utils$xml("mutation"));for(a.setAttribute("name",n),s.appendChild(a),n=0;n<i.length;n++){var o=f.createElement$$module$build$src$core$utils$xml("arg");o.setAttribute("name",i[n]),a.appendChild(o)}l.push(s)}}let l=[];var r,n;return Ua.procedures_defnoreturn&&((r=f.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_defnoreturn"),r.setAttribute("gap","16"),(n=f.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),n.appendChild(f.createTextNode$$module$build$src$core$utils$xml(f.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),r.appendChild(n),l.push(r)),Ua.procedures_defreturn&&((r=f.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_defreturn"),r.setAttribute("gap","16"),(n=f.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),n.appendChild(f.createTextNode$$module$build$src$core$utils$xml(f.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),r.appendChild(n),l.push(r)),Ua.procedures_ifreturn&&((r=f.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_ifreturn"),r.setAttribute("gap","16"),l.push(r)),l.length&&l[l.length-1].setAttribute("gap","24"),t((e=Vi(e))[0],"procedures_callnoreturn"),t(e[1],"procedures_callreturn"),l},zi=function(e){return Wi(e,!1)},Wi=function(e,t=!0){function r(e,t){for(var[r,n]of e)i.push({kind:"block",type:t,gap:16,extraState:{name:r,params:n}})}if(t)return gt("The XML return value of Blockly.Procedures.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),Ki(e);let i=[];return Ua.procedures_defnoreturn&&i.push({kind:"block",type:"procedures_defnoreturn",gap:16,fields:{NAME:f.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE}}),Ua.procedures_defreturn&&i.push({kind:"block",type:"procedures_defreturn",gap:16,fields:{NAME:f.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE}}),Ua.procedures_ifreturn&&i.push({kind:"block",type:"procedures_ifreturn",gap:16}),i.length&&(i[i.length-1].gap=24),r((e=Vi(e))[0],"procedures_callnoreturn"),r(e[1],"procedures_callreturn"),i},qi=function(e){var r=[],n=e.getBlocksByType("procedures_mutatorarg",!1);for(let e=0,t;t=n[e];e++)r.push(t.getFieldValue("NAME"));var n=f.createElement$$module$build$src$core$utils$xml("xml"),t=f.createElement$$module$build$src$core$utils$xml("block"),i=(t.setAttribute("type","procedures_mutatorarg"),f.createElement$$module$build$src$core$utils$xml("field"));i.setAttribute("name","NAME"),r=xt(f.DEFAULT_ARG$$module$build$src$core$procedures,r),r=f.createTextNode$$module$build$src$core$utils$xml(r),i.appendChild(r),t.appendChild(i),n.appendChild(t),e.updateToolbox(n)},Ji=function(e){var t;La(e)&&"mutator"===e.bubbleType&&e.isOpen&&e.blockId&&("procedures_defnoreturn"!==(t=(e=re(e.workspaceId).getBlockById(e.blockId)).type)&&"procedures_defreturn"!==t||(e=e.getIcon(f.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace(),qi(e),e.addChangeListener(Yi)))},Yi=function(e){(Ia(e)||Aa(e)||Da(e)||Na(e))&&(e=re(e.workspaceId),qi(e))},Xi=function(t,e){return e.getAllBlocks(!1).filter(e=>Zi(e,t)||ht(e)&&f.Names$$module$build$src$core$names.equals(e.getProcedureCall(),t))},Zi=function(e,t){return $i(e)&&!e.isProcedureDef()&&e.getProcedureModel()&&f.Names$$module$build$src$core$names.equals(e.getProcedureModel().getName(),t)},f.mutateCallers$$module$build$src$core$procedures=function(r){var n=So,i=r.getProcedureDef()[0],s=r.mutationToDom(!0);r=Xi(i,r.workspace);for(let e=0,t;t=r[e];e++){i=(i=t.mutationToDom())&&Re(i),t.domToMutation&&t.domToMutation(s);var a=t.mutationToDom();i!==(a=a&&Re(a))&&(f.setRecordUndo$$module$build$src$core$events$utils(!1),m(new(g(y.BLOCK_CHANGE))(t,"mutation",null,i,a)),f.setRecordUndo$$module$build$src$core$events$utils(n))}},f.getDefinition$$module$build$src$core$procedures=function(e,t){for(var r of t.getAllBlocks(!1))if($i(r)&&r.isProcedureDef()&&f.Names$$module$build$src$core$names.equals(r.getProcedureModel().getName(),e)||pt(r)&&f.Names$$module$build$src$core$names.equals(r.getProcedureDef()[0],e))return r;return null},Qi=function(e){return e.isDynamic},es=function(e){return void 0!==e.pathDown&&void 0!==e.pathUp},ts=function(e){return void 0!==e.pathLeft&&void 0!==e.pathRight},rs=function(e,t){i(_.RENDERER,e,t)},Dh=function(e){la(_.RENDERER,e)},ns=function(e,t,r){return(e=new(da(_.RENDERER,e))(e)).init(t,r),e},is=function(e){Et(e.getTargetWorkspace(),void 0,"String")},ss=function(e){Et(e.getTargetWorkspace(),void 0,"Number")},as=function(e){Et(e.getTargetWorkspace(),void 0,"Colour")},os=function(e){return ls(e,!1)},ls=function(e,t=!0){return Ua.variables_set_dynamic||Ua.variables_get_dynamic||console.warn("There are no dynamic variable blocks, but there is a dynamic variable category."),t?(gt("The XML return value of Blockly.VariablesDynamic.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),cs(e)):(e.registerButtonCallback("CREATE_VARIABLE_STRING",is),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",ss),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",as),[{kind:"button",text:f.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE,callbackkey:"CREATE_VARIABLE_STRING"},{kind:"button",text:f.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE,callbackkey:"CREATE_VARIABLE_NUMBER"},{kind:"button",text:f.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE,callbackkey:"CREATE_VARIABLE_COLOUR"},...bt(e,e.getVariableMap().getAllVariables(),!1,"variables_get_dynamic","variables_set_dynamic")])},cs=function(e){let t=[],r=document.createElement("button");return r.setAttribute("text",f.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),t.push(r),(r=document.createElement("button")).setAttribute("text",f.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),t.push(r),(r=document.createElement("button")).setAttribute("text",f.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),t.push(r),e.registerButtonCallback("CREATE_VARIABLE_STRING",is),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",ss),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",as),e=us(e),t=t.concat(e)},us=function(r){r=r.getVariableMap().getAllVariables();var n,e,i=[];if(0<r.length&&(Ua.variables_set_dynamic&&(n=r[r.length-1],(e=f.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_set_dynamic"),e.setAttribute("gap","24"),e.appendChild(Nt(n)),i.push(e)),Ua.variables_get_dynamic)){r.sort(Lt);for(let e=0,t;t=r[e];e++)(n=f.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get_dynamic"),n.setAttribute("gap","8"),n.appendChild(Nt(t)),i.push(n)}return i},ds=function(e,t){var r=e.toCopyData();return qp=r,Jp=ee(e)&&e.workspace instanceof wp?e.workspace:null,Yp=t,r},Oh=function(){return qp},Kh=function(e){qp=e},Lh=function(){return Jp},Wh=function(e){Jp=e},Rh=function(){return Yp},zh=function(e){Yp=e},ps=function(e,t,r){return e&&t?hs(e,t,r):qp&&Jp?hs(qp,Jp,Yp):null},hs=function(e,t,r){var n;return t=!t.isMutator&&null!=(n=t.options.parentWorkspace)?n:t,null!=(n=null==(n=pa(_.PASTER,e.paster,!1))?void 0:n.paste(e,t,r))?n:null},ms=function(e){return e&&"function"==typeof e.toCopyData},gs=function(){T.registry.register({name:Jd.ESCAPE,preconditionFn(e){return!e.isReadOnly()},callback(e){return e.hideChaff(),!0},keyCodes:[n.ESC]})},fs=function(){T.registry.register({name:Jd.DELETE,preconditionFn(e,t){return t=t.focusedNode,!e.isReadOnly()&&null!=t&&Ri(t)&&t.isDeletable()&&!e.isDragging()&&!f.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()},callback(e,t,r,n){return t.preventDefault(),(e=n.focusedNode)instanceof O?e.checkAndDelete():Ri(e)&&e.isDeletable()&&(f.setGroup$$module$build$src$core$events$utils(!0),e.dispose(),f.setGroup$$module$build$src$core$events$utils(!1)),!0},keyCodes:[n.DELETE,n.BACKSPACE]})},_s=function(e){return!!(ms(e)&&Ri(e)&&Fi(e))&&(e.isCopyable?e.isCopyable():e instanceof O||e instanceof xu?e.isOwnDeletable()&&e.isOwnMovable():e.isDeletable()&&e.isMovable())},ys=function(e){return _s(e)&&Ri(e)&&e.isDeletable()},bs=function(){var e=T.registry.createSerializedKey(n.C,[n.CTRL]),t=T.registry.createSerializedKey(n.C,[n.META]);T.registry.register({name:Jd.COPY,preconditionFn(e,t){return t=t.focusedNode,e=e.isFlyout?e.targetWorkspace:e,!!t&&!!e&&!e.isDragging()&&!f.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&_s(t)},callback(e,t,r,n){return t.preventDefault(),!!((t=n.focusedNode)&&ms(t)&&_s(t))&&!!(e=e.isFlyout?e.targetWorkspace:e)&&(t.workspace.isFlyout||e.hideChaff(),e=Fi(t)&&t.workspace==e?t.getRelativeToSurfaceXY():void 0,!!ds(t,e))},keyCodes:[e,t]})},vs=function(){var e=T.registry.createSerializedKey(n.X,[n.CTRL]),t=T.registry.createSerializedKey(n.X,[n.META]);T.registry.register({name:Jd.CUT,preconditionFn(e,t){return!!(t=t.focusedNode)&&!e.isReadOnly()&&!e.isDragging()&&!f.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&ys(t)},callback(e,t,r,n){return!!((e=n.focusedNode)&&ys(e)&&ms(e))&&(t=Fi(e)?e.getRelativeToSurfaceXY():void 0,t=ds(e,t),e instanceof O?e.checkAndDelete():Ri(e)&&e.dispose(),!!t)},keyCodes:[e,t]})},Ts=function(){var e=T.registry.createSerializedKey(n.V,[n.CTRL]),t=T.registry.createSerializedKey(n.V,[n.META]);T.registry.register({name:Jd.PASTE,preconditionFn(){var e=Jp;return!(!e||!e.rendered||(e=e.isFlyout?e.targetWorkspace:e,!qp)||!e||e.isReadOnly()||e.isDragging()||f.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken())},callback(e,t){if(!(e=qp))return!1;var r=Jp;if(!r)return!1;if(!(r=r.isFlyout?r.targetWorkspace:r)||r.isReadOnly())return!1;if(t instanceof PointerEvent)t=Ne(r,new k(t.clientX,t.clientY));else{if(!(t=Yp))return!!ps(e,r);var{left:n,top:i,width:s,height:a}=r.getMetricsManager().getViewMetrics(!0);if(new E(i,i+a,n,n+s).contains(t.x,t.y))return!!ps(e,r);t=new k(n+s/2,i+a/2)}return!!ps(e,r,t)},keyCodes:[e,t]})},ks=function(){var e=T.registry.createSerializedKey(n.Z,[n.CTRL]),t=T.registry.createSerializedKey(n.Z,[n.META]);T.registry.register({name:Jd.UNDO,preconditionFn(e){return!e.isReadOnly()&&!e.isDragging()&&!f.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()},callback(e,t){return e.hideChaff(),e.undo(!1),t.preventDefault(),!0},keyCodes:[e,t]})},xs=function(){var e=T.registry.createSerializedKey(n.Z,[n.CTRL,n.SHIFT]),t=T.registry.createSerializedKey(n.Z,[n.META,n.SHIFT]),r=T.registry.createSerializedKey(n.Y,[n.CTRL]);T.registry.register({name:Jd.REDO,preconditionFn(e){return!e.isDragging()&&!e.isReadOnly()&&!f.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()},callback(e,t){return e.hideChaff(),e.undo(!0),t.preventDefault(),!0},keyCodes:[e,t,r]})},Xh=function(){gs(),fs(),bs(),vs(),Ts(),ks(),xs()},Es=function(e){var t=e.saveState();return e.getParameters().length&&(t.parameters=e.getParameters().map(e=>e.saveState())),t},Ss=function(e,t,r,n){if(e=e.loadState(r,n),r.parameters)for(var[i,s]of r.parameters.entries())e.insertParameter(t.loadState(s,n),i);return e},tm=function(e){var t,r=Object.create(null),n=ha(_.SERIALIZER,!0);for(t in n){var i=null==(i=n[t])?void 0:i.save(e);i&&(r[t]=i)}return r},Qh=function(e,t,{recordUndo:r=!1}={}){if(l=ha(_.SERIALIZER,!0)){var n,i,s,a,o,l=Object.entries(l).sort((e,t)=>t[1].priority-e[1].priority),c=So;f.setRecordUndo$$module$build$src$core$events$utils(r),(r=f.getGroup$$module$build$src$core$events$utils())||f.setGroup$$module$build$src$core$events$utils(!0),q(),t instanceof wp&&t.setResizesEnabled(!1);for([,n]of l.reverse())null!=(i=n)&&i.clear(t);for([s,a]of l.reverse())e[s]&&null!=(o=a)&&o.load(e[s],t);t instanceof wp&&t.setResizesEnabled(!0),J(),m(new(g(y.FINISHED_LOADING))(t)),f.setGroup$$module$build$src$core$events$utils(r),f.setRecordUndo$$module$build$src$core$events$utils(c)}},Cs=function(e,t){var r,n=null,n="string"==typeof e?document.getElementById(e)||document.querySelector(e):e;if(!document.contains(n)&&document!==(null==(r=n)?void 0:r.ownerDocument))throw Error("Error: container is not in current document");e=new Fu(t||{}),r=document.createElement("div"),c(r,"injectionDiv"),null!=t&&t.rtl&&c(r,"blocklyRTL"),n.appendChild(r),t=ws(r,e);let i=Is(r,t,e);return As(i),oe(i),de(i),r.addEventListener("focusin",function(){oe(i)}),h(r,"keydown",null,ge),i},ws=function(e,t){e.setAttribute("dir","LTR"),ye(t.hasCss,t.pathToMedia);var r=l(x.SVG,{xmlns:Do,"xmlns:html":No,"xmlns:xlink":Oo,version:"1.1",class:"blocklySvg"},e),n=l(x.DEFS,{},r),i=String(Math.random()).substring(2);return t.gridPattern=Ud.createDom(i,t.gridOptions,n,e),r},Is=function(e,t,r){r.parentWorkspace=null;var n=(r=new wp(r)).options,i=(r.scale=n.zoomOptions.startScale,t.appendChild(r.createDom("blocklyMainBackground",e)),r.getRenderer().getClassName());return i&&c(e,i),(i=r.getTheme().getClassName())&&c(e,i),!n.hasCategories&&n.languageTree&&(e=r.addFlyout(x.SVG),z(e,t)),n.hasTrashcan&&r.addTrashcan(),n.zoomOptions&&n.zoomOptions.controls&&r.addZoomControls(),r.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),r.translate(0,0),r.addChangeListener(Di(r)),de(r),an(),lr(),Pr(),r},As=function(e){var t,r=e.options,n=e.getParentSvg();h(n.parentNode,"contextmenu",null,function(e){ka(e)||e.preventDefault()}),n=h(window,"resize",null,function(){Hr(),e.hideComponents(!0),Sr(),_n(),de(e),Oi(e)}),e.setResizeHandlerWrapper(n),Ds(),r.languageTree&&(n=e.getToolbox(),t=e.getFlyout(!0),n?n.init():t&&(t.init(e),t.show(r.languageTree),"function"==typeof t.scrollToStart)&&t.scrollToStart()),r.hasTrashcan&&e.trashcan.init(),r.zoomOptions&&r.zoomOptions.controls&&e.zoomControls_.init(),r.moveOptions&&r.moveOptions.scrollbars?(e.scrollbar=new Od(e,!0===r.moveOptions.scrollbars||!!r.moveOptions.scrollbars.horizontal,!0===r.moveOptions.scrollbars||!!r.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),r.hasSounds&&Ns(r.pathToMedia,e)},Ds=function(){dh||(h(document,"scroll",null,function(){var r=ne();for(let e=0,t;t=r[e];e++)t instanceof wp&&t.updateInverseScreenCTM()}),Ta(document,"touchend",null,fa),Ta(document,"touchcancel",null,fa)),dh=!0},Ns=function(e,t){function r(){for(;i.length;){var e=i.pop();e&&s(e)}n.preload()}let n=t.getAudioManager(),i=(n.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),n.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),n.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete"),[]);i.push(h(document,"pointermove",null,r,!0)),i.push(h(document,"touchstart",null,r,!0))},Os=function(){A.registry.register({displayText(){return f.Msg$$module$build$src$core$msg.UNDO},preconditionFn(e){return 0<e.workspace.getUndoStack().length?"enabled":"disabled"},callback(e){e.workspace.undo(!1)},scopeType:A.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},Rs=function(){A.registry.register({displayText(){return f.Msg$$module$build$src$core$msg.REDO},preconditionFn(e){return 0<e.workspace.getRedoStack().length?"enabled":"disabled"},callback(e){e.workspace.undo(!0)},scopeType:A.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},Ls=function(){A.registry.register({displayText(){return f.Msg$$module$build$src$core$msg.CLEAN_UP},preconditionFn(e){return e.workspace.isMovable()?1<e.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden"},callback(e){e.workspace.cleanUp()},scopeType:A.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},Ps=function(t,r){function n(e){s--,e.setCollapsed(t),0===s&&f.setGroup$$module$build$src$core$events$utils(!1)}let i=0,s=0;f.setGroup$$module$build$src$core$events$utils(!0);for(let t=0;t<r.length;t++){let e=r[t];for(;e;)s++,setTimeout(n.bind(null,e),i),e=e.getNextBlock(),i+=10}},Ms=function(){A.registry.register({displayText(){return f.Msg$$module$build$src$core$msg.COLLAPSE_ALL},preconditionFn(r){if(r.workspace.options.collapse){r=r.workspace.getTopBlocks(!1);for(let t=0;t<r.length;t++){let e=r[t];for(;e;){if(!e.isCollapsed())return"enabled";e=e.getNextBlock()}}return"disabled"}return"hidden"},callback(e){Ps(!0,e.workspace.getTopBlocks(!0))},scopeType:A.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},Fs=function(){A.registry.register({displayText(){return f.Msg$$module$build$src$core$msg.EXPAND_ALL},preconditionFn(r){if(r.workspace.options.collapse){r=r.workspace.getTopBlocks(!1);for(let t=0;t<r.length;t++){let e=r[t];for(;e;){if(e.isCollapsed())return"enabled";e=e.getNextBlock()}}return"disabled"}return"hidden"},callback(e){Ps(!1,e.workspace.getTopBlocks(!0))},scopeType:A.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},Bs=function(t,r){if(t.isDeletable())Array.prototype.push.apply(r,t.getDescendants(!1));else{t=t.getChildren(!1);for(let e=0;e<t.length;e++)Bs(t[e],r)}},$s=function(t){var r=[];t=t.getTopBlocks(!0);for(let e=0;e<t.length;e++)Bs(t[e],r);return r},Us=function(e,t){t?f.setGroup$$module$build$src$core$events$utils(t):(f.setGroup$$module$build$src$core$events$utils(!0),t=f.getGroup$$module$build$src$core$events$utils());var r=e.shift();r&&(r.isDeadOrDying()?Us(e,t):(r.dispose(!1,!0),setTimeout(Us,10,e,t))),f.setGroup$$module$build$src$core$events$utils(!1)},Vs=function(){A.registry.register({displayText(e){return e.workspace?1===(e=$s(e.workspace).length)?f.Msg$$module$build$src$core$msg.DELETE_BLOCK:f.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",""+e):""},preconditionFn(e){return e.workspace&&0<$s(e.workspace).length?"enabled":"disabled"},callback(e){var t;e.workspace&&(e.workspace.cancelCurrentGesture(),(t=$s(e.workspace)).length<2?Us(t):ut(f.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(t.length)),function(e){e&&Us(t)}))},scopeType:A.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},Hs=function(){Os(),Rs(),Ls(),Ms(),Fs(),Vs()},Gs=function(){A.registry.register({displayText(){return f.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK},preconditionFn(e){return!(e=e.block).isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden"},callback(e){var t;e.block&&(t=e.block.toCopyData())&&ps(t,e.block.workspace)},scopeType:A.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},js=function(){A.registry.register({displayText(e){return e.block.hasIcon(zd.TYPE)?f.Msg$$module$build$src$core$msg.REMOVE_COMMENT:f.Msg$$module$build$src$core$msg.ADD_COMMENT},preconditionFn(e){return!(e=e.block).isInFlyout&&e.workspace.options.comments&&!e.isCollapsed()&&e.isEditable()?"enabled":"hidden"},callback(e){(e=e.block).hasIcon(zd.TYPE)?e.setCommentText(null):e.setCommentText("")},scopeType:A.ScopeType.BLOCK,id:"blockComment",weight:2})},Ks=function(){A.registry.register({displayText(e){return e.block.getInputsInline()?f.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:f.Msg$$module$build$src$core$msg.INLINE_INPUTS},preconditionFn(t){if(!(t=t.block).isInFlyout&&t.isMovable()&&!t.isCollapsed())for(let e=1;e<t.inputList.length;e++)if(!(t.inputList[e-1]instanceof nh||t.inputList[e]instanceof nh))return"enabled";return"hidden"},callback(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:A.ScopeType.BLOCK,id:"blockInline",weight:3})},zs=function(){A.registry.register({displayText(e){return e.block.isCollapsed()?f.Msg$$module$build$src$core$msg.EXPAND_BLOCK:f.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK},preconditionFn(e){return!(e=e.block).isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden"},callback(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:A.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},Ws=function(){A.registry.register({displayText(e){return e.block.hasDisabledReason(Il)?f.Msg$$module$build$src$core$msg.ENABLE_BLOCK:f.Msg$$module$build$src$core$msg.DISABLE_BLOCK},preconditionFn(e){var t;return!(e=e.block).isInFlyout&&e.workspace.options.disable&&e.isEditable()?(t=(t=e.getDisabledReasons()).size>(t.has(Il)?1:0),e.getInheritedDisabled()||t?"disabled":"enabled"):"hidden"},callback(e){e=e.block;var t=f.getGroup$$module$build$src$core$events$utils();t||f.setGroup$$module$build$src$core$events$utils(!0),e.setDisabledReason(!e.hasDisabledReason(Il),Il),f.setGroup$$module$build$src$core$events$utils(t)},scopeType:A.ScopeType.BLOCK,id:"blockDisable",weight:5})},qs=function(){A.registry.register({displayText(e){var t=e.block;return e=t.getDescendants(!1).length,(t=t.getNextBlock())&&(e-=t.getDescendants(!1).length),1===e?f.Msg$$module$build$src$core$msg.DELETE_BLOCK:f.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",""+e)},preconditionFn(e){return!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden"},callback(e){e.block&&e.block.checkAndDelete()},scopeType:A.ScopeType.BLOCK,id:"blockDelete",weight:6})},Js=function(){A.registry.register({displayText(){return f.Msg$$module$build$src$core$msg.HELP},preconditionFn(e){return("function"==typeof(e=e.block).helpUrl?e.helpUrl():e.helpUrl)?"enabled":"hidden"},callback(e){e.block.showHelp()},scopeType:A.ScopeType.BLOCK,id:"blockHelp",weight:7})},Ys=function(){A.registry.register({displayText:()=>f.Msg$$module$build$src$core$msg.REMOVE_COMMENT,preconditionFn(e){return null!=(e=e.comment)&&e.isDeletable()?"enabled":"hidden"},callback(e){f.setGroup$$module$build$src$core$events$utils(!0),null!=(e=e.comment)&&e.dispose(),f.setGroup$$module$build$src$core$events$utils(!1)},scopeType:A.ScopeType.COMMENT,id:"commentDelete",weight:6})},Xs=function(){A.registry.register({displayText:()=>f.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,preconditionFn(e){return null!=(e=e.comment)&&e.isMovable()?"enabled":"hidden"},callback(e){var t;e.comment&&(t=e.comment.toCopyData())&&ps(t,e.comment.workspace)},scopeType:A.ScopeType.COMMENT,id:"commentDuplicate",weight:1})},Zs=function(){A.registry.register({displayText:()=>f.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:e=>null!=(e=e.workspace)&&e.isMutator?"hidden":"enabled",callback:(e,t,r,n)=>{(e=e.workspace)&&(f.setGroup$$module$build$src$core$events$utils(!0),(t=new xu(e)).setPlaceholderText(f.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT),t.moveTo(Qs(new k(n.x,n.y),e)),f.getFocusManager$$module$build$src$core$focus_manager().focusNode(t),f.setGroup$$module$build$src$core$events$utils(!1))},scopeType:A.ScopeType.WORKSPACE,id:"commentCreate",weight:8})},Qs=function(e,t){var r=t.getInjectionDiv().getBoundingClientRect();return e=new k(e.x-r.left,e.y-r.top),r=t.getOriginOffsetInPixels(),(e=k.difference(e,r)).scale(1/t.scale),e},ea=function(){Gs(),js(),Ks(),zs(),Ws(),qs(),Js()},ta=function(){Xs(),Ys(),Zs()},ra=function(){Hs(),ea()},na=function(e){return e&&"function"==typeof e.paste},ia=function(e){return e&&"function"==typeof e.getSvgRoot},sa=function(e){return e.isSelectable()},aa=function(e){Ya.hideChaff(e)},(p=p||{}).scope={},p.ASSUME_ES5=!1,p.ASSUME_ES6=!1,p.ASSUME_ES2020=!1,p.ASSUME_NO_NATIVE_MAP=!1,p.ASSUME_NO_NATIVE_SET=!1,p.ISOLATE_POLYFILLS=!1,p.FORCE_POLYFILL_PROMISE=!1,p.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,p.INSTRUMENT_ASYNC_CONTEXT=!0,p.objectCreate=p.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t},p.defineProperty=p.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,r){return e!=Array.prototype&&e!=Object.prototype&&(e[t]=r.value),e},p.getGlobal=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof rm&&rm];for(var t=0;t<e.length;++t){var r=e[t];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")},p.global=p.ASSUME_ES2020?globalThis:p.getGlobal(this),p.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),p.TRUST_ES6_POLYFILLS=!p.ISOLATE_POLYFILLS||p.IS_SYMBOL_NATIVE,p.polyfills={},p.propertyToPolyfillSymbol={},p.POLYFILL_PREFIX="$jscp$",p.polyfill=function(e,t,r,n){t&&(p.ISOLATE_POLYFILLS?p.polyfillIsolated(e,t,r,n):p.polyfillUnisolated(e,t,r,n))},p.polyfillUnisolated=function(e,t,r,n){for(r=p.global,e=e.split("."),n=0;n<e.length-1;n++){var i=e[n];if(!(i in r))return;r=r[i]}(t=t(n=r[e=e[e.length-1]]))!=n&&null!=t&&p.defineProperty(r,e,{configurable:!0,writable:!0,value:t})},p.polyfillIsolated=function(e,t,r,n){var i=e.split(".");e=1===i.length,n=i[0],n=!e&&n in p.polyfills?p.polyfills:p.global;for(var s=0;s<i.length-1;s++){var a=i[s];if(!(a in n))return;n=n[a]}i=i[i.length-1],null!=(t=t(r=p.IS_SYMBOL_NATIVE&&"es6"===r?n[i]:null))&&(e?p.defineProperty(p.polyfills,i,{configurable:!0,writable:!0,value:t}):t!==r&&(void 0===p.propertyToPolyfillSymbol[i]&&(r=1e9*Math.random()>>>0,p.propertyToPolyfillSymbol[i]=p.IS_SYMBOL_NATIVE?p.global.Symbol(i):p.POLYFILL_PREFIX+r+"$"+i),p.defineProperty(n,p.propertyToPolyfillSymbol[i],{configurable:!0,writable:!0,value:t})))},p.getConstructImplementation=function(){var n;return p.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct?(Reflect.construct(e,[],function(){}),new e instanceof e?Reflect.construct:(n=Reflect.construct,function(e,t,r){return e=n(e,t),r&&Reflect.setPrototypeOf(e,r.prototype),e})):function(e,t,r){return r=p.objectCreate((r=void 0===r?e:r).prototype||Object.prototype),Function.prototype.apply.call(e,r,t)||r};function e(){}},p.construct={valueOf:p.getConstructImplementation}.valueOf(),p.underscoreProtoCanBeSet=function(){var e={};try{return e.__proto__={a:!0},e.a}catch(e){}return!1},p.setPrototypeOf=p.ASSUME_ES6||p.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:p.underscoreProtoCanBeSet()?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null,p.inherits=function(e,t){if(e.prototype=p.objectCreate(t.prototype),e.prototype.constructor=e,p.ASSUME_ES6||p.setPrototypeOf){var r=p.setPrototypeOf;r(e,t)}else for(r in t){var n;"prototype"!=r&&(Object.defineProperties?(n=Object.getOwnPropertyDescriptor(t,r))&&Object.defineProperty(e,r,n):e[r]=t[r])}e.superClass_=t.prototype},p.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},p.arrayIterator=function(e){return{next:p.arrayIteratorImpl(e)}},p.makeIterator=function(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return p.arrayIterator(e);throw Error(String(e)+" is not an iterable or ArrayLike")},p.arrayFromIterator=function(e){for(var t,r=[];!(t=e.next()).done;)r.push(t.value);return r},p.arrayFromIterable=function(e){return e instanceof Array?e:p.arrayFromIterator(p.makeIterator(e))},p.generator={},p.generator.ensureIteratorResultIsObject_=function(e){if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object")},p.generator.Context=function(){this.isRunning_=!1,this.yieldAllIterator_=null,this.yieldResult=void 0,this.nextAddress=1,this.finallyAddress_=this.catchAddress_=0,this.finallyContexts_=this.abruptCompletion_=null},p.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0},p.generator.Context.prototype.stop_=function(){this.isRunning_=!1},p.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_},p.generator.Context.prototype.next_=function(e){this.yieldResult=e},p.generator.Context.prototype.throw_=function(e){this.abruptCompletion_={exception:e,isException:!0},this.jumpToErrorHandler_()},p.generator.Context.prototype.return=function(e){this.abruptCompletion_={return:e},this.nextAddress=this.finallyAddress_},p.generator.Context.prototype.jumpThroughFinallyBlocks=function(e){this.abruptCompletion_={jumpTo:e},this.nextAddress=this.finallyAddress_},p.generator.Context.prototype.yield=function(e,t){return this.nextAddress=t,{value:e}},p.generator.Context.prototype.yieldAll=function(e,t){var r=(e=p.makeIterator(e)).next();if(p.generator.ensureIteratorResultIsObject_(r),!r.done)return this.yieldAllIterator_=e,this.yield(r.value,t);this.yieldResult=r.value,this.nextAddress=t},p.generator.Context.prototype.jumpTo=function(e){this.nextAddress=e},p.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0},p.generator.Context.prototype.setCatchFinallyBlocks=function(e,t){this.catchAddress_=e,null!=t&&(this.finallyAddress_=t)},p.generator.Context.prototype.setFinallyBlock=function(e){this.catchAddress_=0,this.finallyAddress_=e||0},p.generator.Context.prototype.leaveTryBlock=function(e,t){this.nextAddress=e,this.catchAddress_=t||0},p.generator.Context.prototype.enterCatchBlock=function(e){return this.catchAddress_=e||0,e=this.abruptCompletion_.exception,this.abruptCompletion_=null,e},p.generator.Context.prototype.enterFinallyBlock=function(e,t,r){r?this.finallyContexts_[r]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_],this.catchAddress_=e||0,this.finallyAddress_=t||0},p.generator.Context.prototype.leaveFinallyBlock=function(e,t){if(t=this.finallyContexts_.splice(t||0)[0],t=this.abruptCompletion_=this.abruptCompletion_||t){if(t.isException)return this.jumpToErrorHandler_();null!=t.jumpTo&&this.finallyAddress_<t.jumpTo?(this.nextAddress=t.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=e},p.generator.Context.prototype.forIn=function(e){return new p.generator.Context.PropertyIterator(e)},p.generator.Context.PropertyIterator=function(e){for(var t in this.object_=e,this.properties_=[],e)this.properties_.push(t);this.properties_.reverse()},p.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var e=this.properties_.pop();if(e in this.object_)return e}return null},p.generator.Engine_=function(e){this.context_=new p.generator.Context,this.program_=e},p.generator.Engine_.prototype.next_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.next,e,this.context_.next_):(this.context_.next_(e),this.nextStep_())},p.generator.Engine_.prototype.return_=function(e){this.context_.start_();var t=this.context_.yieldAllIterator_;return t?this.yieldAllStep_("return"in t?t.return:function(e){return{value:e,done:!0}},e,this.context_.return):(this.context_.return(e),this.nextStep_())},p.generator.Engine_.prototype.throw_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.throw,e,this.context_.next_):(this.context_.throw_(e),this.nextStep_())},p.generator.Engine_.prototype.yieldAllStep_=function(e,t,r){try{var n=e.call(this.context_.yieldAllIterator_,t);if(p.generator.ensureIteratorResultIsObject_(n),!n.done)return this.context_.stop_(),n;var i=n.value}catch(e){return this.context_.yieldAllIterator_=null,this.context_.throw_(e),this.nextStep_()}return this.context_.yieldAllIterator_=null,r.call(this.context_,i),this.nextStep_()},p.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var e=this.program_(this.context_);if(e)return this.context_.stop_(),{value:e.value,done:!1}}catch(e){this.context_.yieldResult=void 0,this.context_.throw_(e)}if(this.context_.stop_(),this.context_.abruptCompletion_){if(e=this.context_.abruptCompletion_,this.context_.abruptCompletion_=null,e.isException)throw e.exception;return{value:e.return,done:!0}}return{value:void 0,done:!0}},p.generator.Generator_=function(t){this.next=function(e){return t.next_(e)},this.throw=function(e){return t.throw_(e)},this.return=function(e){return t.return_(e)},this[Symbol.iterator]=function(){return this}},p.generator.createGenerator=function(e,t){return t=new p.generator.Generator_(new p.generator.Engine_(t)),p.setPrototypeOf&&e.prototype&&p.setPrototypeOf(t,e.prototype),t},p.asyncExecutePromiseGenerator=function(t){function i(e){return t.next(e)}function s(e){return t.throw(e)}return new Promise(function(r,n){!function e(t){t.done?r(t.value):Promise.resolve(t.value).then(i,s).then(e,n)}(t.next())})},p.asyncExecutePromiseGeneratorFunction=function(e){return p.asyncExecutePromiseGenerator(e())},p.asyncExecutePromiseGeneratorProgram=function(e){return p.asyncExecutePromiseGenerator(new p.generator.Generator_(new p.generator.Engine_(e)))},p.polyfill("globalThis",function(e){return e||p.global},"es_2020","es3"),p.polyfill("Array.prototype.includes",function(e){return e||function(e,t){var r=this,n=(r=r instanceof String?String(r):r).length;for((t=t||0)<0&&(t=Math.max(t+n,0));t<n;t++){var i=r[t];if(i===e||Object.is(i,e))return!0}return!1}},"es7","es3"),p.checkEs6ConformanceViaProxy=function(){try{var n={},i=Object.create(new p.global.Proxy(n,{get:function(e,t,r){return e==n&&"q"==t&&r==i}}));return!0===i.q}catch(e){return!1}},p.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1,p.ES6_CONFORMANCE=p.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&p.checkEs6ConformanceViaProxy(),p.initSymbol=function(){},p.iteratorPrototype=function(e){return(e={next:e})[Symbol.iterator]=function(){return this},e},p.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},p.MapEntry=function(){},p.polyfill("Set.prototype.difference",function(e){return e||function(e){p.checkIsSetInstance(this),p.checkIsSetLike(e);for(var t=p.getSmallerAndLargerSets(this,e),r=(e=new Set(this),t.smallerSetIterator),t=t.largerSet,n=r.next();!n.done;)t.has(n.value)&&e.delete(n.value),n=r.next();return e}},"es_next","es6"),p.checkIsSetLike=function(e){if("object"!=typeof e||null===e||"number"!=typeof e.size||e.size<0||"function"!=typeof e.keys||"function"!=typeof e.has)throw new TypeError("Argument must be set-like")},p.checkIsValidIterator=function(e){if("object"!=typeof e||null===e||"function"!=typeof e.next)throw new TypeError("Invalid iterator.");return e},p.getSmallerAndLargerSets=function(e,t){return e.size<=t.size?{smallerSetIterator:e.keys(),largerSet:t}:{smallerSetIterator:p.checkIsValidIterator(t.keys()),largerSet:e}},p.checkIsSetInstance=function(e){if(!(e instanceof Set))throw new TypeError("Method must be called on an instance of Set.")},p.iteratorFromArray=function(t,r){if(p.ASSUME_ES6)return t[Symbol.iterator]();t instanceof String&&(t+="");var n=0,i=!1,e={next:function(){var e;return!i&&n<t.length?(e=n++,{value:r(e,t[e]),done:!1}):{done:i=!0,value:void 0}}};return e[Symbol.iterator]=function(){return e},e},p.polyfill("Array.prototype.values",function(e){return e||function(){return p.iteratorFromArray(this,function(e,t){return t})}},"es8","es3"),p.polyfill("Array.prototype.flatMap",function(e){return e||function(r,n){var i=[];return Array.prototype.forEach.call(this,function(e,t){e=r.call(n,e,t,this),Array.isArray(e)?i.push.apply(i,e):i.push(e)}),i}},"es9","es5"),p.polyfill("Array.prototype.flat",function(e){return e||function(t){t=void 0===t?1:t;var r=[];return Array.prototype.forEach.call(this,function(e){Array.isArray(e)&&0<t?(e=Array.prototype.flat.call(e,t-1),r.push.apply(r,e)):r.push(e)}),r}},"es9","es5"),p.polyfill("Object.entries",function(e){return e||function(e){var t,r=[];for(t in e)p.owns(e,t)&&r.push([t,e[t]]);return r}},"es8","es3"),p.polyfill("Object.values",function(e){return e||function(e){var t,r=[];for(t in e)p.owns(e,t)&&r.push(e[t]);return r}},"es8","es3"),Object.create(null)),Fa={typeMap:Ma},Ba=Object.create(null),$a="default",_=class{constructor(e){this.name=e}toString(){return this.name}},Fa=(_.CONNECTION_CHECKER=new _("connectionChecker"),_.CONNECTION_PREVIEWER=new _("connectionPreviewer"),_.CURSOR=new _("cursor"),_.EVENT=new _("event"),_.FIELD=new _("field"),_.INPUT=new _("input"),_.RENDERER=new _("renderer"),_.TOOLBOX=new _("toolbox"),_.THEME=new _("theme"),_.TOOLBOX_ITEM=new _("toolboxItem"),_.FLYOUTS_VERTICAL_TOOLBOX=new _("flyoutsVerticalToolbox"),_.FLYOUTS_HORIZONTAL_TOOLBOX=new _("flyoutsHorizontalToolbox"),_.FLYOUT_INFLATER=new _("flyoutInflater"),_.METRICS_MANAGER=new _("metricsManager"),_.BLOCK_DRAGGER=new _("blockDragger"),_.SERIALIZER=new _("serializer"),_.ICON=new _("icon"),_.PASTER=new _("paster"),_.VARIABLE_MODEL=new _("variableModel"),_.VARIABLE_MAP=new _("variableMap"),{DEFAULT:$a,TEST_ONLY:Fa}),Ua=(Fa.Type=_,Fa.getAllItems=ha,Fa.getClass=da,Fa.getClassFromOptions=ma,Fa.getObject=pa,Fa.hasItem=ua,Fa.register=i,Fa.unregister=la,Object.create(null)),Va=750,Ha="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),Ga=null,ja={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},Ka=0,za={TOUCH_ENABLED:Ha,TOUCH_MAP:ja};za.checkTouchIdentifier=va,za.clearTouchIdentifier=_a,za.getTouchIdentifierFromEvent=ba,za.longStart=ga,za.longStop=fa,za.shouldHandleEvent=ya;{var Wa=globalThis.navigator&&globalThis.navigator.userAgent||"";function qa(e){return t.includes(e.toUpperCase())}let t=(qo=Wa).toUpperCase();fo=qa("JavaFX"),bo=qa("WebKit"),bo=qa("Gecko")&&!bo,e=qa("Android"),Wa=globalThis.navigator&&globalThis.navigator.maxTouchPoints,Wa=qa("iPad")||qa("Macintosh")&&0<Wa,r=qa("iPhone")&&!Wa,Mo=qa("Macintosh"),Uo=!(Uo=Wa||e&&!qa("Mobile")||qa("Silk"))&&(r||e)}var y,Ja,Ya,Xa,b,Za,Qa,eo,to,ro,no,io,so,ao,oo,v,n,lo=fo,co=bo,uo=e,po=Wa,ho=r,mo=Mo,go=Uo,fo={ANDROID:uo,GECKO:co,IPAD:po,IPHONE:ho,JavaFx:lo,MAC:mo,MOBILE:go,raw:qo},_o=40,yo=125,bo={},vo=(bo.bind=Ta,bo.conditionalBind=h,bo.getScrollDeltaPixels=Sa,bo.isRightButton=xa,bo.isTargetInput=ka,bo.mouseToSvg=Ea,bo.unbind=s,(e=y=y||{}).BLOCK_CREATE="create",e.BLOCK_DELETE="delete",e.BLOCK_CHANGE="change",e.BLOCK_FIELD_INTERMEDIATE_CHANGE="block_field_intermediate_change",e.BLOCK_MOVE="move",e.VAR_CREATE="var_create",e.VAR_DELETE="var_delete",e.VAR_RENAME="var_rename",e.VAR_TYPE_CHANGE="var_type_change",e.UI="ui",e.BLOCK_DRAG="drag",e.SELECTED="selected",e.CLICK="click",e.MARKER_MOVE="marker_move",e.BUBBLE_OPEN="bubble_open",e.TRASHCAN_OPEN="trashcan_open",e.TOOLBOX_ITEM_SELECT="toolbox_item_select",e.THEME_CHANGE="theme_change",e.VIEWPORT_CHANGE="viewport_change",e.COMMENT_CREATE="comment_create",e.COMMENT_DELETE="comment_delete",e.COMMENT_CHANGE="comment_change",e.COMMENT_MOVE="comment_move",e.COMMENT_RESIZE="comment_resize",e.COMMENT_DRAG="comment_drag",e.COMMENT_COLLAPSE="comment_collapse",e.FINISHED_LOADING="finished_loading",[y.BLOCK_CREATE,y.BLOCK_MOVE,y.COMMENT_CREATE,y.COMMENT_MOVE]),To=({BUMP_EVENTS:vo}.EventType=y,"!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"),ko={genUid:()=>{var t=To.length,r=[];for(let e=0;e<20;e++)r[e]=To.charAt(Math.random()*t);return r.join("")}},xo=0,Wa={TEST_ONLY:ko},Eo=(Wa.genUid=wa,Wa.getNextUniqueId=Ca,""),So=!0,Co=0,wo="ORPHANED_BLOCK",Io=[],Ao={FIRE_QUEUE:Io,enqueueEvent:F,fireNow:M,fireInternal:jo,setGroupInternal:Ko},Do=(f.disable$$module$build$src$core$events$utils,f.enable$$module$build$src$core$events$utils,f.getGroup$$module$build$src$core$events$utils,f.setGroup$$module$build$src$core$events$utils,f.setRecordUndo$$module$build$src$core$events$utils,"http://www.w3.org/2000/svg"),No="http://www.w3.org/1999/xhtml",Oo="http://www.w3.org/1999/xlink",Ro=((r=Ja=Ja||{})[r.ELEMENT_NODE=1]="ELEMENT_NODE",r[r.TEXT_NODE=3]="TEXT_NODE",r[r.COMMENT_NODE=8]="COMMENT_NODE",null),Lo=0,Po=null,Mo={HTML_NS:No},Fo=(Mo.NodeType=Ja,Mo.SVG_NS=Do,Mo.XLINK_NS=Oo,Mo.addClass=c,Mo.createSvgElement=l,Mo.getFastTextWidth=Wo,Mo.getFastTextWidthWithSizeString=X,Mo.getTextWidth=Y,Mo.hasClass=K,Mo.insertAfter=z,Mo.measureFontMetrics=Z,Mo.removeClass=a,Mo.removeClasses=j,Mo.removeNode=o,Mo.setCssTransform=W,Mo.startTextWidthCache=q,Mo.stopTextWidthCache=J,class{static findFocusedNode(e){var t,r=e.getRootFocusableNode();return r.canBeFocused()?(t=r.getFocusableElement(),K(t,Fo.ACTIVE_CLASS_NAME)||K(t,Fo.PASSIVE_CSS_CLASS_NAME)||((r=t.querySelector(this.ACTIVE_FOCUS_NODE_CSS_SELECTOR))instanceof HTMLElement||r instanceof SVGElement)&&(r=Fo.findFocusableNodeFor(r,e))?r:((t=t.querySelector(this.PASSIVE_FOCUS_NODE_CSS_SELECTOR))instanceof HTMLElement||t instanceof SVGElement)&&(e=Fo.findFocusableNodeFor(t,e))?e:null):null}static findFocusableNodeFor(t,e){var r,n;return t.id&&"null"!==t.id&&-1===e.getNestedTrees().map(e=>Fo.findFocusableNodeFor(t,e)).findIndex(e=>!!e)?(r=e.getRootFocusableNode()).canBeFocused()&&t===r.getFocusableElement()?r:(r=null!=(n=e.lookUpFocusableNode(t.id))?n:null)||(n=t.parentElement,!r&&n?Fo.findFocusableNodeFor(n,e):null):null}}),Bo=(Fo.ACTIVE_CLASS_NAME="blocklyActiveFocus",Fo.PASSIVE_CSS_CLASS_NAME="blocklyPassiveFocus",Fo.ACTIVE_FOCUS_NODE_CSS_SELECTOR="."+Fo.ACTIVE_CLASS_NAME,Fo.PASSIVE_FOCUS_NODE_CSS_SELECTOR="."+Fo.PASSIVE_CSS_CLASS_NAME,class{constructor(e,t){this.tree=e,this.rootShouldBeAutoTabbable=t}}),$o=class{constructor(e){this.previouslyFocusedNode=this.focusedNode=null,this.registeredTrees=[],this.isUpdatingFocusedNode=this.recentlyLostAllFocus=this.lockFocusStateChanges=this.currentlyHoldsEphemeralFocus=!1;let t=e=>{if(!this.isUpdatingFocusedNode){this.recentlyLostAllFocus=!e;var t,r=null;if(e instanceof HTMLElement||e instanceof SVGElement)for(var n of this.registeredTrees)if(r=Fo.findFocusableNodeFor(e,n.tree))break;r&&r.canBeFocused()?(e=r.getFocusableTree(),n=null==(t=this.focusedNode)?void 0:t.getFocusableTree(),r===e.getRootFocusableNode()&&e!==n?this.focusTree(e):this.focusNode(r)):this.defocusCurrentFocusedNode()}};e("focusin",e=>{e instanceof FocusEvent&&t(document.activeElement)}),e("focusout",e=>{e instanceof FocusEvent&&t(e.relatedTarget)})}registerTree(e,t=!1){if(this.ensureManagerIsUnlocked(),this.isRegistered(e))throw Error(`Attempted to re-register already registered tree: ${e}.`);this.registeredTrees.push(new Bo(e,t));var r=e.getRootFocusableNode().getFocusableElement();if(!r.id||"null"===r.id)throw Error("Attempting to register a tree with a root element that has an "+`invalid ID: ${e}.`);t&&(r.tabIndex=0)}isRegistered(e){return!!this.lookUpRegistration(e)}lookUpRegistration(t){var e;return null!=(e=this.registeredTrees.find(e=>e.tree===t))?e:null}unregisterTree(t){if(this.ensureManagerIsUnlocked(),!this.isRegistered(t))throw Error(`Attempted to unregister not registered tree: ${t}.`);var e=this.registeredTrees.findIndex(e=>e.tree===t),r=this.registeredTrees[e],n=(this.registeredTrees.splice(e,1),e=Fo.findFocusedNode(t),t.getRootFocusableNode());e&&this.removeHighlight(e),this.focusedNode!==e&&this.focusedNode!==n||this.updateFocusedNode(null),this.removeHighlight(n),r.rootShouldBeAutoTabbable&&t.getRootFocusableNode().getFocusableElement().removeAttribute("tabindex")}getFocusedTree(){var e;return null!=(e=null==(e=this.focusedNode)?void 0:e.getFocusableTree())?e:null}getFocusedNode(){return this.focusedNode}focusTree(e){if(this.ensureManagerIsUnlocked(),!this.isRegistered(e))throw Error(`Attempted to focus unregistered tree: ${e}.`);var t=Fo.findFocusedNode(e),r=e.getRestoredFocusableNode(t);e=e.getRootFocusableNode(),this.focusNode(null!=(r=null!=r?r:t)?r:e)}focusNode(e){this.ensureManagerIsUnlocked();var t=!this.currentlyHoldsEphemeralFocus;t&&(this.isUpdatingFocusedNode=!0);var r,n=(null==(r=this.focusedNode)?void 0:r.getFocusableElement())!==document.activeElement;if(this.focusedNode!==e||n)if(e.canBeFocused()){if(r=e.getFocusableTree(),!this.isRegistered(r))throw Error(`Attempted to focus unregistered node: ${e}.`);(n=e.getFocusableElement()).id&&"null"!==n.id||console.warn("Trying to focus a node that has an invalid ID.");var i,s=Fo.findFocusableNodeFor(n,r),n=Fo.findFocusedNode(r),a=e;s!==e&&(a=r.getRestoredFocusableNode(n),e=r.getRootFocusableNode(),a=null!=(i=null!=a?a:n)?i:e),i=null==(e=this.focusedNode)?void 0:e.getFocusableTree(),e&&this.passivelyFocusNode(e,r),r=r.getRootFocusableNode(),n&&this.removeHighlight(n),r!==a&&this.removeHighlight(r),this.currentlyHoldsEphemeralFocus||this.activelyFocusNode(a,null!=i?i:null),this.updateFocusedNode(a)}else console.warn("Trying to focus a node that can't be focused.");t&&(this.isUpdatingFocusedNode=!1)}takeEphemeralFocus(e){if(this.ensureManagerIsUnlocked(),this.currentlyHoldsEphemeralFocus)throw Error("Attempted to take ephemeral focus when it's already held, "+`with new element: ${e}.`);this.currentlyHoldsEphemeralFocus=!0,this.focusedNode&&this.passivelyFocusNode(this.focusedNode,null),e.focus();let t=!1;return()=>{if(t)throw Error("Attempted to finish ephemeral focus twice for element: "+e+".");if(t=!0,this.currentlyHoldsEphemeralFocus=!1,this.focusedNode){this.activelyFocusNode(this.focusedNode,null);let e=this.focusedNode;setTimeout(()=>{!this.focusedNode&&this.previouslyFocusedNode===e&&this.recentlyLostAllFocus&&this.focusNode(e)},0)}}}ephemeralFocusTaken(){return this.currentlyHoldsEphemeralFocus}ensureManagerIsUnlocked(){if(this.lockFocusStateChanges)throw Error("FocusManager state changes cannot happen in a tree/node focus/blur callback.")}updateFocusedNode(e){this.previouslyFocusedNode=this.focusedNode,this.focusedNode=e}defocusCurrentFocusedNode(){this.focusedNode&&!this.currentlyHoldsEphemeralFocus&&(this.passivelyFocusNode(this.focusedNode,null),this.updateFocusedNode(null))}activelyFocusNode(e,t){this.lockFocusStateChanges=!0;var r=e.getFocusableTree(),n=e.getFocusableElement(),i=null==(i=this.lookUpRegistration(r))?void 0:i.rootShouldBeAutoTabbable;r!==t&&(r.onTreeFocus(e,t),i)&&(r.getRootFocusableNode().getFocusableElement().tabIndex=-1),e.onNodeFocus(),this.lockFocusStateChanges=!1,i&&e===r.getRootFocusableNode()||n.hasAttribute("tabindex")||(n.tabIndex=-1),this.setNodeToVisualActiveFocus(e),n.focus()}passivelyFocusNode(e,t){this.lockFocusStateChanges=!0;var r,n=e.getFocusableTree();n!==t&&(n.onTreeBlur(t),null!=(r=this.lookUpRegistration(n)))&&r.rootShouldBeAutoTabbable&&(n.getRootFocusableNode().getFocusableElement().tabIndex=0),e.onNodeBlur(),this.lockFocusStateChanges=!1,n!==t&&this.setNodeToVisualPassiveFocus(e)}setNodeToVisualActiveFocus(e){e=e.getFocusableElement(),c(e,$o.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),a(e,$o.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}setNodeToVisualPassiveFocus(e){e=e.getFocusableElement(),a(e,$o.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),c(e,$o.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}removeHighlight(e){e=e.getFocusableElement(),a(e,$o.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),a(e,$o.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}static getFocusManager(){return $o.focusManager||($o.focusManager=new $o(document.addEventListener)),$o.focusManager}},Uo=($o.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyActiveFocus",$o.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyPassiveFocus",$o.focusManager=null,f.getFocusManager$$module$build$src$core$focus_manager,{}),T=(Uo.deepMerge=te,class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(e,t){if(this.shortcuts.get(e.name)&&!t)throw Error(`Shortcut named "${e.name}" already exists.`);if(this.shortcuts.set(e.name,e),null!=(t=e.keyCodes)&&t.length)for(var r of t)this.addKeyMapping(r,e.name,!!e.allowCollision)}unregister(e){return this.shortcuts.get(e)?(this.removeAllKeyMappings(e),this.shortcuts.delete(e),!0):(console.warn(`Keyboard shortcut named "${e}" not found.`),!1)}addKeyMapping(e,t,r){var n=this.keyMap.get(e=""+e);if(n&&!r)throw Error(`Shortcut named "${t}" collides with shortcuts "${n}"`);n&&r?n.unshift(t):this.keyMap.set(e,[t])}removeKeyMapping(e,t,r){var n=this.keyMap.get(e);if(n){var i=n.indexOf(t);if(-1<i)return n.splice(i,1),0===n.length&&this.keyMap.delete(e),!0}return r||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1}removeAllKeyMappings(e){for(var t of this.keyMap.keys())this.removeKeyMapping(t,e,!0)}setKeyMap(e){for(var t in this.keyMap.clear(),e)this.keyMap.set(t,e[t])}getKeyMap(){var e,t,r=Object.create(null);for([e,t]of this.keyMap)r[e]=t;return r}getRegistry(){var e,t,r=Object.create(null);for([e,t]of this.shortcuts)r[e]=t;return te(Object.create(null),r)}onKeyDown(e,t){var r=this.serializeKeyEvent(t);if(r=this.getShortcutNamesByKeyCode(r))for(var n of r){var i,r=this.shortcuts.get(n);if(r&&(!r.preconditionFn||r.preconditionFn(e,{focusedNode:null!=(n=f.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())?n:void 0})))if(null!=(i=(n=r).callback)&&i.call(n,e,t,r,{focusedNode:null!=(i=f.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())?i:void 0}))return!0}return!1}getShortcutNamesByKeyCode(e){return(null==(e=this.keyMap.get(e))?void 0:e.slice())||[]}getKeyCodesByShortcutName(e){var t,r,n=[];for([t,r]of this.keyMap)-1<r.indexOf(e)&&n.push(t);return n}serializeKeyEvent(e){let t="";for(var r in T.modifierKeys)e.getModifierState(r)&&(""!==t&&(t+="+"),t+=r);return""!==t&&e.keyCode?t+="+"+e.keyCode:e.keyCode&&(t=String(e.keyCode)),t}checkModifiers(e){for(var t of e)if(!(t in T.modifierKeys))throw Error(t+" is not a valid modifier key.")}createSerializedKey(e,t){let r="";if(t)for(var n in this.checkModifiers(t),T.modifierKeys)t.includes(T.modifierKeys[n])&&(""!==r&&(r+="+"),r+=n);return""!==r&&e?r+="+"+e:e&&(r=""+e),r}}),Vo=(T.registry=new T,(qo=(qo=T=T||{}).modifierKeys||(qo.modifierKeys={}))[qo.Shift=16]="Shift",qo[qo.Control=17]="Control",qo[qo.Alt=18]="Alt",qo[qo.Meta=91]="Meta",Object.create(null)),Ho=[],Go={defineBlocksWithJsonArrayInternal:t},e={TEST_ONLY:Go},jo=(e.createBlockDefinitionsFromJsonArray=f.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,e.defineBlocks=f.defineBlocks$$module$build$src$core$common,e.defineBlocksWithJsonArray=me,e.draggingConnections=Ho,e.fireSelectedEvent=ce,e.getAllWorkspaces=ne,e.getBlockTypeCounts=pe,e.getMainWorkspace=ae,e.getParentContainer=Zo,e.getSelected=le,e.getWorkspaceById=re,e.globalShortcutHandler=ge,e.registerWorkspace=ie,e.setMainWorkspace=oe,e.setParentContainer=ue,e.setSelected=el,e.svgResize=de,e.unregisterWorkpace=se,class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=f.getGroup$$module$build$src$core$events$utils(),this.recordUndo=So}toJson(){return{type:this.type,group:this.group}}static fromJson(e,t,r){return r.isBlank=!1,r.group=e.group||"",r.workspaceId=t.id,r}isNull(){return!1}run(e){}getEventWorkspace_(){let e;if(e=this.workspaceId?re(this.workspaceId):e)return e;throw Error("Workspace is null. Event must have been generated from real Blockly events.")}}),Ko=class extends jo{constructor(e){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank=void 0===e,this.workspaceId=e||""}},zo=class extends Ko{constructor(e,t,r){super(t=null===(t=e?e.workspace.id:t)?void 0:t),this.type=y.CLICK,this.blockId=e?e.id:void 0,this.targetType=r}toJson(){var e=super.toJson();if(this.targetType)return e.targetType=this.targetType,e.blockId=this.blockId,e;throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new zo)).targetType=e.targetType,t.blockId=e.blockId,t}},Wo=((r=em=em||{}).BLOCK="block",r.WORKSPACE="workspace",r.ZOOM_CONTROLS="zoom_controls",i(_.EVENT,y.CLICK,zo),{}),qo=(Wo.removeElem=fe,class{constructor(e){this.name=e}toString(){return this.name}}),Jo=(qo.POSITIONABLE=new qo("positionable"),qo.DRAG_TARGET=new qo("drag_target"),qo.DELETE_AREA=new qo("delete_area"),qo.AUTOHIDEABLE=new qo("autohideable"),class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(e,t){var r,n=e.component.id;if(!t&&this.componentData.has(n))throw Error('Plugin "'+n+'" with capabilities "'+(null==(r=this.componentData.get(n))?void 0:r.capabilities)+'" already added.');for(this.componentData.set(n,e),t=[],r=0;r<e.capabilities.length;r++){var i,s=String(e.capabilities[r]).toLowerCase();t.push(s),this.capabilityToComponentIds.has(s)?null!=(i=this.capabilityToComponentIds.get(s))&&i.push(n):this.capabilityToComponentIds.set(s,[n])}this.componentData.get(n).capabilities=t}removeComponent(t){var r=this.componentData.get(t);if(r){for(let e=0;e<r.capabilities.length;e++){var n=String(r.capabilities[e]).toLowerCase();fe(this.capabilityToComponentIds.get(n),t)}this.componentData.delete(t)}}addCapability(e,t){if(!this.getComponent(e))throw Error('Cannot add capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');var r;this.hasCapability(e,t)?console.warn('Plugin "'+e+'already has capability "'+t+'"'):(t=(""+t).toLowerCase(),null!=(r=this.componentData.get(e))&&r.capabilities.push(t),null!=(r=this.capabilityToComponentIds.get(t))&&r.push(e))}removeCapability(e,t){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,t)?(t=(""+t).toLowerCase(),fe(this.componentData.get(e).capabilities,t),fe(this.capabilityToComponentIds.get(t),e)):console.warn('Plugin "'+e+"doesn't have capability \""+t+'" to remove')}hasCapability(e,t){return t=(""+t).toLowerCase(),this.componentData.has(e)&&this.componentData.get(e).capabilities.includes(t)}getComponent(e){return null==(e=this.componentData.get(e))?void 0:e.component}getComponents(e,t){if(e=(""+e).toLowerCase(),!(e=this.capabilityToComponentIds.get(e)))return[];let r=[];if(t){let t=[];e.forEach(e=>{t.push(this.componentData.get(e))}),t.sort(function(e,t){return e.weight-t.weight}),t.forEach(function(e){r.push(e.component)})}else e.forEach(e=>{r.push(this.componentData.get(e).component)});return r}}),Yo=(Jo.Capability=qo,(t=(t=Jo=Jo||{}).ComponentWeight||(t.ComponentWeight={}))[t.TOOLBOX_WEIGHT=0]="TOOLBOX_WEIGHT",t[t.FLYOUT_WEIGHT=1]="FLYOUT_WEIGHT",t[t.TRASHCAN_WEIGHT=2]="TRASHCAN_WEIGHT",t[t.ZOOM_CONTROLS_WEIGHT=3]="ZOOM_CONTROLS_WEIGHT",Jo.ComponentWeight,!1),Xo='\n.blocklySvg {\n  background-color: #fff;\n  outline: none;\n  overflow: hidden;  /* IE overflows by default. */\n  position: absolute;\n  display: block;\n}\n\n.blocklyWidgetDiv {\n  display: none;\n  position: absolute;\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\n}\n\n.injectionDiv {\n  height: 100%;\n  position: relative;\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\n  touch-action: none;\n  user-select: none;\n  -webkit-user-select: none;\n}\n\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\n  transition: transform .5s;\n}\n\n.blocklyEmboss {\n  filter: var(--blocklyEmbossFilter);\n}\n\n.blocklyTooltipDiv {\n  background-color: #ffffc7;\n  border: 1px solid #ddc;\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n  color: #000;\n  display: none;\n  font: 9pt sans-serif;\n  opacity: .9;\n  padding: 2px;\n  position: absolute;\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\n}\n\n.blocklyDropDownDiv {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1000;\n  display: none;\n  border: 1px solid;\n  border-color: #dadce0;\n  background-color: #fff;\n  border-radius: 2px;\n  padding: 4px;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv:focus {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownContent {\n  max-height: 300px;  /* @todo: spec for maximum height. */\n}\n\n.blocklyDropDownArrow {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 16px;\n  height: 16px;\n  z-index: -1;\n  background-color: inherit;\n  border-color: inherit;\n  border-top: 1px solid;\n  border-left: 1px solid;\n  border-top-left-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyHighlighted>.blocklyPath {\n  filter: var(--blocklyEmbossFilter);\n}\n\n.blocklyHighlightedConnectionPath {\n  fill: none;\n  stroke: #fc3;\n  stroke-width: 4px;\n}\n\n.blocklyPathLight {\n  fill: none;\n  stroke-linecap: round;\n  stroke-width: 1;\n}\n\n.blocklySelected>.blocklyPathLight {\n  display: none;\n}\n\n.blocklyDraggable {\n  cursor: grab;\n  cursor: -webkit-grab;\n}\n\n.blocklyDragging {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n  /* Drag surface disables events to not block the toolbox, so we have to\n   * reenable them here for the cursor values to work. */\n  pointer-events: auto;\n}\n\n  /* Changes cursor on mouse down. Not effective in Firefox because of\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n.blocklyDraggable:active {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n.blocklyDragging.blocklyDraggingDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyDragging>.blocklyPath,\n.blocklyDragging>.blocklyPathLight {\n  fill-opacity: .8;\n  stroke-opacity: .8;\n}\n\n.blocklyDragging>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyDisabledPattern>.blocklyPath {\n  fill: var(--blocklyDisabledPattern);\n  fill-opacity: .5;\n  stroke-opacity: .5;\n}\n\n.blocklyDisabled>.blocklyPathLight,\n.blocklyDisabled>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyInsertionMarker>.blocklyPath,\n.blocklyInsertionMarker>.blocklyPathLight,\n.blocklyInsertionMarker>.blocklyPathDark {\n  fill-opacity: .2;\n  stroke: none;\n}\n\n.blocklyNonEditableField>text {\n  pointer-events: none;\n}\n\n.blocklyFlyout {\n  position: absolute;\n  z-index: 20;\n}\n\n.blocklyText text {\n  cursor: default;\n}\n\n/*\n  Don\'t allow users to select text.  It gets annoying when trying to\n  drag a block and selected text moves instead.\n*/\n.blocklySvg text {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  cursor: inherit;\n}\n\n.blocklyIconGroup {\n  cursor: default;\n}\n\n.blocklyIconGroup:not(:hover),\n.blocklyIconGroupReadonly {\n  opacity: .6;\n}\n\n.blocklyIconShape {\n  fill: #00f;\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.blocklyIconSymbol {\n  fill: #fff;\n}\n\n.blocklyMinimalBody {\n  margin: 0;\n  padding: 0;\n  height: 100%;\n}\n\n.blocklyHtmlInput {\n  border: none;\n  border-radius: 4px;\n  height: 100%;\n  margin: 0;\n  outline: none;\n  padding: 0;\n  width: 100%;\n  text-align: center;\n  display: block;\n  box-sizing: border-box;\n}\n\n/* Remove the increase and decrease arrows on the field number editor */\ninput.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,\ninput.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\n.blocklyMainBackground {\n  stroke-width: 1;\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n}\n\n.blocklyMutatorBackground {\n  fill: #fff;\n  stroke: #ddd;\n  stroke-width: 1;\n}\n\n.blocklyFlyoutBackground {\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyMainWorkspaceScrollbar {\n  z-index: 20;\n}\n\n.blocklyFlyoutScrollbar {\n  z-index: 30;\n}\n\n.blocklyScrollbarHorizontal,\n.blocklyScrollbarVertical {\n  position: absolute;\n  outline: none;\n}\n\n.blocklyScrollbarBackground {\n  opacity: 0;\n  pointer-events: none;\n}\n\n.blocklyScrollbarHandle {\n  fill: #ccc;\n}\n\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyScrollbarHandle:hover {\n  fill: #bbb;\n}\n\n/* Darken flyout scrollbars due to being on a grey background. */\n/* By contrast, workspace scrollbars are on a white background. */\n.blocklyFlyout .blocklyScrollbarHandle {\n  fill: #bbb;\n}\n\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyFlyout .blocklyScrollbarHandle:hover {\n  fill: #aaa;\n}\n\n.blocklyInvalidInput {\n  background: #faa;\n}\n\n.blocklyVerticalMarker {\n  stroke-width: 3px;\n  fill: rgba(255,255,255,.5);\n  pointer-events: none;\n}\n\n.blocklyComputeCanvas {\n  position: absolute;\n  width: 0;\n  height: 0;\n}\n\n.blocklyNoPointerEvents {\n  pointer-events: none;\n}\n\n.blocklyContextMenu {\n  border-radius: 4px;\n  max-height: 100%;\n}\n\n.blocklyDropdownMenu {\n  border-radius: 2px;\n  padding: 0 !important;\n}\n\n.blocklyDropdownMenu .blocklyMenuItem {\n  /* 28px on the left for icon or checkbox. */\n  padding-left: 28px;\n}\n\n/* BiDi override for the resting state. */\n.blocklyDropdownMenu .blocklyMenuItemRtl {\n  /* Flip left/right padding for BiDi. */\n  padding-left: 5px;\n  padding-right: 28px;\n}\n\n.blocklyWidgetDiv .blocklyMenu {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background: #fff;\n  border: 1px solid transparent;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  font: normal 13px Arial, sans-serif;\n  margin: 0;\n  outline: none;\n  padding: 4px 0;\n  position: absolute;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n.blocklyWidgetDiv .blocklyMenu:focus {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv .blocklyMenu {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;\n  outline: none;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n/* State: resting. */\n.blocklyMenuItem {\n  border: none;\n  color: #000;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  /* 7em on the right for shortcut. */\n  min-width: 7em;\n  padding: 6px 15px;\n  white-space: nowrap;\n}\n\n/* State: disabled. */\n.blocklyMenuItemDisabled {\n  color: #ccc;\n  cursor: inherit;\n}\n\n/* State: hover. */\n.blocklyMenuItemHighlight {\n  background-color: rgba(0,0,0,.1);\n}\n\n/* State: selected/checked. */\n.blocklyMenuItemCheckbox {\n  height: 16px;\n  position: absolute;\n  width: 16px;\n}\n\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n  float: left;\n  margin-left: -24px;\n  position: static;  /* Scroll with the menu. */\n}\n\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n  float: right;\n  margin-right: -24px;\n}\n\n.blocklyMenuSeparator {\n  background-color: #ccc;\n  height: 1px;\n  border: 0;\n  margin-left: 4px;\n  margin-right: 4px;\n}\n\n.blocklyBlockDragSurface, .blocklyAnimationLayer {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: visible !important;\n  z-index: 80;\n  pointer-events: none;\n}\n\n.blocklyField {\n  cursor: default;\n}\n\n.blocklyInputField {\n  cursor: text;\n}\n\n.blocklyDragging .blocklyField,\n.blocklyDragging .blocklyIconGroup {\n  cursor: grabbing;\n}\n\n.blocklyActiveFocus:is(\n  .blocklyFlyout,\n  .blocklyWorkspace,\n  .blocklyField,\n  .blocklyPath,\n  .blocklyHighlightedConnectionPath,\n  .blocklyComment,\n  .blocklyBubble,\n  .blocklyIconGroup,\n  .blocklyTextarea\n) {\n  outline: none;\n}\n',Zo={},k=(Zo.inject=ye,Zo.register=_e,class{constructor(e,t){this.x=e,this.y=t}clone(){return new k(this.x,this.y)}scale(e){return this.x*=e,this.y*=e,this}translate(e,t){return this.x+=e,this.y+=t,this}static equals(e,t){return e===t||!(!e||!t)&&e.x===t.x&&e.y===t.y}static distance(e,t){var r=e.x-t.x;return e=e.y-t.y,Math.sqrt(r*r+e*e)}static magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static difference(e,t){return new k(e.x-t.x,e.y-t.y)}static sum(e,t){return new k(e.x+t.x,e.y+t.y)}}),x=class{constructor(e){this.tagName=e}toString(){return this.tagName}},E=(x.ANIMATE=new x("animate"),x.CIRCLE=new x("circle"),x.CLIPPATH=new x("clipPath"),x.DEFS=new x("defs"),x.FECOMPOSITE=new x("feComposite"),x.FECOMPONENTTRANSFER=new x("feComponentTransfer"),x.FEFLOOD=new x("feFlood"),x.FEFUNCA=new x("feFuncA"),x.FEGAUSSIANBLUR=new x("feGaussianBlur"),x.FEPOINTLIGHT=new x("fePointLight"),x.FESPECULARLIGHTING=new x("feSpecularLighting"),x.FILTER=new x("filter"),x.FOREIGNOBJECT=new x("foreignObject"),x.G=new x("g"),x.IMAGE=new x("image"),x.LINE=new x("line"),x.PATH=new x("path"),x.PATTERN=new x("pattern"),x.POLYGON=new x("polygon"),x.RECT=new x("rect"),x.SVG=new x("svg"),x.TEXT=new x("text"),x.TSPAN=new x("tspan"),class{constructor(e,t,r,n){this.top=e,this.bottom=t,this.left=r,this.right=n}static from(e){return new E(e.y,e.y+e.height,e.x,e.x+e.width)}clone(){return new E(this.top,this.bottom,this.left,this.right)}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}getOrigin(){return new k(this.left,this.top)}contains(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom}intersects(e){return this.left<=e.right&&this.right>=e.left&&this.bottom>=e.top&&this.top<=e.bottom}static equals(e,t){return e===t||!(!e||!t)&&e.top===t.top&&e.bottom===t.bottom&&e.left===t.left&&e.right===t.right}static createFromPoint(e,t,r){var n=e.x;return new E(e=e.y,e+r,n,n+t)}}),S=class{constructor(e,t){this.width=e,this.height=t}static equals(e,t){return e===t||!(!e||!t)&&e.width===t.width&&e.height===t.height}static max(e,t){return new S(Math.max(e.width,t.width),Math.max(e.height,t.height))}static min(e,t){return new S(Math.min(e.width,t.width),Math.min(e.height,t.height))}},Qo={getSizeInternal:ml},el={TEST_ONLY:Qo},tl=(el.getBorderBox=Ee,el.getComputedStyle=Te,el.getContainerOffsetToScrollInto=Ce,el.getPageOffset=ke,el.getSize=be,el.getViewportPageOffset=xe,el.scrollIntoContainerView=Se,/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/),rl=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,r={TEST_ONLY:{XY_REGEX:tl,XY_STYLE_REGEX:rl}},nl=(r.getDocumentScroll=De,r.getInjectionDivXY=Ie,r.getRelativeXY=we,r.getViewportBBox=Ae,r.screenToWsCoordinates=Ne,r.wsToScreenCoordinates=Oe,class{constructor(e,t,r,n,i){this.workspace=e,this.horizontal=t,this.oldHostMetrics=null,this.ratio=1,this.origin=new k(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new k(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=r||!1,this.margin=void 0!==i?i:nl.DEFAULT_SCROLLBAR_MARGIN,e="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),n&&(e+=" "+n),this.outerSvg=l(x.SVG,{class:e}),n=l(x.G,{},this.outerSvg),this.svgBackground=l(x.RECT,{class:"blocklyScrollbarBackground"},n),e=Math.floor((nl.scrollbarThickness-5)/2),this.svgHandle=l(x.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},n),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),z(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),t?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=h(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=h(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){var e=nl.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(e)),this.outerSvg.setAttribute("height",String(e)),this.svgHandle.setAttribute("height",String(e-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(e)),this.outerSvg.setAttribute("width",String(e)),this.svgHandle.setAttribute("width",String(e-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),s(this.onMouseDownBarWrapper_),s(this.onMouseDownHandleWrapper_),o(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(e){return e<=0||isNaN(e)?0:Math.min(e,this.scrollbarLength)}setHandleLength(e){this.handleLength=e,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(e){return e<=0||isNaN(e)?0:Math.min(e,this.scrollbarLength-this.handleLength)}setHandlePosition(e){this.handlePosition=e,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(e){this.scrollbarLength=e,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(e,t){this.position.x=e,this.position.y=t,W(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(e){!e&&!(e=this.workspace.getMetrics())||this.oldHostMetrics&&nl.metricsAreEquivalent(e,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(e):this.resizeVertical(e),this.oldHostMetrics=e,this.updateMetrics())}requiresViewResize(e){return!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics.absoluteTop!==e.absoluteTop}resizeHorizontal(e){this.requiresViewResize(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)}resizeViewHorizontal(e){var t=e.viewWidth-2*this.margin;this.pair&&(t-=nl.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),t=e.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(t+=nl.scrollbarThickness),this.setPosition(t,e.absoluteTop+e.viewHeight-nl.scrollbarThickness-this.margin),this.resizeContentHorizontal(e)}resizeContentHorizontal(e){var t,r;e.viewWidth>=e.scrollWidth?(this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1)):(this.pair||this.setVisible(!0),t=this.scrollbarLength*e.viewWidth/e.scrollWidth,t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollWidth-e.viewWidth,r=this.scrollbarLength-this.handleLength,e=this.constrainHandlePosition(e=(e.viewLeft-e.scrollLeft)/t*r),this.setHandlePosition(e),this.ratio=r/t)}resizeVertical(e){this.requiresViewResize(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)}resizeViewVertical(e){let t=e.viewHeight-2*this.margin;this.pair&&(t-=nl.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),this.setPosition(this.workspace.RTL?e.absoluteLeft+this.margin:e.absoluteLeft+e.viewWidth-nl.scrollbarThickness-this.margin,e.absoluteTop+this.margin),this.resizeContentVertical(e)}resizeContentVertical(e){var t,r;e.viewHeight>=e.scrollHeight?(this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1)):(this.pair||this.setVisible(!0),t=this.scrollbarLength*e.viewHeight/e.scrollHeight,t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollHeight-e.viewHeight,r=this.scrollbarLength-this.handleLength,e=this.constrainHandlePosition(e=(e.viewTop-e.scrollTop)/t*r),this.setHandlePosition(e),this.ratio=r/t)}isVisible(){return this.isHandleVisible}setContainerVisible(e){var t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay_()}setVisible(e){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(e)}setVisibleInternal(e){var t=e!==this.isVisible();this.isHandleVisible=e,t&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(e){var t,r,n,i;this.workspace.markFocused(),_a(),this.cleanUp(),xa(e)?e.stopPropagation():(t=Ea(e,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM()),t=this.horizontal?t.x:t.y,r=Ie(this.svgHandle),r=this.horizontal?r.x:r.y,n=this.handlePosition,i=.95*this.handleLength,t<=r?n-=i:t>=r+this.handleLength&&(n+=i),this.setHandlePosition(this.constrainHandlePosition(n)),this.updateMetrics(),e.stopPropagation(),e.preventDefault())}onMouseDownHandle(e){this.workspace.markFocused(),this.cleanUp(),xa(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?e.clientX:e.clientY,this.onMouseUpWrapper_=h(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=h(document,"pointermove",this,this.onMouseMoveHandle),e.stopPropagation(),e.preventDefault())}onMouseMoveHandle(e){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?e.clientX:e.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){_a(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(s(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(s(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let e=this.handlePosition/(this.scrollbarLength-this.handleLength);return e=isNaN(e)?0:e}updateMetrics(){var e=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:e}):this.workspace.setMetrics({y:e})}set(e,t){this.setHandlePosition(this.constrainHandlePosition(e*this.ratio)),!t&&void 0!==t||this.updateMetrics()}setOrigin(e,t){this.origin=new k(e,t)}static metricsAreEquivalent(e,t){return e.viewWidth===t.viewWidth&&e.viewHeight===t.viewHeight&&e.viewLeft===t.viewLeft&&e.viewTop===t.viewTop&&e.absoluteTop===t.absoluteTop&&e.absoluteLeft===t.absoluteLeft&&e.scrollWidth===t.scrollWidth&&e.scrollHeight===t.scrollHeight&&e.scrollLeft===t.scrollLeft&&e.scrollTop===t.scrollTop}}),il=(nl.scrollbarThickness=Ha?25:15,nl.DEFAULT_SCROLLBAR_MARGIN=.5,{parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}}),sl={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:al,DOMParser:ol,XMLSerializer:ll}=globalThis,cl=(ol&&(il=new ol),ll&&(sl=new ll),"https://developers.google.com/blockly/xml"),ul=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,qo={NAME_SPACE:cl},dl=(qo.createElement=f.createElement$$module$build$src$core$utils$xml,qo.createTextNode=f.createTextNode$$module$build$src$core$utils$xml,qo.domToText=Re,qo.injectDependencies=yl,qo.textToDom=f.textToDom$$module$build$src$core$utils$xml,"categoryToolbox"),pl="flyoutToolbox",hl=((t=b=b||{})[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT",{hasCategoriesInternal:gl}),ml={},gl=(ml.Position=b,ml.TEST_ONLY=hl,ml.convertFlyoutDefToJsonArray=Fe,ml.convertToolboxDefToJson=Pe,ml.hasCategories=Be,ml.isCategoryCollapsible=$e,ml.parseToolboxTree=Ge,(Ha=Za=Za||{})[Ha.TOP=0]="TOP",Ha[Ha.BOTTOM=1]="BOTTOM",(yl=Qa=Qa||{})[yl.LEFT=0]="LEFT",yl[yl.RIGHT=1]="RIGHT",(t=eo=eo||{})[t.UP=0]="UP",t[t.DOWN=1]="DOWN",{}),fl=(gl.bumpDirection=eo,gl.bumpPositionRect=ze,gl.getCornerOppositeToolbox=Ke,gl.getStartPositionRect=je,gl.horizontalPosition=Qa,gl.verticalPosition=Za,{width:96,height:124,url:"sprites.png"}),_l=class{constructor(e){this.workspace=e,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=l(x.G,{});var e=String(Math.random()).substring(2);return this.createZoomOutSvg(e),this.createZoomInSvg(e),this.workspace.isMovable()&&this.createZoomResetSvg(e),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:Jo.ComponentWeight.ZOOM_CONTROLS_WEIGHT,capabilities:[Jo.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&o(this.svgGroup);for(var e of this.boundEvents)s(e);this.boundEvents.length=0}getBoundingRectangle(){let e=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(e+=this.LARGE_SPACING+this.HEIGHT),new E(this.top,this.top+e,this.left,this.left+this.WIDTH)}position(e,t){var r,n,i,s;this.initialized&&(r=Ke(this.workspace,e),i=this.SMALL_SPACING+2*this.HEIGHT,this.zoomResetGroup&&(i+=this.LARGE_SPACING+this.HEIGHT),e=je(r,new S(this.WIDTH,i),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,e,this.workspace),r=r.vertical,t=ze(e,this.MARGIN_VERTICAL,r===Za.TOP?eo.DOWN:eo.UP,t),r===Za.TOP?(n=this.SMALL_SPACING+this.HEIGHT,null!=(s=this.zoomInGroup)&&s.setAttribute("transform","translate(0, "+n+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(n+this.LARGE_SPACING+this.HEIGHT)+")")):(s=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0,null!=(i=this.zoomInGroup)&&i.setAttribute("transform","translate(0, "+s+")"),s=s+this.SMALL_SPACING+this.HEIGHT,null!=(n=this.zoomOutGroup)&&n.setAttribute("transform","translate(0, "+s+")")),this.top=t.top,this.left=t.left,null!=(e=this.svgGroup))&&e.setAttribute("transform","translate("+this.left+","+this.top+")")}createZoomOutSvg(e){this.zoomOutGroup=l(x.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);var t=l(x.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup);l(x.RECT,{width:32,height:32},t),l(x.IMAGE,{width:fl.width,height:fl.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup).setAttributeNS(Oo,"xlink:href",this.workspace.options.pathToMedia+fl.url),this.boundEvents.push(h(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(e){this.zoomInGroup=l(x.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);var t=l(x.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup);l(x.RECT,{width:32,height:32},t),l(x.IMAGE,{width:fl.width,height:fl.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup).setAttributeNS(Oo,"xlink:href",this.workspace.options.pathToMedia+fl.url),this.boundEvents.push(h(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(e,t){this.workspace.markFocused(),this.workspace.zoomCenter(e),this.fireZoomEvent(),_a(),t.stopPropagation(),t.preventDefault()}createZoomResetSvg(e){this.zoomResetGroup=l(x.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);var t=l(x.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup);l(x.RECT,{width:32,height:32},t),l(x.IMAGE,{width:fl.width,height:fl.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup).setAttributeNS(Oo,"xlink:href",this.workspace.options.pathToMedia+fl.url),this.boundEvents.push(h(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(e){this.workspace.markFocused();var t=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(t),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),_a(),e.stopPropagation(),e.preventDefault()}fireZoomEvent(){var e=new(g(y.CLICK))(null,this.workspace.id,"zoom_controls");m(e)}},Ha=(_e("\n.blocklyZoom>image, .blocklyZoom>svg>image {\n  opacity: .4;\n}\n\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n  opacity: .8;\n}\n"),{BLOCKS:50,PROCEDURES:75,VARIABLES:100,WORKSPACE_COMMENTS:25}),yl={},t=(yl.register=Zh,yl.unregister=bl,class{constructor(){this.priority=25}save(e){var t,r=[];for(t of e.getTopComments())(e=We(t,{addCoordinates:!0,saveIds:!0}))&&r.push(e);return r.length?r:null}load(e,t){for(var r of e)qe(r,t,{recordUndo:So})}clear(e){for(var t of e.getTopComments())t.dispose()}}),bl=(Zh("workspaceComments",new t),{}),t=(bl.WorkspaceCommentSerializer=t,bl.append=qe,bl.save=We,{}),vl=(t.register=uh,t.unregister=C,class{paste(e,t,r){e=e.commentState,r&&(e.x=r.x,e.y=r.y),f.disable$$module$build$src$core$events$utils();let n;try{n=qe(e,t),Je(n)}finally{f.enable$$module$build$src$core$events$utils()}return n?(U()&&m(new(g(y.COMMENT_CREATE))(n)),f.getFocusManager$$module$build$src$core$focus_manager().focusNode(n),n):null}}),Tl=(uh(vl.TYPE="workspace-comment",new vl),f.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:28,connectingSnapRadius:28,currentConnectionPreference:8,bumpDelay:250},f.config$$module$build$src$core$config,"aria-"),kl="role",C=((C=to=to||{}).GRID="grid",C.GRIDCELL="gridcell",C.GROUP="group",C.LISTBOX="listbox",C.MENU="menu",C.MENUITEM="menuitem",C.MENUITEMCHECKBOX="menuitemcheckbox",C.OPTION="option",C.PRESENTATION="presentation",C.ROW="row",C.TREE="tree",C.TREEITEM="treeitem",C.SEPARATOR="separator",C.STATUS="status",(C=ro=ro||{}).ACTIVEDESCENDANT="activedescendant",C.COLCOUNT="colcount",C.DISABLED="disabled",C.EXPANDED="expanded",C.INVALID="invalid",C.LABEL="label",C.LABELLEDBY="labelledby",C.LEVEL="level",C.ORIENTATION="orientation",C.POSINSET="posinset",C.ROWCOUNT="rowcount",C.SELECTED="selected",C.SETSIZE="setsize",C.VALUEMAX="valuemax",C.VALUEMIN="valuemin",C.LIVE="live",C.HIDDEN="hidden",{}),xl=(C.Role=to,C.State=ro,C.setRole=Xe,C.setState=Ze,class{constructor(e,t){this.content=e,this.opt_value=t,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){var e,t=document.createElement("div"),r=(t.id=Ca(),(this.element=t).className="blocklyMenuItem "+(this.enabled?"":"blocklyMenuItemDisabled ")+(this.checked?"blocklyMenuItemSelected ":"")+(this.highlight?"blocklyMenuItemHighlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl ":""),document.createElement("div"));return r.className="blocklyMenuItemContent",this.checkable&&((e=document.createElement("div")).className="blocklyMenuItemCheckbox ",r.appendChild(e)),e=this.content,"string"==typeof this.content&&(e=document.createTextNode(this.content)),r.appendChild(e),t.appendChild(r),this.roleName&&Xe(t,this.roleName),Ze(t,ro.SELECTED,this.checkable&&this.checked||!1),Ze(t,ro.DISABLED,!this.enabled),t}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){var e;return null!=(e=this.opt_value)?e:null}setRightToLeft(e){this.rightToLeft=e}setRole(e){this.roleName=e}setCheckable(e){this.checkable=e}setChecked(e){this.checked=e}setHighlighted(e){this.highlight=e;var t=this.getElement();t&&this.isEnabled()&&(e?c:a)(t,"blocklyMenuItemHighlight")}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}performAction(e){this.isEnabled()&&this.actionHandler&&this.actionHandler(this,e)}onAction(e,t){this.actionHandler=e.bind(t)}}),El=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.pointerLeaveHandler=this.pointerEnterHandler=this.clickHandler=this.pointerMoveHandler=this.highlightedItem=this.openingCoords=null}addChild(e){this.menuItems.push(e)}render(e){var r=document.createElement("div");r.className="blocklyMenu",r.tabIndex=0,this.roleName&&Xe(r,this.roleName),this.element=r;for(let e=0,t;t=this.menuItems[e];e++)r.appendChild(t.createDom());return this.pointerMoveHandler=h(r,"pointermove",this,this.handlePointerMove,!0),this.clickHandler=h(r,"pointerup",this,this.handleClick,!0),this.pointerEnterHandler=h(r,"pointerenter",this,this.handlePointerEnter,!0),this.pointerLeaveHandler=h(r,"pointerleave",this,this.handlePointerLeave,!0),this.onKeyDownHandler=h(r,"keydown",this,this.handleKeyEvent),e.appendChild(r),r}getElement(){return this.element}focus(){var e=this.getElement();e&&e.focus({preventScroll:!0})}blur(){var e=this.getElement();e&&e.blur()}setRole(e){this.roleName=e}dispose(){this.pointerMoveHandler&&(s(this.pointerMoveHandler),this.pointerMoveHandler=null),this.clickHandler&&(s(this.clickHandler),this.clickHandler=null),this.pointerEnterHandler&&(s(this.pointerEnterHandler),this.pointerEnterHandler=null),this.pointerLeaveHandler&&(s(this.pointerLeaveHandler),this.pointerLeaveHandler=null),this.onKeyDownHandler&&(s(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let e=0,t;t=this.menuItems[e];e++)t.dispose();this.element=null}getMenuItem(r){for(var e=this.getElement();r&&r!==e;){if(r.classList.contains("blocklyMenuItem")){var n=this.getMenuItems();for(let e=0,t;t=n[e];e++)if(t.getElement()===r)return t}r=r.parentElement}return null}setHighlighted(e){var t,r=this.highlightedItem;r&&(r.setHighlighted(!1),this.highlightedItem=null),e&&(e.setHighlighted(!0),this.highlightedItem=e,r=this.getElement(),t=e.getElement(),r)&&t&&(Se(t,r),Ze(r,ro.ACTIVEDESCENDANT,e.getId()))}highlightNext(){var e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e,1)}highlightPrevious(){var e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e<0?this.menuItems.length:e,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(e,t){e+=t;for(var r,n=this.getMenuItems();r=n[e];){if(r.isEnabled()){this.setHighlighted(r);break}e+=t}}handlePointerMove(e){0!==Math.max(Math.abs(e.movementX),Math.abs(e.movementY))&&(e=this.getMenuItem(e.target))&&(e.isEnabled()?this.highlightedItem!==e&&this.setHighlighted(e):this.setHighlighted(null))}handleClick(e){var t=this.openingCoords;if(this.openingCoords=null,t&&"number"==typeof e.clientX){var r=new k(e.clientX,e.clientY);if(k.distance(t,r)<1)return}(t=this.getMenuItem(e.target))&&t.performAction(e)}handlePointerEnter(e){this.focus()}handlePointerLeave(e){this.getElement()&&this.setHighlighted(null)}handleKeyEvent(e){if(this.menuItems.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var t=this.highlightedItem;switch(e.key){case"Enter":case" ":t&&t.performAction(e);break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}e.preventDefault(),e.stopPropagation()}}getSize(){var e=this.getElement(),t=be(e);return t.height=e.scrollHeight,t}getMenuItems(){return this.menuItems.filter(e=>e instanceof xl)}},Sl=class{constructor(){this.element=null}createDom(){return this.element=document.createElement("hr"),this.element.className="blocklyMenuSeparator",Xe(this.element,to.SEPARATOR),this.element}dispose(){var e;null!=(e=this.element)&&e.remove(),this.element=null}},Cl="_TEMP_COLLAPSED_INPUT",wl="_TEMP_COLLAPSED_FIELD",Il="MANUALLY_DISABLED",Al={COLLAPSED_FIELD_NAME:wl,COLLAPSED_INPUT_NAME:Cl,MANUALLY_DISABLED:Il},Dl=((Ml=f.inputTypes$$module$build$src$core$inputs$input_types||(f.inputTypes$$module$build$src$core$inputs$input_types={}))[Ml.VALUE=1]="VALUE",Ml[Ml.STATEMENT=3]="STATEMENT",Ml[Ml.DUMMY=5]="DUMMY",Ml[Ml.CUSTOM=6]="CUSTOM",Ml[Ml.END_ROW=7]="END_ROW",f.inputTypes$$module$build$src$core$inputs$input_types,new Set),Nl=new WeakSet,Ol=new WeakMap,Rl=null,Ll=null,Pl=0,Ml={},Fl=(Ml.finishQueuedRenders=tt,Ml.queueRender=et,Ml.triggerQueuedRenders=rt,f.Msg$$module$build$src$core$msg=Object.create(null),Yd={Msg:f.Msg$$module$build$src$core$msg,setLocale:no=function(t){Object.keys(t).forEach(function(e){f.Msg$$module$build$src$core$msg[e]=t[e]})}},"blocklyToast"),Bl="blocklyToastMessage",$l="blocklyToastCloseButton",Ul=class{static show(e,t){if(t.oncePerSession&&t.id){if(this.shownIds.has(t.id))return;this.shownIds.add(t.id)}this.hide(e);let r=this.createDom(e,t);requestAnimationFrame(()=>{r.style.bottom="2rem"})}static createDom(e,t){let{message:r,duration:n=5,assertiveness:i=Ul.Assertiveness.POLITE}=t,s=document.createElement("div");e.getInjectionDiv().appendChild(s),s.dataset.toastId=t.id,s.className=Fl,Xe(s,to.STATUS),Ze(s,ro.LIVE,i),(t=s.appendChild(document.createElement("div"))).className=Bl,t.innerText=r,(t=s.appendChild(document.createElement("button"))).className=$l,Ze(t,ro.LABEL,f.Msg$$module$build$src$core$msg.CLOSE);var a=l(x.SVG,{width:24,height:24,viewBox:"0 0 24 24",fill:"none"},t);Ze(a,ro.HIDDEN,!0),l(x.RECT,{x:19.7782,y:2.80762,width:2,height:24,transform:"rotate(45, 19.7782, 2.80762)",fill:"black"},a),l(x.RECT,{x:2.80762,y:4.22183,width:2,height:24,transform:"rotate(-45, 2.80762, 4.22183)",fill:"black"},a),t.addEventListener("click",()=>{s.remove(),e.markFocused()});let o;return t=()=>{o=setTimeout(()=>s.remove(),1e3*n)},a=()=>clearTimeout(o),s.addEventListener("focusin",a),s.addEventListener("focusout",t),s.addEventListener("mouseenter",a),s.addEventListener("mousemove",a),s.addEventListener("mouseleave",t),t(),s}static hide(e,t){(e=e.getInjectionDiv().querySelector("."+Fl))instanceof HTMLElement&&(!t||t===e.dataset.toastId)&&e.remove()}},Vl=(Ul.shownIds=new Set,(Jl=(Jl=Ul=Ul||{}).Assertiveness||(Jl.Assertiveness={})).ASSERTIVE="assertive",Jl.POLITE="polite",_e(`
.${Fl} {
  font-size: 1.2rem;
  position: absolute;
  bottom: -10rem;
  right: 2rem;
  padding: 1rem;
  color: black;
  background-color: white;
  border: 2px solid black;
  border-radius: 0.4rem;
  z-index: 999;
  display: flex;
  align-items: center;
  gap: 0.8rem;
  line-height: 1.5;
  transition: bottom 0.3s ease-out;
}

.${Fl} .${Bl} {
  maxWidth: 18rem;
}

.${Fl} .${$l} {
  margin: 0;
  padding: 0.2rem;
  background-color: transparent;
  color: black;
  border: none;
  cursor: pointer;
}
`),function(e,t){window.alert(e),t&&t()}),Hl=Vl,Gl=function(e,t){t(window.confirm(e))},jl=Gl,Kl=function(e,t,r){r(window.prompt(e,t))},zl=Kl,Wl=Ul.show.bind(Ul),ql=Wl,Jl={},Yl=(Jl.alert=ct,Jl.confirm=ut,Jl.prompt=dt,Jl.setAlert=w,Jl.setConfirm=tc,Jl.setPrompt=oc,Jl.setToast=lc,Jl.toast=cc,new Set),w={},Xl=(w.warn=gt,"VARIABLE"),Zl="ijkmnopqrstuvwxyzabcdefgh",Ql={generateUniqueNameInternal:hc},ec={CATEGORY_NAME:Xl,TEST_ONLY:Ql,VAR_LETTER_OPTIONS:Zl},tc=(ec.allDeveloperVariables=f.allDeveloperVariables$$module$build$src$core$variables,ec.allUsedVarModels=f.allUsedVarModels$$module$build$src$core$variables,ec.compareByName=Lt,ec.createVariableButtonHandler=Et,ec.deleteVariable=f.deleteVariable$$module$build$src$core$variables,ec.flyoutCategory=_t,ec.flyoutCategoryBlocks=Tt,ec.generateUniqueName=kt,ec.generateUniqueNameFromOptions=xt,ec.generateVariableFieldDom=Nt,ec.getAddedVariables=Rt,ec.getOrCreateVariablePackage=f.getOrCreateVariablePackage$$module$build$src$core$variables,ec.getVariable=f.getVariable$$module$build$src$core$variables,ec.getVariableUsesById=Pt,ec.internalFlyoutCategory=ft,ec.jsonFlyoutCategoryBlocks=bt,ec.nameUsedWithAnyType=wt,ec.nameUsedWithConflictingParam=It,ec.promptName=St,ec.renameVariable=f.renameVariable$$module$build$src$core$variables,class extends Error{}),rc=class extends tc{constructor(e){super("Expected to find a 'type' property, defining the block type"),this.state=e}},nc=class extends tc{constructor(e,t,r){super(`The block ${t.toDevString()} is missing a(n) ${e}
connection`),this.block=t,this.state=r}},ic=class extends tc{constructor(e,t,r,n){super(`The block ${r.toDevString()} could not connect its
${t} to its parent, because: `+e),this.childBlock=r,this.childState=n}},sc=class extends tc{constructor(e){super("Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren"),this.state=e}},ac=class extends tc{constructor(e,t,r){super(`Cannot add an icon of type '${e}' to the block `+t.toDevString()+", because there is no icon registered with "+`type '${e}'. Make sure that all of your icons have been `+"registered."),this.block=t,this.state=r}},oc={},lc=(oc.BadConnectionCheck=ic,oc.DeserializationError=tc,oc.MissingBlockType=rc,oc.MissingConnection=nc,oc.RealChildOfShadow=sc,oc.UnregisteredIcon=ac,class{constructor(){this.priority=50}save(e){var t,r=[];for(t of e.getTopBlocks(!1))(e=Mt(t,{addCoordinates:!0,doFullSerialization:!1}))&&r.push(e);return r.length?{languageVersion:0,blocks:r}:null}load(e,t){for(var r of e=e.blocks)Kt(r,t,{recordUndo:So})}clear(e){for(var t of e.getTopBlocks(!1))t.dispose(!1)}}),cc=(Zh("blocks",new lc),{}),uc=(cc.BlockSerializer=lc,cc.append=Kt,cc.appendInternal=zt,cc.save=Mt,class{constructor(e){this.name=e}toString(){return this.name}equals(e){return this.name===e.toString()}}),dc=(uc.MUTATOR=new uc("mutator"),uc.WARNING=new uc("warning"),uc.COMMENT=new uc("comment"),class extends jo{constructor(e){super(),this.isBlank=!e,e&&(this.blockId=e.id,this.workspaceId=e.workspace.id)}toJson(){var e=super.toJson();if(this.blockId)return e.blockId=this.blockId,e;throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new dc)).blockId=e.blockId,t}}),pc=class extends dc{constructor(e,t,r,n,i){super(e),this.type=y.BLOCK_CHANGE,e&&(this.element=t,this.name=r||void 0,this.oldValue=n,this.newValue=i)}toJson(){var e=super.toJson();if(this.element)return e.element=this.element,e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,this.disabledReason&&(e.disabledReason=this.disabledReason),e;throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new pc)).element=e.element,t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,void 0!==e.disabledReason&&(t.disabledReason=e.disabledReason),t}setDisabledReason(e){if("disabled"!==this.element)throw Error('Cannot set the disabled reason for a BlockChange event if the element is not "disabled".');this.disabledReason=e}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(t=t.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");var r,n=t.getIcon(uc.MUTATOR);switch(n&&sr(n)&&n.bubbleIsVisible()&&n.setBubbleVisible(!1),e=e?this.newValue:this.oldValue,this.element){case"field":(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":t.setCommentText(e||null);break;case"collapsed":t.setCollapsed(!!e);break;case"disabled":t.setDisabledReason(!!e,null!=(r=this.disabledReason)?r:Il);break;case"inline":t.setInputsInline(!!e);break;case"mutation":r=pc.getExtraBlockState_(t),t.loadExtraState?t.loadExtraState(JSON.parse(e||"{}")):t.domToMutation&&t.domToMutation(f.textToDom$$module$build$src$core$utils$xml(e||"<mutation/>")),m(new pc(t,"mutation",null,r,e));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(e){return e.saveExtraState?(e=e.saveExtraState(!0))?JSON.stringify(e):"":e.mutationToDom&&(e=e.mutationToDom())?Mn(e):""}},hc=(i(_.EVENT,y.BLOCK_CHANGE,pc),{}),mc=(hc.clamp=or,hc.toDegrees=Kc,hc.toRadians=ar,16),gc=1,fc=12,_c=16,yc=.25,bc=null,vc=null,Tc="",kc="",xc=null,Ec=null,Sc=null,Cc=null,wc=null,Ic={getBoundsInfo:function(){var e=ke(xc),t=be(xc);return{left:e.x,right:e.x+t.width,top:e.y,bottom:e.y+t.height,width:t.width,height:t.height}},getPositionMetrics:function(e,t,r,n){var i=Ic.getBoundsInfo(),s=be(io);return t+s.height<i.bottom?_r(e,t,i,s):n-s.height>i.top?yr(r,n,i,s):t+s.height<document.documentElement.clientHeight?_r(e,t,i,s):n-s.height>document.documentElement.clientTop?yr(r,n,i,s):br(e,i,s)}},tc={ANIMATION_TIME:yc,ARROW_HORIZONTAL_PADDING:fc,ARROW_SIZE:mc,BORDER_SIZE:gc,PADDING_Y:_c,TEST_ONLY:Ic},lc=(tc.clearContent=ur,tc.createDom=lr,tc.getContentDiv=Jc,tc.getOwner=Yc,tc.getPositionX=vr,tc.hide=kr,tc.hideIfOwner=Tr,tc.hideWithoutAnimation=xr,tc.isVisible=su,tc.repositionForWindowResize=Sr,tc.setBoundsElement=cr,tc.setColour=dr,tc.show=fr,tc.showPositionedByBlock=cu,tc.showPositionedByField=pr,{}),Ac=(lc.commonWordPrefix=wr,lc.commonWordSuffix=Ir,lc.isNumber=f.isNumber$$module$build$src$core$utils$string,lc.shortestStringLength=Cr,lc.wrap=f.wrap$$module$build$src$core$utils$string,void 0),Dc=!1,Nc=!1,Oc=50,Rc=0,Lc=0,Pc=0,Mc=0,Fc=null,Bc=null,$c=0,Uc=10,Vc=10,Hc=750,Gc=5,jc=null,Kc={HOVER_MS:Hc,LIMIT:Oc,MARGINS:Gc,OFFSET_X:$c,OFFSET_Y:Uc,RADIUS_OK:Vc},zc=(Kc.bindMouseEvents=Mr,Kc.block=Gr,Kc.createDom=Pr,Kc.dispose=Vr,Kc.getCustomTooltip=ch,Kc.getDiv=Xp,Kc.getTooltipOfObject=Rr,Kc.hide=Hr,Kc.isVisible=du,Kc.setCustomTooltip=Eu,Kc.unbindMouseEvents=Fr,Kc.unblock=jr,.45),Wc=.65,qc={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},Jc={},Yc=(Jc.blend=Qr,Jc.getHsvSaturation=fd,Jc.getHsvValue=Ru,Jc.hexToRgb=Xr,Jc.hsvToHex=Zr,Jc.hueToHex=en,Jc.names=qc,Jc.parse=Jr,Jc.rgbToHex=Yr,Jc.setHsvSaturation=Gu,Jc.setHsvValue=ju,{}),I=(Yc.checkMessageReferences=L,Yc.parseBlockColour=sn,Yc.replaceMessageReferences=nn,Yc.tokenizeInterpolation=rn,class{get size_(){return this.size}set size_(e){this.size=e}constructor(e,t,r){this.DEFAULT_VALUE=null,this.name=void 0,this.tooltip=this.validator_=null,this.size=new S(0,0),this.constants_=this.mouseDownWrapper=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.id_=null,this.value_=("DEFAULT_VALUE"in new.target.prototype?new.target.prototype:this).DEFAULT_VALUE,this.size_=new S(0,0),e!==I.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t)&&this.setValidator(t)}configure_(e){e.tooltip&&this.setTooltip(nn(e.tooltip))}setSourceBlock(e){if(this.sourceBlock_)throw Error("Field already bound to a block");if((this.sourceBlock_=e).id.includes("_field"))throw Error("Field ID indicator is contained in block ID. This may cause "+`problems with focus: ${e.id}.`);this.id_=e.id+"_field_"+Ca()}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){if(!this.fieldGroup_){var e=this.id_;if(!e)throw Error("Expected ID to be defined prior to init.");this.fieldGroup_=l(x.G,{id:e}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip),this.bindEvents_(),this.initModel(),this.applyColour()}}initView(){this.createBorderRect_(),this.createTextElement_(),this.fieldGroup_&&c(this.fieldGroup_,"blocklyField")}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=l(x.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=l(x.TEXT,{class:"blocklyText blocklyFieldText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){var e=this.getClickTarget_();if(!e)throw Error("A click target has not been set.");Mr(e),this.mouseDownWrapper=h(e,"pointerdown",this,this.onMouseDown_)}fromXml(e){this.setValue(e.textContent)}toXml(e){return e.textContent=this.getValue(),e}saveState(e){return null!==(e=this.saveLegacyState(I))?e:this.getValue()}loadState(e){this.loadLegacyState(I,e)||this.setValue(e)}saveLegacyState(e){return e.prototype.saveState===this.saveState&&e.prototype.toXml!==this.toXml?((e=f.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name",this.name||""),Re(this.toXml(e)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(e,t){return e.prototype.loadState===this.loadState&&e.prototype.fromXml!==this.fromXml&&(this.fromXml(f.textToDom$$module$build$src$core$utils$xml(t)),!0)}dispose(){var e;Tr(this),un(this),null!=(e=this.getSourceBlock())&&e.isDeadOrDying()||o(this.fieldGroup_),this.disposed=!0}updateEditable(){var e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(c(e,"blocklyEditableField"),a(e,"blocklyNonEditableField")):(c(e,"blocklyNonEditableField"),a(e,"blocklyEditableField")))}setEnabled(e){this.enabled_=e,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==I.prototype.showEditor_}isClickableInFlyout(e){return!e}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let e=!1;return this.name&&(this.SERIALIZABLE?e=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=!0)),e}isVisible(){return this.visible_}setVisible(e){var t;this.visible_!==e&&(this.visible_=e,t=this.fieldGroup_)&&(t.style.display=e?"block":"none")}setValidator(e){this.validator_=e}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(this.borderRect_)return this.borderRect_;throw Error(`The border rectangle is ${this.borderRect_}.`)}getTextElement(){if(this.textElement_)return this.textElement_;throw Error(`The text element is ${this.textElement_}.`)}getTextContent(){if(this.textContent_)return this.textContent_;throw Error(`The text content is ${this.textContent_}.`)}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(e){this.isClickable()&&this.showEditor_(e)}showEditor_(e){}repositionForWindowResize(){return!1}updateSize_(e){var t=this.getConstants();let r=2*(e=void 0!==e?e:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING),n=t.FIELD_TEXT_HEIGHT,i=0;this.textElement_&&(i=Y(this.textElement_),r+=i),this.isFullBlockField()||(n=Math.max(n,t.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=n,this.size_.width=r,this.positionTextElement_(e,i),this.positionBorderRect_()}positionTextElement_(e,t){var r,n,i;this.textElement_&&(r=this.getConstants(),n=this.size_.height/2,this.textElement_.setAttribute("x",String(null!=(i=this.getSourceBlock())&&i.RTL?this.size_.width-t-e:e)),this.textElement_.setAttribute("y",String(r.FIELD_TEXT_BASELINE_CENTER?n:n-r.FIELD_TEXT_HEIGHT/2+r.FIELD_TEXT_BASELINE)))}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_&&(this.render_(),this.isDirty_=!1),this.size_):new S(0,0)}getScaledBBox(){let e;var t,r,n=this.getSourceBlock();if(n)return this.isFullBlockField()?(t=this.sourceBlock_.getHeightWidth(),r=n.workspace.scale,e=this.getAbsoluteXY_(),n=(t.width+1)*r,t=(t.height+1)*r,co?(e.x+=1.5*r,e.y+=1.5*r):(e.x-=.5*r,e.y-=.5*r)):(t=this.borderRect_.getBoundingClientRect(),e=ke(this.borderRect_),n=t.width,t=t.height),new E(e.y,e.y+t,e.x,e.x+n);throw new Xc}onLocationChange(e){}getDisplayText_(){let e=this.getText();return e=(e=e.length>this.maxDisplayLength?e.substring(0,this.maxDisplayLength-2)+"":e).replace(/\s/g,I.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+=""),e}getText(){var e=this.getText_();return null!==e?String(e):String(this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_.queueRender()}setValue(e,t=!0){if(null!==e){var r=f.getGroup$$module$build$src$core$events$utils();r||f.setGroup$$module$build$src$core$events$utils(!0);try{var n,i,s,a,o,l=this.doClassValidation_(e),c=this.processValidation(e,l,t);c instanceof Error||(i=null==(n=this.getValidator())?void 0:n.call(this,c),(s=this.processValidation(c,i,t))instanceof Error)||(a=this.sourceBlock_)&&a.disposed||((o=this.getValue())===s?this.doValueUpdate_(s):(this.doValueUpdate_(s),t&&a&&U()&&m(new(g(y.BLOCK_CHANGE))(a,"field",this.name||null,o,s)),this.isDirty_&&this.forceRerender()))}finally{f.setGroup$$module$build$src$core$events$utils(r)}}}processValidation(e,t,r){return null===t?(this.doValueInvalid_(e,r),this.isDirty_&&this.forceRerender(),Error()):void 0===t?e:t}getValue(){return this.value_}doClassValidation_(e){return null==e?null:e}doValueUpdate_(e){this.value_=e,this.isDirty_=!0}doValueInvalid_(e,t){}onMouseDown_(e){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)}setTooltip(e){e||""===e||(e=this.sourceBlock_);var t=this.getClickTarget_();t?t.tooltip=e:this.tooltip=e}getTooltip(){var e=this.getClickTarget_();return Rr(e||{tooltip:this.tooltip})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return ke(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let t=null;var r=this.getSourceBlock();if(!r)throw new Xc;var n=r.inputList;for(let e=0;e<r.inputList.length;e++){var i=n[e],s=i.fieldRow;for(let e=0;e<s.length;e++)if(s[e]===this){t=i;break}}return t}getFlipRtl(){return!1}onShortcut(e){return!1}getFocusableElement(){if(this.fieldGroup_)return this.fieldGroup_;throw Error("This field currently has no representative DOM element.")}getFocusableTree(){var e=this.getSourceBlock();if(e)return e.workspace;throw new Xc}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}static fromJson(e){throw Error("Attempted to instantiate a field from the registry that hasn't defined a 'fromJson' method.")}}),Xc=(I.NBSP="",I.SKIP_SETUP=Symbol("SKIP_SETUP"),class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}}),Zc=null,Qc=null,eu=null,tu="blocklyWidgetDiv",ru="",nu="",iu=null,su={},au=(su.createDom=an,su.getDiv=Ku,su.hide=ln,su.hideIfOwner=un,su.hideIfOwnerIsInWorkspace=dn,su.isVisible=cn,su.positionWithAnchor=hn,su.repositionForWindowResize=_n,su.show=on,su.testOnly_setDiv=zu,null),ou={},lu=null,cu={},A=(cu.callbackFactory=f.callbackFactory$$module$build$src$core$contextmenu,cu.dispose=Sn,cu.getCurrentBlock=qu,cu.hide=En,cu.setCurrentBlock=yn,cu.show=bn,class{constructor(){this.registeredItems=new Map,this.reset()}reset(){this.registeredItems.clear()}register(e){if(this.registeredItems.has(e.id))throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registeredItems.set(e.id,e)}unregister(e){if(!this.registeredItems.has(e))throw Error('Menu item with ID "'+e+'" not found.');this.registeredItems.delete(e)}getItem(e){return null!=(e=this.registeredItems.get(e))?e:null}getContextMenuOptions(t,r){var n,i=[];for(n of this.registeredItems.values()){if(n.scopeType){if(n.scopeType===uu.BLOCK&&!t.block)continue;if(n.scopeType===uu.COMMENT&&!t.comment)continue;if(n.scopeType===uu.WORKSPACE&&!t.workspace)continue}let e;if(e={scope:t,weight:n.weight},n.separator)e=Object.assign({},e,{separator:!0});else{var s=n.preconditionFn(t,r);if("hidden"===s)continue;var a="function"==typeof n.displayText?n.displayText(t):n.displayText;e=Object.assign({},e,{text:a,callback:n.callback,enabled:"enabled"===s})}i.push(e)}return i.sort(function(e,t){return e.weight-t.weight}),i}}),uu=(ch=A=A||{},(Xp=ch.ScopeType||(ch.ScopeType={})).BLOCK="block",Xp.WORKSPACE="workspace",Xp.COMMENT="comment",ch.registry=new ch,A.ScopeType),du={BLOCK:50,BUBBLE:100},pu=class{constructor(e){this.comment=e,this.startLoc=null,this.workspace=e.workspace}isMovable(){return this.comment.isOwnMovable()&&!this.comment.isDeadOrDying()&&!this.workspace.isReadOnly()}startDrag(){var e;this.fireDragStartEvent(),this.startLoc=this.comment.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null!=(e=this.workspace.getLayerManager())&&e.moveToDragLayer(this.comment),this.comment.setDragging(!0)}drag(e){this.comment.moveDuringDrag(e)}endDrag(){var e;this.fireDragEndEvent(),this.fireMoveEvent(),null!=(e=this.workspace.getLayerManager())&&e.moveOffDragLayer(this.comment,50),this.comment.setDragging(!1),this.comment.snapToGrid(),this.workspace.setResizesEnabled(!0)}fireDragStartEvent(){var e=new(g(y.COMMENT_DRAG))(this.comment,!0);m(e)}fireDragEndEvent(){var e=new(g(y.COMMENT_DRAG))(this.comment,!1);m(e)}fireMoveEvent(){var e;this.comment.isDeadOrDying()||((e=new(g(y.COMMENT_MOVE))(this.comment)).setReason(["drag"]),e.oldCoordinate_=this.startLoc,e.recordNew(),m(e))}revertDrag(){this.startLoc&&this.comment.moveDuringDrag(this.startLoc)}},hu=new WeakMap,mu=class{constructor(e,t,r){this.id=e,this.workspace=t,this.container=r}isVisible(){return this.icon.checkVisibility()}getParentComment(){var e=this.workspace.getCommentById(this.id);if(e)return e;throw Error(`Comment bar button ${this.id} has no corresponding comment`)}getSize(e=!1){var t=this.icon.getBBox(),t=E.from(t);return e&&(e=this.getMargin(),t.left-=e,t.top-=e,t.bottom+=e,t.right+=e),t}getMargin(){return(this.container.getBBox().height-this.icon.getBBox().height)/2}getFocusableElement(){return this.icon}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return this.isVisible()}},gu="_collapse_bar_button",fu=class extends mu{constructor(e,t,r){super(e,t,r),this.id=e,this.workspace=t,this.container=r,this.icon=l(x.IMAGE,{class:"blocklyFoldoutIcon",href:this.workspace.options.pathToMedia+"foldout-icon.svg",id:this.id+gu},this.container),this.bindId=h(this.icon,"pointerdown",this,this.performAction.bind(this))}dispose(){s(this.bindId)}reposition(){var e=this.getMargin();this.icon.setAttribute("y",""+e),this.icon.setAttribute("x",""+e)}performAction(e){_a();var t=this.getParentComment();t.view.bringToFront(),(e&&e instanceof PointerEvent&&xa(e)||(t.setCollapsed(!t.isCollapsed()),this.workspace.hideChaff(),null!=e))&&e.stopPropagation()}},_u=({COMMENT_COLLAPSE_BAR_BUTTON_FOCUS_IDENTIFIER:gu}.CollapseCommentBarButton=fu,"_comment_textarea_"),yu=class{constructor(e,t,r){this.workspace=e,this.onFinishEditing=r,this.textChangeListeners=[],this.text="",this.foreignObject=l(x.FOREIGNOBJECT,{class:"blocklyCommentForeignObject"}),(e=document.createElementNS(No,"body")).setAttribute("xmlns",No),e.className="blocklyMinimalBody",this.textArea=document.createElementNS(No,"textarea"),this.textArea.setAttribute("tabindex","-1"),c(this.textArea,"blocklyCommentText"),c(this.textArea,"blocklyTextarea"),c(this.textArea,"blocklyText"),e.appendChild(this.textArea),this.foreignObject.appendChild(e),t&&(this.id=t+_u,this.textArea.setAttribute("id",this.id)),h(this.textArea,"change",this,this.onTextChange),h(this.textArea,"pointerdown",this,e=>{e.stopPropagation(),f.getFocusManager$$module$build$src$core$focus_manager().focusNode(this),_a()}),h(this.textArea,"keydown",this,this.handleKeyDown)}getDom(){return this.foreignObject}getText(){return this.text}setText(e){this.textArea.value=e,this.onTextChange()}onTextChange(){var t=this.text;this.text=this.textArea.value;for(let e=this.textChangeListeners.length-1;0<=e;e--)this.textChangeListeners[e](t,this.text)}handleKeyDown(e){("Escape"===e.key||"Enter"===e.key&&(e.ctrlKey||e.metaKey))&&(this.onFinishEditing&&this.onFinishEditing(),e.stopPropagation())}addTextChangeListener(e){this.textChangeListeners.push(e)}removeTextChangeListener(e){this.textChangeListeners.splice(this.textChangeListeners.indexOf(e),1)}setPlaceholderText(e){this.textArea.placeholder=e}setEditable(e){e?this.textArea.removeAttribute("readonly"):this.textArea.setAttribute("readonly","true")}updateSize(e,t){this.foreignObject.setAttribute("height",""+(e.height-t.height)),this.foreignObject.setAttribute("width",""+e.width),this.foreignObject.setAttribute("y",""+t.height),this.workspace.RTL&&this.foreignObject.setAttribute("x",""+-e.width)}getFocusableElement(){return this.textArea}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!!this.id}},bu=({COMMENT_EDITOR_FOCUS_IDENTIFIER:_u}.CommentEditor=yu,"_delete_bar_button"),vu=class extends mu{constructor(e,t,r){super(e,t,r),this.id=e,this.workspace=t,this.container=r,this.icon=l(x.IMAGE,{class:"blocklyDeleteIcon",href:this.workspace.options.pathToMedia+"delete-icon.svg",id:this.id+bu},r),this.bindId=h(this.icon,"pointerdown",this,this.performAction.bind(this))}dispose(){s(this.bindId)}reposition(){var e=this.getMargin(),t=(this.icon.setAttribute("x","0"),this.container.getBBox());this.icon.setAttribute("y",""+e),this.icon.setAttribute("x",""+(t.width-this.getSize(!0).getWidth()))}performAction(e){_a(),e&&e instanceof PointerEvent&&xa(e)?e.stopPropagation():(this.getParentComment().dispose(),null!=e&&e.stopPropagation(),f.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.workspace))}},Tu=({COMMENT_DELETE_BAR_BUTTON_FOCUS_IDENTIFIER:bu}.DeleteCommentBarButton=vu,class{constructor(e,t){this.workspace=e,this.commentId=t,this.collapsed=!1,this.editable=!0,this.location=new k(0,0),this.sizeChangeListeners=[],this.disposeListeners=[],this.collapseChangeListeners=[],this.resizePointerMoveListener=this.resizePointerUpListener=null,this.disposed=this.disposing=!1,this.svgRoot=l(x.G,{class:"blocklyComment blocklyEditable blocklyDraggable"}),this.highlightRect=this.createHighlightRect(this.svgRoot),{topBarGroup:this.topBarGroup,topBarBackground:this.topBarBackground,deleteButton:this.deleteButton,foldoutButton:this.foldoutButton,textPreview:this.textPreview,textPreviewNode:this.textPreviewNode}=this.createTopBar(this.svgRoot),this.commentEditor=this.createTextArea(),this.resizeHandle=this.createResizeHandle(this.svgRoot,e),null!=(t=e.getLayerManager())&&t.append(this,50),this.size=Tu.defaultCommentSize,this.setSizeWithoutFiringEvents(this.size),this.moveTo(new k(0,0))}createHighlightRect(e){return l(x.RECT,{class:"blocklyCommentHighlight"},e)}createTopBar(e){e=l(x.G,{class:"blocklyCommentTopbar"},e);var t=l(x.RECT,{class:"blocklyCommentTopbarBackground"},e),r=new vu(this.commentId,this.workspace,e),n=new fu(this.commentId,this.workspace,e),i=l(x.TEXT,{class:"blocklyCommentPreview blocklyCommentText blocklyText"},e),s=document.createTextNode("");return i.appendChild(s),{topBarGroup:e,topBarBackground:t,deleteButton:r,foldoutButton:n,textPreview:i,textPreviewNode:s}}createTextArea(){var e=new yu(this.workspace,this.commentId,()=>this.svgRoot.focus());return this.svgRoot.appendChild(e.getDom()),e.addTextChangeListener((e,t)=>{this.updateTextPreview(t),this.setSize(this.size)}),e}getEditorFocusableNode(){return this.commentEditor}createResizeHandle(e,t){return e=l(x.IMAGE,{class:"blocklyResizeHandle",href:t.options.pathToMedia+"resize-handle.svg"},e),h(e,"pointerdown",this,this.onResizePointerDown),e}getSvgRoot(){return this.svgRoot}getSize(){return this.collapsed?this.topBarBackground.getBBox():this.size}setSizeWithoutFiringEvents(e){var t=this.topBarBackground.getBBox(),r=this.textPreview.getBBox(),n=this.resizeHandle.getBBox();this.size=e=S.max(e,this.calcMinSize(t)),this.svgRoot.setAttribute("height",""+e.height),this.svgRoot.setAttribute("width",""+e.width),this.updateHighlightRect(e),this.updateTopBarSize(e),this.commentEditor.updateSize(e,t),this.deleteButton.reposition(),this.foldoutButton.reposition(),this.updateTextPreviewSize(e,t,r),this.updateResizeHandlePosition(e,n)}setSize(e){var t=this.preResizeSize||this.size;this.setSizeWithoutFiringEvents(e),this.onSizeChange(t,this.size)}calcMinSize(e){var t;this.updateTextPreview(null!=(t=this.commentEditor.getText())?t:"");let r=t=Y(this.textPreview);return this.foldoutButton.isVisible()?r+=this.foldoutButton.getSize(!0).getWidth():t&&(r+=4),this.deleteButton.isVisible()?r+=this.deleteButton.getSize(!0).getWidth():t&&(r+=4),new S(r,e.height+20)}updateHighlightRect(e){this.highlightRect.setAttribute("height",""+e.height),this.highlightRect.setAttribute("width",""+e.width),this.workspace.RTL&&this.highlightRect.setAttribute("x",""+-e.width)}updateTopBarSize(e){this.topBarBackground.setAttribute("width",""+e.width)}updateTextPreviewSize(e,t,r){t=(t.height-r.height)/2;var n=this.foldoutButton.getSize(!0),i=this.deleteButton.getSize(!0);e=e.width-n.getWidth()-i.getWidth(),this.textPreview.setAttribute("x",""+n.getWidth()),this.textPreview.setAttribute("y",""+(t+r.height/2)),this.textPreview.setAttribute("width",""+e)}updateResizeHandlePosition(e,t){this.resizeHandle.setAttribute("y",""+(e.height-t.height)),this.resizeHandle.setAttribute("x",""+(e.width-t.width))}onSizeChange(t,r){for(let e=this.sizeChangeListeners.length-1;0<=e;e--)this.sizeChangeListeners[e](t,r)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}removeSizeChangeListener(e){this.sizeChangeListeners.splice(this.sizeChangeListeners.indexOf(e),1)}onResizePointerDown(e){this.isEditable()&&(this.bringToFront(),xa(e)||(this.preResizeSize=this.getSize(),wn(this.workspace,e,new k(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=h(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=h(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation())}onResizePointerUp(e){_a(),this.resizePointerUpListener&&(s(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(s(this.resizePointerMoveListener),this.resizePointerMoveListener=null),this.setSize(this.size),this.preResizeSize=void 0}onResizePointerMove(e){e=In(this.workspace,e),this.setSizeWithoutFiringEvents(new S(this.workspace.RTL?-e.x:e.x,e.y))}isCollapsed(){return this.collapsed}setCollapsed(e){((this.collapsed=e)?c:a)(this.svgRoot,"blocklyCollapsed"),this.setSizeWithoutFiringEvents(this.size),this.onCollapse()}onCollapse(){for(let e=this.collapseChangeListeners.length-1;0<=e;e--)this.collapseChangeListeners[e](this.collapsed)}addOnCollapseListener(e){this.collapseChangeListeners.push(e)}removeOnCollapseListener(e){this.collapseChangeListeners.splice(this.collapseChangeListeners.indexOf(e),1)}isEditable(){return this.editable}setEditable(e){((this.editable=e)?(c(this.svgRoot,"blocklyEditable"),a):(a(this.svgRoot,"blocklyEditable"),c))(this.svgRoot,"blocklyReadonly"),this.commentEditor.setEditable(e)}getRelativeToSurfaceXY(){return this.location}moveTo(e){this.location=e,this.svgRoot.setAttribute("transform",`translate(${e.x}, ${e.y})`)}getText(){return this.commentEditor.getText()}setText(e){this.commentEditor.setText(e)}setPlaceholderText(e){this.commentEditor.setPlaceholderText(e)}addTextChangeListener(e){this.commentEditor.addTextChangeListener(e)}removeTextChangeListener(e){this.commentEditor.removeTextChangeListener(e)}updateTextPreview(e){this.textPreviewNode.textContent=this.truncateText(e)}truncateText(e){return 12<=e.length?e.substring(0,9)+"...":e}bringToFront(){var e=this.svgRoot.parentNode,t=e.childNodes;t[t.length-1]!==this.svgRoot&&e.appendChild(this.svgRoot)}onDeleteDown(e){_a(),xa(e)||this.dispose(),e.stopPropagation()}dispose(){this.disposing=!0,this.foldoutButton.dispose(),this.deleteButton.dispose(),o(this.svgRoot);for(let e=this.disposeListeners.length-1;0<=e;e--)this.disposeListeners[e]();this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}addDisposeListener(e){this.disposeListeners.push(e)}removeDisposeListener(e){this.disposeListeners.splice(this.disposeListeners.indexOf(e),1)}getCommentBarButtons(){return[this.foldoutButton,this.deleteButton]}}),ku=(Tu.defaultCommentSize=new S(120,100),_e("\n.injectionDiv {\n  --commentFillColour: #FFFCC7;\n  --commentBorderColour: #F2E49B;\n}\n\n.blocklyComment .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 1px solid var(--commentBorderColour);\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n\n.blocklyReadonly.blocklyComment .blocklyTextarea {\n  cursor: inherit;\n}\n\n.blocklyDeleteIcon {\n  width: 20px;\n  height: 20px;\n  display: none;\n  cursor: pointer;\n}\n\n.blocklyFoldoutIcon {\n  width: 20px;\n  height: 20px;\n  transform-origin: 12px 12px;\n  cursor: pointer;\n}\n.blocklyResizeHandle {\n  width: 12px;\n  height: 12px;\n  cursor: se-resize;\n}\n.blocklyReadonly.blocklyComment .blocklyResizeHandle {\n  cursor: inherit;\n}\n\n.blocklyCommentTopbarBackground {\n  fill: var(--commentBorderColour);\n  height: 24px;\n}\n\n.blocklyComment .blocklyCommentPreview.blocklyText {\n  fill: #000;\n  dominant-baseline: middle;\n  visibility: hidden;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentPreview {\n  visibility: visible;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentForeignObject,\n.blocklyCollapsed.blocklyComment .blocklyResizeHandle {\n  display: none;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyFoldoutIcon {\n  transform: rotate(-90deg);\n}\n\n.blocklyRTL .blocklyCommentTopbar {\n  transform: scale(-1, 1);\n}\n\n.blocklyRTL .blocklyCommentForeignObject {\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyCommentPreview {\n  /* Revert the scale and control RTL using direction instead. */\n  transform: scale(-1, 1);\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyResizeHandle {\n  transform: scale(-1, 1);\n  cursor: sw-resize;\n}\n\n.blocklyCommentHighlight {\n  fill: none;\n}\n\n.blocklyCommentText.blocklyActiveFocus {\n  border-color: #fc3;\n  border-width: 2px;\n}\n\n.blocklySelected .blocklyCommentHighlight {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentHighlight {\n  stroke: none;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentTopbarBackground {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n"),class{constructor(e,t){this.workspace=e,this.text="",this.collapsed=!1,this.deletable=this.movable=this.editable=!0,this.location=new k(0,0),this.disposing=this.disposed=!1,this.id=t&&!e.getCommentById(t)?t:wa(),this.size=Tu.defaultCommentSize,e.addTopComment(this),this.fireCreateEvent()}fireCreateEvent(){U()&&m(new(g(y.COMMENT_CREATE))(this))}fireDeleteEvent(){U()&&m(new(g(y.COMMENT_DELETE))(this))}fireChangeEvent(e,t){U()&&m(new(g(y.COMMENT_CHANGE))(this,e,t))}fireCollapseEvent(e){U()&&m(new(g(y.COMMENT_COLLAPSE))(this,e))}setText(e){var t=this.text;this.text=e,this.fireChangeEvent(t,e)}getText(){return this.text}setSize(e){var t=new(g(y.COMMENT_RESIZE))(this);this.size=e,t.recordCurrentSizeAsNewSize(),m(t)}getSize(){return this.size}setCollapsed(e){this.collapsed=e,this.fireCollapseEvent(e)}isCollapsed(){return this.collapsed}setEditable(e){this.editable=e}isEditable(){return this.isOwnEditable()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setMovable(e){this.movable=e}isMovable(){return this.isOwnMovable()&&!this.workspace.isReadOnly()&&!this.workspace.isFlyout}isOwnMovable(){return this.movable}setDeletable(e){this.deletable=e}isDeletable(){return this.isOwnDeletable()&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()&&!this.workspace.isFlyout}isOwnDeletable(){return this.deletable}moveTo(e,t){var r=new(g(y.COMMENT_MOVE))(this);t&&r.setReason(t),this.location=e,r.recordNew(),m(r)}getRelativeToSurfaceXY(){return this.location}dispose(){this.disposing=!0,this.fireDeleteEvent(),this.workspace.removeTopComment(this),this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}}),xu=class extends ku{constructor(e,t){super(e,t),this.dragStrategy=new pu(this),this.workspace=e,this.view=new Tu(e,this.id),this.view.setSize(this.getSize()),this.view.setEditable(this.isEditable()),this.view.getSvgRoot().setAttribute("data-id",this.id),this.view.getSvgRoot().setAttribute("id",this.id),this.addModelUpdateBindings(),h(this.view.getSvgRoot(),"pointerdown",this,this.startGesture),h(this.view.getSvgRoot(),"wheel",this,e=>{e.stopPropagation()})}addModelUpdateBindings(){this.view.addTextChangeListener((e,t)=>{super.setText(t)}),this.view.addSizeChangeListener((e,t)=>{super.setSize(t)}),this.view.addOnCollapseListener(()=>{super.setCollapsed(this.view.isCollapsed())}),this.view.addDisposeListener(()=>{this.isDeadOrDying()||this.dispose()})}setText(e){this.view.setText(e)}setPlaceholderText(e){this.view.setPlaceholderText(e)}setSize(e){this.view.setSize(e)}setCollapsed(e){this.view.setCollapsed(e)}setEditable(e){super.setEditable(e),this.view.setEditable(this.isEditable())}getSvgRoot(){return this.view.getSvgRoot()}getSize(){return super.getSize()}getBoundingRectangle(){var e,t=this.getRelativeToSurfaceXY(),r=null!=(n=null==(e=this.view)?void 0:e.getSize())?n:this.getSize(),n=this.workspace.RTL?(e=t.x-r.width,t.x):(e=t.x,t.x+r.width);return new E(t.y,t.y+r.height,e,n)}moveBy(e,t,r){var n=this.getRelativeToSurfaceXY();e=new k(n.x+e,n.y+t),this.moveTo(e,r)}moveTo(e,t){super.moveTo(e,t),this.view.moveTo(e)}moveDuringDrag(e){this.location=e,this.view.moveTo(e)}setDragging(e){(e?c:a)(this.getSvgRoot(),"blocklyDragging")}dispose(){this.disposing=!0;let e=f.getFocusManager$$module$build$src$core$focus_manager();e.getFocusedNode()===this&&setTimeout(()=>e.focusTree(this.workspace),0),this.view.isDeadOrDying()||this.view.dispose(),super.dispose()}startGesture(e){var t=this.workspace.getGesture(e);t&&(t.handleCommentStart(e,this),f.getFocusManager$$module$build$src$core$focus_manager().focusNode(this))}setDeleteStyle(e){(e?c:a)(this.getSvgRoot(),"blocklyDraggingDelete")}isCopyable(){return this.isOwnMovable()&&this.isOwnDeletable()}isMovable(){return this.dragStrategy.isMovable()}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){c(this.getSvgRoot(),"blocklySelected"),ce(this)}unselect(){a(this.getSvgRoot(),"blocklySelected"),ce(null)}toCopyData(){return{paster:vl.TYPE,commentState:We(this,{addCoordinates:!0})}}showContextMenu(e){var t=A.registry.getContextMenuOptions({comment:this,focusedNode:this},e),r=e instanceof PointerEvent?new k(e.clientX,e.clientY):Oe(this.workspace,this.getRelativeToSurfaceXY()).translate(10,10);bn(e,t,this.workspace.RTL,this.workspace,r)}snapToGrid(){var e,t;this.isDeadOrDying()||null!=(t=this.workspace.getGrid())&&t.shouldSnap()&&(e=this.getRelativeToSurfaceXY(),(t=t.alignXY(e))!==e)&&this.moveTo(t,["snap"])}getEditorFocusableNode(){return this.view.getEditorFocusableNode()}getFocusableElement(){return this.getSvgRoot()}getFocusableTree(){return this.workspace}onNodeFocus(){var e;this.select(),null!=(e=this.workspace.getLayerManager())&&e.append(this,50)}onNodeBlur(){this.unselect()}canBeFocused(){return!0}},Eu={},Su=(Eu.appendDomToWorkspace=ed,Eu.blockToDom=Ln,Eu.blockToDomWithXY=Nn,Eu.clearWorkspaceAndLoadFromXml=od,Eu.deleteNext=cd,Eu.domToBlock=f.domToBlock$$module$build$src$core$xml,Eu.domToBlockInternal=Bn,Eu.domToPrettyText=hd,Eu.domToText=Mn,Eu.domToVariables=$n,Eu.domToWorkspace=f.domToWorkspace$$module$build$src$core$xml,Eu.loadWorkspaceComment=Fn,Eu.saveWorkspaceComment=An,Eu.variablesToDom=Dn,Eu.workspaceToDom=md,class extends dc{constructor(e){super(e),this.type=y.BLOCK_CREATE,e&&(e.isShadow()&&(this.recordUndo=!1),this.xml=Nn(e),this.ids=V(e),this.json=Mt(e,{addCoordinates:!0}))}toJson(){var e=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(this.json)return e.xml=Mn(this.xml),e.ids=this.ids,e.json=this.json,this.recordUndo||(e.recordUndo=this.recordUndo),e;throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new Su)).xml=f.textToDom$$module$build$src$core$utils$xml(e.xml),t.ids=e.ids,t.json=e.json,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){var t=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!Cu(t,this.ids))if(e)Kt(this.json,t);else for(e=0;e<this.ids.length;e++){var r=this.ids[e],n=t.getBlockById(r);n?n.dispose(!1):r===this.blockId&&console.warn("Can't uncreate non-existent block: "+r)}}}),Cu=function(t,e){return e.map(e=>t.getBlockById(e)).filter(e=>e&&e.isShadow()).length===e.length},wu=(i(_.EVENT,y.BLOCK_CREATE,Su),class extends Ko{constructor(e,t){super(t),this.type=y.THEME_CHANGE,this.themeName=e}toJson(){var e=super.toJson();if(this.themeName)return e.themeName=this.themeName,e;throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new wu)).themeName=e.themeName,t}}),Iu=(i(_.EVENT,y.THEME_CHANGE,wu),class extends Ko{constructor(e,t,r,n,i){super(n),this.type=y.VIEWPORT_CHANGE,this.viewTop=e,this.viewLeft=t,this.scale=r,this.oldScale=i}toJson(){var e=super.toJson();if(void 0===this.viewTop)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.viewLeft)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.scale)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.oldScale)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new Iu)).viewTop=e.viewTop,t.viewLeft=e.viewLeft,t.scale=e.scale,t.oldScale=e.oldScale,t}}),Au=(i(_.EVENT,y.VIEWPORT_CHANGE,Iu),(fd=v=v||{})[fd.INPUT_VALUE=1]="INPUT_VALUE",fd[fd.OUTPUT_VALUE=2]="OUTPUT_VALUE",fd[fd.NEXT_STATEMENT=3]="NEXT_STATEMENT",fd[fd.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT",class{constructor(e){this.connectionChecker=e,this.connections=[]}addConnection(e,t){t=this.calculateIndexForYPos(t),this.connections.splice(t,0,e)}findIndexOfConnection(t,r){if(this.connections.length){var n=this.calculateIndexForYPos(r);if(!(n>=this.connections.length)){r=t.y;let e=n;for(;0<=e&&this.connections[e].y===r;){if(this.connections[e]===t)return e;e--}for(e=n;e<this.connections.length&&this.connections[e].y===r;){if(this.connections[e]===t)return e;e++}}}return-1}calculateIndexForYPos(e){if(!this.connections.length)return 0;let t=0,r=this.connections.length;for(;t<r;){var n=Math.floor((t+r)/2);if(this.connections[n].y<e)t=n+1;else{if(!(this.connections[n].y>e)){t=n;break}r=n}}return t}removeConnection(e,t){if(-1===(e=this.findIndexOfConnection(e,t)))throw Error("Unable to find connection in connectionDB.");this.connections.splice(e,1)}getNeighbours(e,n){function t(e){var t=s-i[e].x,r=a-i[e].y;return Math.sqrt(t*t+r*r)<=n&&l.push(i[e]),r<n}let i=this.connections,s=e.x,a=e.y,r=(e=0,i.length-2),o=r;for(;e<o;)i[o].y<a?e=o:r=o,o=Math.floor((e+r)/2);let l=[];if(r=e=o,i.length){for(;0<=e&&t(e);)e--;for(;++r<i.length&&t(r););}return l}isInYRange(e,t,r){return Math.abs(this.connections[e].y-t)<=r}searchForClosest(e,t,r){if(!this.connections.length)return{connection:null,radius:t};var n=e.y,i=e.x,s=(e.x=i+r.x,e.y=n+r.y,this.calculateIndexForYPos(e.y));r=null;let a=t,o,l=s-1;for(;0<=l&&this.isInYRange(l,e.y,t);)o=this.connections[l],this.connectionChecker.canConnect(e,o,!0,a)&&(r=o,a=o.distanceFrom(e)),l--;for(;s<this.connections.length&&this.isInYRange(s,e.y,t);)o=this.connections[s],this.connectionChecker.canConnect(e,o,!0,a)&&(r=o,a=o.distanceFrom(e)),s++;return e.x=i,e.y=n,{connection:r,radius:a}}static init(e){var t=[];return t[v.INPUT_VALUE]=new Au(e),t[v.OUTPUT_VALUE]=new Au(e),t[v.NEXT_STATEMENT]=new Au(e),t[v.PREVIOUS_STATEMENT]=new Au(e),t}}),Du=class extends Ko{constructor(e,t,r){super(r),this.type=y.SELECTED,this.oldElementId=null!=e?e:void 0,this.newElementId=null!=t?t:void 0}toJson(){var e=super.toJson();return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new Du)).oldElementId=e.oldElementId,t.newElementId=e.newElementId,t}},Nu=(i(_.EVENT,y.SELECTED,Du),class extends dc{constructor(e){if(super(e),this.type=y.BLOCK_DELETE,e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=!1),this.oldXml=Nn(e),this.ids=V(e),this.wasShadow=e.isShadow(),this.oldJson=Mt(e,{addCoordinates:!0})}}toJson(){var e=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(void 0===this.wasShadow)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(this.oldJson)return e.oldXml=Mn(this.oldXml),e.ids=this.ids,e.wasShadow=this.wasShadow,e.oldJson=this.oldJson,this.recordUndo||(e.recordUndo=this.recordUndo),e;throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new Nu)).oldXml=f.textToDom$$module$build$src$core$utils$xml(e.oldXml),t.ids=e.ids,t.wasShadow=e.wasShadow||"shadow"===t.oldXml.tagName.toLowerCase(),t.oldJson=e.oldJson,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){var t=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(e)for(e=0;e<this.ids.length;e++){var r=this.ids[e],n=t.getBlockById(r);n?n.dispose(!1):r===this.blockId&&console.warn("Can't delete non-existent block: "+r)}else Kt(this.oldJson,t)}}),Ou=(i(_.EVENT,y.BLOCK_DELETE,Nu),{fromJsonInternal:Ld}),Ru={TEST_ONLY:Ou},Lu=(Ru.fromJson=f.fromJson$$module$build$src$core$field_registry,Ru.register=Xd,Ru.unregister=Md,class extends I{constructor(e,t,r){super(I.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,e!==I.SKIP_SETUP&&(this.setOptions(e),r&&this.configure_(r),t)&&this.setValidator(t)}fromXml(e){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e.textContent)}loadState(e){this.loadLegacyState(Lu,e)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=l(x.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&c(this.borderRect_,"blocklyDropdownRect"),this.fieldGroup_&&(c(this.fieldGroup_,"blocklyField"),c(this.fieldGroup_,"blocklyDropdownField"))}shouldAddBorderRect_(){var e;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!(null!=(e=this.getSourceBlock())&&e.isShadow())}createTextArrow_(){var e;this.arrow=l(x.TSPAN,{},this.textElement_),this.arrow.appendChild(document.createTextNode(null!=(e=this.getSourceBlock())&&e.RTL?Lu.ARROW_CHAR+" ":" "+Lu.ARROW_CHAR)),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.arrow.setAttribute("dominant-baseline","central"),null!=(e=this.getSourceBlock())&&e.RTL?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=l(x.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(Oo,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(e){var t=this.getSourceBlock();if(!t)throw new Xc;this.dropdownCreate(),this.menu_&&(this.menu_.openingCoords=e&&"number"==typeof e.clientX?new k(e.clientX,e.clientY):null,ur(),e=this.menu_.render(so),c(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(t=t.getColour(),e=this.sourceBlock_.getColourTertiary(),dr(t,e)),pr(this,this.dropdownDispose_.bind(this)),so.style.height=this.menu_.getSize().height+"px",this.menu_.focus(),this.selectedMenuItem&&this.menu_.setHighlighted(this.selectedMenuItem),this.applyColour())}dropdownCreate(){var t=this.getSourceBlock();if(!t)throw new Xc;var r=new El,n=(r.setRole(to.LISTBOX),this.menu_=r,this.getOptions(!1));this.selectedMenuItem=null;for(let e=0;e<n.length;e++){var i,s,a=n[e];a===Lu.SEPARATOR?r.addChild(new Sl):([i,s]=a,Xn(i)?((a=new Image(i.width,i.height)).src=i.src,a.alt=i.alt):a=i,(a=new xl(a,s)).setRole(to.OPTION),a.setRightToLeft(t.RTL),a.setCheckable(!0),r.addChild(a),a.setChecked(s===this.value_),s===this.value_&&(this.selectedMenuItem=a),a.onAction(this.handleMenuActionEvent,this))}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(e){Tr(this,!0),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue())}isOptionListDynamic(){return"function"==typeof this.menuGenerator_}getOptions(e){if(this.menuGenerator_)return Array.isArray(this.menuGenerator_)?this.menuGenerator_:(e&&this.generatedOptions||(this.generatedOptions=this.menuGenerator_(),this.validateOptions(this.generatedOptions)),this.generatedOptions);throw TypeError("A menu generator was never defined.")}setOptions(e){Array.isArray(e)?(this.validateOptions(e),e=this.trimOptions(e),this.menuGenerator_=e.options,this.prefixField=e.prefix||null,this.suffixField=e.suffix||null):this.menuGenerator_=e,this.selectedOption=this.getOptions(!1)[0],this.setValue(this.selectedOption[1])}doClassValidation_(t){return this.getOptions(!0).some(e=>e[1]===t)?t:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+t),null)}doValueUpdate_(r){super.doValueUpdate_(r),r=this.getOptions(!0);for(let e=0,t;t=r[e];e++)t[1]===this.value_&&(this.selectedOption=t)}applyColour(){var e=this.sourceBlock_;this.borderRect_&&(this.borderRect_.setAttribute("stroke",e.getColourTertiary()),this.menu_?this.borderRect_.setAttribute("fill",e.getColourTertiary()):this.borderRect_.setAttribute("fill","transparent")),e&&this.arrow&&(e.isShadow()?this.arrow.style.fill=e.getColourSecondary():this.arrow.style.fill=e.getColour())}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";var e=this.selectedOption&&this.selectedOption[0];Xn(e)?this.renderSelectedImage(e):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(e){var t=this.getSourceBlock();if(!t)throw new Xc;this.imageElement.style.display="",this.imageElement.setAttributeNS(Oo,"xlink:href",e.src),this.imageElement.setAttribute("height",String(e.height)),this.imageElement.setAttribute("width",String(e.width));var r=Number(e.height),n=(e=Number(e.width),!!this.borderRect_),i=Math.max(n?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,r+Lu.IMAGE_Y_PADDING),n=n?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,s=this.svgArrow?this.positionSVGArrow(e+n,i/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):Y(this.arrow);this.size_.width=e+s+2*n,this.size_.height=i;let a=0;t.RTL?this.imageElement.setAttribute("x",""+(n+s)):(a=e+s,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x",""+n)),this.imageElement.setAttribute("y",String(i/2-r/2)),this.positionTextElement_(a+n,e+s)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var e=this.getTextElement(),t=(c(e,"blocklyDropdownText"),e.setAttribute("text-anchor","start"),!!this.borderRect_),e=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT),r=Y(this.getTextElement()),t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let n=0;this.svgArrow&&(n=this.positionSVGArrow(r+t,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=r+n+2*t,this.size_.height=e,this.positionTextElement_(t,r)}positionSVGArrow(e,t){if(!this.svgArrow)return 0;var r,n,i,s=this.getSourceBlock();if(s)return r=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,n=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,i=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE,this.svgArrow.setAttribute("transform","translate("+(s.RTL?r:e+n)+","+t+")"),i+n;throw new Xc}getText_(){if(this.selectedOption){var e,t=this.selectedOption[0];if(Xn(t))return t.alt;if("undefined"!=typeof HTMLElement&&t instanceof HTMLElement)return null!=(e=null!=(e=t.title)?e:t.ariaLabel)?e:t.innerText;if("string"==typeof t)return t;console.warn("Can't get text for existing dropdown option. If you're using HTMLElement dropdown options in node, ensure you're using jsdom-global or similar.")}return null}static fromJson(e){if(e.options)return new this(e.options,void 0,e);throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.")}trimOptions(e){let r=!1;var t,n,i,s=e.map(e=>{var t;return e===Lu.SEPARATOR?e:([e,t]=e,"string"==typeof e?[nn(e),t]:(r=!0,[Xn(e)?Object.assign({},e,{alt:nn(e.alt)}):Object.assign({},e),t]))});return r||e.length<2||(t=s.map(([e])=>e),n=Cr(t),e=wr(t,n),i=Ir(t,n),!e&&!i)||n<=e+i?{options:s}:(n=e?t[0].substring(0,e-1):void 0,t=i?t[0].substr(1-i):void 0,{options:this.applyTrim(s,e,i),prefix:n,suffix:t})}applyTrim(e,r,n){return e.map(([e,t])=>[e.substring(r,e.length-n),t])}validateOptions(t){if(!Array.isArray(t))throw TypeError("FieldDropdown options must be an array.");if(!t.length)throw TypeError("FieldDropdown options must not be an empty array.");let r=!1;for(let e=0;e<t.length;e++){var n=t[e];Array.isArray(n)||n===Lu.SEPARATOR?"string"!=typeof n[1]?(r=!0,console.error(`Invalid option[${e}]: Each FieldDropdown option id must be a string. 
          Found ${n[1]} in: `+n)):!n[0]||"string"==typeof n[0]||Xn(n[0])||"undefined"!=typeof HTMLElement&&n[0]instanceof HTMLElement||(r=!0,console.error(`Invalid option[${e}]: Each FieldDropdown option must have a string 
          label, image description, or HTML element. Found ${n[0]} in: `+n)):(r=!0,console.error(`Invalid option[${e}]: Each FieldDropdown option must be an array or
          the string literal 'separator'. Found: `+n))}if(r)throw TypeError("Found invalid FieldDropdown options.")}}),Pu=(Lu.SEPARATOR="separator",Lu.ARROW_CHAR="",Lu.IMAGE_Y_OFFSET=5,Lu.IMAGE_Y_PADDING=2*Lu.IMAGE_Y_OFFSET,Xd("field_dropdown",Lu),class{constructor(e,t,r,n){this.name=e,this.startHats=!1,this.blockStyles=t||Object.create(null),this.categoryStyles=r||Object.create(null),this.componentStyles=n||Object.create(null),this.fontStyle=Object.create(null),i(_.THEME,e,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(e,t){this.blockStyles[e]=t}setCategoryStyle(e,t){this.categoryStyles[e]=t}getComponentStyle(e){if(!(e=this.componentStyles[e]))return null;if("string"==typeof e){var t=this.getComponentStyle(e);if(t)return t}return""+e}setComponentStyle(e,t){this.componentStyles[e]=t}setFontStyle(e){this.fontStyle=e}setStartHats(e){this.startHats=e}static defineTheme(e,t){e=e.toLowerCase();var r,n=new Pu(e);let i=t.base;return i&&(i="string"==typeof i?null!=(r=pa(_.THEME,i))?r:void 0:i)instanceof Pu&&(te(n,i),n.name=e),te(n.blockStyles,t.blockStyles),te(n.categoryStyles,t.categoryStyles),te(n.componentStyles,t.componentStyles),te(n.fontStyle,t.fontStyle),null!==t.startHats&&(n.startHats=t.startHats),n}}),Mu=new Pu("classic",{colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},{colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}}),Fu=class{constructor(e){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let t=null,r=!1;var n,i=!1,s=!1,a=!1,o=!1,l=!1,c=!!e.readOnly,u=(c||(t=Pe(null!=(n=e.toolbox)?n:null),r=Be(t),i=void 0===(i=e.trashcan)?r:i,s=void 0===(s=e.collapse)?r:s,a=void 0===(a=e.comments)?r:a,o=void 0===(o=e.disable)?r:o,l=void 0===(l=e.sounds)||l),n=e.maxTrashcanContents,i?void 0===n&&(n=32):n=0,!!e.rtl);let d=e.horizontalLayout;void 0===d&&(d=!1);var p="end"!==e.toolboxPosition,p=d?p?b.TOP:b.BOTTOM:p==u?b.RIGHT:b.LEFT;let h=e.css,m=(void 0===h&&(h=!0),"https://blockly-demo.appspot.com/static/media/");e.media&&(m=e.media.endsWith("/")?e.media:e.media+"/");var g=e.oneBasedIndex,f=e.renderer||"geras",_=e.plugins||{};let y=e.modalInputs;void 0===y&&(y=!0),this.RTL=u,this.oneBasedIndex=void 0===g||g,this.collapse=s,this.comments=a,this.disable=o,this.readOnly=c,this.maxBlocks=e.maxBlocks||1/0,this.maxInstances=null!=(u=e.maxInstances)?u:null,this.modalInputs=y,this.pathToMedia=m,this.hasCategories=r,this.moveOptions=Fu.parseMoveOptions(e,r),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=i,this.maxTrashcanContents=n,this.hasSounds=l,this.hasCss=h,this.horizontalLayout=d,this.languageTree=t,this.gridOptions=Fu.parseGridOptions(e),this.zoomOptions=Fu.parseZoomOptions(e),this.toolboxPosition=p,this.theme=Fu.parseThemeOptions(e),this.renderer=f,this.rendererOverrides=null!=(g=e.rendererOverrides)?g:null,this.parentWorkspace=null!=(s=e.parentWorkspace)?s:null,this.plugins=_}static parseMoveOptions(e,t){var r=e.move||{},n={};return void 0===r.scrollbars&&void 0===e.scrollbars?n.scrollbars=t:"object"==typeof r.scrollbars?(n.scrollbars={horizontal:!!r.scrollbars.horizontal,vertical:!!r.scrollbars.vertical},n.scrollbars.horizontal&&n.scrollbars.vertical?n.scrollbars=!0:n.scrollbars.horizontal||n.scrollbars.vertical||(n.scrollbars=!1)):n.scrollbars=!!r.scrollbars||!!e.scrollbars,n.wheel=n.scrollbars&&void 0!==r.wheel?!!r.wheel:"object"==typeof n.scrollbars,n.drag=!(!n.scrollbars||void 0!==r.drag&&!r.drag),n}static parseZoomOptions(e){e=e.zoom||{};var t={};return t.controls=void 0!==e.controls&&!!e.controls,t.wheel=void 0!==e.wheel&&!!e.wheel,t.startScale=void 0===e.startScale?1:Number(e.startScale),t.maxScale=void 0===e.maxScale?3:Number(e.maxScale),t.minScale=void 0===e.minScale?.3:Number(e.minScale),t.scaleSpeed=void 0===e.scaleSpeed?1.2:Number(e.scaleSpeed),t.pinch=void 0===e.pinch?t.wheel||t.controls:!!e.pinch,t}static parseGridOptions(e){e=e.grid||{};var t={};return t.spacing=Number(e.spacing)||0,t.colour=e.colour||"#888",t.length=void 0===e.length?1:Number(e.length),t.snap=0<t.spacing&&!!e.snap,t}static parseThemeOptions(e){return"string"==typeof(e=e.theme||Mu)?pa(_.THEME,e):e instanceof Pu?e:Pu.defineTheme(e.name||"builtin"+Ca(),e)}},Bu=class{constructor(e,t){this.bubble=e,this.workspace=t,this.startLoc=null}isMovable(){return!0}startDrag(){var e;this.startLoc=this.bubble.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null!=(e=this.workspace.getLayerManager())&&e.moveToDragLayer(this.bubble),this.bubble.setDragging&&this.bubble.setDragging(!0)}drag(e){this.bubble.moveDuringDrag(e)}endDrag(){var e;this.workspace.setResizesEnabled(!0),null!=(e=this.workspace.getLayerManager())&&e.moveOffDragLayer(this.bubble,100),this.bubble.setDragging(!1)}revertDrag(){this.startLoc&&this.bubble.moveDuringDrag(this.startLoc)}},D=class{constructor(e,t,r,n){this.workspace=e,this.anchor=t,this.ownerRect=r,this.size=new S(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.dragStrategy=new Bu(this,this.workspace),this.id=Ca(),this.svgRoot=l(x.G,{class:"blocklyBubble"},e.getBubbleCanvas()),e=l(x.G,{class:"blocklyEmboss"},this.svgRoot),this.tail=l(x.PATH,{class:"blocklyBubbleTail"},e),this.background=l(x.RECT,{class:"blocklyDraggable",x:0,y:0,rx:$u.BORDER_WIDTH,ry:$u.BORDER_WIDTH},e),this.contentContainer=l(x.G,{},this.svgRoot),this.focusableElement=null!=n?n:this.svgRoot,this.focusableElement.setAttribute("id",this.id),h(this.background,"pointerdown",this,this.onMouseDown)}dispose(){o(this.svgRoot),this.disposed=!0}setAnchorLocation(e,t=!1){this.anchor=e,t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(e,t){this.relativeLeft=e,this.relativeTop=t,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(e,t=!1){e.width=Math.max(e.width,$u.MIN_SIZE),e.height=Math.max(e.height,$u.MIN_SIZE),this.size=e,this.background.setAttribute("width",""+e.width),this.background.setAttribute("height",""+e.height),t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(e){this.colour=e,this.tail.setAttribute("fill",e),this.background.setAttribute("fill",e)}onMouseDown(e){var t;null!=(t=this.workspace.getGesture(e))&&t.handleBubbleStart(e,this),f.getFocusManager$$module$build$src$core$focus_manager().focusNode(this)}positionRelativeToAnchor(){var e=this.anchor.x,e=this.workspace.RTL?e-(this.relativeLeft+this.size.width):e+this.relativeLeft;this.moveTo(e,this.relativeTop+this.anchor.y)}moveTo(e,t){this.svgRoot.setAttribute("transform",`translate(${e}, ${t})`)}positionByRect(e=new E(0,0,0,0)){var t=this.workspace.getMetricsManager().getViewMetrics(!0),r=this.getOptimalRelativeLeft(t),n=this.getOptimalRelativeTop(t),i={x:r,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},s={x:-this.size.width-30,y:n},n={x:e.getWidth(),y:n},a={x:r,y:e.getHeight()},r=e.getWidth()<e.getHeight()?n:a,a=(e=e.getWidth()<e.getHeight()?a:n,n=this.getOverlap(i,t),this.getOverlap(s,t)),o=this.getOverlap(r,t),t=this.getOverlap(e,t);n===(t=Math.max(n,a,o,t))?(this.relativeLeft=i.x,this.relativeTop=i.y):a===t?(this.relativeLeft=s.x,this.relativeTop=s.y):o===t?(this.relativeLeft=r.x,this.relativeTop=r.y):(this.relativeLeft=e.x,this.relativeTop=e.y),this.positionRelativeToAnchor()}getOverlap(e,t){var r=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x+this.anchor.x;return e=e.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(r+this.size.width,t.left+t.width)-Math.max(r,t.left))*(Math.min(e+this.size.height,t.top+t.height)-Math.max(e,t.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(e){let t=-this.size.width/4;var r,n;return this.size.width>e.width||(e=this.getWorkspaceViewRect(e),this.workspace.RTL?(r=this.anchor.x-t)-this.size.width<e.left?t=-(e.left-this.anchor.x+this.size.width):r>e.right&&(t=-(e.right-this.anchor.x)):(n=(r=t+this.anchor.x)+this.size.width,r<e.left?t=e.left-this.anchor.x:n>e.right&&(t=e.right-this.anchor.x-this.size.width))),t}getOptimalRelativeTop(e){let t=-this.size.height/4;var r,n;return this.size.height>e.height||(n=(r=this.anchor.y+t)+this.size.height,r<(e=this.getWorkspaceViewRect(e)).top?t=e.top-this.anchor.y:n>e.bottom&&(t=e.bottom-this.anchor.y-this.size.height)),t}getWorkspaceViewRect(e){var t=e.top;let r=e.top+e.height,n=e.left;return e=e.left+e.width,r-=this.getScrollbarThickness(),this.workspace.RTL?n-=this.getScrollbarThickness():e-=this.getScrollbarThickness(),new E(t,r,n,e)}getScrollbarThickness(){return nl.scrollbarThickness/this.workspace.scale}renderTail(){var e,t,r,n,i,s,a,o=[],l=this.size.width/2,c=this.size.height/2,u=-this.relativeLeft,d=-this.relativeTop;l===u&&c==d?o.push("M "+l+","+c):(d-=c,u-=l,this.workspace.RTL&&(u*=-1),e=Math.sqrt(d*d+u*u),t=Math.acos(u/e),i=(t=d<0?2*Math.PI-t:t)+Math.PI/2,2*Math.PI<i&&(i-=2*Math.PI),r=Math.sin(i),a=Math.cos(i),n=(this.size.width+this.size.height)/$u.TAIL_THICKNESS,n=Math.min(n,this.size.width,this.size.height)/4,u=l+(i=1-$u.ANCHOR_RADIUS/e)*u,d=c+i*d,i=l+n*a,s=c+n*r,l-=n*a,c-=n*r,(r=t+(r=ar(this.workspace.RTL?-$u.TAIL_ANGLE:$u.TAIL_ANGLE)))>2*Math.PI&&(r-=2*Math.PI),t=Math.sin(r)*e/$u.TAIL_BEND,e=Math.cos(r)*e/$u.TAIL_BEND,o.push("M"+i+","+s),o.push("C"+(i+e)+","+(s+t)+" "+u+","+d+" "+u+","+d),o.push("C"+u+","+d+" "+(l+e)+","+(c+t)+" "+l+","+c)),o.push("z"),null!=(a=this.tail)&&a.setAttribute("d",o.join(" "))}bringToFront(){var e=null==(e=this.svgRoot)?void 0:e.parentNode;return!(!this.svgRoot||(null==e?void 0:e.lastChild)===this.svgRoot||(null!=e&&e.appendChild(this.svgRoot),0))}getRelativeToSurfaceXY(){return new k(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(e){this.moveTo(e.x,e.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x-this.anchor.x,this.relativeTop=e.y-this.anchor.y,this.renderTail()}setDragging(e){}setDeleteStyle(e){}isDeletable(){return!1}showContextMenu(e){}isMovable(){return!0}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){ce(this)}unselect(){ce(null)}getFocusableElement(){return this.focusableElement}getFocusableTree(){return this.workspace}onNodeFocus(){this.select(),this.bringToFront()}onNodeBlur(){this.unselect()}canBeFocused(){return!0}},$u=D,Uu=(D.BORDER_WIDTH=6,D.DOUBLE_BORDER=2*$u.BORDER_WIDTH,D.MIN_SIZE=$u.DOUBLE_BORDER,D.TAIL_THICKNESS=1,D.TAIL_ANGLE=20,D.TAIL_BEND=4,D.ANCHOR_RADIUS=8,class extends D{constructor(e,t,r,n){super(t,r,n),this.workspace=t,this.anchor=r,this.ownerRect=n,this.autoLayout=!0,t=new Fu(e),this.validateWorkspaceOptions(t),this.svgDialog=l(x.SVG,{x:D.BORDER_WIDTH,y:D.BORDER_WIDTH},this.contentContainer),e.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new Fu(e)),this.miniWorkspace.internalIsMutator=!0,e=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(e),t.languageTree&&(e.insertBefore(this.miniWorkspace.addFlyout(x.G),this.miniWorkspace.getCanvas()),null!=(e=this.miniWorkspace.getFlyout())&&e.init(this.miniWorkspace),null!=e)&&e.show(t.languageTree),c(this.svgRoot,"blocklyMiniWorkspaceBubble"),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this));let i,s;null!=(i=this.miniWorkspace.getFlyout())&&null!=(s=i.getWorkspace())&&s.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(e){this.miniWorkspace.addChangeListener(e)}validateWorkspaceOptions(e){if(e.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(e.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(e.zoomOptions.controls||e.zoomOptions.wheel||e.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(e.moveOptions.scrollbars||e.moveOptions.wheel||e.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(e.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging()||this.miniWorkspace.keyboardMoveInProgress)for(var t of this.miniWorkspace.getTopBlocks(!1)){var r=t.getRelativeToSurfaceXY();if(r.y<20&&t.moveBy(0,20-r.y),t.RTL){let e=-20;var n=this.miniWorkspace.getFlyout();n&&(e-=n.getWidth()),r.x>e&&t.moveBy(e-r.x,0)}else r.x<20&&t.moveBy(20-r.x,0)}}updateBubbleSize(){var e,t;this.miniWorkspace.isDragging()&&!this.miniWorkspace.keyboardMoveInProgress||(this.autoLayout&&(this.autoLayout=!this.miniWorkspace.keyboardMoveInProgress),e=this.getSize(),t=this.calculateWorkspaceSize(),Math.abs(e.width-t.width)<Uu.MINIMUM_VIEW_CHANGE&&Math.abs(e.height-t.height)<Uu.MINIMUM_VIEW_CHANGE)||(this.svgDialog.setAttribute("width",t.width+"px"),this.svgDialog.setAttribute("height",t.height+"px"),this.miniWorkspace.setCachedParentSvgSize(t.width,t.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform",`translate(${t.width}, 0)`),this.setSize(new S(t.width+D.DOUBLE_BORDER,t.height+D.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}calculateWorkspaceSize(){var e=this.miniWorkspace.getCanvas().getBBox();let t=e.width+Uu.MARGIN;e=e.height+Uu.MARGIN;var r,n=this.miniWorkspace.getFlyout();return n&&(r=n.getWorkspace().getMetricsManager().getScrollMetrics(),e=Math.max(e,r.height+20),t+=n.getWidth()),new S(t,e)}updateBlockStyles(){for(var e of this.miniWorkspace.getAllBlocks(!1))e.setStyle(e.getStyleName());var t;if(e=null==(t=this.miniWorkspace.getFlyout())?void 0:t.getWorkspace())for(var r of e.getAllBlocks(!1))r.setStyle(r.getStyleName())}moveDuringDrag(e){super.moveDuringDrag(e),this.autoLayout=!1}moveTo(e,t){super.moveTo(e,t),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(e){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}}),Vu=(Uu.MINIMUM_VIEW_CHANGE=10,Uu.MARGIN=3*D.DOUBLE_BORDER,class{constructor(e){this.sourceBlock=e,this.offsetInBlock=new k(0,0),this.workspaceLocation=new k(0,0),this.svgRoot=null,this.tooltip=e,this.id=Ca()}getType(){throw Error("Icons must implement getType")}initView(e){var t;this.svgRoot||(t=this.sourceBlock,this.svgRoot=l(x.G,{class:"blocklyIconGroup",id:this.id}),t.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),h(this.svgRoot,"pointerdown",this,e),this.svgRoot.tooltip=this,Mr(this.svgRoot))}dispose(){Fr(this.svgRoot),o(this.svgRoot)}getWeight(){return-1}getSize(){return new S(0,0)}setTooltip(e){this.tooltip=null!=e?e:this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.sourceBlock.isCollapsed()?this.svgRoot.style.display="none":this.svgRoot.style.display="block",sr(this))&&this.setBubbleVisible(!1)}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(e){this.offsetInBlock=e,this.updateSvgRootOffset()}updateSvgRootOffset(){var e;null!=(e=this.svgRoot)&&e.setAttribute("transform",`translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`)}onLocationChange(e){this.workspaceLocation=k.sum(e,this.offsetInBlock)}onClick(){}isClickableInFlyout(e){return!0}getFocusableElement(){var e=this.svgRoot;if(e)return e;throw Error("Attempting to focus uninitialized icon.")}getFocusableTree(){return this.sourceBlock.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getSourceBlock(){return this.sourceBlock}}),Hu=(f.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends Vu{constructor(e,t){super(t),this.flyoutBlockTypes=e,this.sourceBlock=t,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return f.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(e){this.svgRoot||(super.initView(e),l(x.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),l(x.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),l(x.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot),c(this.svgRoot,"blocklyMutatorIcon"))}dispose(){var e;super.dispose(),null!=(e=this.miniWorkspaceBubble)&&e.dispose()}getWeight(){return f.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new S(17,17)}applyColour(){var e;super.applyColour(),null!=(e=this.miniWorkspaceBubble)&&e.setColour(this.sourceBlock.getColour()),null!=(e=this.miniWorkspaceBubble)&&e.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(e){super.onLocationChange(e),null!=(e=this.miniWorkspaceBubble)&&e.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.sourceBlock.isEditable()&&this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(t){let r=this;return(0,p.asyncExecutePromiseGeneratorFunction)(function*(){var e;r.bubbleIsVisible()!==t&&(yield tt(),t?(r.miniWorkspaceBubble=new Uu(r.getMiniWorkspaceConfig(),r.sourceBlock.workspace,r.getAnchorLocation(),r.getBubbleOwnerRect()),r.applyColour(),r.createRootBlock(),r.addSaveConnectionsListener(),null!=(e=r.miniWorkspaceBubble)&&e.addWorkspaceChangeListener(r.createMiniWorkspaceChangeListener())):(null!=(e=r.miniWorkspaceBubble)&&e.dispose(),r.miniWorkspaceBubble=null,r.saveConnectionsListener&&r.sourceBlock.workspace.removeChangeListener(r.saveConnectionsListener),r.saveConnectionsListener=null),m(new(g(y.BUBBLE_OPEN))(r.sourceBlock,t,"mutator")))})}getBubble(){return this.miniWorkspaceBubble}getMiniWorkspaceConfig(){var e={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:null!=(e=this.sourceBlock.workspace.options.rendererOverrides)?e:void 0};return this.flyoutBlockTypes.length&&(e.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map(e=>({kind:"block",type:e}))}),e}getAnchorLocation(){return k.sum(this.workspaceLocation,new k(8.5,8.5))}getBubbleOwnerRect(){var e=this.sourceBlock.getSvgRoot().getBBox();return new E(e.y,e.y+e.height,e.x,e.x+e.width)}createRootBlock(){if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace());for(var e of this.rootBlock.getDescendants(!1))e.queueRender();var t;this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1),e=null!=(t=null==(t=this.miniWorkspaceBubble)||null==(t=t.getWorkspace())||null==(t=t.getFlyout())?void 0:t.getWidth())?t:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(e+16):16,16)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return e=>{f.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(e)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()},0))}}static isIgnorableMutatorEvent(e){return e.isUiEvent||Ia(e)||Da(e)&&"disabled"===e.element}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var e=f.getGroup$$module$build$src$core$events$utils(),t=(e||f.setGroup$$module$build$src$core$events$utils(!0),pc.getExtraBlockState_(this.sourceBlock)),r=(this.sourceBlock.compose(this.rootBlock),pc.getExtraBlockState_(this.sourceBlock));t!==r&&m(new(g(y.BLOCK_CHANGE))(this.sourceBlock,"mutation",null,t,r)),f.setGroup$$module$build$src$core$events$utils(e)}}getWorkspace(){var e;return null==(e=this.miniWorkspaceBubble)?void 0:e.getWorkspace()}},f.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=uc.MUTATOR,f.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1,f.MutatorIcon$$module$build$src$core$icons$mutator_icon,Object.create(null)),Gu={allExtensions:Hu},ju=(f.register$$module$build$src$core$extensions("parent_tooltip_when_inline",Hd),{TEST_ONLY:Gu}),Ku=(ju.apply=Qn,ju.buildTooltipForDropdown=f.buildTooltipForDropdown$$module$build$src$core$extensions,ju.buildTooltipWithFieldText=f.buildTooltipWithFieldText$$module$build$src$core$extensions,ju.isRegistered=Zn,ju.register=f.register$$module$build$src$core$extensions,ju.registerMixin=f.registerMixin$$module$build$src$core$extensions,ju.registerMutator=f.registerMutator$$module$build$src$core$extensions,ju.runAfterPageLoad=Wd,ju.unregister=P,(L=n=n||{})[L.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",L[L.MAC_ENTER=3]="MAC_ENTER",L[L.BACKSPACE=8]="BACKSPACE",L[L.TAB=9]="TAB",L[L.NUM_CENTER=12]="NUM_CENTER",L[L.ENTER=13]="ENTER",L[L.SHIFT=16]="SHIFT",L[L.CTRL=17]="CTRL",L[L.ALT=18]="ALT",L[L.PAUSE=19]="PAUSE",L[L.CAPS_LOCK=20]="CAPS_LOCK",L[L.ESC=27]="ESC",L[L.SPACE=32]="SPACE",L[L.PAGE_UP=33]="PAGE_UP",L[L.PAGE_DOWN=34]="PAGE_DOWN",L[L.END=35]="END",L[L.HOME=36]="HOME",L[L.LEFT=37]="LEFT",L[L.UP=38]="UP",L[L.RIGHT=39]="RIGHT",L[L.DOWN=40]="DOWN",L[L.PLUS_SIGN=43]="PLUS_SIGN",L[L.PRINT_SCREEN=44]="PRINT_SCREEN",L[L.INSERT=45]="INSERT",L[L.DELETE=46]="DELETE",L[L.ZERO=48]="ZERO",L[L.ONE=49]="ONE",L[L.TWO=50]="TWO",L[L.THREE=51]="THREE",L[L.FOUR=52]="FOUR",L[L.FIVE=53]="FIVE",L[L.SIX=54]="SIX",L[L.SEVEN=55]="SEVEN",L[L.EIGHT=56]="EIGHT",L[L.NINE=57]="NINE",L[L.FF_SEMICOLON=59]="FF_SEMICOLON",L[L.FF_EQUALS=61]="FF_EQUALS",L[L.FF_DASH=173]="FF_DASH",L[L.FF_HASH=163]="FF_HASH",L[L.QUESTION_MARK=63]="QUESTION_MARK",L[L.AT_SIGN=64]="AT_SIGN",L[L.A=65]="A",L[L.B=66]="B",L[L.C=67]="C",L[L.D=68]="D",L[L.E=69]="E",L[L.F=70]="F",L[L.G=71]="G",L[L.H=72]="H",L[L.I=73]="I",L[L.J=74]="J",L[L.K=75]="K",L[L.L=76]="L",L[L.M=77]="M",L[L.N=78]="N",L[L.O=79]="O",L[L.P=80]="P",L[L.Q=81]="Q",L[L.R=82]="R",L[L.S=83]="S",L[L.T=84]="T",L[L.U=85]="U",L[L.V=86]="V",L[L.W=87]="W",L[L.X=88]="X",L[L.Y=89]="Y",L[L.Z=90]="Z",L[L.META=91]="META",L[L.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",L[L.CONTEXT_MENU=93]="CONTEXT_MENU",L[L.NUM_ZERO=96]="NUM_ZERO",L[L.NUM_ONE=97]="NUM_ONE",L[L.NUM_TWO=98]="NUM_TWO",L[L.NUM_THREE=99]="NUM_THREE",L[L.NUM_FOUR=100]="NUM_FOUR",L[L.NUM_FIVE=101]="NUM_FIVE",L[L.NUM_SIX=102]="NUM_SIX",L[L.NUM_SEVEN=103]="NUM_SEVEN",L[L.NUM_EIGHT=104]="NUM_EIGHT",L[L.NUM_NINE=105]="NUM_NINE",L[L.NUM_MULTIPLY=106]="NUM_MULTIPLY",L[L.NUM_PLUS=107]="NUM_PLUS",L[L.NUM_MINUS=109]="NUM_MINUS",L[L.NUM_PERIOD=110]="NUM_PERIOD",L[L.NUM_DIVISION=111]="NUM_DIVISION",L[L.F1=112]="F1",L[L.F2=113]="F2",L[L.F3=114]="F3",L[L.F4=115]="F4",L[L.F5=116]="F5",L[L.F6=117]="F6",L[L.F7=118]="F7",L[L.F8=119]="F8",L[L.F9=120]="F9",L[L.F10=121]="F10",L[L.F11=122]="F11",L[L.F12=123]="F12",L[L.NUMLOCK=144]="NUMLOCK",L[L.SCROLL_LOCK=145]="SCROLL_LOCK",L[L.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",L[L.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",L[L.SEMICOLON=186]="SEMICOLON",L[L.DASH=189]="DASH",L[L.EQUALS=187]="EQUALS",L[L.COMMA=188]="COMMA",L[L.PERIOD=190]="PERIOD",L[L.SLASH=191]="SLASH",L[L.APOSTROPHE=192]="APOSTROPHE",L[L.TILDE=192]="TILDE",L[L.SINGLE_QUOTE=222]="SINGLE_QUOTE",L[L.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",L[L.BACKSLASH=220]="BACKSLASH",L[L.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",L[L.WIN_KEY=224]="WIN_KEY",L[L.MAC_FF_META=224]="MAC_FF_META",L[L.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",L[L.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",L[L.WIN_IME=229]="WIN_IME",L[L.VK_NONAME=252]="VK_NONAME",L[L.PHANTOM=255]="PHANTOM",{}),zu=(Ku.arc=mi,Ku.curve=ci,Ku.line=hi,Ku.lineOnAxis=d,Ku.lineTo=pi,Ku.moveBy=di,Ku.moveTo=ui,Ku.point=u,{}),N=(zu.Coordinate=k,zu.KeyCodes=n,zu.Rect=E,zu.Size=S,zu.Svg=x,zu.aria=C,zu.array=Wo,zu.browserEvents=bo,zu.colour=Jc,zu.deprecation=w,zu.dom=Mo,zu.extensions=ju,zu.idGenerator=Wa,zu.math=hc,zu.object=Uo,zu.parsing=Yc,zu.string=lc,zu.style=el,zu.svgMath=r,zu.svgPaths=Ku,zu.toolbox=ml,zu.userAgent=fo,zu.xml=qo,class{constructor(e,t){if(this.type=t,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,(this.sourceBlock_=e).id.includes("_connection"))throw Error("Connection ID indicator is contained in block ID. This will cause "+`problems with focus: ${e.id}.`);this.id=e.id+"_connection_"+Ca()}connect_(e){var t,r,n=v.INPUT_VALUE,i=this.getSourceBlock(),s=e.getSourceBlock();e.isConnected()&&e.disconnectInternal(!1);let a;this.isConnected()&&(t=this.stashShadowState(),(r=this.targetBlock()).isShadow()?r.dispose(!1):(this.disconnectInternal(),a=r),this.applyShadowState(t));let o;U()&&(o=new(g(y.BLOCK_MOVE))(s)).setReason(["connect"]),gi(this,e),s.setParent(i),o&&(o.recordNew(),m(o)),a&&(e=this.type===n?a.outputConnection:a.previousConnection)&&((s=N.getConnectionForOrphanedConnection(s,e))?e.connect(s):e.onFailedConnect(this))}dispose(){var e;this.isConnected()&&(this.isSuperior()&&this.setShadowStateInternal(),e=this.targetBlock())&&!e.isDeadOrDying()&&e.unplug(),this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===v.INPUT_VALUE||this.type===v.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(e){}connect(e){var t;return this.targetConnection===e||(this.getConnectionChecker().canConnect(this,e,!1)&&((t=f.getGroup$$module$build$src$core$events$utils())||f.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(e):e.connect_(this),f.setGroup$$module$build$src$core$events$utils(t)),this.isConnected())}disconnect(){this.disconnectInternal()}disconnectInternal(e=!0){var{parentConnection:t,childConnection:r}=this.getParentAndChildConnections();if(!t||!r)throw Error("Source connection not connected.");var n=f.getGroup$$module$build$src$core$events$utils();n||f.setGroup$$module$build$src$core$events$utils(!0);let i;U()&&(i=new(g(y.BLOCK_MOVE))(r.getSourceBlock())).setReason(["disconnect"]);var s=this.targetConnection;s&&(s.targetConnection=null),this.targetConnection=null,e&&r.getSourceBlock().setParent(null),i&&(i.recordNew(),m(i)),r.getSourceBlock().isShadow()||t.respawnShadow_(),f.setGroup$$module$build$src$core$events$utils(n)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(e,t){var r;return!(this.getSourceBlock().isDeadOrDying()||(t=null==(r=e.getInput(t))?void 0:r.connection,(r=this.targetBlock())&&r!==e)||!t||t.targetConnection===this||(t.isConnected()&&t.disconnect(),t.connect(this),0))}targetBlock(){var e;return this.isConnected()&&null!=(e=null==(e=this.targetConnection)?void 0:e.getSourceBlock())?e:null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return e?(Array.isArray(e)||(e=[e]),this.check=e,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(e){this.setShadowStateInternal({shadowDom:e})}getShadowDom(e){return e&&this.targetBlock().isShadow()?Ln(this.targetBlock()):this.shadowDom}setShadowState(e){this.setShadowStateInternal({shadowState:e})}getShadowState(e){return e&&this.targetBlock()&&this.targetBlock().isShadow()?Mt(this.targetBlock()):this.shadowState}neighbours(e){return[]}getParentInput(){let t=null;var r=this.sourceBlock_.inputList;for(let e=0;e<r.length;e++)if(r[e].connection===this){t=r[e];break}return t}toString(){var r=this.sourceBlock_;if(!r)return"Orphan Connection";if(r.outputConnection===this)var n="Output Connection of ";else if(r.previousConnection===this)n="Previous Connection of ";else if(r.nextConnection===this)n="Next Connection of ";else{n=null;for(let e=0,t;t=r.inputList[e];e++)if(t.connection===this){n=t;break}if(!n)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";n='Input "'+n.name+'" connection on '}return n+r.toDevString()}stashShadowState(){var e=this.getShadowDom(!0),t=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:e,shadowState:t}}applyShadowState({shadowDom:e,shadowState:t}){this.shadowDom=e,this.shadowState=t}setShadowStateInternal({shadowDom:e=null,shadowState:t=null}={}){this.shadowDom=e,this.shadowState=t,this.getSourceBlock().isDeadOrDying()||((e=this.targetBlock())?e.isShadow()?(e.dispose(!1),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())):(e=this.createShadowBlock(!1),this.serializeShadow(e),e&&e.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())))}createShadowBlock(e){var t=this.getSourceBlock(),r=this.getShadowState(),n=this.getShadowDom();if(!t.isDeadOrDying()&&(r||n)){if(r)return zt(r,t.workspace,{parentConnection:e?this:void 0,isShadow:!0,recordUndo:!1});if(n){if(t=Bn(n,t.workspace),e)if(this.type===v.INPUT_VALUE){if(!t.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(t.outputConnection))throw Error("Could not connect shadow block to connection")}else{if(this.type!==v.NEXT_STATEMENT)throw Error("Cannot connect a shadow block to a previous/output connection");if(!t.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(t.previousConnection))throw Error("Could not connect shadow block to connection")}return t}}return null}serializeShadow(e){e&&(this.shadowDom=Ln(e),this.shadowState=Mt(e))}static getConnectionForOrphanedConnection(e,t){if(t.type===v.OUTPUT_VALUE)return _i(e,t.getSourceBlock());e=e.lastConnectionInStack(!0);var r=t.getConnectionChecker();return e&&r.canConnect(t,e,!1)?e:null}}),Wu=(N.CAN_CONNECT=0,N.REASON_SELF_CONNECTION=1,N.REASON_WRONG_TYPE=2,N.REASON_TARGET_NULL=3,N.REASON_CHECKS_FAILED=4,N.REASON_DIFFERENT_WORKSPACES=5,N.REASON_SHADOW_PARENT=6,N.REASON_DRAG_CHECKS_FAILED=7,N.REASON_PREVIOUS_AND_OUTPUT=8,class extends Error{constructor(e){super(`Tried to append an icon of type ${e.getType()} when an icon of `+"that type already exists on the block. Use getIcon to access the existing icon."),this.icon=e}}),qu={},Ju=(qu.DuplicateIconType=Wu,(Xp=f.Align$$module$build$src$core$inputs$align||(f.Align$$module$build$src$core$inputs$align={}))[Xp.LEFT=-1]="LEFT",Xp[Xp.CENTRE=0]="CENTRE",Xp[Xp.RIGHT=1]="RIGHT",f.Align$$module$build$src$core$inputs$align,class extends I{constructor(e,t,r){super(I.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,e!==I.SKIP_SETUP&&(r?this.configure_(r):this.class=t||null,this.setValue(e))}configure_(e){super.configure_(e),e.class&&(this.class=e.class)}initView(){this.createTextElement_(),this.class&&c(this.getTextElement(),this.class),this.fieldGroup_&&c(this.fieldGroup_,"blocklyLabelField")}doClassValidation_(e){return null==e?null:""+e}setClass(e){this.textElement_&&(this.class&&a(this.textElement_,this.class),e)&&c(this.textElement_,e),this.class=e}static fromJson(e){return new this(nn(e.text),void 0,e)}}),Yu=(Xd("field_label",Ju),Ju.prototype.DEFAULT_VALUE="",[]),Xu=(Yu[v.INPUT_VALUE]=v.OUTPUT_VALUE,Yu[v.OUTPUT_VALUE]=v.INPUT_VALUE,Yu[v.NEXT_STATEMENT]=v.PREVIOUS_STATEMENT,Yu[v.PREVIOUS_STATEMENT]=v.NEXT_STATEMENT,"RENAME_VARIABLE_ID"),Zu="DELETE_VARIABLE_ID",Qu=class extends N{constructor(e,t){super(e,t),this.highlighted=!1,this.targetConnection=null,this.db=e.workspace.connectionDBList[t],this.dbOpposite=e.workspace.connectionDBList[Yu[t]],this.offsetInBlock=new k(0,0),this.trackedState=Qu.TrackedState.WILL_TRACK}dispose(){var e,t;super.dispose(),this.trackedState===Qu.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),null!=(t=(e=this.sourceBlock_.pathObject).removeConnectionHighlight)&&t.call(e,this)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(e){var t=this.x-e.x;return e=this.y-e.y,Math.sqrt(t*t+e*e)}bumpAwayFrom(e,t=!1){if(!this.sourceBlock_.workspace.isDragging()){var r=f.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random()),n=f.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random()),i=e.sourceBlock_.getRootBlock(),s=this.sourceBlock_.getRootBlock();if(!i.isInFlyout&&!s.isInFlyout){var a=!0;if(s.isMovable())i.isMovable()&&t&&(n=-n);else{if(!i.isMovable())return;a=!1,r=-r,n=-n}(i=a?s:i).RTL&&(r=-r),i.moveBy((t=a?e:this).x+r-(e=a?this:e).x,t.y+n-e.y,["bump"])}}}moveTo(e,t){let r=!1;return this.trackedState===Qu.TrackedState.WILL_TRACK?(this.db.addConnection(this,t),this.trackedState=Qu.TrackedState.TRACKED,r=!0):this.trackedState===Qu.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,t),r=!0),this.x=e,this.y=t,r}moveBy(e,t){return this.moveTo(this.x+e,this.y+t)}moveToOffset(e){return this.moveTo(e.x+this.offsetInBlock.x,e.y+this.offsetInBlock.y)}setOffsetInBlock(e,t){this.offsetInBlock.x=e,this.offsetInBlock.y=t}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var e=this.targetConnection,t=this.targetBlock();e&&t&&(e=k.difference(this.offsetInBlock,e.offsetInBlock),t.translate(e.x,e.y))}closest(e,t){return this.dbOpposite.searchForClosest(this,e,t)}highlight(){this.highlighted=!0;var e=this.findHighlightSvg();e&&(e.style.display="")}unhighlight(){this.highlighted=!1;var e=this.findHighlightSvg();e&&(e.style.display="none")}isHighlighted(){return this.highlighted}setTracking(e){e&&this.trackedState===Qu.TrackedState.TRACKED||!e&&this.trackedState===Qu.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db.addConnection(this,this.y),this.trackedState=Qu.TrackedState.TRACKED):(this.trackedState===Qu.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=Qu.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){var t=this.targetBlock().getDescendants(!1);for(let e=0;e<t.length;e++){var r,n=t[e],i=n.getConnections_(!0);for(let e=0;e<i.length;e++)i[e].setTracking(!1);for(r of n.getIcons())sr(r)&&r.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let r=[];if(this.type===v.INPUT_VALUE||this.type===v.NEXT_STATEMENT){var e=this.targetBlock();if(e){let t;e.isCollapsed()?(t=[],e.outputConnection&&t.push(e.outputConnection),e.nextConnection&&t.push(e.nextConnection),e.previousConnection&&t.push(e.previousConnection)):t=e.getConnections_(!0);for(let e=0;e<t.length;e++)r.push(...t[e].startTrackingAll());r.length||(r=[e])}}return r}onFailedConnect(t){let r=this.getSourceBlock();if(So){let e=f.getGroup$$module$build$src$core$events$utils();setTimeout(function(){r.isDisposed()||r.getParent()||(f.setGroup$$module$build$src$core$events$utils(e),this.bumpAwayFrom(t),f.setGroup$$module$build$src$core$events$utils(!1))}.bind(this),f.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(e=!0){var t,{parentConnection:r,childConnection:n}=this.getParentAndChildConnections();r&&n&&((t=f.getGroup$$module$build$src$core$events$utils())||f.setGroup$$module$build$src$core$events$utils(!0),r=r.getSourceBlock(),n=n.getSourceBlock(),super.disconnectInternal(e),r.queueRender(),n.updateDisabled(),n.queueRender(),n.getSvgRoot().style.display="block",f.setGroup$$module$build$src$core$events$utils(t))}respawnShadow_(){super.respawnShadow_();var e=this.targetBlock();e&&(e.initSvg(),e.queueRender())}neighbours(e){return this.dbOpposite.getNeighbours(this,e)}connect_(e){super.connect_(e);var t=this.getSourceBlock();e=e.getSourceBlock(),t.updateDisabled(),e.updateDisabled(),e.queueRender(),(t=t.getInputWithBlock(e))&&(t=t.isVisible(),e.getSvgRoot().style.display=t?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return super.setCheck(e),this.sourceBlock_.queueRender(),this}showContextMenu(e){var t,r,n,i=A.registry.getContextMenuOptions({focusedNode:this},e);i.length&&(r=(t=this.getSourceBlock()).workspace,n=e instanceof PointerEvent?new k(e.clientX,e.clientY):(n=new k(this.x,this.y),Oe(r,n).translate(t.RTL?-5:5,5)),bn(e,i,t.RTL,r,n))}getFocusableElement(){var e=this.findHighlightSvg();if(e)return e;throw Error("No highlight SVG found corresponding to this connection.")}getFocusableTree(){return this.getSourceBlock().workspace}onNodeFocus(){this.highlight()}onNodeBlur(){this.unhighlight()}canBeFocused(){return!0}findHighlightSvg(){return document.getElementById(this.id)}},ed=((ch=(ch=Qu=Qu||{}).TrackedState||(ch.TrackedState={}))[ch.WILL_TRACK=-1]="WILL_TRACK",ch[ch.UNTRACKED=0]="UNTRACKED",ch[ch.TRACKED=1]="TRACKED",Qu.TrackedState,class{constructor(e,t){this.name=e,this.sourceBlock=t,this.fieldRow=[],this.align=f.Align$$module$build$src$core$inputs$align.LEFT,this.visible=!0,this.type=f.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(e,t){return this.insertFieldAt(this.fieldRow.length,e,t),this}insertFieldAt(e,t,r){if(e<0||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return(t||""===t&&r)&&((t="string"==typeof t?f.fromJson$$module$build$src$core$field_registry({type:"field_label",text:t}):t).setSourceBlock(this.sourceBlock),this.sourceBlock.initialized&&this.initField(t),t.name=r,t.setVisible(this.isVisible()),t.prefixField&&(e=this.insertFieldAt(e,t.prefixField)),this.fieldRow.splice(e,0,t),e++,t.suffixField&&(e=this.insertFieldAt(e,t.suffixField)),this.sourceBlock.rendered)&&this.sourceBlock.queueRender(),e}removeField(r,e){for(let e=0,t;t=this.fieldRow[e];e++)if(t.name===r)return t.dispose(),this.fieldRow.splice(e,1),this.sourceBlock.rendered&&this.sourceBlock.queueRender(),!0;if(e)return!1;throw Error('Field "'+r+'" not found.')}isVisible(){return this.visible}setVisible(r){let e=[];if(this.visible!==r){this.visible=r;for(let e=0,t;t=this.fieldRow[e];e++)t.setVisible(r);var t;this.connection&&this.connection instanceof Qu&&(r?e=this.connection.startTrackingAll():this.connection.stopTrackingAll(),t=this.connection.targetBlock())&&(t.getSvgRoot().style.display=r?"block":"none")}return e}markDirty(){for(let e=0,t;t=this.fieldRow[e];e++)t.markDirty()}setCheck(e){if(this.connection)return this.connection.setCheck(e),this;throw Error("This input does not have a connection.")}setAlign(e){return this.align=e,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(e){if(this.connection)return this.connection.setShadowDom(e),this;throw Error("This input does not have a connection.")}getShadowDom(){if(this.connection)return this.connection.getShadowDom();throw Error("This input does not have a connection.")}init(){for(var e of this.fieldRow)e.init()}initModel(){for(var e of this.fieldRow)e.initModel()}initField(e){this.sourceBlock.rendered?e.init():e.initModel()}dispose(){for(let e=0,t;t=this.fieldRow[e];e++)t.dispose();this.connection&&this.connection.dispose()}makeConnection(e){return this.sourceBlock.makeConnection_(e)}}),td=class extends ed{constructor(e,t){super(e,t),this.name=e,this.type=f.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},rd=class extends ed{constructor(e,t){super(e,t),this.name=e,this.type=f.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},nd=class extends ed{constructor(e,t){if(!e)throw Error("Statement inputs must have a non-empty name");super(e,t),this.name=e,this.type=f.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(v.NEXT_STATEMENT)}},id=(f.ValueInput$$module$build$src$core$inputs$value_input=class extends ed{constructor(e,t){if(!e)throw Error("Value inputs must have a non-empty name");super(e,t),this.name=e,this.type=f.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(v.INPUT_VALUE)}},f.ValueInput$$module$build$src$core$inputs$value_input,class{constructor(e,t,r){if(this.data=null,this.disposed=!1,this.hue=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabledReasons=new Set,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable=this.movable=this.deletable=!0,this.collapsed_=this.shadow=!1,this.outputShape_=null,this.rendered=this.isInsertionMarker_=this.initialized=this.disposing=!1,this.onchangeWrapper=this.helpUrl=null,this.statementInputCount=0,this.workspace=e,this.id=r&&!e.getBlockById(r)?r:wa(),e.setBlockById(this.id,this),this.xy=new k(0,0),this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,t){if(this.type=t,!(r=Ua[t])||"object"!=typeof r)throw TypeError("Invalid block definition for type: "+t);Object.assign(this,r)}e.addTopBlock(this),e.addTypedBlock(this),new.target===id&&this.doInit_()}doInit_(){var e=f.getGroup$$module$build$src$core$events$utils(),t=(e||f.setGroup$$module$build$src$core$events$utils(!0),So);try{"function"==typeof this.init&&(f.setRecordUndo$$module$build$src$core$events$utils(!1),this.init(),f.setRecordUndo$$module$build$src$core$events$utils(t)),U()&&m(new(g(y.BLOCK_CREATE))(this))}finally{f.setGroup$$module$build$src$core$events$utils(e),f.setRecordUndo$$module$build$src$core$events$utils(t)}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)}dispose(e=!1){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.unplug(e),U()&&m(new(g(y.BLOCK_DELETE))(this)),this.workspace.removeTopBlock(this),this.disposeInternal()}disposeInternal(){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),"function"==typeof this.destroy&&this.destroy(),this.childBlocks_.forEach(e=>e.disposeInternal()),this.inputList.forEach(e=>e.dispose()),this.inputList.length=0,this.getConnections_(!0).forEach(e=>e.dispose()),this.disposed=!0}isDeadOrDying(){return this.disposing||this.disposed}initModel(){if(!this.initialized){for(var e of this.inputList)e.initModel();this.initialized=!0}}unplug(e){this.outputConnection&&this.unplugFromRow(e),this.previousConnection&&this.unplugFromStack(e)}unplugFromRow(e){let t=null,r;null!=(r=this.outputConnection)&&r.isConnected()&&(t=this.outputConnection.targetConnection,this.outputConnection.disconnect()),t&&(e=e&&this.getOnlyValueConnection())&&e.isConnected()&&!e.targetBlock().isShadow()&&(null!=(e=e.targetConnection)&&e.disconnect(),this.workspace.connectionChecker.canConnect(e,t,!1)?t.connect(e):null!=e&&e.onFailedConnect(t))}getOnlyValueConnection(){let t=null;for(let e=0;e<this.inputList.length;e++){var r=this.inputList[e].connection;if(r&&r.type===v.INPUT_VALUE&&r.targetConnection){if(t)return null;t=r}}return t}unplugFromStack(e){let t=null;var r;null!=(r=this.previousConnection)&&r.isConnected()&&(t=this.previousConnection.targetConnection,this.previousConnection.disconnect()),r=this.getNextBlock(),e&&r&&!r.isShadow()&&(null!=(e=null!=(r=null==(r=this.nextConnection)?void 0:r.targetConnection)?r:null)&&e.disconnect(),t)&&this.workspace.connectionChecker.canConnect(t,e,!1)&&t.connect(e)}getConnections_(r){r=[],this.outputConnection&&r.push(this.outputConnection),this.previousConnection&&r.push(this.previousConnection),this.nextConnection&&r.push(this.nextConnection);for(let e=0,t;t=this.inputList[e];e++)t.connection&&r.push(t.connection);return r}lastConnectionInStack(e){let t=this.nextConnection;for(;t;){var r=t.targetBlock();if(!r||e&&r.isShadow())return t;t=r.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(r){for(let e=0,t;t=this.inputList[e];e++)if(t.connection&&t.connection.targetBlock()===r)return t;return null}getSurroundParent(){let e=this,t;do{if(!(e=(t=e).getParent()))return null}while(e.getNextBlock()===t);return e}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let e,t=this;for(;t=(e=t).parentBlock_;);return e}getTopStackBlock(){let e=this,t;for(;(t=e.getPreviousBlock())&&t.getNextBlock()===e&&(e=t););return e}getChildren(r){if(!r)return this.childBlocks_;r=[];for(let e=0,t;t=this.inputList[e];e++){var n;t.connection&&(n=t.connection.targetBlock())&&r.push(n)}return(n=this.getNextBlock())&&r.push(n),r}setParent(e){if(e!==this.parentBlock_){var t=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),r=!!t;if(r&&e&&t!==e)throw Error("Block connected to superior one that is not new parent.");if(!r&&e)throw Error("Block not connected to new parent.");if(r&&!e)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?fe(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(r){var n=[this],i=this.getChildren(r);for(let e,t=0;e=i[t];t++)n.push(...e.getDescendants(r));return n}isDeletable(){return this.deletable&&!this.isInFlyout&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnDeletable(){return this.deletable}setDeletable(e){this.deletable=e}isMovable(){return this.movable&&!this.isInFlyout&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnMovable(){return this.movable}setMovable(e){this.movable=e}isDuplicatable(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(pe(this,!0))}isShadow(){return this.shadow}setShadow(e){this.shadow=e}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(e){this.isInsertionMarker_=e}isEditable(){return this.editable&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setEditable(e){this.editable=e;for(var t of this.getFields())t.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(var e of this.inputList)if(e.connection||1<e.fieldRow.length)return!1;return!0}getMatchingConnection(t,r){var n=this.getConnections_(!0);if(t=t.getConnections_(!0),n.length!==t.length)throw Error("Connection lists did not match in length.");for(let e=0;e<t.length;e++)if(t[e]===r)return n[e];return null}setHelpUrl(e){this.helpUrl=e}setTooltip(e){this.tooltip=e}getTooltip(){return Rr(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue}setColour(e){e=sn(e),this.hue=e.hue,this.colour_=e.hex}setStyle(e){this.styleName_=e}setOnChange(e){if(e&&"function"!=typeof e)throw Error("onchange must be a function.");this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.onchange=e,this.onchangeWrapper=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper)}getField(e){if("string"!=typeof e)throw TypeError("Block.prototype.getField expects a string with the field name but received "+(void 0===e?"nothing":e+" of type "+typeof e)+" instead");for(var t of this.getFields())if(t.name===e)return t;return null}*getFields(){for(var e of this.inputList)for(var t of e.fieldRow)yield t}getVars(){var e,t=[];for(e of this.getFields())e.referencesVariables()&&t.push(e.getValue());return t}getVarModels(){var e,t,r=[];for(e of this.getFields())e.referencesVariables()&&(t=this.workspace.getVariableById(e.getValue()))&&r.push(t);return r}updateVarName(e){for(var t of this.getFields())t.referencesVariables()&&e.getId()===t.getValue()&&t.refreshVariableName()}renameVarById(e,t){for(var r of this.getFields())r.referencesVariables()&&e===r.getValue()&&r.setValue(t)}getFieldValue(e){return(e=this.getField(e))?e.getValue():null}setFieldValue(e,t){var r=this.getField(t);if(!r)throw Error('Field "'+t+'" not found.');r.setValue(e)}setPreviousStatement(e,t){if(e)void 0===t&&(t=null),this.previousConnection||(this.previousConnection=this.makeConnection_(v.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(t);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(e,t){if(e)void 0===t&&(t=null),this.nextConnection||(this.nextConnection=this.makeConnection_(v.NEXT_STATEMENT)),this.nextConnection.setCheck(t);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(e,t){if(e)void 0===t&&(t=null),this.outputConnection||(this.outputConnection=this.makeConnection_(v.OUTPUT_VALUE)),this.outputConnection.setCheck(t);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(e){this.inputsInline!==e&&(m(new(g(y.BLOCK_CHANGE))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)}getInputsInline(){if(void 0!==this.inputsInline)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof td&&this.inputList[e]instanceof td)return!1;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof f.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[e]instanceof td)return!0;for(e=0;e<this.inputList.length;e++)if(this.inputList[e]instanceof rd)return!0;return!1}setOutputShape(e){this.outputShape_=e}getOutputShape(){return this.outputShape_}isEnabled(){return 0===this.disabledReasons.size}setDisabledReason(e,t){e||this.workspace.options.disable||!this.hasDisabledReason(Il)||t==Il||this.setDisabledReason(!1,Il),this.disabledReasons.has(t)!==e&&(e?this.disabledReasons.add(t):this.disabledReasons.delete(t),(e=new(g(y.BLOCK_CHANGE))(this,"disabled",null,!e,e)).setDisabledReason(t),m(e))}getInheritedDisabled(){let e=this.getSurroundParent();for(;e;){if(!e.isEnabled())return!0;e=e.getSurroundParent()}return!1}hasDisabledReason(e){return this.disabledReasons.has(e)}getDisabledReasons(){return this.disabledReasons}isCollapsed(){return this.collapsed_}setCollapsed(e){this.collapsed_!==e&&(m(new(g(y.BLOCK_CHANGE))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)}toString(e,t){t=this.toTokens(t);for(let e=2;e<t.length;e++)"("===t[e-2]&&")"===t[e]&&(t[e-2]=t[e-1],t.splice(e-1,2));let r="";return t=(t=t.reduce((e,t)=>(e=e+("("===r||")"===t?"":" ")+t,r=t[t.length-1],e),"")).trim()||"???",t=e&&t.length>e?t.substring(0,e-3)+"...":t}toTokens(t="?"){var r,n=[];for(r of this.inputList)if(r.name!=Cl){for(var e of r.fieldRow)n.push(e.getText());if(r.connection){var i=r.connection.targetBlock();if(i){var s=r.connection;let e=s.getCheck();(s=!!(e=!e&&s.targetConnection?s.targetConnection.getCheck():e)&&(e.includes("Boolean")||e.includes("Number")))&&n.push("("),n.push(...i.toTokens(t)),s&&n.push(")")}else n.push(t)}}return n}appendValueInput(e){return this.appendInput(new f.ValueInput$$module$build$src$core$inputs$value_input(e,this))}appendStatementInput(e){return this.statementInputCount++,this.appendInput(new nd(e,this))}appendDummyInput(e=""){return this.appendInput(new td(e,this))}appendEndRowInput(e=""){return this.appendInput(new rd(e,this))}appendInput(e){return this.inputList.push(e),e}appendInputFromRegistry(e,t){return(e=da(_.INPUT,e,!1))?this.appendInput(new e(t,this)):null}jsonInit(e){var t=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(t+"Must not have both an output and a previousStatement.");for(var r=0;e["args"+r];){if(void 0===e["message"+r])throw Error(t+`args${r} must have a corresponding message (message${r}).`);r++}if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(t+"Must not have both a colour and a style.");for(e.style?this.jsonInitStyle(e,t):this.jsonInitColour(e,t),r=0;void 0!==e["message"+r];)this.interpolate(e["message"+r],e["args"+r]||[],e["implicitAlign"+r]||e["lastDummyAlign"+r],t),r++;if(void 0!==e.inputsInline&&(f.disable$$module$build$src$core$events$utils(),this.setInputsInline(e.inputsInline),f.enable$$module$build$src$core$events$utils()),void 0!==e.output&&this.setOutput(!0,e.output),void 0!==e.outputShape&&this.setOutputShape(e.outputShape),void 0!==e.previousStatement&&this.setPreviousStatement(!0,e.previousStatement),void 0!==e.nextStatement&&this.setNextStatement(!0,e.nextStatement),void 0!==e.tooltip&&(r=nn(e.tooltip),this.setTooltip(r)),void 0!==e.enableContextMenu&&(this.contextMenu=!!e.enableContextMenu),void 0!==e.suppressPrefixSuffix&&(this.suppressPrefixSuffix=!!e.suppressPrefixSuffix),void 0!==e.helpUrl&&(r=nn(e.helpUrl),this.setHelpUrl(r)),"string"==typeof e.extensions&&(console.warn(t+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),void 0!==e.mutator&&Qn(e.mutator,this,!0),e=e.extensions,Array.isArray(e))for(t=0;t<e.length;t++)Qn(e[t],this,!1)}jsonInitColour(t,r){if("colour"in t)if(void 0===t.colour)console.warn(r+"Undefined colour value.");else{t=t.colour;try{this.setColour(t)}catch(e){console.warn(r+"Illegal colour value: ",t)}}}jsonInitStyle(t,r){t=t.style;try{this.setStyle(t)}catch(e){console.warn(r+"Style does not exist: ",t)}}mixin(e,t){if(void 0!==t&&"boolean"!=typeof t)throw Error("opt_disableCheck must be a boolean if provided");if(!t){for(var r in t=[],e)void 0!==this[r]&&t.push(r);if(t.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(t))}Object.assign(this,e)}interpolate(r,n,i,s){r=rn(r),this.validateTokens(r,n.length),n=this.interpolateArguments(r,n,i),i=[];for(let e=0,t;t=n[e];e++)if(this.isInputKeyword(t.type)){if(r=this.inputFromJson(t,s)){for(let e=0,t;t=i[e];e++)r.appendField(t[0],t[1]);i.length=0}}else(r=this.fieldFromJson(t))&&i.push([r,t.name])}validateTokens(t,r){var n=[];let i=0;for(let e=0;e<t.length;e++){var s=t[e];if("number"==typeof s){if(s<1||r<s)throw Error('Block "'+this.type+'": Message index %'+s+" out of range.");if(n[s])throw Error('Block "'+this.type+'": Message index %'+s+" duplicated.");n[s]=!0,i++}}if(i!==r)throw Error('Block "'+this.type+'": Message does not reference all '+r+" arg(s).")}interpolateArguments(t,r,n){var i=[];for(let e=0;e<t.length;e++){var s=t[e];if("string"==typeof(s="number"==typeof s?r[s-1]:s))if("\n"===s)s={type:"input_end_row"},n&&(s.align=n);else if(!(s=this.stringToFieldJson(s)))continue;i.push(s)}return(t=i.length)&&!this.isInputKeyword(i[t-1].type)&&(t={type:"input_dummy"},n&&(t.align=n),i.push(t)),i}fieldFromJson(e){var t=f.fromJson$$module$build$src$core$field_registry(e);return!t&&e.alt?"string"==typeof e.alt?(e=this.stringToFieldJson(e.alt))?this.fieldFromJson(e):null:this.fieldFromJson(e.alt):t}inputFromJson(e,t){let r={LEFT:f.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:f.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:f.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:f.Align$$module$build$src$core$inputs$align.CENTRE},n;switch(e.type){case"input_value":n=this.appendValueInput(e.name);break;case"input_statement":n=this.appendStatementInput(e.name);break;case"input_dummy":n=this.appendDummyInput(e.name);break;case"input_end_row":n=this.appendEndRowInput(e.name);break;default:n=this.appendInputFromRegistry(e.type,e.name)}return n?(e.check&&n.setCheck(e.check),e.align&&(void 0===(r=r[e.align.toUpperCase()])?console.warn(t+"Illegal align value: ",e.align):n.setAlign(r)),n):null}isInputKeyword(e){return"input_value"===e||"input_statement"===e||"input_dummy"===e||"input_end_row"===e||ua(_.INPUT,e)}stringToFieldJson(e){return(e=e.trim())?{type:"field_label",text:e}:null}moveInputBefore(r,n){if(r!==n){var i=-1,s=n?-1:this.inputList.length;for(let e=0,t;t=this.inputList[e];e++)if(t.name===r){if(i=e,-1!==s)break}else if(n&&t.name===n&&(s=e,-1!==i))break;if(-1===i)throw Error('Named input "'+r+'" not found.');if(-1===s)throw Error('Reference input "'+n+'" not found.');this.moveNumberedInputBefore(i,s)}}moveNumberedInputBefore(e,t){if(e===t)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(t>this.inputList.length)throw RangeError("Reference input "+t+" out of bounds.");var r=this.inputList[e];this.inputList.splice(e,1),e<t&&t--,this.inputList.splice(t,0,r)}removeInput(r,e){for(let e=0,t;t=this.inputList[e];e++)if(t.name===r)return t instanceof nd&&this.statementInputCount--,t.dispose(),this.inputList.splice(e,1),!0;if(e)return!1;throw Error("Input not found: "+r)}getInput(r){for(let e=0,t;t=this.inputList[e];e++)if(t.name===r)return t;return null}getInputTargetBlock(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()}getCommentText(){var e;return null!=(e=null==(e=this.getIcon(uc.COMMENT))?void 0:e.getText())?e:null}setCommentText(e){var t,r=null!=(r=null==(t=this.getIcon(uc.COMMENT))?void 0:t.getText())?r:null;if(r!==e){if(null!==e){if(!(t=this.getIcon(uc.COMMENT))){if(!(t=da(_.ICON,uc.COMMENT.toString(),!1)))throw Error("No comment icon class is registered, so a comment cannot be set");if(t=new t(this),!bi(t))throw Error("The class registered as a comment icon does not conform to the ICommentIcon interface");t=this.addIcon(t)}f.disable$$module$build$src$core$events$utils(),t.setText(e),f.enable$$module$build$src$core$events$utils()}else this.removeIcon(uc.COMMENT);m(new(g(y.BLOCK_CHANGE))(this,"comment",null,r,e))}}setWarningText(e,t){}setMutator(e){}addIcon(e){if(this.hasIcon(e.getType()))throw new Wu(e);return this.icons.push(e),this.icons.sort((e,t)=>e.getWeight()-t.getWeight()),e}removeIcon(t){var e;return!!this.hasIcon(t)&&(null!=(e=this.getIcon(t))&&e.dispose(),this.icons=this.icons.filter(e=>!e.getType().equals(t)),!0)}hasIcon(t){return this.icons.some(e=>e.getType().equals(t))}getIcon(t){return t instanceof uc?this.icons.find(e=>e.getType().equals(t)):this.icons.find(e=>e.getType().toString()===t)}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy}moveBy(e,t,r){if(this.parentBlock_)throw Error("Block has parent");var n=new(g(y.BLOCK_MOVE))(this);r&&n.setReason(r),this.xy.translate(e,t),n.recordNew(),m(n)}makeConnection_(e){return new N(this,e)}allInputsFilled(r){if(!(r=void 0===r?!0:r)&&this.isShadow())return!1;for(let e=0,t;t=this.inputList[e];e++)if(t.connection){var n=t.connection.targetBlock();if(!n||!n.allInputsFilled(r))return!1}return!(n=this.getNextBlock())||n.allInputsFilled(r)}toDevString(){let e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e}}),sd=(id.COLLAPSED_INPUT_NAME=Cl,id.COLLAPSED_FIELD_NAME=wl,null),ad=null,od={},ld=(od.connectionUiEffect=ki,od.disconnectUiEffect=xi,od.disconnectUiStop=Si,od.disposeUiEffect=vi,class{paste(e,t,r){if(!t.isCapacityAvailable(e.typeCounts))return null;r&&(e.blockState.x=r.x,e.blockState.y=r.y),r=r||new k(e.blockState.x||0,e.blockState.y||0),f.disable$$module$build$src$core$events$utils();let n;try{n=Kt(e.blockState,t),Ci(n,r)}finally{f.enable$$module$build$src$core$events$utils()}if(n){U()&&!n.isShadow()&&m(new(g(y.BLOCK_CREATE))(n));let e=n;tt().then(()=>f.getFocusManager$$module$build$src$core$focus_manager().focusNode(e))}return n}}),cd=(uh(ld.TYPE="block",new ld),{}),ud=(cd.bumpIntoBounds=Ai,cd.bumpIntoBoundsHandler=Di,cd.bumpTopObjectsIntoBounds=Oi,class{constructor(e){this.block=e,this.connectionPreviewer=this.connectionCandidate=this.startLoc=this.startChildConn=this.startParentConn=null,this.dragging=!1,this.dragOffset=new k(0,0),this.originalEventGroup="",this.workspace=e.workspace}isMovable(){var e;return this.block.isShadow()?null!=(e=null==(e=this.block.getParent())?void 0:e.isMovable())&&e:this.block.isOwnMovable()&&!this.block.isDeadOrDying()&&!this.workspace.isReadOnly()&&!this.block.isInFlyout}startDrag(e){this.block.isShadow()?this.startDraggingShadow(e):(this.dragging=!0,this.fireDragStartEvent(),this.startLoc=this.block.getRelativeToSurfaceXY(),this.connectionCandidate=null,this.connectionPreviewer=new(ma(_.CONNECTION_PREVIEWER,this.workspace.options))(this.block),q(),this.workspace.setResizesEnabled(!1),Si(),e=this.shouldHealStack(e),this.shouldDisconnect(e)&&this.disconnectBlock(e),this.block.setDragging(!0),null!=(e=this.workspace.getLayerManager())&&e.moveToDragLayer(this.block))}shouldHealStack(e){return!!e&&(e.altKey||e.ctrlKey||e.metaKey)}startDraggingShadow(e){var t=this.block.getParent();if(!t)throw Error("Tried to drag a shadow block with no parent. Shadow blocks should always have parents.");this.dragOffset=k.difference(t.getRelativeToSurfaceXY(),this.block.getRelativeToSurfaceXY()),t.startDrag(e)}shouldDisconnect(e){return!!(this.block.getParent()||e&&this.block.nextConnection&&this.block.nextConnection.targetBlock())}disconnectBlock(e){var t;this.startParentConn=null!=(t=null==(t=this.block.outputConnection)?void 0:t.targetConnection)?t:null==(t=this.block.previousConnection)?void 0:t.targetConnection,e&&(this.startChildConn=null==(t=this.block.nextConnection)?void 0:t.targetConnection),this.block.unplug(e),xi(this.block)}fireDragStartEvent(){var e=new(g(y.BLOCK_DRAG))(this.block,!0,this.block.getDescendants(!1));m(e)}fireDragEndEvent(){var e=new(g(y.BLOCK_DRAG))(this.block,!1,this.block.getDescendants(!1));m(e)}fireMoveEvent(){var e;this.block.isDeadOrDying()||((e=new(g(y.BLOCK_MOVE))(this.block)).setReason(["drag"]),e.oldCoordinate=this.startLoc,e.recordNew(),m(e))}drag(e){var t;this.block.isShadow()?null!=(t=this.block.getParent())&&t.drag(k.sum(e,this.dragOffset)):(this.block.moveDuringDrag(e),this.updateConnectionPreview(this.block,k.difference(e,this.startLoc)))}updateConnectionPreview(e,t){var r,n,i=this.connectionCandidate,s=this.getConnectionCandidate(e,t);s?(this.connectionCandidate=t=i&&this.currCandidateIsBetter(i,t,s)?i:s,{local:s,neighbour:r}=t,t=s.type===v.OUTPUT_VALUE||s.type===v.PREVIOUS_STATEMENT,i=r.isConnected()&&!(null!=(n=r.targetBlock())&&n.isInsertionMarker()),t&&i&&!this.orphanCanConnectAtEnd(e,r.targetBlock(),s.type)?null!=(n=this.connectionPreviewer)&&n.previewReplacement(s,r,r.targetBlock()):null!=(t=this.connectionPreviewer)&&t.previewConnection(s,r)):(null!=(i=this.connectionPreviewer)&&i.hidePreview(),this.connectionCandidate=null)}orphanCanConnectAtEnd(e,t,r){return!!N.getConnectionForOrphanedConnection(e,r===v.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}currCandidateIsBetter(e,t,r){var{local:n,neighbour:i}=e,n=(e=new k(n.x,n.y),new k(i.x,i.y));return t=k.distance(k.sum(e,t),n),r.distance>t-f.config$$module$build$src$core$config.currentConnectionPreference}getConnectionCandidate(e,t){e=this.getLocalConnections(e);let r=this.getSearchRadius(),n=null;for(var i of e){var{connection:s,radius:a}=i.closest(r,t);s&&(n={local:i,neighbour:s,distance:a},r=a)}return n}getSearchRadius(){return this.connectionCandidate?f.config$$module$build$src$core$config.connectingSnapRadius:f.config$$module$build$src$core$config.snapRadius}getLocalConnections(e){var t=e.getConnections_(!1),r=e.lastConnectionInStack(!0);return r&&r!==e.nextConnection&&t.push(r),t}endDrag(e){var t;this.block.isShadow()?null!=(t=this.block.getParent())&&t.endDrag(e):(this.originalEventGroup=f.getGroup$$module$build$src$core$events$utils(),this.fireDragEndEvent(),this.fireMoveEvent(),J(),Si(),null!=(t=this.connectionPreviewer)&&t.hidePreview(),!this.block.isDeadOrDying()&&this.dragging&&(null!=(e=this.workspace.getLayerManager())&&e.moveOffDragLayer(this.block,50),this.block.setDragging(!1)),this.connectionCandidate?(this.applyConnections(this.connectionCandidate),this.disposeStep()):this.block.queueRender().then(()=>this.disposeStep()))}disposeStep(){var e,t=f.getGroup$$module$build$src$core$events$utils();f.setGroup$$module$build$src$core$events$utils(this.originalEventGroup),this.block.snapToGrid(),null!=(e=this.connectionPreviewer)&&e.dispose(),this.workspace.setResizesEnabled(!0),f.setGroup$$module$build$src$core$events$utils(t)}applyConnections(e){var{local:e,neighbour:t}=e;e.connect(t);let r=e.isSuperior()?t:e,n=this.block.getRootBlock();tt().then(()=>{ki(r.getSourceBlock()),setTimeout(()=>{n.bringToFront()},0)})}revertDrag(){if(this.block.isShadow())null!=(e=this.block.getParent())&&e.revertDrag();else{var e;if(null!=(e=this.connectionPreviewer)&&e.hidePreview(),(this.connectionCandidate=null)!=(e=this.startChildConn)&&e.connect(this.block.nextConnection),this.startParentConn)switch(this.startParentConn.type){case v.INPUT_VALUE:this.startParentConn.connect(this.block.outputConnection);break;case v.NEXT_STATEMENT:this.startParentConn.connect(this.block.previousConnection)}else this.block.moveTo(this.startLoc,["drag"]),null!=(e=this.workspace.getLayerManager())&&e.moveOffDragLayer(this.block,50),Ai(this.workspace,this.workspace.getMetricsManager().getScrollMetrics(!0),this.block);this.startParentConn=this.startChildConn=null,this.block.setDragging(!1),this.dragging=!1}}}),dd=class extends D{constructor(e,t,r,n){super(t,r,n),this.text=e,this.workspace=t,this.anchor=r,this.ownerRect=n,this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize(),c(this.svgRoot,"blocklyTextBubble")}getText(){return this.text}setText(e){this.text=e,o(this.paragraph),this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}stringToSvg(e,t){return t=this.createParagraph(t),e=this.createTextFragments(t,e),this.workspace.RTL&&this.rightAlignTextFragments(t.getBBox().width,e),t}createParagraph(e){return l(x.G,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",transform:`translate(0,${D.BORDER_WIDTH})`,style:"direction: "+(this.workspace.RTL?"rtl":"ltr")},e)}createTextFragments(r,e){let n=1;return e.split("\n").map(e=>{var t=l(x.TEXT,{y:n+"em",x:D.BORDER_WIDTH},r);return e=document.createTextNode(e),t.appendChild(e),n+=1,t})}rightAlignTextFragments(e,t){for(var r of t)r.setAttribute("text-anchor","start"),r.setAttribute("x",""+(e+D.BORDER_WIDTH))}updateBubbleSize(){var e=this.paragraph.getBBox();this.setSize(new S(e.width+2*D.BORDER_WIDTH,e.height+2*D.BORDER_WIDTH),!0)}},pd=class extends Vu{constructor(e){super(e),this.sourceBlock=e,this.textMap=new Map,this.textBubble=null}getType(){return pd.TYPE}initView(e){this.svgRoot||(super.initView(e),l(x.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),l(x.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),l(x.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot),c(this.svgRoot,"blocklyWarningIcon"))}dispose(){var e;super.dispose(),null!=(e=this.textBubble)&&e.dispose()}getWeight(){return pd.WEIGHT}getSize(){return new S(17,17)}applyColour(){var e;super.applyColour(),null!=(e=this.textBubble)&&e.setColour(this.sourceBlock.getColour())}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(e){super.onLocationChange(e),null!=(e=this.textBubble)&&e.setAnchorLocation(this.getAnchorLocation())}addMessage(e,t){return this.textMap.get(t)!==e&&(e?this.textMap.set(t,e):this.textMap.delete(t),null!=(e=this.textBubble))&&e.setText(this.getText()),this}getText(){return[...this.textMap.values()].join("\n")}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(t){let r=this;return(0,p.asyncExecutePromiseGeneratorFunction)(function*(){var e;r.bubbleIsVisible()!==t&&(yield tt(),t?(r.textBubble=new dd(r.getText(),r.sourceBlock.workspace,r.getAnchorLocation(),r.getBubbleOwnerRect()),r.applyColour()):(null!=(e=r.textBubble)&&e.dispose(),r.textBubble=null),m(new(g(y.BUBBLE_OPEN))(r.sourceBlock,t,"warning")))})}getBubble(){return this.textBubble}getAnchorLocation(){return k.sum(this.workspaceLocation,new k(8.5,8.5))}getBubbleOwnerRect(){var e=this.sourceBlock.getSvgRoot().getBBox();return new E(e.y,e.y+e.height,e.x,e.x+e.width)}},O=(pd.TYPE=uc.WARNING,pd.WEIGHT=2,class extends id{constructor(e,t,r){if(super(e,t,r),this.childlessWidth=this.width=this.height=0,this.warningTextDb=new Map,this.mutator=null,this.rendered=!0,this.visuallyDisabled=!1,this.translation="",this.dragging=!1,this.relativeCoords=new k(0,0),this.dragStrategy=new ud(this),!e.rendered)throw TypeError("Cannot create a rendered block in a headless workspace");this.workspace=e,this.svgGroup=l(x.G,{}),t&&c(this.svgGroup,t),this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup,this.style),(e=this.pathObject.svgPath).tooltip=this,Mr(e),this.svgGroup.setAttribute("data-id",this.id),e.id=Ca(),this.doInit_()}initSvg(){if(!this.initialized){for(var e of this.inputList)e.init();for(var t of this.getIcons())t.initView(this.createIconPointerDownListener(t)),t.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()||this.isInFlyout),(e=this.getSvgRoot())&&h(e,"pointerdown",this,this.onMouseDown),e.parentNode||this.workspace.getCanvas().appendChild(e),this.initialized=!0}}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){this.addSelect(),ce(this)}unselect(){this.removeSelect(),ce(null)}setParent(e){var t,r,n,i,s,a=this.parentBlock_;e!==a&&(q(),super.setParent(e),J(),t=this.getSvgRoot(),!this.workspace.isClearing)&&t&&(r=this.getRelativeToSurfaceXY(),n=f.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode(),s=this.getSvgRoot().contains(null!=(i=null==n?void 0:n.getFocusableElement())?i:null),e?(e.getSvgRoot().appendChild(t),s&&n&&f.getFocusManager$$module$build$src$core$focus_manager().focusNode(n)):a&&((null==(e=this.workspace.getCanvas().querySelector(".blocklyDragging"))?void 0:e.parentElement)===(i=this.workspace.getCanvas())?i.insertBefore(t,e):(i.appendChild(t),s&&n&&f.getFocusManager$$module$build$src$core$focus_manager().focusNode(n)),this.translate(r.x,r.y)),this.applyColour())}getRelativeToSurfaceXY(){var e=this.workspace.getLayerManager();if(!e)throw Error("Cannot calculate position because the workspace has not been appended");let t=0,r=0,n=this.getSvgRoot();if(n)do{var i=we(n);t+=i.x,r+=i.y,n=n.parentNode}while(n&&!e.hasLayer(n));return new k(t,r)}moveBy(e,t,r){if(this.parentBlock_)throw Error("Block has parent");var n=U();let i=null;n&&(i=new(g(y.BLOCK_MOVE))(this),r)&&i.setReason(r),e=new k(e,t),t=this.getRelativeToSurfaceXY(),e=k.sum(t,e),this.translate(e.x,e.y),this.updateComponentLocations(e),n&&i&&(i.recordNew(),m(i)),this.workspace.resizeContents()}translate(e,t){this.translation=`translate(${e}, ${t})`,this.relativeCoords=new k(e,t),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(e,t){var r=this.getRelativeToSurfaceXY();this.moveBy(e.x-r.x,e.y-r.y,t)}moveDuringDrag(e){this.translate(e.x,e.y),this.getSvgRoot().setAttribute("transform",this.getTranslation()),this.updateComponentLocations(e)}snapToGrid(){var e,t;this.isDeadOrDying()||this.getParent()||this.isInFlyout||null!=(t=this.workspace.getGrid())&&t.shouldSnap()&&(e=this.getRelativeToSurfaceXY(),(t=t.alignXY(e))!==e)&&this.moveTo(t,["snap"])}getBoundingRectangle(){return this.getBoundingRectangleWithDimensions(this.getHeightWidth())}getBoundingRectangleWithoutChildren(){return this.getBoundingRectangleWithDimensions({height:this.height,width:this.childlessWidth})}getBoundingRectangleWithDimensions(e){var t=this.getRelativeToSurfaceXY();let r,n;return n=this.RTL?(r=t.x-e.width,t.x):(r=t.x,t.x+e.width),new E(t.y,t.y+e.height,r,n)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let e=0,t;t=this.inputList[e];e++)t.markDirty()}setCollapsed(e){this.collapsed_!==e&&(super.setCollapsed(e),this.updateCollapsed())}childHasWarning(){var e;for(e of this.getChildren(!1))if(e.getIcon(pd.TYPE)||e.childHasWarning())return!0;return!1}updateCollapsed(){var e,r=this.isCollapsed(),n=Cl,t=wl;for(let e=0,t;t=this.inputList[e];e++)t.name!==n&&t.setVisible(!r);for(e of this.getIcons())e.updateCollapsed();r?(c(this.svgGroup,"blocklyCollapsed"),this.childHasWarning()&&this.setWarningText(f.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,O.COLLAPSED_WARNING_ID),r=this.toString(30),(e=this.getField(t))?e.setValue(r):(this.getInput(n)||this.appendDummyInput(n)).appendField(new Ju(r),t)):(this.updateDisabled(),this.removeInput(n),a(this.svgGroup,"blocklyCollapsed"),this.setWarningText(null,O.COLLAPSED_WARNING_ID))}onMouseDown(e){var t;this.workspace.isReadOnly()||(t=this.workspace.getGesture(e))&&t.handleBlockStart(e,this)}showHelp(){var e="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;e&&window.open(e)}generateContextMenu(e){return this.workspace.isReadOnly()||!this.contextMenu?null:(e=A.registry.getContextMenuOptions({block:this,focusedNode:this},e),this.customContextMenu&&this.customContextMenu(e),e)}calculateContextMenuLocation(e){var t;return e instanceof PointerEvent?new k(e.clientX,e.clientY):(e=Oe(this.workspace,this.getRelativeToSurfaceXY()),t=null==(t=this.inputList.filter(e=>e.isVisible()).flatMap(e=>e.fieldRow).find(e=>e.isVisible()))||null==(t=t.getSvgRoot())?void 0:t.getBoundingClientRect(),new k(this.RTL?e.x-5:e.x+5,(t&&t.height?t.y+t.height:e.y+this.height)+5))}showContextMenu(e){var t=this.generateContextMenu(e),r=this.calculateContextMenuLocation(e);t&&t.length&&(bn(e,t,this.RTL,this.workspace,r),yn(this))}updateComponentLocations(e){this.dragging||this.updateConnectionLocations(e),this.updateIconLocations(e),this.updateFieldLocations(e);for(var t of this.getChildren(!1))t.updateComponentLocations(k.sum(e,t.relativeCoords))}updateConnectionLocations(e){for(var t of this.getConnections_(!1))t.moveToOffset(e)}updateIconLocations(e){for(var t of this.getIcons())t.onLocationChange(e)}updateFieldLocations(e){for(var t of this.inputList)for(var r of t.fieldRow)r.onLocationChange(e)}addClass(e){c(this.svgGroup,e)}removeClass(e){a(this.svgGroup,e)}setDragging(t){(this.dragging=t)?(this.translation="",Ho.push(...this.getConnections_(!0)),this.addClass("blocklyDragging")):(Ho.length=0,this.removeClass("blocklyDragging"));for(let e=0;e<this.childBlocks_.length;e++)this.childBlocks_[e].setDragging(t)}setMovable(e){super.setMovable(e),this.pathObject.updateMovable(e)}setEditable(t){super.setEditable(t),(t?a:c)(this.svgGroup,"blocklyNotEditable"),t=this.getIcons();for(let e=0;e<t.length;e++)t[e].updateEditable()}setShadow(e){super.setShadow(e),this.applyColour()}setInsertionMarker(e){this.isInsertionMarker_!==e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup}dispose(e,t){this.disposing=!0,Vr(),En();let r=f.getFocusManager$$module$build$src$core$focus_manager();var n,i,s;this.getSvgRoot().contains(null!=(n=null==(s=r.getFocusedNode())?void 0:s.getFocusableElement())?n:null)&&((s=this.getParent())||(n=null!=(i=this.outputConnection)?i:this.previousConnection)&&(s=null==(i=n.closest(0,new k(0,0)).connection)?void 0:i.getSourceBlock()),s?r.focusNode(s):setTimeout(()=>r.focusTree(this.workspace),0)),t&&(this.unplug(e),vi(this)),super.dispose(!!e),o(this.svgGroup)}disposeInternal(){this.disposing=!0,super.disposeInternal(),f.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===this&&this.workspace.cancelCurrentGesture(),[...this.warningTextDb.values()].forEach(e=>clearTimeout(e)),this.warningTextDb.clear(),this.getIcons().forEach(e=>e.dispose())}checkAndDelete(){this.workspace.isFlyout||(f.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),f.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(){return this.isInsertionMarker_?null:{paster:ld.TYPE,blockState:Mt(this,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:pe(this,!0)}}applyColour(){var e,t,r;for(null!=(t=(e=this.pathObject).applyColour)&&t.call(e,this),e=this.getIcons(),t=0;t<e.length;t++)e[t].applyColour();for(r of this.getFields())r.applyColour()}updateDisabled(){var e,t=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===t)null!=(e=this.getNextBlock())&&e.updateDisabled();else{this.applyColour(),this.visuallyDisabled=t;for(var r of this.getChildren(!1))r.updateDisabled()}}setWarningText(r,n=""){if(n)this.warningTextDb.has(n)&&(clearTimeout(this.warningTextDb.get(n)),this.warningTextDb.delete(n));else{for(var i of this.warningTextDb.values())clearTimeout(i);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(n,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(n),this.setWarningText(r,n))},100));else if(this.isInFlyout&&(r=null),i=this.getIcon(pd.TYPE),r){let e=this.getSurroundParent(),t=null;for(;e;)e.isCollapsed()&&(t=e),e=e.getSurroundParent();t&&t.setWarningText(f.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,O.COLLAPSED_WARNING_ID),i?i.addMessage(r,n):this.addIcon(new pd(this).addMessage(r,n))}else!i||n&&(i.addMessage("",n),i.getText())||this.removeIcon(pd.TYPE)}setMutator(e){this.removeIcon(f.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),e&&this.addIcon(e)}addIcon(e){return super.addIcon(e),e instanceof f.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=e),e.initView(this.createIconPointerDownListener(e)),e.applyColour(),e.updateEditable(),this.queueRender(),e}createIconPointerDownListener(t){return e=>{this.isDeadOrDying()||(e=this.workspace.getGesture(e))&&e.setStartIcon(t)}}removeIcon(e){var t=super.removeIcon(e);return e.equals(f.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.queueRender(),t}setDisabledReason(e,t){var r=this.isEnabled();super.setDisabledReason(e,t),this.isEnabled()===r||this.getInheritedDisabled()||this.updateDisabled()}setDeletable(e){super.setDeletable(e),(e?a:c)(this.svgGroup,"blocklyNotDeletable")}setHighlighted(e){this.pathObject.updateHighlighted(e)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(e){this.pathObject.updateDraggingDelete(e)}getColour(){return this.style.colourPrimary}setColour(e){var t,r;super.setColour(e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),null!=(r=(t=this.pathObject).setStyle)&&r.call(t,e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()}setStyle(e){var t,r,n=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_&&a(this.svgGroup,this.styleName_),!n)throw Error("Invalid style name: "+e);this.hat=n.hat,null!=(r=(t=this.pathObject).setStyle)&&r.call(t,n),this.colour_=n.colourPrimary,this.style=n,this.applyColour(),c(this.svgGroup,e),this.styleName_=e}getStyle(){return this.style}bringToFront(e=!1){var t=f.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode();let r=this;if(!r.isDeadOrDying()){do{var n=r.getSvgRoot(),i=n.parentNode,s=i.childNodes;if(s[s.length-1]!==n&&i.appendChild(n),e)break}while(r=r.getParent());t&&f.getFocusManager$$module$build$src$core$focus_manager().focusNode(t)}}setPreviousStatement(e,t){super.setPreviousStatement(e,t),this.queueRender()}setNextStatement(e,t){super.setNextStatement(e,t),this.queueRender()}setOutput(e,t){super.setOutput(e,t),this.queueRender()}setInputsInline(e){super.setInputsInline(e),this.queueRender()}removeInput(e,t){return e=super.removeInput(e,t),this.queueRender(),e}moveNumberedInputBefore(e,t){super.moveNumberedInputBefore(e,t),this.queueRender()}appendInput(e){return super.appendInput(e),this.queueRender(),e}setConnectionTracking(e){var t;if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection&&(this.nextConnection.setTracking(e),t=this.nextConnection.targetBlock())&&t.setConnectionTracking(e),!this.collapsed_)for(t=0;t<this.inputList.length;t++){var r=this.inputList[t].connection;r&&(r.setTracking(e),r=r.targetBlock())&&r.setConnectionTracking(e)}}getConnections_(e){var r=[];if(this.outputConnection&&r.push(this.outputConnection),this.previousConnection&&r.push(this.previousConnection),this.nextConnection&&r.push(this.nextConnection),e||!this.collapsed_)for(let e=0,t;t=this.inputList[e];e++)t.connection&&r.push(t.connection);return r}lastConnectionInStack(e){return super.lastConnectionInStack(e)}getMatchingConnection(e,t){return super.getMatchingConnection(e,t)}makeConnection_(e){return new Qu(this,e)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){var e,t,r=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||r.isInFlyout))for(var n of this.getConnections_(!1)){n.isSuperior()&&null!=(e=n.targetBlock())&&e.bumpNeighbours();for(t of n.neighbours(f.config$$module$build$src$core$config.snapRadius))t.getSourceBlock().getRootBlock()===r||n.isConnected()&&t.isConnected()||(n.isSuperior()?t.bumpAwayFrom(n,!1):n.bumpAwayFrom(t,!0))}}scheduleSnapAndBump(){this.snapToGrid(),this.bumpNeighbours()}positionNearConnection(e,t,r){var n;e.type!==v.NEXT_STATEMENT&&e.type!==v.INPUT_VALUE||(n=t.x,t=t.y,n+=r.x-e.getOffsetInBlock().x,t+=r.y-e.getOffsetInBlock().y,this.moveBy(n,t))}getChildren(e){return super.getChildren(e)}queueRender(){return et(this)}render(){this.queueRender(),rt()}renderEfficiently(){q(),this.isCollapsed()&&this.updateCollapsed(),this.isEnabled()||this.updateDisabled(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),J()}tightenChildrenEfficiently(){for(var e of this.inputList){e=e.connection;e&&e.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}getHeightWidth(){let e=this.height,t=this.width;var r,n=this.getNextBlock();return n&&(n=n.getHeightWidth(),r=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT,e+=n.height-r,t=Math.max(t,n.width)),{height:e,width:t}}fadeForReplacement(e){this.pathObject.updateReplacementFade(e)}highlightShapeForInput(e,t){this.pathObject.updateShapeForInputHighlight(e,t)}getDragStrategy(){return this.dragStrategy}setDragStrategy(e){this.dragStrategy=e}isCopyable(){return this.isOwnDeletable()&&this.isOwnMovable()}isMovable(){return this.dragStrategy.isMovable()}startDrag(e){this.dragStrategy.startDrag(e)}drag(e,t){this.dragStrategy.drag(e,t)}endDrag(e){this.dragStrategy.endDrag(e)}revertDrag(){this.dragStrategy.revertDrag()}toFlyoutInfo(){let e=Object.assign({},{kind:"BLOCK"},Mt(this)),r=new Set(["id","height","width","pinned","enabled"]),n=function(e){for(var t in e)r.has(t)?delete e[t]:"object"==typeof e[t]&&n(e[t])};return n(e),[e]}jsonInit(e){super.jsonInit(e),e.classes&&this.addClass(Array.isArray(e.classes)?e.classes.join(" "):e.classes)}getFocusableElement(){return this.pathObject.svgPath}getFocusableTree(){return this.workspace}onNodeFocus(){this.select()}onNodeBlur(){this.unselect()}canBeFocused(){return!0}}),hd=(O.INLINE=-1,O.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_",class{constructor(){}onDragEnter(e){}onDragOver(e){}onDragExit(e){}onDrop(e){}getClientRect(){return null}shouldPreventMove(e){return!1}}),md=class extends hd{constructor(){super(),this.wouldDelete_=!1}wouldDelete(e){return e instanceof O?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e)):this.updateWouldDelete_(Ri(e)&&e.isDeletable()),this.wouldDelete_}updateWouldDelete_(e){this.wouldDelete_=e}},gd=class{constructor(e,t){this.element=e,this.type=t}getElement(){return this.element}getType(){return this.type}},fd=class{constructor(e){this.workspace_=e}getDimensionsPx_(e){let t=0,r=0;return e&&(t=e.getWidth(),r=e.getHeight()),new S(t,r)}getFlyoutMetrics(e){return{width:(e=this.getDimensionsPx_(this.workspace_.getFlyout(e))).width,height:e.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){var e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let e=0,t=0;var r=this.getToolboxMetrics(),n=this.getFlyoutMetrics(),i=!!this.workspace_.getToolbox(),s=!(null!=(a=this.workspace_.getFlyout())&&a.autoClose),a=(i?r:n).position,o=a===b.TOP;return a===b.LEFT&&(i&&(e+=r.width),s)&&(e+=n.width),o&&(i&&(t+=r.height),s)&&(t+=n.height),{top:t,left:e}}getViewMetrics(e){e=e?this.workspace_.scale:1;var t=this.getSvgMetrics(),r=this.getToolboxMetrics(),n=this.getFlyoutMetrics(),i=!!this.workspace_.getToolbox(),s=!(null!=(a=this.workspace_.getFlyout())&&a.autoClose),a=(i?r:n).position,o=a===b.LEFT||a===b.RIGHT;return a!==b.TOP&&a!==b.BOTTOM||(i&&(t.height-=r.height),s&&(t.height-=n.height)),o&&(i&&(t.width-=r.width),s)&&(t.width-=n.width),{height:t.height/e,width:t.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}}getContentMetrics(e){e=e?1:this.workspace_.scale;var t=this.workspace_.getBlocksBoundingBox();return{height:(t.bottom-t.top)*e,width:(t.right-t.left)*e,top:t.top*e,left:t.left*e}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(e){var t,r,n;return this.hasFixedEdges()?(t=this.workspace_.isMovableHorizontally(),r=this.workspace_.isMovableVertically(),e=e||this.getViewMetrics(!1),n={},r||(n.top=e.top,n.bottom=e.top+e.height),t||(n.left=e.left,n.right=e.left+e.width),n):{}}getPaddedContent_(e,t){var r=t.top+t.height,n=t.left+t.width,i=e.width,s=i/2,a=(e=e.height)/2;return{top:Math.min(t.top-a,r-e),bottom:Math.max(r+a,t.top+e),left:Math.min(t.left-s,n-i),right:Math.max(n+s,t.left+i)}}getScrollMetrics(e,t,r){e=e?this.workspace_.scale:1,t=t||this.getViewMetrics(!1);var n=r||this.getContentMetrics(),i=(r=this.getComputedFixedEdges_(t),t=this.getPaddedContent_(t,n),n=(void 0!==r.top?r:t).top,(void 0!==r.left?r:t).left);return{top:n/e,left:i/e,width:((void 0!==r.right?r:t).right-i)/e,height:((void 0!==r.bottom?r:t).bottom-n)/e}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){var e=this.getToolboxMetrics(),t=this.getFlyoutMetrics(!0),r=this.getSvgMetrics(),n=this.getAbsoluteMetrics(),i=this.getViewMetrics(),s=this.getContentMetrics(),a=this.getScrollMetrics(!1,i,s);return{contentHeight:s.height,contentWidth:s.width,contentTop:s.top,contentLeft:s.left,scrollHeight:a.height,scrollWidth:a.width,scrollTop:a.top,scrollLeft:a.left,viewHeight:i.height,viewWidth:i.width,viewTop:i.top,viewLeft:i.left,absoluteTop:n.top,absoluteLeft:n.left,svgHeight:r.height,svgWidth:r.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:t.width,flyoutHeight:t.height}}},_d=(i(_.METRICS_MANAGER,$a,fd),class extends fd{constructor(e,t){super(e),this.flyout_=t}getBoundingBox(){let t;try{t=this.workspace_.getCanvas().getBBox()}catch(e){t={height:0,y:0,width:0,x:0}}return t}getContentMetrics(e){var t=this.getBoundingBox();return e=e?1:this.workspace_.scale,{height:t.height*e,width:t.width*e,top:t.y*e,left:t.x*e}}getScrollMetrics(e,t,r){return t=r||this.getContentMetrics(),r=this.flyout_.MARGIN*this.workspace_.scale,e=e?this.workspace_.scale:1,{height:(t.height+2*r)/e,width:(t.width+t.left+r)/e,top:0,left:0}}}),yd=class{constructor(e,t,r,n){this.workspace=e,this.targetWorkspace=t,this.isFlyoutLabel=n,this.height=this.width=0,this.cursorSvg=this.svgText=null,this.text=r.text,this.position=new k(0,0),this.callbackKey=r.callbackKey||r.callbackkey,this.cssClass=r["web-class"]||null,this.info=r,e=this.isFlyoutLabel?"blocklyFlyoutLabel":"blocklyFlyoutButton",this.cssClass&&(e+=" "+this.cssClass),this.id=Ca(),this.svgGroup=l(x.G,{id:this.id,class:e},this.workspace.getCanvas());let i;this.isFlyoutLabel||(i=l(x.RECT,{class:"blocklyFlyoutButtonShadow",rx:yd.BORDER_RADIUS,ry:yd.BORDER_RADIUS,x:1,y:1},this.svgGroup)),e=l(x.RECT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:yd.BORDER_RADIUS,ry:yd.BORDER_RADIUS},this.svgGroup),t=l(x.TEXT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup),r=nn(this.text),this.workspace.RTL&&(r+=""),t.textContent=r,this.isFlyoutLabel&&(this.svgText=t,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill")),n=Te(t,"fontSize");var s=Te(t,"fontWeight"),a=Te(t,"fontFamily");this.width=X(t,n,s,a),r=Z(r,n,s,a),this.height=this.height||r.height,this.isFlyoutLabel||(this.width+=2*yd.TEXT_MARGIN_X,this.height+=2*yd.TEXT_MARGIN_Y,null!=(n=i)&&n.setAttribute("width",String(this.width)),null!=(s=i)&&s.setAttribute("height",String(this.height))),e.setAttribute("width",String(this.width)),e.setAttribute("height",String(this.height)),t.setAttribute("x",String(this.width/2)),t.setAttribute("y",String(this.height/2-r.height/2+r.baseline)),this.updateTransform(),this.onMouseDownWrapper=h(this.svgGroup,"pointerdown",this,this.onMouseDown),this.onMouseUpWrapper=h(this.svgGroup,"pointerup",this,this.onMouseUp)}createDom(){return this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(e,t){this.position.x=e,this.position.y=t,this.updateTransform()}moveBy(e,t,r){this.moveTo(this.position.x+e,this.position.y+t)}isLabel(){return this.isFlyoutLabel}getPosition(){return this.position}getBoundingRectangle(){return new E(this.position.y,this.position.y+this.height,this.position.x,this.position.x+this.width)}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}getWorkspace(){return this.workspace}dispose(){s(this.onMouseDownWrapper),s(this.onMouseUpWrapper),this.svgGroup&&o(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}setCursorSvg(e){e?this.svgGroup&&(this.svgGroup.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}onMouseUp(e){(e=this.targetWorkspace.getGesture(e))&&e.cancel(),this.isFlyoutLabel&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isFlyoutLabel||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isFlyoutLabel||(e=this.targetWorkspace.getButtonCallback(this.callbackKey))&&e(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}onMouseDown(e){var t=this.targetWorkspace.getGesture(e),r=this.targetWorkspace.getFlyout();t&&r&&t.handleFlyoutStart(e,r)}getSvgRoot(){return this.svgGroup}getFocusableElement(){return this.svgGroup}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}},bd=(yd.TEXT_MARGIN_X=5,yd.TEXT_MARGIN_Y=2,yd.BORDER_RADIUS=4,_e("\n.blocklyFlyoutButton {\n  fill: #888;\n  cursor: default;\n}\n\n.blocklyFlyoutButtonShadow {\n  fill: #666;\n}\n\n.blocklyFlyoutButton:hover {\n  fill: #aaa;\n}\n\n.blocklyFlyoutLabel {\n  cursor: default;\n}\n\n.blocklyFlyoutLabelBackground {\n  opacity: 0;\n}\n"),class{getFirstChild(e){return null}getParent(e){return e.getWorkspace()}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof yd}}),vd=class{constructor(e,t){this.policy=e,this.flyout=t}getFirstChild(e){return null}getParent(e){return this.policy.getParent(e)}getNextSibling(t){var e=this.flyout.getContents();if(!e)return null;let r=e.findIndex(e=>e.getElement()===t);return-1===r?null:e[r=++r>=e.length?0:r].getElement()}getPreviousSibling(t){var e=this.flyout.getContents();if(!e)return null;let r=e.findIndex(e=>e.getElement()===t);return-1===r?null:e[r=--r<0?e.length-1:r].getElement()}isNavigable(e){return this.policy.isNavigable(e)}isApplicable(e){return this.policy.isApplicable(e)}},Td=class{constructor(e,t){this.gap=e,this.axis=t,this.y=this.x=0}getBoundingRectangle(){switch(this.axis){case"x":return new E(this.y,this.y,this.x,this.x+this.gap);case"y":return new E(this.y,this.y+this.gap,this.x,this.x)}}moveBy(e,t,r){this.x+=e,this.y+=t}isNavigable(){return!1}getFocusableElement(){throw Error("Cannot be focused")}getFocusableTree(){throw Error("Cannot be focused")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}},kd=class{getFirstChild(e){return null}getParent(e){return null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return!1}isApplicable(e){return e instanceof Td}},xd=class{getFirstChild(e){return Li(e,!0)[0]}getParent(e){var t;if(null!=(t=e.previousConnection)&&t.targetBlock()){if(t=e.getSurroundParent())return t}else if(null!=(t=e.outputConnection)&&t.targetBlock())return e.outputConnection.targetBlock();return e.workspace}getNextSibling(e){var t;return null!=(t=e.nextConnection)&&t.targetBlock()?null==(t=e.nextConnection)?void 0:t.targetBlock():null!=(t=e.outputConnection)&&t.targetBlock()?Mi(e,1):e.getSurroundParent()?Mi(e.getTopStackBlock(),1):this.getParent(e)instanceof wp?Pi(e,1):null}getPreviousSibling(e){var t;return null!=(t=e.previousConnection)&&t.targetBlock()?null==(t=e.previousConnection)?void 0:t.targetBlock():null!=(t=e.outputConnection)&&t.targetBlock()?Mi(e,-1):this.getParent(e)instanceof wp?Pi(e,-1):null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof O}},Ed=class{getFirstChild(e){return null}getParent(e){return e.getParentComment()}getNextSibling(e){var t=e.getParentComment().view.getCommentBarButtons();return 0<=(e=t.indexOf(e))&&e+1<t.length?t[e+1]:null}getPreviousSibling(e){var t=e.getParentComment().view.getCommentBarButtons();return 0<(e=t.indexOf(e))?t[e-1]:null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof mu}},Sd=class{getFirstChild(e){return e.getParentInput()?e.targetConnection:null}getParent(e){return e.getSourceBlock()}getNextSibling(e){var t,r;return e.getParentInput()?Mi(e,1):e.type===v.NEXT_STATEMENT?(t=e.targetConnection,r=e.getSourceBlock(),t||r.getRootBlock().lastConnectionInStack(!1)!==e?t:(r=(e=r.workspace.getTopBlocks(!0)).indexOf(r.getRootBlock())+1,r=e[r=r>=e.length?0:r],null!=(t=this.getParentConnection(r))?t:r)):e.getSourceBlock()}getPreviousSibling(e){var t,r;return e.getParentInput()?Mi(e,-1):e.type===v.PREVIOUS_STATEMENT||e.type===v.OUTPUT_VALUE?(t=e.targetConnection&&!e.targetConnection.getParentInput()?e.targetConnection:null,r=e.getSourceBlock(),t||this.getParentConnection(r.getRootBlock())!==e?t:(r=(e=r.workspace.getTopBlocks(!0)).indexOf(r.getRootBlock())-1,null!=(t=(r=e[r=r<0?e.length-1:r]).lastConnectionInStack(!1))?t:r)):e.type===v.NEXT_STATEMENT?e.getSourceBlock():null}getParentConnection(e){var t;return!e.outputConnection||null!=(t=e.previousConnection)&&t.isConnected()?e.previousConnection:e.outputConnection}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Qu}},Cd=class{getFirstChild(e){return null}getParent(e){return e.getSourceBlock()}getNextSibling(e){return Mi(e,1)}getPreviousSibling(e){return Mi(e,-1)}isNavigable(e){var t;return e.canBeFocused()&&e.isVisible()&&(e.isClickable()||e.isCurrentlyEditable())&&!(null!=(t=e.getSourceBlock())&&t.isSimpleReporter()&&e.isFullBlockField())&&e.getParentInput().isVisible()}isApplicable(e){return e instanceof I}},wd=class{getFirstChild(e){return e instanceof f.MutatorIcon$$module$build$src$core$icons$mutator_icon&&e.bubbleIsVisible()&&f.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===e&&null!=(e=null==(e=e.getBubble())?void 0:e.getWorkspace())?e:null}getParent(e){return e.getSourceBlock()}getNextSibling(e){return Mi(e,1)}getPreviousSibling(e){return Mi(e,-1)}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Vu}},Id=class{getFirstChild(e){return e.view.getCommentBarButtons()[0]}getParent(e){return e.workspace}getNextSibling(e){return Pi(e,1)}getPreviousSibling(e){return Pi(e,-1)}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof xu}},Ad=class{getFirstChild(e){return(e=e.getTopBlocks(!0)).length?e[0]:null}getParent(e){return null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()&&!e.isMutator}isApplicable(e){return e instanceof wp}},Dd=class{constructor(){this.rules=[new xd,new Cd,new Sd,new Ad,new wd,new Id,new Ed]}addNavigationPolicy(e){this.rules.push(e)}get(t){return this.rules.find(e=>e.isApplicable(t))}getFirstChild(e){var t=null==(t=this.get(e))?void 0:t.getFirstChild(e);return t?null!=(e=this.get(t))&&e.isNavigable(t)?t:this.getFirstChild(t)||this.getNextSibling(t):null}getParent(e){var t=null==(t=this.get(e))?void 0:t.getParent(e);return t?null!=(e=this.get(t))&&e.isNavigable(t)?t:this.getParent(t):null}getNextSibling(e){var t=null==(t=this.get(e))?void 0:t.getNextSibling(e);return t?null!=(e=this.get(t))&&e.isNavigable(t)?t:this.getNextSibling(t):null}getPreviousSibling(e){var t=null==(t=this.get(e))?void 0:t.getPreviousSibling(e);return t?null!=(e=this.get(t))&&e.isNavigable(t)?t:this.getPreviousSibling(t):null}},Nd=class extends Dd{constructor(t){super(),this.rules.push(new bd,new kd),this.rules=this.rules.map(e=>new vd(e,t))}},Od=class{constructor(e,t,r,n,i){this.workspace=e,this.oldHostMetrics=this.corner_=this.vScroll=this.hScroll=null,r=void 0===r||r;var s=(t=void 0===t||t)&&r;t&&(this.hScroll=new nl(e,!0,s,n,i)),r&&(this.vScroll=new nl(e,!1,s,n,i)),s&&(this.corner_=l(x.RECT,{height:nl.scrollbarThickness,width:nl.scrollbarThickness,class:"blocklyScrollbarBackground"}),z(this.corner_,e.getBubbleCanvas()))}dispose(){o(this.corner_),this.oldHostMetrics=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){var e=this.workspace.getMetrics();if(e){var t=!1,r=!1;if(this.oldHostMetrics&&this.oldHostMetrics.viewWidth===e.viewWidth&&this.oldHostMetrics.viewHeight===e.viewHeight&&this.oldHostMetrics.absoluteTop===e.absoluteTop&&this.oldHostMetrics.absoluteLeft===e.absoluteLeft?(this.oldHostMetrics&&this.oldHostMetrics.scrollWidth===e.scrollWidth&&this.oldHostMetrics.viewLeft===e.viewLeft&&this.oldHostMetrics.scrollLeft===e.scrollLeft||(t=!0),this.oldHostMetrics&&this.oldHostMetrics.scrollHeight===e.scrollHeight&&this.oldHostMetrics.viewTop===e.viewTop&&this.oldHostMetrics.scrollTop===e.scrollTop||(r=!0)):r=t=!0,t||r){try{f.disable$$module$build$src$core$events$utils(),this.hScroll&&t&&this.hScroll.resize(e),this.vScroll&&r&&this.vScroll.resize(e)}finally{f.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}this.hScroll&&this.vScroll&&(this.oldHostMetrics&&this.oldHostMetrics.viewWidth===e.viewWidth&&this.oldHostMetrics.absoluteLeft===e.absoluteLeft||null!=(t=this.corner_)&&t.setAttribute("x",String(this.vScroll.position.x)),this.oldHostMetrics&&this.oldHostMetrics.viewHeight===e.viewHeight&&this.oldHostMetrics.absoluteTop===e.absoluteTop||null!=(r=this.corner_)&&r.setAttribute("y",String(this.hScroll.position.y))),this.oldHostMetrics=e}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(e,t){this.hScroll&&this.hScroll.setOrigin(e,t),this.vScroll&&this.vScroll.setOrigin(e,t)}set(e,t,r){this.hScroll&&this.hScroll.set(e,!1),this.vScroll&&this.vScroll.set(t,!1),!r&&void 0!==r||(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace.setMetrics(e))}setX(e){this.hScroll&&this.hScroll.set(e,!0)}setY(e){this.vScroll&&this.vScroll.set(e,!0)}setContainerVisible(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)}isVisible(){let e=!1;return this.hScroll&&(e=this.hScroll.isVisible()),e=this.vScroll?e||this.vScroll.isVisible():e}setVisible(e){this.hScroll&&this.hScroll.setVisibleInternal(e),this.vScroll&&this.vScroll.setVisibleInternal(e)}resizeContent(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)}resizeView(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)}},Rd="sep",Ld=class{load(e,t){return e=new Td(0,t.horizontalLayout?"x":"y"),new gd(e,Rd)}gapForItem(e,t){return null!=(e=parseInt(String(e.gap)))?e:t}disposeItem(e){}getType(){return Rd}};i(_.FLYOUT_INFLATER,Rd,Ld);({SEPARATOR_TYPE:Rd}).SeparatorFlyoutInflater=Ld;var Pd=class extends md{constructor(e){super(),this.horizontalLayout=!1,this.boundEvents=[],this.reflowWrapper=null,this.contents=[],this.autoClose=!0,this.visible=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,this.inflaters=new Map,e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new wp(e),this.workspace_.setMetricsManager(new _d(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.visible),this.workspace_.setNavigator(new Nd(this)),this.id=wa(),this.RTL=!!e.RTL,this.toolboxPosition_=e.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(e){return this.svgGroup_=l(e,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=l(x.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new Od(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(h(this.svgGroup_,"wheel",this,this.wheel_)),this.boundEvents.push(h(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:Jo.ComponentWeight.FLYOUT_WEIGHT,capabilities:[Jo.Capability.AUTOHIDEABLE,Jo.Capability.DELETE_AREA,Jo.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.targetWorkspace.getComponentManager().removeComponent(this.id);for(var e of this.boundEvents)s(e);this.boundEvents.length=0,this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&o(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(e){this.autoClose=e,this.targetWorkspace.recordDragTargets(),this.targetWorkspace.resizeContents()}autoHide(e){!e&&this.targetWorkspace.getFlyout(!0)===this&&this.autoClose&&this.hide()}getTargetWorkspace(){return this.targetWorkspace}isVisible(){return this.visible}setVisible(e){var t=e!==this.isVisible();this.visible=e,t&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(e){var t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay()}getContents(){return this.contents}setContents(e){this.contents=e}updateDisplay(){var e,t=!!this.containerVisible&&this.isVisible();this.svgGroup_&&(this.svgGroup_.style.display=t?"block":"none"),null!=(e=this.workspace_.scrollbar)&&e.setContainerVisible(t)}positionAt_(e,t,r,n){var i;null!=(i=this.svgGroup_)&&i.setAttribute("width",""+e),null!=(i=this.svgGroup_)&&i.setAttribute("height",""+t),this.workspace_.setCachedParentSvgSize(e,t),this.svgGroup_&&W(this.svgGroup_,"translate("+r+"px,"+n+"px)"),(e=this.workspace_.scrollbar)&&(e.setOrigin(r,n),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll)&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y)}hide(){this.isVisible()&&(this.setVisible(!1),this.reflowWrapper)&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null)}show(e){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),"string"==typeof e&&(e=this.getDynamicCategoryContents(e)),this.setVisible(!0),e=Fe(e),e=this.createFlyoutInfo(e),rt(this.workspace_),this.setContents(e),this.layout_(e),this.horizontalLayout?this.height_=0:this.width_=0,this.reflow(),this.workspace_.setResizesEnabled(!0),this.reflowWrapper=e=>{e.type!==y.BLOCK_CHANGE&&e.type!==y.BLOCK_FIELD_INTERMEDIATE_CHANGE||this.reflow()},this.workspace_.addChangeListener(this.reflowWrapper)}createFlyoutInfo(e){var t,r=[],n=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(t of e)"custom"in t&&(e=this.getDynamicCategoryContents(t.custom),e=Fe(e),r.push(...this.createFlyoutInfo(e))),e=t.kind.toLowerCase(),(e=this.getInflaterForType(e))&&(r.push(e.load(t,this)),e=e.gapForItem(t,n))&&r.push(new gd(new Td(e,this.horizontalLayout?"x":"y"),Rd));return this.normalizeSeparators(r)}normalizeSeparators(t){for(let e=t.length-1;0<e;e--){var r=t[e].getType().toLowerCase(),n=t[e-1].getType().toLowerCase();r===Rd&&n===Rd&&t.splice(e-1,1)}return t}getDynamicCategoryContents(e){if("function"!=typeof(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");return e(this.workspace_.targetWorkspace)}clearOldBlocks(){var e;this.getContents().forEach(e=>{var t;null!=(t=this.getInflaterForType(e.getType()))&&t.disposeItem(e)}),null!=(e=this.workspace_.getPotentialVariableMap())&&e.clear()}onMouseDown(e){var t=this.targetWorkspace.getGesture(e);t&&t.handleFlyoutStart(e,this)}isBlockCreatable(e){return e.isEnabled()&&!this.getTargetWorkspace().isReadOnly()}createBlock(e){let t=null;f.disable$$module$build$src$core$events$utils();var r=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{t=this.placeNewBlock(e)}finally{f.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),e=Rt(this.targetWorkspace,r),U()){for(f.setGroup$$module$build$src$core$events$utils(!0),r=0;r<e.length;r++){var n=e[r];m(new(g(y.VAR_CREATE))(n))}m(new(g(y.BLOCK_CREATE))(t))}return this.autoClose&&this.hide(),t}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()}placeNewBlock(e){var t,r=this.targetWorkspace;if(e.getSvgRoot())return t=this.serializeBlock(e),r.setResizesEnabled(!1),r=Kt(t,r),this.positionNewBlock(e,r),r;throw Error("oldBlock is not rendered")}serializeBlock(e){return Mt(e)}positionNewBlock(e,t){var r=this.targetWorkspace,n=r.getOriginOffsetInPixels(),i=this.workspace_.getOriginOffsetInPixels();(e=e.getRelativeToSurfaceXY()).scale(this.workspace_.scale),i=k.sum(i,e),(n=k.difference(i,n)).scale(1/r.scale),t.moveTo(new k(n.x,n.y))}getInflaterForType(e){var t;return this.inflaters.has(e)?null!=(t=this.inflaters.get(e))?t:null:(t=da(_.FLYOUT_INFLATER,e))?(t=new t,this.inflaters.set(e,t),t):null}getFocusableElement(){throw Error("Flyouts are not directly focusable.")}getFocusableTree(){throw Error("Flyouts are not directly focusable.")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}getRootFocusableNode(){throw Error("Flyouts are not directly focusable.")}getRestoredFocusableNode(e){throw Error("Flyouts are not directly focusable.")}getNestedTrees(){throw Error("Flyouts are not directly focusable.")}lookUpFocusableNode(e){throw Error("Flyouts are not directly focusable.")}onTreeFocus(e,t){}onTreeBlur(e){throw Error("Flyouts are not directly focusable.")}},Md=class{constructor(){this.isActive=!1,this.activeClassName="blocklyKeyboardNavigation"}setIsActive(e=!0){this.isActive=e,this.updateActiveVisualization()}getIsActive(){return this.isActive}updateActiveVisualization(){this.isActive?document.body.classList.add(this.activeClassName):document.body.classList.remove(this.activeClassName)}},Fd=new Md,Bd=class{constructor(e){this.workspace=e,this.horizontalScrollEnabled=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled=this.workspace.isMovableVertically(),this.startScrollXY_=new k(e.scrollX,e.scrollY)}dispose(){this.workspace=null}startDrag(){}endDrag(e){this.drag(e)}drag(e){if(e=k.sum(this.startScrollXY_,e),this.horizontalScrollEnabled&&this.verticalScrollEnabled)this.workspace.scroll(e.x,e.y);else if(this.horizontalScrollEnabled)this.workspace.scroll(e.x,this.workspace.scrollY);else{if(!this.verticalScrollEnabled)throw new TypeError("Invalid state.");this.workspace.scroll(this.workspace.scrollX,e.y)}}},$d=class{constructor(e,t){this.creatorWorkspace=t,this.mouseDownXY=new k(0,0),this.startWorkspace_=this.targetBlock=this.startComment=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.workspaceDragger=this.dragger=null,this.dragging=!1,this.flyout=null,this.multiTouch=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=e,this.currentDragDeltaXY=new k(0,0)}dispose(){_a(),jr(),this.creatorWorkspace.clearGesture();for(var e of this.boundEvents)s(e);this.boundEvents.length=0,this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(e){var t=new k(e.clientX,e.clientY);this.updateDragDelta(t)&&(this.updateIsDragging(e),fa()),this.mostRecentEvent=e}updateDragDelta(e){return this.currentDragDeltaXY=k.difference(e,this.mouseDownXY),!this.hasExceededDragRadius&&(this.hasExceededDragRadius=k.magnitude(this.currentDragDeltaXY)>(this.flyout?f.config$$module$build$src$core$config.flyoutDragRadius:f.config$$module$build$src$core$config.dragRadius))}updateIsDraggingFromFlyout(){let e;if(!this.targetBlock||null==(e=this.flyout)||!e.isBlockCreatable(this.targetBlock))return!1;if(this.flyout.targetWorkspace)return!(this.flyout.isScrollable()&&!this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)||(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),f.getGroup$$module$build$src$core$events$utils()||f.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),f.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),0));throw Error("Cannot update dragging from the flyout because the ' +\n          'flyout's target workspace is undefined")}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.dragging=!0,this.workspaceDragger=new Bd(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(e){if(!this.startWorkspace_)throw Error("Cannot update dragging because the start workspace is undefined");if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.flyout&&this.updateIsDraggingFromFlyout();var t=le();t&&Fi(t)&&t.isMovable()?(this.dragging=!0,this.dragger=this.createDragger(t,this.startWorkspace_),this.dragger.onDragStart(e),this.dragger.onDrag(e,this.currentDragDeltaXY)):this.updateIsDraggingWorkspace()}createDragger(e,t){return new(ma(_.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(e,t)}doStart(e){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,ka(e)?this.cancel():(this.gestureHasStarted=!0,Si(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=Ec,this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=e,Gr(),xa(e)?this.handleRightClick(e):("pointerdown"===e.type.toLowerCase()&&"mouse"!==e.pointerType&&ga(e,this),this.mouseDownXY=new k(e.clientX,e.clientY),this.bindMouseEvents(e),this.isEnding_||this.handleTouchStart(e)))}bindMouseEvents(e){this.boundEvents.push(h(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(h(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(h(document,"pointerup",null,this.handleUp.bind(this),!0)),e.preventDefault(),e.stopPropagation()}handleStart(e){this.isDragging()||(this.handleTouchStart(e),this.isMultiTouch()&&fa())}handleMove(e){this.isDragging()&&ya(e)||!this.isMultiTouch()?(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(e),fa())}handleUp(e){if(this.isDragging()||this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()){if(!ya(e))return;if(this.updateFromEvent(e),fa(),this.isEnding_)return void console.log("Trying to end a gesture recursively.");this.isEnding_=!0,this.dragger?(Fd.setIsActive(!1),this.dragger.onDragEnd(e,this.currentDragDeltaXY)):this.workspaceDragger?(Fd.setIsActive(!1),this.workspaceDragger.endDrag(this.currentDragDeltaXY)):this.isBubbleClick()||this.isCommentClick()||(this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(e))}e.preventDefault(),e.stopPropagation(),this.dispose()}handleTouchStart(e){var t=ba(e),r=(this.cachedPoints.set(t,this.getTouchPoint(e)),Array.from(this.cachedPoints.keys()));2===r.length&&(t=this.cachedPoints.get(r[0]),r=this.cachedPoints.get(r[1]),this.startDistance=k.distance(t,r),this.multiTouch=!0,e.preventDefault())}handleTouchMove(e){var t=ba(e);this.cachedPoints.set(t,this.getTouchPoint(e)),this.isPinchZoomEnabled&&2===this.cachedPoints.size?this.handlePinch(e):(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation())}handlePinch(e){var t=Array.from(this.cachedPoints.keys()),r=this.cachedPoints.get(t[0]),t=this.cachedPoints.get(t[1]),r=k.distance(r,t)/this.startDistance;if(0<this.previousScale&&this.previousScale<1/0){if(t=0<(t=r-this.previousScale)?5*t:6*t,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");var n=this.startWorkspace_,i=Ea(e,n.getParentSvg(),n.getInverseScreenCTM());n.zoom(i.x,i.y,t)}this.previousScale=r,e.preventDefault()}handleTouchEnd(e){e=ba(e),this.cachedPoints.has(e)&&this.cachedPoints.delete(e),this.cachedPoints.size<2&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(e){return this.startWorkspace_?new k(e.pageX,e.pageY):null}isMultiTouch(){return this.multiTouch}cancel(){this.isEnding_||(fa(),this.dragger?this.dragger.onDragEnd(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(e){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(e)):this.startBubble?this.startBubble.showContextMenu(e):this.startComment?(this.startComment.workspace.hideChaff(),this.startComment.showContextMenu(e)):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),f.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startWorkspace_),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),Fd.setIsActive(!1),this.dispose()}handleWsStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(t),this.mostRecentEvent=e,this.startBlock||this.startBubble||this.startComment?this.startBlock&&f.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startBlock):f.getFocusManager$$module$build$src$core$focus_manager().focusNode(t),this.doStart(e)}fireWorkspaceClick(e){m(new(g(y.CLICK))(null,e.id,"workspace"))}handleFlyoutStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(t),this.handleWsStart(e,t.getWorkspace())}handleBlockStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(t),this.mostRecentEvent=e}handleBubbleStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(t),this.mostRecentEvent=e}handleCommentStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleCommentStart, but the gesture had already been started.");this.setStartComment(t),this.mostRecentEvent=e}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.bringBlockToFront(),this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent)}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.bringBlockToFront(),this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");var e;this.flyout.isBlockCreatable(this.targetBlock)&&(f.getGroup$$module$build$src$core$events$utils()||f.setGroup$$module$build$src$core$events$utils(!0),(e=this.flyout.createBlock(this.targetBlock)).snapToGrid(),e.bumpNeighbours(),f.getFocusManager$$module$build$src$core$focus_manager().focusNode(e))}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");e=new(g(y.CLICK))(this.startBlock,this.startWorkspace_.id,"block"),m(e)}this.bringBlockToFront(),f.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(e){this.fireWorkspaceClick(this.startWorkspace_||this.creatorWorkspace)}bringBlockToFront(){this.targetBlock&&!this.flyout&&(f.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),this.targetBlock.bringToFront())}setStartField(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=e)}setStartIcon(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=e)}setStartBubble(e){this.startBubble||(this.startBubble=e)}setStartComment(e){this.startComment||(this.startComment=e)}setStartBlock(e){this.startBlock||this.startBubble||((this.startBlock=e).isInFlyout&&e!==e.getRootBlock()?this.setTargetBlock(e.getRootBlock()):this.setTargetBlock(e))}setTargetBlock(e){e.isShadow()?this.setTargetBlock(e.getParent()):(this.targetBlock=e,f.getFocusManager$$module$build$src$core$focus_manager().focusNode(e))}setStartWorkspace(e){this.startWorkspace_||(this.startWorkspace_=e)}setStartFlyout(e){this.flyout||(this.flyout=e)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isCommentClick(){return!!this.startComment&&!this.hasExceededDragRadius}isBlockClick(){return!(!this.startBlock||this.hasExceededDragRadius||this.isFieldClick()||this.isIconClick())}isFieldClick(){return!!this.startField&&this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose))}isIconClick(){var e;return!!this.startIcon&&(e=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose),!this.hasExceededDragRadius)&&e}isWorkspaceClick(){return!(this.startBlock||this.startBubble||this.startField||this.hasExceededDragRadius)}getCurrentDragger(){var e;return null!=(e=null!=(e=this.workspaceDragger)?e:this.dragger)?e:null}isDragging(){return this.dragging}hasStarted(){return this.gestureHasStarted}static inProgress(){var r=ne();for(let e=0,t;t=r[e];e++)if(t.currentGesture_)return!0;return!1}},Ud=class{constructor(e,t){var r;this.pattern=e,this.scale=1,this.spacing=null!=(r=t.spacing)?r:0,this.length=null!=(r=t.length)?r:1,this.line2=(this.line1=e.firstChild)&&this.line1.nextSibling,this.snapToGrid=null!=(r=t.snap)&&r}setSpacing(e){this.spacing=e,this.update(this.scale)}getSpacing(){return this.spacing}setLength(e){this.length=e,this.update(this.scale)}getLength(){return this.length}setSnapToGrid(e){this.snapToGrid=e}shouldSnap(){return this.snapToGrid}getPatternId(){return this.pattern.id}update(e){this.scale=e;var t=this.spacing*e,r=(this.pattern.setAttribute("width",""+t),this.pattern.setAttribute("height",""+t),(t=Math.floor(this.spacing/2)+.5)-this.length/2),n=t+this.length/2;this.setLineAttributes(this.line1,e,r*=e,n*=e,t*=e,t),this.setLineAttributes(this.line2,e,t,t,r,n)}setLineAttributes(e,t,r,n,i,s){e&&(e.setAttribute("stroke-width",""+t),e.setAttribute("x1",""+r),e.setAttribute("y1",""+i),e.setAttribute("x2",""+n),e.setAttribute("y2",""+s))}moveTo(e,t){this.pattern.setAttribute("x",""+e),this.pattern.setAttribute("y",""+t)}alignXY(e){var t=(n=this.getSpacing())/2,r=Math.round(Math.round((e.x-t)/n)*n+t),n=Math.round(Math.round((e.y-t)/n)*n+t);return r===e.x&&n===e.y?e:new k(r,n)}static createDom(e,t,r,n){return e=l(x.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},r),0<(null!=(r=t.length)?r:1)&&0<(null!=(r=t.spacing)?r:0)?(l(x.LINE,{stroke:t.colour},e),null!=(r=t.length)&&r&&l(x.LINE,{stroke:t.colour},e)):l(x.LINE,{},e),n&&n.style.setProperty("--blocklyGridPattern",`url(#${e.id})`),e}},Vd=class{constructor(e){this.workspace=e,this.layers=new Map,(e=e.getInjectionDiv())&&(this.dragLayer=this.createDragLayer(e),this.animationLayer=this.createAnimationLayer(e)),e=this.createLayer(50),c(e,"blocklyBlockCanvas"),e=this.createLayer(100),c(e,"blocklyBubbleCanvas")}createDragLayer(e){var t=l(x.SVG,{class:"blocklyBlockDragSurface",xmlns:Do,"xmlns:html":No,"xmlns:xlink":Oo,version:"1.1"});return e.append(t),l(x.G,{},t)}createAnimationLayer(e){var t=l(x.SVG,{class:"blocklyAnimationLayer",xmlns:Do,"xmlns:html":No,"xmlns:xlink":Oo,version:"1.1"});return e.append(t),l(x.G,{},t)}appendToAnimationLayer(e){var t,r=null==(r=this.dragLayer)?void 0:r.getAttribute("transform");r&&null!=(t=this.animationLayer)&&t.setAttribute("transform",r),null!=(t=this.animationLayer)&&t.appendChild(e.getSvgRoot())}translateLayers(e,t){var r;e=`translate(${e.x}, ${e.y}) scale(${t})`,null!=(t=this.dragLayer)&&t.setAttribute("transform",e);for([,r]of this.layers)r.setAttribute("transform",e)}moveToDragLayer(e){var t;null!=(t=this.dragLayer)&&t.appendChild(e.getSvgRoot()),e.canBeFocused()&&f.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}moveOffDragLayer(e,t){this.append(e,t),e.canBeFocused()&&f.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}append(e,t){var r;this.layers.has(t)||this.createLayer(t),e=e.getSvgRoot(),(null==(r=this.layers.get(t))?void 0:r.lastChild)!==e&&null!=(r=this.layers.get(t))&&r.appendChild(e)}createLayer(e){var t,r,n=this.workspace.getSvgGroup(),i=l(x.G,{});let s=!1;for([t,r]of[...this.layers].sort((e,t)=>e[0]-t[0]))if(e<t){n.insertBefore(i,r),s=!0;break}return s||n.appendChild(i),this.layers.set(e,i),i}hasLayer(e){return e===this.dragLayer||new Set(this.layers.values()).has(e)}getBlockLayer(){return this.layers.get(50)}getBubbleLayer(){return this.layers.get(100)}},Hd=class{constructor(){this.curNode=this.colour=null,this.type="marker"}getCurNode(){return this.curNode}setCurNode(e){this.curNode=e}dispose(){this.curNode=null}getSourceBlockFromNode(e){return e instanceof O?e:e instanceof I||e instanceof Qu?e.getSourceBlock():null}getSourceBlock(){return this.getSourceBlockFromNode(this.getCurNode())}},Gd=class extends Hd{constructor(e){super(),this.workspace=e,this.type="cursor",this.potentialNodes=null}next(){var e=this.getCurNode();return e?((e=this.getNextNode(e,e=>{var t;return e instanceof O&&!(null!=(t=e.outputConnection)&&t.targetBlock())||e instanceof xu},!0))&&this.setCurNode(e),e):null}in(){var e=this.getCurNode();return e?((e=this.getNextNode(e,()=>!0,!0))&&this.setCurNode(e),e):null}prev(){var e=this.getCurNode();return e?((e=this.getPreviousNode(e,e=>{var t;return e instanceof O&&!(null!=(t=e.outputConnection)&&t.targetBlock())||e instanceof xu},!0))&&this.setCurNode(e),e):null}out(){var e=this.getCurNode();return e?((e=this.getPreviousNode(e,()=>!0,!0))&&this.setCurNode(e),e):null}atEndOfLine(){var e=this.getCurNode();return!!e&&this.getNextNode(e,()=>!0,!0)===this.getNextNode(e,e=>e instanceof O&&!(null!=(e=e.outputConnection)&&e.targetBlock()),!0)}getNextNodeImpl(e,t,r=new Set){if(!e||r.has(e))return null;let n=this.workspace.getNavigator().getFirstChild(e)||this.workspace.getNavigator().getNextSibling(e);for(var i=e;i&&!n&&(i=this.workspace.getNavigator().getParent(i));)n=this.workspace.getNavigator().getNextSibling(i);return t(n)?n:n?(r.add(e),this.getNextNodeImpl(n,t,r)):null}getNextNode(e,t,r){return!e||!r&&this.getLastNode()===e?null:this.getNextNodeImpl(e,t)}getPreviousNodeImpl(e,t,r=new Set){var n;return!e||r.has(e)?null:t(n=this.getRightMostChild(this.workspace.getNavigator().getPreviousSibling(e),e)||this.workspace.getNavigator().getParent(e))?n:n?(r.add(e),this.getPreviousNodeImpl(n,t,r)):null}getPreviousNode(e,t,r){return!e||!r&&this.getFirstNode()===e?null:this.getPreviousNodeImpl(e,t)}getRightMostChild(e,t){if(!e)return e;let r=this.workspace.getNavigator().getFirstChild(e);if(!r||r===t)return e;for(e=r;e&&e!==t;e=this.workspace.getNavigator().getNextSibling(r))r=e;return this.getRightMostChild(r,t)}preDelete(e){var t,r=(r=this.getCurNode())?[r]:[],n=null!=(n=null==(t=e.previousConnection)?void 0:t.targetConnection)?n:null==(n=e.outputConnection)?void 0:n.targetConnection;n&&r.push(n),(t=e.getNextBlock())&&r.push(t),(e=e.getParent())&&r.push(e),r.push(this.workspace),this.potentialNodes=r}postDelete(){var e,t,r=this.potentialNodes;if(this.potentialNodes=null,!r)throw Error("must call preDelete first");for(e of r)if(null==(t=this.getSourceBlockFromNode(e))||!t.disposed)return void this.setCurNode(e);throw Error("no valid nodes in this.potentialNodes")}getCurNode(){return f.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()}setCurNode(e){f.getFocusManager$$module$build$src$core$focus_manager().focusNode(e),e instanceof O?e.workspace.scrollBoundsIntoView(e.getBoundingRectangleWithoutChildren()):e instanceof I?(e=e.getSourceBlock()).workspace.scrollBoundsIntoView(e.getBoundingRectangleWithoutChildren()):e instanceof xu&&e.workspace.scrollBoundsIntoView(e.getBoundingRectangle())}getFirstNode(){return this.workspace.getNavigator().getFirstChild(this.workspace)}getLastNode(){var e=this.getFirstNode();return this.getPreviousNode(e,()=>!0,!0)}},jd=(i(_.CURSOR,$a,Gd),class{constructor(e){this.workspace=e,this.markers=new Map,this.cursor=new Gd(this.workspace)}registerMarker(e,t){this.markers.has(e)&&this.unregisterMarker(e),this.markers.set(e,t)}unregisterMarker(e){var t=this.markers.get(e);if(!t)throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.");t.dispose(),this.markers.delete(e)}getCursor(){return this.cursor}getMarker(e){return this.markers.get(e)||null}setCursor(e){this.cursor=e}dispose(){var r=Object.keys(this.markers);for(let e=0,t;t=r[e];e++)this.unregisterMarker(t);this.markers.clear(),this.cursor.dispose()}}),Kd=(jd.LOCAL_MARKER="local_marker_1",class extends D{constructor(e,t,r){super(e,t,r,Kd.createTextArea()),this.workspace=e,this.anchor=t,this.ownerRect=r,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.locationChangeListeners=[],this.text="",this.DEFAULT_SIZE=new S(160+D.DOUBLE_BORDER,80+D.DOUBLE_BORDER),this.MIN_SIZE=new S(45+D.DOUBLE_BORDER,20+D.DOUBLE_BORDER),this.editable=!0,c(this.svgRoot,"blocklyTextInputBubble"),this.textArea=this.getFocusableElement(),this.inputRoot=this.createEditor(this.contentContainer,this.textArea),this.resizeGroup=this.createResizeHandle(this.svgRoot,e),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.text}setText(e){this.text=e,this.textArea.value=e,this.onTextChange()}setEditable(e){(this.editable=e)?this.textArea.removeAttribute("readonly"):this.textArea.setAttribute("readonly","")}isEditable(){return this.editable}addTextChangeListener(e){this.textChangeListeners.push(e)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}addLocationChangeListener(e){this.locationChangeListeners.push(e)}static createTextArea(){var e=document.createElementNS(No,"textarea");return e.className="blocklyTextarea blocklyText",e}createEditor(e,t){e=l(x.FOREIGNOBJECT,{x:D.BORDER_WIDTH,y:D.BORDER_WIDTH},e);var r=document.createElementNS(No,"body");return r.setAttribute("xmlns",No),r.className="blocklyMinimalBody",t.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),r.appendChild(t),e.appendChild(r),this.bindTextAreaEvents(t),e}bindTextAreaEvents(e){h(e,"wheel",this,e=>{e.stopPropagation()}),h(e,"pointerdown",this,e=>{e.stopPropagation(),_a()}),h(e,"change",this,this.onTextChange)}createResizeHandle(e,t){return e=l(x.IMAGE,{class:"blocklyResizeHandle",href:t.options.pathToMedia+"resize-handle.svg"},e),h(e,"pointerdown",this,this.onResizePointerDown),e}setSize(e,t=!1){e.width=Math.max(e.width,this.MIN_SIZE.width),e.height=Math.max(e.height,this.MIN_SIZE.height);var r=e.width-D.DOUBLE_BORDER,n=e.height-D.DOUBLE_BORDER;this.inputRoot.setAttribute("width",""+r),this.inputRoot.setAttribute("height",""+n),this.resizeGroup.setAttribute("y",""+n),this.workspace.RTL?this.resizeGroup.setAttribute("x",""+-D.DOUBLE_BORDER):this.resizeGroup.setAttribute("x",""+r),super.setSize(e,t),this.onSizeChange()}getSize(){return super.getSize()}moveDuringDrag(e){super.moveDuringDrag(e),this.onLocationChange()}setPositionRelativeToAnchor(e,t){super.setPositionRelativeToAnchor(e,t),this.onLocationChange()}positionByRect(e=new E(0,0,0,0)){super.positionByRect(e),this.onLocationChange()}onResizePointerDown(e){this.bringToFront(),xa(e)||(wn(this.workspace,e,new k(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=h(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=h(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation()}onResizePointerUp(e){_a(),this.resizePointerUpListener&&(s(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(s(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(e){e=In(this.workspace,e),this.setSize(new S(this.workspace.RTL?-e.x:e.x,e.y),!1),this.onSizeChange()}onTextChange(){this.text=this.textArea.value;for(var e of this.textChangeListeners)e()}onSizeChange(){for(var e of this.sizeChangeListeners)e()}onLocationChange(){for(var e of this.locationChangeListeners)e()}}),Gu=(_e("\n.blocklyTextInputBubble .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 0;\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n"),{}),zd=(Gu.register=hh,Gu.unregister=ph,class extends Vu{constructor(e){super(e),this.sourceBlock=e,this.textInputBubble=null,this.text="",this.bubbleSize=new S(160,80),this.bubbleVisiblity=!1}getType(){return zd.TYPE}initView(e){this.svgRoot||(super.initView(e),l(x.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),l(x.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),l(x.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot),c(this.svgRoot,"blocklyCommentIcon"))}dispose(){var e;super.dispose(),null!=(e=this.textInputBubble)&&e.dispose()}getWeight(){return zd.WEIGHT}getSize(){return new S(17,17)}applyColour(){super.applyColour();var e,t=this.sourceBlock.getColour();null!=(e=this.textInputBubble)&&e.setColour(t)}updateEditable(){let e=this,t=()=>super.updateEditable;return(0,p.asyncExecutePromiseGeneratorFunction)(function*(){t().call(e),e.bubbleIsVisible()&&(yield e.setBubbleVisible(!1),yield e.setBubbleVisible(!0))})}onLocationChange(e){var t=this.workspaceLocation;super.onLocationChange(e),this.bubbleLocation&&(e=k.difference(this.workspaceLocation,t),this.bubbleLocation=k.sum(this.bubbleLocation,e)),e=this.getAnchorLocation(),null!=(t=this.textInputBubble)&&t.setAnchorLocation(e)}setText(e){var t=this.text;m(new(g(y.BLOCK_CHANGE))(this.sourceBlock,"comment",null,t,e)),this.text=e,null!=(t=this.textInputBubble)&&t.setText(this.text)}getText(){return this.text}setBubbleSize(e){this.bubbleSize=e,null!=(e=this.textInputBubble)&&e.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}setBubbleLocation(e){var t;this.bubbleLocation=e,null!=(t=this.textInputBubble)&&t.moveDuringDrag(e)}getBubbleLocation(){return this.bubbleLocation}saveState(){var e,t;return this.text?(e={text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width},(t=this.getBubbleLocation())&&(e.x=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(t.x+this.bubbleSize.width):t.x,e.y=t.y),e):null}loadState(e){var t;this.text=null!=(t=e.text)?t:"",this.bubbleSize=new S(null!=(t=e.width)?t:160,null!=(t=e.height)?t:80),this.bubbleVisiblity=null!=(t=e.pinned)&&t,this.setBubbleVisible(this.bubbleVisiblity);let r=e.x,n=e.y;tt().then(()=>{r&&n&&(r=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(r+this.bubbleSize.width):r,this.setBubbleLocation(new k(r,n)))})}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){var e;this.textInputBubble&&(e=this.textInputBubble.getText(),this.text!==e)&&(m(new(g(y.BLOCK_CHANGE))(this.sourceBlock,"comment",null,this.text,e)),this.text=e)}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}onBubbleLocationChange(){this.textInputBubble&&(this.bubbleLocation=this.textInputBubble.getRelativeToSurfaceXY())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(e){let t=this;return(0,p.asyncExecutePromiseGeneratorFunction)(function*(){t.bubbleVisiblity!==e&&(t.bubbleVisiblity=e,yield tt(),!t.sourceBlock.rendered||t.sourceBlock.isInFlyout||t.sourceBlock.isInsertionMarker()||(e?(t.sourceBlock.isEditable()?t.showEditableBubble():t.showNonEditableBubble(),t.applyColour()):t.hideBubble(),m(new(g(y.BUBBLE_OPEN))(t.sourceBlock,e,"comment"))))})}getBubble(){return this.textInputBubble}showEditableBubble(){var e;this.createBubble(),null!=(e=this.textInputBubble)&&e.addTextChangeListener(()=>this.onTextChange()),null!=(e=this.textInputBubble)&&e.addSizeChangeListener(()=>this.onSizeChange())}showNonEditableBubble(){var e;this.createBubble(),null!=(e=this.textInputBubble)&&e.setEditable(!1)}createBubble(){this.textInputBubble=new Kd(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.bubbleLocation&&this.textInputBubble.moveDuringDrag(this.bubbleLocation),this.textInputBubble.addTextChangeListener(()=>this.onTextChange()),this.textInputBubble.addSizeChangeListener(()=>this.onSizeChange()),this.textInputBubble.addLocationChangeListener(()=>this.onBubbleLocationChange())}hideBubble(){var e;null!=(e=this.textInputBubble)&&e.dispose(),this.textInputBubble=null}getAnchorLocation(){return k.sum(this.workspaceLocation,new k(8.5,8.5))}getBubbleOwnerRect(){return this.sourceBlock.getBoundingRectangleWithoutChildren()}}),Wd=(zd.TYPE=uc.COMMENT,zd.WEIGHT=3,hh(zd.TYPE,zd),{});Wd.CommentIcon=zd,Wd.Icon=Vu,Wd.IconType=uc,Wd.MutatorIcon=f.MutatorIcon$$module$build$src$core$icons$mutator_icon,Wd.WarningIcon=pd,Wd.exceptions=qu,Wd.registry=Gu;f.Names$$module$build$src$core$names=class{constructor(e,t){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=t||"",this.reservedWords=new Set(e?e.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(e){this.variableMap=e}getNameForUserVariable(e){return this.variableMap?(e=this.variableMap.getVariableById(e))?e.getName():null:(console.warn("Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)}populateVariables(t){t=f.allUsedVarModels$$module$build$src$core$variables(t);for(let e=0;e<t.length;e++)this.getName(t[e].getId(),f.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(e){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(e,t){let r=e;e=(r=t===f.NameType$$module$build$src$core$names.VARIABLE&&(e=this.getNameForUserVariable(e))?e:r).toLowerCase();var n=t===f.NameType$$module$build$src$core$names.VARIABLE||t===f.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"",i=(this.db.has(t)||this.db.set(t,new Map),this.db.get(t));return i.has(e)?n+i.get(e):(t=this.getDistinctName(r,t),i.set(e,t.substr(n.length)),t)}getUserNames(e){var t;return(e=null==(t=this.db.get(e))?void 0:t.keys())?Array.from(e):[]}getDistinctName(e,t){e=this.safeName(e);let r=null,n,i;for(;this.dbReverse.has(e+(null!=(n=r)?n:""))||this.reservedWords.has(e+(null!=(i=r)?i:""));)r=r?r+1:2;var s;return e+=null!=(s=r)?s:"",this.dbReverse.add(e),(t===f.NameType$$module$build$src$core$names.VARIABLE||t===f.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+e}safeName(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".includes(e[0])&&(e="my_"+e)):e=f.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",e}static equals(e,t){return e.toLowerCase()===t.toLowerCase()}},(P=(P=f.Names$$module$build$src$core$names||(f.Names$$module$build$src$core$names={})).NameType||(P.NameType={})).DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",P.VARIABLE="VARIABLE",P.PROCEDURE="PROCEDURE",f.NameType$$module$build$src$core$names=f.Names$$module$build$src$core$names.NameType,f.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=f.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE;({NameType:f.NameType$$module$build$src$core$names}).Names=f.Names$$module$build$src$core$names;var qd,Jd,Yd,Xd,Zd=class extends Map{constructor(){super()}set(e,t){return this.get(e)!==t&&(super.set(e,t),Ui(t))&&t.startPublishing(),this}delete(e){var t=this.get(e);return(e=super.delete(e))&&Ui(t)&&t.stopPublishing(),e}clear(){if(this.size)for(var e of this.keys())this.delete(e)}add(e){return this.set(e.getId(),e)}getProcedures(){return[...this.values()]}},Qd="PROCEDURE",R=(f.DEFAULT_ARG$$module$build$src$core$procedures="x",(qd={CATEGORY_NAME:Qd,DEFAULT_ARG:f.DEFAULT_ARG$$module$build$src$core$procedures}).ObservableProcedureMap=Zd,qd.allProcedures=Vi,qd.findLegalName=f.findLegalName$$module$build$src$core$procedures,qd.flyoutCategory=Wi,qd.getCallers=Xi,qd.getDefinition=f.getDefinition$$module$build$src$core$procedures,qd.internalFlyoutCategory=zi,qd.isNameUsed=ji,qd.isProcedureBlock=$i,qd.mutateCallers=f.mutateCallers$$module$build$src$core$procedures,qd.mutatorOpenListener=Ji,qd.rename=f.rename$$module$build$src$core$procedures,new class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(e){return Object.prototype.hasOwnProperty.call(this,e)||(this[e]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[e]}isField(e){return 1<=(e.type&this.FIELD)}isHat(e){return 1<=(e.type&this.HAT)}isIcon(e){return 1<=(e.type&this.ICON)}isSpacer(e){return 1<=(e.type&this.SPACER)}isInRowSpacer(e){return 1<=(e.type&this.IN_ROW_SPACER)}isSpacerRow(e){return 1<=(e.type&this.BETWEEN_ROW_SPACER)}isInput(e){return 1<=(e.type&this.INPUT)}isExternalInput(e){return 1<=(e.type&this.EXTERNAL_VALUE_INPUT)}isInlineInput(e){return 1<=(e.type&this.INLINE_INPUT)}isStatementInput(e){return 1<=(e.type&this.STATEMENT_INPUT)}isPreviousConnection(e){return 1<=(e.type&this.PREVIOUS_CONNECTION)}isNextConnection(e){return 1<=(e.type&this.NEXT_CONNECTION)}isPreviousOrNextConnection(e){return this.isPreviousConnection(e)||this.isNextConnection(e)}isRoundCorner(e){return 1<=(e.type&this.LEFT_ROUND_CORNER)||1<=(e.type&this.RIGHT_ROUND_CORNER)}isLeftRoundedCorner(e){return this.isRoundCorner(e)&&1<=(e.type&this.LEFT_ROUND_CORNER)}isRightRoundedCorner(e){return this.isRoundCorner(e)&&1<=(e.type&this.RIGHT_ROUND_CORNER)}isLeftSquareCorner(e){return 1<=(e.type&this.LEFT_SQUARE_CORNER)}isRightSquareCorner(e){return 1<=(e.type&this.RIGHT_SQUARE_CORNER)}isCorner(e){return 1<=(e.type&this.CORNER)}isJaggedEdge(e){return 1<=(e.type&this.JAGGED_EDGE)}isRow(e){return 1<=(e.type&this.ROW)}isBetweenRowSpacer(e){return 1<=(e.type&this.BETWEEN_ROW_SPACER)}isTopRow(e){return 1<=(e.type&this.TOP_ROW)}isBottomRow(e){return 1<=(e.type&this.BOTTOM_ROW)}isTopOrBottomRow(e){return this.isTopRow(e)||this.isBottomRow(e)}isInputRow(e){return 1<=(e.type&this.INPUT_ROW)}}),L=class{constructor(e){this.centerline=this.xPos=this.height=this.width=0,this.constants_=e,this.type=R.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},C=class{constructor(e){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=e,this.type=R.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let e=this.elements.length-1;0<=e;e--){var t=this.elements[e];if(R.isInput(t))return t}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let e=0;e<this.elements.length;e++){var t=this.elements[e];if(R.isInRowSpacer(t))return t}return null}getLastSpacer(){for(let e=this.elements.length-1;0<=e;e--){var t=this.elements[e];if(R.isInRowSpacer(t))return t}return null}},ep=class extends C{constructor(e){super(e),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=R.BOTTOM_ROW}hasLeftSquareCorner(e){return!!e.outputConnection||!!e.getNextBlock()}hasRightSquareCorner(e){return!0}measure(){let t=0,r=0,n=0;for(let e=0;e<this.elements.length;e++){var i=this.elements[e];r+=i.width,R.isSpacer(i)||(R.isNextConnection(i)?n=Math.max(n,i.height):t=Math.max(t,i.height))}this.width=Math.max(this.minWidth,r),this.height=Math.max(this.minHeight,t)+n,this.descenderHeight=n,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},tp=class extends L{constructor(e,t){super(e),this.connectionModel=t,this.type|=R.CONNECTION,this.shape=this.constants_.shapeFor(t),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.highlighted=t.isHighlighted()}},Wo=class extends tp{constructor(e,t){super(e,t.connection),this.input=t,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=R.INPUT,this.align=t.align,(this.connectedBlock=t.connection&&t.connection.targetBlock()?t.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},rp=class extends Wo{constructor(e,t){super(e,t),this.height=0,this.type|=R.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},np=class extends L{constructor(e,t,r){super(e),this.field=t,this.parentInput=r,this.isEditable=t.EDITABLE,this.flipRtl=t.getFlipRtl(),this.type|=R.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width}},ip=class extends L{constructor(e){super(e),this.type|=R.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},sp=class extends L{constructor(e,t){super(e),this.icon=t,this.flipRtl=!1,this.type|=R.ICON,e=t.getSize(),this.height=e.height,this.width=e.width}},ap=class extends L{constructor(e,t){super(e),this.type|=R.SPACER|R.IN_ROW_SPACER,this.width=t,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},op=class extends Wo{constructor(e,t){super(e,t),this.type|=R.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},lp=class extends C{constructor(e){super(e),this.connectedBlockWidths=0,this.type|=R.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let t=0;for(let e=0;e<this.elements.length;e++){var r=this.elements[e];this.width+=r.width,R.isInput(r)&&(R.isStatementInput(r)?t+=r.connectedBlockWidth:R.isExternalInput(r)&&0!==r.connectedBlockWidth&&(t+=r.connectedBlockWidth-r.connectionWidth)),R.isSpacer(r)||(this.height=Math.max(this.height,r.height))}this.connectedBlockWidths=t,this.widthWithConnectedBlocks=this.width+t}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},cp=class extends L{constructor(e){super(e),this.type|=R.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},up=class extends tp{constructor(e,t){super(e,t),this.type|=R.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},dp=class extends tp{constructor(e,t){super(e,t),this.connectionOffsetX=0,this.type|=R.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},pp=class extends tp{constructor(e,t){super(e,t),this.type|=R.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},hp=class extends L{constructor(e,t){super(e),this.type=(t&&"left"!==t?R.RIGHT_ROUND_CORNER:R.LEFT_ROUND_CORNER)|R.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},mp=class extends C{constructor(e,t,r){super(e),this.height=t,this.width=r,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type|=R.SPACER|R.BETWEEN_ROW_SPACER,this.elements=[new ap(this.constants_,r)]}measure(){}},gp=class extends L{constructor(e,t){super(e),this.type=(t&&"left"!==t?R.RIGHT_SQUARE_CORNER:R.LEFT_SQUARE_CORNER)|R.CORNER,this.width=this.height=this.constants_.NO_PADDING}},fp=class extends Wo{constructor(e,t){super(e,t),this.type|=R.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},_p=class extends C{constructor(e){super(e),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=R.TOP_ROW}hasLeftSquareCorner(e){var t=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,r=e.getPreviousBlock();return!!e.outputConnection||t||!!r&&r.getNextBlock()===e}hasRightSquareCorner(e){return!0}measure(){let t=0,r=0,n=0;for(let e=0;e<this.elements.length;e++){var i=this.elements[e];r+=i.width,R.isSpacer(i)||(R.isHat(i)?n=Math.max(n,i.ascenderHeight):t=Math.max(t,i.height))}this.width=Math.max(this.minWidth,r),this.height=Math.max(this.minHeight,t)+n,this.capline=this.ascenderHeight=n,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},yp=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=di(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(e){this.blockStyles=Object.create(null);var t,r=e.blockStyles;for(t in r)this.blockStyles[t]=this.validatedBlockStyle_(r[t]);this.setDynamicProperties_(e)}setDynamicProperties_(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=void 0!==e.startHats?e.startHats:this.ADD_START_HATS}setFontConstants_(e){e.fontStyle&&e.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=e.fontStyle.family),e.fontStyle&&e.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=e.fontStyle.weight),e.fontStyle&&e.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=e.fontStyle.size),e=Z("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline}setComponentConstants_(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(e){var t="auto_"+e;return this.blockStyles[t]||(this.blockStyles[t]=this.createBlockStyle_(e)),{style:this.blockStyles[t],name:t}}getBlockStyle(e){return this.blockStyles[e||""]||(e&&e.startsWith("auto_")?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(e){return this.validatedBlockStyle_({colourPrimary:e})}validatedBlockStyle_(e){var t={};return e&&Object.assign(t,e),e=sn(t.colourPrimary||"#000"),t.colourPrimary=e.hex,t.colourSecondary=t.colourSecondary?sn(t.colourSecondary).hex:this.generateSecondaryColour_(t.colourPrimary),t.colourTertiary=t.colourTertiary?sn(t.colourTertiary).hex:this.generateTertiaryColour_(t.colourPrimary),t.hat=t.hat||"",t}generateSecondaryColour_(e){return Qr("#fff",e,.6)||e}generateTertiaryColour_(e){return Qr("#fff",e,.3)||e}dispose(){this.embossFilter&&o(this.embossFilter),this.disabledPattern&&o(this.disabledPattern),this.debugFilter&&o(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){var e=this.JAGGED_TEETH_HEIGHT,t=this.JAGGED_TEETH_WIDTH;return{height:e,width:t,path:hi([u(t,e/4),u(2*-t,e/2),u(t,e/4)])}}makeStartHat(){var e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH;return{height:.75*e,width:t,path:ci("c",[u(30,-e),u(70,-e),u(t,0)])}}makePuzzleTab(){function e(e){var t=-(e=e?-1:1),r=2.5+(s=o/2),n=.5+s,i=u(-a,e*s),s=u(a,e*s);return ci("c",[u(0,e*r),u(-a,t*n),i])+ci("s",[u(a,2.5*t),s])}let a=this.TAB_WIDTH,o=this.TAB_HEIGHT,t=e(!0),r=e(!1);return{type:this.SHAPES.PUZZLE,width:a,height:o,pathDown:r,pathUp:t}}makeNotch(){function e(e){return hi([u(e*n,r),u(3*e,0),u(e*n,-r)])}let t=this.NOTCH_WIDTH,r=this.NOTCH_HEIGHT,n=(t-3)/2,i=e(1),s=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:r,pathLeft:i,pathRight:s}}makeInsideCorners(){var e=this.CORNER_RADIUS;return{width:e,height:e,pathTop:mi("a","0 0,0",e,u(-e,e)),pathBottom:mi("a","0 0,0",e,u(e,e))}}makeOutsideCorners(){var e=this.CORNER_RADIUS,t=di(0,e)+mi("a","0 0,1",e,u(e,-e)),r=mi("a","0 0,1",e,u(e,e)),n=mi("a","0 0,1",e,u(-e,-e));return{topLeft:t,topRight:r,bottomRight:mi("a","0 0,1",e,u(-e,e)),bottomLeft:n,rightHeight:e}}shapeFor(e){switch(e.type){case v.INPUT_VALUE:case v.OUTPUT_VALUE:return this.PUZZLE_TAB;case v.PREVIOUS_STATEMENT:case v.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(e,t,r,n){this.injectCSS_(t,r),this.defs=l(x.DEFS,{},e),e=l(x.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),l(x.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),t=l(x.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),l(x.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},t),l(x.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),l(x.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter=e,e=l(x.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),l(x.RECT,{width:10,height:10,fill:"#aaa"},e),l(x.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern=e,this.createDebugFilter(),n&&(n.style.setProperty("--blocklyEmbossFilter",`url(#${this.embossFilterId})`),n.style.setProperty("--blocklyDisabledPattern",`url(#${this.disabledPatternId})`),n.style.setProperty("--blocklyDebugFilter",`url(#${this.debugFilterId})`))}createDebugFilter(){var e,t;this.debugFilter||(e=l(x.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),t=l(x.FECOMPONENTTRANSFER,{result:"outBlur"},e),l(x.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),l(x.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),l(x.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter=e)}injectCSS_(e,t){t=this.getCSS_(t),e="blockly-renderer-style-"+e,this.cssNode=document.getElementById(e);var r=t.join("\n");this.cssNode?this.cssNode.firstChild.textContent=r:((t=document.createElement("style")).id=e,e=document.createTextNode(r),t.appendChild(e),document.head.insertBefore(t,document.head.firstChild),this.cssNode=t)}getCSS_(e){return[e+" .blocklyText, ",e+" .blocklyFlyoutLabelText {",`font: ${this.FIELD_TEXT_FONTWEIGHT} `+`${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",e+" .blocklyText {","fill: #fff;","}",e+" .blocklyNonEditableField>rect,",e+" .blocklyEditableField>rect {",`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",e+" .blocklyNonEditableField>text,",e+" .blocklyEditableField>text {","fill: #000;","}",e+" .blocklyFlyoutLabelText {","fill: #000;","}",e+" .blocklyText.blocklyBubbleText {","fill: #000;","}",e+" .blocklyEditableField:not(.blocklyEditing):hover>rect {","stroke: #fff;","stroke-width: 2;","}",e+" .blocklyHtmlInput {",`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",e+" .blocklySelected>.blocklyPath {","stroke: #fc3;","stroke-width: 3px;","}",e+" .blocklyHighlightedConnectionPath {","stroke: #fc3;","}",e+" .blocklyReplaceable .blocklyPath {","fill-opacity: .5;","}",e+" .blocklyReplaceable .blocklyPathLight,",e+" .blocklyReplaceable .blocklyPathDark {","display: none;","}",e+" .blocklyInsertionMarker>.blocklyPath {",`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},bp=class{constructor(e,t){this.inlinePath_=this.outlinePath_="",this.block_=e,this.info_=t,this.topLeft_=e.getRelativeToSurfaceXY(),this.constants_=t.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren,this.block_.childlessWidth=this.info_.width}drawOutline_(){this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){var t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}drawTop_(){var e=this.info_.topRow,r=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=di(e.xPos,this.info_.startY);for(let e=0,t;t=r[e];e++)R.isLeftRoundedCorner(t)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:R.isRightRoundedCorner(t)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:R.isPreviousConnection(t)?this.outlinePath_+=t.shape.pathLeft:R.isHat(t)?this.outlinePath_+=this.constants_.START_HAT.path:R.isSpacer(t)&&(this.outlinePath_+=d("h",t.width));this.outlinePath_+=d("v",e.height)}drawJaggedEdge_(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+d("v",e.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(e){var t=e.getLastInput(),r=(this.positionExternalValueConnection_(e),Qi(t.shape)?t.shape.pathDown(t.height):t.shape.pathDown);this.outlinePath_+=d("H",t.xPos+t.width)+r+d("v",e.height-t.connectionHeight)}drawStatementInput_(e){var t,r,n=e.getLastInput();n&&(t=n.xPos+n.notchOffset+n.shape.width,n=n.shape.pathRight+d("h",-(n.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop,r=e.height-2*this.constants_.INSIDE_CORNERS.height,this.outlinePath_+=d("H",t)+n+d("v",r)+this.constants_.INSIDE_CORNERS.pathBottom+d("H",e.xPos+e.width),this.positionStatementInputConnection_(e))}drawRightSideRow_(e){this.outlinePath_+=d("V",e.yPos+e.height)}drawBottom_(){var r=this.info_.bottomRow,n=r.elements;this.positionNextConnection_();let i=0,s="";for(let e=n.length-1,t;t=n[e];e--)R.isNextConnection(t)?s+=t.shape.pathRight:R.isLeftSquareCorner(t)?s+=d("H",r.xPos):R.isLeftRoundedCorner(t)?s+=this.constants_.OUTSIDE_CORNERS.bottomLeft:R.isRightRoundedCorner(t)?(s+=this.constants_.OUTSIDE_CORNERS.bottomRight,i=this.constants_.OUTSIDE_CORNERS.rightHeight):R.isSpacer(t)&&(s+=d("h",-1*t.width));this.outlinePath_+=d("V",r.baseline-i),this.outlinePath_+=s}drawLeft_(){var e,t=this.info_.outputConnection;this.positionOutputConnection_(),t&&(e=t.connectionOffsetY+t.height,t=Qi(t.shape)?t.shape.pathUp(t.height):t.shape.pathUp,this.outlinePath_+=d("V",e)+t),this.outlinePath_+="z"}drawInternals_(){for(let e=0,r;r=this.info_.rows[e];e++)for(let e=0,t;t=r.elements[e];e++)R.isInlineInput(t)?this.drawInlineInput_(t):(R.isIcon(t)||R.isField(t))&&this.layoutField_(t)}layoutField_(e){var t=e.centerline-e.height/2;let r=e.xPos;var n="";this.info_.RTL&&(r=-(r+e.width),e.flipRtl)&&(r+=e.width,n="scale(-1 1)"),R.isIcon(e)?((n=e.icon).setOffsetInBlock(new k(r,t)),this.info_.isInsertionMarker&&n.hideForInsertionMarker()):((e=e.field.getSvgRoot()).setAttribute("transform","translate("+r+","+t+")"+n),this.info_.isInsertionMarker&&e.setAttribute("display","none"))}drawInlineInput_(e){var t=e.width,r=e.height,n=e.connectionOffsetY;this.inlinePath_+=ui(e.xPos+e.connectionWidth,e.centerline-r/2)+d("v",n)+e.shape.pathDown+d("v",r-(e.connectionHeight+n))+d("h",t-e.connectionWidth)+d("v",-r)+"z",this.positionInlineInputConnection_(e)}positionInlineInputConnection_(t){var r=t.centerline-t.height/2;if(t.connectionModel){let e=t.xPos+t.connectionWidth+t.connectionOffsetX;this.info_.RTL&&(e*=-1),t.connectionModel.setOffsetInBlock(e,r+t.connectionOffsetY)}}positionStatementInputConnection_(t){var r=t.getLastInput();if(null!=r&&r.connectionModel){let e=t.xPos+t.statementEdge+r.notchOffset;this.info_.RTL&&(e*=-1),r.connectionModel.setOffsetInBlock(e,t.yPos)}}positionExternalValueConnection_(t){var r=t.getLastInput();if(r&&r.connectionModel){let e=t.xPos+t.width;this.info_.RTL&&(e*=-1),r.connectionModel.setOffsetInBlock(e,t.yPos)}}positionPreviousConnection_(){var e,t=this.info_.topRow;t.connection&&(e=t.xPos+t.notchOffset,t.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-e:e,0))}positionNextConnection_(){var e,t,r=this.info_.bottomRow;r.connection&&(t=(e=r.connection).xPos,e.connectionModel.setOffsetInBlock(this.info_.RTL?-t:t,r.baseline))}positionOutputConnection_(){var e;this.info_.outputConnection&&(e=this.info_.startX+this.info_.outputConnection.connectionOffsetX,this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY))}updateConnectionHighlights(){for(var e of this.info_.rows)for(var t of e.elements){var r;t instanceof tp&&(r=this.drawConnectionHighlightPath(t))&&(r.style.display=t.highlighted?"":"none")}}drawConnectionHighlightPath(e){var t,r,n=e.connectionModel,i=(e=n.type===v.INPUT_VALUE||n.type===v.OUTPUT_VALUE?this.getExpressionConnectionHighlightPath(e):this.getStatementConnectionHighlightPath(e),n.getSourceBlock());return null==(r=(t=i.pathObject).addConnectionHighlight)?void 0:r.call(t,n,e,n.getOffsetInBlock(),i.RTL)}getExpressionConnectionHighlightPath(e){let t="";return Qi(e.shape)?t=e.shape.pathDown(e.height):es(e.shape)&&(t=e.shape.pathDown),e=this.constants_.TAB_OFFSET_FROM_TOP,di(0,-e)+d("v",e)+t+d("v",e)}getStatementConnectionHighlightPath(e){var t;if(ts(e.shape))return t=this.constants_.NOTCH_OFFSET_LEFT-this.constants_.CORNER_RADIUS,di(-t,0)+d("h",t)+e.shape.pathLeft+d("h",t);throw Error("Statement connections should have notch shapes")}},vp=class{constructor(e,t){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=e,this.block_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=t.outputConnection?new dp(this.constants_,t.outputConnection):null,this.isInline=t.getInputsInline()&&!t.isCollapsed(),this.isCollapsed=t.isCollapsed(),this.isInsertionMarker=t.isInsertionMarker(),this.RTL=t.RTL,this.topRow=new _p(this.constants_),this.bottomRow=new ep(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let n=new lp(this.constants_);this.inputRows.push(n);var i=this.block_.getIcons();for(let e=0,t;t=i[e];e++){var r=new sp(this.constants_,t);this.isCollapsed&&!t.isShownWhenCollapsed()||n.elements.push(r)}i=void 0;for(let e=0,r;r=this.block_.inputList[e];e++)if(r.isVisible()){this.shouldStartNewRow_(r,i)&&(this.rows.push(n),n=new lp(this.constants_),this.inputRows.push(n));for(let e=0,t;t=r.fieldRow[e];e++)n.elements.push(new np(this.constants_,t,r));this.addInput_(r,n),i=r}this.isCollapsed&&(n.hasJaggedEdge=!0,n.elements.push(new cp(this.constants_))),(n.elements.length||n.hasDummyInput)&&this.rows.push(n),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var e=!!this.block_.previousConnection,t=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e;let r=this.topRow.hasLeftSquareCorner(this.block_)?gp:hp;this.topRow.elements.push(new r(this.constants_)),t?(e=new ip(this.constants_),this.topRow.elements.push(e)):e&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new pp(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0]instanceof nd&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,r=this.topRow.hasRightSquareCorner(this.block_)?gp:hp,this.topRow.elements.push(new r(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof nd?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new gp(this.constants_)):this.bottomRow.elements.push(new hp(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new up(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new gp(this.constants_,"right")):this.bottomRow.elements.push(new hp(this.constants_,"right"))}addInput_(e,t){this.isInline&&e instanceof f.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new op(this.constants_,e)),t.hasInlineInput=!0):e instanceof nd?(t.elements.push(new fp(this.constants_,e)),t.hasStatement=!0):e instanceof f.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new rp(this.constants_,e)),t.hasExternalInput=!0):(e instanceof td||e instanceof rd)&&(t.minHeight=Math.max(t.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),null===t.align&&(t.align=e.align)}shouldStartNewRow_(e,t){return!!t&&(t instanceof rd||e instanceof nd||t instanceof nd||(e instanceof f.ValueInput$$module$build$src$core$inputs$value_input||e instanceof td||t instanceof f.ValueInput$$module$build$src$core$inputs$value_input)&&!this.isInline)}addElemSpacing_(){for(let e=0,t;t=this.rows[e];e++){var r=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new ap(this.constants_,this.getInRowSpacing_(null,r[0]))),r.length){for(let e=0;e<r.length-1;e++){t.elements.push(r[e]);var n=this.getInRowSpacing_(r[e],r[e+1]);t.elements.push(new ap(this.constants_,n))}t.elements.push(r[r.length-1]),t.endsWithElemSpacer()&&t.elements.push(new ap(this.constants_,this.getInRowSpacing_(r[r.length-1],null)))}}}getInRowSpacing_(e,t){if(!e&&t&&R.isStatementInput(t))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&R.isInput(e)&&!t){if(R.isExternalInput(e))return this.constants_.NO_PADDING;if(R.isInlineInput(e))return this.constants_.LARGE_PADDING;if(R.isStatementInput(e))return this.constants_.NO_PADDING}return e&&R.isLeftSquareCorner(e)&&t&&(R.isPreviousConnection(t)||R.isNextConnection(t))?t.notchOffset:e&&R.isLeftRoundedCorner(e)&&t&&(R.isPreviousConnection(t)||R.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&R.isField(e)&&0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING}computeBounds_(){let r=0,n=0,i=0;for(let e=0,t;t=this.rows[e];e++){var s,a;t.measure(),n=Math.max(n,t.width),t.hasStatement&&(a=t.getLastInput(),a=t.width-(null!=(s=null==a?void 0:a.width)?s:0),r=Math.max(r,a)),i=Math.max(i,t.widthWithConnectedBlocks)}this.statementEdge=r,this.width=n;for(let e=0,t;t=this.rows[e];e++)t.hasStatement&&(t.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(n,i),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let e=0,t;t=this.rows[e];e++){var r;t.hasStatement?this.alignStatementRow_(t):(r=t.width,0<(r=this.getDesiredRowWidth_(t)-r)&&this.addAlignmentPadding_(t,r),R.isTopOrBottomRow(t)&&(t.widthWithConnectedBlocks=t.width))}}getDesiredRowWidth_(e){return this.width-this.startX}addAlignmentPadding_(e,t){var r=e.getFirstSpacer(),n=e.getLastSpacer();if((e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=t),e.align===f.Align$$module$build$src$core$inputs$align.LEFT&&n)n.width+=t;else if(e.align===f.Align$$module$build$src$core$inputs$align.CENTRE&&r&&n)r.width+=t/2,n.width+=t/2;else if(e.align===f.Align$$module$build$src$core$inputs$align.RIGHT&&r)r.width+=t;else{if(!n)return;n.width+=t}e.width+=t}alignStatementRow_(e){var t,r,n=e.getLastInput();n&&(r=e.width-n.width,0<(r=this.statementEdge-r)&&this.addAlignmentPadding_(e,r),r=e.width,t=this.getDesiredRowWidth_(e),n.width+=t-r,n.height=Math.max(n.height,e.height),e.width+=t-r,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths))}addRowSpacing_(){var t=this.rows;this.rows=[];for(let e=0;e<t.length;e++)this.rows.push(t[e]),e!==t.length-1&&this.rows.push(this.makeSpacerRow_(t[e],t[e+1]))}makeSpacerRow_(e,t){var r=this.getSpacerRowHeight_(e,t),n=this.getSpacerRowWidth_(e,t),r=new mp(this.constants_,r,n);return e.hasStatement&&(r.followsStatement=!0),t.hasStatement&&(r.precedesStatement=!0),r}getSpacerRowWidth_(e,t){return this.width-this.startX}getSpacerRowHeight_(e,t){return this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){return R.isSpacer(t)?e.yPos+t.height/2:R.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,R.isNextConnection(t)?e+t.height/2:e-t.height/2):R.isTopRow(e)?R.isHat(t)?e.capline-t.height/2:e.capline+t.height/2:e.yPos+e.height/2}recordElemPositions_(r){let n=r.xPos;for(let e=0,t;t=r.elements[e];e++)R.isSpacer(t)&&(t.height=r.height),t.xPos=n,t.centerline=this.getElemCenterline_(r,t),n+=t.width}finalize_(){let r=0,n=0;for(let e=0,t;t=this.rows[e];e++)t.yPos=n,t.xPos=this.startX,n+=t.height,r=Math.max(r,t.widthWithConnectedBlocks),this.recordElemPositions_(t);var e;this.outputConnection&&this.block_.nextConnection&&(e=this.block_.nextConnection.targetBlock())&&(r=Math.max(r,e.getHeightWidth().width)),this.widthWithChildren=r+this.startX,this.height=n,this.startY=this.topRow.capline,this.bottomRow.baseline=n-this.bottomRow.descenderHeight}getMeasureableForConnection(e){var t,r;if((null==(t=this.outputConnection)?void 0:t.connectionModel)===e)return this.outputConnection;for(r of this.rows)for(var n of r.elements)if(n instanceof tp&&n.connectionModel===e)return n;return null}},Tp=class{constructor(e,t,r){this.connectionHighlights=new WeakMap,this.highlightOffsets=new WeakMap,this.constants=r,this.style=t,this.svgRoot=e,this.svgPath=l(x.PATH,{class:"blocklyPath"},this.svgRoot),this.setClass_("blocklyBlock",!0)}setPath(e){this.svgPath.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}applyColour(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())}setStyle(e){this.style=e}setClass_(e,t){e&&(t?c:a)(this.svgRoot,e)}updateHighlighted(e){e?this.setClass_("blocklyHighlighted",!0):this.setClass_("blocklyHighlighted",!1)}updateShadow_(e){e?(this.setClass_("blocklyShadow",!0),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)):this.setClass_("blocklyShadow",!1)}updateDisabled_(e){this.setClass_("blocklyDisabled",e),this.setClass_("blocklyDisabledPattern",e)}updateSelected(e){this.setClass_("blocklySelected",e)}updateDraggingDelete(e){this.setClass_("blocklyDraggingDelete",e)}updateInsertionMarker(e){this.setClass_("blocklyInsertionMarker",e)}updateMovable(e){this.setClass_("blocklyDraggable",e)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){}addConnectionHighlight(e,t,r,n){return r=`translate(${r.x}, ${r.y})`+(n?" scale(-1 1)":""),(n=this.connectionHighlights.get(e))?(n.setAttribute("d",t),n.setAttribute("transform",r),n):(t=l(x.PATH,{id:e.id,class:"blocklyHighlightedConnectionPath",style:"display: none;",d:t,transform:r},this.svgRoot),this.connectionHighlights.set(e,t),t)}removeConnectionHighlight(e){var t=this.connectionHighlights.get(e);t&&(o(t),this.connectionHighlights.delete(e))}},Jc=class{constructor(e){this.overrides=null,this.name=e}getClassName(){return this.name+"-renderer"}init(e,t){this.constants_=this.makeConstants_(),t&&(this.overrides=t,Object.assign(this.constants_,t)),this.constants_.setTheme(e),this.constants_.init()}createDom(e,t,r){this.constants_.createDom(e,this.name+"-"+t.name,"."+this.getClassName()+"."+t.getClassName(),r)}refreshDom(e,t,r){var n=this.getConstants();n.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=n.randomIdentifier,this.constants_.setTheme(t),this.constants_.init(),this.createDom(e,t,r)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new yp}makeRenderInfo_(e){return new vp(this,e)}makeDrawer_(e,t){return new bp(e,t)}makePathObject(e,t){return new Tp(e,t,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(e){return!0}orphanCanConnectAtEnd(e,t,r){return!!N.getConnectionForOrphanedConnection(e,r===v.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}render(e){var t=this.makeRenderInfo_(e);t.measure(),this.makeDrawer_(e,t).draw()}},w={},kp=(w.BottomRow=ep,w.Connection=tp,w.ConstantProvider=yp,w.Drawer=bp,w.ExternalValueInput=rp,w.Field=np,w.Hat=ip,w.Icon=sp,w.InRowSpacer=ap,w.InlineInput=op,w.InputConnection=Wo,w.InputRow=lp,w.JaggedEdge=cp,w.Measurable=L,w.NextConnection=up,w.OutputConnection=dp,w.PathObject=Tp,w.PreviousConnection=pp,w.RenderInfo=vp,w.Renderer=Jc,w.RoundCorner=hp,w.Row=C,w.SpacerRow=mp,w.SquareCorner=gp,w.StatementInput=fp,w.TopRow=_p,w.Types=R,w.init=ns,w.register=rs,w.unregister=Dh,class{constructor(e,t){this.workspace=e,this.theme=t,this.subscribedWorkspaces=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(e){var t,r,n,i=this.theme;this.theme=e,(e=this.workspace.getInjectionDiv())&&((i=i&&i.getClassName())&&a(e,i),i=this.theme.getClassName())&&c(e,i);for(let e=0,t;t=this.subscribedWorkspaces[e];e++)t.refreshTheme();for([t,r]of this.componentDB)for(var s of r){e=s.element;i=s.propertyName,s=this.theme&&this.theme.getComponentStyle(t);e.style.setProperty(i,s||"")}for(n of this.subscribedWorkspaces)n.hideChaff()}subscribeWorkspace(e){this.subscribedWorkspaces.push(e)}unsubscribeWorkspace(e){if(!fe(this.subscribedWorkspaces,e))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(e,t,r){this.componentDB.has(t)||this.componentDB.set(t,[]),this.componentDB.get(t).push({element:e,propertyName:r}),t=this.theme&&this.theme.getComponentStyle(t),e.style.setProperty(r,t||"")}unsubscribe(t){if(t)for(var[e,r]of this.componentDB){for(let e=r.length-1;0<=e;e--)r[e].element===t&&r.splice(e,1);r.length||this.componentDB.delete(e)}}dispose(){this.subscribedWorkspaces.length=0,this.componentDB.clear()}}),xp="VARIABLE_DYNAMIC",Ep={CATEGORY_NAME:xp},Mo=(Ep.flyoutCategory=ls,Ep.flyoutCategoryBlocks=us,Ep.internalFlyoutCategory=os,Ep.onCreateVariableButtonClick_Colour=as,Ep.onCreateVariableButtonClick_Number=ss,Ep.onCreateVariableButtonClick_String=is,class{canConnect(e,t,r,n){return this.canConnectWithReason(e,t,r,n)===N.CAN_CONNECT}canConnectWithReason(e,t,r,n){var i=this.doSafetyChecks(e,t);return i!==N.CAN_CONNECT?i:this.doTypeChecks(e,t)?r&&!this.doDragChecks(e,t,n||0)?N.REASON_DRAG_CHECKS_FAILED:N.CAN_CONNECT:N.REASON_CHECKS_FAILED}getErrorMessage(e,t,r){switch(e){case N.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case N.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case N.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case N.REASON_TARGET_NULL:return"Target connection is null.";case N.REASON_CHECKS_FAILED:return"Connection checks failed. "+t+" expected "+t.getCheck()+", found "+r.getCheck();case N.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case N.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case N.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(e,t){if(!e||!t)return N.REASON_TARGET_NULL;let r,n,i;return e.isSuperior()?(r=e.getSourceBlock(),n=t.getSourceBlock(),i=t):(n=e.getSourceBlock(),r=t.getSourceBlock(),i=e,e=t),r===n?N.REASON_SELF_CONNECTION:i.type!==Yu[e.type]?N.REASON_WRONG_TYPE:r.workspace!==n.workspace?N.REASON_DIFFERENT_WORKSPACES:r.isShadow()&&!n.isShadow()?N.REASON_SHADOW_PARENT:i.type===v.OUTPUT_VALUE&&n.previousConnection&&n.previousConnection.isConnected()||i.type===v.PREVIOUS_STATEMENT&&n.outputConnection&&n.outputConnection.isConnected()?N.REASON_PREVIOUS_AND_OUTPUT:N.CAN_CONNECT}doTypeChecks(t,r){if(t=t.getCheck(),r=r.getCheck(),!t||!r)return!0;for(let e=0;e<t.length;e++)if(r.includes(t[e]))return!0;return!1}doDragChecks(e,t,r){if(e.distanceFrom(t)>r||t.getSourceBlock().isInsertionMarker())return!1;switch(t.type){case v.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,t);case v.OUTPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isInsertionMarker()||e.isConnected())return!1;break;case v.INPUT_VALUE:if(!t.isConnected()||t.targetBlock().isMovable()||t.targetBlock().isShadow())break;return!1;case v.NEXT_STATEMENT:if(t.isConnected()&&!e.getSourceBlock().nextConnection&&!t.targetBlock().isShadow()&&t.targetBlock().nextConnection||t.targetBlock()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;default:return!1}return!Ho.includes(t)}canConnectToPrevious_(e,t){return!(e.targetConnection||Ho.includes(t)||t.targetConnection&&(!(e=t.targetBlock()).isInsertionMarker()||e.getPreviousBlock()))}}),Sp=(i(_.CONNECTION_CHECKER,$a,Mo),class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(e){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new Zd,this.readOnly=!1,this.potentialVariableMap=null,this.id=wa(),ie(this),this.options=e||new Fu({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(ma(_.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new(this.getVariableMapClass())(this),this.setIsReadOnly(this.options.readOnly)}dispose(){this.listeners.length=0,this.clear(),se(this)}sortObjects(e,t){var r=t=>({getBoundingRectangle:()=>{var e=t.getRelativeToSurfaceXY();return new E(e.y,e.y,e.x,e.x)},moveBy:()=>{}});return this.sortByOrigin(r(e),r(t))}sortByOrigin(e,t){var r=Math.sin(ar(Sp.SCAN_ANGLE))*(this.RTL?-1:1);return e=e.getBoundingRectangle().getOrigin(),t=t.getBoundingRectangle().getOrigin(),e.y+r*e.x-(t.y+r*t.x)}addTopBlock(e){this.topBlocks.push(e)}removeTopBlock(e){if(!fe(this.topBlocks,e))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(e=!1){var t=[].concat(this.topBlocks);return e&&1<t.length&&t.sort(this.sortObjects.bind(this)),t}addTypedBlock(e){this.typedBlocksDB.has(e.type)||this.typedBlocksDB.set(e.type,[]),this.typedBlocksDB.get(e.type).push(e)}removeTypedBlock(e){fe(this.typedBlocksDB.get(e.type),e),this.typedBlocksDB.get(e.type).length||this.typedBlocksDB.delete(e.type)}getBlocksByType(e,t=!1){return this.typedBlocksDB.has(e)?(e=this.typedBlocksDB.get(e).slice(0),t&&e&&1<e.length&&e.sort(this.sortObjects.bind(this)),e.filter(e=>!e.isInsertionMarker())):[]}addTopComment(e){this.topComments.push(e),this.commentDB.has(e.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB.set(e.id,e)}removeTopComment(e){if(!fe(this.topComments,e))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(e.id)}getTopComments(e=!1){var t=[].concat(this.topComments);return e&&1<t.length&&t.sort(this.sortObjects.bind(this)),t}getAllBlocks(t=!1){if(t){var r=this.getTopBlocks(!0);t=[];for(let e=0;e<r.length;e++)t.push(...r[e].getDescendants(!0))}else for(t=this.getTopBlocks(!1),r=0;r<t.length;r++)t.push(...t[r].getChildren(!1));return t.filter(e=>!e.isInsertionMarker())}clear(){this.isClearing=!0;try{var e=f.getGroup$$module$build$src$core$events$utils();for(e||f.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();f.setGroup$$module$build$src$core$events$utils(e),this.isFlyout||this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(e,t){gt("Blockly.Workspace.renameVariableById","v12","v13","Blockly.Workspace.getVariableMap().renameVariable"),(e=this.variableMap.getVariableById(e))&&this.variableMap.renameVariable(e,t)}createVariable(e,t,r){return gt("Blockly.Workspace.createVariable","v12","v13","Blockly.Workspace.getVariableMap().createVariable"),this.variableMap.createVariable(e,null!=t?t:void 0,null!=r?r:void 0)}getVariableUsesById(e){return gt("Blockly.Workspace.getVariableUsesById","v12","v13","Blockly.Workspace.getVariableMap().getVariableUsesById"),Pt(this,e)}deleteVariableById(e){gt("Blockly.Workspace.deleteVariableById","v12","v13","Blockly.Workspace.getVariableMap().deleteVariable");var t=this.variableMap.getVariableById(e);t?f.deleteVariable$$module$build$src$core$variables(this,t):console.warn("Can't delete non-existent variable: "+e)}getVariable(e,t){return gt("Blockly.Workspace.getVariable","v12","v13","Blockly.Workspace.getVariableMap().getVariable"),this.variableMap.getVariable(e,t)}getVariableById(e){return gt("Blockly.Workspace.getVariableById","v12","v13","Blockly.Workspace.getVariableMap().getVariableById"),this.variableMap.getVariableById(e)}getVariablesOfType(e){return gt("Blockly.Workspace.getVariablesOfType","v12","v13","Blockly.Workspace.getVariableMap().getVariablesOfType"),this.variableMap.getVariablesOfType(null!=e?e:"")}getAllVariables(){return gt("Blockly.Workspace.getAllVariables","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables()}getAllVariableNames(){return gt("Blockly.Workspace.getAllVariableNames","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables().map(e=>e.getName())}getWidth(){return 0}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(e){return this.options.maxInstances?(void 0!==this.options.maxInstances[e]?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,!1).length:1/0}isCapacityAvailable(e){if(!this.hasBlockLimits())return!0;let t=0;for(var r in e){if(e[r]>this.remainingCapacityOfType(r))return!1;t+=e[r]}return!(t>this.remainingCapacity())}hasBlockLimits(){return this.options.maxBlocks!==1/0||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(e){var t=e?this.redoStack_:this.undoStack_,r=e?this.undoStack_:this.redoStack_,n=t.pop();if(n){for(var i=[n];t.length&&n.group&&n.group===t[t.length-1].group;){var s=t.pop();s&&i.push(s)}for(t=0;t<i.length;t++)r.push(i[t]);f.setRecordUndo$$module$build$src$core$events$utils(!1);try{for(r=0;r<i.length;r++)i[r].run(e)}finally{f.setRecordUndo$$module$build$src$core$events$utils(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,$()}addChangeListener(e){return this.listeners.push(e),e}removeChangeListener(e){fe(this.listeners,e)}fireChangeListener(t){if(t.recordUndo)for(this.undoStack_.push(t),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(let e=0;e<this.listeners.length;e++)(0,this.listeners[e])(t)}getBlockById(e){return this.blockDB.get(e)||null}setBlockById(e,t){this.blockDB.set(e,t)}removeBlockById(e){this.blockDB.delete(e)}getCommentById(e){return null!=(e=this.commentDB.get(e))?e:null}allInputsFilled(t){var r=this.getTopBlocks(!1);for(let e=0;e<r.length;e++)if(!r[e].allInputsFilled(t))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new(this.getVariableMapClass())(this,!0)}getVariableMap(){return this.variableMap}setVariableMap(e){this.variableMap=e}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let e=null;var t=this.options.parentWorkspace;return this.isFlyout?t&&t.options&&(e=t.options.parentWorkspace):t&&(e=t),e}static getById(e){return re(e)}static getAll(){return ne()}getVariableMapClass(){var e=ma(_.VARIABLE_MAP,this.options,!0);if(e)return e;throw Error("No variable map is registered.")}isReadOnly(){return this.readOnly}setIsReadOnly(e){this.readOnly=e,this.options.readOnly=e}}),Cp=(Sp.SCAN_ANGLE=3,class{constructor(e){this.parentWorkspace=e,this.sounds=new Map,this.lastSound=null,this.muted=!1}dispose(){this.sounds.clear()}load(t,e){if(t.length){try{var r=new globalThis.Audio}catch(e){return}for(let e=0;e<t.length;e++){var n=t[e],i=n.match(/\.(\w+)$/);if(i&&r.canPlayType("audio/"+i[1])){var s=new globalThis.Audio(n);break}}s&&this.sounds.set(e,s)}}preload(){for(var e of this.sounds.values()){e.volume=.01;var t=e.play();if(void 0!==t?t.then(e.pause).catch(function(){}):e.pause(),po||ho)break}}play(e,t){var r;this.muted||((r=this.sounds.get(e))?(e=new Date,null!==this.lastSound&&e.getTime()-this.lastSound.getTime()<100||(this.lastSound=e,(r=po||uo?r:r.cloneNode()).volume=void 0===t?1:t,r.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(e,t))}setMuted(e){this.muted=e}getMuted(){return this.muted}}),wp=class extends Sp{constructor(e){super(e),this.resizeHandlerWrapper=null,this.resizesEnabled=this.visible=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardMoveInProgress=this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=this.layerManager=null,this.navigator=new Dd,this.metricsManager=new(ma(_.METRICS_MANAGER,e,!0))(this),this.getMetrics=e.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=e.setMetrics||wp.setTopLevelWorkspaceMetrics,this.componentManager=new Jo,this.connectionDBList=Au.init(this.connectionChecker),this.audioManager=new Cp(e.parentWorkspace),this.grid=this.options.gridPattern?new Ud(this.options.gridPattern,e.gridOptions):null,this.markerManager=new jd(this),ec&&this.registerToolboxCategoryCallback(Xl,ft),Ep&&this.registerToolboxCategoryCallback(xp,os),qd&&(this.registerToolboxCategoryCallback(Qd,zi),this.addChangeListener(Ji)),this.addChangeListener(this.variableChangeCallback.bind(this)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new kp(this,this.options.theme||Mu),this.themeManager_.subscribeWorkspace(this),this.renderer=ns(this.options.renderer||"geras",this.getTheme(),null!=(e=this.options.rendererOverrides)?e:void 0),this.cachedParentSvgSize=new S(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(e){this.metricsManager=e,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}getMarker(e){return this.markerManager.getMarker(e)}getCursor(){return this.markerManager.getCursor()}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(e){this.themeManager_.setTheme(e=e||Mu)}refreshTheme(){var e;this.svgGroup_&&(e=null===this.options.parentWorkspace,this.renderer.refreshDom(this.svgGroup_,this.getTheme(),e?this.getInjectionDiv():void 0)),this.updateBlockStyles(this.getAllBlocks(!1).filter(e=>!!e.getStyleName())),this.refreshToolboxSelection(),this.toolbox&&this.toolbox.refreshTheme(),this.isVisible()&&this.setVisible(!0),e=new(g(y.THEME_CHANGE))(this.getTheme().name,this.id),m(e)}updateBlockStyles(r){for(let e=0,t;t=r[e];e++){var n=t.getStyleName();n&&t.setStyle(n)}}getInverseScreenCTM(){var e;return this.inverseScreenCTMDirty&&(e=this.getParentSvg().getScreenCTM())&&(this.inverseScreenCTM=e.inverse(),this.inverseScreenCTMDirty=!1),this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.visible}getSvgXY(e){let t=0,r=0,n=1;(this.getCanvas().contains(e)||this.getBubbleCanvas().contains(e))&&(n=this.scale);do{var i=we(e);e!==this.getCanvas()&&e!==this.getBubbleCanvas()||(n=1),t+=i.x*n,r+=i.y*n,e=e.parentNode}while(e&&e!==this.getParentSvg()&&e!==this.getInjectionDiv());return new k(t,r)}getCachedParentSvgSize(){var e=this.cachedParentSvgSize;return new S(e.width,e.height)}getOriginOffsetInPixels(){return Ie(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let e=this.svgGroup_;for(;e;){if((" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv ")){this.injectionDiv=e;break}e=e.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(e){this.resizeHandlerWrapper=e}createDom(e,t){return this.injectionDiv||(this.injectionDiv=null!=t?t:null),this.svgGroup_=l(x.G,{class:"blocklyWorkspace",id:this.id}),t&&Ze(this.svgGroup_,ro.LABEL,f.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),e&&(this.svgBackground_=l(x.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),"blocklyMainBackground"===e&&this.grid?this.svgBackground_.style.fill="var(--blocklyGridPattern)":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.layerManager=new Vd(this),this.svgBlockCanvas_=this.layerManager.getBlockLayer(),this.svgBubbleCanvas_=this.layerManager.getBubbleLayer(),this.isFlyout||(h(this.svgGroup_,"pointerdown",this,this.onMouseDown,!1),this.dummyWheelListener=()=>{},document.body.addEventListener("wheel",this.dummyWheelListener),h(this.svgGroup_,"wheel",this,this.onMouseWheel)),this.options.hasCategories&&(this.toolbox=new(ma(_.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(e=ma(_.CURSOR,this.options))&&this.markerManager.setCursor(new e(this)),e=null===this.options.parentWorkspace,this.renderer.createDom(this.svgGroup_,this.getTheme(),e?this.getInjectionDiv():void 0),f.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!!this.injectionDiv||this.isFlyout),this.svgGroup_}dispose(){var e;this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&o(this.svgGroup_),this.toolbox&&(this.toolbox.dispose(),this.toolbox=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),this.options.parentWorkspace||(e=this.getParentSvg())&&e.parentNode&&o(e.parentNode),this.resizeHandlerWrapper&&(s(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null),this.dummyWheelListener&&(document.body.removeEventListener("wheel",this.dummyWheelListener),this.dummyWheelListener=null),f.getFocusManager$$module$build$src$core$focus_manager().isRegistered(this)&&f.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}addTrashcan(){this.trashcan=wp.newTrashcan(this);var e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.getCanvas())}static newTrashcan(e){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new _l(this);var e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)}copyOptionsForFlyout(){return new Fu({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,plugins:this.options.plugins,modalInputs:this.options.modalInputs,move:{scrollbars:!0}})}addFlyout(e){var t=this.copyOptionsForFlyout();return t.toolboxPosition=this.options.toolboxPosition,this.flyout=new(this.horizontalLayout?ma(_.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0):ma(_.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(t),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(e)}getFlyout(e){return this.flyout||e?this.flyout:this.toolbox?this.toolbox.getFlyout():null}getToolbox(){return this.toolbox}updateScreenCalculations(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox?this.toolbox.position():this.flyout&&this.flyout.position();var r=this.componentManager.getComponents(Jo.Capability.POSITIONABLE,!0),n=this.getMetricsManager().getUiMetrics(),i=[];for(let e=0,t;t=r[e];e++){t.position(n,i);var s=t.getBoundingRectangle();s&&i.push(s)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations()}updateScreenCalculationsIfScrolled(){var e=De();k.equals(this.lastRecordedPageScroll,e)||(this.lastRecordedPageScroll=e,this.updateScreenCalculations())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(e,t){var r=this.getParentSvg();null!=e&&(this.cachedParentSvgSize.width=e,r.setAttribute("data-cached-width",""+e)),null!=t&&(this.cachedParentSvgSize.height=t,r.setAttribute("data-cached-height",""+t))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let e=this.svgGroup_;for(;e;){if("svg"===e.tagName){this.cachedParentSvg=e;break}e=e.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){var e,t,r,n;U()&&(e=this.scale,t=-this.scrollY,r=-this.scrollX,e===this.oldScale&&Math.abs(t-this.oldTop)<1&&Math.abs(r-this.oldLeft)<1||(n=new(g(y.VIEWPORT_CHANGE))(t,r,e,this.id,this.oldScale),this.oldScale=e,this.oldTop=t,this.oldLeft=r,m(n)))}translate(e,t){var r;null!=(r=this.layerManager)&&r.translateLayers(new k(e,t),this.scale),null!=(r=this.grid)&&r.moveTo(e,t),this.maybeFireViewportChangeEvent()}getWidth(){var e=this.getMetrics();return e?e.viewWidth/this.scale:0}setVisible(e){this.visible=e,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox&&this.toolbox.setVisible(e),e||this.hideChaff(!0))}render(){var t=this.getAllBlocks(!1);for(let e=t.length-1;0<=e;e--)t[e].queueRender();this.getTopBlocks().flatMap(e=>e.getDescendants(!1)).filter(e=>e.isInsertionMarker()).forEach(e=>e.queueRender())}highlightBlock(e,t){if(void 0===t){for(let e=0,t;t=this.highlightedBlocks[e];e++)t.setHighlighted(!1);this.highlightedBlocks.length=0}(e=e?this.getBlockById(e):null)&&((t=void 0===t||t)?this.highlightedBlocks.includes(e)||this.highlightedBlocks.push(e):fe(this.highlightedBlocks,e),e.setHighlighted(t))}variableChangeCallback(e){switch(e.type){case y.VAR_CREATE:case y.VAR_DELETE:case y.VAR_RENAME:case y.VAR_TYPE_CHANGE:this.refreshToolboxSelection()}}refreshToolboxSelection(){var e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox&&e.toolbox.getFlyout()&&e.toolbox.refreshSelection()}recordDragTargets(){var r=this.componentManager.getComponents(Jo.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let e=0,t;t=r[e];e++){var n=t.getClientRect();n&&this.dragTargetAreas.push({component:t,clientRect:n})}}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}getDragTarget(r){for(let e=0,t;t=this.dragTargetAreas[e];e++)if(t.clientRect.contains(r.clientX,r.clientY))return t.component;return null}onMouseDown(e){var t=this.getGesture(e);t&&t.handleWsStart(e,this)}startDrag(e,t){wn(this,e,t)}moveDrag(e){return In(this,e)}setKeyboardMoveInProgress(e){this.keyboardMoveInProgress=e}isDragging(){return this.keyboardMoveInProgress||null!==this.currentGesture_&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){var e=!!this.scrollbar;return this.isMovable()&&(!e||this.scrollbar.canScrollHorizontally())}isMovableVertically(){var e=!!this.scrollbar;return this.isMovable()&&(!e||this.scrollbar.canScrollVertically())}onMouseWheel(e){var t,r,n,i;$d.inProgress()?(e.preventDefault(),e.stopPropagation()):(t=this.options.zoomOptions&&this.options.zoomOptions.wheel,r=this.options.moveOptions&&this.options.moveOptions.wheel,(t||r)&&(n=Sa(e),mo&&(i=e.metaKey),t&&(e.ctrlKey||i||!r)?(n=-n.y/50,t=Ea(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(t.x,t.y,n)):(t=this.scrollX-n.x,r=this.scrollY-n.y,e.shiftKey&&!n.x&&(t=this.scrollX-n.y,r=this.scrollY),this.scroll(t,r)),e.preventDefault()))}getBlocksBoundingBox(){var t=this.getTopBoundedElements();if(!t.length)return new E(0,0,0,0);var r=t[0].getBoundingRectangle();for(let e=1;e<t.length;e++){var n=t[e];n.isInsertionMarker&&n.isInsertionMarker()||((n=n.getBoundingRectangle()).top<r.top&&(r.top=n.top),n.bottom>r.bottom&&(r.bottom=n.bottom),n.left<r.left&&(r.left=n.left),n.right>r.right&&(r.right=n.right))}return r}cleanUp(){this.setResizesEnabled(!1),f.setGroup$$module$build$src$core$events$utils(!0);var e=(n=this.getTopBlocks(!0)).filter(e=>e.isMovable());let r=n.filter(e=>!e.isMovable()).map(e=>e.getBoundingRectangle());var t,n=function(e){for(var t of r)if(e.intersects(t))return t;return null},i=0,s=this.renderer.getConstants().MIN_BLOCK_HEIGHT;for(t of e){for(e=t.getBoundingRectangle(),t.moveBy(-e.left,i-e.top,["cleanup"]),t.snapToGrid(),i=n(e=t.getBoundingRectangle());null!=i;)i=i.top+i.getHeight()+s,t.moveBy(0,i-e.top,["cleanup"]),t.snapToGrid(),i=n(e=t.getBoundingRectangle());i=t.getRelativeToSurfaceXY().y+t.getHeightWidth().height+s}f.setGroup$$module$build$src$core$events$utils(!1),this.setResizesEnabled(!0)}showContextMenu(e){var t,r;this.isReadOnly()||this.isFlyout||(t=A.registry.getContextMenuOptions({workspace:this,focusedNode:this},e),this.configureContextMenu&&this.configureContextMenu(t,e),r=e instanceof PointerEvent?new k(e.clientX,e.clientY):Oe(this,new k(5,5)),bn(e,t,this.RTL,this,r))}updateToolbox(e){if(e=Pe(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(Be(e)){if(!this.toolbox)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox.render(e)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(oe(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(e,t,r){r=Math.pow(this.options.zoomOptions.scaleSpeed,r);var n,i,s=this.scale*r;this.scale!==s&&(s>this.options.zoomOptions.maxScale?r=this.options.zoomOptions.maxScale/this.scale:s<this.options.zoomOptions.minScale&&(r=this.options.zoomOptions.minScale/this.scale),n=this.getCanvas().getCTM(),(i=this.getParentSvg().createSVGPoint()).x=e,i.y=t,e=(i=i.matrixTransform(n.inverse())).x,n=n.translate(e*(1-r),(t=i.y)*(1-r)).scale(r),this.scrollX=n.e,this.scrollY=n.f,this.setScale(s))}zoomCenter(e){var t=this.getMetrics();let r;t=this.flyout?(r=t.svgWidth?t.svgWidth/2:0,t.svgHeight?t.svgHeight/2:0):(r=t.viewWidth/2+t.absoluteLeft,t.viewHeight/2+t.absoluteTop),this.zoom(r,t,e)}zoomToFit(){if(this.isMovable()){var e=(t=this.getMetrics()).viewWidth,t=t.viewHeight,r=(n=this.getBlocksBoundingBox()).right-n.left+40,n=n.bottom-n.top+40;if(r){this.flyout&&(this.horizontalLayout?(t+=this.flyout.getHeight(),n+=this.flyout.getHeight()/this.scale):(e+=this.flyout.getWidth(),r+=this.flyout.getWidth()/this.scale)),e/=r,t/=n,f.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(e,t)),this.scrollCenter()}finally{f.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){c(this.getCanvas(),"blocklyCanvasTransitioning"),c(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}endCanvasTransition(){a(this.getCanvas(),"blocklyCanvasTransitioning"),a(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}scrollCenter(){var e,t;this.isMovable()?(t=((e=this.getMetrics()).scrollWidth-e.viewWidth)/2,this.scroll(t=-t-e.scrollLeft,-((e.scrollHeight-e.viewHeight)/2)-e.scrollTop)):console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(e,t){var r,n;this.isMovable()?(r=e?this.getBlockById(e):null)&&(e=r.getRelativeToSurfaceXY(),r=t?{height:r.height,width:r.width}:r.getHeightWidth(),n=this.scale,t=(e.x+(this.RTL?-1:1)*r.width/2)*n,e=(e.y+r.height/2)*n,r=this.getMetrics(),this.scroll(-(t-r.viewWidth/2),-(e-r.viewHeight/2))):console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,this.hideChaff(!1),(e=this.getFlyout(!1))&&e.isVisible()&&(e.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))}getScale(){return this.scale}getAbsoluteScale(){let r=e=>{if(e.isFlyout){var t=null==(t=e.targetWorkspace)?void 0:t.getFlyout();if(t instanceof Pd)return t.getFlyoutScale()}return e.getScale()},n=(e,t)=>e.options.parentWorkspace&&e.options.parentWorkspace.getSvgGroup().contains(e.getSvgGroup())?n(e.options.parentWorkspace,t*r(e)):t*r(e);return n(this,1)}scroll(e,t){this.hideChaff(!0);var r=this.getMetrics(),n=(e=Math.min(e,-r.scrollLeft),t=Math.min(t,-r.scrollTop),r.scrollTop+Math.max(0,r.scrollHeight-r.viewHeight));e=Math.max(e,-(r.scrollLeft+Math.max(0,r.scrollWidth-r.viewWidth))),t=Math.max(t,-n),this.scrollX=e,this.scrollY=t,this.scrollbar&&this.scrollbar.set(-(e+r.scrollLeft),-(t+r.scrollTop),!1),e+=r.absoluteLeft,t+=r.absoluteTop,this.translate(e,t)}getBlockById(e){return super.getBlockById(e)}getAllBlocks(e=!1){return super.getAllBlocks(e)}getTopBlocks(e=!1){return super.getTopBlocks(e)}addTopBlock(e){this.addTopBoundedElement(e),super.addTopBlock(e)}removeTopBlock(e){this.removeTopBoundedElement(e),super.removeTopBlock(e)}addTopComment(e){this.addTopBoundedElement(e),super.addTopComment(e)}removeTopComment(e){this.removeTopBoundedElement(e),super.removeTopComment(e)}getTopComments(e=!1){return super.getTopComments(e)}getCommentById(e){return super.getCommentById(e)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(e){this.topBoundedElements.push(e)}removeTopBoundedElement(e){fe(this.topBoundedElements,e)}getTopBoundedElements(e=!1){var t=[].concat(this.topBoundedElements);return e&&t.sort(this.sortByOrigin.bind(this)),t}setResizesEnabled(e){var t=!this.resizesEnabled&&e;this.resizesEnabled=e,t&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(e,t){if("function"!=typeof t)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(e,t)}getButtonCallback(e){return null!=(e=this.flyoutButtonCallbacks.get(e))?e:null}removeButtonCallback(e){this.flyoutButtonCallbacks.delete(e)}registerToolboxCategoryCallback(e,t){if("function"!=typeof t)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(e,t)}getToolboxCategoryCallback(e){return this.toolboxCategoryCallbacks.get(e)||null}removeToolboxCategoryCallback(e){this.toolboxCategoryCallbacks.delete(e)}getGesture(e){var t,r;return this.keyboardMoveInProgress?(e.preventDefault(),e.stopPropagation(),null):((t="pointerdown"===e.type)&&null!=(r=this.currentGesture_)&&r.hasStarted()&&(console.warn("Tried to start the same gesture twice."),this.currentGesture_.cancel()),!this.currentGesture_&&t&&(this.currentGesture_=new $d(e,this)),this.currentGesture_)}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(e=!1){Hr(),dn(this),xr(),this.hideComponents(e)}hideComponents(t=!1){this.getComponentManager().getComponents(Jo.Capability.AUTOHIDEABLE,!0).forEach(e=>e.autoHide(t))}static setTopLevelWorkspaceMetrics(e){var t=this.getMetrics();"number"==typeof e.x&&(this.scrollX=-(t.scrollLeft+(t.scrollWidth-t.viewWidth)*e.x)),"number"==typeof e.y&&(this.scrollY=-(t.scrollTop+(t.scrollHeight-t.viewHeight)*e.y)),this.translate(this.scrollX+t.absoluteLeft,this.scrollY+t.absoluteTop)}addClass(e){this.injectionDiv&&c(this.injectionDiv,e)}removeClass(e){this.injectionDiv&&a(this.injectionDiv,e)}setIsReadOnly(e){super.setIsReadOnly(e),e?this.addClass("blocklyReadOnly"):this.removeClass("blocklyReadOnly")}scrollBoundsIntoView(e,t=10){var r,n,i;$d.inProgress()||(r=this.getScale(),i=this.getMetricsManager().getViewMetrics(!0),i=new E(i.top,i.top+i.height,i.left,i.left+i.width),e.left>=i.left&&e.top>=i.top&&e.right<=i.right&&e.bottom<=i.bottom)||((e=e.clone()).top-=t,e.bottom+=t,e.left-=t,e.right+=t,n=t=0,e.left<i.left?t=this.RTL?Math.min(i.left-e.left,i.right-e.right):i.left-e.left:e.right>i.right&&(t=this.RTL?i.right-e.right:Math.max(i.right-e.right,i.left-e.left)),e.top<i.top?n=i.top-e.top:e.bottom>i.bottom&&(n=Math.max(i.bottom-e.bottom,i.top-e.top)),this.scroll(this.scrollX+t*r,this.scrollY+n*r))}getFocusableElement(){return this.svgGroup_}getFocusableTree(){return this.isMutator&&this.options.parentWorkspace||this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(e){return!e&&null!=(e=this.getTopBlocks(!0)[0])?e:null}getNestedTrees(){var e=this.getAllBlocks().map(e=>e.getIcons()).flat().filter(e=>e instanceof f.MutatorIcon$$module$build$src$core$icons$mutator_icon&&e.bubbleIsVisible()).map(e=>null==(e=e.getBubble())?void 0:e.getWorkspace()).filter(e=>!!e),t=this.getFlyout(!0);return t&&e.push(t.getWorkspace()),e}searchForWorkspaceComment(e){for(var t of this.getTopComments())if(t instanceof xu&&t.canBeFocused()&&t.getFocusableElement().id===e)return t}lookUpFocusableNode(t){var e,r,n=null==(e=this.targetWorkspace)?void 0:e.getFlyout();if(this.isFlyout&&n)for(var i of n.getContents())if(e=i.getElement(),Q(e)&&e.canBeFocused()&&e.getFocusableElement().id===t)return e;if(i=t.indexOf("_field_"),e=t.indexOf("_connection_"),-1!==i){var s=t.substring(0,i);if(s=this.getBlockById(s))for(var a of s.getFields())if(a.canBeFocused()&&a.getFocusableElement().id===t)return a}else if(-1!==e){if(s=t.substring(0,e),s=this.getBlockById(s))for(var o of s.getConnections_(!0))if(o.id===t)return o}else{if(-1!==(a=Math.max(t.indexOf(_u),t.indexOf(gu),t.indexOf(bu)))&&(a=t.substring(0,a),a=this.searchForWorkspaceComment(a)))return-1<t.indexOf(_u)?a.getEditorFocusableNode():null!=(r=a.view.getCommentBarButtons().find(e=>e.getFocusableElement().id.includes(t)))?r:null;if(r=(r=this.getAllBlocks(!1).find(e=>e.getFocusableElement().id===t))||this.searchForWorkspaceComment(t))return r;for(s of r=this.getAllBlocks().map(e=>e.getIcons()).flat()){if(s.canBeFocused()&&s.getFocusableElement().id===t)return s;if(sr(s)&&(r=s.getBubble())&&r.canBeFocused()&&r.getFocusableElement().id===t)return r}}return null}onTreeFocus(e,t){}onTreeBlur(e){var t,r;this.isFlyout&&this.targetWorkspace&&!f.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&(t=this.targetWorkspace.getFlyout(),(r=this.targetWorkspace.getToolbox())&&e===r||(r&&r.clearSelection(),t&&Bi(t)&&t.autoHide(!1)))}getNavigator(){return this.navigator}setNavigator(e){this.navigator=e}},Ip=class extends jo{constructor(e){super(),this.isBlank=void 0===e,e&&(this.varId=e.getId(),this.workspaceId=e.getWorkspace().id)}toJson(){var e=super.toJson();if(this.varId)return e.varId=this.varId,e;throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new Ip)).varId=e.varId,t}},Ap=class extends Ip{constructor(e){super(e),this.type=y.VAR_CREATE,e&&(this.varType=e.getType(),this.varName=e.getName())}toJson(){var e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(this.varName)return e.varType=this.varType,e.varName=this.varName,e;throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new Ap)).varType=e.varType,t.varName=e.varName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t=t.getVariableMap(),e?t.createVariable(this.varName,this.varType,this.varId):(e=t.getVariableById(this.varId))&&t.deleteVariable(e)}},Wa=(i(_.EVENT,y.VAR_CREATE,Ap),class{constructor(e,t,r,n){this.workspace=e,this.name=t,this.type=r||"",this.id=n||wa()}getId(){return this.id}getName(){return this.name}setName(e){return this.name=e,this}getType(){return this.type}setType(e){return this.type=e,this}getWorkspace(){return this.workspace}save(){var e={name:this.getName(),id:this.getId()},t=this.getType();return t&&(e.type=t),e}static load(e,t){e=new this(t,e.name,e.type,e.id),t.getVariableMap().addVariable(e),m(new(g(y.VAR_CREATE))(e))}}),Dp=(i(_.VARIABLE_MODEL,$a,Wa),class extends Ip{constructor(e){super(e),this.type=y.VAR_DELETE,e&&(this.varType=e.getType(),this.varName=e.getName())}toJson(){var e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(this.varName)return e.varType=this.varType,e.varName=this.varName,e;throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new Dp)).varType=e.varType,t.varName=e.varName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t=t.getVariableMap(),e?(e=t.getVariableById(this.varId))&&t.deleteVariable(e):t.createVariable(this.varName,this.varType,this.varId)}}),Np=(i(_.EVENT,y.VAR_DELETE,Dp),class extends Ip{constructor(e,t){super(e),this.type=y.VAR_RENAME,e&&(this.oldName=e.getName(),this.newName=void 0===t?"":t)}toJson(){var e=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(this.newName)return e.oldName=this.oldName,e.newName=this.newName,e;throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new Np)).oldName=e.oldName,t.newName=e.newName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");var r=(t=t.getVariableMap()).getVariableById(this.varId);e?r&&t.renameVariable(r,this.newName):r&&t.renameVariable(r,this.oldName)}}),hc=(i(_.EVENT,y.VAR_RENAME,Np),class{constructor(e,t=!1){this.workspace=e,this.potentialMap=t,this.variableMap=new Map}clear(){for(var e of this.variableMap.values())for(var t of e.values())this.deleteVariable(t);if(0!==this.variableMap.size)throw Error("Non-empty variable map")}renameVariable(t,r){if(t.getName()!==r){var n=t.getType(),n=this.getVariable(r,n),i=this.workspace.getAllBlocks(!1);let e="";this.potentialMap||(e=f.getGroup$$module$build$src$core$events$utils())||f.setGroup$$module$build$src$core$events$utils(!0);try{n&&n.getId()!==t.getId()?this.renameVariableWithConflict(t,r,n,i):this.renameVariableAndUses(t,r,i)}finally{this.potentialMap||f.setGroup$$module$build$src$core$events$utils(e)}}return t}changeVariableType(e,t){var r,n;return null!=(r=this.variableMap.get(e.getType()))&&r.delete(e.getId()),e.setType(t),(r=null!=(n=this.variableMap.get(t))?n:new Map).set(e.getId(),e),this.variableMap.has(t)||this.variableMap.set(t,r),e}renameVariableById(e,t){gt("VariableMap.renameVariableById","v12","v13","VariableMap.renameVariable");var r=this.getVariableById(e);if(!r)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(r,t)}renameVariableAndUses(e,t,r){for(this.potentialMap||m(new(g(y.VAR_RENAME))(e,t)),e.setName(t),t=0;t<r.length;t++)r[t].updateVarName(e)}renameVariableWithConflict(e,t,r,n){var i=e.getType();for(t!==r.getName()&&this.renameVariableAndUses(r,t,n),t=0;t<n.length;t++)n[t].renameVarById(e.getId(),r.getId());this.potentialMap||m(new(g(y.VAR_DELETE))(e)),null!=(i=this.variableMap.get(i))&&i.delete(e.getId())}createVariable(e,t,r){if(n=this.getVariable(e,t)){if(r&&n.getId()!==r)throw Error('Variable "'+e+'" is already in use and its id is "'+n.getId()+'" which conflicts with the passed in id, "'+r+'".')}else{if(r&&this.getVariableById(r))throw Error('Variable id, "'+r+'", is already in use.');if(n=r||wa(),t=t||"",!(r=pa(_.VARIABLE_MODEL,$a,!0)))throw Error("No variable model is registered.");var n=new r(this.workspace,e,t,n);(e=null!=(r=this.variableMap.get(t))?r:new Map).set(n.getId(),n),this.variableMap.has(t)||this.variableMap.set(t,e),this.potentialMap||m(new(g(y.VAR_CREATE))(n))}return n}addVariable(e){var t=e.getType();this.variableMap.has(t)||this.variableMap.set(t,new Map),null!=(t=this.variableMap.get(t))&&t.set(e.getId(),e)}deleteVariable(e){var t=Pt(this.workspace,e.getId());let r="";this.potentialMap||(r=f.getGroup$$module$build$src$core$events$utils())||f.setGroup$$module$build$src$core$events$utils(!0);try{for(let e=0;e<t.length;e++)t[e].dispose(!0);var n=this.variableMap.get(e.getType());n&&n.has(e.getId())&&(n.delete(e.getId()),this.potentialMap||m(new(g(y.VAR_DELETE))(e)),0===n.size)&&this.variableMap.delete(e.getType())}finally{this.potentialMap||f.setGroup$$module$build$src$core$events$utils(r)}}deleteVariableById(e){gt("VariableMap.deleteVariableById","v12","v13","Blockly.Variables.deleteVariable"),(e=this.getVariableById(e))&&f.deleteVariable$$module$build$src$core$variables(this.workspace,e)}getVariable(t,e){return(e=this.variableMap.get(e||""))&&null!=(e=[...e.values()].find(e=>f.Names$$module$build$src$core$names.equals(e.getName(),t)))?e:null}getVariableById(e){for(var t of this.variableMap.values())if(t.has(e))return null!=(t=t.get(e))?t:null;return null}getVariablesOfType(e){return(e=this.variableMap.get(e||""))?[...e.values()]:[]}getTypes(){return[...this.variableMap.keys()]}getAllVariables(){let e=[];for(var t of this.variableMap.values())e=e.concat(...t.values());return e}getAllVariableNames(){gt("VariableMap.getAllVariableNames","v12","v13","Blockly.Variables.getAllVariables");var e,t=[];for(e of this.variableMap.values())for(var r of e.values())t.push(r.getName());return t}getVariableUsesById(e){return gt("VariableMap.getVariableUsesById","v12","v13","Blockly.Variables.getVariableUsesById"),Pt(this.workspace,e)}}),Op=(i(_.VARIABLE_MAP,$a,hc),class extends Ko{constructor(e,t){super(t),this.type=y.TRASHCAN_OPEN,this.isOpen=e}toJson(){var e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new Op)).isOpen=e.isOpen,t}}),Rp=(i(_.EVENT,y.TRASHCAN_OPEN,Op),class extends md{constructor(e){super(),this.workspace=e,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,this.workspace.options.maxTrashcanContents<=0||(e=this.workspace.copyOptionsForFlyout(),this.workspace.horizontalLayout?(e.toolboxPosition=this.workspace.toolboxPosition===b.TOP?b.BOTTOM:b.TOP,this.flyout=new(ma(_.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(e)):(e.toolboxPosition=this.workspace.toolboxPosition===b.RIGHT?b.LEFT:b.RIGHT,this.flyout=new(ma(_.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(e)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){this.svgGroup=l(x.G,{class:"blocklyTrash"});var e=String(Math.random()).substring(2),t=l(x.CLIPPATH,{id:"blocklyTrashBodyClipPath"+e},this.svgGroup),r=(l(x.RECT,{width:Lp,height:Pp,y:Mp},t),l(x.IMAGE,{width:fl.width,x:-Up,height:fl.height,y:-Vp,"clip-path":"url(#blocklyTrashBodyClipPath"+e+")"},this.svgGroup));return r.setAttributeNS(Oo,"xlink:href",this.workspace.options.pathToMedia+fl.url),t=l(x.CLIPPATH,{id:"blocklyTrashLidClipPath"+e},this.svgGroup),l(x.RECT,{width:Lp,height:Mp},t),this.svgLid=l(x.IMAGE,{width:fl.width,x:-Up,height:fl.height,y:-Vp,"clip-path":"url(#blocklyTrashLidClipPath"+e+")"},this.svgGroup),this.svgLid.setAttributeNS(Oo,"xlink:href",this.workspace.options.pathToMedia+fl.url),Ta(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),Ta(this.svgGroup,"pointerup",this,this.click),Ta(r,"pointerover",this,this.mouseOver),Ta(r,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){var e;0<this.workspace.options.maxTrashcanContents&&(e=this.flyout.createDom(x.SVG),c(e,"blocklyTrashcanFlyout"),z(e,this.workspace.getParentSvg()),this.flyout.init(this.workspace)),this.workspace.getComponentManager().addComponent({component:this,weight:Jo.ComponentWeight.TRASHCAN_WEIGHT,capabilities:[Jo.Capability.AUTOHIDEABLE,Jo.Capability.DELETE_AREA,Jo.Capability.DRAG_TARGET,Jo.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&o(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){var t,r;this.contentsIsOpen()||(t=this.contents.map(function(e){return JSON.parse(e)}),(r=this.workspace.getParentSvg().style).cursor="wait",setTimeout(()=>{var e;null!=(e=this.flyout)&&e.show(t),r.cursor="",null!=(e=this.workspace.scrollbar)&&e.setVisible(!1)},10),this.fireUiEvent(!0))}closeFlyout(){var e;this.contentsIsOpen()&&(null!=(e=this.flyout)&&e.hide(),null!=(e=this.workspace.scrollbar)&&e.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(e,t){var r;this.initialized&&(r=Ke(this.workspace,e),e=je(r,new S(Lp,Pp+Mp),Bp,Fp,e,this.workspace),t=ze(e,Fp,r.vertical===Za.TOP?eo.DOWN:eo.UP,t),this.top=t.top,this.left=t.left,null!=(e=this.svgGroup)&&e.setAttribute("transform","translate("+this.left+","+this.top+")"),null!=(r=this.flyout))&&r.position()}getBoundingRectangle(){return new E(this.top,this.top+Pp+Mp,this.left,this.left+Lp)}getClientRect(){var e,t;return this.svgGroup?(e=(t=this.svgGroup.getBoundingClientRect()).top+Vp-$p,new E(e,e+Mp+Pp+2*$p,t=t.left+Up-$p,t+Lp+2*$p)):null}onDragOver(e){this.setLidOpen(this.wouldDelete_)}onDragExit(e){this.setLidOpen(!1)}onDrop(e){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(e){this.isLidOpen!==e&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=e,this.animateLid())}animateLid(){var e=jp,t=1/(e+1);this.lidOpen+=this.isLidOpen?t:-t,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*Wp),t=Kp+this.lidOpen*(zp-Kp),this.svgGroup&&(this.svgGroup.style.opacity=""+t),this.lidOpen>this.minOpenness&&this.lidOpen<1&&(this.lidTask=setTimeout(this.animateLid.bind(this),Gp/e))}setLidAngle(e){var t,r=this.workspace.toolboxPosition===b.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;null!=(t=this.svgLid)&&t.setAttribute("transform","rotate("+(r?-e:e)+","+(r?4:Lp-4)+","+(Mp-2)+")")}setMinOpenness(e){this.minOpenness=e,this.isLidOpen||this.setLidAngle(e*Wp)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(e){e=new(g(y.TRASHCAN_OPEN))(e,this.workspace.id),m(e)}blockMouseDownWhenOpenable(e){!this.contentsIsOpen()&&this.hasContents()&&e.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(e){if(!(this.workspace.options.maxTrashcanContents<=0||!Aa(e)||e.wasShadow)){if(!e.oldJson)throw Error("Encountered a delete event without proper oldJson");if(e=JSON.stringify(this.cleanBlockJson(e.oldJson)),!this.contents.includes(e)){for(this.contents.unshift(e);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(Hp)}}}cleanBlockJson(e){return function e(t){if(t){var r,n;for(n in delete t.id,delete t.x,delete t.y,delete t.enabled,delete t.disabledReasons,t.icons&&t.icons.comment&&(delete(r=t.icons.comment).height,delete r.width,delete r.pinned),r=t.inputs){var i=(s=r[n]).block,s=s.shadow;i&&e(i),s&&e(s)}t.next&&(t=(n=t.next).block,n=n.shadow,t&&e(t),n)&&e(n)}}(e=JSON.parse(JSON.stringify(e))),Object.assign({},{kind:"BLOCK"},e)}}),Lp=47,Pp=44,Mp=16,Fp=20,Bp=20,$p=10,Up=0,Vp=32,Hp=.1,Gp=80,jp=4,Kp=.4,zp=.8,Wp=45,qp=null,Jp=null,Yp=void 0,Uo={},Yc=(Uo.BlockPaster=ld,Uo.copy=ds,Uo.getLastCopiedData=Oh,Uo.getLastCopiedLocation=Rh,Uo.getLastCopiedWorkspace=Lh,Uo.paste=ps,Uo.registry=t,Uo.setLastCopiedData=Kh,Uo.setLastCopiedLocation=zh,Uo.setLastCopiedWorkspace=Wh,{}),el=(Yc.CollapseCommentBarButton=fu,Yc.CommentBarButton=mu,Yc.CommentEditor=yu,Yc.CommentView=Tu,Yc.DeleteCommentBarButton=vu,Yc.RenderedWorkspaceComment=xu,Yc.WorkspaceComment=ku,(lc=Jd=Jd||{}).ESCAPE="escape",lc.DELETE="delete",lc.COPY="copy",lc.CUT="cut",lc.PASTE="paste",lc.UNDO="undo",lc.REDO="redo",Xh(),{}),r=(el.names=Jd,el.registerCopy=bs,el.registerCut=vs,el.registerDefaultShortcuts=Xh,el.registerDelete=fs,el.registerEscape=gs,el.registerPaste=Ts,el.registerRedo=xs,el.registerUndo=ks,{ProcedureSerializer:class{constructor(e,t){this.procedureModelClass=e,this.parameterModelClass=t,this.priority=75}save(e){return(e=e.getProcedureMap().getProcedures().map(e=>Es(e))).length?e:null}load(e,t){var r,n=t.getProcedureMap();for(r of e)n.add(Ss(this.procedureModelClass,this.parameterModelClass,r,t))}clear(e){e.getProcedureMap().clear()}}}),Ku=(r.loadProcedure=Ss,r.saveProcedure=Es,class{constructor(){this.priority=100}save(e){return(e=e.getAllVariables().map(e=>e.save())).length?e:null}load(e,t){let r=pa(_.VARIABLE_MODEL,$a);e.forEach(e=>{null!=r&&r.load(e,t)})}clear(e){e.getVariableMap().clear()}}),ml=(Zh("variables",new Ku),{}),fo=(ml.VariableSerializer=Ku,{}),qo=(fo.load=Qh,fo.save=tm,{blocks:cc,exceptions:oc,priorities:Ha,procedures:r,registry:yl,variables:ml,workspaceComments:bl,workspaces:fo}),Xp=("Blockly"in globalThis||(globalThis.Blockly={Msg:Yd}),class{load(e,t){return(e=new yd(t.getWorkspace(),t.targetWorkspace,e,!0)).show(),new gd(e,"label")}gapForItem(e,t){return t}disposeItem(e){(e=e.getElement())instanceof yd&&e.dispose()}getType(){return"label"}}),Zp=(i(_.FLYOUT_INFLATER,"label",Xp),class extends yp{constructor(e){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:+this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,e&&(this.GRID_UNIT=e),this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=+this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=+this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(e){super.setFontConstants_(e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(e){super.setDynamicProperties_(e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;var t=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=t&&!isNaN(t)?t:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&o(this.selectedGlowFilter),this.replacementGlowFilter&&o(this.replacementGlowFilter)}makeStartHat(){var e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH;return{height:.75*e,width:t,path:ci("c",[u(25,-e),u(71,-e),u(t,0)])}}makeHexagonal(){function t(e,t,r){var n=(n=e/2)>i?i:n;return pi(-(r=r?-1:1)*n,e=(t?-1:1)*e/2)+pi(r*n,e)}let i=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width(e){return(e/=2)>i?i:e},height(e){return e},connectionOffsetY(e){return e/2},connectionOffsetX(e){return-e},pathDown(e){return t(e,!1,!1)},pathUp(e){return t(e,!0,!1)},pathRightDown(e){return t(e,!1,!0)},pathRightUp(e){return t(e,!1,!0)}}}makeRounded(){function t(e,t,r){var n=e>s?e-s:0,i=(e=(e>s?s:e)/2,r===t?"0":"1");return mi("a","0 0,"+i,e,u((r?1:-1)*e,(t?-1:1)*e))+d("v",(t?-1:1)*n)+mi("a","0 0,"+i,e,u((r?-1:1)*e,(t?-1:1)*e))}let r=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,s=2*r;return{type:this.SHAPES.ROUND,isDynamic:!0,width(e){return(e/=2)>r?r:e},height(e){return e},connectionOffsetY(e){return e/2},connectionOffsetX(e){return-e},pathDown(e){return t(e,!1,!1)},pathUp(e){return t(e,!0,!1)},pathRightDown(e){return t(e,!1,!0)},pathRightUp(e){return t(e,!1,!0)}}}makeSquared(){function t(e,t,r){e-=2*i;var n=r===t?"0":"1";return mi("a","0 0,"+n,i,u((r?1:-1)*i,(t?-1:1)*i))+d("v",(t?-1:1)*e)+mi("a","0 0,"+n,i,u((r?-1:1)*i,(t?-1:1)*i))}let i=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width(e){return i},height(e){return e},connectionOffsetY(e){return e/2},connectionOffsetX(e){return-e},pathDown(e){return t(e,!1,!1)},pathUp(e){return t(e,!0,!1)},pathRightDown(e){return t(e,!1,!0)},pathRightUp(e){return t(e,!1,!0)}}}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case v.INPUT_VALUE:case v.OUTPUT_VALUE:if(null!==(e=e.getSourceBlock().getOutputShape()))switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return t&&t.includes("Boolean")?this.HEXAGONAL:(t&&t.includes("Number")||t&&t.includes("String"),this.ROUNDED);case v.PREVIOUS_STATEMENT:case v.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function e(e){return ci("c",[u(e*i/2,0),u(e*i*3/4,a/2),u(e*i,a)])+hi([u(e*i,s)])+ci("c",[u(e*i/4,a/2),u(e*i/2,a),u(e*i,a)])+d("h",e*n)+ci("c",[u(e*i/2,0),u(e*i*3/4,-a/2),u(e*i,-a)])+hi([u(e*i,-s)])+ci("c",[u(e*i/4,-a/2),u(e*i/2,-a),u(e*i,-a)])}let t=this.NOTCH_WIDTH,r=this.NOTCH_HEIGHT,n=t/3,i=n/3,s=r/2,a=s/2,o=e(1),l=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:r,pathLeft:o,pathRight:l}}makeInsideCorners(){var e=this.CORNER_RADIUS,t=mi("a","0 0,0",e,u(-e,e)),r=mi("a","0 0,1",e,u(-e,e));return{width:e,height:e,pathTop:t,pathBottom:mi("a","0 0,0",e,u(e,e)),rightWidth:e,rightHeight:e,pathTopRight:r,pathBottomRight:mi("a","0 0,1",e,u(e,e))}}generateSecondaryColour_(e){return Qr("#000",e,.15)||e}generateTertiaryColour_(e){return Qr("#000",e,.25)||e}createDom(e,t,r,n){super.createDom(e,t,r,n),e=l(x.DEFS,{},e),t=l(x.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),l(x.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},t),r=l(x.FECOMPONENTTRANSFER,{result:"outBlur"},t),l(x.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},r),l(x.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),l(x.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.selectedGlowFilterId=t.id,this.selectedGlowFilter=t,e=l(x.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),l(x.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),t=l(x.FECOMPONENTTRANSFER,{result:"outBlur"},e),l(x.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),l(x.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),l(x.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),l(x.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter=e,n&&(n.style.setProperty("--blocklySelectedGlowFilter",`url(#${this.selectedGlowFilterId})`),n.style.setProperty("--blocklyReplacementGlowFilter",`url(#${this.replacementGlowFilterId})`))}getCSS_(e){return[e+" .blocklyText,",e+" .blocklyFlyoutLabelText {",`font: ${this.FIELD_TEXT_FONTWEIGHT} `+this.FIELD_TEXT_FONTSIZE+`pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",e+" .blocklyTextInputBubble textarea {","font-weight: normal;","}",e+" .blocklyText {","fill: #fff;","}",e+" .blocklyNonEditableField>rect:not(.blocklyDropdownRect),",e+" .blocklyEditableField>rect:not(.blocklyDropdownRect) {",`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",e+" .blocklyNonEditableField>text,",e+" .blocklyEditableField>text,",e+" .blocklyNonEditableField>g>text,",e+" .blocklyEditableField>g>text {","fill: #575E75;","}",e+" .blocklyFlyoutLabelText {","fill: #575E75;","}",e+" .blocklyText.blocklyBubbleText {","fill: #575E75;","}",e+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableField:not(.blocklyEditing):hover>rect,",e+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableField:not(.blocklyEditing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",e+" .blocklyHtmlInput {",`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",e+" .blocklyDropdownText {","fill: #fff !important;","}",e+".blocklyWidgetDiv .blocklyMenuItem,",e+".blocklyDropDownDiv .blocklyMenuItem {",`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",e+".blocklyDropDownDiv .blocklyMenuItemContent {","color: #fff;","}",e+" .blocklyHighlightedConnectionPath {",`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",e+" .blocklyDisabledPattern > .blocklyOutlinePath {","fill: var(--blocklyDisabledPattern)","}",e+" .blocklyInsertionMarker>.blocklyPath {",`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}",e+" .blocklySelected>.blocklyPath.blocklyPathSelected {","fill: none;","filter: var(--blocklySelectedGlowFilter);","}",e+" .blocklyReplaceable>.blocklyPath {","filter: var(--blocklyReplacementGlowFilter);","}"]}}),Qp=class extends bp{constructor(e,t){super(e,t)}draw(){var e=this.block_.pathObject;e.beginDrawing(),this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),e.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(e){if(!(e.height<=0)){if(R.isSpacer(e)){var t,r,n=e.precedesStatement,i=e.followsStatement;if(n||i)return r=(t=this.constants_.INSIDE_CORNERS).rightHeight,r=e.height-(n?r:0),i=i?t.pathBottomRight:"",e=0<r?d("V",e.yPos+r):"",void(this.outlinePath_+=i+e+(n?t.pathTopRight:""))}this.outlinePath_+=d("V",e.yPos+e.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){var e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=di(e.xPos,this.info_.startY),this.outlinePath_+=d("h",e.width)}drawFlatBottom_(){var e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=d("V",e.baseline),this.outlinePath_+=d("h",-e.width)}drawInlineInput_(e){this.positionInlineInputConnection_(e);var t=e.input.name;e.connectedBlock||this.info_.isInsertionMarker||(e=ui(e.xPos+e.connectionWidth,e.centerline-e.height/2)+this.getInlineInputPath(e),this.block_.pathObject.setOutlinePath(t,e))}getInlineInputPath(e){var t=e.width-2*e.connectionWidth,r=e.height;return d("h",t)+e.shape.pathRightDown(r)+d("h",-t)+e.shape.pathUp(r)+"z"}drawStatementInput_(e){var t=(s=e.getLastInput()).xPos+s.notchOffset+s.shape.width,r=this.constants_.INSIDE_CORNERS,n=s.shape.pathRight+d("h",-(s.notchOffset-r.width))+r.pathTop,i=e.height-2*r.height,s=r.pathBottom+d("h",s.notchOffset-r.width)+(s.connectedBottomNextConnection?"":s.shape.pathLeft);this.outlinePath_+=d("H",t)+n+d("v",i)+s+d("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}drawConnectionHighlightPath(e){var t=e.connectionModel;if(t.type===v.NEXT_STATEMENT||t.type===v.PREVIOUS_STATEMENT||t.type===v.OUTPUT_VALUE&&!e.isDynamicShape)return super.drawConnectionHighlightPath(e);e=t.type===v.INPUT_VALUE?ui(e.connectionWidth,-e.height/2)+this.getInlineInputPath(e):ui(e.width,-e.height/2)+e.shape.pathDown(e.height);var r,n,i=t.getSourceBlock();return null==(n=(r=i.pathObject).addConnectionHighlight)?void 0:n.call(r,t,e,t.getOffsetInBlock(),i.RTL)}},eh=class extends I{constructor(e,t,r,n,i,s,a){if(super(I.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",r=Number(nn(r)),t=Number(nn(t)),isNaN(r)||isNaN(t))throw Error("Height and width values of an image field must cast to numbers.");if(r<=0||t<=0)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new S(t,r+eh.Y_PADDING),this.imageHeight=r,"function"==typeof i&&(this.clickHandler=i),e!==I.SKIP_SETUP&&(a?this.configure_(a):(this.flipRtl=!!s,this.altText=nn(n)||""),this.setValue(nn(e)))}configure_(e){super.configure_(e),e.flipRtl&&(this.flipRtl=e.flipRtl),e.alt&&(this.altText=nn(e.alt))}initView(){this.imageElement=l(x.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS(Oo,"xlink:href",this.value_),this.fieldGroup_&&c(this.fieldGroup_,"blocklyImageField"),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(e){return"string"!=typeof e?null:e}doValueUpdate_(e){this.value_=e,this.imageElement&&this.imageElement.setAttributeNS(Oo,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(e){e!==this.altText&&(this.altText=e||"",this.imageElement)&&this.imageElement.setAttribute("alt",this.altText)}isClickable(){return super.isClickable()&&!!this.clickHandler}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(e){this.clickHandler=e}getText_(){return this.altText}static fromJson(e){if(e.src&&e.width&&e.height)return new this(e.src,e.width,e.height,void 0,void 0,void 0,e);throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.")}},th=(eh.Y_PADDING=1,Xd("field_image",eh),eh.prototype.DEFAULT_VALUE="",class extends I{set size_(e){super.size_=e}get size_(){var e=super.size_;return e.width<14&&(e.width=14),e}constructor(e,t,r){super(I.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onInputWrapper=this.onKeyDownWrapper=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,e!==I.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t)&&this.setValidator(t)}configure_(e){super.configure_(e),void 0!==e.spellcheck&&(this.spellcheck_=e.spellcheck)}initView(){if(!this.getSourceBlock())throw new Xc;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot()),this.fieldGroup_&&c(this.fieldGroup_,"blocklyInputField")}isFullBlockField(){var e,t=this.getSourceBlock();if(t)return this.fullBlockClickTarget_=!(null==(e=this.getConstants())||!e.FULL_BLOCK_FIELDS)&&t.isSimpleReporter();throw new Xc}doValueInvalid_(e,t=!0){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,e=this.value_,this.value_=this.valueWhenEditorWasOpened_,this.sourceBlock_)&&U()&&this.value_!==e&&t&&m(new(g(y.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,e,this.value_))}doValueUpdate_(e){this.isTextValid_=this.isDirty_=!0,this.value_=e}applyColour(){var e=this.getSourceBlock();if(!e)throw new Xc;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",e.getColourTertiary())):(this.borderRect_.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){var e;return null!=(e=this.getConstants())&&e.FULL_BLOCK_FIELDS&&(this.render_(),this.isDirty_=!1),super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){var e;if(super.render_(),this.isBeingEdited_&&(e=this.htmlInput_,this.isTextValid_?(a(e,"blocklyInvalidInput"),Ze(e,ro.INVALID,!1)):(c(e,"blocklyInvalidInput"),Ze(e,ro.INVALID,!0))),!(e=this.getSourceBlock()))throw new Xc;this.getConstants().FULL_BLOCK_FIELDS&&e.applyColour()}setSpellcheck(e){e!==this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_)&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_)}showEditor_(e,t=!1,r=!0){this.workspace_=this.sourceBlock_.workspace,!t&&this.workspace_.options.modalInputs&&(go||uo||po)?this.showPromptEditor():this.showInlineEditor(t,r)}showPromptEditor(){dt(f.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),e=>{null!==e&&this.setValue(this.getValueFromEditorText_(e)),this.onFinishEditing_(this.value_)})}showInlineEditor(e,t){var r=this.getSourceBlock();if(!r)throw new Xc;on(this,r.RTL,this.widgetDispose_.bind(this),this.workspace_,t),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,e||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var e=this.getSourceBlock();if(!e)throw new Xc;f.setGroup$$module$build$src$core$events$utils(!0);var t=oo,r=this.getClickTarget_();if(!r)throw Error("A click target has not been set.");c(r,"blocklyEditing"),(r=document.createElement("input")).className="blocklyHtmlInput",r.setAttribute("spellcheck",this.spellcheck_);var n=this.workspace_.getAbsoluteScale(),i=this.getConstants().FIELD_TEXT_FONTSIZE*n+"pt";return t.style.fontSize=i,r.style.fontSize=i,i=th.BORDERRADIUS*n+"px",this.isFullBlockField()&&(i=((i=this.getScaledBBox()).bottom-i.top)/2+"px",e=(e.getParent()?e.getParent():this.sourceBlock_).getColourTertiary(),r.style.border=+n+"px solid "+e,t.style.borderRadius=i,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW)&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*n+"px"),r.style.borderRadius=i,t.appendChild(r),r.value=r.defaultValue=this.getEditorText_(this.value_),r.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(r),r}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&U()&&null!==this.valueWhenEditorWasOpened_&&this.valueWhenEditorWasOpened_!==this.value_&&(m(new(g(y.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),f.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var e=oo.style;if(e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,!(e=this.getClickTarget_()))throw Error("A click target has not been set.");a(e,"blocklyEditing")}onFinishEditing_(e){}bindInputEvents_(e){this.onKeyDownWrapper=h(e,"keydown",this,this.onHtmlInputKeyDown_),this.onInputWrapper=h(e,"input",this,this.onHtmlInputChange)}unbindInputEvents_(){this.onKeyDownWrapper&&(s(this.onKeyDownWrapper),this.onKeyDownWrapper=null),this.onInputWrapper&&(s(this.onInputWrapper),this.onInputWrapper=null)}onHtmlInputKeyDown_(e){var t,r;"Enter"===e.key?(un(this),xr()):"Escape"===e.key?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value"),!1),un(this),xr()):"Tab"===e.key&&(e.preventDefault(),t=null==(r=this.workspace_)?void 0:r.getCursor(),r=e=>(e instanceof th||e instanceof O&&e.isSimpleReporter())&&e!==this.getSourceBlock(),(e=(e=e.shiftKey?null==t?void 0:t.getPreviousNode(this,r,!1):null==t?void 0:t.getNextNode(this,r,!1))instanceof O&&e.isSimpleReporter()?e.getFields().next().value:e)instanceof th)&&(un(this),xr(),t=e.getSourceBlock(),e.isFullBlockField()&&t&&t instanceof O?f.getFocusManager$$module$build$src$core$focus_manager().focusNode(t):f.getFocusManager$$module$build$src$core$focus_manager().focusNode(e),e.showEditor())}onHtmlInputChange(e){e=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&U()&&this.value_!==e&&m(new(g(y.BLOCK_FIELD_INTERMEDIATE_CHANGE))(this.sourceBlock_,this.name||null,e,this.value_))}setEditorValue_(e,t=!0){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e,t)}resizeEditor_(){tt().then(()=>{var e=this.getSourceBlock();if(!e)throw new Xc;var t=oo,r=this.getScaledBBox(),n=(t.style.width=r.right-r.left+"px",t.style.height=r.bottom-r.top+"px",r.top);t.style.left=`${e.RTL?r.right-t.offsetWidth:r.left}px`,t.style.top=n+"px"})}repositionForWindowResize(){var e=null==(e=this.getSourceBlock())?void 0:e.getRootBlock();return e instanceof O&&(Ai(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),e)||this.resizeEditor_(),!0)}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(e){return""+e}getValueFromEditorText_(e){return e}}),rh=(th.BORDERRADIUS=4,f.FieldTextInput$$module$build$src$core$field_textinput=class extends th{constructor(e,t,r){super(e,t,r)}initView(){super.initView(),this.fieldGroup_&&c(this.fieldGroup_,"blocklyTextInputField")}doClassValidation_(e){return void 0===e?null:""+e}static fromJson(e){return new this(nn(e.text),void 0,e)}},Xd("field_input",f.FieldTextInput$$module$build$src$core$field_textinput),f.FieldTextInput$$module$build$src$core$field_textinput.prototype.DEFAULT_VALUE="",f.FieldTextInput$$module$build$src$core$field_textinput,class extends ep{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){return!!e.outputConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}}),nh=class extends fp{constructor(e,t){if(super(e,t),this.connectedBottomNextConnection=!1,this.connectedBlock){for(e=this.connectedBlock;t=e.getNextBlock();)e=t;e.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},ih=class extends L{constructor(e){super(e),this.width=this.height=0,this.type|=R.getType("RIGHT_CONNECTION")}},sh=class extends _p{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){var t=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection;return!!e.outputConnection||t}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},ah=class extends vp{constructor(e,t){super(e,t),this.isInline=!0,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.topRow=new sh(this.constants_),this.bottomRow=new rh(this.constants_),this.isMultiRow=!t.getInputsInline()||t.isCollapsed(),this.hasStatementInput=0<t.statementInputCount,this.rightSide=this.outputConnection?new ih(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(e,t){return!!t&&(t instanceof rd||e instanceof nd||t instanceof nd||(e instanceof f.ValueInput$$module$build$src$core$inputs$value_input||e instanceof td||e instanceof rd)&&(!this.isInline||this.isMultiRow))}getDesiredRowWidth_(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(e)}getInRowSpacing_(e,t){return e&&t||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&t&&R.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&R.isLeftRoundedCorner(e)&&t&&(R.isPreviousConnection(t)||R.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&R.isLeftSquareCorner(e)&&t&&R.isHat(t)||e&&R.isField(e)&&0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(e,t){var r,n;return R.isTopRow(e)&&R.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:(r=R.isInputRow(e)&&e.hasStatement,(n=R.isInputRow(t)&&t.hasStatement)||r?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),n&&r?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):R.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):R.isBottomRow(t)?this.outputConnection?!t.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING)}getSpacerRowWidth_(e,t){var r=this.width-this.startX;return R.isInputRow(e)&&e.hasStatement||R.isInputRow(t)&&t.hasStatement?Math.max(r,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):r}getElemCenterline_(e,t){if(e.hasStatement&&!R.isSpacer(t)&&!R.isStatementInput(t))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(R.isInlineInput(t)){var r=t.connectedBlock;if(r&&r.outputConnection&&r.nextConnection)return e.yPos+r.height/2}return super.getElemCenterline_(e,t)}addInput_(e,t){if((e instanceof td||e instanceof rd)&&t.hasDummyInput&&t.align===f.Align$$module$build$src$core$inputs$align.LEFT&&e.align===f.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(t,e);else if(e instanceof nd)return t.elements.push(new nh(this.constants_,e)),t.hasStatement=!0,void(null===t.align&&(t.align=e.align));super.addInput_(e,t)}addAlignmentPadding_(r,e){if(this.rightAlignedDummyInputs.get(r)){let t;for(let e=0;e<r.elements.length;e++){var n=r.elements[e];if(R.isSpacer(n)&&(t=n),R.isField(n)&&n.parentInput===this.rightAlignedDummyInputs.get(r))break}if(t)return t.width+=e,void(r.width+=e)}super.addAlignmentPadding_(r,e)}adjustXPosition_(){var t=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let r=t;for(let e=2;e<this.rows.length-1;e+=2){var n,i=this.rows[e-1],s=this.rows[e],a=this.rows[e+1],i=2===e?!!this.topRow.hasPreviousConnection:!!i.followsStatement,a=e+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!a.precedesStatement;if(R.isInputRow(s)&&s.hasStatement)s.measure(),r=s.width-(null!=(n=null==(n=s.getLastInput())?void 0:n.width)?n:0)+t;else if(i&&(2===e||a)&&R.isInputRow(s)&&!s.hasStatement){a=s.xPos,i=null;for(let e=0;e<s.elements.length;e++){var o=s.elements[e];!((i=R.isSpacer(o)?o:i)&&(R.isField(o)||R.isInput(o))&&a<r)||R.isField(o)&&(o.field instanceof Ju||o.field instanceof eh)||(i.width+=r-a),a+=o.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var e=this.outputConnection.shape;if("isDynamic"in e&&e.isDynamic){for(var t=0,r=0;r<this.rows.length;r++){var n=this.rows[r];n.yPos=t,t+=n.height}this.height=t,r=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,t=e.height(r),r=e.width(r),this.outputConnection.height=t,this.outputConnection.width=r,this.outputConnection.startX=r,this.outputConnection.connectionOffsetY=e.connectionOffsetY(t),this.outputConnection.connectionOffsetX=e.connectionOffsetX(r),e=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(e=r,this.rightSide.height=t,this.rightSide.width=e,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+e),this.startX=r,this.width+=r+e,this.widthWithChildren+=r+e}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var r=0,e=0;e<this.rows.length;e++){var n=this.rows[e];if(R.isInputRow(n)){r=n.elements[n.elements.length-2];let e=this.getNegativeSpacing_(n.elements[1]),t=this.getNegativeSpacing_(r);var r=e+t,i=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-r<i&&(r=this.width-i,e=r/2,t=r/2),n.elements.unshift(new ap(this.constants_,-e)),n.elements.push(new ap(this.constants_,-t))}}if(r)for(this.width-=r,this.widthWithChildren-=r,this.rightSide.xPos-=r,e=0;e<this.rows.length;e++)n=this.rows[e],R.isTopOrBottomRow(n)&&(n.elements[1].width-=r),n.width-=r,n.widthWithConnectedBlocks-=r}}getNegativeSpacing_(e){var t,r,n,i;return e&&this.outputConnection?(t=this.outputConnection.width,r=this.outputConnection.shape.type,n=this.constants_,1<this.inputRows.length?r!==n.SHAPES.ROUND?0:(r=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,t-(r=this.height/2>r?r:this.height/2)*(1-Math.sin(Math.acos((r-this.constants_.SMALL_PADDING)/r)))):R.isInlineInput(e)?null==(e=(i=e.connectedBlock)?i.pathObject.outputShapeType:e.shape.type)||i&&i.outputConnection&&(i.statementInputCount||i.nextConnection)||r===n.SHAPES.HEXAGONAL&&r!==e?0:t-this.constants_.SHAPE_IN_SHAPE_PADDING[r][e]:R.isField(e)?r===n.SHAPES.ROUND&&e.field instanceof f.FieldTextInput$$module$build$src$core$field_textinput?t-2.75*n.GRID_UNIT:t-this.constants_.SHAPE_IN_SHAPE_PADDING[r][0]:R.isIcon(e)?this.constants_.SMALL_PADDING:0):0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let e=2;e<this.rows.length-1;e+=2){var t=this.rows[e-1],r=this.rows[e],n=this.rows[e+1],i=2===e,s=e+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!n.precedesStatement;if(i?this.topRow.hasPreviousConnection:t.followsStatement){var a=r.elements[1],a=3===r.elements.length&&a instanceof np&&(a.field instanceof Ju||a.field instanceof eh);if(!i&&a)t.height-=this.constants_.SMALL_PADDING,n.height-=this.constants_.SMALL_PADDING,r.height-=this.constants_.MEDIUM_PADDING;else if(i||s){if(s){for(i=!1,s=0;s<r.elements.length;s++)if(a=r.elements[s],R.isInlineInput(a)&&a.connectedBlock&&!a.connectedBlock.isShadow()&&40<=a.connectedBlock.getHeightWidth().height){i=!0;break}i&&(t.height-=this.constants_.SMALL_PADDING,n.height-=this.constants_.SMALL_PADDING)}}else t.height+=this.constants_.SMALL_PADDING}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},oh=class extends Tp{constructor(e,t,r){super(e,t,r),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=r}setPath(e){super.setPath(e),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",e)}applyColour(e){super.applyColour(e);var t,r=e.getParent();e.isShadow()&&r&&this.svgPath.setAttribute("stroke",r.getColourTertiary());for(t of this.outlines.values())t.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(var e of this.outlines.values())e.setAttribute("transform","scale(-1 1)")}updateSelected(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.classList.add("blocklyPathSelected"),a(this.svgPathSelected,$o.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),a(this.svgPathSelected,$o.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME),this.svgPathSelected.removeAttribute("tabindex"),this.svgPathSelected.removeAttribute("id"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){e=e.getParentInput().name,(e=this.getOutlinePath(e))&&(t?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(var e of this.outlines.keys())this.remainingOutlines.add(e)}endDrawing(){if(this.remainingOutlines.size)for(var e of this.remainingOutlines)this.removeOutlinePath(e);this.remainingOutlines.clear()}setOutlinePath(e,t){(e=this.getOutlinePath(e)).setAttribute("d",t),e.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(e){return this.outlines.has(e)||this.outlines.set(e,l(x.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(e),this.outlines.get(e)}removeOutlinePath(e){let t,r;null!=(t=this.outlines.get(e))&&null!=(r=t.parentNode)&&r.removeChild(this.outlines.get(e)),this.outlines.delete(e)}},lh=class extends Jc{constructor(e){super(e)}makeConstants_(){return new Zp}makeRenderInfo_(e){return new ah(this,e)}makeDrawer_(e,t){return new Qp(e,t)}makePathObject(e,t){return new oh(e,t,this.getConstants())}getConstants(){return this.constants_}},ch=(rs("zelos",lh),class{constructor(e){this.staticConn=this.draggedConn=this.markerConn=this.fadedBlock=null,this.workspace=e.workspace}previewReplacement(e,t,r){f.disable$$module$build$src$core$events$utils();try{this.hidePreview(),(this.fadedBlock=r).fadeForReplacement(!0),this.workspace.getRenderer().shouldHighlightConnection(t)&&(t.highlight(),this.staticConn=t)}finally{f.enable$$module$build$src$core$events$utils()}}previewConnection(e,t){if(e!==this.draggedConn||t!==this.staticConn){f.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.shouldUseMarkerPreview(e,t)&&(this.markerConn=this.previewMarker(e,t)),this.workspace.getRenderer().shouldHighlightConnection(t)&&t.highlight(),this.draggedConn=e,this.staticConn=t}finally{f.enable$$module$build$src$core$events$utils()}}}shouldUseMarkerPreview(e,t){return t.type===v.PREVIOUS_STATEMENT||t.type===v.NEXT_STATEMENT||!(this.workspace.getRenderer()instanceof lh)}previewMarker(e,t){let r=e.getSourceBlock(),n=this.createInsertionMarker(r),i=this.getMatchingConnection(r,n,e);if(!i)return null;n.queueRender(),rt(),i.connect(t);let s={x:t.x-i.x,y:t.y-i.y},a=i.getOffsetInBlock().clone();return tt().then(()=>{if(!n.isDeadOrDying()){f.disable$$module$build$src$core$events$utils();try{null!=n&&n.positionNearConnection(i,s,a),null!=n&&n.getSvgRoot().setAttribute("visibility","visible")}finally{f.enable$$module$build$src$core$events$utils()}}}),i}createInsertionMarker(e){var t,r=Mt(e,{addCoordinates:!1,addInputBlocks:!1,addNextBlocks:!1,doFullSerialization:!1});if(!r)throw Error("Failed to serialize source block. "+e.toDevString());for(t of(e=Kt(r,this.workspace)).getDescendants(!1))t.setInsertionMarker(!0);return e.initSvg(),e.getSvgRoot().setAttribute("visibility","hidden"),e}getMatchingConnection(t,r,n){if(t=t.getConnections_(!0),r=r.getConnections_(!0),t.length===r.length)for(let e=0;e<t.length;e++)if(t[e]===n)return r[e];return null}hidePreview(){f.disable$$module$build$src$core$events$utils();try{this.staticConn&&(this.staticConn.unhighlight(),this.staticConn=null),this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null),this.markerConn&&(this.hideInsertionMarker(this.markerConn),this.draggedConn=this.markerConn=null)}finally{f.enable$$module$build$src$core$events$utils()}}hideInsertionMarker(e){var t,r=e.getSourceBlock(),n=r.outputConnection;null!=(t=r.previousConnection)&&t.targetConnection||null!=n&&n.targetConnection?r.unplug(!0):null!=(t=e.targetBlock())&&t.unplug(!1),r.dispose()}dispose(){this.hidePreview()}}),uh=(i(_.CONNECTION_PREVIEWER,$a,ch),{}),dh=(uh.Align=f.Align$$module$build$src$core$inputs$align,uh.DummyInput=td,uh.EndRowInput=rd,uh.Input=ed,uh.StatementInput=nd,uh.ValueInput=f.ValueInput$$module$build$src$core$inputs$value_input,uh.inputTypes=f.inputTypes$$module$build$src$core$inputs$input_types,!1),ph=(f.CodeGenerator$$module$build$src$core$generator=class{constructor(e){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(r){r||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),r=Ya);var n=[];this.init(r),r=r.getTopBlocks(!0);for(let e=0,t;t=r[e];e++){let e=this.blockToCode(t);(e=Array.isArray(e)?e[0]:e)&&(t.outputConnection&&(e=this.scrubNakedValue(e),this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(e=this.injectId(this.STATEMENT_PREFIX,t)+e),this.STATEMENT_SUFFIX)&&!t.suppressPrefixSuffix&&(e+=this.injectId(this.STATEMENT_SUFFIX,t)),n.push(e))}return n=n.join("\n"),(n=(n=(n=this.finish(n)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")}prefixLines(e,t){return t+e.replace(/(?!\n$)\n/g,"\n"+t)}allNestedComments(t){var r=[];t=t.getDescendants(!0);for(let e=0;e<t.length;e++){var n=t[e].getCommentText();n&&r.push(n)}return r.length&&r.push(""),r.join("\n")}blockToCode(e,t){if(!1===this.isInitialized&&console.warn("CodeGenerator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return t?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return t?"":this.blockToCode(e.getChildren(!1)[0]);var r=this.forBlock[e.type];if("function"!=typeof r)throw Error(this.name_+" generator does not know how to generate code "+`for block type "${e.type}".`);if(r=r.call(e,e,this),Array.isArray(r)){if(e.outputConnection)return[this.scrub_(e,r[0],t),r[1]];throw TypeError("Expecting string from statement block: "+e.type)}if("string"==typeof r)return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(r=this.injectId(this.STATEMENT_PREFIX,e)+r),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(r+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,r,t);if(null===r)return"";throw SyntaxError("Invalid code generated: "+r)}valueToCode(e,t,r){if(isNaN(r))throw TypeError("Expecting valid order from block: "+e.type);if(!(n=e.getInputTargetBlock(t))&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if(!n)return"";if(""===(t=this.blockToCode(n)))return"";if(!Array.isArray(t))throw TypeError(`Expecting tuple from value block: ${n.type} See `+"developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information");if(e=t[0],t=t[1],isNaN(t))throw TypeError("Expecting valid order from value block: "+n.type);if(!e)return"";var n=!1,i=Math.floor(r),s=Math.floor(t);if(i<=s&&(i!==s||0!==i&&99!==i))for(n=!0,i=0;i<this.ORDER_OVERRIDES.length;i++)if(this.ORDER_OVERRIDES[i][0]===r&&this.ORDER_OVERRIDES[i][1]===t){n=!1;break}return e=n?"("+e+")":e}statementToCode(e,t){var r=e.getInputTargetBlock(t);if(!r&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if("string"!=typeof(e=this.blockToCode(r)))throw TypeError("Expecting code from statement block: "+(r&&r.type));return e=e&&this.prefixLines(e,this.INDENT)}addLoopTrap(e,t){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,t),this.INDENT)+e),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,t),this.INDENT)+e),this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,t),this.INDENT)),e}injectId(e,t){return t=t.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+t+"'")}addReservedWords(e){this.RESERVED_WORDS_+=e+","}provideFunction_(t,r){if(!this.definitions_[t]){var n=this.nameDB_.getDistinctName(t,f.NameType$$module$build$src$core$names.PROCEDURE);this.functionNames_[t]=n,r=(r=Array.isArray(r)?r.join("\n"):r).trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,n);let e;for(;e!==r;)r=(e=r).replace(/^(( {2})*) {2}/gm,"$1\0");r=r.replace(/\0/g,this.INDENT),this.definitions_[t]=r}return this.functionNames_[t]}getVariableName(e){return this.getName(e,f.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(e){return this.getName(e,f.NameType$$module$build$src$core$names.PROCEDURE)}getName(e,t){if(this.nameDB_)return this.nameDB_.getName(e,t);throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.")}init(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(e,t,r){return t}finish(e){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),e}scrubNakedValue(e){return e}},0,f.CodeGenerator$$module$build$src$core$generator,class extends Pd{constructor(e){super(e)}setMetrics_(e){var t,r,n;this.isVisible()&&(t=(n=this.workspace_.getMetricsManager()).getScrollMetrics(),r=n.getViewMetrics(),n=n.getAbsoluteMetrics(),"number"==typeof e.y&&(this.workspace_.scrollY=-(t.top+(t.height-r.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+n.left,this.workspace_.scrollY+n.top))}getX(){var e,t,r;return this.isVisible()?(e=(r=this.targetWorkspace.getMetricsManager()).getAbsoluteMetrics(),t=r.getViewMetrics(),r=r.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===b.LEFT?r.width:t.width-this.getWidth():this.toolboxPosition_===b.LEFT?0:t.width:this.toolboxPosition_===b.LEFT?0:t.width+e.left-this.getWidth()):0}getY(){return 0}position(){var e,t;this.isVisible()&&this.targetWorkspace.isVisible()&&(e=this.targetWorkspace.getMetricsManager().getViewMetrics(),this.height_=e.height,t=this.getWidth()-this.CORNER_RADIUS,this.setBackgroundPath(t,e.height-2*this.CORNER_RADIUS),e=this.getX(),t=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),e,t))}setBackgroundPath(e,t){var r=this.toolboxPosition_===b.RIGHT,n=e+this.CORNER_RADIUS;(n=["M "+(r?n:0)+",0"]).push("h",r?-e:e),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,r?0:1,r?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),n.push("v",Math.max(0,t)),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,r?0:1,r?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),n.push("h",r?e:-e),n.push("z"),this.svgBackground_.setAttribute("d",n.join(" "))}scrollToStart(){var e;null!=(e=this.workspace_.scrollbar)&&e.setY(0)}wheel_(e){var t,r,n=Sa(e);n.y&&(t=(r=this.workspace_.getMetricsManager()).getScrollMetrics(),n=r.getViewMetrics().top-t.top+n.y,null!=(r=this.workspace_.scrollbar)&&r.setY(n),dn(this.workspace_),xr()),e.preventDefault(),e.stopPropagation()}layout_(e){this.workspace_.scale=this.targetWorkspace.scale;var t,r=this.MARGIN,n=this.RTL?r:r+this.tabWidth_;for(t of e)t.getElement().moveBy(n,r),r+=t.getElement().getBoundingRectangle().getHeight()}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;var t=this.dragAngleRange_;return e<t&&-t<e||e<-180+t||180-t<e}getClientRect(){var e,t;return this.svgGroup_&&!this.autoClose&&this.isVisible()?(t=(e=this.svgGroup_.getBoundingClientRect()).left,this.toolboxPosition_===b.LEFT?new E(-1e9,1e9,-1e9,t+e.width):new E(-1e9,1e9,t,1e9)):null}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();var e=this.getContents().reduce((e,t)=>Math.max(e,t.getElement().getBoundingRectangle().getWidth()),0),e=(e=(e+=1.5*this.MARGIN+this.tabWidth_)*this.workspace_.scale)+nl.scrollbarThickness;if(this.getWidth()!==e){if(this.RTL)for(var t of this.getContents()){var r=t.getElement().getBoundingRectangle().left,n=e/this.workspace_.scale-t.getElement().getBoundingRectangle().getWidth()-this.MARGIN-this.tabWidth_;t.getElement().moveBy(n-r,0)}this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==b.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}}),hh=(ph.registryName="verticalFlyout",i(_.FLYOUTS_VERTICAL_TOOLBOX,$a,ph),class extends Pd{constructor(e){super(e),this.horizontalLayout=!0}setMetrics_(e){var t,r,n;this.isVisible()&&(t=(n=this.workspace_.getMetricsManager()).getScrollMetrics(),r=n.getViewMetrics(),n=n.getAbsoluteMetrics(),"number"==typeof e.x&&(this.workspace_.scrollX=-(t.left+(t.width-r.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+n.left,this.workspace_.scrollY+n.top))}getX(){return 0}getY(){var e,t,r,n;return this.isVisible()?(e=(r=this.targetWorkspace.getMetricsManager()).getAbsoluteMetrics(),t=r.getViewMetrics(),r=r.getToolboxMetrics(),n=this.toolboxPosition_===b.TOP,this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?n?r.height:t.height-this.getHeight():n?0:t.height:n?0:t.height+e.top-this.getHeight()):0}position(){var e,t;this.isVisible()&&this.targetWorkspace.isVisible()&&(e=this.targetWorkspace.getMetricsManager().getViewMetrics(),this.width_=e.width,e=e.width-2*this.CORNER_RADIUS,t=this.getHeight()-this.CORNER_RADIUS,this.setBackgroundPath(e,t),e=this.getX(),t=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),e,t))}setBackgroundPath(e,t){var r=this.toolboxPosition_===b.TOP,n=["M 0,"+(r?0:this.CORNER_RADIUS)];r?(n.push("h",e+2*this.CORNER_RADIUS),n.push("v",t),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),n.push("h",-e),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),n.push("h",e),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),n.push("v",t),n.push("h",-e-2*this.CORNER_RADIUS)),n.push("z"),this.svgBackground_.setAttribute("d",n.join(" "))}scrollToStart(){var e;null!=(e=this.workspace_.scrollbar)&&e.setX(this.RTL?1/0:0)}wheel_(e){var t,r,n=Sa(e);(n=n.x||n.y)&&(t=(r=this.workspace_.getMetricsManager()).getScrollMetrics(),n=r.getViewMetrics().left-t.left+n,null!=(r=this.workspace_.scrollbar)&&r.setX(n),dn(this.workspace_),xr()),e.preventDefault(),e.stopPropagation()}layout_(e){this.workspace_.scale=this.targetWorkspace.scale;var t,r=this.MARGIN;let n=r+this.tabWidth_;for(t of e=this.RTL?e.reverse():e)e=t.getElement().getBoundingRectangle(),e=this.RTL?n+e.getWidth():n,t.getElement().moveBy(e,r),n+=t.getElement().getBoundingRectangle().getWidth()}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;var t=this.dragAngleRange_;return e<90+t&&90-t<e||-90-t<e&&e<-90+t}getClientRect(){var e,t;return this.svgGroup_&&!this.autoClose&&this.isVisible()?(t=(e=this.svgGroup_.getBoundingClientRect()).top,this.toolboxPosition_===b.TOP?new E(-1e9,t+e.height,-1e9,1e9):new E(t,1e9,-1e9,1e9)):null}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();var e=this.getContents().reduce((e,t)=>Math.max(e,t.getElement().getBoundingRectangle().getHeight()),0),e=(e=(e+=1.5*this.MARGIN)*this.workspace_.scale)+nl.scrollbarThickness;this.getHeight()!==e&&(this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==b.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets())}}),mh=(i(_.FLYOUTS_HORIZONTAL_TOOLBOX,$a,hh),class extends Lu{constructor(e,t,r,n,i){super(I.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=mh.dropdownCreate,this.defaultVariableName="string"==typeof e?e:"",this.size_=new S(0,0),e!==I.SKIP_SETUP&&(i?this.configure_(i):this.setTypes(r,n),t)&&this.setValidator(t)}configure_(e){super.configure_(e),this.setTypes(e.variableTypes,e.defaultType)}initModel(){var e=this.getSourceBlock();if(!e)throw new Xc;this.variable||(e=f.getOrCreateVariablePackage$$module$build$src$core$variables(e.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(e.getId()))}initView(){super.initView(),c(this.fieldGroup_,"blocklyVariableField")}shouldAddBorderRect_(){var e=this.getSourceBlock();if(e)return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!==e.type);throw new Xc}fromXml(e){if(!(i=this.getSourceBlock()))throw new Xc;var t=e.getAttribute("id"),r=e.textContent,n=e.getAttribute("variabletype")||e.getAttribute("variableType")||"",i=f.getOrCreateVariablePackage$$module$build$src$core$variables(i.workspace,t,r,n);if(null!==n&&n!==i.getType())throw Error("Serialized variable type with id '"+i.getId()+"' had type "+i.getType()+", and does not match variable field that references it: "+Mn(e)+".");this.setValue(i.getId())}toXml(e){return this.initModel(),e.id=this.variable.getId(),e.textContent=this.variable.getName(),this.variable.getType()&&e.setAttribute("variabletype",this.variable.getType()),e}saveState(e){var t=this.saveLegacyState(mh);return null===t&&(this.initModel(),t={id:this.variable.getId()},e)&&(t.name=this.variable.getName(),t.type=this.variable.getType()),t}loadState(e){var t=this.getSourceBlock();if(!t)throw new Xc;this.loadLegacyState(mh,e)||(e=f.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,e.id||null,e.name,e.type||""),this.setValue(e.getId()))}setSourceBlock(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(e)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.getName():""}getVariable(){return this.variable}getDefaultType(){return this.defaultType}getValidator(){return this.variable?this.validator_:null}doClassValidation_(e){if(null===e)return null;var t=this.getSourceBlock();if(t)return(t=f.getVariable$$module$build$src$core$variables(t.workspace,e))?(t=t.getType(),this.typeIsAllowed(t)?e:(console.warn("Variable type doesn't match this field!  Type was "+t),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null);throw new Xc}doValueUpdate_(e){var t=this.getSourceBlock();if(!t)throw new Xc;this.variable=f.getVariable$$module$build$src$core$variables(t.workspace,e),super.doValueUpdate_(e)}typeIsAllowed(t){var r=this.getVariableTypes();if(!r)return!0;for(let e=0;e<r.length;e++)if(t===r[e])return!0;return!1}getVariableTypes(){if(this.variableTypes)return this.variableTypes;if(!this.sourceBlock_||this.sourceBlock_.isDeadOrDying())return[""];let e=this.sourceBlock_.workspace.getVariableMap().getTypes();if(this.sourceBlock_.isInFlyout){var t=this.sourceBlock_.workspace.getPotentialVariableMap();if(!t)return e;e=Array.from(new Set([...e,...t.getTypes()]))}return e}setTypes(t=null,r=""){var n=this.getText();if(Array.isArray(t)){if(0===t.length)throw Error(`'variableTypes' of field variable ${n} was an empty list. If you want to include all variable types, pass 'null' instead.`);n=!1;for(let e=0;e<t.length;e++)t[e]===r&&(n=!0);if(!n)throw Error("Invalid default type '"+r+"' in the definition of a FieldVariable")}else if(null!==t)throw Error("'variableTypes' was not an array or null in the definition of FieldVariable "+n);this.defaultType=r,this.variableTypes=t}refreshVariableName(){this.forceRerender()}onItemSelected_(e,t){if(e=t.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(e===Xu&&this.variable)return void f.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);if(e===Zu&&this.variable)return e=this.variable.getWorkspace(),void f.deleteVariable$$module$build$src$core$variables(e,this.variable,this.sourceBlock_)}this.setValue(e)}referencesVariables(){return!0}static fromJson(e){return new this(nn(e.variable),void 0,void 0,void 0,e)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");var e=this.getText();let t=[];if((r=this.getSourceBlock())&&!r.isDeadOrDying()){var r=r.workspace,n=this.getVariableTypes();for(let e=0;e<n.length;e++){var i,s,a=n[e],o=r.getVariableMap().getVariablesOfType(a);t=t.concat(o),r.isFlyout&&(s=i=void 0,t=t.concat(null!=(s=null==(i=r.getPotentialVariableMap())?void 0:i.getVariablesOfType(a))?s:[]))}}for(t.sort(Lt),i=[],s=0;s<t.length;s++)i[s]=[t[s].getName(),t[s].getId()];return i.push([f.Msg$$module$build$src$core$msg.RENAME_VARIABLE,Xu]),f.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&i.push([f.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",e),Zu]),i}}),qu=(Xd("field_variable",mh),class extends th{constructor(e,t,r,n,i,s){super(I.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,e!==I.SKIP_SETUP&&(s?this.configure_(s):this.setConstraints(t,r,n),this.setValue(e),i)&&this.setValidator(i)}configure_(e){super.configure_(e),this.setMinInternal(e.min),this.setMaxInternal(e.max),this.setPrecisionInternal(e.precision)}setConstraints(e,t,r){this.setMinInternal(e),this.setMaxInternal(t),this.setPrecisionInternal(r),this.setValue(this.getValue())}setMin(e){this.setMinInternal(e),this.setValue(this.getValue())}setMinInternal(e){null==e?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}getMin(){return this.min_}setMax(e){this.setMaxInternal(e),this.setValue(this.getValue())}setMaxInternal(e){null==e?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}getMax(){return this.max_}setPrecision(e){this.setPrecisionInternal(e),this.setValue(this.getValue())}setPrecisionInternal(e){this.precision_=Number(e)||0;let t=String(this.precision_);var r=(t=t.includes("e")?this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}):t).indexOf(".");this.decimalPlaces=-1===r?e?0:null:t.length-r-1}getPrecision(){return this.precision_}doClassValidation_(e){return null===e||(e=(e=(e=(""+e).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),e=Number(e||0),isNaN(e))?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),null!==this.decimalPlaces?Number(e.toFixed(this.decimalPlaces)):e)}widgetCreate_(){var e=super.widgetCreate_();return this.min_>-1/0&&(e.min=""+this.min_,Ze(e,ro.VALUEMIN,this.min_)),this.max_<1/0&&(e.max=""+this.max_,Ze(e,ro.VALUEMAX,this.max_)),e}initView(){super.initView(),this.fieldGroup_&&c(this.fieldGroup_,"blocklyNumberField")}static fromJson(e){return new this(e.value,void 0,void 0,void 0,void 0,e)}}),Gu=(Xd("field_number",qu),qu.prototype.DEFAULT_VALUE=0,class extends Ju{constructor(e,t,r){super(String(null!=e?e:""),t,r),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(e){return new this(nn(e.text),void 0,e)}}),gh=(Xd("field_label_serializable",Gu),class extends I{constructor(e,t,r){super(I.SKIP_SETUP),this.SERIALIZABLE=!0,this.value_=this.value_,this.checkChar=gh.CHECK_CHAR,e!==I.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(e),t)&&this.setValidator(t)}configure_(e){super.configure_(e),e.checkCharacter&&(this.checkChar=e.checkCharacter)}saveState(){var e=this.saveLegacyState(gh);return null!==e?e:this.getValueBoolean()}initView(){super.initView();var e=this.getTextElement();c(this.fieldGroup_,"blocklyCheckboxField"),e.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(e){this.checkChar=e||gh.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(e){return!0===e||"TRUE"===e?"TRUE":!1===e||"FALSE"===e?"FALSE":null}doValueUpdate_(e){this.value_=this.convertValueToBool(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool(this.value_))}convertValueToBool(e){return"string"==typeof e?"TRUE"===e:!!e}static fromJson(e){return new this(e.checked,void 0,e)}}),P=(gh.CHECK_CHAR="",Xd("field_checkbox",gh),gh.prototype.DEFAULT_VALUE=!1,class{constructor(e,t){this.draggable=e,this.workspace=t,this.dragTarget=null,this.startLoc=e.getRelativeToSurfaceXY()}onDragStart(e){f.getGroup$$module$build$src$core$events$utils()||f.setGroup$$module$build$src$core$events$utils(!0),this.draggable.startDrag(e)}onDrag(e,t){this.moveDraggable(e,t),t=this.getRoot(this.draggable),Ri(t)&&t.setDeleteStyle(this.wouldDeleteDraggable(e,t)),this.updateDragTarget(e)}updateDragTarget(e){e=this.workspace.getDragTarget(e);var t,r=this.getRoot(this.draggable);this.dragTarget!==e&&(null!=(t=this.dragTarget)&&t.onDragExit(r),null!=e)&&e.onDragEnter(r),null!=e&&e.onDragOver(r),this.dragTarget=e}moveDraggable(e,t){t=this.pixelsToWorkspaceUnits(t),t=k.sum(this.startLoc,t),this.draggable.drag(t,e)}wouldDeleteDraggable(e,t){return!(!(e=this.workspace.getDragTarget(e))||!this.workspace.getComponentManager().hasCapability(e.id,Jo.Capability.DELETE_AREA))&&e.wouldDelete(t)}onDragEnd(e){var t,r=f.getGroup$$module$build$src$core$events$utils(),n=this.workspace.getDragTarget(e),i=this.getRoot(this.draggable);n&&null!=(t=this.dragTarget)&&t.onDrop(i),this.shouldReturnToStart(e,i)&&this.draggable.revertDrag(),(n=Ri(i)&&this.wouldDeleteDraggable(e,i))&&this.draggable instanceof O&&vi(this.draggable.getRootBlock()),this.draggable.endDrag(e),n&&Ri(i)&&(f.setGroup$$module$build$src$core$events$utils(r),i.dispose()),f.setGroup$$module$build$src$core$events$utils(!1),!n&&Q(this.draggable)&&f.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.draggable)}getRoot(e){return e instanceof O?e.getRootBlock():e}shouldReturnToStart(e,t){return!!(e=this.workspace.getDragTarget(e))&&e.shouldPreventMove(t)}pixelsToWorkspaceUnits(e){return e=new k(e.x/this.workspace.scale,e.y/this.workspace.scale),this.workspace.isMutator&&e.scale(1/this.workspace.options.parentWorkspace.scale),e}}),Wo=(i(_.BLOCK_DRAGGER,$a,P),{}),fh=(Wo.BlockDragStrategy=ud,Wo.BubbleDragStrategy=Bu,Wo.CommentDragStrategy=pu,Wo.Dragger=P,class extends Ko{constructor(e,t,r){super(e?e.workspace.id:void 0),this.type=y.BLOCK_DRAG,e&&(this.blockId=e.id,this.isStart=t,this.blocks=r)}toJson(){var e=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new fh)).isStart=e.isStart,t.blockId=e.blockId,t.blocks=e.blocks,t}}),_h=(i(_.EVENT,y.BLOCK_DRAG,fh),class extends dc{constructor(e,t,r,n){super(e),this.type=y.BLOCK_FIELD_INTERMEDIATE_CHANGE,this.recordUndo=!1,e&&(this.name=t,this.oldValue=r,this.newValue=n)}toJson(){var e=super.toJson();if(this.name)return e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e;throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new _h)).name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(t=t.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");e=e?this.newValue:this.oldValue,(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name)}}),yh=(i(_.EVENT,y.BLOCK_FIELD_INTERMEDIATE_CHANGE,_h),class extends dc{constructor(e){super(e),this.type=y.BLOCK_MOVE,e&&(e.isShadow()&&(this.recordUndo=!1),e=this.currentLocation(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)}toJson(){var e=super.toJson();return e.oldParentId=this.oldParentId,e.oldInputName=this.oldInputName,this.oldCoordinate&&(e.oldCoordinate=Math.round(this.oldCoordinate.x)+", "+Math.round(this.oldCoordinate.y)),e.newParentId=this.newParentId,e.newInputName=this.newInputName,this.newCoordinate&&(e.newCoordinate=Math.round(this.newCoordinate.x)+", "+Math.round(this.newCoordinate.y)),this.reason&&(e.reason=this.reason),this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new yh)).oldParentId=e.oldParentId,t.oldInputName=e.oldInputName,e.oldCoordinate&&(r=e.oldCoordinate.split(","),t.oldCoordinate=new k(Number(r[0]),Number(r[1]))),t.newParentId=e.newParentId,t.newInputName=e.newInputName,e.newCoordinate&&(r=e.newCoordinate.split(","),t.newCoordinate=new k(Number(r[0]),Number(r[1]))),void 0!==e.reason&&(t.reason=e.reason),void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}recordNew(){var e=this.currentLocation();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate}setReason(e){this.reason=e}currentLocation(){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var t,r=e.getBlockById(this.blockId);if(r)return e={},(t=r.getParent())?(e.parentId=t.id,(r=t.getInputWithBlock(r))&&(e.inputName=r.name)):e.coordinate=r.getRelativeToSurfaceXY(),e;throw Error("The block associated with the block move event could not be found")}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&k.equals(this.oldCoordinate,this.newCoordinate)}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var r=t.getBlockById(this.blockId);if(r){var n=e?this.newParentId:this.oldParentId,i=e?this.newInputName:this.oldInputName;if(e=e?this.newCoordinate:this.oldCoordinate,n){var s=t.getBlockById(n);if(!s)return void console.warn("Can't connect to non-existent block: "+n)}if(r.getParent()&&r.unplug(),e)i=r.getRelativeToSurfaceXY(),r.moveBy(e.x-i.x,e.y-i.y,this.reason);else{let e;r=null==(t=!(t=r.outputConnection)||r.previousConnection&&r.previousConnection.isConnected()?r.previousConnection:t)?void 0:t.type,i?(r=s.getInput(i))&&(e=r.connection):r===v.PREVIOUS_STATEMENT&&(e=s.nextConnection),e&&t?t.connect(e):console.warn("Can't connect to non-existent input: "+i)}}else console.warn("Can't move non-existent block: "+this.blockId)}}),bh=(i(_.EVENT,y.BLOCK_MOVE,yh),class extends Ko{constructor(e,t,r){super(e?e.workspace.id:void 0),this.type=y.BUBBLE_OPEN,e&&(this.blockId=e.id,this.isOpen=t,this.bubbleType=r)}toJson(){var e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(this.bubbleType)return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId||"",e;throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new bh)).isOpen=e.isOpen,t.bubbleType=e.bubbleType,t.blockId=e.blockId,t}}),vh=((C=Gh=Gh||{}).MUTATOR="mutator",C.COMMENT="comment",C.WARNING="warning",i(_.EVENT,y.BUBBLE_OPEN,bh),class extends jo{constructor(e){super(),this.isBlank=!e,e&&(this.commentId=e.id,this.workspaceId=e.workspace.id,this.group=f.getGroup$$module$build$src$core$events$utils(),this.recordUndo=So)}toJson(){var e=super.toJson();if(this.commentId)return e.commentId=this.commentId,e;throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new vh)).commentId=e.commentId,t}static CommentCreateDeleteHelper(e,t){var r=e.getEventWorkspace_();if(t){if(!e.json)throw Error("Encountered a comment event without proper json");qe(e.json,r)}else{if(!e.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=r.getCommentById(e.commentId))?t.dispose():console.warn("Can't delete non-existent comment: "+e.commentId)}}}),Th=class extends vh{constructor(e,t,r){super(e),this.type=y.COMMENT_CHANGE,e&&(this.oldContents_=void 0===t?"":t,this.newContents_=void 0===r?"":r)}toJson(){var e=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(this.newContents_)return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e;throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new Th)).oldContents_=e.oldContents,t.newContents_=e.newContents,t}isNull(){return this.oldContents_===this.newContents_}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){var r=e?this.newContents_:this.oldContents_;if(void 0===r){if(e)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson")}t.setText(r)}else console.warn("Can't change non-existent comment: "+this.commentId)}},kh=(i(_.EVENT,y.COMMENT_CHANGE,Th),class extends vh{constructor(e,t){super(e),this.newCollapsed=t,this.type=y.COMMENT_COLLAPSE}toJson(){var e=super.toJson();if(void 0===this.newCollapsed)throw Error("The new collapse value undefined. Either call recordNew, or call fromJson");return e.newCollapsed=this.newCollapsed,e}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new kh)).newCollapsed=e.newCollapsed,t}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=t.getCommentById(this.commentId))?t.setCollapsed(e?!!this.newCollapsed:!this.newCollapsed):console.warn("Can't collapse or uncollapse non-existent comment: "+this.commentId)}}),xh=(i(_.EVENT,y.COMMENT_COLLAPSE,kh),class extends vh{constructor(e){super(e),this.type=y.COMMENT_CREATE,e&&(this.xml=An(e),this.json=We(e,{addCoordinates:!0}))}toJson(){var e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(this.json)return e.xml=Mn(this.xml),e.json=this.json,e;throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new xh)).xml=f.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}run(e){vh.CommentCreateDeleteHelper(this,e)}}),Eh=(i(_.EVENT,y.COMMENT_CREATE,xh),class extends vh{constructor(e){super(e),this.type=y.COMMENT_DELETE,e&&(this.xml=An(e),this.json=We(e,{addCoordinates:!0}))}run(e){vh.CommentCreateDeleteHelper(this,!e)}toJson(){var e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(this.json)return e.xml=Mn(this.xml),e.json=this.json,e;throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new Eh)).xml=f.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}}),Sh=(i(_.EVENT,y.COMMENT_DELETE,Eh),class extends Ko{constructor(e,t){super(e?e.workspace.id:void 0),this.type=y.COMMENT_DRAG,e&&(this.commentId=e.id,this.isStart=t)}toJson(){var e=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.isStart=this.isStart,e.commentId=this.commentId,e}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new Sh)).isStart=e.isStart,t.commentId=e.commentId,t}}),Ch=(i(_.EVENT,y.COMMENT_DRAG,Sh),class extends vh{constructor(e){super(e),this.type=y.COMMENT_MOVE,e&&(this.comment_=e,this.oldCoordinate_=e.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setReason(e){this.reason=e}setOldCoordinate(e){this.oldCoordinate_=e}toJson(){var e=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(this.newCoordinate_)return e.oldCoordinate=Math.round(this.oldCoordinate_.x)+", "+Math.round(this.oldCoordinate_.y),e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),e;throw Error("The new comment position is undefined. Either call recordNew, or call fromJson")}static fromJson(e,t,r){return t=super.fromJson(e,t,null!=r?r:new Ch),r=e.oldCoordinate.split(","),t.oldCoordinate_=new k(Number(r[0]),Number(r[1])),r=e.newCoordinate.split(","),t.newCoordinate_=new k(Number(r[0]),Number(r[1])),t}isNull(){return k.equals(this.oldCoordinate_,this.newCoordinate_)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(!(e=e?this.newCoordinate_:this.oldCoordinate_))throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");t.moveTo(e)}else console.warn("Can't move non-existent comment: "+this.commentId)}}),wh=(i(_.EVENT,y.COMMENT_MOVE,Ch),class extends vh{constructor(e){super(e),this.type=y.COMMENT_RESIZE,e&&(this.oldSize=e.getSize())}recordCurrentSizeAsNewSize(){if(this.newSize)throw Error("Tried to record the new size of a comment on the same event twice.");var e=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(!(e=e.getCommentById(this.commentId)))throw Error("The comment associated with the comment resize event could not be found");this.newSize=e.getSize()}toJson(){var e=super.toJson();if(!this.oldSize)throw Error("The old comment size is undefined. Either pass a comment to the constructor, or call fromJson");if(this.newSize)return e.oldWidth=Math.round(this.oldSize.width),e.oldHeight=Math.round(this.oldSize.height),e.newWidth=Math.round(this.newSize.width),e.newHeight=Math.round(this.newSize.height),e;throw Error("The new comment size is undefined. Either call recordCurrentSizeAsNewSize, or call fromJson")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new wh)).oldSize=new S(e.oldWidth,e.oldHeight),t.newSize=new S(e.newWidth,e.newHeight),t}isNull(){return S.equals(this.oldSize,this.newSize)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(!(e=e?this.newSize:this.oldSize))throw Error("Either oldSize or newSize is undefined. Either pass a comment to the constructor and call recordCurrentSizeAsNewSize, or call fromJson");t.setSize(e)}else console.warn("Can't resize non-existent comment: "+this.commentId)}}),Ih=(i(_.EVENT,y.COMMENT_RESIZE,wh),class extends Ko{constructor(e,t,r){super(r),this.type=y.TOOLBOX_ITEM_SELECT,this.oldItem=null!=e?e:void 0,this.newItem=null!=t?t:void 0}toJson(){var e=super.toJson();return e.oldItem=this.oldItem,e.newItem=this.newItem,e}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new Ih)).oldItem=e.oldItem,t.newItem=e.newItem,t}}),Ah=(i(_.EVENT,y.TOOLBOX_ITEM_SELECT,Ih),class extends Ip{constructor(e,t,r){super(e),this.oldType=t,this.newType=r,this.type=y.VAR_TYPE_CHANGE}toJson(){var e=super.toJson();if(this.oldType&&this.newType)return e.oldType=this.oldType,e.newType=this.newType,e;throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson")}static fromJson(e,t,r){return(t=super.fromJson(e,t,null!=r?r:new Ah)).oldType=e.oldType,t.newType=e.newType,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldType||!this.newType)throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson");var r=t.getVariableMap().getVariableById(this.varId);r&&(e?t.getVariableMap().changeVariableType(r,this.newType):t.getVariableMap().changeVariableType(r,this.oldType))}}),Dh=(i(_.EVENT,y.VAR_TYPE_CHANGE,Ah),class extends jo{constructor(e){super(),this.isBlank=!0,this.recordUndo=!1,this.type=y.FINISHED_LOADING,this.isBlank=!!e,e&&(this.workspaceId=e.id)}}),C=(i(_.EVENT,y.FINISHED_LOADING,Dh),f.BLOCK_CHANGE$$module$build$src$core$events$events=y.BLOCK_CHANGE,f.BLOCK_CREATE$$module$build$src$core$events$events=y.BLOCK_CREATE,f.BLOCK_DELETE$$module$build$src$core$events$events=y.BLOCK_DELETE,Oh=y.BLOCK_DRAG,f.BLOCK_MOVE$$module$build$src$core$events$events=y.BLOCK_MOVE,Rh=y.BLOCK_FIELD_INTERMEDIATE_CHANGE,Lh=y.BUBBLE_OPEN,t=y.BLOCK_CHANGE,Kh=y.CLICK,zh=y.COMMENT_CHANGE,Wh=y.COMMENT_CREATE,lc=y.COMMENT_DELETE,Xh=y.COMMENT_MOVE,Zh=y.COMMENT_RESIZE,Ku=y.COMMENT_DRAG,Qh=y.BLOCK_CREATE,tm=y.BLOCK_DELETE,cc=y.FINISHED_LOADING,oc=y.BLOCK_MOVE,Ha=y.SELECTED,r=y.THEME_CHANGE,yl=y.TOOLBOX_ITEM_SELECT,ml=y.TRASHCAN_OPEN,bl=y.UI,fo=y.VAR_CREATE,Yd=y.VAR_DELETE,L=y.VAR_RENAME,Xd=y.VIEWPORT_CHANGE,(P={}).Abstract=jo,P.BLOCK_CHANGE=f.BLOCK_CHANGE$$module$build$src$core$events$events,P.BLOCK_CREATE=f.BLOCK_CREATE$$module$build$src$core$events$events,P.BLOCK_DELETE=f.BLOCK_DELETE$$module$build$src$core$events$events,P.BLOCK_DRAG=Oh,P.BLOCK_FIELD_INTERMEDIATE_CHANGE=Rh,P.BLOCK_MOVE=f.BLOCK_MOVE$$module$build$src$core$events$events,P.BUBBLE_OPEN=Lh,P.BUMP_EVENTS=vo,P.BlockBase=dc,P.BlockChange=pc,P.BlockCreate=Su,P.BlockDelete=Nu,P.BlockDrag=fh,P.BlockFieldIntermediateChange=_h,P.BlockMove=yh,P.BubbleOpen=bh,P.BubbleType=Gh,P.CHANGE=t,P.CLICK=Kh,P.COMMENT_CHANGE=zh,P.COMMENT_CREATE=Wh,P.COMMENT_DELETE=lc,P.COMMENT_DRAG=Ku,P.COMMENT_MOVE=Xh,P.COMMENT_RESIZE=Zh,P.CREATE=Qh,P.Click=zo,P.ClickTarget=em,P.CommentBase=vh,P.CommentChange=Th,P.CommentCollapse=kh,P.CommentCreate=xh,P.CommentDelete=Eh,P.CommentDrag=Sh,P.CommentMove=Ch,P.CommentResize=wh,P.DELETE=tm,P.FINISHED_LOADING=cc,P.FinishedLoading=Dh,P.MOVE=oc,P.SELECTED=Ha,P.Selected=Du,P.THEME_CHANGE=r,P.TOOLBOX_ITEM_SELECT=yl,P.TRASHCAN_OPEN=ml,P.ThemeChange=wu,P.ToolboxItemSelect=Ih,P.TrashcanOpen=Op,P.UI=bl,P.UiBase=Ko,P.VAR_CREATE=fo,P.VAR_DELETE=Yd,P.VAR_RENAME=L,P.VIEWPORT_CHANGE=Xd,P.VarBase=Ip,P.VarCreate=Ap,P.VarDelete=Dp,P.VarRename=Np,P.VarTypeChange=Ah,P.ViewportChange=Iu,P.clearPendingUndo=$,P.disable=f.disable$$module$build$src$core$events$utils,P.disableOrphans=G,P.enable=f.enable$$module$build$src$core$events$utils,P.filter=B,P.fire=m,P.fromJson=H,P.get=g,P.getDescendantIds=V,P.getGroup=f.getGroup$$module$build$src$core$events$utils,P.getRecordUndo=ca,P.isEnabled=U,P.setGroup=f.setGroup$$module$build$src$core$events$utils,P.setRecordUndo=f.setRecordUndo$$module$build$src$core$events$utils,{}),jo=(C.BottomRow=rh,C.ConstantProvider=Zp,C.Drawer=Qp,C.PathObject=oh,C.RenderInfo=ah,C.Renderer=lh,C.RightConnectionShape=ih,C.StatementInput=nh,C.TopRow=sh,ra(),{}),Nh=(jo.registerCleanup=Ls,jo.registerCollapse=Ms,jo.registerCollapseExpandBlock=zs,jo.registerComment=js,jo.registerCommentCreate=Zs,jo.registerCommentDelete=Ys,jo.registerCommentDuplicate=Xs,jo.registerCommentOptions=ta,jo.registerDefaultOptions=ra,jo.registerDelete=qs,jo.registerDeleteAll=Vs,jo.registerDisable=Ws,jo.registerDuplicate=Gs,jo.registerExpand=Fs,jo.registerHelp=Js,jo.registerInline=Ks,jo.registerRedo=Rs,jo.registerUndo=Os,"button"),Oh=class{load(e,t){return(e=new yd(t.getWorkspace(),t.targetWorkspace,e,!1)).show(),new gd(e,Nh)}gapForItem(e,t){return t}disposeItem(e){(e=e.getElement())instanceof yd&&e.dispose()}getType(){return Nh}},Rh=(i(_.FLYOUT_INFLATER,Nh,Oh),{}),Lh=(Rh.Bubble=D,Rh.MiniWorkspaceBubble=Uu,Rh.TextBubble=dd,Rh.TextInputBubble=Kd,class{constructor(){this.permanentlyDisabledBlocks=new Set,this.listeners=new Map,this.capacityWrapper=this.filterFlyoutBasedOnCapacity.bind(this)}load(e,t){return this.setFlyout(t),(e=this.createBlock(e,t.getWorkspace())).isEnabled()?this.updateStateBasedOnCapacity(e):this.permanentlyDisabledBlocks.add(e),e.getDescendants(!1).forEach(e=>e.isInFlyout=!0),this.addBlockListeners(e),new gd(e,"block")}createBlock(e,t){return t=(e.blockxml?(e="string"==typeof e.blockxml?f.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,Bn):(void 0===e.enabled&&(e.enabled="true"!==e.disabled&&!0!==e.disabled),void 0===e.disabledReasons&&!1===e.enabled&&(e.disabledReasons=[Il]),"x"in e&&delete e.x,"y"in e&&delete e.y,zt))(e,t)}gapForItem(e,t){let r;return e.gap?r=parseInt(String(e.gap)):e.blockxml&&(e="string"==typeof e.blockxml?f.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,r=parseInt(e.getAttribute("gap"))),!r||isNaN(r)?t:r}disposeItem(e){(e=e.getElement())instanceof O&&(this.removeListeners(e.id),e.dispose(!1,!1))}removeListeners(e){var t;(null!=(t=this.listeners.get(e))?t:[]).forEach(e=>s(e)),this.listeners.delete(e)}setFlyout(e){var t;this.flyout!==e&&(this.flyout&&null!=(t=this.flyout.targetWorkspace)&&t.removeChangeListener(this.capacityWrapper),this.flyout=e,null!=(t=this.flyout.targetWorkspace))&&t.addChangeListener(this.capacityWrapper)}updateStateBasedOnCapacity(e){for(var t,r=null==(t=this.flyout)||null==(t=t.targetWorkspace)?void 0:t.isCapacityAvailable(pe(e));e;)e.setDisabledReason(!r,"WORKSPACE_AT_BLOCK_CAPACITY"),e=e.getNextBlock()}addBlockListeners(r){var e=[];e.push(h(r.getSvgRoot(),"pointerdown",r,e=>{var t=null==(t=this.flyout)||null==(t=t.targetWorkspace)?void 0:t.getGesture(e);t&&this.flyout&&(t.setStartBlock(r),t.handleFlyoutStart(e,this.flyout))})),e.push(Ta(r.getSvgRoot(),"pointermove",null,()=>{var e;null!=(e=this.flyout)&&null!=(e=e.targetWorkspace)&&e.isDragging()||r.addSelect()})),e.push(Ta(r.getSvgRoot(),"pointerleave",null,()=>{var e;null!=(e=this.flyout)&&null!=(e=e.targetWorkspace)&&e.isDragging()||r.removeSelect()})),this.listeners.set(r.id,e)}filterFlyoutBasedOnCapacity(e){!this.flyout||e&&e.type!==y.BLOCK_CREATE&&e.type!==y.BLOCK_DELETE||this.flyout.getWorkspace().getTopBlocks(!1).forEach(e=>{this.permanentlyDisabledBlocks.has(e)||this.updateStateBasedOnCapacity(e)})}getType(){return"block"}}),Ph=(i(_.FLYOUT_INFLATER,"block",Lh),class extends yp{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(e){return super.getCSS_(e).concat([e+" .blocklyInsertionMarker>.blocklyPathLight,",e+" .blocklyInsertionMarker>.blocklyPathDark {",`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}}),Mh=class{constructor(e){this.inlineSteps_=this.steps_="",this.info_=e,this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+"\n"+this.inlineSteps_}drawTopCorner(r){this.steps_+=di(r.xPos,this.info_.startY);for(let e=0,t;t=r.elements[e];e++)R.isLeftSquareCorner(t)?this.steps_+=this.highlightConstants_.START_POINT:R.isLeftRoundedCorner(t)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):R.isPreviousConnection(t)?this.steps_+=this.notchPaths_.pathLeft:R.isHat(t)?this.steps_+=this.startPaths_.path(this.RTL_):R.isSpacer(t)&&0!==t.width&&(this.steps_+=d("H",t.xPos+t.width-this.highlightOffset));this.steps_+=d("H",r.xPos+r.width-this.highlightOffset)}drawJaggedEdge_(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+d("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(e){var t,r=e.getLastInput();this.RTL_?(t=e.height-r.connectionHeight,this.steps_+=ui(r.xPos+r.width-this.highlightOffset,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+d("v",t)):this.steps_+=ui(r.xPos+r.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(e){var t,r=e.getLastInput();r&&(this.RTL_?(t=e.height-2*this.insideCornerPaths_.height,this.steps_+=ui(r.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+d("v",t)+this.insideCornerPaths_.pathBottom(this.RTL_)+pi(e.width-r.xPos-this.insideCornerPaths_.width,0)):this.steps_+=ui(r.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+pi(e.width-r.xPos-this.insideCornerPaths_.width,0))}drawRightSideRow(e){var t=e.xPos+e.width-this.highlightOffset;e instanceof mp&&e.followsStatement&&(this.steps_+=d("H",t)),this.RTL_&&(this.steps_+=d("H",t),e.height>this.highlightOffset)&&(this.steps_+=d("V",e.yPos+e.height-this.highlightOffset))}drawBottomRow(e){var t;this.RTL_?this.steps_+=d("V",e.baseline-this.highlightOffset):(t=this.info_.bottomRow.elements[0],R.isLeftSquareCorner(t)?this.steps_+=ui(e.xPos+this.highlightOffset,e.baseline-this.highlightOffset):R.isLeftRoundedCorner(t)&&(this.steps_+=ui(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft()))}drawLeft(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=ui(this.info_.startX,e):(this.steps_+=ui(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=d("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(e=this.info_.topRow,R.isLeftRoundedCorner(e.elements[0])?this.steps_+=d("V",this.outsideCornerPaths_.height):this.steps_+=d("V",e.capline+this.highlightOffset))}drawInlineInput(e){var t=this.highlightOffset,r=e.xPos+e.connectionWidth,n=e.centerline-e.height/2,i=e.width-e.connectionWidth,s=n+t;this.RTL_?(n=e.connectionOffsetY-t,e=e.height-(e.connectionOffsetY+e.connectionHeight)+t,this.inlineSteps_+=ui(r-t,s)+d("v",n)+this.puzzleTabPaths_.pathDown(this.RTL_)+d("v",e)+d("h",i)):this.inlineSteps_+=ui(e.xPos+e.width+t,s)+d("v",e.height)+d("h",-i)+ui(r,n+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},Fh=class extends bp{constructor(e,t){super(e,t),this.highlighter_=new Mh(t)}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights();var e=this.block_.pathObject;e.setPath(this.outlinePath_+"\n"+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(e){this.highlighter_.drawJaggedEdge_(e),super.drawJaggedEdge_(e)}drawValueInput_(e){this.highlighter_.drawValueInput(e),super.drawValueInput_(e)}drawStatementInput_(e){this.highlighter_.drawStatementInput(e),super.drawStatementInput_(e)}drawRightSideRow_(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=d("H",e.xPos+e.width)+d("V",e.yPos+e.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(e){this.highlighter_.drawInlineInput(e),super.drawInlineInput_(e)}positionInlineInputConnection_(t){var r=t.centerline-t.height/2;if(t.connectionModel){let e=t.xPos+t.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(e*=-1),t.connectionModel.setOffsetInBlock(e,r+t.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(e){var t,r=e.getLastInput();null!=r&&r.connectionModel&&(t=e.xPos+e.statementEdge+r.notchOffset,t=this.info_.RTL?-1*t:t+this.constants_.DARK_PATH_OFFSET,r.connectionModel.setOffsetInBlock(t,e.yPos+this.constants_.DARK_PATH_OFFSET))}positionExternalValueConnection_(t){var r=t.getLastInput();if(r&&r.connectionModel){let e=t.xPos+t.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(e*=-1),r.connectionModel.setOffsetInBlock(e,t.yPos)}}positionNextConnection_(){var e,t,r=this.info_.bottomRow;r.connection&&(t=(e=r.connection).xPos,e.connectionModel.setOffsetInBlock((this.info_.RTL?-t:t)+this.constants_.DARK_PATH_OFFSET/2,r.baseline+this.constants_.DARK_PATH_OFFSET))}},Bh=class{constructor(e){this.OFFSET=.5,this.constantProvider=e,this.START_POINT=di(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){let e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,r=(1-Math.SQRT1_2)*(e+t)-t,n=di(r,r)+mi("a","0 0,0",e,u(-r-t,e-r)),i=mi("a","0 0,0",e+t,u(e+t,e+t)),s=di(r,-r)+mi("a","0 0,0",e+t,u(e-r,r+t));return{width:e+t,height:e,pathTop(e){return e?n:""},pathBottom(e){return e?i:s}}}makeOutsideCorner(){let e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,r=(1-Math.SQRT1_2)*(e-t)+t,n=di(r,r)+mi("a","0 0,1",e-t,u(e-r,-r+t)),i=di(t,e)+mi("a","0 0,1",e-t,u(e,-e+t)),s=-r,a=di(r,s)+mi("a","0 0,1",e-t,u(-r+t,-s-e));return{height:e,topLeft(e){return e?n:i},bottomLeft(){return a}}}makePuzzleTab(){let e=this.constantProvider.TAB_WIDTH,t=this.constantProvider.TAB_HEIGHT,r=di(-2,2.5-t+.9)+pi(-.45*e,-2.1),n=" v 2.5 "+di(.97*-e,2.5)+ci("q",[u(.05*-e,10),u(.3*e,9.5)])+di(.67*e,-1.9)+" v 2.5 ",i=" v -1.5 "+di(-.92*e,-.5)+ci("q",[u(-.19*e,-5.5)," 0,-11 "])+di(.92*e,1),s=di(-5,t-.7)+pi(.46*e,-2.1);return{width:e,height:t,pathUp(e){return e?r:i},pathDown(e){return e?n:s}}}makeNotch(){return{pathLeft:d("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:" l 5.1,2.6  m -10.2,6.8  l 5.1,2.6 ",height:12,width:10.2}}makeStartHat(){let e=this.constantProvider.START_HAT.height,t=di(25,-8.7)+ci("c",[" 29.7,-6.2 "," 57.2,-0.5 "," 75,8.7 "]),r=ci("c",[" 17.8,-9.2 "," 45.3,-14.9 "," 75,-8.7 "])+ui(100.5,e+.5);return{path(e){return e?t:r}}}},$h=class extends op{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},Uh=class extends fp{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},Vh=class extends vp{constructor(e,t){super(e,t),this.renderer_=e}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof nd||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(e,t){this.isInline&&e instanceof f.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new $h(this.constants_,e)),t.hasInlineInput=!0):e instanceof nd?(t.elements.push(new Uh(this.constants_,e)),t.hasStatement=!0):e instanceof f.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new rp(this.constants_,e)),t.hasExternalInput=!0):(e instanceof td||e instanceof rd)&&(t.minHeight=Math.max(t.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),this.isInline||null!==t.align||(t.align=e.align)}addElemSpacing_(){let r=!1;for(let e=0,t;t=this.rows[e];e++)t.hasExternalInput&&(r=!0);for(let e=0,t;t=this.rows[e];e++){var n=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new ap(this.constants_,this.getInRowSpacing_(null,n[0]))),n.length){for(let e=0;e<n.length-1;e++){t.elements.push(n[e]);var i=this.getInRowSpacing_(n[e],n[e+1]);t.elements.push(new ap(this.constants_,i))}t.elements.push(n[n.length-1]),t.endsWithElemSpacer()&&(n=this.getInRowSpacing_(n[n.length-1],null),r&&t.hasDummyInput&&(n+=this.constants_.TAB_WIDTH),t.elements.push(new ap(this.constants_,n)))}}}getInRowSpacing_(e,t){if(!e)return t&&R.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&R.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&R.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!R.isInput(e)&&(!t||R.isStatementInput(t)))return R.isField(e)&&e.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:R.isIcon(e)?2*this.constants_.LARGE_PADDING+1:R.isHat(e)?this.constants_.NO_PADDING:R.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:R.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:R.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(R.isInput(e)&&!t){if(R.isExternalInput(e))return this.constants_.NO_PADDING;if(R.isInlineInput(e))return this.constants_.LARGE_PADDING;if(R.isStatementInput(e))return this.constants_.NO_PADDING}if(!R.isInput(e)&&t&&R.isInput(t)){if(R.isField(e)&&e.isEditable){if(R.isInlineInput(t)||R.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(R.isInlineInput(t)||R.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(R.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(R.isIcon(e)&&t&&!R.isInput(t))return this.constants_.LARGE_PADDING;if(R.isInlineInput(e)&&t&&R.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(R.isLeftSquareCorner(e)&&t){if(R.isHat(t))return this.constants_.NO_PADDING;if(R.isPreviousConnection(t))return t.notchOffset;if(R.isNextConnection(t))return t.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(R.isLeftRoundedCorner(e)&&t){if(R.isPreviousConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS;if(R.isNextConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return R.isField(e)&&t&&R.isField(t)&&e.isEditable===t.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:t&&R.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return R.isTopRow(e)&&R.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:R.isTopRow(e)||R.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||!e.hasStatement&&t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(R.isSpacer(t))return e.yPos+t.height/2;if(R.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,R.isNextConnection(t)?e+t.height/2:e-t.height/2;if(R.isTopRow(e))return R.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let r=e.yPos;return R.isField(t)||R.isIcon(t)?(r+=t.height/2,(e.hasInlineInput||e.hasStatement)&&t.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(r+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):r=R.isInlineInput(t)?r+t.height/2:r+e.height/2,r}alignRowElements_(){if(this.isInline){var r=0,n=new WeakMap,i=null;for(let e=this.rows.length-1,t;t=this.rows[e];e--)n.set(t,r),R.isInputRow(t)&&(t.hasStatement&&this.alignStatementRow_(t),i&&i.hasStatement&&t.width<i.width?n.set(t,i.width):r=t.hasStatement?t.width:Math.max(r,t.width),i=t);for(let e=r=0,t;t=this.rows[e];e++)t.hasStatement?r=this.getDesiredRowWidth_(t):R.isSpacer(t)?t.width=Math.max(r,n.get(t)):(i=t.width,0<(r=Math.max(r,n.get(t))-i)&&this.addAlignmentPadding_(t,r),r=t.width)}else super.alignRowElements_()}getDesiredRowWidth_(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(e)}finalize_(){let r=0,n=0;for(let e=0,t;t=this.rows[e];e++){t.yPos=n,t.xPos=this.startX,n+=t.height,r=Math.max(r,t.widthWithConnectedBlocks);var i=n-this.topRow.ascenderHeight;t===this.bottomRow&&i<this.constants_.MIN_BLOCK_HEIGHT&&(i=this.constants_.MIN_BLOCK_HEIGHT-i,this.bottomRow.height+=i,n+=i),this.recordElemPositions_(t)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(i=this.block_.nextConnection.targetBlock())&&(r=Math.max(r,i.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=n-this.bottomRow.descenderHeight,this.widthWithChildren=r+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=n+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},Hh=class extends Tp{constructor(e,t,r){super(e,t,r),this.constants=r,this.colourDark="#000000",this.svgPathDark=l(x.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=l(x.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)}setHighlightPath(e){this.svgPathLight.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(e){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(e),this.svgPath.setAttribute("stroke","none")}setStyle(e){this.style=e,this.colourDark=Qr("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(e){super.updateHighlighted(e),this.svgPathLight.style.display=e?"none":"inline"}updateShadow_(e){if(e){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(e){super.updateDisabled_(e),e&&this.svgPath.setAttribute("stroke","none")}},Gh=class extends Jc{constructor(e){super(e),this.highlightConstants=null}init(e,t){super.init(e,t),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(e,t,r){super.refreshDom(e,t,r),this.getHighlightConstants().init()}makeConstants_(){return new Ph}makeRenderInfo_(e){return new Vh(this,e)}makeDrawer_(e,t){return new Fh(e,t)}makePathObject(e,t){return new Hh(e,t,this.getConstants())}makeHighlightConstants_(){return new Bh(this.getConstants())}getHighlightConstants(){if(this.highlightConstants)return this.highlightConstants;throw Error("Cannot access the highlight constants because init has not been called")}},t=(rs("geras",Gh),{}),jh=(t.ConstantProvider=Ph,t.Drawer=Fh,t.HighlightConstantProvider=Bh,t.Highlighter=Mh,t.InlineInput=$h,t.PathObject=Hh,t.RenderInfo=Vh,t.Renderer=Gh,t.StatementInput=Uh,class extends vp{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}addElemSpacing_(){let e=!1;for(var t=0;t<this.rows.length;t++)if(this.rows[t].hasExternalInput){e=!0;break}for(t=0;t<this.rows.length;t++){var r=this.rows[t],n=r.elements;if(r.elements=[],r.startsWithElemSpacer()&&r.elements.push(new ap(this.constants_,this.getInRowSpacing_(null,n[0]))),n.length){for(let e=0;e<n.length-1;e++){r.elements.push(n[e]);var i=this.getInRowSpacing_(n[e],n[e+1]);r.elements.push(new ap(this.constants_,i))}r.elements.push(n[n.length-1]),r.endsWithElemSpacer()&&(n=this.getInRowSpacing_(n[n.length-1],null),e&&r.hasDummyInput&&(n+=this.constants_.TAB_WIDTH),r.elements.push(new ap(this.constants_,n)))}}}getInRowSpacing_(e,t){if(!e)return t&&R.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&R.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&R.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!R.isInput(e)&&!t)return R.isField(e)&&e.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:R.isIcon(e)?2*this.constants_.LARGE_PADDING+1:R.isHat(e)?this.constants_.NO_PADDING:R.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:R.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:R.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(R.isInput(e)&&!t){if(R.isExternalInput(e))return this.constants_.NO_PADDING;if(R.isInlineInput(e))return this.constants_.LARGE_PADDING;if(R.isStatementInput(e))return this.constants_.NO_PADDING}if(!R.isInput(e)&&t&&R.isInput(t)){if(R.isField(e)&&e.isEditable){if(R.isInlineInput(t)||R.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(R.isInlineInput(t)||R.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(R.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(R.isIcon(e)&&t&&!R.isInput(t))return this.constants_.LARGE_PADDING;if(R.isInlineInput(e)&&t&&R.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(R.isLeftSquareCorner(e)&&t){if(R.isHat(t))return this.constants_.NO_PADDING;if(R.isPreviousConnection(t)||R.isNextConnection(t))return t.notchOffset}return R.isLeftRoundedCorner(e)&&t?t.notchOffset-this.constants_.CORNER_RADIUS:R.isField(e)&&t&&R.isField(t)&&e.isEditable===t.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:t&&R.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return R.isTopRow(e)&&R.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:R.isTopRow(e)||R.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){var r;return R.isSpacer(t)?e.yPos+t.height/2:R.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,R.isNextConnection(t)?e+t.height/2:e-t.height/2):R.isTopRow(e)?R.isHat(t)?e.capline-t.height/2:e.capline+t.height/2:(r=e.yPos,R.isField(t)&&e.hasStatement?r+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+t.height/2):r+e.height/2)}finalize_(){let e=0,t=0;for(var r=0;r<this.rows.length;r++){var n=this.rows[r],i=(n.yPos=t,n.xPos=this.startX,t+=n.height,e=Math.max(e,n.widthWithConnectedBlocks),t-this.topRow.ascenderHeight);n===this.bottomRow&&i<this.constants_.MIN_BLOCK_HEIGHT&&(i=this.constants_.MIN_BLOCK_HEIGHT-i,this.bottomRow.height+=i,t+=i),this.recordElemPositions_(n)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(r=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,r.getHeightWidth().width)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline}}),Kh=class extends Jc{constructor(e){super(e)}makeRenderInfo_(e){return new jh(this,e)}},zh=(rs("thrasos",Kh),{}),Wh=(zh.RenderInfo=jh,zh.Renderer=Kh,new Pu("zelos",{colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},{colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}})),lc={Classic:Mu,Zelos:Wh},Ku=class{constructor(e,t,r){this.id_=e.toolboxitemid||Ca(),this.level_=(this.parent_=r||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=t,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(e){}getFocusableElement(){var e=this.getDiv();if(!e)throw Error("Trying to access toolbox item before DOM is initialized.");if(e instanceof HTMLElement)return e;throw Error("Toolbox item div is unexpectedly not an HTML element.")}getFocusableTree(){return this.parentToolbox_}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}},qh=class extends Ku{constructor(e,t,r){super(e,t,r),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),"true"===this.toolboxItemDef_.hidden&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategoryContainer",row:"blocklyToolboxCategory",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyToolboxCategoryIcon",label:"blocklyToolboxCategoryLabel",contents:"blocklyToolboxCategoryGroup",selected:"blocklyToolboxSelected",openicon:"blocklyToolboxCategoryIconOpen",closedicon:"blocklyToolboxCategoryIconClosed"}}parseContents_(t){if("custom"in t)this.flyoutItems_=t.custom;else if(t=t.contents)for(let e=0;e<t.length;e++){var r=t[e];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(r)}}parseCategoryDef_(e){this.name_="name"in e?nn(e.name):"",this.colour_=this.getColour_(e),Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),Xe(this.htmlDiv_,to.TREEITEM),Ze(this.htmlDiv_,ro.SELECTED,!1),Ze(this.htmlDiv_,ro.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),Xe(this.iconDom_,to.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);var e=this.labelDom_.getAttribute("id");return e&&Ze(this.htmlDiv_,ro.LABELLEDBY,e),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){var e=document.createElement("div"),t=(e.tabIndex=-1,e.id=this.getId(),this.cssConfig_.container);return t&&c(e,t),e}createRowContainer_(){var e=document.createElement("div"),t=this.cssConfig_.row;return t&&c(e,t),t=qh.nestedPadding*this.getLevel()+"px",this.workspace_.RTL?e.style.paddingRight=t:e.style.paddingLeft=t,e}createRowContentsContainer_(){var e=document.createElement("div"),t=this.cssConfig_.rowcontentcontainer;return t&&c(e,t),e}createIconDom_(){var e,t=document.createElement("span");return this.parentToolbox_.isHorizontal()||(e=this.cssConfig_.icon)&&c(t,e),t.style.display="inline-block",t}createLabelDom_(e){var t=document.createElement("span");return t.setAttribute("id",this.getId()+".label"),t.textContent=e,(e=this.cssConfig_.label)&&c(t,e),t}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(e){e&&(e=qh.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)}getColour_(e){var t=e.categorystyle||e.categoryStyle;if((e=e.colour)&&t)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(t)return this.getColourfromStyle(t);if(e)return this.parseColour(e)}return""}getColourfromStyle(e){var t=this.workspace_.getTheme();if(e&&t){if((t=t.categoryStyles[e])&&t.colour)return this.parseColour(t.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour(e){var t;return null==(e=nn(e))||""===e?"":(t=Number(e),isNaN(t)?(t=Jr(e))||(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):en(t))}openIcon_(e){var t;e&&((t=this.cssConfig_.closedicon)&&j(e,t),t=this.cssConfig_.openicon)&&c(e,t)}closeIcon_(e){var t;e&&((t=this.cssConfig_.openicon)&&j(e,t),t=this.cssConfig_.closedicon)&&c(e,t)}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let e=this;for(;e.getParent();)if(!(e=e.getParent()).isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(e){}setSelected(e){var t,r;this.rowDiv_&&(t=this.cssConfig_.selected,e?(r=this.parseColour(qh.defaultBackgroundColour),this.rowDiv_.style.backgroundColor=this.colour_||r,t&&c(this.rowDiv_,t)):(this.rowDiv_.style.backgroundColor="",t&&a(this.rowDiv_,t)),Ze(this.htmlDiv_,ro.SELECTED,e))}setDisabled(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled",""+e),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(e){this.flyoutItems_=[],this.toolboxItemDef_="string"==typeof e?{kind:this.toolboxItemDef_.kind,custom:e,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:Fe(e),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){o(this.htmlDiv_)}},Jh=(qh.registrationName="category",qh.nestedPadding=19,qh.borderWidth=8,qh.defaultBackgroundColour="#57e",_e('\n.blocklyToolboxCategory:not(.blocklyToolboxSelected):hover {\n  background-color: rgba(255, 255, 255, .2);\n}\n\n.blocklyToolbox[layout="h"] .blocklyToolboxCategoryContainer {\n  margin: 1px 5px 1px 0;\n}\n\n.blocklyToolbox[dir="RTL"][layout="h"] .blocklyToolboxCategoryContainer {\n  margin: 1px 0 1px 5px;\n}\n\n.blocklyToolboxCategory {\n  height: 22px;\n  line-height: 22px;\n  margin-bottom: 3px;\n  padding-right: 8px;\n  white-space: nowrap;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxCategory {\n  margin-left: 8px;\n  padding-right: 0;\n}\n\n.blocklyToolboxCategoryIcon {\n  background-image: url(<<<PATH>>>/sprites.png);\n  height: 16px;\n  vertical-align: middle;\n  visibility: hidden;\n  width: 16px;\n}\n\n.blocklyToolboxCategoryIconClosed {\n  background-position: -32px -1px;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxCategoryIconClosed {\n  background-position: 0 -1px;\n}\n\n.blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {\n  background-position: -32px -17px;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {\n  background-position: 0 -17px;\n}\n\n.blocklyToolboxCategoryIconOpen {\n  background-position: -16px -1px;\n}\n\n.blocklyToolboxSelected>.blocklyToolboxCategoryIconOpen {\n  background-position: -16px -17px;\n}\n\n.blocklyToolboxCategoryLabel {\n  cursor: default;\n  font: 16px sans-serif;\n  padding: 0 3px;\n  vertical-align: middle;\n}\n\n.blocklyToolboxDelete .blocklyToolboxCategoryLabel {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxSelected .blocklyToolboxCategoryLabel {\n  color: #fff;\n}\n'),i(_.TOOLBOX_ITEM,qh.registrationName,qh),class extends Ku{constructor(e,t){super(e,t),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv=null,Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}init(){this.createDom_()}createDom_(){var e=document.createElement("div"),t=(e.tabIndex=-1,e.id=this.getId(),this.cssConfig_.container);return t&&c(e,t),this.htmlDiv=e}getDiv(){return this.htmlDiv}dispose(){o(this.htmlDiv)}}),Yh=(Jh.registrationName="sep",_e('\n.blocklyTreeSeparator {\n  border-bottom: solid #e5e5e5 1px;\n  height: 0;\n  margin: 5px 0;\n}\n\n.blocklyToolbox[layout="h"] .blocklyTreeSeparator {\n  border-right: solid #e5e5e5 1px;\n  border-bottom: none;\n  height: auto;\n  margin: 0 5px 0 5px;\n  padding: 5px 0;\n  width: 0;\n}\n'),i(_.TOOLBOX_ITEM,Jh.registrationName,Jh),class extends qh{constructor(e,t,r){super(e,t,r),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){var e=super.makeDefaultCssConfig_();return e.contents="blocklyToolboxCategoryGroup",e}parseContents_(t){if("custom"in t)this.flyoutItems_=t.custom;else{var r=t.contents;if(r){this.flyoutItems_=[],t=!0;for(let e=0;e<r.length;e++){var n=r[e];t=!ua(_.TOOLBOX_ITEM,n.kind)||n.kind.toLowerCase()===Jh.registrationName&&t?(this.flyoutItems_.push(n),!0):(this.createToolboxItem(n),!1)}}}}createToolboxItem(e){let t=e.kind;"CATEGORY"===t.toUpperCase()&&$e(e)&&(t=Yh.registrationName),e=new(da(_.TOOLBOX_ITEM,t))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)}init(){super.init(),this.setExpanded("true"===this.toolboxItemDef_.expanded||!0===this.toolboxItemDef_.expanded)}createDom_(){super.createDom_();var e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),Xe(this.subcategoriesDiv_,to.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),Ze(this.htmlDiv_,ro.EXPANDED,!1),this.htmlDiv_}createIconDom_(){var e,t=document.createElement("span");return this.parentToolbox_.isHorizontal()||((e=this.cssConfig_.icon)&&c(t,e),t.style.visibility="visible"),t.style.display="inline-block",t}createSubCategoriesDom_(e){var t=document.createElement("div"),r=(t.style.display="none",this.cssConfig_.contents);for(r&&c(t,r),r=0;r<e.length;r++){var n=e[r],i=(n.init(),n.getDiv());t.appendChild(i),n.getClickTarget&&null!=(i=n.getClickTarget())&&i.setAttribute("id",n.getId())}return t}setExpanded(e){var t;this.expanded_!==e&&((this.expanded_=e)?(this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_)):(null!=(t=this.parentToolbox_.getFlyout())&&t.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)),Ze(this.htmlDiv_,ro.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize())}setVisible_(t){this.htmlDiv_.style.display=t?"block":"none";var r=this.getChildToolboxItems();for(let e=0;e<r.length;e++)r[e].setVisible_(t);this.isHidden_=!t,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(e){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}}),Xh=(Yh.registrationName="collapsibleCategory",i(_.TOOLBOX_ITEM,Yh.registrationName,Yh),class extends md{constructor(e){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.height_=this.width_=0,this.flyout=null,this.contents=new Map,this.previouslySelectedItem_=this.selectedItem_=null,this.boundEvents_=[],this.workspace_=e,this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout=e.options.horizontalLayout,this.RTL=e.options.RTL,this.toolboxPosition=e.options.toolboxPosition}onShortcut(e){return!1}init(){var e=this.workspace_,t=e.getParentSvg(),r=(this.flyout=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),this.flyout.createDom("svg"));c(r,"blocklyToolboxFlyout"),z(r,t),this.setVisible(!0),this.flyout.init(e),this.render(this.toolboxDef_),(e=e.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:Jo.ComponentWeight.TOOLBOX_WEIGHT,capabilities:[Jo.Capability.AUTOHIDEABLE,Jo.Capability.DELETE_AREA,Jo.Capability.DRAG_TARGET]}),f.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!0)}createDom_(e){e=e.getParentSvg();var t=this.createContainer_();return t.id=Ca(),this.contentsDiv_=this.createContentsContainer_(),Xe(this.contentsDiv_,to.TREE),t.appendChild(this.contentsDiv_),e.parentNode.insertBefore(t,e),this.attachEvents_(t,this.contentsDiv_),t}createContainer_(){var e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),c(e,"blocklyToolbox"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e}createContentsContainer_(){var e=document.createElement("div");return c(e,"blocklyToolboxCategoryGroup"),this.isHorizontal()&&(e.style.flexDirection="row"),e}attachEvents_(e,t){e=h(e,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(e),t=h(t,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(t)}onClick_(e){var t;xa(e)||e.target===this.HtmlDiv?Ya.hideChaff(!1):((t=e.target.getAttribute("id"))&&(t=this.getToolboxItemById(t)).isSelectable()&&(this.setSelectedItem(t),t.onClick(e)),Ya.hideChaff(!0)),_a()}onKeyDown_(e){let t=!1;switch(e.key){case"ArrowDown":t=this.selectNext();break;case"ArrowUp":t=this.selectPrevious();break;case"ArrowLeft":t=this.selectParent();break;case"ArrowRight":t=this.selectChild();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),t=!0);break;default:t=!1}(t=!t&&this.selectedItem_&&this.selectedItem_.onKeyDown?this.selectedItem_.onKeyDown(e):t)&&e.preventDefault()}createFlyout_(){var e=this.workspace_,t=e.copyOptionsForFlyout();return t.toolboxPosition=e.options.toolboxPosition,new(e.horizontalLayout?ma(_.FLYOUTS_HORIZONTAL_TOOLBOX,e.options,!0):ma(_.FLYOUTS_VERTICAL_TOOLBOX,e.options,!0))(t)}render(e){this.toolboxDef_=e,this.contents.forEach(e=>e.dispose()),this.contents.clear(),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()}renderContents_(t){var r=document.createDocumentFragment();for(let e=0;e<t.length;e++)this.createToolboxItem(t[e],r);this.contentsDiv_.appendChild(r)}createToolboxItem(e,t){var r=e.kind;"CATEGORY"===r.toUpperCase()&&$e(e)&&(r=Yh.registrationName),(r=da(_.TOOLBOX_ITEM,r.toLowerCase()))&&((e=new r(e,this)).init(),this.addToolboxItem_(e),(r=e.getDiv())&&t.appendChild(r),e.getClickTarget())&&e.getClickTarget().setAttribute("id",e.getId())}addToolboxItem_(t){if(this.contents.set(t.getId(),t),t.isCollapsible()){t=t.getChildToolboxItems();for(let e=0;e<t.length;e++)this.addToolboxItem_(t[e])}}getToolboxItems(){return[...this.contents.values()]}addStyle(e){e&&this.HtmlDiv&&c(this.HtmlDiv,e)}removeStyle(e){e&&this.HtmlDiv&&a(this.HtmlDiv,e)}getClientRect(){var e,t,r,n;return this.HtmlDiv&&this.isVisible_?(t=(e=(n=this.HtmlDiv.getBoundingClientRect()).top)+n.height,n=(r=n.left)+n.width,this.toolboxPosition===b.TOP?new E(-1e7,t,-1e7,1e7):this.toolboxPosition===b.BOTTOM?new E(e,1e7,-1e7,1e7):this.toolboxPosition===b.LEFT?new E(-1e7,1e7,-1e7,n):new E(-1e7,1e7,r,1e7)):null}wouldDelete(e){return e instanceof O?this.updateWouldDelete_(!e.getParent()&&e.isDeletable()):this.updateWouldDelete_(Ri(e)&&e.isDeletable()),this.wouldDelete_}onDragEnter(e){this.updateCursorDeleteStyle_(!0)}onDragExit(e){this.updateCursorDeleteStyle_(!1)}onDrop(e){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=e,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(e){var t=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(t):this.removeStyle(t)}getToolboxItemById(e){return this.contents.get(e)||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout}position(){var e=this.workspace_.getMetrics(),t=this.HtmlDiv;t&&(this.horizontalLayout?(t.style.left="0",t.style.height="auto",t.style.width="100%",this.height_=t.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition===b.TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition===b.RIGHT?t.style.right="0":t.style.left="0",t.style.height="100%",this.width_=t.offsetWidth,this.height_=e.viewHeight),this.flyout.position())}handleToolboxItemResize(){var e=this.workspace_,t=this.HtmlDiv.getBoundingClientRect(),r=this.getFlyout(),n=this.toolboxPosition===b.LEFT?e.scrollX+t.width+(null!=r&&r.isVisible()?r.getWidth():0):e.scrollX,t=this.toolboxPosition===b.TOP?e.scrollY+t.height+(null!=r&&r.isVisible()?r.getHeight():0):e.scrollY;e.translate(n,t),de(e)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){this.contents.forEach(e=>{e.refreshTheme&&e.refreshTheme()})}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout.show(this.selectedItem_.getContents())}setVisible(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.flyout.autoClose&&this.clearSelection()}setSelectedItem(e){var t=this.selectedItem_;!e&&!t||e&&!sa(e)||(this.shouldDeselectItem_(t,e)&&null!==t&&this.deselectItem_(t),this.shouldSelectItem_(t,e)&&null!==e&&this.selectItem_(t,e),this.updateFlyout_(t,e),this.fireSelectEvent(t,e))}shouldDeselectItem_(e,t){return null!==e&&(!e.isCollapsible()||e!==t)}shouldSelectItem_(e,t){return null!==t&&t!==e}deselectItem_(e){this.selectedItem_=null,(this.previouslySelectedItem_=e).setSelected(!1),Ze(this.contentsDiv_,ro.ACTIVEDESCENDANT,"")}selectItem_(e,t){this.selectedItem_=t,this.previouslySelectedItem_=e,t.setSelected(!0),Ze(this.contentsDiv_,ro.ACTIVEDESCENDANT,t.getId())}selectItemByPosition(e){(e=this.getToolboxItems()[e])&&this.setSelectedItem(e)}updateFlyout_(e,t){t&&(e!==t||t.isCollapsible())&&t.getContents().length?(this.flyout.show(t.getContents()),this.flyout.scrollToStart()):this.flyout.hide()}fireSelectEvent(e,t){var r=e&&e.getName();let n=t&&t.getName();e===t&&(n=null),e=new(g(y.TOOLBOX_ITEM_SELECT))(r,n,this.workspace_.id),m(e)}selectParent(){return!(!this.selectedItem_||(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),0):!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable()||(this.setSelectedItem(this.selectedItem_.getParent()),0)))}selectChild(){var e;return!(!this.selectedItem_||!this.selectedItem_.isCollapsible()||((e=this.selectedItem_).isExpanded()?this.selectNext():e.toggleExpanded(),0))}selectNext(){if(this.selectedItem_){var r=[...this.contents.values()];let t=r.indexOf(this.selectedItem_)+1;if(-1<t&&t<r.length){let e=r[t];for(;e&&!e.isSelectable();)e=r[++t];if(e&&e.isSelectable())return this.setSelectedItem(e),!0}}return!1}selectPrevious(){if(this.selectedItem_){var r=[...this.contents.values()];let t=r.indexOf(this.selectedItem_)-1;if(-1<t&&t<r.length){let e=r[t];for(;e&&!e.isSelectable();)e=r[--t];if(e&&e.isSelectable())return this.setSelectedItem(e),!0}}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout.dispose(),this.contents.forEach(e=>e.dispose());for(let e=0;e<this.boundEvents_.length;e++)s(this.boundEvents_[e]);this.boundEvents_=[],this.contents.clear(),this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),o(this.HtmlDiv)),f.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}getFocusableElement(){if(this.HtmlDiv)return this.HtmlDiv;throw Error("Toolbox DOM has not yet been created.")}getFocusableTree(){return this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(e){return(!e||e===this)&&null!=(e=this.getToolboxItems().find(e=>e.isSelectable()))?e:null}getNestedTrees(){return[]}lookUpFocusableNode(e){return this.getToolboxItemById(e)}onTreeFocus(e,t){e!==this?this.getSelectedItem()!==e&&this.setSelectedItem(e):this.clearSelection()}onTreeBlur(e){e&&e===(null==(e=this.flyout)?void 0:e.getWorkspace())||(this.clearSelection(),this.flyout&&Bi(this.flyout)&&this.flyout.autoHide(!1))}}),Zh=(_e('\n.blocklyToolboxDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxGrab {\n  cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Category tree in Toolbox. */\n.blocklyToolbox {\n  box-sizing: border-box;\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background-color: #ddd;\n  overflow-x: visible;\n  overflow-y: auto;\n  padding: 4px 0 4px 0;\n  position: absolute;\n  z-index: 70;  /* so blocks go under toolbox when dragging */\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n}\n\n.blocklyToolboxCategoryGroup {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n\n.blocklyToolboxCategoryGroup:focus {\n  outline: none;\n}\n'),i(_.TOOLBOX,$a,Xh),v.INPUT_VALUE),Qh=v.OUTPUT_VALUE,em=v.NEXT_STATEMENT,tm=v.PREVIOUS_STATEMENT,cc=b.TOP,Dh=b.BOTTOM,oc=b.LEFT,Ha=b.RIGHT,r=(Sp.prototype.newBlock=function(e,t){return new id(this,e,t)},wp.prototype.newBlock=function(e,t){return new O(this,e,t)},Sp.prototype.newComment=function(e){return new ku(this,e)},wp.prototype.newComment=function(e){return new xu(this,e)},wp.newTrashcan=function(e){return new Rp(e)},Uu.prototype.newWorkspaceSvg=function(e){return new wp(e)},f.Names$$module$build$src$core$names.prototype.populateProcedures=function(t){t=(t=Vi(t))[0].concat(t[1]);for(let e=0;e<t.length;e++)this.getName(t[e][0],f.Names$$module$build$src$core$names.NameType.PROCEDURE)},{});r.Block=id,r.BlockFlyoutInflater=Lh,r.BlockNavigationPolicy=xd,r.BlockSvg=O,r.Blocks=Ua,r.ButtonFlyoutInflater=Oh,r.COLLAPSED_FIELD_NAME=wl,r.COLLAPSED_INPUT_NAME=Cl,r.COLLAPSE_CHARS=30,r.CodeGenerator=f.CodeGenerator$$module$build$src$core$generator,r.CollapsibleToolboxCategory=Yh,r.ComponentManager=Jo,r.Connection=N,r.ConnectionChecker=Mo,r.ConnectionDB=Au,r.ConnectionNavigationPolicy=Sd,r.ConnectionType=v,r.ContextMenu=cu,r.ContextMenuItems=jo,r.ContextMenuRegistry=A,r.Css=Zo,r.DELETE_VARIABLE_ID=Zu,r.DeleteArea=md,r.DragTarget=hd,r.DropDownDiv=tc,r.Events=P,r.Extensions=ju,r.Field=I,r.FieldCheckbox=gh,r.FieldDropdown=Lu,r.FieldImage=eh,r.FieldLabel=Ju,r.FieldLabelSerializable=Gu,r.FieldNavigationPolicy=Cd,r.FieldNumber=qu,r.FieldTextInput=f.FieldTextInput$$module$build$src$core$field_textinput,r.FieldVariable=mh,r.Flyout=Pd,r.FlyoutButton=yd,r.FlyoutButtonNavigationPolicy=bd,r.FlyoutItem=gd,r.FlyoutMetricsManager=_d,r.FlyoutNavigationPolicy=vd,r.FlyoutNavigator=Nd,r.FlyoutSeparator=Td,r.FlyoutSeparatorNavigationPolicy=kd,r.FocusManager=$o,r.FocusableTreeTraverser=Fo,r.Generator=f.CodeGenerator$$module$build$src$core$generator,r.Gesture=$d,r.Grid=Ud,r.HorizontalFlyout=hh,r.INPUT_VALUE=Zh,r.Input=ed,r.InsertionMarkerPreviewer=ch,r.KeyboardNavigationController=Md,r.LabelFlyoutInflater=Xp,r.LineCursor=Gd,r.Marker=Hd,r.MarkerManager=jd,r.Menu=El,r.MenuItem=xl,r.MetricsManager=fd,r.Msg=f.Msg$$module$build$src$core$msg,r.NEXT_STATEMENT=em,r.Names=f.Names$$module$build$src$core$names,r.Navigator=Dd,r.OPPOSITE_TYPE=Yu,r.OUTPUT_VALUE=Qh,r.Options=Fu,r.PREVIOUS_STATEMENT=tm,r.PROCEDURE_CATEGORY_NAME=Qd,r.Procedures=qd,r.RENAME_VARIABLE_ID=Xu,r.RenderedConnection=Qu,r.Scrollbar=nl,r.ScrollbarPair=Od,r.SeparatorFlyoutInflater=Ld,r.ShortcutItems=el,r.ShortcutRegistry=T,r.TOOLBOX_AT_BOTTOM=Dh,r.TOOLBOX_AT_LEFT=oc,r.TOOLBOX_AT_RIGHT=Ha,r.TOOLBOX_AT_TOP=cc,r.Theme=Pu,r.ThemeManager=kp,r.Themes=lc,r.Toast=Ul,r.Toolbox=Xh,r.ToolboxCategory=qh,r.ToolboxItem=Ku,r.ToolboxSeparator=Jh,r.Tooltip=Kc,r.Touch=za,r.Trashcan=Rp,r.UnattachedFieldError=Xc,r.VARIABLE_CATEGORY_NAME=Xl,r.VARIABLE_DYNAMIC_CATEGORY_NAME=xp,r.VERSION="12.2.0",r.VariableMap=hc,r.VariableModel=Wa,r.Variables=ec,r.VariablesDynamic=Ep,r.VerticalFlyout=ph,r.WidgetDiv=su,r.Workspace=Sp,r.WorkspaceAudio=Cp,r.WorkspaceDragger=Bd,r.WorkspaceNavigationPolicy=Ad,r.WorkspaceSvg=wp,r.Xml=Eu,r.ZoomControls=_l,r.blockAnimations=od,r.blockRendering=w,r.browserEvents=bo,r.bubbles=Rh,r.bumpObjects=cd,r.clipboard=Uo,r.comments=Yc,r.common=e,r.config=f.config$$module$build$src$core$config,r.constants=Al,r.defineBlocksWithJsonArray=me,r.dialog=Jl,r.dragging=Wo,r.fieldRegistry=Ru,r.geras=t,r.getFocusManager=f.getFocusManager$$module$build$src$core$focus_manager,r.getMainWorkspace=ae,r.getSelected=le,r.hasBubble=sr,r.hideChaff=aa,r.icons=Wd,r.inject=Cs,r.inputs=uh,r.isCopyable=ms,r.isDeletable=Ri,r.isDraggable=Fi,r.isIcon=yi,r.isObservable=Ui,r.isPaster=na,r.isRenderedElement=ia,r.isSelectable=ee,r.isSerializable=Qe,r.isVariableBackedParameterModel=mt,r.keyboardNavigationController=Fd,r.layers=du,r.navigateBlock=Mi,r.navigateStacks=Pi,r.procedures=qd,r.registry=Fa,r.renderManagement=Ml,r.serialization=qo,r.setLocale=no,r.setParentContainer=ue,r.svgResize=de,r.thrasos=zh,r.uiPosition=gl,r.utils=zu,r.zelos=C;return r.__namespace__=f,r},"function"==typeof define&&define.amd?define([],t):"object"==typeof n?r.exports=t():e.Blockly=t()}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],172:[function(e,t,r){t.exports=e("./blocks_compressed.js")},{"./blocks_compressed.js":173}],173:[function(e,t,r){var n,i;n=this,i=function(e){var a=e.__namespace__,e=a.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),i=function(r){return function(){var e=r.workspace,t=r.getField("VAR").getVariable();a.renameVariable$$module$build$src$core$variables(e,t)}},s=function(t){return function(){var e=t.getField("VAR").getVariable();e&&a.deleteVariable$$module$build$src$core$variables(e.getWorkspace(),e,t)}},t=(a.registerMixin$$module$build$src$core$extensions("contextMenu_variableDynamicSetterGetter",{customContextMenu:function(e){var t,r,n;this.isInFlyout?"variables_get_dynamic"!==this.type&&"variables_get_reporter_dynamic"!==this.type||(t={text:a.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:i(this)},r=this.getField("VAR").getText(),r={text:a.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",r),enabled:!0,callback:s(this)},e.unshift(t),e.unshift(r)):(t="variables_get_dynamic"===this.type?(n="variables_set_dynamic",a.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET):(n="variables_get_dynamic",a.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET),n={type:n,fields:{VAR:(r=this.getField("VAR")).saveState(!0)}},e.push({enabled:0<this.workspace.remainingCapacity(),text:t.replace("%1",r.getText()),callback:a.callbackFactory$$module$build$src$core$contextmenu(this,n)}))},onchange:function(e){e=this.getFieldValue("VAR"),e=a.getVariable$$module$build$src$core$variables(this.workspace,e),("variables_get_dynamic"===this.type?this.outputConnection:this.getInput("VALUE").connection).setCheck(e.getType())}}),a.defineBlocks$$module$build$src$core$common(e),{blocks:e}),r=a.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),o=function(r){return function(){var e=r.workspace,t=r.getField("VAR").getVariable();a.renameVariable$$module$build$src$core$variables(e,t)}},l=function(t){return function(){var e=t.getField("VAR").getVariable();e&&a.deleteVariable$$module$build$src$core$variables(e.getWorkspace(),e,t)}},n=(a.registerMixin$$module$build$src$core$extensions("contextMenu_variableSetterGetter",{customContextMenu:function(e){var t,r,n;this.isInFlyout?"variables_get"!==this.type&&"variables_get_reporter"!==this.type||(t={text:a.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:o(this)},r=this.getField("VAR").getText(),r={text:a.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",r),enabled:!0,callback:l(this)},e.unshift(t),e.unshift(r)):(t="variables_get"===this.type?(n="variables_set",a.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET):(n="variables_get",a.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET),n={type:n,fields:{VAR:(r=this.getField("VAR")).saveState(!0)}},e.push({enabled:0<this.workspace.remainingCapacity(),text:t.replace("%1",r.getText()),callback:a.callbackFactory$$module$build$src$core$contextmenu(this,n)}))}}),a.defineBlocks$$module$build$src$core$common(r),{blocks:r}),c=a.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),u=(c.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT);var e=r=>{var e=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+r]});return e.setValidator(function(e){var t=this.getValue();(e="FROM_START"===e||"FROM_END"===e)!==("FROM_START"===t||"FROM_END"===t)&&this.getSourceBlock().updateAt_(r,e)}),e};this.appendDummyInput("WHERE1_INPUT").appendField(e(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(e(2),"WHERE2"),this.appendDummyInput("AT2"),a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){var e=a.createElement$$module$build$src$core$utils$xml("mutation"),t=this.getInput("AT1")instanceof a.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at1",""+t),t=this.getInput("AT2")instanceof a.ValueInput$$module$build$src$core$inputs$value_input,e.setAttribute("at2",""+t),e},domToMutation:function(e){var t="true"===e.getAttribute("at1");e="true"===e.getAttribute("at2"),this.updateAt_(1,t),this.updateAt_(2,e)},updateAt_:function(e,t){this.removeInput("AT"+e),this.removeInput("ORDINAL"+e,!0),t?(this.appendValueInput("AT"+e).setCheck("Number"),a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+e).appendField(a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+e),2===e&&a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(a.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL)),1===e&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1"))&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT")}},c.text_changeCase={init:function(){var e=[[a.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[a.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[a.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(a.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),"CASE"),this.setOutput(!0,"String"),this.setTooltip(a.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_TOOLTIP)}},c.text_trim={init:function(){var e=[[a.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[a.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[a.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(a.Msg$$module$build$src$core$msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),"MODE"),this.setOutput(!0,"String"),this.setTooltip(a.Msg$$module$build$src$core$msg.TEXT_TRIM_TOOLTIP)}},c.text_print={init:function(){this.jsonInit({message0:a.Msg$$module$build$src$core$msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:a.Msg$$module$build$src$core$msg.TEXT_PRINT_TOOLTIP,helpUrl:a.Msg$$module$build$src$core$msg.TEXT_PRINT_HELPURL})}},{updateType_:function(e){this.outputConnection.setCheck("NUMBER"===e?"Number":"String")},mutationToDom:function(){var e=a.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("type",this.getFieldValue("TYPE")),e},domToMutation:function(e){this.updateType_(e.getAttribute("type"))}}),d=(c.text_prompt_ext=Object.assign({},u,{init:function(){var e=[[a.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[a.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(a.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(e=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator(e=>{this.updateType_(e)}),this.appendValueInput("TEXT").appendField(e,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(()=>"TEXT"===this.getFieldValue("TYPE")?a.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:a.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),c.text_prompt=Object.assign({},u,{init:function(){this.mixin(d);var e=[[a.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[a.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(a.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(e=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator(e=>{this.updateType_(e)}),this.appendDummyInput().appendField(e,"TYPE").appendField(this.newQuote_(!0)).appendField(a.fromJson$$module$build$src$core$field_registry({type:"field_input",text:""}),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(()=>"TEXT"===this.getFieldValue("TYPE")?a.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:a.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),c.text_count={init:function(){this.jsonInit({message0:a.Msg$$module$build$src$core$msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:a.Msg$$module$build$src$core$msg.TEXT_COUNT_TOOLTIP,helpUrl:a.Msg$$module$build$src$core$msg.TEXT_COUNT_HELPURL})}},c.text_replace={init:function(){this.jsonInit({message0:a.Msg$$module$build$src$core$msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:a.Msg$$module$build$src$core$msg.TEXT_REPLACE_TOOLTIP,helpUrl:a.Msg$$module$build$src$core$msg.TEXT_REPLACE_HELPURL})}},c.text_reverse={init:function(){this.jsonInit({message0:a.Msg$$module$build$src$core$msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:a.Msg$$module$build$src$core$msg.TEXT_REVERSE_TOOLTIP,helpUrl:a.Msg$$module$build$src$core$msg.TEXT_REVERSE_HELPURL})}},{QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(n){for(let e=0,r;r=this.inputList[e];e++)for(let e=0,t;t=r.fieldRow[e];e++)if(n===t.name)return r.insertFieldAt(e,this.newQuote_(!0)),void r.insertFieldAt(e+2,this.newQuote_(!1));console.warn('field named "'+n+'" not found in '+this.toDevString())},newQuote_:function(e){return e=this.RTL?!e:e,a.fromJson$$module$build$src$core$field_registry({type:"field_image",src:e?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,width:this.QUOTE_IMAGE_WIDTH,height:this.QUOTE_IMAGE_HEIGHT,alt:e?"":""})}}),u={itemCount_:0,mutationToDom:function(){var e=a.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("items",""+this.itemCount_),e},domToMutation:function(e){this.itemCount_=parseInt(e.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(e){this.itemCount_=e.itemCount,this.updateShape_()},decompose:function(t){var e=t.newBlock("text_create_join_container");e.initSvg();let r=e.getInput("STACK").connection;for(let e=0;e<this.itemCount_;e++){var n=t.newBlock("text_create_join_item");n.initSvg(),r.connect(n.previousConnection),r=n.nextConnection}return e},compose:function(e){var t,r=e.getInputTargetBlock("STACK");for(e=[];r;)r.isInsertionMarker()||e.push(r.valueConnection_),r=r.getNextBlock();for(r=0;r<this.itemCount_;r++){var n=this.getInput("ADD"+r).connection.targetConnection;n&&!e.includes(n)&&n.disconnect()}for(this.itemCount_=e.length,this.updateShape_(),r=0;r<this.itemCount_;r++)null!=(t=e[r])&&t.reconnect(this,"ADD"+r)},saveConnections:function(e){e=e.getInputTargetBlock("STACK");let t=0;for(;e;){var r;e.isInsertionMarker()?e=e.getNextBlock():(r=this.getInput("ADD"+t),e.valueConnection_=r&&r.connection.targetConnection,e=e.getNextBlock(),t++)}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var e,t=0;t<this.itemCount_;t++)this.getInput("ADD"+t)||(e=this.appendValueInput("ADD"+t).setAlign(a.Align$$module$build$src$core$inputs$align.RIGHT),0===t&&e.appendField(a.Msg$$module$build$src$core$msg.TEXT_JOIN_TITLE_CREATEWITH));for(t=this.itemCount_;this.getInput("ADD"+t);t++)this.removeInput("ADD"+t)}},p=(a.register$$module$build$src$core$extensions("text_append_tooltip",a.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_TEXT_APPEND_TOOLTIP}","VAR")),{isAt_:!1,mutationToDom:function(){var e=a.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("at",""+this.isAt_),e},domToMutation:function(e){e="false"!==e.getAttribute("at"),this.updateAt_(e)},updateAt_:function(e){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),e&&(this.appendValueInput("AT").setCheck("Number"),a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)&&this.appendDummyInput("ORDINAL").appendField(a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX),a.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(a.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL)),this.isAt_=e}}),u=(a.register$$module$build$src$core$extensions("text_indexOf_tooltip",function(){this.setTooltip(()=>a.Msg$$module$build$src$core$msg.TEXT_INDEXOF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}),a.register$$module$build$src$core$extensions("text_quotes",function(){this.mixin(d),this.quoteField_("TEXT")}),a.registerMixin$$module$build$src$core$extensions("quote_image_mixin",d),a.registerMutator$$module$build$src$core$extensions("text_join_mutator",u,function(){this.mixin(d),this.itemCount_=2,this.updateShape_(),this.setMutator(new a.MutatorIcon$$module$build$src$core$icons$mutator_icon(["text_create_join_item"],this))}),a.registerMutator$$module$build$src$core$extensions("text_charAt_mutator",p,function(){this.getField("WHERE").setValidator(function(e){e="FROM_START"===e||"FROM_END"===e;var t=this.getSourceBlock();e!==t.isAt_&&t.updateAt_(e)}),this.updateAt_(!0),this.setTooltip(()=>{var e=this.getFieldValue("WHERE");let t=a.Msg$$module$build$src$core$msg.TEXT_CHARAT_TOOLTIP;return"FROM_START"!==e&&"FROM_END"!==e||!(e="FROM_START"===e?a.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:a.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP)||(t+="  "+e.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),t})}),a.defineBlocks$$module$build$src$core$common(c),{blocks:c}),p={},h={setStatements_:function(e){this.hasStatements_!==e&&(e?(this.appendStatementInput("STACK").appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=e)},updateParams_:function(){let e="";this.arguments_.length&&(e=a.Msg$$module$build$src$core$msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),a.disable$$module$build$src$core$events$utils();try{this.setFieldValue(e,"PARAMS")}finally{a.enable$$module$build$src$core$events$utils()}},mutationToDom:function(t){var r=a.createElement$$module$build$src$core$utils$xml("mutation");t&&r.setAttribute("name",this.getFieldValue("NAME"));for(let e=0;e<this.argumentVarModels_.length;e++){var n=a.createElement$$module$build$src$core$utils$xml("arg"),i=this.argumentVarModels_[e];n.setAttribute("name",i.getName()),n.setAttribute("varid",i.getId()),t&&this.paramIds_&&n.setAttribute("paramId",this.paramIds_[e]),r.appendChild(n)}return this.hasStatements_||r.setAttribute("statements","false"),r},domToMutation:function(r){this.arguments_=[],this.argumentVarModels_=[];for(let e=0,t;t=r.childNodes[e];e++){var n,i;"arg"===t.nodeName.toLowerCase()&&(n=(i=t).getAttribute("name"),i=i.getAttribute("varid")||i.getAttribute("varId"),this.arguments_.push(n),null!==(i=a.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,i,n,""))?this.argumentVarModels_.push(i):console.log(`Failed to create a variable named "${n}", ignoring.`))}this.updateParams_(),a.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_("false"!==r.getAttribute("statements"))},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;var t=Object.create(null);if(this.argumentVarModels_.length){t.params=[];for(let e=0;e<this.argumentVarModels_.length;e++)t.params.push({name:this.argumentVarModels_[e].getName(),id:this.argumentVarModels_[e].getId()})}return this.hasStatements_||(t.hasStatements=!1),t},loadExtraState:function(t){if(this.arguments_=[],this.argumentVarModels_=[],t.params)for(let e=0;e<t.params.length;e++){var r=t.params[e],r=a.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,r.id,r.name,"");this.arguments_.push(r.getName()),this.argumentVarModels_.push(r)}this.updateParams_(),a.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(!1!==t.hasStatements)},decompose:function(e){var t=a.createElement$$module$build$src$core$utils$xml("block"),r=(t.setAttribute("type","procedures_mutatorcontainer"),a.createElement$$module$build$src$core$utils$xml("statement"));r.setAttribute("name","STACK"),t.appendChild(r);for(let e=0;e<this.arguments_.length;e++){var n=a.createElement$$module$build$src$core$utils$xml("block"),i=(n.setAttribute("type","procedures_mutatorarg"),a.createElement$$module$build$src$core$utils$xml("field")),s=(i.setAttribute("name","NAME"),a.createTextNode$$module$build$src$core$utils$xml(this.arguments_[e]));i.appendChild(s),n.appendChild(i),i=a.createElement$$module$build$src$core$utils$xml("next"),n.appendChild(i),r.appendChild(n),r=i}return e=a.domToBlock$$module$build$src$core$xml(t,e),"procedures_defreturn"===this.type?e.setFieldValue(this.hasStatements_,"STATEMENTS"):e.removeInput("STATEMENT_INPUT"),a.mutateCallers$$module$build$src$core$procedures(this),e},compose:function(e){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let t=e.getInputTargetBlock("STACK");for(;t&&!t.isInsertionMarker();){var r=t.getFieldValue("NAME");this.arguments_.push(r),r=this.workspace.getVariable(r,""),this.argumentVarModels_.push(r),this.paramIds_.push(t.id),t=t.nextConnection&&t.nextConnection.targetBlock()}var n;this.updateParams_(),a.mutateCallers$$module$build$src$core$procedures(this),null!==(e=e.getFieldValue("STATEMENTS"))&&this.hasStatements_!==(e="TRUE"===e)&&(e?(this.setStatements_(!0),null!=(n=this.statementConnection_)&&n.reconnect(this,"STACK"),this.statementConnection_=null):(n=this.getInput("STACK").connection,(this.statementConnection_=n.targetConnection)&&((n=n.targetBlock()).unplug(),n.bumpNeighbours()),this.setStatements_(!1)))},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(t,r){var e=this.workspace.getVariableById(t);if(""===e.getType()){e=e.getName(),r=this.workspace.getVariableById(r);var n=!1;for(let e=0;e<this.argumentVarModels_.length;e++)this.argumentVarModels_[e].getId()===t&&(this.arguments_[e]=r.getName(),this.argumentVarModels_[e]=r,n=!0);n&&(this.displayRenamedVar_(e,r.getName()),a.mutateCallers$$module$build$src$core$procedures(this))}},updateVarName:function(t){var r=t.getName();let n=!1,i;for(let e=0;e<this.argumentVarModels_.length;e++)this.argumentVarModels_[e].getId()===t.getId()&&(i=this.arguments_[e],this.arguments_[e]=r,n=!0);n&&(this.displayRenamedVar_(i,r),a.mutateCallers$$module$build$src$core$procedures(this))},displayRenamedVar_:function(r,n){this.updateParams_();var i=this.getIcon(a.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);if(i&&i.bubbleIsVisible()){i=i.getWorkspace().getAllBlocks(!1);for(let e=0,t;t=i[e];e++)"procedures_mutatorarg"===t.type&&a.Names$$module$build$src$core$names.equals(r,t.getFieldValue("NAME"))&&t.setFieldValue(n,"NAME")}},customContextMenu:function(e){if(!this.isInFlyout){var t=this.getFieldValue("NAME"),r={type:this.callType_,extraState:{name:t,params:this.arguments_}};if(e.push({enabled:!0,text:a.Msg$$module$build$src$core$msg.PROCEDURES_CREATE_DO.replace("%1",t),callback:a.callbackFactory$$module$build$src$core$contextmenu(this,r)}),!this.isCollapsed())for(t=0;t<this.argumentVarModels_.length;t++){var n={type:"variables_get",fields:{VAR:{name:(r=this.argumentVarModels_[t]).getName(),id:r.getId(),type:r.getType()}}};e.push({enabled:!0,text:a.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",r.getName()),callback:a.callbackFactory$$module$build$src$core$contextmenu(this,n)})}}}},h=(p.procedures_defnoreturn=Object.assign({},h,{init:function(){var e=a.findLegalName$$module$build$src$core$procedures("",this);(e=a.fromJson$$module$build$src$core$field_registry({type:"field_input",text:e})).setValidator(a.rename$$module$build$src$core$procedures),e.setSpellcheck(!1),this.appendDummyInput().appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.setMutator(new a.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&a.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},callType_:"procedures_callnoreturn"}),p.procedures_defreturn=Object.assign({},h,{init:function(){var e=a.findLegalName$$module$build$src$core$procedures("",this);(e=a.fromJson$$module$build$src$core$field_registry({type:"field_input",text:e})).setValidator(a.rename$$module$build$src$core$procedures),e.setSpellcheck(!1),this.appendDummyInput().appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(a.Align$$module$build$src$core$inputs$align.RIGHT).appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new a.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},callType_:"procedures_callreturn"}),{init:function(){this.appendDummyInput().appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_ALLOW_STATEMENTS).appendField(a.fromJson$$module$build$src$core$field_registry({type:"field_checkbox",checked:!0}),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(a.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}}),m=(p.procedures_mutatorcontainer=h,class extends a.FieldTextInput$$module$build$src$core$field_textinput{constructor(){super(...arguments),this.editingInteractively=!1}showEditor_(e){super.showEditor_(e),this.editingInteractively=!0,this.editingVariable=void 0}onFinishEditing_(e){super.onFinishEditing_(e),this.editingInteractively=!1}}),g=(p.procedures_mutatorarg={init:function(){var e=new m(a.DEFAULT_ARG$$module$build$src$core$procedures,this.validator_);this.appendDummyInput().appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TITLE).appendField(e,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(a.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1},validator_:function(e){var t=this.getSourceBlock(),r=t.workspace.getRootWorkspace();if(!(e=e.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;var n=(t.workspace.targetWorkspace||t.workspace).getAllBlocks(!1),i=e.toLowerCase();for(let e=0;e<n.length;e++)if(n[e].id!==this.getSourceBlock().id){var s=n[e].getFieldValue("NAME");if(s&&s.toLowerCase()===i)return null}return t.isInFlyout||((t=r.getVariable(e,""))&&t.getName()!==e&&r.renameVariableById(t.getId(),e),t)||(this.editingInteractively?this.editingVariable?r.renameVariableById(this.editingVariable.getId(),e):this.editingVariable=r.createVariable(e,""):r.createVariable(e,"")),e}},"DISABLED_PROCEDURE_DEFINITION"),h={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(e,t){a.Names$$module$build$src$core$names.equals(e,this.getProcedureCall())&&(this.setFieldValue(t,"NAME"),this.setTooltip((this.outputConnection?a.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_TOOLTIP:a.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",t)))},setProcedureParameters_:function(e,t){var r,n=a.getDefinition$$module$build$src$core$procedures(this.getProcedureCall(),this.workspace);if((n=(n=n&&n.getIcon(a.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE))&&n.bubbleIsVisible())?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null),e.join("\n")===this.arguments_.join("\n"))this.quarkIds_=t;else{if(t.length!==e.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]);for(let e=0;e<this.arguments_.length;e++){var i=this.getInput("ARG"+e);i&&(i=i.connection.targetConnection,this.quarkConnections_[this.quarkIds_[e]]=i,n)&&i&&!t.includes(this.quarkIds_[e])&&(i.disconnect(),i.getSourceBlock().bumpNeighbours())}for(this.arguments_=[].concat(e),this.argumentVarModels_=[],e=0;e<this.arguments_.length;e++)n=a.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,null,this.arguments_[e],""),this.argumentVarModels_.push(n);if(this.updateShape_(),this.quarkIds_=t)for(t=0;t<this.arguments_.length;t++)(e=this.quarkIds_[t])in this.quarkConnections_&&(null!=(r=this.quarkConnections_[e])&&r.reconnect(this,"ARG"+t)||delete this.quarkConnections_[e])}},updateShape_:function(){for(var e=0;e<this.arguments_.length;e++){var t=this.getField("ARGNAME"+e);if(t){a.disable$$module$build$src$core$events$utils();try{t.setValue(this.arguments_[e])}finally{a.enable$$module$build$src$core$events$utils()}}else t=a.fromJson$$module$build$src$core$field_registry({type:"field_label",text:this.arguments_[e]}),this.appendValueInput("ARG"+e).setAlign(a.Align$$module$build$src$core$inputs$align.RIGHT).appendField(t,"ARGNAME"+e)}for(e=this.arguments_.length;this.getInput("ARG"+e);e++)this.removeInput("ARG"+e);(e=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||e.appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"):this.getField("WITH")&&e.removeField("WITH"))},mutationToDom:function(){var t=a.createElement$$module$build$src$core$utils$xml("mutation");t.setAttribute("name",this.getProcedureCall());for(let e=0;e<this.arguments_.length;e++){var r=a.createElement$$module$build$src$core$utils$xml("arg");r.setAttribute("name",this.arguments_[e]),t.appendChild(r)}return t},domToMutation:function(r){var n=r.getAttribute("name"),i=(this.renameProcedure(this.getProcedureCall(),n),n=[],[]);for(let e=0,t;t=r.childNodes[e];e++)"arg"===t.nodeName.toLowerCase()&&(n.push(t.getAttribute("name")),i.push(t.getAttribute("paramId")));this.setProcedureParameters_(n,i)},saveExtraState:function(){var e=Object.create(null);return e.name=this.getProcedureCall(),this.arguments_.length&&(e.params=this.arguments_),e},loadExtraState:function(e){var t;this.renameProcedure(this.getProcedureCall(),e.name),(e=e.params)&&((t=[]).length=e.length,t.fill(null),this.setProcedureParameters_(e,t))},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(e){var t,r,n,i;this.workspace&&!this.workspace.isFlyout&&e.recordUndo&&(e.type===a.BLOCK_CREATE$$module$build$src$core$events$events&&e.ids.includes(this.id)?(t=this.getProcedureCall(),(r=!(r=a.getDefinition$$module$build$src$core$procedures(t,this.workspace))||r.type===this.defType_&&JSON.stringify(r.getVars())===JSON.stringify(this.arguments_)?r:null)?r.isEnabled()||(this.setDisabledReason(!0,g),this.setWarningText(a.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",t))):(a.setGroup$$module$build$src$core$events$utils(e.group),e=a.createElement$$module$build$src$core$utils$xml("xml"),(t=a.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type",this.defType_),n=(r=this.getRelativeToSurfaceXY()).y+2*a.config$$module$build$src$core$config.snapRadius,t.setAttribute("x",""+(r.x+a.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1))),t.setAttribute("y",""+n),r=this.mutationToDom(),t.appendChild(r),(r=a.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),(n=this.getProcedureCall())!==(i=a.findLegalName$$module$build$src$core$procedures(n,this))&&this.renameProcedure(n,i),r.appendChild(a.createTextNode$$module$build$src$core$utils$xml(n)),t.appendChild(r),e.appendChild(t),a.domToWorkspace$$module$build$src$core$xml(e,this.workspace),a.setGroup$$module$build$src$core$events$utils(!1))):e.type===a.BLOCK_DELETE$$module$build$src$core$events$events?(t=this.getProcedureCall(),a.getDefinition$$module$build$src$core$procedures(t,this.workspace)||(a.setGroup$$module$build$src$core$events$utils(e.group),this.dispose(!0),a.setGroup$$module$build$src$core$events$utils(!1))):e.type===a.BLOCK_CHANGE$$module$build$src$core$events$events&&"disabled"===e.element&&(t=this.getProcedureCall(),n=a.getDefinition$$module$build$src$core$procedures(t,this.workspace))&&n.id===e.blockId&&((r=a.getGroup$$module$build$src$core$events$utils())&&console.log("Saw an existing group while responding to a definition change"),a.setGroup$$module$build$src$core$events$utils(e.group),e=n.isEnabled(),this.setDisabledReason(!e,g),this.setWarningText(e?null:a.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",t)),a.setGroup$$module$build$src$core$events$utils(r)))},customContextMenu:function(e){var t,r;this.workspace.isMovable()&&(t=this.getProcedureCall(),r=this.workspace,e.push({enabled:!0,text:a.Msg$$module$build$src$core$msg.PROCEDURES_HIGHLIGHT_DEF,callback:function(){var e=a.getDefinition$$module$build$src$core$procedures(t,r);e&&(r.centerOnBlock(e.id),a.getFocusManager$$module$build$src$core$focus_manager().focusNode(e))}}))}},h=(p.procedures_callnoreturn=Object.assign({},h,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(a.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defnoreturn"}),p.procedures_callreturn=Object.assign({},h,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(a.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defreturn"}),p.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(a.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(a.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(a.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){var e=a.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("value",String(Number(this.hasReturnValue_))),e},domToMutation:function(e){this.hasReturnValue_="1"===e.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(e){if(!(this.workspace.isDragging&&this.workspace.isDragging()||e.type!==a.BLOCK_MOVE$$module$build$src$core$events$events&&e.type!==a.BLOCK_CREATE$$module$build$src$core$events$events)){e=!1;var t=this;do{if(this.FUNCTION_TYPES.includes(t.type)){e=!0;break}}while(t=t.getSurroundParent());if(e?("procedures_defnoreturn"===t.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!==t.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(a.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText(a.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_WARNING),!this.isInFlyout)try{a.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!e,"UNPARENTED_IFRETURN")}finally{a.setRecordUndo$$module$build$src$core$events$utils(!0)}}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},a.defineBlocks$$module$build$src$core$common(p),{blocks:p}),f=a.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["","PI"],["e","E"],["","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt()","SQRT1_2"],["","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]),_=(a.register$$module$build$src$core$extensions("math_op_tooltip",a.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"})),{mutationToDom:function(){var e=a.createElement$$module$build$src$core$utils$xml("mutation"),t="DIVISIBLE_BY"===this.getFieldValue("PROPERTY");return e.setAttribute("divisor_input",String(t)),e},domToMutation:function(e){e="true"===e.getAttribute("divisor_input"),this.updateShape_(e)},updateShape_:function(e){var t=this.getInput("DIVISOR");e?t||this.appendValueInput("DIVISOR").setCheck("Number"):t&&this.removeInput("DIVISOR")}}),_=(a.registerMutator$$module$build$src$core$extensions("math_is_divisibleby_mutator",_,function(){this.getField("PROPERTY").setValidator(function(e){e="DIVISIBLE_BY"===e,this.getSourceBlock().updateShape_(e)})}),a.register$$module$build$src$core$extensions("math_change_tooltip",a.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_MATH_CHANGE_TOOLTIP}","VAR")),{updateType_:function(e){"MODE"===e?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){var e=a.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("op",this.getFieldValue("OP")),e},domToMutation:function(e){if(null===(e=e.getAttribute("op")))throw new TypeError("xmlElement had no op attribute");this.updateType_(e)}}),_=(a.registerMutator$$module$build$src$core$extensions("math_modes_of_list_mutator",_,function(){this.getField("OP").setValidator(function(e){this.updateType_(e)}.bind(this))}),a.defineBlocks$$module$build$src$core$common(f),{blocks:f}),y=a.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]),b=(a.register$$module$build$src$core$extensions("controls_whileUntil_tooltip",a.buildTooltipForDropdown$$module$build$src$core$extensions("MODE",{WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"})),a.register$$module$build$src$core$extensions("controls_flow_tooltip",a.buildTooltipForDropdown$$module$build$src$core$extensions("FLOW",{BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"})),{customContextMenu:function(e){var t,r;this.isInFlyout||(r=(t=this.getField("VAR")).getVariable().getName(),this.isCollapsed())||null===r||(t={type:"variables_get",fields:{VAR:t.saveState(!0)}},e.push({enabled:!0,text:a.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",r),callback:a.callbackFactory$$module$build$src$core$contextmenu(this,t)}))}}),v=(a.registerMixin$$module$build$src$core$extensions("contextMenu_newGetVariableBlock",b),a.register$$module$build$src$core$extensions("controls_for_tooltip",a.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),a.register$$module$build$src$core$extensions("controls_forEach_tooltip",a.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR")),new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"])),b=(a.registerMixin$$module$build$src$core$extensions("controls_flow_in_loop_check",{getSurroundLoop:function(){let e=this;do{if(v.has(e.type))return e}while(e=e.getSurroundParent());return null},onchange:function(e){var t=this.workspace;if(t.isDragging&&!t.isDragging()&&(e.type===a.BLOCK_MOVE$$module$build$src$core$events$events||e.type===a.BLOCK_CREATE$$module$build$src$core$events$events)&&(e=!!this.getSurroundLoop(),this.setWarningText(e?null:a.Msg$$module$build$src$core$msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout))try{a.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!e,"CONTROL_FLOW_NOT_IN_LOOP")}finally{a.setRecordUndo$$module$build$src$core$events$utils(!0)}}}),a.defineBlocks$$module$build$src$core$common(y),{blocks:y,loopTypes:v}),T=a.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["","NEQ"],["<","LT"],["","LTE"],[">","GT"],["","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]),k=(a.register$$module$build$src$core$extensions("logic_op_tooltip",a.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"})),{elseifCount_:0,elseCount_:0,mutationToDom:function(){var e;return this.elseifCount_||this.elseCount_?(e=a.createElement$$module$build$src$core$utils$xml("mutation"),this.elseifCount_&&e.setAttribute("elseif",String(this.elseifCount_)),this.elseCount_&&e.setAttribute("else","1"),e):null},domToMutation:function(e){this.elseifCount_=parseInt(e.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(e.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){var e;return this.elseifCount_||this.elseCount_?(e=Object.create(null),this.elseifCount_&&(e.elseIfCount=this.elseifCount_),this.elseCount_&&(e.hasElse=!0),e):null},loadExtraState:function(e){this.elseifCount_=e.elseIfCount||0,this.elseCount_=e.hasElse?1:0,this.updateShape_()},decompose:function(t){var e=t.newBlock("controls_if_if");e.initSvg();let r=e.nextConnection;for(let e=1;e<=this.elseifCount_;e++){var n=t.newBlock("controls_if_elseif");n.initSvg(),r.connect(n.previousConnection),r=n.nextConnection}return this.elseCount_&&((t=t.newBlock("controls_if_else")).initSvg(),r.connect(t.previousConnection)),e},compose:function(e){e=e.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;var t=[null],r=[null];let n=null;for(;e;){if(!e.isInsertionMarker())switch(e.type){case"controls_if_elseif":this.elseifCount_++,t.push(e.valueConnection_),r.push(e.statementConnection_);break;case"controls_if_else":this.elseCount_++,n=e.statementConnection_;break;default:throw TypeError("Unknown block type: "+e.type)}e=e.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(t,r,n)},saveConnections:function(e){e=e.nextConnection.targetBlock();let t=1;for(;e;){if(!e.isInsertionMarker())switch(e.type){case"controls_if_elseif":var r=this.getInput("IF"+t),n=this.getInput("DO"+t);e.valueConnection_=r&&r.connection.targetConnection,e.statementConnection_=n&&n.connection.targetConnection,t++;break;case"controls_if_else":r=this.getInput("ELSE"),e.statementConnection_=r&&r.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+e.type)}e=e.getNextBlock()}},rebuildShape_:function(){var t=[null],r=[null];let e=null;this.getInput("ELSE")&&(e=this.getInput("ELSE").connection.targetConnection);for(let e=1;this.getInput("IF"+e);e++){var n=this.getInput("IF"+e),i=this.getInput("DO"+e);t.push(n.connection.targetConnection),r.push(i.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(t,r,e)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var e=1;this.getInput("IF"+e);e++)this.removeInput("IF"+e),this.removeInput("DO"+e);for(e=1;e<=this.elseifCount_;e++)this.appendValueInput("IF"+e).setCheck("Boolean").appendField(a.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+e).appendField(a.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(a.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(t,r,e){for(let e=1;e<=this.elseifCount_;e++){var n;null!=(n=t[e])&&n.reconnect(this,"IF"+e),null!=(n=r[e])&&n.reconnect(this,"DO"+e)}null!=e&&e.reconnect(this,"ELSE")}}),x=(a.registerMutator$$module$build$src$core$extensions("controls_if_mutator",k,null,["controls_if_elseif","controls_if_else"]),a.register$$module$build$src$core$extensions("controls_if_tooltip",function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?a.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?a.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?a.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_4:"":a.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_1}.bind(this))}),{onchange:function(e){this.prevBlocks_||(this.prevBlocks_=[null,null]);var t=this.getInputTargetBlock("A"),r=this.getInputTargetBlock("B");t&&r&&!this.workspace.connectionChecker.doTypeChecks(t.outputConnection,r.outputConnection)&&(a.setGroup$$module$build$src$core$events$utils(e.group),(e=this.prevBlocks_[0])!==t&&(t.unplug(),!e||e.isDisposed()||e.isShadow()||this.getInput("A").connection.connect(e.outputConnection)),(t=this.prevBlocks_[1])!==r&&(r.unplug(),!t||t.isDisposed()||t.isShadow()||this.getInput("B").connection.connect(t.outputConnection)),this.bumpNeighbours(),a.setGroup$$module$build$src$core$events$utils(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}}),k=(a.register$$module$build$src$core$extensions("logic_compare",function(){this.mixin(x)}),{prevParentConnection_:null,onchange:function(t){var r=this.getInputTargetBlock("THEN"),n=this.getInputTargetBlock("ELSE"),i=this.outputConnection.targetConnection;if((r||n)&&i)for(let e=0;e<2;e++){var s=1===e?r:n;s&&!s.workspace.connectionChecker.doTypeChecks(s.outputConnection,i)&&(a.setGroup$$module$build$src$core$events$utils(t.group),(i===this.prevParentConnection_?(this.unplug(),i.getSourceBlock()):(s.unplug(),s)).bumpNeighbours(),a.setGroup$$module$build$src$core$events$utils(!1))}this.prevParentConnection_=i}}),k=(a.registerMixin$$module$build$src$core$extensions("logic_ternary",k),a.defineBlocks$$module$build$src$core$common(T),{blocks:T}),E=a.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),S=(E.lists_create_with={init:function(){this.setHelpUrl(a.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new a.MutatorIcon$$module$build$src$core$icons$mutator_icon(["lists_create_with_item"],this)),this.setTooltip(a.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){var e=a.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("items",String(this.itemCount_)),e},domToMutation:function(e){if(!(e=e.getAttribute("items")))throw new TypeError("element did not have items");this.itemCount_=parseInt(e,10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(e){this.itemCount_=e.itemCount,this.updateShape_()},decompose:function(t){var e=t.newBlock("lists_create_with_container");e.initSvg();let r=e.getInput("STACK").connection;for(let e=0;e<this.itemCount_;e++){var n=t.newBlock("lists_create_with_item");if(n.initSvg(),!n.previousConnection)throw Error("itemBlock has no previousConnection");r.connect(n.previousConnection),r=n.nextConnection}return e},compose:function(e){var t,r=e.getInputTargetBlock("STACK");for(e=[];r;)r.isInsertionMarker()||e.push(r.valueConnection_),r=r.getNextBlock();for(r=0;r<this.itemCount_;r++){var n=this.getInput("ADD"+r).connection.targetConnection;n&&!e.includes(n)&&n.disconnect()}for(this.itemCount_=e.length,this.updateShape_(),r=0;r<this.itemCount_;r++)null!=(t=e[r])&&t.reconnect(this,"ADD"+r)},saveConnections:function(e){e=e.getInputTargetBlock("STACK");let t=0;for(;e;){var r;e.isInsertionMarker()?e=e.getNextBlock():(r=this.getInput("ADD"+t),e.valueConnection_=null==r?void 0:r.connection.targetConnection,e=e.getNextBlock(),t++)}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(a.Msg$$module$build$src$core$msg.LISTS_CREATE_EMPTY_TITLE);for(var e,t=0;t<this.itemCount_;t++)this.getInput("ADD"+t)||(e=this.appendValueInput("ADD"+t).setAlign(a.Align$$module$build$src$core$inputs$align.RIGHT),0===t&&e.appendField(a.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_INPUT_WITH));for(t=this.itemCount_;this.getInput("ADD"+t);t++)this.removeInput("ADD"+t)}},{init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(a.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(a.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}}),S=(E.lists_create_with_container=S,{init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(a.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(a.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}}),S=(E.lists_create_with_item=S,{init:function(){var e=[[a.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_FIRST,"FIRST"],[a.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_LAST,"LAST"]];if(this.setHelpUrl(a.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(a.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_INPUT_IN_LIST),!(e=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})))throw Error("field_dropdown not found");this.appendValueInput("FIND").appendField(e,"END"),this.setInputsInline(!0),this.setTooltip(()=>a.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}}),S=(E.lists_indexOf=S,{init:function(){var e=[[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET,"GET"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),(e=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator(function(e){e="REMOVE"===e,this.getSourceBlock().updateStatement_(e)}),this.appendValueInput("VALUE").setCheck("Array").appendField(a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(e,"MODE").appendField("","SPACE"),(e=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS})).setValidator(function(e){var t=this.getValue();(e="FROM_START"===e||"FROM_END"===e)!==("FROM_START"===t||"FROM_END"===t)&&this.getSourceBlock().updateAt_(e)}),this.appendDummyInput().appendField(e,"WHERE"),this.appendDummyInput("AT"),a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0),this.setTooltip(()=>{var e=this.getFieldValue("MODE"),t=this.getFieldValue("WHERE");let r="";switch(e+" "+t){case"GET FROM_START":case"GET FROM_END":r=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":r=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":r=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":r=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":r=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":r=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":r=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":r=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":r=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":r=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":r=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":r=a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return"FROM_START"!==t&&"FROM_END"!==t||(r+="  "+("FROM_START"===t?a.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:a.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),r})},mutationToDom:function(){var e=a.createElement$$module$build$src$core$utils$xml("mutation"),t=(e.setAttribute("statement",String(!this.outputConnection)),this.getInput("AT")instanceof a.ValueInput$$module$build$src$core$inputs$value_input);return e.setAttribute("at",String(t)),e},domToMutation:function(e){var t="true"===e.getAttribute("statement");this.updateStatement_(t),e="false"!==e.getAttribute("at"),this.updateAt_(e)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function(e){e.isStatement?this.updateStatement_(!0):"string"==typeof e&&this.domToMutation(a.textToDom$$module$build$src$core$utils$xml(e))},updateStatement_:function(e){e!==!this.outputConnection&&(this.unplug(!0,!0),e?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(e){this.removeInput("AT"),this.removeInput("ORDINAL",!0),e?(this.appendValueInput("AT").setCheck("Number"),a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}}),S=(E.lists_getIndex=S,{init:function(){var e=[[a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_SET,"SET"],[a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[a.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_IN_LIST),e=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),this.appendDummyInput().appendField(e,"MODE").appendField("","SPACE"),(e=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS})).setValidator(function(e){var t=this.getValue();(e="FROM_START"===e||"FROM_END"===e)!==("FROM_START"===t||"FROM_END"===t)&&this.getSourceBlock().updateAt_(e)}),this.appendDummyInput().appendField(e,"WHERE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0),this.setTooltip(()=>{var e=this.getFieldValue("MODE"),t=this.getFieldValue("WHERE");let r="";switch(e+" "+t){case"SET FROM_START":case"SET FROM_END":r=a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":r=a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":r=a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":r=a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":r=a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":r=a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":r=a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":r=a.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return"FROM_START"!==t&&"FROM_END"!==t||(r+="  "+a.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),r})},mutationToDom:function(){var e=a.createElement$$module$build$src$core$utils$xml("mutation"),t=this.getInput("AT")instanceof a.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at",String(t)),e},domToMutation:function(e){e="false"!==e.getAttribute("at"),this.updateAt_(e)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(e){this.removeInput("AT"),this.removeInput("ORDINAL",!0),e?(this.appendValueInput("AT").setCheck("Number"),a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO")}}),S=(E.lists_setIndex=S,{init:function(){this.WHERE_OPTIONS_1=[[a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_INPUT_IN_LIST);var e=r=>{var e=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+r]});return e.setValidator(function(e){var t=this.getValue();(e="FROM_START"===e||"FROM_END"===e)!==("FROM_START"===t||"FROM_END"===t)&&this.getSourceBlock().updateAt_(r,e)}),e};this.appendDummyInput("WHERE1_INPUT").appendField(e(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(e(2),"WHERE2"),this.appendDummyInput("AT2"),a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){var e=a.createElement$$module$build$src$core$utils$xml("mutation"),t=this.getInput("AT1")instanceof a.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at1",String(t)),t=this.getInput("AT2")instanceof a.ValueInput$$module$build$src$core$inputs$value_input,e.setAttribute("at2",String(t)),e},domToMutation:function(e){var t="true"===e.getAttribute("at1");e="true"===e.getAttribute("at2"),this.updateAt_(1,t),this.updateAt_(2,e)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(e,t){this.removeInput("AT"+e),this.removeInput("ORDINAL"+e,!0),t?(this.appendValueInput("AT"+e).setCheck("Number"),a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+e).appendField(a.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+e),1===e&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1"))&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT"),a.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}}),S=(E.lists_getSublist=S,E.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},E.lists_split={init:function(){var e=a.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:[[a.Msg$$module$build$src$core$msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[a.Msg$$module$build$src$core$msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]]});if(!e)throw Error("field_dropdown not found");e.setValidator(e=>{this.updateType_(e)}),this.setHelpUrl(a.Msg$$module$build$src$core$msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(e,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(a.Msg$$module$build$src$core$msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(()=>{var e=this.getFieldValue("MODE");if("SPLIT"===e)return a.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"===e)return a.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+e)})},updateType_:function(e){var t,r;this.getFieldValue("MODE")!==e&&((t=this.getInput("INPUT").connection).setShadowDom(null),r=t.targetBlock())&&(t.disconnect(),r.isShadow()?r.dispose(!1):this.bumpNeighbours()),"SPLIT"===e?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){var e=a.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("mode",this.getFieldValue("MODE")),e},domToMutation:function(e){this.updateType_(e.getAttribute("mode"))},saveExtraState:function(){return{mode:this.getFieldValue("MODE")}},loadExtraState:function(e){this.updateType_(e.mode)}},a.defineBlocks$$module$build$src$core$common(E),{blocks:E}),E={blocks:Object.assign({},E,T,y,f,p,c,r,e),lists:S,logic:k,loops:b,math:_,procedures:h,texts:u,variables:n,variablesDynamic:t};return E.__namespace__=a,E},"function"==typeof define&&define.amd?define(["./blockly_compressed.js"],i):"object"==typeof r?t.exports=i(e("./blockly_compressed.js")):n.Blockly.libraryBlocks=i(n.Blockly)},{"./blockly_compressed.js":171}],174:[function(e,t,r){t.exports=e("./blockly_compressed.js")},{"./blockly_compressed.js":171}],175:[function(e,t,r){var n,i;n=this,i=function(e,t,r){return e.setLocale(t),e},"function"==typeof define&&define.amd?define(["blockly/core","blockly/msg/en","blockly/blocks"],i):"object"==typeof r?t.exports=i(e("blockly/core"),e("blockly/msg/en"),e("blockly/blocks")):n.Blockly=i(n.Blockly,n.Blockly.Msg,n.Blockly.Blocks)},{"blockly/blocks":172,"blockly/core":174,"blockly/msg/en":176}],176:[function(e,t,r){function n(){var e={Msg:Object.create(null)};return e.Msg.ADD_COMMENT="Add Comment",e.Msg.ALT_KEY="Alt",e.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",e.Msg.CHANGE_VALUE_TITLE="Change value:",e.Msg.CHROME_OS="ChromeOS",e.Msg.CLEAN_UP="Clean up Blocks",e.Msg.CLOSE="Close",e.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",e.Msg.COLLAPSE_ALL="Collapse Blocks",e.Msg.COLLAPSE_BLOCK="Collapse Block",e.Msg.COLOUR_BLEND_COLOUR1="colour 1",e.Msg.COLOUR_BLEND_COLOUR2="colour 2",e.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",e.Msg.COLOUR_BLEND_RATIO="ratio",e.Msg.COLOUR_BLEND_TITLE="blend",e.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",e.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",e.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",e.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",e.Msg.COLOUR_RANDOM_TITLE="random colour",e.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",e.Msg.COLOUR_RGB_BLUE="blue",e.Msg.COLOUR_RGB_GREEN="green",e.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",e.Msg.COLOUR_RGB_RED="red",e.Msg.COLOUR_RGB_TITLE="colour with",e.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",e.Msg.COMMAND_KEY=" Command",e.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",e.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",e.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",e.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",e.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",e.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",e.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",e.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",e.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",e.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",e.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",e.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",e.Msg.CONTROLS_IF_MSG_ELSE="else",e.Msg.CONTROLS_IF_MSG_ELSEIF="else if",e.Msg.CONTROLS_IF_MSG_IF="if",e.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",e.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",e.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",e.Msg.CONTROLS_REPEAT_INPUT_DO="do",e.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",e.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",e.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",e.Msg.CONTROL_KEY="Ctrl",e.Msg.COPY_SHORTCUT="Copy",e.Msg.CUT_SHORTCUT="Cut",e.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",e.Msg.DELETE_BLOCK="Delete Block",e.Msg.DELETE_VARIABLE="Delete the '%1' variable",e.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",e.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",e.Msg.DIALOG_CANCEL="Cancel",e.Msg.DIALOG_OK="OK",e.Msg.DISABLE_BLOCK="Disable Block",e.Msg.DUPLICATE_BLOCK="Duplicate",e.Msg.DUPLICATE_COMMENT="Duplicate Comment",e.Msg.EDIT_BLOCK_CONTENTS="Edit Block contents",e.Msg.ENABLE_BLOCK="Enable Block",e.Msg.EXPAND_ALL="Expand Blocks",e.Msg.EXPAND_BLOCK="Expand Block",e.Msg.EXTERNAL_INPUTS="External Inputs",e.Msg.HELP="Help",e.Msg.HELP_PROMPT="Press %1 for help on keyboard controls",e.Msg.INLINE_INPUTS="Inline Inputs",e.Msg.KEYBOARD_NAV_CONSTRAINED_MOVE_HINT="Use the arrow keys to move, then %1 to accept the position",e.Msg.KEYBOARD_NAV_COPIED_HINT="Copied. Press %1 to paste.",e.Msg.KEYBOARD_NAV_CUT_HINT="Cut. Press %1 to paste.",e.Msg.KEYBOARD_NAV_UNCONSTRAINED_MOVE_HINT="Hold %1 and use arrow keys to move freely, then %2 to accept the position",e.Msg.LINUX="Linux",e.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",e.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",e.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",e.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",e.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",e.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",e.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",e.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",e.Msg.LISTS_GET_INDEX_FIRST="first",e.Msg.LISTS_GET_INDEX_FROM_END="# from end",e.Msg.LISTS_GET_INDEX_FROM_START="#",e.Msg.LISTS_GET_INDEX_GET="get",e.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",e.Msg.LISTS_GET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",e.Msg.LISTS_GET_INDEX_LAST="last",e.Msg.LISTS_GET_INDEX_RANDOM="random",e.Msg.LISTS_GET_INDEX_REMOVE="remove",e.Msg.LISTS_GET_INDEX_TAIL="",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",e.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",e.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",e.Msg.LISTS_GET_SUBLIST_END_LAST="to last",e.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",e.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",e.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",e.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",e.Msg.LISTS_GET_SUBLIST_TAIL="",e.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",e.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",e.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",e.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",e.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#finding-items-in-a-list",e.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",e.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",e.Msg.LISTS_INLIST="in list",e.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",e.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",e.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",e.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",e.Msg.LISTS_LENGTH_TITLE="length of %1",e.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",e.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",e.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",e.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",e.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",e.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",e.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",e.Msg.LISTS_SET_INDEX_INPUT_TO="as",e.Msg.LISTS_SET_INDEX_INSERT="insert at",e.Msg.LISTS_SET_INDEX_SET="set",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",e.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",e.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",e.Msg.LISTS_SORT_ORDER_DESCENDING="descending",e.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",e.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",e.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",e.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",e.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",e.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",e.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",e.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",e.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",e.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",e.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",e.Msg.LOGIC_BOOLEAN_FALSE="false",e.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",e.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",e.Msg.LOGIC_BOOLEAN_TRUE="true",e.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",e.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",e.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",e.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",e.Msg.LOGIC_NEGATE_TITLE="not %1",e.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",e.Msg.LOGIC_NULL="null",e.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",e.Msg.LOGIC_NULL_TOOLTIP="Returns null.",e.Msg.LOGIC_OPERATION_AND="and",e.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",e.Msg.LOGIC_OPERATION_OR="or",e.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",e.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",e.Msg.LOGIC_TERNARY_CONDITION="test",e.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",e.Msg.LOGIC_TERNARY_IF_FALSE="if false",e.Msg.LOGIC_TERNARY_IF_TRUE="if true",e.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",e.Msg.MAC_OS="macOS",e.Msg.MATH_ADDITION_SYMBOL="+",e.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",e.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",e.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",e.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",e.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",e.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",e.Msg.MATH_CHANGE_TITLE="change %1 by %2",e.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",e.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",e.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants:  (3.141), e (2.718),  (1.618), sqrt(2) (1.414), sqrt() (0.707), or  (infinity).",e.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",e.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",e.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",e.Msg.MATH_DIVISION_SYMBOL="",e.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",e.Msg.MATH_IS_EVEN="is even",e.Msg.MATH_IS_NEGATIVE="is negative",e.Msg.MATH_IS_ODD="is odd",e.Msg.MATH_IS_POSITIVE="is positive",e.Msg.MATH_IS_PRIME="is prime",e.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",e.Msg.MATH_IS_WHOLE="is whole",e.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",e.Msg.MATH_MODULO_TITLE="remainder of %1  %2",e.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",e.Msg.MATH_MULTIPLICATION_SYMBOL="",e.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",e.Msg.MATH_NUMBER_TOOLTIP="A number.",e.Msg.MATH_ONLIST_HELPURL="",e.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",e.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",e.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",e.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",e.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",e.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",e.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",e.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",e.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",e.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",e.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",e.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",e.Msg.MATH_POWER_SYMBOL="^",e.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",e.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",e.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",e.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",e.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",e.Msg.MATH_ROUND_OPERATOR_ROUND="round",e.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",e.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",e.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",e.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",e.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",e.Msg.MATH_SINGLE_OP_ROOT="square root",e.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",e.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",e.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",e.Msg.MATH_SUBTRACTION_SYMBOL="-",e.Msg.MATH_TRIG_ACOS="acos",e.Msg.MATH_TRIG_ASIN="asin",e.Msg.MATH_TRIG_ATAN="atan",e.Msg.MATH_TRIG_COS="cos",e.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",e.Msg.MATH_TRIG_SIN="sin",e.Msg.MATH_TRIG_TAN="tan",e.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",e.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",e.Msg.MOVE_BLOCK="Move Block",e.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",e.Msg.NEW_NUMBER_VARIABLE="Create number variable...",e.Msg.NEW_STRING_VARIABLE="Create string variable...",e.Msg.NEW_VARIABLE="Create variable...",e.Msg.NEW_VARIABLE_TITLE="New variable name:",e.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",e.Msg.OPTION_KEY=" Option",e.Msg.ORDINAL_NUMBER_SUFFIX="",e.Msg.PASTE_SHORTCUT="Paste",e.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",e.Msg.PROCEDURES_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",e.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",e.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CALL_DISABLED_DEF_WARNING="Can't run the user-defined function '%1' because the definition block is disabled.",e.Msg.PROCEDURES_CREATE_DO="Create '%1'",e.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",e.Msg.PROCEDURES_DEFNORETURN_DO="",e.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",e.Msg.PROCEDURES_DEFNORETURN_TITLE="to",e.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",e.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFRETURN_RETURN="return",e.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",e.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",e.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",e.Msg.PROCEDURES_IFRETURN_HELPURL="https://c2.com/cgi/wiki?GuardClause",e.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",e.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",e.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",e.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",e.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",e.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",e.Msg.REDO="Redo",e.Msg.REMOVE_COMMENT="Remove Comment",e.Msg.RENAME_VARIABLE="Rename variable...",e.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",e.Msg.SHORTCUTS_CODE_NAVIGATION="Code navigation",e.Msg.SHORTCUTS_EDITING="Editing",e.Msg.SHORTCUTS_GENERAL="General",e.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_APPEND_TITLE="to %1 append text %2",e.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",e.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",e.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",e.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",e.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",e.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",e.Msg.TEXT_CHARAT_FIRST="get first letter",e.Msg.TEXT_CHARAT_FROM_END="get letter # from end",e.Msg.TEXT_CHARAT_FROM_START="get letter #",e.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",e.Msg.TEXT_CHARAT_LAST="get last letter",e.Msg.TEXT_CHARAT_RANDOM="get random letter",e.Msg.TEXT_CHARAT_TAIL="",e.Msg.TEXT_CHARAT_TITLE="in text %1 %2",e.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",e.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",e.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",e.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",e.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",e.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",e.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",e.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",e.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",e.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",e.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",e.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",e.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",e.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",e.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",e.Msg.TEXT_GET_SUBSTRING_TAIL="",e.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",e.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",e.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",e.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",e.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",e.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",e.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",e.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",e.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",e.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",e.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",e.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",e.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_LENGTH_TITLE="length of %1",e.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",e.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",e.Msg.TEXT_PRINT_TITLE="print %1",e.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",e.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",e.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",e.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",e.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",e.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",e.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",e.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",e.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",e.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",e.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",e.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",e.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",e.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",e.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",e.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",e.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",e.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",e.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",e.Msg.TODAY="Today",e.Msg.UNDO="Undo",e.Msg.UNKNOWN="Unknown",e.Msg.UNNAMED_KEY="unnamed",e.Msg.VARIABLES_DEFAULT_NAME="item",e.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",e.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",e.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",e.Msg.VARIABLES_SET="set %1 to %2",e.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",e.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",e.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",e.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",e.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",e.Msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER="A variable named '%1' already exists as a parameter in the procedure '%2'.",e.Msg.WINDOWS="Windows",e.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",e.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",e.Msg.CONTROLS_FOREACH_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_FOR_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=e.Msg.CONTROLS_IF_MSG_ELSEIF,e.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=e.Msg.CONTROLS_IF_MSG_ELSE,e.Msg.CONTROLS_IF_IF_TITLE_IF=e.Msg.CONTROLS_IF_MSG_IF,e.Msg.CONTROLS_IF_MSG_THEN=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.LISTS_CREATE_WITH_ITEM_TITLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.LISTS_GET_INDEX_HELPURL=e.Msg.LISTS_INDEX_OF_HELPURL,e.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.MATH_CHANGE_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.PROCEDURES_DEFRETURN_COMMENT=e.Msg.PROCEDURES_DEFNORETURN_COMMENT,e.Msg.PROCEDURES_DEFRETURN_DO=e.Msg.PROCEDURES_DEFNORETURN_DO,e.Msg.PROCEDURES_DEFRETURN_PROCEDURE=e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,e.Msg.PROCEDURES_DEFRETURN_TITLE=e.Msg.PROCEDURES_DEFNORETURN_TITLE,e.Msg.TEXT_APPEND_VARIABLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.MATH_HUE="230",e.Msg.LOOPS_HUE="120",e.Msg.LISTS_HUE="260",e.Msg.LOGIC_HUE="210",e.Msg.VARIABLES_HUE="330",e.Msg.TEXTS_HUE="160",e.Msg.PROCEDURES_HUE="290",e.Msg.COLOUR_HUE="20",e.Msg.VARIABLES_DYNAMIC_HUE="310",e.Msg}var i=this;if("function"==typeof define&&define.amd)define([],n);else if("object"==typeof r)t.exports=n();else{var s,a=n();for(s in a)i.Blockly.Msg[s]=a[s]}},{}]},{},[165]);