!function n(o,r,s){function a(t,e){if(!r[t]){if(!o[t]){var i="function"==typeof require&&require;if(!e&&i)return i(t,!0);if(l)return l(t,!0);throw(e=new Error("Cannot find module '"+t+"'")).code="MODULE_NOT_FOUND",e}i=r[t]={exports:{}},o[t][0].call(i.exports,function(e){return a(o[t][1][e]||e)},i,i.exports,n,o,r,s)}return r[t].exports}for(var l="function"==typeof require&&require,e=0;e<s.length;e++)a(s[e]);return a}({1:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.BlockDragger=void 0;let a=e("blockly");class n extends a.dragging.Dragger{onDrag(e,t){super.onDrag(e,t);var i,n,o,t=document.getElementsByClassName("blocklyToolbox")[0],r=document.getElementsByClassName("blocklyTreeRoot")[0]||document.getElementsByClassName("blocklyFlyout")[0],s=document.getElementById("blocklyTrashIcon");r&&s&&(i=r.getBoundingClientRect(),n=r.getBoundingClientRect(),o=e.clientX,o=Math.abs(o-(n.left+n.width/2)),(n=a.Gesture.inProgress())&&o<200||!n&&e.clientX-(i.left+i.width)<0?(s.style.opacity=""+(1-(n=o/200)),s.style.display="block",t&&(r.style.opacity=""+n,o<50)&&pxt.BrowserUtils.addClass(t,"blocklyToolboxDeleting")):(s.style.display="none",r.style.opacity="1",t&&pxt.BrowserUtils.removeClass(t,"blocklyToolboxDeleting")))}onDragEnd(e){super.onDragEnd(e);var e=document.getElementsByClassName("blocklyToolbox")[0],t=document.getElementsByClassName("blocklyTreeRoot")[0]||document.getElementsByClassName("blocklyFlyout")[0],i=document.getElementById("blocklyTrashIcon");i&&t&&(i.style.display="none",t.style.opacity="1",e)&&pxt.BrowserUtils.removeClass(e,"blocklyToolboxDeleting")}}i.BlockDragger=n},{blockly:219}],2:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.BreakpointIcon=void 0;let n=e("blockly");class o extends n.icons.Icon{constructor(e,t){super(e),this.onStateChange=t,this.isSet_=!1}getType(){return o.type}initView(e){super.initView(e),this.breakpointSvg||(this.breakpointSvg=n.utils.dom.createSvgElement("circle",{class:"blocklyBreakpointSymbol",stroke:"white","stroke-width":2,cx:7,cy:11.5,r:8},this.svgRoot),this.updateColor())}getSize(){return new n.utils.Size(25,25)}onClick(){this.isSet_=!this.isSet_,this.updateColor(),this.onStateChange(this.sourceBlock,this.isSet_)}isEnabled(){return this.isSet_}setEnabled(e){this.isSet_=e,this.updateColor()}updateColor(){this.breakpointSvg&&this.breakpointSvg.setAttribute("fill",this.isSet_?"#FF0000":"#CCCCCC")}}(i.BreakpointIcon=o).type=new n.icons.IconType("breakpoint")},{blockly:219}],3:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.initFunctions=void 0;let h=e("blockly"),d=e("../help"),p=e("../plugins/functions"),u=e("../toolbox"),g=e("../fields"),f=e("../loader"),m=e("../importer"),b=e("../fields/field_imagenotext");function _(s,e){if(!e)return[];let t=[];pxt.appTarget.appTheme.hideFlyoutHeadings||(e=(0,u.createFlyoutHeadingLabel)(lf("Functions"),pxt.toolbox.getNamespaceColor("functions"),pxt.toolbox.getNamespaceIcon("functions"),"blocklyFlyoutIconfunctions"),t.push(e));let i=lf("Make a Function..."),n=lf("New function name:");e=h.utils.xml.createElement("button");e.setAttribute("text",i),e.setAttribute("callbackKey","CREATE_FUNCTION");s.registerButtonCallback("CREATE_FUNCTION",function(e){let t=e=>{h.dialog.prompt(n,e,function(e){pxt.tickEvent("blocks.makeafunction"),(e=e&&(e=e.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""))==i?null:e)&&(s.getVariableMap().getVariable(e)?h.dialog.alert(h.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",e.toLowerCase()),function(){t(e)}):h.Procedures.isNameUsed(e,s)?(e=>{var t=s.getTopBlocks(!0)[0];let i=10,n=10;t&&(o=t.getRelativeToSurfaceXY(),i=o.x+h.SNAP_RADIUS*(t.RTL?-1:1),n=o.y+2*h.SNAP_RADIUS);var t=h.utils.xml.createElement("xml"),o=h.utils.xml.createElement("block"),r=(o.setAttribute("type","procedures_defnoreturn"),o.setAttribute("x",String(i)),o.setAttribute("y",String(n)),h.utils.xml.createElement("field")),e=(r.setAttribute("name","NAME"),r.appendChild(document.createTextNode(e)),o.appendChild(r),t.appendChild(o),(0,m.domToWorkspaceNoEvents)(t,s)),r=(h.hideChaff(),s.getBlockById(e[0]));r.select(),s.centerOnBlock(r.id,!0)})(e):h.dialog.alert(h.Msg.PROCEDURE_ALREADY_EXISTS.replace("%1",e.toLowerCase()),function(){t(e)}))})};t("doSomething")}),t.push(e);var o=h.Procedures.allProcedures(s)[0],r="procedures_callnoreturn";for(let e=0;e<o.length;e++){var a=o[e][0],l=(o[e][1],h.utils.xml.createElement("block")),c=(l.setAttribute("type",r),l.setAttribute("gap","16"),l.setAttribute("colour",pxt.toolbox.getNamespaceColor("functions")),h.utils.xml.createElement("field"));c.textContent=a,c.setAttribute("name","NAME"),l.appendChild(c),t.push(l)}return t}i.initFunctions=function(){var e,t,i=h.Msg,n=(i.FUNCTION_CREATE_NEW=lf("Make a Function..."),i.FUNCTION_WARNING_DUPLICATE_ARG=lf("Functions cannot use the same argument name more than once."),i.FUNCTION_WARNING_ARG_NAME_IS_FUNCTION_NAME=lf("Argument names must not be the same as the function name."),i.FUNCTION_WARNING_EMPTY_NAME=lf("Function and argument names cannot be empty."),i.FUNCTIONS_DEFAULT_FUNCTION_NAME=lf("doSomething"),i.FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME=lf("bool"),i.FUNCTIONS_DEFAULT_STRING_ARG_NAME=lf("text"),i.FUNCTIONS_DEFAULT_NUMBER_ARG_NAME=lf("num"),i.FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME=lf("arg"),i.FUNCTION_FLYOUT_LABEL=lf("Your Functions"),i.FUNCTIONS_CREATE_CALL_OPTION=lf("Create 'call {0}'","%1"),i.FUNCTIONS_DEFNORETURN_TITLE=lf("function"),i.PROCEDURES_HUE=pxt.toolbox.getNamespaceColor("functions"),i.REPORTERS_HUE=pxt.toolbox.getNamespaceColor("variables"),"procedures_defnoreturn"),o=pxt.blocks.getBlockDefinition(n),n=(i.PROCEDURES_DEFNORETURN_TITLE=o.block.PROCEDURES_DEFNORETURN_TITLE,i.PROCEDURE_ALREADY_EXISTS=o.block.PROCEDURE_ALREADY_EXISTS,h.Blocks.procedures_defnoreturn.init=function(){var e=new h.FieldTextInput("",h.Procedures.rename);this.appendDummyInput().appendField(h.Msg.PROCEDURES_DEFNORETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.setColour(pxt.toolbox.getNamespaceColor("functions")),this.arguments_=[],this.argumentVarModels_=[],this.hat="cap",this.setStatements_(!0),this.statementConnection_=null},(0,d.installBuiltinHelpInfo)(n),"procedures_callnoreturn");let r=pxt.blocks.getBlockDefinition(n),s=(i.PROCEDURES_CALLRETURN_TOOLTIP=o.tooltip.toString(),h.Blocks.procedures_callnoreturn={init:function(){var e=new g.FieldProcedure("");this.appendDummyInput("TOPROW").appendField(r.block.PROCEDURES_CALLNORETURN_TITLE).appendField(e,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setColour(pxt.toolbox.getNamespaceColor("functions")),this.arguments_=[],this.quarkConnections_={},this.quarkIds_=null},getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(e,t){h.Names.equals(e,this.getProcedureCall())&&this.setFieldValue(t,"NAME")},onchange:function(t){if(this.workspace&&!this.workspace.isFlyout&&!this.isInsertionMarker())if(t.type==h.Events.CREATE&&-1!=t.ids.indexOf(this.id)){var i,n,o=this.getProcedureCall();let e=h.Procedures.getDefinition(o,this.workspace);(e=!e||e.type==this.defType_&&JSON.stringify(e.arguments_)==JSON.stringify(this.arguments_)?e:null)||(h.Events.setGroup(t.group),o=h.utils.xml.createElement("xml"),(i=h.utils.xml.createElement("block")).setAttribute("type",this.defType_),n=(r=this.getRelativeToSurfaceXY()).x+h.SNAP_RADIUS*(this.RTL?-1:1),r=r.y+2*h.SNAP_RADIUS,i.setAttribute("x",n),i.setAttribute("y",r),(n=h.utils.xml.createElement("field")).setAttribute("name","NAME"),n.appendChild(document.createTextNode(this.getProcedureCall())),i.appendChild(n),o.appendChild(i),(0,m.domToWorkspaceNoEvents)(o,this.workspace),h.Events.setGroup(!1))}else{var r;t.type==h.Events.DELETE&&(r=this.getProcedureCall(),h.Procedures.getDefinition(r,this.workspace)||(h.Events.setGroup(t.group),this.dispose(!0,!1),h.Events.setGroup(!1)))}},mutationToDom:function(){var e=document.createElement("mutation");return e.setAttribute("name",this.getProcedureCall()),e},domToMutation:function(e){e=e.getAttribute("name");this.renameProcedure(this.getProcedureCall(),e)},customContextMenu:function(e){var t={enabled:!0};t.text=h.Msg.PROCEDURES_HIGHLIGHT_DEF;let i=this.getProcedureCall(),n=this.workspace;t.callback=function(){var e=h.Procedures.getDefinition(i,n);e&&e.select()},e.push(t)},defType_:"procedures_defnoreturn"},(0,d.installBuiltinHelpInfo)(n),"function_definition"),a=(o=pxt.blocks.getBlockDefinition(s),i.FUNCTIONS_EDIT_OPTION=o.block.FUNCTIONS_EDIT_OPTION,(0,d.installBuiltinHelpInfo)(s),n="function_call",o=pxt.blocks.getBlockDefinition(n),i.FUNCTIONS_CALL_TITLE=o.block.FUNCTIONS_CALL_TITLE,i.FUNCTIONS_GO_TO_DEFINITION_OPTION=o.block.FUNCTIONS_GO_TO_DEFINITION_OPTION,(0,d.installBuiltinHelpInfo)(n),(0,d.installBuiltinHelpInfo)("function_call_output"),"function_return"),l=(h.Blocks[a]={init:function(){{var a=this;let i=pxt.blocks.getBlockDefinition("function_return"),n="0_add_button",o="0_rem_button",r=(h.Extensions.apply("inline-svgs",a,!1),!0),s;function l(){var e,t=a.getInput("RETURN_VALUE");if(r){if(!t){for(;a.getInput("");)a.removeInput("");a.jsonInit({message0:i.block.message_with_value,args0:[{type:"input_value",name:"RETURN_VALUE",check:null}],previousStatement:null,colour:pxt.toolbox.getNamespaceColor("functions")})}a.getInput(n)&&a.removeInput(n),a.getInput(o)||d(o,a.REMOVE_IMAGE_DATAURI,lf("Remove return value")),s&&((e=a.workspace.getBlockById(s))&&e.outputConnection&&!e.outputConnection.targetBlock()&&a.getInput("RETURN_VALUE").connection.connect(e.outputConnection),s=void 0)}else t&&((e=t.connection.targetBlock())&&(e.isShadow()&&e.setShadow(!1),t.connection.disconnect(),s=e.id),a.removeInput("RETURN_VALUE"),a.jsonInit({message0:i.block.message_no_value,args0:[],previousStatement:null,colour:pxt.toolbox.getNamespaceColor("functions")})),a.getInput(o)&&a.removeInput(o),a.getInput(n)||d(n,a.ADD_IMAGE_DATAURI,lf("Add return value"));a.setInputsInline(!0)}function c(){return h.Xml.domToText(a.mutationToDom())}function u(e,t){e!==t&&h.Events.fire(new h.Events.BlockChange(a,"mutation",null,e,t))}function d(e,t,i){a.appendDummyInput(e).appendField(new b.FieldImageNoText(t,24,24,i,()=>{var e=c(),t=(r=!r,c()),e=(u(e,t),l(),c());u(t,e)},!1))}l(),a.domToMutation=e=>{e.hasAttribute("last_connected_id")&&(s=e.getAttribute("last_connected_id")),r="true"!==e.getAttribute("no_return_value"),l()},a.mutationToDom=()=>{var e,t,i=document.createElement("mutation");return e=i,t=!!a.getInput("RETURN_VALUE"),e.setAttribute("no_return_value",t?"false":"true"),s&&i.setAttribute("last_connected_id",s),i}}},onchange:function(e){let t=this;var i,n;t.workspace&&!t.workspace.isFlyout&&(n=e.type===h.Events.BLOCK_CREATE&&-1!=e.ids.indexOf(t.id),i=e.type===h.Events.BLOCK_DRAG&&e.blocks.some(e=>e.id===t.id),n||i)&&(n=t.getRootBlock()).type!==a&&null==n.previousConnection&&n.type!==s&&(h.Events.setGroup(e.group),t.previousConnection.disconnect(),h.Events.setGroup(!1))}},(0,d.installBuiltinHelpInfo)(a),h.Procedures.flyoutCategory=_,{number:pxt.blocks.defaultIconForArgType("number"),boolean:pxt.blocks.defaultIconForArgType("boolean"),string:pxt.blocks.defaultIconForArgType("string"),Array:pxt.blocks.defaultIconForArgType("Array")}),c={};(i=pxt.appTarget.runtime&&pxt.appTarget.runtime.functionsOptions)&&i.extraFunctionEditorTypes&&i.extraFunctionEditorTypes.forEach(e=>{l[e.typeName]=e.icon||pxt.blocks.defaultIconForArgType(),e.defaultName&&(c[e.typeName]=e.defaultName)});for(e of Object.keys(l))p.FunctionManager.getInstance().setIconForType(e,l[e]);for(t of Object.keys(c))p.FunctionManager.getInstance().setArgumentNameForType(t,c[t]);h.Blocks.argument_reporter_custom&&(h.Blocks.argument_reporter_custom.domToMutation=function(e){e=e.getAttribute("typename");this.typeName_=e,(0,f.setOutputCheck)(this,e,f.cachedBlockInfo)});let u=h.Blocks.function_definition.makeCallOption;h.Blocks.function_definition.makeCallOption=function(){var e=u.call(this),t=this.getName();return e.text=pxt.Util.lf("Create 'call {0}'",t),e}}},{"../fields":70,"../fields/field_imagenotext":38,"../help":72,"../importer":73,"../loader":77,"../plugins/functions":111,"../toolbox":139,blockly:219}],4:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.initLists=void 0;let a=e("blockly"),l=e("../help"),c=e("../constants");i.initLists=function(){let e=a.Msg;var t="lists_create_with",i=pxt.blocks.getBlockDefinition(t),i=(e.LISTS_CREATE_EMPTY_TITLE=i.block.LISTS_CREATE_EMPTY_TITLE,e.LISTS_CREATE_WITH_INPUT_WITH=i.block.LISTS_CREATE_WITH_INPUT_WITH,e.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD=i.block.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD,e.LISTS_CREATE_WITH_ITEM_TITLE=i.block.LISTS_CREATE_WITH_ITEM_TITLE,(0,l.installBuiltinHelpInfo)(t),"lists_length"),t=pxt.blocks.getBlockDefinition(i);e.LISTS_LENGTH_TITLE=t.block.LISTS_LENGTH_TITLE,a.Blocks[i].init=function(){this.jsonInit({message0:e.LISTS_LENGTH_TITLE,args0:[{type:"input_value",name:"VALUE",check:["Array"]}],output:"Number",outputShape:c.provider.SHAPES.ROUND})},(0,l.installBuiltinHelpInfo)(i);let n="lists_index_get",o=pxt.blocks.getBlockDefinition(n),r=(a.Blocks.lists_index_get={init:function(){this.jsonInit({message0:o.block.message0,args0:[{type:"input_value",name:"LIST",check:"Array"},{type:"input_value",name:"INDEX",check:"Number"}],colour:pxt.toolbox.blockColors.arrays,outputShape:c.provider.SHAPES.ROUND,inputsInline:!0}),this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0),(0,l.setBuiltinHelpInfo)(this,n)}},"lists_index_set"),s=pxt.blocks.getBlockDefinition(r);a.Blocks[r]={init:function(){this.jsonInit({message0:s.block.message0,args0:[{type:"input_value",name:"LIST",check:"Array"},{type:"input_value",name:"INDEX",check:"Number"},{type:"input_value",name:"VALUE",check:null}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.blockColors.arrays,inputsInline:!0}),(0,l.setBuiltinHelpInfo)(this,r)}}}},{"../constants":18,"../help":72,blockly:219}],5:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.initLogic=void 0;let o=e("blockly"),r=e("../help");i.initLogic=function(){var e=o.Msg,t="controls_if",i=(n=pxt.blocks.getBlockDefinition(t)).tooltip,n=(e.CONTROLS_IF_MSG_IF=n.block.CONTROLS_IF_MSG_IF,e.CONTROLS_IF_MSG_THEN=n.block.CONTROLS_IF_MSG_THEN,e.CONTROLS_IF_MSG_ELSE=n.block.CONTROLS_IF_MSG_ELSE,e.CONTROLS_IF_MSG_ELSEIF=n.block.CONTROLS_IF_MSG_ELSEIF,e.CONTROLS_IF_TOOLTIP_1=i.CONTROLS_IF_TOOLTIP_1,e.CONTROLS_IF_TOOLTIP_2=i.CONTROLS_IF_TOOLTIP_2,e.CONTROLS_IF_TOOLTIP_3=i.CONTROLS_IF_TOOLTIP_3,e.CONTROLS_IF_TOOLTIP_4=i.CONTROLS_IF_TOOLTIP_4,(0,r.installBuiltinHelpInfo)(t),"logic_compare"),i=pxt.blocks.getBlockDefinition(n).tooltip,t=(e.LOGIC_COMPARE_TOOLTIP_EQ=i.LOGIC_COMPARE_TOOLTIP_EQ,e.LOGIC_COMPARE_TOOLTIP_NEQ=i.LOGIC_COMPARE_TOOLTIP_NEQ,e.LOGIC_COMPARE_TOOLTIP_LT=i.LOGIC_COMPARE_TOOLTIP_LT,e.LOGIC_COMPARE_TOOLTIP_LTE=i.LOGIC_COMPARE_TOOLTIP_LTE,e.LOGIC_COMPARE_TOOLTIP_GT=i.LOGIC_COMPARE_TOOLTIP_GT,e.LOGIC_COMPARE_TOOLTIP_GTE=i.LOGIC_COMPARE_TOOLTIP_GTE,(0,r.installBuiltinHelpInfo)(n),"logic_operation"),n=(i=pxt.blocks.getBlockDefinition(t)).tooltip,i=(e.LOGIC_OPERATION_AND=i.block.LOGIC_OPERATION_AND,e.LOGIC_OPERATION_OR=i.block.LOGIC_OPERATION_OR,e.LOGIC_OPERATION_TOOLTIP_AND=n.LOGIC_OPERATION_TOOLTIP_AND,e.LOGIC_OPERATION_TOOLTIP_OR=n.LOGIC_OPERATION_TOOLTIP_OR,(0,r.installBuiltinHelpInfo)(t),"logic_negate"),n=pxt.blocks.getBlockDefinition(i),t=(e.LOGIC_NEGATE_TITLE=n.block.LOGIC_NEGATE_TITLE,(0,r.installBuiltinHelpInfo)(i),"logic_boolean"),n=pxt.blocks.getBlockDefinition(t);e.LOGIC_BOOLEAN_TRUE=n.block.LOGIC_BOOLEAN_TRUE,e.LOGIC_BOOLEAN_FALSE=n.block.LOGIC_BOOLEAN_FALSE,(0,r.installBuiltinHelpInfo)(t)}},{"../help":72,blockly:219}],6:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.initLoops=void 0;let m=e("blockly"),b=e("../help"),_=e("../plugins/duplicateOnDrag");i.initLoops=function(){var e=m.Msg,t="controls_repeat_ext",i=pxt.blocks.getBlockDefinition(t);e.CONTROLS_REPEAT_TITLE=i.block.CONTROLS_REPEAT_TITLE,e.CONTROLS_REPEAT_INPUT_DO=i.block.CONTROLS_REPEAT_INPUT_DO,(0,b.installBuiltinHelpInfo)(t);let n="device_while",o=pxt.blocks.getBlockDefinition(n),r=(m.Blocks[n]={init:function(){this.jsonInit({message0:o.block.message0,args0:[{type:"input_value",name:"COND",check:"Boolean"}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.getNamespaceColor("loops")}),this.appendStatementInput("DO").appendField(o.block.appendField),(0,b.setBuiltinHelpInfo)(this,n)}},"pxt_controls_for"),s=pxt.blocks.getBlockDefinition(r),a=(m.Blocks[r]={init:function(){this.jsonInit({message0:s.block.message0,args0:[{type:"input_value",name:"VAR",variable:s.block.variable,check:"Variable"},{type:"input_value",name:"TO",check:"Number"}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.getNamespaceColor("loops"),inputsInline:!0}),this.appendStatementInput("DO").appendField(s.block.appendField);let e=this;(0,b.setHelpResources)(this,r,s.name,function(){return pxt.U.rlf(s.tooltip,e.getInputTargetBlock("VAR")?e.getInputTargetBlock("VAR").getField("VAR").getText():"")},s.url,String(pxt.toolbox.getNamespaceColor("loops")))},getVars:function(){return[this.getField("VAR").getText()]},renameVar:function(e,t){var i=this.getField("VAR");m.Names.equals(e,i.getText())&&i.setValue(t)}},(0,_.setDuplicateOnDrag)(r,"VAR"),"controls_simple_for"),l=pxt.blocks.getBlockDefinition(a),c=(m.Blocks[a]={init:function(){this.jsonInit({message0:l.block.message0,args0:[{type:"field_variable",name:"VAR",variable:l.block.variable,variableTypes:[""]},{type:"input_value",name:"TO",check:"Number"}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.getNamespaceColor("loops"),inputsInline:!0}),this.appendStatementInput("DO").appendField(l.block.appendField);let e=this;(0,b.setHelpResources)(this,a,l.name,function(){return pxt.U.rlf(l.tooltip,e.getField("VAR").getText())},l.url,String(pxt.toolbox.getNamespaceColor("loops")))},getVars:function(){return[this.getField("VAR").getText()]},renameVar:function(e,t){var i=this.getField("VAR");m.Names.equals(e,i.getText())&&i.setValue(t)},customContextMenu:function(e){var t,i,n;this.isCollapsed()||null!=(t=null==(t=this.workspace)?void 0:t.options)&&t.readOnly||(t={enabled:!0},n=this.getField("VAR").getText(),t.text=lf("Create 'get {0}'",n),(i=m.utils.xml.createElement("field")).textContent=n,i.setAttribute("name","VAR"),(n=m.utils.xml.createElement("block")).setAttribute("type","variables_get"),n.appendChild(i),t.callback=m.ContextMenu.callbackFactory(this,n),e.push(t))}},pxt.blocks.getBlockDefinition(ts.pxtc.TS_BREAK_TYPE)),u=(m.Blocks[pxtc.TS_BREAK_TYPE]={init:function(){var e=pxt.toolbox.getNamespaceColor("loops");this.jsonInit({message0:c.block.message0,inputsInline:!0,previousStatement:null,nextStatement:null,colour:e}),(0,b.setHelpResources)(this,ts.pxtc.TS_BREAK_TYPE,c.name,c.tooltip,c.url,e,void 0,void 0,!1)}},pxt.blocks.getBlockDefinition(ts.pxtc.TS_CONTINUE_TYPE)),d=(m.Blocks[pxtc.TS_CONTINUE_TYPE]={init:function(){var e=pxt.toolbox.getNamespaceColor("loops");this.jsonInit({message0:u.block.message0,inputsInline:!0,previousStatement:null,nextStatement:null,colour:e}),(0,b.setHelpResources)(this,ts.pxtc.TS_CONTINUE_TYPE,u.name,u.tooltip,u.url,e,void 0,void 0,!1)}},"#cccccc"),h=(m.Blocks[pxtc.COLLAPSED_BLOCK]={init:function(){this.jsonInit({message0:"...",inputsInline:!0,previousStatement:null,nextStatement:null,colour:d}),(0,b.setHelpResources)(this,ts.pxtc.COLLAPSED_BLOCK,"...",lf("a few blocks"),void 0,d,void 0,void 0,!1)}},"pxt_controls_for_of"),p=pxt.blocks.getBlockDefinition(h),g=(m.Blocks[h]={init:function(){this.jsonInit({message0:p.block.message0,args0:[{type:"input_value",name:"VAR",variable:p.block.variable,check:"Variable"},{type:"input_value",name:"LIST",check:["Array","String"]}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.blockColors.loops,inputsInline:!0}),this.appendStatementInput("DO").appendField(p.block.appendField);let e=this;(0,b.setHelpResources)(this,h,p.name,function(){return pxt.Util.rlf(p.tooltip,e.getInputTargetBlock("VAR")?e.getInputTargetBlock("VAR").getField("VAR").getText():"")},p.url,String(pxt.toolbox.getNamespaceColor("loops")))}},(0,_.setDuplicateOnDrag)(h,"VAR"),"controls_for_of"),f=pxt.blocks.getBlockDefinition(g);m.Blocks[g]={init:function(){this.jsonInit({message0:f.block.message0,args0:[{type:"field_variable",name:"VAR",variable:f.block.variable,variableTypes:[""]},{type:"input_value",name:"LIST",check:"Array"}],previousStatement:null,nextStatement:null,colour:pxt.toolbox.blockColors.loops,inputsInline:!0}),this.appendStatementInput("DO").appendField(f.block.appendField);let e=this;(0,b.setHelpResources)(this,g,f.name,function(){return pxt.Util.rlf(f.tooltip,e.getField("VAR").getText())},f.url,String(pxt.toolbox.getNamespaceColor("loops")))}}}},{"../help":72,"../plugins/duplicateOnDrag":91,blockly:219}],7:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.initMathRoundBlock=i.initMathOpBlock=i.initMath=void 0;let c=e("blockly"),u=e("../help"),d=e("../constants"),s=e("../composableMutations"),a=e("../fields/field_dropdown");function h(){let e=pxt.blocks.MATH_FUNCTIONS.unary.concat(pxt.blocks.MATH_FUNCTIONS.binary).concat(pxt.blocks.MATH_FUNCTIONS.infix);var t="math_js_op";let i=pxt.blocks.getBlockDefinition(t);function o(e,t){e=e.appendValueInput("ARG"+(t?1:0));e.setCheck("Number"),t&&(e.connection.setShadowDom((()=>{var e;return n||((n=document.createElement("shadow")).setAttribute("type","math_number"),(e=document.createElement("field")).setAttribute("name","NUM"),e.textContent="0",n.appendChild(e)),n})()),e.connection.respawnShadow_())}function r(e,t){var i=!!e.getInput("ARG1");t?(i&&e.moveInputBefore("op_dropdown","ARG1"),e.moveInputBefore("ARG0","op_dropdown")):(i&&e.moveInputBefore("ARG0","ARG1"),e.moveInputBefore("op_dropdown","ARG0"))}c.Blocks[t]={init:function(){let n=this;n.setPreviousStatement(!1),n.setNextStatement(!1),n.setOutput(!0,"Number"),n.setOutputShape(d.provider.SHAPES.ROUND),n.setInputsInline(!0),n.appendDummyInput("op_dropdown").appendField(new a.FieldDropdown(e.map(e=>[i.block[e],e]),e=>{var t=n;return(e=>-1!==pxt.blocks.MATH_FUNCTIONS.unary.indexOf(e))(e)?t.removeInput("ARG1",!0):t.getInput("ARG1")||o(t,!0),r(t,(e=>-1!==pxt.blocks.MATH_FUNCTIONS.infix.indexOf(e))(e)),e}),"OP"),o(n,!1),(0,s.appendMutation)(n,{mutationToDom:e=>{let t;for(let e=0;e<n.inputList.length;e++){var i=n.inputList[e];if("op_dropdown"===i.name){t=!1;break}if("ARG0"===i.name){t=!0;break}}return e.setAttribute("op-type",(n.getInput("ARG1")?t?"infix":"binary":"unary").toString()),e},domToMutation:e=>{e.hasAttribute("op-type")&&("unary"!=(e=e.getAttribute("op-type"))&&o(n,!0),r(n,"infix"===e))}})}},(0,u.installHelpResources)(t,i.name,function(e){return i.tooltip[e.getFieldValue("OP")]},i.url,pxt.toolbox.getNamespaceColor(i.category))}i.initMath=function(e){let t="math_op2",i=pxt.blocks.getBlockDefinition(t),n=i.tooltip,o=(c.Blocks[t]={init:function(){this.jsonInit({message0:lf("%1 of %2 and %3"),args0:[{type:"field_dropdown",name:"op",options:[[lf("{id:op}min"),"min"],[lf("{id:op}max"),"max"]]},{type:"input_value",name:"x",check:"Number"},{type:"input_value",name:"y",check:"Number"}],inputsInline:!0,output:"Number",outputShape:d.provider.SHAPES.ROUND,colour:pxt.toolbox.getNamespaceColor("math")}),(0,u.setHelpResources)(this,t,i.name,function(e){return n[e.getFieldValue("op")]},i.url,pxt.toolbox.getNamespaceColor(i.category))},codeCard:(0,u.attachCardInfo)(e,"Math.min")},"math_op3"),r=pxt.blocks.getBlockDefinition(o);c.Blocks[o]={init:function(){this.jsonInit({message0:r.block.message0,args0:[{type:"input_value",name:"x",check:"Number"}],inputsInline:!0,output:"Number",outputShape:d.provider.SHAPES.ROUND,colour:pxt.toolbox.getNamespaceColor("math")}),(0,u.setBuiltinHelpInfo)(this,o)},codeCard:(0,u.attachCardInfo)(e,"Math.abs")},["math_number","math_integer","math_whole_number","math_number_minmax"].forEach(e=>{var t=pxt.blocks.getBlockDefinition(e);(0,u.installHelpResources)(e,t.name,t.tooltip,t.url,"#fff","#fff","#fff")});var e=c.Msg,s="math_arithmetic",a=pxt.blocks.getBlockDefinition(s);let l=a.tooltip;e.MATH_ADDITION_SYMBOL=a.block.MATH_ADDITION_SYMBOL,e.MATH_SUBTRACTION_SYMBOL=a.block.MATH_SUBTRACTION_SYMBOL,e.MATH_MULTIPLICATION_SYMBOL=a.block.MATH_MULTIPLICATION_SYMBOL,e.MATH_DIVISION_SYMBOL=a.block.MATH_DIVISION_SYMBOL,e.MATH_POWER_SYMBOL=a.block.MATH_POWER_SYMBOL,(0,u.installHelpResources)(s,a.name,function(e){return l[e.getFieldValue("OP")]},a.url,pxt.toolbox.getNamespaceColor(a.category)),s="math_modulo",a=pxt.blocks.getBlockDefinition(s),e.MATH_MODULO_TITLE=a.block.MATH_MODULO_TITLE,(0,u.installBuiltinHelpInfo)(s),h(),p()},i.initMathOpBlock=h;let n;function p(){let t=pxt.blocks.ROUNDING_FUNCTIONS;var e="math_js_round";let i=pxt.blocks.getBlockDefinition(e);c.Blocks[e]={init:function(){var e=this;e.setPreviousStatement(!1),e.setNextStatement(!1),e.setOutput(!0,"Number"),e.setOutputShape(d.provider.SHAPES.ROUND),e.setInputsInline(!0),e.appendDummyInput("round_dropdown").appendField(new a.FieldDropdown(t.map(e=>[i.block[e],e])),"OP");e.appendValueInput("ARG0").setCheck("Number")}},(0,u.installHelpResources)(e,i.name,function(e){return i.tooltip[e.getFieldValue("OP")]},i.url,pxt.toolbox.getNamespaceColor(i.category))}i.initMathRoundBlock=p},{"../composableMutations":17,"../constants":18,"../fields/field_dropdown":34,"../help":72,blockly:219}],8:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.initOnStart=void 0;let n=e("blockly"),o=e("../fields"),s=e("../help");i.initOnStart=function(){let i=pxt.blocks.getBlockDefinition(ts.pxtc.ON_START_TYPE);if(n.Blocks[ts.pxtc.ON_START_TYPE]={init:function(){let e,t=null==(e=pxt.appTarget.runtime)?void 0:e.onStartColor;t=t&&pxt.toolbox.getAccessibleBackground(t),this.jsonInit({message0:i.block.message0,args0:[{type:"input_dummy"},{type:"input_statement",name:"HANDLER"}],colour:t||pxt.toolbox.getNamespaceColor("loops")}),(0,s.setHelpResources)(this,ts.pxtc.ON_START_TYPE,i.name,i.tooltip,i.url,t||pxt.toolbox.getNamespaceColor("loops"),void 0,void 0,!!pxt.appTarget.runtime&&pxt.appTarget.runtime.onStartUnDeletable)}},n.Blocks[pxtc.TS_STATEMENT_TYPE]={init:function(){let o=this;o.setColour("#717171"),o.setPreviousStatement(!0),o.setNextStatement(!0),o.setInputsInline(!1);let t,r;o.domToMutation=t=>{var i=parseInt(t.getAttribute("numlines"));o.declaredVariables=t.getAttribute("declaredvars"),r=[];for(let e=0;e<i;e++){var n=t.getAttribute("line"+e);r.push(n)}o.setPythonEnabled(!1)},o.mutationToDom=()=>{let i=document.createElement("mutation");return r&&(r.forEach((e,t)=>i.setAttribute("line"+t,e)),i.setAttribute("numlines",r.length.toString())),o.declaredVariables&&i.setAttribute("declaredvars",this.declaredVariables),i},o.setPythonEnabled=e=>{if(t!==e){for(;o.inputList.length;)o.removeInput(o.inputList[0].name);(t=e)?(o.appendDummyInput().appendField(pxt.Util.lf("<python code>"),"LINE0"),o.setTooltip(lf("A Python statement that could not be converted to blocks"))):(r.forEach((e,t)=>{o.appendDummyInput().appendField(e,"LINE"+t)}),o.setTooltip(lf("A JavaScript statement that could not be converted to blocks")))}},o.getLines=()=>r,o.setEditable(!1),(0,s.setHelpResources)(this,pxtc.TS_STATEMENT_TYPE,lf("JavaScript statement"),lf("A JavaScript statement that could not be converted to blocks"),"/blocks/javascript-blocks","#717171")}},n.Blocks[pxtc.TS_OUTPUT_TYPE]={init:function(){let t=this;t.setColour("#717171"),t.setPreviousStatement(!1),t.setNextStatement(!1),t.setOutput(!0),t.setEditable(!1),t.appendDummyInput().appendField(new o.FieldTsExpression(""),"EXPRESSION"),t.setPythonEnabled=e=>{t.getField("EXPRESSION").setPythonEnabled(e),e?t.setTooltip(lf("A Python expression that could not be converted to blocks")):t.setTooltip(lf("A JavaScript expression that could not be converted to blocks"))},(0,s.setHelpResources)(t,pxtc.TS_OUTPUT_TYPE,lf("JavaScript expression"),lf("A JavaScript expression that could not be converted to blocks"),"/blocks/javascript-blocks","#717171")}},pxt.appTarget.runtime&&pxt.appTarget.runtime.pauseUntilBlock){let t=pxt.appTarget.runtime.pauseUntilBlock,i=pxt.blocks.getBlockDefinition(ts.pxtc.PAUSE_UNTIL_TYPE);n.Blocks[pxtc.PAUSE_UNTIL_TYPE]={init:function(){var e=t.color||pxt.toolbox.getNamespaceColor("loops");this.jsonInit({message0:i.block.message0,args0:[{type:"input_value",name:"PREDICATE",check:"Boolean"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:e}),(0,s.setHelpResources)(this,ts.pxtc.PAUSE_UNTIL_TYPE,i.name,i.tooltip,i.url,e,void 0,void 0,!1)}}}}},{"../fields":70,"../help":72,blockly:219}],9:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.initText=void 0;let n=e("blockly"),o=e("../help"),r=e("../constants");i.initText=function(){var e=pxt.blocks.getBlockDefinition("text"),e=((0,o.installHelpResources)("text",e.name,e.tooltip,e.url,"#fff","#fff","#fff"),"text_length"),t=pxt.blocks.getBlockDefinition(e);n.Msg.TEXT_LENGTH_TITLE=t.block.TEXT_LENGTH_TITLE,n.Blocks[e].init=function(){this.jsonInit({message0:n.Msg.TEXT_LENGTH_TITLE,args0:[{type:"input_value",name:"VALUE",check:["String"]}],output:"Number",outputShape:r.provider.SHAPES.ROUND})},(0,o.installBuiltinHelpInfo)(e),t="text_join",e=pxt.blocks.getBlockDefinition(t),n.Msg.TEXT_JOIN_TITLE_CREATEWITH=e.block.TEXT_JOIN_TITLE_CREATEWITH,(0,o.installBuiltinHelpInfo)(t)}},{"../constants":18,"../help":72,blockly:219}],10:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0}),o.initVariables=o.CREATE_VAR_BTN_ID=void 0;let l=e("blockly"),c=e("../toolbox"),a=e("../help");function u(e,t){let i=[];pxt.appTarget.appTheme.hideFlyoutHeadings||(n=(0,c.createFlyoutHeadingLabel)(lf("Variables"),pxt.toolbox.getNamespaceColor("variables"),pxt.toolbox.getNamespaceIcon("variables")),i.push(n));var n=document.createElement("button"),n=(n.setAttribute("text",lf("Make a Variable...")),n.setAttribute("callbackKey","CREATE_VARIABLE"),n.setAttribute("id",o.CREATE_VAR_BTN_ID),e.registerButtonCallback("CREATE_VARIABLE",function(e){l.Variables.createVariableButtonHandler(e.getTargetWorkspace())}),i.push(n),l.Variables.flyoutCategoryBlocks(e));return i=i.concat(n)}o.CREATE_VAR_BTN_ID="create-variable-btn",o.initVariables=function(){let e=lf("{id:var}item");l.Variables.flyoutCategory=u,l.Variables.flyoutCategoryBlocks=function(e){var t=e.getVariableMap().getVariablesOfType(""),i=[];if(0<t.length){var n,o,r,s,e=t[t.length-1];t.sort(l.Variables.compareByName);for(let e=0;e<t.length;e++){var a=t[e];l.Blocks.variables_get&&((a=(0,c.mkVariableFieldBlock)("variables_get",a.getId(),a.getType(),a.getName(),!1)).setAttribute("gap","8"),i.push(a))}i[i.length-1].setAttribute("gap","24"),(l.Blocks.variables_change||l.Blocks.variables_set)&&i.unshift((0,c.createFlyoutGroupLabel)(lf("Your Variables"))),l.Blocks.variables_change&&(r=l.Blocks.variables_get?20:8,(s=(0,c.mkVariableFieldBlock)("variables_change",e.getId(),e.getType(),e.getName(),!1)).setAttribute("gap",r+""),(r=l.utils.xml.createElement("value")).setAttribute("name","VALUE"),(n=l.utils.xml.createElement("shadow")).setAttribute("type","math_number"),r.appendChild(n),(o=l.utils.xml.createElement("field")).setAttribute("name","NUM"),o.appendChild(document.createTextNode("1")),n.appendChild(o),s.appendChild(r),i.unshift(s)),l.Blocks.variables_set&&(n=l.Blocks.variables_change?8:24,(o=(0,c.mkVariableFieldBlock)("variables_set",e.getId(),e.getType(),e.getName(),!1)).setAttribute("gap",n+""),(r=l.utils.xml.createElement("value")).setAttribute("name","VALUE"),(s=l.utils.xml.createElement("shadow")).setAttribute("type","math_number"),r.appendChild(s),(e=l.utils.xml.createElement("field")).setAttribute("name","NUM"),e.appendChild(document.createTextNode("0")),s.appendChild(e),o.appendChild(r),i.unshift(o))}return i};var t=l.Msg;let i="variables_get";var n=pxt.blocks.getBlockDefinition(i);t.VARIABLES_GET_CREATE_SET=n.block.VARIABLES_GET_CREATE_SET,l.Blocks[i]={init:function(){this.jsonInit({type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}",variableTypes:[""]}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]}),(0,a.setBuiltinHelpInfo)(this,i)}},(0,a.installBuiltinHelpInfo)("variables_get_reporter"),t.RENAME_VARIABLE=lf("Rename variable..."),t.DELETE_VARIABLE=lf('Delete the "%1" variable'),t.DELETE_VARIABLE_CONFIRMATION=lf('Delete %1 uses of the "%2" variable?'),t.NEW_VARIABLE_DROPDOWN=lf("New variable...");let o="variables_set",r=(n=pxt.blocks.getBlockDefinition(o),t.VARIABLES_SET=n.block.VARIABLES_SET,t.VARIABLES_DEFAULT_NAME=e,t.VARIABLES_SET_CREATE_GET=lf("Create 'get %1'"),l.Blocks[o]={init:function(){this.jsonInit({type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}",variableTypes:[""]},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}),(0,a.setBuiltinHelpInfo)(this,o)}},"variables_change"),s=pxt.blocks.getBlockDefinition(r);l.Blocks[r]={init:function(){this.jsonInit({message0:s.block.message0,args0:[{type:"field_variable",name:"VAR",variable:e,variableTypes:[""]},{type:"input_value",name:"VALUE",check:"Number"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:pxt.toolbox.getNamespaceColor("variables")}),(0,a.setBuiltinHelpInfo)(this,r)},customContextMenu:function(e){var t,i,n;null!=(t=null==(t=this.workspace)?void 0:t.options)&&t.readOnly||this.isInFlyout||(t={enabled:0<this.workspace.remainingCapacity()},n=this.getField("VAR").getText(),t.text=lf("Create 'get {0}'",n),(i=l.utils.xml.createElement("field")).textContent=n,i.setAttribute("name","VAR"),(n=l.utils.xml.createElement("block")).setAttribute("type","variables_get"),n.appendChild(i),t.callback=l.ContextMenu.callbackFactory(this,n),e.push(t))}},t.NEW_VARIABLE_TITLE=lf("New variable name:"),t.RENAME_VARIABLE_TITLE=lf("Rename all '%1' variables to:")}},{"../help":72,"../toolbox":139,blockly:219}],11:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.renderCodeCard=void 0;let a=e("./render");i.renderCodeCard=function(t,i={}){var n=!!(r=t.url?/^[^:]+:\/\//.test(t.url)?t.url:"/"+t.url.replace(/^\.?\/?/,""):t.youTubeId?"https://youtu.be/"+t.youTubeId:void 0),o=(e,t,i="div",n="")=>{i=document.createElement(i);return t&&(i.className=t),e&&e.appendChild(i),n&&i.appendChild(document.createTextNode(n+"")),i},e=o(null,"ui "+(t.style||"card")+" "+(t.color||"")+(n?" link":""),n?"a":"div"),n=(i.role&&e.setAttribute("role",i.role),"option"===i.role&&e.setAttribute("aria-selected","true"),n&&((n=e).href=r,/^https?:\/\//.test(r))&&(n.target="_blank"),!i.hideHeader&&t.header&&(r=o(e,"ui content "+(t.responsive?" tall desktop only":"")),t.header)&&o(r,"description","span",t.header),(i.shortName?t.shortName:"")||t.name),r=o(e,"ui image"+(t.responsive?" tall landscape only":""));if(t.label&&((i=document.createElement("label")).className=`ui ${t.labelClass||"orange right ribbon"} label`,i.textContent=t.label,r.appendChild(i)),t.blocksXml&&((i=(0,a.render)(t.blocksXml))?((s=o(r,"")).setAttribute("style","width:100%; min-height:10em"),s.appendChild(i)):(pxt.error("failed to render blocks"),pxt.debug(t.blocksXml))),t.typeScript&&((s=document.createElement("pre")).appendChild(document.createTextNode(t.typeScript)),r.appendChild(s)),(i=t.imageUrl||(t.youTubeId?`https://img.youtube.com/vi/${t.youTubeId}/0.jpg`:void 0))&&((s=document.createElement("div")).className="ui imagewrapper",(i=document.createElement("div")).className="ui cardimage",i.style.backgroundImage=`url("${t.imageUrl}")`,i.title=n,i.setAttribute("role","presentation"),s.appendChild(i),r.appendChild(s)),"file"==t.cardType&&(i=o(e,"ui fileimage"),r.appendChild(i)),n||t.description){var s=o(e,"ui content");if(n&&(e.setAttribute("aria-label",n),o(s,"header","div",n)),t.description){r=o(s,"ui description"),i=/((?:\.{1,3})|[\!\?â€¦])/.exec(t.description);let e=t.description+".";i&&(n=i[1],e=t.description.split(n)[0]+n),r.appendChild(document.createTextNode(e))}}return t.time&&(s=o(e,"meta"),t.time)&&o(s,"date","span").appendChild(document.createTextNode(pxt.Util.timeSince(t.time))),t.extracontent&&o(e,"extra content","div").appendChild(document.createTextNode(t.extracontent)),e}},{"./render":137}],12:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.workerOpAsync=n.compileExpression=n.AUTO_DISABLED_REASON=n.callKey=n.compileAsync=n.compileBlockAsync=n.PXT_WARNING_ID=void 0;let d=e("blockly"),x=e("./environment"),R=e("./typeChecker"),O=e("./util"),u=e("../toolbox"),A=e("../legacyMutations"),h=e("./variables"),p=e("../fields");function g(e,t){var i;return e.type===ts.pxtc.ON_START_TYPE?0:(i=t.stdCallTable[e.type],t=f(0,e),e=1+ts.pxtc.Util.codalHash16(t),i&&i.attrs.afterOnStart?e:-e)}function f(e,t){return t.type==ts.pxtc.ON_START_TYPE?JSON.stringify({name:ts.pxtc.ON_START_TYPE}):t.type==ts.pxtc.FUNCTION_DEFINITION_TYPE?JSON.stringify({type:"function",name:t.getFieldValue("function_name")}):JSON.stringify(function e(t){let i=[];let n=[];for(var o of t.inputList){for(var r of o.fieldRow)r.name&&i.push(r.getText());o.type===d.inputs.inputTypes.VALUE&&(o.connection.targetBlock()?n.push(e(o.connection.targetBlock())):n.push(null))}return{type:t.type,fields:i,inputs:n}}(t)).replace(/"id"\s*:\s*"[^"]+"/g,"")}function m(e,t){var i;e.setDisabledReason(!t,n.AUTO_DISABLED_REASON);for(i of e.getDescendants(!1))i.setDisabledReason(!t,n.AUTO_DISABLED_REASON)}function b(e){e.setDisabledReason(!1,n.AUTO_DISABLED_REASON),e.setDisabledReason(!1,d.constants.MANUALLY_DISABLED),e.setDisabledReason(!1,"ORPHANED_BLOCK")}function _(e,t){if(t.isInsertionMarker())return[];let i;var n,o,r,s,a,l,c,u,d,h,p,g,f,m,b,_,y,v=[];switch(e.stats[t.type]=(e.stats[t.type]||0)+1,M(t,v),t.type){case"controls_if":i=((i,n,o)=>{var e,r=[];for(let t=0;t<=n.elseifCount_;++t){var s=N(i,(0,O.getInputTargetBlock)(i,n,"IF"+t),o),a=L(i,(0,O.getInputTargetBlock)(i,n,"DO"+t));let e=pxt.blocks.mkText("if (");0<t&&((e=pxt.blocks.mkText("else if (")).glueToBlock=pxt.blocks.GlueMode.WithSpace),(0,O.append)(r,[e,s,pxt.blocks.mkText(")"),a])}return n.elseCount_&&((e=pxt.blocks.mkText("else")).glueToBlock=pxt.blocks.GlueMode.WithSpace,(0,O.append)(r,[e,L(i,(0,O.getInputTargetBlock)(i,n,"ELSE"))])),r})(e,t,v);break;case"pxt_controls_for":case"controls_for":case"controls_simple_for":i=(h=e,p=t,g=v,f=(0,O.getInputTargetBlock)(h,p,"TO"),m=(0,O.getInputTargetBlock)(h,p,"DO"),b=(0,O.getInputTargetBlock)(h,p,"BY"),_=(0,O.getInputTargetBlock)(h,p,"FROM"),y=!b||b.type.match(/^math_number/)&&1==F(b),p=(0,R.lookup)(h,p,(0,O.getLoopVariableField)(h,p).getField("VAR").getText()),[pxt.blocks.mkText("for (let "+p.escapedName+" = "),_?N(h,_,g):pxt.blocks.mkText("0"),pxt.blocks.mkText("; "),pxt.blocks.mkInfix(pxt.blocks.mkText(p.escapedName),"<=",N(h,f,g)),pxt.blocks.mkText("; "),y?pxt.blocks.mkText(p.escapedName+"++"):pxt.blocks.mkInfix(pxt.blocks.mkText(p.escapedName),"+=",N(h,b,g)),pxt.blocks.mkText(")"),L(h,m)]);break;case"pxt_controls_for_of":case"controls_for_of":i=((e,t,i)=>{let n=(0,O.getInputTargetBlock)(e,t,"LIST"),o=(0,O.getInputTargetBlock)(e,t,"DO"),r;return r=n&&"placeholder"!==n.type?N(e,n,i):pxt.blocks.mkText("[0]"),i=(0,R.lookup)(e,t,(0,O.getLoopVariableField)(e,t).getField("VAR").getText()),[pxt.blocks.mkText("for (let "+i.escapedName+" of "),r,pxt.blocks.mkText(")"),L(e,o)]})(e,t,v);break;case"variables_set":i=[((t,e,i)=>{let n=(0,O.getInputTargetBlock)(t,e,"VALUE"),o=(0,R.lookup)(t,e,e.getField("VAR").getText()),r=t.idToScope[e.id],s=r.declaredVars[o.name]===o&&!o.firstReference&&!o.alreadyDeclared,a=(s&&(0,O.forEachChildExpression)(e,e=>{"variables_get"===e.type&&(0,R.lookup)(t,e,e.getField("VAR").getText())===o&&(s=!1)},!0),N(t,n,i)),l=o.escapedName+" = ";var c;return o.isAssigned=!0,s?(o.alreadyDeclared=x.BlockDeclarationType.Assigned,i=(0,R.getConcreteType)(o.type),l=`let ${o.escapedName} = `,i&&(c=(0,R.getConcreteType)((0,R.returnType)(t,n)),i.type!==c.type)&&(l=`let ${o.escapedName}: ${i.type} = `)):o.firstReference||(o.firstReference=e),pxt.blocks.mkStmt(pxt.blocks.mkText(l),a)})(e,t,v)];break;case"variables_change":i=[(_=e,f=t,y=v,p=(0,O.getInputTargetBlock)(_,f,"VALUE"),f=(0,R.lookup)(_,f,f.getField("VAR").getText()),_=N(_,p,y),p=pxt.blocks.mkText(f.escapedName),pxt.blocks.mkStmt(pxt.blocks.mkInfix(p,"+=",_)))];break;case"controls_repeat_ext":i=((t,i,e)=>{let n=N(t,(0,O.getInputTargetBlock)(t,i,"TIMES"),e),o=L(t,(0,O.getInputTargetBlock)(t,i,"DO")),r="index";for(let e=2;!(e=>!(0,R.lookup)(t,i,e))(r);e++)r="index"+e;return[pxt.blocks.mkText("for (let "+r+" = 0; "),pxt.blocks.mkInfix(pxt.blocks.mkText(r),"<",n),pxt.blocks.mkText("; "+r+"++)"),o]})(e,t,v);break;case"device_while":i=((e,t,i)=>(i=N(e,(0,O.getInputTargetBlock)(e,t,"COND"),i),e=L(e,(0,O.getInputTargetBlock)(e,t,"DO")),[pxt.blocks.mkText("while ("),i,pxt.blocks.mkText(")"),e]))(e,t,v);break;case"procedures_defnoreturn":i=(b=e,g=t,h=(0,O.escapeVarName)(g.getFieldValue("NAME"),b,!0),g=(0,O.getInputTargetBlock)(b,g,"STACK"),[pxt.blocks.mkText("function "+h+"() "),L(b,g)]);break;case"function_definition":i=(a=e,l=t,m=(0,O.escapeVarName)(l.getField("function_name").getText(),a,!0),c=(0,O.getInputTargetBlock)(a,l,"STACK"),u=l.getArguments().map(e=>{var t;return"Array"==e.type?(t=(0,R.lookup)(a,l,e.name),t=null!=(t=(0,R.getConcreteType)(t.type))&&t.type&&"Array"!==t.type?t.type:"any[]",(0,O.escapeVarName)(e.name,a)+": "+t):(0,O.escapeVarName)(e.name,a)+": "+e.type}),d=(0,R.isFunctionRecursive)(a,l,!1),[pxt.blocks.mkText(`function ${m} (${u.join(", ")})`+(d?": any":"")),L(a,c)]);break;case"procedures_callnoreturn":i=[((e,t)=>(t=(0,O.escapeVarName)(t.getFieldValue("NAME"),e,!0),pxt.blocks.mkStmt(pxt.blocks.mkText(t+"()"))))(e,t)];break;case"function_call":i=[$(e,t,v,!0)];break;case pxtc.TS_RETURN_STATEMENT_TYPE:i=[((e,t,i)=>(t=(0,O.getInputTargetBlock)(e,t,"RETURN_VALUE"))&&"placeholder"!=t.type?pxt.blocks.mkStmt(pxt.blocks.mkText("return "),N(e,t,i)):pxt.blocks.mkStmt(pxt.blocks.mkText("return")))(e,t,v)];break;case ts.pxtc.ON_START_TYPE:i=((e,t)=>(t=(0,O.getInputTargetBlock)(e,t,"HANDLER"),e=L(e,t),pxt.appTarget.compile&&pxt.appTarget.compile.onStartText&&e&&e.children&&e.children.unshift(pxt.blocks.mkStmt(pxt.blocks.mkText(`// ${pxtc.ON_START_COMMENT}
`))),e))(e,t).children;break;case pxtc.TS_STATEMENT_TYPE:i=t.getLines().map(e=>pxt.blocks.mkText(e+"\n"));break;case pxtc.PAUSE_UNTIL_TYPE:i=(u=e,d=t,c=v,s=pxt.appTarget.runtime&&pxt.appTarget.runtime.pauseUntilBlock,pxt.U.assert(!!s,"target has block enabled"),T=s.namespace,s=s.callName||"pauseUntil",u=P(u,d,{definitionName:"PREDICATE",actualName:"PREDICATE"},c),d=[pxt.blocks.mkGroup([pxt.blocks.mkText("() => "),u])],T?[pxt.blocks.mkStmt(pxt.blocks.H.namespaceCall(T,s,d,!1))]:[pxt.blocks.mkStmt(pxt.blocks.H.mkCall(s,d,!1,!1))]);break;case pxtc.TS_DEBUGGER_TYPE:i="1"!=t.getFieldValue("ON_OFF")?[]:[pxt.blocks.mkText("debugger;\n")];break;case pxtc.TS_BREAK_TYPE:i=[pxt.blocks.mkText("break;\n")];break;case pxtc.TS_CONTINUE_TYPE:i=[pxt.blocks.mkText("continue;\n")];break;default:var T=e.stdCallTable[t.type];i=T?[(o=t,r=v,(s=(n=e).stdCallTable[o.type]).imageLiteral?pxt.blocks.mkStmt(D(0,o,s.imageLiteral,s.imageLiteralColumns,s.imageLiteralRows,s.namespace,s.f,(0,O.visibleParams)(s,(0,O.countOptionals)(o,s)).map(e=>P(n,o,e,r)))):s.hasHandler?((t,i,n,o,r,s)=>{var e,o=o.map(e=>P(t,i,e,s)),a=(0,O.getInputTargetBlock)(t,i,"HANDLER"),a=L(t,a);pxt.appTarget.compile&&pxt.appTarget.compile.emptyEventHandlerComments&&0===a.children.length&&a.children.unshift(pxt.blocks.mkStmt(pxt.blocks.mkText("// "+pxtc.HANDLER_COMMENT)));let l,c=((0,O.isMutatingBlock)(i)&&i.mutation.getMutationType()===A.MutatorTypes.ObjectDestructuringMutator?l=i.mutation.compileMutation(t,s):n.comp.handlerArgs.length&&(e=(0,R.getEscapedCBParameters)(i,n,t),l=pxt.blocks.mkText(`function (${e.join(", ")})`)),r),u=n.f;n.attrs.blockAliasFor&&(e=t.blocksInfo.apis.byQName[n.attrs.blockAliasFor])&&(u=e.name,c=e.namespace);{var[r,o,a,n,d,h=!1]=[c,u,o,a,l,n.isExtensionMethod];n.noFinalNewline=!0;let e;return e=d?pxt.blocks.mkGroup([d,n]):pxt.blocks.mkGroup([pxt.blocks.mkText("function ()"),n]),h?pxt.blocks.mkStmt(pxt.blocks.H.extensionCall(o,a.concat([e]),!1)):r?pxt.blocks.mkStmt(pxt.blocks.H.namespaceCall(r,o,a.concat([e]),!1)):pxt.blocks.mkStmt(pxt.blocks.H.mkCall(o,a.concat([e]),!1))}})(n,o,s,((e,t)=>(0,O.visibleParams)(e,(0,O.countOptionals)(t,e)).filter(e=>!!e.definitionName))(s,o),s.namespace,r):pxt.blocks.mkStmt(B(n,o,s,r)))]:[pxt.blocks.mkStmt(N(e,t,v))]}var E=i[i.length-1];if(E&&!E.id&&(E.id=t.id),v.length){var k,C,I=i,w=[];for(k of v)for(var S of k.split("\n"))w.push(pxt.blocks.mkText("// "+S)),w.push(pxt.blocks.mkNewLine());for(C of w.reverse())I.unshift(C)}return i.forEach(e=>{!(e.type===pxt.blocks.NT.Block||e.type===pxt.blocks.NT.Prefix&&pxt.Util.startsWith(e.op,"//"))||t.type==pxtc.ON_START_TYPE&&e.id||(e.id=t.id)}),i}function N(t,i,n){pxt.U.assert(null!=i),t.stats[i.type]=(t.stats[i.type]||0)+1,M(i,n);let o;var e,r,s,a,l,c,u,d,h,p,g,f,m;if("placeholder"!=i.type&&i.isEnabled&&i.isEnabled())switch(i.type){case"math_number":case"math_integer":case"math_whole_number":case"math_number_minmax":o=I(0,i);break;case"math_op2":o=(h=t,g=n,f=(p=i).getFieldValue("op"),m=N(h,(0,O.getInputTargetBlock)(h,p,"x"),g),h=N(h,(0,O.getInputTargetBlock)(h,p,"y"),g),pxt.blocks.H.mathCall(f,[m,h]));break;case"math_op3":o=((e,t,i)=>(e=N(e,(0,O.getInputTargetBlock)(e,t,"x"),i),pxt.blocks.H.mathCall("abs",[e])))(t,i,n);break;case"math_arithmetic":case"logic_compare":case"logic_operation":o=((e,t,i)=>{let n=t.getFieldValue("OP"),o=(0,O.getInputTargetBlock)(e,t,"A"),r=(0,O.getInputTargetBlock)(e,t,"B"),s=[N(e,o,i),N(e,r,i)];if(-1!==["LT","LTE","GT","GTE","EQ","NEQ"].indexOf(n)&&C(e,o)&&C(e,r)&&pxt.blocks.flattenNode([s[0]]).output!==pxt.blocks.flattenNode([s[1]]).output&&(s=s.map(e=>pxt.blocks.H.mkParenthesizedExpression(pxt.blocks.mkGroup([e,pxt.blocks.mkText(" as any")])))),t=(0,R.returnType)(e,o),(0,R.isStringType)(t)){if("EQ"==n)return pxt.blocks.H.mkSimpleCall("==",s);if("NEQ"==n)return pxt.blocks.H.mkSimpleCall("!=",s)}else if((0,R.isBooleanType)(t))return pxt.blocks.H.mkSimpleCall(E[n],s);return pxt.U.assert(n in E),pxt.blocks.H.mkSimpleCall(E[n],s)})(t,i,n);break;case"math_modulo":o=(p=t,g=i,f=n,m=(0,O.getInputTargetBlock)(p,g,"DIVIDEND"),g=(0,O.getInputTargetBlock)(p,g,"DIVISOR"),m=[N(p,m,f),N(p,g,f)],pxt.blocks.H.mkSimpleCall("%",m));break;case"logic_boolean":o=pxt.blocks.H.mkBooleanLiteral("TRUE"==i.getFieldValue("BOOL"));break;case"logic_negate":o=((e,t,i)=>(e=N(e,(0,O.getInputTargetBlock)(e,t,"BOOL"),i),pxt.blocks.mkPrefix("!",[pxt.blocks.H.mkParenthesizedExpression(e)])))(t,i,n);break;case"variables_get":case"variables_get_reporter":o=((e,t)=>{let i=t.getField("VAR").getText(),n=(0,R.lookup)(e,t,i);return n?(n.firstReference||(n.firstReference=t),pxt.U.assert(null!=n&&null!=n.type),pxt.blocks.mkText(n.escapedName)):pxt.blocks.mkText(i)})(t,i);break;case"text":o=pxt.blocks.H.mkStringLiteral(i.getFieldValue("TEXT"));break;case"text_join":o=((e,t,i)=>{let n,o=0;for(;;){var r=(0,O.getInputTargetBlock)(e,t,"ADD"+o);if(o++,!r){if(o<t.inputList.length)continue;break}var s=N(e,r,i);n=n?pxt.blocks.H.mkSimpleCall("+",[n,s]):0===r.type.indexOf("text")?s:pxt.blocks.H.mkSimpleCall("+",[pxt.blocks.H.mkStringLiteral(""),s])}return n||pxt.blocks.H.mkStringLiteral("")})(t,i,n);break;case"lists_create_with":o=(c=t,u=n,d=(h=i).inputList.map(e=>e.connection&&e.connection.targetBlock()?N(c,e.connection.targetBlock(),u):void 0).filter(e=>!!e),pxt.blocks.H.mkArrayLiteral(d,!h.getInputsInline()));break;case"lists_index_get":o=(d=t,s=i,a=n,l=(0,O.getInputTargetBlock)(d,s,"LIST"),l=N(d,l,a),d=N(d,(0,O.getInputTargetBlock)(d,s,"INDEX"),a),s=pxt.blocks.mkGroup([l,pxt.blocks.mkText("["),d,pxt.blocks.mkText("]")]));break;case"lists_index_set":o=(a=t,l=i,s=n,e=(0,O.getInputTargetBlock)(a,l,"LIST"),b=N(a,e,s),r=N(a,(0,O.getInputTargetBlock)(a,l,"INDEX"),s),a=N(a,(0,O.getInputTargetBlock)(a,l,"VALUE"),s),l=pxt.blocks.mkGroup([b,pxt.blocks.mkText("["),r,pxt.blocks.mkText("] = "),a]),"lists_create_with"===e.type?y(l):l);break;case"math_js_op":case"math_js_round":o=((e,t,i)=>{var n=t.getFieldValue("OP"),o=[N(e,(0,O.getInputTargetBlock)(e,t,"ARG0"),i)];return t.getInput("ARG1")&&o.push(N(e,(0,O.getInputTargetBlock)(e,t,"ARG1"),i)),pxt.blocks.H.mathCall(n,o)})(t,i,n);break;case pxtc.TS_OUTPUT_TYPE:o=pxt.blocks.mkText(i.getFieldValue("EXPRESSION").trim());break;case"argument_reporter_boolean":case"argument_reporter_number":case"argument_reporter_string":case"argument_reporter_array":case"argument_reporter_custom":o=((e,t)=>(t=(0,O.escapeVarName)(t.getFieldValue("VALUE"),e),pxt.blocks.mkText(t)))(t,i);break;case"function_call_output":o=$(t,i,n,!1);break;default:var b=t.stdCallTable[i.type];o=b?b.imageLiteral?D(0,i,b.imageLiteral,b.imageLiteralColumns,b.imageLiteralRows,b.namespace,b.f,(0,O.visibleParams)(b,(0,O.countOptionals)(i,b)).map(e=>P(t,i,e,n))):B(t,i,b,n):(pxt.reportError("blocks","unable to compile expression",{details:i.type}),(0,R.defaultValueForType)((0,R.returnType)(t,i)))}else if("Array"===(0,R.find)((0,R.returnType)(t,i)).type){let e="lists_index_get"===i.getParent().type;e||(_=t.stdCallTable[i.getParent().type],e=_&&_.isExpression);var _=pxt.blocks.mkText("[0]");o=e?_:y(_)}else o=(0,R.defaultValueForType)((0,R.returnType)(t,i));return o.id=i.id,o}function L(t,e){let i=[];for(var n=e;e;)e.isEnabled()&&(0,O.append)(i,_(t,e)),e=e.getNextBlock();return n&&t.blockDeclarations[n.id]&&t.blockDeclarations[n.id].filter(e=>!e.alreadyDeclared).forEach(e=>{i.unshift(v(e,t.blocksInfo)),e.alreadyDeclared=x.BlockDeclarationType.Implicit}),pxt.blocks.mkBlock(i)}function y(e){var t=pxt.blocks.mkStmt(pxt.blocks.mkText(";"));return t.glueToBlock=pxt.blocks.GlueMode.NoSpace,pxt.blocks.mkGroup([t,e])}function D(e,t,i,n,o,r,s,a){a=void 0===a?[]:a;let l="\n",c=(o=o||5,n=(n||5)*i,t.getFieldValue("LEDS"));c=c.replace(/[ `\n]+/g,"");for(let t=0;t<o;++t){for(let e=0;e<n;++e)0<e&&(l+=" "),l+="#"===c[t*n+e]?"#":".";l+="\n"}i=pxt.blocks.H.mkStringLiteral(l);return i.canIndentInside=!0,pxt.blocks.H.namespaceCall(r,s,[i].concat(a),!1)}function o(e,t,i){let n=pxt.blocks.flattenNode(t);return r("format",{format:{input:n.output,pos:1}}).then(()=>({source:n.output,sourceMap:n.sourceMap,stats:e.stats,diagnostics:i||[]}))}function M(e,t){var i=null==(i=e.getCommentText)?void 0:i.call(e);i&&t.push(i)}function v(e,t){var i=(0,R.getConcreteType)(e.type);let n,o="";if("null"==(n="Array"===i.type?pxt.blocks.mkText("[]"):(0,R.defaultValueForType)(i)).op||"[]"==n.op){let e=i.type;"Array"!==e&&"null[]"!==e||(e="number[]");i=t.apis.byQName[e];i&&i.attributes.autoCreate?n=pxt.blocks.mkText(i.attributes.autoCreate+"()"):o=": "+e}return pxt.blocks.mkStmt(pxt.blocks.mkText("let "+e.escapedName+o+" = "),n)}function T(e,t,i,n,o){e=r(e,o.x,o.x+o.width)||r(o.x,e,e+i),i=r(t,o.y,o.y+o.height)||r(o.y,t,t+n);return e&&i;function r(e,t,i){return t<=e&&e<=i}}n.PXT_WARNING_ID="WARNING_MESSAGE",n.compileBlockAsync=function(e,t){var i=e.workspace,t=(0,x.mkEnv)(i,t),i=((0,R.infer)(i&&i.getAllBlocks(!1),t,i),_(t,e));return t.placeholders={},o(t,i)},n.compileAsync=function(e,t,i={}){var[e,t]=((r,s,a)=>{try{let e=s.getAllBlocks(!1),t=(pxt.react.getTilemapProject&&pxt.react.getTilemapProject().removeInactiveBlockAssets(e.map(e=>e.id)),s.getTopBlocks(!0)),i=(t=t.sort((e,t)=>g(e,r)-g(t,r)),((i,e,t)=>{var n=d.Events.isEnabled();n&&d.Events.disable(),e.forEach(b);let o={};function r(e,t){o[e]?m(t,!1):(m(t,!0),o[e]=t)}t.forEach(t=>{var e=i.stdCallTable[t.type];if(t.type==ts.pxtc.ON_START_TYPE)r(ts.pxtc.ON_START_TYPE,t);else if(!((0,O.isFunctionDefinition)(t)||e&&e.attrs.blockAllowMultiple&&!e.attrs.handlerStatement&&!e.attrs.forceStatement))if(e&&e.hasHandler&&!e.attrs.handlerStatement&&!e.attrs.forceStatement)r(e.attrs.blockHandlerKey||f(0,t),t);else{let e=t;for(;e;)m(t,!1),e=e.getNextBlock()}}),n&&d.Events.enable()})(r,e,t),e=e.filter(e=>e.isEnabled()),t=t.filter(e=>e.isEnabled()),(0,h.trackAllVariables)(t,r),(0,R.infer)(e,r,s),[]);var l=s.getTopComments(!0);let n=((e,t)=>{if(!e.length||e.some(e=>!e.rendered))return{orphans:t,idToComments:{}};var i,n=e.map(e=>{var t=e.getBoundingRectangle(),i=e.getHeightWidth();return{id:e.id,x:t.left,y:t.top,width:i.width,height:i.height}}),o={orphans:[],idToComments:{}};for(i of t){var r,s=i.getBoundingRectangle(),a=i.getSize(),l=s.left,c=s.top;let e;for(r of n)(T(l,c,a.width,a.height,r)||!e&&T(l-20,c-20,a.width+40,a.height+40,r))&&(e=r);(e?(o.idToComments[e.id]||(o.idToComments[e.id]=[]),o.idToComments[e.id]):o.orphans).push(i)}return o})(t,l),o=(n.orphans.forEach(e=>(0,O.append)(i,k(e).children)),t.forEach(e=>{n.idToComments[e.id]&&n.idToComments[e.id].forEach(e=>{(0,O.append)(i,k(e).children)}),e.type==ts.pxtc.ON_START_TYPE?(0,O.append)(i,_(r,e)):(e=pxt.blocks.mkBlock(_(r,e))).type==pxt.blocks.NT.Block?(0,O.append)(i,e.children):i.push(e)}),[]);r.enums.forEach(a=>{var e=s.getVariableMap().getVariablesOfType(a.name);if(e&&e.length){e=e.map(e=>{var t=/^(\d+)([^0-9].*)$/.exec(e.getName());return t?[t[2],parseInt(t[1])]:[e.getName(),-1]});e.sort((e,t)=>e[1]-t[1]);let r=[],s=-1;e.forEach(([e,t],i)=>{let n;var o;a.isBitMask?0<=(o=Math.log2(t))&&Math.floor(o)===o&&(n=pxt.blocks.H.mkAssign(pxt.blocks.mkText(e),pxt.blocks.H.mkSimpleCall("<<",[pxt.blocks.H.mkNumberLiteral(1),pxt.blocks.H.mkNumberLiteral(o)]))):a.isHash&&(o=ts.pxtc.Util.codalHash16(e.toLowerCase()),n=pxt.blocks.H.mkAssign(pxt.blocks.mkText(e),pxt.blocks.H.mkNumberLiteral(o))),n=n||(t===s+1?pxt.blocks.mkText(e):pxt.blocks.H.mkAssign(pxt.blocks.mkText(e),pxt.blocks.H.mkNumberLiteral(t))),r.push(n),s=t});e=pxt.blocks.mkCommaSep(r,!0);e.glueToBlock=pxt.blocks.GlueMode.NoSpace,o.push(pxt.blocks.mkGroup([pxt.blocks.mkText("enum "+a.name),pxt.blocks.mkBlock([e])]))}}),r.kinds.forEach(t=>{var e=s.getVariableMap().getVariablesOfType("KIND_"+t.name);e&&e.length&&(e=e.map(e=>e.getName()).filter(e=>-1===t.initialMembers.indexOf(e))).length&&o.push(pxt.blocks.mkGroup([pxt.blocks.mkText("namespace "+t.name),pxt.blocks.mkBlock(e.map(e=>pxt.blocks.mkStmt(pxt.blocks.mkText(`export const ${e} = ${t.name}.${t.createFunctionName}()`))))]))});var c=r.allVariables.filter(e=>!e.alreadyDeclared).map(e=>v(e,a));return r.allVariables.filter(e=>e.alreadyDeclared===x.BlockDeclarationType.Implicit&&!e.isAssigned).forEach(e=>{var t=(0,R.getConcreteType)(e.type);"string"===t.type||"number"===t.type||"boolean"===t.type||(0,u.isArrayType)(t.type)||r.diagnostics.push({blockId:e.firstReference&&e.firstReference.id,message:lf("Variable '{0}' is never assigned",e.name)})}),[o.concat(c.concat(i)),r.diagnostics]}catch(e){var t=e.block;if(!t)throw e;t.setWarningText(e+"",n.PXT_WARNING_ID),r.errors.push(t)}finally{r.placeholders={}}return[null,null]})(i=(0,x.mkEnv)(e,t,i),e,t);return o(i,e,t)},n.callKey=f,n.AUTO_DISABLED_REASON="pxt_automatic_disabled",n.compileExpression=N;let E={ADD:"+",MINUS:"-",MULTIPLY:"*",DIVIDE:"/",LT:"<",LTE:"<=",GT:">",GTE:">=",AND:"&&",OR:"||",EQ:"==",NEQ:"!=",POWER:"**"};function $(t,i,n,e){var o=(0,O.escapeVarName)(i.getField("function_name").getText(),t,!0),r=!i.getInputsInline(),s=i.getArguments().map(e=>({actualName:e.name,definitionName:e.id})).map(e=>P(t,i,e,n)),o=pxt.blocks.H.stdCall(o,s,r);return e?pxt.blocks.mkStmt(o):o}function P(e,t,i,n,o=!1){var r=t.getFieldValue(i.definitionName);if(null==r)return(0,R.attachPlaceholderIf)(e,t,i.definitionName),s=(0,O.getInputTargetBlock)(e,t,i.definitionName),o&&"lists_create_with"===s.type?y(N(e,s,n)):i.shadowOptions&&i.shadowOptions.toString&&!(0,R.isStringType)((0,R.returnType)(e,s))?pxt.blocks.H.mkSimpleCall("+",[pxt.blocks.H.mkStringLiteral(""),pxt.blocks.H.mkParenthesizedExpression(N(e,s,n))]):N(e,s,n);o=t.getField(i.definitionName);if(o instanceof d.FieldTextInput||o instanceof p.FieldTextInput)return pxt.blocks.H.mkStringLiteral(r);if(o instanceof p.FieldTilemap&&!o.isGreyBlock){var s=pxt.react.getTilemapProject(),n=o.getValue();if(n.startsWith("tilemap`"))return pxt.blocks.mkText(n);if(e.options.emitTilemapLiterals)try{var a,l=pxt.sprite.decodeTilemap(n,"typescript",s);if(l)return[a]=s.createNewTilemapFromData(l),pxt.blocks.mkText(`tilemap\`${a}\``)}catch(e){}}t=e.blocksInfo.apis.byQName[i.type];if(t&&t.attributes.emitAsConstant)for(var c of Object.keys(e.blocksInfo.apis.byQName)){var u=e.blocksInfo.apis.byQName[c];if(u&&u.attributes&&u.attributes.enumIdentity===r)return pxt.blocks.mkText(c)}o=pxt.blocks.mkText(r);return o.canIndentInside="string"==typeof r&&0<=r.indexOf("\n"),o}function B(i,n,o,r){let t;if((0,O.isMutatingBlock)(n)&&n.mutation.getMutationType()===A.MutatorTypes.RestParameterMutator)t=n.mutation.compileMutation(i,r).children;else{if("ENUM_GET"===o.attrs.shim)return a=o.attrs.enumName,l=n.getFieldValue("MEMBER").replace(/^\d+/,""),pxt.blocks.H.mkPropertyAccess(l,pxt.blocks.mkText(a));if("KIND_GET"===o.attrs.shim)return l=i.kinds.filter(e=>e.blockId===o.attrs.blockId)[0],pxt.blocks.H.mkPropertyAccess(n.getFieldValue("MEMBER"),pxt.blocks.mkText(l.name));t=(0,O.visibleParams)(o,(0,O.countOptionals)(n,o)).map((e,t)=>P(i,n,e,r,o.isExtensionMethod&&0===t&&!o.isExpression))}let e=o.namespace,s=o.f;o.attrs.blockAliasFor&&(a=i.blocksInfo.apis.byQName[o.attrs.blockAliasFor])&&(s=a.name,e=a.namespace);var a,l=!n.getInputsInline();if(o.isIdentity)return t[0];if(o.property)return pxt.blocks.H.mkPropertyAccess(s,t[0]);if("@get@"==s)return pxt.blocks.H.mkPropertyAccess(t[1].op.replace(/.*\./,""),t[0]);if("@set@"==s)return pxt.blocks.H.mkAssign(pxt.blocks.H.mkPropertyAccess(t[1].op.replace(/.*\./,"").replace(/@set/,""),t[0]),t[2]);if("@change@"==s)return pxt.blocks.H.mkSimpleCall("+=",[pxt.blocks.H.mkPropertyAccess(t[1].op.replace(/.*\./,"").replace(/@set/,""),t[0]),t[2]]);if(o.isExtensionMethod){if(o.attrs.defaultInstance){let e;(e=(0,O.isMutatingBlock)(n)&&n.mutation.getMutationType()===A.MutatorTypes.DefaultInstanceMutator?n.mutation.compileMutation(i,r):e)?t.unshift(e):t.unshift(pxt.blocks.mkText(o.attrs.defaultInstance))}return pxt.blocks.H.extensionCall(s,t,l)}return e?pxt.blocks.H.namespaceCall(e,s,t,l):pxt.blocks.H.stdCall(s,t,l)}function k(e){e=e.getText();return pxt.blocks.H.mkMultiComment(e.trim())}function C(e,t){return function t(i,n){if(!n)return!1;if("math_number"===n.type||"math_integer"===n.type||"math_number_minmax"===n.type||"math_whole_number"===n.type)return!0;let e=i.stdCallTable[n.type];if(!e)return!1;let o=e.comp;if("TD_ID"===e.attrs.shim&&1===o.parameters.length){let e=n.getFieldValue(o.parameters[0].definitionName);return e?!isNaN(parseInt(e)):t(i,(0,O.getInputTargetBlock)(i,n,o.parameters[0].definitionName))}return!1}(e,t)||"logic_boolean"===t.type||"text"===t.type}function F(e){var t=e.getFieldValue("math_number_minmax"===e.type?"SLIDER":"NUM"),t=parseFloat(t);if(i=t,e=e,isFinite(i)&&!isNaN(i))return t;var i=lf("Number entered is either too large or too small"),t=e;throw(i=new Error(i)).block=t,i}function I(e,t){return pxt.blocks.H.mkNumberLiteral(F(t))}function r(e,t){return pxt.worker.getWorker(pxt.webConfig.workerjs).opAsync(e,t)}n.workerOpAsync=r},{"../fields":70,"../legacyMutations":76,"../toolbox":139,"./environment":13,"./typeChecker":14,"./util":15,"./variables":16,blockly:219}],13:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.mkEnv=i.emptyEnv=i.BlockDeclarationType=i.Point=void 0;let o=e("./util");function r(e,t){return{workspace:e,options:t,stdCallTable:{},userFunctionReturnValues:{},diagnostics:[],errors:[],renames:{oldToNew:{},takenNames:{},oldToNewFunctions:{}},stats:{},enums:[],kinds:[],idToScope:{},blockDeclarations:{},allVariables:[],blocksInfo:null,placeholders:{}}}i.Point=class{constructor(e,t,i,n,o){this.link=e,this.type=t,this.parentType=i,this.childType=n,this.isArrayType=o}},(e=i.BlockDeclarationType||(i.BlockDeclarationType={}))[e.None=0]="None",e[e.Argument=1]="Argument",e[e.Assigned=2]="Assigned",e[e.Implicit=3]="Implicit",i.emptyEnv=r,i.mkEnv=function(e,t,i={}){let n=r(e,i);return(n.blocksInfo=t)&&(Object.keys(t.apis.byQName).forEach(e=>{e=t.apis.byQName[e];!e.pkg||6!==e.kind&&3!==e.kind&&5!==e.kind&&4!==e.kind||(n.renames.takenNames[e.qName]=!0)}),t.enumsByName&&Object.keys(t.enumsByName).forEach(e=>n.enums.push(t.enumsByName[e])),t.kindsByName&&Object.keys(t.kindsByName).forEach(e=>n.kinds.push(t.kindsByName[e])),t.blocks.forEach(e=>{var t,i;n.stdCallTable[e.attributes.blockId]?pxt.reportError("blocks","function already defined",{details:e.attributes.blockId,qualifiedName:e.qName,packageName:e.pkg}):(n.renames.takenNames[e.namespace]=!0,i=!!(t=pxt.blocks.compileInfo(e)).thisParameter,n.stdCallTable[e.attributes.blockId]={namespace:e.namespace,f:e.name,comp:t,attrs:e.attributes,isExtensionMethod:i,isExpression:e.retType&&"void"!==e.retType,imageLiteral:e.attributes.imageLiteral||e.attributes.gridLiteral,imageLiteralColumns:e.attributes.imageLiteralColumns,imageLiteralRows:e.attributes.imageLiteralRows,hasHandler:pxt.blocks.hasHandler(e),property:!e.parameters,isIdentity:"TD_ID"==e.attributes.shim})}),e.getTopBlocks(!1).filter(o.isFunctionDefinition).forEach(e=>{e="procedures_defnoreturn"===e.type?e.getFieldValue("NAME"):e.getField("function_name").getText();(0,o.escapeVarName)(e,n,!0)})),n}},{"./util":15}],14:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.isBooleanType=i.isStringType=i.defaultValueForType=i.getEscapedCBParameters=i.isFunctionRecursive=i.getDeclaredVariables=i.lookup=i.getConcreteType=i.attachPlaceholderIf=i.returnType=i.find=i.mkPoint=i.infer=void 0;let n=e("./environment"),g=e("./util"),l=e("../plugins/functions"),f=e("./compiler"),c=e("../loader");function m(e,t){var i,n=T(e),o=T(t);x(null==n.link&&null==o.link),n!=o&&(r(n)?a(e.type,t.type):r(o)?(a(e.type,t.type),e.type=null,n.link=e.link=o,n.isArrayType=o.isArrayType):(n.childType&&o.childType?(i=n.childType,n.childType=null,m(i,o.childType)):n.childType&&!o.childType&&(o.childType=n.childType),n.parentType&&o.parentType?(i=n.parentType,n.parentType=null,m(i,o.parentType)):!n.parentType||o.parentType||o.type||(o.parentType=n.parentType),i=a(n.type,o.type),e.link=o,n.link=o,n.isArrayType=o.isArrayType,e.type=null,t.type=i))}function b(e,t,i,n){C(e,t,i);try{m(E(e,(0,g.getInputTargetBlock)(e,t,i)),n)}catch(e){}}function u(e,t=!1){return new n.Point(null,e,null,null,t)}i.infer=function(e,d,t){function h(e){var t=null==(t=null==(t=e.connection)?void 0:t.getCheck())?void 0:t[0];return e.name?t||"T":void 0}function p(e,t){var i=e.inputList.filter(e=>"T"===h(e));if(i.length){var n,i=(0,g.getInputTargetBlock)(d,e,i[0].name);if(i)return I(i=(n=E(d,i)).type?v(E(d,i).type+"[]"):v(null),n),b(d,e,t,i),!0}return!1}e&&e.filter(e=>e.isEnabled()).forEach(a=>{try{switch(a.type){case"math_op2":b(d,a,"x",v(_.type)),b(d,a,"y",v(_.type));break;case"math_op3":b(d,a,"x",v(_.type));break;case"math_arithmetic":case"logic_compare":switch(a.getFieldValue("OP")){case"ADD":case"MINUS":case"MULTIPLY":case"DIVIDE":case"LT":case"LTE":case"GT":case"GTE":case"POWER":b(d,a,"A",v(_.type)),b(d,a,"B",v(_.type));break;case"AND":case"OR":C(d,a,"A",y.type),C(d,a,"B",y.type);break;case"EQ":case"NEQ":C(d,a,"A"),C(d,a,"B");var e=E(d,(0,g.getInputTargetBlock)(d,a,"A")),t=E(d,(0,g.getInputTargetBlock)(d,a,"B"));try{m(e,t)}catch(e){}}break;case"logic_operation":C(d,a,"A",y.type),C(d,a,"B",y.type);break;case"logic_negate":C(d,a,"BOOL",y.type);break;case"controls_if":for(let e=0;e<=a.elseifCount_;++e)C(d,a,"IF"+e,y.type);break;case"pxt_controls_for":case"controls_simple_for":b(d,a,"TO",v(_.type));break;case"pxt_controls_for_of":case"controls_for_of":var i=(0,g.getInputTargetBlock)(d,a,"LIST");i&&"placeholder"!==i.type?I(E(d,i),S(d,a,(0,g.getLoopVariableField)(d,a).getField("VAR").getText()).type):d.diagnostics.push({blockId:a.id,message:lf("The 'for of' block must have a list input")});break;case"variables_set":case"variables_change":var n=S(d,a,a.getField("VAR").getText()).type,o=(C(d,a,"VALUE"),(0,g.getInputTargetBlock)(d,a,"VALUE"));if(o){l=d;var r=null!=(u=null==(u=(c=o).outputConnection)?void 0:u.getCheck())&&u.length&&"Array"!==u[0]&&"T"!==u[0]?u.map(e=>v(e)):[E(l,c)];let t=T(n);if(t.type&&r.slice(1).some(e=>e.type===t.type))n.link=T(r[0]);else try{m(n,r[0])}catch(e){}}break;case"controls_repeat_ext":b(d,a,"TIMES",v(_.type));break;case"device_while":C(d,a,"COND",y.type);break;case"lists_index_get":b(d,a,"LIST",v("Array")),b(d,a,"INDEX",v(_.type)),I(E(d,(0,g.getInputTargetBlock)(d,a,"LIST")),E(d,a));break;case"lists_index_set":b(d,a,"LIST",v("Array")),C(d,a,"VALUE"),p(a,"LIST"),b(d,a,"INDEX",v(_.type));break;case"function_definition":k(d,a.getField("function_name").getText());break;case"function_call":case"function_call_output":a.getArguments().forEach(e=>{b(d,a,e.id,v(e.type))});break;case pxtc.TS_RETURN_STATEMENT_TYPE:C(d,a,"RETURN_VALUE");break;case pxtc.PAUSE_UNTIL_TYPE:b(d,a,"PREDICATE",y);break;default:if(a.type in d.stdCallTable){let s=d.stdCallTable[a.type];"ENUM_GET"!==s.attrs.shim&&"KIND_GET"!==s.attrs.shim&&(0,g.visibleParams)(s,(0,g.countOptionals)(a,s)).forEach((t,e)=>{var i,e=s.isExtensionMethod&&0===e;if(t.definitionName&&!a.getFieldValue(t.definitionName)){var n=a.inputList.find(e=>e.name==t.definitionName),o=null==(i=null==n?void 0:n.connection)?void 0:i.getCheck();if(o){if(e&&"Array"===h(n))if(p(a,t.definitionName))return;for(let e=0;e<o.length;e++)try{var r=o[e];b(d,a,t.definitionName,v(r));break}catch(e){}}}})}}}catch(e){var s=e.block||a;s.setWarningText(e+"",f.PXT_WARNING_ID),d.errors.push(s)}var l,c,u}),d.allVariables.forEach(e=>{null==w(e.type).type&&(e.isFunctionParameter?e.type.isArrayType&&(e.type.type="any[]"):m(e.type,v(e.type.isArrayType?"number[]":_.type)))})};let _=(i.mkPoint=u)("number"),y=u("boolean"),o=u("string"),s=u("void");function v(e){if(!e)return u(e);switch(e.toLowerCase()){case"number":return _;case"boolean":return y;case"string":return o;case"void":return s;default:return u(e)}}function T(e){return e.link?T(e.link):e}function r(e){return e===_||e===y||e===o||e===s}function E(i,n){var e;if(x(null!=n),"placeholder"==(o=n).type||o.type===pxtc.TS_OUTPUT_TYPE)return n.p||(n.p=u(null)),T(n.p);if("variables_get"==n.type)return T(S(i,n,n.getField("VAR").getText()).type);if("function_call_output"==n.type)return o=i,e=(e=n).getField("function_name").getText(),k(o,e);if(!n.outputConnection)return v(s.type);var o=(null==(e=null==(o=n.outputConnection)?void 0:o.getCheck())?void 0:e[0])||"T";if("Array"===o){var r=n.outputConnection.getCheck();if(1<r.length)return v(r[1]);let e;if("lists_create_with"==n.type){if(n.inputList&&n.inputList.length)for(var t of n.inputList)if(t.connection&&t.connection.targetBlock()){t=T(E(i,t.connection.targetBlock()));if(t){if(t.parentType)return t.parentType;I(e=t.type?v(t.type+"[]"):u(null),t);break}}}else"argument_reporter_array"==n.type&&(e=e||S(i,n,n.getFieldValue("VALUE")).type);return e&&(e.isArrayType=!0),e||u(null,!0)}if("T"!==o)return v(o);{let t=i.stdCallTable[n.type];var r="lists_index_get"===n.type;if(r||t&&t.comp.thisParameter){let e;if((e=r?n.inputList.find(e=>"LIST"===e.name):n.inputList.find(e=>e.name===t.comp.thisParameter.definitionName)).connection&&e.connection.targetBlock())return(o=E(i,e.connection.targetBlock())).childType||(r=d(o.type)&&"Array"!==o.type?u(o.type.substr(0,o.type.length-2)):u(null),I(o,r),r)}return u(null)}}function k(i,n){if(!i.userFunctionReturnValues[n]){var o=(0,l.getDefinition)(n,i.workspace);let t=u("void");if(h(i,o,!0))t=u("any");else{var e,r=[];for(e of o.getDescendants(!1))"function_return"===e.type&&(C(i,e,"RETURN_VALUE"),r.push(E(i,(0,g.getInputTargetBlock)(i,e,"RETURN_VALUE"))));if(r.length)try{var s,a=u(null);for(s of r)m(a,s);t=a}catch(e){i.diagnostics.push({blockId:o.id,message:pxt.Util.lf("Function '{0}' has an invalid return type",n)}),t=u("any")}}i.userFunctionReturnValues[n]=t}return i.userFunctionReturnValues[n]}function a(e,t){if(null==e||"Array"===e&&d(t))return t;if(null==t||"Array"===t&&d(e))return e;if(e==t)return e;throw new Error("cannot mix "+e+" with "+t)}function d(e){return e&&(-1!==e.indexOf("[]")||"Array"==e)}function C(e,t,i,n){var o,r=t.getInputTargetBlock(i);r?r.type!==pxtc.TS_OUTPUT_TYPE||r.p||(r.p=u(null)):(e.placeholders[t.id]||(e.placeholders[t.id]={}),e.placeholders[t.id][i]||(e.placeholders[t.id][i]=(r=e,o=t,{type:"placeholder",p:u(n||null),workspace:r.workspace,parentBlock_:o,getParent:()=>o})))}function I(e,t){e=T(e),t=T(t);e.childType?m(e.childType,t):e.type||(e.childType=t),t.parentType?m(t.parentType,e):t.type||(t.parentType=e),d(e.type)&&(e.isArrayType=!0)}function w(e,t=[]){e=T(e);if(-1===t.indexOf(e)&&(t.push(e),!e.type||"Array"===e.type)){if(e.parentType){var i=w(e.parentType,t);if(i.type&&"Array"!==i.type)return d(i.type)?e.type=i.type.substr(0,i.type.length-2):e.type=i.type,e}if(e.childType){i=w(e.childType,t);if(i.type)e.type=i.type+"[]"}}return e}function S(e,t,i){return function e(t,i){return i&&i.declaredVars[t]?i.declaredVars[t]:i&&i.parent?e(t,i.parent):null}(i,e.idToScope[t.id])}function h(o,e,r){let s=(0,g.getFunctionName)(e),a={};return function t(e){let i;i=r?e.getDescendants(!1).filter(e=>"function_return"==e.type).map(e=>(0,g.getInputTargetBlock)(o,e,"RETURN_VALUE")).filter(e=>e&&"function_call_output"===e.type):e.getDescendants(!1).filter(e=>"function_call_output"==e.type);for(var n of i){let e=(0,g.getFunctionName)(n);if(e===s)return!0;if(!a[e]&&(a[e]=!0,t((0,l.getDefinition)(e,n.workspace))))return!0}return!1}(e)}function p(i,n,o){var r=[];if(n.attrs.draggableParameters)for(let t=0;t<n.comp.handlerArgs.length;t++){var s=n.comp.handlerArgs[t];let e;var a=(0,g.getInputTargetBlock)(o,i,c.DRAGGABLE_PARAM_INPUT_PREFIX+s.name);if(null==(e="reporter"===n.attrs.draggableParameters?a&&a.getFieldValue("VALUE"):a&&a.getField("VAR").getText()))break;r.push({name:e,type:u(s.type)})}else for(let e=0;e<n.comp.handlerArgs.length;e++){var t=n.comp.handlerArgs[e],l=i.getField("HANDLER_"+t.name),l=l&&l.getText();if(null===l)break;r.push({name:l,type:u(t.type)})}return r}function x(e){if(!e)throw new Error("Assertion failure")}i.find=T,i.returnType=E,i.attachPlaceholderIf=C,i.getConcreteType=w,i.lookup=S,i.getDeclaredVariables=function(e,t){switch(e.type){case"pxt_controls_for":case"controls_simple_for":return[{name:(0,g.getLoopVariableField)(t,e).getField("VAR").getText(),type:_}];case"pxt_controls_for_of":case"controls_for_of":return[{name:(0,g.getLoopVariableField)(t,e).getField("VAR").getText(),type:u(null)}];case"function_definition":return e.getArguments().filter(e=>"Array"===e.type).map(e=>{var t=u(null);return t.isArrayType=!0,{name:e.name,type:t,isFunctionParameter:!0}})}if((0,g.isMutatingBlock)(e)){let t=e.mutation.getDeclaredVariables();if(t)return Object.keys(t).map(e=>({name:e,type:u(t[e])}))}var i=t.stdCallTable[e.type];return i&&i.comp.handlerArgs.length?p(e,i,t):[]},i.isFunctionRecursive=h,i.getEscapedCBParameters=function(t,e,i){return p(t,e,i).map(e=>S(i,t,e.name).escapedName)},i.defaultValueForType=function(e){if(null==e.type&&(m(e,v(_.type)),e=T(e)),d(e.type)||e.isArrayType)return pxt.blocks.mkText("[]");switch(e.type){case"boolean":return pxt.blocks.H.mkBooleanLiteral(!1);case"number":return pxt.blocks.H.mkNumberLiteral(0);case"string":return pxt.blocks.H.mkStringLiteral("");default:return pxt.blocks.mkText("null")}},i.isStringType=function(e){return e===o},i.isBooleanType=function(e){return e===y}},{"../loader":77,"../plugins/functions":111,"./compiler":12,"./environment":13,"./util":15}],15:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.isFunctionDefinition=i.append=i.escapeVarName=i.isMutatingBlock=i.getInputTargetBlock=i.countOptionals=i.visibleParams=i.getFunctionName=i.getLoopVariableField=i.printScope=i.forEachStatementInput=i.forEachChildExpression=void 0;let o=e("blockly");function r(t){let i="";for(let e=0;e<t;e++)i+="    ";return i}function n(e,t,i){var n=t.getInputTargetBlock(i);return n||(null==(n=e.placeholders[t.id])?void 0:n[i])}i.forEachChildExpression=function t(e,i,n=!1){e.inputList.filter(e=>e.type===o.inputs.inputTypes.VALUE).forEach(e=>{e.connection&&e.connection.targetBlock()&&(i(e.connection.targetBlock()),n)&&t(e.connection.targetBlock(),i,n)})},i.forEachStatementInput=function(e,t){e.inputList.filter(e=>e.type===o.inputs.inputTypes.STATEMENT).forEach(e=>{e.connection&&e.connection.targetBlock()&&t(e.connection.targetBlock())})},i.printScope=function t(i,n=0){var e=Object.keys(i.declaredVars).map(e=>`${e}(${i.declaredVars[e].id})`).join(",");i.referencedVars.join(", ");pxt.log(r(n)+"SCOPE: "+(i.firstStatement?i.firstStatement.type:"TOP-LEVEL")),e.length&&pxt.log(r(n)+"DECS: "+e),i.children.forEach(e=>t(e,n+1))},i.getLoopVariableField=function(e,t){return"pxt_controls_for"==t.type||"pxt_controls_for_of"==t.type?n(e,t,"VAR"):t},i.getFunctionName=function(e){return e.getField("function_name").getText()},i.visibleParams=function({comp:e},t){let i=[];return e.thisParameter&&i.push(e.thisParameter),e.parameters.forEach(e=>{e.isOptional&&0<t?(i.push(e),--t):e.isOptional||i.push(e)}),i},i.countOptionals=function(e,t){if(t.attrs.compileHiddenArguments)return t.comp.parameters.reduce((e,t)=>(t.isOptional&&e++,e),0);if(e.mutationToDom){t=e.mutationToDom();if(t.hasAttribute("_expanded"))return e=parseInt(t.getAttribute("_expanded")),isNaN(e)?0:Math.max(e,0)}return 0},i.getInputTargetBlock=n,i.isMutatingBlock=function(e){return!!e.mutation},i.escapeVarName=function(e,t,i=!1){if(!e)return"_";if(i){if(t.renames.oldToNewFunctions[e])return t.renames.oldToNewFunctions[e]}else if(t.renames.oldToNew[e])return t.renames.oldToNew[e];let n=ts.pxtc.escapeIdentifier(e);if(t.renames.takenNames[n]){let e=2;for(;t.renames.takenNames[n+e];)e++;n+=e}return i?(t.renames.oldToNewFunctions[e]=n,t.renames.takenNames[n]=!0):t.renames.oldToNew[e]=n,n},i.append=function(e,t){e.push.apply(e,t)},i.isFunctionDefinition=function(e){return"procedures_defnoreturn"===e.type||"function_definition"===e.type}},{blockly:219}],16:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.trackAllVariables=void 0;let l=e("blockly"),c=e("./environment"),u=e("./typeChecker"),d=e("./util");function h(e,t){if(-1!==e.referencedVars.indexOf(t))return!0;for(var i of e.children)if(h(i,t))return!0;return!1}function p(e,t){if(-1!==e.assignedVars.indexOf(t))return!0;for(var i of e.children)if(p(i,t))return!0;return!1}i.trackAllVariables=function(e,t){let r=1,i;return e.forEach(e=>{e.type===ts.pxtc.ON_START_TYPE&&(e=e.getInputTargetBlock("HANDLER"))&&s(e,i={firstStatement:e,declaredVars:{},referencedVars:[],children:[],assignedVars:[]},t)}),i=i||{firstStatement:null,declaredVars:{},referencedVars:[],children:[],assignedVars:[]},e.forEach(e=>{e.type!==ts.pxtc.ON_START_TYPE&&s(e,i,t)}),Object.keys(i.declaredVars).forEach(e=>{var t=i.declaredVars[e];delete i.declaredVars[e],(function e(t,i){let n;if(-1!==t.referencedVars.indexOf(i))return t;for(var o of t.children)if(h(o,i)){if(p(o,i))return t;if(n)return t;n=o}return n?e(n,i):void 0}(i,t.id)||i).declaredVars[e]=t}),function t(i,n){let o=Object.keys(i.declaredVars);if(o.length){let e=o.map(e=>i.declaredVars[e]);i.firstStatement&&(n.blockDeclarations[i.firstStatement.id]=e.concat(n.blockDeclarations[i.firstStatement.id]||[])),e.forEach(e=>n.allVariables.push(e))}i.children.forEach(e=>t(e,n))}(i,t),function t(n,o){for(var i of Object.keys(n.declaredVars)){let e=n.declaredVars[i];e.escapedName||(e.escapedName=r(i))}n.children.forEach(e=>t(e,o));function r(t){if(!t)return"_";let i=ts.pxtc.escapeIdentifier(t);if(o.renames.takenNames[i]||s(i,n,t)){let e=2;for(;o.renames.takenNames[i+e]||s(i+e,n,t);)e++;i+=e}return i}function s(t,i,n){if(i){for(var o of Object.keys(i.declaredVars)){let e=i.declaredVars[o];if((n!==e.name||e.name!==e.escapedName)&&e.escapedName===t)return!0}return s(t,i.parent,n)}return!1}}(i,t),i;function s(e,t,n){if(n.idToScope[e.id]=t,"variables_get"===e.type?(o=a(e.getField("VAR").getText(),t),t.referencedVars.push(o.id)):"variables_set"===e.type||"variables_change"===e.type?(o=a(e.getField("VAR").getText(),t),t.assignedVars.push(o.id),t.referencedVars.push(o.id)):e.type===pxtc.TS_STATEMENT_TYPE&&(o=e.declaredVariables)&&o.split(",").forEach(e=>{a(e,t).alreadyDeclared=c.BlockDeclarationType.Argument}),e.inputList.some(e=>e.type===l.inputs.inputTypes.STATEMENT)){var o=(0,u.getDeclaredVariables)(e,n).map(e=>Object.assign(Object.assign({},e),{id:r++}));let i=t;o.length&&(i={parent:t,firstStatement:e,declaredVars:{},referencedVars:[],assignedVars:[],children:[]},o.forEach(e=>{e.alreadyDeclared=c.BlockDeclarationType.Assigned,i.declaredVars[e.name]=e}),n.idToScope[e.id]=i),t!==i&&t.children.push(i),(0,d.forEachChildExpression)(e,e=>{s(e,i,n)}),(0,d.forEachStatementInput)(e,e=>{var t={parent:i,firstStatement:e,declaredVars:{},referencedVars:[],assignedVars:[],children:[]};i.children.push(t),s(e,t,n)})}else(0,d.forEachChildExpression)(e,e=>{s(e,t,n)});e.nextConnection&&e.nextConnection.targetBlock()&&s(e.nextConnection.targetBlock(),t,n)}function a(e,t){return t.declaredVars[e]||(t.parent?a(e,t.parent):(t.declaredVars[e]={name:e,type:(0,u.mkPoint)(null),id:r++},t.declaredVars[e]))}}},{"./environment":13,"./typeChecker":14,"./util":15,blockly:219}],17:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.initVariableReporterArgs=i.initExpandableBlock=i.initVariableArgsBlock=i.appendMutation=void 0;let R=e("blockly"),O=e("./toolbox"),A=e("./constants"),u=e("./fields"),p=e("./loader"),N=e("./fields/field_imagenotext"),g=e("./plugins/duplicateOnDrag");function L(e,t){let i=e.mutationToDom,n=e.domToMutation;e.mutationToDom=()=>{var e=i?i():document.createElement("mutation");return t.mutationToDom(e)},e.domToMutation=e=>{n&&n(e),t.domToMutation(e)}}i.appendMutation=L,i.initVariableArgsBlock=function(r,s){let a=0,l=0,c=r.appendDummyInput(),o=()=>{if(a!==l){if(a>l){var t=a-l;for(let e=0;e<t;e++){var i=s[l+e],i=(c.insertFieldAt(c.fieldRow.length-1,new u.FieldArgumentVariable(i.name),"HANDLER_"+i.name),r);null!=i&&i.initSvg&&i.initSvg()}}else{var n=l-a;for(let e=0;e<n;e++){var o=s[l-e-1];c.removeField("HANDLER_"+o.name)}}a>=s.length?c.removeField("_HANDLER_ADD"):l>=s.length&&e(),l=a}};function e(){c.appendField(new N.FieldImageNoText(r.ADD_IMAGE_DATAURI,24,24,lf("Add argument"),()=>{a=Math.min(a+1,s.length),o()},!1),"_HANDLER_ADD")}R.Extensions.apply("inline-svgs",r,!1),e(),L(r,{mutationToDom:t=>{t.setAttribute("numArgs",a.toString());for(let e=0;e<a;e++){var i=r.getField("HANDLER_"+s[e].name),i=i&&i.getText();t.setAttribute("arg"+e,i)}return t},domToMutation:t=>{var e=parseInt(t.getAttribute("numargs"));a=Math.min(isNaN(e)?0:e,s.length),o();for(let e=0;e<a;e++){var i=t.getAttribute("arg"+e),n="HANDLER_"+s[e].name;r.getField(n)&&(0,p.setVarFieldValue)(r,n,i)}}})},i.initExpandableBlock=function(n,s,a,l,e,t){let i="0_add_button",o="0_rem_button",r="0_add_rem_button",c="_expanded",u="_input_init",d=a.parameters.map(e=>e.name),h=a.parameters.length,p=e?h:1,g="variable"===n.blocksById[s.type].attributes.inlineInputMode,f=n.blocksById[s.type].attributes.inlineInputModeLimit||4;var e=n.blocksById[s.type].attributes.compileHiddenArguments,m=n.blocksById[s.type].attributes.expandableArgumentBreaks;let b,_=(m&&(b=m.split(/[;,]/).map(e=>parseInt(e))),new D(s)),y=(_.setEventsEnabled(!1),_.setValue(c,0),_.setValue(u,!1),_.setEventsEnabled(!0),R.Extensions.apply("inline-svgs",s,!1),!1),v=!0;if(L(s,{mutationToDom:e=>(e.setAttribute(c,_.getString(c)),e.setAttribute(u,_.getString(u)),e),domToMutation:e=>{_.setEventsEnabled(!1),e.hasAttribute(u)&&"true"==e.getAttribute(u)&&!_.getBoolean(u)&&_.setValue(u,!0),I(),e.hasAttribute(c)&&(e=parseInt(e.getAttribute(c)),isNaN(e)||(e=e-(_.getNumber(c)||0),_.getBoolean(u)?s.rendered||s.isInsertionMarker()?E(e,!0,s.isInsertionMarker()):(_.setValue(c,w(e)),C()):E(e,!0))),_.setEventsEnabled(!0)}}),I(),e){let t=0;for(let e=0;e<s.inputList.length;e++){var T=s.inputList[e];!pxt.Util.startsWith(T.name,A.optionalInputWithFieldPrefix)&&-1===d.indexOf(T.name)||(!T.connection||T.connection.isConnected()||s.isInsertionMarker()||x(T,l.definitionNameToParam[a.parameters[t].name]),++t)}}function E(e,i=!1,t=!1){e=w(e);if(t||i||e!==_.getNumber(c)){_.setValue(c,e);var n=e;if(_.getBoolean(u)||!(0<n)||(I(),s.rendered)){let t=0;for(let e=0;e<s.inputList.length;e++){var o,r=s.inputList[e];pxt.Util.startsWith(r.name,A.optionalDummyInputPrefix)?S(r,t<n||n===h):!pxt.Util.startsWith(r.name,A.optionalInputWithFieldPrefix)&&-1===d.indexOf(r.name)||(S(r,o=t<n),o&&r.connection&&!r.connection.isConnected()&&!s.isInsertionMarker()&&x(r,l.definitionNameToParam[a.parameters[t].name]),++t)}C(),g&&s.setInputsInline(n<f),i||s.queueRender()}}}function k(e,t,i,n){s.appendDummyInput(e).appendField(new N.FieldImageNoText(t,24,24,i,()=>E(n),!1))}function C(){var e,t;y||(e=(t=_.getNumber(c))!==h,t=0!==t,s.inputList.some(e=>e.name===i)&&s.removeInput(i,!0),s.inputList.some(e=>e.name===o)&&s.removeInput(o,!0),s.inputList.some(e=>e.name===r)&&s.removeInput(r,!0),e&&t?s.appendDummyInput(r).appendField(new N.FieldImageNoText(s.REMOVE_IMAGE_DATAURI,24,24,lf("Hide optional arguments"),()=>E(-1*p),!1)).appendField(new N.FieldImageNoText(s.ADD_IMAGE_DATAURI,24,24,lf("Reveal optional arguments"),()=>E(p),!1)):e?k(i,s.ADD_IMAGE_DATAURI,lf("Reveal optional arguments"),p):t&&k(o,s.REMOVE_IMAGE_DATAURI,lf("Hide optional arguments"),-1*p))}function I(){_.setValue(u,!0),t(),C()}function w(e){var t=Math.min(Math.max(_.getNumber(c)+e,0),h);if(b){if(0<=e){if(0===t)return 0;for(var i of b)if(i>=t)return i;return h}for(let e=0;e<b.length;e++)if(b[e]>=t)return 0<e?b[e-1]:0;return b[b.length-1]}return t}function S(e,t){e.setVisible(t)}function x(t,e){let i=(0,O.createShadowValue)(n,e);"value"===i.tagName.toLowerCase()&&(i=i.firstElementChild),R.Events.disable();try{let e;s.initialized?e=R.Xml.domToBlock(i,s.workspace):(e=R.Xml.domToBlockInternal(i,s.workspace),setTimeout(()=>{e.isInsertionMarker()&&(R.Events.disable(),e.dispose(),R.Events.enable())})),e&&t.connection.connect(e.outputConnection)}catch(e){}R.Events.enable()}s.mixin({updateBeforeRender:()=>{y||v&&(v=!1,E(0,void 0,y=!0),y=!1)}})},i.initVariableReporterArgs=function(s,a,l){let c="0_add_button",u="numargs",d=new D(s),e=(d.setEventsEnabled(!1),d.setValue(u,0),d.setEventsEnabled(!0),R.Extensions.apply("inline-svgs",s,!1),()=>{for(var e of a){var t,i,n,o=s.getInput(p.DRAGGABLE_PARAM_INPUT_PREFIX+e.name);if(!o)break;o.connection.targetConnection||(R.Events.disable(),n=pxt.blocks.reporterTypeForArgType(e.type),(t=document.createElement("block")).setAttribute("type",n),(i=document.createElement("field")).setAttribute("name","VALUE"),i.textContent=e.name,t.appendChild(i),"argument_reporter_custom"===n&&((i=document.createElement("mutation")).setAttribute("type",e.type),t.appendChild(i)),n=R.Xml.domToBlock(t,s.workspace),o.connection.connect(n.outputConnection),!s.isInsertionMarker()&&n instanceof R.BlockSvg&&(n.initSvg(),n.queueRender()),R.Events.enable())}}),h=()=>{var t=s.inputList.filter(e=>e.name.startsWith(p.DRAGGABLE_PARAM_INPUT_PREFIX)).length,i=s.inputList.some(e=>e.name===c);if(t<d.getNumber(u))for(let e=t;e<d.getNumber(u);e++){var n,o=a[e];o&&((n=s.appendValueInput(p.DRAGGABLE_PARAM_INPUT_PREFIX+o.name)).setCheck((0,p.getBlocklyCheckForType)(o.type,l)),(0,g.setDuplicateOnDrag)(s.type,n.name),i?s.moveInputBefore(n.name,c):s.moveInputBefore(n.name,"HANDLER"))}else if(t>d.getNumber(u))for(let e=t-1;e>=d.getNumber(u);e--){var r=a[e];r&&((r=s.getInput(p.DRAGGABLE_PARAM_INPUT_PREFIX+r.name)).connection.targetConnection&&(R.Events.disable(),r.connection.targetBlock().dispose(),R.Events.enable()),s.removeInput(r.name,!0))}d.getNumber(u)<a.length?i||(s.appendDummyInput(c).appendField(new N.FieldImageNoText(s.ADD_IMAGE_DATAURI,24,24,lf("Add argument"),()=>{d.setValue(u,d.getNumber(u)+1),h()},!1)),s.moveInputBefore(c,"HANDLER")):i&&s.removeInput(c,!0),setTimeout(e)};h(),L(s,{mutationToDom:e=>(e.setAttribute(u,d.getString(u)),e),domToMutation:e=>{d.setEventsEnabled(!1),e.hasAttribute(u)&&(e=parseInt(e.getAttribute(u)),isNaN(e)||(d.setValue(u,e),h())),d.setEventsEnabled(!0)}})};class D{constructor(e,t){this.block=e,this.fireEvents=!0,this.state=t||{}}setValue(e,n){if(this.fireEvents&&this.block.mutationToDom){let t=this.block.mutationToDom(),i=(this.state[e]=n.toString(),this.block.mutationToDom());Object.keys(this.state).forEach(e=>{t.getAttribute(e)!==this.state[e]&&i.setAttribute(e,this.state[e])});var o=R.Xml.domToText(t),r=R.Xml.domToText(i);o!=r&&R.Events.fire(new R.Events.BlockChange(this.block,"mutation",null,o,r))}else this.state[e]=n.toString()}getNumber(e){return parseInt(this.state[e])}getBoolean(e){return"false"!=this.state[e]}getString(e){return this.state[e]}setEventsEnabled(e){this.fireEvents=e}}},{"./constants":18,"./fields":70,"./fields/field_imagenotext":38,"./loader":77,"./plugins/duplicateOnDrag":91,"./toolbox":139,blockly:219}],18:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.optionalInputWithFieldPrefix=i.optionalDummyInputPrefix=i.provider=void 0;e=e("blockly");i.provider=new e.zelos.ConstantProvider,i.optionalDummyInputPrefix="0_optional_dummy",i.optionalInputWithFieldPrefix="0_optional_field"},{blockly:219}],19:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.registerBlockitems=i.BlockContextWeight=void 0;let n=e("blockly"),o=e("../external");var r;(e=r=i.BlockContextWeight||(i.BlockContextWeight={}))[e.Duplicate=10]="Duplicate",e[e.Copy=15]="Copy",e[e.AddComment=20]="AddComment",e[e.ExpandCollapse=30]="ExpandCollapse",e[e.DeleteBlock=40]="DeleteBlock",e[e.Help=50]="Help",i.registerBlockitems=function(){n.ContextMenuRegistry.registry.unregister("blockDuplicate"),n.ContextMenuRegistry.registry.unregister("blockCollapseExpand"),n.ContextMenuRegistry.registry.unregister("blockHelp"),n.ContextMenuRegistry.registry.unregister("blockInline"),e={displayText(){return lf("Duplicate")},preconditionFn(e){e=e.block;return!e.isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden"},callback(t){if(t.block){let e=!1;t.block.duplicateOnDrag_&&(t.block.duplicateOnDrag_=!1,e=!0);var i=t.block.toCopyData();e&&(t.block.duplicateOnDrag_=!0),i&&n.clipboard.paste(i,t.block.workspace)}},scopeType:n.ContextMenuRegistry.ScopeType.BLOCK,id:"blockDuplicate",weight:r.Duplicate},n.ContextMenuRegistry.registry.register(e),e={displayText(e){return e.block.isCollapsed()?pxt.U.lf("Expand Block"):pxt.U.lf("Collapse Block")},preconditionFn(e){let t=e.block;return t.workspace.getTopBlocks(!1).some(e=>e===t)&&0<t.statementInputCount&&!t.previousConnection&&!t.isInFlyout&&t.isMovable()&&t.workspace.options.collapse?"enabled":"hidden"},callback(e){e.block&&(pxt.tickEvent("blocks.context.expandCollapseBlock",void 0,{interactiveConsent:!0}),e.block.setCollapsed(!e.block.isCollapsed()))},scopeType:n.ContextMenuRegistry.ScopeType.BLOCK,id:"pxtExpandCollapseBlock",weight:r.ExpandCollapse},n.ContextMenuRegistry.registry.register(e),e={displayText(){return pxt.U.lf("Help")},preconditionFn(e){e=e.block;return("function"==typeof e.helpUrl?e.helpUrl():e.helpUrl)?"enabled":"hidden"},callback(e){e.block&&(e="function"==typeof(e=e.block).helpUrl?e.helpUrl():e.helpUrl)&&(0,o.openHelpUrl)(e)},scopeType:n.ContextMenuRegistry.ScopeType.BLOCK,id:"pxtHelpBlock",weight:r.Help},n.ContextMenuRegistry.registry.register(e);var e=n.ContextMenuRegistry.registry.getItem("blockDelete");e&&(e.weight=r.DeleteBlock),(e=n.ContextMenuRegistry.registry.getItem("blockComment"))&&(e.weight=r.AddComment)}},{"../external":25,blockly:219}],20:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.setupWorkspaceContextMenu=i.initContextMenu=void 0;let n=e("blockly"),o=e("./workspaceItems"),r=e("../external"),s=e("./blockItems"),a=!1;i.initContextMenu=function(){var e=n.Msg;e.DUPLICATE_BLOCK=lf("{id:block}Duplicate"),e.DUPLICATE_COMMENT=lf("Duplicate Comment"),e.REMOVE_COMMENT=lf("Remove Comment"),e.ADD_COMMENT=lf("Add Comment"),e.EXTERNAL_INPUTS=lf("External Inputs"),e.INLINE_INPUTS=lf("Inline Inputs"),e.EXPAND_BLOCK=lf("Expand Block"),e.COLLAPSE_BLOCK=lf("Collapse Block"),e.ENABLE_BLOCK=lf("Enable Block"),e.DISABLE_BLOCK=lf("Disable Block"),e.DELETE_BLOCK=lf("Delete Block"),e.DELETE_X_BLOCKS=lf("Delete Blocks"),e.DELETE_ALL_BLOCKS=lf("Delete All Blocks"),e.HELP=lf("Help"),a||(a=!0,(0,o.registerWorkspaceItems)(),(0,s.registerBlockitems)())},i.setupWorkspaceContextMenu=function(i){try{n.ContextMenuItems.registerCommentOptions()}catch(e){}i.configureContextMenu=(e,t)=>{(0,r.onWorkspaceContextMenu)(i,e)}}},{"../external":25,"./blockItems":19,"./workspaceItems":22,blockly:219}],21:[function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,o)}:function(e,t,i,n){e[n=void 0===n?i:n]=t[i]}),o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),o(e("./contextMenu"),i)},{"./contextMenu":20}],22:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.registerWorkspaceItems=i.WorkspaceContextWeight=void 0;let s=e("blockly"),o=e("../layout"),n=e("../external");var a;(e=a=i.WorkspaceContextWeight||(i.WorkspaceContextWeight={}))[e.Paste=10]="Paste",e[e.DeleteAll=20]="DeleteAll",e[e.FormatCode=30]="FormatCode",e[e.CollapseBlocks=40]="CollapseBlocks",e[e.ExpandBlocks=50]="ExpandBlocks",e[e.Snapshot=60]="Snapshot",e[e.Find=70]="Find",i.registerWorkspaceItems=function(){var e;e={displayText(){return pxt.U.lf("Format Code")},preconditionFn(e){return e.workspace.options.readOnly?"hidden":"enabled"},callback(e){e.workspace&&(pxt.tickEvent("blocks.context.format",void 0,{interactiveConsent:!0}),(0,o.flow)(e.workspace,{useViewWidth:!0}))},scopeType:s.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtFormatCode",weight:a.FormatCode},s.ContextMenuRegistry.registry.register(e),e={displayText(){return pxt.U.lf("Snapshot")},preconditionFn(e){var t;return(0,o.screenshotEnabled)()?(t=(e=e.workspace).getTopBlocks(!1),e=e.getTopComments(!1),0===t.length&&0===e.length?"disabled":"enabled"):"hidden"},callback(n){n.workspace&&(pxt.tickEvent("blocks.context.screenshot",void 0,{interactiveConsent:!0}),(async()=>{let e,t,i=await(0,o.screenshotAsync)(n.workspace,null,null==(e=pxt.appTarget.appTheme)?void 0:e.embedBlocksInSnapshot);pxt.BrowserUtils.isSafari()&&(i=await(0,o.screenshotAsync)(n.workspace,null,null==(t=pxt.appTarget.appTheme)?void 0:t.embedBlocksInSnapshot)),pxt.BrowserUtils.isSafari()&&(i=i.replace(/^data:image\/[^;]/,"data:application/octet-stream")),pxt.BrowserUtils.browserDownloadDataUri(i,`${pxt.appTarget.nickname||pxt.appTarget.id}-${lf("screenshot")}.png`)})())},scopeType:s.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtSnapshotCode",weight:a.Snapshot},s.ContextMenuRegistry.registry.register(e),e={displayText(){return pxt.U.lf("Collapse Blocks")},preconditionFn(e){e=e.workspace;return e.options.readOnly||!pxt.appTarget.appTheme.blocksCollapsing?"hidden":e.getTopBlocks(!1).some(e=>e.isEnabled()&&!e.isCollapsed())?"enabled":"disabled"},callback(e){e.workspace&&(pxt.tickEvent("blocks.context.collapse",void 0,{interactiveConsent:!0}),(0,o.setCollapsedAll)(e.workspace,!0))},scopeType:s.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtCollapseBlocks",weight:a.CollapseBlocks},s.ContextMenuRegistry.registry.register(e),e={displayText(){return pxt.U.lf("Expand Blocks")},preconditionFn(e){e=e.workspace;return e.options.readOnly||!pxt.appTarget.appTheme.blocksCollapsing?"hidden":e.getTopBlocks(!1).some(e=>e.isEnabled()&&e.isCollapsed())?"enabled":"disabled"},callback(e){e.workspace&&(pxt.tickEvent("blocks.context.expand",void 0,{interactiveConsent:!0}),(0,o.setCollapsedAll)(e.workspace,!1))},scopeType:s.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtExpandBlocks",weight:a.ExpandBlocks},s.ContextMenuRegistry.registry.register(e);{let r=e=>{let i=[],n=e=>{if(e.isDeletable())i.push(...e.getDescendants(!1));else for(var t of e.getChildren(!1))n(t)};for(var t of e.getTopBlocks())n(t);return i},e={displayText(e){return 1<r(e.workspace).filter(e=>!e.isShadow()).length?pxt.U.lf("Delete All Blocks"):pxt.U.lf("Delete Block")},preconditionFn(e){return e.workspace.options.readOnly?"hidden":0===r(e.workspace).filter(e=>!e.isShadow()).length?"disabled":"enabled"},callback(e){if(e.workspace){let t=r(e.workspace);e=t.filter(e=>!e.isShadow()).length;let i=10,n=s.utils.idGenerator.genUid(),o=()=>{var e=t.shift();e&&(e.isDeadOrDying()?o():(s.Events.setGroup(n),e.dispose(!1,!0),s.Events.setGroup(!1),setTimeout(o,i)))};pxt.tickEvent("blocks.context.delete",void 0,{interactiveConsent:!0}),e<2?o():s.dialog.confirm(lf("Delete all {0} blocks?",e),e=>{e&&o()})}},scopeType:s.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtDeleteAllBlocks",weight:a.DeleteAll};s.ContextMenuRegistry.registry.register(e)}e={displayText(){return pxt.U.lf("Findâ€¦")},preconditionFn(e){return e.workspace.options.readOnly||!pxt.appTarget.appTheme.workspaceSearch?"hidden":"enabled"},callback(e){e.workspace&&(pxt.tickEvent("blocks.context.find",void 0,{interactiveConsent:!0}),(0,n.openWorkspaceSearch)())},scopeType:s.ContextMenuRegistry.ScopeType.WORKSPACE,id:"pxtWorkspaceFind",weight:a.Find},s.ContextMenuRegistry.registry.register(e),s.ContextMenuRegistry.registry.unregister("workspaceDelete"),s.ContextMenuRegistry.registry.unregister("expandWorkspace"),s.ContextMenuRegistry.registry.unregister("collapseWorkspace"),s.ContextMenuRegistry.registry.unregister("cleanWorkspace"),s.ContextMenuRegistry.registry.unregister("redoWorkspace"),s.ContextMenuRegistry.registry.unregister("undoWorkspace")}},{"../external":25,"../layout":75,blockly:219}],23:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.initAccessibleBlocksCopyPasteContextMenu=i.initCopyPaste=void 0;let o=e("blockly"),r=e("./external"),n=e("./contextMenu/blockItems"),s=e("./contextMenu/workspaceItems"),a=e("./plugins/duplicateOnDrag"),l,c,u;i.initCopyPaste=function(e){var t;l||!(0,r.getCopyPasteHandlers)()||(t=o.ShortcutRegistry.registry.getRegistry(),l=Object.assign({},t[o.ShortcutItems.names.COPY]),c=Object.assign({},t[o.ShortcutItems.names.CUT]),u=Object.assign({},t[o.ShortcutItems.names.PASTE]),o.ShortcutRegistry.registry.unregister(o.ShortcutItems.names.COPY),o.ShortcutRegistry.registry.unregister(o.ShortcutItems.names.CUT),o.ShortcutRegistry.registry.unregister(o.ShortcutItems.names.PASTE),t={name:o.ShortcutItems.names.COPY,preconditionFn(e,t){return g(e,t,l.preconditionFn)},callback:h,keyCodes:l.keyCodes},o.ShortcutRegistry.registry.register(t),t={name:o.ShortcutItems.names.CUT,preconditionFn(e,t){return g(e,t,c.preconditionFn)},callback(e,t,i,n){var o=null==(o=(0,r.getCopyPasteHandlers)())?void 0:o.cut;return o?o(e,t,i,n):c.callback(e,t,i,n)},keyCodes:c.keyCodes},o.ShortcutRegistry.registry.register(t),t={name:o.ShortcutItems.names.PASTE,preconditionFn(e,t){return!e.isReadOnly()&&!e.isDragging()&&!o.getFocusManager().ephemeralFocusTaken()},callback:p,keyCodes:u.keyCodes},o.ShortcutRegistry.registry.register(t),e)||(t={displayText:()=>lf("Copy"),preconditionFn:e=>{var t=e.block;return!t.isInFlyout&&t.isMovable()&&t.isEditable()?(t=(0,r.getCopyPasteHandlers)())?t.copyPrecondition(e):"enabled":"hidden"},callback:function(e,t){var i=e.block;i&&(i.select(),h(i.workspace,t,void 0,e))},scopeType:o.ContextMenuRegistry.ScopeType.BLOCK,weight:n.BlockContextWeight.Copy,id:"makecode-copy-block"},e={displayText:()=>lf("Copy"),preconditionFn:e=>{var t=e.comment;return t.isMovable()&&t.isEditable()?(t=(0,r.getCopyPasteHandlers)())?t.copyPrecondition(e):"enabled":"hidden"},callback:function(e,t){var i=e.comment;i&&(i.select(),h(i.workspace,t,void 0,e))},scopeType:o.ContextMenuRegistry.ScopeType.COMMENT,weight:n.BlockContextWeight.Copy,id:"makecode-copy-comment"},o.ContextMenuRegistry.registry.register(t),o.ContextMenuRegistry.registry.register(e),t={displayText:()=>lf("Paste"),preconditionFn:d,callback:function(e,t){var i=e.workspace;i&&p(i,t,void 0,e)},scopeType:o.ContextMenuRegistry.ScopeType.WORKSPACE,weight:s.WorkspaceContextWeight.Paste,id:"makecode-paste"},o.ContextMenuRegistry.registry.register(t))},i.initAccessibleBlocksCopyPasteContextMenu=function(){var e=o.ContextMenuRegistry.registry.getItem("blockPasteFromContextMenu");if("separator"in e)throw new Error(`RegistryItem ${e.id} is not of type ActionRegistryItem`);if(e=Object.assign(Object.assign({},e),{preconditionFn:d}),o.ContextMenuRegistry.registry.unregister("blockPasteFromContextMenu"),o.ContextMenuRegistry.registry.register(e),"separator"in(e=o.ContextMenuRegistry.registry.getItem("blockCutFromContextMenu")))throw new Error(`RegistryItem ${e.id} is not of type ActionRegistryItem`);e=Object.assign(Object.assign({},e),{preconditionFn:e=>{var t,i=e.focusedNode;return i&&o.isCopyable(i)&&(t=i.workspace,!i.workspace.isFlyout)&&t instanceof o.WorkspaceSvg&&c.preconditionFn(t,e)?"enabled":"hidden"}}),o.ContextMenuRegistry.registry.unregister("blockCutFromContextMenu"),o.ContextMenuRegistry.registry.register(e)};let d=e=>{var t;return pxt.shell.isReadOnly()||null!=(t=e.workspace)&&t.options.readOnly?"hidden":(t=(0,r.getCopyPasteHandlers)())?t.pastePrecondition(e):"enabled"},h=(e,t,i,n)=>{var o=null==(o=(0,r.getCopyPasteHandlers)())?void 0:o.copy;return o?o(e,t,i,n):l.callback(e,t,i,n)},p=(e,t,i,n)=>{var o=null==(o=(0,r.getCopyPasteHandlers)())?void 0:o.paste;return o?o(e,t,i,n):u.callback(e,t,i,n)};function g(e,t,i){var n=o.getFocusManager().getFocusedNode(),i=(n instanceof o.BlockSvg&&(0,a.shouldDuplicateOnDrag)(n)&&n.setDeletable(!0),i(e,t));return(0,a.updateDuplicateOnDragState)(n),i}},{"./contextMenu/blockItems":19,"./contextMenu/workspaceItems":22,"./external":25,"./plugins/duplicateOnDrag":91,blockly:219}],24:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.decompiledDiffAsync=i.mergeXml=i.diffXml=i.needsDecompiledDiff=void 0;let S=e("blockly"),x=e("./importer"),R=e("./render");i.needsDecompiledDiff=function(e,t){if(!e||!t)return!1;let i={};if(e.replace(/id="([^"]+)"/g,(e,t)=>(i[t]=!0,"")),!Object.keys(i).length)return!1;let n=0,o=0;return t.replace(/id="([^"]+)"/g,(e,t)=>(n++,i[t]&&o++,"")),0<n&&0==o},i.diffXml=function(e,t,i){return o((0,x.loadWorkspaceXml)(e,!0),(0,x.loadWorkspaceXml)(t,!0),i)};let O="#d0d0d0";function o(p,g,f){try{S.Events.disable();{var m=p;var b=g;var _=f;pxt.tickEvent("blocks.diff",{started:1}),_=_||{};let o=A();if(!m)return{ws:void 0,message:lf("All blocks are new."),added:0,deleted:0,modified:1};if(!b)return{ws:void 0,message:lf("The current blocks seem corrupted."),added:0,deleted:0,modified:1};let n=pxt.Util.toDictionary(m.getTopBlocks(!1),e=>L(e,!0)),e=(b.getTopBlocks(!1).forEach(e=>{var t=L(e,!0),i=m.getBlockById(e.id)||n[t];i&&t==L(i,!0)&&(o("fast unmodified top ",e.id),e.dispose(!1),i.dispose(!1))}),m.getAllBlocks(!1).filter(e=>e.isEnabled())),t=m.getTopBlocks(!1).filter(e=>e.isEnabled()),i=b.getAllBlocks(!1).filter(e=>e.isEnabled());if(o("blocks",i.map(e=>e.toDevString())),o(i),0==e.length&&0==i.length)return pxt.tickEvent("blocks.diff",{moves:1}),{ws:void 0,message:lf("Some blocks were moved or changed."),added:0,deleted:0,modified:1};let r=t.filter(e=>!b.getBlockById(e.id)),s=e.filter(e=>!b.getBlockById(e.id)),a=i.filter(e=>!m.getBlockById(e.id)),l=(0,R.initRenderingWorkspace)(),c=(0,x.saveWorkspaceXml)(b,!0),u=((0,x.domToWorkspaceNoEvents)(S.utils.xml.textToDom(c),l),l.getAllBlocks(!1).filter(e=>!e.isEnabled()).forEach(e=>{o("disabled ",e.toDevString()),e.dispose(!1)}),pxt.Util.toDictionary(l.getAllBlocks(!1),e=>e.id)),d=(o("todo blocks",u),w("start"),_.hideDeletedTopBlocks||(r.forEach(e=>{o("deleted top "+e.toDevString()),I(e);e=k(e);I(e),e.setDisabledReason(!0,N)}),w("deleted top")),a.map(e=>l.getBlockById(e.id)).filter(e=>!!e).forEach(e=>{o("added "+e.toDevString()),I(e)}),w("added"),{}),h=(_.hideDeletedBlocks||((y=s.filter(e=>!(u[e.id]||E(e)||e.outputConnection&&e.outputConnection.isConnected()))).forEach(e=>{var t=k(e);d[e.id]=t.id,o(`deleted block ${e.toDevString()}->`+t.toDevString())}),y.forEach(e=>{o(`stitching ${e.toDevString()}->`+d[e.id]);var t=l.getBlockById(d[e.id]),i=(t.setDisabledReason(!0,N),T(t),I(t),e.getPreviousBlock());i&&(i=l.getBlockById(d[i.id])||l.getBlockById(i.id),o(`previous ${e.id}->${t.toDevString()}: `+i.toDevString()),i)&&(i.nextConnection?t.previousConnection.connect(i.nextConnection):(i=i.inputList.slice().reverse().find(e=>e.connection&&e.connection.type==S.NEXT_STATEMENT))&&t.previousConnection.connect(i.connection)),(i=e.getNextBlock())&&(i=l.getBlockById(d[i.id])||l.getBlockById(i.id))&&(o(`next ${e.id}->${t.toDevString()}: `+i.toDevString()),t.nextConnection.connect(i.previousConnection))})),0);if(pxt.Util.values(u).filter(e=>{var t,i,n=m.getBlockById(e.id);return!!n&&!((t=e.getPreviousBlock())&&!u[t.id]||(e=e.getNextBlock())&&!u[e.id]||!(i=n.getPreviousBlock())&&!t||!!i==!!t&&i.id==t.id&&(!(i=n.getNextBlock())&&!e||!!i==!!e&&i.id==e.id))}).forEach(e=>{o("moved "+e.toDevString()),delete u[e.id],T(e),h++}),w("moved"),pxt.Util.values(u).filter(e=>{var t,i,n=m.getBlockById(e.id);return!!n&&(t=L(n),i=L(e),t!=i)&&(o("old "+n.toDevString(),t),o("new "+e.toDevString(),i),!0)}).forEach(e=>{o("changed "+e.toDevString()),delete u[e.id],T(e),h++}),w("changed"),l.getTopBlocks(!1).forEach(e=>{e.getDescendants(!1).find(e=>E(e))||(o("unmodified top "+e.toDevString()),delete u[e.id],e.dispose(!1))}),w("cleaned"),pxt.Util.values(u).filter(e=>!!l.getBlockById(e.id)).forEach(e=>{!function t(e){e.setColour(O);C(e);_.statementsOnly&&(e.inputList||[]).map(e=>e.type==S.inputs.inputTypes.VALUE&&e.connection&&e.connection.targetBlock()).filter(e=>!!e).forEach(e=>t(e))}(e)}),w("unmodified"),!l.getAllBlocks(!1).length)return pxt.tickEvent("blocks.diff",{missed:1}),{ws:l,message:lf("Some blocks were changed."),deleted:s.length,added:a.length,modified:h};l.resize(),S.svgResize(l);var y=(0,R.renderWorkspace)(_.renderOptions||{emPixels:20,layout:4,aspectRatio:.5,useViewWidth:!0}),v={ws:l,svg:y,deleted:s.length,added:a.length,modified:h};return pxt.tickEvent("blocks.diff",{deleted:v.deleted,added:v.added,modified:v.modified}),v;function T(e){e.__pxt_used=!0}function E(e){return!!e.__pxt_used}function k(e){e=S.Xml.blockToDom(e,!1),e=S.Xml.domToBlock(e,l);return e.nextConnection&&e.nextConnection.targetConnection&&e.nextConnection.disconnect(),e.previousConnection&&e.previousConnection.targetConnection&&e.previousConnection.disconnect(),e}function C(e){e.inputList.forEach(e=>e.fieldRow.forEach(e=>{e.init()}))}function I(e){e.getDescendants(!1).forEach(e=>{delete u[e.id],T(e)})}function w(e){o(e+":",pxt.Util.values(u).map(e=>e.toDevString()))}return}}catch(e){return pxt.reportException(e),{ws:void 0,message:lf("Oops, we could not diff those blocks."),error:e,deleted:0,added:0,modified:0}}finally{S.Events.enable()}}function A(){return pxt.options.debug||window&&/diffdbg=1/.test(window.location.href)?pxt.log:e=>{}}let N="disabled_for_diff";function L(e,t){e=S.Xml.blockToDom(e,!0);return n(e),function e(t,i){if(!t)return;i(t);for(var n of pxt.Util.toArray(t.children))e(n,i)}(e,e=>{n(e),t||"next"!=e.localName&&"statement"!=e.localName&&"shadow"!=e.localName||e.remove()}),S.Xml.domToText(e)}function n(e){e.removeAttribute("id"),e.removeAttribute("x"),e.removeAttribute("y"),e.removeAttribute("deletable"),e.removeAttribute("editable"),e.removeAttribute("movable")}function g(n,o){if(o){let t,i;for(let e=0;e<n.length;++e){var r=n[e];r.startPos<=o.start&&r.endPos>=o.start+o.length&&(!t||i>r.endPos-r.startPos)&&(t=r,i=r.endPos-r.startPos)}return t?t.id:void 0}}i.mergeXml=function(e,t,i){return e==t?i:i==t?e:void 0},i.decompiledDiffAsync=function(e,a,t,l,i={}){let c=A();var n=a.outfiles[pxt.MAIN_BLOCKS];let u=l.outfiles[pxt.MAIN_BLOCKS],d=(c(n),c(u),e=pxt.diff.computeFormattedDiff(e,t,{ignoreWhitespace:!0,full:!0}),c(e),{}),h=0,p=0;return e.forEach((e,t)=>{var i=e[0],n=e.substr(2);let o=n.length;switch(i){case"-":h+=o+1;break;case"+":p+=o+1;break;default:var r,s=/^\s+/.exec(n),s=(s&&(s=s[0].length,h+=s,p+=s,o-=s),g(l.blockSourceMap,{start:p,length:o}));s&&!d[s]&&(r=g(a.blockSourceMap,{start:h,length:o}))&&(c(e),c(`id ${h}:${n.length}>${r} ==> ${p}:${n.length}>`+s),d[s]=r,u=u.replace(s,r)),h+=o+1,p+=o+1}}),t=(0,x.loadWorkspaceXml)(n,!0),e=(0,x.loadWorkspaceXml)(u,!0),i.statementsOnly=!0,o(t,e,i)}},{"./importer":73,"./render":137,blockly:219}],25:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.getCopyPasteHandlers=i.setCopyPaste=i.openWorkspaceSearch=i.setOpenWorkspaceSearch=i.prompt=i.setPrompt=i.setOnWorkspaceContextMenu=i.onWorkspaceContextMenu=i.setOpenHelpUrl=i.openHelpUrl=i.setExtensionBlocklyPatch=i.extensionBlocklyPatch=i.setPromptTranslateBlock=i.promptTranslateBlock=void 0;let o=e("blockly"),n;i.promptTranslateBlock=function(e,t){n&&n(e,t)},i.setPromptTranslateBlock=function(e){n=e};let r;i.extensionBlocklyPatch=function(e,t){r&&r(e,t)},i.setExtensionBlocklyPatch=function(e){r=e};let s;i.openHelpUrl=function(e){s?s(e):window.open(e)},i.setOpenHelpUrl=function(e){s=e};let a;i.onWorkspaceContextMenu=function(e,t){a&&a(e,t)},i.setOnWorkspaceContextMenu=function(e){a=e};let l;i.setPrompt=function(e,t){t&&o.dialog.setPrompt(e),l=e},i.prompt=function(e,t,i,n){l?l(e,t,i,n):o.dialog.prompt(e,t,i)};let c;i.setOpenWorkspaceSearch=function(e){c=e},i.openWorkspaceSearch=function(){c&&c()};let u,d,h,p,g;i.setCopyPaste=function(e,t,i,n,o){u=e,d=t,h=i,p=n,g=o},i.getCopyPasteHandlers=function(){return u?{copy:u,cut:d,paste:h,copyPrecondition:p,pastePrecondition:g}:null}},{blockly:219}],26:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.createFieldEditor=i.registerFieldEditor=i.initFieldEditors=void 0;let n=e("./field_animation"),o=e("./field_tilemap"),r=e("./field_textinput"),s=e("./field_sprite"),a=e("./field_gridpicker"),l=e("./field_colour"),c=e("./field_images"),u=e("./field_textdropdown"),d=e("./field_numberdropdown"),h=e("./field_imagedropdown"),p=e("./field_note"),g=e("./field_melodySandbox"),f=e("./field_toggle"),m=e("./field_toggle_downup"),b=e("./field_toggle_highlow"),_=e("./field_toggle_onoff"),y=e("./field_toggle_updown"),v=e("./field_toggle_winlose"),T=e("./field_toggle_yesno"),E=e("./field_protractor"),k=e("./field_position"),C=e("./field_speed"),I=e("./field_tileset"),w=e("./field_turnratio"),S=e("./field_musiceditor"),x=e("./field_sound_effect"),R=e("./field_autocomplete"),O=e("./field_colorwheel"),A=e("./field_scopedvalueselector"),N={};function L(e,t,i){null==N[e]&&(N[e]={field:t,validator:i})}i.initFieldEditors=function(){var e;L("text",r.FieldTextInput),L("note",p.FieldNote),L("gridpicker",a.FieldGridPicker),L("textdropdown",u.FieldTextDropdown),L("numberdropdown",d.FieldNumberDropdown),L("imagedropdown",h.FieldImageDropdown),L("colorwheel",O.FieldColorWheel),L("toggle",f.FieldToggle),L("toggleonoff",_.FieldToggleOnOff),L("toggleyesno",T.FieldToggleYesNo),L("toggleupdown",y.FieldToggleUpDown),L("toggledownup",m.FieldToggleDownUp),L("togglehighlow",b.FieldToggleHighLow),L("togglewinlose",v.FieldToggleWinLose),L("colornumber",l.FieldColorNumber),L("images",c.FieldImages),L("sprite",s.FieldSpriteEditor),L("animation",n.FieldAnimationEditor),L("tilemap",o.FieldTilemap),L("tileset",I.FieldTileset),L("speed",C.FieldSpeed),L("turnratio",w.FieldTurnRatio),L("protractor",E.FieldProtractor),L("position",k.FieldPosition),L("melody",g.FieldCustomMelody),L("soundeffect",x.FieldSoundEffect),L("autocomplete",R.FieldAutoComplete),L("scopedvalueselector",A.FieldScopedValueSelector),null!=(e=pxt.appTarget.appTheme)&&e.songEditor&&L("musiceditor",S.FieldMusicEditor)},i.registerFieldEditor=L,i.createFieldEditor=function(e,t,i){return null==N[e]?(pxt.error(`Field editor ${e} not registered`),null):(i=i||{},pxt.Util.assert(null==i.lightMode,"lightMode is a reserved parameter for custom fields"),i.lightMode=pxt.options.light,new(e=N[e]).field(t,i,e.validator))}},{"./field_animation":27,"./field_autocomplete":30,"./field_colorwheel":32,"./field_colour":33,"./field_gridpicker":36,"./field_imagedropdown":37,"./field_images":39,"./field_melodySandbox":43,"./field_musiceditor":44,"./field_note":45,"./field_numberdropdown":46,"./field_position":47,"./field_protractor":49,"./field_scopedvalueselector":50,"./field_sound_effect":51,"./field_speed":52,"./field_sprite":53,"./field_textdropdown":55,"./field_textinput":56,"./field_tilemap":57,"./field_tileset":58,"./field_toggle":59,"./field_toggle_downup":60,"./field_toggle_highlow":61,"./field_toggle_onoff":62,"./field_toggle_updown":63,"./field_toggle_winlose":64,"./field_toggle_yesno":65,"./field_turnratio":67}],27:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldAnimationEditor=void 0;var n=pxt.svgUtil,o=e("./field_asset");let r=e("./field_utils");class s extends o.FieldAssetEditor{constructor(){super(...arguments),this.onMouseEnter=()=>{if(!this.animateRef&&this.asset){var t=this.getParentInterval()||this.asset.interval;let e=0;this.animateRef=setInterval(()=>{this.preview&&this.frames[e]&&this.preview.src(this.frames[e]),e=(e+1)%this.frames.length},50<t?t:50)}},this.onMouseLeave=()=>{this.animateRef&&clearInterval(this.animateRef),this.animateRef=void 0,this.preview&&this.frames[0]&&this.preview.src(this.frames[0])}}initView(){this.sourceBlock_.getSvgRoot().addEventListener("mouseenter",this.onMouseEnter),this.sourceBlock_.getSvgRoot().addEventListener("mouseleave",this.onMouseLeave)}showEditor_(){this.asset&&(this.asset.interval=this.getParentInterval()||this.asset.interval),super.showEditor_()}render_(){super.render_(),this.size_.height=42,this.size_.width=80}getAssetType(){return"animation"}createNewAsset(e){var t,i=pxt.react.getTilemapProject();if(e){var n=pxt.lookupProjectAssetByTSReference(e,i);if(n)return n;n=e,t=this.params.taggedTemplate;n=-1===n.indexOf("[")?null:(n=n.replace(/[\[\]]/gm,"")).split(",").map(e=>pxt.sprite.imageLiteralToBitmap(e,t).data()).filter(e=>e.height&&e.width);if(n&&n.length){let e=this.temporaryAssetId(),t={internalID:-1,id:e,type:"animation",frames:n,interval:this.getParentInterval(),meta:{}};return t}n=i.lookupAssetByName("animation",e.trim());if(n)return n}let o=this.temporaryAssetId();i=new pxt.sprite.Bitmap(this.params.initWidth,this.params.initHeight).data();let r={internalID:-1,id:o,type:"animation",frames:[i],interval:500,meta:{}};return r}onEditorClose(e){this.setParentInterval(e.interval)}getValueText(){return this.asset?this.isTemporaryAsset()?"["+this.asset.frames.map(e=>pxt.sprite.bitmapToImageLiteral(pxt.sprite.Bitmap.fromData(e),"typescript",this.params.taggedTemplate)).join(",")+"]":pxt.getTSReferenceForAsset(this.asset):this.valueText||"[]"}redrawPreview(){var e;this.fieldGroup_&&(pxsim.U.clear(this.fieldGroup_),e=(new n.Rect).at(35,1).size(40,40).corner(4).setClass("blocklyAnimationField"),this.fieldGroup_.appendChild(e.el),e=new n.Text("ï€ˆ").at(5,26).setClass("semanticIcon"),this.fieldGroup_.appendChild(e.el),this.asset)&&(this.frames=this.asset.frames.map(e=>(0,r.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(e),32,this.lightMode)),this.preview=(new n.Image).src(this.frames[0]).at(39,5).size(32,32),this.fieldGroup_.appendChild(this.preview.el))}getParentIntervalBlock(){var e,t=this.sourceBlock_;if(t.getParent())for(e of t.getParent().inputList)if("frameInterval"===e.name)return e.connection.targetBlock()}setParentInterval(e){var t,i=this.getParentIntervalBlock();i&&(t=a(i))&&i.setFieldValue(String(e),t)}getParentInterval(){var e=this.getParentIntervalBlock();if(e){var t=a(e);if(t)return Number(e.getFieldValue(t))}return 100}parseFieldOptions(e){return i={initWidth:16,initHeight:16,disableResize:!1,lightMode:!1},(e=e)&&(i.lightMode=e.lightMode,e.filter&&(i.filter=e.filter),i.initWidth=t(e.initWidth,i.initWidth),i.initHeight=t(e.initHeight,i.initHeight),i.taggedTemplate=e.taggedTemplate),i;function t(e,t){e=parseInt(e);return isNaN(e)?t:e}var i}}function a(e){var t;return"math_number_minmax"===e.type?"SLIDER":"math_number"===(t=e.type)||"math_integer"===t||"math_whole_number"===t?"NUM":"timePicker"===e.type?"ms":null}i.FieldAnimationEditor=s},{"./field_asset":29,"./field_utils":69}],28:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldArgumentVariable=void 0;let n=e("blockly");class o extends n.FieldVariable{constructor(e){super(e),this.menuGenerator_=this.generateMenu}generateMenu(){return n.FieldVariable.dropdownCreate.call(this).filter(e=>e[1]!=n.DELETE_VARIABLE_ID)}}i.FieldArgumentVariable=o},{blockly:219}],29:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.BlocklyTilemapChange=i.FieldAssetEditor=void 0;let u=e("blockly");var n=pxt.svgUtil,o=e("./field_base");let d=e("./field_utils");class r extends o.FieldBase{constructor(e,t,i){super(e,t,i),this.pendingEdit=!1,this.isEmpty=!1,this.assetChangeListener=()=>{var e;this.pendingEdit||((e=this.getBlockData())&&(this.asset=pxt.react.getTilemapProject().lookupAsset(this.getAssetType(),e)),this.redrawPreview())},this.lightMode=t.lightMode,this.params=this.parseFieldOptions(t),this.blocksInfo=t.blocksInfo}onInit(){this.redrawPreview()}onValueChanged(e){return this.parseValueText(e),this.redrawPreview(),this.getValueText()}saveState(e){return this.asset&&!this.isTemporaryAsset()?(0,d.getAssetSaveState)(this.asset):super.saveState(e)}loadState(e){"string"==typeof e?super.loadState(e):(e=(0,d.loadAssetFromSaveState)(e),super.loadState(pxt.getTSReferenceForAsset(e)),this.asset=e,this.setBlockData(this.asset.id))}showEditor_(){if(!this.isGreyBlock){var t=Object.assign({},this.params);t.blocksInfo=this.blocksInfo;let e;switch(this.asset.type){case"tile":case"image":e="image-editor",t.temporaryAssets=(0,d.getTemporaryAssets)(this.sourceBlock_.workspace,"image");break;case"animation":e="animation-editor",t.temporaryAssets=(0,d.getTemporaryAssets)(this.sourceBlock_.workspace,"image").concat((0,d.getTemporaryAssets)(this.sourceBlock_.workspace,"animation"));break;case"tilemap":e="tilemap-editor";var i,n=pxt.react.getTilemapProject();pxt.sprite.addMissingTilemapTilesAndReferences(n,this.asset);for(i of(0,d.getTilesReferencedByTilesets)(this.sourceBlock_.workspace))-1===this.asset.data.projectReferences.indexOf(i.id)&&this.asset.data.projectReferences.push(i.id);break;case"song":e="music-editor",t.temporaryAssets=(0,d.getTemporaryAssets)(this.sourceBlock_.workspace,"song"),(0,d.setMelodyEditorOpen)(this.sourceBlock_,!0)}this.isFullscreen()?this.showEditorFullscreen(e,t):this.showEditorInWidgetDiv(e,t)}}getFieldDescription(){var e;return(null==(e=null==(e=this.asset)?void 0:e.meta)?void 0:e.displayName)||this.getAssetType().toString()}showEditorFullscreen(e,t){let i=pxt.react.getFieldEditorView(e,this.asset,t);this.undoRedoState&&i.restorePersistentData(this.undoRedoState),pxt.react.getTilemapProject().pushUndo(),i.onHide(()=>{this.onFieldEditorHide(i)}),i.show()}showEditorInWidgetDiv(e,t){let i,n={getScaledBBox:()=>i},o=(u.WidgetDiv.show(n,this.sourceBlock_.RTL,()=>{document.activeElement&&"INPUT"===document.activeElement.tagName&&document.activeElement.blur(),r.hide(),o.classList.remove("sound-effect-editor-widget"),o.style.transform="",o.style.position="",o.style.left="",o.style.top="",o.style.width="",o.style.height="",o.style.opacity="",o.style.transition="",o.style.alignItems="",this.onFieldEditorHide(r)}),u.WidgetDiv.getDiv()),r=pxt.react.getFieldEditorView(e,this.asset,t,o);var e=this.sourceBlock_,t=e.getBoundingRectangle(),s=(0,d.workspaceToScreenCoordinates)(e.workspace,new u.utils.Coordinate(t.right,t.top));var a=s.x-400,s=s.y+60-20,a=(o.style.opacity="0",o.classList.add("sound-effect-editor-widget"),o.style.position="absolute",o.style.left=a+"px",o.style.top=s+"px",o.style.width="50rem",o.style.height="34.25rem",o.style.display="flex",o.style.alignItems="center",o.style.transition="transform 0.25s ease 0s, opacity 0.25s ease 0s",o.style.borderRadius="",r.onHide(()=>{u.WidgetDiv.hideIfOwner(n)}),r.show(),o.getBoundingClientRect()),s=e.workspace.getInjectionDiv().getBoundingClientRect(),l=(a.height>s.height?(o.style.height="",o.style.top="calc(1rem - 20px)",o.style.bottom="calc(1rem + 20px)"):(a.bottom>s.bottom||a.top<s.top)&&(o.style.top=s.top+s.height/2-a.height/2-20+"px"),e.workspace.getToolbox().getWidth()),c=s.left+l,t=(a.width>s.width-l?(o.style.width="",o.style.left="1rem",o.style.right="1rem"):a.left+a.width>=s.right?(e=(0,d.workspaceToScreenCoordinates)(e.workspace,new u.utils.Coordinate(t.left,t.top))).x-a.width-20>c?o.style.left=e.x-a.width-20+"px":o.style.left=c+(s.width-l)/2-a.width/2+"px":a.left<s.left&&(o.style.left=c+"px"),o.getBoundingClientRect());i=new u.utils.Rect(t.top,t.bottom,t.left,t.right),requestAnimationFrame(()=>{o.style.opacity="1",o.style.transform="translateY(20px)"})}onFieldEditorHide(e){var t,i,n,o,r=e.getResult(),s=pxt.react.getTilemapProject();"song"===this.asset.type&&(0,d.setMelodyEditorOpen)(this.sourceBlock_,!1),r&&(t=this.getValue(),pxt.assetEquals(this.asset,r)||(r=pxt.patchTemporaryAsset(this.asset,r,s),i=a(this.asset)?null:this.asset.id,n=a(r)?null:r.id,this.pendingEdit=!0,null!=(o=r.meta)&&o.displayName&&this.disposeOfTemporaryAsset(),this.asset=r,o=s.revision(),this.onEditorClose(this.asset),this.updateAssetListener(),this.updateAssetMeta(),this.redrawPreview(),this.undoRedoState=e.getPersistentData(),this.sourceBlock_&&u.Events.isEnabled()&&(r=new l(this.sourceBlock_,"field",this.name,t,this.getValue(),o,s.revision()),i!==n&&(r.oldAssetId=i,r.newAssetId=n),u.Events.fire(r)),this.pendingEdit=!1))}render_(){this.isGreyBlock&&!this.textElement_&&this.createTextElement_(),super.render_(),this.isGreyBlock||(this.size_.height=42,this.size_.width=50)}getDisplayText_(){var e;return this.isGreyBlock?(e=pxt.Util.htmlUnescape(this.valueText)).substr(0,e.indexOf("("))+"(...)":""}updateEditable(){var e;this.isGreyBlock&&this.fieldGroup_?(e=this.fieldGroup_,u.utils.dom.removeClass(e,"blocklyNonEditableText"),u.utils.dom.removeClass(e,"blocklyEditableText"),e.style.cursor=""):super.updateEditable()}getValue(){return this.isGreyBlock?pxt.Util.htmlUnescape(this.valueText):this.getValueText()}onDispose(){var e;null!=(e=this.sourceBlock_)&&e.workspace&&!this.sourceBlock_.workspace.rendered&&this.disposeOfTemporaryAsset(),pxt.react.getTilemapProject().removeChangeListener(this.getAssetType(),this.assetChangeListener)}disposeOfTemporaryAsset(){this.isTemporaryAsset()&&(pxt.react.getTilemapProject().removeAsset(this.asset),this.setBlockData(null),this.asset=void 0)}clearTemporaryAssetData(){this.isTemporaryAsset()&&this.setBlockData(null)}isTemporaryAsset(){return a(this.asset)}getAsset(){return this.asset}updateAsset(e){this.asset=e,this.setValue(this.getValue())}onEditorClose(e){}redrawPreview(){if(this.fieldGroup_)if(pxsim.U.clear(this.fieldGroup_),this.isGreyBlock)this.createTextElement_(),this.render_(),this.updateEditable();else{var t=(new n.Rect).at(5,1).size(40,40).setClass("blocklySpriteField").stroke("#898989",1).corner(4);if(this.fieldGroup_.appendChild(t.el),this.asset){let e;switch(this.asset.type){case"image":case"tile":e=(0,d.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(this.asset.bitmap),32,this.lightMode);break;case"animation":e=(0,d.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(this.asset.frames[0]),32,this.lightMode);break;case"tilemap":e=(0,d.tilemapToImageURI)(this.asset.data,32,this.lightMode);break;case"song":e=(0,d.songToDataURI)(this.asset.song,60,20,this.lightMode)}e&&(t=(new n.Image).src(e).at(9,5).size(32,32),this.fieldGroup_.appendChild(t.el))}}}parseValueText(e){var t,i;e=pxt.Util.htmlUnescape(e),this.sourceBlock_&&(t=pxt.react.getTilemapProject(),i=this.getBlockData(),!(i=t.lookupAsset(this.getAssetType(),i))||e&&this.isEmpty?(this.setBlockData(null),this.asset&&this.sourceBlock_&&this.asset.meta.blockIDs&&(this.asset.meta.blockIDs=this.asset.meta.blockIDs.filter(e=>e!==this.sourceBlock_.id),this.isTemporaryAsset()||t.updateAsset(this.asset)),this.isEmpty=!e,this.asset=this.createNewAsset(e)):this.asset=i,this.updateAssetMeta(),this.updateAssetListener())}parseFieldOptions(e){var t={initWidth:16,initHeight:16,disableResize:!1,lightMode:!1};return e&&(e.disableResize&&(t.disableResize="true"===e.disableResize.toLowerCase()||"1"===e.disableResize),t.initWidth=i(e.initWidth,t.initWidth),t.initHeight=i(e.initHeight,t.initHeight),t.lightMode=e.lightMode),t;function i(e,t){e=parseInt(e);return isNaN(e)?t:e}}updateAssetMeta(){var e;this.asset&&(this.asset.meta||(this.asset.meta={}),this.asset.meta.blockIDs||(this.asset.meta.blockIDs=[]),this.sourceBlock_&&(-1===this.asset.meta.blockIDs.indexOf(this.sourceBlock_.id)&&((e=this.asset.meta.blockIDs).length&&this.isTemporaryAsset()&&e.some(e=>this.sourceBlock_.workspace.getBlockById(e))&&(this.asset=pxt.cloneAsset(this.asset),this.asset.meta.blockIDs=[]),this.asset.meta.blockIDs.push(this.sourceBlock_.id)),this.setBlockData(this.isTemporaryAsset()?null:this.asset.id)),this.isTemporaryAsset()?this.asset.meta.temporaryInfo={blockId:this.sourceBlock_.id,fieldName:this.name}:pxt.react.getTilemapProject().updateAsset(this.asset))}updateAssetListener(){pxt.react.getTilemapProject().removeChangeListener(this.getAssetType(),this.assetChangeListener),this.asset&&!this.isTemporaryAsset()&&pxt.react.getTilemapProject().addChangeListener(this.asset,this.assetChangeListener)}isFullscreen(){return!0}temporaryAssetId(){return this.sourceBlock_.id+"_"+this.name}}function a(e){return e&&!e.meta.displayName}i.FieldAssetEditor=r;class l extends u.Events.BlockChange{constructor(e,t,i,n,o,r,s){super(e,t,i,n,o),this.oldRevision=r,this.newRevision=s,this.fieldName=i}isNull(){return this.oldRevision===this.newRevision&&super.isNull()}run(e){(this.newAssetId||this.oldAssetId)&&(t=this.getEventWorkspace_().getBlockById(this.blockId),e?(0,d.setBlockDataForField)(t,this.fieldName,this.newAssetId):(0,d.setBlockDataForField)(t,this.fieldName,this.oldAssetId)),e?pxt.react.getTilemapProject().redo():pxt.react.getTilemapProject().undo(),super.run(e);var t=this.getEventWorkspace_(),e=new l(t.getBlockById(this.blockId),"tilemap-revision","revision",null,pxt.react.getTilemapProject().revision(),0,0);e.recordUndo=!1,u.Events.fire(e)}}i.BlocklyTilemapChange=l},{"./field_base":31,"./field_utils":69,blockly:219}],30:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldAutoComplete=void 0;let n=e("blockly"),o=e("./field_utils");var r=e("./field_textdropdown");let s=e("../plugins/text");class a extends r.FieldTextDropdown{constructor(e,t,i){super(e,t,i),this.isFieldCustom_=!0,this.key=t.key,this.isTextValid_=!0}isOptionListDynamic(){return!0}getDisplayText_(){return this.parsedValue||""}getFieldDescription(){return this.getDisplayText_()}doValueUpdate_(e){this.isDirty_=!0,null!==e&&(/['"`].*['"`]/.test(e)?this.parsedValue=JSON.parse(e):this.parsedValue=e,this.value_=this.parsedValue)}getValue(){return this.parsedValue||""}getOptions(){var e=null==(e=this.sourceBlock_)?void 0:e.workspace;if(!e)return[];var i=[];for(let t of(0,o.getAllFields)(e,e=>e instanceof a&&e.getKey()===this.key).map(e=>e.ref.getDisplayText_()))t.trim()&&!i.some(e=>e[0]===t)&&i.push([t,t]);return i.sort((e,t)=>e[0].localeCompare(t[0])),i}showDropdown_(){this.getOptions().length&&super.showDropdown_()}getKey(){return this.key||(this.sourceBlock_?this.sourceBlock_.type:void 0)}initView(){this.quoteSize_=16,this.quoteWidth_=8,this.quoteLeftX_=0,this.quoteRightX_=0,this.quoteY_=10,this.quoteLeft_&&this.quoteLeft_.parentNode.removeChild(this.quoteLeft_),this.quoteLeft_=n.utils.dom.createSvgElement("text",{"font-size":this.quoteSize_+"px",class:"field-text-quote"},this.fieldGroup_),super.initView(),this.quoteRight_&&this.quoteRight_.parentNode.removeChild(this.quoteRight_),this.quoteRight_=n.utils.dom.createSvgElement("text",{"font-size":this.quoteSize_+"px",class:"field-text-quote"},this.fieldGroup_),this.quoteLeft_.appendChild(document.createTextNode('"')),this.quoteRight_.appendChild(document.createTextNode('"'))}updateSize_(){super.updateSize_();var e=Math.max(this.size_.width,1);let t=this.positionLeft(e+3);this.textElement_.setAttribute("x",t.toString()),t+=this.positionRight(t+e+3),this.size_.width=e+t}positionRight(e){if(!this.quoteRight_)return 0;let t=0;return t=(this.sourceBlock_.RTL?this.quoteRightX_=s.FieldString.quotePadding:this.quoteRightX_=e+s.FieldString.quotePadding,this.quoteWidth_+s.FieldString.quotePadding),this.quoteRight_.setAttribute("transform","translate("+this.quoteRightX_+","+this.quoteY_+")"),t}positionLeft(e){if(!this.quoteLeft_)return 0;let t=0;return t=(this.sourceBlock_.RTL?this.quoteLeftX_=e+this.quoteWidth_+2*s.FieldString.quotePadding:this.quoteLeftX_=0,this.quoteWidth_+s.FieldString.quotePadding),this.quoteLeft_.setAttribute("transform","translate("+this.quoteLeftX_+","+this.quoteY_+")"),t}createSVGArrow(){}}i.FieldAutoComplete=a},{"../plugins/text":134,"./field_textdropdown":55,"./field_utils":69,blockly:219}],31:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldBase=void 0;var n=e("blockly");let o=e("./field_utils");class r extends n.Field{constructor(e,t,i){super(e,i),this.SERIALIZABLE=!0,this.options=t,e&&!this.valueText&&(this.valueText=e)}static enqueueInit(e){r.pendingInit.push(e),this.pendingTimeout||(r.pendingTimeout=setTimeout(()=>r.flushInitQueue()))}static flushInitQueue(){for(var e of r.pendingInit)e.onLoadedIntoWorkspace();r.pendingTimeout=void 0,r.pendingInit=[]}init(){super.init(),this.onInit(),r.enqueueInit(this)}dispose(){this.onDispose()}getValue(){return this.valueText}doValueUpdate_(e){null!==e&&(this.valueText=this.loaded?this.onValueChanged(e):e)}getDisplayText_(){return this.valueText}onLoadedIntoWorkspace(){this.loaded||(this.loaded=!0,this.valueText=this.onValueChanged(this.valueText))}getFieldDescription(){return this.getDisplayText_()}getAnchorDimensions(){var e=this.getScaledBBox();return this.sourceBlock_.RTL?e.right+=r.CHECKMARK_OVERHANG:e.left-=r.CHECKMARK_OVERHANG,e}isInitialized(){return!!this.fieldGroup_}getBlockData(){return(0,o.getBlockDataForField)(this.sourceBlock_,this.name)}setBlockData(e){(0,o.setBlockDataForField)(this.sourceBlock_,this.name,e)}getSiblingBlock(e,t=!1){t=t?this.sourceBlock_.getParent():this.sourceBlock_;if(t&&t.inputList)for(var i of t.inputList)if(i.name===e)return i.connection.targetBlock()}getSiblingField(e,t=!1){t=t?this.sourceBlock_.getParent():this.sourceBlock_;if(t)return t.getField(e)}}(i.FieldBase=r).CHECKMARK_OVERHANG=25,r.pendingInit=[]},{"./field_utils":69,blockly:219}],32:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldColorWheel=void 0;e=e("../plugins/math");class n extends e.FieldSlider{constructor(e,t,i){super(String(e),"0","255","1","10","Color",i),this.isFieldCustom_=!0,this.params=t,this.params.min&&(this.min_=parseFloat(this.params.min)),this.params.max&&(this.max_=parseFloat(this.params.max)),this.params.label&&(this.labelText_=this.params.label),this.params.channel&&(this.channel_=this.params.channel)}setBackground_(e){var t=this.createColourStops_().join(",");e.style.background=`linear-gradient(left, ${t})`,this.params.sliderWidth&&(e.style.width=this.params.sliderWidth+"px")}setReadout_(e,t){var t=this.colorWheel(parseInt(t),this.channel_),i=document.createElement("span");i.className="blocklyColorReadout",i.style.backgroundColor=""+t,pxsim.U.clear(e),e.appendChild(i)}createColourStops_(){var t=[];for(let e=0;e<=255;e+=20)t.push(this.colorWheel(e,this.channel_));return t}colorWheel(e,t){return"hsvfast"==t?this.hsvFast(e,255,255):(e=255-e)<85?this.hex(3*e,255,255-3*e):e<170?this.hex(255,255-3*(e-=85),3*e):this.hex(255-3*(e-=170),3*e,255)}hsvFast(e,t,i){let n=e%255>>0;n<0&&(n+=255);var e=i*(255-t)/255>>0,t=i-e,i=(n=192*n/255>>0)/64>>0,o=n%64>>0,r=(o*t/63.75>>0)+e,o=((63-o)*t/63.75>>0)+e;let s,a,l;return l=i?1==i?(s=e,a=o,r):(s=r,a=e,o):(s=o,a=r,e),this.hex(s,a,l)}hex(e,t,i){return"#"+this.componentToHex(255&e)+this.componentToHex(255&t)+this.componentToHex(255&i)}componentToHex(e){e=e.toString(16);return 1==e.length?"0"+e:e}}i.FieldColorWheel=n},{"../plugins/math":119}],33:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldColorNumber=void 0;var n=e("@blockly/field-grid-dropdown");let o=e("blockly/core");class r extends n.FieldGridDropdown{constructor(e,t,i){let n,o,r;var s,a,l,c=null!=(n=t.valueMode)?n:"rgb",u="#dedede";t.colours?0<(o=JSON.parse(t.colours)).lastIndexOf(o[0])&&(o[0]=u):pxt.appTarget.runtime&&pxt.appTarget.runtime.palette&&((o=pxt.Util.clone(pxt.appTarget.runtime.palette))[0]=u,pxt.appTarget.runtime.paletteNames)&&((r=pxt.Util.clone(pxt.appTarget.runtime.paletteNames))[0]=lf("transparent")),super((s=c,a=o,l=r,a.map(e=>d(e,s,a)).map((e,t)=>{var i=document.createElement("div");return i.className="blocklyColourSwatch",i.style.backgroundColor=a[t],l&&t<l.length&&(i.title=l[t]),[i,e]})),i,{primaryColour:"white",borderColour:"#dadce0",columns:t.columns?parseInt(t.columns):7}),this.isFieldCustom_=!0,this.isDirty_=!1,this.allColoursCSSFormat_=o,this.valueMode_=c,this.setValue(e)}trimOptions(e){return{options:e}}initView(){var e=this.getConstants();if(!e)throw Error("Constants not found");this.size_=new o.utils.Size(e.FIELD_COLOUR_DEFAULT_WIDTH,e.FIELD_COLOUR_DEFAULT_HEIGHT),this.createBorderRect_(),this.getBorderRect().style.fillOpacity="1",this.getBorderRect().setAttribute("stroke","#fff"),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}showEditor_(e){super.showEditor_(e),o.DropDownDiv.getContentDiv().classList.add("blocklyFieldColour"),o.DropDownDiv.repositionForWindowResize()}isFullBlockField(){var e;if(this.getSourceBlock())return e=this.getConstants(),this.blockIsSimpleReporter()&&Boolean(null==e?void 0:e.FIELD_COLOUR_FULL_BLOCK);throw new o.UnattachedFieldError}blockIsSimpleReporter(){var e,t=this.getSourceBlock();if(!t)throw new o.UnattachedFieldError;if(!t.outputConnection)return!1;for(e of t.inputList)if(e.connection||1<e.fieldRow.length)return!1;return!0}applyColour(){var e=this.getSourceBlock();if(!e)throw new o.UnattachedFieldError;if(this.fieldGroup_){var t=this.borderRect_;if(!t)throw new Error("The border rect has not been initialized");this.isFullBlockField()?(t.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getCSSValue()),e.pathObject.svgPath.setAttribute("stroke","#fff")):(t.style.display="block",t.style.fill=this.getCSSValue())}}getSize(){var e;return null!=(e=this.getConstants())&&e.FIELD_COLOUR_FULL_BLOCK&&(this.render_(),this.isDirty_=!1),super.getSize()}render_(){this.updateSize_();var e=this.getSourceBlock();if(!e)throw new o.UnattachedFieldError;e.applyColour()}updateSize_(i){var n=this.getConstants();if(n){let e,t;t=this.isFullBlockField()?(e=2*(null!=i?i:0),n.FIELD_TEXT_HEIGHT):(e=n.FIELD_COLOUR_DEFAULT_WIDTH,n.FIELD_COLOUR_DEFAULT_HEIGHT),this.size_.height=t,this.size_.width=e,this.positionBorderRect_()}}doClassValidation_(e){return this.allColoursCSSFormat_?"string"!=typeof e?null:d(s(e,this.allColoursCSSFormat_),this.valueMode_,this.allColoursCSSFormat_):e}getText(){let e=this.getCSSValue();return e=/^#(.)\1(.)\2(.)\3$/.test(e)?"#"+e[1]+e[3]+e[5]:e}getFieldDescription(){var e=this.getCSSValue();return e?lf("color ${0}",e):lf("color")}getCSSValue(){return s(this.getValue(),this.allColoursCSSFormat_)}}function d(t,e,i){switch(e){case"hex":return`"${t}"`;case"rgb":return-1<t.indexOf("#")?"0x"+t.replace(/^#/,""):t;case"index":if(!t)return"-1";for(let e=0;e<i.length;e++)if(t.toUpperCase()===i[e].toUpperCase())return e+""}return t}function s(e,t){if(e){var i=/Colors\.([a-zA-Z]+)/.exec(e),n=/(0x|#)([0-9a-fA-F]+)/.exec(e);if(i)switch(i[1].toLocaleLowerCase()){case"red":return"#FF0000";case"orange":return"#FF7F00";case"yellow":return"#FFFF00";case"green":return"#00FF00";case"blue":return"#0000FF";case"indigo":return"#4B0082";case"violet":return"#8A2BE2";case"purple":return"#A033E5";case"pink":return"#FF007F";case"white":return"#FFFFFF";case"black":return"#000000";default:return e}else if(n){var o=n[2];if(3===o.length){let t="#";for(let e=0;e<o.length;e++){var r=o.charAt(e);t+=r+r}return t}if(6===o.length)return"#"+o}i=parseInt(e);return isNaN(i)||null==t[i]?t[0]:t[i]}return e}i.FieldColorNumber=r,o.Css.register(`
.blocklyColourSwatch {
    width: 22px;
    height: 22px;
}

.blocklyFieldColour.blocklyFieldGridContainer {
    padding: 0px;
}

.blocklyFieldColour .blocklyFieldGrid {
    grid-gap: 0px;
    row-gap: 0px;
    outline: none;
}

.blocklyFieldColour .blocklyFieldGrid .blocklyFieldGridItem {
    padding: 0;
    border: none;
    margin: 2px;
}

.blocklyFieldColour .blocklyFieldGrid .blocklyFieldGridItem .blocklyColourSwatch {
    border: 2px solid rgba(0,0,0,.1);
    border-radius: 4px;
}

.blocklyFieldColour .blocklyFieldGridItem:focus .blocklyColourSwatch {
    box-shadow: 2px 2px 7px 2px rgba(0,0,0,.3);
    border-color: #eee;
    border-width: 1px;
}

.blocklyFieldColour .blocklyFieldGrid .blocklyFieldGridItemSelected .blocklyColourSwatch {
    outline: 1px solid #000;
    border-color: #eee;
    border-width: 1px;
}
`)},{"@blockly/field-grid-dropdown":213,"blockly/core":218}],34:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldDropdown=void 0;let n=e("blockly"),o=e("../plugins/newVariableField/fieldDropdownMixin");class r extends n.FieldDropdown{constructor(){super(...arguments),this.svgRootBinding=null,this.fieldRootBinding=null}initView(){super.initView(),this.fieldGroup_&&this.fieldGroup_.classList.add("pxtFieldDropdown"),this.shouldAddBorderRect_()||(this.createBorderRect_(),this.clickTargetRect=this.borderRect_,this.clickTargetRect.setAttribute("stroke-opacity","0"),this.clickTargetRect.setAttribute("fill-opacity","0"),this.borderRect_=void 0)}shouldAddBorderRect_(){if("variables_get"===this.sourceBlock_.type)return!1;for(var e of this.sourceBlock_.inputList)for(var t of e.fieldRow)if(t!==this&&t.EDITABLE)return!0;return!this.sourceBlock_.getInputsInline()||super.shouldAddBorderRect_()}bindEvents_(){this.shouldAddBorderRect_()?super.bindEvents_():(this.svgRootBinding=n.browserEvents.conditionalBind(this.sourceBlock_.getSvgRoot(),"pointerdown",this,e=>{this.sourceBlock_.icons.length||this.onMouseDown_(e)},!1),this.fieldRootBinding=n.browserEvents.conditionalBind(this.getSvgRoot(),"pointerdown",this,e=>{this.sourceBlock_.icons.length&&this.onMouseDown_(e)},!1))}dispose(){super.dispose(),this.svgRootBinding&&(n.browserEvents.unbind(this.svgRootBinding),n.browserEvents.unbind(this.fieldRootBinding))}positionBorderRect_(){super.positionBorderRect_(),this.clickTargetRect&&(this.clickTargetRect.setAttribute("width",String(this.size_.width)),this.clickTargetRect.setAttribute("height",String(this.size_.height)),this.clickTargetRect.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.clickTargetRect.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}showEditor_(e){o.showEditorMixin.call(this,e)}}i.FieldDropdown=r,n.Css.register(`
.pxtFieldDropdown.blocklyActiveFocus > .blocklyFieldRect, .pxtFieldDropdown.blocklyPassiveFocus > .blocklyFieldRect {
    stroke-opacity: 1;
}
`)},{"../plugins/newVariableField/fieldDropdownMixin":121,blockly:219}],35:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldDropdownGrid=void 0;let r=e("blockly");e=e("./field_dropdown");class n extends e.FieldDropdown{constructor(){super(...arguments),this.isFieldCustom_=!0,this.gridItems=[],this.keyDownBinding=null,this.pointerMoveBinding=null}setFocusedItem(e,t){this.lastUserInputAction="keymove",this.setFocusedItem_(e),e.setAttribute("aria-activedescendant",":"+this.activeDescendantIndex),t.preventDefault(),t.stopPropagation()}setOpeningPointerCoords(e){var t;e&&({pageX:e,pageY:t}=e,void 0!==e)&&void 0!==t&&(this.openingPointerCoords={x:e,y:t})}addKeyDownHandler(i){let n=pxt.Util.isUserLanguageRtl()?"ArrowLeft":"ArrowRight",o=pxt.Util.isUserLanguageRtl()?"ArrowRight":"ArrowLeft";this.keyDownBinding=r.browserEvents.bind(i,"keydown",this,e=>{if(void 0===this.activeDescendantIndex){if("ArrowDown"===e.code||e.code===n||"Home"===e.code)return this.activeDescendantIndex=0,this.setFocusedItem(i,e);if("ArrowUp"===e.code||e.code===o||"End"===e.code)return this.activeDescendantIndex=this.gridItems.length-1,this.setFocusedItem(i,e)}var t=pxt.BrowserUtils.isMac()?e.metaKey:e.ctrlKey;switch(e.code){case"ArrowUp":0<=this.activeDescendantIndex-this.columns_&&(this.activeDescendantIndex-=this.columns_);break;case"ArrowDown":this.activeDescendantIndex+this.columns_<this.gridItems.length&&(this.activeDescendantIndex+=this.columns_);break;case n:this.activeDescendantIndex<this.gridItems.length-1&&this.activeDescendantIndex++;break;case o:0!==this.activeDescendantIndex&&this.activeDescendantIndex--;break;case"Home":if(t)this.activeDescendantIndex=0;else for(;this.activeDescendantIndex%this.columns_!=0;)this.activeDescendantIndex--;break;case"End":if(t)this.activeDescendantIndex=this.gridItems.length-1;else for(;this.activeDescendantIndex%this.columns_!=this.columns_-1&&this.activeDescendantIndex<this.gridItems.length-1;)this.activeDescendantIndex++;break;case"Enter":case"Space":return this.buttonClickAndClose_(this.gridItems[this.activeDescendantIndex].getAttribute("data-value")),e.preventDefault(),void e.stopPropagation();default:return}this.setFocusedItem(i,e)})}addPointerListener(e){this.pointerMoveBinding=r.browserEvents.bind(e,"pointermove",this,()=>{this.lastUserInputAction="pointermove"})}pointerMoveTriggeredByUser(){return this.openingPointerCoords&&!this.lastUserInputAction||"pointermove"===this.lastUserInputAction}pointerOutTriggeredByUser(){return"pointermove"===this.lastUserInputAction}disposeGrid(){this.keyDownBinding&&r.browserEvents.unbind(this.keyDownBinding),this.pointerMoveBinding&&r.browserEvents.unbind(this.pointerMoveBinding),this.keyDownBinding=null,this.pointerMoveBinding=null,this.openingPointerCoords=void 0,this.lastUserInputAction=void 0,this.activeDescendantIndex=void 0,this.gridItems=[]}}i.FieldDropdownGrid=n},{"./field_dropdown":34,blockly:219}],36:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldGridPicker=void 0;let d=e("blockly"),o=e("./field_utils"),n=e("./field_base");e=e("./field_dropdowngrid");class h extends e.FieldDropdownGrid{constructor(e,t,i){super(t.data),this.tabKeyBind=null,this.buttonClick_=e=>{null!==e&&(this.setValue(e),this.closeModal_)&&(this.close(),this.closeModal_=!1)},this.buttonClickAndClose_=e=>{this.closeModal_=!0,this.buttonClick_(e)},this.columns_=parseInt(t.columns)||4,this.maxRows_=parseInt(t.maxRows)||0,this.width_=parseInt(t.width)||void 0,this.backgroundColour_=(0,o.parseColour)(t.colour),this.borderColour_=pxt.toolbox.fadeColor(this.backgroundColour_,.4,!1);var n={xOffset:parseInt(t.tooltipsXOffset)||15,yOffset:parseInt(t.tooltipsYOffset)||-10};this.tooltipConfig_=n,this.hasSearchBar_=!!t.hasSearchBar||!1}setFocusedItem_(e){this.gridItems.forEach(e=>e.classList.remove("gridpicker-option-focused","gridpicker-menuitem-highlight"));var t=this.gridItems[this.activeDescendantIndex],i=(t.classList.add("gridpicker-option-focused"),d.utils.style.scrollIntoContainerView(t,this.scrollContainer),t.getBoundingClientRect());this.gridTooltip_&&(t=t.title||t.alt,this.gridTooltip_.textContent=t,this.gridTooltip_.style.visibility=t?"visible":"hidden",this.gridTooltip_.style.display=t?"":"none",this.gridTooltip_.style.top=i.bottom+5+"px",this.gridTooltip_.style.left=i.left+"px"),this.addKeyboardNavigableClass()}dispose(){super.dispose(),this.disposeGrid(),this.disposeTooltip(),this.disposeIntersectionObserver()}createTooltip_(){this.gridTooltip_||(this.gridTooltip_=document.createElement("div"),this.gridTooltip_.className="blocklyGridPickerTooltip",this.gridTooltip_.style.position="absolute",this.gridTooltip_.style.display="none",this.gridTooltip_.style.visibility="hidden",document.body.appendChild(this.gridTooltip_))}populateTableContainer(t,i,e){this.gridItems=[],this.activeDescendantIndex=0,pxsim.U.removeChildren(i),0==t.length&&(this.firstItem_=void 0);for(let e=0;e<t.length/this.columns_;e++){var n=this.populateRow(e,t,i);i.appendChild(n)}}populateRow(e,t,a){var i=this.columns_,l=document.createElement("div");l.className="blocklyGridPickerRow";for(let s=i*e;s<Math.min(i*e+i,t.length);s++){let i=t[s][0],n=t[s][1],o=document.createElement("div");o.className="gridpicker-menuitem gridpicker-option",o.setAttribute("id",":"+s),o.setAttribute("role","gridcell"),o.setAttribute("aria-selected","false"),o.style.userSelect="none",o.title=i.alt||i,o.setAttribute("data-value",n);var c,u=document.createElement("div");u.setAttribute("class","gridpicker-menuitem-content"),u.title=i.alt||i,u.setAttribute("data-value",n);let r="object"==typeof i,e=this.backgroundColour_;if(n==this.getValue()&&(o.setAttribute("aria-selected","true"),this.activeDescendantIndex=s,pxt.BrowserUtils.addClass(o,"gridpicker-option-selected "+(this.openingPointerCoords?"":"gridpicker-option-focused")),e=this.sourceBlock_.getColourTertiary(),this.selectedItemDom=o,r)&&!this.shouldShowTooltips()&&this.updateSelectedBar_(i,n),o.style.backgroundColor=e,o.style.borderColor=this.borderColour_,r?((c=new Image(i.width,i.height)).setAttribute("draggable","false"),"IntersectionObserver"in window?(c.src=h.DEFAULT_IMG,c.setAttribute("data-src",i.src),this.observer.observe(c)):c.src=i.src,c.alt=i.alt||"",c.setAttribute("data-value",n),u.appendChild(c)):u.textContent=i,this.shouldShowTooltips()){d.browserEvents.conditionalBind(o,"click",this,()=>this.buttonClickAndClose_(n));let t=this.sourceBlock_.RTL?-this.tooltipConfig_.xOffset:this.tooltipConfig_.xOffset,i=this.tooltipConfig_.yOffset;d.browserEvents.bind(o,"pointermove",this,e=>{this.pointerMoveTriggeredByUser()&&(this.gridItems.forEach(e=>e.classList.remove("gridpicker-option-focused")),this.activeDescendantIndex=s,r&&(this.gridTooltip_.style.top=e.clientY+i+"px",this.gridTooltip_.style.left=e.clientX+t+"px",e=(e=document.elementFromPoint(e.clientX,e.clientY)).title||e.alt,this.gridTooltip_.textContent=e,this.gridTooltip_.style.visibility=e?"visible":"hidden",this.gridTooltip_.style.display=e?"":"none"),pxt.BrowserUtils.addClass(o,"gridpicker-menuitem-highlight"),a.setAttribute("aria-activedescendant",o.id))}),d.browserEvents.bind(o,"pointerout",this,e=>{this.pointerOutTriggeredByUser()&&(this.gridItems.forEach(e=>e.classList.remove("gridpicker-option-focused")),r&&(this.gridTooltip_.style.visibility="hidden",this.gridTooltip_.style.display="none"),pxt.BrowserUtils.removeClass(o,"gridpicker-menuitem-highlight"),a.removeAttribute("aria-activedescendant"),this.activeDescendantIndex=void 0)})}else r?(this.selectedBar_.style.display="",d.browserEvents.conditionalBind(o,"click",this,e=>{if(this.closeModal_)this.buttonClick_(n);else{var t=a.getElementsByClassName("gridpicker-menuitem-highlight");for(let e=0;e<t.length;e++)pxt.BrowserUtils.removeClass(t[e],"gridpicker-menuitem-highlight");pxt.BrowserUtils.addClass(o,"gridpicker-menuitem-highlight"),this.updateSelectedBar_(i,n)}})):(d.browserEvents.conditionalBind(o,"click",this,()=>this.buttonClickAndClose_(n)),d.browserEvents.conditionalBind(o,"mouseup",this,()=>this.buttonClickAndClose_(n)));o.appendChild(u),this.gridItems.push(o),l.appendChild(o),0==s&&(this.firstItem_=o)}return l}doClassValidation_(e){return e}getFieldDescription(){return this.getValue()}close(){this.disposeTooltip(),this.disposeGrid(),d.WidgetDiv.hideIfOwner(this),d.Events.setGroup(!1),this.tabKeyBind&&d.browserEvents.unbind(this.tabKeyBind)}highlightFirstItem(e){var i=e.childNodes;if(i.length&&i[0].childNodes){for(let t=0;t<i.length;++t){var n=i[t].childNodes.length;for(let e=0;e<n;++e){var o=i[t].childNodes[e];pxt.BrowserUtils.removeClass(o,"gridpicker-menuitem-highlight"),pxt.BrowserUtils.removeClass(o,"gridpicker-option-selected")}}i[0].childNodes[0].className+=" gridpicker-menuitem-highlight"}}highlightAndScrollSelected(e,t){this.selectedItemDom&&d.utils.style.scrollIntoContainerView(this.selectedItemDom,t,!0)}showEditor_(e){this.setOpeningPointerCoords(e),d.WidgetDiv.show(this,this.sourceBlock_.RTL,()=>{this.onClose_()}),this.setupIntersectionObserver_(),this.createTooltip_();var t=document.createElement("div");this.positionMenu_(t),t.focus(),e||this.addKeyboardNavigableClass()}positionMenu_(t){var e,i=d.utils.svgMath.getViewportBBox(),n=this.getAnchorDimensions_(),{paddingContainer:o,scrollContainer:r}=this.createWidget_(t),o=(this.scrollContainer=r,{width:o.offsetWidth,height:o.offsetHeight}),s=window.outerHeight||window.innerHeight;this.width_&&(e=window.outerWidth||window.innerWidth,this.width_>e&&(this.width_=e),t.style.width=this.width_+"px");let a=0;if(this.hasSearchBar_&&(a+=50),this.selectedBar_&&(a+=50),this.maxRows_){let e=t.children[0].offsetHeight*(this.maxRows_+.3);s<e+a&&(e=s-a),o.height>e&&(r.style.overflowY="auto",r.style.height=e+"px",o.height=e)}o.height+=a,d.WidgetDiv.positionWithAnchor(i,n,o,this.sourceBlock_.RTL),this.highlightAndScrollSelected(t,r)}shouldShowTooltips(){return!pxt.BrowserUtils.isMobile()}getAnchorDimensions_(){var e=this.getScaledBBox();return this.sourceBlock_.RTL?e.right+=n.FieldBase.CHECKMARK_OVERHANG:e.left-=n.FieldBase.CHECKMARK_OVERHANG,e}createWidget_(e){var t,i,n=d.WidgetDiv.getDiv(),o=this.getOptions(),r=(e.setAttribute("role","grid"),e.setAttribute("tabindex","0"),this.addPointerListener(n),this.addKeyDownHandler(e),document.createElement("div")),s=document.createElement("div");s.style.border="solid 1px "+this.borderColour_,e.style.backgroundColor=this.backgroundColour_,r.style.backgroundColor=this.backgroundColour_,s.style.backgroundColor=this.backgroundColour_,e.className="blocklyGridPickerMenu",r.className="blocklyGridPickerScroller",s.className="blocklyGridPickerPadder",s.appendChild(r),r.appendChild(e),n.appendChild(s);let a;this.hasSearchBar_&&({searchBarDiv:t,searchBar:i}=this.createSearchBar_(e,r,o),s.insertBefore(t,s.childNodes[0]),a=i);let l;return this.shouldShowTooltips()||({selectedBar:t,cancelButton:i}=this.createSelectedBar_(),this.selectedBar_=t,l=i,s.appendChild(this.selectedBar_)),this.populateTableContainer(o,e,r),(this.hasSearchBar_||this.selectedBar_)&&(this.firstFocusableElement=a||e,this.lastFocusableElement=l||e,this.tabKeyBind=d.browserEvents.bind(n,"keydown",this,this.handleTabKey.bind(this))),{paddingContainer:s,scrollContainer:r}}createSearchBar_(n,o,r){var e=document.createElement("div"),t=(e.setAttribute("class","ui fluid icon input"),document.createElement("i"));t.setAttribute("class","search icon");let s=document.createElement("input");return s.setAttribute("type","search"),s.setAttribute("id","search-bar"),s.setAttribute("class","blocklyGridPickerSearchBar"),s.setAttribute("placeholder",pxt.Util.lf("Search")),s.setAttribute("tabindex","0"),s.addEventListener("click",()=>{s.focus(),s.setSelectionRange(0,s.value.length)}),s.addEventListener("keyup",pxt.Util.debounce(e=>{if("Tab"!==e.code){e=s.value;let i=new RegExp(e,"i");var t=r.filter(e=>{var t=e[0].alt,e=e[1];return t?i.test(t):i.test(e)});this.populateTableContainer(t,n,o),e?this.highlightFirstItem(n):this.highlightAndScrollSelected(n,o),this.gridTooltip_.style.visibility="hidden",this.gridTooltip_.style.display="none"}},300,!1)),s.addEventListener("keyup",e=>{13==e.which&&(e=n.childNodes[0])&&(e=e.childNodes[0])&&(this.closeModal_=!0,e.click())}),e.appendChild(s),e.appendChild(t),{searchBarDiv:e,searchBar:s}}createSelectedBar_(){var e=document.createElement("div"),t=(e.setAttribute("class","blocklyGridPickerSelectedBar"),e.style.display="none",document.createElement("div")),i=document.createElement("div"),i=(i.className="blocklyGridPickerSelectedImage",t.appendChild(i),this.selectedImg_=document.createElement("img"),this.selectedImg_.setAttribute("width","30px"),this.selectedImg_.setAttribute("height","30px"),this.selectedImg_.setAttribute("draggable","false"),this.selectedImg_.style.display="none",this.selectedImg_.src=h.DEFAULT_IMG,i.appendChild(this.selectedImg_),this.selectedBarText_=document.createElement("span"),this.selectedBarText_.className="blocklyGridPickerTooltip",t.appendChild(this.selectedBarText_),document.createElement("div")),n=document.createElement("div"),o=(n.className="ui buttons mini",i.appendChild(n),document.createElement("button")),r=(o.className="ui button icon green",document.createElement("i")),r=(r.className="icon check",o.appendChild(r),d.browserEvents.conditionalBind(o,"click",this,()=>{this.setValue(this.selectedBarValue_),this.close()}),document.createElement("button")),s=(r.className="ui button icon red",document.createElement("i"));return s.className="icon cancel",r.appendChild(s),d.browserEvents.conditionalBind(r,"click",this,()=>{this.close()}),n.appendChild(o),n.appendChild(r),e.appendChild(t),e.appendChild(i),{selectedBar:e,cancelButton:r}}updateSelectedBar_(e,t){e.src&&(this.selectedImg_.src=e.src,this.selectedImg_.style.display=""),this.selectedImg_.alt=e.alt||e,this.selectedBarText_.textContent=e.alt||e,this.selectedBarValue_=t}setupIntersectionObserver_(){if("IntersectionObserver"in window){this.disposeIntersectionObserver();let t=e=>{var t=e.getAttribute("data-src");t&&(e.src=t,e.removeAttribute("data-src"))};this.observer=new IntersectionObserver(e=>{e.forEach(e=>{0<e.intersectionRatio&&(this.observer.unobserve(e.target),t(e.target))})},{rootMargin:"20px 0px",threshold:.01})}}disposeIntersectionObserver(){this.observer&&(this.observer=null)}disposeTooltip(){this.gridTooltip_&&(pxsim.U.remove(this.gridTooltip_),this.gridTooltip_=null)}onClose_(){this.disposeTooltip(),this.disposeGrid()}handleTabKey(e){"Tab"===e.code&&(this.addKeyboardNavigableClass(),document.activeElement!==this.lastFocusableElement||e.shiftKey?document.activeElement===this.firstFocusableElement&&e.shiftKey&&(this.lastFocusableElement.focus(),e.preventDefault()):(this.firstFocusableElement.focus(),e.preventDefault()))}addKeyboardNavigableClass(){this.scrollContainer&&this.scrollContainer.classList.add("keyboardNavigable")}}(i.FieldGridPicker=h).DEFAULT_IMG="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",d.Css.register(`
.blocklyGridPickerTooltip {
    z-index: 995;
}

.blocklyGridPickerPadder {
    outline: none;
    box-shadow: 0px 0px 8px 1px rgba(0, 0, 0, .3)
}

.blocklyWidgetDiv .blocklyGridPickerRow {
    display: table-row;
}

.blocklyWidgetDiv .blocklyGridPickerMenu {
    display: table;
    outline: none;
    border-spacing: 7px;
}

.blocklyGridPickerScroller {
    outline: none;
    padding: 4px;
    border-radius: 4px;
    position: relative;
    -webkit-overflow-scrolling: touch;
}

.blocklyGridPickerScroller.keyboardNavigable:has(:focus-visible) {
    outline: 4px solid var(--pxt-focus-border);
}

.blocklyGridPickerPadder {
    border-radius: 4px;
    outline: none;
    position: relative;
}

.blocklyGridPickerPadder .ui.input i.search.icon {
    margin-top: -0.2rem;
}

.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-menuitem {
    background: white;
    cursor: pointer;
    min-width: unset;
}

.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-menuitem-highlight, .blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-menuitem-hover {
    background: #d6e9f8;
    box-shadow: 0px 0px 0px 4px rgba(255, 255, 255, 0.2);
}

.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-option {
    border: solid 1px black;
    border-radius: 4px;
    color: #fff;
    font-size: 12pt;
    font-weight: bold;
    display: table-cell;
    padding: 8px;
    text-align: center;
    vertical-align: top;
    -webkit-user-select: none;
    -moz-user-select: -moz-none;
    -ms-user-select: none;
        user-select: none;
}

.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-menuitem-content {
    color: #fff;
    font-size: 13px;
    font-family: var(--pxt-page-font);
}

.blocklyWidgetDiv .blocklyGridPickerMenu .floatLeft {
    float: left;
}

.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-option.gridpicker-option-selected {
    position: relative;
}

.blocklyWidgetDiv .blocklyGridPickerMenu .gridpicker-menuitem .gridpicker-menuitem-checkbox {
    display: none;
}

.blocklyWidgetDiv .blocklyGridPickerMenu:focus .blocklyGridPickerRow .gridpicker-menuitem.gridpicker-option-focused {
    outline: 3px solid var(--pxt-focus-border);
}

.blocklyGridPickerTooltip {
    z-index: 995;
}

.blocklyGridPickerSelectedBar {
    display: flex;
    padding-top: 5px;
    justify-content: space-between;
}

.blocklyGridPickerSelectedImage {
    padding: 3px;
    display: inline-block;
    vertical-align: middle;
}

.ui.input input.blocklyGridPickerSearchBar {
    background: none;
    border: none;
    color: white;
}

.ui.input input.blocklyGridPickerSearchBar::placeholder {
    color: white;
}

.ui.input input.blocklyGridPickerSearchBar::-webkit-input-placeholder {
    color: white;
}

.ui.input input.blocklyGridPickerSearchBar::-moz-placeholder {
    color: white;
}

.ui.input input.blocklyGridPickerSearchBar:-ms-input-placeholder {
    color: white;
}

.ui.input input.blocklyGridPickerSearchBar:-moz-placeholder {
    color: white;
}
`)},{"./field_base":31,"./field_dropdowngrid":35,"./field_utils":69,blockly:219}],37:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldImageDropdown=void 0;let m=e("blockly"),b=e("./field_utils");e=e("./field_dropdowngrid");class n extends e.FieldDropdownGrid{constructor(e,t,i){super(t.data),this.buttonClickAndClose_=e=>{e&&(this.setValue(e),m.DropDownDiv.hide())},this.columns_=parseInt(t.columns),this.maxRows_=parseInt(t.maxRows)||0,this.width_=parseInt(t.width)||300,this.backgroundColour_=(0,b.parseColour)(t.colour),this.borderColour_=pxt.toolbox.fadeColor(this.backgroundColour_,.4,!1)}setFocusedItem_(e){this.gridItems.forEach(e=>e.setAttribute("class","blocklyDropDownButton"));var t=this.gridItems[this.activeDescendantIndex],i=t.parentElement,t=(t.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonFocus"),i.getBoundingClientRect()),e=e.parentElement.getBoundingClientRect();t.bottom>e.bottom?i.scrollIntoView({block:"end"}):t.top<e.top&&i.scrollIntoView({block:"start"})}createRow(){var e=document.createElement("div");return e.setAttribute("role","row"),e}showEditor_(t){if(this.setOpeningPointerCoords(t),!m.DropDownDiv.hideIfOwner(this)){m.DropDownDiv.hideWithoutAnimation(),(0,b.clearDropDownDiv)();t=m.DropDownDiv.getContentDiv();let o=document.createElement("div");o.setAttribute("role","grid"),o.setAttribute("tabindex","0"),o.classList.add("blocklyMenu","blocklyDropdownMenu"),this.addPointerListener(t),this.addKeyDownHandler(o);var a=[];let n={height:0,width:0,items:[]};var e,l=this.getOptions(),c=this.columns_?this.width_/this.columns_-8:0;for(let i=0;i<l.length;i++){var u=l[i][0];let e=u.width,t=u.height;"placeholder"!=u.type&&this.columns_&&(e=c,t=c),n.height&&n.width+e+8>this.width_?(a.push(n),n={width:e+8,height:t+8,items:[l[i]]}):(n.width+=e+8,n.height=Math.max(n.height,t+8),n.items.push(l[i]))}a.push(n);let r,s=0;for(e of a){var d,h=this.createRow();h.style.width=e.width+"px",h.style.height=e.height+"px",o.appendChild(h);for(d of e.items){let i=s;var p=d[0];let n=d[1];if("placeholder"==p.type){var g=document.createElement("span");g.setAttribute("class","blocklyDropDownPlaceholder"),g.style.width=p.width+"px",g.style.height=e.height+"px",h.appendChild(g)}else{g=document.createElement("div");g.setAttribute("class","blocklyDropDownButtonContainer");let e=document.createElement("div"),t=(e.setAttribute("id",":"+i),e.setAttribute("role","gridcell"),e.setAttribute("aria-selected","false"),e.classList.add("blocklyDropDownButton"),e.title=p.alt,e.style.width=(c||p.width)+"px",e.style.height=(c||p.height)+"px",this.backgroundColour_);n==this.getValue()&&(t=this.sourceBlock_.getColourTertiary(),e.setAttribute("aria-selected","true"),this.activeDescendantIndex=i,o.setAttribute("aria-activedescendant",e.id),e.setAttribute("class","blocklyDropDownButton "+(this.openingPointerCoords?"blocklyDropDownButtonHover":"blocklyDropDownButtonFocus")),r=g),e.style.backgroundColor=t,e.style.borderColor=this.borderColour_,m.browserEvents.bind(e,"click",this,()=>this.buttonClickAndClose_(n)),m.browserEvents.bind(e,"pointermove",this,()=>{this.pointerMoveTriggeredByUser()&&(this.gridItems.forEach(e=>e.setAttribute("class","blocklyDropDownButton")),this.activeDescendantIndex=i,e.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonHover"),o.setAttribute("aria-activedescendant",e.id))}),m.browserEvents.bind(e,"pointerout",this,()=>{this.pointerOutTriggeredByUser()&&(e.setAttribute("class","blocklyDropDownButton"),o.removeAttribute("aria-activedescendant"),this.activeDescendantIndex=void 0)});var f=document.createElement("img");f.src=p.src,e.setAttribute("data-value",n),f.setAttribute("data-value",n),e.appendChild(f),this.gridItems.push(e),g.appendChild(e),h.append(g),s++}}}if(t.appendChild(o),this.maxRows_){var i=_(a);let e=_(a.slice(0,this.maxRows_));a.length>this.maxRows_&&(e+=.4*a[this.maxRows_].height),t.style.maxHeight=e+"px",t.style.height=i+"px"}pxt.BrowserUtils.isFirefox()&&(t.style.paddingRight="20px"),m.DropDownDiv.setColour(this.backgroundColour_,this.borderColour_),m.DropDownDiv.showPositionedByField(this,this.onHide_.bind(this)),o.focus(),r&&r.scrollIntoView({block:"end"});i=this.sourceBlock_;this.savedPrimary_=null==i?void 0:i.getColour(),null!=i&&i.isShadow()?i.setColour(i.getColourTertiary()):this.borderRect_&&this.borderRect_.setAttribute("fill",i.getColourTertiary())}}doValueUpdate_(e){this.selectedOption_=void 0,super.doValueUpdate_(e)}getFieldDescription(){return lf("image")}onHide_(){this.disposeGrid();var e=m.DropDownDiv.getContentDiv(),e=(e.removeAttribute("role"),e.removeAttribute("aria-activedescendant"),e.style.width="",e.style.paddingRight="",e.style.maxHeight="",this.sourceBlock_);null!=e&&e.isShadow()?this.sourceBlock_.setColour(this.savedPrimary_):this.borderRect_&&this.borderRect_.setAttribute("fill",this.savedPrimary_)}}function _(e){return e.reduce((e,t)=>e+t.height,0)}i.FieldImageDropdown=n,m.Css.register(`
.blocklyDropDownButtonContainer,
.blocklyDropDownButton {
    display: inline-block;
    float: left;
    border-radius: 4px;
    text-align: center;
    margin: 0;
}

.blocklyDropDownButtonContainer {
    padding: 4px;
}

.blocklyDropDownButton {
    border: 1px solid;
    transition: box-shadow .1s;
    cursor: pointer;
    outline: none;
}

.blocklyDropDownButtonHover {
    box-shadow: 0px 0px 0px 4px rgba(255, 255, 255, 0.2);
}

.blocklyDropDownButtonFocus {
    box-shadow: 0px 0px 0px 4px rgb(255, 255, 255);
}

.blocklyDropDownButton:active {
    box-shadow: 0px 0px 0px 6px rgba(255, 255, 255, 0.2);
}

.blocklyDropDownButton > img {
    width: 80%;
    height: 80%;
    position: relative;
    top: 50%;
    transform: translateY(-50%);
}
`)},{"./field_dropdowngrid":35,"./field_utils":69,blockly:219}],38:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldImageNoText=void 0;let n=e("blockly");class o extends n.FieldImage{constructor(e,t,i,n,o,r,s){super(e,t,i,n,o,r,s),this.isFieldCustom_=!0}getFieldDescription(){}showEditor_(){super.showEditor_(),this.getSourceBlock()instanceof n.BlockSvg&&n.getFocusManager().focusNode(this.getSourceBlock())}}i.FieldImageNoText=o},{blockly:219}],39:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldImages=void 0;let u=e("blockly");var n=e("./field_imagedropdown");let d=e("./field_utils");class o extends n.FieldImageDropdown{constructor(e,t,i){super(e,t,i),this.shouldSort_=t.sort,this.addLabel_=!!t.addLabel}showEditor_(e){if(this.setOpeningPointerCoords(e),!u.DropDownDiv.hideIfOwner(this)){var s=this.sourceBlock_,e=(u.DropDownDiv.hideWithoutAnimation(),(0,d.clearDropDownDiv)(),u.DropDownDiv.getContentDiv());let o=document.createElement("div");o.setAttribute("role","grid"),o.setAttribute("tabindex","0"),o.setAttribute("class","blocklyMenu blocklyImageMenu"),this.addPointerListener(e),this.addKeyDownHandler(o);var t=this.getOptions();this.shouldSort_&&t.sort();let r=this.createRow();for(let n=0;n<t.length;n++){var a=t[n][0];let i=t[n][1];if("placeholder"==a.type){var l=document.createElement("span");l.setAttribute("class","blocklyDropDownPlaceholder"),l.style.width=a.width+"px",l.style.height=a.height+"px",o.appendChild(l)}else{l=document.createElement("div");l.setAttribute("class","blocklyDropDownButtonContainer");let e=document.createElement("div"),t=(e.setAttribute("id",":"+n),e.setAttribute("role","gridcell"),e.setAttribute("aria-selected","false"),e.setAttribute("class","blocklyDropDownButton"),e.title=a.alt,this.columns_?e.style.width=this.width_/this.columns_-8+"px":(e.style.width=a.width+"px",e.style.height=a.height+"px"),s.getColour());i==this.getValue()&&(t=s.getColourTertiary(),e.setAttribute("aria-selected","true"),this.activeDescendantIndex=n,o.setAttribute("aria-activedescendant",e.id),e.setAttribute("class","blocklyDropDownButton "+(this.openingPointerCoords?"blocklyDropDownButtonHover":"blocklyDropDownButtonFocus"))),e.style.backgroundColor=t,e.style.borderColor=s.getColourTertiary(),u.browserEvents.bind(e,"click",this,()=>this.buttonClickAndClose_(i)),u.browserEvents.bind(e,"pointermove",this,()=>{this.pointerMoveTriggeredByUser()&&(this.gridItems.forEach(e=>e.setAttribute("class","blocklyDropDownButton")),this.activeDescendantIndex=n,e.setAttribute("class","blocklyDropDownButton blocklyDropDownButtonHover"),o.setAttribute("aria-activedescendant",e.id))}),u.browserEvents.bind(e,"pointerout",this,()=>{this.pointerOutTriggeredByUser()&&(e.setAttribute("class","blocklyDropDownButton"),o.removeAttribute("aria-activedescendant"),this.activeDescendantIndex=void 0)});var c=document.createElement("img");c.src=a.src,e.setAttribute("data-value",i),c.setAttribute("data-value",i),e.appendChild(c),this.addLabel_&&((c=this.createTextNode_(a.alt)).setAttribute("data-value",i),e.appendChild(c)),this.gridItems.push(e),l.appendChild(e),r.append(l),r.childElementCount===this.columns_&&(o.appendChild(r),r=this.createRow())}}r.childElementCount&&o.appendChild(r),o.style.width=this.width_+"px",e.appendChild(o),u.DropDownDiv.setColour(s.getColour(),s.getColourTertiary()),u.DropDownDiv.showPositionedByField(this,this.onHideCallback.bind(this)),o.focus(),this.savedPrimary_=null==s?void 0:s.getColour(),null!=s&&s.isShadow()?s.setColour(s.style.colourTertiary):this.borderRect_&&this.borderRect_.setAttribute("fill",s.style.colourTertiary)}}onHideCallback(){this.disposeGrid();var e=u.DropDownDiv.getContentDiv(),e=(e.removeAttribute("role"),e.removeAttribute("aria-activedescendant"),this.sourceBlock_);null!=e&&e.isShadow()?e.setColour(this.savedPrimary_):this.borderRect_&&this.borderRect_.setAttribute("fill",this.savedPrimary_)}createTextNode_(e){var t=document.createElement("span");return t.setAttribute("class","blocklyDropdownTextLabel"),t.textContent=e,t}}i.FieldImages=o,u.Css.register(`
.blocklyImageMenu .blocklyDropDownButton > img {
    top: unset;
    transform: unset;
    margin-top: 4px;
}
.blocklyImageMenu .blocklyDropdownTextLabel {
    line-height: 1.15;
    margin-top: 2px;
}
`)},{"./field_imagedropdown":37,"./field_utils":69,blockly:219}],40:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldKind=void 0;let c=e("blockly"),r=e("./field_utils"),n=e("../external");e=e("./field_dropdown");class s extends e.FieldDropdown{constructor(e){var i;super((i=e,function(){let t=[];var e=this.getSourceBlock();return null!=e&&e.workspace&&!e.isInFlyout?e.workspace.getVariableMap().getVariablesOfType(h(i.name)).forEach(e=>{t.push([e.getName(),e.getName()])}):i.initialMembers.forEach(e=>t.push([e,e])),t.push([lf("Add a new {0}...",i.memberName),"CREATE"]),t.push([void 0,"SEPARATOR"]),t.push([lf("Rename {0}...",i.memberName),"RENAME"]),t.push([lf("Delete {0}...",i.memberName),"DELETE"]),t})),this.opts=e}initView(){super.initView()}onItemSelected_(e,t){var i=t.getValue();if("CREATE"===i)a(this.sourceBlock_.workspace,this.opts,lf("New {0}:",this.opts.memberName),e=>e&&this.setValue(e));else if("RENAME"===i){let i=this.sourceBlock_.workspace;var o=i.getVariableMap().getVariable(this.value_,h(this.opts.name));let n=o.getName();-1!==this.opts.initialMembers.indexOf(n)?c.dialog.alert(lf("The built-in {0} '{1}' cannot be renamed. Try creating a new kind instead!",this.opts.memberName,n)):l(i,Object.assign(Object.assign({},this.opts),{toRename:o}),lf("Rename '{0}':",n),e=>{var t;for(t of(0,r.getAllFields)(i,e=>e instanceof s&&e.getValue()===n&&e.opts.name===this.opts.name))t.ref.setValue(e)})}else if("DELETE"===i){let n=this.sourceBlock_.workspace,o=n.getVariableMap().getVariable(this.value_,h(this.opts.name)),t=o.getName();if(-1!==this.opts.initialMembers.indexOf(t))c.dialog.alert(lf("The built-in {0} '{1}' cannot be deleted.",this.opts.memberName,t));else{let i=(0,r.getAllFields)(n,e=>e instanceof s&&e.getValue()===t&&e.opts.name===this.opts.name);1<i.length?c.dialog.confirm(lf('Delete {0} uses of the "{1}" {2}?',i.length,t,this.opts.memberName),e=>{if(e){c.Events.setGroup(!0);for(var t of i)t.block.dispose(!0);n.getVariableMap().deleteVariable(o),this.setValue(this.opts.initialMembers[0]),c.Events.setGroup(!1)}}):(n.getVariableMap().deleteVariable(o),this.setValue(this.opts.initialMembers[0]))}}else super.onItemSelected_(e,t)}doClassValidation_(t){var e;return null!=(e=this.opts)&&e.initialMembers&&!this.opts.initialMembers.find(e=>e==t)&&this.getOptions(),super.doClassValidation_(t)}getOptions(e){return this.initVariables(),super.getOptions(e)}initVariables(){if(this.sourceBlock_&&this.sourceBlock_.workspace){let t=this.sourceBlock_.workspace,i=d(t,this.opts.name);this.opts.initialMembers.forEach(e=>{-1===i.indexOf(e)&&o(t,this.opts,e)}),"CREATE"!==this.getValue()&&"RENAME"!==this.getValue()&&"DELETE"!==this.getValue()||this.opts.initialMembers.length&&this.setValue(this.opts.initialMembers[0])}}}function u(o,r,s,a,l){(0,n.prompt)(s,null,i=>{if(i){let t=!1;if(pxtc.isIdentifierStart(i.charCodeAt(0),2)){t=!0;for(let e=1;e<i.length;e++)pxtc.isIdentifierPart(i.charCodeAt(e),2)||(t=!1)}if(t)if(pxt.blocks.isReservedWord(i)||"CREATE"===i||"RENAME"===i||"DELETE"===i)c.dialog.alert(lf("'{0}' is a reserved word and cannot be used.",i),()=>u(o,r,s,a,l));else{var n=d(o,r.name);for(let e=0;e<n.length;e++)if(n[e]===i)return void c.dialog.alert(lf("A {0} named '{1}' already exists.",r.memberName,i),()=>u(o,r,s,a,l));i===r.createFunctionName&&c.dialog.alert(lf("'{0}' is a reserved name.",r.createFunctionName),()=>u(o,r,s,a,l)),a(i)}else c.dialog.alert(lf("Names must start with a letter and can only contain letters, numbers, '$', and '_'."),()=>u(o,r,s,a,l))}},{placeholder:r.promptHint})}function a(t,i,e,n){u(t,i,e,e=>{n(o(t,i,e))},a)}function l(t,i,e,n){u(t,i,e,e=>{t.getVariableMap().renameVariable(i.toRename,e),n(e)},l)}function d(e,t){e=e.getVariableMap().getVariablesOfType(h(t));return e&&e.length?e.map(e=>e.getName()):[]}function o(e,t,i){return c.Variables.getOrCreateVariablePackage(e,null,i,h(t.name)),i}function h(e){return"KIND_"+e}i.FieldKind=s},{"../external":25,"./field_dropdown":34,"./field_utils":69,blockly:219}],41:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldLedMatrix=void 0;let r=e("blockly");var s,n,e=e("./field_matrix");let a=/^.*[\.#].*$/;(n=s=s||{})[n.None=0]="None",n[n.Number=1]="Number",n[n.Letter=2]="Letter";class l extends e.FieldMatrix{constructor(e,t,i){super(e,i),this.isFieldCustom_=!0,this.SERIALIZABLE=!0,this.onColor="#FFFFFF",this.scale=1,this.numMatrixCols=5,this.numMatrixRows=5,this.yAxisLabel=s.None,this.xAxisLabel=s.None,this.cellState=[],this.clearSelectionOnBlur=!0,this.forceFocusVisible=!0,this.dontHandleMouseEvent_=e=>{e.stopPropagation(),e.preventDefault()},this.clearLedDragHandler=e=>{let t=this.sourceBlock_.getSvgRoot();pxsim.pointerEvents.down.forEach(e=>t.removeEventListener(e,this.dontHandleMouseEvent_)),t.removeEventListener(pxsim.pointerEvents.move,this.dontHandleMouseEvent_),document.removeEventListener(pxsim.pointerEvents.up,this.clearLedDragHandler),document.removeEventListener(pxsim.pointerEvents.leave,this.clearLedDragHandler),r.Touch.clearTouchIdentifier(),this.matrixSvg.removeEventListener(pxsim.pointerEvents.move,this.handleRootMouseMoveListener),e.stopPropagation(),e.preventDefault()},this.toggleCell=(e,t,i)=>{this.cellState[e][t]=null!=i?i:this.currentDragState_,this.updateValue()},this.handleRootMouseMoveListener=i=>{if(this.sourceBlock_.isEditable()){let e,t;t=(i.changedTouches&&1==i.changedTouches.length?(e=i.changedTouches[0].clientX,i.changedTouches[0]):(e=i.clientX,i)).clientY;var n,i=document.elementFromPoint(e,t);i&&(n=i.getAttribute("data-x"),i=i.getAttribute("data-y"),null!=n)&&null!=i&&this.toggleCell(parseInt(n),parseInt(i))}},this.params=t,void 0!==this.params.rows&&(e=parseInt(this.params.rows),isNaN(e)||(this.numMatrixRows=e)),void 0!==this.params.columns&&(i=parseInt(this.params.columns),isNaN(i)||(this.numMatrixCols=i)),void 0!==this.params.onColor&&(this.onColor=this.params.onColor),void 0!==this.params.offColor&&(this.offColor=this.params.offColor),void 0!==this.params.scale?this.scale=Math.max(.6,Math.min(2,Number(this.params.scale))):15<Math.max(this.numMatrixCols,this.numMatrixRows)?this.scale=.85:10<Math.max(this.numMatrixCols,this.numMatrixRows)&&(this.scale=.9),this.size_.height=this.scale*Number(this.numMatrixRows)*(l.CELL_WIDTH+l.CELL_VERTICAL_MARGIN)+2*l.CELL_VERTICAL_MARGIN+l.BOTTOM_MARGIN+this.getXAxisHeight(),this.size_.width=this.scale*Number(this.numMatrixCols)*(l.CELL_WIDTH+l.CELL_HORIZONTAL_MARGIN)+l.CELL_HORIZONTAL_MARGIN+this.getYAxisWidth()}getCellToggled(e,t){return this.cellState[e][t]}useTwoToneFocusIndicator(e,t){return this.getCellToggled(e,t)}showEditor_(){this.selected=[0,0];var e=this.matrixSvg.getBoundingClientRect();let t=r.WidgetDiv.getDiv();t.append(this.matrixSvg),this.addKeyboardFocusHandlers(),t.style.left=e.left+"px",t.style.top=e.top+"px",t.style.transform=`scale(${r.getMainWorkspace().getScale()})`,t.style.transformOrigin="0 0",r.WidgetDiv.show(this,this.sourceBlock_.RTL,()=>{this.removeKeyboardFocusHandlers(),this.clearCellSelection(),this.fieldGroup_.append(this.matrixSvg),t.style.left="",t.style.top="",t.style.transform="",t.style.transformOrigin=""}),this.matrixSvg.focus(),this.focusCell(0,0)}initMatrix(){if(!this.sourceBlock_.isInsertionMarker()){this.matrixSvg=pxsim.svg.parseString(`<svg xmlns="http://www.w3.org/2000/svg" id="field-matrix" class="blocklyMatrix" tabindex="-1" role="grid" width="${this.size_.width}" height="${this.size_.height}"/>`),this.matrixSvg.ariaLabel=lf("LED grid");var e=r.getMainWorkspace();this.matrixSvg.style.boxShadow=`rgba(255, 255, 255, 0.3) 0 0 0 ${4*e.getAbsoluteScale()}px`,this.matrixSvg.style.transition="box-shadow 0.25s",this.matrixSvg.style.borderRadius=4*e.getAbsoluteScale()+"px";for(let t=0;t<this.numMatrixCols;t++){this.cellState.push([]);for(let e=0;e<this.numMatrixRows;e++)this.cellState[t].push(!1)}if(this.restoreStateFromString(),this.createMatrixDisplay({cellWidth:l.CELL_WIDTH,cellHeight:l.CELL_WIDTH,cellLabel:lf("LED"),cellHorizontalMargin:l.CELL_HORIZONTAL_MARGIN,cellVerticalMargin:l.CELL_VERTICAL_MARGIN,cornerRadius:l.CELL_CORNER_RADIUS,cellFill:this.offColor,padLeft:this.getYAxisWidth(),scale:this.scale}),this.updateValue(),this.xAxisLabel!==s.None){var e=this.scale*this.numMatrixRows*(l.CELL_WIDTH+l.CELL_VERTICAL_MARGIN)+2*l.CELL_VERTICAL_MARGIN+l.BOTTOM_MARGIN,t=pxsim.svg.child(this.matrixSvg,"g",{transform:`translate(0 ${e})`});for(let e=0;e<this.numMatrixCols;e++){var i=this.getYAxisWidth()+this.scale*e*(l.CELL_WIDTH+l.CELL_HORIZONTAL_MARGIN)+l.CELL_WIDTH/2+l.CELL_HORIZONTAL_MARGIN/2;pxsim.svg.child(t,"text",{x:i,class:"blocklyText"}).textContent=this.getLabel(e,this.xAxisLabel)}}if(this.yAxisLabel!==s.None){var n=pxsim.svg.child(this.matrixSvg,"g",{});for(let e=0;e<this.numMatrixRows;e++){var o=this.scale*e*(l.CELL_WIDTH+l.CELL_VERTICAL_MARGIN)+l.CELL_WIDTH/2+2*l.CELL_VERTICAL_MARGIN;pxsim.svg.child(n,"text",{x:0,y:o,class:"blocklyText"}).textContent=this.getLabel(e,this.yAxisLabel)}}e=r.utils.dom.createSvgElement("rect",{x:0,y:0,fill:"none",width:this.size_.width,height:this.size_.height},null);this.matrixSvg.append(e),this.fieldGroup_.classList.add("blocklyFieldLedMatrixGroup"),this.fieldGroup_.append(this.matrixSvg),this.attachEventHandlersToMatrix()}}getLabel(e,t){return t!==s.Letter?(e+1).toString():String.fromCharCode(e+65)}updateEditable(){var e=this.fieldGroup_;this.EDITABLE&&e&&(this.sourceBlock_.isEditable()?this.fieldGroup_.setAttribute("cursor","pointer"):this.fieldGroup_.removeAttribute("cursor"),super.updateEditable())}attachPointerEventHandlersToCell(i,n,t){pxsim.pointerEvents.down.forEach(e=>t.addEventListener(e,e=>{if(this.sourceBlock_.isEditable()){let t=this.sourceBlock_.getSvgRoot();this.currentDragState_=!this.cellState[i][n],r.hideChaff(),r.common.setSelected(this.sourceBlock_),this.toggleCell(i,n),pxsim.pointerEvents.down.forEach(e=>t.addEventListener(e,this.dontHandleMouseEvent_)),t.addEventListener(pxsim.pointerEvents.move,this.dontHandleMouseEvent_),document.addEventListener(pxsim.pointerEvents.up,this.clearLedDragHandler),document.addEventListener(pxsim.pointerEvents.leave,this.clearLedDragHandler),this.matrixSvg.addEventListener(pxsim.pointerEvents.move,this.handleRootMouseMoveListener),e.stopPropagation(),e.preventDefault(),this.returnEphemeralFocus()}},!1))}getColor(e,t){return this.cellState[e][t]?this.onColor:this.offColor||l.DEFAULT_OFF_COLOR}getOpacity(e,t){var i=this.offColor?"1.0":"0.2";return this.cellState[e][t]?"1.0":i}updateCell(e,t){var i=this.cells[e][t];i.setAttribute("fill",this.getColor(e,t)),i.setAttribute("fill-opacity",this.getOpacity(e,t)),i.setAttribute("class","blocklyLed"+(this.cellState[e][t]?"On":"Off")),i.setAttribute("aria-checked",this.cellState[e][t].toString())}setValue(e,t=!0){var i=e!==this.value_;if(super.setValue(String(e),i),this.matrixSvg){t&&this.restoreStateFromString();for(let t=0;t<this.numMatrixCols;t++)for(let e=0;e<this.numMatrixRows;e++)this.updateCell(t,e)}}render_(){this.visible_?this.matrixSvg||this.initMatrix():this.markDirty()}getValue(){e=this.value_;var e,t=(t=(e=(e||"").trim()).charAt(0))!==e.charAt(e.length-1)||-1===o.indexOf(t)?e:e.substr(1,e.length-2).trim();return`\`
${l.TAB}${t}
${l.TAB}\``}getFieldDescription(){return lf("{0}x{1} LED Grid",this.numMatrixCols,this.numMatrixRows)}restoreStateFromString(){var n,e=this.value_;if(e){var o=e.split("\n").filter(e=>a.test(e));for(let i=0;i<o.length&&i<this.numMatrixRows;i++){let t=0;var r=o[i];for(let e=0;e<r.length&&t<this.numMatrixCols;e++)"."===(n=r[e])||"_"===n||"0"===n?(this.cellState[t][i]=!1,t++):"#"!==(n=r[e])&&"*"!==n&&"1"!==n||(this.cellState[t][i]=!0,t++)}}}updateValue(){let i="";for(let t=0;t<this.numMatrixRows;t++){for(let e=0;e<this.numMatrixCols;e++)i+=(this.cellState[e][t]?"#":".")+" ";i+="\n"+l.TAB}this.setValue(i,!1)}getYAxisWidth(){return this.yAxisLabel===s.None?0:l.Y_AXIS_WIDTH}getXAxisHeight(){return this.xAxisLabel===s.None?0:l.X_AXIS_HEIGHT}}(i.FieldLedMatrix=l).CELL_WIDTH=25,l.CELL_HORIZONTAL_MARGIN=7,l.CELL_VERTICAL_MARGIN=5,l.CELL_CORNER_RADIUS=5,l.BOTTOM_MARGIN=9,l.Y_AXIS_WIDTH=9,l.X_AXIS_HEIGHT=10,l.TAB="        ",l.DEFAULT_OFF_COLOR="#000000";let o=["'",'"',"`"];r.Css.register(`
.pxt-renderer.classic-theme .blocklyDraggable:not(.blocklyDisabled) .blocklyFieldLedMatrixGroup.blocklyEditableField:not(.blocklyEditing):hover>rect {
    stroke: none;
}
.pxt-renderer.classic-theme .blocklyDraggable:not(.blocklyDisabled) .blocklyFieldLedMatrixGroup.blocklyActiveFocus.blocklyEditableField:not(.blocklyEditing):hover>rect {
    stroke: var(--blockly-active-node-color);
    stroke-width: var(--blockly-selection-width);
}
.pxt-renderer.classic-theme .blocklyDraggable:not(.blocklyDisabled) .blocklyFieldLedMatrixGroup.blocklyPassiveFocus.blocklyEditableField:not(.blocklyEditing):hover>rect {
    stroke: var(--blockly-active-node-color);
    stroke-dasharray: 5px 3px;
    stroke-width: var(--blockly-selection-width);
}
.blocklyFieldLedMatrixGroup > .blocklyFieldRect {
    fill: none !important;
}`)},{"./field_matrix":42,blockly:219}],42:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldMatrix=void 0;let n=e("blockly");class o extends n.Field{constructor(){super(...arguments),this.cells=[],this.keyDownBinding=null,this.blurBinding=null,this.selected=void 0,this.forceFocusVisible=!1,this.returnEphemeralFocusFn=void 0,this.getCellId=(e,t)=>this.sourceBlock_.id+`:${e}-`+t}createMatrixDisplay({cellWidth:i,cellHeight:n,cellLabel:o,cellHorizontalMargin:r,cellVerticalMargin:s,cornerRadius:a=0,cellFill:l,cellStroke:c,padLeft:u=0,scale:d=1}){for(let e=0;e<this.numMatrixCols;e++)this.cells.push([]);for(let t=0;t<this.numMatrixRows;t++){var h=pxsim.svg.child(this.matrixSvg,"g",{role:"row"});for(let e=0;e<this.numMatrixCols;e++){var p=d*e*(i+r)+r+u,g=d*t*(n+s)+s,p=pxsim.svg.child(h,"g",{transform:`translate(${p} ${g})`,role:"gridcell"}),g={id:this.getCellId(e,t),"aria-label":o,role:"switch","aria-checked":"false",width:d*i,height:d*n,fill:null!=l?l:"none",stroke:c,"data-x":e,"data-y":t,rx:Math.max(2,d*a)},p=pxsim.svg.child(p,"rect",g);this.cells[e][t]=p}}}handleArrowUp(e,t){this.selected=[e,t-1]}handleArrowDown(e,t){this.selected=[e,t+1]}handleArrowLeft(e,t){0!==e?this.selected=[e-1,t]:0!==t&&(this.selected=[this.numMatrixCols-1,t-1])}handleArrowRight(e,t){e!==this.cells.length-1?this.selected=[e+1,t]:t!==this.numMatrixRows-1&&(this.selected=[0,t+1])}addKeyDownHandler(){this.keyDownBinding=n.browserEvents.bind(this.matrixSvg,"keydown",this,e=>{if(this.selected){var[t,i]=this.selected,n=pxt.BrowserUtils.isMac()?e.metaKey:e.ctrlKey;switch(e.code){case"ArrowUp":0!==i&&this.handleArrowUp(t,i);break;case"ArrowDown":i!==this.cells[0].length-1&&this.handleArrowDown(t,i);break;case"ArrowLeft":this.handleArrowLeft(t,i);break;case"ArrowRight":this.handleArrowRight(t,i);break;case"Home":this.selected=n?[0,0]:[0,i];break;case"End":this.selected=n?[this.numMatrixCols-1,this.numMatrixRows-1]:[this.numMatrixCols-1,i];break;case"Enter":case"Space":this.toggleCell(t,i,!this.getCellToggled(t,i));break;case"Escape":return this.sourceBlock_.workspace.markFocused(),void this.returnEphemeralFocus();default:return}var[o,r]=this.selected;this.focusCell(o,r),e.preventDefault(),e.stopPropagation()}})}addBlurHandler(){this.blurBinding=n.browserEvents.bind(this.matrixSvg,"blur",this,e=>{this.clearSelectionOnBlur?(this.removeKeyboardFocusHandlers(),this.clearCellSelection()):this.clearFocusIndicator()})}focusCell(e,t){this.setCellSelection(e,t),this.setFocusIndicator(this.cells[e][t],this.useTwoToneFocusIndicator(e,t))}setCellSelection(e,t){this.matrixSvg.setAttribute("aria-activedescendant",this.getCellId(e,t))}clearCellSelection(){this.selected&&(this.clearFocusIndicator(),this.selected=void 0),this.matrixSvg.removeAttribute("aria-activedescendant")}setFocusIndicator(e,t){var i,n;this.clearFocusIndicator(),(this.matrixSvg.matches(":focus-visible")||this.forceFocusVisible)&&(i=e.parentNode,n=parseInt(e.getAttribute("width")),e=parseInt(e.getAttribute("rx")),pxsim.svg.child(i,"rect",{transform:"translate(-2, -2)",width:n+4,height:n+4,rx:Math.max(2,e)+"px",stroke:"#fff","stroke-width":4,fill:"none"}),t)&&pxsim.svg.child(i,"rect",{transform:"translate(-1, -1)",width:n+2,height:n+2,rx:Math.max(2,e)+"px",stroke:"#000","stroke-width":2,fill:"none"})}clearFocusIndicator(){this.cells.forEach(e=>e.forEach(e=>{for(;e.nextElementSibling;)e.nextElementSibling.remove()}))}addKeyboardFocusHandlers(){this.sourceBlock_.isInFlyout||(this.addKeyDownHandler(),this.addBlurHandler())}attachEventHandlersToMatrix(){if(!this.sourceBlock_.isInFlyout)for(let t=0;t<this.numMatrixCols;++t)for(let e=0;e<this.numMatrixRows;++e)this.attachPointerEventHandlersToCell(t,e,this.cells[t][e])}returnEphemeralFocus(){var e;this.returnEphemeralFocusFn&&(e=this.returnEphemeralFocusFn,this.returnEphemeralFocusFn=void 0,e())}removeKeyboardFocusHandlers(){this.keyDownBinding&&(n.browserEvents.unbind(this.keyDownBinding),this.keyDownBinding=void 0),this.blurBinding&&(n.browserEvents.unbind(this.blurBinding),this.blurBinding=void 0)}}i.FieldMatrix=o,n.Css.register(`
    .blocklyMatrix:focus-visible {
        outline: none;
    }
`)},{blockly:219}],43:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.FieldCustomMelody=n.TOTAL_WIDTH=n.HEADER_HEIGHT=void 0;let i=e("blockly");var o=pxt.svgUtil;let r=e("./field_utils");e=e("./field_matrix");n.HEADER_HEIGHT=50,n.TOTAL_WIDTH=300;class s extends e.FieldMatrix{constructor(e,t,i){super(e,i),this.isFieldCustom_=!0,this.SERIALIZABLE=!0,this.soundingKeys=0,this.numMatrixRows=8,this.numMatrixCols=8,this.tempo=120,this.isPlaying=!1,this.timeouts=[],this.clearSelectionOnBlur=!1,this.matrixFocusBind=null,this.tabKeyBind=null,this.params=t,this.createMelodyIfDoesntExist()}init(){super.init(),this.onInit()}showEditor_(e){e=!e;i.DropDownDiv.hideWithoutAnimation(),(0,r.clearDropDownDiv)(),i.DropDownDiv.setColour(this.getDropdownBackgroundColour(),this.getDropdownBorderColour());let t=i.DropDownDiv.getContentDiv();pxt.BrowserUtils.addClass(t,"melody-content-div"),pxt.BrowserUtils.addClass(t.parentElement,"melody-editor-dropdown"),this.gallery=new pxtmelody.MelodyGallery,this.renderEditor(t),this.addKeyboardFocusHandlers(),this.attachEventHandlersToMatrix(),this.matrixFocusBind=i.browserEvents.bind(this.matrixSvg,"focus",this,this.handleMatrixFocus.bind(this)),this.tabKeyBind=i.browserEvents.bind(t,"keydown",this,this.handleTabKey.bind(this)),this.prevString=this.getValue(),(0,r.setMelodyEditorOpen)(this.sourceBlock_,!0),i.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_,()=>{this.onEditorClose(),pxt.BrowserUtils.removeClass(t,"melody-content-div"),pxt.BrowserUtils.removeClass(t.parentElement,"melody-editor-dropdown"),(0,r.setMelodyEditorOpen)(this.sourceBlock_,!1)}),e&&this.toggle.getRootElement().focus()}getValue(){return this.stringRep=this.getTypeScriptValue(),this.stringRep}doValueUpdate_(e){null==e||""==e||'""'==e||this.stringRep&&this.stringRep===e||(this.stringRep=e,this.parseTypeScriptValue(e),super.doValueUpdate_(this.getValue()))}getText_(){return this.invalidString?pxt.Util.lf("Invalid Input"):this.getValue()}getFieldDescription(){var e;return(null==(e=null==(e=this.melody.getStringRepresentation())?void 0:e.replace(/-/g,""))?void 0:e.trim())||lf("empty")}onInit(){this.render_(),this.createMelodyIfDoesntExist(),this.invalidString||(this.fieldGroup_||(this.fieldGroup_=i.utils.dom.createSvgElement("g",{},null)),this.visible_||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.updateFieldLabel())}render_(){super.render_(),this.invalidString||(this.size_.width=s.MUSIC_ICON_WIDTH+(s.COLOR_BLOCK_WIDTH+s.COLOR_BLOCK_SPACING)*this.numMatrixCols),this.size_.height=34,this.sourceBlock_.setColour("#ffffff")}renderEditor(e){var t=this.getDropdownBackgroundColour(),i=this.getDropdownBorderColour();this.topDiv=document.createElement("div"),pxt.BrowserUtils.addClass(this.topDiv,"melody-top-bar-div"),this.root=new o.SVG(this.topDiv).id("melody-editor-header-controls"),this.toggle=new l(this.root,{leftText:lf("Editor"),rightText:lf("Gallery"),baseColor:t}),this.toggle.onStateChange(e=>{e?this.hideGallery():this.showGallery()}),this.firstFocusableElement=this.toggle.getRootElement(),this.toggle.layout(),this.toggle.translate((n.TOTAL_WIDTH-this.toggle.width())/2,a),e.appendChild(this.topDiv),e.appendChild(this.gallery.getElement()),this.editorDiv=document.createElement("div"),pxt.BrowserUtils.addClass(this.editorDiv,"melody-editor-div"),this.editorDiv.style.setProperty("background-color",i),this.gridDiv=this.createGridDisplay(),this.editorDiv.appendChild(this.gridDiv),this.bottomDiv=document.createElement("div"),pxt.BrowserUtils.addClass(this.bottomDiv,"melody-bottom-bar-div"),this.doneButton=document.createElement("button"),pxt.BrowserUtils.addClass(this.doneButton,"melody-confirm-button"),this.doneButton.innerText=lf("Done"),this.doneButton.addEventListener("click",()=>this.onDone()),this.doneButton.style.setProperty("background-color",t),this.lastFocusableElement=this.doneButton,this.playButton=document.createElement("button"),this.playButton.id="melody-play-button",this.playButton.addEventListener("click",()=>this.togglePlay()),this.playIcon=document.createElement("i"),this.playIcon.id="melody-play-icon",pxt.BrowserUtils.addClass(this.playIcon,"play icon"),this.playButton.appendChild(this.playIcon),this.tempoInput=document.createElement("input"),pxt.BrowserUtils.addClass(this.tempoInput,"ui input"),this.tempoInput.type="number",this.tempoInput.title=lf("tempo"),this.tempoInput.id="melody-tempo-input",this.tempoInput.addEventListener("input",()=>this.setTempo(+this.tempoInput.value)),this.syncTempoField(!0),this.bottomDiv.appendChild(this.tempoInput),this.bottomDiv.appendChild(this.playButton),this.bottomDiv.appendChild(this.doneButton),this.editorDiv.appendChild(this.bottomDiv),e.appendChild(this.editorDiv)}onEditorClose(){this.stopMelody(),this.gallery&&this.gallery.stopMelody(),this.matrixFocusBind&&(i.browserEvents.unbind(this.matrixFocusBind),this.matrixFocusBind=void 0),this.tabKeyBind&&(i.browserEvents.unbind(this.tabKeyBind),this.tabKeyBind=void 0),this.clearCellSelection(),this.removeKeyboardFocusHandlers(),this.clearDomReferences(),this.sourceBlock_&&i.Events.isEnabled()&&this.getValue()!==this.prevString&&i.Events.fire(new i.Events.BlockChange(this.sourceBlock_,"field",this.name,this.prevString,this.getValue())),this.prevString=void 0}onDone(){i.DropDownDiv.hideIfOwner(this)}clearDomReferences(){this.topDiv=null,this.editorDiv=null,this.gridDiv=null,this.bottomDiv=null,this.doneButton=null,this.playButton=null,this.playIcon=null,this.tempoInput=null,this.matrixSvg=null,this.cells=[],this.toggle=null,this.root=null,this.firstFocusableElement=null,this.lastFocusableElement=null,this.gallery.clearDomReferences()}getTypeScriptValue(){return this.invalidString||(this.melody?'"'+this.melody.getStringRepresentation()+'"':"")}parseTypeScriptValue(e){var t=e;try{e=(e=e.slice(1,-1)).trim(),this.createMelodyIfDoesntExist();var i,n=e.split(" ");n.forEach(e=>{if(!this.isValidNote(e))throw new Error(lf("Invalid note '{0}'. Notes can be C D E F G A B C5",e))}),this.melody.resetMelody();for(let e=0;e<n.length;e++)"-"!=n[e]&&(i=pxtmelody.noteToRow(n[e]),this.melody.updateMelody(i,e));this.updateFieldLabel()}catch(e){pxt.log(e),this.invalidString=t}}isValidNote(e){switch(e){case"C":case"D":case"E":case"F":case"G":case"A":case"B":case"C5":case"-":return!0}return!1}getPreviewWidth(){return this.updateSize_(),this.size_.width}getPreviewHeight(){var e;return(null==(e=this.getConstants())?void 0:e.FIELD_BORDER_RECT_HEIGHT)||16}getDropdownBackgroundColour(){var e=this.sourceBlock_.getParent();return e?e.getColour():"#3D3D3D"}getDropdownBorderColour(){var e=this.sourceBlock_.getParent();return e?e.getColourTertiary():"#2A2A2A"}updateFieldLabel(){if(this.fieldGroup_){pxsim.U.clear(this.fieldGroup_);var e=c("ï€").appendClass("melody-editor-field-icon").at(6,15),t=(this.fieldGroup_.appendChild(e.el),this.melody.getStringRepresentation().trim().split(" "));for(let e=0;e<t.length;e++){var i=pxtmelody.getColorClass(pxtmelody.noteToRow(t[e])),n=(new o.Rect).at((s.COLOR_BLOCK_WIDTH+s.COLOR_BLOCK_SPACING)*e+s.COLOR_BLOCK_X,s.COLOR_BLOCK_Y).size(s.COLOR_BLOCK_WIDTH,s.COLOR_BLOCK_HEIGHT).stroke("#898989",1).fill((e=>{switch(e){case 0:return"#A80000";case 1:return"#D83B01";case 2:return"#FFB900";case 3:return"#107C10";case 4:return"#008272";case 5:return"#0078D7";case 6:return"#5C2D91";case 7:return"#B4009E"}return"#DCDCDC"})(pxtmelody.noteToRow(t[e]))).corners(3,2);pxt.BrowserUtils.addClass(n.el,i),this.fieldGroup_.appendChild(n.el)}}}setTempo(e){(isNaN(e)||e<=0)&&this.tempoInput?this.tempoInput.value=this.tempo+"":this.tempo!=e&&(this.tempo=e,this.melody&&this.melody.setTempo(this.tempo),this.tempoInput&&(this.tempoInput.value=this.tempo+""),this.syncTempoField(!1))}syncTempoField(e){var t=this.sourceBlock_.getParent();if(t)for(var i of t.inputList)if("tempo"===i.name||"bpm"===i.name){i=i.connection.targetBlock();i&&(e?i.getFieldValue("SLIDER")?(this.tempoInput.value=i.getFieldValue("SLIDER"),this.tempo=+this.tempoInput.value):this.tempoInput.value=this.tempo+"":("math_number_minmax"===i.type?i.setFieldValue(this.tempoInput.value,"SLIDER"):i.setFieldValue(this.tempoInput.value,"NUM"),this.tempoInput.focus()));break}}getDuration(){return 6e4/this.tempo}createMelodyIfDoesntExist(){return!this.melody&&(this.melody=new pxtmelody.MelodyArray,!0)}toggleCell(e,t){this.invalidString=null,this.melody.updateMelody(t,e),this.melody.getValue(t,e)&&!this.isPlaying&&this.playNote(t,e),this.updateGrid(),this.updateFieldLabel()}getCellToggled(e,t){return this.melody.getValue(t,e)}useTwoToneFocusIndicator(e,t){return!0}updateGrid(){for(let t=0;t<this.numMatrixRows;t++){var i=pxtmelody.getColorClass(t);for(let e=0;e<this.numMatrixCols;e++){var n=this.cells[e][t];this.melody.getValue(t,e)?(pxt.BrowserUtils.removeClass(n,"melody-default"),pxt.BrowserUtils.addClass(n,i)):(pxt.BrowserUtils.addClass(n,"melody-default"),pxt.BrowserUtils.removeClass(n,i))}}}playNote(e,t){let i=++this.soundingKeys;this.isPlaying?(this.timeouts.push(setTimeout(()=>{this.playToneCore(e)},t*this.getDuration())),this.timeouts.push(setTimeout(()=>{pxt.AudioContextManager.stop()},(t+1)*this.getDuration()))):(this.playToneCore(e),this.timeouts.push(setTimeout(()=>{this.soundingKeys==i&&pxt.AudioContextManager.stop()},this.getDuration())))}queueToneForColumn(t,e,i){let n=setTimeout(()=>{++this.soundingKeys,pxt.AudioContextManager.stop();for(let e=0;e<this.numMatrixRows;e++)this.melody.getValue(e,t)&&this.playToneCore(e);this.highlightColumn(t,!0),this.timeouts=this.timeouts.filter(e=>e!==n)},e),o=setTimeout(()=>{this.timeouts=this.timeouts.filter(e=>e!==o),this.highlightColumn(t,!1)},e+i);this.timeouts.push(n),this.timeouts.push(o)}playToneCore(e){let t=0;switch(e){case 0:t=523;break;case 1:t=494;break;case 2:t=440;break;case 3:t=392;break;case 4:t=349;break;case 5:t=330;break;case 6:t=294;break;case 7:t=262}pxt.AudioContextManager.tone(t)}highlightColumn(e,t){this.cells[e].forEach(e=>{t?pxt.BrowserUtils.addClass(e,"playing"):pxt.BrowserUtils.removeClass(e,"playing")})}createGridDisplay(){return s.VIEWBOX_WIDTH=(s.CELL_WIDTH+s.CELL_HORIZONTAL_MARGIN)*this.numMatrixCols+s.CELL_HORIZONTAL_MARGIN,pxt.BrowserUtils.isEdge()&&(s.VIEWBOX_WIDTH+=37),s.VIEWBOX_HEIGHT=(s.CELL_WIDTH+s.CELL_VERTICAL_MARGIN)*this.numMatrixRows+s.CELL_VERTICAL_MARGIN,this.matrixSvg=pxsim.svg.parseString(`<svg xmlns="http://www.w3.org/2000/svg" class="melody-grid-div blocklyMatrix" role="grid" viewBox="0 0 ${s.VIEWBOX_WIDTH} ${s.VIEWBOX_HEIGHT}" tabindex="0" />`),this.matrixSvg.ariaLabel=lf("Melody grid"),this.createMatrixDisplay({cellWidth:s.CELL_WIDTH,cellHeight:s.CELL_WIDTH,cellLabel:lf("Note"),cellStroke:"white",cellHorizontalMargin:s.CELL_HORIZONTAL_MARGIN,cellVerticalMargin:s.CELL_VERTICAL_MARGIN,cornerRadius:s.CELL_CORNER_RADIUS}),this.updateGrid(),this.matrixSvg}handleMatrixFocus(e){this.selected||(t=null!=(t=this.getMelodyNote(0))?t:0,this.selected=[0,t]);var[t,i]=this.selected;this.focusCell(t,i)}handleTabKey(e){"Tab"===e.code&&(document.activeElement!==this.lastFocusableElement||e.shiftKey?document.activeElement===this.firstFocusableElement&&e.shiftKey&&(this.lastFocusableElement.focus(),e.preventDefault()):(this.firstFocusableElement.focus(),e.preventDefault()))}attachPointerEventHandlersToCell(t,i,n){pxsim.pointerEvents.down.forEach(e=>n.addEventListener(e,e=>{this.toggleCell(t,i),this.clearFocusIndicator(),e.stopPropagation(),e.preventDefault()},!1))}handleArrowUp(e,t){var i=void 0!==this.getMelodyNote(e);this.selected=[e,t-1],i&&this.toggleCell(this.selected[0],this.selected[1])}handleArrowDown(e,t){var i=void 0!==this.getMelodyNote(e);this.selected=[e,t+1],i&&this.toggleCell(this.selected[0],this.selected[1])}handleArrowLeft(e,t){var e=(e+this.numMatrixCols-1)%this.numMatrixCols,i=null!=(i=this.getMelodyNote(e))?i:t;this.selected=[e,i]}handleArrowRight(e,t){var e=(e+this.numMatrixCols+1)%this.numMatrixCols,i=null!=(i=this.getMelodyNote(e))?i:t;this.selected=[e,i]}getMelodyNote(t){for(let e=0;e<this.numMatrixRows;++e)if(this.melody.getValue(e,t))return e}togglePlay(){this.isPlaying?this.stopMelody():(this.isPlaying=!0,this.playMelody()),this.updatePlayButton()}updatePlayButton(){this.isPlaying?(pxt.BrowserUtils.removeClass(this.playIcon,"play icon"),pxt.BrowserUtils.addClass(this.playIcon,"stop icon")):(pxt.BrowserUtils.removeClass(this.playIcon,"stop icon"),pxt.BrowserUtils.addClass(this.playIcon,"play icon"))}playMelody(){if(this.isPlaying){for(let e=0;e<this.numMatrixCols;e++)this.queueToneForColumn(e,e*this.getDuration(),this.getDuration());this.timeouts.push(setTimeout(()=>this.playMelody(),this.numMatrixCols*this.getDuration()))}else this.stopMelody()}stopMelody(){if(this.isPlaying){for(;this.timeouts.length;)clearTimeout(this.timeouts.shift());pxt.AudioContextManager.stop(),this.isPlaying=!1,this.cells.forEach(e=>e.forEach(e=>pxt.BrowserUtils.removeClass(e,"playing")))}}showGallery(){this.stopMelody(),this.updatePlayButton(),this.gallery.show(e=>{e&&(this.melody.parseNotes(e),this.toggle.toggle(),this.toggle.getRootElement().focus(),this.updateFieldLabel(),this.updateGrid())}),this.lastFocusableElement=this.gallery.getLastFocusableElement()}hideGallery(){this.gallery.hide(),this.lastFocusableElement=this.doneButton}isFullBlockField(){return!0}}(n.FieldCustomMelody=s).CELL_WIDTH=25,s.CELL_HORIZONTAL_MARGIN=5,s.CELL_VERTICAL_MARGIN=7,s.CELL_CORNER_RADIUS=5,s.COLOR_BLOCK_WIDTH=10,s.COLOR_BLOCK_HEIGHT=20,s.COLOR_BLOCK_X=20,s.COLOR_BLOCK_Y=5,s.COLOR_BLOCK_SPACING=2,s.MUSIC_ICON_WIDTH=20;let a=6;class l{constructor(e,t){this.props=(e=>(e.baseColor||(e.baseColor="#e95153"),e.backgroundColor||(e.backgroundColor="rgba(52,73,94,.2)"),e.borderColor||(e.borderColor="rgba(52,73,94,.4)"),e.selectedTextColor||(e.selectedTextColor=e.baseColor),e.unselectedTextColor||(e.unselectedTextColor="hsla(0,0%,100%,.9)"),e.switchColor||(e.switchColor="#ffffff"),e))(t),this.root=e.group(),this.buildDom(),this.isLeft=!0}buildDom(){this.root.style().content(`
        .toggle-left {
            transform: translateX(0px);
            animation: mvleft 0.2s 0s ease;
        }

        .toggle-right {
            transform: translateX(100px);
            animation: mvright 0.2s 0s ease;
        }

        @keyframes mvright {
            0% {
                transform: translateX(0px);
            }
            100% {
                transform: translateX(100px);
            }
        }

        @keyframes mvleft {
            0% {
                transform: translateX(100px);
            }
            100% {
                transform: translateX(0px);
            }
        }
        `),this.root.def().create("clipPath","sprite-editor-toggle-border").clipPathUnits(!0).draw("rect").at(0,0).corners(.02,.1).size(1,1),this.root.draw("rect").size(200,40).fill(this.props.baseColor).stroke(this.props.borderColor,4).corners(4,4).clipPath("url(#sprite-editor-toggle-border)"),this.root.draw("rect").at(2,2).size(196,36).fill(this.props.backgroundColor).corners(4,4),this.switch=this.root.draw("rect").at(2,2).size(98,36).fill(this.props.switchColor).corners(4,4),this.leftElement=this.root.group(),this.leftText=c(this.props.leftText).appendClass("sprite-editor-text").fill(this.props.selectedTextColor),this.leftElement.appendChild(this.leftText),this.rightElement=this.root.group(),this.rightText=c(this.props.rightText).appendClass("sprite-editor-text").fill(this.props.unselectedTextColor),this.rightElement.appendChild(this.rightText),this.root.onClick(()=>this.toggle()),this.root.el.tabIndex=0,this.root.el.classList.add("melody-editor-toggle-buttons"),this.root.el.addEventListener("keydown",e=>{["Space","ArrowLeft","ArrowRight","Enter"].includes(e.code)&&(this.toggle(),e.preventDefault())})}toggle(e=!1){this.isLeft?(this.switch.removeClass("toggle-left"),this.switch.appendClass("toggle-right"),this.leftText.fill(this.props.unselectedTextColor),this.rightText.fill(this.props.selectedTextColor)):(this.switch.removeClass("toggle-right"),this.switch.appendClass("toggle-left"),this.leftText.fill(this.props.selectedTextColor),this.rightText.fill(this.props.unselectedTextColor)),this.isLeft=!this.isLeft,!e&&this.changeHandler&&this.changeHandler(this.isLeft)}onStateChange(e){this.changeHandler=e}layout(){this.leftText.moveTo(51,20),this.rightText.moveTo(149,20)}translate(e,t){this.root.translate(e,t)}height(){return 40}width(){return 200}getRootElement(){return this.root.el}}function c(e){return new o.Text(e).anchor("middle").setAttribute("dominant-baseline","middle").setAttribute("dy",pxt.BrowserUtils.isIE()||pxt.BrowserUtils.isEdge()?"0.3em":"0.1em")}},{"./field_matrix":42,"./field_utils":69,blockly:219}],44:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldMusicEditor=void 0;var n=pxt.svgUtil,o=e("./field_asset");let r=e("./field_utils");class s extends o.FieldAssetEditor{getAssetType(){return"song"}createNewAsset(e){var t=pxt.react.getTilemapProject();if(e){var i=pxt.lookupProjectAssetByTSReference(e,t);if(i)return i}if(this.getBlockData())return t.lookupAsset("song",this.getBlockData());let n;if(e?(i=/^\s*hex\s*`([a-fA-F0-9]+)`\s*(?:;?)\s*$/.exec(e))&&(n=pxt.assets.music.decodeSongFromHex(i[1])):n=pxt.assets.music.getEmptySong(2),n)return pxt.assets.music.inflateSong(n),{internalID:-1,id:this.temporaryAssetId(),type:"song",meta:{},song:n};this.isGreyBlock=!0,this.valueText=e}render_(){super.render_(),this.isGreyBlock||(this.size_.height=42,this.size_.width=18+this.previewWidth())}getValueText(){return this.asset&&!this.isTemporaryAsset()?pxt.getTSReferenceForAsset(this.asset):this.asset?`hex\`${pxt.assets.music.encodeSongToHex(this.asset.song)}\``:this.valueText||""}parseFieldOptions(e){return{}}redrawPreview(){var e,t;this.fieldGroup_&&(pxsim.U.clear(this.fieldGroup_),this.isGreyBlock?super.redrawPreview():(e=18+this.previewWidth(),t=(new n.Rect).at(5,1).size(8+this.previewWidth(),40).setClass("blocklySpriteField").stroke("#898989",1).corner(4),this.fieldGroup_.appendChild(t.el),this.asset&&(t=(0,r.songToDataURI)(this.asset.song,this.previewWidth(),32,this.lightMode))&&(t=(new n.Image).src(t).at(9,5).size(this.previewWidth(),32),this.fieldGroup_.appendChild(t.el)),(null==(t=this.size_)?void 0:t.width)!=e&&this.forceRerender()))}previewWidth(){return 32*(this.asset?this.asset.song.measures:2)}}i.FieldMusicEditor=s},{"./field_asset":29,"./field_utils":69}],45:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldNote=void 0;let u=e("blockly"),d=e("./field_utils");var n;(e=n=n||{})[e.C=262]="C",e[e.CSharp=277]="CSharp",e[e.D=294]="D",e[e.Eb=311]="Eb",e[e.E=330]="E",e[e.F=349]="F",e[e.FSharp=370]="FSharp",e[e.G=392]="G",e[e.GSharp=415]="GSharp",e[e.A=440]="A",e[e.Bb=466]="Bb",e[e.B=494]="B",e[e.C3=131]="C3",e[e.CSharp3=139]="CSharp3",e[e.D3=147]="D3",e[e.Eb3=156]="Eb3",e[e.E3=165]="E3",e[e.F3=175]="F3",e[e.FSharp3=185]="FSharp3",e[e.G3=196]="G3",e[e.GSharp3=208]="GSharp3",e[e.A3=220]="A3",e[e.Bb3=233]="Bb3",e[e.B3=247]="B3",e[e.C4=262]="C4",e[e.CSharp4=277]="CSharp4",e[e.D4=294]="D4",e[e.Eb4=311]="Eb4",e[e.E4=330]="E4",e[e.F4=349]="F4",e[e.FSharp4=370]="FSharp4",e[e.G4=392]="G4",e[e.GSharp4=415]="GSharp4",e[e.A4=440]="A4",e[e.Bb4=466]="Bb4",e[e.B4=494]="B4",e[e.C5=523]="C5",e[e.CSharp5=555]="CSharp5",e[e.D5=587]="D5",e[e.Eb5=622]="Eb5",e[e.E5=659]="E5",e[e.F5=698]="F5",e[e.FSharp5=740]="FSharp5",e[e.G5=784]="G5",e[e.GSharp5=831]="GSharp5",e[e.A5=880]="A5",e[e.Bb5=932]="Bb5",e[e.B5=988]="B5",e[e.C6=1047]="C6",e[e.CSharp6=1109]="CSharp6",e[e.D6=1175]="D6",e[e.Eb6=1245]="Eb6",e[e.E6=1319]="E6",e[e.F6=1397]="F6",e[e.FSharp6=1480]="FSharp6",e[e.G6=1568]="G6",e[e.GSharp6=1568]="GSharp6",e[e.A6=1760]="A6",e[e.Bb6=1865]="Bb6",e[e.B6=1976]="B6",e[e.C7=2093]="C7";class h extends u.FieldNumber{constructor(e,t,i){super(null,0,null,null,i),this.isFieldCustom_=!0,this.SERIALIZABLE=!0,this.isTextValid_=!0,this.nKeys_=36,this.minNote_=28,this.maxNote_=63,this.eps=2,this.keyHandler=e=>{var t,i="string"==typeof this.value_?parseFloat(this.value_):this.value_;"ArrowUp"!==e.code&&"ArrowDown"!==e.code||({keyAbove:i,keyBelow:t}=this.getNeighboringKeys(i),i="ArrowUp"===e.code?i:t,t=this.getKeyFreq(i),this.setValue(t),this.playKey(this.piano[i-this.minNote_],t),this.noteLabel.textContent=this.getKeyName(i),e.stopPropagation(),e.preventDefault())},this.setSpellcheck(!1),this.prepareNotes(),this.isExpanded=!1,this.currentPage=0,this.totalPlayCount=0,t.editorColour&&(this.primaryColour=(0,d.parseColour)(t.editorColour),this.borderColour=u.utils.colour.blend("#000000",this.primaryColour,.2));i=parseInt(t.eps),!Number.isNaN(i)&&0<=i&&(this.eps=i),i=parseInt(t.minNote)||this.minNote_,t=parseInt(t.maxNote)||this.maxNote_;28<=i&&t<=75&&i<t&&(this.minNote_=i,this.maxNote_=t,this.nKeys_=this.maxNote_-this.minNote_+1),this.setValue(e)}doClassValidation_(e){var t=/^Note\.(.+)$/.exec(e),t=t&&1<t.length?t[1]:null;return null===(e=n[t]||String(parseFloat(e||"0")))||(t=parseFloat(e||"0"),isNaN(t))||t<0?null:(e=Math.floor(t)!=t,Number(t.toFixed(e?2:0)))}getValue(){return this.value_+""}doValueUpdate_(e){isNaN(Number(e))||Number(e)<0||(this.sourceBlock_&&u.Events.isEnabled()&&this.value_!=e&&u.Events.fire(new u.Events.BlockChange(this.sourceBlock_,"field",this.name,this.value_,e)),this.value_=e,this.refreshText())}getText(){return this.isExpanded?""+this.value_:this.getNoteString()}getFieldDescription(){return this.getNoteString()||lf("note")}getNoteString(){var t=+this.value_;for(let e=0;e<this.nKeys_;e++)if(Math.abs(this.getKeyFreq(e+this.minNote_)-t)<this.eps)return this.getKeyName(e+this.minNote_);let e=t.toString();return isNaN(t)||(e+=" Hz"),e}refreshText(){this.forceRerender()}onFinishEditing_(e){this.refreshText()}onHide(){this.isExpanded=!1,this.refreshText()}widgetDispose_(){this.htmlInput_.removeEventListener("keydown",this.keyHandler),super.widgetDispose_()}showEditor_(e){this.isExpanded=!0,this.updateColor(),u.DropDownDiv.hideWithoutAnimation(),(0,d.clearDropDownDiv)();var t=pxt.BrowserUtils.isMobile()||pxt.BrowserUtils.isIOS(),e=(super.showEditor_(e,t),this.refreshText(),u.Events.setGroup(!0),this.piano=[],this.currentSelectedKey=void 0,this.nKeys_-this.nKeys_/h.notesPerOctave*h.blackKeysPerOctave),i=h.notesPerOctave-h.blackKeysPerOctave;let n=h.keyWidth*e,o=h.keyHeight+h.labelHeight;var r=window.innerWidth<n,s=(r&&(n=i*h.keyWidth,o=h.keyHeight+h.labelHeight+h.prevNextHeight),p("blocklyPianoDiv",`width: ${n}px;
            height: ${o}px;`));u.DropDownDiv.getContentDiv().appendChild(s),this.noteLabel=p("blocklyNoteLabel",`top: ${h.keyHeight}px;
            width: ${n}px;
            background-color: ${this.primaryColour};
            border-color: ${this.primaryColour};`),s.appendChild(this.noteLabel),this.noteLabel.textContent="-";let a=0;for(let t=0;t<this.nKeys_;t++){var l=Math.floor(t/h.notesPerOctave);let e=this.getPosition(t+this.minNote_);r&&t>=h.notesPerOctave&&(e-=i*l*h.keyWidth);var c=this.getKeyDiv(t+this.minNote_,e);this.piano.push(c),s.appendChild(c),Math.abs(this.getKeyFreq(t+this.minNote_)-Number(this.getValue()))<this.eps&&(pxt.BrowserUtils.addClass(c,"selected"),this.currentSelectedKey=c,a=l)}r&&(this.setPage(a),s.appendChild(this.getNextPrevDiv(!0,n)),s.appendChild(this.getNextPrevDiv(!1,n))),u.DropDownDiv.setColour(this.primaryColour,this.borderColour),u.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_,()=>this.onHide(),void 0,!1),this.htmlInput_.addEventListener("keydown",this.keyHandler)}playKey(e,t){let i=++this.totalPlayCount;this.currentSelectedKey!==e&&(this.currentSelectedKey&&pxt.BrowserUtils.removeClass(this.currentSelectedKey,"selected"),pxt.BrowserUtils.addClass(e,"selected"),this.setValue(t)),this.currentSelectedKey=e,this.htmlInput_.value=this.getText(),pxt.AudioContextManager.tone(t),setTimeout(()=>{this.totalPlayCount==i&&pxt.AudioContextManager.stop()},300)}dispose(){u.DropDownDiv.hideIfOwner(this),super.dispose()}updateColor(){var e,t=this.sourceBlock_.getParent();t&&(this.sourceBlock_.isShadow()||1===(e=this.sourceBlock_).inputList.length&&1===e.inputList[0].fieldRow.length)?(this.primaryColour=t.getColour(),this.borderColour=t.getColourTertiary()):(this.primaryColour="#3D3D3D",this.borderColour="#2A2A2A")}setPage(e){var t=this.nKeys_/h.notesPerOctave,i=(e=Math.max(Math.min(e,t-1),0),this.noteLabel.textContent="Octave #"+(e+1),e*h.notesPerOctave);for(let e=0;e<this.piano.length;++e){var n=e>=i&&e<i+h.notesPerOctave;this.piano[e].style.display=n?"block":"none"}this.currentPage=e}getNextPrevDiv(t,e){var i=t?0:e/2;let n=p("blocklyNotePrevNext",`top: ${h.keyHeight+h.labelHeight}px;
            left: ${i}px;
            width: ${Math.ceil(e/2)}px;
            ${t?"border-left-color":"border-right-color"}: ${this.primaryColour};
            background-color: ${this.primaryColour};
            border-bottom-color: ${this.primaryColour};`);return pxt.BrowserUtils.pointerEvents.down.forEach(e=>{u.browserEvents.conditionalBind(n,e,this,()=>this.setPage(t?this.currentPage-1:this.currentPage+1),!0)}),n.textContent=t?"<":">",n}getKeyDiv(t,e){let i=p("blocklyNote "+(this.isWhite(t)?"":"black"),`width: ${this.getKeyWidth(t)}px;
            height: ${this.getKeyHeight(t)}px;
            left: ${e}px;
            border-color: ${this.primaryColour};`);return pxt.BrowserUtils.pointerEvents.down.forEach(e=>{u.browserEvents.conditionalBind(i,e,this,()=>this.playKey(i,this.getKeyFreq(t)),!0)}),u.browserEvents.conditionalBind(i,"mouseover",this,e=>{this.noteLabel.textContent=this.getKeyName(t),e.buttons&&this.playKey(i,this.getKeyFreq(t))},!0),i}isWhite(e){switch((e+=8)%12){case 1:case 3:case 6:case 8:case 10:return!1;default:return!0}}whiteKeysBefore(e){switch((e+=8)%12){case 0:return 0;case 1:case 2:return 1;case 3:case 4:return 2;case 5:return 3;case 6:case 7:return 4;case 8:case 9:return 5;case 10:case 11:return 6}return-1}getKeyWidth(e){return this.isWhite(e)?h.keyWidth:h.keyWidth/2}getKeyHeight(e){return this.isWhite(e)?h.keyHeight:h.keyHeight/2}getNeighboringKeys(t){let i,n;for(let e=this.minNote_;e<=this.maxNote_;++e){if(this.getKeyFreq(e)+this.eps>t){n=e;break}i=e}return i?n&&n!==this.maxNote_?(t<this.getKeyFreq(i)+this.eps?n=i:t>this.getKeyFreq(n)-this.eps&&(i=n),{keyAbove:i+1,keyBelow:n-1}):{keyAbove:this.maxNote_,keyBelow:t-this.eps<this.getKeyFreq(this.maxNote_)?this.maxNote_-1:this.maxNote_}:{keyAbove:t+this.eps>this.getKeyFreq(this.minNote_)?this.minNote_+1:this.minNote_,keyBelow:this.minNote_}}getKeyFreq(e){return this.getKeyNoteData(e).freq}getKeyName(e){e=this.getKeyNoteData(e);let t=e.prefixedName;return this.nKeys_<=h.notesPerOctave?t=e.name:28<=this.minNote_&&this.maxNote_<=63&&(t=e.altPrefixedName||t),t}getKeyNoteData(e){return h.Notes[e]}getPosition(e){if(e===this.minNote_)return 0;var t,i=h.keyWidth/4,n=Math.floor((this.minNote_+8)/h.notesPerOctave),o=Math.floor((e+8)/h.notesPerOctave);let r=this.whiteKeysBefore(this.minNote_)*h.keyWidth;return this.isWhite(this.minNote_)||(r-=i),n<o?(o=(t=7*h.keyWidth)-r+(o-n-1)*t,this.whiteKeysBefore(e)*h.keyWidth+o-(this.isWhite(e)?0:i)):this.whiteKeysBefore(e)*h.keyWidth-r-(this.isWhite(e)?0:i)}prepareNotes(){h.Notes||(h.Notes={28:{name:lf("{id:note}C"),prefixedName:lf("Low C"),freq:131},29:{name:lf("C#"),prefixedName:lf("Low C#"),freq:139},30:{name:lf("{id:note}D"),prefixedName:lf("Low D"),freq:147},31:{name:lf("D#"),prefixedName:lf("Low D#"),freq:156},32:{name:lf("{id:note}E"),prefixedName:lf("Low E"),freq:165},33:{name:lf("{id:note}F"),prefixedName:lf("Low F"),freq:175},34:{name:lf("F#"),prefixedName:lf("Low F#"),freq:185},35:{name:lf("{id:note}G"),prefixedName:lf("Low G"),freq:196},36:{name:lf("G#"),prefixedName:lf("Low G#"),freq:208},37:{name:lf("{id:note}A"),prefixedName:lf("Low A"),freq:220},38:{name:lf("A#"),prefixedName:lf("Low A#"),freq:233},39:{name:lf("{id:note}B"),prefixedName:lf("Low B"),freq:247},40:{name:lf("{id:note}C"),prefixedName:lf("Middle C"),freq:262},41:{name:lf("C#"),prefixedName:lf("Middle C#"),freq:277},42:{name:lf("{id:note}D"),prefixedName:lf("Middle D"),freq:294},43:{name:lf("D#"),prefixedName:lf("Middle D#"),freq:311},44:{name:lf("{id:note}E"),prefixedName:lf("Middle E"),freq:330},45:{name:lf("{id:note}F"),prefixedName:lf("Middle F"),freq:349},46:{name:lf("F#"),prefixedName:lf("Middle F#"),freq:370},47:{name:lf("{id:note}G"),prefixedName:lf("Middle G"),freq:392},48:{name:lf("G#"),prefixedName:lf("Middle G#"),freq:415},49:{name:lf("{id:note}A"),prefixedName:lf("Middle A"),freq:440},50:{name:lf("A#"),prefixedName:lf("Middle A#"),freq:466},51:{name:lf("{id:note}B"),prefixedName:lf("Middle B"),freq:494},52:{name:lf("{id:note}C"),prefixedName:lf("Tenor C"),altPrefixedName:lf("High C"),freq:523},53:{name:lf("C#"),prefixedName:lf("Tenor C#"),altPrefixedName:lf("High C#"),freq:554},54:{name:lf("{id:note}D"),prefixedName:lf("Tenor D"),altPrefixedName:lf("High D"),freq:587},55:{name:lf("D#"),prefixedName:lf("Tenor D#"),altPrefixedName:lf("High D#"),freq:622},56:{name:lf("{id:note}E"),prefixedName:lf("Tenor E"),altPrefixedName:lf("High E"),freq:659},57:{name:lf("{id:note}F"),prefixedName:lf("Tenor F"),altPrefixedName:lf("High F"),freq:698},58:{name:lf("F#"),prefixedName:lf("Tenor F#"),altPrefixedName:lf("High F#"),freq:740},59:{name:lf("{id:note}G"),prefixedName:lf("Tenor G"),altPrefixedName:lf("High G"),freq:784},60:{name:lf("G#"),prefixedName:lf("Tenor G#"),altPrefixedName:lf("High G#"),freq:831},61:{name:lf("{id:note}A"),prefixedName:lf("Tenor A"),altPrefixedName:lf("High A"),freq:880},62:{name:lf("A#"),prefixedName:lf("Tenor A#"),altPrefixedName:lf("High A#"),freq:932},63:{name:lf("{id:note}B"),prefixedName:lf("Tenor B"),altPrefixedName:lf("High B"),freq:988},64:{name:lf("{id:note}C"),prefixedName:lf("High C"),freq:1046},65:{name:lf("C#"),prefixedName:lf("High C#"),freq:1109},66:{name:lf("{id:note}D"),prefixedName:lf("High D"),freq:1175},67:{name:lf("D#"),prefixedName:lf("High D#"),freq:1245},68:{name:lf("{id:note}E"),prefixedName:lf("High E"),freq:1319},69:{name:lf("{id:note}F"),prefixedName:lf("High F"),freq:1397},70:{name:lf("F#"),prefixedName:lf("High F#"),freq:1478},71:{name:lf("{id:note}G"),prefixedName:lf("High G"),freq:1568},72:{name:lf("G#"),prefixedName:lf("High G#"),freq:1661},73:{name:lf("{id:note}A"),prefixedName:lf("High A"),freq:1760},74:{name:lf("A#"),prefixedName:lf("High A#"),freq:1865},75:{name:lf("{id:note}B"),prefixedName:lf("High B"),freq:1976}})}}function p(e,t){var i=document.createElement("div");return pxt.BrowserUtils.addClass(i,e),i.setAttribute("style",t.replace(/\s+/g," ")),i}(i.FieldNote=h).keyWidth=22,h.keyHeight=90,h.labelHeight=24,h.prevNextHeight=20,h.notesPerOctave=12,h.blackKeysPerOctave=5},{"./field_utils":69,blockly:219}],46:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldNumberDropdown=void 0;e=e("./field_textdropdown");class n extends e.BaseFieldTextDropdown{constructor(e,t,i,n,o,r){super(e+"",t,r),this.setConstraints(i,n,o)}setConstraints(e,t,i){this.setMinInternal(e),this.setMaxInternal(t),this.setPrecisionInternal(i),this.setValue(this.getValue())}getValue(){return Number(super.getValue())}setMinInternal(e){null==e?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}setMaxInternal(e){null==e?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}setPrecisionInternal(e){this.precision_=Number(e)||0;let t=String(this.precision_);var i=(t=-1!==t.indexOf("e")?this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}):t).indexOf(".");this.decimalPlaces=-1===i?e?0:null:t.length-i-1}doClassValidation_(e){if(null===e)return null;e=(e=(e=(e=""+e).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity");let t=Number(e||0);return isNaN(t)?null:(void 0!==this.min_&&(t=Math.max(t,this.min_)),void 0!==this.max_&&(t=Math.min(t,this.max_)),this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_),(t=null!==this.decimalPlaces?Number(t.toFixed(this.decimalPlaces)):t)+"")}}class o extends n{constructor(e,t,i){super(e,(t=>{let i;if(t.values){var n,o=[],r=t.values.split(",");let e=!1;for(n of r){var s=parseFloat(n);if(Number.isNaN(s)){e=!0;break}o.push([n,s])}e||(i=o)}else if(t.data)try{var a=JSON.parse(t.data);if(Array.isArray(a)&&a.length){if((e=>{for(var t of e)if("number"!=typeof t)return;return 1})(a))return a.map(e=>[""+e,e]);{let e=!1;for(var l of a)if(!Array.isArray(l)||"string"!=typeof l[0]||"number"!=typeof l[1]){e=!0;break}e||(i=a)}}}catch(e){}return i||(pxt.warn("Could not parse numberdropdown data field"),[])})(t),t.min,t.max,t.precision,i),this.isFieldCustom_=!0}getOptions(){let e;return this.menuGenerator_&&("string"==typeof this.menuGenerator_&&(this.menuGenerator_=JSON.parse(this.menuGenerator_)),e=this.menuGenerator_.map(e=>"object"==typeof e?[pxt.Util.rlf(e[0]),e[1]]:[String(e),String(e)])),e}}i.FieldNumberDropdown=o},{"./field_textdropdown":55}],47:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldPosition=void 0;let u=e("blockly");e=e("../plugins/math");class n extends e.FieldSlider{constructor(e,t,i){super(e,"0","100","1","1","Value",i),this.isFieldCustom_=!0,this.params=t,this.params.screenHeight||(this.params.screenHeight=120),this.params.screenWidth||(this.params.screenWidth=160),this.params.xInputName||(this.params.xInputName="x"),this.params.yInputName||(this.params.yInputName="y"),this.params.min&&(this.min_=parseInt(this.params.min)),this.params.max&&(this.max_=parseInt(this.params.max))}showEditor_(e){this.getFieldByName(this.params.xInputName)===this&&(this.max_=this.params.screenWidth,this.labelText_=this.params.xInputName);var t=this.getFieldByName(this.params.yInputName);t===this&&(this.max_=this.params.screenHeight,this.labelText_=this.params.yInputName),super.showEditor_(e),this.renderScreenPicker()}doValueUpdate_(e){super.doValueUpdate_(e),this.resetCrosshair&&this.resetCrosshair()}renderScreenPicker(){var e=u.DropDownDiv.getContentDiv();this.selectorDiv_=document.createElement("div"),this.selectorDiv_.className="blocklyCanvasOverlayOuter",e.appendChild(this.selectorDiv_);let n=document.createElement("div"),o=(n.className="blocklyCanvasOverlayDiv",this.selectorDiv_.appendChild(n),document.createElement("div")),r=(o.className="cross-x",n.appendChild(o),document.createElement("div")),s=(r.className="cross-y",n.appendChild(r),document.createElement("div")),a=(s.className="label",n.appendChild(s),1.5*this.params.screenWidth),l=1.5*this.params.screenHeight;n.style.height=l+"px",n.style.width=a+"px";var e=e.getElementsByClassName("goog-slider-horizontal")[0];e&&(e.style.width=a+"px",e=Number(this.getValue()),!isNaN(e))&&e>this.getMin()&&(this.setValue(e-1+""),this.setValue(e+""));let c=(e,t)=>{e=Math.round(Math.max(0,Math.min(a,e))),t=Math.round(Math.max(0,Math.min(l,t))),o.style.top=t+"px",r.style.left=e+"px",e=Math.round(Math.max(0,Math.min(this.params.screenWidth,e/a*this.params.screenWidth))),t=Math.round(Math.max(0,Math.min(this.params.screenHeight,t/l*this.params.screenHeight))),isNaN(e)?s.textContent=this.params.yInputName+"="+t:isNaN(t)?s.textContent=this.params.xInputName+"="+e:s.textContent=`${this.params.xInputName}=${e} ${this.params.yInputName}=`+t;var i=s.getBoundingClientRect();e>this.params.screenWidth/2?s.style.left=e*(a/this.params.screenWidth)-i.width-8+"px":s.style.left=e*(a/this.params.screenWidth)+4+"px",t>this.params.screenHeight/2?s.style.top=t*(l/this.params.screenHeight)-i.height-6+"px":s.style.top=t*(l/this.params.screenHeight)+"px"};this.resetCrosshair=()=>{var{currentX:e,currentY:t}=this.getXY();c(e/this.params.screenWidth*a,t/this.params.screenHeight*l)},this.resetCrosshair(),u.browserEvents.bind(this.selectorDiv_,"mousemove",this,e=>{var t=n.getBoundingClientRect(),i=e.clientX-t.left,e=e.clientY-t.top;c(i,e)}),u.browserEvents.bind(this.selectorDiv_,"mouseleave",this,this.resetCrosshair),u.browserEvents.bind(this.selectorDiv_,"click",this,e=>{var t=n.getBoundingClientRect(),i=e.clientX-t.left,e=e.clientY-t.top,t=Math.round(i/a*this.params.screenWidth),i=Math.round(e/l*this.params.screenHeight);this.close(),this.setXY(t,i)})}resizeHandler(){this.close()}setXY(e,t){var i=this.getFieldByName(this.params.xInputName),i=(i&&"number"==typeof i.getValue()&&i.setValue(String(e)),this.getFieldByName(this.params.yInputName));i&&"number"==typeof i.getValue()&&i.setValue(String(t))}getFieldByName(t){var i=this.sourceBlock_.getParent();if(i)for(let e=0;e<i.inputList.length;e++){var n=i.inputList[e];if(n.name===t)return this.getTargetField(n)}}getXY(){let e,t;var i=this.getFieldByName(this.params.xInputName),i=(i&&(e=i.getValue()),this.getFieldByName(this.params.yInputName));return i&&(t=i.getValue()),{currentX:parseInt(e),currentY:parseInt(t)}}getTargetField(e){var e=e.connection.targetBlock();return(e=e&&e.inputList[0])?e.fieldRow[0]:null}widgetDispose_(){super.widgetDispose_(),this.close(!0)}close(e){e||(u.WidgetDiv.hideIfOwner(this),u.DropDownDiv.hideIfOwner(this)),window.removeEventListener("resize",this.resizeHandler),this.resetCrosshair=void 0,this.selectorDiv_&&(u.utils.dom.removeNode(this.selectorDiv_),this.selectorDiv_=void 0)}}i.FieldPosition=n},{"../plugins/math":119,blockly:219}],48:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldProcedure=void 0;e=e("./field_dropdown");class n extends e.FieldDropdown{constructor(e,t){super(function(){var t=[];if(this.sourceBlock_&&this.sourceBlock_.workspace){var i,n=this.sourceBlock_.workspace.getAllBlocks(!1);for(let e=0;e<n.length;e++)n[e].getProcedureDef&&(i=n[e].getProcedureDef(),t.push(i[0]))}var e=this.getValue(),o=(e&&-1==t.indexOf(e)&&t.push(e),t.sort((e,t)=>{e=e.toLowerCase(),t=t.toLowerCase();return e===t?0:t<e?1:-1}),t.length||t.push("Temp"),this.rawValue&&-1===t.indexOf(this.rawValue)&&t.push(this.rawValue),[]);for(let e=0;e<t.length;e++)o[e]=[t[e],t[e]];return o},t),this.setValue(e||"")}getOptions(e){return this.menuGenerator_()}doClassValidation_(e){return void 0===e?null:e}doValueUpdate_(e){this.rawValue=e,super.doValueUpdate_(e)}init(){this.fieldGroup_||super.init.call(this)}setSourceBlock(e){pxt.Util.assert(!e.isShadow(),"Procedure fields are not allowed to exist on shadow blocks."),super.setSourceBlock.call(this,e)}}i.FieldProcedure=n},{"./field_dropdown":34}],49:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldProtractor=void 0;e=e("../plugins/math");class n extends e.FieldSlider{constructor(e,t,i){super(String(e),"0","180","1","15",lf("Angle"),i),this.isFieldCustom_=!0,this.params=t}createLabelDom_(e){var t=document.createElement("div"),i=(this.circleSVG=document.createElementNS("http://www.w3.org/2000/svg","svg"),pxsim.svg.hydrate(this.circleSVG,{viewBox:"0 0 200 100",width:"170"}),t.appendChild(this.circleSVG),pxsim.svg.child(this.circleSVG,"circle",{"stroke-dasharray":"565.48","stroke-dashoffset":"0",cx:100,cy:100,r:"90",style:"fill:transparent; transition: stroke-dashoffset 0.1s linear;",stroke:"#a8aaa8","stroke-width":"1rem"}),this.circleBar=pxsim.svg.child(this.circleSVG,"circle",{"stroke-dasharray":"565.48","stroke-dashoffset":"0",cx:100,cy:100,r:"90",style:"fill:transparent; transition: stroke-dashoffset 0.1s linear;",stroke:"#f12a21","stroke-width":"1rem"}),this.reporter=pxsim.svg.child(this.circleSVG,"text",{x:100,y:80,"text-anchor":"middle","dominant-baseline":"middle",style:"font-size: 50px",class:"sim-text inverted number"}),document.createElement("span"));return i.setAttribute("class","blocklyFieldSliderReadout"),[t,i]}setReadout(e){this.updateAngle("string"==typeof e?parseFloat(e):e),this.reporter&&(this.reporter.textContent=e+"Â°")}updateAngle(e){this.circleBar&&(e=(180-(e=Math.max(0,Math.min(180,e))))/180*Math.PI*90,this.circleBar.setAttribute("stroke-dashoffset",""+e))}}i.FieldProtractor=n},{"../plugins/math":119}],50:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldScopedValueSelector=void 0;let n=e("blockly"),o=e("./field_utils");class r extends n.FieldLabel{constructor(e,t){super(e),this.isFieldCustom_=!0,this.types=[],this.dragging=!1,this.onDragEvent=t=>{if(t.blocks.find(e=>e.id===this.sourceBlock_.id))if(this.dragging=t.isStart,t.isStart)this.forceRerender();else{var i=[];{let e=null==(t=this.sourceBlock_.getParent())?void 0:t.getParent();for(;e;)i.push(e),e=e.getParent()}let n=pxt.getBundledApiInfo();var e;this.scopedValue=null;for(e of i)if("variables_set"===e.type){var o=e.inputList.find(e=>"VALUE"===e.name);if(o){o=o.fieldRow;if(o){o=o.find(e=>"VAR"===e.name);if(o){o=o.getVariable();if(o)return this.setValue(o.getName())}}}}else{o=(e=>{var t,i=e.codeCard;if(!i||!i.name)return null;for(t of Object.values(n))if(t.apis.byQName[i.name])return t.apis.byQName[i.name]})(e);if(o)for(var r of o.parameters)if(r.handlerParameters)for(var s of r.handlerParameters)if(this.types.includes(s.type))return this.setValue(s.name)}this.setValue(this.defl)}},this.onWorkspaceChange=e=>this.sourceBlock_&&this.sourceBlock_.workspace&&!this.sourceBlock_.disposed&&e.type===n.Events.BLOCK_DRAG?this.onDragEvent(e):void 0,this.defl=t.defl,t.types?this.types=t.types.split(","):t.type&&(this.types=[t.type]),this.types=this.types.map(e=>e.trim().replace(/['"]+/g,""))}init(){super.init(),this.sourceBlock_&&(this.scopedValue=(0,o.getBlockDataForField)(this.sourceBlock_,"scopedValue"),this.sourceBlock_.workspace.addChangeListener(this.onWorkspaceChange))}dispose(){this.sourceBlock_&&this.sourceBlock_.workspace.removeChangeListener(this.onWorkspaceChange),super.dispose()}getValue(){var e;return null!=(e=this.sourceBlock_)&&e.isInFlyout?lf("(dynamic)"):this.dragging?lf("what will it be?"):(this.sourceBlock_&&!this.scopedValue&&(this.scopedValue=(0,o.getBlockDataForField)(this.sourceBlock_,"scopedValue")),this.scopedValue||this.defl||lf("unknown"))}setValue(e,t){this.scopedValue=e||this.defl||lf("unknown"),this.sourceBlock_&&(0,o.setBlockDataForField)(this.sourceBlock_,"scopedValue",this.scopedValue||""),super.setValue(this.scopedValue,t),this.forceRerender()}getFieldDescription(){return this.scopedValue||this.defl||lf("value")}}i.FieldScopedValueSelector=r},{"./field_utils":69,blockly:219}],51:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldSoundEffect=void 0;let u=e("blockly");var o=pxt.svgUtil,n=e("./field_base");let d=e("./field_utils");class r extends n.FieldBase{constructor(){super(...arguments),this.registeredChangeListener=!1,this.onWorkspaceChange=e=>{e.type!==u.Events.CHANGE||!(e=this.sourceBlock_.workspace.getBlockById(e.blockId))||e!==this.sourceBlock_&&e.getParent()!==this.sourceBlock_||this.redrawPreview()}}onInit(){this.options||(this.options={}),this.options.durationInputName||(this.options.durationInputName="duration"),this.options.startFrequencyInputName||(this.options.startFrequencyInputName="startFrequency"),this.options.endFrequencyInputName||(this.options.endFrequencyInputName="endFrequency"),this.options.startVolumeInputName||(this.options.startVolumeInputName="startVolume"),this.options.endVolumeInputName||(this.options.endVolumeInputName="endVolume"),this.options.waveFieldName||(this.options.waveFieldName="waveShape"),this.options.interpolationFieldName||(this.options.interpolationFieldName="interpolation"),this.options.effectFieldName||(this.options.effectFieldName="effect"),this.options.useMixerSynthesizer||(this.options.useMixerSynthesizer=!1),this.redrawPreview(),this.sourceBlock_.workspace&&(this.workspace=this.sourceBlock_.workspace,this.sourceBlock_.isShadow()||this.sourceBlock_.isInsertionMarker()||(this.registeredChangeListener=!0,this.workspace.addChangeListener(this.onWorkspaceChange)))}onDispose(){this.workspace&&this.registeredChangeListener&&(this.workspace.removeChangeListener(this.onWorkspaceChange),this.registeredChangeListener=!1)}onValueChanged(e){return e}redrawPreview(){if(this.fieldGroup_){if(this.drawnSound){var e=this.readCurrentSound();if(e.startFrequency===this.drawnSound.startFrequency&&e.endFrequency===this.drawnSound.endFrequency&&e.startVolume===this.drawnSound.startVolume&&e.endVolume===this.drawnSound.endVolume&&e.wave===this.drawnSound.wave&&e.interpolation===this.drawnSound.interpolation)return}pxsim.U.clear(this.fieldGroup_);var e=(new o.Rect).at(5,4).size(160,40).setClass("blocklyFieldRect blocklySpriteField").stroke("#fff",1).fill("#dedede").corner(20),t="preview-clip-"+pxt.U.guidGen(),i=(new o.ClipPath).id(t).clipPathUnits(!1),n=(new o.Rect).size(115,40).fill("#FFF").at(0,0),n=(i.appendChild(n),this.drawnSound=this.readCurrentSound(),(new o.Path).stroke("grey",2).fill("none").setD(pxt.assets.renderSoundPath(this.drawnSound,120,32)).clipPath("url('#"+t+"')")),t=(new o.Group).translate(35,7),i=(t.appendChild(i),t.appendChild(n),new o.Text("ï€").appendClass("melody-editor-field-icon").setAttribute("alignment-baseline","middle").anchor("middle").at(20,24));this.fieldGroup_.appendChild(e.el),this.fieldGroup_.appendChild(i.el),this.fieldGroup_.appendChild(t.el)}}showEditor_(e){e=!e;let t=this.readCurrentSound();u.Events.disable();let i,n={getScaledBBox:()=>i},o=(u.WidgetDiv.show(n,this.sourceBlock_.RTL,()=>{document.activeElement&&"INPUT"===document.activeElement.tagName&&document.activeElement.blur(),s.hide(),o.classList.remove("sound-effect-editor-widget"),o.style.transform="",o.style.position="",o.style.left="",o.style.top="",o.style.width="",o.style.height="",o.style.opacity="",o.style.transition="",o.style.alignItems="",u.Events.enable(),u.Events.setGroup(!0),this.fireNumberInputUpdate(this.options.durationInputName,t.duration),this.fireNumberInputUpdate(this.options.startFrequencyInputName,t.startFrequency),this.fireNumberInputUpdate(this.options.endFrequencyInputName,t.endFrequency),this.fireNumberInputUpdate(this.options.startVolumeInputName,t.startVolume),this.fireNumberInputUpdate(this.options.endVolumeInputName,t.endVolume),this.fireFieldDropdownUpdate(this.options.waveFieldName,h[t.wave]),this.fireFieldDropdownUpdate(this.options.interpolationFieldName,g[t.interpolation]),this.fireFieldDropdownUpdate(this.options.effectFieldName,p[t.effect]),u.Events.setGroup(!1),this.mostRecentValue&&this.setBlockData(JSON.stringify(this.mostRecentValue))}),u.WidgetDiv.getDiv());var r={onClose:()=>{u.WidgetDiv.hideIfOwner(n),s.hide()},onSoundChange:e=>{this.mostRecentValue=e,this.updateSiblingBlocks(e),this.redrawPreview()},initialSound:t,useMixerSynthesizer:(e=>{if(!e)return!1;if("string"==typeof e)switch(e.toLowerCase().trim()){case"1":case"yes":case"y":case"on":case"true":return!0;default:return!1}return!!e})(this.options.useMixerSynthesizer)};let s=pxt.react.getFieldEditorView("soundeffect-editor",t,r,o,e);var r=this.sourceBlock_,e=r.getBoundingRectangle(),a=(0,d.workspaceToScreenCoordinates)(r.workspace,new u.utils.Coordinate(e.right,e.top));var l=a.x+20,a=a.y-20,l=(o.style.opacity="0",o.classList.add("sound-effect-editor-widget"),o.style.position="absolute",o.style.left=l+"px",o.style.top=a+"px",o.style.width="30rem",o.style.height="40rem",o.style.display="flex",o.style.alignItems="center",o.style.transition="transform 0.25s ease 0s, opacity 0.25s ease 0s",o.style.borderRadius="",s.onHide(()=>{}),s.show(),o.getBoundingClientRect()),a=r.workspace.getInjectionDiv().getBoundingClientRect(),c=(l.height>a.height?(o.style.height="",o.style.top="calc(1rem - 20px)",o.style.bottom="calc(1rem + 20px)"):(l.bottom>a.bottom||l.top<a.top)&&(o.style.top=a.top+a.height/2-l.height/2-20+"px"),r.workspace.getToolbox().getWidth()),r=(l.width>a.width-c?(o.style.width="",o.style.left="1rem",o.style.right="1rem"):l.left+l.width>=a.right&&(r=(0,d.workspaceToScreenCoordinates)(r.workspace,new u.utils.Coordinate(e.left,e.top)),e=a.left+c,r.x-l.width-20>e?o.style.left=r.x-l.width-20+"px":o.style.left=e+(a.width-c)/2-l.width/2+"px"),o.getBoundingClientRect());i=new u.utils.Rect(r.top,r.bottom,r.left,r.right),requestAnimationFrame(()=>{o.style.opacity="1",o.style.transform="translateY(20px)"})}render_(){super.render_(),this.size_.height=48,this.size_.width=165}getFieldDescription(){return lf("sound effect")}updateSiblingBlocks(e){this.setNumberInputValue(this.options.durationInputName,e.duration),this.setNumberInputValue(this.options.startFrequencyInputName,e.startFrequency),this.setNumberInputValue(this.options.endFrequencyInputName,e.endFrequency),this.setNumberInputValue(this.options.startVolumeInputName,e.startVolume),this.setNumberInputValue(this.options.endVolumeInputName,e.endVolume),this.setFieldDropdownValue(this.options.waveFieldName,h[e.wave]),this.setFieldDropdownValue(this.options.interpolationFieldName,g[e.interpolation]),this.setFieldDropdownValue(this.options.effectFieldName,p[e.effect])}setNumberInputValue(e,t){e=this.getSiblingBlock(e)||this.getSiblingBlock(e,!0);e&&("math_number"===e.type||"math_integer"===e.type||"math_whole_number"===e.type?e.setFieldValue(Math.round(t),"NUM"):"math_number_minmax"===e.type&&e.setFieldValue(Math.round(t),"SLIDER"))}getNumberInputValue(e,t){e=this.getSiblingBlock(e)||this.getSiblingBlock(e,!0);return e?"math_number"===e.type||"math_integer"===e.type||"math_whole_number"===e.type?parseInt(e.getFieldValue("NUM")+""):"math_number_minmax"===e.type?parseInt(e.getFieldValue("SLIDER")+""):t:t}fireNumberInputUpdate(t,i){var n=this.getSiblingBlock(t)||this.getSiblingBlock(t,!0);if(n){let e;"math_number"===n.type||"math_integer"===n.type||"math_whole_number"===n.type?e="NUM":"math_number_minmax"===n.type&&(e="SLIDER"),e&&u.Events.fire(new u.Events.BlockChange(n,"field",e,i,this.getNumberInputValue(t,i)))}}setFieldDropdownValue(e,t){e=this.getSiblingField(e)||this.getSiblingField(e,!0);e&&e.setValue(t)}getFieldDropdownValue(e){e=this.getSiblingField(e)||this.getSiblingField(e,!0);if(e)return e.getValue()}fireFieldDropdownUpdate(e,t){var i=this.getSiblingField(e)||this.getSiblingField(e,!0);i&&u.Events.fire(new u.Events.BlockChange(i.getSourceBlock(),"field",i.name,t,this.getFieldDropdownValue(e)))}readCurrentSound(){var e=this.readBlockDataSound();return{duration:this.getNumberInputValue(this.options.durationInputName,e.duration),startFrequency:this.getNumberInputValue(this.options.startFrequencyInputName,e.startFrequency),endFrequency:this.getNumberInputValue(this.options.endFrequencyInputName,e.endFrequency),startVolume:this.getNumberInputValue(this.options.startVolumeInputName,e.startVolume),endVolume:this.getNumberInputValue(this.options.endVolumeInputName,e.endVolume),wave:s(h,this.getFieldDropdownValue(this.options.waveFieldName))||e.wave,interpolation:s(g,this.getFieldDropdownValue(this.options.interpolationFieldName))||e.interpolation,effect:s(p,this.getFieldDropdownValue(this.options.effectFieldName))||e.effect}}readBlockDataSound(){var e=this.getBlockData();let t;try{t=JSON.parse(e)}catch(e){t={duration:1e3,startFrequency:100,endFrequency:4800,startVolume:100,endVolume:0,wave:"sine",interpolation:"linear",effect:"none"}}return t}}i.FieldSoundEffect=r;let h={sine:"WaveShape.Sine",square:"WaveShape.Square",sawtooth:"WaveShape.Sawtooth",triangle:"WaveShape.Triangle",noise:"WaveShape.Noise"},p={none:"SoundExpressionEffect.None",vibrato:"SoundExpressionEffect.Vibrato",tremolo:"SoundExpressionEffect.Tremolo",warble:"SoundExpressionEffect.Warble"},g={linear:"InterpolationCurve.Linear",curve:"InterpolationCurve.Curve",logarithmic:"InterpolationCurve.Logarithmic"};function s(t,i){return Object.keys(t).find(e=>t[e]===i)}},{"./field_base":31,"./field_utils":69,blockly:219}],52:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldSpeed=void 0;e=e("../plugins/math");class n extends e.FieldSlider{constructor(e,t,i){super(String(e),"-100","100","1","10","Speed",i),this.isFieldCustom_=!0,this.params=t,this.params.min&&(this.min_=parseFloat(this.params.min)),this.params.max&&(this.max_=parseFloat(this.params.max)),this.params.label&&(this.labelText_=this.params.label),this.params.format||(this.params.format="{0}%")}createLabelDom_(e){var t=document.createElement("div"),i=(this.speedSVG=document.createElementNS("http://www.w3.org/2000/svg","svg"),pxsim.svg.hydrate(this.speedSVG,{viewBox:"0 0 200 100",width:"170"}),t.appendChild(this.speedSVG),pxsim.svg.child(this.speedSVG,"circle",{"stroke-dasharray":"565.48","stroke-dashoffset":"0",cx:100,cy:100,r:"90",style:"fill:transparent; transition: stroke-dashoffset 0.1s linear;",stroke:"#a8aaa8","stroke-width":"1rem"}),this.circleBar=pxsim.svg.child(this.speedSVG,"circle",{"stroke-dasharray":"565.48","stroke-dashoffset":"0",cx:100,cy:100,r:"90",style:"fill:transparent; transition: stroke-dashoffset 0.1s linear;",stroke:"#f12a21","stroke-width":"1rem"}),this.reporter=pxsim.svg.child(this.speedSVG,"text",{x:100,y:80,"text-anchor":"middle","dominant-baseline":"middle",style:`font-size: ${Math.max(14,50-5*(this.params.format.length-4))}px`,class:"sim-text inverted number"}),document.createElement("span"));return i.setAttribute("class","blocklyFieldSliderReadout"),[t,i]}setReadout(e){this.updateSpeed("string"==typeof e?parseFloat(e):e),this.params&&this.reporter&&(this.reporter.textContent=ts.pxtc.U.rlf(this.params.format,e))}updateSpeed(e){var t;this.circleBar&&(t=this.sign(e),e=Math.abs(e)/100*50+50,-1==t&&(e=50-e),t=180*Math.PI,this.circleBar.setAttribute("stroke-dashoffset",""+(100-e)/100*t))}sign(e){return e?e<0?-1:1:0}}i.FieldSpeed=n},{"../plugins/math":119}],53:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldSpriteEditor=void 0;e=e("./field_asset");class n extends e.FieldAssetEditor{getAssetType(){return"image"}createNewAsset(e){var t=pxt.react.getTilemapProject();if(e){var i=pxt.lookupProjectAssetByTSReference(e,t);if(i)return i}if(this.getBlockData())return t.lookupAsset("image",this.getBlockData());i=e?pxt.sprite.imageLiteralToBitmap(e,this.params.taggedTemplate):new pxt.sprite.Bitmap(this.params.initWidth,this.params.initHeight);let n;if(!i){if(!(n=o(e)))return this.isGreyBlock=!0,void(this.valueText=e);this.qName=e}return n=n||i.data(),{internalID:-1,id:this.temporaryAssetId(),type:"image",jresData:pxt.sprite.base64EncodeBitmap(n),meta:{},bitmap:n}}getValueText(){if(!this.asset)return this.valueText||"";if(this.asset&&!this.isTemporaryAsset())return pxt.getTSReferenceForAsset(this.asset);if(this.qName){var e=o(this.qName);if(e&&pxt.sprite.bitmapEquals(e,this.asset.bitmap))return this.qName}return pxt.sprite.bitmapToImageLiteral(this.asset&&pxt.sprite.Bitmap.fromData(this.asset.bitmap),"typescript",this.params.taggedTemplate)}parseFieldOptions(e){var t={initColor:1,initWidth:16,initHeight:16,disableResize:!1,lightMode:!1};if(e){if(t.lightMode=e.lightMode,e.sizes){var i=e.sizes.split(";"),n=[];for(let e=0;e<i.length;e++){var o=i[e].split(",");if(2===o.length){let e=parseInt(o[0]),t=parseInt(o[1]);isNaN(e)||isNaN(t)||(o=pxt.appTarget.runtime&&pxt.appTarget.runtime.screenSize,e<0&&o&&(e=o.width),t<0&&o&&(t=o.height),n.push([e,t]))}}0<n.length&&(t.initWidth=n[0][0],t.initHeight=n[0][1])}e.filter&&(t.filter=e.filter),e.disableResize&&(t.disableResize="true"===e.disableResize.toLowerCase()||"1"===e.disableResize),t.initColor=r(e.initColor,t.initColor),t.initWidth=r(e.initWidth,t.initWidth),t.initHeight=r(e.initHeight,t.initHeight),t.taggedTemplate=e.taggedTemplate}return t;function r(e,t){e=parseInt(e);return isNaN(e)?t:e}}}function o(t){var e=pxt.react.getTilemapProject().getGalleryAssets("image").filter(e=>e.id===t),e=e.length&&e[0];if(e)return e.bitmap}i.FieldSpriteEditor=n},{"./field_asset":29}],54:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldStyledLabel=void 0;e=e("blockly");class n extends e.FieldLabel{constructor(e,t,i){super(e,(e=>{if(e){if(e.bold&&e.italics)return"blocklyBoldItalicizedText";if(e.bold)return"blocklyBoldText";if(e.italics)return"blocklyItalicizedText"}})(t)),this.isFieldCustom_=!0}getFieldDescription(){return this.getText()}}i.FieldStyledLabel=n},{blockly:219}],55:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldTextDropdown=i.BaseFieldTextDropdown=void 0;let a=e("blockly"),l=e("./field_utils");class n extends a.FieldTextInput{constructor(e,t,i){super(e,i),this.menuGenerator_=t,this.selectedMenuItem=null,this.menu_=null,this.svgArrow=null,this.generatedOptions=null,this.menuItems=[],this.lastHighlightedMenuElement=null}initView(){super.initView(),this.createSVGArrow()}inputKeydownListener(e){"ArrowDown"===e.key&&(e.preventDefault(),this.menu_.focus(),this.selectedMenuItem?this.menu_.setHighlighted(this.selectedMenuItem):this.menu_.setHighlighted(this.menuItems[0]))}dropdownKeydownListener(e){var t=this.menu_.getElement().querySelector(".blocklyMenuItemHighlight");"ArrowUp"!==e.key||t!==this.lastHighlightedMenuElement&&this.lastHighlightedMenuElement||(e.preventDefault(),this.selectedMenuItem=null,this.menu_.setHighlighted(null),this.htmlInput_.focus()),this.lastHighlightedMenuElement=t}showEditor_(e,t){super.showEditor_(e,!0),this.dropDownOpen_||this.showDropdown_(),a.Touch.clearTouchIdentifier(),this.inputKeydownHandler=this.inputKeydownListener.bind(this),this.htmlInput_.addEventListener("keydown",this.inputKeydownHandler),t||this.htmlInput_.focus()}doValueUpdate_(e){1<(null==e?void 0:e.length)&&e.charAt(0)===e.charAt(e.length-1)&&("'"===e.charAt(0)||'"'===e.charAt(0))&&(e=e.slice(1,e.length-1)),super.doValueUpdate_(e)}getOptions(e){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");if(Array.isArray(this.menuGenerator_))return this.menuGenerator_;if(!e||!this.generatedOptions){var i=this.generatedOptions;if(!Array.isArray(i))throw TypeError("FieldDropdown options must be an array.");if(!i.length)throw TypeError("FieldDropdown options must not be an empty array.");let t=!1;for(let e=0;e<i.length;e++){var n=i[e];Array.isArray(n)?"string"!=typeof n[1]?(t=!0,pxt.error("Invalid option["+e+"]: Each FieldDropdown option id must be a string. Found "+n[1]+" in: ",n)):n[0]&&"string"!=typeof n[0]&&!(0,l.isImageProperties)(n[0])&&(t=!0,pxt.error("Invalid option["+e+"]: Each FieldDropdown option must have a string label or image description. Found"+n[0]+" in: ",n)):(t=!0,pxt.error("Invalid option["+e+"]: Each FieldDropdown option must be an array. Found: ",n))}if(t)throw TypeError("Found invalid FieldDropdown options.")}return this.generatedOptions}isOptionListDynamic(){return"function"==typeof this.menuGenerator_}getFieldDescription(){return this.getText()}dropdownDispose_(){a.WidgetDiv.getDiv().removeEventListener("keydown",this.inputKeydownHandler),this.menu_.getElement().removeEventListener("keydown",this.dropdownKeydownHandler),this.dropDownOpen_=!1,this.menu_&&this.menu_.dispose(),this.menu_=null,this.selectedMenuItem=null,this.menuItems=[],this.applyColour()}dropdownCreate(){var n=this.getSourceBlock();if(!n)throw new a.UnattachedFieldError;var o=new a.Menu,r=(o.setRole(a.utils.aria.Role.LISTBOX),this.menu_=o,this.getOptions(!1));this.selectedMenuItem=null;for(let i=0;i<r.length;i++){let[e,t]=r[i];var s=(s=void 0,l.isImageProperties)(e)?((s=new Image(e.width,e.height)).src=e.src,s.alt=e.alt,s):e,s=new a.MenuItem(s,t);s.setRole(a.utils.aria.Role.OPTION),s.setRightToLeft(n.RTL),s.setCheckable(!0),o.addChild(s),s.setChecked(t===this.value_),t===this.value_&&(this.selectedMenuItem=s),s.onAction(this.handleMenuActionEvent,this),this.menuItems.push(s)}}showDropdown_(e){var t=this.getSourceBlock();if(!t)throw new a.UnattachedFieldError;this.dropdownCreate(),e&&"number"==typeof e.clientX?this.menu_.openingCoords=new a.utils.Coordinate(e.clientX,e.clientY):this.menu_.openingCoords=null,(0,l.clearDropDownDiv)();var e=this.menu_.render(a.DropDownDiv.getContentDiv()),e=(a.utils.dom.addClass(e,"blocklyDropdownMenu"),t.getParent()),i=(e||t).getColour(),e=(e||t).style.colourTertiary;a.DropDownDiv.setColour(i,e),this.dropDownOpen_=!0,a.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this),void 0,!1),this.dropdownKeydownHandler=this.dropdownKeydownListener.bind(this),this.menu_.getElement().addEventListener("keydown",this.dropdownKeydownHandler),this.selectedMenuItem&&(this.menu_.setHighlighted(this.selectedMenuItem),a.utils.style.scrollIntoContainerView(this.selectedMenuItem.getElement(),a.DropDownDiv.getContentDiv(),!0)),this.applyColour()}updateSize_(e){super.updateSize_(e);var t,e=this.positionSVGArrow(this.size_.width,this.size_.height/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2);this.sourceBlock_.RTL&&this.textElement_&&(t=this.getConstants(),t=a.utils.dom.getFastTextWidth(this.textElement_,t.FIELD_TEXT_FONTSIZE,t.FIELD_TEXT_FONTWEIGHT,t.FIELD_TEXT_FONTFAMILY),this.positionTextElement_(-e,t)),this.size_.width+=e}positionSVGArrow(e,t){if(!this.svgArrow)return 0;var i,n,o,r=this.getSourceBlock();if(r)return i=!!this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,n=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,o=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE,r=r.RTL?i/2:e+n,this.svgArrow.setAttribute("transform","translate("+r+","+t+")"),o+n;throw new a.UnattachedFieldError}createSVGArrow(){this.svgArrow=a.utils.dom.createSvgElement("image",{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(a.utils.dom.XLINK_NS,"xlink:href",o.DROPDOWN_SVG_DATAURI)}handleMenuActionEvent(e){a.DropDownDiv.hideIfOwner(this,!0),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue()),a.WidgetDiv.hideIfOwner(this)}}(i.BaseFieldTextDropdown=n).DROPDOWN_SVG_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiM1NzVFNzUiLz48L3N2Zz4K";class o extends n{constructor(e,t,i){super(e,(e=>{if(e.values)return e.values.split(",").map(e=>[e,e]);if(e.data){let t;try{var i=JSON.parse(e.data);if(Array.isArray(i)&&i.length)if(r(i))t=i.map(e=>[e,e]);else{let e=!1;for(var n of i)if(!Array.isArray(n)||2!==n.length||!r(n)){e=!0;break}e||(t=i)}}catch(e){}if(t)return t;pxt.warn("Could not parse textdropdown data field")}return[]})(t),i),this.isFieldCustom_=!0}}function r(e){for(var t of e)if("string"!=typeof t)return;return 1}i.FieldTextDropdown=o},{"./field_utils":69,blockly:219}],56:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldTextInput=void 0;e=e("blockly");class n extends e.FieldTextInput{constructor(e,t,i){super(e,i),this.isFieldCustom_=!0}getFieldDescription(){return this.getValue()}}i.FieldTextInput=n},{blockly:219}],57:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldTilemap=void 0;e=e("./field_asset");class n extends e.FieldAssetEditor{getInitText(){return this.initText}getTileset(){var e;return null==(e=this.asset)?void 0:e.data.tileset}getAssetType(){return"tilemap"}createNewAsset(t=""){t=t&&t.replace(/&#96;/g,"`");var i=pxt.react.getTilemapProject(),n=pxt.lookupProjectAssetByTSReference(t,i);if(n)return n;if(null==(n=this.sourceBlock_)||!n.isInFlyout){var o,n=pxt.sprite.decodeTilemap(t,"typescript",i)||i.blankTilemap(this.params.tileWidth,this.params.initWidth,this.params.initHeight);let e;return(o=n)&&o.tilemap&&o.tilemap.width&&o.tilemap.height&&!(!o.layers||o.layers.width!==o.tilemap.width||o.layers.height!==o.tilemap.height||!o.tileset)?(this.initText=t,this.isGreyBlock=!1,[o]=i.createNewTilemapFromData(n),e=i.getTilemap(o)):t.trim()&&(this.isGreyBlock=!0,this.valueText=t),e}}onEditorClose(e){pxt.sprite.updateTilemapReferencesFromResult(pxt.react.getTilemapProject(),e)}getValueText(){return this.isGreyBlock?pxt.Util.htmlUnescape(this.valueText):this.asset?pxt.getTSReferenceForAsset(this.asset):this.initText?this.getInitText():this.valueText||""}parseFieldOptions(e){var t={initWidth:16,initHeight:16,disableResize:!1,tileWidth:16,lightMode:!1};if(e){if(t.lightMode=e.lightMode,e.filter&&(t.filter=e.filter),e.tileWidth)if("number"==typeof e.tileWidth)switch(e.tileWidth){case 4:t.tileWidth=4;break;case 8:t.tileWidth=8;break;case 16:t.tileWidth=16;break;case 32:t.tileWidth=32}else switch(e.tileWidth.trim().toLowerCase()){case"4":case"four":t.tileWidth=4;break;case"8":case"eight":t.tileWidth=8;break;case"16":case"sixteen":t.tileWidth=16;break;case"32":case"thirtytwo":t.tileWidth=32}t.initWidth=i(e.initWidth,t.initWidth),t.initHeight=i(e.initHeight,t.initHeight)}return t;function i(e,t){e=parseInt(e);return isNaN(e)?t:e}}}i.FieldTilemap=n},{"./field_asset":29}],58:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldTileset=void 0;var n=e("./field_images");let s=e("./field_utils");class a extends n.FieldImages{constructor(e,t,i){super(e,t,i),this.isFieldCustom_=!0,this.menuGenerator_=()=>{var e;return null!=(e=this.sourceBlock_)&&e.workspace&&(0,s.needsTilemapUpgrade)(null==(e=this.sourceBlock_)?void 0:e.workspace)?[o()]:a.getReferencedTiles(this.sourceBlock_.workspace)},this.assetChangeListener=()=>{this.doValueUpdate_(this.getValue()),this.forceRerender()},this.blocksInfo=t.blocksInfo}static getReferencedTiles(e){var t=pxt.react.getTilemapProject();if(t.revision()!==a.cachedRevision||e.id!=a.cachedWorkspaceId){a.cachedRevision=t.revision(),a.cachedWorkspaceId=e.id;var n,o=(0,s.getAllReferencedTiles)(e);for(n of[16,4,8,32]){var r=t.getProjectTiles(n,16===n);if(r)for(let t of r.tiles)o.find(e=>e.id===t.id)||o.push(t)}let i={};o.sort((e,t)=>e.id===t.id?0:e.bitmap.width!==t.bitmap.width?e.bitmap.width-t.bitmap.width:e.isProjectTile!==t.isProjectTile?e.isProjectTile?-1:1:(i[e.id]||(i[e.id]=c(e.id)))-(i[t.id]||(i[t.id]=c(t.id))));a.referencedTiles=o.map(e=>{return[{src:c((t=e).id)<=2?l(t.bitmap.width):(0,s.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(t.bitmap),32,!1),width:32,height:32,alt:u(e)},e.id,e];var t})}return a.referencedTiles}initView(){super.initView(),this.sourceBlock_&&this.sourceBlock_.isInFlyout&&this.setValue(this.getOptions()[0][1])}getValue(){var e=pxt.react.getTilemapProject();if(this.selectedOption_)return t=this.selectedOption_[2],(t=e.lookupAsset(t.type,t.id))?pxt.getTSReferenceForAsset(t):super.getValue();var t=super.getValue();if("string"==typeof t){if(-1!==t.indexOf(".")){e=e.lookupAsset("tile",t);if(e)return pxt.getTSReferenceForAsset(e)}if(-1===t.indexOf("`"))return`img\`${t}\``}return t}getText(){var e=this.getValue();return"string"==typeof e&&-1!==e.indexOf("`")?e:super.getText()}render_(){var e;this.value_&&this.selectedOption_&&this.selectedOption_[1]!==this.value_&&(e=pxt.react.getTilemapProject().resolveTile(this.value_),a.cachedRevision=-1,e)&&(this.selectedOption_=[{src:(0,s.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(e.bitmap),32,!1),width:32,height:32,alt:u(e)},this.value_,e]),super.render_()}doValueUpdate_(e){let t=!1;var i=this.getOptions(!0);if(e){var n,o=pxt.parseAssetTSReference(e);e=(e=o?o.name:e).trim();for(n of i)if(e===n[2].id||e===n[2].meta.displayName||e===pxt.getShortIDForAsset(n[2]))return this.selectedOption_=n,this.value_=this.getValue(),this.updateAssetListener(),super.doValueUpdate_(n[1]),void(t=!0);t||super.doValueUpdate_(e),this.selectedOption_=null,this.updateAssetListener()}}doClassValidation_(t){if(this.getOptions(!0).some(([,e])=>e===t))return t;if(t){var i=pxt.react.getTilemapProject(),n=/^\s*assets\s*\.\s*tile\s*`([^`]*)`\s*$/.exec(t);let e;if(e=n?i.lookupAssetByName("tile",n[1]):t.startsWith(pxt.sprite.TILE_NAMESPACE)?i.lookupAsset("tile",t.trim()):i.lookupAssetByName("tile",t.trim()))return this.localTile=e,pxt.getTSReferenceForAsset(e,!1)}return this.sourceBlock_&&pxt.warn(`Trying to set tile reference to nonexistent tile. Block type: ${this.sourceBlock_.type}, Field name: ${this.name}, Value: `+t),null}getOptions(e){var t;return"function"!=typeof this.menuGenerator_?(this.transparent=o(),t=[this.transparent],this.localTile&&t.push([{src:(0,s.bitmapToImageURI)(pxt.sprite.Bitmap.fromData(this.localTile.bitmap),32,!1),width:32,height:32,alt:u(this.localTile)},this.localTile.id,this.localTile]),t):this.menuGenerator_.call(this)}dispose(){super.dispose(),pxt.react.getTilemapProject().removeChangeListener("tile",this.assetChangeListener)}updateAssetListener(){var e=pxt.react.getTilemapProject();e.removeChangeListener("tile",this.assetChangeListener),this.selectedOption_&&e.addChangeListener(this.selectedOption_[2],this.assetChangeListener)}saveState(e){let t,i=this.localTile||(null==(t=this.selectedOption_)?void 0:t[2]);var n,o,r=pxt.react.getTilemapProject();return i||(n=this.getValue(),o=pxt.parseAssetTSReference(n),i=(i=o?r.lookupAssetByName("tile",o.name):i)||r.lookupAsset("tile",n)),null!=i&&i.isProjectTile?(0,s.getAssetSaveState)(i):super.saveState(e)}loadState(e){"string"==typeof e?super.loadState(e):(e=(0,s.loadAssetFromSaveState)(e),this.localTile=e,super.loadState(pxt.getTSReferenceForAsset(e)))}getFieldDescription(){return lf("tile")}}function o(){var e=pxt.react.getTilemapProject().getTransparency(16);return[{src:l(16),width:32,height:32,alt:pxt.U.lf("transparency")},e.id,e]}function l(i){var e=document.createElement("canvas"),n=e.getContext("2d");e.width=i,e.height=i,n.fillStyle="#aeaeae",n.fillRect(0,0,i,i),n.fillStyle="#dedede";for(let t=0;t<i;t+=4)for(let e=0;e<i;e+=4)t+e>>2&1&&n.fillRect(t,e,4,4);return e.toDataURL()}function c(e){switch(e){case"myTiles.transparency16":return 1;case"myTiles.transparency4":case"myTiles.transparency8":case"myTiles.transparency32":return 2;default:if(e.startsWith("myTiles.tile")){var t=parseInt(e.slice(12));if(!Number.isNaN(t))return t+2}return 9999999999}}function u(e){return e.meta.displayName||pxt.getShortIDForAsset(e)}i.FieldTileset=a},{"./field_images":39,"./field_utils":69}],59:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldToggle=i.BaseFieldToggle=void 0;let n=e("blockly"),l=e("../constants");class o extends n.FieldNumber{constructor(e,t,i,n,o){super(e,void 0,void 0,void 0,o),this.trueText=i,this.falseText=n,this.isFieldCustom_=!0,this.CURSOR="pointer",this.params=t,this.setValue(e),this.type_=t.type}initView(){if(this.fieldGroup_){this.clickTarget_=this.sourceBlock_.getSvgRoot(),!this.sourceBlock_.isShadow()&&this.sourceBlock_.inputList&&1<this.sourceBlock_.inputList.length&&(this.borderRect_=n.utils.dom.createSvgElement("rect",{rx:this.getConstants().CORNER_RADIUS,ry:this.getConstants().CORNER_RADIUS,x:0,y:0,width:this.size_.width,height:this.size_.height,fill:this.sourceBlock_.getColour(),stroke:this.sourceBlock_.getColourTertiary()},null),this.fieldGroup_.insertBefore(this.borderRect_,this.textElement_));var e=this.getSize();switch(this.checkElement_=n.utils.dom.createSvgElement("g",{class:"blocklyToggle "+(this.state_?"blocklyToggleOn":"blocklyToggleOff"),transform:`translate(8, ${e.height/2})`},this.fieldGroup_),this.getOutputShape()){case l.provider.SHAPES.HEXAGONAL:this.toggleThumb_=n.utils.dom.createSvgElement("polygon",{class:"blocklyToggleRect",points:"-7,-14 -21,0 -7,14 7,14 21,0 7,-14",cursor:"pointer"},this.checkElement_);break;case l.provider.SHAPES.ROUND:this.toggleThumb_=n.utils.dom.createSvgElement("rect",{class:"blocklyToggleCircle",x:-6,y:-14,height:28,width:28,rx:14,ry:14,cursor:"pointer"},this.checkElement_);break;case l.provider.SHAPES.SQUARE:this.toggleThumb_=n.utils.dom.createSvgElement("rect",{class:"blocklyToggleRect",x:-6,y:-14,height:28,width:28,rx:3,ry:3,cursor:"pointer"},this.checkElement_)}var t=this.sourceBlock_.RTL?-e.width/2:e.width/2;this.textElement_=n.utils.dom.createSvgElement("text",{class:"blocklyText",x:t,dy:"0.6ex",y:e.height/2},this.fieldGroup_),this.updateEditable(),this.switchToggle(this.state_),this.setValue(this.getValue()),this.markDirty()}}getDisplayText_(){return this.state_?this.getTrueText():this.getFalseText()}getTrueText(){return this.trueText}getFalseText(){return this.falseText}getFieldDescription(){return this.getDisplayText_()}updateSize_(){switch(this.getOutputShape()){case l.provider.SHAPES.ROUND:this.size_.width=2*this.getInnerWidth()-7;break;case l.provider.SHAPES.HEXAGONAL:this.size_.width=2*this.getInnerWidth()+8-Math.floor(this.getInnerWidth()/2);break;case l.provider.SHAPES.SQUARE:this.size_.width=9+2*this.getInnerWidth()}}getInnerWidth(){return 10*this.getMaxLength()}getMaxLength(){return Math.max(this.getTrueText().length,this.getFalseText().length)}getOutputShape(){return this.sourceBlock_.isShadow()?this.sourceBlock_.getOutputShape():l.provider.SHAPES.SQUARE}doClassValidation_(e){return"boolean"==typeof this.fromVal(e)?e:"false"}applyColour(){var e=this.sourceBlock_.getColourTertiary();this.borderRect_?this.borderRect_.setAttribute("stroke",e):this.sourceBlock_.pathObject.svgPath.setAttribute("fill",e)}getValue(){return this.toVal(this.state_)}doValueUpdate_(e){e=this.fromVal(e);this.state_!==e&&(this.sourceBlock_&&n.Events.isEnabled()&&n.Events.fire(new n.Events.BlockChange(this.sourceBlock_,"field",this.name,this.state_,e)),this.state_=e,this.switchToggle(this.state_),this.isDirty_=!0)}switchToggle(o){if(this.checkElement_){this.updateSize_();var r=this.getSize(),s=this.getInnerWidth(),a=(o?(pxt.BrowserUtils.addClass(this.checkElement_,"blocklyToggleOn"),pxt.BrowserUtils.removeClass(this.checkElement_,"blocklyToggleOff")):(pxt.BrowserUtils.removeClass(this.checkElement_,"blocklyToggleOn"),pxt.BrowserUtils.addClass(this.checkElement_,"blocklyToggleOff")),this.getOutputShape());let e=0,t=0,i=0,n=0;switch(a){case l.provider.SHAPES.HEXAGONAL:e=r.width/2,t=e/2,i=-t,n=t-s,this.toggleThumb_.setAttribute("points",`0,-14 -14,0 0,14 ${e},14 ${e+14},0 ${e},-14`);break;case l.provider.SHAPES.ROUND:case l.provider.SHAPES.SQUARE:e=5+s,t=e/2,this.toggleThumb_.setAttribute("width",""+e),this.toggleThumb_.setAttribute("x","-"+t),i=n=a==l.provider.SHAPES.SQUARE?2:-6}this.checkElement_.setAttribute("transform",`translate(${o?n+s+t:t+i}, ${r.height/2})`)}}render_(){if(this.visible_&&this.textElement_){for(;this.textElement_.firstChild;)this.textElement_.firstChild.remove();var e=document.createTextNode(this.getDisplayText_()),e=(this.textElement_.appendChild(e),pxt.BrowserUtils.addClass(this.textElement_,"blocklyToggleText"),this.updateSize_(),this.size_.width),t=this.state_?e+e/8:e/2;this.textElement_.setAttribute("x",""+(t-e/2))}this.borderRect_&&(this.borderRect_.setAttribute("width",""+this.size_.width),this.borderRect_.setAttribute("height",""+this.size_.height))}showEditor_(){var e=!this.state_;null!==e&&this.setValue(this.toVal(e))}toVal(e){return"number"==this.type_?String(e?"1":"0"):String(e?"true":"false")}fromVal(e){return"string"==typeof e?"1"==e||"TRUE"==e.toUpperCase():!!e}}i.BaseFieldToggle=o;class r extends o{constructor(e,t,i){super(e,t,lf("True"),lf("False"),i)}}i.FieldToggle=r},{"../constants":18,blockly:219}],60:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldToggleDownUp=void 0;e=e("./field_toggle");class n extends e.BaseFieldToggle{constructor(e,t,i){super(e,t,lf("DOWN"),lf("UP"),i)}}i.FieldToggleDownUp=n},{"./field_toggle":59}],61:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldToggleHighLow=void 0;e=e("./field_toggle");class n extends e.BaseFieldToggle{constructor(e,t,i){super(e,t,lf("HIGH"),lf("LOW"),i)}}i.FieldToggleHighLow=n},{"./field_toggle":59}],62:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldToggleOnOff=void 0;e=e("./field_toggle");class n extends e.BaseFieldToggle{constructor(e,t,i){super(e,t,lf("ON"),lf("OFF"),i)}}i.FieldToggleOnOff=n},{"./field_toggle":59}],63:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldToggleUpDown=void 0;e=e("./field_toggle");class n extends e.BaseFieldToggle{constructor(e,t,i){super(e,t,lf("UP"),lf("DOWN"),i)}}i.FieldToggleUpDown=n},{"./field_toggle":59}],64:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldToggleWinLose=void 0;e=e("./field_toggle");class n extends e.BaseFieldToggle{constructor(e,t,i){super(e,t,lf("WIN"),lf("LOSE"),i)}}i.FieldToggleWinLose=n},{"./field_toggle":59}],65:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldToggleYesNo=void 0;e=e("./field_toggle");class n extends e.BaseFieldToggle{constructor(e,t,i){super(e,t,lf("Yes"),lf("No"),i)}}i.FieldToggleYesNo=n},{"./field_toggle":59}],66:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldTsExpression=void 0;e=e("blockly");class n extends e.FieldTextInput{constructor(){super(...arguments),this.isFieldCustom_=!0,this.pythonMode=!1}updateEditable(){var e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(pxt.BrowserUtils.addClass(e,"blocklyEditableText"),pxt.BrowserUtils.removeClass(e,"blocklyGreyExpressionBlockText")):(pxt.BrowserUtils.addClass(e,"blocklyGreyExpressionBlockText"),pxt.BrowserUtils.removeClass(e,"blocklyEditableText")))}setPythonEnabled(e){e!==this.pythonMode&&(this.pythonMode=e,this.forceRerender())}getText(){return this.pythonMode?pxt.Util.lf("<python code>"):this.getValue()}getFieldDescription(){return this.pythonMode?pxt.Util.lf("<python code>"):pxt.Util.lf("<typescript code>")}applyColour(){var e;this.sourceBlock_&&null!=(e=this.getConstants())&&e.FULL_BLOCK_FIELDS&&this.borderRect_&&(this.borderRect_.setAttribute("stroke",this.sourceBlock_.style.colourPrimary),this.borderRect_.setAttribute("fill",this.sourceBlock_.style.colourPrimary))}}i.FieldTsExpression=n},{blockly:219}],67:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldTurnRatio=void 0;let o=e("blockly");e=e("../plugins/math");class u extends e.FieldSlider{constructor(e,t,i){super(String(e),"-200","200","1","10","TurnRatio",i),this.isFieldCustom_=!0,this.params=t,this.sliderColor_="#a8aaa8"}createLabelDom_(e){var t=document.createElement("div"),i=o.utils.dom.createSvgElement("svg",{xmlns:"http://www.w3.org/2000/svg","xmlns:html":"http://www.w3.org/1999/xhtml","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1",height:u.HALF+u.HANDLE_RADIUS+10+"px",width:2*u.HALF+"px"},t),n=o.utils.dom.createSvgElement("defs",{},i),n=o.utils.dom.createSvgElement("marker",{id:"head",orient:"auto",markerWidth:"2",markerHeight:"4",refX:"0.1",refY:"1.5"},n),n=(o.utils.dom.createSvgElement("path",{d:"M0,0 V3 L1.5,1.5 Z",fill:"#f12a21"},n),this.reporter_=pxsim.svg.child(i,"text",{x:u.HALF,y:96,"text-anchor":"middle","dominant-baseline":"middle",style:"font-size: 50px",class:"sim-text inverted number"}),this.path_=o.utils.dom.createSvgElement("path",{x1:u.HALF,y1:u.HALF,"marker-end":"url(#head)",style:"fill: none; stroke: #f12a21; stroke-width: 10"},i),this.updateGraph_(),document.createElement("span"));return n.setAttribute("class","blocklyFieldSliderReadout"),[t,n]}updateGraph_(){if(this.path_){var t=Math.min(Math.max(Number(this.getValue())||0,-200),200),i=t/100,n=Math.max(-1,Math.min(1,i)),o=Math.max(n)*Math.PI/2,r=u.RADIUS-6;let e=u.HALF;var s=u.HALF-22,i=(1<Math.abs(i)&&(e-=(i-(0<i?1:-1))*r/2),.2+.5*Math.abs(n)),n=r*i,a=r*Math.sin(Math.PI/2-o),l=r*Math.cos(Math.PI/2-o),c=a-r*i*Math.cos(2*o),r=l-r*i*Math.sin(2*o),i=`M ${e} ${s} C ${e} ${s-n} ${e+r} ${s-c} ${e+l} `+(s-a);this.path_.setAttribute("d",i),this.reporter_.textContent=""+t}}setReadout(e){this.updateGraph_()}}(i.FieldTurnRatio=u).HALF=80,u.HANDLE_RADIUS=30,u.RADIUS=u.HALF-u.HANDLE_RADIUS-1},{"../plugins/math":119,blockly:219}],68:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.getNextValue=i.FieldUserEnum=void 0;let u=e("blockly"),n=e("../external");e=e("./field_dropdown");class o extends e.FieldDropdown{constructor(e){var t;super((t=e,function(){let i=[];return this.sourceBlock_&&this.sourceBlock_.workspace?this.sourceBlock_.workspace.getVariableMap().getVariablesOfType(t.name).forEach(e=>{var t=e.getName().replace(/^\d+/,"");i.push([t,e.getName()])}):t.initialMembers.forEach(e=>i.push([e,e])),i.push([lf("Add a new {0}...",t.memberName),"CREATE"]),i})),this.opts=e}init(){super.init(),this.initVariables()}onItemSelected_(e,t){"CREATE"===t.getValue()?function r(s,a,l,c){(0,n.prompt)(l,null,o=>{if(o){let t=!1;if(pxtc.isIdentifierStart(o.charCodeAt(0),2)){t=!0;for(let e=1;e<o.length;e++)pxtc.isIdentifierPart(o.charCodeAt(e),2)||(t=!1)}if(t){let n=d(s,a.name);for(let i=0;i<n.length;i++){let[e,t]=n[i];if(e===o)return void u.dialog.alert(lf("A {0} named '{1}' already exists.",a.memberName,o),()=>r(s,a,l,c))}c(h(s,a,o))}else u.dialog.alert(lf("Names must start with a letter and can only contain letters, numbers, '$', and '_'."),()=>r(s,a,l,c))}},{placeholder:a.promptHint})}(this.sourceBlock_.workspace,this.opts,lf("New {0}:",this.opts.memberName),e=>e&&this.setValue(e)):super.onItemSelected_(e,t)}doClassValidation_(t){var e;return null!=(e=this.opts)&&e.initialMembers&&!this.opts.initialMembers.find(e=>e==t)&&this.getOptions(),super.doClassValidation_(t)}initVariables(){if(this.sourceBlock_&&this.sourceBlock_.workspace){let e=this.sourceBlock_.workspace,i=d(e,this.opts.name);var t;this.opts.initialMembers.forEach(t=>{i.some(([e])=>e===t)||h(e,this.opts,t)}),"CREATE"===this.getValue()&&(t=((e,t,i)=>{var n=e.getVariableMap().getVariablesOfType(t);if(n&&n.length)for(let e=0;e<n.length;e++){var[o]=r(n[e]);if(o===i)return n[e].getName()}})(e,this.opts.name,this.opts.initialMembers[0]))&&this.setValue(t)}}}function r(e){var t=/^(\d+)([^0-9].*)$/.exec(e.getName());return t?[t[2],parseInt(t[1])]:[e.getName(),-1]}function d(e,t){e=e.getVariableMap().getVariablesOfType(t);return e&&e.length?e.map(r):[]}function s(e,t){var i=e.map(([,e])=>e);if(t.isBitMask){for(let e=0;e<i.length;e++){var n=1<<e;if(i.indexOf(n)<0)return n}return 1<<i.length}if(t.isHash)return 0;var o=t.firstValue||0;for(let e=0;e<i.length;e++)if(i.indexOf(o+e)<0)return o+e;return o+i.length}function h(e,t,i){i=s(d(e,t.name),t)+i;return u.Variables.getOrCreateVariablePackage(e,null,i,t.name),i}i.FieldUserEnum=o,i.getNextValue=s},{"../external":25,"./field_dropdown":34,blockly:219}],69:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.isImageProperties=i.clearDropDownDiv=i.deleteBlockDataForField=i.getBlockDataForField=i.setBlockDataForField=i.setBlockData=i.getBlockData=i.workspaceToScreenCoordinates=i.setMelodyEditorOpen=i.FieldEditorOpenEvent=i.FIELD_EDITOR_OPEN_EVENT_TYPE=i.loadAssetFromSaveState=i.getAssetSaveState=i.getTemporaryAssets=i.getTilesReferencedByTilesets=i.getAllReferencedTiles=i.getAllFields=i.updateTilemapXml=i.needsTilemapUpgrade=i.getAllBlocksWithTilesets=i.getAllBlocksWithTilemaps=i.songToDataURI=i.tilemapToImageURI=i.bitmapToImageURI=i.parseColour=i.svg=void 0;let n=e("blockly"),o=e("./field_tilemap"),r=e("./field_animation"),s=e("./field_musiceditor"),a=e("./field_sprite"),l=e("./field_tileset"),c;function p(e){return u(e,e=>e instanceof o.FieldTilemap&&!e.isGreyBlock)}function g(e){return u(e,e=>e instanceof l.FieldTileset)}function u(e,o){let r=[];return e.getTopBlocks(!1).forEach(e=>function e(t){for(var i of t.inputList){for(var n of i.fieldRow)o(n)&&r.push({block:t,field:n.name,ref:n});i.connection&&i.connection.targetBlock()&&e(i.connection.targetBlock())}t.nextConnection&&t.nextConnection.targetBlock()&&e(t.nextConnection.targetBlock())}(e)),r}(e=c=i.svg||(i.svg={})).hasClass=function(e,t){return pxt.BrowserUtils.containsClass(e,t)},e.addClass=function(e,t){pxt.BrowserUtils.addClass(e,t)},e.removeClass=function(e,t){pxt.BrowserUtils.removeClass(e,t)},i.parseColour=function(e){var t=Number(e);return isNaN(t)?"string"==typeof e&&e.match(/^#[0-9a-fA-F]{6}$/)?e:"#000":n.utils.colour.hueToHex(t)},i.bitmapToImageURI=function(i,e,n){var o=pxt.appTarget.runtime.palette.slice(1),t=document.createElement("canvas"),r=(t.width=e,t.height=e,Math.min(e/i.width,e/i.height)),s=Math.max(Math.floor(e*(1-i.width/i.height)/2),0),a=Math.max(Math.floor(e*(1-i.height/i.width)/2),0);let l;n?((l=t.getContext("2d",{alpha:!1})).fillStyle="#dedede",l.fillRect(0,0,e,e)):l=t.getContext("2d");for(let t=0;t<i.width;t++)for(let e=0;e<i.height;e++){var c=i.get(t,e);c?(l.fillStyle=o[c-1],l.fillRect(s+t*r,a+e*r,r,r)):n&&(l.fillStyle="#dedede",l.fillRect(s+t*r,a+e*r,r,r))}return t.toDataURL()},i.tilemapToImageURI=function(i,e,n){var o=pxt.appTarget.runtime.palette.slice(),t=document.createElement("canvas"),r=(t.width=e,t.height=e,Math.min(e/i.tilemap.width,e/i.tilemap.height)),s=Math.max(Math.floor(e*(1-i.tilemap.width/i.tilemap.height)/2),0),a=Math.max(Math.floor(e*(1-i.tilemap.height/i.tilemap.width)/2),0);let l;n?((l=t.getContext("2d",{alpha:!1})).fillStyle="#dedede",l.fillRect(0,0,e,e)):l=t.getContext("2d");var c=[];for(let t=0;t<i.tilemap.width;t++)for(let e=0;e<i.tilemap.height;e++){var u,d=i.tilemap.get(t,e);d?(c[d]||(u=i.tileset.tiles[d],c[d]=u?pxt.sprite.computeAverageColor(pxt.sprite.Bitmap.fromData(u.bitmap),o):"#dedede"),l.fillStyle=c[d],l.fillRect(s+t*r,a+e*r,r,r)):n&&(l.fillStyle="#dedede",l.fillRect(s+t*r,a+e*r,r,r))}return t.toDataURL()},i.songToDataURI=function(e,t,i,n,o){var r=pxt.appTarget.runtime.palette.slice(),s=document.createElement("canvas");s.width=t,s.height=i;let a;n?((a=s.getContext("2d",{alpha:!1})).fillStyle="#dedede",a.fillRect(0,0,t,i)):a=s.getContext("2d");var l,c=[5,11,5,4,2,6,14,2,5,1],u=(o=o||e.measures,Math.max(Math.floor(t/(e.beatsPerMeasure*o*2)),1)),d=Math.floor(t/u),h=Math.max(Math.floor(i/12),1),p=Math.floor(i/h);for(l of e.tracks)for(var g of l.notes){var f,m=Math.floor(g.startTick/(e.ticksPerBeat/2));if(d<m)break;for(f of g.notes){var b=12-f.note%12;p<b||(a.fillStyle=r[c[l.id||e.tracks.indexOf(l)]],a.fillRect(m*u,b*h,u,h))}}return s.toDataURL()},i.getAllBlocksWithTilemaps=p,i.getAllBlocksWithTilesets=g,i.needsTilemapUpgrade=function(e){return!!e.getVariableMap().getVariablesOfType(pxt.sprite.BLOCKLY_TILESET_TYPE).map(e=>pxt.sprite.legacy.blocklyVariableToTile(e.getName())).length},i.updateTilemapXml=function(e,n){let t=!1,o={};for(var i of e.children)if("variables"===i.tagName.toLowerCase()){var r,s,a,l,c=[];for(r of i.children)r.getAttribute("type")===pxt.sprite.BLOCKLY_TILESET_TYPE&&(t=!0,a=r.textContent,(a=pxt.sprite.legacy.blocklyVariableToTile(a)).qualifiedName||(s="myTiles.tile"+a.projectId,a=n.createNewTile(a.data,s),o[s]=a),c.push(r));for(l of c)l.remove()}if(t)for(var u of e.getElementsByTagName("field")){var d=u.textContent,h=d.trim();if(o[h])u.textContent=pxt.getTSReferenceForAsset(o[h]);else if(h.startsWith("tiles.createTilemap(")){h=pxt.sprite.legacy.decodeTilemap(d,"typescript");let i=[];var d=new pxt.sprite.TilemapData(h.tilemap,{tileWidth:h.tileset.tileWidth,tiles:h.tileset.tiles.map((e,t)=>null!=e.projectId?o["myTiles.tile"+e.projectId]:(i[t]||(i[t]=n.resolveTile(e.qualifiedName)),i[t]))},h.layers),[h]=n.createNewTilemapFromData(d),d=n.lookupAsset("tilemap",h);u.textContent=pxt.getTSReferenceForAsset(d)}}},i.getAllFields=u,i.getAllReferencedTiles=function(e,t){let i,n={};var o,r,s,a=p(e),l=pxt.react.getTilemapProject();for(o of a)if(o.block.id!==t)for(var c of(null==(i=o.ref.getTileset())?void 0:i.tiles)||[])n[c.id]=l.lookupAsset("tile",c.id);for(r of l.getAssets("tilemap"))for(var u of r.data.tileset.tiles)n[u.id]=l.lookupAsset("tile",u.id);for(s of g(e)){var d=s.ref.getValue(),h=/^\s*assets\s*\.\s*tile\s*`([^`]*)`\s*$/.exec(d);h?(h=l.lookupAssetByName("tile",h[1]))&&!n[h.id]&&(n[h.id]=h):n[d]||(n[d]=l.resolveTile(d))}return Object.keys(n).map(e=>n[e]).filter(e=>!!e)},i.getTilesReferencedByTilesets=function(e){let t={};var i,n=pxt.react.getTilemapProject();for(i of g(e)){var o=i.ref.getValue(),r=/^\s*assets\s*\.\s*tile\s*`([^`]*)`\s*$/.exec(o);r?(r=n.lookupAssetByName("tile",r[1]))&&!t[r.id]&&(t[r.id]=r):t[o]||(t[o]=n.resolveTile(o))}return Object.keys(t).map(e=>t[e]).filter(e=>!!e)},i.getTemporaryAssets=function(e,t){switch(t){case"image":return u(e,e=>e instanceof a.FieldSpriteEditor&&e.isTemporaryAsset()).map(e=>e.ref.getAsset());case"animation":return u(e,e=>e instanceof r.FieldAnimationEditor&&e.isTemporaryAsset()).map(e=>e.ref.getAsset());case"song":return u(e,e=>e instanceof s.FieldMusicEditor&&e.isTemporaryAsset()).map(e=>e.ref.getAsset());default:return[]}},i.getAssetSaveState=function(e){var t={version:1,assetType:e.type,assetId:e.id,jres:{}},i=pxt.react.getTilemapProject();if("tilemap"===e.type){var n,o=i.getProjectTilesetJRes();for(n of Object.keys(o))if("*"!==n){var r=o[n];if(r.mimeType===pxt.TILEMAP_MIME_TYPE)r.id!==e.id&&delete o[n];else{let t=m(o["*"].namespace)+n;e.data.tileset.tiles.some(e=>e.id===t)||delete o[n]}}t.jres=o}else{var i="tile"===e.type?i.getProjectTilesetJRes():i.getProjectAssetsJRes(),[i,s]=(t.jres["*"]=i["*"],b(i,e.id));t.jres[i]=s}return t},i.loadAssetFromSaveState=function(e){let t=e.assetId;e.jres=(e=>{var t,i,n=e["*"],o={"*":n};for(t of Object.keys(e))"*"!==t&&(i=e[t],o[t]="string"==typeof i?{id:void 0,data:i,mimeType:n.mimeType}:i);return o})(e.jres);var i=pxt.react.getTilemapProject();if(r=i.lookupAsset(e.assetType,e.assetId)){var n=new pxt.TilemapProject,n=(n.loadGallerySnapshot(i.saveGallerySnapshot()),"tilemap"===e.assetType||"tile"===e.assetType?n.loadTilemapJRes(e.jres):n.loadAssetsJRes(e.jres),n.lookupAsset(e.assetType,e.assetId));if(pxt.assetEquals(n,r,!0))return r;r=i.lookupAssetByValue(n.type,n);if(r)return r;t=i.generateNewID(e.assetType);var o,[n,r]=b(e.jres,e.assetId);delete e.jres[n],"tilemap"===e.assetType?(r.id=t,e.jres[t]=r):([n,o]=t.split("."),m(n)!==m(e.jres["*"].namespace)&&(r.namespace=m(n)),r.id=t,e.jres[o]=r)}return"tilemap"===e.assetType||"tile"===e.assetType?i.loadTilemapJRes(e.jres,!0):i.loadAssetsJRes(e.jres),i.lookupAsset(e.assetType,t)},i.FIELD_EDITOR_OPEN_EVENT_TYPE="field_editor_open";class d extends n.Events.UiBase{constructor(e,t){super(e.workspace.id),this.type=i.FIELD_EDITOR_OPEN_EVENT_TYPE,this.blockId=e.id,this.isOpen=t}}function h(e){return e.data?/^(?:\d+;?)+$/.test(e.data)?{commentRefs:e.data.split(";"),fieldData:{}}:JSON.parse(e.data):{commentRefs:[],fieldData:{}}}function f(e,t){e.data=JSON.stringify(t)}function m(e){return e.endsWith(".")?e:e+"."}function b(t,i){var n,o=t["*"].namespace;for(n of Object.keys(t))if("*"!==n){var r=t[n];let e;if((e=r.id?r.namespace?m(r.namespace)+r.id:r.id:r.namespace?m(r.namespace)+n:m(o)+n)===i)return[n,t[n]]}}i.FieldEditorOpenEvent=d,i.setMelodyEditorOpen=function(e,t){n.Events.fire(new d(e,t))},i.workspaceToScreenCoordinates=function(e,t){var t=t.scale(e.scale),i=e.getOriginOffsetInPixels(),t=n.utils.Coordinate.sum(t,i),i=e.getInjectionDiv().getBoundingClientRect();return new n.utils.Coordinate(t.x+i.left,t.y+i.top)},i.getBlockData=h,i.setBlockData=f,i.setBlockDataForField=function(e,t,i){var n=h(e);n.fieldData[t]=i,f(e,n)},i.getBlockDataForField=function(e,t){return h(e).fieldData[t]},i.deleteBlockDataForField=function(e,t){var i=h(e);delete i.fieldData[t],f(e,i)},i.clearDropDownDiv=function(){n.DropDownDiv.clearContent(),n.DropDownDiv.getContentDiv().style.height=""},i.isImageProperties=function(e){return e&&"object"==typeof e&&"src"in e&&"string"==typeof e.src&&"alt"in e&&"string"==typeof e.alt&&"width"in e&&"number"==typeof e.width&&"height"in e&&"number"==typeof e.height}},{"./field_animation":27,"./field_musiceditor":44,"./field_sprite":53,"./field_tilemap":57,"./field_tileset":58,blockly:219}],70:[function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,o)}:function(e,t,i,n){e[n=void 0===n?i:n]=t[i]}),o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),o(e("./field_utils"),i),o(e("./fieldEditorRegistry"),i),o(e("./field_animation"),i),o(e("./field_argumentvariable"),i),o(e("./field_kind"),i),o(e("./field_asset"),i),o(e("./field_ledmatrix"),i),o(e("./field_styledlabel"),i),o(e("./field_base"),i),o(e("./field_tsexpression"),i),o(e("./field_textinput"),i),o(e("./field_tilemap"),i),o(e("./field_userenum"),i),o(e("./field_procedure"),i),o(e("./field_sprite"),i),o(e("./field_imagedropdown"),i),o(e("./field_protractor"),i),o(e("./field_toggle_highlow"),i),o(e("./field_images"),i),o(e("./field_sound_effect"),i),o(e("./field_toggle_onoff"),i),o(e("./field_speed"),i),o(e("./field_toggle_updown"),i),o(e("./field_toggle_winlose"),i),o(e("./field_autocomplete"),i),o(e("./field_melodySandbox"),i),o(e("./field_toggle_yesno"),i),o(e("./field_musiceditor"),i),o(e("./field_textdropdown"),i),o(e("./field_note"),i),o(e("./field_turnratio"),i),o(e("./field_colorwheel"),i),o(e("./field_numberdropdown"),i),o(e("./field_colour"),i),o(e("./field_position"),i),o(e("./field_tileset"),i),o(e("./field_gridpicker"),i),o(e("./field_toggle"),i)},{"./fieldEditorRegistry":26,"./field_animation":27,"./field_argumentvariable":28,"./field_asset":29,"./field_autocomplete":30,"./field_base":31,"./field_colorwheel":32,"./field_colour":33,"./field_gridpicker":36,"./field_imagedropdown":37,"./field_images":39,"./field_kind":40,"./field_ledmatrix":41,"./field_melodySandbox":43,"./field_musiceditor":44,"./field_note":45,"./field_numberdropdown":46,"./field_position":47,"./field_procedure":48,"./field_protractor":49,"./field_sound_effect":51,"./field_speed":52,"./field_sprite":53,"./field_styledlabel":54,"./field_textdropdown":55,"./field_textinput":56,"./field_tilemap":57,"./field_tileset":58,"./field_toggle":59,"./field_toggle_highlow":61,"./field_toggle_onoff":62,"./field_toggle_updown":63,"./field_toggle_winlose":64,"./field_toggle_yesno":65,"./field_tsexpression":66,"./field_turnratio":67,"./field_userenum":68,"./field_utils":69}],71:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.getBlockText=void 0;let s=e("blockly");i.getBlockText=function e(t){var i,n,o=[];for(i of t.inputList)if(i.isVisible()){if(0<i.fieldRow.length)for(var r of i.fieldRow)r.isVisible()&&(r=r.getFieldDescription?r.getFieldDescription():r.getText())&&o.push(r);i.connection&&i.connection.targetBlock()&&i.connection.type===s.INPUT_VALUE&&(n=e(i.connection.targetBlock()))&&o.push(`[${n}]`)}return o.join(" ")}},{blockly:219}],72:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.attachCardInfo=i.mkCard=i.installHelpResources=i.setHelpResources=i.installBuiltinHelpInfo=i.setBuiltinHelpInfo=void 0;let c=e("blockly"),u=e("./xml"),d=e("./external"),n=e("./toolbox"),h=e("./plugins/duplicateOnDrag");function p(i,n,e,t,o,r,s,a,l){!t||"string"!=typeof t&&"function"!=typeof t||i.setTooltip(t),o&&i.setHelpUrl(o),r&&i.setColour(r),l&&i.setDeletable(!1),(0,h.setDuplicateOnDragStrategy)(i);r=document.getElementById("blocklyToolboxDefinition"),l=r?(0,u.getFirstChildWithAttr)(r,"block","type",n):void 0;i.codeCard={header:e,name:e,software:1,description:"function"==typeof t?t(i):t,blocksXml:l?'<xml xmlns="http://www.w3.org/1999/xhtml">'+((0,u.cleanOuterHTML)(l)||`<block type="${n}"></block>`)+"</xml>":void 0,url:o},pxt.Util.isTranslationMode()&&(i.customContextMenu=e=>{let t=pxt.blocks.getBlockDefinition(i.type);t&&t.translationIds&&e.push({enabled:!0,text:lf("Translate this block"),callback:function(){(0,d.promptTranslateBlock)(n,t.translationIds)}})})}function o(e,t,i,n,o,r,s){var a=c.Blocks[e];let l=a.init;l&&(a.init=function(){l.call(this),p(this,e,t,i,n,o)})}function r(e,t){return{name:e.namespace+"."+e.name,shortName:e.name,description:e.attributes.jsDoc,url:e.attributes.help?"reference/"+e.attributes.help.replace(/^\//,""):void 0,blocksXml:`<xml xmlns="http://www.w3.org/1999/xhtml">${(0,u.cleanOuterHTML)(t)}</xml>`}}i.setBuiltinHelpInfo=function(e,t){var i=pxt.blocks.getBlockDefinition(t);p(e,t,i.name,i.tooltip,i.url,pxt.toolbox.getNamespaceColor(i.category))},i.installBuiltinHelpInfo=function(e){var t=pxt.blocks.getBlockDefinition(e);o(e,t.name,t.tooltip,t.url,pxt.toolbox.getNamespaceColor(t.category))},i.setHelpResources=p,i.installHelpResources=o,i.mkCard=r,i.attachCardInfo=function(e,t){var i;if(t=e.apis.byQName[t])return i=pxt.blocks.compileInfo(t),r(t,(0,n.createToolboxBlock)(e,t,i))}},{"./external":25,"./plugins/duplicateOnDrag":91,"./toolbox":139,"./xml":141,blockly:219}],73:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.validateAllReferencedBlocksExist=i.patchShadows=i.patchCommentIds=i.importXml=i.loadWorkspaceXml=i.loadBlocksXml=i.getFirstChildWithAttr=i.getChildrenWithAttr=i.getBlocksWithType=i.getDirectChildren=i.saveBlocksXml=i.workspaceToDom=i.saveWorkspaceXml=i.clearWithoutEvents=i.domToWorkspaceNoEvents=void 0;let m=e("blockly"),b=e("./loader"),_=e("./external"),a=e("./fields");function o(e,t,i){pxt.tickEvent("blocks.domtow");let n=[];k(e),C(e,!1),pxt.react.getTilemapProject&&(0,a.updateTilemapXml)(e,pxt.react.getTilemapProject());try{m.Events.disable(),n=m.Xml.domToWorkspace(e,t),a.FieldBase.flushInitQueue();for(var o of t.getAllBlocks())o.afterWorkspaceLoad&&o.afterWorkspaceLoad.call(o);s=i,(r=t).getAllBlocks(!1).filter(e=>!!e.getCommentText()).forEach(t=>{var i,n=t.getCommentText();if(/@hide/.test(n)&&null!=s&&s.applyHideMetaComment)t.dispose(!0);else{let e=n;/@highlight/.test(e)&&(e=e.replace(/@highlight/g,"").trim(),null!=(i=r.highlightBlock))&&i.call(r,t.id,!0),/@collapsed/.test(e)&&!t.getParent()&&(e=e.replace(/@collapsed/g,"").trim(),t.setCollapsed(!0)),n===(e=e.replace(/@validate-\S+/g,"").trim())||null!=s&&s.keepMetaComments||t.setCommentText(e||null)}})}catch(e){pxt.reportException(e)}finally{m.Events.enable()}var r,s;return n.filter(e=>!!t.getBlockById(e))}function n(e,t){var i,t=m.Xml.workspaceToDom(e,t),e=m.Xml.variablesToDom(e.getVariableMap().getAllVariables());for(i of y(t,"variables"))i.remove();return r(t.getElementsByTagName("block")),r(t.getElementsByTagName("shadow")),r(t.getElementsByTagName("comment")),t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e),t}function r(t){for(let e=0;e<t.length;e++){var i=t.item(e);i.hasAttribute("editable")&&i.removeAttribute("editable"),i.hasAttribute("movable")&&i.removeAttribute("movable")}}function y(t,i){var n=[];for(let e=0;e<t.childNodes.length;e++){var o=t.childNodes.item(e);o.tagName===i&&n.push(o)}return n}function v(e,t){return T(e,"block","type",t).concat(T(e,"shadow","type",t))}function T(e,t,i,n){return pxt.Util.toArray(e.getElementsByTagName(t)).filter(e=>e.getAttribute(i)===n)}function E(e,t,i,n){e=T(e,t,i,n);return e.length?e[0]:void 0}function k(e){var t,i;for(t of y(e,"comment"))t.hasAttribute("id")||t.setAttribute("id",m.utils.idGenerator.genUid());for(i of e.querySelectorAll("comment:not([h])"))i.setAttribute("h","80"),i.setAttribute("w","160")}function s(e){var t;if(2!==e.parentElement.childElementCount)return t=l(e),e.parentElement.appendChild(t),e.remove(),t;e.remove()}function l(e){var t,i,n=m.utils.xml.createElement("block");for(t of e.getAttributeNames())n.setAttribute(t,e.getAttribute(t));for(i of e.childNodes)n.appendChild(i.cloneNode(!0));return n}function C(t,e){if("shadow"===t.tagName)if("xml"===(null==(i=t.parentElement)?void 0:i.tagName)){pxt.warn(`Shadow block of type '${t.getAttribute("type")}' found at top level. Converting to non-shadow block`),pxt.tickEvent("blocks.import.topLevelShadow",{blockId:t.getAttribute("type")});var i=l(t),i=(t.parentElement.insertBefore(i,t),t.remove(),y(t=i,"mutation")[0]);null!=i&&i.hasAttribute("dupliacteondrag")&&i.removeAttribute("dupliacteondrag")}else{i=t.getAttribute("type");let e=!1;switch(i){case"variables_get_reporter":case"argument_reporter_boolean":case"argument_reporter_number":case"argument_reporter_string":case"argument_reporter_array":case"argument_reporter_custom":e=!0}if(e){if(!(t=s(t)))return;let e=y(t,"mutation")[0];e?e.setAttribute("duplicateondrag","true"):((e=m.utils.xml.createElement("mutation")).setAttribute("duplicateondrag","true"),t.appendChild(e))}else"variables_get"!==i&&!function e(t){for(var i of t.children)if("block"===i.tagName.toLowerCase()||e(i))return!0;return!1}(t)||(t=s(t))}if(t)for(var n of t.children)C(n,e||"shadow"===t.tagName)}i.domToWorkspaceNoEvents=o,i.clearWithoutEvents=function(e){if(pxt.tickEvent("blocks.clear"),e)try{m.Events.disable(),e.clear(),e.clearUndo()}finally{m.Events.enable()}},i.saveWorkspaceXml=function(e,t){return e=n(e,!t),m.Xml.domToText(e)},i.workspaceToDom=n,i.saveBlocksXml=function(e,t){return e.getTopBlocks(!1).map(e=>m.Xml.domToText(m.Xml.blockToDom(e,!t)))},i.getDirectChildren=y,i.getBlocksWithType=v,i.getChildrenWithAttr=T,i.getFirstChildWithAttr=E,i.loadBlocksXml=function(e,t){var i,t=m.utils.xml.textToDom(t),t=m.Xml.domToBlock(t,e);e.getMetrics&&(e=e.getMetrics(),i=t.getHeightWidth(),t.moveBy(e.viewLeft+e.viewWidth/2-i.width/2,e.viewTop+e.viewHeight/2-i.height/2))},i.loadWorkspaceXml=function(e,t=!1,i){var n=new m.Workspace;try{return o(m.utils.xml.textToDom(e),n,i),n}catch(e){return t||pxt.reportException(e),null}},i.importXml=function(e,i,o,t=!1){try{(0,b.initializeAndInject)(o);let n=(new DOMParser).parseFromString(i,"application/xml");var r=pxt.patching.computePatches(e),s=(r&&(r.filter(e=>"blockId"==e.type).forEach(i=>Object.keys(i.map).forEach(t=>{v(n,t).forEach(e=>{e.setAttribute("type",i.map[t]),pxt.debug(`patched block ${t} -> `+i.map[t])})})),r.filter(e=>"blockValue"==e.type).forEach(i=>Object.keys(i.map).forEach(t=>{var e=t.split("."),e=e[0];v(n,e).reduce((e,t)=>e.concat(y(t,"value")),[]).forEach(e=>{e.setAttribute("name",i.map[t]),pxt.debug(`patched block value ${t} -> `+i.map[t])})})),r.filter(e=>"userenum"==e.type).forEach(i=>Object.keys(i.map).forEach(t=>{T(n,"variable","type",t).forEach(e=>{e.setAttribute("type",i.map[t]),pxt.debug(`patched enum variable type ${t} -> `+i.map[t])})}))),y(n.children.item(0),"shadow"));for(let i of s){let t=n.createElement("block");i.getAttributeNames().forEach(e=>t.setAttribute(e,i.getAttribute(e)));for(let e=0;e<i.childNodes.length;e++)t.appendChild(i.childNodes.item(e));i.replaceWith(t)}C(n.documentElement,!1),k(n.documentElement);let t={};Object.keys(o.apis.byQName).forEach(e=>{e=o.apis.byQName[e];7==e.kind&&(t[e.namespace+"."+(e.attributes.blockImportId||e.attributes.block||e.attributes.blockId||e.name)]=e.namespace+"."+e.name)});var a=n.getElementsByTagName("block");for(let e=0;e<a.length;++e)((o,r,s)=>{let e,t=s.getAttribute("type"),i=m.Blocks[t],a=(0,b.blockSymbol)(t);if(a&&i){let n=pxt.blocks.compileInfo(a);null!=(e=a.parameters)&&e.forEach((e,t)=>{var i=o.apis.byQName[e.type];i&&6==i.kind&&(e=E(s,"field","name",n.actualNameToParam[e.name].definitionName))&&(i=r[i.name+"."+e.textContent])&&(e.textContent=i)})}})(o,t,a[e]);{var l=n.documentElement;var c=o;var u=v(l,ts.pxtc.ON_START_TYPE);let i=u.length?u[0]:void 0;if(i)i.removeAttribute("deletable");else{var d=[],h=c.blocksById;let e=l.firstElementChild,t=void 0;for(;e;){var p=e.nextElementSibling,g=e.getAttribute("type");e.getAttribute("disabled")||e.getElementsByTagName("statement").length||!(b.buildinBlockStatements[g]||h[g]&&"void"==h[g].retType&&!(0,b.hasArrowFunction)(h[g]))||(t=(t?((g=l.ownerDocument.createElement("next")).appendChild(e),t.appendChild(g)):((t=l.ownerDocument.createElement("statement")).setAttribute("name","HANDLER"),i||((i=l.ownerDocument.createElement("block")).setAttribute("type",ts.pxtc.ON_START_TYPE),d.push(i)),i.appendChild(t),t.appendChild(e)),e.removeAttribute("x"),e.removeAttribute("y"),e)),e=p}d.forEach(e=>l.appendChild(e))}}return f=n.documentElement,pxt.U.toArray(f.querySelectorAll("block[type=procedures_defnoreturn]")).forEach(e=>{e.setAttribute("type","function_definition"),e.querySelector("field[name=NAME]").setAttribute("name","function_name")}),pxt.U.toArray(f.querySelectorAll("block[type=procedures_callnoreturn]")).forEach(e=>{e.setAttribute("type","function_call"),e.querySelector("field[name=NAME]").setAttribute("name","function_name")}),(0,_.extensionBlocklyPatch)(e,n.documentElement),(new XMLSerializer).serializeToString(n)}catch(e){return t||pxt.reportException(e),i}var f},i.patchCommentIds=k,i.patchShadows=C,i.validateAllReferencedBlocksExist=function(e){pxt.U.assert(!(null==m||!m.Blocks),"Called validateAllReferencedBlocksExist before initializing Blockly");var t=(e=m.utils.xml.textToDom(e)).querySelectorAll("block");for(let e=0;e<t.length;e++)if(!m.Blocks[t.item(e).getAttribute("type")])return!1;var i=e.querySelectorAll("shadow");for(let e=0;e<i.length;e++)if(!m.Blocks[i.item(e).getAttribute("type")])return!1;return!0}},{"./external":25,"./fields":70,"./loader":77,blockly:219}],74:[function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,o)}:function(e,t,i,n){e[n=void 0===n?i:n]=t[i]}),o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)},r=(Object.defineProperty(i,"__esModule",{value:!0}),i.external=i.contextMenu=void 0,o(e("./plugins/arrays"),i),o(e("./plugins/functions"),i),o(e("./plugins/logic"),i),o(e("./plugins/math"),i),o(e("./plugins/text"),i),o(e("./plugins/renderer"),i),o(e("./plugins/flyout"),i),o(e("./plugins/newVariableField"),i),o(e("./plugins/comments"),i),o(e("./compiler/compiler"),i),o(e("./compiler/environment"),i),o(e("./loader"),i),o(e("./layout"),i),o(e("./render"),i),o(e("./toolbox"),i),o(e("./fields"),i),o(e("./sourceMap"),i),o(e("./importer"),i),o(e("./diff"),i),o(e("./legacyMutations"),i),o(e("./blockDragger"),i),o(e("./workspaceSearch"),i),o(e("./monkeyPatches"),i),o(e("./getBlockText"),i),e("./contextMenu")),r=(i.contextMenu=r,e("./external"));i.external=r,o(e("./breakpointIcon"),i)},{"./blockDragger":1,"./breakpointIcon":2,"./compiler/compiler":12,"./compiler/environment":13,"./contextMenu":21,"./diff":24,"./external":25,"./fields":70,"./getBlockText":71,"./importer":73,"./layout":75,"./legacyMutations":76,"./loader":77,"./monkeyPatches":81,"./plugins/arrays":83,"./plugins/comments":86,"./plugins/flyout":97,"./plugins/functions":111,"./plugins/logic":117,"./plugins/math":119,"./plugins/newVariableField":123,"./plugins/renderer":129,"./plugins/text":134,"./render":137,"./sourceMap":138,"./toolbox":139,"./workspaceSearch":140}],75:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.documentToSvg=i.blocklyToSvgAsync=i.cleanUpBlocklySvg=i.serializeSvgString=i.serializeNode=i.toSvgAsync=i.toPngAsync=i.screenshotAsync=i.screenshotEnabled=i.flow=i.setCollapsedAll=i.verticalAlign=i.splitSvg=i.patchBlocksFromOldWorkspace=void 0;let C=e("blockly"),I=e("./compiler/environment"),y=e("./fields"),w=e("./compiler/compiler"),r=e("./importer");function S(e){return(e=e.replace(/\n/g,"")).trim()}i.patchBlocksFromOldWorkspace=function(a,l,c){c=(0,r.loadWorkspaceXml)(c,!0);{var u,d=a,h=l;a=c;let e,t,i=h.getTopBlocks(!1).filter(e=>e.isEnabled()),n=a.getTopBlocks(!1),o,r=h.getTopComments(!1),s=a.getTopComments(!1);for(b of i){var p=b.getRelativeToSurfaceXY();if(p&&0!=p.x&&0!=p.y){if(!e){e=(0,I.mkEnv)(h,d),t={};for(var g of n){var f=(0,w.callKey)(e,g),m=t[f]||[];m.push(g),t[f]=m}}var b=(0,w.callKey)(e,b),b=(t[b]||[]).shift();b&&((b=b.getRelativeToSurfaceXY()).x=p.x,b.y=p.y)}}for(u of r){var _=u.getRelativeToSurfaceXY();if(_&&0!=_.x&&0!=_.y){if(!o){o={};for(var y of s){var v=S(y.getText()),T=o[v]||[];T.push(y),o[v]=T}}var E,k=S(u.getText()),k=(o[k]||[]).shift();k&&(E=u.getSize(),k.setText(u.getText()),k.setSize(E),(u=k.getRelativeToSurfaceXY()).x=_.x,u.y=_.y)}}}var e,a=(0,r.workspaceToDom)(l,!0),t=(0,r.workspaceToDom)(c,!0);for(e of a.childNodes)pxt.BrowserUtils.isElement(e)&&"block"===e.localName&&"true"===e.getAttribute("disabled")&&t.appendChild(t.ownerDocument.importNode(e,!0));return C.Xml.domToText(t)},i.splitSvg=function(u,e,d=18){var t=e.getTopComments(!0),i=e.getTopBlocks(!0);if(t.length+i.length<2)return u;let h=document.createElement("div");function o(e,t,i,n,o,r,s){var a=u.cloneNode(!0),l=a.querySelector("g.blocklyWorkspace > g."+e),t=a.querySelector("g.blocklyWorkspace > g."+t),e=pxt.Util.toArray(l.querySelectorAll(`g.blocklyWorkspace > g.${e} > `+(s?"."+s:"g[transform]")));let c=e.splice(i,1)[0];c?(e.filter(e=>e!=c).forEach(e=>{e.parentNode.removeChild(e)}),l.removeAttribute("transform"),t.parentNode.removeChild(t),c.setAttribute("transform",`translate(${o.x}, ${o.y})`),s=n.width/d+"em",i=n.height/d+"em",a.setAttribute("viewBox",`0 0 ${n.width} `+n.height),a.style.width=s,a.style.height=i,a.setAttribute("width",s),a.setAttribute("height",i),a.setAttribute("aria-label",r),h.appendChild(a)):pxt.log("missing block, did block failed to load?")}return h.className="blocks-svg-list "+e.getInjectionDiv().className,t.forEach((e,t)=>o("blocklyBubbleCanvas","blocklyBlockCanvas",t,e.getSize(),{x:0,y:0},lf("blockly comment"),"blocklyComment")),i.forEach((e,t)=>{var i=e.getHeightWidth(),n={x:0,y:0},e=(e.hat&&(i.height+=d,n.y+=d),e.toString());o("blocklyBlockCanvas","blocklyBubbleCanvas",t,i,n,e+" blocks")}),h},i.verticalAlign=function(e,i){let n=0;e.getTopComments(!0).forEach(e=>{e.moveBy(0,n),n=(n+=e.getSize().height)+i}),e.getTopBlocks(!0).forEach((e,t)=>{e.hat&&(n+=i),e.moveBy(0,n),n=(n+=e.getHeightWidth().height)+i})},i.setCollapsedAll=function(e,t){e.getTopBlocks(!1).filter(e=>e.isEnabled()).forEach(e=>e.setCollapsed(t))};let v=20,T=20;function n(e,t,i){let n,o=(i&&(n={target:pxt.appTarget.id,versions:pxt.appTarget.versions,xml:(0,r.saveBlocksXml)(e).map(e=>pxt.Util.htmlEscape(e))}),0|t||4);return s(e,o).then(e=>e?pxt.BrowserUtils.encodeToPngAsync(e.xml,{width:e.width,height:e.height,pixelDensity:o,text:i?JSON.stringify(n,null,2):null}):Promise.resolve(void 0)).catch(e=>{pxt.reportException(e)})}i.flow=function(e,t){if(t){if(t.useViewWidth){var i=e.getMetrics();if(i.viewHeight>i.viewWidth)return a(e.getTopComments(!0),e.getTopBlocks(!0),void 0,i.viewWidth),void e.scroll(v,T)}a(e.getTopComments(!0),e.getTopBlocks(!0),t.ratio)}else a(e.getTopComments(!0),e.getTopBlocks(!0));e.scroll(v,T)},i.screenshotEnabled=function(){return pxt.BrowserUtils.hasFileAccess()&&!pxt.BrowserUtils.isIE()},i.screenshotAsync=n,i.toPngAsync=n;let E="http://www.w3.org/1999/xlink",c=12e7;function s(e,t){if(!e)return Promise.resolve(void 0);var i,n,o,r=e.getBlocksBoundingBox(),s=e.getParentSvg().cloneNode(!0);u(s);for(i of e.getAllBlocks())i.hasIcon(C.icons.IconType.COMMENT)&&(n=(o=i.getIcon(C.icons.IconType.COMMENT)).getBubbleLocation())&&(o=o.getBubbleSize(),r.left=Math.min(n.x,r.left),r.top=Math.min(n.y,r.top),r.right=Math.max(n.x+o.width,r.right),r.bottom=Math.max(n.y+o.height,r.bottom));--r.left,--r.top,r.right+=1,r.bottom+=1;var e=r.right-r.left,a=r.bottom-r.top;let l=1;t=e*a*Math.pow(t,2);return t>c&&(l=Math.sqrt(c/t)),d(s,r.left,r.top,e,a,l)}function k(e){return o((new XMLSerializer).serializeToString(e))}function o(e){return e.replace(new RegExp("&nbsp;","g"),"&#160;")}function u(e){pxt.BrowserUtils.removeClass(e,"blocklySvg"),pxt.BrowserUtils.addClass(e,"blocklyPreview pxt-renderer classic-theme"),pxt.U.toArray(e.querySelectorAll(".blocklyMainBackground,.blocklyScrollbarBackground")).forEach(e=>{e&&e.parentNode.removeChild(e)}),pxt.U.toArray(e.querySelectorAll(".blocklyConnectionIndicator,.blocklyInputConnectionIndicator")).forEach(e=>{e&&e.parentNode.removeChild(e)}),e.removeAttribute("width"),e.removeAttribute("height"),pxt.U.toArray(e.querySelectorAll(".blocklyBlockCanvas,.blocklyBubbleCanvas")).forEach(e=>e.removeAttribute("transform")),e.querySelectorAll("[tabindex]").forEach(e=>{e.removeAttribute("tabindex")});let i=new DOMParser;return pxt.U.toArray(e.querySelectorAll(".blocklyTextarea")).forEach(e=>{var t=i.parseFromString("<!doctype html><body>"+pxt.docs.html2Quote(e.value),"text/html");e.textContent=t.body.textContent}),e}async function d(e,t,i,n,o,r){if(e.childNodes[0]){e.removeAttribute("width"),e.removeAttribute("height"),e.removeAttribute("transform");var s,a=Math.round(n*(r||1)),r=Math.round(o*(r||1)),e=k(e).replace(/^\s*<svg[^>]+>/i,"").replace(/<\/svg>\s*$/i,""),t=`<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="${E}" width="${a}" height="${r}" viewBox="${t} ${i} ${n} ${o}" class="pxt-renderer classic-theme injectionDiv">${e}</svg>`,i=(new DOMParser).parseFromString(t,"image/svg+xml"),n=i.createElementNS("http://www.w3.org/1999/xhtml","style"),o=pxt.Util.isUserLanguageRtl(),e=document.getElementById(`style-${o?"rtl":""}blockly.css`).href,t=pxt.Util.toArray(document.head.getElementsByTagName("link")).filter(e=>pxt.Util.endsWith(e.getAttribute("href"),"semantic.css"))[0].href,o=await Promise.all([pxt.BrowserUtils.loadAjaxAsync(e),pxt.BrowserUtils.loadAjaxAsync(t)]),e=pxt.Util.toArray(document.head.querySelectorAll("style")).filter(e=>/\.blocklySvg/.test(e.innerText))[0],t=(o.unshift((null==(t=document.getElementById("blockly-common-style"))?void 0:t.innerText)||""),o.unshift((null==(t=document.getElementById("blockly-renderer-style-pxt-classic"))?void 0:t.innerText)||""),(e?e.innerText:"")+"\n\n"+o.map(e=>e+"\n\n")),e=(n.appendChild(i.createCDATASection(t)),i.documentElement.insertBefore(n,i.documentElement.firstElementChild),i);R=R||{};var l,c,o=(e=pxt.Util.toArray(e.getElementsByTagName("image"))).filter(e=>{e=e.getAttributeNS(E,"href");return e&&!/^data:/.test(e)});for(l of o){var u=l.getAttributeNS(E,"href");let t=R[u];if(!t)try{var d=await pxt.BrowserUtils.loadImageAsync(l.getAttributeNS(E,"href")),h=document.createElement("canvas"),p=h.getContext("2d"),g=d.width,f=d.height;h.width=g,h.height=f,p.drawImage(d,0,0,g,f,0,0,h.width,h.height),t=h.toDataURL("image/png"),R[u]=t}catch(e){pxt.debug("svg render: failed to load "+u),t=""}l.setAttributeNS(E,"href",u)}for(c of o=e.filter(e=>{e=e.getAttribute("href");return(null==e?void 0:e.endsWith(".svg"))&&(e.startsWith("/")||e.startsWith(pxt.webConfig.cdnUrl))})){var m=c.getAttribute("href");let e=24,t=24,i=(c.hasAttribute("width")&&c.hasAttribute("height")?(e=parseInt(c.getAttribute("width").replace(/[^0-9]/g,"")),t=parseInt(c.getAttribute("height").replace(/[^0-9]/g,""))):c.classList.contains("blocklyResizeHandle")&&(e=12,t=12),R[m]);i=i||await pxt.BrowserUtils.encodeToPngAsync(m,{width:e,height:t,pixelDensity:2}),R[m]=i,c.setAttribute("href",i)}await 0;n=i;if(O=O||{},pxt.BrowserUtils.isEdge())for(s of pxt.Util.toArray(n.getElementsByTagName("image")).filter(e=>/^data:image\/svg\+xml/.test(e.getAttributeNS(E,"href")))){var b=s.getAttributeNS(E,"href"),_=parseInt(s.getAttribute("width").replace(/[^0-9]/g,"")),y=parseInt(s.getAttribute("height").replace(/[^0-9]/g,""));let e=O[b];e||(e=await pxt.BrowserUtils.encodeToPngAsync(b,{width:_,height:y,pixelDensity:2}),pxt.log("HREF: "+e)),O[b]=e,s.setAttributeNS(E,"href",e)}return await 0,{width:a,height:r,svg:k(i).replace('<style xmlns="http://www.w3.org/1999/xhtml">',"<style>"),xml:x(i),css:t}}}function x(e){e=(new XMLSerializer).serializeToString(e);return"data:image/svg+xml;base64,"+ts.pxtc.encodeBase64(unescape(encodeURIComponent(e)))}i.toSvgAsync=s,i.serializeNode=k,i.serializeSvgString=o,i.cleanUpBlocklySvg=u,i.blocklyToSvgAsync=d,i.documentToSvg=x;let R;let O;function a(e,t,i=1.62,n){let r=[],s={};e.forEach(e=>{var t=e.data;null!=t&&(s[t]=e)});let a,o=(t.sort((e,t)=>e.isEnabled()===t.isEnabled()?e.type===t.type?0:"function_definition"===e.type?1:"function_definition"===t.type?-1:e.type.localeCompare(t.type):e.isEnabled()?-1:1),t.forEach(e=>{var t=(0,y.getBlockData)(e).commentRefs;if(t.length){var i=[];for(let e=0;e<t.length;e++){var n=s[t[e]];n&&(i.push(A(n)),delete s[t[e]])}if(i.length)return void r.push({value:e,width:-1,height:-1,children:i})}var o=A(e);!a&&e.isEnabled()&&e.type===pxtc.ON_START_TYPE?a=o:r.push(o)}),a&&r.unshift(a),Object.keys(s).sort((e,t)=>e.length===t.length?t<e?-1:1:e.length>t.length?-1:1).forEach(e=>{s[e]&&r.push(A(s[e]))}),e.forEach(e=>{null==e.data&&r.push(A(e))}),0);for(let e=0;e<r.length;e++){var l=r[e];if(l.children){var c=l.value.getHeightWidth(),u=(l.x=0,l.y=0,c.width+13);let t=0;for(let e=0;e<l.children.length;e++){var d=l.children[e];d.x=u,d.y=t,t+=d.height+13,l.width=Math.max(l.width,u+d.width)}l.height=Math.max(t-13,c.height)}o+=(l.height+13)*(l.width+13)}let h,p=(h=n>v?n-v:Math.sqrt(o)*i,v),g=T,f=0;for(let e=0;e<r.length;e++){var m=r[e];if(m.children){_(m,p+m.x,g+m.y);for(let e=0;e<m.children.length;e++){var b=m.children[e];_(b,p+b.x,g+b.y)}}else _(m,p,g);p+=m.width+45,f=Math.max(f,g+m.height+45),p>h&&(p=v,g=f)}function _(e,t,i){var n=e.value.getBoundingRectangle();e.value.moveBy(t-n.left,i-n.top)}}function A(e){var t=e instanceof C.BlockSvg?e.getHeightWidth():e.getSize();return{value:e,height:t.height,width:t.width}}},{"./compiler/compiler":12,"./compiler/environment":13,"./fields":70,"./importer":73,blockly:219}],76:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.mutateToolboxBlock=i.addMutation=i.MutatorTypes=void 0;let n=e("blockly"),o=e("./compiler/util"),r=e("./compiler/compiler"),s=e("./loader"),a=e("./plugins/newVariableField/fieldVariable");var l;(e=l=i.MutatorTypes||(i.MutatorTypes={})).ObjectDestructuringMutator="objectdestructuring",e.RestParameterMutator="restparameter",e.DefaultInstanceMutator="defaultinstance",i.addMutation=function(e,t,i){let n;switch(i){case l.ObjectDestructuringMutator:if(!t.parameters||t.parameters.length<1)pxt.error("Destructuring mutations require at least one parameter");else{let e=!1;for(var o of t.parameters)if(-1!==o.type.indexOf("=>")){if(!o.properties||0===o.properties.length)return void pxt.error("Destructuring mutations only supported for functions with an event parameter that has multiple properties");e=!0}if(!e)return void pxt.error("Destructuring mutations must have an event parameter")}n=new u(e,t);break;case l.RestParameterMutator:n=new d(e,t);break;case l.DefaultInstanceMutator:n=new h(e,t);break;default:return void pxt.warn("Ignoring unknown mutation type: "+i)}e.mutationToDom=n.mutationToDom.bind(n),e.domToMutation=n.domToMutation.bind(n),e.compose=n.compose.bind(n),e.decompose=n.decompose.bind(n),e.mutation=n},i.mutateToolboxBlock=function(e,t,i){var n=document.createElement("mutation");switch(t){case l.ObjectDestructuringMutator:n.setAttribute(u.propertiesAttributeName,i);break;case l.RestParameterMutator:n.setAttribute(d.countAttributeName,i);break;case l.DefaultInstanceMutator:n.setAttribute(h.attributeName,i);default:return void pxt.warn("Ignoring unknown mutation type: "+t)}e.appendChild(n)};class c{constructor(e,t){this.info=t,this.block=e,this.topBlockType=this.block.type+"_mutator";t=this.getSubBlockNames(),this.initializeMutatorTopBlock(),this.initializeMutatorSubBlocks(t),t=t.map(e=>e.type);this.block.setMutator(new n.icons.MutatorIcon(t,e))}compose(e){e=e.getDescendants(!1).map(e=>({type:e.type,name:e.inputList[0].name}));e.shift(),this.updateBlock(e)}decompose(i){var e,t=i.newBlock(this.topBlockType);t.initSvg();for(e of t.inputList)if(e.name===c.mutatorStatmentInput){let t=e.connection;this.getVisibleBlockTypes().forEach(e=>{e=i.newBlock(e);e.initSvg(),t.connect(e.previousConnection),t=e.nextConnection});break}return t}compileMutation(e,t){}getDeclaredVariables(){}isDeclaredByMutation(e){return!1}initializeMutatorSubBlock(e,t,i){e.appendDummyInput(t).appendField(t),e.setColour(i),e.setNextStatement(!0),e.setPreviousStatement(!0)}initializeMutatorTopBlock(){let e=this.info.attributes.mutateText,t=this.block.getColour();n.Blocks[this.topBlockType]=n.Blocks[this.topBlockType]||{init:function(){this.appendDummyInput().appendField(e),this.setColour(t),this.appendStatementInput(c.mutatorStatmentInput)}}}initializeMutatorSubBlocks(e){let t=this.block.getColour(),i=this.initializeMutatorSubBlock.bind(this);e.forEach(e=>{n.Blocks[e.type]=n.Blocks[e.type]||{init:function(){i(this,e.name,t)}}})}}c.mutatorStatmentInput="PROPERTIES",c.mutatedVariableInputName="properties";class u extends c{constructor(e,t){super(e,t),this.currentlyVisible=[],this.parameterRenames={},this.prefix=this.info.attributes.mutatePrefix,this.block.appendDummyInput(c.mutatedVariableInputName),this.block.appendStatementInput("HANDLER").setCheck("null")}getMutationType(){return l.ObjectDestructuringMutator}compileMutation(n,e){var t;if(this.info.attributes.mutatePropertyEnum||this.parameters.length)return t=`function ({ ${this.parameters.map(e=>{var t=this.block.getField(e),t=t&&t.getText(),i=(0,o.escapeVarName)(e,n);return t!==e?(this.parameterRenames[e]=t,e+": "+(0,o.escapeVarName)(t,n)):i}).join(", ")} })`,this.info.attributes.mutatePropertyEnum?pxt.blocks.mkText(` [${this.parameters.map(e=>this.info.attributes.mutatePropertyEnum+"."+e).join(", ")}],`+t):pxt.blocks.mkText(t)}getDeclaredVariables(){let t={};return this.parameters.forEach(e=>{t[this.getVarFieldValue(e)]=this.parameterTypes[e]}),t}isDeclaredByMutation(t){return this.parameters.some(e=>this.getVarFieldValue(e)===t)}mutationToDom(){var e,t=document.createElement("mutation"),i=this.parameters.map(e=>{var t=this.getVarFieldValue(e);return t!==e&&(this.parameterRenames[e]=pxt.Util.htmlEscape(t)),pxt.Util.htmlEscape(e)}).join(",");for(e in t.setAttribute(u.propertiesAttributeName,i),this.parameterRenames)e===this.parameterRenames[e]&&delete this.parameterRenames[e];return t.setAttribute(u.renameAttributeName,JSON.stringify(this.parameterRenames)),t}domToMutation(e){var t=e.getAttribute(u.propertiesAttributeName);if(t){t=t.split(",");let i=[];if(void 0===this.paramIndex&&(this.paramIndex=this.getParameterIndex()),t.forEach(e=>{let t=e.split(":");this.info.parameters[this.paramIndex].properties.some(e=>e.name===t[0])&&i.push({property:t[0],newName:t[1]})}),this.parameterRenames=void 0,e.hasAttribute(u.renameAttributeName))try{this.parameterRenames=JSON.parse(e.getAttribute(u.renameAttributeName))}catch(e){pxt.warn("Ignoring invalid rename map in saved block mutation")}this.parameterRenames=this.parameterRenames||{},this.parameters=[],i.forEach(e=>{this.parameters.push(e.property),e.newName&&e.newName!==e.property&&(this.parameterRenames[e.property]=e.newName)}),this.updateVisibleProperties(),i.filter(e=>!!e.newName).forEach(e=>this.setVarFieldValue(e.property,e.newName))}}getVarFieldValue(e){e=this.block.getField(e);return e&&e.getText()}setVarFieldValue(e,t){this.block.getField(e);this.block.getField(e)&&(0,s.setVarFieldValue)(this.block,e,t)}updateBlock(e){this.parameters=[],e.forEach(e=>{-1===this.parameters.indexOf(e.name)&&this.parameters.push(e.name)}),this.updateVisibleProperties()}getSubBlockNames(){return this.parameters=[],this.parameterTypes={},void 0===this.paramIndex&&(this.paramIndex=this.getParameterIndex()),this.info.parameters[this.paramIndex].properties.map(e=>(this.parameterTypes[e.name]=e.type,{type:this.propertyId(e.name),name:e.name}))}getVisibleBlockTypes(){return this.currentlyVisible.map(e=>this.propertyId(e))}updateVisibleProperties(){if(!pxt.Util.listsEqual(this.currentlyVisible,this.parameters)){let i=this.block.inputList.find(e=>e.name===c.mutatedVariableInputName);this.prefix&&0===this.currentlyVisible.length&&i.appendField(this.prefix,u.prefixLabel),this.currentlyVisible.forEach(e=>{var t;-1===this.parameters.indexOf(e)&&((t=this.getVarFieldValue(e))!==e&&(this.parameterRenames[e]=t),i.removeField(e))}),this.parameters.forEach(e=>{var t;-1===this.currentlyVisible.indexOf(e)&&(t=this.parameterRenames[e]||e,i.appendField(new a.FieldVariable(t),e))}),this.prefix&&0===this.parameters.length&&i.removeField(u.prefixLabel),this.currentlyVisible=this.parameters}}propertyId(e){return this.block.type+"_"+e}getParameterIndex(){for(let e=0;e<this.info.parameters.length;e++)if(-1!==this.info.parameters[e].type.indexOf("=>"))return e}}u.propertiesAttributeName="callbackproperties",u.renameAttributeName="renamemap",u.prefixLabel="0prefix_label_";class d extends c{constructor(){super(...arguments),this.count=0}getMutationType(){return l.RestParameterMutator}compileMutation(t,i){let n=[];return this.forEachInput(e=>n.push((0,r.compileExpression)(t,e,i))),pxt.blocks.mkGroup(n)}mutationToDom(){var e=document.createElement("mutation");return e.setAttribute(d.countAttributeName,this.count.toString()),e}domToMutation(e){e=e.getAttribute(d.countAttributeName);if(e){try{this.count=parseInt(e)}catch(e){return}for(let e=0;e<this.count;e++)this.addNumberField(!1,e)}}updateBlock(e){if(e){var t=Math.abs(this.count-e.length);if(this.count<e.length)for(let e=0;e<t;e++)this.addNumberField(!0,this.count);else if(this.count>e.length)for(let e=0;e<t;e++)this.removeNumberField()}}getSubBlockNames(){return[{name:"Value",type:d.entryTypeName}]}getVisibleBlockTypes(){let e=[];return this.forEachInput(()=>e.push(d.entryTypeName)),e}addNumberField(e,t){t=this.block.appendValueInput(d.valueInputPrefix+t).setCheck("Number");e&&((e=this.block.workspace.newBlock("math_number")).initSvg(),e.setShadow(!0),t.connection.connect(e.outputConnection),this.block.workspace.render(),this.count++)}removeNumberField(){0<this.count&&this.block.removeInput(d.valueInputPrefix+(this.count-1)),this.count--}forEachInput(t){for(let e=0;e<this.count;e++)t(this.block.getInputTargetBlock(d.valueInputPrefix+e),e)}}d.countAttributeName="count",d.entryTypeName="entry",d.valueInputPrefix="value_input_";class h extends c{constructor(){super(...arguments),this.showing=!1}getMutationType(){return l.DefaultInstanceMutator}compileMutation(e,t){if(this.showing){var i=this.block.getInputTargetBlock(h.instanceInputName);if(i)return(0,r.compileExpression)(e,i,t)}}mutationToDom(){var e=document.createElement("mutation");return e.setAttribute(h.attributeName,this.showing?"true":"false"),e}domToMutation(e){e=e.getAttribute(h.attributeName);e?this.updateShape("true"===e):this.updateShape(!1)}updateBlock(e){this.updateShape(!(!e||!e.length))}getSubBlockNames(){return[{name:"Instance",type:h.instanceSubBlockType}]}getVisibleBlockTypes(){var e=[];return this.showing&&e.push(h.instanceSubBlockType),e}updateShape(e){this.showing!==e&&(e&&!this.block.getInputTargetBlock(h.instanceInputName)?this.block.appendValueInput(h.instanceInputName):this.block.removeInput(h.instanceInputName),this.showing=e)}}h.attributeName="showing",h.instanceInputName="__instance__",h.instanceSubBlockType="instance"},{"./compiler/compiler":12,"./compiler/util":15,"./loader":77,"./plugins/newVariableField/fieldVariable":122,blockly:219}],77:[function(e,v,I){Object.defineProperty(I,"__esModule",{value:!0}),I.setVarFieldValue=I.generateIcons=I.getFixedInstanceDropdownValues=I.setOutputCheck=I.getBlocklyCheckForType=I.initAccessibleBlocksContextMenuItems=I.initialize=I.initializeAndInject=I.cleanBlocks=I.hasArrowFunction=I.injectBlocks=I.blockSymbol=I.cachedBlockInfo=I.buildinBlockStatements=I.builtinBlocks=I.isTupleType=I.DRAGGABLE_PARAM_INPUT_PREFIX=I.initCopyPaste=void 0;let w=e("blockly"),S=e("./constants"),y=e("./composableMutations"),x=e("./legacyMutations"),t=e("./builtins/math"),R=e("./fields"),i=e("./builtins/functions"),n=e("./builtins/lists"),o=e("./builtins/logic"),r=e("./builtins/loops"),s=e("./builtins/text"),a=e("./toolbox"),c=e("./help"),O=e("./fields"),A=e("./fields"),N=e("./fields"),L=e("./fields"),u=e("./external"),l=e("./builtins/variables"),d=e("./builtins/misc"),T=e("./contextMenu"),E=e("./codecardRenderer"),H=e("./fields/field_dropdown"),D=e("./plugins/duplicateOnDrag"),h=e("./copyPaste");var k=e("./copyPaste");Object.defineProperty(I,"initCopyPaste",{enumerable:!0,get:function(){return k.initCopyPaste}});let G=e("./plugins/newVariableField/fieldVariable"),C=e("./plugins/functions"),V=e("./plugins/functions/utils"),j=e("./compiler/util"),W=e("./compiler/compiler");I.DRAGGABLE_PARAM_INPUT_PREFIX="HANDLER_DRAG_PARAM_",I.isTupleType=function(e){if(e=/^\[(.+)\]$/.exec(e))return e[1].split(/,\s*/)};let p;function g(){return p||(p={},Object.keys(w.Blocks).forEach(e=>p[e]={block:w.Blocks[e]})),p}I.builtinBlocks=g,I.buildinBlockStatements={controls_if:!0,controls_for:!0,pxt_controls_for:!0,controls_simple_for:!0,controls_repeat_ext:!0,pxt_controls_for_of:!0,controls_for_of:!0,variables_set:!0,variables_change:!0,device_while:!0};let f={};function m(l){return I.cachedBlockInfo=l,(0,D.setDraggableShadowBlocks)(l.blocks.filter(e=>e.attributes.duplicateShadowOnDrag).map(e=>e.attributes.blockId)),(0,C.setArgumentReporterLocalizeFunction)((n,o)=>{{var r=l,s=n;let e,t=void 0,i=(n=o).getLocalizationName();i&&(a=pxt.U.rlf(i),t=a!==i?a:pxtc.getBlockTranslationsCacheKey(i));var a=(0,V.getArgumentReporterParent)(n,n);if(a&&!(0,j.isFunctionDefinition)(a)){n=r.blocksById[a.type];if(n){r=pxt.blocks.compileInfo(n),n=null==(e=r.handlerArgs)?void 0:e.find(e=>e.name===s.getValue());if(n)return pxtc.getBlockTranslationsCacheKey(n.localizationKey)}}return t}}),l.blocks.map(e=>{var t,i=pxt.blocks.compileInfo(e),n=(0,a.createToolboxBlock)(l,e,i,!1,2);return e.attributes.blockBuiltin?(pxt.Util.assert(!!g()[e.attributes.blockId]),(t=g()[e.attributes.blockId]).symbol=e,t.block.codeCard=(0,c.mkCard)(e,n)):((m,b,_,e)=>{let t=b.attributes.blockId;if(g()[t])return pxt.reportError("blocks","trying to override builtin block",{details:t});var i=JSON.stringify(b);if(!f[t]||f[t].hash!=i){if(w.Blocks[b.attributes.blockId])return pxt.error("duplicate block definition: "+t);i={hash:i,fn:b,block:{codeCard:(0,c.mkCard)(b,e),init:function(){{var l=this,E=m,k=b,C=_,c,u;let e,t,i=(k.attributes.blockNamespace||k.namespace).split(".")[0],v=1==k.kind||2==k.kind,n=("boolean"!=typeof k.isInstance||null!=(e=k.attributes)&&e.defaultInstance||(v=k.isInstance),E.apis.byQName[i]),T=k.attributes.blockNamespace&&n&&n.attributes.color||k.attributes.color||n&&n.attributes.color||pxt.toolbox.getNamespaceColor(i)||255,o=pxt.blocks.getHelpUrl(k),r=(o&&l.setHelpUrl(o),(0,D.setDuplicateOnDragStrategy)(l),l.setColour("string"==typeof T?pxt.toolbox.getAccessibleBackground(T):T),S.provider.SHAPES.ROUND),s=("boolean"==k.retType&&(r=S.provider.SHAPES.HEXAGONAL),l.setOutputShape(r),k.attributes.undeletable&&l.setDeletable(!1),f(k.attributes._def),!1),a=!1;if(k.attributes.mutate)(0,x.addMutation)(l,k,k.attributes.mutate);else if(k.attributes.defaultInstance)(0,x.addMutation)(l,k,x.MutatorTypes.DefaultInstanceMutator);else if(k.attributes._expandedDef&&"disabled"!==k.attributes.expandableArgumentMode){var d="toggle"===k.attributes.expandableArgumentMode;(0,y.initExpandableBlock)(E,l,k.attributes._expandedDef,C,d,()=>f(k.attributes._expandedDef,!0))}else if(C.handlerArgs.length)if(s=!0,k.attributes.optionalVariableArgs)"reporter"===k.attributes.draggableParameters?a=!0:(0,y.initVariableArgsBlock)(l,C.handlerArgs);else if(k.attributes.draggableParameters)C.handlerArgs.filter(e=>!e.inBlockDef).forEach(e=>{var t=l.appendValueInput(I.DRAGGABLE_PARAM_INPUT_PREFIX+e.name);"reporter"==k.attributes.draggableParameters?t.setCheck($(e.type,E)):t.setCheck("Variable")}),C.handlerArgs.forEach(e=>{(0,D.setDuplicateOnDrag)(l.type,I.DRAGGABLE_PARAM_INPUT_PREFIX+e.name)});else{let t=l.appendDummyInput();C.handlerArgs.filter(e=>!e.inBlockDef).forEach(e=>{t.appendField(new G.FieldVariable(e.name),"HANDLER_"+e.name)})}(0,y.appendMutation)(l,{mutationToDom:t=>(l.inputList.forEach(e=>{e.fieldRow.forEach(e=>{e.isFieldCustom_&&e.saveOptions&&(e=e.saveOptions())&&t.setAttribute("customfield",JSON.stringify(e))})}),t),domToMutation:i=>{l.inputList.forEach(e=>{e.fieldRow.forEach(e=>{var t;e.isFieldCustom_&&e.restoreOptions&&(t=JSON.parse(i.getAttribute("customfield")))&&e.restoreOptions(t)})})}}),(d=k.attributes.imageLiteral||k.attributes.gridLiteral)&&(h=(k.attributes.imageLiteralColumns||5)*d,p=k.attributes.imageLiteralRows||5,g=k.attributes.imageLiteralScale,c=k.attributes.gridLiteralOnColor,u=k.attributes.gridLiteralOffColor,l.appendDummyInput().appendField(new O.FieldLedMatrix("",{columns:h,rows:p,scale:g,onColor:c,offColor:u}),"LEDS")),"external"===k.attributes.inlineInputMode?l.setInputsInline(!1):"inline"===k.attributes.inlineInputMode?l.setInputsInline(!0):l.setInputsInline(!k.parameters||k.parameters.length<4&&!d),((h=null==(t=k.parameters)?void 0:t.find(e=>pxtc.parameterTypeIsArrowFunction(e)))||s)&&(l.appendStatementInput("HANDLER").setCheck(null),l.setInputsInline(!0));var h,p=M(k),g=!!k.attributes.handlerStatement||!!k.attributes.forceStatement||"void"===k.retType&&!p;function f(e,n=!1){let o=0,_=!n&&!!C.thisParameter;e=(e=>{let t=[],i=[];return e.parts.forEach(e=>{switch(e.kind){case"break":n();break;case"param":i.push(e),n();break;case"image":case"label":i.push(e)}}),n(),t;function n(){i.length&&(t.push(i),i=[])}})(e);let y=new pxt.ImageConverter;if("ENUM_GET"!==k.attributes.shim&&"KIND_GET"!==k.attributes.shim||!(1<C.parameters.length||C.thisParameter)){let i=t=>{var e;return null==(e=l.inputList)?void 0:e.some(e=>e.name===t)};e.forEach(e=>{let g=[],f,m,b=!1;e.forEach(e=>{if("param"!==e.kind){var t=(e=>{if("image"===e.kind){var t=e.uri,i=B[t];if(i)return new w.FieldImage(i,40,40,"",null,pxt.Util.isUserLanguageRtl());pxt.log("missing jres icon "+t)}else{var n=(e=>{if(" "===e)return"";if(1<e.length){var t=" "==e.charAt(0),i=" "==e.charAt(e.length-1);if(t||i)return e.substring(t?1:0,i?e.length-1:e.length)}return e})(e.text);if(n)return e.cssClass?new w.FieldLabel(n,e.cssClass):e.style.length?new A.FieldStyledLabel(n,{bold:-1!==e.style.indexOf("bold"),italics:-1!==e.style.indexOf("italics"),blocksInfo:void 0}):new w.FieldLabel(n,void 0)}})(e);t&&g.push({field:t})}else if("ENUM_GET"===k.attributes.shim)pxt.Util.assert(!!k.attributes.enumName,"Trying to create an ENUM_GET block without a valid enum name"),g.push({name:"MEMBER",field:new N.FieldUserEnum(E.enumsByName[k.attributes.enumName])});else if("KIND_GET"===k.attributes.shim)g.push({name:"MEMBER",field:new R.FieldKind(E.kindsByName[k.attributes.kindNamespace||k.attributes.blockNamespace||k.namespace])});else{let n=((i,e,t=!1)=>{if(i.ref){var n="this"===i.name?e.thisParameter:e.actualNameToParam[i.name];if(!n){let t;if(e.handlerArgs.forEach(e=>{e.name===i.name&&(t=e)}),t)return t}return n}return t?e.thisParameter:e.definitionNameToParam[i.name]})(e,C,_);if(_=!1,n)if(n.definitionName){var t=pxt.Util.lookup(E.apis.byQName,n.type),i=(b=!0,n.definitionName),o=n.actualName,r=t&&6==t.kind,s=t&&!!t.attributes.fixedInstances&&!n.shadowBlockId,a=!!k.attributes.constantShim,l="@combined@"==n.type,c=n.fieldEditor,u=i.charAt(0).toUpperCase()+i.slice(1),d=n.type;if(r||s||a||l){let e;0==(e=r?(a=E.apis,p=n.type,pxt.Util.values(a.byQName).filter(e=>e.namespace===p&&!e.attributes.blockHidden)):s?U(E.apis,t.qName):l?k.combinedProperties.map(e=>pxt.Util.lookup(E.apis.byQName,e)):(r=E.apis,h=k.qName,pxt.Util.values(r.byQName).filter(e=>e.attributes.blockIdentity===h))).length&&pxt.error(`no instances of ${t.qName} found`);a=e.map(e=>{let t=e.attributes.block||e.attributes.blockId||e.name;var i=e.attributes.blockCombine;return e.attributes.jresURL&&!e.attributes.iconURL&&pxt.Util.startsWith(e.attributes.jresURL,"data:image/x-mkcd-f")&&(e.attributes.iconURL=y.convert(e.attributes.jresURL)),i&&(t=t.replace(/@set/,"")),[e.attributes.iconURL||e.attributes.blockImage?{src:e.attributes.iconURL||pxt.Util.pathJoin(pxt.webConfig.commitCdnUrl,`blocks/${e.namespace.toLowerCase()}/${e.name.toLowerCase()}.png`),alt:t,width:36,height:36,value:e.name}:t,e.namespace+"."+e.name]});if(n.defaultValue){let i=-1;a.some((e,t)=>e[1]===n.defaultValue&&(i=t,!0)),-1<i&&(s=a.splice(i,1)[0],a.unshift(s))}c?(l=k.attributes.paramDefl[o]||"",r={data:a,colour:T,label:u,type:d,blocksInfo:E},pxt.Util.jsonMergeFrom(r,k.attributes.paramFieldEditorOptions&&k.attributes.paramFieldEditorOptions[o]||{}),g.push(F((0,L.createFieldEditor)(c,l,r),i))):g.push(F(new H.FieldDropdown(a),i))}else c?(t=k.attributes.paramDefl[n.actualName]||"",s={colour:T,label:u,type:d,blocksInfo:E},pxt.Util.jsonMergeFrom(s,k.attributes.paramFieldEditorOptions&&k.attributes.paramFieldEditorOptions[n.actualName]||{}),g.push(F((0,L.createFieldEditor)(c,t,s),n.definitionName))):(f=i,v&&"this"===e.name?m=n.type:"number"==n.type&&n.shadowBlockId&&"value"==n.shadowBlockId?(f=void 0,g.push(F(new w.FieldNumber("0"),i))):m="string"==n.type&&n.shadowOptions&&n.shadowOptions.toString?null:$(n.type,E))}else f=I.DRAGGABLE_PARAM_INPUT_PREFIX+n.name,m="reporter"===k.attributes.draggableParameters?$(n.type,E):"Variable";else pxt.error("block "+k.attributes.blockId+": unknown parameter "+e.name+(e.ref?` (${e.ref})`:""))}var h,p});let t;if(f){if(i(f))return;(t=l.appendValueInput(f)).setAlign(w.inputs.Align.LEFT)}else if(n){e=b?S.optionalInputWithFieldPrefix:S.optionalDummyInputPrefix;if(f=e+o++,i(f))return;t=l.appendDummyInput(f)}else t=l.appendDummyInput();m&&t.setCheck(m),g.forEach(e=>t.appendField(e.field,e.name))}),y.logTime()}else pxt.warn(`Enum blocks may only have 1 parameter but ${k.attributes.blockId} has `+C.parameters.length)}g||P(l,k.retType,E),l.setPreviousStatement(g),l.setNextStatement(g),a&&(0,y.initVariableReporterArgs)(l,C.handlerArgs,E),l.setTooltip(/^__/.test(k.namespace)?"":k.attributes.jsDoc)}}}};pxt.Util.isTranslationMode()&&(i.block.customContextMenu=e=>{b.attributes.translationId&&e.push({enabled:!0,text:lf("Translate this block"),callback:function(){(0,u.promptTranslateBlock)(t,[b.attributes.translationId])}})}),f[t]=i,w.Blocks[t]=i.block}})(l,e,i,n),e})}function M(e){return!(null==(e=e.parameters)||!e.some(e=>pxtc.parameterTypeIsArrowFunction(e)))}I.blockSymbol=function(e){return(e=f[e])?e.fn:void 0},I.injectBlocks=m,I.hasArrowFunction=M,I.cleanBlocks=function(){for(var e in pxt.debug("removing all custom blocks"),f)e=f[e].fn,delete w.Blocks[e.attributes.blockId],delete f[e.attributes.blockId]},I.initializeAndInject=function(e){_(e),(0,T.initContextMenu)(),(0,h.initCopyPaste)(!1),m(e)};let b=!(I.initialize=function(e){_(e);{B={};let i=e.apis.jres;i&&Object.keys(i).forEach(e=>{var t=i[e];t&&t.icon&&(B[e]=t.icon)})}});function _(e){if(!b){b=!0,(0,L.initFieldEditors)(),(0,d.initOnStart)(),(0,t.initMath)(e),(0,l.initVariables)(),(0,i.initFunctions)(),(0,n.initLists)(),(0,r.initLoops)(),(0,o.initLogic)(),(0,s.initText)(),w.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="";{let r=e=>{var t;if(null!=(t=e.hasDisabledReason)&&t.call(e,W.AUTO_DISABLED_REASON))return lf("This block is disabled and will not run. Attach this block to an event to enable it.");let i=e.tooltip;for(;"function"==typeof i;)i=i(e);return i};w.Tooltip.setCustomTooltip((t,e)=>{if(e.codeCard){var i=(0,E.renderCodeCard)({header:r(e)});t.appendChild(i)}else{var i=r(e),n=(i=w.utils.string.wrap(i,w.Tooltip.LIMIT)).split("\n");for(let e=0;e<n.length;e++){var o=document.createElement("div");o.appendChild(document.createTextNode(n[e])),t.appendChild(o)}}})}pxt.BrowserUtils.isSafari()&&pxt.BrowserUtils.isIOS()&&document.addEventListener("pointerup",e=>{setTimeout(()=>{w.Touch.checkTouchIdentifier(e)&&w.Touch.clearTouchIdentifier()})})}}function $(e,t){var i,n=e.split(/\s*\|\s*/),o=[];for(i of n)switch(i){case"number":o.push("Number");break;case"string":o.push("String");break;case"boolean":o.push("Boolean");break;case"T":case"any":return null;case"void":return;default:if((0,a.isArrayType)(i)){if(1<n.length)return null;o.push("Array")}var r=t.apis.byQName[i];r&&r.extendsTypes&&0<r.extendsTypes.length?o.push(...r.extendsTypes):o.push(i)}return o}function P(e,t,i){t=$(t,i);!t&&null!==t||e.setOutput(!0,t)}I.initAccessibleBlocksContextMenuItems=function(){(0,h.initAccessibleBlocksCopyPasteContextMenu)()},I.getBlocklyCheckForType=$,I.setOutputCheck=P;let B={};function F(e,t){return{field:e,name:t}}function U(n,o){return pxt.Util.values(n.byQName).filter(e=>{return 4===e.kind&&e.attributes.fixedInstance&&(t=n,(e=e.retType)==(i=o)||!(!(t=t.byQName[e])||!t.extendsTypes)&&0<=t.extendsTypes.indexOf(i));var t,i}).sort((e,t)=>(t.attributes.weight||50)-(e.attributes.weight||50))}I.getFixedInstanceDropdownValues=U,I.generateIcons=function(e){let t=new pxt.ImageConverter;e.forEach(e=>{e.attributes.jresURL&&!e.attributes.iconURL&&pxt.Util.startsWith(e.attributes.jresURL,"data:image/x-mkcd-f")&&(e.attributes.iconURL=t.convert(e.attributes.jresURL))})},I.setVarFieldValue=function(e,t,i){var n=e.getField(t),o=e.workspace.getVariableMap().getAllVariables();let r=!1;if(o&&o.length)for(let e=0;e<o.length;e++){var s=o[e];s.getName()===i&&(n.setValue(s.getId()),r=!0)}r||(n.initModel(),(t=n.getVariable()).setName(i),n.setValue(t.getId()))}},{"./builtins/functions":3,"./builtins/lists":4,"./builtins/logic":5,"./builtins/loops":6,"./builtins/math":7,"./builtins/misc":8,"./builtins/text":9,"./builtins/variables":10,"./codecardRenderer":11,"./compiler/compiler":12,"./compiler/util":15,"./composableMutations":17,"./constants":18,"./contextMenu":21,"./copyPaste":23,"./external":25,"./fields":70,"./fields/field_dropdown":34,"./help":72,"./legacyMutations":76,"./plugins/duplicateOnDrag":91,"./plugins/functions":111,"./plugins/functions/utils":114,"./plugins/newVariableField/fieldVariable":122,"./toolbox":139,blockly:219}],78:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.monkeyPatchBlockSvg=void 0;let o=e("blockly"),r=e("../fields/field_imagenotext"),s=e("../plugins/renderer/constants");i.monkeyPatchBlockSvg=function(){let n=o.BlockSvg.prototype.setCollapsed;o.BlockSvg.prototype.setCollapsed=function(e){var t,i;e!==this.isCollapsed()&&(n.call(this,e),this.isCollapsed())&&(t=this.getInput(o.constants.COLLAPSED_INPUT_NAME),i=s.ConstantProvider.EXPAND_IMAGE_DATAURI)&&t.appendField(new r.FieldImageNoText(i,24,24,"",()=>{this.setCollapsed(!1)},!1))}}},{"../fields/field_imagenotext":38,"../plugins/renderer/constants":126,blockly:219}],79:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.monkeyPatchGesture=void 0;let n=e("blockly");i.monkeyPatchGesture=function(){if(pxt.BrowserUtils.isAndroid()&&pxt.BrowserUtils.isInGame()){let t=n.Gesture.prototype.doStart,i=(n.Gesture.prototype.doStart=function(e){this.id?(e.stopPropagation(),e.preventDefault()):(this.id=e.pointerId,t.call(this,e))},n.Gesture.prototype.bindMouseEvents=function(e){this.boundEvents_||(this.boundEvents_=[]);let i=e=>{var t=new PointerEvent(e.type,Object.assign(Object.assign({},e),{clientX:e.clientX,clientY:e.clientY,pointerId:this.id}));return t.stopPropagation=()=>e.stopPropagation(),t.stopImmediatePropagation=()=>e.stopImmediatePropagation(),t.preventDefault=()=>e.preventDefault(),t};var t=t=>e=>{if("pointerup"===e.type)e=i(e);else if(e.pointerId!==this.id)return;try{t.call(this,e)}catch(e){pxt.error("Uncaught error while executing gesture handler",e),this.cancel(),this.dispose()}};this.boundEvents_.push(n.browserEvents.conditionalBind(document,"pointerdown",null,t(this.handleStart),!0)),this.boundEvents_.push(n.browserEvents.conditionalBind(document,"pointermove",null,t(this.handleMove),!0)),this.boundEvents_.push(n.browserEvents.conditionalBind(document,"pointerup",null,t(this.handleUp),!0)),e.preventDefault(),e.stopPropagation()},n.Gesture.prototype.dispose);n.Gesture.prototype.dispose=function(){if(i.call(this),this.boundEvents_){for(var e of this.boundEvents_)n.browserEvents.unbind(e);this.boundEvents_.length=0}}}}},{blockly:219}],80:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.monkeyPatchGrid=void 0;let o=e("blockly");i.monkeyPatchGrid=function(){let e,t,a=null==(e=pxt.appTarget.appTheme.blocklyOptions)?void 0:e.grid;if(null!=(t=null==a?void 0:a.image)&&t.path){let r=[],s=(o.Grid.createDom=function(e,t,i,n){e="blocklyGridPattern"+e,i=o.utils.dom.createSvgElement(o.utils.Svg.PATTERN,{id:e,patternUnits:"userSpaceOnUse",width:a.image.width,height:a.image.height},i);return r.push(e),o.utils.dom.createSvgElement(o.utils.Svg.IMAGE,{width:a.image.width,height:a.image.height,opacity:a.image.opacity},i).setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",a.image.path),n&&n.style.setProperty("--blocklyGridPattern",`url(#${i.id})`),i},o.Grid.prototype.update);o.Grid.prototype.update=function(e){s.call(this,e);var t,i,n=[];for(t of r){var o=document.getElementById(t);o?(o.setAttribute("width",a.image.width),o.setAttribute("height",a.image.height),o.setAttribute("patternTransform","scale("+e+")")):n.push(t)}for(i of n)r.splice(r.indexOf(i),1)}}}},{blockly:219}],81:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.applyMonkeyPatches=void 0;let n=e("./blockSvg"),o=e("./gesture"),r=e("./grid");i.applyMonkeyPatches=function(){(0,n.monkeyPatchBlockSvg)(),(0,r.monkeyPatchGrid)(),(0,o.monkeyPatchGesture)()}},{"./blockSvg":78,"./gesture":79,"./grid":80}],82:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});let f=e("blockly"),m=e("../functions/constants"),n=e("../../fields/field_imagenotext");f.Blocks.lists_create_with=Object.assign(Object.assign({},{valueConnections_:[],horizontalAfter_:3,itemCount_:3,mutationToDom:function(){var e=f.utils.xml.createElement("mutation");return e.setAttribute("items",this.itemCount_+""),this.horizontalAfter_&&e.setAttribute("horizontalafter",this.horizontalAfter_+""),e},domToMutation:function(e){this.itemCount_=parseInt(e.getAttribute("items"),10);e=e.getAttribute("horizontalafter");e&&(this.horizontalAfter_=parseInt(e,10)),this.updateShape_()},storeConnections_:function(){this.valueConnections_=[];for(let e=0;e<this.itemCount_;e++)this.valueConnections_.push(this.getInput("ADD"+e).connection.targetConnection)},restoreConnections_:function(){var t;for(let e=0;e<this.itemCount_;e++)null!=(t=this.valueConnections_[e])&&t.reconnect(this,"ADD"+e)},addItem_:function(){this.storeConnections_();if(this.update_(()=>{this.itemCount_++}),this.restoreConnections_(),1<this.itemCount_){var e=this.getInput("ADD0");if(e&&e.connection.targetConnection){var t=this.getInput("ADD"+(this.itemCount_-1)),i=e.connection.getShadowDom(),n=i&&i.getAttribute("type");if(n){var o=g("shadow",n),r=h(i,"value");for(let e=0;e<r.length;e++){var s=r[e],a=s.getAttribute("name"),s=h(s,"shadow")[0];p(o,a,s&&s.getAttribute("type"))}t.connection.setShadowDom(o)}var i=e.connection.targetConnection,l=i&&i.getSourceBlock(),e=l&&l.type;if(e&&e!==n){var c=g("block",e);if(l)if(e===m.FUNCTION_CALL_OUTPUT_BLOCK_TYPE){i=f.utils.xml.createElement("mutation");i.setAttribute("name",l.getName()),c.appendChild(i)}else if(l.inputList)for(let e=0;e<l.inputList.length;e++){var u=l.inputList[e],d=u.connection&&u.connection.getShadowDom(),d=d&&d.getAttribute("type");p(c,u.name,d)}n=f.Xml.domToBlock(c,this.workspace);t.connection.connect(n.outputConnection)}else t.connection.setShadowDom(t.connection.getShadowDom())}}function h(t,i){var n=[];if(t&&t.children)for(let e=0;e<t.children.length;e++){var o=t.children[e];o.tagName===i&&n.push(o)}return n}function p(e,t,i){var n;t&&i&&((n=f.utils.xml.createElement("value")).setAttribute("name",t),n.appendChild(g("shadow",i)),e.appendChild(n))}function g(e,t){e=f.utils.xml.createElement(e);return e.setAttribute("type",t),e.setAttribute("id",f.utils.idGenerator.genUid()),e}},removeItem_:function(){this.storeConnections_();this.update_(()=>{this.itemCount_--}),this.restoreConnections_()},update_:function(e){f.Events.setGroup(!0);let t=this;var i=t.mutationToDom(),i=i&&f.Xml.domToText(i);e&&e.call(this),this.updateShape_(),t instanceof f.BlockSvg&&t.initSvg();let n=f.Events.getGroup();e=t.mutationToDom(),e=e&&f.Xml.domToText(e);i!=e&&(f.Events.fire(new f.Events.BlockChange(t,"mutation",null,i,e)),setTimeout(function(){f.Events.setGroup(n),t.bumpNeighbours(),f.Events.setGroup(!1)},f.config.bumpDelay)),t.rendered&&t instanceof f.BlockSvg&&t.queueRender(),f.Events.setGroup(!1)},updateShape_:function(){var e=()=>{this.removeItem_()};this.itemCount_?(this.getInput("EMPTY")&&this.removeInput("EMPTY"),this.getInput("TITLE")||this.appendDummyInput("TITLE").appendField(f.Msg.LISTS_CREATE_WITH_INPUT_WITH)):(this.getInput("TITLE")&&this.removeInput("TITLE"),this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(f.Msg.LISTS_CREATE_EMPTY_TITLE));let t=0;for(t=0;t<this.itemCount_;t++)this.getInput("ADD"+t)||this.appendValueInput("ADD"+t);for(;this.getInput("ADD"+t);)this.removeInput("ADD"+t),t++;this.getInput("BUTTONS")&&this.removeInput("BUTTONS");var i=this.appendDummyInput("BUTTONS"),e=(0<this.itemCount_&&i.appendField(new n.FieldImageNoText(this.REMOVE_IMAGE_DATAURI,24,24,"*",e,!1)),i.appendField(new n.FieldImageNoText(this.ADD_IMAGE_DATAURI,24,24,"*",()=>{this.addItem_()},!1)),this.itemCount_<=this.horizontalAfter_);this.setInputsInline(e),this.workspace instanceof f.WorkspaceSvg&&(i=this.workspace.getRenderer(),this.setOutputShape(e?i.getConstants().SHAPES.ROUND:i.getConstants().SHAPES.SQUARE))}}),{init:function(){var e;f.Extensions.apply("inline-svgs",this,!1),this.setHelpUrl(f.Msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.updateShape_(),this.setOutput(!0,"Array"),this.workspace instanceof f.WorkspaceSvg&&(e=this.workspace.getRenderer(),this.setOutputShape(e.getConstants().SHAPES.ROUND)),this.setInputsInline(!0),this.setTooltip(f.Msg.LISTS_CREATE_WITH_TOOLTIP)}})},{"../../fields/field_imagenotext":38,"../functions/constants":105,blockly:219}],83:[function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,o)}:function(e,t,i,n){e[n=void 0===n?i:n]=t[i]}),o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),o(e("./createList"),i)},{"./createList":82}],84:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.CommentIcon=void 0;let n=e("blockly"),o=e("./textinput_bubble"),r=e("../../fields"),s=n.Events,a="~commentOffsetX",l="~commentOffsetY";class c extends n.icons.Icon{constructor(e){super(e),this.sourceBlock=e,this.textInputBubble=null,this.text="",this.bubbleSize=new n.utils.Size(160,80),this.bubbleVisiblity=!1}getType(){return c.TYPE}initView(e){this.svgRoot||(super.initView(e),n.utils.dom.createSvgElement(n.utils.Svg.PATH,{class:"blocklyIconShape",d:"m 2,2 0,9.2211 3.0026599,0 1.6008929,1.5989 1.8138195,-1.5989 6.6046683,0 0,-9.2211 -13.0220406,0 z",style:"fill: #fff;"},this.svgRoot),n.utils.dom.createSvgElement("rect",{class:"blocklyIconSymbol",x:"4",y:"8",height:"1",width:"6",style:"fill: #575E75;"},this.svgRoot),n.utils.dom.createSvgElement(n.utils.Svg.RECT,{class:"blocklyIconSymbol",x:"4",y:"6",height:"1",width:"6",style:"fill: #575E75;"},this.svgRoot),n.utils.dom.createSvgElement("rect",{class:"blocklyIconSymbol",x:"4",y:"4",height:"1",width:"8",style:"fill: #575E75;"},this.svgRoot),n.utils.dom.addClass(this.svgRoot,"blockly-icon-comment"))}dispose(){var e;super.dispose(),null!=(e=this.textInputBubble)&&e.dispose()}getWeight(){return c.WEIGHT}getSize(){return new n.utils.Size(17,17)}applyColour(){super.applyColour();var e,t=this.sourceBlock.style.colourPrimary,i=this.sourceBlock.style.colourTertiary;null!=(e=this.textInputBubble)&&e.setColour(t,i)}async updateEditable(){super.updateEditable(),this.bubbleIsVisible()&&(await this.setBubbleVisible(!1),await this.setBubbleVisible(!0))}onLocationChange(e){super.onLocationChange(e);var t,e=this.getAnchorLocation();null!=(t=this.textInputBubble)&&t.setAnchorLocation(e)}setText(e){this.text||e||this.clearSavedOffsetData();var t=this.text;s.fire(new(s.get(s.BLOCK_CHANGE))(this.sourceBlock,"comment",null,t,e)),this.text=e,null!=(t=this.textInputBubble)&&t.setText(this.text)}getText(){return this.text}setBubbleSize(e){this.bubbleSize=e,null!=(e=this.textInputBubble)&&e.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}saveState(){return this.text?{text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width}:null}loadState(e){var t;this.text=null!=(t=e.text)?t:"",this.bubbleSize=new n.utils.Size(null!=(t=e.width)?t:160,null!=(t=e.height)?t:80),this.bubbleVisiblity=null!=(t=e.pinned)&&t,this.setBubbleVisible(this.bubbleVisiblity)}setBubbleLocation(e){}getBubbleLocation(){var e;return!this.bubbleIsVisible()||null==(e=this.textInputBubble)?void 0:e.getRelativeToSurfaceXY()}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){var e;this.textInputBubble&&(e=this.textInputBubble.getText(),this.text!==e)&&(s.fire(new(s.get(s.BLOCK_CHANGE))(this.sourceBlock,"comment",null,this.text,e)),this.text=e)}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}onPositionChange(){var e;this.textInputBubble&&(e=this.textInputBubble.getPositionRelativeToAnchor(),(0,r.setBlockDataForField)(this.sourceBlock,a,e.x+""),(0,r.setBlockDataForField)(this.sourceBlock,l,e.y+""))}bubbleIsVisible(){return this.bubbleVisiblity}async setBubbleVisible(e){this.bubbleVisiblity===e||e&&this.textInputBubble||(e||this.textInputBubble)&&(this.bubbleVisiblity=e,!this.sourceBlock.rendered||this.sourceBlock.isInFlyout||this.sourceBlock.isInsertionMarker()||(await n.renderManagement.finishQueuedRenders(),!this.sourceBlock.rendered)||this.sourceBlock.isInFlyout||this.sourceBlock.isInsertionMarker()||(e?(this.sourceBlock.isEditable()?this.showEditableBubble():this.showNonEditableBubble(),this.applyColour()):this.hideBubble(),this.sourceBlock.isEditable()&&s.fire(new(s.get(s.BUBBLE_OPEN))(this.sourceBlock,e,"comment"))))}getBubble(){return this.textInputBubble}showEditableBubble(){var e=this.getSavedOffsetData();this.textInputBubble=new o.TextInputBubble(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.textInputBubble.addTextChangeListener(()=>this.onTextChange()),this.textInputBubble.addSizeChangeListener(()=>this.onSizeChange()),this.textInputBubble.addPositionChangeListener(()=>this.onPositionChange()),this.textInputBubble.setDeleteHandler(()=>{this.setBubbleVisible(!1),this.sourceBlock.setCommentText(null),this.clearSavedOffsetData()}),this.textInputBubble.setCollapseHandler(()=>{this.setBubbleVisible(!1)}),e&&this.textInputBubble.setPositionRelativeToAnchor(e.x,e.y),n.getFocusManager().focusNode(this.textInputBubble)}showNonEditableBubble(){var e=this.getSavedOffsetData();this.textInputBubble=new o.TextInputBubble(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect(),!0),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.textInputBubble.setCollapseHandler(()=>{this.setBubbleVisible(!1)}),e&&this.textInputBubble.setPositionRelativeToAnchor(e.x,e.y),n.getFocusManager().focusNode(this.textInputBubble)}hideBubble(){var e;null!=(e=this.textInputBubble)&&e.dispose(),this.textInputBubble=null,n.getFocusManager().focusNode(this.getSourceBlock())}getAnchorLocation(){return n.utils.Coordinate.sum(this.workspaceLocation,new n.utils.Coordinate(8.5,8.5))}getBubbleOwnerRect(){var e=this.sourceBlock.getSvgRoot().getBBox();return new n.utils.Rect(e.y,e.y+e.height,e.x,e.x+e.width)}getSavedOffsetData(){var e=(0,r.getBlockDataForField)(this.sourceBlock,a),t=(0,r.getBlockDataForField)(this.sourceBlock,l);return e&&t?new n.utils.Coordinate(parseFloat(e),parseFloat(t)):new n.utils.Coordinate(16,16)}clearSavedOffsetData(){(0,r.deleteBlockDataForField)(this.sourceBlock,a),(0,r.deleteBlockDataForField)(this.sourceBlock,l)}}(i.CommentIcon=c).TYPE=n.icons.IconType.COMMENT,c.WEIGHT=3,n.icons.registry.unregister(c.TYPE.toString()),n.icons.registry.register(c.TYPE,c)},{"../../fields":70,"./textinput_bubble":87,blockly:219}],85:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Bubble=void 0;let l=e("blockly");var o=l.utils.dom;class r{constructor(e,t,i,n){this.workspace=e,this.anchor=t,this.ownerRect=i,this.size=new l.utils.Size(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeTop=0,this.relativeLeft=0,this.dragStrategy=new l.dragging.BubbleDragStrategy(this,this.workspace),this.id=l.utils.idGenerator.getNextUniqueId(),this.svgRoot=o.createSvgElement(l.utils.Svg.G,{class:"blocklyBubble"},e.getBubbleCanvas());t=o.createSvgElement(l.utils.Svg.G,{},this.svgRoot);this.tail=o.createSvgElement(l.utils.Svg.LINE,{"stroke-width":"3","stroke-linecap":"round"},t),this.background=o.createSvgElement(l.utils.Svg.RECT,{class:"blocklyDraggable","stroke-width":"3",x:0,y:0},t),this.contentContainer=o.createSvgElement(l.utils.Svg.G,{},this.svgRoot),this.topBar=o.createSvgElement(l.utils.Svg.RECT,{class:"blocklyCommentTopbarBackground",x:r.BORDER_WIDTH,y:r.BORDER_WIDTH},t),this.deleteIcon=o.createSvgElement(l.utils.Svg.IMAGE,{class:"blocklyDeleteIcon",href:e.options.pathToMedia+"delete-icon.svg"},t),this.collapseIcon=o.createSvgElement(l.utils.Svg.IMAGE,{class:"blocklyFoldoutIcon",href:e.options.pathToMedia+"foldout-icon.svg"},t),this.focusableElement=null!=n?n:this.svgRoot,this.focusableElement.setAttribute("id",this.id),l.browserEvents.conditionalBind(this.background,"pointerdown",this,this.onMouseDown),l.browserEvents.conditionalBind(this.topBar,"pointerdown",this,this.onMouseDown),l.browserEvents.conditionalBind(this.collapseIcon,"pointerdown",this,this.onCollapseDown),l.browserEvents.conditionalBind(this.deleteIcon,"pointerdown",this,this.onDeleteDown)}dispose(){this.disposed||(o.removeNode(this.svgRoot),this.disposed=!0,this.isDragDelete&&this.deleteHandler&&this.deleteHandler())}setAnchorLocation(e,t=!1){this.anchor=e,t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(e,t){this.relativeLeft=e,this.relativeTop=t,this.positionRelativeToAnchor(),this.renderTail()}getPositionRelativeToAnchor(){return new l.utils.Coordinate(this.relativeLeft,this.relativeTop)}getSize(){return this.size}setSize(e,t=!1){var i=this.topBar.getBBox(),n=this.deleteIcon.getBBox(),o=this.collapseIcon.getBBox();e.width=Math.max(e.width,r.MIN_SIZE),e.height=Math.max(e.height,r.MIN_SIZE),this.size=e,this.background.setAttribute("width",""+e.width),this.background.setAttribute("height",""+e.height),this.topBar.setAttribute("width",""+(e.width-r.DOUBLE_BORDER)),this.updateDeleteIconPosition(e,i,n),this.updateFoldoutIconPosition(i,o),t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(e,t){this.colour=e,this.tail.setAttribute("stroke",t||e),this.background.setAttribute("fill",t||e),this.background.setAttribute("stroke",t||e),this.svgRoot.setAttribute("style","--commentBorderColour: "+e)}onMouseDown(e){var t;null!=(t=this.workspace.getGesture(e))&&t.handleBubbleStart(e,this),l.common.setSelected(this),l.getFocusManager().focusNode(this)}positionRelativeToAnchor(){let e=this.anchor.x;this.workspace.RTL?e-=this.relativeLeft+this.size.width:e+=this.relativeLeft;var t=this.relativeTop+this.anchor.y;this.moveTo(e,t)}moveTo(e,t){this.svgRoot.setAttribute("transform",`translate(${e}, ${t})`)}positionByRect(e=new l.utils.Rect(0,0,0,0)){var t=this.workspace.getMetricsManager().getViewMetrics(!0),i=this.getOptimalRelativeLeft(t),n=this.getOptimalRelativeTop(t),o={x:i,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},r={x:-this.size.width-30,y:n},n={x:e.getWidth(),y:n},i={x:i,y:e.getHeight()},s=e.getWidth()<e.getHeight()?n:i,e=e.getWidth()<e.getHeight()?i:n,i=this.getOverlap(o,t),n=this.getOverlap(r,t),a=this.getOverlap(s,t),t=this.getOverlap(e,t),t=Math.max(i,n,a,t);i===t?(this.relativeLeft=o.x,this.relativeTop=o.y):n===t?(this.relativeLeft=r.x,this.relativeTop=r.y):a===t?(this.relativeLeft=s.x,this.relativeTop=s.y):(this.relativeLeft=e.x,this.relativeTop=e.y),this.positionRelativeToAnchor()}getOverlap(e,t){var e={x:this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x+this.anchor.x,y:e.y+this.anchor.y},i={x:e.x+this.size.width,y:e.y+this.size.height},n={x:t.left,y:t.top},t={x:t.left+t.width,y:t.top+t.height},o=Math.min(i.x,t.x)-Math.max(e.x,n.x),i=Math.min(i.y,t.y)-Math.max(e.y,n.y);return Math.max(0,Math.min(1,o*i/(this.size.width*this.size.height)))}getOptimalRelativeLeft(e){let t=-this.size.width/4;var i,n;return this.size.width>e.width||(e=this.getWorkspaceViewRect(e),this.workspace.RTL?(i=this.anchor.x-t)-this.size.width<e.left?t=-(e.left-this.anchor.x+this.size.width):i>e.right&&(t=-(e.right-this.anchor.x)):(n=(i=t+this.anchor.x)+this.size.width,i<e.left?t=e.left-this.anchor.x:n>e.right&&(t=e.right-this.anchor.x-this.size.width))),t}getOptimalRelativeTop(e){let t=-this.size.height/4;var i,n;return this.size.height>e.height||(i=(n=this.anchor.y+t)+this.size.height,n<(n=this.getWorkspaceViewRect(e)).top?t=n.top-this.anchor.y:i>n.bottom&&(t=n.bottom-this.anchor.y-this.size.height)),t}getWorkspaceViewRect(e){var t=e.top,i=e.top+e.height;let n=e.left,o=e.left+e.width;return i-=this.getScrollbarThickness(),this.workspace.RTL?n-=this.getScrollbarThickness():o-=this.getScrollbarThickness(),new l.utils.Rect(t,i,n,o)}getScrollbarThickness(){return l.Scrollbar.scrollbarThickness/this.workspace.scale}renderTail(){var e=this.size.width/2,t=this.size.height/2,i=-this.relativeLeft,n=-this.relativeTop,o=Math.atan2(t-n,e-i);i+=r.ANCHOR_RADIUS*Math.cos(o),n+=r.ANCHOR_RADIUS*Math.sin(o),this.tail.setAttribute("x1",e+""),this.tail.setAttribute("y1",t+""),this.tail.setAttribute("x2",i+""),this.tail.setAttribute("y2",n+"")}bringToFront(){var e=null==(e=this.svgRoot)?void 0:e.parentNode;return!(!this.svgRoot||(null==e?void 0:e.lastChild)===this.svgRoot||(null!=e&&e.appendChild(this.svgRoot),0))}getRelativeToSurfaceXY(){return new l.utils.Coordinate(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(e){this.moveTo(e.x,e.y),this.workspace.RTL?this.relativeLeft=this.anchor.x-e.x-this.size.width:this.relativeLeft=e.x-this.anchor.x,this.relativeTop=e.y-this.anchor.y,this.renderTail()}setDragging(e){}setDeleteStyle(e){(this.isDragDelete=e)?o.addClass(this.getSvgRoot(),"blocklyDraggingDelete"):o.removeClass(this.getSvgRoot(),"blocklyDraggingDelete")}isDeletable(){return!1}showContextMenu(e){}isMovable(){return!0}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){l.common.fireSelectedEvent(this)}unselect(){l.common.fireSelectedEvent(null)}getFocusableElement(){return this.focusableElement}getFocusableTree(){return this.workspace}onNodeFocus(){this.select(),this.bringToFront()}onNodeBlur(){this.unselect()}canBeFocused(){return!0}contentTop(){var e=this.topBar.getBBox();return r.BORDER_WIDTH+e.height}setDeleteHandler(e){this.deleteHandler=e}setCollapseHandler(e){this.collapseHandler=e}onDeleteDown(e){l.browserEvents.isRightButton(e)||this.deleteHandler&&(e.preventDefault(),this.deleteHandler()),e.stopPropagation()}onCollapseDown(e){l.browserEvents.isRightButton(e)||this.collapseHandler&&(e.preventDefault(),this.collapseHandler()),e.stopPropagation()}updateDeleteIconPosition(e,t,i){t=this.calcDeleteMargin(t,i);this.deleteIcon.setAttribute("y",""+t),this.deleteIcon.setAttribute("x",""+(e.width-i.width-t))}updateFoldoutIconPosition(e,t){e=this.calcFoldoutMargin(e,t);this.collapseIcon.setAttribute("y",""+e),this.collapseIcon.setAttribute("x",""+e)}calcDeleteMargin(e,t){return(e.height-t.height)/2+r.BORDER_WIDTH}calcFoldoutMargin(e,t){return(e.height-t.height)/2+r.BORDER_WIDTH}}(e=i.Bubble=r).BORDER_WIDTH=0,r.DOUBLE_BORDER=2*e.BORDER_WIDTH,r.MIN_SIZE=e.DOUBLE_BORDER,r.ANCHOR_RADIUS=8,l.Css.register(`
.blocklyBubble .blocklyDeleteIcon, .blocklyBubble .blocklyFoldoutIcon {
    filter: grayscale(100%) brightness(100000);
}

.blocklyBubble .blocklyTextarea.blocklyText {
    color: #575E75;
}
`)},{blockly:219}],86:[function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,o)}:function(e,t,i,n){e[n=void 0===n?i:n]=t[i]}),o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),o(e("./blockComment"),i)},{"./blockComment":84}],87:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.TextInputBubble=void 0;let o=e("./bubble.js"),r=e("blockly");var s=r.utils.dom,a=r.browserEvents;class l extends o.Bubble{constructor(e,t,i,n){super(e,t,i,l.createTextArea()),this.workspace=e,this.anchor=t,this.ownerRect=i,this.readOnly=n,this.resizePointerUpListener=null,this.resizePointerMoveListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.positionChangeListeners=[],this.text="",this.DEFAULT_SIZE=new r.utils.Size(160+o.Bubble.DOUBLE_BORDER,80+o.Bubble.DOUBLE_BORDER),this.MIN_SIZE=new r.utils.Size(45+o.Bubble.DOUBLE_BORDER,20+o.Bubble.DOUBLE_BORDER),s.addClass(this.svgRoot,"blocklyTextInputBubble"),this.textArea=this.getFocusableElement(),this.inputRoot=this.createEditor(this.contentContainer,this.textArea),this.resizeGroup=this.createResizeHandle(this.svgRoot,e),this.setSize(this.DEFAULT_SIZE,!0),n&&(this.deleteIcon.style.display="none"),a.conditionalBind(this.textArea,"keydown",this,this.onKeyDown)}getText(){return this.text}moveTo(e,t){super.moveTo(e,t),this.onPositionChange()}setText(e){this.text=e,this.textArea.value=e,this.onTextChange()}addTextChangeListener(e){this.textChangeListeners.push(e)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}addPositionChangeListener(e){this.positionChangeListeners.push(e)}static createTextArea(){var e=document.createElementNS(s.HTML_NS,"textarea");return e.className="blocklyTextarea blocklyText",e}createEditor(e,t){let i=s.createSvgElement(r.utils.Svg.FOREIGNOBJECT,{x:o.Bubble.BORDER_WIDTH,y:this.contentTop()},e);setTimeout(()=>{i.setAttribute("y",this.contentTop()+"")});e=document.createElementNS(s.HTML_NS,"body");return e.setAttribute("xmlns",s.HTML_NS),e.className="blocklyMinimalBody",t.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),e.appendChild(t),i.appendChild(e),this.bindTextAreaEvents(t),i}bindTextAreaEvents(e){a.conditionalBind(e,"wheel",this,e=>{e.stopPropagation()}),a.conditionalBind(e,"pointerdown",this,e=>{e.stopPropagation(),r.Touch.clearTouchIdentifier()}),a.conditionalBind(e,"change",this,this.onTextChange)}createResizeHandle(e,t){t=s.createSvgElement(r.utils.Svg.IMAGE,{class:"blocklyResizeHandle",href:t.options.pathToMedia+"resize-handle.svg"},e);return a.conditionalBind(t,"pointerdown",this,this.onResizePointerDown),t}setSize(e,t=!1){e.width=Math.max(e.width,this.MIN_SIZE.width),e.height=Math.max(e.height,this.MIN_SIZE.height+this.contentTop());var i=e.width-o.Bubble.DOUBLE_BORDER,n=e.height-this.contentTop()-o.Bubble.BORDER_WIDTH,n=(this.inputRoot.setAttribute("width",""+i),this.inputRoot.setAttribute("height",""+n),this.textArea.style.width="100%",this.textArea.style.height="100%",this.resizeGroup.getBBox());this.workspace.RTL?this.resizeGroup.setAttribute("transform",`translate(${o.Bubble.BORDER_WIDTH}, ${e.height-o.Bubble.BORDER_WIDTH-n.height}) scale(-1 1)`):this.resizeGroup.setAttribute("transform",`translate(${i-n.width}, ${e.height-o.Bubble.BORDER_WIDTH-n.height})`),super.setSize(e,t),this.onSizeChange()}getSize(){return super.getSize()}isDeletable(){return!this.readOnly}onResizePointerDown(e){this.bringToFront(),a.isRightButton(e)||(this.workspace.startDrag(e,new r.utils.Coordinate(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=a.conditionalBind(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=a.conditionalBind(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation()}onResizePointerUp(e){r.Touch.clearTouchIdentifier(),this.resizePointerUpListener&&(a.unbind(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(a.unbind(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(e){e=this.workspace.moveDrag(e);this.setSize(new r.utils.Size(this.workspace.RTL?-e.x:e.x,e.y),!1),this.onSizeChange()}onTextChange(){this.text=this.textArea.value;for(var e of this.textChangeListeners)e()}onSizeChange(){for(var e of this.sizeChangeListeners)e()}onPositionChange(){for(var e of this.positionChangeListeners)e()}onKeyDown(e){"Escape"===e.key&&(this.collapseHandler(),e.stopPropagation())}}i.TextInputBubble=l,r.Css.register(`
.blocklyTextInputBubble .blocklyTextarea {
  background-color: var(--commentFillColour);
  border: 0;
  display: block;
  margin: 0;
  outline: 0;
  padding: 3px;
  resize: none;
  text-overflow: hidden;
}
`)},{"./bubble.js":85,blockly:219}],88:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.DuplicateOnDragConnectionChecker=void 0;let s=e("blockly"),o=e("./duplicateOnDrag"),r=e("../functions/utils"),a=[];a[s.ConnectionType.INPUT_VALUE]=s.ConnectionType.OUTPUT_VALUE,a[s.ConnectionType.OUTPUT_VALUE]=s.ConnectionType.INPUT_VALUE,a[s.ConnectionType.NEXT_STATEMENT]=s.ConnectionType.PREVIOUS_STATEMENT,a[s.ConnectionType.PREVIOUS_STATEMENT]=s.ConnectionType.NEXT_STATEMENT;class n extends s.ConnectionChecker{doDragChecks(e,t,i){var n;return!!super.doDragChecks(e,t,i)&&!((n=t.targetBlock())&&(0,o.shouldDuplicateOnDrag)(n)&&(!n.isShadow()||!(0,o.isAllowlistedShadow)(n))||!(0,r.doArgumentReporterDragChecks)(e,t,i))}doSafetyChecks(e,t){if(!e||!t)return s.Connection.REASON_TARGET_NULL;let i,n,o,r;return e.isSuperior()?(i=e.getSourceBlock(),n=t.getSourceBlock(),o=e,r=t):(n=e.getSourceBlock(),i=t.getSourceBlock(),r=e,o=t),i===n?s.Connection.REASON_SELF_CONNECTION:r.type!==a[o.type]?s.Connection.REASON_WRONG_TYPE:i.workspace!==n.workspace?s.Connection.REASON_DIFFERENT_WORKSPACES:r.type===s.ConnectionType.OUTPUT_VALUE&&n.previousConnection&&n.previousConnection.isConnected()||r.type===s.ConnectionType.PREVIOUS_STATEMENT&&n.outputConnection&&n.outputConnection.isConnected()?s.Connection.REASON_PREVIOUS_AND_OUTPUT:s.Connection.CAN_CONNECT}}i.DuplicateOnDragConnectionChecker=n},{"../functions/utils":114,"./duplicateOnDrag":90,blockly:219}],89:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.setDuplicateOnDragStrategy=i.DuplicateOnDragStrategy=void 0;let u=e("blockly"),d=e("./duplicateOnDrag");var n=u.Events,o=u.utils.Coordinate,r=u.utils.dom;class s{constructor(e){this.block=e,this.startParentConn=null,this.startChildConn=null,this.startLoc=null,this.connectionCandidate=null,this.connectionPreviewer=null,this.dragging=!1,this.originalEventGroup="",this.dragOffset=new o(0,0),this.workspace=e.workspace}isMovable(){var e;return this.block.isShadow()?null!=(e=null==(e=this.block.getParent())?void 0:e.isMovable())&&e:this.block.isOwnMovable()&&!this.block.isDeadOrDying()&&!this.workspace.options.readOnly&&!this.block.isInFlyout}startDrag(e){var t;this.block.isShadow()&&!(0,d.isAllowlistedShadow)(this.block)?this.startDraggingShadow(e):(this.dragging=!0,n.getGroup()||n.setGroup(!0),this.fireDragStartEvent(),this.startLoc=this.block.getRelativeToSurfaceXY(),t=u.registry.getClassFromOptions(u.registry.Type.CONNECTION_PREVIEWER,this.workspace.options),this.connectionPreviewer=new t(this.block),r.startTextWidthCache(),this.workspace.setResizesEnabled(!1),u.blockAnimations.disconnectUiStop(),t=!!e&&(e.altKey||e.ctrlKey||e.metaKey),this.shouldDisconnect(t)&&this.disconnectBlock(t),this.block.setDragging(!0),null!=(e=this.workspace.getLayerManager())&&e.moveToDragLayer(this.block))}startDraggingShadow(e){var t=this.block.getParent();if(!t)throw new Error("Tried to drag a shadow block with no parent. Shadow blocks should always have parents.");this.dragOffset=o.difference(t.getRelativeToSurfaceXY(),this.block.getRelativeToSurfaceXY()),t.startDrag(e)}shouldDisconnect(e){return!!(this.block.getParent()||e&&this.block.nextConnection&&this.block.nextConnection.targetBlock())}disconnectBlock(e){let t,i,n,o,r,s,a;var l=this.block.isShadow();if(l&&this.block.setShadow(!1),(0,d.shouldDuplicateOnDrag)(this.block)){var c=this.block.outputConnection;if(null==c||!c.targetConnection)return;a=u.Xml.blockToDom(this.block,!0),l||(r=u.Xml.domToBlock(a,this.block.workspace)),s=c.targetConnection}this.startParentConn=null!=(i=null==(t=this.block.outputConnection)?void 0:t.targetConnection)?i:null==(n=this.block.previousConnection)?void 0:n.targetConnection,e&&(this.startChildConn=null==(o=this.block.nextConnection)?void 0:o.targetConnection),s&&l&&s.setShadowDom(a),this.block.unplug(e),u.blockAnimations.disconnectUiEffect(this.block),(0,d.updateDuplicateOnDragState)(this.block),s&&r&&s.connect(r.outputConnection)}fireDragStartEvent(){var e=new(n.get(n.BLOCK_DRAG))(this.block,!0,this.block.getDescendants(!1));n.fire(e)}fireDragEndEvent(){var e=new(n.get(n.BLOCK_DRAG))(this.block,!1,this.block.getDescendants(!1));n.fire(e)}fireMoveEvent(){var e;this.block.isDeadOrDying()||((e=new(n.get(n.BLOCK_MOVE))(this.block)).setReason(["drag"]),e.oldCoordinate=this.startLoc,e.recordNew(),n.fire(e))}drag(e){var t;this.block.isShadow()?null!=(t=this.block.getParent())&&t.drag(o.sum(e,this.dragOffset)):(this.block.moveDuringDrag(e),this.updateConnectionPreview(this.block,o.difference(e,this.startLoc)))}updateConnectionPreview(e,t){var i,n=this.connectionCandidate,o=this.getConnectionCandidate(e,t);o?(t=n&&this.currCandidateIsBetter(n,t,o)?n:o,{local:n,neighbour:o}=this.connectionCandidate=t,t=n.type===u.ConnectionType.OUTPUT_VALUE||n.type===u.ConnectionType.PREVIOUS_STATEMENT,i=o.isConnected()&&!o.targetBlock().isInsertionMarker(),t&&i&&!this.orphanCanConnectAtEnd(e,o.targetBlock(),n.type)?this.connectionPreviewer.previewReplacement(n,o,o.targetBlock()):this.connectionPreviewer.previewConnection(n,o)):(this.connectionPreviewer.hidePreview(),this.connectionCandidate=null)}orphanCanConnectAtEnd(e,t,i){i=i===u.ConnectionType.OUTPUT_VALUE?t.outputConnection:t.previousConnection;return!!u.Connection.getConnectionForOrphanedConnection(e,i)}currCandidateIsBetter(e,t,i){var{local:e,neighbour:n}=e,e=new o(e.x,e.y),n=new o(n.x,n.y),e=o.distance(o.sum(e,t),n);return i.distance>e-u.config.currentConnectionPreference}getConnectionCandidate(e,t){var i,e=this.getLocalConnections(e);let n=this.connectionCandidate?u.config.connectingSnapRadius:u.config.snapRadius,o=null;for(i of e){var{connection:r,radius:s}=i.closest(n,t);r&&(o={local:i,neighbour:r,distance:s},n=s)}return o}getLocalConnections(e){var t=e.getConnections_(!1),i=e.lastConnectionInStack(!0);return i&&i!==e.nextConnection&&t.push(i),t}endDrag(e){var t;this.block.isShadow()?null!=(t=this.block.getParent())&&t.endDrag(e):(this.originalEventGroup=n.getGroup(),this.fireDragEndEvent(),this.fireMoveEvent(),r.stopTextWidthCache(),u.blockAnimations.disconnectUiStop(),this.connectionPreviewer.hidePreview(),!this.block.isDeadOrDying()&&this.dragging&&(null!=(t=this.workspace.getLayerManager())&&t.moveOffDragLayer(this.block,u.layers.BLOCK),this.block.setDragging(!1)),this.connectionCandidate?(this.applyConnections(this.connectionCandidate),this.disposeStep()):this.block.queueRender().then(()=>this.disposeStep()))}disposeStep(){var e=n.getGroup();n.setGroup(this.originalEventGroup),this.block.snapToGrid(),this.connectionPreviewer.dispose(),this.workspace.setResizesEnabled(!0),n.setGroup(e)}applyConnections(e){var{local:e,neighbour:t}=e;e.connect(t);let i=e.isSuperior()?t:e,n=this.block.getRootBlock();u.renderManagement.finishQueuedRenders().then(()=>{u.blockAnimations.connectionUiEffect(i.getSourceBlock()),setTimeout(()=>{n.bringToFront()},0)})}revertDrag(){var e;if(this.block.isShadow())null!=(e=this.block.getParent())&&e.revertDrag();else{if(null!=(e=this.startChildConn)&&e.connect(this.block.nextConnection),this.startParentConn)switch(this.startParentConn.type){case u.ConnectionType.INPUT_VALUE:this.startParentConn.connect(this.block.outputConnection);break;case u.ConnectionType.NEXT_STATEMENT:this.startParentConn.connect(this.block.previousConnection)}else this.block.moveTo(this.startLoc,["drag"]),null!=(e=this.workspace.getLayerManager())&&e.moveOffDragLayer(this.block,50),u.bumpObjects.bumpIntoBounds(this.workspace,this.workspace.getMetricsManager().getScrollMetrics(!0),this.block);this.startChildConn=null,this.startParentConn=null,this.connectionPreviewer.hidePreview(),this.connectionCandidate=null,this.block.setDragging(!1),this.dragging=!1}}}i.DuplicateOnDragStrategy=s,i.setDuplicateOnDragStrategy=function(e){var t;null!=(t=e.setDragStrategy)&&t.call(e,new s(e))}},{"./duplicateOnDrag":90,blockly:219}],90:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.updateDuplicateOnDragState=i.shouldDuplicateOnDrag=i.isAllowlistedShadow=i.setDuplicateOnDrag=i.setDraggableShadowBlocks=void 0;let n,r;function s(e){return!(!n||-1===n.indexOf(e.type))}function o(e){var i,n,o;if(e.isShadow()&&s(e))return!0;if(r){let t=null==(i=e.outputConnection)?void 0:i.targetBlock();if(t)for(o of r.filter(e=>e.parentBlockType===t.type))if(o&&(!o.childBlockType||o.childBlockType===e.type)){if(!o.inputName)return!0;if((null==(n=e.outputConnection.targetConnection.getParentInput())?void 0:n.name)===o.inputName)return!0}}return!1}i.setDraggableShadowBlocks=function(e){n=e},i.setDuplicateOnDrag=function(t,i,n){(r=r||[]).some(e=>e.parentBlockType===t&&e.inputName===i&&e.childBlockType===n)||r.push({parentBlockType:t,inputName:i,childBlockType:n})},i.isAllowlistedShadow=s,i.shouldDuplicateOnDrag=o,i.updateDuplicateOnDragState=function(t){setTimeout(()=>{var e=o(t);t.pathObject&&t.pathObject.setHasDottedOutlineOnHover(e),t.setDeletable(!e)})}},{}],91:[function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,o)}:function(e,t,i,n){e[n=void 0===n?i:n]=t[i]}),o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),o(e("./duplicateOnDrag"),i),o(e("./variablesGetReporter"),i),o(e("./connectionChecker"),i),o(e("./dragStrategy"),i)},{"./connectionChecker":88,"./dragStrategy":89,"./duplicateOnDrag":90,"./variablesGetReporter":92}],92:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});let n=e("blockly"),o=e("./duplicateOnDrag");n.Blocks.variables_get_reporter={init:function(){this.jsonInit({type:"variables_get_reporter",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}",variableTypes:[""]}],output:null,colour:"%{BKY_VARIABLES_HUE}",outputShape:(new n.zelos.ConstantProvider).SHAPES.ROUND,helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableReporter"]}),(0,o.updateDuplicateOnDragState)(this)}}},{"./duplicateOnDrag":90,blockly:219}],93:[function(e,t,o){Object.defineProperty(o,"__esModule",{value:!0}),o.MultiFlyoutRecyclableBlockInflater=o.HIDDEN_CLASS_NAME=void 0;let r=e("blockly");o.HIDDEN_CLASS_NAME="pxtFlyoutHidden";class i extends r.BlockFlyoutInflater{constructor(){super(...arguments),this.keyToBlock=new Map,this.blockToKey=new Map}static register(){r.registry.register(r.registry.Type.FLYOUT_INFLATER,"block",i,!0)}isBlockRecycleable(e){switch(e.type){case"variables_get":case"variables_set":case"variables_change":return!1}return!0}createBlock(e,t){var i=(e=>e.blockxml?"string"==typeof e.blockxml?e.blockxml:r.Xml.domToText(e.blockxml):e.type)(e);if(!i)return super.createBlock(e,t);let n;return this.keyToBlock.has(i)&&(n=this.keyToBlock.get(i),this.keyToBlock.delete(i)),n=null!=n?n:super.createBlock(e,t),this.blockToKey.set(n,i),n.removeClass(o.HIDDEN_CLASS_NAME),n.setDisabledReason(!1,o.HIDDEN_CLASS_NAME),n}disposeItem(e){var t=e.getElement();if(t instanceof r.BlockSvg&&this.blockToKey.has(t)){if(this.isBlockRecycleable(t))return void this.recycleBlock(t);this.blockToKey.delete(t)}super.disposeItem(e)}clearCache(){this.blockToKey=new Map,this.keyToBlock=new Map}recycleBlock(e){var t=e.getRelativeToSurfaceXY(),t=(e.moveBy(-t.x,-t.y),e.addClass(o.HIDDEN_CLASS_NAME),e.setDisabledReason(!0,o.HIDDEN_CLASS_NAME),this.blockToKey.get(e));this.keyToBlock.set(t,e),this.removeListeners(e.id)}}o.MultiFlyoutRecyclableBlockInflater=i,r.Css.register(`
.${o.HIDDEN_CLASS_NAME} {
    display: none;
}
`)},{blockly:219}],94:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ButtonFlyoutInflater=void 0;let n=e("blockly"),o=e("./flyoutButton");class r extends n.ButtonFlyoutInflater{static register(){n.registry.register(n.registry.Type.FLYOUT_INFLATER,"button",r,!0)}load(e,t){t=new o.FlyoutButton(t.getWorkspace(),t.targetWorkspace,e,!1);return e.id&&t.getSvgRoot().setAttribute("id",e.id),t.show(),new n.FlyoutItem(t,"button")}}i.ButtonFlyoutInflater=r},{"./flyoutButton":96,blockly:219}],95:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.CachingFlyout=void 0;var n=e("blockly");let o=e("./blockInflater");class r extends n.VerticalFlyout{constructor(){super(...arguments),this.forceOpen=!1}clearBlockCache(){var e=this.getInflaterForType("block");e instanceof o.MultiFlyoutRecyclableBlockInflater&&e.clearCache()}getFlyoutElement(){return this.svgGroup_}setForceOpen(e){this.forceOpen=e}}i.CachingFlyout=r},{"./blockInflater":93,blockly:219}],96:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FlyoutButton=void 0;let d=e("blockly"),h={"ïŠ‡":"usb","ï¨":"accessible-icon","ï…°":"adn","ï†§":"pied-piper-pp","ï†¶":"steam","ïŠ”":"bluetooth-b","ï‡":"rebel","ï„¶":"maxcdn","ï†ª":"joomla","ïˆ“":"sellsy","ïˆŽ":"connectdevelop","ï„“":"github-alt"};class n extends d.FlyoutButton{constructor(e,t,i,n){super(e,t,i,n);var o=this.getSvgRoot();if(n){var e=i,t=(e["web-class"]&&o.classList.add(e["web-class"]),e["web-icon"]),n=e["web-icon-class"],i=e["web-icon-color"];if(t||n){var r=Object.keys(h).includes(t)?"brandIcon":"",s=d.utils.dom.createSvgElement("text",{class:"blocklyFlyoutLabelIcon"+(n?" "+n:"")+(r?" "+r:""),x:0,y:0,"text-anchor":"start"},o),n=(t&&(s.textContent=t),i&&s.setAttribute("style","fill: "+i),this.getTargetWorkspace()),a=(s.setAttribute("dominant-baseline","central"),s.setAttribute("dy","0"),s.setAttribute("x",(n.RTL?this.width+d.FlyoutButton.TEXT_MARGIN_X:0)+""),s.setAttribute("y",this.height/2+d.FlyoutButton.TEXT_MARGIN_Y+""),d.utils.dom.getTextWidth(s)+2*d.FlyoutButton.TEXT_MARGIN_X),l=(this.width+=a,o.getElementsByClassName("blocklyFlyoutLabelBackground").item(0));l.setAttribute("width",String(this.width));for(let e=0;e<o.children.length;e++){var c,u=o.children.item(e);u!==s&&u!==l&&(c=Number(u.getAttribute("x")),u.setAttribute("x",c+a+""))}}var r=e["web-line"],t=e["web-line-width"];r&&((i=d.utils.dom.createSvgElement("line",{class:"blocklyFlyoutLine","stroke-dasharray":r,"text-anchor":"middle"},o)).setAttribute("x1","0"),i.setAttribute("x2",null!=t?t:this.width+""),i.setAttribute("y1",this.height+10+""),i.setAttribute("y2",this.height+10+""))}else n=this.height,this.width+=2*(17.5-d.FlyoutButton.TEXT_MARGIN_X),this.height+=2*(14-d.FlyoutButton.TEXT_MARGIN_Y),e=o.getElementsByClassName("blocklyFlyoutButtonShadow").item(0),r=o.getElementsByClassName("blocklyFlyoutButtonBackground").item(0),t=o.getElementsByTagName("text").item(0),e.setAttribute("width",String(this.width)),e.setAttribute("height",String(this.height)),r.setAttribute("width",String(this.width)),r.setAttribute("height",String(this.height)),t.setAttribute("x",String(this.width/2)),t.setAttribute("y",String(parseFloat(t.getAttribute("y"))-n/2+this.height/2))}isDisposed(){return null===this.getSvgRoot().parentNode}}i.FlyoutButton=n},{blockly:219}],97:[function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,o)}:function(e,t,i,n){e[n=void 0===n?i:n]=t[i]}),o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),i.registerFlyoutInflaters=i.MultiFlyoutRecyclableBlockInflater=i.LabelFlyoutInflater=i.ButtonFlyoutInflater=void 0;let r=e("./buttonFlyoutInflater"),s=(Object.defineProperty(i,"ButtonFlyoutInflater",{enumerable:!0,get:function(){return r.ButtonFlyoutInflater}}),e("./labelFlyoutInflater")),a=(Object.defineProperty(i,"LabelFlyoutInflater",{enumerable:!0,get:function(){return s.LabelFlyoutInflater}}),e("./blockInflater"));Object.defineProperty(i,"MultiFlyoutRecyclableBlockInflater",{enumerable:!0,get:function(){return a.MultiFlyoutRecyclableBlockInflater}}),o(e("./cachingFlyout"),i),i.registerFlyoutInflaters=function(){r.ButtonFlyoutInflater.register(),s.LabelFlyoutInflater.register(),a.MultiFlyoutRecyclableBlockInflater.register()}},{"./blockInflater":93,"./buttonFlyoutInflater":94,"./cachingFlyout":95,"./labelFlyoutInflater":98}],98:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.LabelFlyoutInflater=void 0;let n=e("blockly"),o=e("./flyoutButton");class r extends n.LabelFlyoutInflater{static register(){n.registry.register(n.registry.Type.FLYOUT_INFLATER,"label",r,!0)}load(e,t){t=new o.FlyoutButton(t.getWorkspace(),t.targetWorkspace,e,!0);return t.show(),new n.FlyoutItem(t,"label")}}i.LabelFlyoutInflater=r},{"./flyoutButton":96,blockly:219}],99:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});let n=e("blockly");i=e("../constants"),e={typeName_:"",getTypeName(){return this.typeName_},removeFieldCallback(e){var t=this.getParent();null!=t&&t.removeFieldCallback&&t.removeFieldCallback(e)}};n.Blocks[i.ARGUMENT_EDITOR_BOOLEAN_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"bool"}],extensions:["output_boolean","text_field_color"]}),this.typeName_="boolean"}}),n.Blocks[i.ARGUMENT_EDITOR_STRING_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"text"}],extensions:["output_string","text_field_color"]}),this.typeName_="string"}}),n.Blocks[i.ARGUMENT_EDITOR_NUMBER_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"num"}],extensions:["output_number","text_field_color"]}),this.typeName_="number"}}),n.Blocks[i.ARGUMENT_EDITOR_ARRAY_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"list"}],extensions:["output_array","text_field_color"]}),this.typeName_="Array"}}),n.Blocks[i.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_editor",name:"TEXT",text:"arg"}],outputShape:(new n.zelos.ConstantProvider).SHAPES.ROUND,extensions:["text_field_color"]}),this.typeName_="any"},mutationToDom(){var e=n.utils.xml.createElement("mutation");return e.setAttribute("typename",this.typeName_),e},domToMutation(e){this.typeName_=e.getAttribute("typename"),this.setOutput(!0,this.typeName_)}})},{"../constants":105,blockly:219}],100:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.LOCALIZATION_NAME_MUTATION_KEY=void 0;let n=e("blockly");var o=e("../constants");let r=e("../msg"),s=e("../../duplicateOnDrag"),a=(i.LOCALIZATION_NAME_MUTATION_KEY="localizationname",{typeName_:"",localizationName_:"",getTypeName(){return this.typeName_},getLocalizationName(){return this.localizationName_||this.getFieldValue("VALUE")},mutationToDom(){var e=n.utils.xml.createElement("mutation");return this.localizationName_&&e.setAttribute(i.LOCALIZATION_NAME_MUTATION_KEY,this.localizationName_),e},domToMutation(e){e.hasAttribute(i.LOCALIZATION_NAME_MUTATION_KEY)&&(this.localizationName_=e.getAttribute(i.LOCALIZATION_NAME_MUTATION_KEY))}});function l(e){(0,s.setDuplicateOnDragStrategy)(e),(0,s.updateDuplicateOnDragState)(e)}n.Blocks[o.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE]=Object.assign(Object.assign({},a),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_reporter",name:"VALUE",text:""}],colour:n.Msg[r.MsgKey.REPORTERS_HUE],extensions:["output_boolean"]}),this.typeName_="boolean",l(this)}}),n.Blocks[o.ARGUMENT_REPORTER_STRING_BLOCK_TYPE]=Object.assign(Object.assign({},a),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_reporter",name:"VALUE",text:""}],colour:n.Msg[r.MsgKey.REPORTERS_HUE],extensions:["output_string"]}),this.typeName_="string",l(this)}}),n.Blocks[o.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE]=Object.assign(Object.assign({},a),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_reporter",name:"VALUE",text:""}],colour:n.Msg[r.MsgKey.REPORTERS_HUE],extensions:["output_number"]}),this.typeName_="number",l(this)}}),n.Blocks[o.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE]=Object.assign(Object.assign({},a),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_reporter",name:"VALUE",text:""}],colour:n.Msg[r.MsgKey.REPORTERS_HUE],extensions:["output_array"]}),this.typeName_="Array",l(this)}}),n.Blocks[o.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE]=Object.assign(Object.assign({},a),{init:function(){this.jsonInit({message0:" %1",args0:[{type:"field_argument_reporter",name:"VALUE",text:""}],colour:n.Msg[r.MsgKey.REPORTERS_HUE],inputsInline:!0,outputShape:(new n.zelos.ConstantProvider).SHAPES.ROUND,output:null}),this.typeName_="",l(this)},mutationToDom(){var e=a.mutationToDom.call(this);return e.setAttribute("typename",this.typeName_),e},domToMutation(e){this.typeName_=e.getAttribute("typename"),this.setOutput(!0,this.typeName_),a.domToMutation.call(this,e)}})},{"../../duplicateOnDrag":91,"../constants":105,"../msg":112,blockly:219}],101:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});let s=e("blockly");i=e("../commonFunctionMixin");let r=e("../constants"),a=e("../utils"),n=e("../msg");e=Object.assign(Object.assign({},i.COMMON_FUNCTION_MIXIN),{populateArgument_:function(t,i,n){let o=null,r=null;i&&t.id in i&&(e=i[t.id],o=e.block,r=e.shadow);var e=null==o?void 0:o.workspace.connectionChecker;s.Events.disable();try{if(o&&!o.isDisposed()&&i&&(null==e?void 0:e.canConnectWithReason(null==o?void 0:o.outputConnection,n.connection,!1))===s.Connection.CAN_CONNECT){o.outputConnection.connect(n.connection);let e;"variables_get"!==(e=o.isShadow()?s.Xml.blockToDom(o):r||this.buildShadowDom_(t.type)).getAttribute("type")&&n.connection.setShadowDom(e),delete i[n.name]}else this.attachShadow_(n,t.type)}finally{s.Events.enable()}},afterWorkspaceLoad:function(){var e,t;for(e of this.inputList)e.type===s.inputs.inputTypes.VALUE&&((t=null==(t=e.connection)?void 0:t.targetBlock())&&t.isShadow()&&t.getVarModels().length&&t.setShadow(!1),t=e.connection&&e.getShadowDom(),(0,a.isVariableBlockType)(null==t?void 0:t.getAttribute("type")))&&e.setShadowDom(null)},addFunctionLabel_:function(e){this.appendDummyInput("function_name").appendField(new s.FieldLabel(e,"functionNameText"),"function_name")},updateFunctionLabel_:function(e){this.getField("function_name").setValue(e)},attachShadow_(e,t){var t=(0,a.getShadowBlockInfoFromType_)(t,this.workspace),i=t[0],n=t[1],t=t[2];s.Events.disable();let o=null;try{(o=this.workspace.newBlock(i)).setFieldValue(t,n),o.setShadow("variables_get"!==i),!this.isInsertionMarker()&&o instanceof s.BlockSvg&&(o.initSvg(),o.queueRender())}finally{s.Events.enable()}o&&(o.setShadow(!0),o.outputConnection.connect(e.connection))},buildShadowDom_(e){var t=s.utils.xml.createElement("shadow"),e=(0,a.getShadowBlockInfoFromType_)(e,this.workspace),i=e[0],n=e[1],e=e[2],o="variables_get"===i,i=(t.setAttribute("type",i),s.utils.xml.createElement("field"));return i.textContent=e,o&&(i.setAttribute("id",e),o=this.workspace.getVariableMap().getVariableById(e),i.textContent=o?o.getName():""),i.setAttribute("name",n),t.appendChild(i),t},onchange(e){var t,i,n,o;this.workspace&&!this.workspace.isFlyout&&(e.type==s.Events.BLOCK_CREATE&&-1!=(null==(o=e.ids)?void 0:o.indexOf(this.id))?(o=this.getName(),(o=(0,a.getDefinition)(o,this.workspace))?(i=o.getArguments().slice(),t=this.arguments_.slice(),JSON.stringify(t)!==JSON.stringify(i)&&(0,a.mutateCallersAndDefinition)(o.getName(),this.workspace,o.mutationToDom()),this.functionId_=o.functionId_):(s.Events.setGroup(e.group),t=s.utils.xml.createElement("xml"),(i=s.utils.xml.createElement("block")).setAttribute("type",r.FUNCTION_DEFINITION_BLOCK_TYPE),n=(o=this.getRelativeToSurfaceXY()).x+s.config.snapRadius*(this.RTL?-1:1),o=o.y+2*s.config.snapRadius,i.setAttribute("x",n+""),i.setAttribute("y",o+""),n=this.mutationToDom(),i.appendChild(n),t.appendChild(i),s.Xml.domToWorkspace(t,this.workspace),s.Events.setGroup(!1))):e.type==s.Events.BLOCK_DELETE&&(o=this.getName(),(0,a.getDefinition)(o,this.workspace)||(s.Events.setGroup(e.group),this.dispose(!0),s.Events.setGroup(!1))))},serializeChangedInputs(e){var t,i,n,o=[],r=(0,a.getArgMap)(e,!0);for(t of this.arguments_)r[t.id]||((n=(i=this.getInput(t.id).connection).targetBlock()).isShadow()?o.push({inputName:t.id,connectedShadow:i.getShadowState(!0)}):o.push({inputName:t.id,connectedBlock:n.id}));return o}});s.Blocks[r.FUNCTION_CALL_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){this.jsonInit({extensions:["function_contextmenu_edit"]}),this.name_="",this.arguments_=[],this.functionId_="",this.setPreviousStatement(!0),this.setNextStatement(!0),this.setColour(s.Msg[n.MsgKey.PROCEDURES_HUE]),this.setHelpUrl(s.Msg[n.MsgKey.PROCEDURES_CALLNORETURN_HELPURL]),this.setTooltip(s.Msg[n.MsgKey.FUNCTION_CALL_TOOLTIP]),this.setInputsInline(!0)}}),s.Blocks[r.FUNCTION_CALL_OUTPUT_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){this.jsonInit({extensions:["function_contextmenu_edit"]}),this.name_="",this.arguments_=[],this.functionId_="",this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0,null),this.setOutputShape((new s.zelos.ConstantProvider).SHAPES.ROUND),this.setColour(s.Msg[n.MsgKey.PROCEDURES_HUE]),this.setHelpUrl(s.Msg[n.MsgKey.PROCEDURES_CALLNORETURN_HELPURL]),this.setTooltip(s.Msg[n.MsgKey.FUNCTION_CALL_TOOLTIP]),this.setInputsInline(!0)}})},{"../commonFunctionMixin":104,"../constants":105,"../msg":112,"../utils":114,blockly:219}],102:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.newFunctionMutation=void 0;let r=e("blockly");var n=e("../commonFunctionMixin");let o=e("../constants"),s=e("../utils"),a=e("../fields/fieldAutocapitalizeTextInput"),l=e("../functionManager"),c=e("../msg");e=Object.assign(Object.assign({},n.COMMON_FUNCTION_MIXIN),{populateArgument_:function(e,t,i){e=this.createArgumentEditor_(e.type,e.name);i.connection.connect(e.outputConnection)},addFunctionLabel_:function(e){e=new a.FieldAutocapitalizeTextInput(e||"",void 0,{spellcheck:!1,disableAutocapitalize:!0});this.appendDummyInput("function_name").appendField(e,"function_name")},updateFunctionLabel_:function(e){r.Events.disable(),this.getField("function_name").setValue(e),r.Events.enable()},createArgumentEditor_:function(t,i){r.Events.disable();let n;try{let e="";switch(t){case"boolean":e=o.ARGUMENT_EDITOR_BOOLEAN_BLOCK_TYPE;break;case"number":e=o.ARGUMENT_EDITOR_NUMBER_BLOCK_TYPE;break;case"string":e=o.ARGUMENT_EDITOR_STRING_BLOCK_TYPE;break;case"Array":e=o.ARGUMENT_EDITOR_ARRAY_BLOCK_TYPE;break;default:e=o.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE}(n=e==o.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE?(0,s.createCustomArgumentEditor)(t,this.workspace):this.workspace.newBlock(e)).setFieldValue(i,"TEXT"),n.setShadow(!0),!this.isInsertionMarker()&&n instanceof r.BlockSvg&&(n.initSvg(),n.queueRender())}finally{r.Events.enable()}return n},async focusLastEditorAsync_(){var e,t;await r.renderManagement.finishQueuedRenders(),0<this.inputList.length&&((t=this.inputList[this.inputList.length-2]).type==r.inputs.inputTypes.DUMMY?((e=this.workspace)instanceof r.WorkspaceSvg&&e.centerOnBlock(this.id,!0),t.fieldRow[0].showEditor()):t.type==r.inputs.inputTypes.VALUE&&((t=(e=t.connection.targetBlock()).workspace)instanceof r.WorkspaceSvg&&t.centerOnBlock(e.id,!0),e.getField("TEXT").showEditor()))},removeFieldCallback(t){let i=null;for(let e=0;e<this.inputList.length&&!i;e++){var n=this.inputList[e];if(n.connection){var o=n.connection.targetBlock();o&&o.getField(t.name)===t&&(i=n.name)}else for(let e=0;e<n.fieldRow.length;e++)n.fieldRow[e]==t&&(i=n.name)}i&&(r.WidgetDiv.hide(),this.removeInput(i),this.updateFunctionSignature(),this.updateDisplay_())},addParam_(e,t){r.WidgetDiv.hide();t=(0,s.findUniqueParamName)(t,this.arguments_.map(e=>e.name));this.arguments_.push({id:r.utils.idGenerator.genUid(),name:t,type:e}),this.updateDisplay_(),this.focusLastEditorAsync_()},addBooleanExternal(){this.addParam_("boolean",r.Msg[c.MsgKey.FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME])},addStringExternal(){this.addParam_("string",r.Msg[c.MsgKey.FUNCTIONS_DEFAULT_STRING_ARG_NAME])},addNumberExternal(){this.addParam_("number",r.Msg[c.MsgKey.FUNCTIONS_DEFAULT_NUMBER_ARG_NAME])},addArrayExternal(){this.addParam_("Array",r.Msg[c.MsgKey.FUNCTIONS_DEFAULT_ARRAY_ARG_NAME])},addCustomExternal(e){this.addParam_(e,l.FunctionManager.getInstance().getArgumentNameForType(e))},updateFunctionSignature(){this.arguments_=[];for(let e=1;e<this.inputList.length;e++){var t=this.inputList[e];switch(t.type){case r.inputs.inputTypes.STATEMENT:break;case r.inputs.inputTypes.DUMMY:this.name_=t.fieldRow[0].getValue()||t.fieldRow[0].getText();break;case r.inputs.inputTypes.VALUE:var i=t.connection.targetBlock();this.arguments_.push({id:t.name,name:i.getFieldValue("TEXT"),type:i.getTypeName()});break;default:pxt.warn("Unexpected input type on a function mutator root: "+t.type)}}}});i.newFunctionMutation=function(e){var e=(0,s.findLegalName)(r.Msg[c.MsgKey.FUNCTIONS_DEFAULT_FUNCTION_NAME],e),t=r.utils.xml.createElement("mutation");return t.setAttribute("name",e),t.setAttribute("functionid",r.utils.idGenerator.genUid()),t},r.Blocks[o.FUNCTION_DECLARATION_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){this.jsonInit({style:{hat:"cap"}}),this.name_="",this.arguments_=[],this.functionId_="",this.createAllInputs_(),this.setColour(r.Msg[c.MsgKey.PROCEDURES_HUE]),this.setStatements_(!0),this.setDeletable(!1),this.setMovable(!1),this.contextMenu=!1,this.setInputsInline(!0)}})},{"../commonFunctionMixin":104,"../constants":105,"../fields/fieldAutocapitalizeTextInput":109,"../functionManager":110,"../msg":112,"../utils":114,blockly:219}],103:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});let n=e("blockly");i=e("../commonFunctionMixin");let o=e("../constants"),r=e("../utils"),s=e("../fields/fieldAutocapitalizeTextInput"),a=e("../msg"),l=e("../functionManager"),c=e("../svgs");var u=e("../../duplicateOnDrag");let d=e("../../../fields/field_imagenotext");e=Object.assign(Object.assign({},i.COMMON_FUNCTION_MIXIN),{populateArgument_:function(e,t,i){let n=null;var o;null!=t&&t[e.id]&&(o=t[e.id],n=o.block);let r;t&&n&&!n.isDisposed()?((r=n).setFieldValue(e.name,"VALUE"),delete t[i.name]):r=this.createArgumentReporter_(e),i.connection.connect(r.outputConnection)},afterWorkspaceLoad:function(){for(let t of this.inputList)if(t.type===n.inputs.inputTypes.VALUE){var i=this.arguments_.find(e=>e.id===t.name);if(i){let e=t.connection.targetBlock();e||(this.populateArgument_(i,null,t),e=t.connection.targetBlock()),e.setFieldValue(i.name,"VALUE"),e.isShadow()&&e.setShadow(!1),t.setShadowDom(null)}}},addFunctionLabel_:function(e){e=new s.FieldAutocapitalizeTextInput(e||"",r.rename,{spellcheck:!1,disableAutocapitalize:!0});this.appendDummyInput("function_name").appendField(e,"function_name")},updateFunctionLabel_:function(e){n.Events.disable(),this.getField("function_name").setValue(e),n.Events.enable()},createArgumentReporter_:function(e){let t="";switch(e.type){case"boolean":t=o.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE;break;case"number":t=o.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE;break;case"string":t=o.ARGUMENT_REPORTER_STRING_BLOCK_TYPE;break;case"Array":t=o.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE;break;default:t=o.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE}n.Events.disable();let i;try{(i=t==o.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE?(0,r.createCustomArgumentReporter)(e.type,this.workspace):this.workspace.newBlock(t)).setFieldValue(e.name,"VALUE"),i.setShadow(!0),!this.isInsertionMarker()&&i instanceof n.BlockSvg&&(i.initSvg(),i.queueRender())}finally{n.Events.enable()}return i},customContextMenu:function(e){var t;this.isInFlyout||null!=(t=null==(t=this.workspace)?void 0:t.options)&&t.readOnly||(e.push(this.makeEditOption()),e.push(this.makeCallOption()))},makeEditOption:function(){var e;return{enabled:!(null!=(e=null==(e=this.workspace)?void 0:e.options)&&e.readOnly),text:n.Msg.FUNCTIONS_EDIT_OPTION,callback:()=>{var e,t=this;t.type!=o.FUNCTION_CALL_BLOCK_TYPE&&t.type!=o.FUNCTION_CALL_OUTPUT_BLOCK_TYPE||(e=t.workspace,t=(0,r.getDefinition)(t.getName(),e)),n.hideChaff(),n.getSelected()&&n.getSelected().unselect(),l.FunctionManager.getInstance().editFunctionExternal(t.mutationToDom(),e=>{e&&((0,r.mutateCallersAndDefinition)(t.getName(),t.workspace,e),t.updateDisplay_()),setTimeout(()=>{t.afterWorkspaceLoad&&t.afterWorkspaceLoad()})})}}},makeCallOption:function(){var e=this.getName(),t=n.utils.xml.createElement("mutation"),i=(t.setAttribute("name",e),n.utils.xml.createElement("block"));return i.appendChild(t),i.setAttribute("type",o.FUNCTION_CALL_BLOCK_TYPE),{enabled:0<this.workspace.remainingCapacity()&&!(null!=(t=null==(t=this.workspace)?void 0:t.options)&&t.readOnly),text:n.Msg.FUNCTIONS_CREATE_CALL_OPTION.replace("%1",e),callback:n.ContextMenu.callbackFactory(this,i)}}});n.Blocks[o.FUNCTION_DEFINITION_BLOCK_TYPE]=Object.assign(Object.assign({},e),{init:function(){var e;this.jsonInit({style:{hat:"cap"}}),this.name_="",this.arguments_=[],this.functionId_="",this.createAllInputs_(),this.setColour(n.Msg[a.MsgKey.PROCEDURES_HUE]),this.setTooltip(n.Msg[a.MsgKey.PROCEDURES_DEFNORETURN_TOOLTIP]),this.setHelpUrl(n.Msg[a.MsgKey.PROCEDURES_DEFNORETURN_HELPURL]),this.setStatements_(!0),this.setInputsInline(!0),this.workspace.options.collapse&&(e=c.COLLAPSE_IMAGE_DATAURI,this.appendDummyInput("function_collapse").appendField(new d.FieldImageNoText(e,24,24,"",()=>{this.setCollapsed(!0)},!1)))}}),(0,u.setDuplicateOnDrag)(o.FUNCTION_DEFINITION_BLOCK_TYPE)},{"../../../fields/field_imagenotext":38,"../../duplicateOnDrag":91,"../commonFunctionMixin":104,"../constants":105,"../fields/fieldAutocapitalizeTextInput":109,"../functionManager":110,"../msg":112,"../svgs":113,"../utils":114,blockly:219}],104:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.COMMON_FUNCTION_MIXIN=void 0;let r=e("blockly"),s=e("./constants"),a=e("./utils"),n=e("./msg");i.COMMON_FUNCTION_MIXIN={name_:"",functionId_:"",arguments_:[],mutationToDom:function(){this.ensureIds_();let i=r.utils.xml.createElement("mutation");return i.setAttribute("name",this.name_),i.setAttribute("functionid",this.functionId_),this.arguments_.forEach(function(e){var t=r.utils.xml.createElement("arg");t.setAttribute("name",e.name),t.setAttribute("id",e.id),t.setAttribute("type",e.type),i.appendChild(t)}),i},domToMutation:function(t){var i=[];for(let e=0;e<t.childNodes.length;++e){var n=t.childNodes[e];"arg"==n.nodeName.toLowerCase()&&i.push({id:n.getAttribute("id"),name:n.getAttribute("name"),type:n.getAttribute("type")})}this.arguments_=i,this.name_=t.getAttribute("name"),this.restoreSavedFunctionId(t.getAttribute("functionid"))},saveExtraState:function(){return{name:this.name_,functionid:this.functionId_,arguments:this.arguments_.slice()}},loadExtraState:function(e){this.arguments_=e.arguments.slice(),this.name_=e.name,this.restoreSavedFunctionId(e.functionid)},restoreSavedFunctionId:function(e){(0,a.idsInUse)(this.workspace).indexOf(e)<0&&(this.functionId_=e),this.ensureIds_();let t=null;this instanceof r.BlockSvg&&(t=this.getHeightWidth()),this.type!==s.FUNCTION_DEFINITION_BLOCK_TYPE||t&&!t.height&&!t.width?this.updateDisplay_():!this.getFieldValue("function_name")&&this.name_&&(this.setFieldValue(this.name_,"function_name"),this.updateDisplay_())},getName:function(){return this.name_},getFunctionId:function(){return this.functionId_},getArguments:function(){return this.arguments_},removeValueInputs_:function(){var i=[];for(let e=0,t;t=this.inputList[e];e++)t.type==r.inputs.inputTypes.VALUE?t.dispose():i.push(t);this.inputList=i},createAllInputs_:function(){let t=!1,i=!1;if(this.inputList.forEach(function(e){"function_title"==e.name?t=!0:"function_name"==e.name&&(i=!0)}),!t){let e="";switch(this.type){case s.FUNCTION_CALL_OUTPUT_BLOCK_TYPE:case s.FUNCTION_CALL_BLOCK_TYPE:e=r.Msg[n.MsgKey.FUNCTIONS_CALL_TITLE];break;case s.FUNCTION_DEFINITION_BLOCK_TYPE:case s.FUNCTION_DECLARATION_BLOCK_TYPE:e=r.Msg[n.MsgKey.FUNCTIONS_DEFNORETURN_TITLE]}this.appendDummyInput("function_title").appendField(e,"function_title")}i?this.updateFunctionLabel_(this.getName()):this.addFunctionLabel_(this.getName()),this.updateArgumentInputs_()},updateArgumentInputs_(){var i,e;for(let t of this.inputList)t.type!==r.inputs.inputTypes.VALUE||this.arguments_.some(e=>e.id===t.name)||(this.type===s.FUNCTION_DEFINITION_BLOCK_TYPE&&(e=t.connection.targetBlock())&&e.dispose(),this.removeInput(t.name));let n=this.inputList.findIndex(e=>e.type===r.inputs.inputTypes.VALUE);-1===n&&(n=this.inputList.length);for(let t of this.arguments_){let e=this.inputList.find(e=>e.name===t.id);var o=!e;o&&(e=this.appendValueInput(t.id)),this.inputList.indexOf(e)!==n&&this.moveInputBefore(e.name,null==(i=this.inputList[n+1])?void 0:i.name),(0,a.isCustomType)(t.type)?e.setCheck(t.type):e.setCheck(t.type.charAt(0).toUpperCase()+t.type.slice(1)),!this.isInsertionMarker()&&o&&this.populateArgument_(t,void 0,e),n++}this.inputList.some(e=>"function_collapse"===e.name)&&this.moveInputBefore("function_collapse",null),this.hasStatements_&&this.moveInputBefore("STACK",null)},updateDisplay_:function(){var e=this.rendered;this.createAllInputs_(),e&&!this.isInsertionMarker()&&this instanceof r.BlockSvg&&(this.initSvg(),this.queueRender())},setStatements_:function(e){this.hasStatements_!==e&&(e?this.appendStatementInput("STACK"):this.removeInput("STACK",!0),this.hasStatements_=e)},ensureIds_:function(){switch(this.type){case s.FUNCTION_DEFINITION_BLOCK_TYPE:this.functionId_&&"null"!=this.functionId_||(this.functionId_=r.utils.idGenerator.genUid());for(let e=0;e<this.arguments_.length;++e)this.arguments_[e].id||(this.arguments_[e].id=r.utils.idGenerator.genUid());break;case s.FUNCTION_CALL_OUTPUT_BLOCK_TYPE:case s.FUNCTION_CALL_BLOCK_TYPE:var e=(0,a.getDefinition)(this.name_,this.workspace);if(e){this.functionId_=e.getFunctionId();var i=e.getArguments();for(let t=0;t<this.arguments_.length;++t)for(let e=0;e<i.length;++e)if(i[e].name==this.arguments_[t].name){this.arguments_[t].id=i[e].id;break}}}}}},{"./constants":105,"./msg":112,"./utils":114,blockly:219}],105:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE=i.ARGUMENT_EDITOR_ARRAY_BLOCK_TYPE=i.ARGUMENT_EDITOR_STRING_BLOCK_TYPE=i.ARGUMENT_EDITOR_NUMBER_BLOCK_TYPE=i.ARGUMENT_EDITOR_BOOLEAN_BLOCK_TYPE=i.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE=i.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE=i.ARGUMENT_REPORTER_STRING_BLOCK_TYPE=i.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE=i.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE=i.FUNCTION_CALL_OUTPUT_BLOCK_TYPE=i.FUNCTION_CALL_BLOCK_TYPE=i.FUNCTION_DECLARATION_BLOCK_TYPE=i.FUNCTION_DEFINITION_BLOCK_TYPE=void 0,i.FUNCTION_DEFINITION_BLOCK_TYPE="function_definition",i.FUNCTION_DECLARATION_BLOCK_TYPE="function_declaration",i.FUNCTION_CALL_BLOCK_TYPE="function_call",i.FUNCTION_CALL_OUTPUT_BLOCK_TYPE="function_call_output",i.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE="argument_reporter_boolean",i.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE="argument_reporter_number",i.ARGUMENT_REPORTER_STRING_BLOCK_TYPE="argument_reporter_string",i.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE="argument_reporter_array",i.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE="argument_reporter_custom",i.ARGUMENT_EDITOR_BOOLEAN_BLOCK_TYPE="argument_editor_boolean",i.ARGUMENT_EDITOR_NUMBER_BLOCK_TYPE="argument_editor_number",i.ARGUMENT_EDITOR_STRING_BLOCK_TYPE="argument_editor_string",i.ARGUMENT_EDITOR_ARRAY_BLOCK_TYPE="argument_editor_array",i.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE="argument_editor_custom"},{}],106:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});let n=e("blockly"),o=e("./utils"),r=e("./msg"),s=e("./svgs"),a=new n.zelos.ConstantProvider;i={customContextMenu:function(e){if(!this.isCollapsed()){var t={text:n.Msg.RENAME_VARIABLE,enabled:!this.workspace.options.readOnly,callback:()=>{var e=this.workspace,t=this.getField("VAR").getVariable();n.Variables.renameVariable(e,t)}};if(e.unshift(t),!this.isInFlyout)for(let t of this.workspace.getVariableMap().getVariablesOfType("")){var i={enabled:!this.workspace.options.readOnly,text:t.getName(),callback:()=>{var e=this.getField("VAR");e||pxt.log("Tried to get a variable field on the wrong type of block."),e.setValue(t.getId())}};e.unshift(i)}}}};n.Extensions.registerMixin("function_contextmenu_edit",{customContextMenu:function(e){var t={enabled:!(null!=(t=null==(t=this.workspace)?void 0:t.options)&&t.readOnly),text:n.Msg[r.MsgKey.FUNCTIONS_GO_TO_DEFINITION_OPTION],callback:()=>{var e=this.getField("function_name").getText(),e=(0,o.getDefinition)(e,this.workspace);e&&this.workspace instanceof n.WorkspaceSvg&&this.workspace.centerOnBlock(e.id,!0)}};e.push(t)}}),n.Extensions.registerMixin("contextMenu_variableReporter",i),n.Extensions.register("output_number",function(){this.setInputsInline(!0),this.setOutputShape(a.SHAPES.ROUND),this.setOutput(!0,"Number")}),n.Extensions.register("output_string",function(){this.setInputsInline(!0),this.setOutputShape(a.SHAPES.ROUND),this.setOutput(!0,"String")}),n.Extensions.register("output_boolean",function(){this.setInputsInline(!0),this.setOutputShape(a.SHAPES.HEXAGONAL),this.setOutput(!0,"Boolean")}),n.Extensions.register("output_array",function(){this.setInputsInline(!0),this.setOutputShape(a.SHAPES.ROUND),this.setOutput(!0,"Array")}),n.Extensions.register("text_field_color",function(){var e;this.workspace instanceof n.WorkspaceSvg?(e=this.workspace.getRenderer().getConstants(),this.setColour(e.FIELD_BORDER_RECT_COLOUR)):this.setColour("#fff")}),n.Extensions.register("inline-svgs",function(){this.ADD_IMAGE_DATAURI=s.ADD_IMAGE_DATAURI,this.REMOVE_IMAGE_DATAURI=s.REMOVE_IMAGE_DATAURI})},{"./msg":112,"./svgs":113,"./utils":114,blockly:219}],107:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldArgumentEditor=void 0;let o=e("blockly"),n=e("../functionManager");class r extends o.FieldTextInput{constructor(e,t,i){super(e,t,i)}showEditor(e){super.showEditor(e);var t,e=o.WidgetDiv.getDiv(),i=(e.className+=" argumentEditorInput",document.createElement("img")),i=(i.setAttribute("class","argumentEditorRemoveIcon"),i.setAttribute("src",r.REMOVE_ARG_URI),this.removeButtonMouseWrapper_=o.browserEvents.conditionalBind(i,"mousedown",this,this.removeCallback),e.appendChild(i),null==(i=this.sourceBlock_)?void 0:i.getTypeName());i&&null!=(t=this.sourceBlock_)&&t.workspace&&(t=n.FunctionManager.getInstance().getIconForType(i))&&(i=t+" icon argumentEditorTypeIcon",(t=document.createElement("i")).className=i,e.appendChild(t))}removeCallback(){var t,i=null==(i=this.sourceBlock_)?void 0:i.getParent();if(i){let e;for(var n of i.inputList)if((null==(t=n.connection)?void 0:t.targetBlock())===this.sourceBlock_){e=n.name;break}e&&(o.WidgetDiv.hide(),i.removeInput(e))}}}(i.FieldArgumentEditor=r).REMOVE_ARG_URI="data:image/svg+xml;charset=UTF-8,%3c?xml version='1.0' encoding='UTF-8' standalone='no'?%3e%3csvg width='20px' height='20px' viewBox='0 0 20 20' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3c!-- Generator: Sketch 48.1 (47250) - http://www.bohemiancoding.com/sketch --%3e%3ctitle%3edelete-argument v2%3c/title%3e%3cdesc%3eCreated with Sketch.%3c/desc%3e%3cdefs%3e%3c/defs%3e%3cg id='Page-1' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e%3cg id='delete-argument-v2' stroke='%23FF661A'%3e%3cg id='Group' transform='translate(3.000000, 2.500000)'%3e%3cpath d='M1,3 L13,3 L11.8900496,14.0995037 C11.8389294,14.6107055 11.4087639,15 10.8950124,15 L3.10498756,15 C2.59123611,15 2.16107055,14.6107055 2.10995037,14.0995037 L1,3 Z' id='Rectangle' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3c/path%3e%3cpath d='M7,11 L7,6' id='Line' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3c/path%3e%3cpath d='M9.5,11 L9.5,6' id='Line-Copy' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3c/path%3e%3cpath d='M4.5,11 L4.5,6' id='Line-Copy-2' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'%3e%3c/path%3e%3crect id='Rectangle-2' fill='%23FF661A' x='0' y='2.5' width='14' height='1' rx='0.5'%3e%3c/rect%3e%3cpath d='M6,0 L8,0 C8.55228475,-1.01453063e-16 9,0.44771525 9,1 L9,3 L5,3 L5,1 C5,0.44771525 5.44771525,1.01453063e-16 6,0 Z' id='Rectangle-3' stroke-width='1.5'%3e%3c/path%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e",o.fieldRegistry.register("field_argument_editor",r),o.Css.register(`

.argumentEditorInput {
    overflow: visible;
}

.functioneditor i.argumentEditorTypeIcon {
    color: var(--pxt-target-foreground1);
    position: absolute;
    width: 24px;
    height: 24px;
    top: 40px;
    left: 50%;
    margin-left: -12px;
}

.argumentEditorRemoveIcon {
    position: absolute;
    width: 24px;
    height: 24px;
    top: -40px;
    left: 50%;
    margin-left: -12px;
    cursor: pointer;
}

`)},{"../functionManager":110,blockly:219}],108:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.setArgumentReporterLocalizeFunction=i.FieldArgumentReporter=void 0;var n=e("blockly");let o=e("../utils"),r;class s extends n.FieldLabelSerializable{getDisplayText_(){var e=this.getSourceBlock();if(e&&(0,o.isFunctionArgumentReporter)(e)&&r){e=r(this,e);if(e)return e}return super.getDisplayText_()}}i.FieldArgumentReporter=s,i.setArgumentReporterLocalizeFunction=function(e){r=e},n.registry.register(n.registry.Type.FIELD,"field_argument_reporter",s)},{"../utils":114,blockly:219}],109:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldAutocapitalizeTextInput=void 0;e=e("blockly");class n extends e.FieldTextInput{constructor(e,t,i){super(e,t,i),this.disableAutocapitalize=!1}setAutocapitalize(e){this.disableAutocapitalize=!e,this.htmlInput_&&(this.disableAutocapitalize?this.htmlInput_.setAttribute("autocapitalize","none"):this.htmlInput_.removeAttribute("autocapitalize"))}configure_(e){super.configure_(e),void 0!==e.disableAutocapitalize&&(this.disableAutocapitalize=e.disableAutocapitalize)}widgetCreate_(){var e=super.widgetCreate_();return this.disableAutocapitalize&&e.setAttribute("autocapitalize","none"),e}}i.FieldAutocapitalizeTextInput=n,e.fieldRegistry.register("field_autocapitalize_text_input",n)},{blockly:219}],110:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FunctionManager=void 0;let n=e("blockly"),o=e("./msg");class r{constructor(){this.typeIcons={},this.typeArgumentNames={}}static getInstance(){return r.instance}getIconForType(e){return this.typeIcons[e]}setIconForType(e,t){this.typeIcons[e]=t}setArgumentNameForType(e,t){this.typeArgumentNames[e]=t}getArgumentNameForType(e){return this.typeArgumentNames[e]||n.Msg[o.MsgKey.FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME]}setEditFunctionExternal(e){this._editFunctionExternal=e}editFunctionExternal(e,t){this._editFunctionExternal?this._editFunctionExternal(e,t):pxt.warn("External function editor must be overriden: Blockly.Functions.editFunctionExternalHandler",e,t)}}(i.FunctionManager=r).instance=new r},{"./msg":112,blockly:219}],111:[function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,o)}:function(e,t,i,n){e[n=void 0===n?i:n]=t[i]}),o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)},r=(Object.defineProperty(i,"__esModule",{value:!0}),i.validateFunctionExternal=i.getAllFunctionDefinitionBlocks=i.getDefinition=i.flyoutCategory=void 0,o(e("./msg"),i),o(e("./extensions"),i),o(e("./fields/fieldArgumentEditor"),i),o(e("./fields/fieldArgumentReporter"),i),o(e("./fields/fieldAutocapitalizeTextInput"),i),o(e("./blocks/argumentEditorBlocks"),i),o(e("./blocks/argumentReporterBlocks"),i),o(e("./blocks/functionDeclarationBlock"),i),o(e("./blocks/functionDefinitionBlock"),i),o(e("./blocks/functionCallBlocks"),i),o(e("./functionManager"),i),e("./utils"));Object.defineProperty(i,"flyoutCategory",{enumerable:!0,get:function(){return r.flyoutCategory}}),Object.defineProperty(i,"getDefinition",{enumerable:!0,get:function(){return r.getDefinition}}),Object.defineProperty(i,"getAllFunctionDefinitionBlocks",{enumerable:!0,get:function(){return r.getAllFunctionDefinitionBlocks}}),Object.defineProperty(i,"validateFunctionExternal",{enumerable:!0,get:function(){return r.validateFunctionExternal}})},{"./blocks/argumentEditorBlocks":99,"./blocks/argumentReporterBlocks":100,"./blocks/functionCallBlocks":101,"./blocks/functionDeclarationBlock":102,"./blocks/functionDefinitionBlock":103,"./extensions":106,"./fields/fieldArgumentEditor":107,"./fields/fieldArgumentReporter":108,"./fields/fieldAutocapitalizeTextInput":109,"./functionManager":110,"./msg":112,"./utils":114}],112:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MsgKey=void 0;let n=e("blockly"),o;function r(e,t){n.Msg[e]||(n.Msg[e]=t)}(e=o=i.MsgKey||(i.MsgKey={})).REPORTERS_HUE="REPORTERS_HUE",e.FUNCTIONS_CALL_TITLE="FUNCTIONS_CALL_TITLE",e.FUNCTIONS_DEFNORETURN_TITLE="FUNCTIONS_DEFNORETURN_TITLE",e.FUNCTIONS_GO_TO_DEFINITION_OPTION="FUNCTIONS_GO_TO_DEFINITION_OPTION",e.FUNCTION_CALL_TOOLTIP="FUNCTION_CALL_TOOLTIP",e.PROCEDURES_HUE="PROCEDURES_HUE",e.PROCEDURES_CALLNORETURN_HELPURL="PROCEDURES_CALLNORETURN_HELPURL",e.FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME="FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME",e.FUNCTIONS_DEFAULT_STRING_ARG_NAME="FUNCTIONS_DEFAULT_STRING_ARG_NAME",e.FUNCTIONS_DEFAULT_NUMBER_ARG_NAME="FUNCTIONS_DEFAULT_NUMBER_ARG_NAME",e.FUNCTIONS_DEFAULT_ARRAY_ARG_NAME="FUNCTIONS_DEFAULT_ARRAY_ARG_NAME",e.PROCEDURES_DEFNORETURN_TOOLTIP="PROCEDURES_DEFNORETURN_TOOLTIP",e.PROCEDURES_DEFNORETURN_HELPURL="PROCEDURES_DEFNORETURN_HELPURL",e.FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME="FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME",e.FUNCTIONS_DEFAULT_FUNCTION_NAME="FUNCTIONS_DEFAULT_FUNCTION_NAME",e.FUNCTION_CREATE_NEW="FUNCTION_CREATE_NEW",e.FUNCTION_FLYOUT_LABEL="FUNCTION_FLYOUT_LABEL",e.FUNCTIONS_EDIT_OPTION="FUNCTIONS_EDIT_OPTION",e.FUNCTIONS_CREATE_CALL_OPTION="FUNCTIONS_CREATE_CALL_OPTION",r(o.REPORTERS_HUE,"#A80000"),r(o.FUNCTIONS_CALL_TITLE,"call"),r(o.FUNCTIONS_DEFNORETURN_TITLE,"function"),r(o.FUNCTIONS_GO_TO_DEFINITION_OPTION,"Go to Definition"),r(o.FUNCTIONS_DEFAULT_BOOLEAN_ARG_NAME,"bool"),r(o.FUNCTIONS_DEFAULT_STRING_ARG_NAME,"text"),r(o.FUNCTIONS_DEFAULT_NUMBER_ARG_NAME,"num"),r(o.FUNCTIONS_DEFAULT_ARRAY_ARG_NAME,"array"),r(o.FUNCTIONS_DEFAULT_CUSTOM_ARG_NAME,"value"),r(o.FUNCTIONS_DEFAULT_FUNCTION_NAME,"doSomething"),r(o.FUNCTION_CREATE_NEW,"Make a Function"),r(o.FUNCTION_FLYOUT_LABEL,"Your Functions"),r(o.FUNCTIONS_EDIT_OPTION,"Edit Function"),r(o.FUNCTIONS_CREATE_CALL_OPTION,"Create 'call %1'")},{blockly:219}],113:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.REMOVE_IMAGE_DATAURI=i.ADD_IMAGE_DATAURI=i.COLLAPSE_IMAGE_DATAURI=void 0,i.COLLAPSE_IMAGE_DATAURI="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg enable-background='new 0 0 24 24' version='1.1' viewBox='0 0 24 24' xml:space='preserve' xmlns='http://www.w3.org/2000/svg'%3E%3Cstyle type='text/css'%3E .st0%7Bfill:%23CF8B17;%7D .st1%7Bfill:%23FFFFFF;%7D%0A%3C/style%3E%3Ctitle%3Erepeat%3C/title%3E%3Ccircle cx='12' cy='12' r='10.503' fill='none' stroke='%23fff' stroke-linecap='square' stroke-linejoin='round' stroke-width='2'/%3E%3Cg transform='matrix(.0086269 0 0 -.0086269 4.8224 17.354)'%3E%3Cpath d='m1611 367.42q0 53-37 90l-651 651q-38 38-91 38-54 0-90-38l-651-651q-38-36-38-90 0-53 38-91l74-75q39-37 91-37 53 0 90 37l486 486 486-486q37-37 90-37 52 0 91 37l75 75q37 39 37 91z' fill='%23fff'/%3E%3C/g%3E%3C/svg%3E%0A",i.ADD_IMAGE_DATAURI="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMS4wLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4KCjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgdmVyc2lvbj0iMS4xIgogICBpZD0icmVwZWF0IgogICB4PSIwcHgiCiAgIHk9IjBweCIKICAgdmlld0JveD0iMCAwIDI0IDI0IgogICBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAyNCAyNDsiCiAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgIGlua3NjYXBlOnZlcnNpb249IjAuOTEgcjEzNzI1IgogICBzb2RpcG9kaTpkb2NuYW1lPSJhZGQuc3ZnIj48bWV0YWRhdGEKICAgICBpZD0ibWV0YWRhdGExNSI+PHJkZjpSREY+PGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPjxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PjxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz48ZGM6dGl0bGU+cmVwZWF0PC9kYzp0aXRsZT48L2NjOldvcms+PC9yZGY6UkRGPjwvbWV0YWRhdGE+PGRlZnMKICAgICBpZD0iZGVmczEzIiAvPjxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBwYWdlY29sb3I9IiNmZjQ4MjEiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMSIKICAgICBvYmplY3R0b2xlcmFuY2U9IjEwIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwIgogICAgIGd1aWRldG9sZXJhbmNlPSIxMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTY4MCIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI5NjkiCiAgICAgaWQ9Im5hbWVkdmlldzExIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTp6b29tPSIxOS42NjY2NjciCiAgICAgaW5rc2NhcGU6Y3g9IjEyLjkxNTI1NCIKICAgICBpbmtzY2FwZTpjeT0iMTYuMDY3Nzk2IgogICAgIGlua3NjYXBlOndpbmRvdy14PSIwIgogICAgIGlua3NjYXBlOndpbmRvdy15PSIwIgogICAgIGlua3NjYXBlOndpbmRvdy1tYXhpbWl6ZWQ9IjAiCiAgICAgaW5rc2NhcGU6Y3VycmVudC1sYXllcj0icmVwZWF0IiAvPjxzdHlsZQogICAgIHR5cGU9InRleHQvY3NzIgogICAgIGlkPSJzdHlsZTMiPgoJLnN0MHtmaWxsOiNDRjhCMTc7fQoJLnN0MXtmaWxsOiNGRkZGRkY7fQo8L3N0eWxlPjx0aXRsZQogICAgIGlkPSJ0aXRsZTUiPnJlcGVhdDwvdGl0bGU+PHJlY3QKICAgICBzdHlsZT0ib3BhY2l0eToxO2ZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MTtzdHJva2UtbGluZWNhcDpzcXVhcmU7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MC4wNzg0MzEzNyIKICAgICBpZD0icmVjdDQxNDMiCiAgICAgd2lkdGg9IjQuMDUwMDAwMiIKICAgICBoZWlnaHQ9IjEyLjM5NzA1IgogICAgIHg9IjkuOTc1MDAwNCIKICAgICB5PSItMTguMTk4NTI2IgogICAgIHJ4PSIwLjgxIgogICAgIHJ5PSIwLjgxIgogICAgIHRyYW5zZm9ybT0ic2NhbGUoMSwtMSkiIC8+PHJlY3QKICAgICBzdHlsZT0ib3BhY2l0eToxO2ZpbGw6I2ZmZmZmZjtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6bm9uZTtzdHJva2Utd2lkdGg6MTtzdHJva2UtbGluZWNhcDpzcXVhcmU7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MC4wNzg0MzEzNyIKICAgICBpZD0icmVjdDQxNDMtMSIKICAgICB3aWR0aD0iNC4wNTAwMDAyIgogICAgIGhlaWdodD0iMTIuMzk3MTE5IgogICAgIHg9IjkuOTc1MDAwNCIKICAgICB5PSI1LjgwMTQ0MDciCiAgICAgcng9IjAuODEiCiAgICAgcnk9IjAuODEiCiAgICAgdHJhbnNmb3JtPSJtYXRyaXgoMCwxLDEsMCwwLDApIiAvPjxjaXJjbGUKICAgICBzdHlsZT0ib3BhY2l0eToxO2ZpbGw6bm9uZTtmaWxsLW9wYWNpdHk6MTtmaWxsLXJ1bGU6bm9uemVybztzdHJva2U6I2ZmZmZmZjtzdHJva2Utd2lkdGg6MjtzdHJva2UtbGluZWNhcDpzcXVhcmU7c3Ryb2tlLWxpbmVqb2luOnJvdW5kO3N0cm9rZS1taXRlcmxpbWl0OjQ7c3Ryb2tlLWRhc2hhcnJheTpub25lO3N0cm9rZS1kYXNob2Zmc2V0OjA7c3Ryb2tlLW9wYWNpdHk6MSIKICAgICBpZD0icGF0aDQxMzYiCiAgICAgY3g9IjEyIgogICAgIGN5PSIxMiIKICAgICByPSIxMC41MDMxOTEiIC8+PC9zdmc+",i.REMOVE_IMAGE_DATAURI="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAyMS4wLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4KCjxzdmcKICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICB4bWxuczpjYz0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbnMjIgogICB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiCiAgIHhtbG5zOnN2Zz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciCiAgIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIKICAgeG1sbnM6c29kaXBvZGk9Imh0dHA6Ly9zb2RpcG9kaS5zb3VyY2Vmb3JnZS5uZXQvRFREL3NvZGlwb2RpLTAuZHRkIgogICB4bWxuczppbmtzY2FwZT0iaHR0cDovL3d3dy5pbmtzY2FwZS5vcmcvbmFtZXNwYWNlcy9pbmtzY2FwZSIKICAgdmVyc2lvbj0iMS4xIgogICBpZD0icmVwZWF0IgogICB4PSIwcHgiCiAgIHk9IjBweCIKICAgdmlld0JveD0iMCAwIDI0IDI0IgogICBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCAyNCAyNDsiCiAgIHhtbDpzcGFjZT0icHJlc2VydmUiCiAgIGlua3NjYXBlOnZlcnNpb249IjAuOTEgcjEzNzI1IgogICBzb2RpcG9kaTpkb2NuYW1lPSJyZW1vdmUuc3ZnIj48bWV0YWRhdGEKICAgICBpZD0ibWV0YWRhdGExNSI+PHJkZjpSREY+PGNjOldvcmsKICAgICAgICAgcmRmOmFib3V0PSIiPjxkYzpmb3JtYXQ+aW1hZ2Uvc3ZnK3htbDwvZGM6Zm9ybWF0PjxkYzp0eXBlCiAgICAgICAgICAgcmRmOnJlc291cmNlPSJodHRwOi8vcHVybC5vcmcvZGMvZGNtaXR5cGUvU3RpbGxJbWFnZSIgLz48ZGM6dGl0bGU+cmVwZWF0PC9kYzp0aXRsZT48L2NjOldvcms+PC9yZGY6UkRGPjwvbWV0YWRhdGE+PGRlZnMKICAgICBpZD0iZGVmczEzIiAvPjxzb2RpcG9kaTpuYW1lZHZpZXcKICAgICBwYWdlY29sb3I9IiNmZjFhZmYiCiAgICAgYm9yZGVyY29sb3I9IiM2NjY2NjYiCiAgICAgYm9yZGVyb3BhY2l0eT0iMSIKICAgICBvYmplY3R0b2xlcmFuY2U9IjEwIgogICAgIGdyaWR0b2xlcmFuY2U9IjEwIgogICAgIGd1aWRldG9sZXJhbmNlPSIxMCIKICAgICBpbmtzY2FwZTpwYWdlb3BhY2l0eT0iMCIKICAgICBpbmtzY2FwZTpwYWdlc2hhZG93PSIyIgogICAgIGlua3NjYXBlOndpbmRvdy13aWR0aD0iMTY4MCIKICAgICBpbmtzY2FwZTp3aW5kb3ctaGVpZ2h0PSI5NTAiCiAgICAgaWQ9Im5hbWVkdmlldzExIgogICAgIHNob3dncmlkPSJmYWxzZSIKICAgICBpbmtzY2FwZTp6b29tPSIxOS42NjY2NjciCiAgICAgaW5rc2NhcGU6Y3g9IjAuMDUwODQ3NTIxIgogICAgIGlua3NjYXBlOmN5PSI5Ljk2NjEwMTciCiAgICAgaW5rc2NhcGU6d2luZG93LXg9IjAiCiAgICAgaW5rc2NhcGU6d2luZG93LXk9IjAiCiAgICAgaW5rc2NhcGU6d2luZG93LW1heGltaXplZD0iMCIKICAgICBpbmtzY2FwZTpjdXJyZW50LWxheWVyPSJyZXBlYXQiIC8+PHN0eWxlCiAgICAgdHlwZT0idGV4dC9jc3MiCiAgICAgaWQ9InN0eWxlMyI+Cgkuc3Qwe2ZpbGw6I0NGOEIxNzt9Cgkuc3Qxe2ZpbGw6I0ZGRkZGRjt9Cjwvc3R5bGU+PHRpdGxlCiAgICAgaWQ9InRpdGxlNSI+cmVwZWF0PC90aXRsZT48cmVjdAogICAgIHN0eWxlPSJvcGFjaXR5OjE7ZmlsbDojZmZmZmZmO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpub256ZXJvO3N0cm9rZTpub25lO3N0cm9rZS13aWR0aDoxO3N0cm9rZS1saW5lY2FwOnNxdWFyZTtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eTowLjA3ODQzMTM3IgogICAgIGlkPSJyZWN0NDE0My0xIgogICAgIHdpZHRoPSI0LjA1MDAwMDIiCiAgICAgaGVpZ2h0PSIxMi4zOTcxMTkiCiAgICAgeD0iOS45NzUwMDA0IgogICAgIHk9IjUuODAxNDQwNyIKICAgICByeD0iMC44MSIKICAgICByeT0iMC44MSIKICAgICB0cmFuc2Zvcm09Im1hdHJpeCgwLDEsMSwwLDAsMCkiIC8+PGNpcmNsZQogICAgIHN0eWxlPSJvcGFjaXR5OjE7ZmlsbDpub25lO2ZpbGwtb3BhY2l0eToxO2ZpbGwtcnVsZTpub256ZXJvO3N0cm9rZTojZmZmZmZmO3N0cm9rZS13aWR0aDoyO3N0cm9rZS1saW5lY2FwOnNxdWFyZTtzdHJva2UtbGluZWpvaW46cm91bmQ7c3Ryb2tlLW1pdGVybGltaXQ6NDtzdHJva2UtZGFzaGFycmF5Om5vbmU7c3Ryb2tlLWRhc2hvZmZzZXQ6MDtzdHJva2Utb3BhY2l0eToxIgogICAgIGlkPSJwYXRoNDEzNiIKICAgICBjeD0iMTIiCiAgICAgY3k9IjEyIgogICAgIHI9IjEwLjUwMzE5MSIgLz48L3N2Zz4="},{}],114:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.isVariableBlockType=i.validateFunctionExternal=i.flyoutCategory=i.getShadowBlockInfoFromType_=i.findUniqueParamName=i.getArgumentReporterParent=i.doArgumentReporterDragChecks=i.isFunctionArgumentReporter=i.getArgMap=i.mutateCallersAndDefinition=i.idsInUse=i.findLegalName=i.createCustomArgumentEditor=i.createCustomArgumentReporter=i.isCustomType=i.getAllFunctionDefinitionBlocks=i.getDefinition=i.rename=void 0;let g=e("blockly"),f=e("./constants"),d=e("./functionManager"),h=e("./msg"),p=e("./blocks/functionDeclarationBlock"),s=e("../../compiler/util"),a=e("../../loader");function m(e,t){for(var i of t.getTopBlocks(!1))if(i.type===f.FUNCTION_DEFINITION_BLOCK_TYPE)if(i.getName()===e)return i;return null}function b(e){return e.getTopBlocks(!1).filter(e=>e.type===f.FUNCTION_DEFINITION_BLOCK_TYPE)}function n(e,t,i){i=i.newBlock(e),e=g.utils.xml.createElement("mutation");return e.setAttribute("typename",t),i.domToMutation(e),i}function r(e,t,i){if(null==i||!i.isInFlyout)for(var n=l(t,i);n[e];)e=o(e);return e}function l(e,i,n){let o={};return e.getVariableMap().getAllVariables().forEach(function(e){o[e.getName()]=!0}),e.getAllBlocks(!1).forEach(function(e){var t=e;t==i||n&&t.getFunctionId&&t.getFunctionId()==n||(t.type==f.FUNCTION_DEFINITION_BLOCK_TYPE?o[t.getName()]=!0:"procedures_defreturn"!=e.type&&e.type)}),o}function o(e){var t=e.match(/^(.*?)(\d+)$/);return t?e=t[1]+(parseInt(t[2],10)+1):e+="2",e}function c(e,t,i){var n=m(e,t);if(n){var o,r,s,a,l,c=n.mutationToDom(),u=_(c,!1),d=_(i,!0),h=[];for(o of n.getDescendants(!1))y(o)&&((r=v(o,o))&&r!==n||(r=o.getFieldValue("VALUE"))!==(s=d[u[r]])&&(a=o.outputConnection.targetBlock().id,l=o.outputConnection.targetConnection.getParentInput().name,h.push({id:o.id,type:o.type,oldName:r,newName:s,targetBlockId:a,targetInputName:l})));var p=((e,t)=>{var i,n,o=[];for(i of t.getAllBlocks(!1))i.type!==f.FUNCTION_CALL_BLOCK_TYPE&&i.type!==f.FUNCTION_CALL_OUTPUT_BLOCK_TYPE||(n=i).getName()===e&&o.push(n);return o})(e,n.workspace).map(e=>({id:e.id,oldMutation:g.utils.xml.domToText(e.mutationToDom()),shadows:e.serializeChangedInputs(i)})),p=new T(n.id,p,g.Xml.domToText(c),g.Xml.domToText(i),h);p.workspaceId=t.id,p.run(!0),g.Events.fire(p)}else pxt.warn("Attempted to change function "+e+", but no definition block was found on the workspace")}function _(t,i){var n={};for(let e=0;e<t.childNodes.length;++e){var o=t.childNodes[e],r=i?o.getAttribute("id"):o.getAttribute("name"),o=i?o.getAttribute("name"):o.getAttribute("id");n[r]=o}return n}function y(e){return e.type==f.ARGUMENT_REPORTER_BOOLEAN_BLOCK_TYPE||e.type==f.ARGUMENT_REPORTER_NUMBER_BLOCK_TYPE||e.type==f.ARGUMENT_REPORTER_STRING_BLOCK_TYPE||e.type==f.ARGUMENT_REPORTER_ARRAY_BLOCK_TYPE||e.type==f.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE}function v(e,t){pxt.U.assert(y(e));let i=e.getFieldValue("VALUE"),n=e.getTypeName();for(;t.getSurroundParent();)for(var o of(t=t.getSurroundParent()).inputList)if(o.connection&&o.name.startsWith(a.DRAGGABLE_PARAM_INPUT_PREFIX)){var r=o.name.slice(a.DRAGGABLE_PARAM_INPUT_PREFIX.length);if(r===i){let e=n;return"string"!==e&&"number"!==e&&"boolean"!==e||(e=e.charAt(0).toUpperCase()+e.slice(1)),-1!==o.connection.getCheck().indexOf(e)?t:void 0}}if(!t.isEnabled())return t;if((0,s.isFunctionDefinition)(t)&&t.getArguments().some(e=>e.name===i&&e.type===n))return t}i.rename=function(e){e=e.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"");var t,i=this.sourceBlock_,n=r(e,i.workspace,i),o=this.getValue();return e?n?o?(o!=e&&o!=n&&(i.name_=n,t=i.mutationToDom(),c(i.name_=o,i.workspace,t)),n):i.name_=n:e:o},i.getDefinition=m,i.getAllFunctionDefinitionBlocks=b,i.isCustomType=function(e){return!("boolean"==e||"string"==e||"number"==e)},i.createCustomArgumentReporter=function(e,t){return n(f.ARGUMENT_REPORTER_CUSTOM_BLOCK_TYPE,e,t)},i.createCustomArgumentEditor=function(e,t){return n(f.ARGUMENT_EDITOR_CUSTOM_BLOCK_TYPE,e,t)},i.findLegalName=r,i.idsInUse=function(e){let t=[];return e.getAllBlocks(!1).forEach(function(e){e.type==f.FUNCTION_DEFINITION_BLOCK_TYPE&&t.push(e.getFunctionId())}),t},i.mutateCallersAndDefinition=c,i.getArgMap=_,i.isFunctionArgumentReporter=y,i.doArgumentReporterDragChecks=function(e,t,i){return!y(e=e.getSourceBlock())||!(t=t.getSourceBlock())||!!v(e,t)},i.getArgumentReporterParent=v,i.findUniqueParamName=function(e,t){for(;i=e,(n=t)&&-1!=n.indexOf(i);)e=o(e);var i,n;return e},i.getShadowBlockInfoFromType_=function(e,t){let i="",n="",o="";switch(e){case"boolean":i="logic_boolean",n="BOOL",o="TRUE";break;case"number":i="math_number",n="NUM",o="1";break;case"string":i="text",n="TEXT",o="abc";break;case"Array":i="variables_get",n="VAR",o=g.Variables.getOrCreateVariablePackage(t,null,"list","").getId();break;default:i="variables_get",n="VAR",o=g.Variables.getOrCreateVariablePackage(t,null,d.FunctionManager.getInstance().getArgumentNameForType(e),"").getId()}return[i,n,o]},i.flyoutCategory=function(t){var e,i=[],n=document.createElement("button"),o=g.Msg[h.MsgKey.FUNCTION_CREATE_NEW],r="CREATE_FUNCTION";n.setAttribute("text",o),n.setAttribute("callbackKey",r),t.registerButtonCallback(r,()=>{var e=t;g.hideChaff(),g.getSelected()&&g.getSelected().unselect(),d.FunctionManager.getInstance().editFunctionExternal((0,p.newFunctionMutation)(e),(n=>function(t){if(t){var i,t='<xml><block type="'+f.FUNCTION_DEFINITION_BLOCK_TYPE+'">'+g.Xml.domToText(t)+"</block></xml>",t=g.utils.xml.textToDom(t);g.Events.setGroup(!0);let e=g.Xml.domToBlock(t.firstChild,n);e.updateDisplay_(),n.getMetrics&&(t=n.getMetrics(),i=e.getHeightWidth(),e.moveBy(t.viewLeft+t.viewWidth/2-i.width/2,t.viewTop+t.viewHeight/2-i.height/2),e.scheduleSnapAndBump()),n.centerOnBlock(e.id,!0),g.Events.setGroup(!1),setTimeout(()=>{e.afterWorkspaceLoad&&e.afterWorkspaceLoad()})}})(e))}),i.push(n);for(e of b(t)){var s=e.getName(),a=e.getArguments(),l=g.utils.xml.createElement("block"),c=(l.setAttribute("type","function_call"),l.setAttribute("gap","16"),g.utils.xml.createElement("mutation"));c.setAttribute("name",s),l.appendChild(c);for(let e=0;e<a.length;e++){var u=g.utils.xml.createElement("arg");u.setAttribute("name",a[e].name),u.setAttribute("type",a[e].type),u.setAttribute("id",a[e].id),c.appendChild(u)}i.push(l)}return i},i.validateFunctionExternal=function(t,e){var i=t.getAttribute("name");if(!i)return g.dialog.alert(g.Msg.FUNCTION_WARNING_EMPTY_NAME),!1;var n={};for(let e=0;e<t.childNodes.length;++e){var o=t.childNodes[e].getAttribute("name");if(!o)return g.dialog.alert(g.Msg.FUNCTION_WARNING_EMPTY_NAME),!1;if(n[o])return g.dialog.alert(g.Msg.FUNCTION_WARNING_DUPLICATE_ARG),!1;n[o]=!0}return n[i]?(g.dialog.alert(g.Msg.FUNCTION_WARNING_ARG_NAME_IS_FUNCTION_NAME),!1):!l(e,null,t.getAttribute("functionid"))[i]||(g.dialog.alert(g.Msg.VARIABLE_ALREADY_EXISTS.replace("%1",i)),!1)},i.isVariableBlockType=function(e){switch(e){case"argument_reporter_boolean":case"argument_reporter_number":case"argument_reporter_string":case"argument_reporter_array":case"argument_reporter_custom":case"variables_get_reporter":case"variables_get":return!0}return!1};class T extends g.Events.Abstract{constructor(e,t,i,n,o){super(),this.definition=e,this.callers=t,this.oldMutation=i,this.newMutation=n,this.descendantChanges=o,this.type="pxt_mutate_function"}static fromJson(e,t,i){t=i=super.fromJson(e,t,i||new T(e.definition,e.callers,e.oldMutation,e.newMutation,e.descendantChanges));return t.definition=e.definition,t.callers=e.callers,t.oldMutation=e.oldMutation,t.newMutation=e.newMutation,t.descendantChanges=e.descendantChanges,i}toJson(){return{type:this.type,group:this.group,definition:this.definition,callers:this.callers,oldMutation:this.oldMutation,newMutation:this.newMutation,descendantChanges:this.descendantChanges}}run(e){var t,i,n,o,r,s=this.getEventWorkspace_(),a=g.utils.xml.textToDom(e?this.newMutation:this.oldMutation),l=s.getBlockById(this.definition);g.Events.disable(),l.domToMutation(a),l.updateArgumentInputs_(),l.afterWorkspaceLoad();for(t of this.callers){var c,u=s.getBlockById(t.id);if(e)u.domToMutation(a);else{u.domToMutation(g.utils.xml.textToDom(t.oldMutation));for(var d of t.shadows)d.connectedBlock?(c=s.getBlockById(d.connectedBlock),u.getInput(d.inputName).connection.connect(c.outputConnection)):u.getInput(d.inputName).connection.setShadowState(d.connectedShadow)}}for(i of this.descendantChanges)i.newName?s.getBlockById(i.id).setFieldValue(e?i.newName:i.oldName,"VALUE"):e?(n=s.getBlockById(i.id))&&n.dispose():((n=s.newBlock(i.type,i.id)).setFieldValue(i.oldName,"VALUE"),n.initSvg(),(r=(o=s.getBlockById(i.targetBlockId).getInput(i.targetInputName).connection).targetBlock())&&!r.isShadow()&&r.dispose(),o.connect(n.outputConnection));g.Events.enable()}}},{"../../compiler/util":15,"../../loader":77,"./blocks/functionDeclarationBlock":102,"./constants":105,"./functionManager":110,"./msg":112,blockly:219}],115:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});i=e("blockly");i.Extensions.unregister("logic_compare"),i.Extensions.register("logic_compare",function(){})},{blockly:219}],116:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});let s=e("blockly"),a=e("../../fields/field_imagenotext");s.Blocks.controls_if=Object.assign(Object.assign({},{elseifCount_:0,elseCount_:0,valueConnections_:[],statementConnections_:[],elseStatementConnection_:null,mutationToDom:function(){var e;return this.elseifCount_||this.elseCount_?(e=s.utils.xml.createElement("mutation"),this.elseifCount_&&e.setAttribute("elseif",this.elseifCount_+""),this.elseCount_&&e.setAttribute("else","1"),e):null},domToMutation:function(e){e&&(this.elseifCount_=parseInt(e.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(e.getAttribute("else"),10)||0,this.rebuildShape_())},storeConnections_:function(t){t=t||0,this.valueConnections_=[null],this.statementConnections_=[null],this.elseStatementConnection_=null;for(let e=1;e<=this.elseifCount_;e++)t!=e&&(this.valueConnections_.push(this.getInput("IF"+e).connection.targetConnection),this.statementConnections_.push(this.getInput("DO"+e).connection.targetConnection));this.getInput("ELSE")&&(this.elseStatementConnection_=this.getInput("ELSE").connection.targetConnection)},restoreConnections_:function(){var t,e;for(let e=1;e<=this.elseifCount_;e++)this.reconnectValueConnection_(e,this.valueConnections_),null!=(t=this.statementConnections_[e])&&t.reconnect(this,"DO"+e);this.getInput("ELSE")&&null!=(e=this.elseStatementConnection_)&&e.reconnect(this,"ELSE")},addElse_:function(){this.update_(()=>{this.elseCount_++})},removeElse_:function(){this.update_(()=>{this.elseCount_--})},addElseIf_:function(){this.update_(()=>{this.elseifCount_++})},removeElseIf_:function(e){this.update_(()=>{this.elseifCount_--},e)},update_:function(e,t){s.Events.setGroup(!0),this.storeConnections_(t);let i=this;t=i.mutationToDom(),t=t&&s.Xml.domToText(t);e&&e.call(this),this.updateShape_(),i instanceof s.BlockSvg&&i.initSvg();let n=s.Events.getGroup();e=i.mutationToDom(),e=e&&s.Xml.domToText(e);t!=e&&(s.Events.fire(new s.Events.BlockChange(i,"mutation",null,t,e)),setTimeout(function(){s.Events.setGroup(n),i.bumpNeighbours(),s.Events.setGroup(!1)},s.config.bumpDelay)),i.rendered&&i instanceof s.BlockSvg&&i.queueRender(),this.restoreConnections_(),s.Events.setGroup(!1)},updateShape_:function(){this.getInput("ELSE")&&(this.removeInput("ELSE"),this.removeInput("ELSETITLE"),this.removeInput("ELSEBUTTONS"));let e=1;for(;this.getInput("IF"+e);)this.removeInput("IF"+e),this.removeInput("IFTITLE"+e),this.removeInput("IFBUTTONS"+e),this.removeInput("DO"+e),e++;for(let e=1;e<=this.elseifCount_;e++){var t=(e=>function(){o.removeElseIf_(e)})(e);this.appendValueInput("IF"+e).setCheck("Boolean").appendField(s.Msg.CONTROLS_IF_MSG_ELSEIF).setShadowDom((n=i=void 0,(i=document.createElement("shadow")).setAttribute("type","logic_boolean"),(n=document.createElement("field")).setAttribute("name","BOOL"),n.textContent="FALSE",i.appendChild(n),i)),this.appendDummyInput("IFTITLE"+e).appendField(s.Msg.CONTROLS_IF_MSG_THEN),this.appendDummyInput("IFBUTTONS"+e).appendField(new a.FieldImageNoText(this.REMOVE_IMAGE_DATAURI,24,24,"*",t,!1)).setAlign(s.inputs.Align.RIGHT),this.appendStatementInput("DO"+e)}var i,n;this.elseCount_&&(this.appendDummyInput("ELSETITLE").appendField(s.Msg.CONTROLS_IF_MSG_ELSE),this.appendDummyInput("ELSEBUTTONS").setAlign(s.inputs.Align.RIGHT).appendField(new a.FieldImageNoText(this.REMOVE_IMAGE_DATAURI,24,24,"*",this.removeElse_.bind(this),!1)),this.appendStatementInput("ELSE")),this.getInput("ADDBUTTON")&&this.removeInput("ADDBUTTON");let o=this;function r(){0==o.elseCount_?o.addElse_():(o.elseifCount_||(o.elseifCount_=0),o.addElseIf_())}this.appendDummyInput("ADDBUTTON").appendField(new a.FieldImageNoText(this.ADD_IMAGE_DATAURI,24,24,"*",r,!1))},rebuildShape_:function(){var e=[null],t=[null];let i=null,n=(this.getInput("ELSE")&&(i=this.getInput("ELSE").connection.targetConnection),1);for(;this.getInput("IF"+n);){var o=this.getInput("IF"+n),r=this.getInput("DO"+n);e.push(o.connection.targetConnection),t.push(r.connection.targetConnection),n++}this.updateShape_(),this.reconnectChildBlocks_(e,t,i)},reconnectChildBlocks_:function(t,i,e){var n;for(let e=1;e<=this.elseifCount_;e++)this.reconnectValueConnection_(e,t),null!=(n=i[e])&&n.reconnect(this,"DO"+e);null!=e&&e.reconnect(this,"ELSE")},reconnectValueConnection_:function(e,t){var i=null==(i=this.getInput("IF"+e))?void 0:i.connection.targetBlock();t[e]&&(t[e].reconnect(this,"IF"+e),i)&&!i.getParent()&&i.dispose()}}),{init(){var e;s.Extensions.apply("inline-svgs",this,!1),this.elseifCount_=0,this.elseCount_=0,this.setHelpUrl(s.Msg.CONTROLS_IF_HELPURL),this.appendValueInput("IF0").setCheck("Boolean").appendField(s.Msg.CONTROLS_IF_MSG_IF),this.appendDummyInput("THEN0").appendField(s.Msg.CONTROLS_IF_MSG_THEN),this.appendStatementInput("DO0"),this.workspace instanceof s.WorkspaceSvg&&(e=this.workspace.getRenderer(),this.setOutputShape(e.getConstants().SHAPES.HEXAGONAL)),this.updateShape_(),this.setInputsInline(!0),this.setColour(s.Msg.LOGIC_HUE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(()=>this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?s.Msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?s.Msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?s.Msg.CONTROLS_IF_TOOLTIP_4:"":s.Msg.CONTROLS_IF_TOOLTIP_1)}})},{"../../fields/field_imagenotext":38,blockly:219}],117:[function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,o)}:function(e,t,i,n){e[n=void 0===n?i:n]=t[i]}),o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),o(e("./extensions"),i),o(e("./ifElse"),i)},{"./extensions":115,"./ifElse":116}],118:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldSlider=void 0;let o=e("blockly");class n extends o.FieldNumber{constructor(e,t,i,n,o,r,s,a){super(e,t,i,n,s,a),this.keyboardControlActive=!1,"string"==typeof o?this.step_=parseFloat(o):"number"==typeof o&&(this.step_=o),this.labelText_=r}hasMin(){return this.getMin()>-1/0}hasMax(){return this.getMax()<1/0}getStep(){return this.step_}getLabel(){return this.labelText_}setLabel(e){this.labelText_=e}setOptions(e,t,i,n){this.setConstraints(e,t,n),this.step_=parseFloat(i)||void 0}getFieldDescription(){return this.getValue()+""}doClassValidation_(e){if(null===e)return null;e=(e=(e=(e=""+e).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity");let t=Number(e||0);if(isNaN(t))return null;this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_);let i=String(this.precision_);e=(i=-1!==i.indexOf("e")?this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}):i).indexOf(".");let n;return n=-1===e?this.precision_?0:null:i.length-e-1,t=null!==n?Number(t.toFixed(n)):t}widgetDispose_(){this.removeEventListeners(),super.widgetDispose_()}addEventListeners(){this.inputKeydownHandler=this.inputKeydownListener.bind(this),this.htmlInput_.addEventListener("keydown",this.inputKeydownHandler),this.sliderKeydownHandler=this.sliderKeydownListener.bind(this),this.slider_.addEventListener("keydown",this.sliderKeydownHandler),this.sliderBlurHandler=this.sliderBlurListener.bind(this),this.slider_.addEventListener("blur",this.sliderBlurHandler),this.sliderPointerdownHandler=this.sliderPointerdownListener.bind(this),this.slider_.addEventListener("pointerdown",this.sliderPointerdownHandler)}removeEventListeners(){this.htmlInput_.removeEventListener("keydown",this.inputKeydownHandler),this.slider_.removeEventListener("keydown",this.sliderKeydownHandler),this.slider_.removeEventListener("blur",this.sliderBlurHandler),this.slider_.removeEventListener("pointerdown",this.sliderPointerdownHandler)}inputKeydownListener(e){"ArrowDown"===e.key&&(e.preventDefault(),this.keyboardControlActive=!0,this.slider_.focus())}sliderPointerdownListener(e){this.keyboardControlActive=!1}sliderKeydownListener(e){switch(e.key){case"ArrowUp":e.preventDefault(),this.htmlInput_.focus();break;case"Enter":case" ":e.preventDefault(),e.stopPropagation(),o.hideChaff()}}sliderBlurListener(e){this.keyboardControlActive=!1}showEditor_(e,t){super.showEditor_(e,!0),o.DropDownDiv.hideWithoutAnimation(),o.DropDownDiv.clearContent(),o.DropDownDiv.getContentDiv().style.height="";e=o.DropDownDiv.getContentDiv();e.setAttribute("role","menu"),e.setAttribute("aria-haspopup","true"),this.addSlider_(e),o.DropDownDiv.setColour("#ffffff","#dddddd"),o.DropDownDiv.showPositionedByBlock(this,this.sourceBlock_,void 0,void 0,!1),this.addEventListeners(),t||this.htmlInput_.focus()}addSlider_(e){var t;this.labelText_&&(t=this.createLabelDom_(this.labelText_),e.appendChild(t[0]),this.readout_=t[1],this.setReadout(this.value_)),this.slider_=this.createSlider(),e.appendChild(this.slider_);let n=()=>{pxt.BrowserUtils.isFirefox()||this.keyboardControlActive||this.htmlInput_.focus()};o.browserEvents.bind(this.slider_,"input",this,e=>{var t,i=parseFloat(this.slider_.value)||0;null!==i&&(this.setValue(i),t=this.htmlInput_)&&(t.value=i+"",n())}),o.browserEvents.bind(this.slider_,"focus",this,e=>{n()})}setValue(e,t){super.setValue(e,t),this.updateDom(),this.slider_&&(this.slider_.value=this.getValue()+"")}createSlider(){var e=document.createElement("input");e.setAttribute("class","blocklyFieldSlider"),e.type="range",e.min=this.getMin()+"",e.max=this.getMax()+"",e.value=this.getValue()+"";let t;return this.sourceBlock_ instanceof o.BlockSvg&&("#ffffff"===this.sourceBlock_.getColour()?this.sourceBlock_.getParent()&&(t=this.sourceBlock_.getParent().getColourTertiary()):t=this.sourceBlock_.getColourTertiary()),t&&e.setAttribute("style","--blocklyFieldSliderBackgroundColor: "+t),Number.isNaN(this.step_)||(e.step=this.step_+""),e}updateDom(){this.setReadout(this.getValue())}setReadout(e){this.readout_&&(this.readout_.innerText=e+"")}createLabelDom_(e){var t=document.createElement("div"),i=(t.setAttribute("class","blocklyFieldSliderLabel"),document.createElement("span")),n=(i.setAttribute("class","blocklyFieldSliderReadout"),document.createElement("span"));return n.setAttribute("class","blocklyFieldSliderLabelText"),n.innerText=e,t.appendChild(n),t.appendChild(i),[t,i]}}i.FieldSlider=n,o.fieldRegistry.register("field_slider",n),o.Css.register(`
:root {
    --blocklyFieldSliderBackgroundColor: #547AB2;
}
.blocklyFieldSliderLabel {
    font-family: "Helvetica Neue", "Segoe UI", Helvetica, sans-serif;
    font-size: 0.65rem;
    color: $colour_toolboxText;
    margin: 8px;
}
.blocklyFieldSliderLabelText {
    font-weight: bold;
}
.blocklyFieldSliderReadout {
    margin-left: 10px;
}

input[type=range].blocklyFieldSlider {
    -webkit-appearance: none;
    width: 100%;
}
input[type=range].blocklyFieldSlider:focus {
    outline: none;
}
input[type=range].blocklyFieldSlider::-webkit-slider-runnable-track {
    -webkit-appearance: none;
    margin: 8px;
    height: 22px;
    width: 150px;
    outline: none;
    border-radius: 11px;
    margin-bottom: 20px;
    background: var(--blocklyFieldSliderBackgroundColor);
}
input[type=range].blocklyFieldSlider::-webkit-slider-thumb {
    -webkit-appearance: none;
    width: 26px;
    height: 26px;
    margin-top: -1px;
    background-color: white;
    border-radius: 100%;
    -webkit-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);
    -moz-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);
    box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);
    cursor: pointer;
}
input[type=range].blocklyFieldSlider:focus-visible::-webkit-slider-thumb {
    outline: 2px solid white; 
    outline-offset: 3px;
    -webkit-box-shadow: 0 0 0 3px var(--pxt-focus-border);
    -moz-box-shadow: 0 0 0 3px var(--pxt-focus-border);
    box-shadow: 0 0 0 3px var(--pxt-focus-border);
}
input[type=range].blocklyFieldSlider::-moz-range-track {
    margin: 8px;
    height: 22px;
    width: 95%;
    outline: none;
    border-radius: 11px;
    margin-bottom: 20px;
    background: #547AB2;
}
input[type=range].blocklyFieldSlider::-moz-range-thumb {
    width: 26px;
    height: 26px;
    margin-top: -1px;
    background-color: white;
    border-radius: 100%;
    -webkit-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);
    -moz-box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);
    box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.15);
    cursor: pointer;
}
`)},{blockly:219}],119:[function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,o)}:function(e,t,i,n){e[n=void 0===n?i:n]=t[i]}),o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),o(e("./fieldSlider"),i),o(e("./numberBlocks"),i)},{"./fieldSlider":118,"./numberBlocks":120}],120:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});let n=e("blockly");i=new n.zelos.ConstantProvider,n.defineBlocksWithJsonArray([{type:"math_integer",message0:"%1",args0:[{type:"field_number",name:"NUM",precision:1}],output:"Number",outputShape:i.SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_whole_number",message0:"%1",args0:[{type:"field_number",name:"NUM",min:0,precision:1}],output:"Number",outputShape:i.SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_positive_number",message0:"%1",args0:[{type:"field_number",name:"NUM",min:0}],output:"Number",outputShape:i.SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_number_minmax",message0:"%1",args0:[{type:"field_slider",name:"SLIDER",value:0,step:1,labelText:"Number"}],output:"Number",outputShape:i.SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",mutator:"math_number_minmax_mutator",extensions:["parent_tooltip_when_inline"]}]),e={mutationToDom:function(){var e=this.inputList[0].fieldRow[0],t=n.utils.xml.createElement("mutation");return e.hasMin()&&t.setAttribute("min",e.getMin()+""),e.hasMax()&&t.setAttribute("max",e.getMax()+""),null!=e.getLabel()&&t.setAttribute("label",e.getLabel()),null!=e.getStep()&&t.setAttribute("step",e.getStep()+""),null!=e.getPrecision()&&t.setAttribute("precision",e.getPrecision()+""),t},domToMutation:function(e){var t=this.inputList[0].fieldRow[0],i=e.getAttribute("min"),n=e.getAttribute("max"),o=e.getAttribute("step"),r=e.getAttribute("label"),e=e.getAttribute("precision");t.setLabel(r),t.setOptions(i,n,o,e)}};n.Extensions.registerMutator("math_number_minmax_mutator",e)},{blockly:219}],121:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.showEditorMixin=void 0;let u=e("blockly"),d=e("../../fields");i.showEditorMixin=function(e){var n=this.getSourceBlock();if(!n)throw new u.UnattachedFieldError;var o=new u.Menu,r=(o.setRole(u.utils.aria.Role.LISTBOX),this.menu_=o,this.getOptions(!1));let s=null;var a,l,c=e=>{u.DropDownDiv.hideIfOwner(this,!0),this.onItemSelected_(this.menu_,e)};for(let i=0;i<r.length;i++){let[e,t]=r[i];"SEPARATOR"===t?(l=new h(""),o.addChild(l)):(a=(l=void 0,d.isImageProperties)(e)?((l=new Image(e.width,e.height)).src=e.src,l.alt=e.alt||"",l):e,(a=new u.MenuItem(a,t)).setRole(u.utils.aria.Role.OPTION),a.setRightToLeft(n.RTL),a.setCheckable(!0),o.addChild(a),a.setChecked(t===this.value_),a.onAction(c,this),t===this.value_&&(s=a))}e&&"number"==typeof e.clientX?this.menu_.openingCoords=new u.utils.Coordinate(e.clientX,e.clientY):this.menu_.openingCoords=null,u.DropDownDiv.clearContent(),u.DropDownDiv.getContentDiv().style.height="";var t,e=this.menu_.render(u.DropDownDiv.getContentDiv());u.utils.dom.addClass(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(e=n.getColour(),t=this.sourceBlock_.style.colourTertiary,u.DropDownDiv.setColour(e,t)),u.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),u.DropDownDiv.getContentDiv().style.height=this.menu_.getSize().height+"px",this.menu_.focus(),s&&this.menu_.setHighlighted(s),this.applyColour()};class h extends u.MenuItem{createDom(){var e=document.createElement("div");return e.id=u.utils.idGenerator.getNextUniqueId(),(this.element_=e).className="blockly-menuseparator",e.setAttribute("role","separator"),e}getElement(){return this.element_}getId(){return this.element_.id}isEnabled(){return!1}}u.Css.register(`
.blockly-menuseparator {
    border-top: 1px solid rgba(0, 0, 0, 0.2);
    margin: 4px 0;
    padding: 0;
}
`)},{"../../fields":70,blockly:219}],122:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldVariable=void 0;let n=e("blockly"),o=e("./fieldDropdownMixin");class r extends n.FieldVariable{constructor(e,t,i,n,o){super(e,t,i,n,o),this.svgRootBinding=null,this.fieldRootBinding=null,this.menuGenerator_=r.dropdownCreate}static dropdownCreate(){var e=n.FieldVariable.dropdownCreate.call(this),t=e.findIndex(e=>"RENAME_VARIABLE_ID"===e[1]);return e.splice(t,0,[n.Msg.NEW_VARIABLE_DROPDOWN,r.CREATE_VARIABLE_ID],[void 0,"SEPARATOR"]),e}onItemSelected_(e,t){if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&t.getValue()===r.CREATE_VARIABLE_ID)return void n.Variables.createVariableButtonHandler(this.sourceBlock_.workspace,e=>{e=this.sourceBlock_.workspace.getVariableMap().getVariable(e);e&&this.setValue(e.getId())});super.onItemSelected_(e,t)}initView(){super.initView(),this.shouldAddBorderRect_()||(this.createBorderRect_(),this.clickTargetRect=this.borderRect_,this.clickTargetRect.setAttribute("stroke-opacity","0"),this.clickTargetRect.setAttribute("fill-opacity","0"),this.borderRect_=void 0)}shouldAddBorderRect_(){if("variables_get"===this.sourceBlock_.type)return!1;for(var e of this.sourceBlock_.inputList)for(var t of e.fieldRow)if(t!==this&&t.EDITABLE)return!0;return!this.sourceBlock_.getInputsInline()||super.shouldAddBorderRect_()}bindEvents_(){this.shouldAddBorderRect_()?super.bindEvents_():(this.svgRootBinding=n.browserEvents.conditionalBind(this.sourceBlock_.getSvgRoot(),"pointerdown",this,e=>{this.sourceBlock_.icons.length||this.onMouseDown_(e)},!1),this.fieldRootBinding=n.browserEvents.conditionalBind(this.getSvgRoot(),"pointerdown",this,e=>{this.sourceBlock_.icons.length&&this.onMouseDown_(e)},!1))}dispose(){super.dispose(),this.svgRootBinding&&(n.browserEvents.unbind(this.svgRootBinding),n.browserEvents.unbind(this.fieldRootBinding))}positionBorderRect_(){super.positionBorderRect_(),this.clickTargetRect&&(this.clickTargetRect.setAttribute("width",String(this.size_.width)),this.clickTargetRect.setAttribute("height",String(this.size_.height)),this.clickTargetRect.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.clickTargetRect.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}showEditor_(e){o.showEditorMixin.call(this,e)}getValue(){var e,t=super.getValue();if(null!=(e=this.sourceBlock_)&&e.isInFlyout&&(null==(e=this.sourceBlock_.workspace)?void 0:e.getPotentialVariableMap()).getVariableById(t))return"potential_"+t;return t}}(i.FieldVariable=r).CREATE_VARIABLE_ID="CREATE_VARIABLE",n.fieldRegistry.unregister("field_variable"),n.fieldRegistry.register("field_variable",r)},{"./fieldDropdownMixin":121,blockly:219}],123:[function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,o)}:function(e,t,i,n){e[n=void 0===n?i:n]=t[i]}),o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),o(e("./fieldVariable"),i)},{"./fieldVariable":122}],124:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.isCollapsedInputRow=i.CollapsedInputRow=void 0;let n=e("blockly");class o extends n.blockRendering.InputRow{constructor(e){super(e),this.type|=n.blockRendering.Types.INPUT_ROW|n.blockRendering.Types.getType("COLLAPSED_INPUT_ROW")}measure(){this.width=this.minWidth,this.height=this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT}}i.CollapsedInputRow=o,i.isCollapsedInputRow=function(e){return!!(e.type&n.blockRendering.Types.getType("COLLAPSED_INPUT_ROW"))}},{blockly:219}],125:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ConnectionPreviewer=void 0;let a=e("blockly");class l extends a.InsertionMarkerPreviewer{previewConnection(e,t){super.previewConnection(e,t),t.type!==a.ConnectionType.INPUT_VALUE&&t.type!==a.ConnectionType.OUTPUT_VALUE||this.showDraggedIndicatorWithLine(e,t)}previewReplacement(e,t,i){super.previewReplacement(e,t,i),this.showDraggedIndicatorWithLine(e,t)}showDraggedIndicatorWithLine(e,t){this.connectionLine||(this.connectionLine=a.utils.dom.createSvgElement("line",{class:"blocklyConnectionLine",x1:0,y1:0,x2:0,y2:0},e.sourceBlock_.getSvgRoot()),this.draggedConnectionIndicator=this.createConnectionIndicator(e.sourceBlock_.getSvgRoot(),e),i=t.sourceBlock_.getSvgRoot().querySelector(":scope>.blocklyConnectionIndicatorParent"),this.staticConnectionIndicator=this.createConnectionIndicator(i,t)),this.staticConnectionIndicator.parentElement.appendChild(this.staticConnectionIndicator);var i=l.CONNECTION_INDICATOR_RADIUS,n=e.getOffsetInBlock(),e=a.utils.Coordinate.sum(e.sourceBlock_.getRelativeToSurfaceXY(),n),t=a.utils.Coordinate.sum(t.sourceBlock_.getRelativeToSurfaceXY(),t.getOffsetInBlock()),o=t.x-e.x,t=t.y-e.y,e=Math.atan2(t,o),r=Math.sqrt(o*o+t*t),s=a.Gesture.inProgress();r<2*i+1||!s?a.utils.dom.addClass(this.connectionLine,"hidden"):s&&(a.utils.dom.removeClass(this.connectionLine,"hidden"),this.connectionLine.setAttribute("x1",String(n.x+Math.cos(e)*i)),this.connectionLine.setAttribute("y1",String(n.y+Math.sin(e)*i)),this.connectionLine.setAttribute("x2",String(n.x+o-Math.cos(e)*i)),this.connectionLine.setAttribute("y2",String(n.y+t-Math.sin(e)*i)))}hidePreview(){super.hidePreview(),this.connectionLine&&(this.connectionLine.remove(),this.connectionLine=null,this.draggedConnectionIndicator.remove(),this.draggedConnectionIndicator=null,this.staticConnectionIndicator.remove(),this.staticConnectionIndicator=null,this.staticConnection=null)}createConnectionIndicator(e,t){e=a.utils.dom.createSvgElement("g",{class:"blocklyInputConnectionIndicator"},e),a.utils.dom.createSvgElement("circle",{r:l.CONNECTION_INDICATOR_RADIUS},e),t=t.getOffsetInBlock();return e.setAttribute("transform","translate("+t.x+","+t.y+")"),e}}(i.ConnectionPreviewer=l).CONNECTION_INDICATOR_RADIUS=9},{blockly:219}],126:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ConstantProvider=void 0;let o=e("blockly");class n extends o.zelos.ConstantProvider{constructor(){super(...arguments),this.FIELD_TEXT_FONTFAMILY='"Consolas", "Monaco", "Menlo", "Ubuntu Mono", "source-code-pro", monospace',this.FIELD_TEXT_FONTWEIGHT="600",this.HIGHLIGHT_GLOW_COLOUR="#FFF200",this.ERROR_HIGHLIGHT_GLOW_COLOR="#FF0000",this.HIGHLIGHT_GLOW_SIZE=1.1,this.ELLIPSES_RADIUS=6,this.ELLIPSES_SPACING=8,this.ellipses=this.makeEllipses()}createDom(e,t,i,n){super.createDom(e,t,i,n);t=o.utils.dom.createSvgElement(o.utils.Svg.DEFS,{},e);this.highlightOutlineFilter=this.createHighlight(t,"blocklyHighlightedGlowFilter",this.HIGHLIGHT_GLOW_COLOUR),this.highlightOutlineFilterId=this.highlightOutlineFilter.id,this.errorOutlineFilter=this.createHighlight(t,"blocklyErrorHighlightedGlowFilter",this.ERROR_HIGHLIGHT_GLOW_COLOR),this.errorOutlineFilterId=this.errorOutlineFilter.id,this.embossFilterOverride=this.createOutline(t,"blocklyBubbleEmbossGlowFilter"),this.embossFilterId=this.embossFilterOverride.id}dispose(){super.dispose(),this.highlightOutlineFilter&&o.utils.dom.removeNode(this.highlightOutlineFilter)}makeEllipses(){var t=this.ELLIPSES_RADIUS,i=this.ELLIPSES_SPACING;let n="";for(let e=0;e<3;e++)n+=o.utils.svgPaths.moveBy(i,0)+o.utils.svgPaths.arc("a","180 1,1",t,o.utils.svgPaths.point(2*t,0));for(let e=0;e<3;e++)n+=o.utils.svgPaths.arc("a","180 1,1",t,o.utils.svgPaths.point(2*-t,0))+o.utils.svgPaths.moveBy(-i,0);return n}getCSS_(e){return super.getCSS_(e).concat([e+" .blocklyConnectionIndicator, "+e+" .blocklyInputConnectionIndicator {","fill: #ff0000;","stroke: #ffff00;","stroke-width: 3px;","}",e+" .blocklyConnectionIndicator {","display: none;","}",e+" .blocklyBlockDragSurface > g > .blocklyDraggable > .blocklyConnectionIndicator {","display: block;","}",e+" .blocklyConnectionLine {","stroke: #ffff00;","stroke-width: 4px;","}",e+" .blocklyConnectionLine.hidden {","display: none;","}",e+" .blocklyFlyoutHeading .blocklyFlyoutLabelText {font-size: 1.5rem;","}"])}createHighlight(e,t,i){t=o.utils.dom.createSvgElement(o.utils.Svg.FILTER,{id:t+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),o.utils.dom.createSvgElement(o.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.HIGHLIGHT_GLOW_SIZE},t),e=o.utils.dom.createSvgElement(o.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},t);return o.utils.dom.createSvgElement(o.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},e),o.utils.dom.createSvgElement(o.utils.Svg.FEFLOOD,{"flood-color":i,"flood-opacity":1,result:"outColor"},t),o.utils.dom.createSvgElement(o.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),t}createOutline(e,t){t=o.utils.dom.createSvgElement(o.utils.Svg.FILTER,{id:t+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),o.utils.dom.createSvgElement(o.utils.Svg.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:.92},t),e=o.utils.dom.createSvgElement(o.utils.Svg.FECOMPONENTTRANSFER,{result:"outBlur"},t),o.utils.dom.createSvgElement(o.utils.Svg.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},e),o.utils.dom.createSvgElement(o.utils.Svg.FEFLOOD,{"flood-color":"#000000","flood-opacity":.5,result:"outColor"},t),o.utils.dom.createSvgElement(o.utils.Svg.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),e=o.utils.dom.createSvgElement("feMerge",{},t);return o.utils.dom.createSvgElement("feMergeNode",{in:"outBlur"},e),o.utils.dom.createSvgElement("feMergeNode",{in:"outGlow"},e),o.utils.dom.createSvgElement("feMergeNode",{in:"SourceGraphic"},e),t}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case o.ConnectionType.INPUT_VALUE:case o.ConnectionType.OUTPUT_VALUE:return t&&t.includes("Boolean")?this.HEXAGONAL:(t&&t.includes("Number")||t&&t.includes("String"),this.ROUNDED);case o.ConnectionType.PREVIOUS_STATEMENT:case o.ConnectionType.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}}(i.ConstantProvider=n).COLLAPSE_IMAGE_DATAURI="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg enable-background='new 0 0 24 24' version='1.1' viewBox='0 0 24 24' xml:space='preserve' xmlns='http://www.w3.org/2000/svg'%3E%3Cstyle type='text/css'%3E .st0%7Bfill:%23CF8B17;%7D .st1%7Bfill:%23FFFFFF;%7D%0A%3C/style%3E%3Ctitle%3Erepeat%3C/title%3E%3Ccircle cx='12' cy='12' r='10.503' fill='none' stroke='%23fff' stroke-linecap='square' stroke-linejoin='round' stroke-width='2'/%3E%3Cg transform='matrix(.0086269 0 0 -.0086269 4.8224 17.354)'%3E%3Cpath d='m1611 367.42q0 53-37 90l-651 651q-38 38-91 38-54 0-90-38l-651-651q-38-36-38-90 0-53 38-91l74-75q39-37 91-37 53 0 90 37l486 486 486-486q37-37 90-37 52 0 91 37l75 75q37 39 37 91z' fill='%23fff'/%3E%3C/g%3E%3C/svg%3E%0A",n.EXPAND_IMAGE_DATAURI="data:image/svg+xml,%3C%3Fxml version='1.0' encoding='UTF-8'%3F%3E%3Csvg enable-background='new 0 0 24 24' version='1.1' viewBox='0 0 24 24' xml:space='preserve' xmlns='http://www.w3.org/2000/svg'%3E%3Cstyle type='text/css'%3E .st0%7Bfill:%23CF8B17;%7D .st1%7Bfill:%23FFFFFF;%7D%0A%3C/style%3E%3Ctitle%3Erepeat%3C/title%3E%3Ccircle cx='12' cy='12' r='10.503' fill='none' stroke='%23fff' stroke-linecap='square' stroke-linejoin='round' stroke-width='2'/%3E%3Cg transform='matrix(.0086269 0 0 -.0086269 4.8224 17.654)'%3E%3Cpath d='m1611 832q0-53-37-90l-651-651q-38-38-91-38-54 0-90 38l-651 651q-38 36-38 90 0 53 38 91l74 75q39 37 91 37 53 0 90-37l486-486 486 486q37 37 90 37 52 0 91-37l75-75q37-39 37-91z' fill='%23fff'/%3E%3C/g%3E%3C/svg%3E%0A"},{blockly:219}],127:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),e("blockly").Css.register(`
.blocklyDropdownMenu .blocklyMenuItemCheckbox {
    filter: contrast(0) brightness(100);
}

.blocklyVerticalMarker {
    fill: none;
}
`)},{blockly:219}],128:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Drawer=void 0;let s=e("blockly"),n=e("./collapsedInputRow");class o extends s.zelos.Drawer{drawCollapsedStack_(e){var t=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.constants_.INSIDE_CORNERS.width,i=this.constants_.STATEMENT_INPUT_PADDING_LEFT+2*this.constants_.INSIDE_CORNERS.width+s.utils.svgPaths.lineOnAxis("h",-this.constants_.INSIDE_CORNERS.width)+this.constants_.INSIDE_CORNERS.pathTop,n=e.height-2*this.constants_.INSIDE_CORNERS.height,o=this.constants_.INSIDE_CORNERS.pathBottom+s.utils.svgPaths.lineOnAxis("h",this.constants_.INSIDE_CORNERS.width),r=this.constants_.ellipses;this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.bottomRight+s.utils.svgPaths.lineOnAxis("H",t)+i+s.utils.svgPaths.lineOnAxis("v",n/2)+r+s.utils.svgPaths.lineOnAxis("v",n/2)+o+s.utils.svgPaths.lineOnAxis("H",e.xPos+e.width-this.constants_.OUTSIDE_CORNERS.rightHeight)+this.constants_.OUTSIDE_CORNERS.topRight}drawOutline_(){if(this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection)this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_();else{this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){var t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):(0,n.isCollapsedInputRow)(t)?this.drawCollapsedStack_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}}drawLeft_(){if(super.drawLeft_(),this.info_.rows.find(function(e){return(0,n.isCollapsedInputRow)(e)})){let e=this.info_.startY;s.blockRendering.Types.isLeftRoundedCorner(this.info_.topRow.elements[0])&&(e+=this.constants_.OUTSIDE_CORNERS.rightHeight),this.outlinePath_=this.outlinePath_.slice(0,-1),this.outlinePath_+=s.utils.svgPaths.lineOnAxis("V",e)}}}i.Drawer=o},{"./collapsedInputRow":124,blockly:219}],129:[function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,o)}:function(e,t,i,n){e[n=void 0===n?i:n]=t[i]}),o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),o(e("./renderer"),i),o(e("./connectionPreviewer"),i),o(e("./css"),i)},{"./connectionPreviewer":125,"./css":127,"./renderer":132}],130:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.RenderInfo=void 0;let r=e("blockly"),n=e("./collapsedInputRow");class o extends r.zelos.RenderInfo{measure(){if(this.block_)for(var e of this.block_.inputList)e.init();super.measure()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let n=new r.blockRendering.InputRow(this.constants_);this.inputRows.push(n);var i=this.block_.getIcons();for(let e=0,t;t=i[e];e++){var o=new r.blockRendering.Icon(this.constants_,t);this.isCollapsed&&!t.isShownWhenCollapsed()||n.elements.push(o)}let t=void 0;for(let e=0,i;i=this.block_.inputList[e];e++)if(i.isVisible()){this.shouldStartNewRow_(i,t)&&(this.rows.push(n),n=new r.blockRendering.InputRow(this.constants_),this.inputRows.push(n));for(let e=0,t;t=i.fieldRow[e];e++)n.elements.push(new r.blockRendering.Field(this.constants_,t,i));this.addInput_(i,n),t=i}this.isCollapsed&&(this.block_.inputList.find(function(e){return e.type==r.inputs.inputTypes.STATEMENT})?n=this.addCollapsedRow_(n):(n.hasJaggedEdge=!0,n.elements.push(new r.blockRendering.JaggedEdge(this.constants_)))),(n.elements.length||n.hasDummyInput)&&this.rows.push(n),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection;var e=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof r.inputs.StatementInput||this.rows.some(e=>(0,n.isCollapsedInputRow)(e)),e=(this.bottomRow.minHeight=e?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)),e=(e?this.bottomRow.elements.push(new r.blockRendering.SquareCorner(this.constants_)):this.bottomRow.elements.push(new r.blockRendering.RoundCorner(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new r.blockRendering.NextConnection(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_));e?this.bottomRow.elements.push(new r.blockRendering.SquareCorner(this.constants_,"right")):this.bottomRow.elements.push(new r.blockRendering.RoundCorner(this.constants_,"right"))}addCollapsedRow_(e){this.rows.push(e);e=new n.CollapsedInputRow(this.constants_);return e.hasDummyInput=!0,e}}i.RenderInfo=o},{"./collapsedInputRow":124,blockly:219}],131:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.PathObject=void 0;let r=e("blockly"),n="blockly-dotted-outline-on-hover";class o extends r.zelos.PathObject{constructor(){super(...arguments),this.connectionPointIndicators=new WeakMap}setPath(e){super.setPath(e),this.svgPathHighlighted&&this.svgPathHighlighted.setAttribute("d",e)}updateHighlighted(e){e?this.svgPathHighlighted||(e=this.constants,e=this.hasError?e.errorOutlineFilterId:e.highlightOutlineFilterId,this.svgPathHighlighted=this.svgPath.cloneNode(!0),this.svgPathHighlighted.classList.add("pxtRendererHighlight"),this.svgPathHighlighted.setAttribute("fill","none"),this.svgPathHighlighted.setAttribute("filter","url(#"+e+")"),this.svgRoot.appendChild(this.svgPathHighlighted)):this.svgPathHighlighted&&(this.svgRoot.removeChild(this.svgPathHighlighted),this.svgPathHighlighted=null)}updateSelected(e){e&&this.svgPath.classList.remove("hover"),super.updateSelected(e)}addConnectionHighlight(e,t,i,n){e=super.addConnectionHighlight(e,t,i,n);return this.staticConnectionIndicatorParentGroup?this.svgRoot.appendChild(this.staticConnectionIndicatorParentGroup):this.staticConnectionIndicatorParentGroup=r.utils.dom.createSvgElement("g",{class:"blocklyConnectionIndicatorParent"},this.svgRoot),e}removeConnectionHighlight(e){var t;null!=(t=this.staticConnectionIndicatorParentGroup)&&t.remove(),super.removeConnectionHighlight(e)}applyColour(t){if(super.applyColour(t),t.outputConnection){let e=!1;var i,n,o=t.getParent();o&&(t.isShadow()?(n=o.style.colourTertiary,(.2126*(i=r.utils.colour.hexToRgb(n))[0]+.7152*i[1]+.0722*i[2])/255<.15&&(this.svgPath.setAttribute("stroke",r.utils.colour.blend("#ffffff",n,.3)),e=!0)):(i=o.style.colourPrimary)===(n=t.style.colourPrimary)&&(o=r.utils.colour.blend("#0000000",n,.6),n=r.utils.colour.blend("#ffffff",n,.6),pxt.contrastRatio(o,i)>pxt.contrastRatio(n,i)?this.svgPath.setAttribute("stroke",o):this.svgPath.setAttribute("stroke",n),e=!0)),e||this.svgPath.setAttribute("stroke",t.style.colourTertiary)}}setHasDottedOutlineOnHover(e){(this.hasDottedOutlineOnHover=e)?(this.svgPath.classList.add(n),this.mouseOverData||(this.mouseOverData=r.browserEvents.bind(this.svgRoot,"mouseover",this,()=>{this.svgPath.classList.add("hover")}),this.mouseLeaveData=r.browserEvents.bind(this.svgRoot,"mouseleave",this,()=>{this.svgPath.classList.remove("hover")}))):(this.svgPath.classList.remove(n),this.mouseOverData&&(r.browserEvents.unbind(this.mouseOverData),r.browserEvents.unbind(this.mouseLeaveData),this.mouseOverData=void 0,this.mouseLeaveData=void 0),this.svgPath.classList.remove(n))}setHasError(e){this.hasError=e}isHighlighted(){return!!this.svgPathHighlighted}}(i.PathObject=o).CONNECTION_INDICATOR_RADIUS=9,r.Css.register(`
.blockly-dotted-outline-on-hover {
    transition: stroke .4s;
}
.blockly-dotted-outline-on-hover.hover {
    stroke-dasharray: 2;
    stroke: white;
    stroke-width: 2;
}
.blocklyDisabledPattern>.blocklyPath.pxtRendererHighlight {
    fill: none;
}
`)},{blockly:219}],132:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Renderer=void 0;var n=e("blockly");let o=e("./pathObject"),r=e("./constants"),s=e("./info"),a=e("./drawer");class l extends n.zelos.Renderer{makePathObject(e,t){return new o.PathObject(e,t,this.getConstants())}makeConstants_(){return new r.ConstantProvider}makeRenderInfo_(e){return new s.RenderInfo(this,e)}makeDrawer_(e,t){return new a.Drawer(e,t)}render(e){e.updateBeforeRender&&e.updateBeforeRender(),super.render(e)}}i.Renderer=l,n.blockRendering.register("pxt",l)},{"./constants":126,"./drawer":128,"./info":130,"./pathObject":131,blockly:219}],133:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldString=void 0;let n=e("blockly");class o extends n.FieldTextInput{initView(){this.quoteSize_=16,this.quoteWidth_=8,this.quoteLeftX_=0,this.quoteRightX_=0,this.quoteY_=10,this.quoteLeft_&&this.quoteLeft_.parentNode.removeChild(this.quoteLeft_),this.quoteLeft_=n.utils.dom.createSvgElement("text",{"font-size":this.quoteSize_+"px",class:"field-text-quote"},this.fieldGroup_),super.initView(),this.quoteRight_&&this.quoteRight_.parentNode.removeChild(this.quoteRight_),this.quoteRight_=n.utils.dom.createSvgElement("text",{"font-size":this.quoteSize_+"px",class:"field-text-quote"},this.fieldGroup_),this.quoteLeft_.appendChild(document.createTextNode('"')),this.quoteRight_.appendChild(document.createTextNode('"'))}updateSize_(e){super.updateSize_(e);var e=this.value_?this.size_.width:1,t=this.positionLeft(e+3);this.textElement_.setAttribute("x",t+""),t+=this.positionRight(t+e+3),this.size_.width=e+t}positionLeft(e){if(!this.quoteLeft_)return 0;let t=0;return t=(this.sourceBlock_.RTL?this.quoteLeftX_=e+this.quoteWidth_+2*o.quotePadding:this.quoteLeftX_=0,this.quoteWidth_+o.quotePadding),this.quoteLeft_.setAttribute("transform","translate("+this.quoteLeftX_+","+this.quoteY_+")"),t}positionRight(e){if(!this.quoteRight_)return 0;let t=0;return t=(this.sourceBlock_.RTL?this.quoteRightX_=o.quotePadding:this.quoteRightX_=e+o.quotePadding,this.quoteWidth_+o.quotePadding),this.quoteRight_.setAttribute("transform","translate("+this.quoteRightX_+","+this.quoteY_+")"),t}}(i.FieldString=o).quotePadding=0,n.Css.register(`
.field-text-quote {
    fill: #a31515 !important;
}
`),n.fieldRegistry.register("field_string",o)},{blockly:219}],134:[function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,o)}:function(e,t,i,n){e[n=void 0===n?i:n]=t[i]}),o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),o(e("./fieldString"),i),o(e("./text"),i),o(e("./join"),i)},{"./fieldString":133,"./join":135,"./text":136}],135:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});let o=e("blockly"),r=e("../../fields/field_imagenotext");o.Extensions.registerMutator("pxt_text_join_mutator",{itemCount_:0,valueConnections_:[],mutationToDom:function(){var e=o.utils.xml.createElement("mutation");return e.setAttribute("items",this.itemCount_+""),e},domToMutation:function(e){this.itemCount_=parseInt(e.getAttribute("items"),10),this.updateShape_()},storeValueConnections_:function(){this.valueConnections_=[];for(let e=0;e<this.itemCount_;e++)this.valueConnections_.push(this.getInput("ADD"+e).connection.targetConnection)},restoreValueConnections_:function(){var t;for(let e=0;e<this.itemCount_;e++)null!=(t=this.valueConnections_[e])&&t.reconnect(this,"ADD"+e)},addItem_:function(){this.storeValueConnections_();var e,t,i;this.update_(()=>{this.itemCount_++}),this.restoreValueConnections_(),1<this.itemCount_&&(i=this.getInput("ADD0"))&&i.connection.targetConnection&&(e=this.getInput("ADD"+(this.itemCount_-1)),i=i.connection.getShadowDom())&&(t=o.utils.xml.createElement("shadow"),i=i.getAttribute("type"),t.setAttribute("type",i),t)&&(t.setAttribute("id",o.utils.idGenerator.genUid()),e.connection.setShadowDom(t))},removeItem_:function(){this.storeValueConnections_();this.update_(()=>{this.itemCount_--}),this.restoreValueConnections_()},update_:function(e){o.Events.setGroup(!0);let t=this;var i=t.mutationToDom(),i=i&&o.Xml.domToText(i);e&&e.call(this),this.updateShape_(),t instanceof o.BlockSvg&&t.initSvg();let n=o.Events.getGroup();e=t.mutationToDom(),e=e&&o.Xml.domToText(e);i!=e&&(o.Events.fire(new o.Events.BlockChange(t,"mutation",null,i,e)),setTimeout(function(){o.Events.setGroup(n),t.bumpNeighbours(),o.Events.setGroup(!1)},o.config.bumpDelay)),t.rendered&&t instanceof o.BlockSvg&&t.queueRender(),o.Events.setGroup(!1)},updateShape_:function(){let e=this;this.getInput("EMPTY")&&this.removeInput("EMPTY"),this.getInput("TITLE")||this.appendDummyInput("TITLE").appendField(o.Msg.TEXT_JOIN_TITLE_CREATEWITH);let t;for(t=0;t<this.itemCount_;t++)this.getInput("ADD"+t)||this.appendValueInput("ADD"+t).setAlign(o.inputs.Align.LEFT);for(;this.getInput("ADD"+t);)this.removeInput("ADD"+t),t++;this.getInput("BUTTONS")&&this.removeInput("BUTTONS");var i,n=this.appendDummyInput("BUTTONS"),n=(1<this.itemCount_&&n.appendField(new r.FieldImageNoText(this.REMOVE_IMAGE_DATAURI,24,24,"*",function(){e.removeItem_()},!1)),n.appendField(new r.FieldImageNoText(this.ADD_IMAGE_DATAURI,24,24,"*",function(){e.addItem_()},!1)),this.itemCount_<=4);this.setInputsInline(n),this.workspace instanceof o.WorkspaceSvg&&(i=this.workspace.getRenderer(),this.setOutputShape(n?i.getConstants().SHAPES.ROUND:i.getConstants().SHAPES.SQUARE))}},function(){o.Extensions.apply("inline-svgs",this,!1),this.itemCount_=2,this.updateShape_()}),o.defineBlocksWithJsonArray([{type:"text_join",message0:"",output:"String",outputShape:(new o.zelos.ConstantProvider).SHAPES.ROUND,style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"pxt_text_join_mutator"}])},{"../../fields/field_imagenotext":38,blockly:219}],136:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0});i=e("blockly");i.defineBlocksWithJsonArray([{type:"text",message0:"%1",args0:[{type:"field_string",name:"TEXT",text:""}],output:"String",outputShape:(new i.zelos.ConstantProvider).SHAPES.ROUND,style:"field_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]}])},{blockly:219}],137:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.blocksMetrics=i.render=i.renderWorkspace=i.cleanRenderingWorkspace=i.initRenderingWorkspace=void 0;let o=e("blockly"),n=e("./layout"),r=e("./importer"),s,a;function l(){return s||((a=document.createElement("div")).style.position="absolute",a.style.top="0",a.style.left="0",a.style.width="1px",a.style.height="1px",document.body.appendChild(a),s=o.inject(a,{move:{scrollbars:!1},readOnly:!0,sounds:!1,media:pxt.webConfig.commitCdnUrl+"blockly/media/",rtl:pxt.Util.isUserLanguageRtl(),renderer:"pxt"})),(0,r.clearWithoutEvents)(s),s}function c(){s&&s.dispose(),s=void 0}function u(e={emPixels:18,layout:1}){switch(e.splitSvg?1:e.layout||4){case 1:(0,n.verticalAlign)(s,e.emPixels||18);break;case 4:(0,n.flow)(s,{ratio:e.aspectRatio,useViewWidth:e.useViewWidth});break;case 3:s.cleanUp_&&s.cleanUp_()}let t=s.getMetrics();var i=a.querySelectorAll("svg")[0].cloneNode(!0);return(0,n.cleanUpBlocklySvg)(i),pxt.U.toArray(i.querySelectorAll(".blocklyBlockCanvas,.blocklyBubbleCanvas")).forEach(e=>e.setAttribute("transform",`translate(${-t.contentLeft}, ${-t.contentTop}) scale(1)`)),i.setAttribute("viewBox",`0 0 ${t.contentWidth} `+t.contentHeight),e.emPixels&&(i.style.width=t.contentWidth/e.emPixels+"em",i.style.height=t.contentHeight/e.emPixels+"em"),e.splitSvg?(0,n.splitSvg)(i,s,e.emPixels):i}i.initRenderingWorkspace=l,i.cleanRenderingWorkspace=c,i.renderWorkspace=u,i.render=function(e,t={emPixels:18,layout:1}){l();try{var i=e||'<xml xmlns="http://www.w3.org/1999/xhtml"></xml>',n=o.utils.xml.textToDom(i);return(0,r.domToWorkspaceNoEvents)(n,s,{applyHideMetaComment:!0}),u(t)}catch(e){pxt.reportException(e)}finally{c()}},i.blocksMetrics=function(e){if(!(e=e.getTopBlocks(!1)).length)return{width:0,height:0};let t=void 0;return e.forEach(e=>{e=e.getBoundingRectangle();t?(t.l=Math.min(t.l,e.left),t.r=Math.max(t.r,e.right),t.t=Math.min(t.t,e.top),t.b=Math.min(t.b,e.bottom)):t={l:e.left,r:e.right,t:e.top,b:e.bottom}}),{width:t.r-t.l,height:t.b-t.t}}},{"./importer":73,"./layout":75,blockly:219}],138:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.findBlockIdByLine=i.findBlockIdByPosition=void 0,i.findBlockIdByPosition=function(n,o){if(o){let t,i;for(let e=0;e<n.length;++e){var r=n[e];r.startPos<=o.start&&r.endPos>=o.start+o.length&&(!t||i>r.endPos-r.startPos)&&(t=r,i=r.endPos-r.startPos)}return t?t.id:void 0}},i.findBlockIdByLine=function(n,o){if(o){let t,i;for(let e=0;e<n.length;++e){var r=n[e];r.startLine<=o.start&&r.endLine>o.start+o.length&&(!t||i>r.endLine-r.startLine)&&(t=r,i=r.endLine-r.startLine)}return t?t.id:void 0}}},{}],139:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.createFunctionsFlyoutCategory=i.mkReturnStatementBlock=i.mkVariableFieldBlock=i.mkFieldBlock=i.mkPredicateBlock=i.createToolboxBlock=i.createFlyoutGap=i.createFlyoutButton=i.createFlyoutGroupLabel=i.createFlyoutHeadingLabel=i.createShadowValue=i.isArrayType=void 0;let r=e("blockly"),g=e("./plugins/functions"),f=e("./loader"),m=/^(string|number|boolean)$/,b={string:{field:"TEXT",block:"text",defaultValue:""},number:{field:"NUM",block:"math_number",defaultValue:"0"},boolean:{field:"BOOL",block:"logic_boolean",defaultValue:"false"},Array:{field:"VAR",block:"variables_get",defaultValue:"list"}};function _(e){e=/^(?:Array<(.+)>)|(?:(.+)\[\])|(?:\[.+\])$/.exec(e);if(e)return e[1]||e[2]}function y(e,i,n,o,t,r=0){o=o||i.defaultValue,!(n=n||i.shadowBlockId)&&i.range&&(n="math_number_minmax");let s;if(s=o&&'"'==o.slice(0,1)?JSON.parse(o):o,"number"==i.type&&"value"==n)return(a=document.createElement("field")).setAttribute("name",i.definitionName),a.appendChild(document.createTextNode("0")),a;if(i.fieldEditor)return i.defaultValue?((a=document.createElement("field")).setAttribute("name",i.definitionName),a.appendChild(document.createTextNode(i.defaultValue)),a):void 0;var a=pxt.Util.lookup(e.apis.byQName,i.type),l=6==(null==a?void 0:a.kind),a=a&&!!a.attributes.fixedInstances&&!i.shadowBlockId,c="@combined@"==i.type;if(!n&&(l||a||c))return o?((l=document.createElement("field")).setAttribute("name",i.definitionName),l.appendChild(document.createTextNode(o)),l):void 0;a="variables_get"==n,c="text"==n,o=document.createElement("value"),o.setAttribute("name",i.definitionName),l="lists_create_with"!==n&&n?void 0:_(i.type);let u=document.createElement(!a&&!l||t?"shadow":"block");o.appendChild(u);var d=b[l||i.type];if(u.setAttribute("type",n||(l?"lists_create_with":d&&d.block||i.type)),u.setAttribute("colour","#fff"),l){if(d&&!n){let e;switch(l){case"number":e=["0","1"];break;case"string":e=["a","b","c"];break;case"boolean":e=["FALSE","FALSE","FALSE"]}return v(u,d.block,d.field,e),o}if(n&&s)return v(u,s),o}if(!d||n&&d.block!==n&&"math_number_minmax"!==n)s&&((t=document.createElement("field")).textContent=s,a?(t.setAttribute("name","VAR"),u.appendChild(t)):c?(t.setAttribute("name","TEXT"),u.appendChild(t)):n?(l=e.blocksById[n])&&l.attributes._def&&l.attributes._def.parameters.length&&(a=l.attributes._def.parameters[0],t.setAttribute("name",a.name),u.appendChild(t)):(t.setAttribute("name",i.definitionName),u.appendChild(t)));else{c=document.createElement("field");u.appendChild(c);let e;switch(n){case"variables_get":e="VAR";break;case"math_number_minmax":e="SLIDER";break;default:e=d.field}c.setAttribute("name",e);let t;t="boolean"==i.type?document.createTextNode((s||d.defaultValue).toUpperCase()):document.createTextNode(s||d.defaultValue),c.appendChild(t)}let h;if(i.range&&((h=document.createElement("mutation")).setAttribute("min",i.range.min.toString()),h.setAttribute("max",i.range.max.toString()),h.setAttribute("label",i.actualName.charAt(0).toUpperCase()+i.actualName.slice(1)),i.fieldOptions)&&(i.fieldOptions.step&&h.setAttribute("step",i.fieldOptions.step),i.fieldOptions.color&&h.setAttribute("color",i.fieldOptions.color),i.fieldOptions.precision)&&h.setAttribute("precision",i.fieldOptions.precision),i.fieldOptions&&(h=h||document.createElement("mutation")).setAttribute("customfield",JSON.stringify(i.fieldOptions)),h&&u.appendChild(h),r)for(let t of pxt.Util.toArray(o.getElementsByTagName("shadow")))if(!t.innerHTML){var p=e.blocks.find(e=>e.attributes.blockId===t.getAttribute("type"));if(p)for(var g=T(e,p,pxt.blocks.compileInfo(p),!0,r-1);g.firstChild;)t.appendChild(g.firstChild.cloneNode(!0)),g.firstChild.remove()}return o}function v(t,i,n,o){var r=o?o.length:2,e=document.createElement("mutation");e.setAttribute("items",""+r),e.setAttribute("horizontalafter",""+r),t.appendChild(e);for(let e=0;e<r;e++){var s,a=document.createElement("value"),l=(a.setAttribute("name","ADD"+e),document.createElement("shadow"));l.setAttribute("type",i),n&&((s=document.createElement("field")).setAttribute("name",n),o&&s.appendChild(document.createTextNode(o[e])),l.appendChild(s)),a.appendChild(l),t.appendChild(a)}}function a(e,t,i,n){e=o(e,pxt.toolbox.convertColor(t),i,n);return e.setAttribute("web-class","blocklyFlyoutHeading"),e}function l(e,t,i,n){e=o(e,void 0,t);return e.setAttribute("web-class","blocklyFlyoutGroup"),e.setAttribute("web-line","1.5"),i&&e.setAttribute("web-line-width",i),n&&(e.setAttribute("web-help-button","true"),e.setAttribute("callbackKey",n)),e}function o(e,t,i,n){var o=r.utils.xml.createElement("label");return o.setAttribute("text",e),t&&o.setAttribute("web-icon-color",pxt.toolbox.convertColor(t)),i&&(1===i.length?(o.setAttribute("web-icon",i),n&&o.setAttribute("web-icon-class",n)):o.setAttribute("web-icon-class","blocklyFlyoutIcon"+e)),o}function T(i,s,n,o=!1,r=0){let a,e,t,l;if(s.attributes.toolboxParent){var c=i.blocksById[s.attributes.toolboxParent];if(c){var u=pxt.blocks.compileInfo(c);if(t=T(i,c,u,o),s.attributes.toolboxParentArgument)!(l=t.querySelector(`value[name=${s.attributes.toolboxParentArgument}]`))&&u.parameters.some(e=>e.definitionName===s.attributes.toolboxParentArgument)&&((l=document.createElement("value")).setAttribute("name",s.attributes.toolboxParentArgument),t.appendChild(l));else if(!(l=t.querySelector("value")))for(var d of u.parameters)if(!t.querySelector(`field[name=${d.definitionName}]`)){(l=document.createElement("value")).setAttribute("name",d.definitionName),t.appendChild(l);break}if(l)for(;l.firstChild;)l.removeChild(l.firstChild);else t=void 0}}let h=document.createElement(t||o?"shadow":"block");if(h.setAttribute("type",s.attributes.blockId),s.attributes.blockGap?h.setAttribute("gap",s.attributes.blockGap):pxt.appTarget.appTheme&&pxt.appTarget.appTheme.defaultBlockGap&&h.setAttribute("gap",pxt.appTarget.appTheme.defaultBlockGap.toString()),n.thisParameter){c=n.thisParameter,u=!(null==(a=i.apis.byQName[c.type])||!a.attributes.fixedInstances);let e=c.shadowBlockId,t=c.defaultValue;u||e&&"variables_get"!==e||(e="variables_get",t=t||c.definitionName);u=y(i,c,e,t,o,r);u&&h.appendChild(u)}if("ENUM_GET"===s.attributes.shim||"KIND_GET"===s.attributes.shim?null!=(e=s.parameters)&&e.length&&(c=s.parameters[0].default)&&((u=document.createElement("field")).setAttribute("name","MEMBER"),u.textContent=c,h.appendChild(u)):s.parameters&&(n.parameters.filter(e=>m.test(e.type)||m.test(_(e.type))||e.shadowBlockId||e.defaultValue).forEach(e=>{e=y(i,e,void 0,void 0,o,r);e&&h.appendChild(e)}),s.attributes.draggableParameters?n.handlerArgs.forEach(e=>{var t="reporter"===s.attributes.draggableParameters,i=document.createElement("value"),n=(i.setAttribute("name",f.DRAGGABLE_PARAM_INPUT_PREFIX+e.name),t?pxt.blocks.reporterTypeForArgType(e.type):"variables_get_reporter"),o=document.createElement("block"),r=(o.setAttribute("type",n),document.createElement("mutation")),n=(o.appendChild(r),t&&"argument_reporter_custom"===n&&r.setAttribute("typename",e.type),r.setAttribute(g.LOCALIZATION_NAME_MUTATION_KEY,e.localizationKey),document.createElement("field"));n.setAttribute("name",t?"VALUE":"VAR"),n.textContent=pxt.Util.htmlEscape(e.name),o.appendChild(n),i.appendChild(o),h.appendChild(i)}):n.handlerArgs.forEach(e=>{var t=document.createElement("field");t.setAttribute("name","HANDLER_"+e.name),t.textContent=e.name,h.appendChild(t)})),s.attributes.expandArgumentsInToolbox){let e;for(var p of h.children)if("mutation"===p.tagName){e=p;break}e||(e=document.createElement("mutation"),h.appendChild(e)),e.setAttribute("_expanded",""+s.attributes._expandedDef.parameters.length)}return t?(l.appendChild(h),t):h}function n(e,t,i,n){n=document.createElement(n?"shadow":"block"),n.setAttribute("type",pxt.Util.htmlEscape(e)),e=document.createElement("field");return e.setAttribute("name",pxt.Util.htmlEscape(t)),e.textContent=pxt.Util.htmlEscape(i),n.appendChild(e),n}function c(){var e=document.createElement("block"),t=(e.setAttribute("type","function_return"),document.createElement("value")),i=(t.setAttribute("name","RETURN_VALUE"),e.appendChild(t),n("math_number","NUM","0",!0));return t.appendChild(i),e}i.isArrayType=_,i.createShadowValue=y,i.createFlyoutHeadingLabel=a,i.createFlyoutGroupLabel=l,i.createFlyoutButton=function(e,t){var i=r.utils.xml.createElement("button");return i.setAttribute("text",t),i.setAttribute("callbackKey",e),i},i.createFlyoutGap=function(e){var t=r.utils.xml.createElement("sep");return t.setAttribute("gap",e+""),t},i.createToolboxBlock=T,i.mkPredicateBlock=function(e){var t=document.createElement("block");t.setAttribute("type",e);(e=document.createElement("value")).setAttribute("name","PREDICATE"),t.appendChild(e);var i=n("logic_boolean","BOOL","TRUE",!0);return e.appendChild(i),t},i.mkFieldBlock=n,i.mkVariableFieldBlock=function(e,t,i,n,o){return(o=document.createElement(o?"shadow":"block")).setAttribute("type",pxt.Util.htmlEscape(e)),(e=document.createElement("field")).setAttribute("name","VAR"),e.id=t,e.setAttribute("variabletype",pxt.Util.htmlEscape(i)),e.textContent=pxt.Util.htmlEscape(n),o.appendChild(e),o},i.mkReturnStatementBlock=c,i.createFunctionsFlyoutCategory=function(e){var i,t=(0,g.flyoutCategory)(e),n=(1<t.length&&(o=c(),t.splice(1,0,l(lf("Your Functions"))),t.splice(1,0,o)),(0,g.getAllFunctionDefinitionBlocks)(e).filter(e=>e.getDescendants(!1).some(e=>"function_return"===e.type&&e.getInputTargetBlock("RETURN_VALUE"))).map(e=>e.getField("function_name").getText())),o=a(lf("Functions"),pxt.toolbox.getNamespaceColor("functions"),pxt.toolbox.getNamespaceIcon("functions"),"blocklyFlyoutIconfunctions"),r=(t.unshift(o),[]);for(i of t)if(r.push(i),"function_call"===i.getAttribute("type")){var s=i.children.item(0);if(s){let t=s.getAttribute("name");n.some(e=>e===t)&&((s=i.cloneNode(!0)).setAttribute("type","function_call_output"),r.push(s))}}return r}},{"./loader":77,"./plugins/functions":111,blockly:219}],140:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.PxtWorkspaceSearch=void 0;let n=e("blockly");e=e("@blockly/plugin-workspace-search");class o extends e.WorkspaceSearch{constructor(e){super(e),this.injectionDiv=e.getInjectionDiv()}highlightSearchGroup(e){e.forEach(e=>{e=e.pathObject.svgPath;n.utils.dom.addClass(e,"blockly-ws-search-highlight-pxt")})}unhighlightSearchGroup(e){e.forEach(e=>{e=e.pathObject.svgPath;n.utils.dom.removeClass(e,"blockly-ws-search-highlight-pxt")})}open(){super.open(),n.utils.dom.addClass(this.injectionDiv,"blockly-ws-searching")}close(){super.close(),n.utils.dom.removeClass(this.injectionDiv,"blockly-ws-searching")}}i.PxtWorkspaceSearch=o,n.Css.register(`
.blockly-ws-search {
    background: var(--pxt-neutral-background1);
    color: var(--pxt-neutral-foreground1);
    border: solid var(--pxt-neutral-alpha50) 1px;
    border-top: none;
    border-right: none;
    box-shadow: 0px 2px 15px var(--pxt-neutral-alpha50);
}

.blockly-ws-search input {
    -webkit-tap-highlight-color: transparent;
    background: var(--pxt-neutral-background1);
    color: var(--pxt-neutral-foreground1);
    border: none;
}

.blockly-ws-search input::-webkit-input-placeholder {
    color: var(--pxt-neutral-alpha50);
}

.blockly-ws-search input::-moz-placeholder {
    color: var(--pxt-neutral-alpha50);
}

.blockly-ws-search input::-ms-input-placeholder {
    color: var(--pxt-neutral-alpha50);
}

.blockly-ws-search input:active,
.blockly-ws-search input:focus {
    border-color: var(--pxt-neutral-alpha50);
    background: var(--pxt-neutral-background1);
    color: var(--pxt-neutral-foreground1);
}

.blockly-ws-search input::selection {
    color: var(--pxt-neutral-foreground1);
}

.blockly-ws-search button {
    padding-left: 6px;
    padding-right: 6px;
    color: var(--pxt-neutral-foreground1);
}`)},{"@blockly/plugin-workspace-search":214,blockly:219}],141:[function(e,t,i){function o(e,t,i,n){return pxt.Util.toArray(e.getElementsByTagName(t)).filter(e=>e.getAttribute(i)===n)}Object.defineProperty(i,"__esModule",{value:!0}),i.cleanOuterHTML=i.getDirectChildren=i.getFirstChildWithAttr=i.getChildrenWithAttr=i.getBlocksWithType=void 0,i.getBlocksWithType=function(e,t){return o(e,"block","type",t).concat(o(e,"shadow","type",t))},i.getChildrenWithAttr=o,i.getFirstChildWithAttr=function(e,t,i,n){return(e=o(e,t,i,n)).length?e[0]:void 0},i.getDirectChildren=function(t,i){var n=[];for(let e=0;e<t.childNodes.length;e++){var o=t.childNodes.item(e);o.tagName===i&&n.push(o)}return n},i.cleanOuterHTML=function(e){return e.outerHTML.replace(/^<\?[^>]*>/,"")}},{}],142:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.IFrameEmbeddedClient=void 0;class n{constructor(e){this.messageHandler=e,this.onMessageReceived=e=>{var t=e.data;if(t){if("iframeclientsetmessageport"===t.type)return this.port=e.ports[0],this.port.onmessage=this.onMessageReceived,void this.postMessage({type:"iframeclientsetmessageport"});if("iframeclientready"===t.type)return void this.sendReadyMessage()}this.messageHandler(e)},this.frameId=(()=>{var e=/frameid=([a-zA-Z0-9\-]+)/i.exec(window.location.href);if(e)return e[1]})(),window.addEventListener("message",this.onMessageReceived),this.sendReadyMessage()}dispose(){window.removeEventListener("message",this.onMessageReceived),this.port&&this.port.close()}postMessage(e){this.postMessageCore(e)}postMessageCore(e){this.frameId&&(e.frameId=this.frameId),this.port?this.port.postMessage(e):window.acquireVsCodeApi?window.acquireVsCodeApi().postMessage(e):window.parent&&window.parent!==window&&window.parent.postMessage(e,"*")}sendReadyMessage(){this.postMessage({type:"iframeclientready"})}}i.IFrameEmbeddedClient=n},{}],143:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.inflateButtonProps=i.ButtonBody=i.Button=void 0;let r=e("react/jsx-runtime"),w=e("../util");i.Button=e=>{var t=n(e);return(0,r.jsx)("button",Object.assign({},t,{children:(0,r.jsx)(i.ButtonBody,Object.assign({},e))}))};function n(e){let{id:t,className:i,style:n,ariaLabel:o,ariaHidden:r,ariaDescribedBy:s,ariaControls:a,ariaExpanded:l,ariaHasPopup:c,ariaPosInSet:u,ariaSetSize:d,ariaSelected:h,ariaPressed:p,role:g,onClick:f,onRightClick:m,onKeydown:b,onBlur:_,onFocus:y,buttonRef:v,title:T,hardDisabled:E,href:k,target:C,tabIndex:I}=e;e=e.disabled,e=e||E;return{id:t,className:(0,w.classList)("common-button",i,e&&"disabled"),style:n,title:T,ref:v,onClick:e?void 0:e=>{f&&f(),k&&window.open(k,C||"_blank","noopener,noreferrer"),e.stopPropagation(),e.preventDefault()},onContextMenu:e=>{m&&(m(),e.stopPropagation(),e.preventDefault())},onKeyDown:b||w.fireClickOnEnter,onBlur:_,onFocus:y,role:g||"button",tabIndex:I||(e?-1:0),disabled:E,"aria-label":o,"aria-hidden":r,"aria-controls":a,"aria-expanded":l,"aria-haspopup":c,"aria-posinset":u,"aria-setsize":d,"aria-describedby":s,"aria-selected":h,"aria-pressed":p}}i.ButtonBody=e=>{var{label:e,labelClassName:t,leftIcon:i,rightIcon:n,children:o}=e;return(0,r.jsxs)(r.Fragment,{children:[(i||n||e)&&(0,r.jsxs)("span",Object.assign({className:"common-button-flex"},{children:[i&&(0,r.jsx)("i",{className:i,"aria-hidden":!0}),(0,r.jsx)("span",Object.assign({className:(0,w.classList)("common-button-label",t)},{children:e})),n&&(0,r.jsx)("i",{className:"right "+n,"aria-hidden":!0})]})),o]})},i.inflateButtonProps=n},{"../util":154,"react/jsx-runtime":269}],144:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.CarouselNav=void 0;let l=e("react/jsx-runtime"),c=e("../util"),u=e("./Button");i.CarouselNav=e=>{let{pages:t,selected:i,maxDisplayed:n,onPageSelected:o}=e;var r=[];let s=0,a=t;n&&(s=Math.min(Math.max(0,i-(n>>1)),Math.max(0,s+t-n)),a=Math.min(s+n,t));for(let e=s;e<a;e++)r.push(e);return(0,l.jsxs)("div",Object.assign({className:"common-carousel-nav"},{children:[(0,l.jsx)(u.Button,{className:"common-carousel-nav-arrow",title:lf("Previous page"),leftIcon:"fas fa-chevron-circle-left",onClick:()=>o(i-1),disabled:0===i}),(0,l.jsx)("ul",Object.assign({className:"common-carousel-nav"},{children:r.map(e=>(0,l.jsx)("li",Object.assign({onClick:()=>o(e)},{children:(0,l.jsx)(u.Button,{className:(0,c.classList)(i===e&&"selected"),title:lf("Jump to page {0}",e+1),onClick:()=>o(e),label:(0,l.jsx)("span",{className:"common-carousel-nav-button-handle"})})}),e))})),(0,l.jsx)(u.Button,{className:"common-carousel-nav-arrow",title:lf("Next page"),leftIcon:"fas fa-chevron-circle-right",onClick:()=>o(i+1),disabled:i===t-1})]}))}},{"../util":154,"./Button":143,"react/jsx-runtime":269}],145:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.CheckboxIcon=i.Checkbox=void 0;let d=e("react/jsx-runtime"),h=e("../util");i.Checkbox=e=>{let{id:t,className:i,ariaHidden:n,ariaLabel:o,role:r,isChecked:s,onChange:a,label:l,style:c,tabIndex:u}=e;return(0,d.jsxs)("div",Object.assign({className:(0,h.classList)("common-checkbox",i,"toggle"===c&&"toggle")},{children:[(0,d.jsx)("input",{id:t,tabIndex:null!=u?u:0,type:"checkbox",checked:s,onChange:()=>{a(!s)},onKeyDown:h.fireClickOnEnter,role:r,"aria-hidden":n,"aria-label":o}),l&&(0,d.jsx)("label",Object.assign({htmlFor:t},{children:l}))]}))};i.CheckboxIcon=e=>{e=e.isChecked;return(0,d.jsx)("span",Object.assign({className:(0,h.classList)("common-checkbox-icon",e&&"checked")},{children:e&&(0,d.jsx)("i",{className:"fas fa-check"})}))}},{"../util":154,"react/jsx-runtime":269}],146:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Dropdown=void 0;let m=e("react/jsx-runtime"),b=e("react"),_=e("../util"),y=e("./Button"),v=e("./FocusList");i.Dropdown=e=>{let{id:t,className:i,ariaHidden:n,ariaLabel:o,role:r,items:s,tabIndex:a,selectedId:l,onItemSelected:c}=e,[u,d]=b.useState(!1),h=b.useRef(),p=b.useRef(),g=b.useRef({});b.useEffect(()=>{u&&Object.keys(g.current).length&&g.current[null!=l?l:0].focus()},[u]);e=(0,_.classList)("common-dropdown",i);let f=s.find(e=>e.id===l)||s[0];return(0,m.jsxs)("div",Object.assign({className:e,ref:h,onBlur:e=>{h.current&&u&&!h.current.contains(e.relatedTarget)&&d(!1)}},{children:[(0,m.jsx)(y.Button,Object.assign({},f,{id:t,buttonRef:e=>p.current=e,tabIndex:a,rightIcon:u?"fas fa-chevron-up":"fas fa-chevron-down",role:r,className:(0,_.classList)("common-dropdown-button",u&&"expanded",f.className),onClick:()=>{d(!u)},onKeydown:e=>{var t=s.indexOf(f);"ArrowDown"===e.key?(u?t<s.length-1&&c(s[t+1].id):d(!0),e.preventDefault(),e.stopPropagation()):"ArrowUp"===e.key?0<t&&(c(s[t-1].id),e.preventDefault(),e.stopPropagation()):"Enter"===e.key&&(d(!0),e.preventDefault(),e.stopPropagation())},ariaHasPopup:"listbox",ariaExpanded:u,ariaLabel:o,ariaHidden:n})),u&&(0,m.jsx)(v.FocusList,Object.assign({role:"listbox",className:"common-menu-dropdown-pane common-dropdown-shadow",childTabStopId:l,"aria-labelledby":t,useUpAndDownArrowKeys:!0,onItemReceivedFocus:t=>{t.id&&s.some(e=>e.id===t.id)&&c(t.id)}},{children:(0,m.jsx)("ul",Object.assign({role:"presentation"},{children:s.map(t=>(0,m.jsx)("li",Object.assign({role:"presentation"},{children:(0,m.jsx)(y.Button,Object.assign({},t,{buttonRef:e=>g.current[t.id]=e,className:(0,_.classList)("common-dropdown-item",t.className),onClick:()=>{var e;d(!1),c(t.id),null!=(e=p.current)&&e.focus()},ariaSelected:t.id===l,role:"option"}))}),t.id))}))}))]}))}},{"../util":154,"./Button":143,"./FocusList":148,react:268,"react/jsx-runtime":269}],147:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.EditorToggle=void 0;let d=e("react/jsx-runtime"),h=e("../util"),l=e("./Button"),c=e("./FocusList"),p=e("./MenuDropdown"),g=e("react");i.EditorToggle=e=>{let{id:t,className:i,ariaLabel:n,role:o,items:r,selected:s}=e;var[a,l]=(0,g.useState)(!1),c=r.some(e=>b(e));let u=e=>{};c=(0,h.classList)("common-editor-toggle",c&&"has-dropdown",a&&"focused",i);return(0,d.jsxs)("div",Object.assign({className:"common-editor-toggle-outer"},{children:[(0,d.jsx)(m,Object.assign({setIsFocused:l},e)),(0,d.jsxs)("div",Object.assign({id:t,className:c,role:o||"tablist","aria-hidden":!0,"aria-label":n},{children:[r.map((e,t)=>{var i=s===t;return(0,d.jsxs)("div",Object.assign({className:(0,h.classList)("common-editor-toggle-item",i&&"selected",b(e)&&"common-editor-toggle-item-dropdown")},{children:[(0,d.jsx)(f,{item:e,isSelected:i,onKeydown:u}),b(e)&&(0,d.jsx)(p.MenuDropdown,{id:"toggle-dropdown",className:"toggle-dropdown",icon:"fas fa-chevron-down",title:lf("More options"),tabIndex:-1,ariaHidden:!0,items:e.items.map(e=>({role:"menuitem",title:e.title,label:e.label,onClick:e.onClick,leftIcon:e.icon}))})]}),t)}),(0,d.jsx)("div",{className:"common-editor-toggle-handle","aria-hidden":!0})]}))]}))};let f=e=>{var{item:e,onKeydown:t}=e,{label:e,title:i,onClick:n,icon:o,focusable:r}=e;return(0,d.jsx)(l.Button,{className:o?void 0:"no-icon",role:r?"tab":void 0,tabIndex:-1,onKeydown:t,label:e,title:i,onClick:n,leftIcon:o,ariaHidden:!0})},m=e=>{let{items:t,id:i,selected:n,ariaHidden:o,setIsFocused:r}=e,s;e=t.reduce((e,t,i)=>{e=[...e];return e.push(Object.assign({},t)),n===i?(e[e.length-1].selected=!0,s=i):e[e.length-1].selected=!1,b(t)&&e.push(...t.items.filter(e=>e.focusable)),e},[]);let a=i+"-option-";return(0,d.jsx)(c.FocusList,Object.assign({id:i,role:"tablist",className:"common-toggle-accessibility",childTabStopId:a+s,focusSelectsItem:!0},{children:e.map((e,t)=>(0,d.jsx)(l.Button,{className:e.selected?"selected":void 0,id:a+t,role:"tab",title:e.title,label:e.label,onClick:e.onClick,onFocus:()=>r(!0),onBlur:()=>r(!1),ariaSelected:e.selected,ariaHidden:o},t))}))};function b(e){return!(null==(e=e.items)||!e.length)}},{"../util":154,"./Button":143,"./FocusList":148,"./MenuDropdown":153,react:268,"react/jsx-runtime":269}],148:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FocusList=void 0;let g=e("react/jsx-runtime"),f=e("../util");i.FocusList=e=>{let{id:t,className:i,role:n,ariaHidden:o,ariaLabel:r,childTabStopId:s,children:a,focusSelectsItem:l,onItemReceivedFocus:c,useUpAndDownArrowKeys:u}=e,d,h;let p=e=>"true"===e.getAttribute("data-isfocusable")&&null!==e.offsetParent;return(0,g.jsx)("div",Object.assign({id:t,className:i,role:n,tabIndex:s?void 0:0,onKeyDown:n=>{if(null!=d&&d.length){var o=document.activeElement,r=d.indexOf(o);let i=e=>{e.click?e.click():e.dispatchEvent(new Event("click"))};var s=e=>{e.focus(),c&&c(e),l&&i(e)};if(-1!==r||o===h){let e,t;t=u?(e="ArrowUp","ArrowDown"):pxt.Util.isUserLanguageRtl()?(e="ArrowRight","ArrowLeft"):(e="ArrowLeft","ArrowRight"),l||"Enter"!==n.key&&" "!==n.key?n.key===t?(r===d.length-1||o===h?s((0,f.findNextFocusableElement)(d,r,0,!0,p)):s((0,f.findNextFocusableElement)(d,r,r+1,!0,p)),n.preventDefault(),n.stopPropagation()):n.key===e?(0===r||o===h?s((0,f.findNextFocusableElement)(d,r,d.length-1,!1,p)):s((0,f.findNextFocusableElement)(d,r,r-1,!1,p)),n.preventDefault(),n.stopPropagation()):"Home"===n.key?(s((0,f.findNextFocusableElement)(d,r,0,!0,p)),n.preventDefault(),n.stopPropagation()):"End"===n.key&&(s((0,f.findNextFocusableElement)(d,r,d.length-1,!0,p)),n.preventDefault(),n.stopPropagation()):(n.preventDefault(),n.stopPropagation(),i(o))}}},ref:e=>{if(e&&!h){var t,e=(h=e).querySelectorAll('[tabindex]:not([tabindex="-1"]),[data-isfocusable]');d=[];for(t of e.values())d.push(t),t.setAttribute("tabindex","-1"),t.setAttribute("data-isfocusable","true");s&&(e=h.querySelector("#"+s))&&e.setAttribute("tabindex","0")}},"aria-hidden":o,"aria-label":r},{children:a}))}},{"../util":154,"react/jsx-runtime":269}],149:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FocusTrapRegion=i.FocusTrap=void 0;let u=e("react/jsx-runtime"),C=e("react"),I=e("../../util"),w=e("./context"),d=e("../../../hooks/useId");i.FocusTrap=e=>(0,u.jsx)(w.FocusTrapProvider,{children:(0,u.jsx)(n,Object.assign({},e))});let n=e=>{let{children:t,id:i,className:n,onEscape:o,arrowKeyNavigation:s,dontStealFocus:r,includeOutsideTabOrder:c,dontRestoreFocus:a,dontTrapFocus:l,focusFirstItem:u,tagName:d,role:h,ariaLabelledby:p,ariaLabel:g,ariaHidden:f}=e,m=C.useRef(null),b=C.useRef(document.activeElement),[_,y]=C.useState(!1),v=C.useRef(null),T=(0,w.useFocusTrapState)().regions,E=(C.useEffect(()=>()=>{!a&&b.current&&(0,I.focusLastActive)(b.current)},[]),C.useCallback(()=>{let e,t,i,n=(0,I.nodeListToArray)(c?null==(e=m.current)?void 0:e.querySelectorAll("[tabindex]"):null==(t=m.current)?void 0:t.querySelectorAll('[tabindex]:not([tabindex="-1"])'));if(T.length){let o={};for(var s of T){var a=null==(i=m.current)?void 0:i.querySelector(`[data-focus-trap-region="${s.id}"]`);a&&(o[s.id]=a)}for(var l of T){let t=o[l.id];!l.enabled&&t&&(n=n.filter(e=>!t.contains(e)))}let r=n.slice();n.sort((t,i)=>{var e=T.find(e=>e.enabled&&(null==(e=o[e.id])?void 0:e.contains(t))),n=T.find(e=>e.enabled&&(null==(e=o[e.id])?void 0:e.contains(i)));return(null==e?void 0:e.order)===(null==n?void 0:n.order)?r.indexOf(t)-r.indexOf(i):e?n?e.order-n.order:-1:1})}return n},[T,c]));var e=C.useCallback(e=>{var t;e&&(m.current=e,t=E(),r||_||e.contains(document.activeElement)||!t.length||(m.current.focus(),u&&(0,I.findNextFocusableElement)(t,-1,0,!0).focus(),y(!0)))},[E,r,_,u]),k=C.useCallback(r=>{if(m.current){var e=(i,n)=>{var o=E();if(o.length){let e=o.indexOf(r.target);e<0&&(e=o.indexOf(v.current));let t;t=i?n?(0,I.findNextFocusableElement)(o,e,o.length-1,i):e===o.length-1?(0,I.findNextFocusableElement)(o,e,0,i):(0,I.findNextFocusableElement)(o,e,e+1,i):n?(0,I.findNextFocusableElement)(o,e,0,i):0===e?(0,I.findNextFocusableElement)(o,e,o.length-1,i):(0,I.findNextFocusableElement)(o,e,Math.max(e-1,0),i),(v.current=t).focus(),r.preventDefault(),r.stopPropagation()}};if("Escape"===r.key){let e=!1;if(T.length)for(var t of T)if(t.onEscape){var i=null==(i=m.current)?void 0:i.querySelector(`[data-focus-trap-region="${t.id}"]`);if(null!=i&&i.contains(document.activeElement)){e=!0,t.onEscape();break}}e||o(),r.preventDefault(),r.stopPropagation()}else"Tab"===r.key?l?o():r.shiftKey?e(!1,!1):e(!0,!1):s&&("ArrowDown"===r.key?e(!0,!1):"ArrowUp"===r.key?e(!1,!1):"Home"===r.key?e(!1,!0):"End"===r.key&&e(!0,!0))}},[E,o,s,T,l]);return C.createElement(d||"div",{id:i,className:(0,I.classList)("common-focus-trap",n),ref:e,onKeyDown:k,role:h,tabIndex:-1,"aria-labelledby":p,"aria-label":g,"aria-hidden":f},t)};i.FocusTrapRegion=e=>{let{className:t,id:i,onEscape:n,order:o,enabled:r,children:s,divRef:a}=e,l=(0,d.useId)(),c=(0,w.useFocusTrapDispatch)();return C.useEffect(()=>(c((0,w.addRegion)(l,o,r,n)),()=>c((0,w.removeRegion)(l))),[l,r,o]),(0,u.jsx)("div",Object.assign({id:i,className:t,"data-focus-trap-region":l,tabIndex:-1,ref:a},{children:s}))}},{"../../../hooks/useId":155,"../../util":154,"./context":150,react:268,"react/jsx-runtime":269}],150:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.useFocusTrapDispatch=i.useFocusTrapState=i.removeRegion=i.addRegion=i.FocusTrapProvider=void 0;let n=e("react/jsx-runtime"),o=e("react"),r=o.createContext(null),s=o.createContext(null);i.FocusTrapProvider=({children:e})=>{var[t,i]=o.useReducer(a,{regions:[]});return(0,n.jsx)(r.Provider,Object.assign({value:t},{children:(0,n.jsx)(s.Provider,Object.assign({value:i},{children:e}))}))},i.addRegion=(e,t,i,n)=>({type:"ADD_REGION",id:e,order:t,enabled:i,onEscape:n});function a(e,t){var i=e.regions.slice();switch(t.type){case"ADD_REGION":var n={id:t.id,enabled:t.enabled,order:t.order,onEscape:t.onEscape},o=i.findIndex(e=>e.id===t.id);-1!==o?i.splice(o,1,n):i.push(n);break;case"REMOVE_REGION":o=e.regions.findIndex(e=>e.id===t.id);-1!==o&&i.splice(o,1)}return{regions:i}}i.removeRegion=e=>({type:"REMOVE_REGION",id:e}),i.useFocusTrapState=function(){return o.useContext(r)},i.useFocusTrapDispatch=function(){return o.useContext(s)}},{react:268,"react/jsx-runtime":269}],151:[function(e,t,i){var n=this&&this.__createBinding||(Object.create?function(e,t,i,n){void 0===n&&(n=i);var o=Object.getOwnPropertyDescriptor(t,i);o&&("get"in o?t.__esModule:!o.writable&&!o.configurable)||(o={enumerable:!0,get:function(){return t[i]}}),Object.defineProperty(e,n,o)}:function(e,t,i,n){e[n=void 0===n?i:n]=t[i]}),o=this&&this.__exportStar||function(e,t){for(var i in e)"default"===i||Object.prototype.hasOwnProperty.call(t,i)||n(t,e,i)};Object.defineProperty(i,"__esModule",{value:!0}),o(e("./FocusTrap"),i)},{"./FocusTrap":149}],152:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Input=void 0;let P=e("react/jsx-runtime"),B=e("react"),F=e("../util"),U=e("./Button"),H=e("./FocusList");i.Input=i=>{let e,{id:n,className:t,inputClassName:o,groupClassName:r,role:s,ariaHidden:a,ariaLabel:l,initialValue:c,label:u,title:d,placeholder:h,icon:p,iconTitle:g,disabled:f,type:m,readOnly:b,autoComplete:_,selectOnClick:y,onChange:v,onEnterKey:T,onIconClick:E,onFocus:k,onBlur:C,onOptionSelected:I,handleInputRef:w,preserveValueOnBlur:$=!0,options:S}=i,[x,R]=B.useState(c||""),[O,A]=B.useState(!1),[N]=B.useState(i.filter?new RegExp(i.filter):void 0),L;B.useEffect(()=>{R(c||"")},[c]);let D=()=>{S&&A(!O)};let M=e=>e&&-1!=Object.values(S).indexOf(e)?"dropdown-item-"+e:void 0;return(0,P.jsxs)("div",Object.assign({className:(0,F.classList)("common-input-wrapper",f&&"disabled",t),onBlur:e=>{O&&!L.contains(e.relatedTarget)&&A(!1)},ref:e=>{e&&(L=e)}},{children:[u&&(0,P.jsx)("label",Object.assign({className:"common-input-label",htmlFor:n},{children:u})),(0,P.jsxs)("div",Object.assign({className:(0,F.classList)("common-input-group",r)},{children:[(0,P.jsx)("input",{id:n,className:(0,F.classList)("common-input",p&&"has-icon",o),title:d,role:s||"textbox",tabIndex:f?-1:0,"aria-label":l,"aria-hidden":a,type:m||"text",placeholder:h,value:x,readOnly:!!b,onClick:e=>{y&&e.target.select(),S&&!O&&A(!0)},onChange:e=>{let t,i=e.target.value;i&&N&&(i=(null==(t=i.match(N))?void 0:t.join(""))||""),b||x===i||R(i),v&&v(i)},onKeyDown:e=>{var t="number"==typeof e.which?e.which:e.keyCode;13===t||i.treatSpaceAsEnter&&32===t?T&&(e.preventDefault(),T(x)):S&&"ArrowDown"===e.key?(O?null!=(t=document.getElementById(M(Object.values(S)[0])))&&t.focus():D(),e.preventDefault(),e.stopPropagation()):S&&O&&"ArrowUp"===e.key&&(t=Object.values(S),null!=(t=document.getElementById(M(t[t.length-1])))&&t.focus(),e.preventDefault(),e.stopPropagation())},onBlur:()=>{C&&C(x),$||R("")},onFocus:()=>{k&&k(x)},autoComplete:_?"":"off",autoCorrect:_?"":"off",autoCapitalize:_?"":"off",spellCheck:_,disabled:f,ref:w}),p&&(E?(0,P.jsx)(U.Button,{leftIcon:p,title:g,disabled:f,onClick:()=>{E&&E(x)}}):(0,P.jsx)("i",{className:p,"aria-hidden":!0})),S&&(0,P.jsx)(U.Button,{leftIcon:O?"fas fa-chevron-up":"fas fa-chevron-down",title:g,disabled:f,ariaHasPopup:"listbox",ariaExpanded:O,ariaLabel:l,tabIndex:-1,onClick:D})]})),O&&(0,P.jsx)(H.FocusList,Object.assign({role:"listbox",className:"common-menu-dropdown-pane common-dropdown-shadow",childTabStopId:null!=(e=M(x))?e:M(Object.values(S)[0]),"aria-labelledby":n,useUpAndDownArrowKeys:!0},{children:(0,P.jsx)("ul",Object.assign({role:"presentation",onKeyDown:e=>{var t;"Escape"===e.code&&(e.target.blur(),D(),null!=(t=document.getElementById(n))&&t.focus(),e.stopPropagation(),e.preventDefault())}},{children:Object.keys(S).map(t=>(0,P.jsx)("li",Object.assign({role:"presentation"},{children:(0,P.jsx)(U.Button,{title:t,label:t,id:M(S[t]),className:(0,F.classList)("common-dropdown-item"),onClick:()=>{return e=t,A(!1),e=S[e],R(e),I&&I(e),void(null!=(e=document.getElementById(n))&&e.focus());var e},ariaSelected:M(S[t])===M(null!=x?x:c),role:"option"})}),t))}))}))]}))}},{"../util":154,"./Button":143,"./FocusList":148,react:268,"react/jsx-runtime":269}],153:[function(e,t,b){Object.defineProperty(b,"__esModule",{value:!0}),b.MenuLinkItemImpl=b.MenuCheckboxItemImpl=b.MenuDropdownItemImpl=b.MenuDropdown=void 0;let _=e("react"),y=e("react/jsx-runtime"),v=e("react"),T=e("../util"),E=e("./Button"),k=e("./FocusTrap"),c=e("./Checkbox");b.MenuDropdown=e=>{var{id:e,className:t,ariaHidden:i,ariaLabel:n,role:o,items:r,label:s,title:a,icon:l,tabIndex:c,disabled:u}=e;let[d,h]=v.useState(!1),p,g;var t=(0,T.classList)("common-menu-dropdown",t),f=e+"-menu";let m=(e=>{let t=[],i={items:[]};for(var n of e)"separator"===n.role?(i.className=n.className,0<i.items.length&&(t.push(i),i={items:[]})):i.items.push(n);return 0<i.items.length&&t.push(i),t})(r);return(0,y.jsxs)("div",Object.assign({className:t,ref:e=>{e&&(p=e)},onBlur:e=>{p&&d&&!p.contains(e.relatedTarget)&&h(!1)}},{children:[(0,y.jsx)(E.Button,{id:e,label:s,tabIndex:c,buttonRef:e=>{e&&(g=e)},title:a,leftIcon:l,role:o||"menuitem",className:(0,T.classList)("menu-button",d&&"expanded"),onClick:()=>{h(!d)},ariaHasPopup:"true",ariaExpanded:d,ariaControls:d?f:void 0,ariaLabel:n,ariaHidden:i,disabled:u,onKeydown:e=>{"ArrowDown"!==e.key||d||h(!0)}}),d&&(0,y.jsx)(k.FocusTrap,Object.assign({role:"menu",className:"common-menu-dropdown-pane",id:f,arrowKeyNavigation:!0,onEscape:()=>{h(!1),g&&g.focus()},includeOutsideTabOrder:!0,dontTrapFocus:!0,dontRestoreFocus:!0,focusFirstItem:!0,ariaLabelledby:e,tagName:"ul"},{children:m.map((e,t)=>(0,y.jsxs)(v.Fragment,{children:[(0,y.jsx)("li",Object.assign({role:"none"},{children:(0,y.jsx)("ul",Object.assign({role:"group"},{children:e.items.map((i,e)=>{e=t+"-"+e;return"menuitem"===i.role?(0,_.createElement)(b.MenuDropdownItemImpl,Object.assign({},i,{key:e,onClick:()=>{var e;h(!1),null!=(e=i.onClick)&&e.call(i)}})):"link"===i.role?(0,_.createElement)(b.MenuLinkItemImpl,Object.assign({},i,{key:e,onClick:()=>{var e;h(!1),null!=(e=i.onClick)&&e.call(i)}})):(0,_.createElement)(b.MenuCheckboxItemImpl,Object.assign({},i,{key:e,onChange:e=>{var t;h(!1),null!=(t=i.onChange)&&t.call(i,e)}}))})}))})),t<m.length-1&&(0,y.jsx)("li",{role:"separator",className:(0,T.classList)("common-menu-dropdown-separator",e.className)})]},t))}))]}))},b.MenuDropdownItemImpl=e=>{var t=(0,E.inflateButtonProps)(e);return(0,y.jsx)("li",Object.assign({},t,{className:(0,T.classList)("common-menu-dropdown-item",t.className),role:"menuitem",tabIndex:-1},{children:(0,y.jsx)(E.ButtonBody,Object.assign({},e))}))},b.MenuCheckboxItemImpl=e=>{let{label:t,isChecked:i,onChange:n,id:o,className:r,ariaLabel:s,ariaHidden:a,ariaDescribedBy:l}=e;return(0,y.jsxs)("li",Object.assign({role:"menuitemcheckbox",tabIndex:-1,className:(0,T.classList)("common-menu-dropdown-item","common-menu-dropdown-checkbox-item",r),"aria-label":s,"aria-hidden":a,"aria-describedby":l,"aria-checked":i?"true":"false",onClick:()=>n(!i),onKeyDown:T.fireClickOnEnter,id:o},{children:[(0,y.jsx)(c.CheckboxIcon,{isChecked:i}),(0,y.jsx)("span",{children:t})]}))};b.MenuLinkItemImpl=e=>{var{href:e,label:t,id:i,className:n,ariaLabel:o,ariaHidden:r,ariaDescribedBy:s,onClick:a}=e;return(0,y.jsx)("a",Object.assign({role:"none",className:(0,T.classList)("common-menu-dropdown-item","common-menu-dropdown-link-item",n),"aria-label":o,"aria-hidden":r,"aria-describedby":s,id:i,tabIndex:-1,href:e,target:"_blank",rel:"noopener noreferrer",onClick:a,onKeyDown:T.fireClickOnEnter},{children:t}))}},{"../util":154,"./Button":143,"./Checkbox":145,"./FocusTrap":151,react:268,"react/jsx-runtime":269}],154:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.focusLastActive=i.isFocusable=i.findNextFocusableElement=i.screenToSVGCoord=i.clientCoord=i.CheckboxStatus=i.nodeListToArray=i.classList=i.fireClickOnEnter=i.jsxLF=void 0;let a=e("react/jsx-runtime");function n(e){return!!e&&("true"===e.getAttribute("data-isfocusable")||-1!==e.tabIndex)&&"none"!==getComputedStyle(e).display}i.jsxLF=function(e,...t){let i=[];e.replace(/\{\d\}/g,e=>(i.push(parseInt(e.substr(1,1))),e));var n,o,r=[];let s=0;for(o of i)n=e.split(`{${o}}`),pxt.U.assert(2===n.length),r.push((0,a.jsx)("span",{children:n[0]},s++)),r.push((0,a.jsx)("span",{children:t[o]},s++)),e=n[1];return r.push((0,a.jsx)("span",{children:e},s++)),r},i.fireClickOnEnter=function(e){var t="number"==typeof e.which?e.which:e.keyCode;13!==t&&32!==t||(e.preventDefault(),e.currentTarget.click())},i.classList=function(...e){return e.filter(e=>"string"==typeof e).reduce((e,t)=>e.concat(t.split(" ")),[]).map(e=>e.trim()).filter(e=>!!e).join(" ")},i.nodeListToArray=function(e){var t,i=[];for(t of e)i.push(t);return i},(e=i.CheckboxStatus||(i.CheckboxStatus={}))[e.Selected=0]="Selected",e[e.Unselected=1]="Unselected",e[e.Waiting=2]="Waiting",i.clientCoord=function(e){return e.touches?(e.touches.length?e.touches:e.changedTouches)[0]:e},i.screenToSVGCoord=function(e,t){var i=e.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i.matrixTransform(e.getScreenCTM().inverse())},i.findNextFocusableElement=function e(t,i,n,o,r){var s=o?1:-1,a=t[n];return i===n||(r||(e=>e.checkVisibility?e.checkVisibility({visibilityProperty:!0}):"none"!==(e=getComputedStyle(e)).display&&"hidden"!==e.visibility))(a)?a:(n+s>=t.length?n=0:n+s<0?n=t.length-1:n+=s,e(t,i,n,o,r))},i.isFocusable=n,i.focusLastActive=function(e){for(;e&&!n(e);){var t=e.parentElement;if(!t)break;e=t}e.focus()}},{"react/jsx-runtime":269}],155:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.useId=void 0;let n=e("react");i.useId=function(){return n.useMemo(()=>pxt.Util.guidGen(),[])}},{react:268}],156:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.AssetEditor=void 0;let n=e("react/jsx-runtime");var o=e("react");let r=e("react-dom"),s=e("./components/ImageFieldEditor"),a=e("./components/ImageEditor/store/imageReducer"),l=e("../../pxtservices/iframeEmbeddedClient");document.addEventListener("DOMContentLoaded",()=>{var e;e=document.getElementById("asset-editor-field-div"),r.render((0,n.jsx)(c,{}),e)});class c extends o.Component{constructor(e){super(e),this.handleMessage=e=>{var t=e.data;switch(t.type){case"create":this.setPalette(t.palette),this.initTilemapProject(t.files);var i=this.getEmptyAsset(t.assetType,t.displayName);this.setState({editing:i,isEmptyAsset:!0}),this.sendResponse({id:t.id,type:t.type});break;case"open":this.setPalette(t.palette),this.initTilemapProject(t.files);i=this.lookupAsset(t.assetType,t.assetId);"tilemap"===i.type&&pxt.sprite.addMissingTilemapTilesAndReferences(this.editorProject,i),this.setState({editing:i}),this.sendResponse({id:t.id,type:t.type});break;case"duplicate":this.setPalette(t.palette),this.initTilemapProject(t.files);i=this.lookupAsset(t.assetType,t.assetId);this.setState({editing:this.editorProject.duplicateAsset(i)}),this.sendResponse({id:t.id,type:t.type});break;case"save":this.sendResponse({id:t.id,type:t.type,files:this.saveProjectFiles()})}},this.refHandler=e=>{e&&(this.editor=e,this.editor.init(this.state.editing,()=>{},{galleryTiles:this.galleryTiles,hideMyAssets:!0,hideCloseButton:!0}))},this.handleKeydown=e=>{!e.ctrlKey||"s"!==e.key&&"S"!==e.key||this.sendSaveRequest()},this.pollForUpdates=()=>{this.state.editing&&this.updateAsset()},this.sendSaveRequest=()=>{this.sendEvent({type:"event",kind:"done-clicked"})},this.state={},pxt.react.getTilemapProject=()=>this.editorProject,(0,a.setTelemetryFunction)(u)}componentDidMount(){this.iframeClient=new l.IFrameEmbeddedClient(this.handleMessage),window.addEventListener("keydown",this.handleKeydown,null),this.sendEvent({type:"event",kind:"ready"}),u("asset-editor-shown"),this.pollingInterval=setInterval(this.pollForUpdates,200)}componentWillUnmount(){window.removeEventListener("message",this.handleMessage,null),window.removeEventListener("keydown",this.handleKeydown,null),window.clearInterval(this.pollingInterval)}componentDidUpdate(e,t,i){null!=t&&t.editing&&t.editing!==this.state.editing&&this.saveProject.removeChangeListener(t.editing.type,this.sendSaveRequest),null!=(t=this.state)&&t.editing&&this.saveProject.addChangeListener(this.state.editing,this.sendSaveRequest)}render(){return this.state.editing?(0,n.jsx)(s.ImageFieldEditor,{ref:this.refHandler,singleFrame:"animation"!==this.state.editing.type,isMusicEditor:"song"===this.state.editing.type,doneButtonCallback:this.sendSaveRequest,hideDoneButton:!0,includeSpecialTagsInFilter:!0}):(0,n.jsx)("div",{})}sendResponse(e){this.postMessage(e)}sendEvent(e){this.postMessage(e)}postMessage(e){this.iframeClient.postMessage(e)}updateAsset(){var e,t=this.editor.getValue(),i=pxt.cloneAsset(t);if(!this.lastValue||!pxt.assetEquals(this.lastValue,i)){if(this.lastValue=pxt.cloneAsset(t),"tilemap"===i.type&&t.type===i.type&&(i.data.deletedTiles=null==(e=t.data.deletedTiles)?void 0:e.slice(),i.data.editedTiles=null==(e=t.data.editedTiles)?void 0:e.slice(),i.data.projectReferences=null==(e=t.data.projectReferences)?void 0:e.slice(),i.data.tileOrder=null==(e=t.data.tileOrder)?void 0:e.slice()),this.saveProject=this.editorProject.clone(),this.state.isEmptyAsset){var n=null==(t=i.meta)?void 0:t.displayName;let e;switch(i.type){case"image":e=this.saveProject.createNewProjectImage(i.bitmap,n);break;case"tile":e=this.saveProject.createNewTile(i.bitmap,null,n);break;case"tilemap":pxt.sprite.updateTilemapReferencesFromResult(this.saveProject,i);var[o,,]=this.saveProject.createNewTilemapFromData(i.data,n);e=this.saveProject.lookupAssetByName("tilemap",o);break;case"animation":e=this.saveProject.createNewAnimationFromData(i.frames,i.interval,n);break;case"song":e=this.saveProject.createNewSong(i.song,n)}}else"tilemap"===i.type&&pxt.sprite.updateTilemapReferencesFromResult(this.saveProject,i),this.saveProject.updateAsset(i);this.sendSaveRequest()}}saveProjectFiles(){this.updateAsset();var e,t,i=pxt.inflateJRes(this.saveProject.getProjectAssetsJRes()),n=pxt.inflateJRes(this.saveProject.getProjectTilesetJRes()),o={};for(e of Object.keys(i)){var r=this.locateFileForAsset(e)||pxt.IMAGES_JRES;o[r]||(o[r]={}),o[r][e]=i[e]}for(t of Object.keys(n)){var s=this.locateFileForAsset(t)||pxt.TILEMAP_JRES;o[s]||(o[s]={}),o[s][t]=n[t]}var a,l=Object.assign({},this.files);for(a of Object.keys(o)){l[a]=JSON.stringify(o[a],null,4);var c=a.substring(0,a.length-"jres".length)+"ts";!l[c]&&a!==pxt.IMAGES_JRES&&a!==pxt.TILEMAP_JRES||(l[c]=pxt.emitProjectImages(o[a])+"\n"+pxt.emitTilemapsFromJRes(o[a]))}return l}setPalette(e){e&&Array.isArray(e)&&e.length&&(pxt.appTarget.runtime.palette=e.slice())}initTilemapProject(e){var t,i,n={},o={},r={},s={};this.editorProject=new pxt.TilemapProject,this.inflatedJres={},this.commentAttrs={};for(t of Object.keys(e).filter(e=>!e.endsWith(".jres"))){var a,l=(e=>{let t=e.split("\n"),i={},n,o="";for(var r of t){var s=/^namespace\s+([^\}]+)\s+\{$/.exec(r);s?(n=s[1],o=""):/^\s+\/\/%\s/.test(r)?o+=r+"\n":(s=/^\s*export\s+const\s+([^\s]+)\s*=/.exec(r))&&(r=n+"."+s[1],i[r]=pxtc.parseCommentString(o),o="")}return i})(e[t]);for(a of Object.keys(l))this.commentAttrs[a]=l[a]}for(i of Object.keys(e).filter(e=>e.endsWith(".jres"))){var c,u,d=-1!==i.indexOf("pxt_modules")||-1!==i.indexOf("node_modules"),h=pxt.inflateJRes(JSON.parse(e[i]));this.inflatedJres[i]=h;for(c of Object.keys(h))null!=(u=this.commentAttrs[c])&&u.tags&&(u=this.commentAttrs[c].tags.split(" ").filter(e=>!!e)).length&&(h[c].tags=u),h[c].mimeType===pxt.TILEMAP_MIME_TYPE||h[c].tilemapTile?d?o[c]=h[c]:n[c]=h[c]:d?s[c]=h[c]:r[c]=h[c]}this.editorProject.loadAssetsJRes(s,!0),this.editorProject.loadAssetsJRes(r),this.editorProject.loadTilemapJRes(o,!1,!0),this.editorProject.loadTilemapJRes(n),this.galleryTiles=this.editorProject.getGalleryAssets("tile").map(e=>{if(this.commentAttrs[e.id]){var t=null==(t=e.meta.tags)?void 0:t.map(e=>pxt.Util.startsWith(e,"category-")?e:e.toLowerCase());if(t&&-1!==t.indexOf("tile"))return{qName:e.id,bitmap:e.bitmap,alt:e.id,tags:t}}}).filter(e=>!!e),this.saveProject=this.editorProject.clone()}locateFileForAsset(e){for(var t of Object.keys(this.inflatedJres))if(this.inflatedJres[t][e])return t}getEmptyAsset(e,t){var i=pxt.react.getTilemapProject(),n=t||pxt.getDefaultAssetDisplayName(e);let o=n,r=0;for(;i.isNameTaken(e,o);)o=n+r++;var s={type:e,id:"",internalID:0,meta:{displayName:o}};switch(e){case"image":case"tile":s.bitmap=new pxt.sprite.Bitmap(16,16).data();break;case"tilemap":var a=s;a.data=i.blankTilemap(16,16,16),pxt.sprite.addMissingTilemapTilesAndReferences(i,a);break;case"animation":a=s;a.frames=[new pxt.sprite.Bitmap(16,16).data()],a.interval=200;break;case"song":s.song=pxt.assets.music.getEmptySong(2)}return s}lookupAsset(e,t){var i=this.saveProject.lookupAsset(e,t);return i||(i=t.split("."),this.saveProject.lookupAsset(e,i[i.length-1]))}}function u(e){pxt.tickEvent("asset.editor",{action:e})}i.AssetEditor=c},{"../../pxtservices/iframeEmbeddedClient":142,"./components/ImageEditor/store/imageReducer":174,"./components/ImageFieldEditor":180,react:268,"react-dom":232,"react/jsx-runtime":269}],157:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.getLabelForAssetType=i.getIconClassForAssetType=i.assetToGalleryItem=i.getAssets=i.getNewInternalID=i.lookupAsset=i.createTile=i.createProjectImage=i.createNewImageAsset=i.isNameTaken=void 0;let n=e("../../pxtblocks");function f(e,t=new pxt.ImageConverter){switch(e.type){case"image":case"tile":return e.previewURI=t.convert("data:image/x-mkcd-f,"+e.jresData),e;case"tilemap":var i=e.data.tilemap;return e.previewURI=n.tilemapToImageURI(e.data,Math.max(i.width,i.height),!1),e;case"animation":return(null==(i=e.frames)?void 0:i.length)<=0?null:(e.framePreviewURIs=e.frames.map(e=>t.convert("data:image/x-mkcd-f,"+pxt.sprite.base64EncodeBitmap(e))),e.previewURI=e.framePreviewURIs[0],e);case"song":return e.previewURI=n.songToDataURI(e.song,32,32,!1,1),e;case"json":return e}}function m(o){return function(e,t){var i=-1===o.indexOf(e.meta.package)?0:1,n=-1===o.indexOf(t.meta.package)?0:1;return i==n?e.internalID-t.internalID:i-n}}i.isNameTaken=function(e){return pxt.react.getTilemapProject().isNameTaken("image",e)},i.createNewImageAsset=function(e,t,i,n){var o=pxt.react.getTilemapProject();switch(e){case"tile":return o.createNewTile(new pxt.sprite.Bitmap(t,i).data(),null,n);case"image":return o.createNewImage(t,i)}return null},i.createProjectImage=function(e){return pxt.react.getTilemapProject().createNewProjectImage(e)},i.createTile=function(e,t,i){return pxt.react.getTilemapProject().createNewTile(e,t,i)},i.lookupAsset=function(e,t){return pxt.react.getTilemapProject().lookupAsset(e,t)},i.getNewInternalID=function(){return pxt.react.getTilemapProject().getNewInternalId()},i.getAssets=function(e=!1,t="image",i=[]){var n=pxt.react.getTilemapProject();let o=new pxt.ImageConverter;var r,s=e=>f(e,o),n=(e?n.getGalleryAssets:n.getAssets).bind(n),a=(()=>{var e=null==(e=pxt.appTarget.blocksprj)?void 0:e.config;return e?Object.keys(e.dependencies):[]})(),l=n("image").map(s).sort(m(a)),c=n("tile").map(s).filter(e=>!e.id.match(/^myTiles.transparency(8|16|32)$/gi)).sort(m(a)),u=n("tilemap").map(s).sort(m(a)),d=n("animation").map(s).sort(m(a)),h=n("song").map(s).sort(m(a)),p=n("json").map(s).sort(m(a));for(r of i)switch(r.type){case"image":l.push(s(r));break;case"tile":c.push(s(r));break;case"animation":d.push(s(r));break;case"tilemap":u.push(s(r));break;case"song":h.push(s(r));break;case"json":p.push(s(r))}let g=[];switch(t){case"image":g=l.concat(c).concat(d).concat(u).concat(h).concat(p);break;case"tile":g=c.concat(l).concat(d).concat(u).concat(h).concat(p);break;case"animation":g=d.concat(l).concat(c).concat(u).concat(h).concat(p);break;case"tilemap":g=u.concat(c).concat(l).concat(d).concat(h).concat(p);break;case"song":g=h.concat(l).concat(c).concat(d).concat(u).concat(p);break;case"json":g=p.concat(l).concat(c).concat(d).concat(u).concat(h)}return pxt.tickEvent(e?"assets.gallery":"assets.update",{count:g.length}),g},i.assetToGalleryItem=f,i.getIconClassForAssetType=function(e){if("object"==typeof(null==(t=pxt.appTarget.appTheme)?void 0:t.assetEditor)){var t=pxt.appTarget.appTheme.assetEditor[e];if("object"==typeof t&&t.iconClass)return t.iconClass}switch(e){case"tile":return"clone";case"animation":return"video";case"tilemap":return"map";case"song":return"music";case"json":return"file code";default:return null}},i.getLabelForAssetType=function(e){if("object"==typeof(null==(t=pxt.appTarget.appTheme)?void 0:t.assetEditor)){var t=pxt.appTarget.appTheme.assetEditor[e];if("object"==typeof t&&t.label)return pxt.U.rlf("{id:assetType}"+t.label)}switch(e){case"image":return lf("Image");case"tile":return lf("Tile");case"animation":return lf("Animation");case"tilemap":return lf("Tilemap");case"song":return lf("Song");case"json":return lf("File")}}},{"../../pxtblocks":74}],158:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FilterPanel=i.FilterPanelSubheading=i.FilterTag=void 0;let n=e("react/jsx-runtime");var o=e("react");let r=e("../util");class s extends o.Component{constructor(e){super(e),this.clickHandler=this.clickHandler.bind(this)}render(){return(0,n.jsxs)("div",Object.assign({className:"filter-tag"},{children:[(0,n.jsx)("div",Object.assign({className:"filter-tag-box",role:"checkbox",onClick:this.clickHandler,onKeyDown:r.fireClickOnEnter,"aria-checked":this.props.selected},{children:(0,n.jsx)("i",{className:"icon square outline "+(this.props.selected?"check":"")})})),(0,n.jsx)("div",Object.assign({className:"filter-tag-name",role:"button",onClick:this.clickHandler,onKeyDown:r.fireClickOnEnter},{children:pxtc.U.rlf(this.props.tag)}))]}))}clickHandler(){this.props.onClickHandler(this.props.tag)}}i.FilterTag=s;class a extends o.Component{render(){return(0,n.jsxs)("div",Object.assign({className:"filter-subheading-row"},{children:[(0,n.jsx)("div",Object.assign({className:"filter-subheading-title"},{children:this.props.subheading+":"})),this.props.buttonText&&(0,n.jsx)("div",Object.assign({className:"filter-subheading-button",role:"button",style:this.props.buttonStyle,onClick:this.props.buttonAction,onKeyDown:r.fireClickOnEnter},{children:this.props.buttonText}))]}))}}i.FilterPanelSubheading=a;class l extends o.Component{isTagSelected(e){return 0<=this.props.enabledTags.indexOf(e.toLowerCase())}render(){var e=this.props.tagOptions;return(0,n.jsxs)("div",Object.assign({className:"filter-panel"},{children:[(0,n.jsx)("div",Object.assign({className:"filter-title"},{children:lf("Filter")})),(0,n.jsx)(a,{subheading:lf("Categories"),buttonText:lf("Clear"),buttonAction:this.props.clearTags,buttonStyle:0<this.props.enabledTags.length?{color:"white"}:{}}),(0,n.jsx)("div",Object.assign({className:"filter-tag-list"},{children:e.map(e=>(0,n.jsx)(s,{tag:e,selected:this.isTagSelected(e),onClickHandler:this.props.tagClickHandler},e))}))]}))}}i.FilterPanel=l},{"../util":203,react:268,"react/jsx-runtime":269}],159:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Alert=void 0;let o=e("react/jsx-runtime");var n=e("react"),r=e("react-redux"),e=e("./actions/dispatch");class s extends n.Component{constructor(e){super(e)}render(){var{title:e,text:t,options:i,dispatchHideAlert:n}=this.props;return(0,o.jsx)("div",Object.assign({className:"image-editor-alert-container",role:"region",onClick:n},{children:(0,o.jsxs)("div",Object.assign({className:"image-editor-alert",role:"dialog"},{children:[(0,o.jsxs)("div",Object.assign({className:"title"},{children:[(0,o.jsx)("span",{className:"ms-Icon ms-Icon--Warning"}),(0,o.jsx)("span",{children:e}),(0,o.jsx)("span",{className:"ms-Icon ms-Icon--Cancel",role:"button",onClick:n})]})),(0,o.jsx)("div",Object.assign({className:"text"},{children:t})),i&&(0,o.jsx)("div",Object.assign({className:"options"},{children:i.map((e,t)=>(0,o.jsx)("div",Object.assign({className:"button",role:"button",onClick:e.onClick},{children:e.label}),t))}))]}))}))}}n={dispatchHideAlert:e.dispatchHideAlert};i.Alert=(0,r.connect)(function({editor:e},t){return e?t:{}},n)(s)},{"./actions/dispatch":170,react:268,"react-redux":251,"react/jsx-runtime":269}],160:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.BottomBar=i.BottomBarImpl=void 0;let _=e("react/jsx-runtime");var n=e("react"),o=e("react-redux"),r=e("./actions/dispatch");let s=e("../../assets"),a=e("./keyboardShortcuts"),y=e("../../../../react-common/components/util"),v=e("../../../../react-common/components/controls/Button");class l extends n.Component{constructor(e){super(e),this.disableShortcutsOnFocus=()=>{this.setShortcutsEnabled(!1)},this.handleWidthChange=e=>{var e=e.target.value,t=parseInt(e),{aspectRatioLocked:i,imageDimensions:n}=this.props;!isNaN(t)&&i?this.setState({width:t+"",height:Math.floor(t*(n[1]/n[0]))+""}):this.setState({width:e})},this.handleHeightChange=e=>{var e=e.target.value,t=parseInt(e),{aspectRatioLocked:i,imageDimensions:n}=this.props;!isNaN(t)&&i?this.setState({height:t+"",width:Math.floor(t*(n[0]/n[1]))+""}):this.setState({height:e})},this.handleDimensionalBlur=()=>{var{imageDimensions:e,isTilemap:t,dispatchChangeImageDimensions:i}=this.props,n=parseInt(this.state.width),o=parseInt(this.state.height),t=t?255:512,n=isNaN(n)?e[0]:Math.min(Math.max(n,1),t),o=isNaN(o)?e[1]:Math.min(Math.max(o,1),t);n===e[0]&&o===e[1]||i([n,o]),this.setState({width:null,height:null}),this.setShortcutsEnabled(!0)},this.handleDimensionalKeydown=e=>{13===("number"==typeof e.which?e.which:e.keyCode)&&e.currentTarget.blur()},this.handleAssetNameChange=e=>{let t=null;var e=e.target.value||"",i=e.trim();pxt.validateAssetName(i)?(0,s.isNameTaken)(i)&&i!==this.props.assetName&&(t=lf("This name is already used elsewhere in your project")):t=lf("Names may only contain letters, numbers, '-', '_', and space"),this.setState({assetName:e,assetNameMessage:t})},this.handleAssetNameBlur=()=>{var e,{dispatchChangeAssetName:t,assetName:i}=this.props;this.state.assetName&&(e=this.state.assetName.trim())!==i&&pxt.validateAssetName(e)&&!(0,s.isNameTaken)(e)&&t(e),this.setState({assetName:null,assetNameMessage:null}),this.setShortcutsEnabled(!0)},this.zoomIn=()=>{this.props.dispatchChangeZoom(1)},this.zoomOut=()=>{this.props.dispatchChangeZoom(-1)},this.state={}}render(){var{imageDimensions:e,cursorLocation:t,hasUndo:i,hasRedo:n,dispatchUndoImageEdit:o,dispatchRedoImageEdit:r,aspectRatioLocked:s,onionSkinEnabled:a,dispatchToggleAspectRatioLocked:l,dispatchToggleOnionSkinEnabled:c,resizeDisabled:u,singleFrame:d,onDoneClick:h,assetName:p,hideDoneButton:g,hideAssetName:f}=this.props,m=this.state.assetNameMessage,b=null==this.state.width?e[0]:this.state.width,e=null==this.state.height?e[1]:this.state.height,p=null==this.state.assetName?p||"":this.state.assetName;return(0,_.jsxs)("div",Object.assign({className:"image-editor-bottombar"},{children:[!u&&(0,_.jsxs)("div",Object.assign({className:"image-editor-resize"},{children:[(0,_.jsx)("input",{className:"image-editor-input",title:lf("Image Width"),value:b,tabIndex:0,onChange:this.handleWidthChange,onFocus:this.disableShortcutsOnFocus,onBlur:this.handleDimensionalBlur,onKeyDown:this.handleDimensionalKeydown}),(0,_.jsx)(v.Button,{className:(0,y.classList)("image-editor-button",!s&&"toggle"),onClick:l,leftIcon:s?"ms-Icon ms-Icon--Lock":"ms-Icon ms-Icon--Unlock",title:s?lf("Unlock Aspect Ratio"):lf("Lock Aspect Ratio")}),(0,_.jsx)("input",{className:"image-editor-input",title:lf("Image Height"),value:e,tabIndex:0,onChange:this.handleHeightChange,onFocus:this.disableShortcutsOnFocus,onBlur:this.handleDimensionalBlur,onKeyDown:this.handleDimensionalKeydown})]})),!d&&(0,_.jsx)("div",{className:"image-editor-seperator"}),!d&&(0,_.jsx)("div",{children:(0,_.jsx)(v.Button,{onClick:c,className:(0,y.classList)("image-editor-button",!a&&"toggle"),leftIcon:"ms-Icon ms-Icon--MapLayers",title:a?lf("Hide Previous Frame"):lf("Show Previous Frame")})}),!u&&(0,_.jsx)("div",{className:(0,y.classList)("image-editor-seperator",!t&&"transparent")}),(0,_.jsx)("div",Object.assign({className:"image-editor-coordinate-preview"},{children:t&&t[0]+", "+t[1]})),(0,_.jsx)("div",Object.assign({className:"image-editor-change-name"},{children:!f&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("input",{className:"image-editor-input",title:lf("Asset Name"),value:p,placeholder:lf("Asset Name"),tabIndex:0,onChange:this.handleAssetNameChange,onFocus:this.disableShortcutsOnFocus,onBlur:this.handleAssetNameBlur,onKeyDown:this.handleDimensionalKeydown}),m&&(0,_.jsx)("div",Object.assign({className:"ui pointing below red basic label"},{children:m}))]})})),(0,_.jsxs)("div",Object.assign({className:"image-editor-undo-redo"},{children:[(0,_.jsx)(v.Button,{className:"image-editor-button",title:lf("Undo"),leftIcon:"ms-Icon ms-Icon--Undo",onClick:i?o:null,disabled:!i}),(0,_.jsx)(v.Button,{className:"image-editor-button",title:lf("Redo"),leftIcon:"ms-Icon ms-Icon--Redo",onClick:n?r:null,disabled:!n})]})),(0,_.jsx)("div",{className:"image-editor-seperator"}),(0,_.jsxs)("div",Object.assign({className:"image-editor-zoom-controls"},{children:[(0,_.jsx)(v.Button,{className:"image-editor-button toggle",onClick:this.zoomOut,leftIcon:"ms-Icon ms-Icon--ZoomOut",title:lf("Zoom Out")}),(0,_.jsx)(v.Button,{className:"image-editor-button toggle",onClick:this.zoomIn,leftIcon:"ms-Icon ms-Icon--ZoomIn",title:lf("Zoom In")})]})),!g&&(0,_.jsx)(v.Button,{className:"image-editor-confirm",title:lf("Done"),label:lf("Done"),onClick:h})]}))}setShortcutsEnabled(e){e&&this.shortcutLock?((0,a.releaseShortcutLock)(this.shortcutLock),this.shortcutLock=void 0):e||this.shortcutLock||(this.shortcutLock=(0,a.obtainShortcutLock)())}}i.BottomBarImpl=l;e={dispatchChangeImageDimensions:r.dispatchChangeImageDimensions,dispatchUndoImageEdit:r.dispatchUndoImageEdit,dispatchRedoImageEdit:r.dispatchRedoImageEdit,dispatchToggleAspectRatioLocked:r.dispatchToggleAspectRatioLocked,dispatchToggleOnionSkinEnabled:r.dispatchToggleOnionSkinEnabled,dispatchChangeZoom:r.dispatchChangeZoom,dispatchChangeAssetName:r.dispatchChangeAssetName};i.BottomBar=(0,o.connect)(function({store:{present:e,past:t,future:i},editor:n},o){var r;return e?{imageDimensions:[(r=(n.isTilemap?e.tilemap:e.frames[e.currentFrame]).bitmap).width,r.height],aspectRatioLocked:e.aspectRatioLocked,onionSkinEnabled:n.onionSkinEnabled,cursorLocation:n.cursorLocation,resizeDisabled:"tile"===(null==(r=e.asset)?void 0:r.type),assetName:null==(e=null==(r=e.asset)?void 0:r.meta)?void 0:e.displayName,hasUndo:!!t.length,hasRedo:!!i.length,isTilemap:n.isTilemap}:{}},e)(l)},{"../../../../react-common/components/controls/Button":143,"../../../../react-common/components/util":154,"../../assets":157,"./actions/dispatch":170,"./keyboardShortcuts":172,react:268,"react-redux":251,"react/jsx-runtime":269}],161:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.CursorSizes=void 0;let n=e("react/jsx-runtime");var o=e("react"),r=e("./actions/dispatch"),s=e("react-redux");let a=e("../../../../react-common/components/controls/Button"),l=e("../../../../react-common/components/util");class c extends o.Component{constructor(){super(...arguments),this.handlers=[]}render(){var e=this.props.selected;return(0,n.jsxs)("div",Object.assign({className:"cursor-buttons"},{children:[(0,n.jsx)(a.Button,{className:(0,l.classList)("image-editor-button",1!==e&&"toggle"),title:lf("Small Cursor (1px)"),label:(0,n.jsx)("div",{className:"cursor-button small"}),onClick:this.clickHandler(1)}),(0,n.jsx)(a.Button,{className:(0,l.classList)("image-editor-button",3!==e&&"toggle"),title:lf("Small Cursor (3px)"),label:(0,n.jsx)("div",{className:"cursor-button medium"}),onClick:this.clickHandler(3)}),(0,n.jsx)(a.Button,{className:(0,l.classList)("image-editor-button",5!==e&&"toggle"),title:lf("Small Cursor (5px)"),label:(0,n.jsx)("div",{className:"cursor-button large"}),onClick:this.clickHandler(5)})]}))}clickHandler(t){return this.handlers[t]||(this.handlers[t]=()=>{var e=this.props.dispatchChangeCursorSize;e(t)}),this.handlers[t]}}e={dispatchChangeCursorSize:r.dispatchChangeCursorSize};i.CursorSizes=(0,s.connect)(function({editor:e},t){return e?{selected:e.cursorSize}:{}},e)(c)},{"../../../../react-common/components/controls/Button":143,"../../../../react-common/components/util":154,"./actions/dispatch":170,react:268,"react-redux":251,"react/jsx-runtime":269}],162:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ImageCanvas=i.ImageCanvasImpl=void 0;let n=e("react/jsx-runtime");var o=e("react"),r=e("react-redux");let h=e("./store/imageReducer");var s=e("./actions/dispatch");let a=e("./util"),p=e("./toolDefinitions"),d=e("../../assets"),l=e("./keyboardShortcuts"),g=e("./ImageEditor"),f="image/x-mkcd-f4",c=[h.TileDrawingMode.Wall];class u extends o.Component{constructor(){super(...arguments),this.cursor=p.ToolCursor.Crosshair,this.zoom=2.5,this.panX=0,this.panY=0,this.hasInteracted=!1,this.tileCache={},this.onKeyDown=e=>{var t;if((0,l.areShortcutsEnabled)()&&(this.hasInteracted=!0,!e.repeat)){switch(!e.ctrlKey&&!e.metaKey||"c"!==e.key&&"v"!==e.key||e.stopPropagation(),(e.ctrlKey||e.metaKey)&&"a"===e.key&&this.shouldHandleCanvasShortcut()&&(this.selectAll(),e.preventDefault()),"Escape"==e.key&&null!=(t=null==(t=this.editState)?void 0:t.floating)&&t.image&&this.shouldHandleCanvasShortcut()&&(this.cancelSelection(),e.preventDefault()),this.lastTool=this.props.tool,e.keyCode){case 18:this.props.dispatchChangeImageTool(h.ImageEditorTool.ColorSelect),e.preventDefault();break;case 32:this.props.dispatchChangeImageTool(h.ImageEditorTool.Pan);break;default:this.lastTool=null}this.updateCursor(!1,!1)}},this.onKeyUp=e=>{null!=this.lastTool&&(this.props.dispatchChangeImageTool(this.lastTool),this.lastTool=null,this.updateCursor(!1,!1))},this.onCopy=e=>{var t;this.props.tool===h.ImageEditorTool.Marquee&&null!=(t=null==(t=this.editState)?void 0:t.floating)&&t.image&&(e.preventDefault(),this.props.isTilemap?e.clipboardData.setData("application/makecode-tilemap",JSON.stringify((0,a.createTilemapPatchFromFloatingLayer)(this.editState,this.props.tilemapState.tileset))):(t=pxt.sprite.bitmapToImageLiteral(this.editState.floating.image,"typescript"),e.clipboardData.setData("application/makecode-image",t),e.clipboardData.setData("text/plain",t)))},this.onPaste=t=>{if(this.props.isTilemap){var i=t.clipboardData.getData("application/makecode-tilemap");let e;try{e=JSON.parse(i)}catch(e){}return e&&e.map&&e.layers&&e.tiles?(t.preventDefault(),void this.applyTilemapPatch(e)):void 0}let e=t.clipboardData.getData("application/makecode-image");i=(e=!e&&(i=t.clipboardData.getData("text/plain"),i=/img(`|\(""")[\s\da-f.#tngrpoyw]+(`|"""\))/im.exec(i))?i[0]:e)&&pxt.sprite.imageLiteralToBitmap(e);i&&i.width&&i.height&&(t.preventDefault(),this.props.tool!==h.ImageEditorTool.Marquee&&this.props.dispatchChangeImageTool(h.ImageEditorTool.Marquee),this.editState.mergeFloatingLayer(),this.editState.setFloatingLayer(i),this.props.dispatchImageEdit(this.editState.toImageState()))},this.preventContextMenu=e=>e.preventDefault()}render(){var e=this.getImageState(),e=!e||e.bitmap.height>e.bitmap.width,t=!this.props.isTilemap&&this.props.tool==h.ImageEditorTool.Marquee;return(0,n.jsx)("div",Object.assign({ref:"canvas-bounds",className:"image-editor-canvas "+(e?"portrait":"landscape"),onContextMenu:this.preventContextMenu,tabIndex:0},{children:(0,n.jsxs)("div",Object.assign({className:"paint-container"},{children:[!this.props.lightMode&&(0,n.jsx)("canvas",{ref:"paint-surface-bg",className:"paint-surface"}),(0,n.jsx)("canvas",{ref:"paint-surface",className:"paint-surface main"}),c.map((e,t)=>(0,n.jsx)("canvas",{ref:"paint-surface-"+e.toString(),className:"paint-surface overlay "+(this.props.overlayEnabled?"":"hide")},t)),(0,n.jsx)("div",{ref:"floating-layer-border",className:"image-editor-floating-layer"}),t&&(0,n.jsx)("div",{ref:"floating-layer-nw-corner",className:"image-editor-floating-layer-corner"}),t&&(0,n.jsx)("div",{ref:"floating-layer-ne-corner",className:"image-editor-floating-layer-corner"}),t&&(0,n.jsx)("div",{ref:"floating-layer-se-corner",className:"image-editor-floating-layer-corner"}),t&&(0,n.jsx)("div",{ref:"floating-layer-sw-corner",className:"image-editor-floating-layer-corner"})]}))}))}componentDidMount(){document.activeElement instanceof HTMLElement&&document.activeElement.blur(),this.tileCache={},this.cellWidth=this.props.isTilemap?this.props.tilemapState.tileset.tileWidth:1,this.canvas=this.refs["paint-surface"],this.background=this.refs["paint-surface-bg"],this.floatingLayer=this.refs["floating-layer-border"],this.canvasLayers=c.map(e=>this.refs["paint-surface-"+e.toString()]),(0,a.bindGestureEvents)(this.refs["canvas-bounds"],this);var e=this.refs["canvas-bounds"],e=(e.addEventListener("wheel",e=>{this.hasInteracted=!0,this.updateZoom(e.deltaY/30,e.clientX,e.clientY),e.preventDefault()}),e.addEventListener("mousemove",e=>{e.button||(this.hasHover=!0),this.edit||this.updateCursorLocation(e)}),e.addEventListener("mouseout",e=>{this.edit||this.updateCursorLocation(null)}),document.addEventListener("keydown",this.onKeyDown,!0),document.addEventListener("keyup",this.onKeyUp),document.addEventListener("copy",this.onCopy),document.addEventListener("paste",this.onPaste),this.getImageState());this.editState=(0,p.getEditState)(e,this.props.isTilemap,this.props.drawingMode),this.redraw(),this.updateBackground()}componentDidUpdate(){var e;this.edit&&this.editState||(e=this.getImageState(),this.editState=(0,p.getEditState)(e,this.props.isTilemap,this.props.drawingMode)),this.props.isTilemap||(this.tileCache={}),this.cellWidth=this.props.isTilemap?this.props.tilemapState.tileset.tileWidth:1,this.props.zoomDelta||0===this.props.zoomDelta?(0===this.props.zoomDelta?this.hasInteracted||this.zoomToCanvas():(this.hasInteracted=!0,this.updateZoom(this.props.zoomDelta)),this.props.dispatchChangeZoom(null)):(this.redraw(),this.updateBackground())}componentWillUnmount(){this.tileCache={},document.removeEventListener("keydown",this.onKeyDown,!0),document.removeEventListener("keyup",this.onKeyUp),document.removeEventListener("copy",this.onCopy),document.removeEventListener("paste",this.onPaste)}onClick(e,t){this.hasInteracted=!0,this.isPanning()||(document.activeElement instanceof HTMLElement&&document.activeElement!==this.refs["canvas-bounds"]&&document.activeElement.blur(),this.focus(),this.isColorSelect()?this.selectCanvasColor(e,t):(this.updateCursorLocation(e),this.inBounds(this.cursorLocation[0],this.cursorLocation[1])?(this.touchesResize(e.clientX,e.clientY)&&(this.isResizing=!0),this.startEdit(!!t),this.updateEdit(this.cursorLocation[0],this.cursorLocation[1]),this.commitEdit()):null!=(t=null==(e=this.editState)?void 0:e.floating)&&t.image&&(this.editState.mergeFloatingLayer(),this.props.dispatchImageEdit(this.editState.toImageState()))))}onDragStart(e,t){this.hasInteracted=!0,this.focus(),this.touchesResize(e.clientX,e.clientY)&&(this.isResizing=!0),this.isPanning()?(this.lastPanX=e.clientX,this.lastPanY=e.clientY,this.updateCursor(!0,!1)):this.isColorSelect()?this.selectCanvasColor(e,t):(this.updateCursorLocation(e),this.startEdit(!!t),this.updateEdit(this.cursorLocation[0],this.cursorLocation[1]))}onDragMove(e){this.focus(),this.isPanning()&&null!=this.lastPanX&&null!=this.lastPanY?(this.panX+=this.lastPanX-e.clientX,this.panY+=this.lastPanY-e.clientY,this.lastPanX=e.clientX,this.lastPanY=e.clientY,this.updateCursor(!0,!1)):this.edit&&this.updateCursorLocation(e)&&this.updateEdit(this.cursorLocation[0],this.cursorLocation[1])}onDragEnd(e){if(this.isPanning()&&null!=this.lastPanX&&null!=this.lastPanY)this.panX+=this.lastPanX-e.clientX,this.panY+=this.lastPanY-e.clientY,this.lastPanX=void 0,this.lastPanY=void 0,this.updateCursor(!1,!1);else if(this.isResizing){if(!this.edit)return;this.updateCursorLocation(e)&&this.updateEdit(this.cursorLocation[0],this.cursorLocation[1]),this.commitEdit(!1),this.updateCursor(!1,!1)}else{if(!this.edit)return;this.updateCursorLocation(e)&&this.updateEdit(this.cursorLocation[0],this.cursorLocation[1]),this.commitEdit()}this.isResizing=!1}updateCursorLocation(e){if(e){var t,i;if(this.canvas)return i=this.canvas.getBoundingClientRect(),t=Math.floor((e.clientX-i.left)/i.width*this.imageWidth),i=Math.floor((e.clientY-i.top)/i.height*this.imageHeight),!(this.cursorLocation&&t===this.cursorLocation[0]&&i===this.cursorLocation[1]||(this.cursorLocation=[t,i,e.clientX,e.clientY],this.hasHover&&this.props.dispatchChangeCursorLocation(this.cursorLocation),this.edit||this.redraw(),this.updateCursor(!!this.edit,this.editState.inFloatingLayer(t,i)),0));this.cursorLocation=[0,0,e.clientX,e.clientY]}else this.cursorLocation&&(this.cursorLocation=null,this.props.dispatchChangeCursorLocation(null),this.edit||this.redraw());return!1}updateCursor(e,t){let i=this.props.tool;var n=p.tools.find(e=>e.tool===i);n?t?e?this.updateCursorCore(n.downLayerCursor||n.hoverLayerCursor||n.downCursor||n.hoverCursor):this.updateCursorCore(n.hoverLayerCursor||n.hoverCursor):e?this.updateCursorCore(n.downCursor||n.hoverCursor):this.updateCursorCore(n.hoverCursor):this.updateCursorCore(p.ToolCursor.Default)}updateCursorCore(e){this.cursor=e||p.ToolCursor.Default,this.updateBackground()}startEdit(e){var{tool:t,toolWidth:i,selectedColor:n,backgroundColor:o,drawingMode:r}=this.props,[s,a]=this.cursorLocation;(this.inBounds(s,a)||this.isResizing)&&(s=r==h.TileDrawingMode.Wall?2:e?o:n,this.edit=(0,p.getEdit)(t,this.editState,s,i),this.edit.originalImage=this.originalImage,this.edit.start(this.cursorLocation[0],this.cursorLocation[1],this.cursorLocation[2],this.cursorLocation[3],this.editState))}updateEdit(e,t){this.edit&&(this.edit.inBounds(e,t)||this.isResizing)&&(this.edit.update(e,t),this.redraw())}commitEdit(e=!0){var t=this.props.dispatchImageEdit,i=this.getImageState();this.edit&&(this.editState=(0,p.getEditState)(i,this.props.isTilemap,this.props.drawingMode),this.edit.doEdit(this.editState),this.originalImage=e?void 0:this.edit.originalImage,this.edit=void 0,t(this.editState.toImageState()))}redraw(){var e,{prevFrame:t,onionSkinEnabled:i,selectedColor:n,toolWidth:o,drawingMode:r,tool:s}=this.props,a=this.getImageState(),n=r==h.TileDrawingMode.Wall?2:n;let l=!1;if(this.canvas&&(this.imageWidth=a.bitmap.width,this.imageHeight=a.bitmap.height,l=this.canvas.width!=a.bitmap.width*this.cellWidth||this.canvas.height!=a.bitmap.height*this.cellWidth,this.canvas.width=a.bitmap.width*this.cellWidth,this.canvas.height=a.bitmap.height*this.cellWidth,this.canvasLayers.forEach(e=>{e.width=this.canvas.width/this.cellWidth,e.height=this.canvas.height/this.cellWidth}),i&&t&&(a=(0,p.getEditState)(t,this.props.isTilemap,r),(e=this.canvas.getContext("2d")).globalAlpha=.5,this.drawImage(a.image),a.floating&&a.floating.image&&this.drawImage(a.floating.image,a.layerOffsetX,a.layerOffsetY,!0),e.globalAlpha=1),this.edit?((a=this.editState.copy()).setActiveLayer(r),this.edit.doEdit(a),this.drawImage(a.image,0,0,!(!i||!t)),this.drawOverlayLayers(a.overlayLayers),this.redrawFloatingLayer(a)):(this.drawImage(this.editState.image,0,0,!(!i||!t)),this.drawOverlayLayers(this.editState.overlayLayers),this.redrawFloatingLayer(this.editState),this.cursorLocation&&this.shouldDrawCursor()&&(e=s===h.ImageEditorTool.Erase?0:n,this.drawCursor(this.cursorLocation[0]-(o>>1),this.cursorLocation[1]-(o>>1),o,e))),this.background&&(this.background.width!=this.canvas.width<<1||this.background.height!=this.canvas.height<<1))){this.background.width=this.canvas.width<<1,this.background.height=this.canvas.height<<1;var c=this.background.getContext("2d"),u=(c.imageSmoothingEnabled=!1,c.fillStyle="#aeaeae",c.fillRect(0,0,this.background.width,this.background.height),c.fillStyle="#dedede",this.imageHeight<<1),d=this.imageWidth<<1;for(let t=0;t<d;t++)for(let e=0;e<u;e++)t+e&1&&c.fillRect(t*this.cellWidth,e*this.cellWidth,this.cellWidth,this.cellWidth)}l&&this.zoomToCanvas()}drawImage(e,t=0,i=0,n=!1,o=!this.props.lightMode){this.props.isTilemap?this.drawTilemap(e,t,i,n,o):this.drawBitmap(e,t,i,n,o)}redrawFloatingLayer(e,t=!1){var i=this.refs["floating-layer-border"],n=this.refs["floating-layer-nw-corner"],o=this.refs["floating-layer-ne-corner"],r=this.refs["floating-layer-se-corner"],s=this.refs["floating-layer-sw-corner"],a=[n,o,r,s];if(e.floating&&e.floating.image){t||(this.drawImage(e.floating.image,e.layerOffsetX,e.layerOffsetY,!0),e.floating.overlayLayers&&this.drawOverlayLayers(e.floating.overlayLayers,e.layerOffsetX,e.layerOffsetY));var t=this.canvas.getBoundingClientRect(),l=Math.max(e.layerOffsetX,0),c=Math.max(e.layerOffsetY,0),u=Math.min(e.layerOffsetX+e.floating.image.width,e.width),d=Math.min(e.layerOffsetY+e.floating.image.height,e.height),h=t.width/e.width,t=t.height/e.height,p=(i.style.display="",(u-l<1||d-c<1)&&(i.style.display="none"),-this.panX+h*l),g=-this.panY+t*c,h=h*(u-l),u=t*(d-c),l=(i.style.left=p+"px",i.style.top=g+"px",i.style.width=h+"px",i.style.height=u+"px",i.style.borderLeft=0<=e.layerOffsetX?"":"none",i.style.borderTop=0<=e.layerOffsetY?"":"none",i.style.borderRight=e.layerOffsetX+e.floating.image.width<=e.width?"":"none",i.style.borderBottom=e.layerOffsetY+e.floating.image.height<=e.height?"":"none",null!=n);if(l)this.props.isTilemap||(a.forEach(e=>{e.style.display="",e.style.width="16px",e.style.height="16px",e.style.border="3px solid black",e.style.position="absolute",e.style.backgroundColor="white"}),n.style.left=p-16+"px",n.style.top=g-16+"px",n.style.cursor="nw-resize",o.style.left=p+h+"px",o.style.top=g-16+"px",o.style.cursor="ne-resize",r.style.left=p+h+"px",r.style.top=g+u+"px",r.style.cursor="se-resize",s.style.left=p-16+"px",s.style.top=g+u+"px",s.style.cursor="sw-resize")}else i.style.display="none",a.forEach(e=>{e&&(e.style.display="none")})}drawOverlayLayers(e,i=0,n=0,o=!this.props.lightMode){e&&e.forEach((e,t)=>{this.drawBitmap(e,i,n,!0,o,this.canvasLayers[t])})}drawBitmap(i,n=0,o=0,r=!1,e=this.props.lightMode,t=this.canvas){var s=this.props.colors,a=t.getContext("2d");a.imageSmoothingEnabled=!1;for(let t=0;t<i.width;t++)for(let e=0;e<i.height;e++){var l=i.get(t,e);l?(a.fillStyle=s[l],a.fillRect(t+n,e+o,1,1)):r||a.clearRect(t+n,e+o,1,1)}}generateTile(e,t){var i;return t.tiles[e]?((i=document.createElement("canvas")).width=t.tileWidth,i.height=t.tileWidth,this.drawBitmap(pxt.sprite.Bitmap.fromData(t.tiles[e].bitmap),0,0,!1,!this.props.lightMode,i),this.tileCache[t.tiles[e].id]=i):null}drawTilemap(i,n=0,o=0,r=!1,s=!this.props.lightMode,e=this.canvas){var a,{tileset:l}=this.props.tilemapState,c=e.getContext("2d");let u;this.tileCacheRevision!==this.props.tilesetRevision&&(this.tileCache={},this.tileCacheRevision=this.props.tilesetRevision),c.imageSmoothingEnabled=!1,c.fillStyle=g.LIGHT_MODE_TRANSPARENT;for(let t=0;t<i.width;t++)for(let e=0;e<i.height;e++)(a=i.get(t,e))&&a<l.tiles.length?(u=(u=this.tileCache[l.tiles[a].id])||this.generateTile(a,l))&&c.drawImage(u,(t+n)*this.cellWidth,(e+o)*this.cellWidth):r||(s?c.clearRect((t+n)*this.cellWidth,(e+o)*this.cellWidth,this.cellWidth,this.cellWidth):c.fillRect((t+n)*this.cellWidth,(e+o)*this.cellWidth,this.cellWidth,this.cellWidth))}drawCursor(n,o,r,e){var t=this.props.isTilemap&&this.props.drawingMode===h.TileDrawingMode.Wall,s=(t?this.canvasLayers[0]:this.canvas).getContext("2d");if(s.imageSmoothingEnabled=!1,e&&-1!==e)if(this.props.isTilemap&&!t){if(!(e>=this.props.tilemapState.tileset.tiles.length)){let i=this.tileCache[this.props.tilemapState.tileset.tiles[e].id];if(i=i||this.generateTile(e,this.props.tilemapState.tileset))for(let t=0;t<r;t++)for(let e=0;e<r;e++)s.drawImage(i,(n+t)*this.cellWidth,(o+e)*this.cellWidth)}}else t?(s.fillStyle=this.props.colors[e],s.fillRect(n,o,1,1)):(s.fillStyle=this.props.colors[e],s.fillRect(n*this.cellWidth,o*this.cellWidth,r*this.cellWidth,r*this.cellWidth));else this.props.lightMode?(s.fillStyle=g.LIGHT_MODE_TRANSPARENT,s.fillRect(n*this.cellWidth,o*this.cellWidth,r*this.cellWidth,r*this.cellWidth)):s.clearRect(n*this.cellWidth,o*this.cellWidth,r*this.cellWidth,r*this.cellWidth)}updateBackground(){this.refs["canvas-bounds"].style.cursor=this.cursor,this.canvas.style.cursor=this.cursor,this.updateZoom(0)}updateZoom(e,t,i){var n=this.refs["canvas-bounds"];if(this.canvas&&n){var n=n.getBoundingClientRect(),{canvasX:o,canvasY:r}=(t=void 0===t?n.left+(n.width>>1):t,i=void 0===i?n.top+(n.height>>1):i,this.clientToCanvas(t,i,n)),e=(this.zoom=Math.max(this.zoom+e,2.5),this.getCanvasUnit(n));if(e){var{canvasX:t,canvasY:i}=this.clientToCanvas(t,i,n);if(isNaN(t)||isNaN(i)||isNaN(o)||isNaN(r))return;this.panX+=(o-t)*e,this.panY+=(r-i)*e}this.applyZoom()}}getCenteredPan(){let[e,t]=[0,0];var i=this.refs["canvas-bounds"].getBoundingClientRect(),n=this.canvas.getBoundingClientRect();return n.width<i.width&&(e=-((i.width>>1)-(n.width>>1))),n.height<i.height&&(t=-((i.height>>1)-(n.height>>1))),[e,t]}zoomToCanvas(){this.zoom=10;var e=this.refs["canvas-bounds"];this.applyZoom(),this.canvas&&e&&([this.panX,this.panY]=this.getCenteredPan()),this.applyZoom()}applyZoom(e){var t=this.refs["canvas-bounds"];if(this.canvas&&t){e=e||t.getBoundingClientRect();t=this.getCanvasUnit(e);if(0===t)return this.waitingToZoom?void 0:(this.waitingToZoom=!0,void requestAnimationFrame(()=>{this.waitingToZoom&&(this.waitingToZoom=!1,this.applyZoom())}));this.waitingToZoom=!1;var i=t*this.imageWidth,n=t*this.imageHeight,t=1<this.imageWidth&&1<this.imageHeight?2*t:t>>1;this.hasInteracted||([this.panX,this.panY]=this.getCenteredPan()),this.panX=Math.max(Math.min(this.panX,i-t),-(e.width-t)),this.panY=Math.max(Math.min(this.panY,n-t),-(e.height-t)),this.canvas.style.position="fixed",this.canvas.style.width=i+"px",this.canvas.style.height=n+"px",this.canvas.style.left=-this.panX+"px",this.canvas.style.top=-this.panY+"px",this.canvas.style.clipPath=`polygon(${this.panX}px ${this.panY}px, ${this.panX+e.width}px ${this.panY}px, ${this.panX+e.width}px ${this.panY+e.height}px, ${this.panX}px ${this.panY+e.height}px)`,this.background&&this.cloneCanvasStyle(this.canvas,this.background),this.canvasLayers.forEach(e=>this.cloneCanvasStyle(this.canvas,e)),this.redrawFloatingLayer(this.editState,!0)}}selectCanvasColor(e,t){var i=this.refs["canvas-bounds"].getBoundingClientRect(),{canvasX:e,canvasY:i}=this.clientToCanvas(e.clientX,e.clientY,i),e=Math.floor(e),i=Math.floor(i);let n;n=(n=this.editState.inFloatingLayer(e,i)?this.editState.floating.image.get(e-this.editState.layerOffsetX,i-this.editState.layerOffsetY):n)||this.editState.image.get(e,i),t?this.props.dispatchChangeBackgroundColor(n):this.props.dispatchChangeSelectedColor(n)}selectAll(){this.props.tool!==h.ImageEditorTool.Marquee&&this.props.dispatchChangeImageTool(h.ImageEditorTool.Marquee),this.editState.mergeFloatingLayer(),this.editState.copyToLayer(0,0,this.imageWidth,this.imageHeight,!0),this.props.dispatchImageEdit(this.editState.toImageState())}cancelSelection(){this.editState.mergeFloatingLayer(),this.props.dispatchImageEdit(this.editState.toImageState())}cloneCanvasStyle(e,t){t.style.position=e.style.position,t.style.width=e.style.width,t.style.height=e.style.height,t.style.left=e.style.left,t.style.top=e.style.top,t.style.clipPath=e.style.clipPath}clientToCanvas(e,t,i){var n=this.getCanvasUnit(i);return{canvasX:(e-i.left+this.panX)/n,canvasY:(t-i.top+this.panY)/n}}getCanvasUnit(e){var t=e.width/e.height,i=this.imageWidth/this.imageHeight,n=Math.pow(this.zoom/10,2);return i<t?n*(e.height/this.imageHeight):n*(e.width/this.imageWidth)}inBounds(e,t){return 0<=e&&e<this.imageWidth&&0<=t&&t<this.imageHeight}isPanning(){return this.props.tool===h.ImageEditorTool.Pan}touchesResize(e,t){var i=document.querySelectorAll(":hover");for(let e=0;e<i.length;e++)if("image-editor-floating-layer-corner"==i[e].className)return!0;return!1}isColorSelect(){return this.props.tool===h.ImageEditorTool.ColorSelect}shouldHandleCanvasShortcut(){return!(this.props.suppressShortcuts||document.activeElement instanceof HTMLInputElement)}shouldDrawCursor(){if(!this.hasHover)return!1;switch(this.props.tool){case h.ImageEditorTool.Fill:case h.ImageEditorTool.Marquee:case h.ImageEditorTool.Pan:case h.ImageEditorTool.ColorSelect:return!1;default:return!0}}getImageState(){return this.props.isTilemap?this.props.tilemapState.tilemap:this.props.imageState}applyTilemapPatch(t){var{tilemapState:i,dispatchCreateNewTile:n,gallery:o,backgroundColor:r}=this.props,s=i.tileset,a=pxt.sprite.tilemapLiteralToTilemap(t.map);if(a&&a.width&&a.height){var i=t.tiles.map(e=>pxt.sprite.getBitmapFromJResURL(`data:${f};base64,`+e)),t=t.layers.map(e=>pxt.sprite.getBitmapFromJResURL(`data:${f};base64,`+e)),l=[];let e=s.tiles.length;for(let t of i){var c=s.tiles.findIndex(e=>t.equals(pxt.sprite.Bitmap.fromData(e.bitmap)));if(0<=c)l.push(c);else{if(o){c=o.find(e=>t.equals(pxt.sprite.Bitmap.fromData(e.bitmap)));if(c){n(null,s.tiles.length,r,c.qualifiedName),l.push(e),e++;continue}}n((0,d.createTile)(t.data()),s.tiles.length,r),l.push(e),e++}}this.editState.mergeFloatingLayer();var u=new pxt.sprite.Tilemap(a.width,a.height);for(let t=0;t<u.width;t++)for(let e=0;e<u.height;e++)u.set(t,e,l[a.get(t,e)]);this.editState.floating={image:u,overlayLayers:t},this.editState.layerOffsetX=0,this.editState.layerOffsetY=0,this.props.dispatchImageEdit(this.editState.toImageState())}}focus(){this.refs["canvas-bounds"].focus()}}i.ImageCanvasImpl=u;e={dispatchImageEdit:s.dispatchImageEdit,dispatchChangeCursorLocation:s.dispatchChangeCursorLocation,dispatchChangeZoom:s.dispatchChangeZoom,dispatchChangeImageTool:s.dispatchChangeImageTool,dispatchChangeSelectedColor:s.dispatchChangeSelectedColor,dispatchChangeBackgroundColor:s.dispatchChangeBackgroundColor,dispatchCreateNewTile:s.dispatchCreateNewTile};i.ImageCanvas=(0,r.connect)(function({store:{present:e},editor:t},i){return t.isTilemap?e?{selectedColor:t.selectedColor,tilemapState:e,tool:t.tool,toolWidth:t.cursorSize,zoomDelta:t.zoomDelta,onionSkinEnabled:!1,overlayEnabled:t.overlayEnabled,backgroundColor:t.backgroundColor,colors:e.colors,isTilemap:t.isTilemap,drawingMode:t.drawingMode,gallery:t.tileGallery,tilesetRevision:t.tilesetRevision}:{}:e?{selectedColor:t.selectedColor,colors:e.colors,imageState:e.frames[e.currentFrame],tool:t.tool,toolWidth:t.cursorSize,zoomDelta:t.zoomDelta,onionSkinEnabled:t.onionSkinEnabled,backgroundColor:t.backgroundColor,prevFrame:e.frames[e.currentFrame-1],isTilemap:t.isTilemap,tilesetRevision:t.tilesetRevision}:{}},e)(u)},{"../../assets":157,"./ImageEditor":163,"./actions/dispatch":170,"./keyboardShortcuts":172,"./store/imageReducer":174,"./toolDefinitions":178,"./util":179,react:268,"react-redux":251,"react/jsx-runtime":269}],163:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ImageEditor=i.LIGHT_MODE_TRANSPARENT=void 0;let c=e("react/jsx-runtime");var n=e("react");let u=e("react-redux"),d=e("./store/imageStore"),h=e("./SideBar"),p=e("./BottomBar"),g=e("./TopBar"),f=e("./ImageCanvas"),m=e("./Alert"),b=e("./Timeline"),o=e("./keyboardShortcuts"),r=e("./actions/dispatch"),s=e("./util"),a=e("../../assets"),_=e("../../../../react-common/components/util");i.LIGHT_MODE_TRANSPARENT="#dedede";class y extends n.Component{constructor(e){super(e),this.onStoreChange=()=>{this.props.onChange&&this.props.onChange(this.props.singleFrame?pxt.sprite.bitmapToImageLiteral(this.getCurrentFrame(),"typescript"):"");var e=this.getStore(),t=e.getState();(0,o.setStore)(e),t.editor&&this.setState({alert:t.editor.alert}),!!t.editor.editingTile!=!!this.state.editingTile&&(t.editor.editingTile?((e=t.editor.editingTile.tilesetIndex)?(e=t.store.present.tileset.tiles[e],this.setState({editingTile:!0,tileToEdit:e})):(e=t.store.present.tileset.tileWidth,t=(0,a.createNewImageAsset)("tile",e,e,lf("myTile")),this.setState({editingTile:!0,tileToEdit:t})),this.props.onTileEditorOpenClose&&this.props.onTileEditorOpenClose(!0)):(this.setState({editingTile:!1}),this.props.onTileEditorOpenClose&&this.props.onTileEditorOpenClose(!1)))},this.onDoneClick=()=>{this.props.onDoneClicked&&this.props.onDoneClicked(this.getAsset())},this.onTileEditorFinished=e=>{var t=this.getStore().getState().editor.editingTile;e.isProjectTile=!0,this.dispatchOnStore((0,r.dispatchCloseTileEditor)(e,t.tilesetIndex))},this.state={editingTile:!1}}componentDidMount(){(0,o.addKeyListener)(),this.props.asset&&this.openAsset(this.props.asset),this.unsubscribeChangeListener=this.getStore().subscribe(this.onStoreChange),this.onResize()}componentWillUnmount(){this.props.nested||(0,o.removeKeyListener)(),this.unsubscribeChangeListener&&this.unsubscribeChangeListener()}render(){var{singleFrame:e,lightMode:t,hideDoneButton:i,hideAssetName:n}=this.props,o=this.getStore(),{tileToEdit:r,editingTile:s,alert:a}=this.state,l="Animation"===o.getState().store.present.kind;return(0,c.jsxs)("div",Object.assign({className:"image-editor-outer"},{children:[(0,c.jsx)(u.Provider,Object.assign({store:o},{children:(0,c.jsxs)("div",Object.assign({className:(0,_.classList)("image-editor",s&&"editing-tile",i&&"hide-done-button")},{children:[(0,c.jsx)(g.TopBar,{singleFrame:e}),(0,c.jsxs)("div",Object.assign({className:"image-editor-content"},{children:[(0,c.jsx)(h.SideBar,{lightMode:t}),(0,c.jsx)(f.ImageCanvas,{suppressShortcuts:s,lightMode:t}),l&&!e?(0,c.jsx)(b.Timeline,{}):void 0]})),(0,c.jsx)(p.BottomBar,{singleFrame:e,onDoneClick:this.onDoneClick,hideDoneButton:!!i,hideAssetName:!!n}),a&&a.title&&(0,c.jsx)(m.Alert,{title:a.title,text:a.text,options:a.options})]}))})),s&&(0,c.jsx)(y,{store:d.tileEditorStore,ref:"nested-image-editor",onDoneClicked:this.onTileEditorFinished,asset:r,singleFrame:!0,nested:!0,hideAssetName:n})]}))}openAsset(e,t,i=!1){this.dispatchOnStore((0,r.dispatchOpenAsset)(e,i,t)),e.meta.displayName?this.dispatchOnStore((0,r.dispatchChangeAssetName)(e.meta.displayName)):i&&this.dispatchOnStore((0,r.dispatchChangeAssetName)(""))}openGalleryAsset(e){var t=this.getAsset(),i=this.getStore().getState().store.present.frames;switch(t.type){case"animation":switch(e.type){case"image":case"tile":this.setCurrentFrame(pxt.sprite.Bitmap.fromData(e.bitmap),1===i.length);break;case"animation":this.dispatchOnStore((0,r.dispatchSetFrames)(e.frames.map(e=>({bitmap:e}))))}break;case"image":case"tile":switch(e.type){case"image":case"tile":this.setCurrentFrame(pxt.sprite.Bitmap.fromData(e.bitmap),!0);break;case"animation":this.setCurrentFrame(pxt.sprite.Bitmap.fromData(e.frames[0]),!0)}}}onResize(){this.dispatchOnStore((0,r.dispatchChangeZoom)(0))}getCurrentFrame(){var e=this.getStore().getState().store.present,e=e.frames[e.currentFrame];return(0,s.imageStateToBitmap)(e)}getAsset(){switch(this.getStore().getState().store.present.asset.type){case"tile":return this.getTile();case"animation":return this.getAnimation();case"tilemap":return this.getTilemap();default:return this.getImage()}}getImage(){var e,t=this.getStore().getState().store.present,i=this.getCurrentFrame().data(),n=t.asset?Object.assign({},t.asset.meta):{};return{id:null==(e=t.asset)?void 0:e.id,internalID:t.asset?t.asset.internalID:(0,a.getNewInternalID)(),type:"image",bitmap:i,jresData:pxt.sprite.base64EncodeBitmap(i),meta:n}}getTile(){var e,t=this.getStore().getState().store.present,i=this.getCurrentFrame().data(),n=t.asset?Object.assign({},t.asset.meta):{};return{id:null==(e=t.asset)?void 0:e.id,internalID:t.asset?t.asset.internalID:(0,a.getNewInternalID)(),isProjectTile:!0,type:"tile",bitmap:i,jresData:pxt.sprite.base64EncodeBitmap(i),meta:n}}getAnimation(){var e,t=this.getStore().getState().store.present,i=t.asset?Object.assign({},t.asset.meta):{};return{id:null==(e=t.asset)?void 0:e.id,internalID:t.asset?t.asset.internalID:(0,a.getNewInternalID)(),type:"animation",interval:t.interval,frames:t.frames.map(e=>(0,s.imageStateToBitmap)(e).data()),meta:i}}getTilemap(){var e=this.getStore().getState(),t=e.store.present,{floating:i,overlayLayers:n,layerOffsetX:o,layerOffsetY:r}=t.tilemap,n=(0,s.applyBitmapData)(pxt.sprite.Bitmap.fromData(n[0]).copy().data(),i&&i.overlayLayers&&i.overlayLayers[0],o,r),i=new pxt.sprite.TilemapData((0,s.imageStateToTilemap)(t.tilemap),t.tileset,n),o=(i.deletedTiles=e.editor.deletedTiles,i.editedTiles=e.editor.editedTiles,t.asset?Object.assign({},t.asset.meta):{});return{id:null==(r=t.asset)?void 0:r.id,internalID:t.asset?t.asset.internalID:(0,a.getNewInternalID)(),type:"tilemap",data:i,meta:o}}getPersistentData(){var e=this.getStore().getState();return{editor:e.editor,past:e.store.past}}restorePersistentData(e){e&&this.dispatchOnStore((0,r.dispatchSetInitialState)(e.editor,e.past))}setCurrentFrame(e,t){var i;t||(t=this.getStore().getState().store.present.frames[0],e.width===t.bitmap.width&&e.height===t.bitmap.height)||(i=[Math.max(e.width,t.bitmap.width),Math.max(e.height,t.bitmap.height)],t.bitmap.width===i[0]&&t.bitmap.height===i[1]||this.dispatchOnStore((0,r.dispatchChangeImageDimensions)(i)),e=(e=e.copy()).resize(i[0],i[1])),this.dispatchOnStore((0,r.dispatchImageEdit)({bitmap:e.data()}))}openInTileEditor(e){this.refs["nested-image-editor"].setCurrentFrame(e,!1)}disableResize(){this.dispatchOnStore((0,r.dispatchDisableResize)())}closeNestedEditor(){var e;this.state.editingTile&&null!=(e=this.refs["nested-image-editor"])&&e.onDoneClick()}getJres(){var e;return this.props.singleFrame?(e=this.getCurrentFrame().data(),pxt.sprite.base64EncodeBitmap(e)):""}loadJres(e){if(e)try{this.setCurrentFrame(pxt.sprite.getBitmapFromJResURL(e),!0)}catch(e){}}getStore(){return this.props.store||d.mainStore}dispatchOnStore(e){this.getStore().dispatch(e)}}i.ImageEditor=y},{"../../../../react-common/components/util":154,"../../assets":157,"./Alert":159,"./BottomBar":160,"./ImageCanvas":162,"./SideBar":165,"./Timeline":166,"./TopBar":169,"./actions/dispatch":170,"./keyboardShortcuts":172,"./store/imageStore":175,"./util":179,react:268,"react-redux":251,"react/jsx-runtime":269}],164:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Pivot=void 0;let n=e("react/jsx-runtime");var o=e("react");let r=e("./util");class s extends o.Component{constructor(e){super(e),this.handlers=[],this.state={open:!1}}componentWillUnmount(){this.handlers=null}render(){var{options:e,selected:t}=this.props;let i=e[t];return(0,n.jsx)("div",Object.assign({className:"image-editor-pivot-outer"},{children:e.map((e,t)=>(0,n.jsx)("div",Object.assign({role:"tab",className:"image-editor-pivot-option "+(e===i?"selected":""),tabIndex:0,onClick:this.clickHandler(t),onKeyDown:r.fireClickOnlyOnEnter},{children:e.text}),e.id))}))}clickHandler(i){if(!this.handlers[i]){let{onChange:e,options:t}=this.props;this.handlers[i]=()=>{this.setState({open:!1}),e(t[i],i)}}return this.handlers[i]}}i.Pivot=s},{"./util":179,react:268,"react/jsx-runtime":269}],165:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.SideBar=i.SideBarImpl=void 0;let n=e("react/jsx-runtime");var o=e("react"),r=e("react-redux");let s=e("./toolDefinitions");var a=e("./actions/dispatch");let l=e("./sprite/Palette"),c=e("./tilemap/TilePalette"),u=e("./tilemap/Minimap"),d=e("../../../../react-common/components/controls/Button"),h=e("../../../../react-common/components/util");class p extends o.Component{constructor(){super(...arguments),this.handlers=[]}render(){let{selectedTool:t,isTilemap:e,lightMode:i}=this.props;return(0,n.jsxs)("div",Object.assign({className:"image-editor-sidebar "+(e?"tilemap":"")},{children:[e&&(0,n.jsx)("div",Object.assign({className:"image-editor-tilemap-minimap"},{children:(0,n.jsx)(u.Minimap,{lightMode:i})})),(0,n.jsx)("div",Object.assign({className:"image-editor-tool-buttons"},{children:s.tools.filter(e=>!e.hiddenTool).map(e=>(0,n.jsx)(d.Button,{className:(0,h.classList)("image-editor-button",t!==e.tool&&"toggle"),leftIcon:e.iconClass,title:e.title,onClick:this.clickHandler(e.tool)},e.tool))})),(0,n.jsx)("div",Object.assign({className:"image-editor-palette"},{children:e?(0,n.jsx)(c.TilePalette,{}):(0,n.jsx)(l.Palette,{})}))]}))}clickHandler(e){return this.handlers[e]||(this.handlers[e]=()=>this.props.dispatchChangeImageTool(e)),this.handlers[e]}}i.SideBarImpl=p;e={dispatchChangeImageTool:a.dispatchChangeImageTool};i.SideBar=(0,r.connect)(function({editor:e},t){return e?{isTilemap:e.isTilemap,selectedTool:e.tool}:{}},e)(p)},{"../../../../react-common/components/controls/Button":143,"../../../../react-common/components/util":154,"./actions/dispatch":170,"./sprite/Palette":173,"./tilemap/Minimap":176,"./tilemap/TilePalette":177,"./toolDefinitions":178,react:268,"react-redux":251,"react/jsx-runtime":269}],166:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Timeline=i.TimelineImpl=void 0;let c=e("react/jsx-runtime");var n=e("react"),o=e("react-redux"),r=e("./actions/dispatch");let u=e("./TimelineFrame"),a=e("./util"),d=e("../../../../react-common/components/controls/Button");class s extends n.Component{constructor(e){super(e),this.handlers=[],this.scrollOffset=0,this.dragEnd=!1,this.duplicateFrame=()=>{var{currentFrame:e,dispatchDuplicateFrame:t}=this.props;t(e)},this.deleteFrame=()=>{var{currentFrame:e,dispatchDeleteFrame:t}=this.props;t(e)},this.newFrame=()=>{var e=this.props.dispatchNewFrame;this.dragEnd?this.dragEnd=!1:e()},this.state={}}render(){let{frames:e,colors:n,currentFrame:o,interval:t,previewAnimating:i}=this.props,{isMovingFrame:r,dropPreviewIndex:s}=this.state;var a=e.slice();let l;return r&&(l=e[o],a.splice(o,1),a.splice(s,0,null)),(0,c.jsxs)("div",Object.assign({className:"image-editor-timeline "+(pxt.BrowserUtils.isEdge()?"edge":"")},{children:[(0,c.jsx)("div",Object.assign({className:"image-editor-timeline-preview"},{children:(0,c.jsx)(u.TimelineFrame,{frames:i?e:[e[o]],colors:n,interval:t,animating:!0})})),(0,c.jsx)("div",Object.assign({className:"image-editor-timeline-frames-outer"},{children:(0,c.jsxs)("div",Object.assign({className:"image-editor-timeline-frames",ref:"frame-scroller-ref"},{children:[a.map((e,t)=>{var i=!r&&t===o;return e?(0,c.jsx)("div",Object.assign({className:"image-editor-timeline-frame "+(i?"active":""),role:"button",onClick:this.clickHandler(t)},{children:(0,c.jsx)(u.TimelineFrame,{frames:[e],colors:n,showActions:i,duplicateFrame:this.duplicateFrame,deleteFrame:this.deleteFrame})}),t):(0,c.jsx)("div",{className:"image-editor-timeline-frame drop-marker"},t)}),l&&(0,c.jsx)("div",Object.assign({ref:"floating-frame",className:"image-editor-timeline-frame dragging"},{children:(0,c.jsx)(u.TimelineFrame,{frames:[l],colors:n,duplicateFrame:this.duplicateFrame,deleteFrame:this.deleteFrame})})),(0,c.jsx)(d.Button,{className:"image-editor-button add-frame-button toggle",title:lf("Add new frame"),onClick:this.newFrame,leftIcon:"ms-Icon ms-Icon--Add"})]}))}))]}))}componentDidMount(){this.frameScroller=this.refs["frame-scroller-ref"];let o,r=!1,s=0;(0,a.bindGestureEvents)(this.frameScroller,{onClick:e=>{this.dragEnd=!1},onDragStart:t=>{o=t.clientY,pxt.BrowserUtils.addClass(this.frameScroller,"scrolling");let i=-1;for(let e=0;e<this.frameScroller.childElementCount;e++){var n=this.frameScroller.children.item(e).getBoundingClientRect();if(t.clientY>=n.top&&t.clientY<=n.bottom){i=e,s=t.clientY-n.top;break}}r=i!==this.props.currentFrame},onDragMove:e=>{if(r){this.scrollOffset-=o-e.clientY,o=e.clientY;try{var t=this.frameScroller.getBoundingClientRect(),i=this.frameScroller.parentElement.getBoundingClientRect();t.height>i.height?this.scrollOffset=Math.max(Math.min(this.scrollOffset,0),i.height-t.height-15):this.scrollOffset=0,this.frameScroller.parentElement.scrollTop=-this.scrollOffset}catch(e){}}else this.updateDragDrop(e,s)},onDragEnd:()=>{var e,t;o=null,pxt.BrowserUtils.removeClass(this.frameScroller,"scrolling"),this.dragEnd=!0,this.state.isMovingFrame&&({dispatchMoveFrame:e,currentFrame:t}=this.props,e(t,this.state.dropPreviewIndex),this.setState({isMovingFrame:!1}))}}),this.frameScroller.addEventListener("wheel",e=>{this.scrollOffset-=e.deltaY;try{var t=this.frameScroller.getBoundingClientRect(),i=this.frameScroller.parentElement.getBoundingClientRect();t.height>i.height?this.scrollOffset=Math.max(Math.min(this.scrollOffset,0),i.height-t.height-15):this.scrollOffset=0,this.frameScroller.parentElement.scrollTop=-this.scrollOffset}catch(e){}})}clickHandler(i){return this.handlers[i]||(this.handlers[i]=()=>{var{currentFrame:e,dispatchChangeCurrentFrame:t}=this.props;this.dragEnd?this.dragEnd=!1:i!=e&&t(i)}),this.handlers[i]}updateDragDrop(i,n){this.animHandler?(cancelAnimationFrame(this.animHandler),this.animHandler=void 0):this.lastTimestamp=void 0;var e=this.frameScroller.getBoundingClientRect(),t=i.clientY-e.top-n,o=this.frameScroller.lastElementChild.getBoundingClientRect().height,o=(e.height-o)/this.props.frames.length,o=Math.floor(t/o);let r=this.frameScroller.parentElement.getBoundingClientRect(),s=e.height-r.height;0<s&&(Math.abs(r.top-i.clientY)<80?this.animHandler=requestAnimationFrame(e=>{var t;!this.state.isMovingFrame||this.frameScroller.parentElement.scrollTop<=0||(t=e-(this.lastTimestamp||e),this.lastTimestamp=e,e=1-Math.abs(r.top-i.clientY)/80,this.frameScroller.parentElement.scrollTop=Math.max(0,this.frameScroller.parentElement.scrollTop-t/1e3*(100+400*e)),this.updateDragDrop(i,n))}):Math.abs(r.bottom-i.clientY)<80&&(this.animHandler=requestAnimationFrame(e=>{var t;!this.state.isMovingFrame||this.frameScroller.parentElement.scrollTop>=s||(t=e-(this.lastTimestamp||e),this.lastTimestamp=e,e=t/1e3*(100+400*(1-Math.abs(r.bottom-i.clientY)/80)),this.frameScroller.parentElement.scrollTop=Math.min(s,this.frameScroller.parentElement.scrollTop+e),this.updateDragDrop(i,n))}))),this.state.isMovingFrame?this.refs["floating-frame"]&&(this.refs["floating-frame"].style.top=t+"px",this.state.dropPreviewIndex!==o)&&this.setState({dropPreviewIndex:o}):this.setState({isMovingFrame:!0,dropPreviewIndex:this.props.currentFrame})}}i.TimelineImpl=s;e={dispatchDuplicateFrame:r.dispatchDuplicateFrame,dispatchDeleteFrame:r.dispatchDeleteFrame,dispatchChangeCurrentFrame:r.dispatchChangeCurrentFrame,dispatchNewFrame:r.dispatchNewFrame,dispatchMoveFrame:r.dispatchMoveFrame};i.Timeline=(0,o.connect)(function({store:{present:e},editor:t},i){return e?{frames:e.frames,currentFrame:e.currentFrame,colors:e.colors,interval:e.interval,previewAnimating:t.previewAnimating}:{}},e)(s)},{"../../../../react-common/components/controls/Button":143,"./TimelineFrame":167,"./actions/dispatch":170,"./util":179,react:268,"react-redux":251,"react/jsx-runtime":269}],167:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.TimelineFrame=void 0;let r=e("react/jsx-runtime");var n=e("react");let s=e("../../../../react-common/components/controls/Button"),c=pxt.BrowserUtils.isEdge()?25:1;class o extends n.Component{constructor(e){super(e),this.state={index:0}}render(){var{frames:e,animating:t,showActions:i,duplicateFrame:n,deleteFrame:o}=this.props,t=e[t?Math.min(Math.max(0,this.state.index),e.length-1):0],e=t.bitmap.height>t.bitmap.width;return(0,r.jsxs)("div",Object.assign({className:"timeline-frame-outer "+(e?"portrait":"landscape")},{children:[(0,r.jsx)("div",{className:"timeline-frame-spacer"}),(0,r.jsx)("canvas",{ref:"preview-canvas"}),(0,r.jsx)("div",{className:"timeline-frame-spacer"}),i&&(0,r.jsxs)("div",Object.assign({className:"timeline-frame-actions"},{children:[(0,r.jsx)(s.Button,{className:"image-editor-button",leftIcon:"ms-Icon ms-Icon--Copy",title:lf("Duplicate Current Frame"),onClick:n}),(0,r.jsx)(s.Button,{className:"image-editor-button",leftIcon:"ms-Icon ms-Icon--Delete",title:lf("Delete Current Frame"),onClick:o})]}))]}))}componentDidMount(){this.canvas=this.refs["preview-canvas"],this.redraw(),this.updateAnimation()}componentDidUpdate(){this.redraw(),this.updateAnimation()}componentWillUnmount(){this.intervalId&&clearInterval(this.intervalId),this.intervalId=void 0}redraw(){var e,t;this.canvas&&({animating:e,frames:t}=this.props,e=t[e?Math.min(Math.max(0,this.state.index),t.length-1):0],this.canvas.height=e.bitmap.height*c,this.canvas.width=e.bitmap.width*c,t=pxt.sprite.Bitmap.fromData(e.bitmap),this.drawBitmap(t),e.floating)&&e.floating.bitmap&&(t=pxt.sprite.Bitmap.fromData(e.floating.bitmap),this.drawBitmap(t,e.layerOffsetX,e.layerOffsetY,!0))}updateAnimation(){var{animating:e,interval:t,frames:i}=this.props,e=e&&5<t&&1<i.length;e&&t!==this.intervalcurrent?(this.intervalId&&clearInterval(this.intervalId),this.intervalId=setInterval(()=>this.setState({index:(this.state.index+1)%this.props.frames.length}),t),this.intervalcurrent=t):!e&&this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0,this.intervalcurrent=void 0)}drawBitmap(i,n=0,o=0,r=!1){var s=this.props.colors,a=this.canvas.getContext("2d");for(let t=0;t<i.width;t++)for(let e=0;e<i.height;e++){var l=i.get(t,e);l?(a.fillStyle=s[l],a.fillRect((t+n)*c,(e+o)*c,c,c)):r||a.clearRect((t+n)*c,(e+o)*c,c,c)}}}i.TimelineFrame=o},{"../../../../react-common/components/controls/Button":143,react:268,"react/jsx-runtime":269}],168:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Toggle=void 0;let n=e("react/jsx-runtime");e=e("react");class o extends e.Component{constructor(e){super(e),this.checked=!1,this.handleToggleClick=e=>{this.checked=!this.checked,this.props.onChange&&this.props.onChange(e.target.checked)},this.checked=e.initialValue}render(){var{initialValue:e,label:t}=this.props;return(0,n.jsxs)("div",Object.assign({className:"image-editor-toggle-container"},{children:[t&&(0,n.jsx)("span",{children:t}),(0,n.jsxs)("label",Object.assign({className:"image-editor-toggle"},{children:[(0,n.jsx)("input",{type:"checkbox",onClick:this.handleToggleClick,defaultChecked:e,"aria-checked":this.checked}),(0,n.jsx)("span",{className:"image-editor-toggle-switch"})]}))]}))}}i.Toggle=o},{react:268,"react/jsx-runtime":269}],169:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.TopBar=i.TopBarImpl=void 0;let r=e("react/jsx-runtime");var n=e("react"),o=e("react-redux"),s=e("./actions/dispatch");let a=e("./CursorSizes"),l=e("./Toggle"),c=e("./keyboardShortcuts"),u=e("../../../../react-common/components/controls/Button");class d extends n.Component{constructor(e){super(e),this.togglePreviewAnimating=()=>this.props.dispatchChangePreviewAnimating(!this.props.previewAnimating),this.flipVertical=()=>(0,c.flip)(!0),this.flipHorizontal=()=>(0,c.flip)(!1),this.rotateClockwise=()=>(0,c.rotate)(!0),this.rotateCounterclockwise=()=>(0,c.rotate)(!1),this.handleIntervalChange=e=>{this.setState({interval:e.target.value})},this.handleIntervalBlur=()=>{var e=this.props.dispatchChangeInterval,t=parseInt(this.state.interval);isNaN(t)||e(Math.min(Math.max(t,50),1e6)),this.setState({interval:null})},this.state={}}render(){var{interval:e,previewAnimating:t,singleFrame:i,isTilemap:n,dispatchChangeOverlayEnabled:o}=this.props,e=null==this.state.interval?e:this.state.interval;return(0,r.jsxs)("div",Object.assign({className:"image-editor-topbar"},{children:[(0,r.jsx)("div",Object.assign({className:"cursor-group"},{children:(0,r.jsx)(a.CursorSizes,{})})),(0,r.jsx)("div",{className:"image-editor-seperator"}),(0,r.jsxs)("div",Object.assign({className:"image-transform-group"},{children:[(0,r.jsx)(u.Button,{className:"image-editor-button",leftIcon:"xicon flipvertical",title:lf("Flip vertical"),onClick:this.flipVertical}),(0,r.jsx)(u.Button,{className:"image-editor-button",leftIcon:"xicon fliphorizontal",title:lf("Flip horizontal"),onClick:this.flipHorizontal}),(0,r.jsx)(u.Button,{className:"image-editor-button",leftIcon:"xicon rotateright",title:lf("Rotate clockwise"),onClick:this.rotateClockwise}),(0,r.jsx)(u.Button,{className:"image-editor-button",leftIcon:"xicon rotateleft",title:lf("Rotate counterclockwise"),onClick:this.rotateCounterclockwise})]})),(0,r.jsx)("div",{className:"spacer"}),!i&&(0,r.jsx)("div",{className:"image-editor-seperator"}),!i&&(0,r.jsxs)("div",Object.assign({className:"timeline-controls"},{children:[(0,r.jsx)(u.Button,{className:"image-editor-button TOGGLE",onClick:this.togglePreviewAnimating,leftIcon:t?"ms-Icon ms-Icon--Stop":"ms-Icon ms-Icon--Play",title:t?lf("Stop Animation Preview"):lf("Play Animation Preview")}),(0,r.jsx)("div",Object.assign({className:"image-editor-interval-label image-editor-label"},{children:(0,r.jsx)("span",{className:"ms-Icon ms-Icon--Clock"})})),(0,r.jsx)("div",Object.assign({className:"image-editor-interval"},{children:(0,r.jsx)("input",{className:"image-editor-input",title:lf("Interval Between Frames (ms)"),value:e,onChange:this.handleIntervalChange,onBlur:this.handleIntervalBlur})}))]})),n&&(0,r.jsx)(l.Toggle,{initialValue:!0,label:lf("Show walls"),onChange:o})]}))}}i.TopBarImpl=d;e={dispatchChangeInterval:s.dispatchChangeInterval,dispatchChangePreviewAnimating:s.dispatchChangePreviewAnimating,dispatchChangeOverlayEnabled:s.dispatchChangeOverlayEnabled};i.TopBar=(0,o.connect)(function({store:{present:e},editor:t},i){return e?{interval:e.interval,previewAnimating:t.previewAnimating,isTilemap:t.isTilemap}:{}},e)(d)},{"../../../../react-common/components/controls/Button":143,"./CursorSizes":161,"./Toggle":168,"./actions/dispatch":170,"./keyboardShortcuts":172,react:268,"react-redux":251,"react/jsx-runtime":269}],170:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.dispatchSetFrames=i.dispatchOpenAsset=i.dispatchChangeAssetName=i.dispatchDisableResize=i.dispatchDeleteTile=i.dispatchCloseTileEditor=i.dispatchOpenTileEditor=i.dispatchSetGalleryOpen=i.dispatchCreateNewTile=i.dispatchChangeDrawingMode=i.dispatchChangeTilePalettePage=i.dispatchChangeTilePaletteCategory=i.dispatchSetInitialState=i.dispatchChangeBackgroundColor=i.dispatchSwapBackgroundForeground=i.dispatchHideAlert=i.dispatchShowAlert=i.dispatchChangeZoom=i.dispatchChangeOverlayEnabled=i.dispatchToggleOnionSkinEnabled=i.dispatchChangePreviewAnimating=i.dispatchChangeInterval=i.dispatchMoveFrame=i.dispatchChangeCurrentFrame=i.dispatchDuplicateFrame=i.dispatchDeleteFrame=i.dispatchNewFrame=i.dispatchToggleAspectRatioLocked=i.dispatchRedoImageEdit=i.dispatchUndoImageEdit=i.dispatchImageEdit=i.dispatchChangeCursorLocation=i.dispatchChangeKeyModifiers=i.dispatchChangeImageDimensions=i.dispatchChangeSelectedColor=i.dispatchChangeCursorSize=i.dispatchChangeImageTool=void 0;let o=e("./types");i.dispatchChangeImageTool=e=>({type:o.CHANGE_IMAGE_TOOL,tool:e}),i.dispatchChangeCursorSize=e=>({type:o.CHANGE_CURSOR_SIZE,cursorSize:e}),i.dispatchChangeSelectedColor=e=>({type:o.CHANGE_SELECTED_COLOR,selectedColor:e}),i.dispatchChangeImageDimensions=e=>({type:o.CHANGE_IMAGE_DIMENSIONS,imageDimensions:e}),i.dispatchChangeKeyModifiers=e=>({type:o.CHANGE_KEY_MODIFIERS,keyModifiers:e}),i.dispatchChangeCursorLocation=e=>({type:o.CHANGE_CURSOR_LOCATION,cursorLocation:e}),i.dispatchImageEdit=e=>({type:o.IMAGE_EDIT,newState:e}),i.dispatchUndoImageEdit=()=>({type:o.UNDO_IMAGE_EDIT}),i.dispatchRedoImageEdit=()=>({type:o.REDO_IMAGE_EDIT}),i.dispatchToggleAspectRatioLocked=()=>({type:o.TOGGLE_ASPECT_RATIO}),i.dispatchNewFrame=e=>({type:o.NEW_FRAME,index:e}),i.dispatchDeleteFrame=e=>({type:o.DELETE_FRAME,index:e}),i.dispatchDuplicateFrame=e=>({type:o.DUPLICATE_FRAME,index:e}),i.dispatchChangeCurrentFrame=e=>({type:o.CHANGE_CURRENT_FRAME,index:e}),i.dispatchMoveFrame=(e,t)=>({type:o.MOVE_FRAME,oldIndex:e,newIndex:t}),i.dispatchChangeInterval=e=>({type:o.CHANGE_INTERVAL,newInterval:e}),i.dispatchChangePreviewAnimating=e=>({type:o.CHANGE_PREVIEW_ANIMATING,animating:e}),i.dispatchToggleOnionSkinEnabled=()=>({type:o.TOGGLE_ONION_SKIN_ENABLED}),i.dispatchChangeOverlayEnabled=e=>({type:o.CHANGE_OVERLAY_ENABLED,enabled:e}),i.dispatchChangeZoom=e=>({type:o.CHANGE_CANVAS_ZOOM,zoom:e}),i.dispatchShowAlert=(e,t,i)=>({type:o.SHOW_ALERT,title:e,text:t,options:i}),i.dispatchHideAlert=()=>({type:o.HIDE_ALERT}),i.dispatchSwapBackgroundForeground=()=>({type:o.SWAP_FOREGROUND_BACKGROUND}),i.dispatchChangeBackgroundColor=e=>({type:o.CHANGE_BACKGROUND_COLOR,backgroundColor:e}),i.dispatchSetInitialState=(e,t)=>({type:o.SET_INITIAL_STATE,state:e,past:t}),i.dispatchChangeTilePaletteCategory=e=>({type:o.CHANGE_TILE_PALETTE_CATEGORY,category:e}),i.dispatchChangeTilePalettePage=e=>({type:o.CHANGE_TILE_PALETTE_PAGE,page:e}),i.dispatchChangeDrawingMode=e=>({type:o.CHANGE_DRAWING_MODE,drawingMode:e}),i.dispatchCreateNewTile=(e,t,i,n)=>({type:o.CREATE_NEW_TILE,tile:e,foreground:t,background:i,qualifiedName:n}),i.dispatchSetGalleryOpen=e=>({type:o.SET_GALLERY_OPEN,open:e}),i.dispatchOpenTileEditor=(e,t)=>({type:o.OPEN_TILE_EDITOR,index:e,id:t}),i.dispatchCloseTileEditor=(e,t)=>({type:o.CLOSE_TILE_EDITOR,result:e,index:t}),i.dispatchDeleteTile=(e,t)=>({type:o.DELETE_TILE,id:t,index:e}),i.dispatchDisableResize=()=>({type:o.DISABLE_RESIZE}),i.dispatchChangeAssetName=e=>({type:o.CHANGE_ASSET_NAME,name:e}),i.dispatchOpenAsset=(e,t,i)=>({type:o.OPEN_ASSET,asset:e,keepPast:t,gallery:i});i.dispatchSetFrames=(e,t)=>({type:o.SET_FRAMES,frames:e,currentFrame:t})},{"./types":171}],171:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.OPEN_ASSET=i.CHANGE_ASSET_NAME=i.DISABLE_RESIZE=i.DELETE_TILE=i.CLOSE_TILE_EDITOR=i.OPEN_TILE_EDITOR=i.CREATE_NEW_TILE=i.CHANGE_DRAWING_MODE=i.CHANGE_TILE_PALETTE_CATEGORY=i.CHANGE_TILE_PALETTE_PAGE=i.CHANGE_BACKGROUND_COLOR=i.SWAP_FOREGROUND_BACKGROUND=i.HIDE_ALERT=i.SHOW_ALERT=i.CHANGE_CANVAS_ZOOM=i.CHANGE_OVERLAY_ENABLED=i.TOGGLE_ONION_SKIN_ENABLED=i.CHANGE_PREVIEW_ANIMATING=i.CHANGE_INTERVAL=i.CHANGE_CURRENT_FRAME=i.MOVE_FRAME=i.DUPLICATE_FRAME=i.DELETE_FRAME=i.NEW_FRAME=i.SET_GALLERY_OPEN=i.TOGGLE_ASPECT_RATIO=i.REDO_IMAGE_EDIT=i.UNDO_IMAGE_EDIT=i.IMAGE_EDIT=i.CHANGE_CURSOR_LOCATION=i.CHANGE_KEY_MODIFIERS=i.CHANGE_IMAGE_DIMENSIONS=i.CHANGE_SELECTED_COLOR=i.CHANGE_CURSOR_SIZE=i.CHANGE_IMAGE_TOOL=i.SET_FRAMES=i.SET_INITIAL_STATE=void 0,i.SET_INITIAL_STATE="SET_INITIAL_STATE",i.SET_FRAMES="SET_FRAMES",i.CHANGE_IMAGE_TOOL="CHANGE_IMAGE_TOOL",i.CHANGE_CURSOR_SIZE="CHANGE_CURSOR_SIZE",i.CHANGE_SELECTED_COLOR="CHANGE_SELECTED_COLOR",i.CHANGE_IMAGE_DIMENSIONS="CHANGE_IMAGE_DIMENSIONS",i.CHANGE_KEY_MODIFIERS="CHANGE_KEY_MODIFIERS",i.CHANGE_CURSOR_LOCATION="CHANGE_CURSOR_LOCATION",i.IMAGE_EDIT="IMAGE_EDIT",i.UNDO_IMAGE_EDIT="UNDO_IMAGE_EDIT",i.REDO_IMAGE_EDIT="REDO_IMAGE_EDIT",i.TOGGLE_ASPECT_RATIO="TOGGLE_ASPECT_RATIO",i.SET_GALLERY_OPEN="SET_GALLERY_OPEN",i.NEW_FRAME="NEW_FRAME",i.DELETE_FRAME="DELETE_FRAME",i.DUPLICATE_FRAME="DUPLICATE_FRAME",i.MOVE_FRAME="MOVE_FRAME",i.CHANGE_CURRENT_FRAME="CHANGE_CURRENT_FRAME",i.CHANGE_INTERVAL="CHANGE_INTERVAL",i.CHANGE_PREVIEW_ANIMATING="CHANGE_PREVIEW_ANIMATING",i.TOGGLE_ONION_SKIN_ENABLED="TOGGLE_ONION_SKIN_ENABLED",i.CHANGE_OVERLAY_ENABLED="CHANGE_OVERLAY_ENABLED",i.CHANGE_CANVAS_ZOOM="CHANGE_CANVAS_ZOOM",i.SHOW_ALERT="SHOW_ALERT",i.HIDE_ALERT="HIDE_ALERT",i.SWAP_FOREGROUND_BACKGROUND="SWAP_FOREGROUND_BACKGROUND",i.CHANGE_BACKGROUND_COLOR="CHANGE_BACKGROUND_COLOR",i.CHANGE_TILE_PALETTE_PAGE="CHANGE_TILE_PALETTE_PAGE",i.CHANGE_TILE_PALETTE_CATEGORY="CHANGE_TILE_PALETTE_CATEGORY",i.CHANGE_DRAWING_MODE="CHANGE_DRAWING_MODE",i.CREATE_NEW_TILE="CREATE_NEW_TILE",i.OPEN_TILE_EDITOR="OPEN_TILE_EDITOR",i.CLOSE_TILE_EDITOR="CLOSE_TILE_EDITOR",i.DELETE_TILE="DELETE_TILE",i.DISABLE_RESIZE="DISABLE_RESIZE",i.CHANGE_ASSET_NAME="CHANGE_ASSET_NAME",i.OPEN_ASSET="OPEN_ASSET"},{}],172:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.moveFrame=i.advanceFrame=i.replaceColor=i.outline=i.rotateAllFrames=i.rotate=i.flipAllFrames=i.flip=i.setStore=i.areShortcutsEnabled=i.releaseShortcutLock=i.obtainShortcutLock=i.removeKeyListener=i.addKeyListener=void 0;let n=e("./store/imageReducer"),p=e("./actions/dispatch"),o=e("./store/imageStore"),g=e("./toolDefinitions"),f=o.mainStore,r=[];function s(){return!r.length}function a(e){var t=e.ctrlKey||e.metaKey;"Undo"===e.key||t&&"z"===e.key&&!e.shiftKey?(m((0,p.dispatchUndoImageEdit)()),e.preventDefault(),e.stopPropagation()):("Redo"===e.key||t&&"y"===e.key||t&&"Z"===e.key&&e.shiftKey)&&(m((0,p.dispatchRedoImageEdit)()),e.preventDefault(),e.stopPropagation())}function l(e){"Backspace"!==e.key&&"Delete"!==e.key||(c(e),e.stopPropagation())}function c(e){if(s())if(e.shiftKey&&/^(?:Digit[1-9])|(?:Key[A-F])$/.test(e.code))0==e.code.indexOf("Digit")?E(parseInt(e.code.substring(5))):E(parseInt(e.code.substring(3),16));else{switch(e.key){case"e":d(n.ImageEditorTool.Erase);break;case"q":d(n.ImageEditorTool.Pan);break;case"b":case"p":d(n.ImageEditorTool.Paint);break;case"g":d(n.ImageEditorTool.Fill);break;case"m":d(n.ImageEditorTool.Marquee);break;case"u":d(n.ImageEditorTool.Rect);break;case"l":d(n.ImageEditorTool.Line);break;case"c":d(n.ImageEditorTool.Circle);break;case"-":case"_":h(-1);break;case"=":case"+":h(1);break;case"x":m((0,p.dispatchSwapBackgroundForeground)());break;case"h":_(!1);break;case"v":_(!0);break;case"H":y(!1);break;case"V":y(!0);break;case"[":v(!1);break;case"]":v(!0);break;case"{":T(!1);break;case"}":T(!0);break;case">":b(!0);break;case"<":b(!1);break;case".":C(!0);break;case",":C(!1);break;case"PageDown":I(!0,e.shiftKey);break;case"PageUp":I(!1,e.shiftKey);break;case"r":k();break;case"R":{let e=f.getState(),t=e.editor.backgroundColor,i=e.editor.selectedColor;t!==i&&w(k,e=>(0,g.replaceColorEdit)(e,t,i))}break;case"ArrowLeft":S(-1,0,e.shiftKey);break;case"ArrowRight":S(1,0,e.shiftKey);break;case"ArrowUp":S(0,-1,e.shiftKey);break;case"ArrowDown":S(0,1,e.shiftKey);break;case"Backspace":case"Delete":!function e(t=!1){var i;let[n]=u();if(null==(i=n.floating)||!i.image)return;let o=e=>(e.floating=null,e);t?w(()=>e(),o):m((0,p.dispatchImageEdit)(o(n).toImageState()))}(e.shiftKey)}var t;!f.getState().editor.isTilemap&&/^Digit\d$/.test(e.code)&&0<=(t=+e.code.slice(-1)+(e.shiftKey?9:0))&&t<16&&(t=t,m((0,p.dispatchChangeSelectedColor)(t)))}}function u(){var e,t=f.getState();return t.editor.isTilemap?(e=t.store.present,[(0,g.getEditState)(e.tilemap,!0,t.editor.drawingMode),"tilemap"]):(e=t.store.present,[(0,g.getEditState)(e.frames[e.currentFrame],!1,t.editor.drawingMode),1<e.frames.length?"animation":"image"])}function d(e){m((0,p.dispatchChangeImageTool)(e))}function h(e){m((0,p.dispatchChangeZoom)(e))}function m(e){f.dispatch(e)}function b(e){let t;var i=f.getState().editor.cursorSize;switch(i){case 1:t=e?3:1;break;case 3:t=e?5:1;break;case 5:t=e?5:3}i!==t&&m((0,p.dispatchChangeCursorSize)(t))}function _(e){var[t,i]=u(),t=(0,g.flipEdit)(t,e,"tilemap"===i);m((0,p.dispatchImageEdit)(t.toImageState()))}function y(t){w(()=>_(t),e=>(0,g.flipEdit)(e,t,!1))}function v(e){var[t,i]=u(),t=(0,g.rotateEdit)(t,e,"tilemap"===i,"animation"===i);m((0,p.dispatchImageEdit)(t.toImageState()))}function T(t){w(()=>v(t),e=>(0,g.rotateEdit)(e,t,!1,!0))}function E(e){var[t,i]=u();"tilemap"!==i&&(i=(0,g.outlineEdit)(t,e),m((0,p.dispatchImageEdit)(i.toImageState())))}function k(){var e,t=f.getState(),i=t.editor.backgroundColor,t=t.editor.selectedColor;i!==t&&([e]=u(),e=(0,g.replaceColorEdit)(e,i,t),m((0,p.dispatchImageEdit)(e.toImageState())))}function C(t){var i=f.getState();if(!i.editor.isTilemap){i=i.store.present;if(!(i.frames.length<=1)){let e;e=t?(i.currentFrame+1)%i.frames.length:(i.currentFrame+i.frames.length-1)%i.frames.length,m((0,p.dispatchChangeCurrentFrame)(e))}}}function I(t,i=!1){var n=f.getState();if(!n.editor.isTilemap){n=n.store.present;if(!(n.frames.length<=1)){let e;e=t?(n.currentFrame+1)%n.frames.length:(n.currentFrame+n.frames.length-1)%n.frames.length;var o=n.frames.slice();i?t?o.unshift(o.pop()):o.push(o.shift()):(i=o[n.currentFrame],o.splice(n.currentFrame,1),o.splice(e,0,i)),m((0,p.dispatchSetFrames)(o,e))}}}function w(e,t){var i,n=f.getState();if(n.editor.isTilemap)e();else{n=n.store.present;if(1===n.frames.length)e();else{var o,e=n.frames[n.currentFrame],r=!!e.floating,s=null==(i=e.floating)?void 0:i.bitmap.width,a=null==(i=e.floating)?void 0:i.bitmap.height,l=e.layerOffsetX,c=e.layerOffsetY,u=[];for(o of n.frames){var d=(0,g.getEditState)(o,!1),h=(r?null!=(h=d.floating)&&h.image?d.layerOffsetX===l&&d.layerOffsetY===c&&d.floating.image.width===s&&d.floating.image.height===a||(d.mergeFloatingLayer(),d.copyToLayer(l,c,s,a,!0)):d.copyToLayer(l,c,s,a,!0):d.mergeFloatingLayer(),t(d));u.push(h.toImageState())}m((0,p.dispatchSetFrames)(u,n.currentFrame))}}}function S(t,i,e=!1){var n,[o]=u();null!=(n=o.floating)&&n.image&&(n=e=>(e.layerOffsetX+=t,e.layerOffsetY+=i,e),e?w(()=>S(t,i),n):m((0,p.dispatchImageEdit)(n(o).toImageState())))}i.addKeyListener=function(){r=[],document.addEventListener("keydown",c),document.addEventListener("keydown",a,!0),document.addEventListener("keydown",l,!0)},i.removeKeyListener=function(){document.removeEventListener("keydown",c),document.removeEventListener("keydown",a,!0),document.removeEventListener("keydown",l,!0)},i.obtainShortcutLock=function(){let e=0;for(;!e;)e=Math.random()*Number.MAX_SAFE_INTEGER;return r.push(e),e},i.releaseShortcutLock=function(e){-1!==(e=r.indexOf(e))&&r.splice(e,1)},i.areShortcutsEnabled=s,i.setStore=function(e){f=e||o.mainStore},i.flip=_,i.flipAllFrames=y,i.rotate=v,i.rotateAllFrames=T,i.outline=E,i.replaceColor=function(e,t){var[i,,]=u(),i=(0,g.replaceColorEdit)(i,e,t);m((0,p.dispatchImageEdit)(i.toImageState()))},i.advanceFrame=C,i.moveFrame=I},{"./actions/dispatch":170,"./store/imageReducer":174,"./store/imageStore":175,"./toolDefinitions":178}],173:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Palette=void 0;let o=e("react/jsx-runtime");var n=e("react"),r=e("react-redux"),s=e("../actions/dispatch");let a=e("../../../../../react-common/components/controls/Button"),l=e("../../../../../react-common/components/util");class c extends n.Component{constructor(){super(...arguments),this.preventContextMenu=e=>e.preventDefault()}render(){var{colors:e,selected:t,backgroundColor:i,dispatchSwapBackgroundForeground:n}=this.props;return(0,o.jsxs)("div",{children:[(0,o.jsxs)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",className:"image-editor-colors",viewBox:"0 0 23 15",onClick:n},{children:[(0,o.jsx)("defs",{children:(0,o.jsxs)("pattern",Object.assign({id:"alpha-background",width:"6",height:"6",patternUnits:"userSpaceOnUse"},{children:[(0,o.jsx)("rect",{x:"0",y:"0",width:"6px",height:"6px",fill:"#aeaeae"}),(0,o.jsx)("rect",{x:"0",y:"0",width:"3px",height:"3px",fill:"#dedede"}),(0,o.jsx)("rect",{x:"3",y:"3",width:"3px",height:"3px",fill:"#dedede"})]}))}),(0,o.jsxs)("g",{children:[(0,o.jsx)("rect",Object.assign({fill:i?e[i]:"url(#alpha-background)",x:6,y:4,width:15,height:10,stroke:"#3c3c3c",strokeWidth:"0.5"},{children:(0,o.jsx)("title",{children:u(i,e[i])})})),(0,o.jsx)("rect",Object.assign({fill:t?e[t]:"url(#alpha-background)",x:2,y:1,width:15,height:10,stroke:"#3c3c3c",strokeWidth:"0.5"},{children:(0,o.jsx)("title",{children:u(t,e[t])})}))]})]})),(0,o.jsx)("div",Object.assign({className:"image-editor-color-buttons",onContextMenu:this.preventContextMenu},{children:this.props.colors.map((e,t)=>(0,o.jsx)(a.Button,{className:(0,l.classList)("image-editor-button",0===t&&"checkerboard"),title:u(t,e),style:0===t?null:{"--preview-color":e},onClick:()=>this.props.dispatchChangeSelectedColor(t),onRightClick:()=>this.props.dispatchChangeBackgroundColor(t)},t))}))]})}}function u(e,t){t=0===e?lf("transparency"):(e=>{switch(null==e?void 0:e.toLowerCase()){case"#ffffff":return lf("white");case"#ff2121":return lf("red");case"#ff93c4":return lf("pink");case"#ff8135":return lf("orange");case"#fff609":return lf("yellow");case"#249ca3":return lf("teal");case"#78dc52":return lf("green");case"#003fad":return lf("blue");case"#87f2ff":return lf("light blue");case"#8e2ec4":return lf("purple");case"#a4839f":return lf("light purple");case"#5c406c":return lf("dark purple");case"#e5cdc4":return lf("tan");case"#91463d":return lf("brown");case"#000000":return lf("black");default:return}})(t);return t?lf("Color {0} ({1})",e,t):lf("Color {0}",e)}e={dispatchChangeSelectedColor:s.dispatchChangeSelectedColor,dispatchChangeBackgroundColor:s.dispatchChangeBackgroundColor,dispatchSwapBackgroundForeground:s.dispatchSwapBackgroundForeground};i.Palette=(0,r.connect)(function({store:{present:e},editor:t},i){return e?{selected:t.selectedColor,backgroundColor:t.backgroundColor,colors:e.colors}:{}},e)(c)},{"../../../../../react-common/components/controls/Button":143,"../../../../../react-common/components/util":154,"../actions/dispatch":170,react:268,"react-redux":251,"react/jsx-runtime":269}],174:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.setTelemetryFunction=i.TileDrawingMode=i.TileCategory=i.KeyModifiers=i.CursorSize=i.ImageEditorTool=void 0;let u=e("../../../assets"),d=e("../actions/types");(e=r=i.ImageEditorTool||(i.ImageEditorTool={}))[e.Paint=0]="Paint",e[e.Fill=1]="Fill",e[e.Line=2]="Line",e[e.Erase=3]="Erase",e[e.Circle=4]="Circle",e[e.Rect=5]="Rect",e[e.ColorSelect=6]="ColorSelect",e[e.Marquee=7]="Marquee",e[e.Pan=8]="Pan",(e=i.CursorSize||(i.CursorSize={}))[e.One=1]="One",e[e.Three=3]="Three",e[e.Five=5]="Five",(e=i.KeyModifiers||(i.KeyModifiers={}))[e.Alt=1]="Alt",e[e.Shift=2]="Shift",(e=h=i.TileCategory||(i.TileCategory={}))[e.Forest=0]="Forest",e[e.Aquatic=1]="Aquatic",e[e.Dungeon=2]="Dungeon",e[e.Misc=3]="Misc",(e=p=i.TileDrawingMode||(i.TileDrawingMode={})).Default="default";var r,h,p,e={kind:"Animation",visible:!0,colors:["#000000","#ffffff","#ff2121","#ff93c4","#ff8135","#fff609","#249ca3","#78dc52","#003fad","#87f2ff","#8e2ec4","#a4839f","#5c406c","#e5cdc4","#91463d","#000000"],aspectRatioLocked:!(e.Wall="wall"),currentFrame:0,frames:[b(16,16)],interval:200};let g={store:{present:e,past:[],future:[]},editor:{selectedColor:3,tool:r.Paint,cursorSize:1,backgroundColor:1,previewAnimating:!1,onionSkinEnabled:!1,overlayEnabled:!0,tilesetRevision:0,isTilemap:!1}};let f=(e,t,i)=>{let n;switch(t.type){case d.CHANGE_PREVIEW_ANIMATING:return y("preview-animate-"+(t.animating?"on":"off")),Object.assign(Object.assign({},e),{previewAnimating:t.animating});case d.CHANGE_CANVAS_ZOOM:return(0<t.zoom||t.zoom<0)&&y("zoom-"+(0<t.zoom?"in":"out")),Object.assign(Object.assign({},e),{zoomDelta:t.zoom});case d.CHANGE_IMAGE_TOOL:return y("change-tool-"+r[t.tool]),Object.assign(Object.assign({},e),{tool:t.tool});case d.CHANGE_CURSOR_SIZE:return y("change-cursor-size-"+t.cursorSize),Object.assign(Object.assign({},e),{cursorSize:t.cursorSize});case d.CHANGE_SELECTED_COLOR:return y("foreground-color-"+t.selectedColor),Object.assign(Object.assign({},e),{selectedColor:t.selectedColor,tool:e.tool===r.Erase?r.Paint:e.tool});case d.CHANGE_CURSOR_LOCATION:return Object.assign(Object.assign({},e),{cursorLocation:t.cursorLocation});case d.CHANGE_BACKGROUND_COLOR:return y("background-color-"+t.backgroundColor),Object.assign(Object.assign({},e),{backgroundColor:t.backgroundColor});case d.SWAP_FOREGROUND_BACKGROUND:return y("swap-foreground-background"),Object.assign(Object.assign({},e),{backgroundColor:e.selectedColor,selectedColor:e.backgroundColor});case d.TOGGLE_ONION_SKIN_ENABLED:return y("toggle-onion-skin"),Object.assign(Object.assign({},e),{onionSkinEnabled:!e.onionSkinEnabled});case d.CHANGE_TILE_PALETTE_CATEGORY:return y("change-tile-category-"+h[t.category]),Object.assign(Object.assign({},e),{tilemapPalette:Object.assign(Object.assign({},e.tilemapPalette),{category:t.category,page:0})});case d.CHANGE_TILE_PALETTE_PAGE:return y("change-tile-page"),Object.assign(Object.assign({},e),{tilemapPalette:Object.assign(Object.assign({},e.tilemapPalette),{page:t.page})});case d.CHANGE_DRAWING_MODE:return y("change-drawing-mode"),Object.assign(Object.assign({},e),{drawingMode:t.drawingMode||p.Default});case d.CHANGE_OVERLAY_ENABLED:return y("change-overlay-enabled"),Object.assign(Object.assign({},e),{overlayEnabled:t.enabled});case d.CREATE_NEW_TILE:return n=e.editedTiles,!t.tile||n&&-1!==n.indexOf(t.tile.id)||(n=(n||[]).concat([t.tile.id])),Object.assign(Object.assign({},e),{editedTiles:n,selectedColor:t.foreground,backgroundColor:t.background});case d.SET_GALLERY_OPEN:return y("set-gallery-open-"+t.open),Object.assign(Object.assign({},e),{tileGalleryOpen:t.open,tilemapPalette:Object.assign(Object.assign({},e.tilemapPalette),{page:0})});case d.DELETE_TILE:return Object.assign(Object.assign({},e),{deletedTiles:(e.deletedTiles||[]).concat([t.id]),selectedColor:t.index===e.selectedColor?0:e.selectedColor,backgroundColor:t.index===e.backgroundColor?0:e.backgroundColor,tilesetRevision:e.tilesetRevision+1});case d.OPEN_TILE_EDITOR:var o=t.index?"edit":"new";return y("open-tile-editor-"+o),Object.assign(Object.assign({},e),{editingTile:{type:o,tilesetIndex:t.index}});case d.CLOSE_TILE_EDITOR:return n=e.editedTiles,!t.result||n&&-1!==n.indexOf(t.result.id)||(n=(n||[]).concat([t.result.id])),Object.assign(Object.assign({},e),{editedTiles:n,selectedColor:t.index||i.present.tileset.tiles.length,editingTile:void 0,tilesetRevision:e.tilesetRevision+1});case d.SHOW_ALERT:return y("show-alert"),Object.assign(Object.assign({},e),{alert:{title:t.title,text:t.text,options:t.options}});case d.HIDE_ALERT:return y("hide-alert"),Object.assign(Object.assign({},e),{alert:null});case d.DISABLE_RESIZE:return Object.assign(Object.assign({},e),{resizeDisabled:!0})}return e};function m(e,i,n){return Object.assign(Object.assign({},e),{tiles:e.tiles.map((e,t)=>t===i?n:e)})}function b(e,t){return{bitmap:new pxt.sprite.Bitmap(e,t).data()}}function _(e){let t,i,n;return e.floating&&(e.floating.bitmap&&(i=pxt.sprite.Bitmap.fromData(e.floating.bitmap).copy().data()),e.floating.overlayLayers&&(n=e.floating.overlayLayers.map(e=>pxt.sprite.Bitmap.fromData(e).copy().data())),t={bitmap:i,overlayLayers:n}),Object.assign(Object.assign({},e),{bitmap:pxt.sprite.Bitmap.fromData(e.bitmap).copy().data(),overlayLayers:e.overlayLayers&&e.overlayLayers.map(e=>pxt.sprite.Bitmap.fromData(e).copy().data()),floating:t})}let n;function y(e){n&&n(e)}function v(i,e){var n=e.copy();for(let t=0;t<n.width;t++)for(let e=0;e<n.height;e++){var o=n.get(t,e);o===i?n.set(t,e,0):i<o&&n.set(t,e,o-1)}return n}function T(e,t,i){return pxt.sprite.Bitmap.fromData(e).resize(t,i).data()}function E(e,t,i){return pxt.sprite.Tilemap.fromData(e).resize(t,i).data()}function k(e,t){return!(e.layerOffsetX!==t.layerOffsetX||e.layerOffsetY!==t.layerOffsetY||!!e.floating!=!!t.floating||!pxt.sprite.bitmapEquals(e.bitmap,t.bitmap)||!pxt.U.arrayEquals(e.overlayLayers,t.overlayLayers,pxt.sprite.bitmapEquals)||!(!e.floating||pxt.sprite.bitmapEquals(e.floating.bitmap,t.floating.bitmap)&&pxt.U.arrayEquals(e.floating.overlayLayers,t.floating.overlayLayers,pxt.sprite.bitmapEquals)))}i.setTelemetryFunction=function(e){n=e},i.default=(i=g,n)=>{var o,r;switch(n.type){case d.OPEN_TILE_EDITOR:case d.CHANGE_PREVIEW_ANIMATING:case d.CHANGE_CANVAS_ZOOM:case d.CHANGE_IMAGE_TOOL:case d.CHANGE_CURSOR_SIZE:case d.CHANGE_SELECTED_COLOR:case d.CHANGE_CURSOR_LOCATION:case d.CHANGE_BACKGROUND_COLOR:case d.SWAP_FOREGROUND_BACKGROUND:case d.TOGGLE_ONION_SKIN_ENABLED:case d.CHANGE_OVERLAY_ENABLED:case d.CHANGE_TILE_PALETTE_PAGE:case d.CHANGE_TILE_PALETTE_CATEGORY:case d.CHANGE_DRAWING_MODE:case d.SET_GALLERY_OPEN:case d.SHOW_ALERT:case d.HIDE_ALERT:case d.DISABLE_RESIZE:return Object.assign(Object.assign({},i),{editor:f(i.editor,n,i.store)});case d.SET_INITIAL_STATE:var s=n.state;return Object.assign(Object.assign({},i),{editor:Object.assign(Object.assign({},g.editor),{selectedColor:s.selectedColor,backgroundColor:s.backgroundColor,tilemapPalette:s.tilemapPalette,tileGalleryOpen:s.tileGalleryOpen,tileGallery:s.tileGallery,isTilemap:s.isTilemap,referencedTiles:i.editor.referencedTiles}),store:Object.assign(Object.assign({},i.store),{past:n.past||i.store.past,future:n.past?[]:i.store.future})});case d.OPEN_ASSET:var s=n.asset,a=n.gallery||(n.keepPast?i.editor.tileGallery:[]);let e=-1;if("tilemap"===s.type){var l=n.asset.data;if(pxt.sprite.isEmptyTilemap(l)){var l=l.tileset.tiles||[];let t=null==(c=a.find(e=>-1!==e.tags.indexOf("forest")))?void 0:c.qualifiedName;var c=(0,u.lookupAsset)("tile",t);c&&!l.find(e=>e.id===t)&&l.push(c),e=l.indexOf(c)}}return Object.assign(Object.assign({},i),{editor:"tilemap"===s.type?{selectedColor:e,backgroundColor:-1,isTilemap:!0,tilemapPalette:{category:h.Forest,page:0},drawingMode:p.Default,overlayEnabled:!0,tileGallery:a,tileGalleryOpen:!!a,referencedTiles:s.data.projectReferences,previewAnimating:!1,onionSkinEnabled:!1,tilesetRevision:0,tool:(n.keepPast?i:g).editor.tool,cursorSize:(n.keepPast?i:g).editor.cursorSize,editedTiles:n.keepPast?i.editor.editedTiles:void 0,deletedTiles:n.keepPast?i.editor.deletedTiles:void 0}:{isTilemap:!1,tilesetRevision:0,selectedColor:(n.keepPast?i:g).editor.selectedColor,backgroundColor:(n.keepPast?i:g).editor.backgroundColor,previewAnimating:(n.keepPast?i:g).editor.previewAnimating,tool:(n.keepPast?i:g).editor.tool,onionSkinEnabled:(n.keepPast?i:g).editor.onionSkinEnabled,cursorSize:(n.keepPast?i:g).editor.cursorSize,resizeDisabled:(n.keepPast?i:g).editor.resizeDisabled},store:Object.assign(Object.assign({},i.store),{past:n.keepPast?i.store.past:[],present:(l=a,"tilemap"===(c=n.asset).type?((e,t)=>({kind:"Tilemap",asset:e,colors:pxt.appTarget.runtime.palette.slice(),aspectRatioLocked:!1,tilemap:{bitmap:e.data.tilemap.data(),overlayLayers:[e.data.layers]},tileset:((e,t)=>{for(var i of e.tiles)if(!i.jresData&&!i.isProjectTile)for(var n of t)if(n.qualifiedName===i.id){i.bitmap=n.bitmap;break}return e})(e.data.tileset,t),nextId:e.data.nextId}))(c,l):(e=>({kind:"Animation",asset:e,visible:!0,colors:pxt.appTarget.runtime.palette.slice(),aspectRatioLocked:"tile"===e.type,currentFrame:0,frames:"animation"===e.type?e.frames.map(e=>({bitmap:e})):[{bitmap:e.bitmap}],interval:"animation"===e.type?e.interval:100}))(c)),future:[]})});case d.CHANGE_ASSET_NAME:return y("change-asset-name"),Object.assign(Object.assign({},i),{store:{past:[...i.store.past,i.store.present],present:Object.assign(Object.assign({},i.store.present),{asset:Object.assign(Object.assign({},i.store.present.asset),{meta:Object.assign(Object.assign({},i.store.present.asset.meta||{}),{displayName:n.name})})}),future:[]}});case d.UNDO_IMAGE_EDIT:return i.store.past.length?(y("undo"),Object.assign(Object.assign({},i),{store:Object.assign(Object.assign({},i.store),{past:i.store.past.slice(0,i.store.past.length-1),present:i.store.past[i.store.past.length-1],future:[...i.store.future,i.store.present]}),editor:Object.assign(Object.assign({},i.editor),{tilesetRevision:i.editor.tilesetRevision+1})})):i;case d.REDO_IMAGE_EDIT:return i.store.future.length?(y("redo"),Object.assign(Object.assign({},i),{store:Object.assign(Object.assign({},i.store),{past:[...i.store.past,i.store.present],present:i.store.future[i.store.future.length-1],future:i.store.future.slice(0,i.store.future.length-1)}),editor:Object.assign(Object.assign({},i.editor),{tilesetRevision:i.editor.tilesetRevision+1})})):i;default:s=i.store.present,a=(i.editor.isTilemap?(t,i)=>{switch(i.type){case d.TOGGLE_ASPECT_RATIO:y(`toggle-aspect-ratio-lock`);return Object.assign(Object.assign({},t),{aspectRatioLocked:!t.aspectRatioLocked});case d.CHANGE_IMAGE_DIMENSIONS:y(`change-dimensions`);const[n,o]=i.imageDimensions;return Object.assign(Object.assign({},t),{tilemap:Object.assign(Object.assign({},t.tilemap),{bitmap:E(t.tilemap.bitmap,n,o),overlayLayers:t.tilemap.overlayLayers&&t.tilemap.overlayLayers.map(e=>T(e,n,o))})});case d.CREATE_NEW_TILE:const r=!i.qualifiedName;y(!r?`used-tile-${i.qualifiedName}`:`new-tile`);let e;if(r){e=i.tile;e.isProjectTile=true}else e=(0,u.lookupAsset)("tile",i.qualifiedName);return Object.assign(Object.assign({},t),{tileset:Object.assign(Object.assign({},t.tileset),{tiles:t.tileset.tiles.concat([e])}),nextId:r?t.nextId+1:t.nextId});case d.CLOSE_TILE_EDITOR:y("close-tile-editor");if(!i.result)return t;else if(i.index)return Object.assign(Object.assign({},t),{tileset:m(t.tileset,i.index,i.result)});else return Object.assign(Object.assign({},t),{tileset:Object.assign(Object.assign({},t.tileset),{tiles:t.tileset.tiles.concat([i.result])}),nextId:t.nextId+1});case d.DELETE_TILE:y("delete-tile");const s=t.tileset.tiles.slice();s.splice(i.index,1);return Object.assign(Object.assign({},t),{tilemap:Object.assign(Object.assign({},t.tilemap),{bitmap:v(i.index,pxt.sprite.Tilemap.fromData(t.tilemap.bitmap)).data()}),tileset:Object.assign(Object.assign({},t.tileset),{tiles:s})});case d.IMAGE_EDIT:y(`image-edit`);return Object.assign(Object.assign({},t),{tilemap:i.newState});default:return t}}:(i,n)=>{switch(n.type){case d.TOGGLE_ASPECT_RATIO:y(`toggle-aspect-ratio-lock`);return Object.assign(Object.assign({},i),{aspectRatioLocked:!i.aspectRatioLocked});case d.CHANGE_CURRENT_FRAME:y(`change-frame`);return Object.assign(Object.assign({},i),{currentFrame:n.index});case d.CHANGE_INTERVAL:y(`change-interval`);return Object.assign(Object.assign({},i),{interval:n.newInterval});case d.CHANGE_IMAGE_DIMENSIONS:y(`change-dimensions`);const[o,r]=n.imageDimensions;return Object.assign(Object.assign({},i),{frames:i.frames.map((e,t)=>Object.assign(Object.assign({},e),{bitmap:pxt.sprite.Bitmap.fromData(e.bitmap).resize(o,r).data()}))});case d.IMAGE_EDIT:y(`image-edit`);return Object.assign(Object.assign({},i),{frames:i.frames.map((e,t)=>t===i.currentFrame?n.newState:e)});case d.DELETE_FRAME:if(i.frames.length===1)return i;y(`delete-frame`);const t=i.frames.slice();t.splice(n.index,1);let e=i.currentFrame;if(i.currentFrame>=n.index&&i.currentFrame>0)e--;return Object.assign(Object.assign({},i),{currentFrame:e,frames:t});case d.DUPLICATE_FRAME:y(`duplicate-frame`);const s=i.frames.slice();s.splice(n.index,0,_(i.frames[n.index]));return Object.assign(Object.assign({},i),{frames:s,currentFrame:n.index+1});case d.NEW_FRAME:y(`new-frame`);return Object.assign(Object.assign({},i),{frames:[...i.frames,b(i.frames[0].bitmap.width,i.frames[0].bitmap.height)],currentFrame:i.frames.length});case d.MOVE_FRAME:if(n.newIndex<0||n.newIndex>=i.frames.length||n.newIndex<0||n.newIndex>=i.frames.length)return i;y(`move-frame`);const a=i.frames.slice();const l=a.splice(n.oldIndex,1)[0];a.splice(n.newIndex,0,l);return Object.assign(Object.assign({},i),{frames:a,currentFrame:n.oldIndex===i.currentFrame?n.newIndex:i.currentFrame});case d.SET_FRAMES:y(`set-frames`);return Object.assign(Object.assign({},i),{frames:n.frames,currentFrame:n.currentFrame||0});default:return i}})(i.store.present,n);let t=s.kind!==a.kind;s=(t=t||("Animation"===s.kind?(r=a,!((o=s).visible===r.visible&&o.aspectRatioLocked===r.aspectRatioLocked&&o.currentFrame===r.currentFrame&&o.interval===r.interval&&pxt.assetEquals(o.asset,r.asset)&&pxt.U.arrayEquals(o.colors,r.colors,(e,t)=>e===t)&&pxt.U.arrayEquals(o.frames,r.frames,(e,t)=>k(e,t)))):(o=a,!((r=s).aspectRatioLocked===o.aspectRatioLocked&&r.nextId===o.nextId&&k(r.tilemap,o.tilemap)&&pxt.assetEquals(r.asset,o.asset)&&pxt.U.arrayEquals(r.colors,o.colors,(e,t)=>e===t)&&pxt.sprite.tilesetEquals(r.tileset,o.tileset)))))?Object.assign(Object.assign({},i.store),{past:[...i.store.past,s],present:a,future:[]}):i.store;return Object.assign(Object.assign({},i),{editor:f(i.editor,n,i.store),store:s})}}},{"../../../assets":157,"../actions/types":171}],175:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.mainStore=i.tileEditorStore=void 0;var n=e("redux"),e=e("./imageReducer"),o=(0,n.createStore)(e.default);i.default=o,i.tileEditorStore=(0,n.createStore)(e.default),i.mainStore=o},{"./imageReducer":174,redux:270}],176:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Minimap=void 0;let n=e("react/jsx-runtime");var o=e("react"),r=e("react-redux");let u=e("../ImageEditor"),d=pxt.BrowserUtils.isEdge()?25:1;class s extends o.Component{constructor(){super(...arguments),this.tileColors=[]}componentDidMount(){this.canvas=this.refs["minimap-canvas"],this.redrawCanvas()}componentDidUpdate(){this.redrawCanvas()}render(){return(0,n.jsx)("div",Object.assign({className:"minimap-outer"},{children:(0,n.jsx)("canvas",{ref:"minimap-canvas",className:"paint-surface"})}))}redrawCanvas(){var{tilemap:e,lightMode:i}=this.props,{bitmap:e,floating:t,layerOffsetX:n,layerOffsetY:o}=e,r=this.canvas.getContext("2d"),s=pxt.sprite.Tilemap.fromData(e),a=t&&t.bitmap?pxt.sprite.Tilemap.fromData(t.bitmap):null;this.canvas.width=s.width*d,this.canvas.height=s.height*d,this.tileColors=[];for(let t=0;t<s.width;t++)for(let e=0;e<s.height;e++){var l=a?a.get(t-n,e-o):null,c=s.get(t,e);l?(r.fillStyle=this.getColor(l),r.fillRect(t*d,e*d,d,d)):c?(r.fillStyle=this.getColor(c),r.fillRect(t*d,e*d,d,d)):i?(r.fillStyle=u.LIGHT_MODE_TRANSPARENT,r.fillRect(t*d,e*d,d,d)):r.clearRect(t*d,e*d,d,d)}}getColor(e){if(!this.tileColors[e]){var{tileset:t,colors:i}=this.props;if(e>=t.tiles.length)return"#ffffff";t=pxt.sprite.Bitmap.fromData(t.tiles[e].bitmap);this.tileColors[e]=pxt.sprite.computeAverageColor(t,i)}return this.tileColors[e]}}i.Minimap=(0,r.connect)(function({store:{present:e}},t){return e?{tilemap:e.tilemap,tileset:e.tileset,colors:e.colors}:{}},{})(s)},{"../ImageEditor":163,react:268,"react-redux":251,"react/jsx-runtime":269}],177:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.TilePalette=void 0;let f=e("react/jsx-runtime"),o=e("react");var n=e("react-redux");let m=e("../store/imageReducer");var r=e("../actions/dispatch");let b=e("../TimelineFrame"),_=e("../Pivot"),s=e("../../../assets"),y=e("../../../../../react-common/components/controls/CarouselNav"),v=e("../../../../../react-common/components/controls/Dropdown"),T=e("../../../../../react-common/components/controls/Button"),E=e("../../../../../react-common/components/util");pxt.BrowserUtils.isEdge();let a=[{id:"forest",text:lf("Forest"),tiles:[]},{id:"aquatic",text:lf("Aquatic"),tiles:[]},{id:"dungeon",text:lf("Dungeon"),tiles:[]},{id:"misc",text:lf("Miscellaneous"),tiles:[]}],k=[{id:"custom",text:lf("My Tiles")},{id:"gallery",text:lf("Gallery")}],C=new pxt.sprite.Bitmap(16,16);class l extends o.Component{constructor(e){super(e),this.dropdownHandler=t=>{this.props.dispatchChangeTilePaletteCategory(this.categories.filter(e=>!!e.tiles.length).findIndex(e=>e.id===t))},this.pivotHandler=(e,t)=>{this.props.dispatchSetGalleryOpen(1===t)},this.pageHandler=e=>{this.props.dispatchChangeTilePalettePage(e)},this.tileCreateHandler=()=>{this.props.dispatchOpenTileEditor()},this.tileEditHandler=()=>{var{tileset:e,selected:t,dispatchOpenTileEditor:i}=this.props,e=e.tiles[t];null!=e&&e.isProjectTile&&0!==t&&i(t,e.id)},this.tileDuplicateHandler=()=>{var{tileset:e,selected:t,backgroundColor:i,dispatchCreateNewTile:n}=this.props;e.tiles[t]&&e.tiles[t].isProjectTile&&0!==t&&(t=e.tiles[t],n((0,s.createTile)(t.bitmap,null,null==(n=t.meta)?void 0:n.displayName),e.tiles.length,i))},this.tileDeleteAlertHandler=()=>{var{tileset:e,selected:t,dispatchShowAlert:i,dispatchHideAlert:n,referencedTiles:o}=this.props,e=e.tiles[t];t&&e&&e.isProjectTile&&(o&&-1!==o.indexOf(e.id)?i(lf("Unable to delete"),lf("This tile is used in your game. Remove all blocks using the tile before deleting."),[{label:lf("Cancel"),onClick:n}]):i(lf("Are you sure?"),lf("Deleting this tile will remove it from all other tile maps in your game."),[{label:lf("Yes"),onClick:this.deleteTile},{label:lf("No"),onClick:n}]))},this.deleteTile=()=>{var e=this.props.tileset.tiles[this.props.selected];e&&this.props.dispatchDeleteTile(this.props.selected,e.id)},this.foregroundBackgroundClickHandler=()=>{this.props.drawingMode!=m.TileDrawingMode.Default?this.props.dispatchChangeDrawingMode(m.TileDrawingMode.Default):this.props.dispatchSwapBackgroundForeground()},this.wallClickHandler=()=>{this.props.drawingMode===m.TileDrawingMode.Wall?this.props.dispatchChangeDrawingMode(m.TileDrawingMode.Default):this.props.dispatchChangeDrawingMode(m.TileDrawingMode.Wall)},this.preventContextMenu=e=>e.preventDefault();var i=e.gallery;if(this.refreshGallery(e),i){let t={};for(var n of i){var o=n.tags.find(e=>pxt.Util.startsWith(e,"category-"));o&&(t[o]||(t[o]={id:o,text:pxt.Util.rlf("{id:tilecategory}"+o.substr(9)),tiles:[]}),t[o].tiles.push(n))}this.categories=a.concat(Object.keys(t).map(e=>t[e]))}else this.categories=[]}componentDidMount(){this.updateGalleryTiles()}UNSAFE_componentWillReceiveProps(e){this.props.selected!=e.selected?this.jumpToPageContaining(e.selected):this.props.backgroundColor!=e.backgroundColor&&this.jumpToPageContaining(e.backgroundColor),this.refreshGallery(e)}componentDidUpdate(){this.updateGalleryTiles()}render(){let{colors:i,selected:t,backgroundColor:e,tileset:n,category:o,page:r,drawingMode:s,galleryOpen:a}=this.props;var l=n.tiles[t]?n.tiles[t].bitmap:C.data(),c=n.tiles[e]?n.tiles[e].bitmap:C.data();C.data();this.updateGalleryTiles();let u=Math.ceil(this.categoryTiles.length/16);a||this.categoryTiles.length%16!=0||u++;var d=!a&&(1===u||r===u-1),h=a||!this.renderedTiles.some(e=>!w(e)&&e.index===t),p=4*r*4,p=this.categoryTiles.slice(p,16+p),g=this.categories.filter(e=>!!e.tiles.length).map(e=>({id:e.id,title:e.text,label:e.text}));return(0,f.jsxs)("div",Object.assign({className:"tile-palette"},{children:[(0,f.jsxs)("div",Object.assign({className:"tile-palette-fg-bg"},{children:[(0,f.jsx)("div",Object.assign({className:"tile-palette-swatch fg "+(s==m.TileDrawingMode.Default?"selected":""),onClick:this.foregroundBackgroundClickHandler,role:"button"},{children:(0,f.jsx)(b.TimelineFrame,{frames:[{bitmap:l}],colors:i})})),(0,f.jsxs)("div",Object.assign({className:"tile-palette-swatch bg",onClick:this.foregroundBackgroundClickHandler,role:"button"},{children:[(0,f.jsx)(b.TimelineFrame,{frames:[{bitmap:c}],colors:i}),(0,f.jsx)(T.Button,{className:"image-editor-button toggle",leftIcon:"ms-Icon ms-Icon--ReturnKey",title:lf("Swap the background and foreground colors."),onClick:this.foregroundBackgroundClickHandler})]})),(0,f.jsx)("div",Object.assign({className:"tile-palette-swatch wall "+(s==m.TileDrawingMode.Wall?"selected":""),onClick:this.wallClickHandler,title:lf("Draw walls"),role:"button"},{children:(0,f.jsx)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1000 1000",width:"1000",height:"1000"},{children:(0,f.jsx)("path",{d:"M 968.49289,108.05443 771.30518,3.7581533 183.65231,166.0694 l 2.58963,202.62638 -156.247366,54.4148 0.872799,492.65563 179.544267,81.08212 758.08125,-222.4989 z M 765.6275,42.836761 916.79721,122.02922 412.26526,262.35026 250.08966,187.43643 Z M 934.62189,739.077 234.56171,946.92199 233.81426,554.79578 422.38222,493.25053 423.42046,300.4059 934.62189,157.54989 Z M 204.96854,402.33519 361.49056,473.98651 222.88861,518.46222 75.008408,444.5191 Z"})}))}))]})),(0,f.jsx)(_.Pivot,{options:k,selected:a?1:0,onChange:this.pivotHandler}),(0,f.jsxs)("div",Object.assign({className:"tile-palette-controls-outer"},{children:[a&&(0,f.jsx)(v.Dropdown,{id:"tile-palette-gallery",className:"tile-palette-dropdown",items:g,onItemSelected:this.dropdownHandler,selectedId:g[o].id}),!a&&(0,f.jsxs)("div",Object.assign({className:"tile-palette-controls"},{children:[(0,f.jsx)(T.Button,{className:(0,E.classList)("image-editor-button",!h&&"toggle"),onClick:this.tileEditHandler,leftIcon:"ms-Icon ms-Icon--SingleColumnEdit",title:lf("Edit the selected tile"),disabled:h}),(0,f.jsx)(T.Button,{className:(0,E.classList)("image-editor-button",!h&&"toggle"),onClick:this.tileDuplicateHandler,leftIcon:"ms-Icon ms-Icon--Copy",title:lf("Duplicate the selected tile"),disabled:h}),(0,f.jsx)(T.Button,{className:(0,E.classList)("image-editor-button",!h&&"toggle"),onClick:this.tileDeleteAlertHandler,leftIcon:"ms-Icon ms-Icon--Delete",title:lf("Delete the selected tile"),disabled:h})]}))]})),(0,f.jsxs)("div",Object.assign({className:"tile-canvas-outer",onContextMenu:this.preventContextMenu},{children:[(0,f.jsxs)("div",Object.assign({className:"tile-canvas"},{children:[p.map((e,t)=>(0,f.jsx)(I,{tile:e.bitmap,title:lf("Tile {0}",e),colors:i,onClick:()=>this.handleTileClick(t,!1),onRightClick:()=>this.handleTileClick(t,!0)},t)),d&&(0,f.jsx)("div",Object.assign({className:"tile-button-outer"},{children:(0,f.jsx)(T.Button,{className:"image-editor-button add-tile-button toggle",onClick:this.tileCreateHandler,leftIcon:"ms-Icon ms-Icon--Add",title:lf("Create a new tile")})}))]})),(0,f.jsx)("div",Object.assign({className:"tile-canvas-controls"},{children:(0,f.jsx)(y.CarouselNav,{selected:r,pages:u,onPageSelected:this.pageHandler,maxDisplayed:5})}))]}))]}))}updateGalleryTiles(){var{page:e,category:t,galleryOpen:i}=this.props,i=(this.categoryTiles=i?this.categories[t].tiles:this.getCustomTiles().map(([e,t])=>({index:t,bitmap:e.bitmap})),16*e);this.renderedTiles=this.categoryTiles.slice(i,16+i)}jumpToPageContaining(e){var{tileset:i,dispatchSetGalleryOpen:n,dispatchChangeTilePaletteCategory:o,dispatchChangeTilePalettePage:r}=this.props;if(!(!e||e<0||e>=i.tiles.length)){let t=i.tiles[e];t.isProjectTile?(i=this.getCustomTiles().map(([e])=>e))&&(e=Math.max(Math.floor(i.findIndex(e=>e.id==t.id)/16),0),n(!1),r(e)):(i=this.categories.find(e=>-1!==e.tiles.findIndex(e=>e.qualifiedName==t.id)))&&i.tiles&&(e=Math.max(Math.floor(i.tiles.findIndex(e=>e.qualifiedName==t.id)/16),0),n(!0),o(this.categories.indexOf(i)),r(e))}}handleTileClick(i,n){var o,r,i=this.renderedTiles[i];if(i){let e,t;w(i)?(e=this.getTileIndex(i),t=i.qualifiedName):e=i.index,0<=e?n?this.props.dispatchChangeBackgroundColor(e):this.props.dispatchChangeSelectedColor(e):({selected:i,backgroundColor:o,tileset:r}=this.props,r=r.tiles.length||1,this.props.dispatchCreateNewTile(null,n?i:r,n?r:o,t)),this.props.dispatchChangeDrawingMode(m.TileDrawingMode.Default)}}refreshGallery(e){let{gallery:i,tileset:n}=e;i&&a.forEach(t=>{t.tiles=i.filter(e=>-1!==e.tags.indexOf(t.id)&&e.tileWidth===n.tileWidth)})}getCustomTiles(){return this.props.tileset.tiles.map((e,t)=>[e,t]).filter(([e])=>e.isProjectTile).sort(([e],[t])=>{var i="myTiles.transparency"+this.props.tileset.tileWidth;return e.id==i?-1:t.id==i?1:e.internalID-t.internalID})}getTileIndex(t){var i=this.props.tileset;for(let e=0;e<i.tiles.length;e++)if(i.tiles[e].id===t.qualifiedName)return e;return-1}}let I=e=>{let{tile:r,title:t,onClick:i,onRightClick:n,colors:s}=e,a=o.useRef();return o.useEffect(()=>{var e=a.current,i=(e.width=r.width,e.height=r.height,e.getContext("2d")),n=(i.clearRect(0,0,e.width,e.height),pxt.sprite.Bitmap.fromData(r));for(let t=0;t<r.width;t++)for(let e=0;e<r.height;e++){var o=n.get(t,e);o&&(i.fillStyle=s[o],i.fillRect(t,e,1,1))}},[r,s]),(0,f.jsx)("div",Object.assign({className:"tile-button-outer"},{children:(0,f.jsx)(T.Button,{className:"image-editor-button tile-button",title:t,onClick:i,onRightClick:n,label:(0,f.jsx)("canvas",{ref:a})})}))};function w(e){return e.qualifiedName}e={dispatchChangeSelectedColor:r.dispatchChangeSelectedColor,dispatchChangeBackgroundColor:r.dispatchChangeBackgroundColor,dispatchSwapBackgroundForeground:r.dispatchSwapBackgroundForeground,dispatchChangeTilePalettePage:r.dispatchChangeTilePalettePage,dispatchChangeTilePaletteCategory:r.dispatchChangeTilePaletteCategory,dispatchChangeDrawingMode:r.dispatchChangeDrawingMode,dispatchCreateNewTile:r.dispatchCreateNewTile,dispatchSetGalleryOpen:r.dispatchSetGalleryOpen,dispatchOpenTileEditor:r.dispatchOpenTileEditor,dispatchDeleteTile:r.dispatchDeleteTile,dispatchShowAlert:r.dispatchShowAlert,dispatchHideAlert:r.dispatchHideAlert};i.TilePalette=(0,n.connect)(function({store:{present:e},editor:t},i){return e?{selected:t.selectedColor,tileset:e.tileset,backgroundColor:t.backgroundColor,category:t.tilemapPalette.category,page:t.tilemapPalette.page,colors:e.colors,drawingMode:t.drawingMode,gallery:t.tileGallery,galleryOpen:t.tileGalleryOpen,referencedTiles:t.referencedTiles}:{}},e)(l)},{"../../../../../react-common/components/controls/Button":143,"../../../../../react-common/components/controls/CarouselNav":144,"../../../../../react-common/components/controls/Dropdown":146,"../../../../../react-common/components/util":154,"../../../assets":157,"../Pivot":164,"../TimelineFrame":167,"../actions/dispatch":170,"../store/imageReducer":174,react:268,"react-redux":251,"react/jsx-runtime":269}],178:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.replaceColorEdit=i.outlineEdit=i.flipEdit=i.rotateEdit=i.MarqueeEdit=i.FillEdit=i.CircleEdit=i.LineEdit=i.OutlineEdit=i.RectangleEdit=i.PaintEdit=i.SelectionEdit=i.Edit=i.EditState=i.getEditState=i.getEdit=i.tools=i.ToolCursor=void 0;let a=e("./store/imageReducer"),n;(e=n=i.ToolCursor||(i.ToolCursor={})).None="none",e.Default="default",e.Pointer="pointer",e.Crosshair="crosshair",e.Grab="grab",e.Grabbing="grabbing",e.EyeDropper="var(--eyedropper)",i.tools=[{tool:a.ImageEditorTool.Paint,iconClass:"ms-Icon ms-Icon--Edit",title:lf("Paint Tool"),hoverCursor:n.Crosshair},{tool:a.ImageEditorTool.Erase,iconClass:"ms-Icon ms-Icon--EraseTool",title:lf("Erase Tool"),hoverCursor:n.Crosshair},{tool:a.ImageEditorTool.Rect,iconClass:"ms-Icon ms-Icon--RectangleShape",title:lf("Rectangle Tool"),hoverCursor:n.Crosshair},{tool:a.ImageEditorTool.Fill,iconClass:"ms-Icon ms-Icon--BucketColor",title:lf("Fill Tool"),hoverCursor:n.Crosshair},{tool:a.ImageEditorTool.Circle,iconClass:"ms-Icon ms-Icon--CircleRing",title:lf("Circle Tool"),hoverCursor:n.Crosshair},{tool:a.ImageEditorTool.Line,iconClass:"ms-Icon ms-Icon--Line",title:lf("Line Tool"),hoverCursor:n.Crosshair},{tool:a.ImageEditorTool.Marquee,iconClass:"ms-Icon ms-Icon--SelectAll",title:lf("Marquee Tool"),hoverCursor:n.Crosshair,hoverLayerCursor:n.Grab,downLayerCursor:n.Grabbing},{tool:a.ImageEditorTool.Pan,iconClass:"ms-Icon ms-Icon--HandsFree",title:lf("Canvas Pan Tool"),hoverCursor:n.Grab,downCursor:n.Grabbing},{tool:a.ImageEditorTool.ColorSelect,hiddenTool:!0,iconClass:"ms-Icon ms-Icon--Edit",title:lf("Color Select Tool"),hoverCursor:n.EyeDropper}],i.getEdit=function(e,t,i,n){switch(e){case a.ImageEditorTool.Paint:return new s(t.width,t.height,i,n);case a.ImageEditorTool.Rect:return new u(t.width,t.height,i,n);case a.ImageEditorTool.Fill:return new p(t.width,t.height,i,n);case a.ImageEditorTool.Line:return new d(t.width,t.height,i,n);case a.ImageEditorTool.Marquee:return new g(t.width,t.height,i,n);case a.ImageEditorTool.Circle:return new h(t.width,t.height,i,n);case a.ImageEditorTool.Erase:return new s(t.width,t.height,0,n);default:a.ImageEditorTool.ColorSelect;return}},i.getEditState=function(e,t,i=a.TileDrawingMode.Default){var n=new c((t?pxt.sprite.Tilemap:pxt.sprite.Bitmap).fromData(e.bitmap).copy());e.overlayLayers&&(n.overlayLayers=e.overlayLayers.map(e=>pxt.sprite.Bitmap.fromData(e).copy())),n.layerOffsetX=e.layerOffsetX,n.layerOffsetY=e.layerOffsetY;let o,r,s;return e.floating&&(e.floating.bitmap&&(r=(t?pxt.sprite.Tilemap:pxt.sprite.Bitmap).fromData(e.floating.bitmap).copy()),e.floating.overlayLayers&&(s=e.floating.overlayLayers.map(e=>pxt.sprite.Bitmap.fromData(e).copy())),o={image:r,overlayLayers:s}),n.floating=o,n.setActiveLayer(i),n};class c{constructor(e){this.activeLayerIndex=-1,this.image=e,this.layerOffsetX=0,this.layerOffsetY=0}get width(){return this.image.width}get height(){return this.image.height}get activeLayer(){return this.activeLayerIndex<0?this.image:this.overlayLayers[this.activeLayerIndex]}setActiveLayer(e){e===a.TileDrawingMode.Wall?this.activeLayerIndex=0:this.activeLayerIndex=-1}copy(){var i=new c;if(i.image=this.image.copy(),i.overlayLayers=this.overlayLayers&&this.overlayLayers.map(e=>e.copy()),this.floating){let e,t;this.floating.image&&(e=this.floating.image.copy()),this.floating.overlayLayers&&(t=this.floating.overlayLayers.map(e=>e.copy())),i.floating={image:e,overlayLayers:t}}return i.layerOffsetX=this.layerOffsetX,i.layerOffsetY=this.layerOffsetY,i}equals(e){return!(!this.image.equals(e.image)||this.floating&&!e.floating||!this.floating&&e.floating)&&(!this.floating||!this.floating.image||this.floating.image.equals(e.floating.image)&&this.layerOffsetX===e.layerOffsetX&&this.layerOffsetY===e.layerOffsetY)}mergeFloatingLayer(){this.floating&&(this.floating.image||this.floating.overlayLayers)&&(this.floating.image&&(this.floating.image.x0=this.layerOffsetX,this.floating.image.y0=this.layerOffsetY,this.image.apply(this.floating.image,!0),this.floating.image=void 0),this.floating.overlayLayers)&&(this.floating.overlayLayers.forEach((e,t)=>{e.x0=this.layerOffsetX,e.y0=this.layerOffsetY,this.overlayLayers[t].apply(e,!0)}),this.floating.overlayLayers=void 0)}copyToLayer(n,o,t,r,i=!1){if(0!==t&&0!==r){t<0&&(n+=t,t=-t),r<0&&(o+=r,r=-r);var s=this.image.copy(n,o,t,r);this.layerOffsetX=s.x0,this.layerOffsetY=s.y0,s.x0=void 0,s.y0=void 0;let e;if(this.overlayLayers&&(e=this.overlayLayers.map(e=>e.copy(n,o,t,r))),i)for(let i=0;i<t;i++)for(let t=0;t<r;t++)this.image.set(n+i,o+t,0),this.overlayLayers&&this.overlayLayers.forEach(e=>e.set(n+i,o+t,0));this.floating={image:s,overlayLayers:e}}}inFloatingLayer(e,t){return!(!this.floating||!this.floating.image)&&(e-=this.layerOffsetX,t-=this.layerOffsetY,0<=e)&&e<this.floating.image.width&&0<=t&&t<this.floating.image.height}setFloatingLayer(e,t,i){i&&this.mergeFloatingLayer(),this.floating={image:e},this.layerOffsetX=null!=(i=null==t?void 0:t.layerOffsetX)?i:0,this.layerOffsetY=null!=(e=null==t?void 0:t.layerOffsetY)?e:0}toImageState(){return{bitmap:this.image.data(),layerOffsetX:this.layerOffsetX,layerOffsetY:this.layerOffsetY,floating:this.floating&&{bitmap:this.floating.image?this.floating.image.data():void 0,overlayLayers:this.floating.overlayLayers?this.floating.overlayLayers.map(e=>e.data()):void 0},overlayLayers:this.overlayLayers?this.overlayLayers.map(e=>e.data()):void 0}}}i.EditState=c;class o{constructor(e,t,i,n){this.canvasWidth=e,this.canvasHeight=t,this.color=i,this.toolWidth=n}doEdit(e){this.isStarted&&this.doEditCore(e)}inBounds(e,t){return 0<=e&&e<this.canvasWidth&&0<=t&&t<this.canvasHeight}start(e,t,i,n,o){this.isStarted=!0,this.startCol=e,this.startRow=t,this.startX=i,this.startY=n}drawCursor(e,t,i){i(e,t)}}i.Edit=o;class r extends o{update(e,t){this.endCol=e,this.endRow=t,this.isDragged||e==this.startCol&&t==this.startRow||(this.isDragged=!0)}topLeft(){return{x:Math.min(this.startCol,this.endCol),y:Math.min(this.startRow,this.endRow)}}bottomRight(){return{x:Math.max(this.startCol,this.endCol),y:Math.max(this.startRow,this.endRow)}}}i.SelectionEdit=r;class s extends o{constructor(e,t,i,n){super(e,t,i,n),this.showPreview=!0,this.mask=new pxt.sprite.Bitmask(e,t)}update(e,t){this.interpolate(this.startCol,this.startRow,e,t),this.startCol=e,this.startRow=t}interpolate(e,t,i,n){let o=(e,t)=>this.mask.set(e,t);pxt.Util.bresenhamLine(e,t,i,n,(e,t)=>this.drawCore(e,t,o))}doEditCore(i){i.mergeFloatingLayer();for(let t=0;t<i.width;t++)for(let e=0;e<i.height;e++)this.mask.get(t,e)&&i.activeLayer.set(t,e,this.color)}drawCursor(e,t,i){this.drawCore(e,t,i)}drawCore(i,n,o){i-=Math.floor(this.toolWidth/2),n-=Math.floor(this.toolWidth/2);for(let t=0;t<this.toolWidth;t++)for(let e=0;e<this.toolWidth;e++){var r=i+t,s=n+e;0<=r&&r<this.canvasWidth&&0<=s&&s<this.canvasHeight&&o(i+t,n+e)}}}i.PaintEdit=s;class l extends r{constructor(){super(...arguments),this.showPreview=!0}doEditCore(i){i.mergeFloatingLayer();var n=this.topLeft(),o=this.bottomRight();for(let t=n.x;t<=o.x;t++)for(let e=n.y;e<=o.y;e++)i.activeLayer.set(t,e,this.color)}}i.RectangleEdit=l;class u extends r{constructor(){super(...arguments),this.showPreview=!0}doEditCore(t){t.mergeFloatingLayer();var i=this.topLeft(),n=(i.x-=this.toolWidth>>1,i.y-=this.toolWidth>>1,this.bottomRight());n.x+=this.toolWidth>>1,n.y+=this.toolWidth>>1;for(let e=0;e<this.toolWidth;e++)this.drawRectangle(t,{x:i.x+e,y:i.y+e},{x:n.x-e,y:n.y-e})}drawRectangle(t,i,n){if(!(i.x>n.x||i.y>n.y)){for(let e=i.x;e<=n.x;e++)t.activeLayer.set(e,i.y,this.color),t.activeLayer.set(e,n.y,this.color);for(let e=i.y;e<=n.y;e++)t.activeLayer.set(i.x,e,this.color),t.activeLayer.set(n.x,e,this.color)}}drawCursor(e,t,i){this.drawCore(e,t,i)}drawCore(i,n,o){i-=Math.floor(this.toolWidth/2),n-=Math.floor(this.toolWidth/2);for(let t=0;t<this.toolWidth;t++)for(let e=0;e<this.toolWidth;e++){var r=i+t,s=n+e;0<=r&&r<this.canvasWidth&&0<=s&&s<this.canvasHeight&&o(i+t,n+e)}}}i.OutlineEdit=u;class d extends r{constructor(){super(...arguments),this.showPreview=!0}doEditCore(e){e.mergeFloatingLayer(),this.bresenham(this.startCol,this.startRow,this.endCol,this.endRow,e)}bresenham(e,t,i,n,o){let r=(e,t)=>o.activeLayer.set(e,t,this.color);pxt.Util.bresenhamLine(e,t,i,n,(e,t)=>this.drawCore(e,t,r))}drawCursor(e,t,i){this.drawCore(e,t,i)}drawCore(i,n,o){i-=Math.floor(this.toolWidth/2),n-=Math.floor(this.toolWidth/2);for(let t=0;t<this.toolWidth;t++)for(let e=0;e<this.toolWidth;e++)o(i+t,n+e)}}i.LineEdit=d;class h extends r{constructor(){super(...arguments),this.showPreview=!0}doEditCore(e){e.mergeFloatingLayer();var t=this.topLeft(),i=this.bottomRight(),n=i.x-t.x,i=i.y-t.y,t=Math.floor(Math.hypot(n,i)),n=this.startCol,i=this.startRow;this.midpoint(n,i,t,e)}midpoint(e,t,i,n){let o=i-1,r=0,s=1,a=1,l=s-2*i;for(;o>=r;)n.activeLayer.set(e+o,t+r,this.color),n.activeLayer.set(e+o,t-r,this.color),n.activeLayer.set(e+r,t+o,this.color),n.activeLayer.set(e+r,t-o,this.color),n.activeLayer.set(e-r,t+o,this.color),n.activeLayer.set(e-r,t-o,this.color),n.activeLayer.set(e-o,t+r,this.color),n.activeLayer.set(e-o,t-r,this.color),l<=0&&(r++,l+=a,a+=2),0<l&&(o--,s+=2,l+=s-2*i)}}i.CircleEdit=h;class p extends o{constructor(){super(...arguments),this.showPreview=!0}start(e,t,i,n,o){this.isStarted=!0,this.col=e,this.row=t}update(e,t){this.col=e,this.row=t}doEditCore(o){let i=o.activeLayer!==o.image;var e=(e,t)=>(i?o.activeLayer.get(e,t)+1<<8:0)+o.image.get(e,t),t=e(this.col,this.row);if(t!==this.color){o.mergeFloatingLayer();let i=new pxt.sprite.Bitmask(o.width,o.height),n=(i.set(this.col,this.row),[{x:this.col,y:this.row}]);for(;n.length;){var r=n.pop();e(r.x,r.y)===t&&(o.activeLayer.set(r.x,r.y,this.color),s(r.x+1,r.y),s(r.x-1,r.y),s(r.x,r.y+1),s(r.x,r.y-1))}function s(e,t){0<=e&&e<i.width&&0<=t&&t<i.height&&!i.get(e,t)&&(i.set(e,t),n.push({x:e,y:t}))}}}}i.FillEdit=p;class g extends r{constructor(){super(...arguments),this.isMove=!1,this.isResize=!1,this.showPreview=!1}start(e,t,o,r,s){this.isStarted=!0,this.startCol=e,this.startRow=t;var a=document.elementFromPoint(o,r);if(s.floating&&s.floating.image)if(a&&"image-editor-floating-layer-corner"==a.className){this.isResize=!0,this.startOffsetX=s.layerOffsetX,this.startOffsetY=s.layerOffsetY;let t=void 0,i=0;var l=document.getElementsByClassName("image-editor-floating-layer-corner");for(let e=0;e<l.length;e++){var c=Math.sqrt(Math.pow(l[e].getBoundingClientRect().x-o,2)+Math.pow(l[e].getBoundingClientRect().y-r,2));c>i&&(i=c,t=l[e])}var u=document.getElementsByClassName("paint-surface");let n;for(let e=0;e<u.length;e++)u[e].className.includes("main")&&(n=u[e]);var a=n.getBoundingClientRect().left,d=n.getBoundingClientRect().top,h=n.getBoundingClientRect().width,p=n.getBoundingClientRect().height;this.anchorCol=(t.getBoundingClientRect().x-a)/h*this.canvasWidth,this.anchorRow=(t.getBoundingClientRect().y-d)/p*this.canvasHeight,this.originalImage||(this.originalImage=s.floating.image.copy())}else s.inFloatingLayer(e,t)&&(this.isMove=!0,this.startOffsetX=s.layerOffsetX,this.startOffsetY=s.layerOffsetY)}inBounds(e,t){return this.isMove||super.inBounds(e,t)}doEditCore(e){var t,i,n=this.topLeft(),o=this.bottomRight();this.isDragged?this.isMove?(e.layerOffsetX=this.startOffsetX+this.endCol-this.startCol,e.layerOffsetY=this.startOffsetY+this.endRow-this.startRow):this.isResize?(i=Math.round(Math.abs(this.anchorCol-this.endCol)),t=Math.round(Math.abs(this.anchorRow-this.endRow)),i=((i,n,o)=>{var r=new pxt.sprite.Bitmap(n,o,0,0);for(let t=0;t<n;t++)for(let e=0;e<o;e++){var s=Math.floor(t/n*i.width),a=Math.floor(e/o*i.height),s=i.get(s,a);r.set(t,e,s)}return r})(this.originalImage,i,t),e.setFloatingLayer(i,{layerOffsetX:Math.round(Math.min(this.anchorCol,this.endCol)),layerOffsetY:Math.round(Math.min(this.anchorRow,this.endRow))},!1)):(e.mergeFloatingLayer(),e.copyToLayer(n.x,n.y,o.x-n.x+1,o.y-n.y+1,!0)):this.isMove||e.mergeFloatingLayer()}}i.MarqueeEdit=g,i.rotateEdit=function(e,o,t,i){var n=!(null==(n=e.floating)||!n.image);let r=n?e.floating:e;var s=new(t?pxt.sprite.Tilemap:pxt.sprite.Bitmap)(r.image.height,r.image.width),a=r.overlayLayers?r.overlayLayers.map(e=>new pxt.sprite.Bitmap(e.height,e.width)):void 0;for(let n=0;n<r.image.width;n++)for(let i=0;i<r.image.height;i++)l(r.image,s,n,i),a&&a.forEach((e,t)=>l(r.overlayLayers[t],e,n,i));if(t=s.width===s.height&&s.width===e.image.width&&e.image.width===e.image.height,!i&&!n||t)return(i=new c(s)).overlayLayers=a,i;if(!n)for(let i=0;i<e.width;i++)for(let t=0;t<e.height;t++)e.image.set(i,t,0),e.overlayLayers&&e.overlayLayers.forEach(e=>null==e?void 0:e.set(i,t,0));return(s.width===e.image.height&&s.height===e.image.width||s.width===e.image.width&&s.height===e.image.height)&&(e.layerOffsetX=(e.width>>1)-(s.width>>1),e.layerOffsetY=(e.height>>1)-(s.height>>1)),e.floating={image:s,overlayLayers:a},e;function l(e,t,i,n){o?t.set(n,i,e.get(i,e.height-n-1)):t.set(n,i,e.get(e.width-i-1,n))}},i.flipEdit=function(e,o,t){let i,n,r=null!=(i=e.floating)&&i.image?e.floating:e;var s=new(t?pxt.sprite.Tilemap:pxt.sprite.Bitmap)(r.image.width,r.image.height),a=r.overlayLayers?r.overlayLayers.map(e=>new pxt.sprite.Bitmap(e.width,e.height)):void 0;for(let n=0;n<r.image.width;n++)for(let i=0;i<r.image.height;i++)l(r.image,s,n,i),a&&a.forEach((e,t)=>l(r.overlayLayers[t],e,n,i));return null!=(n=e.floating)&&n.image?(e.floating={image:s,overlayLayers:a},e):((t=new c(s)).overlayLayers=a,t);function l(e,t,i,n){o?t.set(i,n,e.get(i,e.height-n-1)):t.set(i,n,e.get(e.width-i-1,n))}},i.outlineEdit=function(e,i){var n=null!=(t=e.floating)&&t.image?e.floating:e,t=e.copy(),o=(null!=(e=null==e?void 0:e.floating)&&e.image?t.floating:t).image;for(let t=0;t<n.image.width;t++)for(let e=0;e<n.image.height;e++)0!==n.image.get(t,e)||0===n.image.get(t-1,e)&&0===n.image.get(t,e-1)&&0===n.image.get(t+1,e)&&0===n.image.get(t,e+1)||o.set(t,e,i);return t},i.replaceColorEdit=function(e,i,n){var o=null!=(t=e.floating)&&t.image?e.floating:e,t=e.copy(),r=(null!=(e=null==e?void 0:e.floating)&&e.image?t.floating:t).image;for(let t=0;t<o.image.width;t++)for(let e=0;e<o.image.height;e++)o.image.get(t,e)===i&&r.set(t,e,n);return t}},{"./store/imageReducer":174}],179:[function(e,t,i){function s(){return"undefined"!=typeof window&&!!window.PointerEvent}function a(){return"undefined"!=typeof window&&("ontouchstart"in window||navigator&&0<navigator.maxTouchPoints)}var n;Object.defineProperty(i,"__esModule",{value:!0}),i.createTilemapPatchFromFloatingLayer=i.applyBitmapData=i.imageStateToTilemap=i.imageStateToBitmap=i.bindGestureEvents=i.GestureState=i.fireClickOnlyOnEnter=i.clientCoord=i.pointerEvents=i.Bitmask=i.MapTools=i.isBitmapSupported=i.isTouchEnabled=i.hasPointerEvents=i.DRAG_RADIUS=void 0,i.DRAG_RADIUS=3,i.hasPointerEvents=s,i.isTouchEnabled=a,i.isBitmapSupported=function(){return!!window.createImageBitmap},(n=i.MapTools||(i.MapTools={}))[n.Pan=0]="Pan",n[n.Stamp=1]="Stamp",n[n.Object=2]="Object",n[n.Erase=3]="Erase";function l(e){return e.touches?(e.touches.length?e.touches:e.changedTouches)[0]:e}i.Bitmask=class{constructor(e,t){this.width=e,this.height=t,this.mask=new Uint8Array(Math.ceil(e*t/8))}set(e,t){e+=this.width*t;this.mask[e>>3]|=1<<(7&e)}get(e,t){e+=this.width*t;return this.mask[e>>3]>>(7&e)&1}},i.pointerEvents=s()?{up:"pointerup",down:["pointerdown"],move:"pointermove",enter:"pointerenter",leave:"pointerleave"}:a()?{up:"mouseup",down:["mousedown","touchstart"],move:"touchmove",enter:"touchenter",leave:"touchend"}:{up:"mouseup",down:["mousedown"],move:"mousemove",enter:"mouseenter",leave:"mouseleave"},i.clientCoord=l,i.fireClickOnlyOnEnter=function(e){13===("number"==typeof e.which?e.which:e.keyCode)&&(e.preventDefault(),e.currentTarget.click())};class c{constructor(e,t,i){this.target=e,this.isRightClick=i,this.startX=t.clientX,this.startY=t.clientY,this.currentX=t.clientX,this.currentY=t.clientY}update(e){this.currentX=e.clientX,this.currentY=e.clientY,!this.isDrag&&this.distance()>i.DRAG_RADIUS?(this.isDrag=!0,this.target.onDragStart(e,this.isRightClick)):this.isDrag&&this.target.onDragMove(e)}end(e){e&&this.update(e),e=e||{clientX:this.currentX,clientY:this.currentY},this.isDrag?this.target.onDragEnd(e):this.target.onClick(e,this.isRightClick)}distance(){return Math.sqrt(Math.pow(this.currentX-this.startX,2)+Math.pow(this.currentY-this.startY,2))}}function u(t,i){for(let e=0;e<t.changedTouches.length;e++)if(t.changedTouches[e].identifier===i)return t.changedTouches[e]}function d(e){return 0<e.button}i.GestureState=c,i.bindGestureEvents=function(e,o){if(s()){var r=e;var i=o;let t;r.addEventListener("pointerup",e=>{t&&(t.end(l(e)),e.preventDefault()),t=void 0}),r.addEventListener("pointerdown",e=>{t&&t.end(),t=new c(i,l(e),d(e)),e.preventDefault()}),r.addEventListener("pointermove",e=>{t&&(t.update(l(e)),e.preventDefault())}),r.addEventListener("pointerleave",e=>{t&&(t.end(l(e)),e.preventDefault()),t=void 0})}else if(a()){r=e;var t=o;let i,n;r.addEventListener("touchend",e=>{var t;i&&n&&(t=u(e,n))&&(i.end(t),i=void 0,e.preventDefault())}),r.addEventListener("touchstart",e=>{i&&i.end(),n=e.changedTouches[0].identifier,i=new c(t,e.changedTouches[0],d(e))}),r.addEventListener("touchmove",e=>{var t;i&&n&&(t=u(e,n))&&(i.update(t),e.preventDefault())}),r.addEventListener("touchcancel",e=>{var t;i&&n&&(t=u(e,n))&&(i.end(t),i=void 0,e.preventDefault())})}else{var n=o;let t;e.addEventListener("mouseup",e=>{t&&t.end(l(e)),t=void 0}),e.addEventListener("mousedown",e=>{t&&t.end(),t=new c(n,l(e),d(e))}),e.addEventListener("mousemove",e=>{t&&t.update(l(e))}),e.addEventListener("mouseleave",e=>{t&&t.end(l(e)),t=void 0})}},i.imageStateToBitmap=function(e){var t,i=pxt.sprite.Bitmap.fromData(e.bitmap).copy();return e.floating&&e.floating.bitmap&&((t=pxt.sprite.Bitmap.fromData(e.floating.bitmap)).x0=e.layerOffsetX||0,t.y0=e.layerOffsetY||0,i.apply(t,!0)),i},i.imageStateToTilemap=function(e){var t,i=pxt.sprite.Tilemap.fromData(e.bitmap).copy();return e.floating&&e.floating.bitmap&&((t=pxt.sprite.Tilemap.fromData(e.floating.bitmap)).x0=e.layerOffsetX||0,t.y0=e.layerOffsetY||0,i.apply(t,!0)),i},i.applyBitmapData=function(e,t,i=0,n=0){var o;return e&&t?(o=pxt.sprite.Bitmap.fromData(e),(t=pxt.sprite.Bitmap.fromData(t)).x0=i,t.y0=n,o.apply(t,!0),o.data()):e},i.createTilemapPatchFromFloatingLayer=function(e,i){if(e.floating){var n=pxt.sprite.Tilemap.fromData(e.floating.image.data()),o=new pxt.sprite.Tilemap(n.width,n.height),e=e.floating.overlayLayers?e.floating.overlayLayers.map(e=>pxt.sprite.base64EncodeBitmap(e.data())):[],r=[];for(let t=0;t<n.width;t++)for(let e=0;e<n.height;e++){var s=i.tiles[n.get(t,e)],a=r.indexOf(s);-1===a?(o.set(t,e,r.length),r.push(s)):o.set(t,e,a)}return{map:pxt.sprite.hexEncodeTilemap(o),layers:e,tiles:r.map(e=>pxt.sprite.base64EncodeBitmap(e.bitmap))}}}},{}],180:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ImageFieldEditor=void 0;let y=e("react/jsx-runtime");var n=e("react");let o=e("./assetEditor/assetCard"),r=e("../assets"),v=e("./ImageEditor/ImageEditor"),s=e("./ImageEditor/keyboardShortcuts"),a=e("./ImageEditor/store/imageReducer"),T=e("./FilterPanel"),E=e("../util"),k=e("../../../react-common/components/controls/EditorToggle"),C=e("./MusicFieldEditor"),I=e("../../../react-common/components/util"),w=e("../../../react-common/components/controls/FocusTrap");class l extends n.Component{constructor(e){super(e),this.tagClickHandler=e=>{var t=this.state.gallerySelectedTags,e=e.toLowerCase(),i=t.indexOf(e);i<0?t.push(e):t.splice(i,1),this.setState({gallerySelectedTags:t})},this.clearFilterTags=()=>{this.setState({gallerySelectedTags:[]})},this.toggleFilter=()=>{this.setState({filterOpen:!this.state.filterOpen})},this.showEditor=()=>{this.setImageEditorShortcutsEnabled(!0),c("gallery-editor"),this.setState({currentView:"editor",tileGalleryVisible:!1})},this.showGallery=()=>{this.setImageEditorShortcutsEnabled(!1),c("gallery-builtin"),this.setState({currentView:"gallery",tileGalleryVisible:!1})},this.showMyAssets=()=>{this.setImageEditorShortcutsEnabled(!1),c("gallery-my-assets"),this.userAssets=(0,r.getAssets)(void 0,void 0,this.options.temporaryAssets),this.setState({currentView:"my-assets",tileGalleryVisible:!1})},this.toggleTileGallery=()=>{this.state.tileGalleryVisible?this.setState({tileGalleryVisible:!1}):this.setState({tileGalleryVisible:!0,currentView:"editor"})},this.onAssetSelected=e=>{var t,i;this.ref&&e.id!==(null==(i=this.asset)?void 0:i.id)&&(this.state.editingTile?this.ref.openInTileEditor(pxt.sprite.Bitmap.fromData(e.bitmap)):"gallery"===this.state.currentView?this.ref.openGalleryAsset(e):(i=pxt.react.getTilemapProject(),"tilemap"===(null==(t=this.asset)?void 0:t.type)&&pxt.sprite.updateTilemapReferencesFromResult(i,this.asset),this.asset.meta.displayName?i.updateAsset(this.asset):e.meta.displayName||(e=Object.assign(Object.assign({},pxt.cloneAsset(e)),{id:this.asset.id,meta:this.asset.meta})),"tilemap"===e.type&&pxt.sprite.addMissingTilemapTilesAndReferences(i,e),this.ref.openAsset(e,void 0,!0))),c("gallery-selection"),this.setState({currentView:"editor",tileGalleryVisible:!1}),this.setImageEditorShortcutsEnabled(!0)},this.onTileEditorOpenClose=e=>{this.setState({editingTile:e})},this.onDoneClick=()=>{this.closeEditor&&this.closeEditor(),this.props.doneButtonCallback&&this.props.doneButtonCallback()},this.handleImageEditorRegionRef=e=>{e&&(this.imageEditorRegion=e)},this.onEscapeFromGallery=()=>{this.setState({currentView:"editor"},()=>{this.imageEditorRegion&&this.imageEditorRegion.focus()})},this.state={currentView:"editor",headerVisible:!0,filterOpen:!1,gallerySelectedTags:[],galleryFilter:""},(0,a.setTelemetryFunction)(c)}get asset(){var e;return null==(e=this.ref)?void 0:e.getAsset()}render(){let e,t,i,n,o,{currentView:r,headerVisible:s,editingTile:a,hideMyAssets:l,filterOpen:c,hideCloseButton:u}=this.state;var d="gallery"===this.state.currentView&&c;let h=s,p=!this.props.isMusicEditor&&(!this.asset||a||"tilemap"!==this.asset.type);var g=!l&&!a,f=(this.asset&&!this.galleryAssets&&p&&this.updateGalleryAssets(),null!=(e=this.galleryAssets)&&e.length||(p=!1),this.props.includeSpecialTagsInFilter?[]:["tile","dialog","background"]);let m=[],b=[];switch(r){case"my-assets":b=this.filterAssetsByType(this.userAssets,a?"tile":null==(t=this.asset)?void 0:t.type),m=this.getAvailableTags(b,f);break;case"gallery":b=this.filterAssetsByType(this.galleryAssets,a?"tile":null==(i=this.asset)?void 0:i.type,!0,!0),m=this.getAvailableTags(b,f),b=this.filterAssetsByTag(b)}var _=[{label:lf("Editor"),title:lf("Editor"),focusable:!0,icon:"fas fa-paint-brush",onClick:this.showEditor,view:"editor"},{label:lf("Gallery"),title:lf("Gallery"),focusable:!0,icon:"fas fa-image",onClick:this.showGallery,view:"gallery"},{label:lf("My Assets"),title:lf("My Assets"),focusable:!0,icon:"fas fa-folder",onClick:this.showMyAssets,view:"my-assets"}];return p||g?p?g||_.splice(2,1):_.splice(1,1):h=!1,(0,y.jsxs)(w.FocusTrap,Object.assign({onEscape:this.onDoneClick,className:(0,I.classList)("image-editor-wrapper",this.props.isMusicEditor&&"music-asset-editor")},{children:[h&&(0,y.jsxs)("div",Object.assign({className:"gallery-editor-header"},{children:[(0,y.jsx)("div",{className:"image-editor-header-left"}),(0,y.jsx)("div",Object.assign({className:"image-editor-header-center"},{children:(0,y.jsx)(k.EditorToggle,{id:"image-editor-toggle",className:"slim tablet-compact",items:_,selected:_.findIndex(e=>e.view===r)})})),(0,y.jsxs)("div",Object.assign({className:"image-editor-header-right"},{children:[(0,y.jsxs)("div",Object.assign({className:"gallery-filter-button "+("gallery"===this.state.currentView?"":"hidden"),role:"button",onClick:this.toggleFilter,onKeyDown:E.fireClickOnEnter},{children:[(0,y.jsx)("div",Object.assign({className:"gallery-filter-button-icon"},{children:(0,y.jsx)("i",{className:"icon filter"})})),(0,y.jsx)("div",Object.assign({className:"gallery-filter-button-label"},{children:lf("Filter")}))]})),!a&&!u&&(0,y.jsx)("div",Object.assign({className:"image-editor-close-button",role:"button",onClick:this.onDoneClick},{children:(0,y.jsx)("i",{className:"ui icon close"})}))]}))]})),(0,y.jsxs)("div",Object.assign({className:"image-editor-gallery-window"},{children:[(0,y.jsxs)("div",Object.assign({className:"image-editor-gallery-content"},{children:[(0,y.jsx)(w.FocusTrapRegion,Object.assign({divRef:this.handleImageEditorRegionRef,className:"image-editor-region",enabled:"editor"===r},{children:this.props.isMusicEditor?(0,y.jsx)(C.MusicFieldEditor,{ref:"image-editor",onDoneClicked:this.onDoneClick,hideDoneButton:this.props.hideDoneButton}):(0,y.jsx)(v.ImageEditor,{ref:"image-editor",singleFrame:this.props.singleFrame,onDoneClicked:this.onDoneClick,onTileEditorOpenClose:this.onTileEditorOpenClose,lightMode:this.lightMode,hideDoneButton:this.props.hideDoneButton,hideAssetName:!(null!=(o=null==(n=pxt.appTarget)?void 0:n.appTheme)&&o.assetEditor)})})),(0,y.jsx)(S,{items:b,hidden:"editor"===r,onAssetSelected:this.onAssetSelected,onEscape:this.onEscapeFromGallery})]})),(0,y.jsx)("div",Object.assign({className:"filter-panel-gutter "+(d?"":"hidden")},{children:(0,y.jsx)("div",Object.assign({className:"filter-panel-container"},{children:(0,y.jsx)(T.FilterPanel,{enabledTags:this.state.gallerySelectedTags,tagClickHandler:this.tagClickHandler,clearTags:this.clearFilterTags,tagOptions:m})}))}))]}))]}))}componentDidMount(){this.ref=this.refs["image-editor"],c("image-editor-shown")}componentWillUnmount(){c("image-editor-hidden"),this.galleryAssets=void 0,this.userAssets=void 0}init(e,t,i){switch(this.closeEditor=t,this.options=i,this.lightMode=i.lightMode,e.type){case"image":this.initSingleFrame(e,i);break;case"tile":i.disableResize=!0,this.initSingleFrame(e,i);break;case"animation":this.initAnimation(e,i);break;case"tilemap":this.initTilemap(e,i);break;case"song":this.ref.openAsset(e)}this.editID=e.id;let n=!1;i&&(this.blocksInfo=i.blocksInfo,i.filter&&(this.setState({galleryFilter:i.filter}),n=!0),null!=i.headerVisible&&(this.setState({headerVisible:i.headerVisible}),n=!0),null!=i.hideMyAssets&&(this.setState({hideMyAssets:i.hideMyAssets}),n=!0),null!=i.hideCloseButton)&&(this.setState({hideCloseButton:i.hideCloseButton}),n=!0),n||this.forceUpdate()}getValue(){return this.ref?this.ref.getAsset():null}getJres(){return this.ref?this.ref.getJres():""}getPersistentData(){return this.ref?this.ref.getPersistentData():null}restorePersistentData(e){this.ref&&(this.ref.restorePersistentData(e),this.options)&&this.options.disableResize&&this.ref.disableResize()}onResize(){this.ref&&this.ref.onResize()}updateGalleryAssets(){this.galleryAssets=(0,r.getAssets)(!0,this.asset.type)}getAvailableTags(e,t){let i=[];return this.galleryAssets?(e.forEach(e=>{null!=(e=e.meta.tags)&&e.forEach(e=>{e=(e=>{let t=0===e.indexOf("?")&&1<e.length?e.substring(1):e;return t=t.toLowerCase()})(e);t.indexOf(e)<0&&i.indexOf(e)<0&&i.push(e)})}),i):[]}filterAssetsByTag(e){return e=0<this.state.gallerySelectedTags.length&&this.state.filterOpen?e.filter(e=>!(null==(e=e.meta.tags)||!e.find(e=>0<=this.state.gallerySelectedTags.indexOf(e)))):e}filterAssetsByType(e,t,i=!1,n){if(void 0===(t=void 0===t?null==(o=this.asset)?void 0:o.type:t))return e;if(this.asset&&!i&&(e=e.map(e=>e.type!==this.asset.type||e.id!==this.asset.id?e:(0,r.assetToGalleryItem)(this.getValue())),this.state.editingTile)){let i=this.ref.getAsset();e=e.map(t=>{var e;return 0<=(null==(e=i.data.editedTiles)?void 0:e.indexOf(t.id))?(0,r.assetToGalleryItem)(i.data.tileset.tiles.find(e=>e.id===t.id)):t})}if(n){e.forEach(e=>{var t;!e.meta.tags&&this.options&&(e.meta.tags=(null==(e=null==(t=null==(t=this.blocksInfo)?void 0:t.apis.byQName[e.id])?void 0:t.attributes.tags)?void 0:e.split(" "))||[])});var o=this.state.galleryFilter.split(" ").filter(e=>!!e).map(e=>e.toLowerCase());let t=o.filter(e=>0!==e.indexOf("!")),i=o.filter(e=>0===e.indexOf("!")&&1<e.length).map(e=>e.substring(1));e=e.filter(e=>((e,t)=>{let n=e.meta.tags||[];return t.every(t=>{let i="?"+t;return n.some(e=>e===t||e===i)})})(e,t)&&((e,t)=>{let i=e.meta.tags||[];return t.every(t=>!i.some(e=>e===t))})(e,i))}if(i)switch(t){case"animation":return e.filter(e=>"animation"===e.type||"tile"===e.type||"image"===e.type);case"image":return e.filter(e=>"tile"===e.type||"image"===e.type);case"tile":return e.filter(e=>"tile"===e.type);case"tilemap":return e.filter(e=>"tilemap"===e.type);case"song":return e.filter(e=>"song"===e.type);case"json":return e.filter(e=>"json"===e.type)}else switch(t){case"animation":return e.filter(e=>"animation"===e.type);case"image":return e.filter(e=>"image"===e.type);case"tile":return e.filter(e=>"tile"===e.type);case"tilemap":return e.filter(e=>"tilemap"===e.type);case"song":return e.filter(e=>"song"===e.type);case"json":return e.filter(e=>"json"===e.type)}}initSingleFrame(e,t){this.ref.openAsset(e),t.disableResize&&this.ref.disableResize()}initAnimation(e,t){this.ref.openAsset(e),t.disableResize&&this.ref.disableResize()}initTilemap(e,t){let i;null!=t&&t.blocksInfo&&(this.blocksInfo=t.blocksInfo,i=pxt.sprite.filterItems(pxt.sprite.getGalleryItems(this.blocksInfo,"Image"),["tile"]).map(e=>({bitmap:pxt.sprite.getBitmap(this.blocksInfo,e.qName).data(),tags:e.tags,qualifiedName:e.qName,tileWidth:16}))),null!=t&&t.galleryTiles&&(i=t.galleryTiles.map(e=>({bitmap:e.bitmap,tags:e.tags,qualifiedName:e.qName,tileWidth:16}))),this.ref.openAsset(e,i)}loadJres(e){this.ref&&this.ref.loadJres(e)}setImageEditorShortcutsEnabled(e){e&&this.shortcutLock?((0,s.releaseShortcutLock)(this.shortcutLock),this.shortcutLock=void 0):e||this.shortcutLock||(this.shortcutLock=(0,s.obtainShortcutLock)())}}i.ImageFieldEditor=l;class S extends n.Component{constructor(){super(...arguments),this.clickHandler=e=>{this.props.onAssetSelected(e)}}render(){var{items:e,hidden:t,onEscape:i}=this.props;return(0,y.jsx)(w.FocusTrapRegion,Object.assign({className:(0,I.classList)("image-editor-gallery",e&&!t&&"visible"),enabled:!t,onEscape:i},{children:!t&&(null==e?void 0:e.map((e,t)=>(0,y.jsx)(o.AssetCardView,{asset:e,selected:!1,onClick:this.clickHandler},t)))}))}}(class extends n.Component{});function c(e){pxt.tickEvent("image.editor",{action:e})}},{"../../../react-common/components/controls/EditorToggle":147,"../../../react-common/components/controls/FocusTrap":151,"../../../react-common/components/util":154,"../assets":157,"../util":203,"./FilterPanel":158,"./ImageEditor/ImageEditor":163,"./ImageEditor/keyboardShortcuts":172,"./ImageEditor/store/imageReducer":174,"./MusicFieldEditor":181,"./assetEditor/assetCard":184,react:268,"react/jsx-runtime":269}],181:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MusicFieldEditor=void 0;let n=e("react/jsx-runtime");var o=e("react");let r=e("./musicEditor/MusicEditor");class s extends o.Component{constructor(e){super(e),this.onSongChanged=e=>{this.mostRecentValue=e},this.onAssetNameChanged=e=>{this.setState({editingSong:Object.assign(Object.assign({},this.state.editingSong),{meta:Object.assign(Object.assign({},this.state.editingSong.meta),{displayName:e})})})},this.state={editRef:0}}render(){var e=this.props.onDoneClicked,t=this.state.editingSong;return(0,n.jsx)("div",Object.assign({className:"music-field-editor"},{children:t&&(0,n.jsx)(r.MusicEditor,{asset:t,onSongChanged:this.onSongChanged,onAssetNameChanged:this.onAssetNameChanged,editRef:this.state.editRef,onDoneClicked:e,hideDoneButton:this.props.hideDoneButton})}))}getAsset(){if(this.state.editingSong)return Object.assign(Object.assign({},this.state.editingSong),{song:this.mostRecentValue||this.state.editingSong.song})}openAsset(e){pxt.assets.music.inflateSong(e.song),this.setState({editingSong:e,editRef:this.state.editRef+1})}openGalleryAsset(e){}getJres(){return""}loadJres(e){}disableResize(){}onResize(){}getPersistentData(){}restorePersistentData(e){}}i.MusicFieldEditor=s},{"./musicEditor/MusicEditor":189,react:268,"react/jsx-runtime":269}],182:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.dispatchUpdateGalleryAssets=i.dispatchUpdateUserAssets=i.dispatchChangeGalleryView=i.dispatchChangeSelectedAsset=void 0;let n=e("./types");i.dispatchChangeSelectedAsset=(e,t)=>({type:n.CHANGE_SELECTED_ASSET,assetType:e,assetId:t}),i.dispatchChangeGalleryView=(e,t,i)=>({type:n.CHANGE_GALLERY_VIEW,view:e,assetType:t,assetId:i}),i.dispatchUpdateUserAssets=()=>({type:n.UPDATE_USER_ASSETS});i.dispatchUpdateGalleryAssets=()=>({type:n.UPDATE_GALLERY_ASSETS})},{"./types":183}],183:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.UPDATE_GALLERY_ASSETS=i.UPDATE_USER_ASSETS=i.CHANGE_GALLERY_VIEW=i.CHANGE_SELECTED_ASSET=void 0,i.CHANGE_SELECTED_ASSET="CHANGE_SELECTED_ASSET",i.CHANGE_GALLERY_VIEW="CHANGE_GALLERY_VIEW",i.UPDATE_USER_ASSETS="UPDATE_USER_ASSETS",i.UPDATE_GALLERY_ASSETS="UPDATE_GALLERY_ASSETS"},{}],184:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.AssetCard=i.AssetCardView=void 0;let r=e("react/jsx-runtime");var n=e("react"),o=e("react-redux");let s=e("./store/assetEditorReducerState");var a=e("./actions/dispatch");let l=e("./assetPreview"),c=e("../../util"),u=e("../../assets");class d extends n.Component{constructor(){super(...arguments),this.clickHandler=()=>{var{type:e,id:t}=this.props.asset;this.props.dispatchChangeSelectedAsset(e,t)}}render(){var{asset:e,selected:t}=this.props;return(0,r.jsx)(h,{asset:e,selected:t,onClick:this.clickHandler})}}class h extends n.Component{constructor(){super(...arguments),this.clickHandler=()=>{this.props.onClick(this.props.asset)}}render(){var{asset:e,selected:t}=this.props,i=(0,s.isGalleryAsset)(e),n=(0,u.getIconClassForAssetType)(e.type),o=n||!(null!=(o=e.meta)&&o.displayName);return(0,r.jsxs)("div",Object.assign({className:"asset-editor-card "+(t?"selected":""),onClick:this.clickHandler,role:"listitem",tabIndex:0,onKeyDown:c.fireClickOnEnter},{children:[(0,r.jsx)(l.AssetPreview,{asset:e}),o&&(0,r.jsxs)("div",Object.assign({className:"asset-editor-card-label"},{children:[n&&(0,r.jsx)("div",Object.assign({className:"asset-editor-card-icon"},{children:(0,r.jsx)("i",{className:"icon "+n})})),!(null!=(t=e.meta)&&t.displayName)&&!i&&(0,r.jsx)("div",Object.assign({className:"asset-editor-card-icon warning"},{children:(0,r.jsx)("i",{className:"icon exclamation triangle"})}))]}))]}))}}i.AssetCardView=h;e={dispatchChangeSelectedAsset:a.dispatchChangeSelectedAsset};i.AssetCard=(0,o.connect)(function(e,t){return e?{selected:e.selectedAsset&&t.asset.id==e.selectedAsset.id}:{}},e)(d)},{"../../assets":157,"../../util":203,"./actions/dispatch":182,"./assetPreview":185,"./store/assetEditorReducerState":186,react:268,"react-redux":251,"react/jsx-runtime":269}],185:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.AssetPreview=void 0;let n=e("react/jsx-runtime"),s=e("react");i.AssetPreview=e=>{var t=e.asset,i=t.meta.displayName||(t.meta.temporaryInfo?lf("Temporary Asset"):t.id);return(0,n.jsx)("div",Object.assign({className:"asset-editor-preview",title:i},{children:"json"===t.type?(0,n.jsx)(r,Object.assign({},e)):(0,n.jsx)(o,Object.assign({},e))}))};let o=e=>{let t,o=e.asset,r=s.useRef(null),i="animation"===o.type&&1<(null==(t=o.framePreviewURIs)?void 0:t.length);return s.useEffect(()=>{if(i&&r.current){let t,e=0,i=()=>{t=setInterval(()=>{r.current&&(r.current.src=o.framePreviewURIs[e]),e=(e+1)%o.framePreviewURIs.length},Math.max(o.interval,100))},n=()=>{clearInterval(t)};return r.current.addEventListener("mouseenter",i),r.current.addEventListener("mouseleave",n),()=>{var e;t&&clearInterval(t),null!=(e=r.current)&&e.removeEventListener("mouseenter",i),null!=(e=r.current)&&e.removeEventListener("mouseleave",n)}}},[o,i]),(0,n.jsx)("img",{src:o.previewURI,alt:lf("A preview of your asset (eg image, tile, animation)"),ref:r,loading:"lazy"})},r=e=>{e=e.asset,e=e.meta.displayName||lf("Untitled");return(0,n.jsx)("div",Object.assign({className:"json-asset-preview"},{children:(0,n.jsx)("div",{children:e})}))}},{react:268,"react/jsx-runtime":269}],186:[function(e,t,i){var n;Object.defineProperty(i,"__esModule",{value:!0}),i.isGalleryAsset=i.GalleryView=void 0,(n=i.GalleryView||(i.GalleryView={}))[n.User=0]="User",n[n.Gallery=1]="Gallery",i.isGalleryAsset=function(e){return null==e?void 0:e.id.startsWith("sprites.")}},{}],187:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.EditControls=void 0;let c=e("react/jsx-runtime"),u=e("react"),d=e("../../../../react-common/components/controls/Button"),h=e("../../../../react-common/components/controls/Input"),p=e("../../assets");i.EditControls=e=>{let{onAssetNameChanged:i,onDoneClicked:t,assetName:n,hideDoneButton:o}=e,[r,s]=u.useState(),[a,l]=u.useState();e=e=>{let t=null;e=e.trim();e?(pxt.validateAssetName(e)?(0,p.isNameTaken)(e)&&e!==n&&(t=lf("This name is already used elsewhere in your project")):t=lf("Names may only contain letters, numbers, '-', '_', and space"),t?(s(e),l(t)):(i(e),s(void 0),l(void 0))):(s(void 0),l(void 0))};return(0,c.jsxs)("div",Object.assign({className:"music-editor-edit-controls"},{children:[a&&(0,c.jsx)("div",Object.assign({className:"music-editor-name-error"},{children:a})),(0,c.jsx)(h.Input,{placeholder:lf("Asset Name"),initialValue:n||r,onBlur:e,onEnterKey:e}),!o&&(0,c.jsx)(d.Button,{className:"green",title:lf("Done"),label:lf("Done"),onClick:t})]}))}},{"../../../../react-common/components/controls/Button":143,"../../../../react-common/components/controls/Input":152,"../../assets":157,react:268,"react/jsx-runtime":269}],188:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.GridHighlight=void 0;let r=e("react/jsx-runtime"),s=e("./svgConstants");i.GridHighlight=e=>{var{start:e,end:t,ticksPerBeat:i}=e,n=null!=e&&null!=t,o=Math.min(e,t),e=Math.max(e,t);return n?(0,r.jsxs)("g",{children:[(0,r.jsx)("rect",{fill:"#03adfc",x:(0,s.tickToX)(i,o),y:s.STAFF_HEADER_HEIGHT-s.STAFF_GRID_TICK_HEIGHT,width:(0,s.tickToX)(i,e)-(0,s.tickToX)(i,o),height:s.STAFF_GRID_TICK_HEIGHT}),(0,r.jsx)("rect",{fill:"#03adfc",x:(0,s.tickToX)(i,o),y:s.BASS_STAFF_TOP+s.STAFF_HEADER_HEIGHT-s.STAFF_GRID_TICK_HEIGHT,width:(0,s.tickToX)(i,e)-(0,s.tickToX)(i,o),height:s.STAFF_GRID_TICK_HEIGHT})]}):(0,r.jsx)("g",{})}},{"./svgConstants":201,"react/jsx-runtime":269}],189:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.MusicEditor=void 0;let P=e("react/jsx-runtime"),B=e("react"),F=e("./EditControls"),U=e("./keyboardNavigation"),H=e("./playback"),G=e("./PlaybackControls"),V=e("./ScrollableWorkspace"),j=e("./TrackSelector"),W=e("./utils");i.MusicEditor=e=>{let{asset:t,onSongChanged:n,savedUndoStack:i,onAssetNameChanged:o,editRef:r,onDoneClicked:s,hideDoneButton:a}=e,[h,l]=B.useState(0);var[e,c]=B.useState("1/8");let[p,u]=B.useState(t.song),[g,d]=B.useState(!1),[f,m]=B.useState(!1),[b,_]=B.useState(i||[]),[y,v]=B.useState([]);var[T,E]=B.useState(r);let[k,C]=B.useState(),[I,w]=B.useState(),[S,x]=B.useState(!1);var[R,$]=B.useState((0,W.doesSongUseBassClef)(t.song));B.useEffect(()=>()=>{(0,H.stopPlayback)()},[]),B.useEffect(()=>{let e=e=>{k&&(e.preventDefault(),e.stopPropagation(),e.clipboardData.setData("application/makecode-song",JSON.stringify(k)))},t=e=>{k&&(e.preventDefault(),e.stopPropagation(),e.clipboardData.setData("application/makecode-song",JSON.stringify(k)),e=(0,W.applySelection)(k,f?h:void 0),L((0,W.deleteSelectedNotes)(e),!0))},i=t=>{t=t.clipboardData.getData("application/makecode-song");if(t){t=JSON.parse(t);let e;e=k?{originalSong:(0,W.unselectAllNotes)((0,W.applySelection)(k,f?h:void 0)),pastedContent:t,startTick:k.startTick,endTick:k.startTick+(t.endTick-t.startTick),deltaTick:0,transpose:0}:{originalSong:p,pastedContent:t,startTick:0,endTick:t.endTick-t.startTick,deltaTick:0,transpose:0},L((0,W.applySelection)(e,f?h:void 0),!1),C(e)}};return document.addEventListener("copy",e),document.addEventListener("cut",t),document.addEventListener("paste",i),()=>{document.removeEventListener("copy",e),document.removeEventListener("cut",t),document.removeEventListener("paste",i)}},[k,f,p]),T!==r&&(E(r),u(t.song));let O=B.useRef(),A=g?1:((e,t)=>{switch(e){case"1/4":return t;case"1/8":return t/2;case"1/16":return t/4;case"1/32":return t/8}})(e,p.ticksPerBeat),N=!!p.tracks[h].drums,L=(e,t)=>{(0,H.isPlaying)()&&(0,H.updatePlaybackSongAsync)(e);var i=b.slice();t&&(i.push(pxt.assets.music.cloneSong((null==k?void 0:k.originalSong)||(null==(t=O.current)?void 0:t.original)||p)),_(i),v([])),u(e),n&&n(e),O.current&&(O.current.editing=e)},D=()=>{var e;C(void 0);let t;return"move"===(null==(e=null==O?void 0:O.current)?void 0:e.dragType)?t=(0,W.unselectAllNotes)(O.current.editing):(0,W.findSelectedRange)(p)&&(t=(0,W.unselectAllNotes)(p)),t&&(L(t,!0),"move"===(null==(e=null==O?void 0:O.current)?void 0:e.dragType))&&(O.current=void 0),t},M=e=>{I?w(Object.assign(Object.assign({},I),{tick:e})):w({tick:e,gridTicks:A,track:h,bassClef:!1,hideTracksActive:f,selection:k})};return(0,P.jsxs)("div",Object.assign({className:"music-editor"},{children:[(0,P.jsx)(j.TrackSelector,{song:p,selected:h,onTrackSelected:e=>{D(),x(!1);var t=p.tracks[e];t.drums?pxsim.music.playDrumAsync(t.drums[0]):pxsim.music.playNoteAsync((0,W.rowToNote)(t.instrument.octave,6,!1,!!t.drums).note,t.instrument,pxsim.music.tickToMs(p.beatsPerMinute,p.ticksPerBeat,p.ticksPerBeat/2)),l(e),I&&w(Object.assign(Object.assign({},I),{track:e})),g&&d(!1)},eraserActive:g,onEraserClick:()=>{D(),x(!1),d(!g)},hideTracksActive:f,onHideTracksClick:()=>{D(),x(!1),m(!f)},selectedResolution:e,onResolutionSelected:c}),(0,P.jsx)(V.ScrollableWorkspace,{song:p,selectedTrack:h,eraserActive:g,onWorkspaceClick:(a,t)=>{x(!1);let e=p.tracks[h],i=e.instrument,n=(0,W.findPreviousNoteEvent)(p,h,a.tick);var o=(0,W.findPreviousNoteEvent)(p,h,a.exactTick);D(),M(a.tick);let r=e=>(0,W.isBassClefNote)(i.octave,e,N)===a.isBassClef&&(0,W.noteToRow)(i.octave,e,N)===a.row,s,l;if((null==o?void 0:o.startTick)===a.exactTick&&o.notes.some(r)?(s=a.exactTick,l=o):(null==n?void 0:n.startTick)===a.tick&&n.notes.some(r)&&(s=a.tick,l=n),l){o=(0,W.unselectAllNotes)(p);if(t&&!N){var t=l.notes.find(r),c=12*i.octave-20,u=12*i.octave+20,d=(0,W.removeNoteAtRowFromTrack)(o,h,a.row,a.isBassClef,s);let e;e="normal"===t.enharmonicSpelling&&t.note<u?"sharp":"sharp"===t.enharmonicSpelling&&t.note>c||t.note===u?"flat":"normal";c=(0,W.rowToNote)(i.octave,a.row,a.isBassClef,N,e);L((0,W.addNoteToTrack)(d,h,c,l.startTick,l.endTick),!0),pxsim.music.playNoteAsync(c.note,i,pxsim.music.tickToMs(p.beatsPerMinute,p.ticksPerBeat,l.endTick-l.startTick))}else L((0,W.removeNoteAtRowFromTrack)(o,h,a.row,a.isBassClef,s),!0)}else if(g){let r=p,s=!1;for(let o=0;o<p.tracks.length;o++)if(!f||o===h){let e=p.tracks[o],t=e.instrument,i=!!e.drums,n=e=>(0,W.isBassClefNote)(t.octave,e,i)===a.isBassClef&&(0,W.noteToRow)(t.octave,e,i)===a.row;for(let e of(0,W.findNoteEventsOverlappingRange)(p,o,a.exactTick-1,a.exactTick+1))e.notes.some(n)&&(r=(0,W.removeNoteAtRowFromTrack)(r,o,a.row,a.isBassClef,e.startTick),s=!0)}s&&L(r,!1)}else{t=(0,W.rowToNote)(i.octave,a.row,a.isBassClef,N),u=p.beatsPerMeasure*p.ticksPerBeat*p.measures;a.tick!==u&&(d=N?1:A,L((0,W.unselectAllNotes)((0,W.addNoteToTrack)(p,h,t,a.tick,a.tick+d)),!0),N?pxsim.music.playDrumAsync(e.drums[t.note]):pxsim.music.playNoteAsync(t.note,i,pxsim.music.tickToMs(p.beatsPerMinute,p.ticksPerBeat,A)))}},onWorkspaceDragStart:()=>{x(!1),O.current?(O.current.editing=p,O.current.original=p,O.current.selectionAtDragStart=k&&Object.assign({},k)):O.current={editing:p,original:p,selectionAtDragStart:k&&Object.assign({},k)}},onWorkspaceDragEnd:()=>{var e,t;"move"===O.current.dragType?(t=O.current.dragEnd.tick-O.current.dragStart.tick,e=O.current.dragEnd.row-(O.current.dragEnd.isBassClef?12:0)-(O.current.dragStart.row-(O.current.dragStart.isBassClef?12:0)),C(Object.assign(Object.assign({},O.current.selectionAtDragStart),{deltaTick:O.current.selectionAtDragStart.deltaTick+t,transpose:O.current.selectionAtDragStart.transpose+e})),O.current.dragStart=void 0,O.current.dragEnd=void 0,O.current.selectionAtDragStart=void 0):("note-length"===O.current.dragType&&D(),pxt.assets.music.songEquals(O.current.editing,O.current.original)||L(O.current.editing,!0),"marquee"===O.current.dragType&&((t=(0,W.findSelectedRange)(O.current.editing,A))?C({startTick:t.start,endTick:t.end,deltaTick:0,transpose:0,originalSong:O.current.editing}):C(void 0)),O.current=void 0)},onWorkspaceDrag:(t,i)=>{if(M(i.tick),g){if(11<i.row||i.row<0)return;var n=O.current.dragEnd||i;O.current.dragEnd=i;let a=p,l=!1;var e=11-n.row+(n.isBassClef?12:0);pxt.Util.bresenhamLine(n.tick,e,i.tick,11-i.row+(i.isBassClef?12:0),(e,t)=>{let n={tick:e,exactTick:e,isBassClef:12<=t,row:11-t%12};for(let e=0;e<p.tracks.length;e++)if(!f||e===h){var o=p.tracks[e];let t=o.instrument,i=!!o.drums;var r,s=e=>(0,W.isBassClefNote)(t.octave,e,i)===n.isBassClef&&(0,W.noteToRow)(t.octave,e,i)===n.row;for(r of(0,W.findNoteEventsOverlappingRange)(p,e,n.exactTick-1,n.exactTick+1))r.notes.some(s)&&(a=(0,W.removeNoteAtRowFromTrack)(a,e,n.row,n.isBassClef,r.startTick),l=!0)}}),void(l&&L(a,!1))}else if(O.current.dragType=void 0,O.current.dragStart=t,O.current.dragEnd=i,O.current.original.tracks[h].drums)L((0,W.fillDrums)(O.current.original,h,t.row,t.isBassClef,t.tick,i.tick,A),!1);else{if(O.current.selectionAtDragStart){var n=(0,W.findNoteEventAtPosition)(O.current.original,t,f?h:void 0);if(null!=n&&n.selected)return O.current.dragType="move",e=i.tick-t.tick,n=i.row-(i.isBassClef?12:0)-(t.row-(t.isBassClef?12:0)),e=Object.assign(Object.assign({},O.current.selectionAtDragStart),{deltaTick:e+O.current.selectionAtDragStart.deltaTick,transpose:n+O.current.selectionAtDragStart.transpose}),n=(0,W.applySelection)(e,f?h:void 0),L(n,!1),void C(e)}n=(0,W.findPreviousNoteEvent)(O.current.original,h,t.exactTick);if(!N&&n&&t.exactTick>=n.startTick&&t.exactTick<n.endTick){let e=!1;for(var o of n.notes)if((0,W.noteToRow)(p.tracks[h].instrument.octave,o,!1)===t.row){e=!0;break}if(e)return i.tick<n.startTick+1?void 0:(C(void 0),O.current.dragType="note-length",void L((0,W.editNoteEventLength)(O.current.original,h,n.startTick,i.tick),!1))}C({startTick:t.tick,endTick:i.tick,deltaTick:0,transpose:0,originalSong:O.current.editing}),L((0,W.selectNoteEventsInRange)(O.current.original,t.tick,i.tick,f?h:void 0),!1),O.current.dragType="marquee"}},gridTicks:A,hideUnselectedTracks:f,showBassClef:R,selection:k,cursor:S?I:void 0,onKeydown:e=>{x(!0);let t=I;(t=t||{tick:0,gridTicks:A,track:h,bassClef:!1,hideTracksActive:f,selection:k}).gridTicks=A,t.track=h,t.selection=k,t.hideTracksActive=f;var[e,i]=(0,U.handleKeyboardEvent)(p,t,e);pxt.assets.music.songEquals(e,p)||L(e,!i.selection),i.selection?C(i.selection):C(void 0),w(i)}}),(0,P.jsx)(G.PlaybackControls,{song:p,onTempoChange:e=>{D(),x(!1),L(Object.assign(Object.assign({},p),{beatsPerMinute:e}),!0)},onMeasuresChanged:e=>{D(),x(!1),L((0,W.changeSongLength)(p,e),!0)},onUndoClick:()=>{var e;b.length&&(v(y.concat([p])),e=b.pop(),_(b.slice()),L(e,!1))},onRedoClick:()=>{var e;y.length&&(_(b.concat([p])),e=y.pop(),v(y.slice()),L(e,!1))},showBassClef:R,onBassClefCheckboxClick:$,hasUndo:!!b.length,hasRedo:!!y.length}),(0,P.jsx)(F.EditControls,{assetName:t.meta.displayName,onAssetNameChanged:o,onDoneClicked:s,hideDoneButton:a})]}))}},{"./EditControls":187,"./PlaybackControls":192,"./ScrollableWorkspace":193,"./TrackSelector":196,"./keyboardNavigation":199,"./playback":200,"./utils":202,react:268,"react/jsx-runtime":269}],190:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Note=void 0;let l=e("react/jsx-runtime"),c=e("../../../../react-common/components/util"),u=e("./svgConstants"),d=e("./utils");i.Note=e=>{var{row:e,iconURI:t,length:i,opacity:n,enharmonicSpelling:o,isBassClef:r,selected:s,cursorHighlighted:a}=e;return(0,l.jsxs)("g",Object.assign({className:(0,c.classList)("music-staff-note",s&&"selected",a&&"cursor-highlighted"),transform:`translate(${-u.NOTE_ICON_WIDTH/2}, ${(0,u.rowY)(e,r)-u.NOTE_ICON_WIDTH/2})`},{children:[0===e&&(0,l.jsx)("line",{className:"music-staff-row",x1:-u.NOTE_ICON_WIDTH/2,y1:u.NOTE_ICON_WIDTH/2,x2:3*u.NOTE_ICON_WIDTH/2,y2:u.NOTE_ICON_WIDTH/2,opacity:n}),!!i&&(0,l.jsx)("rect",{x:u.NOTE_ICON_WIDTH/2,y:u.NOTE_ICON_WIDTH/2-u.NOTE_DURATION_HEIGHT/2,width:i,height:u.NOTE_DURATION_HEIGHT}),(0,l.jsx)("image",Object.assign({x:0,y:0,width:u.NOTE_ICON_WIDTH,height:u.NOTE_ICON_WIDTH,href:(0,d.resolveImageURL)(t),opacity:n},{children:(0,l.jsx)("animate",{attributeName:"y",values:"0;-7;-10;-7;0",dur:"0.25s",repeatCount:"1",begin:"indefinite"})})),o&&"normal"!==o&&(0,l.jsx)("text",Object.assign({x:u.NOTE_ICON_WIDTH,y:0,fontSize:u.NOTE_ICON_WIDTH/2},{children:"sharp"===o?"â™¯":"â™­"}))]}))}},{"../../../../react-common/components/util":154,"./svgConstants":201,"./utils":202,"react/jsx-runtime":269}],191:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.NoteGroup=void 0;let h=e("react/jsx-runtime"),p=e("react"),g=e("./Note"),f=e("./playback"),m=e("./svgConstants"),b=e("./utils");i.NoteGroup=e=>{let{song:t,noteEvent:o,octave:r,iconURI:s,isDrumTrack:a,cursor:l}=e,n,c="music-note-playing";p.useEffect(()=>{let i=!1,e=e=>{if(e>=o.startTick&&e<o.endTick){if(!i){i=!0,n.classList.add(c);var t=n.querySelectorAll("animate");for(let e=0;e<t.length;e++)t.item(e).beginElement()}}else i&&(i=!1,n.classList.remove(c))},t=()=>{i&&(i=!1,n.classList.remove(c))};return(0,f.addTickListener)(e),(0,f.addPlaybackStateListener)(t),()=>{(0,f.removeTickListener)(e),(0,f.removePlaybackStateListener)(t),n.classList.remove(c)}},[o]);e=(0,m.tickToX)(t.ticksPerBeat,o.startTick);let u=a?0:(0,m.tickToX)(t.ticksPerBeat,o.endTick)-e,d=(null==l?void 0:l.tick)===o.startTick;return(0,h.jsx)("g",Object.assign({className:"music-staff-note-group",transform:`translate(${e}, 0)`,ref:e=>{e&&(n=e)}},{children:o.notes.map((e,t)=>{var i=(0,b.isBassClefNote)(r,e,a),n=(0,b.noteToRow)(r,e,a);return(0,h.jsx)(g.Note,{isBassClef:i,row:n,enharmonicSpelling:e.enharmonicSpelling,iconURI:s,length:u,selected:o.selected,cursorHighlighted:d&&l.noteGroupIndex===t},t)})}))}},{"./Note":190,"./playback":200,"./svgConstants":201,"./utils":202,react:268,"react/jsx-runtime":269}],192:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.PlaybackControls=void 0;let p=e("react/jsx-runtime"),g=e("react"),f=e("../../../../react-common/components/controls/Button"),m=e("../../../../react-common/components/controls/Checkbox"),b=e("../../../../react-common/components/controls/Input"),_=e("../../../../react-common/components/util"),y=e("./playback");i.PlaybackControls=e=>{let{song:t,onTempoChange:i,onMeasuresChanged:n,onUndoClick:o,onRedoClick:r,hasUndo:s,hasRedo:a,showBassClef:l,onBassClefCheckboxClick:c}=e,[u,d]=g.useState("stop");g.useEffect(()=>{let e=e=>{d(e)};return(0,y.addPlaybackStateListener)(e),()=>(0,y.removePlaybackStateListener)(e)},[]);var e=e=>{e=parseFloat(e);Number.isNaN(e)||(e=Math.min(500,Math.max(20,Math.floor(e))),i(e))},h=e=>{e=parseInt(e);isNaN(e)||e<1||50<e||n(e)};return(0,p.jsxs)("div",Object.assign({className:"music-playback-controls"},{children:[(0,p.jsxs)("div",Object.assign({className:"music-playback-buttons"},{children:[(0,p.jsx)(f.Button,{className:"square-button",title:lf("Stop"),leftIcon:"fas fa-stop",onClick:()=>{(0,y.stopPlayback)(),d("stop")}}),(0,p.jsx)(f.Button,{className:(0,_.classList)("square-button","play"===u&&"green"),title:lf("Play"),leftIcon:"fas fa-play",onClick:()=>{(0,y.startPlaybackAsync)(t,!1,0),d("play")}}),(0,p.jsx)(f.Button,{className:(0,_.classList)("square-button","loop"===u&&"green"),title:lf("Loop"),leftIcon:"fas fa-retweet",onClick:()=>{(0,y.isLooping)()||((0,y.isPlaying)()?(0,y.setLooping)(!0):(0,y.startPlaybackAsync)(t,!0,0),d("loop"))}})]})),(0,p.jsx)(b.Input,{id:"music-playback-tempo-input music-editor-label",label:lf("Tempo:"),initialValue:t.beatsPerMinute.toString(),onBlur:e,onEnterKey:e}),(0,p.jsx)("div",{className:"spacer"}),(0,p.jsx)(m.Checkbox,{className:"music-editor-label",id:"show-bass-clef",label:lf("Show bass clef"),isChecked:l,onChange:c}),(0,p.jsxs)("div",Object.assign({className:"music-undo-redo common-button-group"},{children:[(0,p.jsx)(f.Button,{className:"square-button purple",title:lf("Undo"),leftIcon:"xicon undo",disabled:!s,onClick:o}),(0,p.jsx)(f.Button,{className:"square-button purple",title:lf("Redo"),leftIcon:"xicon redo",disabled:!a,onClick:r})]})),(0,p.jsxs)("div",Object.assign({className:"music-playback-measures"},{children:[(0,p.jsx)("div",Object.assign({className:"music-editor-label"},{children:lf("Measures:")})),(0,p.jsx)(f.Button,{className:"menu-button",title:lf("Remove measure"),leftIcon:"fas fa-minus-circle",onClick:()=>{1<t.measures&&n(t.measures-1)}}),(0,p.jsx)(b.Input,{id:"music-playback-measures-input",initialValue:t.measures.toString(),onBlur:h,onEnterKey:h}),(0,p.jsx)(f.Button,{className:"menu-button",title:lf("Add measure"),leftIcon:"fas fa-plus-circle",onClick:()=>{t.measures<50&&n(t.measures+1)}})]}))]}))}},{"../../../../react-common/components/controls/Button":143,"../../../../react-common/components/controls/Checkbox":145,"../../../../react-common/components/controls/Input":152,"../../../../react-common/components/util":154,"./playback":200,react:268,"react/jsx-runtime":269}],193:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ScrollableWorkspace=void 0;let n=e("react/jsx-runtime"),o=e("react"),c=e("./svgConstants"),u=e("./utils"),r=e("./Workspace");i.ScrollableWorkspace=e=>{let{cursor:s,song:a}=e,l=o.useRef(null);return o.useEffect(()=>{if(s){var t=(0,c.tickToX)(a.ticksPerBeat,s.tick);let i=l.current.querySelector("svg");var n=e=>{var t=i.createSVGPoint();return t.x=e,t.y=0,t.matrixTransform(i.getScreenCTM()).x},o=n(t),r=(0,u.findNoteEventAtTick)(a,s.track,s.tick),t=n(t+c.BEAT_WIDTH)-o;let e;e=r?n((0,c.tickToX)(a.ticksPerBeat,r.endTick+a.ticksPerBeat/2))-o:t;n=l.current.getBoundingClientRect(),r=o-n.x,o=r+e;r<t?l.current.scrollLeft+=r-t:e<n.width&&o>n.width&&(l.current.scrollLeft+=o-n.width)}},[null==s?void 0:s.tick,a.ticksPerBeat]),(0,n.jsx)("div",Object.assign({ref:l,className:"music-scrollable-workspace"},{children:(0,n.jsx)("div",Object.assign({className:"music-scroller"},{children:(0,n.jsx)(r.Workspace,Object.assign({},e))}))}))}},{"./Workspace":197,"./svgConstants":201,"./utils":202,react:268,"react/jsx-runtime":269}],194:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Staff=void 0;let m=e("react/jsx-runtime"),b=e("react"),_=e("../../../../react-common/components/util"),y=e("./playback"),v=e("./svgConstants"),T=e("./utils");i.Staff=e=>{let{top:t,isBassClef:i,gridTicks:n,ticksPerBeat:c,beatsPerMeasure:o,beatsPerMinute:u,measures:r}=e,d;b.useEffect(()=>{let t=pxsim.music.tickToMs(u,c,1),i=(0,v.tickToX)(c,2)-(0,v.tickToX)(c,1),n=0,o=!1,r,s,e=e=>{n=(0,v.tickToX)(c,e),s=Date.now(),o||(o=!0,d.style.display="unset",r=requestAnimationFrame(l))},a=()=>{o=!1,d.style.display="none",r&&cancelAnimationFrame(r)},l=()=>{var e=n+i*(Date.now()-s)/t;d.setAttribute("transform",`translate(${e}, 0)`),o&&(r=requestAnimationFrame(l))};return(0,y.addTickListener)(e),(0,y.addPlaybackStateListener)(a),()=>{(0,y.removeTickListener)(e),(0,y.removePlaybackStateListener)(a),r&&cancelAnimationFrame(r)}},[c,u]);var s=(0,v.workspaceWidth)(r,o),a=[];for(let e=0;e<5;e++)a.push((0,m.jsx)("line",{className:"music-staff-row",x1:0,y1:(0,v.rowY)(2*e+2,!1),x2:s,y2:(0,v.rowY)(2*e+2,!1)},e));var l=[],h=n;for(let e=0;e<r*o*c;e+=h){var p=e%c==0,g=e%(o*c)==0,f=!p&&!g;l.push((0,m.jsxs)("g",{children:[g&&!i&&(0,m.jsx)("text",Object.assign({x:(0,v.tickToX)(c,e),y:v.STAFF_HEADER_HEIGHT-v.STAFF_HEADER_OFFSET,textAnchor:"middle",fontSize:v.STAFF_HEADER_FONT_SIZE},{children:Math.floor(e/(o*c))+1})),(0,m.jsx)("line",{className:"music-staff-column",x1:(0,v.tickToX)(c,e),y1:v.STAFF_HEADER_HEIGHT-v.STAFF_GRID_TICK_HEIGHT,x2:(0,v.tickToX)(c,e),y2:v.STAFF_HEADER_HEIGHT}),!f&&(0,m.jsx)("line",{className:(0,_.classList)("music-staff-column",p&&"beat-start",g&&"measure-start"),x1:(0,v.tickToX)(c,e),y1:i&&g?0:v.STAFF_HEADER_HEIGHT,x2:(0,v.tickToX)(c,e),y2:v.WORKSPACE_HEIGHT})]},e))}return(0,m.jsxs)("g",Object.assign({className:"music-staff",transform:`translate(0 ${t})`},{children:[(0,m.jsx)("rect",{className:"music-staff-background",x:0,y:v.STAFF_HEADER_HEIGHT,width:s,height:v.WORKSPACE_HEIGHT-v.STAFF_HEADER_HEIGHT}),(0,m.jsx)("image",{className:"music-staff-clef",href:(0,T.resolveImageURL)(i?"music-editor/bass-clef.svg":"music-editor/treble-clef.svg"),height:i?v.BASS_CLEF_HEIGHT:v.CLEF_HEIGHT,x:0,y:i?v.BASS_CLEF_TOP:v.STAFF_HEADER_HEIGHT}),(0,m.jsx)("rect",{fill:"#000",x:0,y:v.STAFF_HEADER_HEIGHT-v.STAFF_GRID_TICK_HEIGHT,width:s,height:v.STAFF_GRID_TICK_HEIGHT}),(0,m.jsx)("rect",{fill:"#dedede",x:v.CLEF_WIDTH,y:v.STAFF_HEADER_HEIGHT-v.STAFF_GRID_TICK_HEIGHT,width:s-v.CLEF_WIDTH-v.STAFF_END_WIDTH,height:v.STAFF_GRID_TICK_HEIGHT}),(0,m.jsx)("g",Object.assign({className:"music-staff-rows"},{children:a})),(0,m.jsx)("g",Object.assign({className:"music-staff-beats"},{children:l})),(0,m.jsxs)("g",Object.assign({className:"music-staff-end"},{children:[(0,m.jsx)("rect",{x:s-v.STAFF_END_WIDTH,y:v.STAFF_HEADER_HEIGHT,width:3,height:v.WORKSPACE_HEIGHT-v.STAFF_HEADER_HEIGHT}),(0,m.jsx)("rect",{x:s-12,y:v.STAFF_HEADER_HEIGHT,width:12,height:v.WORKSPACE_HEIGHT-v.STAFF_HEADER_HEIGHT})]})),(0,m.jsx)("g",Object.assign({className:"music-playback-head",ref:e=>{e&&(d=e)}},{children:(0,m.jsx)("line",{className:"music-playback-line",x1:0,y1:v.STAFF_HEADER_HEIGHT,x2:0,y2:v.WORKSPACE_HEIGHT})}))]}))}},{"../../../../react-common/components/util":154,"./playback":200,"./svgConstants":201,"./utils":202,react:268,"react/jsx-runtime":269}],195:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Track=void 0;let s=e("react/jsx-runtime"),a=e("./Note"),l=e("./NoteGroup"),c=e("./svgConstants");i.Track=e=>{let{song:t,track:i,cursorLocation:n,keyboardCursor:o}=e,r;return n&&(r=(0,s.jsx)("g",Object.assign({transform:`translate(${(0,c.tickToX)(t.ticksPerBeat,n.tick)}, 0)`},{children:(0,s.jsx)(a.Note,{isBassClef:n.isBassClef,row:n.row,iconURI:i.iconURI,opacity:.5})}))),(0,s.jsxs)("g",Object.assign({className:"music-staff-track"},{children:[o&&(0,s.jsx)("g",{children:(0,s.jsx)("rect",{x:(0,c.tickToX)(t.ticksPerBeat,o.tick),y:o.bassClef?c.BASS_STAFF_TOP+c.STAFF_HEADER_HEIGHT:c.STAFF_HEADER_HEIGHT,width:5,height:c.WORKSPACE_HEIGHT-c.STAFF_HEADER_HEIGHT,fill:"purple"})}),i.notes.map(e=>(0,s.jsx)(l.NoteGroup,{noteEvent:e,octave:i.instrument.octave,song:t,iconURI:i.iconURI,isDrumTrack:!!i.drums,cursor:o},e.startTick)),r]}))}},{"./Note":190,"./NoteGroup":191,"./svgConstants":201,"react/jsx-runtime":269}],196:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.TrackSelector=void 0;let u=e("react/jsx-runtime"),d=e("../../../../react-common/components/controls/Button"),h=e("../../../../react-common/components/controls/Checkbox"),p=e("../../../../react-common/components/controls/Dropdown"),g=e("../../../../react-common/components/controls/FocusList"),f=e("../../../../react-common/components/util"),m=e("./utils"),b={four:"1/4",eight:"1/8",sixteen:"1/16",thirtytwo:"1/32"};i.TrackSelector=e=>{let{song:i,selected:n,onTrackSelected:o,selectedResolution:t,onResolutionSelected:r,eraserActive:s,onEraserClick:a,hideTracksActive:l,onHideTracksClick:c}=e;e=[{title:lf("1/4 Note"),label:lf("1/4"),id:"four"},{title:lf("1/8 Note"),label:lf("1/8"),id:"eight"},{title:lf("1/16 Note"),label:lf("1/16"),id:"sixteen"},{title:lf("1/32 Note"),label:lf("1/32"),id:"thirtytwo"}];return(0,u.jsxs)("div",Object.assign({className:"music-track-selector"},{children:[(0,u.jsxs)(g.FocusList,Object.assign({role:"radiogroup",ariaLabel:lf("Track selection")},{children:[i.tracks.map((e,t)=>(0,u.jsx)(d.Button,{role:"radio",ariaSelected:n===t&&!s,ariaPosInSet:t+1,ariaSetSize:i.tracks.length+1,title:e.name,className:(0,f.classList)("music-track-button square-button pixellated",n===t&&!s&&"selected"),label:(0,u.jsx)("img",{src:(0,m.resolveImageURL)(e.iconURI),alt:e.name}),onClick:()=>{var e;e=t,o(e)}},e.name)),(0,u.jsx)(d.Button,{className:(0,f.classList)("music-track-button square-button",s&&"selected"),title:s?lf("Turn off eraser tool"):lf("Turn on eraser tool"),leftIcon:"fas fa-eraser",ariaSelected:s,ariaPosInSet:i.tracks.length,ariaSetSize:i.tracks.length+1,onClick:a})]})),(0,u.jsx)(h.Checkbox,{className:"music-editor-label",id:"hide-tracks",label:lf("Only show selected instrument"),isChecked:l,onChange:c}),(0,u.jsxs)("div",Object.assign({className:"music-track-grid"},{children:[(0,u.jsx)("div",Object.assign({className:"music-editor-label"},{children:lf("Grid:")})),(0,u.jsx)(p.Dropdown,{id:"grid-resolution",ariaLabel:lf("Staff grid resolution"),items:e,selectedId:Object.keys(b).find(e=>b[e]===t),onItemSelected:e=>{r(b[e])}})]}))]}))}},{"../../../../react-common/components/controls/Button":143,"../../../../react-common/components/controls/Checkbox":145,"../../../../react-common/components/controls/Dropdown":146,"../../../../react-common/components/controls/FocusList":148,"../../../../react-common/components/util":154,"./utils":202,"react/jsx-runtime":269}],197:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Workspace=void 0;let S=e("react/jsx-runtime"),x=e("react"),R=e("../../../../react-common/components/util"),O=e("./GridHighlight"),A=e("./Staff"),N=e("./svgConstants"),L=e("./Track"),D=e("./utils"),M=e("./WorkspaceSelection");function $(e,t,i,n){t=(0,R.screenToSVGCoord)(t,(0,R.clientCoord)(e)),e=t.y>N.BASS_STAFF_TOP,n=(0,N.closestTick)(i.ticksPerBeat,t.x+N.BEAT_WIDTH/i.ticksPerBeat,n);return{isBassClef:e,row:(0,N.closestRow)(t.y),tick:n,exactTick:(0,N.closestTick)(i.ticksPerBeat,t.x,1)}}i.Workspace=e=>{let{song:n,onWorkspaceClick:o,gridTicks:r,selectedTrack:i,onWorkspaceDrag:s,onWorkspaceDragStart:a,onWorkspaceDragEnd:l,onKeydown:t,cursor:c,hideUnselectedTracks:u,eraserActive:d,showBassClef:h,selection:p}=e,[g,f]=x.useState(null),[m,b]=x.useState(null),[_,y]=x.useState(!1),v;x.useEffect(()=>{v.onpointerdown=e=>{e.preventDefault(),v.focus();e=$(e,v,n,r);(d||0<=e.tick&&0<=e.row&&e.row<12)&&b(e)},v.onpointermove=e=>{var t,e=$(e,v,n,r);g&&g.exactTick===e.exactTick&&g.row===e.row||(t=n.beatsPerMeasure*n.ticksPerBeat*n.measures,0<=e.tick&&0<=e.row&&e.row<12&&e.tick<=t&&(m&&(_||(y(!0),a(),s(m,m)),s(m,e)),e.tick<t)?f(e):f(null))},v.onpointerleave=e=>{f(null),_&&(l(),y(!1))},v.onpointerup=e=>{b(null);var t=$(e,v,n,r),i=0<=t.tick&&0<=t.row&&t.row<12;_?(i&&s(m,t),l(),y(!1)):i&&o(t,e.ctrlKey)}},[g,m,_,s,l,a]);let T,E,k=_||d?void 0:g;var e=g&&(0,D.findNoteEventAtTick)(n,i,g.tick),C=m&&(0,D.findNoteEventAtTick)(n,i,m.tick),C=(p?(T=p.startTick+p.deltaTick,E=p.endTick+p.deltaTick):!d&&C&&(null==g?void 0:g.tick)>=C.startTick?(T=C.startTick,E=C.endTick):!d&&_&&g&&m?(T=Math.min(g.tick,m.tick),E=Math.max(g.tick,m.tick)):e?(T=e.startTick,E=e.endTick):g&&(T=g.tick,E=g.tick+r),e&&(k=k&&Object.assign(Object.assign({},k),{tick:e.startTick})),n.tracks.filter((e,t)=>t!==i)),e=h?2*N.WORKSPACE_HEIGHT:N.WORKSPACE_HEIGHT,I=pxt.assets.music.getSongInfo(n),w=(0,N.workspaceWidth)(n.measures,n.beatsPerMeasure)+20;return(0,S.jsxs)("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",className:(0,R.classList)("music-workspace",d&&"erasing"),viewBox:`0 0 ${w} `+e,"aria-label":lf("Music Workspace"),tabIndex:0,onKeyDown:t,ref:e=>{e&&(v=e)}},{children:[(0,S.jsxs)("filter",Object.assign({id:"selection-outline"},{children:[(0,S.jsx)("feMorphology",{in:"SourceAlpha",result:"DILATED",operator:"dilate",radius:"4"}),(0,S.jsx)("feFlood",{floodColor:"yellow",floodOpacity:"1",result:"FLOODED"}),(0,S.jsx)("feComposite",{in:"FLOODED",in2:"DILATED",operator:"in",result:"OUTLINE"}),(0,S.jsxs)("feMerge",{children:[(0,S.jsx)("feMergeNode",{in:"OUTLINE"}),(0,S.jsx)("feMergeNode",{in:"SourceGraphic"})]})]})),(0,S.jsxs)("filter",Object.assign({id:"cursor-outline"},{children:[(0,S.jsx)("feMorphology",{in:"SourceAlpha",result:"DILATED",operator:"dilate",radius:"4"}),(0,S.jsx)("feFlood",{floodColor:"purple",floodOpacity:"1",result:"FLOODED"}),(0,S.jsx)("feComposite",{in:"FLOODED",in2:"DILATED",operator:"in",result:"OUTLINE"}),(0,S.jsxs)("feMerge",{children:[(0,S.jsx)("feMergeNode",{in:"OUTLINE"}),(0,S.jsx)("feMergeNode",{in:"SourceGraphic"})]})]})),(0,S.jsx)("rect",{x:"0",y:"0",width:w,height:e,fill:"#FFFFFF",opacity:0}),(0,S.jsx)(A.Staff,Object.assign({},I,{top:0,gridTicks:r})),h&&(0,S.jsx)(A.Staff,Object.assign({},I,{top:N.BASS_STAFF_TOP,isBassClef:!0,gridTicks:r})),(0,S.jsx)(O.GridHighlight,Object.assign({},I,{start:T,end:E})),p&&(0,S.jsx)(M.WorkspaceSelection,Object.assign({},I,{range:p})),!u&&C.map((e,t)=>(0,S.jsx)(L.Track,{track:e,song:n},t)),(0,S.jsx)(L.Track,{track:n.tracks[i],song:n,cursorLocation:k,keyboardCursor:c})]}))}},{"../../../../react-common/components/util":154,"./GridHighlight":188,"./Staff":194,"./Track":195,"./WorkspaceSelection":198,"./svgConstants":201,"./utils":202,react:268,"react/jsx-runtime":269}],198:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.WorkspaceSelection=void 0;let n=e("react/jsx-runtime"),o=e("./svgConstants");i.WorkspaceSelection=e=>{var{range:e,ticksPerBeat:t}=e,i=(0,o.tickToX)(t,e.startTick+e.deltaTick),t=(0,o.tickToX)(t,e.endTick+e.deltaTick);return(0,n.jsxs)("g",{children:[(0,n.jsx)("rect",{className:"music-workspace-selection",fill:"#03adfc",opacity:.5,x:Math.min(i,t),y:o.STAFF_HEADER_HEIGHT,width:Math.max(i,t)-Math.min(i,t),height:o.WORKSPACE_HEIGHT-o.STAFF_HEADER_HEIGHT}),(0,n.jsx)("rect",{className:"music-workspace-selection",fill:"#03adfc",opacity:.5,x:Math.min(i,t),y:o.BASS_STAFF_TOP+o.STAFF_HEADER_HEIGHT,width:Math.max(i,t)-Math.min(i,t),height:o.WORKSPACE_HEIGHT-o.STAFF_HEADER_HEIGHT})]})}},{"./svgConstants":201,"react/jsx-runtime":269}],199:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.handleKeyboardEvent=void 0;let w=e("./playback"),S=e("./utils");i.handleKeyboardEvent=function(r,s,t){var e=t.ctrlKey||t.metaKey,i=t.shiftKey,n=t.altKey,a=s.selection?void 0:(0,S.findNoteEventAtTick)(r,s.track,s.tick);(null==a?void 0:a.startTick)===s.tick&&void 0===s.noteGroupIndex&&(s.noteGroupIndex=0);let l=r,c=Object.assign(Object.assign({},s),{selection:s.selection&&Object.assign({},s.selection)}),u=r.tracks[s.track].instrument,d=u.octave;var o=r.ticksPerBeat*r.beatsPerMeasure,h=o*r.measures,p=!!s.selection;let g=!!r.tracks[s.track].drums;var f,m=e=>{c.selection&&(l=(0,S.applySelection)(c.selection,s.hideTracksActive?s.track:void 0),e&&(l=(0,S.unselectAllNotes)(l)),delete c.selection)},b=e=>{for(var t of e.notes)pxsim.music.playNoteAsync(t.note,u,pxsim.music.tickToMs(l.beatsPerMinute,r.ticksPerBeat,e.endTick-e.startTick))};switch(t.key){case"ArrowUp":case"Up":if(t.preventDefault(),i)c.bassClef=!1;else if(c.selection)c.selection.transpose++,l=(0,S.applySelection)(c.selection);else if(a)if(n&&e)c.noteGroupIndex=a.notes.length-1;else if(n)c.noteGroupIndex=Math.min(s.noteGroupIndex+1,a.notes.length-1);else{var _=a.notes[s.noteGroupIndex];let t=(0,S.isBassClefNote)(d,_,g);var y=(0,S.noteToRow)(d,_,g);let i=y;for(var v=e?12:1;a.notes.some(e=>(0,S.isBassClefNote)(d,e,g)===t&&i===(0,S.noteToRow)(d,e,g));)if(12<=(i+=v)){if(!t)break;t=!1,i-=12}if(12<=i||i<0)break;let n=(0,S.rowToNote)(d,i,t,g,_.enharmonicSpelling);l=(0,S.removeNoteAtRowFromTrack)(l,s.track,y,(0,S.isBassClefNote)(d,_,g),a.startTick),l=(0,S.addNoteToTrack)(l,s.track,n,a.startTick,a.endTick);var y=(0,S.findNoteEventAtTick)(l,s.track,s.tick);c.noteGroupIndex=y.notes.findIndex(e=>e.note===n.note),pxsim.music.playNoteAsync(n.note,u,pxsim.music.tickToMs(l.beatsPerMinute,r.ticksPerBeat,y.endTick-y.startTick))}break;case"ArrowDown":case"Down":if(t.preventDefault(),i)c.bassClef=!0;else if(c.selection)c.selection.transpose--,l=(0,S.applySelection)(c.selection);else if(a)if(n&&e)c.noteGroupIndex=0;else if(n)c.noteGroupIndex=Math.max(s.noteGroupIndex-1,0);else{var T=a.notes[s.noteGroupIndex];let t=l.tracks[s.track],i=(0,S.isBassClefNote)(d,T,!!t.drums);var E=(0,S.noteToRow)(d,T,!!t.drums);let n=E;for(var k=e?-12:-1;a.notes.some(e=>(0,S.isBassClefNote)(d,e,!!t.drums)===i&&n===(0,S.noteToRow)(d,e,!!t.drums));)if((n+=k)<0){if(i)break;i=!0,n+=12}if(12<=n||n<0)break;let o=(0,S.rowToNote)(d,n,i,!!t.drums,T.enharmonicSpelling);l=(0,S.removeNoteAtRowFromTrack)(l,s.track,E,(0,S.isBassClefNote)(d,T,!!t.drums),a.startTick),l=(0,S.addNoteToTrack)(l,s.track,o,a.startTick,a.endTick);var _=(0,S.findNoteEventAtTick)(l,s.track,s.tick);c.noteGroupIndex=_.notes.findIndex(e=>e.note===o.note),pxsim.music.playNoteAsync(o.note,u,pxsim.music.tickToMs(l.beatsPerMinute,r.ticksPerBeat,_.endTick-_.startTick))}break;case"ArrowLeft":case"Left":t.preventDefault(),i&&p&&(c.selection.deltaTick||c.selection.transpose)&&m(!0),e?(c.tick%o==0?c.tick=Math.max(c.tick-o,0):c.tick=Math.floor(c.tick/o)*o,(null==(y=(0,S.findNoteEventAtTick)(l,s.track,c.tick))?void 0:y.startTick)===c.tick?(c.noteGroupIndex=0,b(y)):c.noteGroupIndex=void 0):(E=s.tick%s.gridTicks!=0?Math.floor(c.tick/s.gridTicks)*s.gridTicks:s.tick-s.gridTicks,(null==(T=(0,S.findPreviousNoteEvent)(l,s.track,s.tick-1))?void 0:T.endTick)>E?(c.tick=T.startTick,c.noteGroupIndex=0):(c.tick=Math.max(E,0),c.noteGroupIndex=void 0));break;case"ArrowRight":case"Right":t.preventDefault(),i&&p&&(c.selection.deltaTick||c.selection.transpose)&&m(!0),e?(c.tick%o==0?c.tick=Math.min(c.tick+o,h-o):(c.tick=Math.min(Math.ceil(c.tick/o)*o,h-o),c.tick>=h&&(c.tick-=o)),(null==(_=(0,S.findNoteEventAtTick)(l,s.track,c.tick))?void 0:_.startTick)===c.tick?(c.noteGroupIndex=0,b(_)):c.noteGroupIndex=void 0):(y=a?Math.ceil(a.endTick/s.gridTicks)*s.gridTicks:s.tick+s.gridTicks,(null==(T=(0,S.findNextNoteEvent)(l,s.track,s.tick))?void 0:T.startTick)<=y?(c.tick=T.startTick,c.noteGroupIndex=0):(c.tick=Math.min(Math.ceil(y/s.gridTicks)*s.gridTicks,h-s.gridTicks),c.noteGroupIndex=void 0));break;case"End":t.preventDefault(),e&&(c.tick=h-s.gridTicks,(E=(0,S.findNoteEventAtTick)(l,s.track,c.tick))?(c.tick=E.startTick,c.noteGroupIndex=0,b(E)):c.noteGroupIndex=void 0);break;case"Home":t.preventDefault(),e&&((_=(c.tick=0,S.findNoteEventAtTick)(l,s.track,c.tick))?(c.noteGroupIndex=0,b(_)):c.noteGroupIndex=void 0);break;case"Backspace":if(t.preventDefault(),s.selection)m(),l=(0,S.deleteSelectedNotes)(l);else if(void 0!==s.noteGroupIndex){if(e){l=(0,S.removeNoteEventFromTrack)(l,s.track,s.tick),c.noteGroupIndex=void 0;break}l=(0,S.removeNoteFromTrack)(l,s.track,a.notes[s.noteGroupIndex],a.startTick),1===a.notes.length?c.noteGroupIndex=void 0:c.noteGroupIndex=Math.min(c.noteGroupIndex,a.notes.length-2)}break;case"Enter":p&&m(!0);break;case"Spacebar":case" ":t.preventDefault(),(0,w.isPlaying)()?(0,w.stopPlayback)():i?(0,w.startPlaybackAsync)(r,e,null==s?void 0:s.tick):(0,w.startPlaybackAsync)(r,e,0);break;case"j":case"J":if(!r.tracks[s.track].drums&&a){t.preventDefault();var T=a.notes[c.noteGroupIndex],y=12*u.octave-20,E=12*u.octave+20,_=(0,S.noteToRow)(d,T,!1),C=a.startTick,I=(0,S.isBassClefNote)(d,T,!1);l=(0,S.removeNoteAtRowFromTrack)(l,c.track,_,I,C);let e;e="normal"===T.enharmonicSpelling&&T.note<E?"sharp":"sharp"===T.enharmonicSpelling&&T.note>y||T.note===E?"flat":"normal";C=(0,S.rowToNote)(u.octave,_,I,!1,e);l=(0,S.addNoteToTrack)(l,c.track,C,a.startTick,a.endTick),pxsim.music.playNoteAsync(C.note,u,pxsim.music.tickToMs(l.beatsPerMinute,l.ticksPerBeat,s.gridTicks))}break;default:if(e&&"a"===t.key||"A"===t.key)t.preventDefault(),c.selection&&m(!0),c.selection={startTick:0,endTick:h,originalSong:l,transpose:0,deltaTick:0};else if(/^[a-g]$/i.test(t.key)){if(!e){t.preventDefault(),m(!0);let e;e=s.bassClef?(0,S.rowToNote)(d,3+"abcdefg".indexOf(t.key.toLowerCase()),!0,g):(0,S.rowToNote)(d,5+"abcdefg".indexOf(t.key.toLowerCase()),!1,g),a?-1===a.notes.indexOf(e)&&(l=(0,S.addNoteToTrack)(l,s.track,e,a.startTick,a.endTick),b((0,S.findNoteEventAtTick)(l,s.track,a.startTick))):(l=(0,S.addNoteToTrack)(l,s.track,e,s.tick,s.tick+s.gridTicks),b((c.noteGroupIndex=0,S.findNoteEventAtTick)(l,s.track,s.tick)))}}else if(/^[1-9]$/.test(t.key)){t.preventDefault(),m(!0),a&&(l=(0,S.editNoteEventLength)(l,s.track,a.startTick,a.startTick+parseInt(t.key)*s.gridTicks),b((0,S.findNoteEventAtTick)(l,s.track,a.startTick)));break}}return c.tick!==s.tick&&(i?(c.selection?c.selection.endTick=c.tick:c.selection={originalSong:r,startTick:s.tick,endTick:c.tick,transpose:0,deltaTick:0},l=(0,S.applySelection)(c.selection,c.hideTracksActive?c.track:void 0)):c.selection&&(f=(0,S.selectNoteEventsInRange)(c.selection.originalSong,c.selection.startTick,c.selection.endTick,c.hideTracksActive?c.track:void 0),(f=(0,S.findSelectedRange)(f,c.gridTicks))&&(c.selection.startTick=f.start,c.selection.endTick=f.end),c.selection.deltaTick+=c.tick-s.tick,l=(0,S.applySelection)(c.selection,c.hideTracksActive?c.track:void 0),0<c.selection.startTick+c.selection.deltaTick)&&(c.tick=c.selection.startTick+c.selection.deltaTick)),[l,c]}},{"./playback":200,"./utils":202}],200:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.removePlaybackStateListener=i.addPlaybackStateListener=i.removeTickListener=i.addTickListener=i.stopPlayback=i.updatePlaybackSongAsync=i.setLooping=i.isLooping=i.isPlaying=i.startPlaybackAsync=void 0;let n,o=[],r=[];function s(){return!!n&&"stop"!==n.state()}i.startPlaybackAsync=async function(e,t,i){n||(await(n=new pxsim.music.Sequencer).initAsync(),n.addEventListener("state-change",()=>{for(var e of o)e(n.state())}),n.addEventListener("tick",()=>{for(var e of r)e(n.currentTick())}),n.setVolume(100)),n.startFrom(e,t,i)},i.isPlaying=s,i.isLooping=function(){return s()&&"loop"===n.state()},i.setLooping=function(e){n&&n.setLooping(e)},i.updatePlaybackSongAsync=async function(e){n&&n.updateSong(e)},i.stopPlayback=function(){n&&n.stop()},i.addTickListener=function(e){r.push(e)},i.removeTickListener=function(t){r=r.filter(e=>t!==e)},i.addPlaybackStateListener=function(e){o.push(e)},i.removePlaybackStateListener=function(t){o=o.filter(e=>t!==e)}},{}],201:[function(e,t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.rowY=n.closestRow=n.closestTick=n.beatToX=n.tickToX=n.workspaceWidth=n.BASS_CLEF_HEIGHT=n.BASS_CLEF_TOP=n.BASS_STAFF_HEADER_HEIGHT=n.BASS_STAFF_TOP=n.NOTE_DURATION_HEIGHT=n.NOTE_ICON_WIDTH=n.WORKSPACE_HEIGHT=n.STAFF_GRID_TICK_HEIGHT=n.STAFF_END_WIDTH=n.STAFF_HEADER_OFFSET=n.STAFF_HEADER_FONT_SIZE=n.STAFF_HEADER_HEIGHT=n.CLEF_HEIGHT=n.CLEF_WIDTH=n.STAFF_ROW_HEIGHT=n.BEAT_WIDTH=void 0,n.BEAT_WIDTH=150,n.STAFF_ROW_HEIGHT=50,n.CLEF_WIDTH=250,n.CLEF_HEIGHT=320,n.STAFF_HEADER_HEIGHT=n.STAFF_ROW_HEIGHT,n.STAFF_HEADER_FONT_SIZE=40,n.STAFF_HEADER_OFFSET=11,n.STAFF_END_WIDTH=25,n.STAFF_GRID_TICK_HEIGHT=7,n.WORKSPACE_HEIGHT=n.STAFF_HEADER_HEIGHT+7*n.STAFF_ROW_HEIGHT,n.NOTE_ICON_WIDTH=45,n.NOTE_DURATION_HEIGHT=n.NOTE_ICON_WIDTH/3,n.BASS_STAFF_TOP=n.WORKSPACE_HEIGHT,n.BASS_STAFF_HEADER_HEIGHT=n.STAFF_ROW_HEIGHT/2,n.BASS_CLEF_TOP=90,n.BASS_CLEF_HEIGHT=230,n.workspaceWidth=function(e,t){return n.CLEF_WIDTH+e*t*n.BEAT_WIDTH+n.STAFF_END_WIDTH},n.tickToX=function(e,t){return n.CLEF_WIDTH+n.BEAT_WIDTH/e*t},n.beatToX=function(e){return n.CLEF_WIDTH+n.BEAT_WIDTH*e},n.closestTick=function(e,t,i){return t=Math.floor((t-n.CLEF_WIDTH)*(e/n.BEAT_WIDTH)),Math.floor(t/i)*i},n.closestRow=function(e){var t=e>n.BASS_STAFF_TOP;return 12-Math.round((e-n.STAFF_HEADER_HEIGHT-(t?n.BASS_STAFF_TOP:0))/(n.STAFF_ROW_HEIGHT/2))},n.rowY=function(e,t){return t?n.BASS_STAFF_TOP+n.STAFF_HEADER_HEIGHT+(12-e%12)*n.STAFF_ROW_HEIGHT/2:n.STAFF_HEADER_HEIGHT+(12-e%12)*n.STAFF_ROW_HEIGHT/2}},{}],202:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.doesSongUseBassClef=i.applySelection=i.moveSelectedNotes=i.deleteSelectedNotes=i.unselectAllNotes=i.selectNoteEventsInRange=i.findSelectedRange=i.changeSongLength=i.findNoteEventAtPosition=i.findNextNoteEvent=i.findNoteEventsOverlappingRange=i.findPreviousNoteEvent=i.findNoteEventAtTick=i.fillDrums=i.editNoteEventLength=i.removeNoteEventFromTrack=i.removeNoteAtRowFromTrack=i.removeNoteFromTrack=i.addNoteToTrack=i.isBassClefNote=i.noteToRow=i.resolveImageURL=i.rowToNote=void 0;let l=[0,2,4,5,7,9,11,12,14,16,17,19],s=[0,1,3,5,7,8,10,12,13,15,17,19];function c(e,t,i,n,o){if(n)return{note:t+(i?12:0),enharmonicSpelling:"normal"};let r;return r=i?s[t]+12*e-19:l[t]+12*e+1,o&&"normal"!==o?"sharp"===o?{note:r+1,enharmonicSpelling:o}:{note:r-1,enharmonicSpelling:o}:{note:r,enharmonicSpelling:"normal"}}function u(e,t,i){if(i)return 12<=t.note?t.note-12:t.note;var i=d(e,t,!1),n=t.note-1-12*e+(i?20:0),o=i?s:l;for(let e=0;e<o.length;e++){if(o[e]===n)return"normal"===t.enharmonicSpelling?e:"sharp"===t.enharmonicSpelling?e-1:e+1;if(o[e]>n){if("sharp"===t.enharmonicSpelling)return e-1;if("flat"===t.enharmonicSpelling)return e}}return"sharp"===t.enharmonicSpelling&&n===o[o.length-1]+1?o.length-1:-1}function d(e,t,i){return i?12<=t.note:"flat"===t.enharmonicSpelling?t.note<12*e:"sharp"===t.enharmonicSpelling?t.note<=12*e+1:t.note<12*e+1}function h(e,i,n,o,r){return Object.assign(Object.assign({},e),{tracks:e.tracks.map((e,t)=>t!==i?e:Object.assign(Object.assign({},e),{notes:((e,n,t,i,o,r)=>{var s={notes:[n],startTick:t,endTick:i};for(let i=0;i<e.length;i++){if(e[i].startTick>t)return e.slice(0,i).concat([s]).concat(e.slice(i));if(e[i].endTick>t)return e[i].notes.some(e=>e.note===n.note&&e.enharmonicSpelling===n.enharmonicSpelling)?e.slice():e.map((e,t)=>t!==i?e:Object.assign(Object.assign({},e),{notes:e.notes.concat([n]).sort((e,t)=>{var i=d(o,e,r);return i===d(o,t,r)?u(o,e,r)-u(o,t,r):i?-1:1})}))}return e.slice().concat([s])})(e.notes,n,o,r,e.instrument.octave,!!e.drums).filter(e=>(e.startTick<=o||e.startTick>=r)&&(e.endTick>=r||e.endTick<=o))}))})}function a(e,t,i){var n;for(n of e.tracks[t].notes)if(n.startTick<=i&&n.endTick>i)return n}function p(e,t){let i=e.measures*e.beatsPerMeasure*e.ticksPerBeat+1,n=-1;for(var o of e.tracks)for(var r of o.notes)r.selected&&(i=Math.min(r.startTick,i),n=Math.max(r.endTick,n));if(-1!==n)return void 0!==t&&(i=Math.floor(i/t)*t,n=Math.ceil(n/t)*t),{start:i,end:n}}function n(e,i,n,o){return void 0!==o?Object.assign(Object.assign({},e),{tracks:e.tracks.map((e,t)=>t!==o?e:r(e,Math.min(i,n),Math.max(i,n)))}):Object.assign(Object.assign({},e),{tracks:e.tracks.map(e=>r(e,Math.min(i,n),Math.max(i,n)))})}function r(e,t,i){return Object.assign(Object.assign({},e),{notes:e.notes.map(e=>Object.assign(Object.assign({},e),{notes:e.notes.slice(),selected:!(e.startTick>=i||e.endTick<=t)}))})}function g(e){return Object.assign(Object.assign({},e),{tracks:e.tracks.map(e=>Object.assign(Object.assign({},e),{notes:e.notes.map(e=>Object.assign(Object.assign({},e),{selected:!1}))}))})}function o(e,i,n,o){var t=p(e);if(!t)return e;var{start:t,end:r}=t;let s=t+i,a=r+i,l=e.beatsPerMeasure*e.ticksPerBeat*e.measures;return Object.assign(Object.assign({},e),{tracks:e.tracks.map((t,e)=>void 0!==o&&o!=e?t:Object.assign(Object.assign({},t),{notes:t.notes.filter(e=>e.selected||e.endTick<=s||e.startTick>=a).map(e=>e.selected?m(e,t.instrument.octave,i,n,!!t.drums):e).map(e=>Object.assign(Object.assign({},e),{endTick:Math.min(e.endTick,l)})).filter(e=>0<e.notes.length&&0<=e.startTick&&e.startTick<l).sort((e,t)=>e.startTick-t.startTick)}))})}function f(t,a){if(t.pastedContent){var l=t;var c=a;let i=f(l.pastedContent,c),n=p(i,c),o=l.startTick+l.deltaTick,r=o+(n.end-n.start),e=g(l.originalSong),s=e.beatsPerMeasure*e.ticksPerBeat*e.measures;return Object.assign(Object.assign({},e),{tracks:e.tracks.map((t,e)=>void 0!==c&&c!=e?t:Object.assign(Object.assign({},t),{notes:t.notes.filter(e=>e.endTick<=o||e.startTick>=r).concat(i.tracks[e].notes.filter(e=>e.selected).map(e=>Object.assign(Object.assign({},e),{startTick:e.startTick-n.start+l.startTick,endTick:e.endTick-n.start+l.startTick}))).map(e=>e.selected?m(e,t.instrument.octave,l.deltaTick,l.transpose,!!t.drums):e).map(e=>Object.assign(Object.assign({},e),{endTick:Math.min(e.endTick,s)})).filter(e=>0<e.notes.length&&0<=e.startTick&&e.startTick<s).sort((e,t)=>e.startTick-t.startTick)}))})}return o(n(t.originalSong,t.startTick,t.endTick,a),t.deltaTick,t.transpose,a)}function m(e,i,t,n,o){var r=Object.assign(Object.assign({},e),{startTick:e.startTick+t,endTick:e.endTick+t,notes:[]});if(o)r.notes=e.notes.slice();else for(var s of e.notes){let e=d(i,s,o),t=u(i,s,o);t+n>=l.length?e&&(t-=12,e=!1):t+n<0&&(e||(t+=12,e=!0));var a=t+n;a<0||a>=l.length||r.notes.push(c(i,a,e,o,s.enharmonicSpelling))}return r}i.rowToNote=c,i.resolveImageURL=function(e){return window.MonacoPaths&&window.MonacoPaths[e]||e},i.noteToRow=u,i.isBassClefNote=d,i.addNoteToTrack=h,i.removeNoteFromTrack=function(e,i,n,o){return Object.assign(Object.assign({},e),{tracks:e.tracks.map((e,t)=>t!==i?e:Object.assign(Object.assign({},e),{notes:((e,t,i)=>{var n=e.slice();for(let e=0;e<n.length;e++)if(n[e].startTick==i){n[e]=Object.assign(Object.assign({},n[e]),{notes:n[e].notes.filter(e=>e.note!==t.note)});break}return n.filter(e=>e.notes.length)})(e.notes,n,o)}))})},i.removeNoteAtRowFromTrack=function(e,i,n,o,r){return Object.assign(Object.assign({},e),{tracks:e.tracks.map((e,t)=>t!==i?e:Object.assign(Object.assign({},e),{notes:((e,t,i,n,o,r)=>{var s=e.slice();for(let e=0;e<s.length;e++)if(s[e].startTick==o){s[e]=Object.assign(Object.assign({},s[e]),{notes:s[e].notes.filter(e=>d(n,e,r)!==i||u(n,e,r)!==t)});break}return s.filter(e=>e.notes.length)})(e.notes,n,o,e.instrument.octave,r,!!e.drums)}))})},i.removeNoteEventFromTrack=function(e,i,n){return Object.assign(Object.assign({},e),{tracks:e.tracks.map((e,t)=>t!==i?e:Object.assign(Object.assign({},e),{notes:e.notes.filter(e=>e.startTick!==n)}))})},i.editNoteEventLength=function(e,i,n,o){let r=e.beatsPerMeasure*e.ticksPerBeat*e.measures;return Object.assign(Object.assign({},e),{tracks:e.tracks.map((e,t)=>t!==i?e:Object.assign(Object.assign({},e),{notes:((e,t,i)=>{var n=e.slice();if(i<=t)return n;let o;for(let e=0;e<n.length;e++)n[e].startTick===t?(o=Object.assign(Object.assign({},n[e]),{endTick:i}),n[e]=o):o&&n[e].startTick<o.endTick&&(n[e]=void 0);return n.filter(e=>!!e)})(e.notes,n,Math.min(o,r))}))})},i.fillDrums=function(t,i,e,n,o,r,s){var a=c(0,e,n,!0);for(let e=o;e<r;e+=s)t=h(t,i,{note:a.note,enharmonicSpelling:"normal"},e,e+1);return t},i.findNoteEventAtTick=a,i.findPreviousNoteEvent=function(e,t,i){var n;let o;for(n of e.tracks[t].notes){if(n.startTick>i)return o;o=n}return o},i.findNoteEventsOverlappingRange=function(e,t,i,n){var o,r=[];for(o of e.tracks[t].notes)if(o.endTick<i||o.startTick>n){if(o.startTick>n)break}else r.push(o);return r},i.findNextNoteEvent=function(e,t,i){var n;for(n of e.tracks[t].notes)if(n.startTick>i)return n},i.findNoteEventAtPosition=function(i,n,e){if(void 0!==e){var o=a(i,e,n.tick);let t=i.tracks[e];return null!=o&&o.notes.some(e=>u(t.instrument.octave,e,!!t.drums)===n.row)?o:void 0}for(let e=0;e<i.tracks.length;e++){var r=a(i,e,n.tick);let t=i.tracks[e];if(null!=r&&r.notes.some(e=>u(t.instrument.octave,e,!!t.drums)===n.row))return r}},i.changeSongLength=function(e,t){let i=t*e.beatsPerMeasure*e.ticksPerBeat;return Object.assign(Object.assign({},e),{measures:t,tracks:e.tracks.map(e=>{e=Object.assign(Object.assign({},e),{notes:e.notes.slice()});return e.notes=e.notes.filter(e=>e.startTick<i),e.notes=e.notes.map(e=>Object.assign(Object.assign({},e),{endTick:Math.min(e.endTick,i)})),e})})},i.findSelectedRange=p,i.selectNoteEventsInRange=n,i.unselectAllNotes=g,i.deleteSelectedNotes=function(e){return Object.assign(Object.assign({},e),{tracks:e.tracks.map(e=>Object.assign(Object.assign({},e),{notes:e.notes.filter(e=>!e.selected)}))})},i.moveSelectedNotes=o,i.applySelection=f,i.doesSongUseBassClef=function(e){return e.tracks.some(t=>t.notes.some(e=>e.notes.some(e=>d(t.instrument.octave,e,!!t.drums))))}},{}],203:[function(e,t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.fireClickOnEnter=void 0,i.fireClickOnEnter=function(e){var t="number"==typeof e.which?e.which:e.keyCode;13!==t&&32!==t||(e.preventDefault(),e.currentTarget.click())}},{}],204:[function(e,t,i){var n=e("./toPropertyKey.js");t.exports=function(e,t,i){return(t=n(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e},t.exports.__esModule=!0,t.exports.default=t.exports},{"./toPropertyKey.js":211}],205:[function(e,t,i){function n(){return t.exports=n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i,n=arguments[t];for(i in n)!{}.hasOwnProperty.call(n,i)||(e[i]=n[i])}return e},t.exports.__esModule=!0,t.exports.default=t.exports,n.apply(null,arguments)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},{}],206:[function(e,t,i){t.exports=function(e){return e&&e.__esModule?e:{default:e}},t.exports.__esModule=!0,t.exports.default=t.exports},{}],207:[function(e,i,t){var l=e("./typeof.js").default;function n(e,t){var s,a;return"function"==typeof WeakMap&&(s=new WeakMap,a=new WeakMap),i.exports=function(e,t){if(!t&&e&&e.__esModule)return e;var i,n,o={__proto__:null,default:e};if(null!==e&&("object"==l(e)||"function"==typeof e)){if(i=t?a:s){if(i.has(e))return i.get(e);i.set(e,o)}for(var r in e)"default"!==r&&{}.hasOwnProperty.call(e,r)&&((n=(i=Object.defineProperty)&&Object.getOwnPropertyDescriptor(e,r))&&(n.get||n.set)?i(o,r,n):o[r]=e[r])}return o},i.exports.__esModule=!0,(i.exports.default=i.exports)(e,t)}i.exports=n,i.exports.__esModule=!0,i.exports.default=i.exports},{"./typeof.js":212}],208:[function(e,t,i){var n=e("./defineProperty.js");function o(t,e){var i,n=Object.keys(t);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(t),e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,i)),n}t.exports=function(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach(function(e){n(t,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))})}return t},t.exports.__esModule=!0,t.exports.default=t.exports},{"./defineProperty.js":204}],209:[function(e,t,i){t.exports=function(e,t){if(null==e)return{};var i,n={};for(i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n},t.exports.__esModule=!0,t.exports.default=t.exports},{}],210:[function(e,t,i){var n=e("./typeof.js").default;t.exports=function(e,t){if("object"!=n(e)||!e)return e;var i=e[Symbol.toPrimitive];if(void 0===i)return("string"===t?String:Number)(e);if(i=i.call(e,t||"default"),"object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")},t.exports.__esModule=!0,t.exports.default=t.exports},{"./typeof.js":212}],211:[function(e,t,i){var n=e("./typeof.js").default,o=e("./toPrimitive.js");t.exports=function(e){return e=o(e,"string"),"symbol"==n(e)?e:e+""},t.exports.__esModule=!0,t.exports.default=t.exports},{"./toPrimitive.js":210,"./typeof.js":212}],212:[function(e,t,i){function n(e){return t.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t.exports.__esModule=!0,t.exports.default=t.exports,n(e)}t.exports=n,t.exports.__esModule=!0,t.exports.default=t.exports},{}],213:[function(e,t,i){var n=this,o=t=>{{var i={370:e=>{e.exports=t}},n={};function o(e){var t=n[e];return void 0!==t||(t=n[e]={exports:{}},i[e](t,t.exports,o)),t.exports}o.d=(e,t)=>{for(var i in t)o.o(t,i)&&!o.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var e={},a=((o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(e),o.d(e,{FieldGridDropdown:()=>s}),o(370));class l{constructor(e,t,i,n){this.value=i,this.selected=!1,this.selectionCallback=n,this.element=document.createElement("button"),this.element.id=a.utils.idGenerator.getNextUniqueId(),this.element.className="blocklyFieldGridItem",this.clickHandler=a.browserEvents.conditionalBind(this.element,"click",this,this.onClick,!0),e.appendChild(this.element);i="string"==typeof t?document.createTextNode(t):t;this.element.appendChild(i),a.utils.aria.setRole(this.element,a.utils.aria.Role.GRIDCELL)}dispose(){this.selectionCallback=null,this.element.remove(),this.clickHandler&&(a.browserEvents.unbind(this.clickHandler),this.clickHandler=null)}getId(){return this.element.id}getValue(){return this.value}isSelected(){return this.selected}setSelected(e){this.selected=e,a.utils.aria.setState(this.element,a.utils.aria.State.SELECTED,this.selected),this.element.classList.toggle("blocklyFieldGridItemSelected",this.selected),this.isSelected()&&this.focus()}onClick(){var e;this.setSelected(!0),null!=(e=this.selectionCallback)&&e.call(this,this)}focus(){this.element.focus({preventScroll:!0});var e,t,i,n=this.element.offsetParent;n&&(e=this.element.offsetTop,t=n.scrollTop,i=this.getInterItemSpacing(),e<t?n.scrollTo(0,e-i):e+this.element.offsetHeight>t+n.clientHeight&&n.scrollBy(0,e+this.element.clientHeight-(t+n.clientHeight)+i))}getInterItemSpacing(){let e=this.element.closest(".blocklyFieldGrid");if(e){var t=[...e.querySelectorAll(".blocklyFieldGridItem")];if(t.length){var i=t[0].offsetTop,n=t[0].offsetHeight;for(let e of t)if(e.offsetTop!==i)return e.offsetTop-n-i}}return 0}}class r{constructor(e,t,i,n,o){if(this.columns=i,this.rtl=n,this.itemIndices=new Map,this.items=new Array,this.keyDownHandler=null,this.pointerMoveHandler=null,this.selectionCallback=o,this.root=document.createElement("div"),this.root.className="blocklyFieldGrid",this.root.tabIndex=0,a.utils.aria.setRole(this.root,a.utils.aria.Role.GRID),e.appendChild(this.root),this.populateItems(t),this.keyDownHandler=a.browserEvents.conditionalBind(this.root,"keydown",this,this.onKeyDown),this.pointerMoveHandler=a.browserEvents.conditionalBind(this.root,"pointermove",this,this.onPointerMove,!0),!(1<=i))throw new Error("Number of columns must be >= 1; got "+i);this.columns=i,this.root.style.setProperty("--grid-columns",""+this.columns)}populateItems(e){let o=document.createElement("div");for(var[r,s]of e.entries())if(s!==a.FieldDropdown.SEPARATOR){r%this.columns==0&&((o=document.createElement("div")).className="blocklyFieldGridRow",a.utils.aria.setRole(o,a.utils.aria.Role.ROW),this.root.appendChild(o));let[t,e]=s,i=(()=>{if((e=t)&&"object"==typeof e&&"src"in e&&"string"==typeof e.src&&"alt"in e&&"string"==typeof e.alt&&"width"in e&&"number"==typeof e.width&&"height"in e&&"number"==typeof e.height){let e=new Image(t.width,t.height);return e.src=t.src,e.alt=t.alt||"",e}var e;return t})(),n=new l(o,i,e,e=>{var t;this.setSelectedValue(e.getValue()),null!=(t=this.selectionCallback)&&t.call(this,e)});this.itemIndices.set(n.getId(),this.itemIndices.size),this.items.push(n)}}dispose(){this.selectionCallback=void 0;for(var e of this.items)e.dispose();this.itemIndices.clear(),this.items.length=0,this.keyDownHandler&&(a.browserEvents.unbind(this.keyDownHandler),this.keyDownHandler=null),this.pointerMoveHandler&&(a.browserEvents.unbind(this.pointerMoveHandler),this.pointerMoveHandler=null),this.root.remove()}onKeyDown(e){if(!(!this.items.length||e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){switch(e.key){case"ArrowUp":this.moveFocus(-1*this.columns,!0);break;case"ArrowDown":this.moveFocus(this.columns,!0);break;case"ArrowLeft":this.moveFocus(-1*(this.rtl?-1:1),!0);break;case"ArrowRight":this.moveFocus(this.rtl?-1:1,!0);break;case"PageUp":case"Home":this.moveFocus(0,!1);break;case"PageDown":case"End":this.moveFocus(this.items.length-1,!1);break;case"Enter":case"Space":return void e.stopPropagation();default:return}e.preventDefault(),e.stopPropagation()}}onPointerMove(e){(e.movementX||e.movementY)&&e.target instanceof Element&&(e=e.target.closest(".blocklyFieldGridItem"))&&(e=e.id,void 0!==(e=this.itemIndices.get(e)))&&this.moveFocus(e,!1)}setSelectedValue(e){for(var[t,i]of this.items.entries()){var n=i.getValue()===e;i.setSelected(n),n&&this.moveFocus(t,!1)}}moveFocus(e,t){let i=e;if(t){let e=this.getFocusedItem();if(!e)return;i+=this.indexOfItem(e)}e=this.itemAtIndex(i);e&&(e.focus(),a.utils.aria.setState(this.root,a.utils.aria.State.ACTIVEDESCENDANT,e.getId()))}indexOfItem(e){return null!=(e=this.itemIndices.get(e.getId()))?e:-1}itemAtIndex(e){return this.items[e]}getFocusedItem(){var e=null!=(e=this.root.querySelector(".blocklyFieldGridItem:focus"))?e:this.root.querySelector(".blocklyFieldGridItem");return e&&e.id&&void 0!==(e=this.itemIndices.get(e.id))?this.itemAtIndex(e):void 0}}class s extends a.FieldDropdown{constructor(e,t,i){super(e,t,i),this.columns=3,null!=i&&i.columns&&this.setColumns(parseInt(""+i.columns)),i&&i.primaryColour&&(this.primaryColour=i.primaryColour),i&&i.borderColour&&(this.borderColour=i.borderColour)}static fromJson(e){if(e.options)return new this(e.options,void 0,e);throw new Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.")}setColumns(e){!isNaN(e)&&1<=e&&(this.columns=e,a.DropDownDiv.getOwner()===this)&&a.DropDownDiv.isVisible()&&(null!=(e=this.grid)&&e.dispose(),this.showEditor_())}showEditor_(e){a.DropDownDiv.clearContent();var t=!(null==(t=this.getSourceBlock())||!t.workspace.RTL),t=(this.grid=new r(a.DropDownDiv.getContentDiv(),this.getOptions(!1),this.columns,t,e=>{a.DropDownDiv.hideIfOwner(this),this.setValue(e.getValue())}),a.DropDownDiv.getContentDiv().classList.add("blocklyFieldGridContainer"),this.getColours()),t=(t&&t.border&&a.DropDownDiv.setColour(t.primary,t.border),a.DropDownDiv.showPositionedByField(this,this.dropdownDispose_.bind(this)),this.getValue());t&&this.grid.setSelectedValue(t)}doValueUpdate_(e){var t;super.doValueUpdate_(e),null!=(t=this.grid)&&t.setSelectedValue(e)}getColours(){var e,t;return this.primaryColour&&this.borderColour?{primary:this.primaryColour,border:this.borderColour}:(t=this.getSourceBlock())instanceof a.BlockSvg&&(t=t.isShadow()?t.getParent():t)?{primary:null!=(e=this.primaryColour)?e:t.getColour(),border:null!=(e=this.borderColour)?e:t.getColourTertiary()}:void 0}}return a.fieldRegistry.register("field_grid_dropdown",s),a.Css.register("\n   .blocklyFieldGridContainer {\n     padding: 7px;\n     overflow: auto;\n   }\n   \n  .blocklyFieldGrid {\n    display: grid;\n    grid-gap: 7px;\n    grid-template-columns: repeat(var(--grid-columns), min-content);\n  }\n\n .blocklyFieldGrid .blocklyFieldGridItem {\n   border: 1px solid rgba(1, 1, 1, 0.5);\n   border-radius: 4px;\n   color: white;\n   min-width: auto;\n   background: none;\n   white-space: nowrap;\n   cursor: pointer;\n   padding: 6px 15px;\n }\n \n .blocklyFieldGrid .blocklyFieldGridRow {\n   display: contents;\n }\n \n .blocklyFieldGrid .blocklyFieldGridItem.blocklyFieldGridItemSelected {\n   background-color: rgba(1, 1, 1, 0.25);\n }\n\n .blocklyFieldGrid .blocklyFieldGridItem:focus {\n   box-shadow: 0 0 0 4px hsla(0, 0%, 100%, .2);\n   outline: none;\n }\n "),e}};if("object"==typeof i&&"object"==typeof t)t.exports=o(e("blockly/core"));else if("function"==typeof define&&define.amd)define(["blockly/core"],o);else{var r,s=o("object"==typeof i?e("blockly/core"):n.Blockly);for(r in s)("object"==typeof i?i:n)[r]=s[r]}},{"blockly/core":218}],214:[function(e,t,i){var n=this,o=t=>{{var i={370:e=>{e.exports=t}},n={};function o(e){var t=n[e];return void 0!==t||(t=n[e]={exports:{}},i[e](t,t.exports,o)),t.exports}o.d=(e,t)=>{for(var i in t)o.o(t,i)&&!o.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r={},s=((o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})})(r),o.d(r,{WorkspaceSearch:()=>a}),o(370));let e=(()=>{let i=!1;return function(){var e,t;i||(i=!0,(e=document.createElement("style")).id="blockly-ws-search-style",t=document.createTextNode("path.blocklyPath.blockly-ws-search-highlight {\n    fill: #000;\n  }\n  path.blocklyPath.blockly-ws-search-highlight.blockly-ws-search-current {\n    fill: grey;\n  }\n  .blockly-ws-search-close-btn {\n    background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aCBkPSJNMTkgNi40MUwxNy41OSA1IDEyIDEwLjU5IDYuNDEgNSA1IDYuNDEgMTAuNTkgMTIgNSAxNy41OSA2LjQxIDE5IDEyIDEzLjQxIDE3LjU5IDE5IDE5IDE3LjU5IDEzLjQxIDEyeiIvPjxwYXRoIGQ9Ik0wIDBoMjR2MjRIMHoiIGZpbGw9Im5vbmUiLz48L3N2Zz4=) no-repeat top left;\n  }\n  .blockly-ws-search-next-btn {\n    background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aCBkPSJNNy40MSA4LjU5TDEyIDEzLjE3bDQuNTktNC41OEwxOCAxMGwtNiA2LTYtNiAxLjQxLTEuNDF6Ii8+PHBhdGggZD0iTTAgMGgyNHYyNEgwVjB6IiBmaWxsPSJub25lIi8+PC9zdmc+) no-repeat top left;\n  }\n  .blockly-ws-search-previous-btn {\n    background: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgd2lkdGg9IjE0Ij48cGF0aCBkPSJNNy40MSAxNS40MUwxMiAxMC44M2w0LjU5IDQuNThMMTggMTRsLTYtNi02IDZ6Ii8+PHBhdGggZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjwvc3ZnPg==) no-repeat top left;\n  }\n  .blockly-ws-search {\n    background: #fff;\n    border: solid lightgrey 0.5px;\n    box-shadow: 0px 10px 20px grey;\n    justify-content: center;\n    padding: 0.25em;\n    position: absolute;\n    z-index: 70;\n  }\n  .blockly-ws-search-input input {\n    border: none;\n  }\n  .blockly-ws-search button {\n    border: none;\n    padding-left: 6px;\n    padding-right: 6px;\n  }\n  .blockly-ws-search-actions {\n    display: flex;\n  }\n  .blockly-ws-search-container {\n    display: flex;\n  }\n  .blockly-ws-search-content {\n    display: flex;\n  }"),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild))}})();class a{constructor(e){this.workspace=e,this.id="workspaceSearch",this.htmlDiv=null,this.actionDiv=null,this.inputElement=null,this.textInputPlaceholder="Search",this.blocks=[],this.lastHighlighted=null,this.currentBlockIndex=-1,this.searchText="",this.searchOnInput=!0,this.caseSensitive=!1,this.preserveSelected=!0,this.boundEvents=[]}init(){this.workspace.getComponentManager().addComponent({component:this,weight:0,capabilities:[s.ComponentManager.Capability.POSITIONABLE]}),e(),this.createDom(),this.setVisible(!1),this.workspace.resize()}dispose(){for(var e of this.boundEvents)s.browserEvents.unbind(e);this.boundEvents.length=0,this.htmlDiv&&(this.htmlDiv.remove(),this.htmlDiv=null),this.actionDiv=null,this.inputElement=null}createDom(){var e=this.workspace.getInjectionDiv(),t=(this.addEvent(e,"keydown",this,e=>this.onWorkspaceKeyDown(e)),this.htmlDiv=document.createElement("div"),s.utils.dom.addClass(this.htmlDiv,"blockly-ws-search"),document.createElement("div")),i=(s.utils.dom.addClass(t,"blockly-ws-search-container"),document.createElement("div")),n=(s.utils.dom.addClass(i,"blockly-ws-search-content"),t.appendChild(i),document.createElement("div")),n=(s.utils.dom.addClass(n,"blockly-ws-search-input"),this.inputElement=this.createTextInput(),this.addEvent(this.inputElement,"keydown",this,e=>this.onKeyDown(e)),this.addEvent(this.inputElement,"input",this,()=>this.onInput()),this.addEvent(this.inputElement,"click",this,()=>{var e;this.searchAndHighlight(this.searchText,this.preserveSelected),null!=(e=this.inputElement)&&e.select()}),n.appendChild(this.inputElement),i.appendChild(n),this.actionDiv=document.createElement("div"),s.utils.dom.addClass(this.actionDiv,"blockly-ws-search-actions"),i.appendChild(this.actionDiv),this.createNextBtn()),i=(n&&this.addActionBtn(n,()=>this.next()),this.createPreviousBtn()),n=(i&&this.addActionBtn(i,()=>this.previous()),this.createCloseBtn());n&&(this.addBtnListener(n,()=>this.close()),t.appendChild(n)),this.htmlDiv.appendChild(t),e.insertBefore(this.htmlDiv,this.workspace.getParentSvg())}addEvent(e,t,i,n){e=s.browserEvents.conditionalBind(e,t,i,n);this.boundEvents.push(e)}addActionBtn(e,t){this.addBtnListener(e,t),null!=(t=this.actionDiv)&&t.appendChild(e)}createTextInput(){var e=document.createElement("input");return e.type="text",e.setAttribute("placeholder",this.textInputPlaceholder),e}createNextBtn(){return this.createBtn("blockly-ws-search-next-btn","Find next")}createPreviousBtn(){return this.createBtn("blockly-ws-search-previous-btn","Find previous")}createCloseBtn(){return this.createBtn("blockly-ws-search-close-btn","Close search bar")}createBtn(e,t){var i=document.createElement("button");return s.utils.dom.addClass(i,e),i.setAttribute("aria-label",t),i}addBtnListener(e,t){this.addEvent(e,"click",this,t),this.addEvent(e,"keydown",this,e=>{"Enter"===e.key?(t(e),e.preventDefault()):"Escape"===e.key&&this.close(),e.stopPropagation()})}getBoundingRectangle(){return null}position(e,t){this.htmlDiv&&(this.workspace.RTL?this.htmlDiv.style.left=e.absoluteMetrics.left+"px":e.toolboxMetrics.position===s.TOOLBOX_AT_RIGHT?this.htmlDiv.style.right=e.toolboxMetrics.width+"px":this.htmlDiv.style.right="0",this.htmlDiv.style.top=e.absoluteMetrics.top+"px")}onInput(){var e;this.searchOnInput&&this.inputElement&&(e=this.inputElement.value.trim())!==this.searchText&&this.searchAndHighlight(e,this.preserveSelected)}onKeyDown(e){if("Escape"===e.key)this.close();else if("Enter"===e.key)if(this.searchOnInput)e.shiftKey?this.previous():this.next();else if(this.inputElement){let e=this.inputElement.value.trim();e!==this.searchText&&this.searchAndHighlight(e,this.preserveSelected)}}onWorkspaceKeyDown(e){(e.ctrlKey||e.metaKey)&&"f"===e.key&&(this.open(),e.preventDefault(),e.stopPropagation())}previous(){this.setCurrentBlock(this.currentBlockIndex-1)}next(){this.setCurrentBlock(this.currentBlockIndex+1)}setSearchPlaceholder(e){this.textInputPlaceholder=e,this.inputElement&&this.inputElement.setAttribute("placeholder",this.textInputPlaceholder)}setCurrentBlock(e){var t;this.blocks.length&&((t=this.blocks[this.currentBlockIndex])&&this.unhighlightCurrentSelection(t),this.currentBlockIndex=(e%this.blocks.length+this.blocks.length)%this.blocks.length,t=this.blocks[this.currentBlockIndex],this.highlightCurrentSelection(t),this.workspace.centerOnBlock(t.id,!1),this.lastHighlighted=t)}open(){var e;this.setVisible(!0),null!=(e=this.inputElement)&&e.focus(),null!=(e=this.inputElement)&&e.select(),this.searchText&&this.searchAndHighlight(this.searchText)}close(){this.setVisible(!1);var e=s.FocusManager.getFocusManager();this.lastHighlighted&&!this.lastHighlighted.isDisposed()?e.focusNode(this.lastHighlighted):e.focusTree(this.workspace),this.clearBlocks(),this.lastHighlighted=null}setVisible(e){this.htmlDiv&&(this.htmlDiv.style.display=e?"flex":"none")}searchAndHighlight(e,t){var i=this.blocks[this.currentBlockIndex];this.searchText=e.trim(),this.clearBlocks(),this.blocks=this.getMatchingBlocks(this.workspace,this.searchText,this.caseSensitive),this.highlightSearchGroup(this.blocks);let n=0;t&&(n=-1<(n=this.blocks.indexOf(i))?n:0),this.setCurrentBlock(n)}getSearchPool(e){return e.getAllBlocks(!0).filter(e=>{e=e.getSurroundParent();return!e||!e.isCollapsed()})}isBlockMatch(e,t,i){let n="";if(e.isCollapsed())n=e.toString();else{let t=[];e.inputList.forEach(e=>{e.fieldRow.forEach(e=>{t.push(e.getText())})}),n=t.join(" ").trim()}return-1<(n=i?n:n.toLowerCase()).indexOf(t)}getMatchingBlocks(e,t,i){return t?(this.caseSensitive||(t=t.toLowerCase()),this.getSearchPool(e).filter(e=>this.isBlockMatch(e,t,i))):[]}clearBlocks(){this.unhighlightSearchGroup(this.blocks);var e=this.blocks[this.currentBlockIndex];e&&this.unhighlightCurrentSelection(e),this.currentBlockIndex=-1,this.blocks=[]}highlightCurrentSelection(e){e=e.pathObject.svgPath;s.utils.dom.addClass(e,"blockly-ws-search-current")}unhighlightCurrentSelection(e){e=e.pathObject.svgPath;s.utils.dom.removeClass(e,"blockly-ws-search-current")}highlightSearchGroup(e){e.forEach(e=>{e=e.pathObject.svgPath;s.utils.dom.addClass(e,"blockly-ws-search-highlight")})}unhighlightSearchGroup(e){e.forEach(e=>{e=e.pathObject.svgPath;s.utils.dom.removeClass(e,"blockly-ws-search-highlight")})}}return r}};if("object"==typeof i&&"object"==typeof t)t.exports=o(e("blockly/core"));else if("function"==typeof define&&define.amd)define(["blockly/core"],o);else{var r,s=o("object"==typeof i?e("blockly/core"):n.Blockly);for(r in s)("object"==typeof i?i:n)[r]=s[r]}},{"blockly/core":218}],215:[function(e,i,n){!function(ig){!function(){var e,t;e=this,t=function(){var g,$,P,B,F,U,H,G,f,V,l,c,j,s,W,a,z,Y,K,X,q,J,Z,Q,ee,te,ie,ne,oe,re,se,ae,le,ce,ue,de,he,pe,ge,fe,me,be,_e,ye,ve,Te,Ee,ke,Ce,Ie,we,Se,xe,Re,Oe,Ae,Ne,Le,De,Me,$e,Pe,Be,Fe,Ue,He,Ge,Ve,je,We,ze,Ye,Ke,Xe,qe,Je,Ze,Qe,et,tt,it,nt,ot,rt,st,at,lt,ct,ut,dt,ht,pt,gt,ft,mt,bt,_t,yt,vt,Tt,Et,kt,Ct,It,wt,St,xt,Rt,Ot,At,Nt,Lt,Dt,Mt,$t,Pt,Bt,Ft,Ut,Ht,Gt,Vt,jt,Wt,zt,Yt,Kt,Xt,qt,Jt,Zt,Qt,ei,ti,ii,ni,oi,ri,si,ai,li,ci,ui,di,hi,pi,gi,fi,mi,bi,_i,yi,vi,Ti,Ei,ki,Ci,Ii,wi,Si,xi,Ri,Oi,Ai,Ni,Li,Di,Mi,$i,Pi,Bi,Fi,Ui,Hi,Gi,Vi,ji,Wi,zi,Yi,Ki,Xi,qi,Ji,Zi,Qi,en,tn,nn,on,rn,sn,an,ln,cn,un,dn,hn,pn,gn,fn,mn,bn,_n,yn,vn,Tn,En,kn,Cn,In,wn,Sn,xn,Rn,On,An,Nn,Ln,Dn,Mn,$n,Pn,Bn,Fn,Un,Hn,Gn,Vn,jn,Wn,zn,Yn,Kn,Xn,qn,Jn,Zn,Qn,eo,to,io,no,oo,ro,so,ao,lo,u,co,uo,ho,po,go,d,fo,mo,bo,_o,yo,vo,To,Eo,ko,Co,Io,wo,So,xo,Ro,Oo,Ao,No,Lo,Do,Mo,$o,Po,Bo,Fo,Uo,Ho,Go,Vo,jo,Wo,zo,Yo,Ko,Xo,qo,Jo,Zo,Qo,er,tr,ir,nr,or,rr,sr,ar,lr,cr,ur,dr,hr,pr,gr,fr,mr,br,_r,yr,vr,Tr,Er,kr,Cr,Ir,wr,Sr,xr,Rr,Or,Ar,Nr,Lr,Dr,Mr,$r,Pr,Br,Fr,Ur,Hr,Gr,Vr,jr,Wr,zr,Yr,Kr,Xr,qr,Jr,Zr,Qr,es,ts,is,ns,os,rs,ss,as,h,m={},o=function(e,t,i,n){if(!(e instanceof b)&&"string"!=typeof e||""===(""+e).trim())throw Error('Invalid type "'+e+'". The type must be a non-empty string or a Blockly.registry.Type.');if(e=(""+e).toLowerCase(),"string"!=typeof t||""===t.trim())throw Error('Invalid name "'+t+'". The name must be a non-empty string.');var o=t.toLowerCase();if(!i)throw Error("Can not register a null value");let r=Ps[e],s=Fs[e];if(r||(r=Ps[e]=Object.create(null),s=Fs[e]=Object.create(null)),ls(e,i),!n&&r[o]&&r[o]!==i)throw Error('Name "'+o+'" with type "'+e+'" already registered.');r[o]=i,s[o]=t},ls=function(e,t){if(e===String(b.FIELD))if("function"!=typeof t.fromJson)throw Error('Type "'+e+'" must have a fromJson function')},cs=function(e,t){e=(""+e).toLowerCase(),t=t.toLowerCase();var i=Ps[e];i&&i[t]?(delete Ps[e][t],delete Fs[e][t]):console.warn("Unable to unregister ["+t+"]["+e+"] from the registry.")},us=function(e,t,i){e=(""+e).toLowerCase(),t=t.toLowerCase();var n=Ps[e];if(n&&n[t])return n[t];if(t="Unable to find ["+t+"]["+e+"] in the registry.",i)throw Error(t+" You must require or register a "+e+" plugin.");return console.warn(t),null},ds=function(e,t){return e=(""+e).toLowerCase(),t=t.toLowerCase(),!!(e=Ps[e])&&!!e[t]},hs=us,ps=us,gs=function(e,t,i){e=(""+e).toLowerCase();var n,o=Ps[e];if(!o){if(o=`Unable to find [${e}] in the registry.`,i)throw Error(o+` You must require or register a ${e} plugin.`);return console.warn(o),null}if(!t)return o;e=Fs[e],i=Object.create(null);for(n of Object.keys(o))i[e[n]]=o[n];return i},fs=function(e,t,i){return"function"==typeof(t=t.plugins[String(e)]||Us)?t:hs(e,t,i)},ms=function(e,t){bs(),zs=setTimeout(function(){t&&t.handleRightClick(e)},Gs)},bs=function(){zs&&(clearTimeout(zs),zs=0)},_s=function(){js=null},ys=function(e){return!e.type.startsWith("pointer")||e instanceof PointerEvent&&Ts(e)},vs=function(e){return""+e.pointerId},Ts=function(e){var t=vs(e);return js?js===t:"pointerdown"===e.type&&(js=t,!0)},p=function(t,i,n,o,r){function s(e){(r||ys(e))&&(n?o.call(n,e):o(e))}var a=[];if(i in Ws)for(let e=0;e<Ws[i].length;e++){var l=Ws[i][e];t.addEventListener(l,s,!1),a.push([t,l,s])}else t.addEventListener(i,s,!1),a.push([t,i,s]);return a},Es=function(t,i,n,o){function r(e){n?o.call(n,e):o(e)}var s=[];if(i in Ws)for(let e=0;e<Ws[i].length;e++){var a=Ws[i][e];t.addEventListener(a,r,!1),s.push([t,a,r])}else t.addEventListener(i,r,!1),s.push([t,i,r]);return s},r=function(e){for(var t=e[e.length-1][2];e.length;){var[i,n,o]=e.pop();i.removeEventListener(n,o,!1)}return t},ks=function(e){if(e.target instanceof HTMLElement){if(e.target.isContentEditable||"true"===e.target.getAttribute("data-is-text-input"))return!0;if(e.target instanceof HTMLInputElement)return"text"===(e=e.target).type||"number"===e.type||"email"===e.type||"password"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type;if(e.target instanceof HTMLTextAreaElement)return!0}return!1},Cs=function(e){return!(!e.ctrlKey||!ga)||2===e.button},Is=function(e,t,i){var n=t.createSVGPoint();return n.x=e.clientX,n.y=e.clientY,i=i||t.getScreenCTM().inverse(),n.matrixTransform(i)},ws=function(e){switch(e.deltaMode){default:return{x:e.deltaX,y:e.deltaY};case 1:return{x:e.deltaX*ba,y:e.deltaY*ba};case 2:return{x:e.deltaX*_a,y:e.deltaY*_a}}},Ss=function(){return"blockly-"+(ka++).toString(36)},xs=function(){return Ea.genUid()},Rs=function(e){return e.type===_.BLOCK_CREATE},Os=function(e){return e.type===_.BLOCK_DELETE},As=function(e){return e.type===_.BLOCK_CHANGE},Ns=function(e){return e.type===_.BLOCK_FIELD_INTERMEDIATE_CHANGE},Ls=function(e){return e.type===_.BLOCK_MOVE},Ds=function(e){return e.type===_.CLICK},Ms=function(e){return e.type===_.BUBBLE_OPEN},$s=function(e){return e.type===_.VIEWPORT_CHANGE},Ps=(m.setRecordUndo$$module$build$src$core$events$utils=function(e){Ia=e},us=function(){return Ia},g=function(e){Ra.fireInternal(e)},ja=function(e){if(U()){if(!xa.length)try{requestAnimationFrame(()=>{setTimeout($,0)})}catch(e){setTimeout($,0)}P(e)}},$=function(){var e,t,i=B(xa);xa.length=0;for(e of i)e.workspaceId&&null!=(t=ie(e.workspaceId))&&t.fireChangeListener(e)},P=function(t){if(As(t)&&"mutation"===t.element){let e;for(e=xa.length;0<e;e--){var i=xa[e-1];if(i.group!==t.group||i.workspaceId!==t.workspaceId||!Ls(i)||i.newParentId!==t.blockId)break}xa.splice(e,0,t)}else xa.push(t)},B=function(e){var t,i,n=[];for(t of e)e=n[n.length-1],t.isNull()||(e&&e.workspaceId===t.workspaceId&&e.group===t.group?Ls(t)&&Ls(e)&&t.blockId===e.blockId?(e.newParentId=t.newParentId,e.newInputName=t.newInputName,e.newCoordinate=t.newCoordinate,(e.reason||t.reason)&&(e.reason=Array.from(new Set((null!=(i=e.reason)?i:[]).concat(null!=(i=t.reason)?i:[]))))):As(t)&&As(e)&&t.blockId===e.blockId&&t.element===e.element&&t.name===e.name?e.newValue=t.newValue:$s(t)&&$s(e)?(e.viewTop=t.viewTop,e.viewLeft=t.viewLeft,e.scale=t.scale,e.oldScale=t.oldScale):Ds(t)&&Ms(e)||n.push(t):n.push(t));return n.filter(e=>!e.isNull())},F=function(){for(let e=0,t;t=xa[e];e++)t.recordUndo=!1},m.disable$$module$build$src$core$events$utils=function(){wa++},m.enable$$module$build$src$core$events$utils=function(){wa--},U=function(){return 0===wa},m.getGroup$$module$build$src$core$events$utils=function(){return Ca},m.setGroup$$module$build$src$core$events$utils=function(e){Ra.setGroupInternal(e)},Wa=function(e){Ca="boolean"==typeof e?e?xs():"":e},H=function(i){var n=[];i=i.getDescendants(!1);for(let e=0,t;t=i[e];e++)n[e]=t.id;return n},G=function(e,t){var i=f(e.type);if(i)return i.fromJson(e,t);throw Error("Unknown event type.")},f=function(e){var t=hs(b.EVENT,e);if(t)return t;throw Error(`Event type ${e} not found in registry.`)},V=function(e){if((Ls(e)||Rs(e))&&e.workspaceId){var t=ie(e.workspaceId);if(!e.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(e=t.getBlockById(e.blockId)){var i=Ia;try{Ia=!1;var n=e.getParent();if(n&&!n.hasDisabledReason(Sa)){var o=e.getDescendants(!1);for(let e=0,t;t=o[e];e++)t.setDisabledReason(!1,Sa)}else if((e.outputConnection||e.previousConnection)&&!t.isDragging())for(;e.setDisabledReason(!0,Sa),e=e.getNextBlock(););}finally{Ia=i}}}},l=function(e,t,i){for(var n in e=document.createElementNS(Oa,""+e),t)e.setAttribute(n,""+t[n]);return i&&i.appendChild(e),e},c=function(t,e){return!(e=e.split(" ")).every(e=>t.classList.contains(e))&&(t.classList.add(...e),!0)},j=function(e,t){e.classList.remove(...t.split(" "))},s=function(t,e){return!(e=e.split(" ")).every(e=>!t.classList.contains(e))&&(t.classList.remove(...e),!0)},W=function(e,t){return e.classList.contains(t)},a=function(e){return e&&e.parentNode?e.parentNode.removeChild(e):null},z=function(e,t){var i=t.nextSibling;if(!(t=t.parentNode))throw Error("Reference node has no parent.");i?t.insertBefore(e,i):t.appendChild(e)},Y=function(e,t){e.style.transform=t,e.style["-webkit-transform"]=t},K=function(){Da++,La=La||Object.create(null)},X=function(){--Da||(La=null)},q=function(e){var t,i=e.textContent+"\n"+e.className.baseVal;return La&&(t=La[i])||(t=window.getComputedStyle(e),t=J(e,t.fontSize,t.fontWeight,t.fontFamily),La&&(La[i]=t)),t},Ya=function(e,t,i,n){return J(e,t+"pt",i,n)},J=function(e,t,i,n){var o,r=e.textContent;return e=r+"\n"+e.className.baseVal,La&&(o=La[e])||(Ma||((o=document.createElement("canvas")).className="blocklyComputeCanvas",document.body.appendChild(o),Ma=o.getContext("2d")),o=r&&Ma?(Ma.font=i+" "+t+" "+n,Ma.measureText(r).width):0,La&&(La[e]=o)),o},Z=function(e,t,i,n){var o=document.createElement("span");o.style.font=i+" "+t+" "+n,o.textContent=e,(e=document.createElement("div")).style.width="1px",e.style.height="0",(t=document.createElement("div")).style.display="flex",t.style.position="fixed",t.style.top="0",t.style.left="0",t.appendChild(o),t.appendChild(e),document.body.appendChild(t),i={height:0,baseline:0};try{t.style.alignItems="baseline",i.baseline=e.offsetTop-o.offsetTop,t.style.alignItems="flex-end",i.height=e.offsetTop-o.offsetTop}finally{document.body.removeChild(t)}return i},m.getFocusManager$$module$build$src$core$focus_manager=function(){return Fa.getFocusManager()},Q=function(e){return e&&"function"==typeof e.getFocusableElement&&"function"==typeof e.getFocusableTree&&"function"==typeof e.onNodeFocus&&"function"==typeof e.onNodeBlur&&"function"==typeof e.canBeFocused},ee=function(e){return Q(e)&&"string"==typeof e.id&&"object"==typeof e.workspace&&"function"==typeof e.select&&"function"==typeof e.unselect},te=function(e,t){for(var i in t)null!==t[i]&&Array.isArray(t[i])?e[i]=te(e[i]||[],t[i]):e[i]=null!==t[i]&&"object"==typeof t[i]?te(e[i]||Object.create(null),t[i]):t[i];return e},ie=function(e){return Ha[e]||null},ne=function(){var e,t=[];for(e in Ha)t.push(Ha[e]);return t},oe=function(e){Ha[e.id]=e},re=function(e){delete Ha[e.id]},se=function(){return Js},ae=function(e){Js=e},le=function(){var e=m.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode();return e&&ee(e)?e:null},el=function(e){m.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)},ce=function(e){var t=le(),i=new(f(_.SELECTED))(null!=(i=null==t?void 0:t.id)?i:null,null!=(i=null==e?void 0:e.id)?i:null,null!=(e=null!=(i=null==e?void 0:e.workspace.id)?i:null==t?void 0:t.workspace.id)?e:"");g(i)},Za=function(){return Zs},ue=function(e){Zs=e},de=function(e){for(;e.options.parentWorkspace;)e=e.options.parentWorkspace;var t,i=e.getParentSvg(),n=e.getCachedParentSvgSize(),o=i.parentElement;o instanceof HTMLElement&&(t=o.offsetWidth,o=o.offsetHeight,n.width!==t&&(i.setAttribute("width",t+"px"),e.setCachedParentSvgSize(t,null)),n.height!==o&&(i.setAttribute("height",o+"px"),e.setCachedParentSvgSize(null,o)),e.resize())},he=function(e,t){var i=Object.create(null),n=e.getDescendants(!0);t&&(e=e.getNextBlock())&&(e=n.indexOf(e),n.splice(e,n.length-e));for(let e=0,t;t=n[e];e++)i[t.type]?i[t.type]++:i[t.type]=1;return i},pe=function(e){return function(){this.jsonInit(e)}},ge=function(e){Va.defineBlocksWithJsonArrayInternal(e)},t=function(e){m.defineBlocks$$module$build$src$core$common(m.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(e))},m.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(t){var i={};for(let e=0;e<t.length;e++){var n,o=t[e];o?(n=o.type)?i[n]={init:pe(o)}:console.warn(`Block definition #${e} in JSON array is missing a type attribute. `+"Skipping."):console.warn(`Block definition #${e} in JSON array is ${o}. Skipping`)}return i},m.defineBlocks$$module$build$src$core$common=function(e){for(var t of Object.keys(e)){var i=e[t];t in Hs&&console.warn(`Block definition "${t}" overwrites previous definition.`),Hs[t]=i}},fe=function(e){let t=Js;var i,n=m.getFocusManager$$module$build$src$core$focus_manager().getFocusedTree();for(i of ne())if(n===i){t=i;break}ks(e)||!t||t.rendered&&!t.isFlyout&&!t.isVisible()||T.registry.onKeyDown(t,e)},me=function(e,t){return-1!==(t=e.indexOf(t))&&(e.splice(t,1),!0)},be=function(e){if(qa)throw Error("CSS already injected");Ja+="\n"+e},_e=function(e,t){qa||(qa=!0,e&&(e=t.replace(/[\\/]$/,""),t=Ja.replace(/<<<PATH>>>/g,e),Ja="",(e=document.createElement("style")).id="blockly-common-style",t=document.createTextNode(t),e.appendChild(t),document.head.insertBefore(e,document.head.firstChild)))},ye=function(e){return Qa.getSizeInternal(e)},gl=function(e){var t,i,n,o,r;return"none"!==Te(e,"display")?ve(e):(i=(t=e.style).display,n=t.visibility,o=t.position,t.visibility="hidden",t.position="absolute",t.display="inline",r=e.offsetWidth,e=e.offsetHeight,t.display=i,t.position=o,t.visibility=n,new I(r,e))},ve=function(e){return new I(e.offsetWidth,e.offsetHeight)},Te=function(e,t){return(e=window.getComputedStyle(e))[t]||e.getPropertyValue(t)},Ee=function(e){var t=new E(0,0),i=(e=e.getBoundingClientRect(),document.documentElement),i=new E(window.pageXOffset||i.scrollLeft,window.pageYOffset||i.scrollTop);return t.x=e.left+i.x,t.y=e.top+i.y,t},ke=function(){var e=document.body,t=document.documentElement;return new E(e.scrollLeft||t.scrollLeft,e.scrollTop||t.scrollTop)},Ce=function(e){var t=parseFloat(Te(e,"borderLeftWidth")),i=parseFloat(Te(e,"borderRightWidth")),n=parseFloat(Te(e,"borderTopWidth"));return e=parseFloat(Te(e,"borderBottomWidth")),new C(n,e,t,i)},Ie=function(e,t,i){e=we(e,t,i),t.scrollLeft=e.x,t.scrollTop=e.y},we=function(e,t,i){var n=Ee(e),o=Ee(t),r=Ce(t),s=n.x-o.x-r.left,n=n.y-o.y-r.top,o=ve(e);return e=t.clientWidth-o.width,o=t.clientHeight-o.height,r=t.scrollLeft,t=t.scrollTop,i?(r+=s-e/2,t+=n-o/2):(r+=Math.min(s,Math.max(s-e,0)),t+=Math.min(n,Math.max(n-o,0))),new E(r,t)},Se=function(e){var t=new E(0,0),i=e.x&&e.getAttribute("x"),n=e.y&&e.getAttribute("y");return i&&(t.x=parseInt(i)),n&&(t.y=parseInt(n)),(i=(i=e.getAttribute("transform"))&&i.match(tl))&&(t.x+=Number(i[1]),i[3])&&(t.y+=Number(i[3])),(e=e.getAttribute("style"))&&e.includes("translate")&&(e=e.match(il))&&(t.x+=Number(e[1]),e[3])&&(t.y+=Number(e[3])),t},xe=function(e){let t=0,i=0;for(;e;){var n=Se(e);if(t+=n.x,i+=n.y,(" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv "))break;e=e.parentNode}return new E(t,i)},Re=function(){var e=ke();return new C(e.y,document.documentElement.clientHeight+e.y,e.x,document.documentElement.clientWidth+e.x)},Oe=function(){var e=document.documentElement,t=window;return new E(t.pageXOffset||e.scrollLeft,t.pageYOffset||e.scrollTop)},Ae=function(e,t){var i=t.x,n=(t=t.y,e.getInjectionDiv().getBoundingClientRect()),i=new E(i-n.left,t-n.top);return t=e.getOriginOffsetInPixels(),E.difference(i,t).scale(1/e.scale)},Ne=function(e,t){var i=t.scale(e.scale),n=(t=i.x,i=i.y,e.getInjectionDiv().getBoundingClientRect());return e=e.getOriginOffsetInPixels(),new E(t+n.left+e.x,i+n.top+e.y)},_l=function(e){({document:sl=sl,DOMParser:al=al,XMLSerializer:ll=ll}=e),ol=new al,rl=new ll},m.createElement$$module$build$src$core$utils$xml=function(e){return sl.createElementNS(cl,e)},m.createTextNode$$module$build$src$core$utils$xml=function(e){return sl.createTextNode(e)},m.textToDom$$module$build$src$core$utils$xml=function(e){let t=ol.parseFromString(e,"text/xml");if(t&&t.documentElement&&!t.getElementsByTagName("parsererror").length)return t.documentElement;if((t=ol.parseFromString(e,"text/html"))&&t.body.firstChild&&"xml"===t.body.firstChild.nodeName.toLowerCase())return t.body.firstChild;throw Error("DOMParser was unable to parse: "+e)},Le=function(e){return De(rl.serializeToString(e))},De=function(e){return e.replace(ul,e=>`&#${e.charCodeAt(0)};`)},Me=function(e){return e?((e instanceof Element||"string"==typeof e)&&(e=Ve(e),e=Ue(e)),$e(e),e):null},$e=function(e){var t=e.kind;if(e=e.contents,t&&t!==hl&&t!==dl)throw Error("Invalid toolbox kind "+t+". Please supply either "+hl+" or "+dl);if(!e)throw Error("Toolbox must have a contents attribute.")},Pe=function(e){return e?e.contents||(Array.isArray(e)&&0<e.length&&!e[0].nodeType?e:He(e)):[]},Be=function(e){return pl.hasCategoriesInternal(e)},fl=function(e){var t;return!!e&&((t=e.kind)?t===dl:!!e.contents.filter(e=>"CATEGORY"===e.kind.toUpperCase()).length)},Fe=function(e){return!(!e||!e.contents||!e.contents.filter(function(e){return"CATEGORY"===e.kind.toUpperCase()}).length)},Ue=function(e){var t={contents:He(e)};return e instanceof Node&&Ge(e,t),t},He=function(i){var n,o=[];let r=i.childNodes;r=r||i;for(let e=0,t;t=r[e];e++)t.tagName&&(i={},n=t.tagName.toUpperCase(),"BLOCK"===(i.kind=n)?i.blockxml=t:t.childNodes&&0<t.childNodes.length&&(i.contents=He(t)),Ge(t,i),o.push(i));return o},Ge=function(t,i){for(let e=0;e<t.attributes.length;e++){var n=t.attributes[e];n.nodeName.includes("css-")?(i.cssconfig=i.cssconfig||{},i.cssconfig[n.nodeName.replace("css-","")]=n.value):i[n.nodeName]=n.value}},Ve=function(e){let t=null;if(e)if("string"==typeof e){if("xml"!==(t=m.textToDom$$module$build$src$core$utils$xml(e)).nodeName.toLowerCase())throw TypeError("Toolbox should be an <xml> document.")}else e instanceof Element&&(t=e);return t},je=function(e,t,i,n,o,r){var s=r.scrollbar&&r.scrollbar.canScrollVertically();return e.horizontal===ea.LEFT?(i=o.absoluteMetrics.left+i,s&&r.RTL&&(i+=nl.scrollbarThickness)):(i=o.absoluteMetrics.left+o.viewMetrics.width-t.width-i,s&&!r.RTL&&(i-=nl.scrollbarThickness)),e.vertical===Qs.TOP?e=o.absoluteMetrics.top+n:(e=o.absoluteMetrics.top+o.viewMetrics.height-t.height-n,r.scrollbar&&r.scrollbar.canScrollHorizontally()&&(e-=nl.scrollbarThickness)),new C(e,e+t.height,i,i+t.width)},We=function(e,t){return{horizontal:t.toolboxMetrics.position===y.LEFT||e.horizontalLayout&&!e.RTL?ea.RIGHT:ea.LEFT,vertical:t.toolboxMetrics.position===y.BOTTOM?Qs.TOP:Qs.BOTTOM}},ze=function(t,i,n,o){var r=t.left,s=t.right-t.left,a=t.bottom-t.top;for(let e=0;e<o.length;e++){var l=o[e];t.intersects(l)&&(t=n===ta.UP?l.top-a-i:l.bottom+i,t=new C(t,t+a,r,r+s),e=-1)}return t},Zp=function(e,t){o(b.SERIALIZER,e,t)},yl=function(e){cs(b.SERIALIZER,e)},Ye=function(e,{addCoordinates:t=!1,saveIds:i=!0}={}){var n=e.workspace,o=Object.create(null);return o.height=e.getSize().height,o.width=e.getSize().width,i&&(o.id=e.id),t&&(t=e.getRelativeToSurfaceXY(),o.x=n.RTL?n.getWidth()-t.x:t.x,o.y=t.y),e.getText()&&(o.text=e.getText()),e.isCollapsed()&&(o.collapsed=!0),e.isOwnEditable()||(o.editable=!1),e.isOwnMovable()||(o.movable=!1),e.isOwnDeletable()||(o.deletable=!1),o},Ke=function(e,t,{recordUndo:i=!1}={}){var n,o,r,s=Ia;return m.setRecordUndo$$module$build$src$core$events$utils(i),i=t.newComment(e.id),void 0!==e.text&&i.setText(e.text),void 0===e.x&&void 0===e.y||(n=i.getRelativeToSurfaceXY(),o=null!=(o=e.x)?o:n.x,o=t.RTL?t.getWidth()-o:o,t=null!=(r=e.y)?r:n.y,i.moveTo(new E(o,t))),void 0===e.width&&!e.height||(r=i.getSize(),i.setSize(new I(null!=(n=e.width)?n:r.width,null!=(o=e.height)?o:r.height))),void 0!==e.collapsed&&i.setCollapsed(e.collapsed),void 0!==e.editable&&i.setEditable(e.editable),void 0!==e.movable&&i.setMovable(e.movable),void 0!==e.deletable&&i.setDeletable(e.deletable),m.setRecordUndo$$module$build$src$core$events$utils(s),i},up=function(e,t){o(b.PASTER,e,t)},w=function(e){cs(b.PASTER,e)},Xe=function(t){for(var e=t.workspace,i=t.getRelativeToSurfaceXY(),n=new E(0,0),o=e.getTopComments(!1).filter(e=>e.id!==t.id).map(e=>e.getRelativeToSurfaceXY());qe(E.sum(i,n),o);)n.translate(e.RTL?-30:30,30);t.moveTo(E.sum(i,n))},qe=function(t,e){return e.some(e=>Math.abs(e.x-t.x)<=1&&Math.abs(e.y-t.y)<=1)},Je=function(e,t){e.setAttribute(El,t)},Ze=function(e,t,i){Array.isArray(i)&&(i=i.join(" ")),e.setAttribute(Tl+t,""+i)},Qe=function(e){return e&&"function"==typeof e.saveState&&"function"==typeof e.loadState},et=function(e){return ot(e),nt()?(rt(),Promise.resolve()):Ll=Ll||new Promise(e=>{Dl=e,Ml=window.requestAnimationFrame(()=>{rt(),e()})})},tt=function(){return Ll||Promise.resolve()},it=function(e){e||window.cancelAnimationFrame(Ml),rt(e),!e&&Dl&&Dl()},nt=function(){return ca},ot=function(e){Al.add(e),Nl.set(e,m.getGroup$$module$build$src$core$events$utils());var t=e.getParent();t?ot(t):Ol.add(e)},rt=function(e){let t=e?new Set([e]):new Set([...Ol].map(e=>e.workspace)),i=[...Ol].filter(at).filter(e=>t.has(e.workspace));for(var n of i)lt(n);for(var o of t)o.resizeContents();for(var r of i)n=r.getRelativeToSurfaceXY(),r.updateComponentLocations(n);for(var s of i)r=m.getGroup$$module$build$src$core$events$utils(),(n=Nl.get(s))&&m.setGroup$$module$build$src$core$events$utils(n),s.bumpNeighbours(),m.setGroup$$module$build$src$core$events$utils(r);for(var a of i)st(a);e||(Ll=null)},st=function(e){Ol.delete(e),Al.delete(e),Nl.delete(e);for(var t of e.getChildren(!1))st(t)},at=function(e){return!e.isDisposed()&&!e.getParent()},lt=function(e){if(Al.has(e)&&e.initialized){for(var t of e.getChildren(!1))lt(t);e.renderEfficiently()}},ct=function(e,t){Gl(e,t)},S=function(e=Hl){Gl=e},ut=function(e,t){jl(e,t)},tc=function(e=Vl){jl=e},dt=function(e,t,i){zl(e,t,i)},ac=function(e=Wl){zl=e},cc=function(e,t){Kl(e,t)},lc=function(e=Yl){Kl=e},ht=function(e){return e&&"function"==typeof e.getProcedureDef},pt=function(e){return e&&"function"==typeof e.getProcedureCall&&"function"==typeof e.renameProcedure},gt=function(e){return void 0!==e.getVariableModel},ft=function(e,t,i,n){e=e+" was deprecated in "+t+" and will be deleted in "+i+".",n&&(e+="\nUse "+n+" instead."),ql.has(e)||(ql.add(e),console.warn(e))},m.allUsedVarModels$$module$build$src$core$variables=function(t){t=t.getAllBlocks(!1);var i=new Set;for(let e=0;e<t.length;e++){var n=t[e].getVarModels();if(n)for(let e=0;e<n.length;e++){var o=n[e];o.getId()&&i.add(o)}}return Array.from(i.values())},m.allDeveloperVariables$$module$build$src$core$variables=function(i){i=i.getAllBlocks(!1);var n=new Set;for(let e=0,t;t=i[e];e++){var o=t.getDeveloperVariables;if(o){o=o();for(let e=0;e<o.length;e++)n.add(o[e])}}return Array.from(n.values())},mt=function(e){return bt(e,!1)},bt=function(e,t=!0){return Hs.variables_set||Hs.variables_get||console.warn("There are no variable blocks, but there is a variable category."),t?(ft("The XML return value of Blockly.Variables.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),vt(e)):(e.registerButtonCallback("CREATE_VARIABLE",function(e){Ct(e.getTargetWorkspace())}),[{kind:"button",text:"%{BKY_NEW_VARIABLE}",callbackkey:"CREATE_VARIABLE"},...yt(e,e.getVariableMap().getVariablesOfType(""),!0)])},_t=function(e){return{VAR:{name:e.getName(),type:e.getType()}}},yt=function(e,t,i,n="variables_get",o="variables_set"){i=i&&Hs.math_change,e=[];var r=t.slice(-1)[0];return r&&(Hs[o]&&e.push({kind:"block",type:o,gap:i?8:24,fields:_t(r)}),i)&&e.push({kind:"block",type:"math_change",gap:Hs[n]?20:8,fields:_t(r),inputs:{DELTA:{shadow:{type:"math_number",fields:{NUM:1}}}}}),Hs[n]&&e.push(...t.sort(Dt).map(e=>({kind:"block",type:n,gap:8,fields:_t(e)}))),e},vt=function(e){let t=[];var i=document.createElement("button");return i.setAttribute("text","%{BKY_NEW_VARIABLE}"),i.setAttribute("callbackKey","CREATE_VARIABLE"),e.registerButtonCallback("CREATE_VARIABLE",function(e){Ct(e.getTargetWorkspace())}),t.push(i),e=Tt(e),t=t.concat(e)},Tt=function(i){var n=[];if(0<(i=i.getVariableMap().getVariablesOfType("")).length){var e,o=i[i.length-1];if(Hs.variables_set&&((e=m.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_set"),e.setAttribute("gap",Hs.math_change?"8":"24"),e.appendChild(At(o)),n.push(e)),Hs.math_change&&((e=m.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","math_change"),e.setAttribute("gap",Hs.variables_get?"20":"8"),e.appendChild(At(o)),o=m.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),e.appendChild(o),n.push(e)),Hs.variables_get){i.sort(Dt);for(let e=0,t;t=i[e];e++)(o=m.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get"),o.setAttribute("gap","8"),o.appendChild(At(t)),n.push(o)}}return n},Et=function(e){return Ql.generateUniqueNameInternal(e)},pc=function(e){return kt(Zl.charAt(0),e.getVariableMap().getAllVariables().map(e=>e.getName()))},kt=function(n,o){if(o.length){var r=Zl;let e="",i=r.indexOf(n);for(;;){let t=!1;for(let e=0;e<o.length;e++)if(o[e].toLowerCase()===n){t=!0;break}if(!t)break;++i===r.length&&(i=0,e=""+(Number(e)+1)),n=r.charAt(i)+e}}return n},Ct=function(o,r,e){let s=e||"";!function n(e){It(m.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,e,function(e){var t,i;e?(t=St(e,o))?(i=t.getType()===s?m.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",t.getName()):(i=m.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE).replace("%1",t.getName()).replace("%2",t.getType()),ct(i,function(){n(e)})):(o.getVariableMap().createVariable(e,s),r&&r(e)):r&&r(null)})}("")},m.renameVariable$$module$build$src$core$variables=function(r,s,a){!function o(e){var t=m.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",s.getName());It(t,e,function(e){var t,i,n;e?(t=wt(e,s.getType(),r),i=xt(s.getName(),e,r),t||i?(n="",t?n=m.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",t.getName()).replace("%2",t.getType()):i&&(n=m.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",e).replace("%2",i)),ct(n,function(){o(e)})):(r.getVariableMap().renameVariable(s,e),a&&a(e))):a&&a(null)})}("")},It=function(e,t,i){dt(e,t,function(e){!e||(e=e.replace(/[\s\xa0]+/g," ").trim())!==m.Msg$$module$build$src$core$msg.RENAME_VARIABLE&&e!==m.Msg$$module$build$src$core$msg.NEW_VARIABLE||(e=null),i(e)})},wt=function(i,n,o){o=o.getVariableMap().getAllVariables(),i=i.toLowerCase();for(let e=0,t;t=o[e];e++)if(t.getName().toLowerCase()===i&&t.getType()!==n)return t;return null},St=function(i,n){n=n.getVariableMap().getAllVariables(),i=i.toLowerCase();for(let e=0,t;t=n[e];e++)if(t.getName().toLowerCase()===i)return t;return null},xt=function(e,t,i){return(i.getProcedureMap().getProcedures().length?Rt:Ot)(e,t,i)},Rt=function(t,i,e){t=t.toLowerCase(),i=i.toLowerCase();for(var n of e=e.getProcedureMap().getProcedures()){var o=n.getParameters().filter(gt).map(e=>e.getVariableModel().getName());if(o&&(e=o.some(e=>e.toLowerCase()===t),o=o.some(e=>e.toLowerCase()===i),e)&&o)return n.getName()}return null},Ot=function(t,i,e){t=t.toLowerCase(),i=i.toLowerCase();for(var n of e=e.getAllBlocks(!1))if(ht(n)){var o=(n=(e=n.getProcedureDef())[1]).some(e=>e.toLowerCase()===t),n=n.some(e=>e.toLowerCase()===i);if(o&&n)return e[0]}return null},At=function(e){var t=m.createElement$$module$build$src$core$utils$xml("field");return t.setAttribute("name","VAR"),t.setAttribute("id",e.getId()),t.setAttribute("variabletype",e.getType()),e=m.createTextNode$$module$build$src$core$utils$xml(e.getName()),t.appendChild(e),t},m.getOrCreateVariablePackage$$module$build$src$core$variables=function(e,t,i,n){let o=m.getVariable$$module$build$src$core$variables(e,t,i,n);return o=o||Nt(e,t,i,n)},m.getVariable$$module$build$src$core$variables=function(e,t,i,n){var o=e.getPotentialVariableMap();let r=null;if((!t||!(r=!(r=e.getVariableById(t))&&o?o.getVariableById(t):r))&&i){if(void 0===n)throw Error("Tried to look up a variable by name without a type");!(r=e.getVariable(i,n))&&o&&(r=o.getVariable(i,n))}return r},Nt=function(e,t,i,n){var o=e.getVariableMap(),r=e.getPotentialVariableMap();return i=i||Et(e.isFlyout?e.targetWorkspace:e),r?r.createVariable(i,n,null!=t?t:void 0):o.createVariable(i,n,t)},Lt=function(t,i){t=t.getAllVariables();var n=[];if(i.length!==t.length)for(let e=0;e<t.length;e++){var o=t[e];i.includes(o)||n.push(o)}return n},Dt=function(e,t){return e.getName().localeCompare(t.getName(),void 0,{sensitivity:"base"})},Mt=function(i,n){var o=[];i=i.getAllBlocks(!1);for(let t=0;t<i.length;t++){var r=i[t].getVarModels();if(r)for(let e=0;e<r.length;e++)r[e].getId()===n&&o.push(i[t])}return o},m.deleteVariable$$module$build$src$core$variables=function(t,i,n){var o=i.getName(),r=Mt(t,i.getId());for(let e=r.length-1;0<=e;e--){var s=r[e];if("procedures_defnoreturn"===s.type||"procedures_defreturn"===s.type)return n=String(s.getFieldValue("NAME")),o=m.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",o).replace("%2",n),void ct(o);s===n&&r.splice(e,1)}n&&r.length||1<r.length?(o=m.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(r.length+(n&&!n.workspace.isFlyout?1:0))).replace("%2",o),ut(o,e=>{e&&i&&t.getVariableMap().deleteVariable(i)})):t.getVariableMap().deleteVariable(i)},$t=function(e,{addCoordinates:t=!1,addInputBlocks:i=!0,addNextBlocks:n=!0,doFullSerialization:o=!0,saveIds:r=!0}={}){var s;return e.isInsertionMarker()?null:(s={type:e.type,id:r?e.id:void 0},t&&Bt(e,s),Pt(e,s),Ft(e,s,o),Ut(e,s,o),Ht(e,s,o),i&&Gt(e,s,o,r),n&&Vt(e,s,o,r),s)},Pt=function(e,t){e.isCollapsed()&&(t.collapsed=!0),e.isEnabled()||(t.disabledReasons=Array.from(e.getDisabledReasons())),e.isOwnDeletable()||(t.deletable=!1),e.isOwnMovable()||(t.movable=!1),e.isOwnEditable()||(t.editable=!1),void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&(t.inline=e.inputsInline),e.data&&(t.data=e.data)},Bt=function(e,t){var i=e.workspace;e=e.getRelativeToSurfaceXY(),t.x=Math.round(i.RTL?i.getWidth()-e.x:e.x),t.y=Math.round(e.y)},Ft=function(e,t,i){e.saveExtraState?null!==(e=e.saveExtraState(i))&&(t.extraState=e):e.mutationToDom&&null!==(e=e.mutationToDom())&&(t.extraState=$n(e).replace(' xmlns="https://developers.google.com/blockly/xml"',""))},Ut=function(e,t,i){var n,o=Object.create(null);for(n of e.getIcons())Qe(n)&&(e=n.saveState(i))&&(o[n.getType().toString()]=e);Object.keys(o).length&&(t.icons=o)},Ht=function(e,t,i){var n,o=Object.create(null);for(n of e.getFields())n.isSerializable()&&(o[n.name]=n.saveState(i));Object.keys(o).length&&(t.fields=o)},Gt=function(t,e,i,n){var o=Object.create(null);for(let e=0;e<t.inputList.length;e++){var r,s=t.inputList[e];s.connection&&(r=jt(s.connection,i,n))&&(o[s.name]=r)}Object.keys(o).length&&(e.inputs=o)},Vt=function(e,t,i,n){e.nextConnection&&(e=jt(e.nextConnection,i,n))&&(t.next=e)},jt=function(e,t,i){var n,o=e.getShadowState(!0);return e=e.targetBlock(),o||e?(n=Object.create(null),o&&(n.shadow=o),e&&!e.isShadow()&&(n.block=$t(e,{doFullSerialization:t,saveIds:i})),n):null},Wt=function(e,t,{recordUndo:i=!1}={}){return e=zt(e,t,{recordUndo:i}),t.rendered&&it(),e},zt=function(e,t,{parentConnection:i,isShadow:n=!1,recordUndo:o=!1}={}){var r=Ia,s=(m.setRecordUndo$$module$build$src$core$events$utils(o),(o=m.getGroup$$module$build$src$core$events$utils())||m.setGroup$$module$build$src$core$events$utils(!0),m.disable$$module$build$src$core$events$utils(),t.getAllVariables());let a;try{a=Yt(e,t,{parentConnection:i,isShadow:n})}finally{m.enable$$module$build$src$core$events$utils()}if(Kt(t,s),U()&&g(new(f(_.BLOCK_CREATE))(a)),m.setGroup$$module$build$src$core$events$utils(o),m.setRecordUndo$$module$build$src$core$events$utils(r),t.rendered){let e=a;setTimeout(()=>{e.disposed||e.setConnectionTracking(!0)},1)}return a},Yt=function(e,t,{parentConnection:i,isShadow:n=!1}={}){var o;if(e.type)return(o=t.newBlock(e.type,e.id)).setShadow(n),Xt(o,e),qt(o,e),Jt(o,e),Zt(i,o,e),Qt(o,e),ei(o,e),ti(o,e),ii(o,e),oi(o,t.rendered),o;throw new ic(e)},Kt=function(e,t){if(U())for(e=Lt(e,t),t=0;t<e.length;t++){var i=e[t];g(new(f(_.VAR_CREATE))(i))}},Xt=function(e,t){var i=void 0===t.x?0:t.x,n=(t=void 0===t.y?0:t.y,e.workspace),i=n.RTL?n.getWidth()-i:i;e.moveBy(i,t)},qt=function(e,t){if(t.collapsed&&e.setCollapsed(!0),!1===t.deletable&&e.setDeletable(!1),!1===t.movable&&e.setMovable(!1),!1===t.editable&&e.setEditable(!1),!1===t.enabled&&e.setDisabledReason(!0,xl),Array.isArray(t.disabledReasons))for(var i of t.disabledReasons)e.setDisabledReason(!0,i);void 0!==t.inline&&e.setInputsInline(t.inline),void 0!==t.data&&(e.data=t.data)},Jt=function(e,t){t.extraState&&(e.loadExtraState?e.loadExtraState(t.extraState):e.domToMutation&&e.domToMutation(m.textToDom$$module$build$src$core$utils$xml(t.extraState)))},Zt=function(e,t,i){if(e){if(e.getSourceBlock().isShadow()&&!t.isShadow())throw new rc(i);if(e.type===m.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var n=t.outputConnection;if(!n)throw new nc("output",t,i)}else if(!(n=t.previousConnection))throw new nc("previous",t,i);var o;if(!e.connect(n))throw o=t.workspace.connectionChecker,new oc(o.getErrorMessage(o.canConnectWithReason(n,e,!1),n,e),e.type===m.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",t,i)}},Qt=function(e,t){var i;if(t.icons)for(i of Object.keys(t.icons)){var n=t.icons[i],o=e.getIcon(i);if(!o){if(!(o=hs(b.ICON,i,!1)))throw new sc(i,e,t);o=new o(e),e.addIcon(o)}Qe(o)&&o.loadState(n)}},ei=function(t,i){if(i.fields){var n=Object.keys(i.fields);for(let e=0;e<n.length;e++){var o=n[e],r=i.fields[o],s=t.getField(o);s?s.loadState(r):console.warn(`Ignoring non-existant field ${o} in block `+t.type)}}},ti=function(t,i){if(i.inputs){var n=Object.keys(i.inputs);for(let e=0;e<n.length;e++){var o=n[e],r=t.getInput(o);if(!r||!r.connection)throw new nc(o,t,i);ni(r.connection,i.inputs[o])}}},ii=function(e,t){if(t.next){if(!e.nextConnection)throw new nc("next",e,t);ni(e.nextConnection,t.next)}},ni=function(e,t){t.shadow&&e.setShadowState(t.shadow),t.block&&Yt(t.block,e.getSourceBlock().workspace,{parentConnection:e})},oi=function(e,t){if(t){e.setConnectionTracking(!1),e.initSvg(),e.queueRender();for(var i of e.getIcons())i.onLocationChange(e.getRelativeToSurfaceXY())}else e.initModel()},ri=function(e){return"function"==typeof e.bubbleIsVisible&&"function"==typeof e.setBubbleVisible&&"function"==typeof e.getBubble},si=function(e){return e*Math.PI/180},Wc=function(e){return 180*e/Math.PI},ai=function(e,t,i){var n;return i<e&&(n=i,i=e,e=n),Math.max(e,Math.min(t,i))},li=function(){document.querySelector(".blocklyDropDownDiv")||((ra=document.createElement("div")).className="blocklyDropDownDiv",ra.tabIndex=-1,(Zs||document.body).appendChild(ra),(sa=document.createElement("div")).className="blocklyDropDownContent",ra.appendChild(sa),Sc=p(sa,"keydown",null,fe),(aa=document.createElement("div")).className="blocklyDropDownArrow",ra.appendChild(aa),ra.style.opacity="0",ra.style.transition="transform "+_c+"s, opacity "+_c+"s")},ci=function(e){kc=e},qc=function(){return Cc},Xc=function(){return sa},ui=function(){Sc&&(r(Sc),Sc=null),ra.remove(),li()},di=function(e,t){ra.style.backgroundColor=e,ra.style.borderColor=t},cu=function(e,t,i,n,o=!0){return fi(pi(t),e,o,i,n)},hi=function(e,t,i,n=!0){return Ic=!0,fi(gi(e),e,n,t,i)},pi=function(e){var t=e.getSvgRoot(),i=e.workspace.scale,n=e.height*i;return e=e.width*i,t=Ee(t),new C(t.y,t.y+n,t.x,t.x+e)},gi=function(e){return e=e.getScaledBBox(),new C(e.top,e.bottom,e.left,e.right)},fi=function(e,t,i,n,o){var r=e.left+(e.right-e.left)/2,s=e.bottom;e=e.top,o&&(e+=o);let a=(o=t.getSourceBlock()).workspace;for(;a.options.parentWorkspace;)a=a.options.parentWorkspace;return ci(a.getParentSvg().parentNode),mi(t,o.RTL,r,s,r,e,i,n)},mi=function(e,t,i,n,o,r,s,a){return Cc=e,vc=a||null,ra.style.direction=t?"rtl":"ltr",Tc=(e=Js).getRenderer().getClassName(),Ec=e.getTheme().getClassName(),c(ra,Tc),c(ra,Ec),i=Ci(i,n,o,r),s&&(wc=m.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(ra)),i},bi=function(e,t,i,n){return{initialX:(e=vi(e,i.left,i.right,n.width)).divX,initialY:t,finalX:e.divX,finalY:t+bc,arrowX:e.arrowX,arrowY:-(gc/2+fc),arrowAtTop:!0,arrowVisible:!0}},_i=function(e,t,i,n){return{initialX:(e=vi(e,i.left,i.right,n.width)).divX,initialY:t-n.height,finalX:e.divX,finalY:t-n.height-bc,arrowX:e.arrowX,arrowY:n.height-2*fc-gc/2,arrowAtTop:!1,arrowVisible:!0}},yi=function(e,t,i){return{initialX:(e=vi(e,t.left,t.right,i.width)).divX,initialY:0,finalX:e.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},vi=function(e,t,i,n){return t=ai(t,e-n/2,i-n),{arrowX:e=ai(i=mc,e=e-gc/2-t,n-i-gc),divX:t}},ru=function(){return!!Cc},Ti=function(e,t){return Cc===e&&((t?ki:Ei)(),!0)},Ei=function(){ra.style.transform="translate(0, 0)",ra.style.opacity="0",yc=setTimeout(function(){ki()},1e3*_c),vc&&(vc(),vc=null)},ki=function(){Cc&&(yc&&clearTimeout(yc),vc&&(vc(),vc=null),ui(),Cc=null,Js.markFocused(),wc)&&(wc(),wc=null)},Ci=function(e,t,i,n){(e=xc.getPositionMetrics(e,t,i,n)).arrowVisible?(t=e.arrowX,i=e.arrowY,n=e.arrowAtTop?45:225,aa.style.display="",aa.style.transform=`translate(${t}px, ${i}px) rotate(${n}deg)`,aa.setAttribute("class","blocklyDropDownArrow")):aa.style.display="none",t=Math.floor(e.initialX),i=Math.floor(e.initialY),n=Math.floor(e.finalX);var o=Math.floor(e.finalY);return ra.style.left=t+"px",ra.style.top=i+"px",ra.style.display="block",ra.style.opacity="1",ra.style.transform="translate("+(n-t)+"px,"+(o-i)+"px)",!!e.arrowAtTop},Ii=function(){var e,t;Cc?(e=Cc.getSourceBlock(),t=(e=Ic?gi(Cc):pi(e)).left+(e.right-e.left)/2,Ci(t,e.bottom,t,e.top)):Ei()},wi=function(e){return e.length?e.reduce(function(e,t){return e.length<t.length?e:t}).length:0},Si=function(e,t){if(!e.length)return 0;if(1===e.length)return e[0].length;let i=0;t=t||wi(e);let n;for(n=0;n<t;n++){for(var o=e[0][n],r=1;r<e.length;r++)if(o!==e[r][n])return i;" "===o&&(i=n+1)}for(o=1;o<e.length;o++)if((r=e[o][n])&&" "!==r)return i;return t},xi=function(e,t){if(!e.length)return 0;if(1===e.length)return e[0].length;let i=0;t=t||wi(e);let n;for(n=0;n<t;n++){for(var o=e[0].substr(-n-1,1),r=1;r<e.length;r++)if(o!==e[r].substr(-n-1,1))return i;" "===o&&(i=n+1)}for(o=1;o<e.length;o++)if((r=e[o].charAt(e[o].length-n-1))&&" "!==r)return i;return t},m.wrap$$module$build$src$core$utils$string=function(t,i){t=t.split("\n");for(let e=0;e<t.length;e++)t[e]=Ri(t[e],i);return t.join("\n")},Ri=function(i,e){if(i.length<=e)return i;for(var n=i.trim().split(/\s+/),o=0;o<n.length;o++)n[o].length>e&&(e=n[o].length);var r=-1/0;let s,a=1;do{o=r,s=i,i=[],r=n.length/a;let t=1;for(let e=0;e<n.length-1;e++)t<(e+1.5)/r?(t++,i[e]=!0):i[e]=!1}while(i=Ai(n,i,e),r=Oi(n,i,e),i=Ni(n,i),a++,o<r);return s},Oi=function(e,t,i){for(var n=[0],o=[],r=0;r<e.length;r++)n[n.length-1]+=e[r].length,!0===t[r]?(n.push(0),o.push(e[r].charAt(e[r].length-1))):!1===t[r]&&n[n.length-1]++;for(e=Math.max(...n),r=t=0;r<n.length;r++)t=(t-=2*Math.pow(Math.abs(i-n[r]),1.5))-Math.pow(e-n[r],1.5),".?!".includes(o[r])?t+=i/3:",;)]}".includes(o[r])&&(t+=i/4);return 1<n.length&&n[n.length-1]<=n[n.length-2]&&(t+=.5),t},Ai=function(t,i,n){let o=Oi(t,i,n),r;for(let e=0;e<i.length-1;e++){var s,a;i[e]!==i[e+1]&&((s=[].concat(i))[e]=!s[e],s[e+1]=!s[e+1],(a=Oi(t,s,n))>o)&&(o=a,r=s)}return r?Ai(t,r,n):i},Ni=function(t,i){var n=[];for(let e=0;e<t.length;e++)n.push(t[e]),void 0!==i[e]&&n.push(i[e]?"\n":" ");return n.join("")},m.isNumber$$module$build$src$core$utils$string=function(e){return/^\s*-?\d+(\.\d+)?\s*$/.test(e)},Cu=function(e){Rc=e},cp=function(){return Rc},du=function(){return Oc},Jh=function(){return jc},Li=function(e){if(e=Di(e)){for(e=e.tooltip;"function"==typeof e;)e=e();if("string"!=typeof e)throw Error("Tooltip function must return a string.");return e}return""},Di=function(e){for(;e&&e.tooltip;){if("string"==typeof e.tooltip||"function"==typeof e.tooltip)return e;e=e.tooltip}return null},Mi=function(){document.querySelector(".blocklyTooltipDiv")||((jc=document.createElement("div")).className="blocklyTooltipDiv",(Zs||document.body).appendChild(jc))},$i=function(e){e.mouseOverWrapper_=Es(e,"pointerover",null,Bi),e.mouseOutWrapper_=Es(e,"pointerout",null,Fi),e.addEventListener("pointermove",Ui,!1)},Pi=function(e){e&&(r(e.mouseOverWrapper_),r(e.mouseOutWrapper_),e.removeEventListener("pointermove",Ui))},Bi=function(e){Ac||(e=Di(e.currentTarget),Pc!==e&&(Gi(),Bc=null,Pc=e),clearTimeout(Lc))},Fi=function(e){Ac||(Lc=setTimeout(function(){Bc=Pc=null,Gi()},1),clearTimeout(Dc),Dc=0)},Ui=function(e){var t;Pc&&Pc.tooltip&&!Ac&&(Oc?(t=Mc-e.pageX,e=$c-e.pageY,Math.sqrt(t*t+e*e)>Hc&&Gi()):Bc!==Pc&&(clearTimeout(Dc),Mc=e.pageX,$c=e.pageY,Dc=setTimeout(Ki,Gc)))},Hi=function(){Bc=Pc=null,Gi()},Gi=function(){Oc&&(Oc=!1,jc)&&(jc.style.display="none"),Dc&&(clearTimeout(Dc),Dc=0)},Vi=function(){Gi(),Ac=!0},ji=function(){Ac=!1},Wi=function(){jc&&Pc&&("function"==typeof Rc?Rc(jc,Pc):zi())},zi=function(){var t=Li(Pc);t=(t=m.wrap$$module$build$src$core$utils$string(t,Nc)).split("\n");for(let e=0;e<t.length;e++){var i=document.createElement("div");i.appendChild(document.createTextNode(t[e])),jc.appendChild(i)}},Yi=function(e){var t=document.documentElement.clientWidth,i=document.documentElement.clientHeight;let n=Mc,o=(n=e?n-(Fc+jc.offsetWidth):n+Fc,$c+Uc);return o+jc.offsetHeight>i+window.scrollY&&(o-=jc.offsetHeight+2*Uc),e?n=Math.max(Vc-window.scrollX,n):n+jc.offsetWidth>t+window.scrollX-2*Vc&&(n=t-jc.offsetWidth-2*Vc),{x:n,y:o}},Ki=function(){var e,t;!Ac&&(Bc=Pc,jc)&&(jc.textContent="",Wi(),e=Pc.RTL,{x:e,y:t}=(jc.style.direction=e?"rtl":"ltr",jc.style.display="block",Oc=!0,Yi(e)),jc.style.left=e+"px",jc.style.top=t+"px")},md=function(){return zc},Vu=function(e){zc=e},Lu=function(){return Yc},ju=function(e){Yc=e},Xi=function(e){e=(""+e).toLowerCase().trim();var t,i=Kc[e];return i||(i="#"===(i="0x"===e.substring(0,2)?"#"+e.substring(2):e)[0]?i:"#"+i,/^#[0-9a-f]{6}$/.test(i)?i:/^#[0-9a-f]{3}$/.test(i)?["#",i[1],i[1],i[2],i[2],i[3],i[3]].join(""):(t=e.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/))&&(e=Number(t[1]),i=Number(t[2]),t=Number(t[3]),0<=e)&&e<256&&0<=i&&i<256&&0<=t&&t<256?qi(e,i,t):null)},qi=function(e,t,i){return t=e<<16|t<<8|i,e<16?"#"+(16777216|t).toString(16).substr(1):"#"+t.toString(16)},Ji=function(e){return(e=Xi(e))?[(e=parseInt(e.substr(1),16))>>16,e>>8&255,255&e]:[0,0,0]},Zi=function(e,t,i){let n=0,o=0,r=0;if(0===t)r=o=n=i;else{var s=Math.floor(e/60),a=e/60-s,l=(e=i*(1-t),i*(1-t*a));switch(t=i*(1-t*(1-a)),s){case 1:n=l,o=i,r=e;break;case 2:n=e,o=i,r=t;break;case 3:n=e,o=l,r=i;break;case 4:n=t,o=e,r=i;break;case 5:n=i,o=e,r=l;break;case 6:case 0:n=i,o=t,r=e}}return qi(Math.floor(n),Math.floor(o),Math.floor(r))},Qi=function(e,t,i){return(e=Xi(e))&&(t=Xi(t))?(e=Ji(e),t=Ji(t),qi(Math.round(t[0]+i*(e[0]-t[0])),Math.round(t[1]+i*(e[1]-t[1])),Math.round(t[2]+i*(e[2]-t[2])))):null},en=function(e){return Zi(e,zc,255*Yc)},tn=function(t,i,n){var o=[],r=t.split(""),s=(r.push(""),0);t=[];let a=null;for(let e=0;e<r.length;e++){var l,c,u=r[e];0===s?"%"===u?((s=t.join(""))&&o.push(s),t.length=0,s=1):(n&&"\n"===u?((l=t.join(""))&&o.push(l),t.length=0,o):t).push(u):1===s?"%"===u?(t.push(u),s=0):i&&"0"<=u&&u<="9"?(s=2,a=u,(u=t.join(""))&&o.push(u),t.length=0):s="{"===u?3:(t.push("%",u),0):2===s?"0"<=u&&u<="9"?a+=u:(c=void 0,o.push(parseInt(null!=(c=a)?c:"",10)),e--,s=0):3===s&&(""===u?(t.splice(0,0,"%{"),e--,s=0):"}"!==u?t.push(u):(s=t.join(""),/[A-Z]\w*/i.test(s)&&(u=(u=s.toUpperCase()).startsWith("BKY_")?u.substring(4):null)&&u in m.Msg$$module$build$src$core$msg?"string"==typeof(s=m.Msg$$module$build$src$core$msg[u])?Array.prototype.push.apply(o,tn(s,i,n)):o.push(i?""+s:s):o.push("%{"+s+"}"),s=t.length=0))}for((i=t.join(""))&&o.push(i),c=[],r=t.length=0;r<o.length;r++)("string"!=typeof o[r]||n&&"\n"===o[r]?((i=t.join(""))&&c.push(i),t.length=0,c):t).push(o[r]);return(i=t.join(""))&&c.push(i),t.length=0,c},nn=function(e){return tn(e,!0,!0)},on=function(e){return"string"!=typeof e?e:(e=tn(e,!1,!1)).length?String(e[0]):""},D=function(t){let i=!0;var n=m.Msg$$module$build$src$core$msg,o=t.match(/%{BKY_[A-Z]\w*}/gi);if(o)for(let e=0;e<o.length;e++)void 0===n[o[e].toUpperCase().slice(6,-1)]&&(console.warn("No message string for "+o[e]+" in "+t),i=!1);return i},rn=function(e){var t="string"==typeof e?on(e):e,i=Number(t);if(!isNaN(i)&&0<=i&&i<=360)return{hue:i,hex:Zi(i,zc,255*Yc)};if(i=Xi(t))return{hue:null,hex:i};throw i='Invalid colour: "'+t+'"',e!==t&&(i+=' (from "'+e+'")'),Error(i)},Wu=function(){return la},zu=function(e){null===(la=e)&&null!=(e=document.querySelector("."+tu))&&e.remove()},sn=function(){var e=Zs||document.body,t=document.querySelector("div."+tu);t?la=t:((la=document.createElement("div")).className=tu,la.tabIndex=-1),p(la,"keydown",null,fe),e.appendChild(la)},an=function(e,t,i,n,o=!0){ln(),Zc=e,eu=i,(i=la)&&(i.style.direction=t?"rtl":"ltr",i.style.display="block",!n&&e instanceof x&&(n=null==(t=e.getSourceBlock())?void 0:t.workspace),Qc=null!=n?n:null,iu=(e=null!=n?n:Js).getRenderer().getClassName(),nu=e.getTheme().getClassName(),iu&&c(i,iu),nu&&c(i,nu),o)&&(ou=m.getFocusManager$$module$build$src$core$focus_manager().takeEphemeralFocus(i))},ln=function(){var e;cn()&&(Zc=null,e=la)&&(e.style.display="none",e.style.left="",e.style.top="",eu&&(eu(),eu=null),e.textContent="",iu&&(s(e,iu),iu=""),nu&&(s(e,nu),nu=""),Js.markFocused(),ou)&&(ou(),ou=null)},cn=function(){return!!Zc},un=function(e){Zc===e&&ln()},dn=function(e){let t=null===Qc,i=e;for(;!t&&i;){if(i===e){t=!0;break}i=e.options.parentWorkspace}t&&ln()},hn=function(e,t,i){la.style.left=e+"px",la.style.top=t+"px",la.style.height=i+"px"},pn=function(e,t,i,n){var o=fn(e,t,i);e=gn(e,t,i,n),o<0?hn(e,0,i.height+o):hn(e,o,i.height)},gn=function(e,t,i,n){return n?Math.min(Math.max(t.right-i.width,e.left),e.right-i.width):Math.max(Math.min(t.left,e.right-i.width),e.left)},fn=function(e,t,i){return t.bottom+i.height>=e.bottom?t.top-i.height:t.bottom},mn=function(e){return!(null==e||!e.repositionForWindowResize)},bn=function(){mn(Zc)&&Zc.repositionForWindowResize()||ln()},Ku=function(){return su},_n=function(e){su=e},yn=function(e,t,i,n,o){var r;an(au,i,In,n),t.length?(o=o||(e instanceof PointerEvent?new E(e.clientX,e.clientY):(console.warn("Context menu opened with keyboard but no location given"),new E(0,0))),r=vn(t,i,e,o),Tn(lu=r,i,o),setTimeout(function(){r.focus()},1),su=null):Cn()},vn=function(t,n,o,r){var s,a=new Cl;a.setRole(ia.MENU);for(let e=0;e<t.length;e++){let i=t[e];i.separator?a.addChild(new Il):((s=new kl(i.text)).setRightToLeft(n),s.setRole(ia.MENUITEM),a.addChild(s),s.setEnabled(i.enabled),i.enabled&&s.onAction(function(e,t){Cn(),requestAnimationFrame(()=>{setTimeout(()=>{i.callback(i.scope,o,t,r)},0)})},{}))}return a},Tn=function(e,t,i){var n=Re(),o=(i=new C(i.y+n.top,i.y+n.top,i.x+n.left,i.x+n.left),En(e),e.getSize());t&&(i.left+=o.width,i.right+=o.width,n.left+=o.width,n.right+=o.width),pn(n,i,o,t),e.focus()},En=function(e){var t=la;if(!t)throw Error("Attempting to create a context menu when widget div is null");t=e.render(t),c(t,"blocklyContextMenu"),p(t,"contextmenu",null,kn),e.focus()},kn=function(e){e.preventDefault(),e.stopPropagation()},Cn=function(){un(au),su=null},In=function(){lu&&(lu.dispose(),lu=null)},m.callbackFactory$$module$build$src$core$contextmenu=function(i,n){return()=>{m.disable$$module$build$src$core$events$utils();let e;try{e=(n instanceof Element?Bn:zt)(n,i.workspace);var t=i.getRelativeToSurfaceXY();t.x=i.RTL?t.x-m.config$$module$build$src$core$config.snapRadius:t.x+m.config$$module$build$src$core$config.snapRadius,t.y+=2*m.config$$module$build$src$core$config.snapRadius,e.moveBy(t.x,t.y)}finally{m.enable$$module$build$src$core$events$utils()}return U()&&!e.isShadow()&&g(new(f(_.BLOCK_CREATE))(e)),m.getFocusManager$$module$build$src$core$focus_manager().focusNode(e),e}},wn=function(e,t){return(t=Is(t,e.getParentSvg(),e.getInverseScreenCTM())).x/=e.scale,t.y/=e.scale,t},Sn=function(e,t,i){t=wn(e,t),pu.set(e,E.difference(i,t))},xn=function(e,t){if(t=wn(e,t),e=pu.get(e))return E.sum(e,t);throw Error("Drag not initialized")},gd=function(e,t=!1){var i,n=m.createElement$$module$build$src$core$utils$xml("xml"),o=On(m.allUsedVarModels$$module$build$src$core$variables(e));o.hasChildNodes()&&n.appendChild(o);for(i of e.getTopComments())n.appendChild(Rn(i,t));for(e=e.getTopBlocks(!0),o=0;o<e.length;o++)n.appendChild(An(e[o],t));return n},Rn=function(e,t=!1){var i=m.createElement$$module$build$src$core$utils$xml("comment"),n=(t||i.setAttribute("id",e.id),t=e.workspace,e.getRelativeToSurfaceXY());return n.x=t.RTL?t.getWidth()-n.x:n.x,i.setAttribute("x",""+n.x),i.setAttribute("y",""+n.y),i.setAttribute("w",""+e.getSize().width),i.setAttribute("h",""+e.getSize().height),e.getText()&&(i.textContent=e.getText()),e.isCollapsed()&&i.setAttribute("collapsed","true"),e.isOwnEditable()||i.setAttribute("editable","false"),e.isOwnMovable()||i.setAttribute("movable","false"),e.isOwnDeletable()||i.setAttribute("deletable","false"),i},On=function(t){var i=m.createElement$$module$build$src$core$utils$xml("variables");for(let e=0;e<t.length;e++){var n=t[e],o=m.createElement$$module$build$src$core$utils$xml("variable");o.appendChild(m.createTextNode$$module$build$src$core$utils$xml(n.getName())),n.getType()&&o.setAttribute("type",n.getType()),o.id=n.getId(),i.appendChild(o)}return i},An=function(e,t){if(e.isInsertionMarker()&&!(e=e.getChildren(!1)[0]))return new DocumentFragment;let i=0;var n;return e.workspace.RTL&&(i=e.workspace.getWidth()),t=Dn(e,t),qn(t)&&(n=e.getRelativeToSurfaceXY(),t.setAttribute("x",String(Math.round(e.workspace.RTL?i-n.x:n.x))),t.setAttribute("y",String(Math.round(n.y)))),t},Nn=function(e){var t;return e.isSerializable()?((t=m.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name",e.name||""),e.toXml(t)):null},Ln=function(e,t){for(var i of e.getFields())(e=Nn(i))&&t.appendChild(e)},Dn=function(e,t){if(e.isInsertionMarker())return(t=e.getChildren(!1)[0])?Dn(t):new DocumentFragment;var i,n,o,r=m.createElement$$module$build$src$core$utils$xml(e.isShadow()?"shadow":"block");for(r.setAttribute("type",e.type),t||(r.id=e.id),e.mutationToDom&&(i=e.mutationToDom())&&(i.hasChildNodes()||i.hasAttributes())&&r.appendChild(i),Ln(e,r),(i=e.getCommentText())&&(s=(n=e.getIcon(uc.COMMENT)).getBubbleSize(),l=n.bubbleIsVisible(),n=n.getBubbleLocation(),(o=m.createElement$$module$build$src$core$utils$xml("comment")).appendChild(m.createTextNode$$module$build$src$core$utils$xml(i)),o.setAttribute("pinned",""+l),o.setAttribute("h",""+s.height),o.setAttribute("w",""+s.width),n&&(o.setAttribute("x",""+(e.workspace.RTL?e.workspace.getWidth()-(n.x+s.width):n.x)),o.setAttribute("y",""+n.y)),r.appendChild(o)),e.data&&((i=m.createElement$$module$build$src$core$utils$xml("data")).appendChild(m.createTextNode$$module$build$src$core$utils$xml(e.data)),r.appendChild(i)),i=0;i<e.inputList.length;i++){var s,a=void 0,l=!0;(s=e.inputList[i]).type!==m.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&s.type!==m.inputTypes$$module$build$src$core$inputs$input_types.END_ROW&&(n=s.connection.targetBlock(),s.type===m.inputTypes$$module$build$src$core$inputs$input_types.VALUE?a=m.createElement$$module$build$src$core$utils$xml("value"):s.type===m.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(a=m.createElement$$module$build$src$core$utils$xml("statement")),!(o=s.connection.getShadowDom())||n&&n.isShadow()||a.appendChild(Mn(o,t)),n&&(n=Dn(n,t)).nodeType===qs.ELEMENT_NODE&&(a.appendChild(n),l=!1),a.setAttribute("name",s.name),l||r.appendChild(a))}void 0!==e.inputsInline&&e.inputsInline!==e.inputsInlineDefault&&r.setAttribute("inline",String(e.inputsInline)),e.isCollapsed()&&r.setAttribute("collapsed","true"),e.isEnabled()||r.setAttribute("disabled-reasons",Array.from(e.getDisabledReasons()).map(encodeURIComponent).join(",")),e.isOwnDeletable()||r.setAttribute("deletable","false"),e.isOwnMovable()||r.setAttribute("movable","false"),e.isOwnEditable()||r.setAttribute("editable","false");let c;return(a=e.getNextBlock())&&(i=Dn(a,t)).nodeType===qs.ELEMENT_NODE&&((c=m.createElement$$module$build$src$core$utils$xml("next")).appendChild(i),r.appendChild(c)),!(e=e.nextConnection&&e.nextConnection.getShadowDom())||a&&a.isShadow()||c.appendChild(Mn(e,t)),r},Mn=function(e,t){let i=e=e.cloneNode(!0),n;for(;i;)if(t&&"shadow"===i.nodeName&&i.removeAttribute("id"),i.firstChild)i=i.firstChild;else{for(;i&&!i.nextSibling;){var o;i=(n=i).parentNode,n.nodeType===qs.TEXT_NODE&&""===n.data.trim()&&(null==(o=i)?void 0:o.firstChild)!==n&&a(n)}i&&(i=(n=i).nextSibling,n.nodeType===qs.TEXT_NODE)&&""===n.data.trim()&&a(n)}return e},$n=function(e){return Le(e).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},pd=function(t){t=$n(t).split("<");let i="";for(let e=1;e<t.length;e++){var n=t[e];"/"===n[0]&&(i=i.substring(2)),t[e]=i+"<"+n,"/"!==n[0]&&"/>"!==n.slice(-2)&&(i+="  ")}return(t=(t=t.join("\n")).replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>")).replace(/^\n/,"")},ad=function(e,t){return t.setResizesEnabled(!1),t.clear(),e=m.domToWorkspace$$module$build$src$core$xml(e,t),t.setResizesEnabled(!0),e},m.domToWorkspace$$module$build$src$core$xml=function(i,n){let o=0;n.RTL&&(o=n.getWidth());var r=[],e=(K(),m.getGroup$$module$build$src$core$events$utils());e||m.setGroup$$module$build$src$core$events$utils(!0),n.setResizesEnabled&&n.setResizesEnabled(!1);let s=!0;try{for(let e=0,t;t=i.childNodes[e];e++){var a=t.nodeName.toLowerCase(),l=t;if("block"===a||"shadow"===a&&!Ia){var c,u,d=Bn(l,n),h=(r.push(d.id),parseInt(null!=(c=l.getAttribute("x"))?c:"10",10)),p=parseInt(null!=(u=l.getAttribute("y"))?u:"10",10);isNaN(h)||isNaN(p)||d.moveBy(n.RTL?o-h:h,p,["create"]),s=!1}else{if("shadow"===a)throw TypeError("Shadow block cannot be a top-level block.");if("comment"===a)Pn(l,n);else if("variables"===a){if(!s)throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");Fn(l,n),s=!1}}}}finally{m.setGroup$$module$build$src$core$events$utils(e),n.setResizesEnabled&&n.setResizesEnabled(!0),n.rendered&&it(),X()}return g(new(f(_.FINISHED_LOADING))(n)),r},Pn=function(e,t){var i,n,o=null!=(r=e.getAttribute("id"))?r:void 0,r=new(t.rendered?ku:Eu)(t,o);return r.setText(null!=(o=e.textContent)?o:""),o=parseInt(null!=(i=e.getAttribute("x"))?i:"",10),i=parseInt(null!=(n=e.getAttribute("y"))?n:"",10),isNaN(o)||isNaN(i)||(o=t.RTL?t.getWidth()-o:o,r.moveTo(new E(o,i))),t=parseInt(null!=(n=e.getAttribute("w"))?n:"",10),n=parseInt(null!=(o=e.getAttribute("h"))?o:"",10),isNaN(t)||isNaN(n)||r.setSize(new I(t,n)),"true"===e.getAttribute("collapsed")&&r.setCollapsed(!0),"false"===e.getAttribute("editable")&&r.setEditable(!1),"false"===e.getAttribute("movable")&&r.setMovable(!1),"false"===e.getAttribute("deletable")&&r.setDeletable(!1),r},ed=function(n,o){if(!o.getBlocksBoundingBox)return m.domToWorkspace$$module$build$src$core$xml(n,o);var e=o.getBlocksBoundingBox();if(n=m.domToWorkspace$$module$build$src$core$xml(n,o),e&&e.top!==e.bottom){var r=e.bottom,e=o.RTL?e.right:e.left,s=1/0;let t=-1/0,i=1/0;for(let e=0;e<n.length;e++){var a=o.getBlockById(n[e]).getRelativeToSurfaceXY();a.y<i&&(i=a.y),a.x<s&&(s=a.x),a.x>t&&(t=a.x)}for(r=r-i+10,e=o.RTL?e-t:e-s,s=0;s<n.length;s++)o.getBlockById(n[s]).moveBy(e,r,["create"])}return n},m.domToBlock$$module$build$src$core$xml=function(e,t){return e=Bn(e,t),t.rendered&&it(),e},Bn=function(e,i){m.disable$$module$build$src$core$events$utils();var t=i.getAllVariables();let n;try{if(n=Kn(e,i),i.rendered){let e=n,t=n.getDescendants(!1);e.setConnectionTracking(!1);for(let e=t.length-1;0<=e;e--)t[e].initSvg();for(let e=t.length-1;0<=e;e--)t[e].queueRender();setTimeout(function(){e.disposed||e.setConnectionTracking(!0)},1),i.resizeContents()}else{var o=n.getDescendants(!1);for(let e=o.length-1;0<=e;e--)o[e].initModel()}}finally{m.enable$$module$build$src$core$events$utils()}if(U()){for(e=Lt(i,t),i=0;i<e.length;i++)t=e[i],g(new(f(_.VAR_CREATE))(t));g(new(f(_.BLOCK_CREATE))(n))}return n},Fn=function(t,i){for(let e=0;e<t.children.length;e++){var n=t.children[e],o=n.getAttribute("type"),r=n.getAttribute("id");if(!(n=n.textContent))break;i.getVariableMap().createVariable(n,null!=o?o:void 0,r)}},Un=function(t){var i={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let e=0;e<t.children.length;e++){var n=t.children[e];if(n.nodeType!==qs.TEXT_NODE)switch(n.nodeName.toLowerCase()){case"mutation":i.mutation.push(n);break;case"comment":i.comment.push(n);break;case"data":i.data.push(n);break;case"title":case"field":i.field.push(n);break;case"value":case"statement":i.input.push(n);break;case"next":i.next.push(n);break;default:console.warn("Ignoring unknown tag: "+n.nodeName)}}return i},Hn=function(t,i){let n=!1;for(let e=0;e<t.length;e++){var o=t[e];i.domToMutation&&(i.domToMutation(o),i.initSvg)&&(n=!0)}return n},Gn=function(u,d){for(let c=0;c<u.length;c++){let e=u[c],t=e.textContent,i="true"===e.getAttribute("pinned");let n=parseInt(null!=(h=e.getAttribute("w"))?h:"50",10);var h=parseInt(null!=(h=e.getAttribute("h"))?h:"50",10);let o,r=parseInt(null!=(o=e.getAttribute("x"))?o:"",10),s,a=parseInt(null!=(s=e.getAttribute("y"))?s:"",10),l=(d.setCommentText(t),d.getIcon(uc.COMMENT));isNaN(n)||isNaN(h)||l.setBubbleSize(new I(n,h)),l.setBubbleVisible(i),setTimeout(()=>{isNaN(r)||isNaN(a)||(r=d.workspace.RTL?d.workspace.getWidth()-(r+n):r,l.setBubbleLocation(new E(r,a))),l.setBubbleVisible(i)},1)}},Vn=function(t,i){for(let e=0;e<t.length;e++)i.data=t[e].textContent},jn=function(t,i){for(let e=0;e<t.length;e++){var n=t[e],o=n.getAttribute("name");o?Xn(i,o,n):console.warn("Ignoring unnamed field in block "+i.type)}},Wn=function(t){let i=null,n=null;for(let e=0;e<t.childNodes.length;e++){var o=t.childNodes[e];qn(o)&&("block"===o.nodeName.toLowerCase()?i=o:"shadow"===o.nodeName.toLowerCase()&&(n=o))}return{childBlockElement:i,childShadowElement:n}},zn=function(t,i,n,o){for(let e=0;e<t.length;e++){var r=t[e],s=r.getAttribute("name"),a=s?n.getInput(s):null;if(!a){console.warn("Ignoring non-existent input "+s+" in block "+o);break}if((r=Wn(r)).childBlockElement){if(!a.connection)throw TypeError("Input connection does not exist.");Kn(r.childBlockElement,i,a.connection,!1)}r.childShadowElement&&null!=(s=a.connection)&&s.setShadowDom(r.childShadowElement)}},Yn=function(t,i,n){for(let e=0;e<t.length;e++){var o=Wn(t[e]);if(o.childBlockElement){if(!n.nextConnection)throw TypeError("Next statement does not exist.");if(n.nextConnection.isConnected())throw TypeError("Next statement is already connected.");Kn(o.childBlockElement,i,n.nextConnection,!0)}o.childShadowElement&&n.nextConnection&&n.nextConnection.setShadowDom(o.childShadowElement)}},Kn=function(e,t,i,n){var o=e.getAttribute("type");if(!o)throw TypeError("Block type unspecified: "+e.outerHTML);var r=null!=(s=e.getAttribute("id"))?s:void 0,s=t.newBlock(o,r),r=Un(e),a=Hn(r.mutation,s);if(Gn(r.comment,s),Vn(r.data,s),i)if(n){if(!s.previousConnection)throw TypeError("Next block does not have previous statement.");i.connect(s.previousConnection)}else if(s.outputConnection)i.connect(s.outputConnection);else{if(!s.previousConnection)throw TypeError("Child block does not have output or previous statement.");i.connect(s.previousConnection)}if(jn(r.field,s),zn(r.input,t,s,o),Yn(r.next,t,s),a&&s.initSvg(),(t=e.getAttribute("inline"))&&s.setInputsInline("true"===t),(t=e.getAttribute("disabled"))&&s.setDisabledReason("true"===t||"disabled"===t,xl),null!==(t=e.getAttribute("disabled-reasons")))for(var l of t.split(","))s.setDisabledReason(!0,decodeURIComponent(l));if((l=e.getAttribute("deletable"))&&s.setDeletable("true"===l),(l=e.getAttribute("movable"))&&s.setMovable("true"===l),(l=e.getAttribute("editable"))&&s.setEditable("true"===l),(l=e.getAttribute("collapsed"))&&s.setCollapsed("true"===l),"shadow"===e.nodeName.toLowerCase()){for(e=s.getChildren(!1),l=0;l<e.length;l++)if(!e[l].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");s.setShadow(!0)}return s},Xn=function(e,t,i){var n=e.getField(t);n?n.fromXml(i):console.warn("Ignoring non-existent field "+t+" in block "+e.type)},cd=function(t){for(let e=0;e<t.childNodes.length;e++){var i=t.childNodes[e];if("next"===i.nodeName.toLowerCase()){t.removeChild(i);break}}},qn=function(e){return e.nodeType===qs.ELEMENT_NODE},Jd=function(e,t){o(b.FIELD,e,t)},$d=function(e){cs(b.FIELD,e)},m.fromJson$$module$build$src$core$field_registry=function(e){return Nu.fromJsonInternal(e)},Dd=function(e){var t=ps(b.FIELD,e.type);return t?t.fromJson(e):(console.warn("Blockly could not create a field of type "+e.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null)},Jn=function(e){return e&&"object"==typeof e&&"src"in e&&"string"==typeof e.src&&"alt"in e&&"string"==typeof e.alt&&"width"in e&&"number"==typeof e.width&&"height"in e&&"number"==typeof e.height},m.register$$module$build$src$core$extensions=function(e,t){if("string"!=typeof e||""===e.trim())throw Error('Error: Invalid extension name "'+e+'"');if(Gu[e])throw Error('Error: Extension "'+e+'" is already registered.');if("function"!=typeof t)throw Error('Error: Extension "'+e+'" must be a function');Gu[e]=t},m.registerMixin$$module$build$src$core$extensions=function(e,t){if(!t||"object"!=typeof t)throw Error('Error: Mixin "'+e+'" must be a object');m.register$$module$build$src$core$extensions(e,function(){this.mixin(t)})},m.registerMutator$$module$build$src$core$extensions=function(e,t,i,n){var o='Error when registering mutator "'+e+'": ';ro(o,t);let r=no(t,o);if(i&&"function"!=typeof i)throw Error(o+'Extension "'+e+'" is not a function');m.register$$module$build$src$core$extensions(e,function(){r&&this.setMutator(new m.MutatorIcon$$module$build$src$core$icons$mutator_icon(n||[],this)),this.mixin(t),i&&i.apply(this)})},M=function(e){Zn(e)?delete Gu[e]:console.warn('No extension mapping for name "'+e+'" found to unregister')},Zn=function(e){return!!Gu[e]},Qn=function(e,t,i){var n=Gu[e];if("function"!=typeof n)throw Error('Error: Extension "'+e+'" not found.');let o;if(i?eo(e,t):o=so(t),n.apply(t),i)ro('Error after applying mutator "'+e+'": ',t);else if(!ao(o,t))throw Error('Error when applying extension "'+e+'": mutation properties changed when applying a non-mutator extension.')},eo=function(e,t){if(so(t).length)throw Error('Error: tried to apply mutation "'+e+'" to a block that already has mutator functions.  Block id: '+t.id)},to=function(e,t){return oo(e.mutationToDom,e.domToMutation,t+" mutationToDom/domToMutation")},io=function(e,t){return oo(e.saveExtraState,e.loadExtraState,t+" saveExtraState/loadExtraState")},no=function(e,t){return oo(e.compose,e.decompose,t+" compose/decompose")},oo=function(e,t,i){if(e&&t){if("function"!=typeof e||"function"!=typeof t)throw Error(i+" must be a function");return!0}if(e||t)throw Error(i+"Must have both or neither functions");return!1},ro=function(e,t){var i=to(t,e),n=io(t,e);if(!i&&!n)throw Error(e+"Mutations must contain either XML hooks, or JSON hooks, or both");no(t,e)},so=function(e){var t=[];return void 0!==e.domToMutation&&t.push(e.domToMutation),void 0!==e.mutationToDom&&t.push(e.mutationToDom),void 0!==e.saveExtraState&&t.push(e.saveExtraState),void 0!==e.loadExtraState&&t.push(e.loadExtraState),void 0!==e.compose&&t.push(e.compose),void 0!==e.decompose&&t.push(e.decompose),t},ao=function(t,i){if((i=so(i)).length!==t.length)return!1;for(let e=0;e<i.length;e++)if(t[e]!==i[e])return!1;return!0},Yd=function(t){if("object"!=typeof document)throw Error("runAfterPageLoad() requires browser document.");if("complete"===document.readyState)t();else{let e=setInterval(function(){"complete"===document.readyState&&(clearInterval(e),t())},10)}},m.buildTooltipForDropdown$$module$build$src$core$extensions=function(t,i){let e=[];return function(){e.includes(this.type)||(lo(this,t,i),e.push(this.type)),this.setTooltip(function(){var e=String(this.getFieldValue(t));return on(i[e])}.bind(this))}},lo=function(e,t,i){var n=e.getField(t);if(n instanceof Du&&!n.isOptionListDynamic())for(var o of n=n.getOptions())o!==Du.SEPARATOR&&([,n]=o,void 0===i[n])&&console.warn(`No tooltip mapping for value ${n} of field `+`${t} of block type ${e.type}.`)},m.buildTooltipWithFieldText$$module$build$src$core$extensions=function(t,i){return function(){this.setTooltip(function(){var e=this.getField(i);return on(t).replace("%1",e?e.getText():"")}.bind(this))}},Gd=function(){let t=this.tooltip;this.setTooltip(function(){var e=this.getParent();return e&&e.getInputsInline()&&e.tooltip||t}.bind(this))},u=function(e,t){return" "+e+","+t+" "},co=function(e,t){return" "+e+t.join("")},uo=function(e,t){return" M "+e+","+t+" "},ho=function(e,t){return" m "+e+","+t+" "},po=function(e,t){return" l "+e+","+t+" "},go=function(e){return" l"+e.join("")},d=function(e,t){return" "+e+" "+t+" "},fo=function(e,t,i,n){return e+" "+i+" "+i+" "+t+n},mo=function(e,t){if(!e||!t)throw Error("Cannot connect null connections.");(e.targetConnection=t).targetConnection=e},bo=function(i,n){let o=null;var r=null==(n=n.outputConnection)?void 0:n.getConnectionChecker();for(let e=0,t;t=i.inputList[e];e++){var s=t.connection;if(s&&null!=r&&r.canConnect(n,s,!1)){if(o)return null;o=s}}return o},_o=function(e,t){for(var i;i=bo(e,t);)if(!(e=i.targetBlock())||e.isShadow())return i;return null},yo=function(e){return Q(e)&&"function"==typeof e.getType&&"function"==typeof e.initView&&"function"==typeof e.dispose&&"function"==typeof e.getWeight&&"function"==typeof e.getSize&&"function"==typeof e.applyColour&&"function"==typeof e.hideForInsertionMarker&&"function"==typeof e.updateEditable&&"function"==typeof e.updateCollapsed&&"function"==typeof e.isShownWhenCollapsed&&"function"==typeof e.setOffsetInBlock&&"function"==typeof e.onLocationChange&&"function"==typeof e.onClick},vo=function(e){return yo(e)&&ri(e)&&Qe(e)&&"function"==typeof e.setText&&"function"==typeof e.getText&&"function"==typeof e.setBubbleSize&&"function"==typeof e.getBubbleSize&&"function"==typeof e.setBubbleLocation&&"function"==typeof e.getBubbleLocation&&e.getType()===uc.COMMENT},To=function(e){var t,i,n,o;100<e.getDescendants(!1).length||(t=e.workspace,o=e.getSvgRoot(),t.getAudioManager().play("delete"),i=e.getRelativeToSurfaceXY(),(n=o.cloneNode(!0)).setAttribute("transform","translate("+i.x+","+i.y+")"),null!=(o=t.getLayerManager())&&o.appendToAnimationLayer({getSvgRoot:()=>n}),Eo(n,{x:i.x,y:i.y,width:e.width,height:e.height},t.RTL,new Date))},Eo=function(e,t,i,n){var o=((new Date).getTime()-n.getTime())/150;1<o?a(e):(e.setAttribute("transform","translate("+(t.x+(i?-1:1)*t.width/2*o)+","+(t.y+t.height/2*o)+") scale("+(1-o)+")"),setTimeout(Eo,10,e,t,i,n))},ko=function(e){var t,i,n=e.workspace,o=n.scale;n.getAudioManager().play("click"),o<1||(t=n.getSvgXY(e.getSvgRoot()),e.outputConnection?(t.x+=(e.RTL?3:-3)*o,t.y+=13*o):e.previousConnection&&(t.x+=(e.RTL?-23:23)*o,t.y+=3*o),i=l(k.CIRCLE,{cx:t.x,cy:t.y,r:0,fill:"none",stroke:"#888","stroke-width":10},n.getParentSvg()),e=l(k.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*o},i),n=l(k.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},i),e.beginElement(),n.beginElement(),setTimeout(()=>{a(i)},150))},Co=function(e){var t;wo(),e.workspace.getAudioManager().play("disconnect"),e.workspace.scale<1||(t=e.getHeightWidth().height,t=Math.atan(10/t)/Math.PI*180,e.RTL||(t*=-1),Io(sd=e,t,new Date,0))},Io=function(e,t,i,n){var o=[.66,1,.66,0,-.66,-1,-.66,0];let r="";i.getTime()+200>(new Date).getTime()&&(r=`skewX(${Math.round(o[n%o.length]*t)})`,rd=setTimeout(Io,15,e,t,i,n+1)),e.getSvgRoot().setAttribute("transform",e.getTranslation()+" "+r)},wo=function(){sd&&(rd&&(clearTimeout(rd),rd=null),sd.getSvgRoot().setAttribute("transform",sd.getTranslation()),sd=null)},So=function(t,e){for(var i=t.workspace,n=m.config$$module$build$src$core$config.snapRadius,o=E.difference(e,t.getRelativeToSurfaceXY()),r=new E(0,0),s=i.getAllBlocks(!1).filter(e=>e.id!=t.id).map(e=>e.getRelativeToSurfaceXY());xo(E.sum(e,r),s)||Ro(t,E.sum(o,r),n);)i.RTL?r.translate(-n,2*n):r.translate(n,2*n);t.moveTo(E.sum(e,r))},xo=function(t,e){return e.some(e=>Math.abs(e.x-t.x)<=1&&Math.abs(e.y-t.y)<=1)},Ro=function(e,t,i){return e.getConnections_(!1).some(e=>!!e.closest(i,t).connection)},Oo=function(e,t,i){var n=i.getBoundingRectangle(),o=n.right-n.left,r=ai(t.top,n.top,t.top+t.height-(n.bottom-n.top))-n.top;let s=t.left;return t=t.left+t.width-o,e.RTL?s=Math.min(t,s):t=Math.max(s,t),!(!(e=ai(s,n.left,t)-n.left)&&!r||(i.moveBy(e,r,["inbounds"]),0))},Ao=function(o){return e=>{var t,i,n=o.getMetricsManager();n.hasFixedEdges()&&!o.isDragging()&&(va.includes(null!=(t=e.type)?t:"")?(t=n.getScrollMetrics(!0),(i=No(o,e))&&(n=m.getGroup$$module$build$src$core$events$utils()||!1,m.setGroup$$module$build$src$core$events$utils(e.group),Oo(o,t,i)&&!e.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),m.setGroup$$module$build$src$core$events$utils(n))):$s(e)&&e.scale&&e.oldScale&&e.scale>e.oldScale&&Lo(o))}},No=function(e,t){let i=null;switch(t.type){case _.BLOCK_CREATE:case _.BLOCK_MOVE:i=(i=e.getBlockById(t.blockId))&&i.getRootBlock();break;case _.COMMENT_CREATE:case _.COMMENT_MOVE:case _.COMMENT_RESIZE:i=e.getCommentById(t.commentId)}return i},Lo=function(i){if((n=i.getMetricsManager()).hasFixedEdges()&&!i.isDragging()){var n=n.getScrollMetrics(!0),o=i.getTopBoundedElements();for(let e=0,t;t=o[e];e++)Oo(i,n,t)}},Do=function(e){return e&&"function"==typeof e.isDeletable&&"function"==typeof e.dispose&&"function"==typeof e.setDeleteStyle},Mo=function(e,t){var i,n,o=e.getIcons();for(i of e.inputList)i.isVisible()&&(o.push(...i.fieldRow),null!=(n=i.connection)&&n.targetBlock()?(e=i.connection.targetBlock(),(i.connection.type!==v.NEXT_STATEMENT||t||(e=null==(n=e.lastConnectionInStack(!1))?void 0:n.getSourceBlock()))&&o.push(e)):(null==(n=i.connection)?void 0:n.type)===v.INPUT_VALUE&&o.push(i.connection));return o},$o=function(e,t){var i=e.workspace.getTopBoundedElements(!0).filter(e=>Q(e));let n=null;return 0<=(e=i.indexOf(e instanceof N?e.getRootBlock():e)+t)&&e<i.length?n=i[e]:e<0?n=i[i.length-1]:e>=i.length&&(n=i[0]),t<0&&n instanceof N&&null!=(i=null==(e=n.lastConnectionInStack(!1))?void 0:e.getSourceBlock())?i:n},Po=function(e,t){var i,n=e instanceof N?null!=(n=null==(i=e.outputConnection)?void 0:i.targetBlock())?n:e.getSurroundParent():e.getSourceBlock();return n instanceof N&&-1!==(e=(i=Mo(n,0<t)).indexOf(e))&&0<=(t=e+t)&&t<i.length?i[t]:null},Bo=function(e){return e&&"function"==typeof e.getRelativeToSurfaceXY&&"function"==typeof e.isMovable&&"function"==typeof e.startDrag&&"function"==typeof e.drag&&"function"==typeof e.endDrag&&"function"==typeof e.revertDrag},Fo=function(e){return e&&"function"==typeof e.autoHide},pp=function(e,t){o(b.ICON,e.toString(),t)},hp=function(e){cs(b.ICON,e)},Uo=function(e){return"function"==typeof e.getProcedureModel&&"function"==typeof e.doProcedureUpdate&&"function"==typeof e.isProcedureDef},Ho=function(e){return e&&"function"==typeof e.startPublishing&&"function"==typeof e.stopPublishing},Go=function(e){let t=e.getProcedureMap().getProcedures().filter(e=>!e.getReturnTypes()).map(e=>[e.getName(),e.getParameters().map(e=>e.getName()),!1]),i=(e.getBlocksByType("procedures_defnoreturn",!1).forEach(e=>{!Uo(e)&&ht(e)&&t.push(e.getProcedureDef())}),e.getProcedureMap().getProcedures().filter(e=>!!e.getReturnTypes()).map(e=>[e.getName(),e.getParameters().map(e=>e.getName()),!0]));return e.getBlocksByType("procedures_defreturn",!1).forEach(e=>{!Uo(e)&&ht(e)&&i.push(e.getProcedureDef())}),t.sort(Vo),i.sort(Vo),[t,i]},Vo=function(e,t){return e[0].localeCompare(t[0],void 0,{sensitivity:"base"})},m.findLegalName$$module$build$src$core$procedures=function(e,t){if(!t.isInFlyout)for(e=e||m.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!jo(e,t.workspace,t);){var i=e.match(/^(.*?)(\d+)$/);e=i?i[1]+(parseInt(i[2])+1):e+"2"}return e},jo=function(e,t,i){return!Wo(e,t,i)},Wo=function(e,t,i){for(var n of t.getAllBlocks(!1))if(n!==i&&ht(n)&&m.Names$$module$build$src$core$names.equals(n.getProcedureDef()[0],e))return!0;i=!i||!Uo(i)||null==i?void 0:i.getProcedureModel();for(var o of t.getProcedureMap().getProcedures())if(o!==i&&m.Names$$module$build$src$core$names.equals(o.getName(),e))return!0;return!1},m.rename$$module$build$src$core$procedures=function(e){var t=this.getSourceBlock();if(!t)throw new Jc;e=e.trim();var i=m.findLegalName$$module$build$src$core$procedures(e,t),n=(Uo(t)&&!t.isInsertionMarker()&&t.getProcedureModel().setName(i),this.getValue());if(n!==e&&n!==i)for(e=t.workspace.getAllBlocks(!1),t=0;t<e.length;t++){var o=e[t];o.renameProcedure&&o.renameProcedure(n,i)}return i},zo=function(e){function t(t,i){for(let e=0;e<t.length;e++){var n=t[e][0],o=t[e][1],r=m.createElement$$module$build$src$core$utils$xml("block"),s=(r.setAttribute("type",i),r.setAttribute("gap","16"),m.createElement$$module$build$src$core$utils$xml("mutation"));for(s.setAttribute("name",n),r.appendChild(s),n=0;n<o.length;n++){var a=m.createElement$$module$build$src$core$utils$xml("arg");a.setAttribute("name",o[n]),s.appendChild(a)}l.push(r)}}let l=[];var i,n;return Hs.procedures_defnoreturn&&((i=m.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_defnoreturn"),i.setAttribute("gap","16"),(n=m.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),n.appendChild(m.createTextNode$$module$build$src$core$utils$xml(m.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),i.appendChild(n),l.push(i)),Hs.procedures_defreturn&&((i=m.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_defreturn"),i.setAttribute("gap","16"),(n=m.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),n.appendChild(m.createTextNode$$module$build$src$core$utils$xml(m.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),i.appendChild(n),l.push(i)),Hs.procedures_ifreturn&&((i=m.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","procedures_ifreturn"),i.setAttribute("gap","16"),l.push(i)),l.length&&l[l.length-1].setAttribute("gap","24"),t((e=Go(e))[0],"procedures_callnoreturn"),t(e[1],"procedures_callreturn"),l},Yo=function(e){return Ko(e,!1)},Ko=function(e,t=!0){function i(e,t){for(var[i,n]of e)o.push({kind:"block",type:t,gap:16,extraState:{name:i,params:n}})}if(t)return ft("The XML return value of Blockly.Procedures.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),zo(e);let o=[];return Hs.procedures_defnoreturn&&o.push({kind:"block",type:"procedures_defnoreturn",gap:16,fields:{NAME:m.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE}}),Hs.procedures_defreturn&&o.push({kind:"block",type:"procedures_defreturn",gap:16,fields:{NAME:m.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE}}),Hs.procedures_ifreturn&&o.push({kind:"block",type:"procedures_ifreturn",gap:16}),o.length&&(o[o.length-1].gap=24),i((e=Go(e))[0],"procedures_callnoreturn"),i(e[1],"procedures_callreturn"),o},Xo=function(e){var i=[],n=e.getBlocksByType("procedures_mutatorarg",!1);for(let e=0,t;t=n[e];e++)i.push(t.getFieldValue("NAME"));var n=m.createElement$$module$build$src$core$utils$xml("xml"),t=m.createElement$$module$build$src$core$utils$xml("block"),o=(t.setAttribute("type","procedures_mutatorarg"),m.createElement$$module$build$src$core$utils$xml("field"));o.setAttribute("name","NAME"),i=kt(m.DEFAULT_ARG$$module$build$src$core$procedures,i),i=m.createTextNode$$module$build$src$core$utils$xml(i),o.appendChild(i),t.appendChild(o),n.appendChild(t),e.updateToolbox(n)},qo=function(e){var t;Ms(e)&&"mutator"===e.bubbleType&&e.isOpen&&e.blockId&&("procedures_defnoreturn"!==(t=(e=ie(e.workspaceId).getBlockById(e.blockId)).type)&&"procedures_defreturn"!==t||(e=e.getIcon(m.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace(),Xo(e),e.addChangeListener(Jo)))},Jo=function(e){(Rs(e)||Os(e)||As(e)||Ns(e))&&(e=ie(e.workspaceId),Xo(e))},Zo=function(t,e){return e.getAllBlocks(!1).filter(e=>Qo(e,t)||pt(e)&&m.Names$$module$build$src$core$names.equals(e.getProcedureCall(),t))},Qo=function(e,t){return Uo(e)&&!e.isProcedureDef()&&e.getProcedureModel()&&m.Names$$module$build$src$core$names.equals(e.getProcedureModel().getName(),t)},m.mutateCallers$$module$build$src$core$procedures=function(i){var n=Ia,o=i.getProcedureDef()[0],r=i.mutationToDom(!0);i=Zo(o,i.workspace);for(let e=0,t;t=i[e];e++){o=(o=t.mutationToDom())&&Le(o),t.domToMutation&&t.domToMutation(r);var s=t.mutationToDom();o!==(s=s&&Le(s))&&(m.setRecordUndo$$module$build$src$core$events$utils(!1),g(new(f(_.BLOCK_CHANGE))(t,"mutation",null,o,s)),m.setRecordUndo$$module$build$src$core$events$utils(n))}},m.getDefinition$$module$build$src$core$procedures=function(e,t){for(var i of t.getAllBlocks(!1))if(Uo(i)&&i.isProcedureDef()&&m.Names$$module$build$src$core$names.equals(i.getProcedureModel().getName(),e)||ht(i)&&m.Names$$module$build$src$core$names.equals(i.getProcedureDef()[0],e))return i;return null},er=function(e){return e.isDynamic},tr=function(e){return void 0!==e.pathDown&&void 0!==e.pathUp},ir=function(e){return void 0!==e.pathLeft&&void 0!==e.pathRight},nr=function(e,t){o(b.RENDERER,e,t)},Op=function(e){cs(b.RENDERER,e)},or=function(e,t,i){return(e=new(hs(b.RENDERER,e))(e)).init(t,i),e},rr=function(e){Ct(e.getTargetWorkspace(),void 0,"String")},sr=function(e){Ct(e.getTargetWorkspace(),void 0,"Number")},ar=function(e){Ct(e.getTargetWorkspace(),void 0,"Colour")},lr=function(e){return cr(e,!1)},cr=function(e,t=!0){return Hs.variables_set_dynamic||Hs.variables_get_dynamic||console.warn("There are no dynamic variable blocks, but there is a dynamic variable category."),t?(ft("The XML return value of Blockly.VariablesDynamic.flyoutCategory()","v12","v13","the same method, but handle a return type of FlyoutItemInfo[] (JSON) instead."),ur(e)):(e.registerButtonCallback("CREATE_VARIABLE_STRING",rr),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",sr),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",ar),[{kind:"button",text:m.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE,callbackkey:"CREATE_VARIABLE_STRING"},{kind:"button",text:m.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE,callbackkey:"CREATE_VARIABLE_NUMBER"},{kind:"button",text:m.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE,callbackkey:"CREATE_VARIABLE_COLOUR"},...yt(e,e.getVariableMap().getAllVariables(),!1,"variables_get_dynamic","variables_set_dynamic")])},ur=function(e){let t=[],i=document.createElement("button");return i.setAttribute("text",m.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),t.push(i),(i=document.createElement("button")).setAttribute("text",m.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),t.push(i),(i=document.createElement("button")).setAttribute("text",m.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),i.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),t.push(i),e.registerButtonCallback("CREATE_VARIABLE_STRING",rr),e.registerButtonCallback("CREATE_VARIABLE_NUMBER",sr),e.registerButtonCallback("CREATE_VARIABLE_COLOUR",ar),e=dr(e),t=t.concat(e)},dr=function(i){i=i.getVariableMap().getAllVariables();var n,e,o=[];if(0<i.length&&(Hs.variables_set_dynamic&&(n=i[i.length-1],(e=m.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_set_dynamic"),e.setAttribute("gap","24"),e.appendChild(At(n)),o.push(e)),Hs.variables_get_dynamic)){i.sort(Dt);for(let e=0,t;t=i[e];e++)(n=m.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type","variables_get_dynamic"),n.setAttribute("gap","8"),n.appendChild(At(t)),o.push(n)}return o},hr=function(e,t){var i=e.toCopyData();return Kh=i,Xh=ee(e)&&e.workspace instanceof Sh?e.workspace:null,qh=t,i},Np=function(){return Kh},Wp=function(e){Kh=e},Dp=function(){return Xh},Yp=function(e){Xh=e},Lp=function(){return qh},zp=function(e){qh=e},pr=function(e,t,i){return e&&t?gr(e,t,i):Kh&&Xh?gr(Kh,Xh,qh):null},gr=function(e,t,i){var n;return t=!t.isMutator&&null!=(n=t.options.parentWorkspace)?n:t,null!=(n=null==(n=ps(b.PASTER,e.paster,!1))?void 0:n.paste(e,t,i))?n:null},fr=function(e){return e&&"function"==typeof e.toCopyData},mr=function(){T.registry.register({name:Xd.ESCAPE,preconditionFn(e){return!e.isReadOnly()},callback(e){return e.hideChaff(),!0},keyCodes:[n.ESC]})},br=function(){T.registry.register({name:Xd.DELETE,preconditionFn(e,t){return t=t.focusedNode,!e.isReadOnly()&&null!=t&&Do(t)&&t.isDeletable()&&!e.isDragging()&&!m.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()},callback(e,t,i,n){return t.preventDefault(),(e=n.focusedNode)instanceof N?e.checkAndDelete():Do(e)&&e.isDeletable()&&(m.setGroup$$module$build$src$core$events$utils(!0),e.dispose(),m.setGroup$$module$build$src$core$events$utils(!1)),!0},keyCodes:[n.DELETE,n.BACKSPACE]})},_r=function(e){return!!(fr(e)&&Do(e)&&Bo(e))&&(e.isCopyable?e.isCopyable():e instanceof N||e instanceof ku?e.isOwnDeletable()&&e.isOwnMovable():e.isDeletable()&&e.isMovable())},yr=function(e){return _r(e)&&Do(e)&&e.isDeletable()},vr=function(){var e=T.registry.createSerializedKey(n.C,[n.CTRL]),t=T.registry.createSerializedKey(n.C,[n.META]);T.registry.register({name:Xd.COPY,preconditionFn(e,t){return t=t.focusedNode,e=e.isFlyout?e.targetWorkspace:e,!!t&&!!e&&!e.isDragging()&&!m.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&_r(t)},callback(e,t,i,n){return t.preventDefault(),!!((t=n.focusedNode)&&fr(t)&&_r(t))&&!!(e=e.isFlyout?e.targetWorkspace:e)&&(t.workspace.isFlyout||e.hideChaff(),e=Bo(t)&&t.workspace==e?t.getRelativeToSurfaceXY():void 0,!!hr(t,e))},keyCodes:[e,t]})},Tr=function(){var e=T.registry.createSerializedKey(n.X,[n.CTRL]),t=T.registry.createSerializedKey(n.X,[n.META]);T.registry.register({name:Xd.CUT,preconditionFn(e,t){return!!(t=t.focusedNode)&&!e.isReadOnly()&&!e.isDragging()&&!m.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&yr(t)},callback(e,t,i,n){return!!((e=n.focusedNode)&&yr(e)&&fr(e))&&(t=Bo(e)?e.getRelativeToSurfaceXY():void 0,t=hr(e,t),e instanceof N?e.checkAndDelete():Do(e)&&e.dispose(),!!t)},keyCodes:[e,t]})},Er=function(){var e=T.registry.createSerializedKey(n.V,[n.CTRL]),t=T.registry.createSerializedKey(n.V,[n.META]);T.registry.register({name:Xd.PASTE,preconditionFn(){var e=Xh;return!(!e||!e.rendered||(e=e.isFlyout?e.targetWorkspace:e,!Kh)||!e||e.isReadOnly()||e.isDragging()||m.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken())},callback(e,t){if(!(e=Kh))return!1;var i=Xh;if(!i)return!1;if(!(i=i.isFlyout?i.targetWorkspace:i)||i.isReadOnly())return!1;if(t instanceof PointerEvent)t=Ae(i,new E(t.clientX,t.clientY));else{if(!(t=qh))return!!pr(e,i);var{left:n,top:o,width:r,height:s}=i.getMetricsManager().getViewMetrics(!0);if(new C(o,o+s,n,n+r).contains(t.x,t.y))return!!pr(e,i);t=new E(n+r/2,o+s/2)}return!!pr(e,i,t)},keyCodes:[e,t]})},kr=function(){var e=T.registry.createSerializedKey(n.Z,[n.CTRL]),t=T.registry.createSerializedKey(n.Z,[n.META]);T.registry.register({name:Xd.UNDO,preconditionFn(e){return!e.isReadOnly()&&!e.isDragging()&&!m.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()},callback(e,t){return e.hideChaff(),e.undo(!1),t.preventDefault(),!0},keyCodes:[e,t]})},Cr=function(){var e=T.registry.createSerializedKey(n.Z,[n.CTRL,n.SHIFT]),t=T.registry.createSerializedKey(n.Z,[n.META,n.SHIFT]),i=T.registry.createSerializedKey(n.Y,[n.CTRL]);T.registry.register({name:Xd.REDO,preconditionFn(e){return!e.isDragging()&&!e.isReadOnly()&&!m.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()},callback(e,t){return e.hideChaff(),e.undo(!0),t.preventDefault(),!0},keyCodes:[e,t,i]})},Jp=function(){mr(),br(),vr(),Tr(),Er(),kr(),Cr()},Ir=function(e){var t=e.saveState();return e.getParameters().length&&(t.parameters=e.getParameters().map(e=>e.saveState())),t},wr=function(e,t,i,n){if(e=e.loadState(i,n),i.parameters)for(var[o,r]of i.parameters.entries())e.insertParameter(t.loadState(r,n),o);return e},tg=function(e){var t,i=Object.create(null),n=gs(b.SERIALIZER,!0);for(t in n){var o=null==(o=n[t])?void 0:o.save(e);o&&(i[t]=o)}return i},Qp=function(e,t,{recordUndo:i=!1}={}){if(l=gs(b.SERIALIZER,!0)){var n,o,r,s,a,l=Object.entries(l).sort((e,t)=>t[1].priority-e[1].priority),c=Ia;m.setRecordUndo$$module$build$src$core$events$utils(i),(i=m.getGroup$$module$build$src$core$events$utils())||m.setGroup$$module$build$src$core$events$utils(!0),K(),t instanceof Sh&&t.setResizesEnabled(!1);for([,n]of l.reverse())null!=(o=n)&&o.clear(t);for([r,s]of l.reverse())e[r]&&null!=(a=s)&&a.load(e[r],t);t instanceof Sh&&t.setResizesEnabled(!0),X(),g(new(f(_.FINISHED_LOADING))(t)),m.setGroup$$module$build$src$core$events$utils(i),m.setRecordUndo$$module$build$src$core$events$utils(c)}},Sr=function(e,t){var i,n=null,n="string"==typeof e?document.getElementById(e)||document.querySelector(e):e;if(!document.contains(n)&&document!==(null==(i=n)?void 0:i.ownerDocument))throw Error("Error: container is not in current document");e=new Pu(t||{}),i=document.createElement("div"),c(i,"injectionDiv"),null!=t&&t.rtl&&c(i,"blocklyRTL"),n.appendChild(i),t=xr(i,e);let o=Rr(i,t,e);return Or(o),ae(o),de(o),i.addEventListener("focusin",function(){ae(o)}),p(i,"keydown",null,fe),o},xr=function(e,t){e.setAttribute("dir","LTR"),_e(t.hasCss,t.pathToMedia);var i=l(k.SVG,{xmlns:Oa,"xmlns:html":Aa,"xmlns:xlink":Na,version:"1.1",class:"blocklySvg"},e),n=l(k.DEFS,{},i),o=String(Math.random()).substring(2);return t.gridPattern=Ud.createDom(o,t.gridOptions,n,e),i},Rr=function(e,t,i){i.parentWorkspace=null;var n=(i=new Sh(i)).options,o=(i.scale=n.zoomOptions.startScale,t.appendChild(i.createDom("blocklyMainBackground",e)),i.getRenderer().getClassName());return o&&c(e,o),(o=i.getTheme().getClassName())&&c(e,o),!n.hasCategories&&n.languageTree&&(e=i.addFlyout(k.SVG),z(e,t)),n.hasTrashcan&&i.addTrashcan(),n.zoomOptions&&n.zoomOptions.controls&&i.addZoomControls(),i.getThemeManager().subscribe(t,"workspaceBackgroundColour","background-color"),i.translate(0,0),i.addChangeListener(Ao(i)),de(i),sn(),li(),Mi(),i},Or=function(e){var t,i=e.options,n=e.getParentSvg();p(n.parentNode,"contextmenu",null,function(e){ks(e)||e.preventDefault()}),n=p(window,"resize",null,function(){Gi(),e.hideComponents(!0),Ii(),bn(),de(e),Lo(e)}),e.setResizeHandlerWrapper(n),Ar(),i.languageTree&&(n=e.getToolbox(),t=e.getFlyout(!0),n?n.init():t&&(t.init(e),t.show(i.languageTree),"function"==typeof t.scrollToStart)&&t.scrollToStart()),i.hasTrashcan&&e.trashcan.init(),i.zoomOptions&&i.zoomOptions.controls&&e.zoomControls_.init(),i.moveOptions&&i.moveOptions.scrollbars?(e.scrollbar=new Nd(e,!0===i.moveOptions.scrollbars||!!i.moveOptions.scrollbars.horizontal,!0===i.moveOptions.scrollbars||!!i.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),e.scrollbar.resize()):e.setMetrics({x:.5,y:.5}),i.hasSounds&&Nr(i.pathToMedia,e)},Ar=function(){dp||(p(document,"scroll",null,function(){var i=ne();for(let e=0,t;t=i[e];e++)t instanceof Sh&&t.updateInverseScreenCTM()}),Es(document,"touchend",null,bs),Es(document,"touchcancel",null,bs)),dp=!0},Nr=function(e,t){function i(){for(;o.length;){var e=o.pop();e&&r(e)}n.preload()}let n=t.getAudioManager(),o=(n.load([e+"click.mp3",e+"click.wav",e+"click.ogg"],"click"),n.load([e+"disconnect.wav",e+"disconnect.mp3",e+"disconnect.ogg"],"disconnect"),n.load([e+"delete.mp3",e+"delete.ogg",e+"delete.wav"],"delete"),[]);o.push(p(document,"pointermove",null,i,!0)),o.push(p(document,"touchstart",null,i,!0))},Lr=function(){R.registry.register({displayText(){return m.Msg$$module$build$src$core$msg.UNDO},preconditionFn(e){return 0<e.workspace.getUndoStack().length?"enabled":"disabled"},callback(e){e.workspace.undo(!1)},scopeType:R.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},Dr=function(){R.registry.register({displayText(){return m.Msg$$module$build$src$core$msg.REDO},preconditionFn(e){return 0<e.workspace.getRedoStack().length?"enabled":"disabled"},callback(e){e.workspace.undo(!0)},scopeType:R.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},Mr=function(){R.registry.register({displayText(){return m.Msg$$module$build$src$core$msg.CLEAN_UP},preconditionFn(e){return e.workspace.isMovable()?1<e.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden"},callback(e){e.workspace.cleanUp()},scopeType:R.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},$r=function(t,i){function n(e){r--,e.setCollapsed(t),0===r&&m.setGroup$$module$build$src$core$events$utils(!1)}let o=0,r=0;m.setGroup$$module$build$src$core$events$utils(!0);for(let t=0;t<i.length;t++){let e=i[t];for(;e;)r++,setTimeout(n.bind(null,e),o),e=e.getNextBlock(),o+=10}},Pr=function(){R.registry.register({displayText(){return m.Msg$$module$build$src$core$msg.COLLAPSE_ALL},preconditionFn(i){if(i.workspace.options.collapse){i=i.workspace.getTopBlocks(!1);for(let t=0;t<i.length;t++){let e=i[t];for(;e;){if(!e.isCollapsed())return"enabled";e=e.getNextBlock()}}return"disabled"}return"hidden"},callback(e){$r(!0,e.workspace.getTopBlocks(!0))},scopeType:R.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},Br=function(){R.registry.register({displayText(){return m.Msg$$module$build$src$core$msg.EXPAND_ALL},preconditionFn(i){if(i.workspace.options.collapse){i=i.workspace.getTopBlocks(!1);for(let t=0;t<i.length;t++){let e=i[t];for(;e;){if(e.isCollapsed())return"enabled";e=e.getNextBlock()}}return"disabled"}return"hidden"},callback(e){$r(!1,e.workspace.getTopBlocks(!0))},scopeType:R.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},Fr=function(t,i){if(t.isDeletable())Array.prototype.push.apply(i,t.getDescendants(!1));else{t=t.getChildren(!1);for(let e=0;e<t.length;e++)Fr(t[e],i)}},Ur=function(t){var i=[];t=t.getTopBlocks(!0);for(let e=0;e<t.length;e++)Fr(t[e],i);return i},Hr=function(e,t){t?m.setGroup$$module$build$src$core$events$utils(t):(m.setGroup$$module$build$src$core$events$utils(!0),t=m.getGroup$$module$build$src$core$events$utils());var i=e.shift();i&&(i.isDeadOrDying()?Hr(e,t):(i.dispose(!1,!0),setTimeout(Hr,10,e,t))),m.setGroup$$module$build$src$core$events$utils(!1)},Gr=function(){R.registry.register({displayText(e){return e.workspace?1===(e=Ur(e.workspace).length)?m.Msg$$module$build$src$core$msg.DELETE_BLOCK:m.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",""+e):""},preconditionFn(e){return e.workspace&&0<Ur(e.workspace).length?"enabled":"disabled"},callback(e){var t;e.workspace&&(e.workspace.cancelCurrentGesture(),(t=Ur(e.workspace)).length<2?Hr(t):ut(m.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(t.length)),function(e){e&&Hr(t)}))},scopeType:R.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},Vr=function(){Lr(),Dr(),Mr(),Pr(),Br(),Gr()},jr=function(){R.registry.register({displayText(){return m.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK},preconditionFn(e){return!(e=e.block).isInFlyout&&e.isDeletable()&&e.isMovable()?e.isDuplicatable()?"enabled":"disabled":"hidden"},callback(e){var t;e.block&&(t=e.block.toCopyData())&&pr(t,e.block.workspace)},scopeType:R.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},Wr=function(){R.registry.register({displayText(e){return e.block.hasIcon(zd.TYPE)?m.Msg$$module$build$src$core$msg.REMOVE_COMMENT:m.Msg$$module$build$src$core$msg.ADD_COMMENT},preconditionFn(e){return!(e=e.block).isInFlyout&&e.workspace.options.comments&&!e.isCollapsed()&&e.isEditable()?"enabled":"hidden"},callback(e){(e=e.block).hasIcon(zd.TYPE)?e.setCommentText(null):e.setCommentText("")},scopeType:R.ScopeType.BLOCK,id:"blockComment",weight:2})},zr=function(){R.registry.register({displayText(e){return e.block.getInputsInline()?m.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:m.Msg$$module$build$src$core$msg.INLINE_INPUTS},preconditionFn(t){if(!(t=t.block).isInFlyout&&t.isMovable()&&!t.isCollapsed())for(let e=1;e<t.inputList.length;e++)if(!(t.inputList[e-1]instanceof np||t.inputList[e]instanceof np))return"enabled";return"hidden"},callback(e){e.block.setInputsInline(!e.block.getInputsInline())},scopeType:R.ScopeType.BLOCK,id:"blockInline",weight:3})},Yr=function(){R.registry.register({displayText(e){return e.block.isCollapsed()?m.Msg$$module$build$src$core$msg.EXPAND_BLOCK:m.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK},preconditionFn(e){return!(e=e.block).isInFlyout&&e.isMovable()&&e.workspace.options.collapse?"enabled":"hidden"},callback(e){e.block.setCollapsed(!e.block.isCollapsed())},scopeType:R.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},Kr=function(){R.registry.register({displayText(e){return e.block.hasDisabledReason(xl)?m.Msg$$module$build$src$core$msg.ENABLE_BLOCK:m.Msg$$module$build$src$core$msg.DISABLE_BLOCK},preconditionFn(e){var t;return!(e=e.block).isInFlyout&&e.workspace.options.disable&&e.isEditable()?(t=(t=e.getDisabledReasons()).size>(t.has(xl)?1:0),e.getInheritedDisabled()||t?"disabled":"enabled"):"hidden"},callback(e){e=e.block;var t=m.getGroup$$module$build$src$core$events$utils();t||m.setGroup$$module$build$src$core$events$utils(!0),e.setDisabledReason(!e.hasDisabledReason(xl),xl),m.setGroup$$module$build$src$core$events$utils(t)},scopeType:R.ScopeType.BLOCK,id:"blockDisable",weight:5})},Xr=function(){R.registry.register({displayText(e){var t=e.block;return e=t.getDescendants(!1).length,(t=t.getNextBlock())&&(e-=t.getDescendants(!1).length),1===e?m.Msg$$module$build$src$core$msg.DELETE_BLOCK:m.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",""+e)},preconditionFn(e){return!e.block.isInFlyout&&e.block.isDeletable()?"enabled":"hidden"},callback(e){e.block&&e.block.checkAndDelete()},scopeType:R.ScopeType.BLOCK,id:"blockDelete",weight:6})},qr=function(){R.registry.register({displayText(){return m.Msg$$module$build$src$core$msg.HELP},preconditionFn(e){return("function"==typeof(e=e.block).helpUrl?e.helpUrl():e.helpUrl)?"enabled":"hidden"},callback(e){e.block.showHelp()},scopeType:R.ScopeType.BLOCK,id:"blockHelp",weight:7})},Jr=function(){R.registry.register({displayText:()=>m.Msg$$module$build$src$core$msg.REMOVE_COMMENT,preconditionFn(e){return null!=(e=e.comment)&&e.isDeletable()?"enabled":"hidden"},callback(e){m.setGroup$$module$build$src$core$events$utils(!0),null!=(e=e.comment)&&e.dispose(),m.setGroup$$module$build$src$core$events$utils(!1)},scopeType:R.ScopeType.COMMENT,id:"commentDelete",weight:6})},Zr=function(){R.registry.register({displayText:()=>m.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,preconditionFn(e){return null!=(e=e.comment)&&e.isMovable()?"enabled":"hidden"},callback(e){var t;e.comment&&(t=e.comment.toCopyData())&&pr(t,e.comment.workspace)},scopeType:R.ScopeType.COMMENT,id:"commentDuplicate",weight:1})},Qr=function(){R.registry.register({displayText:()=>m.Msg$$module$build$src$core$msg.ADD_COMMENT,preconditionFn:e=>null!=(e=e.workspace)&&e.isMutator?"hidden":"enabled",callback:(e,t,i,n)=>{(e=e.workspace)&&(m.setGroup$$module$build$src$core$events$utils(!0),(t=new ku(e)).setPlaceholderText(m.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT),t.moveTo(es(new E(n.x,n.y),e)),m.getFocusManager$$module$build$src$core$focus_manager().focusNode(t),m.setGroup$$module$build$src$core$events$utils(!1))},scopeType:R.ScopeType.WORKSPACE,id:"commentCreate",weight:8})},es=function(e,t){var i=t.getInjectionDiv().getBoundingClientRect();return e=new E(e.x-i.left,e.y-i.top),i=t.getOriginOffsetInPixels(),(e=E.difference(e,i)).scale(1/t.scale),e},ts=function(){jr(),Wr(),zr(),Yr(),Kr(),Xr(),qr()},is=function(){Zr(),Jr(),Qr()},ns=function(){Vr(),ts()},os=function(e){return e&&"function"==typeof e.paste},rs=function(e){return e&&"function"==typeof e.getSvgRoot},ss=function(e){return e.isSelectable()},as=function(e){Js.hideChaff(e)},(h=h||{}).scope={},h.ASSUME_ES5=!1,h.ASSUME_ES6=!1,h.ASSUME_ES2020=!1,h.ASSUME_NO_NATIVE_MAP=!1,h.ASSUME_NO_NATIVE_SET=!1,h.ISOLATE_POLYFILLS=!1,h.FORCE_POLYFILL_PROMISE=!1,h.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,h.INSTRUMENT_ASYNC_CONTEXT=!0,h.objectCreate=h.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(e){function t(){}return t.prototype=e,new t},h.defineProperty=h.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,i){return e!=Array.prototype&&e!=Object.prototype&&(e[t]=i.value),e},h.getGlobal=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof ig&&ig];for(var t=0;t<e.length;++t){var i=e[t];if(i&&i.Math==Math)return i}throw Error("Cannot find global object")},h.global=h.ASSUME_ES2020?globalThis:h.getGlobal(this),h.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),h.TRUST_ES6_POLYFILLS=!h.ISOLATE_POLYFILLS||h.IS_SYMBOL_NATIVE,h.polyfills={},h.propertyToPolyfillSymbol={},h.POLYFILL_PREFIX="$jscp$",h.polyfill=function(e,t,i,n){t&&(h.ISOLATE_POLYFILLS?h.polyfillIsolated(e,t,i,n):h.polyfillUnisolated(e,t,i,n))},h.polyfillUnisolated=function(e,t,i,n){for(i=h.global,e=e.split("."),n=0;n<e.length-1;n++){var o=e[n];if(!(o in i))return;i=i[o]}(t=t(n=i[e=e[e.length-1]]))!=n&&null!=t&&h.defineProperty(i,e,{configurable:!0,writable:!0,value:t})},h.polyfillIsolated=function(e,t,i,n){var o=e.split(".");e=1===o.length,n=o[0],n=!e&&n in h.polyfills?h.polyfills:h.global;for(var r=0;r<o.length-1;r++){var s=o[r];if(!(s in n))return;n=n[s]}o=o[o.length-1],null!=(t=t(i=h.IS_SYMBOL_NATIVE&&"es6"===i?n[o]:null))&&(e?h.defineProperty(h.polyfills,o,{configurable:!0,writable:!0,value:t}):t!==i&&(void 0===h.propertyToPolyfillSymbol[o]&&(i=1e9*Math.random()>>>0,h.propertyToPolyfillSymbol[o]=h.IS_SYMBOL_NATIVE?h.global.Symbol(o):h.POLYFILL_PREFIX+i+"$"+o),h.defineProperty(n,h.propertyToPolyfillSymbol[o],{configurable:!0,writable:!0,value:t})))},h.getConstructImplementation=function(){var n;return h.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct?(Reflect.construct(e,[],function(){}),new e instanceof e?Reflect.construct:(n=Reflect.construct,function(e,t,i){return e=n(e,t),i&&Reflect.setPrototypeOf(e,i.prototype),e})):function(e,t,i){return i=h.objectCreate((i=void 0===i?e:i).prototype||Object.prototype),Function.prototype.apply.call(e,i,t)||i};function e(){}},h.construct={valueOf:h.getConstructImplementation}.valueOf(),h.underscoreProtoCanBeSet=function(){var e={};try{return e.__proto__={a:!0},e.a}catch(e){}return!1},h.setPrototypeOf=h.ASSUME_ES6||h.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:h.underscoreProtoCanBeSet()?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null,h.inherits=function(e,t){if(e.prototype=h.objectCreate(t.prototype),e.prototype.constructor=e,h.ASSUME_ES6||h.setPrototypeOf){var i=h.setPrototypeOf;i(e,t)}else for(i in t){var n;"prototype"!=i&&(Object.defineProperties?(n=Object.getOwnPropertyDescriptor(t,i))&&Object.defineProperty(e,i,n):e[i]=t[i])}e.superClass_=t.prototype},h.arrayIteratorImpl=function(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}},h.arrayIterator=function(e){return{next:h.arrayIteratorImpl(e)}},h.makeIterator=function(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];if(t)return t.call(e);if("number"==typeof e.length)return h.arrayIterator(e);throw Error(String(e)+" is not an iterable or ArrayLike")},h.arrayFromIterator=function(e){for(var t,i=[];!(t=e.next()).done;)i.push(t.value);return i},h.arrayFromIterable=function(e){return e instanceof Array?e:h.arrayFromIterator(h.makeIterator(e))},h.generator={},h.generator.ensureIteratorResultIsObject_=function(e){if(!(e instanceof Object))throw new TypeError("Iterator result "+e+" is not an object")},h.generator.Context=function(){this.isRunning_=!1,this.yieldAllIterator_=null,this.yieldResult=void 0,this.nextAddress=1,this.finallyAddress_=this.catchAddress_=0,this.finallyContexts_=this.abruptCompletion_=null},h.generator.Context.prototype.start_=function(){if(this.isRunning_)throw new TypeError("Generator is already running");this.isRunning_=!0},h.generator.Context.prototype.stop_=function(){this.isRunning_=!1},h.generator.Context.prototype.jumpToErrorHandler_=function(){this.nextAddress=this.catchAddress_||this.finallyAddress_},h.generator.Context.prototype.next_=function(e){this.yieldResult=e},h.generator.Context.prototype.throw_=function(e){this.abruptCompletion_={exception:e,isException:!0},this.jumpToErrorHandler_()},h.generator.Context.prototype.return=function(e){this.abruptCompletion_={return:e},this.nextAddress=this.finallyAddress_},h.generator.Context.prototype.jumpThroughFinallyBlocks=function(e){this.abruptCompletion_={jumpTo:e},this.nextAddress=this.finallyAddress_},h.generator.Context.prototype.yield=function(e,t){return this.nextAddress=t,{value:e}},h.generator.Context.prototype.yieldAll=function(e,t){var i=(e=h.makeIterator(e)).next();if(h.generator.ensureIteratorResultIsObject_(i),!i.done)return this.yieldAllIterator_=e,this.yield(i.value,t);this.yieldResult=i.value,this.nextAddress=t},h.generator.Context.prototype.jumpTo=function(e){this.nextAddress=e},h.generator.Context.prototype.jumpToEnd=function(){this.nextAddress=0},h.generator.Context.prototype.setCatchFinallyBlocks=function(e,t){this.catchAddress_=e,null!=t&&(this.finallyAddress_=t)},h.generator.Context.prototype.setFinallyBlock=function(e){this.catchAddress_=0,this.finallyAddress_=e||0},h.generator.Context.prototype.leaveTryBlock=function(e,t){this.nextAddress=e,this.catchAddress_=t||0},h.generator.Context.prototype.enterCatchBlock=function(e){return this.catchAddress_=e||0,e=this.abruptCompletion_.exception,this.abruptCompletion_=null,e},h.generator.Context.prototype.enterFinallyBlock=function(e,t,i){i?this.finallyContexts_[i]=this.abruptCompletion_:this.finallyContexts_=[this.abruptCompletion_],this.catchAddress_=e||0,this.finallyAddress_=t||0},h.generator.Context.prototype.leaveFinallyBlock=function(e,t){if(t=this.finallyContexts_.splice(t||0)[0],t=this.abruptCompletion_=this.abruptCompletion_||t){if(t.isException)return this.jumpToErrorHandler_();null!=t.jumpTo&&this.finallyAddress_<t.jumpTo?(this.nextAddress=t.jumpTo,this.abruptCompletion_=null):this.nextAddress=this.finallyAddress_}else this.nextAddress=e},h.generator.Context.prototype.forIn=function(e){return new h.generator.Context.PropertyIterator(e)},h.generator.Context.PropertyIterator=function(e){for(var t in this.object_=e,this.properties_=[],e)this.properties_.push(t);this.properties_.reverse()},h.generator.Context.PropertyIterator.prototype.getNext=function(){for(;0<this.properties_.length;){var e=this.properties_.pop();if(e in this.object_)return e}return null},h.generator.Engine_=function(e){this.context_=new h.generator.Context,this.program_=e},h.generator.Engine_.prototype.next_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.next,e,this.context_.next_):(this.context_.next_(e),this.nextStep_())},h.generator.Engine_.prototype.return_=function(e){this.context_.start_();var t=this.context_.yieldAllIterator_;return t?this.yieldAllStep_("return"in t?t.return:function(e){return{value:e,done:!0}},e,this.context_.return):(this.context_.return(e),this.nextStep_())},h.generator.Engine_.prototype.throw_=function(e){return this.context_.start_(),this.context_.yieldAllIterator_?this.yieldAllStep_(this.context_.yieldAllIterator_.throw,e,this.context_.next_):(this.context_.throw_(e),this.nextStep_())},h.generator.Engine_.prototype.yieldAllStep_=function(e,t,i){try{var n=e.call(this.context_.yieldAllIterator_,t);if(h.generator.ensureIteratorResultIsObject_(n),!n.done)return this.context_.stop_(),n;var o=n.value}catch(e){return this.context_.yieldAllIterator_=null,this.context_.throw_(e),this.nextStep_()}return this.context_.yieldAllIterator_=null,i.call(this.context_,o),this.nextStep_()},h.generator.Engine_.prototype.nextStep_=function(){for(;this.context_.nextAddress;)try{var e=this.program_(this.context_);if(e)return this.context_.stop_(),{value:e.value,done:!1}}catch(e){this.context_.yieldResult=void 0,this.context_.throw_(e)}if(this.context_.stop_(),this.context_.abruptCompletion_){if(e=this.context_.abruptCompletion_,this.context_.abruptCompletion_=null,e.isException)throw e.exception;return{value:e.return,done:!0}}return{value:void 0,done:!0}},h.generator.Generator_=function(t){this.next=function(e){return t.next_(e)},this.throw=function(e){return t.throw_(e)},this.return=function(e){return t.return_(e)},this[Symbol.iterator]=function(){return this}},h.generator.createGenerator=function(e,t){return t=new h.generator.Generator_(new h.generator.Engine_(t)),h.setPrototypeOf&&e.prototype&&h.setPrototypeOf(t,e.prototype),t},h.asyncExecutePromiseGenerator=function(t){function o(e){return t.next(e)}function r(e){return t.throw(e)}return new Promise(function(i,n){!function e(t){t.done?i(t.value):Promise.resolve(t.value).then(o,r).then(e,n)}(t.next())})},h.asyncExecutePromiseGeneratorFunction=function(e){return h.asyncExecutePromiseGenerator(e())},h.asyncExecutePromiseGeneratorProgram=function(e){return h.asyncExecutePromiseGenerator(new h.generator.Generator_(new h.generator.Engine_(e)))},h.polyfill("globalThis",function(e){return e||h.global},"es_2020","es3"),h.polyfill("Array.prototype.includes",function(e){return e||function(e,t){var i=this,n=(i=i instanceof String?String(i):i).length;for((t=t||0)<0&&(t=Math.max(t+n,0));t<n;t++){var o=i[t];if(o===e||Object.is(o,e))return!0}return!1}},"es7","es3"),h.checkEs6ConformanceViaProxy=function(){try{var n={},o=Object.create(new h.global.Proxy(n,{get:function(e,t,i){return e==n&&"q"==t&&i==o}}));return!0===o.q}catch(e){return!1}},h.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1,h.ES6_CONFORMANCE=h.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&h.checkEs6ConformanceViaProxy(),h.initSymbol=function(){},h.iteratorPrototype=function(e){return(e={next:e})[Symbol.iterator]=function(){return this},e},h.owns=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},h.MapEntry=function(){},h.polyfill("Set.prototype.difference",function(e){return e||function(e){h.checkIsSetInstance(this),h.checkIsSetLike(e);for(var t=h.getSmallerAndLargerSets(this,e),i=(e=new Set(this),t.smallerSetIterator),t=t.largerSet,n=i.next();!n.done;)t.has(n.value)&&e.delete(n.value),n=i.next();return e}},"es_next","es6"),h.checkIsSetLike=function(e){if("object"!=typeof e||null===e||"number"!=typeof e.size||e.size<0||"function"!=typeof e.keys||"function"!=typeof e.has)throw new TypeError("Argument must be set-like")},h.checkIsValidIterator=function(e){if("object"!=typeof e||null===e||"function"!=typeof e.next)throw new TypeError("Invalid iterator.");return e},h.getSmallerAndLargerSets=function(e,t){return e.size<=t.size?{smallerSetIterator:e.keys(),largerSet:t}:{smallerSetIterator:h.checkIsValidIterator(t.keys()),largerSet:e}},h.checkIsSetInstance=function(e){if(!(e instanceof Set))throw new TypeError("Method must be called on an instance of Set.")},h.iteratorFromArray=function(t,i){if(h.ASSUME_ES6)return t[Symbol.iterator]();t instanceof String&&(t+="");var n=0,o=!1,e={next:function(){var e;return!o&&n<t.length?(e=n++,{value:i(e,t[e]),done:!1}):{done:o=!0,value:void 0}}};return e[Symbol.iterator]=function(){return e},e},h.polyfill("Array.prototype.values",function(e){return e||function(){return h.iteratorFromArray(this,function(e,t){return t})}},"es8","es3"),h.polyfill("Array.prototype.flatMap",function(e){return e||function(i,n){var o=[];return Array.prototype.forEach.call(this,function(e,t){e=i.call(n,e,t,this),Array.isArray(e)?o.push.apply(o,e):o.push(e)}),o}},"es9","es5"),h.polyfill("Array.prototype.flat",function(e){return e||function(t){t=void 0===t?1:t;var i=[];return Array.prototype.forEach.call(this,function(e){Array.isArray(e)&&0<t?(e=Array.prototype.flat.call(e,t-1),i.push.apply(i,e)):i.push(e)}),i}},"es9","es5"),h.polyfill("Object.entries",function(e){return e||function(e){var t,i=[];for(t in e)h.owns(e,t)&&i.push([t,e[t]]);return i}},"es8","es3"),h.polyfill("Object.values",function(e){return e||function(e){var t,i=[];for(t in e)h.owns(e,t)&&i.push(e[t]);return i}},"es8","es3"),Object.create(null)),Bs={typeMap:Ps},Fs=Object.create(null),Us="default",b=class{constructor(e){this.name=e}toString(){return this.name}},Bs=(b.CONNECTION_CHECKER=new b("connectionChecker"),b.CONNECTION_PREVIEWER=new b("connectionPreviewer"),b.CURSOR=new b("cursor"),b.EVENT=new b("event"),b.FIELD=new b("field"),b.INPUT=new b("input"),b.RENDERER=new b("renderer"),b.TOOLBOX=new b("toolbox"),b.THEME=new b("theme"),b.TOOLBOX_ITEM=new b("toolboxItem"),b.FLYOUTS_VERTICAL_TOOLBOX=new b("flyoutsVerticalToolbox"),b.FLYOUTS_HORIZONTAL_TOOLBOX=new b("flyoutsHorizontalToolbox"),b.FLYOUT_INFLATER=new b("flyoutInflater"),b.METRICS_MANAGER=new b("metricsManager"),b.BLOCK_DRAGGER=new b("blockDragger"),b.SERIALIZER=new b("serializer"),b.ICON=new b("icon"),b.PASTER=new b("paster"),b.VARIABLE_MODEL=new b("variableModel"),b.VARIABLE_MAP=new b("variableMap"),{DEFAULT:Us,TEST_ONLY:Bs}),Hs=(Bs.Type=b,Bs.getAllItems=gs,Bs.getClass=hs,Bs.getClassFromOptions=fs,Bs.getObject=ps,Bs.hasItem=ds,Bs.register=o,Bs.unregister=cs,Object.create(null)),Gs=750,Vs="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),js=null,Ws={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},zs=0,Ys={TOUCH_ENABLED:Vs,TOUCH_MAP:Ws};Ys.checkTouchIdentifier=Ts,Ys.clearTouchIdentifier=_s,Ys.getTouchIdentifierFromEvent=vs,Ys.longStart=ms,Ys.longStop=bs,Ys.shouldHandleEvent=ys;{var Ks=globalThis.navigator&&globalThis.navigator.userAgent||"";function Xs(e){return t.includes(e.toUpperCase())}let t=(Ka=Ks).toUpperCase();ma=Xs("JavaFX"),ya=Xs("WebKit"),ya=Xs("Gecko")&&!ya,e=Xs("Android"),Ks=globalThis.navigator&&globalThis.navigator.maxTouchPoints,Ks=Xs("iPad")||Xs("Macintosh")&&0<Ks,i=Xs("iPhone")&&!Ks,$a=Xs("Macintosh"),Ua=!(Ua=Ks||e&&!Xs("Mobile")||Xs("Silk"))&&(i||e)}var _,qs,Js,Zs,y,Qs,ea,ta,ia,na,oa,ra,sa,aa,la,v,n,ca=ma,ua=ya,da=e,ha=Ks,pa=i,ga=$a,fa=Ua,ma={ANDROID:da,GECKO:ua,IPAD:ha,IPHONE:pa,JavaFx:ca,MAC:ga,MOBILE:fa,raw:Ka},ba=40,_a=125,ya={},va=(ya.bind=Es,ya.conditionalBind=p,ya.getScrollDeltaPixels=ws,ya.isRightButton=Cs,ya.isTargetInput=ks,ya.mouseToSvg=Is,ya.unbind=r,(e=_=_||{}).BLOCK_CREATE="create",e.BLOCK_DELETE="delete",e.BLOCK_CHANGE="change",e.BLOCK_FIELD_INTERMEDIATE_CHANGE="block_field_intermediate_change",e.BLOCK_MOVE="move",e.VAR_CREATE="var_create",e.VAR_DELETE="var_delete",e.VAR_RENAME="var_rename",e.VAR_TYPE_CHANGE="var_type_change",e.UI="ui",e.BLOCK_DRAG="drag",e.SELECTED="selected",e.CLICK="click",e.MARKER_MOVE="marker_move",e.BUBBLE_OPEN="bubble_open",e.TRASHCAN_OPEN="trashcan_open",e.TOOLBOX_ITEM_SELECT="toolbox_item_select",e.THEME_CHANGE="theme_change",e.VIEWPORT_CHANGE="viewport_change",e.COMMENT_CREATE="comment_create",e.COMMENT_DELETE="comment_delete",e.COMMENT_CHANGE="comment_change",e.COMMENT_MOVE="comment_move",e.COMMENT_RESIZE="comment_resize",e.COMMENT_DRAG="comment_drag",e.COMMENT_COLLAPSE="comment_collapse",e.FINISHED_LOADING="finished_loading",[_.BLOCK_CREATE,_.BLOCK_MOVE,_.COMMENT_CREATE,_.COMMENT_MOVE]),Ta=({BUMP_EVENTS:va}.EventType=_,"!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"),Ea={genUid:()=>{var t=Ta.length,i=[];for(let e=0;e<20;e++)i[e]=Ta.charAt(Math.random()*t);return i.join("")}},ka=0,Ks={TEST_ONLY:Ea},Ca=(Ks.genUid=xs,Ks.getNextUniqueId=Ss,""),Ia=!0,wa=0,Sa="ORPHANED_BLOCK",xa=[],Ra={FIRE_QUEUE:xa,enqueueEvent:P,fireNow:$,fireInternal:ja,setGroupInternal:Wa},Oa=(m.disable$$module$build$src$core$events$utils,m.enable$$module$build$src$core$events$utils,m.getGroup$$module$build$src$core$events$utils,m.setGroup$$module$build$src$core$events$utils,m.setRecordUndo$$module$build$src$core$events$utils,"http://www.w3.org/2000/svg"),Aa="http://www.w3.org/1999/xhtml",Na="http://www.w3.org/1999/xlink",La=((i=qs=qs||{})[i.ELEMENT_NODE=1]="ELEMENT_NODE",i[i.TEXT_NODE=3]="TEXT_NODE",i[i.COMMENT_NODE=8]="COMMENT_NODE",null),Da=0,Ma=null,$a={HTML_NS:Aa},Pa=($a.NodeType=qs,$a.SVG_NS=Oa,$a.XLINK_NS=Na,$a.addClass=c,$a.createSvgElement=l,$a.getFastTextWidth=Ya,$a.getFastTextWidthWithSizeString=J,$a.getTextWidth=q,$a.hasClass=W,$a.insertAfter=z,$a.measureFontMetrics=Z,$a.removeClass=s,$a.removeClasses=j,$a.removeNode=a,$a.setCssTransform=Y,$a.startTextWidthCache=K,$a.stopTextWidthCache=X,class{static findFocusedNode(e){var t,i=e.getRootFocusableNode();return i.canBeFocused()?(t=i.getFocusableElement(),W(t,Pa.ACTIVE_CLASS_NAME)||W(t,Pa.PASSIVE_CSS_CLASS_NAME)||((i=t.querySelector(this.ACTIVE_FOCUS_NODE_CSS_SELECTOR))instanceof HTMLElement||i instanceof SVGElement)&&(i=Pa.findFocusableNodeFor(i,e))?i:((t=t.querySelector(this.PASSIVE_FOCUS_NODE_CSS_SELECTOR))instanceof HTMLElement||t instanceof SVGElement)&&(e=Pa.findFocusableNodeFor(t,e))?e:null):null}static findFocusableNodeFor(t,e){var i,n;return t.id&&"null"!==t.id&&-1===e.getNestedTrees().map(e=>Pa.findFocusableNodeFor(t,e)).findIndex(e=>!!e)?(i=e.getRootFocusableNode()).canBeFocused()&&t===i.getFocusableElement()?i:(i=null!=(n=e.lookUpFocusableNode(t.id))?n:null)||(n=t.parentElement,!i&&n?Pa.findFocusableNodeFor(n,e):null):null}}),Ba=(Pa.ACTIVE_CLASS_NAME="blocklyActiveFocus",Pa.PASSIVE_CSS_CLASS_NAME="blocklyPassiveFocus",Pa.ACTIVE_FOCUS_NODE_CSS_SELECTOR="."+Pa.ACTIVE_CLASS_NAME,Pa.PASSIVE_FOCUS_NODE_CSS_SELECTOR="."+Pa.PASSIVE_CSS_CLASS_NAME,class{constructor(e,t){this.tree=e,this.rootShouldBeAutoTabbable=t}}),Fa=class{constructor(e){this.previouslyFocusedNode=this.focusedNode=null,this.registeredTrees=[],this.isUpdatingFocusedNode=this.recentlyLostAllFocus=this.lockFocusStateChanges=this.currentlyHoldsEphemeralFocus=!1;let t=e=>{if(!this.isUpdatingFocusedNode){this.recentlyLostAllFocus=!e;var t,i=null;if(e instanceof HTMLElement||e instanceof SVGElement)for(var n of this.registeredTrees)if(i=Pa.findFocusableNodeFor(e,n.tree))break;i&&i.canBeFocused()?(e=i.getFocusableTree(),n=null==(t=this.focusedNode)?void 0:t.getFocusableTree(),i===e.getRootFocusableNode()&&e!==n?this.focusTree(e):this.focusNode(i)):this.defocusCurrentFocusedNode()}};e("focusin",e=>{e instanceof FocusEvent&&t(document.activeElement)}),e("focusout",e=>{e instanceof FocusEvent&&t(e.relatedTarget)})}registerTree(e,t=!1){if(this.ensureManagerIsUnlocked(),this.isRegistered(e))throw Error(`Attempted to re-register already registered tree: ${e}.`);this.registeredTrees.push(new Ba(e,t));var i=e.getRootFocusableNode().getFocusableElement();if(!i.id||"null"===i.id)throw Error("Attempting to register a tree with a root element that has an "+`invalid ID: ${e}.`);t&&(i.tabIndex=0)}isRegistered(e){return!!this.lookUpRegistration(e)}lookUpRegistration(t){var e;return null!=(e=this.registeredTrees.find(e=>e.tree===t))?e:null}unregisterTree(t){if(this.ensureManagerIsUnlocked(),!this.isRegistered(t))throw Error(`Attempted to unregister not registered tree: ${t}.`);var e=this.registeredTrees.findIndex(e=>e.tree===t),i=this.registeredTrees[e],n=(this.registeredTrees.splice(e,1),e=Pa.findFocusedNode(t),t.getRootFocusableNode());e&&this.removeHighlight(e),this.focusedNode!==e&&this.focusedNode!==n||this.updateFocusedNode(null),this.removeHighlight(n),i.rootShouldBeAutoTabbable&&t.getRootFocusableNode().getFocusableElement().removeAttribute("tabindex")}getFocusedTree(){var e;return null!=(e=null==(e=this.focusedNode)?void 0:e.getFocusableTree())?e:null}getFocusedNode(){return this.focusedNode}focusTree(e){if(this.ensureManagerIsUnlocked(),!this.isRegistered(e))throw Error(`Attempted to focus unregistered tree: ${e}.`);var t=Pa.findFocusedNode(e),i=e.getRestoredFocusableNode(t);e=e.getRootFocusableNode(),this.focusNode(null!=(i=null!=i?i:t)?i:e)}focusNode(e){this.ensureManagerIsUnlocked();var t=!this.currentlyHoldsEphemeralFocus;t&&(this.isUpdatingFocusedNode=!0);var i,n=(null==(i=this.focusedNode)?void 0:i.getFocusableElement())!==document.activeElement;if(this.focusedNode!==e||n)if(e.canBeFocused()){if(i=e.getFocusableTree(),!this.isRegistered(i))throw Error(`Attempted to focus unregistered node: ${e}.`);(n=e.getFocusableElement()).id&&"null"!==n.id||console.warn("Trying to focus a node that has an invalid ID.");var o,r=Pa.findFocusableNodeFor(n,i),n=Pa.findFocusedNode(i),s=e;r!==e&&(s=i.getRestoredFocusableNode(n),e=i.getRootFocusableNode(),s=null!=(o=null!=s?s:n)?o:e),o=null==(e=this.focusedNode)?void 0:e.getFocusableTree(),e&&this.passivelyFocusNode(e,i),i=i.getRootFocusableNode(),n&&this.removeHighlight(n),i!==s&&this.removeHighlight(i),this.currentlyHoldsEphemeralFocus||this.activelyFocusNode(s,null!=o?o:null),this.updateFocusedNode(s)}else console.warn("Trying to focus a node that can't be focused.");t&&(this.isUpdatingFocusedNode=!1)}takeEphemeralFocus(e){if(this.ensureManagerIsUnlocked(),this.currentlyHoldsEphemeralFocus)throw Error("Attempted to take ephemeral focus when it's already held, "+`with new element: ${e}.`);this.currentlyHoldsEphemeralFocus=!0,this.focusedNode&&this.passivelyFocusNode(this.focusedNode,null),e.focus();let t=!1;return()=>{if(t)throw Error("Attempted to finish ephemeral focus twice for element: "+e+".");if(t=!0,this.currentlyHoldsEphemeralFocus=!1,this.focusedNode){this.activelyFocusNode(this.focusedNode,null);let e=this.focusedNode;setTimeout(()=>{!this.focusedNode&&this.previouslyFocusedNode===e&&this.recentlyLostAllFocus&&this.focusNode(e)},0)}}}ephemeralFocusTaken(){return this.currentlyHoldsEphemeralFocus}ensureManagerIsUnlocked(){if(this.lockFocusStateChanges)throw Error("FocusManager state changes cannot happen in a tree/node focus/blur callback.")}updateFocusedNode(e){this.previouslyFocusedNode=this.focusedNode,this.focusedNode=e}defocusCurrentFocusedNode(){this.focusedNode&&!this.currentlyHoldsEphemeralFocus&&(this.passivelyFocusNode(this.focusedNode,null),this.updateFocusedNode(null))}activelyFocusNode(e,t){this.lockFocusStateChanges=!0;var i=e.getFocusableTree(),n=e.getFocusableElement(),o=null==(o=this.lookUpRegistration(i))?void 0:o.rootShouldBeAutoTabbable;i!==t&&(i.onTreeFocus(e,t),o)&&(i.getRootFocusableNode().getFocusableElement().tabIndex=-1),e.onNodeFocus(),this.lockFocusStateChanges=!1,o&&e===i.getRootFocusableNode()||n.hasAttribute("tabindex")||(n.tabIndex=-1),this.setNodeToVisualActiveFocus(e),n.focus()}passivelyFocusNode(e,t){this.lockFocusStateChanges=!0;var i,n=e.getFocusableTree();n!==t&&(n.onTreeBlur(t),null!=(i=this.lookUpRegistration(n)))&&i.rootShouldBeAutoTabbable&&(n.getRootFocusableNode().getFocusableElement().tabIndex=0),e.onNodeBlur(),this.lockFocusStateChanges=!1,n!==t&&this.setNodeToVisualPassiveFocus(e)}setNodeToVisualActiveFocus(e){e=e.getFocusableElement(),c(e,Fa.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),s(e,Fa.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}setNodeToVisualPassiveFocus(e){e=e.getFocusableElement(),s(e,Fa.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),c(e,Fa.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}removeHighlight(e){e=e.getFocusableElement(),s(e,Fa.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),s(e,Fa.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME)}static getFocusManager(){return Fa.focusManager||(Fa.focusManager=new Fa(document.addEventListener)),Fa.focusManager}},Ua=(Fa.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyActiveFocus",Fa.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME="blocklyPassiveFocus",Fa.focusManager=null,m.getFocusManager$$module$build$src$core$focus_manager,{}),T=(Ua.deepMerge=te,class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(e,t){if(this.shortcuts.get(e.name)&&!t)throw Error(`Shortcut named "${e.name}" already exists.`);if(this.shortcuts.set(e.name,e),null!=(t=e.keyCodes)&&t.length)for(var i of t)this.addKeyMapping(i,e.name,!!e.allowCollision)}unregister(e){return this.shortcuts.get(e)?(this.removeAllKeyMappings(e),this.shortcuts.delete(e),!0):(console.warn(`Keyboard shortcut named "${e}" not found.`),!1)}addKeyMapping(e,t,i){var n=this.keyMap.get(e=""+e);if(n&&!i)throw Error(`Shortcut named "${t}" collides with shortcuts "${n}"`);n&&i?n.unshift(t):this.keyMap.set(e,[t])}removeKeyMapping(e,t,i){var n=this.keyMap.get(e);if(n){var o=n.indexOf(t);if(-1<o)return n.splice(o,1),0===n.length&&this.keyMap.delete(e),!0}return i||console.warn(`No keyboard shortcut named "${t}" registered with key code "${e}"`),!1}removeAllKeyMappings(e){for(var t of this.keyMap.keys())this.removeKeyMapping(t,e,!0)}setKeyMap(e){for(var t in this.keyMap.clear(),e)this.keyMap.set(t,e[t])}getKeyMap(){var e,t,i=Object.create(null);for([e,t]of this.keyMap)i[e]=t;return i}getRegistry(){var e,t,i=Object.create(null);for([e,t]of this.shortcuts)i[e]=t;return te(Object.create(null),i)}onKeyDown(e,t){var i=this.serializeKeyEvent(t);if(i=this.getShortcutNamesByKeyCode(i))for(var n of i){var o,i=this.shortcuts.get(n);if(i&&(!i.preconditionFn||i.preconditionFn(e,{focusedNode:null!=(n=m.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())?n:void 0})))if(null!=(o=(n=i).callback)&&o.call(n,e,t,i,{focusedNode:null!=(o=m.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode())?o:void 0}))return!0}return!1}getShortcutNamesByKeyCode(e){return(null==(e=this.keyMap.get(e))?void 0:e.slice())||[]}getKeyCodesByShortcutName(e){var t,i,n=[];for([t,i]of this.keyMap)-1<i.indexOf(e)&&n.push(t);return n}serializeKeyEvent(e){let t="";for(var i in T.modifierKeys)e.getModifierState(i)&&(""!==t&&(t+="+"),t+=i);return""!==t&&e.keyCode?t+="+"+e.keyCode:e.keyCode&&(t=String(e.keyCode)),t}checkModifiers(e){for(var t of e)if(!(t in T.modifierKeys))throw Error(t+" is not a valid modifier key.")}createSerializedKey(e,t){let i="";if(t)for(var n in this.checkModifiers(t),T.modifierKeys)t.includes(T.modifierKeys[n])&&(""!==i&&(i+="+"),i+=n);return""!==i&&e?i+="+"+e:e&&(i=""+e),i}}),Ha=(T.registry=new T,(Ka=(Ka=T=T||{}).modifierKeys||(Ka.modifierKeys={}))[Ka.Shift=16]="Shift",Ka[Ka.Control=17]="Control",Ka[Ka.Alt=18]="Alt",Ka[Ka.Meta=91]="Meta",Object.create(null)),Ga=[],Va={defineBlocksWithJsonArrayInternal:t},e={TEST_ONLY:Va},ja=(e.createBlockDefinitionsFromJsonArray=m.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,e.defineBlocks=m.defineBlocks$$module$build$src$core$common,e.defineBlocksWithJsonArray=ge,e.draggingConnections=Ga,e.fireSelectedEvent=ce,e.getAllWorkspaces=ne,e.getBlockTypeCounts=he,e.getMainWorkspace=se,e.getParentContainer=Za,e.getSelected=le,e.getWorkspaceById=ie,e.globalShortcutHandler=fe,e.registerWorkspace=oe,e.setMainWorkspace=ae,e.setParentContainer=ue,e.setSelected=el,e.svgResize=de,e.unregisterWorkpace=re,class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=m.getGroup$$module$build$src$core$events$utils(),this.recordUndo=Ia}toJson(){return{type:this.type,group:this.group}}static fromJson(e,t,i){return i.isBlank=!1,i.group=e.group||"",i.workspaceId=t.id,i}isNull(){return!1}run(e){}getEventWorkspace_(){let e;if(e=this.workspaceId?ie(this.workspaceId):e)return e;throw Error("Workspace is null. Event must have been generated from real Blockly events.")}}),Wa=class extends ja{constructor(e){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank=void 0===e,this.workspaceId=e||""}},za=class extends Wa{constructor(e,t,i){super(t=null===(t=e?e.workspace.id:t)?void 0:t),this.type=_.CLICK,this.blockId=e?e.id:void 0,this.targetType=i}toJson(){var e=super.toJson();if(this.targetType)return e.targetType=this.targetType,e.blockId=this.blockId,e;throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new za)).targetType=e.targetType,t.blockId=e.blockId,t}},Ya=((i=eg=eg||{}).BLOCK="block",i.WORKSPACE="workspace",i.ZOOM_CONTROLS="zoom_controls",o(b.EVENT,_.CLICK,za),{}),Ka=(Ya.removeElem=me,class{constructor(e){this.name=e}toString(){return this.name}}),Xa=(Ka.POSITIONABLE=new Ka("positionable"),Ka.DRAG_TARGET=new Ka("drag_target"),Ka.DELETE_AREA=new Ka("delete_area"),Ka.AUTOHIDEABLE=new Ka("autohideable"),class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(e,t){var i,n=e.component.id;if(!t&&this.componentData.has(n))throw Error('Plugin "'+n+'" with capabilities "'+(null==(i=this.componentData.get(n))?void 0:i.capabilities)+'" already added.');for(this.componentData.set(n,e),t=[],i=0;i<e.capabilities.length;i++){var o,r=String(e.capabilities[i]).toLowerCase();t.push(r),this.capabilityToComponentIds.has(r)?null!=(o=this.capabilityToComponentIds.get(r))&&o.push(n):this.capabilityToComponentIds.set(r,[n])}this.componentData.get(n).capabilities=t}removeComponent(t){var i=this.componentData.get(t);if(i){for(let e=0;e<i.capabilities.length;e++){var n=String(i.capabilities[e]).toLowerCase();me(this.capabilityToComponentIds.get(n),t)}this.componentData.delete(t)}}addCapability(e,t){if(!this.getComponent(e))throw Error('Cannot add capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');var i;this.hasCapability(e,t)?console.warn('Plugin "'+e+'already has capability "'+t+'"'):(t=(""+t).toLowerCase(),null!=(i=this.componentData.get(e))&&i.capabilities.push(t),null!=(i=this.capabilityToComponentIds.get(t))&&i.push(e))}removeCapability(e,t){if(!this.getComponent(e))throw Error('Cannot remove capability, "'+t+'". Plugin "'+e+'" has not been added to the ComponentManager');this.hasCapability(e,t)?(t=(""+t).toLowerCase(),me(this.componentData.get(e).capabilities,t),me(this.capabilityToComponentIds.get(t),e)):console.warn('Plugin "'+e+"doesn't have capability \""+t+'" to remove')}hasCapability(e,t){return t=(""+t).toLowerCase(),this.componentData.has(e)&&this.componentData.get(e).capabilities.includes(t)}getComponent(e){return null==(e=this.componentData.get(e))?void 0:e.component}getComponents(e,t){if(e=(""+e).toLowerCase(),!(e=this.capabilityToComponentIds.get(e)))return[];let i=[];if(t){let t=[];e.forEach(e=>{t.push(this.componentData.get(e))}),t.sort(function(e,t){return e.weight-t.weight}),t.forEach(function(e){i.push(e.component)})}else e.forEach(e=>{i.push(this.componentData.get(e).component)});return i}}),qa=(Xa.Capability=Ka,(t=(t=Xa=Xa||{}).ComponentWeight||(t.ComponentWeight={}))[t.TOOLBOX_WEIGHT=0]="TOOLBOX_WEIGHT",t[t.FLYOUT_WEIGHT=1]="FLYOUT_WEIGHT",t[t.TRASHCAN_WEIGHT=2]="TRASHCAN_WEIGHT",t[t.ZOOM_CONTROLS_WEIGHT=3]="ZOOM_CONTROLS_WEIGHT",Xa.ComponentWeight,!1),Ja='\n.blocklySvg {\n  background-color: #fff;\n  outline: none;\n  overflow: hidden;  /* IE overflows by default. */\n  position: absolute;\n  display: block;\n}\n\n.blocklyWidgetDiv {\n  display: none;\n  position: absolute;\n  z-index: 99999;  /* big value for bootstrap3 compatibility */\n}\n\n.injectionDiv {\n  height: 100%;\n  position: relative;\n  overflow: hidden;  /* So blocks in drag surface disappear at edges */\n  touch-action: none;\n  user-select: none;\n  -webkit-user-select: none;\n}\n\n.blocklyBlockCanvas.blocklyCanvasTransitioning,\n.blocklyBubbleCanvas.blocklyCanvasTransitioning {\n  transition: transform .5s;\n}\n\n.blocklyEmboss {\n  filter: var(--blocklyEmbossFilter);\n}\n\n.blocklyTooltipDiv {\n  background-color: #ffffc7;\n  border: 1px solid #ddc;\n  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);\n  color: #000;\n  display: none;\n  font: 9pt sans-serif;\n  opacity: .9;\n  padding: 2px;\n  position: absolute;\n  z-index: 100000;  /* big value for bootstrap3 compatibility */\n}\n\n.blocklyDropDownDiv {\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: 1000;\n  display: none;\n  border: 1px solid;\n  border-color: #dadce0;\n  background-color: #fff;\n  border-radius: 2px;\n  padding: 4px;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv:focus {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownContent {\n  max-height: 300px;  /* @todo: spec for maximum height. */\n}\n\n.blocklyDropDownArrow {\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 16px;\n  height: 16px;\n  z-index: -1;\n  background-color: inherit;\n  border-color: inherit;\n  border-top: 1px solid;\n  border-left: 1px solid;\n  border-top-left-radius: 4px;\n  border-color: inherit;\n}\n\n.blocklyHighlighted>.blocklyPath {\n  filter: var(--blocklyEmbossFilter);\n}\n\n.blocklyHighlightedConnectionPath {\n  fill: none;\n  stroke: #fc3;\n  stroke-width: 4px;\n}\n\n.blocklyPathLight {\n  fill: none;\n  stroke-linecap: round;\n  stroke-width: 1;\n}\n\n.blocklySelected>.blocklyPathLight {\n  display: none;\n}\n\n.blocklyDraggable {\n  cursor: grab;\n  cursor: -webkit-grab;\n}\n\n.blocklyDragging {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n  /* Drag surface disables events to not block the toolbox, so we have to\n   * reenable them here for the cursor values to work. */\n  pointer-events: auto;\n}\n\n  /* Changes cursor on mouse down. Not effective in Firefox because of\n     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */\n.blocklyDraggable:active {\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n.blocklyDragging.blocklyDraggingDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyDragging>.blocklyPath,\n.blocklyDragging>.blocklyPathLight {\n  fill-opacity: .8;\n  stroke-opacity: .8;\n}\n\n.blocklyDragging>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyDisabledPattern>.blocklyPath {\n  fill: var(--blocklyDisabledPattern);\n  fill-opacity: .5;\n  stroke-opacity: .5;\n}\n\n.blocklyDisabled>.blocklyPathLight,\n.blocklyDisabled>.blocklyPathDark {\n  display: none;\n}\n\n.blocklyInsertionMarker>.blocklyPath,\n.blocklyInsertionMarker>.blocklyPathLight,\n.blocklyInsertionMarker>.blocklyPathDark {\n  fill-opacity: .2;\n  stroke: none;\n}\n\n.blocklyNonEditableField>text {\n  pointer-events: none;\n}\n\n.blocklyFlyout {\n  position: absolute;\n  z-index: 20;\n}\n\n.blocklyText text {\n  cursor: default;\n}\n\n/*\n  Don\'t allow users to select text.  It gets annoying when trying to\n  drag a block and selected text moves instead.\n*/\n.blocklySvg text {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  cursor: inherit;\n}\n\n.blocklyIconGroup {\n  cursor: default;\n}\n\n.blocklyIconGroup:not(:hover),\n.blocklyIconGroupReadonly {\n  opacity: .6;\n}\n\n.blocklyIconShape {\n  fill: #00f;\n  stroke: #fff;\n  stroke-width: 1px;\n}\n\n.blocklyIconSymbol {\n  fill: #fff;\n}\n\n.blocklyMinimalBody {\n  margin: 0;\n  padding: 0;\n  height: 100%;\n}\n\n.blocklyHtmlInput {\n  border: none;\n  border-radius: 4px;\n  height: 100%;\n  margin: 0;\n  outline: none;\n  padding: 0;\n  width: 100%;\n  text-align: center;\n  display: block;\n  box-sizing: border-box;\n}\n\n/* Remove the increase and decrease arrows on the field number editor */\ninput.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,\ninput.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {\n  -webkit-appearance: none;\n  margin: 0;\n}\n\ninput[type=number] {\n  -moz-appearance: textfield;\n}\n\n.blocklyMainBackground {\n  stroke-width: 1;\n  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */\n}\n\n.blocklyMutatorBackground {\n  fill: #fff;\n  stroke: #ddd;\n  stroke-width: 1;\n}\n\n.blocklyFlyoutBackground {\n  fill: #ddd;\n  fill-opacity: .8;\n}\n\n.blocklyMainWorkspaceScrollbar {\n  z-index: 20;\n}\n\n.blocklyFlyoutScrollbar {\n  z-index: 30;\n}\n\n.blocklyScrollbarHorizontal,\n.blocklyScrollbarVertical {\n  position: absolute;\n  outline: none;\n}\n\n.blocklyScrollbarBackground {\n  opacity: 0;\n  pointer-events: none;\n}\n\n.blocklyScrollbarHandle {\n  fill: #ccc;\n}\n\n.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyScrollbarHandle:hover {\n  fill: #bbb;\n}\n\n/* Darken flyout scrollbars due to being on a grey background. */\n/* By contrast, workspace scrollbars are on a white background. */\n.blocklyFlyout .blocklyScrollbarHandle {\n  fill: #bbb;\n}\n\n.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,\n.blocklyFlyout .blocklyScrollbarHandle:hover {\n  fill: #aaa;\n}\n\n.blocklyInvalidInput {\n  background: #faa;\n}\n\n.blocklyVerticalMarker {\n  stroke-width: 3px;\n  fill: rgba(255,255,255,.5);\n  pointer-events: none;\n}\n\n.blocklyComputeCanvas {\n  position: absolute;\n  width: 0;\n  height: 0;\n}\n\n.blocklyNoPointerEvents {\n  pointer-events: none;\n}\n\n.blocklyContextMenu {\n  border-radius: 4px;\n  max-height: 100%;\n}\n\n.blocklyDropdownMenu {\n  border-radius: 2px;\n  padding: 0 !important;\n}\n\n.blocklyDropdownMenu .blocklyMenuItem {\n  /* 28px on the left for icon or checkbox. */\n  padding-left: 28px;\n}\n\n/* BiDi override for the resting state. */\n.blocklyDropdownMenu .blocklyMenuItemRtl {\n  /* Flip left/right padding for BiDi. */\n  padding-left: 5px;\n  padding-right: 28px;\n}\n\n.blocklyWidgetDiv .blocklyMenu {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background: #fff;\n  border: 1px solid transparent;\n  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);\n  font: normal 13px Arial, sans-serif;\n  margin: 0;\n  outline: none;\n  padding: 4px 0;\n  position: absolute;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n.blocklyWidgetDiv .blocklyMenu:focus {\n  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);\n}\n\n.blocklyDropDownDiv .blocklyMenu {\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  border: inherit;  /* Compatibility with gapi, reset from goog-menu */\n  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;\n  outline: none;\n  overflow-y: auto;\n  overflow-x: hidden;\n  max-height: 100%;\n  z-index: 20000;  /* Arbitrary, but some apps depend on it... */\n}\n\n/* State: resting. */\n.blocklyMenuItem {\n  border: none;\n  color: #000;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  /* 7em on the right for shortcut. */\n  min-width: 7em;\n  padding: 6px 15px;\n  white-space: nowrap;\n}\n\n/* State: disabled. */\n.blocklyMenuItemDisabled {\n  color: #ccc;\n  cursor: inherit;\n}\n\n/* State: hover. */\n.blocklyMenuItemHighlight {\n  background-color: rgba(0,0,0,.1);\n}\n\n/* State: selected/checked. */\n.blocklyMenuItemCheckbox {\n  height: 16px;\n  position: absolute;\n  width: 16px;\n}\n\n.blocklyMenuItemSelected .blocklyMenuItemCheckbox {\n  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;\n  float: left;\n  margin-left: -24px;\n  position: static;  /* Scroll with the menu. */\n}\n\n.blocklyMenuItemRtl .blocklyMenuItemCheckbox {\n  float: right;\n  margin-right: -24px;\n}\n\n.blocklyMenuSeparator {\n  background-color: #ccc;\n  height: 1px;\n  border: 0;\n  margin-left: 4px;\n  margin-right: 4px;\n}\n\n.blocklyBlockDragSurface, .blocklyAnimationLayer {\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  overflow: visible !important;\n  z-index: 80;\n  pointer-events: none;\n}\n\n.blocklyField {\n  cursor: default;\n}\n\n.blocklyInputField {\n  cursor: text;\n}\n\n.blocklyDragging .blocklyField,\n.blocklyDragging .blocklyIconGroup {\n  cursor: grabbing;\n}\n\n.blocklyActiveFocus:is(\n  .blocklyFlyout,\n  .blocklyWorkspace,\n  .blocklyField,\n  .blocklyPath,\n  .blocklyHighlightedConnectionPath,\n  .blocklyComment,\n  .blocklyBubble,\n  .blocklyIconGroup,\n  .blocklyTextarea\n) {\n  outline: none;\n}\n',Za={},E=(Za.inject=_e,Za.register=be,class{constructor(e,t){this.x=e,this.y=t}clone(){return new E(this.x,this.y)}scale(e){return this.x*=e,this.y*=e,this}translate(e,t){return this.x+=e,this.y+=t,this}static equals(e,t){return e===t||!(!e||!t)&&e.x===t.x&&e.y===t.y}static distance(e,t){var i=e.x-t.x;return e=e.y-t.y,Math.sqrt(i*i+e*e)}static magnitude(e){return Math.sqrt(e.x*e.x+e.y*e.y)}static difference(e,t){return new E(e.x-t.x,e.y-t.y)}static sum(e,t){return new E(e.x+t.x,e.y+t.y)}}),k=class{constructor(e){this.tagName=e}toString(){return this.tagName}},C=(k.ANIMATE=new k("animate"),k.CIRCLE=new k("circle"),k.CLIPPATH=new k("clipPath"),k.DEFS=new k("defs"),k.FECOMPOSITE=new k("feComposite"),k.FECOMPONENTTRANSFER=new k("feComponentTransfer"),k.FEFLOOD=new k("feFlood"),k.FEFUNCA=new k("feFuncA"),k.FEGAUSSIANBLUR=new k("feGaussianBlur"),k.FEPOINTLIGHT=new k("fePointLight"),k.FESPECULARLIGHTING=new k("feSpecularLighting"),k.FILTER=new k("filter"),k.FOREIGNOBJECT=new k("foreignObject"),k.G=new k("g"),k.IMAGE=new k("image"),k.LINE=new k("line"),k.PATH=new k("path"),k.PATTERN=new k("pattern"),k.POLYGON=new k("polygon"),k.RECT=new k("rect"),k.SVG=new k("svg"),k.TEXT=new k("text"),k.TSPAN=new k("tspan"),class{constructor(e,t,i,n){this.top=e,this.bottom=t,this.left=i,this.right=n}static from(e){return new C(e.y,e.y+e.height,e.x,e.x+e.width)}clone(){return new C(this.top,this.bottom,this.left,this.right)}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}getOrigin(){return new E(this.left,this.top)}contains(e,t){return e>=this.left&&e<=this.right&&t>=this.top&&t<=this.bottom}intersects(e){return this.left<=e.right&&this.right>=e.left&&this.bottom>=e.top&&this.top<=e.bottom}static equals(e,t){return e===t||!(!e||!t)&&e.top===t.top&&e.bottom===t.bottom&&e.left===t.left&&e.right===t.right}static createFromPoint(e,t,i){var n=e.x;return new C(e=e.y,e+i,n,n+t)}}),I=class{constructor(e,t){this.width=e,this.height=t}static equals(e,t){return e===t||!(!e||!t)&&e.width===t.width&&e.height===t.height}static max(e,t){return new I(Math.max(e.width,t.width),Math.max(e.height,t.height))}static min(e,t){return new I(Math.min(e.width,t.width),Math.min(e.height,t.height))}},Qa={getSizeInternal:gl},el={TEST_ONLY:Qa},tl=(el.getBorderBox=Ce,el.getComputedStyle=Te,el.getContainerOffsetToScrollInto=we,el.getPageOffset=Ee,el.getSize=ye,el.getViewportPageOffset=ke,el.scrollIntoContainerView=Ie,/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/),il=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,i={TEST_ONLY:{XY_REGEX:tl,XY_STYLE_REGEX:il}},nl=(i.getDocumentScroll=Oe,i.getInjectionDivXY=xe,i.getRelativeXY=Se,i.getViewportBBox=Re,i.screenToWsCoordinates=Ae,i.wsToScreenCoordinates=Ne,class{constructor(e,t,i,n,o){this.workspace=e,this.horizontal=t,this.oldHostMetrics=null,this.ratio=1,this.origin=new E(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new E(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=i||!1,this.margin=void 0!==o?o:nl.DEFAULT_SCROLLBAR_MARGIN,e="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),n&&(e+=" "+n),this.outerSvg=l(k.SVG,{class:e}),n=l(k.G,{},this.outerSvg),this.svgBackground=l(k.RECT,{class:"blocklyScrollbarBackground"},n),e=Math.floor((nl.scrollbarThickness-5)/2),this.svgHandle=l(k.RECT,{class:"blocklyScrollbarHandle",rx:e,ry:e},n),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),z(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),t?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=p(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=p(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){var e=nl.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(e)),this.outerSvg.setAttribute("height",String(e)),this.svgHandle.setAttribute("height",String(e-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(e)),this.outerSvg.setAttribute("width",String(e)),this.svgHandle.setAttribute("width",String(e-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),r(this.onMouseDownBarWrapper_),r(this.onMouseDownHandleWrapper_),a(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(e){return e<=0||isNaN(e)?0:Math.min(e,this.scrollbarLength)}setHandleLength(e){this.handleLength=e,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(e){return e<=0||isNaN(e)?0:Math.min(e,this.scrollbarLength-this.handleLength)}setHandlePosition(e){this.handlePosition=e,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(e){this.scrollbarLength=e,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(e,t){this.position.x=e,this.position.y=t,Y(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(e){!e&&!(e=this.workspace.getMetrics())||this.oldHostMetrics&&nl.metricsAreEquivalent(e,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(e):this.resizeVertical(e),this.oldHostMetrics=e,this.updateMetrics())}requiresViewResize(e){return!this.oldHostMetrics||this.oldHostMetrics.viewWidth!==e.viewWidth||this.oldHostMetrics.viewHeight!==e.viewHeight||this.oldHostMetrics.absoluteLeft!==e.absoluteLeft||this.oldHostMetrics.absoluteTop!==e.absoluteTop}resizeHorizontal(e){this.requiresViewResize(e)?this.resizeViewHorizontal(e):this.resizeContentHorizontal(e)}resizeViewHorizontal(e){var t=e.viewWidth-2*this.margin;this.pair&&(t-=nl.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),t=e.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(t+=nl.scrollbarThickness),this.setPosition(t,e.absoluteTop+e.viewHeight-nl.scrollbarThickness-this.margin),this.resizeContentHorizontal(e)}resizeContentHorizontal(e){var t,i;e.viewWidth>=e.scrollWidth?(this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1)):(this.pair||this.setVisible(!0),t=this.scrollbarLength*e.viewWidth/e.scrollWidth,t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollWidth-e.viewWidth,i=this.scrollbarLength-this.handleLength,e=this.constrainHandlePosition(e=(e.viewLeft-e.scrollLeft)/t*i),this.setHandlePosition(e),this.ratio=i/t)}resizeVertical(e){this.requiresViewResize(e)?this.resizeViewVertical(e):this.resizeContentVertical(e)}resizeViewVertical(e){let t=e.viewHeight-2*this.margin;this.pair&&(t-=nl.scrollbarThickness),this.setScrollbarLength(Math.max(0,t)),this.setPosition(this.workspace.RTL?e.absoluteLeft+this.margin:e.absoluteLeft+e.viewWidth-nl.scrollbarThickness-this.margin,e.absoluteTop+this.margin),this.resizeContentVertical(e)}resizeContentVertical(e){var t,i;e.viewHeight>=e.scrollHeight?(this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1)):(this.pair||this.setVisible(!0),t=this.scrollbarLength*e.viewHeight/e.scrollHeight,t=this.constrainHandleLength(t),this.setHandleLength(t),t=e.scrollHeight-e.viewHeight,i=this.scrollbarLength-this.handleLength,e=this.constrainHandlePosition(e=(e.viewTop-e.scrollTop)/t*i),this.setHandlePosition(e),this.ratio=i/t)}isVisible(){return this.isHandleVisible}setContainerVisible(e){var t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay_()}setVisible(e){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(e)}setVisibleInternal(e){var t=e!==this.isVisible();this.isHandleVisible=e,t&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(e){var t,i,n,o;this.workspace.markFocused(),_s(),this.cleanUp(),Cs(e)?e.stopPropagation():(t=Is(e,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM()),t=this.horizontal?t.x:t.y,i=xe(this.svgHandle),i=this.horizontal?i.x:i.y,n=this.handlePosition,o=.95*this.handleLength,t<=i?n-=o:t>=i+this.handleLength&&(n+=o),this.setHandlePosition(this.constrainHandlePosition(n)),this.updateMetrics(),e.stopPropagation(),e.preventDefault())}onMouseDownHandle(e){this.workspace.markFocused(),this.cleanUp(),Cs(e)?e.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?e.clientX:e.clientY,this.onMouseUpWrapper_=p(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=p(document,"pointermove",this,this.onMouseMoveHandle),e.stopPropagation(),e.preventDefault())}onMouseMoveHandle(e){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?e.clientX:e.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){_s(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(r(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(r(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let e=this.handlePosition/(this.scrollbarLength-this.handleLength);return e=isNaN(e)?0:e}updateMetrics(){var e=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:e}):this.workspace.setMetrics({y:e})}set(e,t){this.setHandlePosition(this.constrainHandlePosition(e*this.ratio)),!t&&void 0!==t||this.updateMetrics()}setOrigin(e,t){this.origin=new E(e,t)}static metricsAreEquivalent(e,t){return e.viewWidth===t.viewWidth&&e.viewHeight===t.viewHeight&&e.viewLeft===t.viewLeft&&e.viewTop===t.viewTop&&e.absoluteTop===t.absoluteTop&&e.absoluteLeft===t.absoluteLeft&&e.scrollWidth===t.scrollWidth&&e.scrollHeight===t.scrollHeight&&e.scrollLeft===t.scrollLeft&&e.scrollTop===t.scrollTop}}),ol=(nl.scrollbarThickness=Vs?25:15,nl.DEFAULT_SCROLLBAR_MARGIN=.5,{parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}}),rl={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:sl,DOMParser:al,XMLSerializer:ll}=globalThis,cl=(al&&(ol=new al),ll&&(rl=new ll),"https://developers.google.com/blockly/xml"),ul=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,Ka={NAME_SPACE:cl},dl=(Ka.createElement=m.createElement$$module$build$src$core$utils$xml,Ka.createTextNode=m.createTextNode$$module$build$src$core$utils$xml,Ka.domToText=Le,Ka.injectDependencies=_l,Ka.textToDom=m.textToDom$$module$build$src$core$utils$xml,"categoryToolbox"),hl="flyoutToolbox",pl=((t=y=y||{})[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT",{hasCategoriesInternal:fl}),gl={},fl=(gl.Position=y,gl.TEST_ONLY=pl,gl.convertFlyoutDefToJsonArray=Pe,gl.convertToolboxDefToJson=Me,gl.hasCategories=Be,gl.isCategoryCollapsible=Fe,gl.parseToolboxTree=Ve,(Vs=Qs=Qs||{})[Vs.TOP=0]="TOP",Vs[Vs.BOTTOM=1]="BOTTOM",(_l=ea=ea||{})[_l.LEFT=0]="LEFT",_l[_l.RIGHT=1]="RIGHT",(t=ta=ta||{})[t.UP=0]="UP",t[t.DOWN=1]="DOWN",{}),ml=(fl.bumpDirection=ta,fl.bumpPositionRect=ze,fl.getCornerOppositeToolbox=We,fl.getStartPositionRect=je,fl.horizontalPosition=ea,fl.verticalPosition=Qs,{width:96,height:124,url:"sprites.png"}),bl=class{constructor(e){this.workspace=e,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=l(k.G,{});var e=String(Math.random()).substring(2);return this.createZoomOutSvg(e),this.createZoomInSvg(e),this.workspace.isMovable()&&this.createZoomResetSvg(e),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:Xa.ComponentWeight.ZOOM_CONTROLS_WEIGHT,capabilities:[Xa.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&a(this.svgGroup);for(var e of this.boundEvents)r(e);this.boundEvents.length=0}getBoundingRectangle(){let e=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(e+=this.LARGE_SPACING+this.HEIGHT),new C(this.top,this.top+e,this.left,this.left+this.WIDTH)}position(e,t){var i,n,o,r;this.initialized&&(i=We(this.workspace,e),o=this.SMALL_SPACING+2*this.HEIGHT,this.zoomResetGroup&&(o+=this.LARGE_SPACING+this.HEIGHT),e=je(i,new I(this.WIDTH,o),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,e,this.workspace),i=i.vertical,t=ze(e,this.MARGIN_VERTICAL,i===Qs.TOP?ta.DOWN:ta.UP,t),i===Qs.TOP?(n=this.SMALL_SPACING+this.HEIGHT,null!=(r=this.zoomInGroup)&&r.setAttribute("transform","translate(0, "+n+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(n+this.LARGE_SPACING+this.HEIGHT)+")")):(r=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0,null!=(o=this.zoomInGroup)&&o.setAttribute("transform","translate(0, "+r+")"),r=r+this.SMALL_SPACING+this.HEIGHT,null!=(n=this.zoomOutGroup)&&n.setAttribute("transform","translate(0, "+r+")")),this.top=t.top,this.left=t.left,null!=(e=this.svgGroup))&&e.setAttribute("transform","translate("+this.left+","+this.top+")")}createZoomOutSvg(e){this.zoomOutGroup=l(k.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);var t=l(k.CLIPPATH,{id:"blocklyZoomoutClipPath"+e},this.zoomOutGroup);l(k.RECT,{width:32,height:32},t),l(k.IMAGE,{width:ml.width,height:ml.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+e+")"},this.zoomOutGroup).setAttributeNS(Na,"xlink:href",this.workspace.options.pathToMedia+ml.url),this.boundEvents.push(p(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(e){this.zoomInGroup=l(k.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);var t=l(k.CLIPPATH,{id:"blocklyZoominClipPath"+e},this.zoomInGroup);l(k.RECT,{width:32,height:32},t),l(k.IMAGE,{width:ml.width,height:ml.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+e+")"},this.zoomInGroup).setAttributeNS(Na,"xlink:href",this.workspace.options.pathToMedia+ml.url),this.boundEvents.push(p(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(e,t){this.workspace.markFocused(),this.workspace.zoomCenter(e),this.fireZoomEvent(),_s(),t.stopPropagation(),t.preventDefault()}createZoomResetSvg(e){this.zoomResetGroup=l(k.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);var t=l(k.CLIPPATH,{id:"blocklyZoomresetClipPath"+e},this.zoomResetGroup);l(k.RECT,{width:32,height:32},t),l(k.IMAGE,{width:ml.width,height:ml.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+e+")"},this.zoomResetGroup).setAttributeNS(Na,"xlink:href",this.workspace.options.pathToMedia+ml.url),this.boundEvents.push(p(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(e){this.workspace.markFocused();var t=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(t),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),_s(),e.stopPropagation(),e.preventDefault()}fireZoomEvent(){var e=new(f(_.CLICK))(null,this.workspace.id,"zoom_controls");g(e)}},Vs=(be("\n.blocklyZoom>image, .blocklyZoom>svg>image {\n  opacity: .4;\n}\n\n.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {\n  opacity: .6;\n}\n\n.blocklyZoom>image:active, .blocklyZoom>svg>image:active {\n  opacity: .8;\n}\n"),{BLOCKS:50,PROCEDURES:75,VARIABLES:100,WORKSPACE_COMMENTS:25}),_l={},t=(_l.register=Zp,_l.unregister=yl,class{constructor(){this.priority=25}save(e){var t,i=[];for(t of e.getTopComments())(e=Ye(t,{addCoordinates:!0,saveIds:!0}))&&i.push(e);return i.length?i:null}load(e,t){for(var i of e)Ke(i,t,{recordUndo:Ia})}clear(e){for(var t of e.getTopComments())t.dispose()}}),yl=(Zp("workspaceComments",new t),{}),t=(yl.WorkspaceCommentSerializer=t,yl.append=Ke,yl.save=Ye,{}),vl=(t.register=up,t.unregister=w,class{paste(e,t,i){e=e.commentState,i&&(e.x=i.x,e.y=i.y),m.disable$$module$build$src$core$events$utils();let n;try{n=Ke(e,t),Xe(n)}finally{m.enable$$module$build$src$core$events$utils()}return n?(U()&&g(new(f(_.COMMENT_CREATE))(n)),m.getFocusManager$$module$build$src$core$focus_manager().focusNode(n),n):null}}),Tl=(up(vl.TYPE="workspace-comment",new vl),m.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:28,connectingSnapRadius:28,currentConnectionPreference:8,bumpDelay:250},m.config$$module$build$src$core$config,"aria-"),El="role",w=((w=ia=ia||{}).GRID="grid",w.GRIDCELL="gridcell",w.GROUP="group",w.LISTBOX="listbox",w.MENU="menu",w.MENUITEM="menuitem",w.MENUITEMCHECKBOX="menuitemcheckbox",w.OPTION="option",w.PRESENTATION="presentation",w.ROW="row",w.TREE="tree",w.TREEITEM="treeitem",w.SEPARATOR="separator",w.STATUS="status",(w=na=na||{}).ACTIVEDESCENDANT="activedescendant",w.COLCOUNT="colcount",w.DISABLED="disabled",w.EXPANDED="expanded",w.INVALID="invalid",w.LABEL="label",w.LABELLEDBY="labelledby",w.LEVEL="level",w.ORIENTATION="orientation",w.POSINSET="posinset",w.ROWCOUNT="rowcount",w.SELECTED="selected",w.SETSIZE="setsize",w.VALUEMAX="valuemax",w.VALUEMIN="valuemin",w.LIVE="live",w.HIDDEN="hidden",{}),kl=(w.Role=ia,w.State=na,w.setRole=Je,w.setState=Ze,class{constructor(e,t){this.content=e,this.opt_value=t,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){var e,t=document.createElement("div"),i=(t.id=Ss(),(this.element=t).className="blocklyMenuItem "+(this.enabled?"":"blocklyMenuItemDisabled ")+(this.checked?"blocklyMenuItemSelected ":"")+(this.highlight?"blocklyMenuItemHighlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl ":""),document.createElement("div"));return i.className="blocklyMenuItemContent",this.checkable&&((e=document.createElement("div")).className="blocklyMenuItemCheckbox ",i.appendChild(e)),e=this.content,"string"==typeof this.content&&(e=document.createTextNode(this.content)),i.appendChild(e),t.appendChild(i),this.roleName&&Je(t,this.roleName),Ze(t,na.SELECTED,this.checkable&&this.checked||!1),Ze(t,na.DISABLED,!this.enabled),t}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){var e;return null!=(e=this.opt_value)?e:null}setRightToLeft(e){this.rightToLeft=e}setRole(e){this.roleName=e}setCheckable(e){this.checkable=e}setChecked(e){this.checked=e}setHighlighted(e){this.highlight=e;var t=this.getElement();t&&this.isEnabled()&&(e?c:s)(t,"blocklyMenuItemHighlight")}isEnabled(){return this.enabled}setEnabled(e){this.enabled=e}performAction(e){this.isEnabled()&&this.actionHandler&&this.actionHandler(this,e)}onAction(e,t){this.actionHandler=e.bind(t)}}),Cl=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.pointerLeaveHandler=this.pointerEnterHandler=this.clickHandler=this.pointerMoveHandler=this.highlightedItem=this.openingCoords=null}addChild(e){this.menuItems.push(e)}render(e){var i=document.createElement("div");i.className="blocklyMenu",i.tabIndex=0,this.roleName&&Je(i,this.roleName),this.element=i;for(let e=0,t;t=this.menuItems[e];e++)i.appendChild(t.createDom());return this.pointerMoveHandler=p(i,"pointermove",this,this.handlePointerMove,!0),this.clickHandler=p(i,"pointerup",this,this.handleClick,!0),this.pointerEnterHandler=p(i,"pointerenter",this,this.handlePointerEnter,!0),this.pointerLeaveHandler=p(i,"pointerleave",this,this.handlePointerLeave,!0),this.onKeyDownHandler=p(i,"keydown",this,this.handleKeyEvent),e.appendChild(i),i}getElement(){return this.element}focus(){var e=this.getElement();e&&e.focus({preventScroll:!0})}blur(){var e=this.getElement();e&&e.blur()}setRole(e){this.roleName=e}dispose(){this.pointerMoveHandler&&(r(this.pointerMoveHandler),this.pointerMoveHandler=null),this.clickHandler&&(r(this.clickHandler),this.clickHandler=null),this.pointerEnterHandler&&(r(this.pointerEnterHandler),this.pointerEnterHandler=null),this.pointerLeaveHandler&&(r(this.pointerLeaveHandler),this.pointerLeaveHandler=null),this.onKeyDownHandler&&(r(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let e=0,t;t=this.menuItems[e];e++)t.dispose();this.element=null}getMenuItem(i){for(var e=this.getElement();i&&i!==e;){if(i.classList.contains("blocklyMenuItem")){var n=this.getMenuItems();for(let e=0,t;t=n[e];e++)if(t.getElement()===i)return t}i=i.parentElement}return null}setHighlighted(e){var t,i=this.highlightedItem;i&&(i.setHighlighted(!1),this.highlightedItem=null),e&&(e.setHighlighted(!0),this.highlightedItem=e,i=this.getElement(),t=e.getElement(),i)&&t&&(Ie(t,i),Ze(i,na.ACTIVEDESCENDANT,e.getId()))}highlightNext(){var e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e,1)}highlightPrevious(){var e=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(e<0?this.menuItems.length:e,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(e,t){e+=t;for(var i,n=this.getMenuItems();i=n[e];){if(i.isEnabled()){this.setHighlighted(i);break}e+=t}}handlePointerMove(e){0!==Math.max(Math.abs(e.movementX),Math.abs(e.movementY))&&(e=this.getMenuItem(e.target))&&(e.isEnabled()?this.highlightedItem!==e&&this.setHighlighted(e):this.setHighlighted(null))}handleClick(e){var t=this.openingCoords;if(this.openingCoords=null,t&&"number"==typeof e.clientX){var i=new E(e.clientX,e.clientY);if(E.distance(t,i)<1)return}(t=this.getMenuItem(e.target))&&t.performAction(e)}handlePointerEnter(e){this.focus()}handlePointerLeave(e){this.getElement()&&this.setHighlighted(null)}handleKeyEvent(e){if(this.menuItems.length&&!(e.shiftKey||e.ctrlKey||e.metaKey||e.altKey)){var t=this.highlightedItem;switch(e.key){case"Enter":case" ":t&&t.performAction(e);break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}e.preventDefault(),e.stopPropagation()}}getSize(){var e=this.getElement(),t=ye(e);return t.height=e.scrollHeight,t}getMenuItems(){return this.menuItems.filter(e=>e instanceof kl)}},Il=class{constructor(){this.element=null}createDom(){return this.element=document.createElement("hr"),this.element.className="blocklyMenuSeparator",Je(this.element,ia.SEPARATOR),this.element}dispose(){var e;null!=(e=this.element)&&e.remove(),this.element=null}},wl="_TEMP_COLLAPSED_INPUT",Sl="_TEMP_COLLAPSED_FIELD",xl="MANUALLY_DISABLED",Rl={COLLAPSED_FIELD_NAME:Sl,COLLAPSED_INPUT_NAME:wl,MANUALLY_DISABLED:xl},Ol=(($l=m.inputTypes$$module$build$src$core$inputs$input_types||(m.inputTypes$$module$build$src$core$inputs$input_types={}))[$l.VALUE=1]="VALUE",$l[$l.STATEMENT=3]="STATEMENT",$l[$l.DUMMY=5]="DUMMY",$l[$l.CUSTOM=6]="CUSTOM",$l[$l.END_ROW=7]="END_ROW",m.inputTypes$$module$build$src$core$inputs$input_types,new Set),Al=new WeakSet,Nl=new WeakMap,Ll=null,Dl=null,Ml=0,$l={},Pl=($l.finishQueuedRenders=tt,$l.queueRender=et,$l.triggerQueuedRenders=it,m.Msg$$module$build$src$core$msg=Object.create(null),qd={Msg:m.Msg$$module$build$src$core$msg,setLocale:oa=function(t){Object.keys(t).forEach(function(e){m.Msg$$module$build$src$core$msg[e]=t[e]})}},"blocklyToast"),Bl="blocklyToastMessage",Fl="blocklyToastCloseButton",Ul=class{static show(e,t){if(t.oncePerSession&&t.id){if(this.shownIds.has(t.id))return;this.shownIds.add(t.id)}this.hide(e);let i=this.createDom(e,t);requestAnimationFrame(()=>{i.style.bottom="2rem"})}static createDom(e,t){let{message:i,duration:n=5,assertiveness:o=Ul.Assertiveness.POLITE}=t,r=document.createElement("div");e.getInjectionDiv().appendChild(r),r.dataset.toastId=t.id,r.className=Pl,Je(r,ia.STATUS),Ze(r,na.LIVE,o),(t=r.appendChild(document.createElement("div"))).className=Bl,t.innerText=i,(t=r.appendChild(document.createElement("button"))).className=Fl,Ze(t,na.LABEL,m.Msg$$module$build$src$core$msg.CLOSE);var s=l(k.SVG,{width:24,height:24,viewBox:"0 0 24 24",fill:"none"},t);Ze(s,na.HIDDEN,!0),l(k.RECT,{x:19.7782,y:2.80762,width:2,height:24,transform:"rotate(45, 19.7782, 2.80762)",fill:"black"},s),l(k.RECT,{x:2.80762,y:4.22183,width:2,height:24,transform:"rotate(-45, 2.80762, 4.22183)",fill:"black"},s),t.addEventListener("click",()=>{r.remove(),e.markFocused()});let a;return t=()=>{a=setTimeout(()=>r.remove(),1e3*n)},s=()=>clearTimeout(a),r.addEventListener("focusin",s),r.addEventListener("focusout",t),r.addEventListener("mouseenter",s),r.addEventListener("mousemove",s),r.addEventListener("mouseleave",t),t(),r}static hide(e,t){(e=e.getInjectionDiv().querySelector("."+Pl))instanceof HTMLElement&&(!t||t===e.dataset.toastId)&&e.remove()}},Hl=(Ul.shownIds=new Set,(Xl=(Xl=Ul=Ul||{}).Assertiveness||(Xl.Assertiveness={})).ASSERTIVE="assertive",Xl.POLITE="polite",be(`
.${Pl} {
  font-size: 1.2rem;
  position: absolute;
  bottom: -10rem;
  right: 2rem;
  padding: 1rem;
  color: black;
  background-color: white;
  border: 2px solid black;
  border-radius: 0.4rem;
  z-index: 999;
  display: flex;
  align-items: center;
  gap: 0.8rem;
  line-height: 1.5;
  transition: bottom 0.3s ease-out;
}

.${Pl} .${Bl} {
  maxWidth: 18rem;
}

.${Pl} .${Fl} {
  margin: 0;
  padding: 0.2rem;
  background-color: transparent;
  color: black;
  border: none;
  cursor: pointer;
}
`),function(e,t){window.alert(e),t&&t()}),Gl=Hl,Vl=function(e,t){t(window.confirm(e))},jl=Vl,Wl=function(e,t,i){i(window.prompt(e,t))},zl=Wl,Yl=Ul.show.bind(Ul),Kl=Yl,Xl={},ql=(Xl.alert=ct,Xl.confirm=ut,Xl.prompt=dt,Xl.setAlert=S,Xl.setConfirm=tc,Xl.setPrompt=ac,Xl.setToast=lc,Xl.toast=cc,new Set),S={},Jl=(S.warn=ft,"VARIABLE"),Zl="ijkmnopqrstuvwxyzabcdefgh",Ql={generateUniqueNameInternal:pc},ec={CATEGORY_NAME:Jl,TEST_ONLY:Ql,VAR_LETTER_OPTIONS:Zl},tc=(ec.allDeveloperVariables=m.allDeveloperVariables$$module$build$src$core$variables,ec.allUsedVarModels=m.allUsedVarModels$$module$build$src$core$variables,ec.compareByName=Dt,ec.createVariableButtonHandler=Ct,ec.deleteVariable=m.deleteVariable$$module$build$src$core$variables,ec.flyoutCategory=bt,ec.flyoutCategoryBlocks=Tt,ec.generateUniqueName=Et,ec.generateUniqueNameFromOptions=kt,ec.generateVariableFieldDom=At,ec.getAddedVariables=Lt,ec.getOrCreateVariablePackage=m.getOrCreateVariablePackage$$module$build$src$core$variables,ec.getVariable=m.getVariable$$module$build$src$core$variables,ec.getVariableUsesById=Mt,ec.internalFlyoutCategory=mt,ec.jsonFlyoutCategoryBlocks=yt,ec.nameUsedWithAnyType=St,ec.nameUsedWithConflictingParam=xt,ec.promptName=It,ec.renameVariable=m.renameVariable$$module$build$src$core$variables,class extends Error{}),ic=class extends tc{constructor(e){super("Expected to find a 'type' property, defining the block type"),this.state=e}},nc=class extends tc{constructor(e,t,i){super(`The block ${t.toDevString()} is missing a(n) ${e}
connection`),this.block=t,this.state=i}},oc=class extends tc{constructor(e,t,i,n){super(`The block ${i.toDevString()} could not connect its
${t} to its parent, because: `+e),this.childBlock=i,this.childState=n}},rc=class extends tc{constructor(e){super("Encountered a real block which is defined as a child of a shadow\nblock. It is an invariant of Blockly that shadow blocks only have shadow\nchildren"),this.state=e}},sc=class extends tc{constructor(e,t,i){super(`Cannot add an icon of type '${e}' to the block `+t.toDevString()+", because there is no icon registered with "+`type '${e}'. Make sure that all of your icons have been `+"registered."),this.block=t,this.state=i}},ac={},lc=(ac.BadConnectionCheck=oc,ac.DeserializationError=tc,ac.MissingBlockType=ic,ac.MissingConnection=nc,ac.RealChildOfShadow=rc,ac.UnregisteredIcon=sc,class{constructor(){this.priority=50}save(e){var t,i=[];for(t of e.getTopBlocks(!1))(e=$t(t,{addCoordinates:!0,doFullSerialization:!1}))&&i.push(e);return i.length?{languageVersion:0,blocks:i}:null}load(e,t){for(var i of e=e.blocks)Wt(i,t,{recordUndo:Ia})}clear(e){for(var t of e.getTopBlocks(!1))t.dispose(!1)}}),cc=(Zp("blocks",new lc),{}),uc=(cc.BlockSerializer=lc,cc.append=Wt,cc.appendInternal=zt,cc.save=$t,class{constructor(e){this.name=e}toString(){return this.name}equals(e){return this.name===e.toString()}}),dc=(uc.MUTATOR=new uc("mutator"),uc.WARNING=new uc("warning"),uc.COMMENT=new uc("comment"),class extends ja{constructor(e){super(),this.isBlank=!e,e&&(this.blockId=e.id,this.workspaceId=e.workspace.id)}toJson(){var e=super.toJson();if(this.blockId)return e.blockId=this.blockId,e;throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new dc)).blockId=e.blockId,t}}),hc=class extends dc{constructor(e,t,i,n,o){super(e),this.type=_.BLOCK_CHANGE,e&&(this.element=t,this.name=i||void 0,this.oldValue=n,this.newValue=o)}toJson(){var e=super.toJson();if(this.element)return e.element=this.element,e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,this.disabledReason&&(e.disabledReason=this.disabledReason),e;throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new hc)).element=e.element,t.name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,void 0!==e.disabledReason&&(t.disabledReason=e.disabledReason),t}setDisabledReason(e){if("disabled"!==this.element)throw Error('Cannot set the disabled reason for a BlockChange event if the element is not "disabled".');this.disabledReason=e}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(t=t.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");var i,n=t.getIcon(uc.MUTATOR);switch(n&&ri(n)&&n.bubbleIsVisible()&&n.setBubbleVisible(!1),e=e?this.newValue:this.oldValue,this.element){case"field":(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name);break;case"comment":t.setCommentText(e||null);break;case"collapsed":t.setCollapsed(!!e);break;case"disabled":t.setDisabledReason(!!e,null!=(i=this.disabledReason)?i:xl);break;case"inline":t.setInputsInline(!!e);break;case"mutation":i=hc.getExtraBlockState_(t),t.loadExtraState?t.loadExtraState(JSON.parse(e||"{}")):t.domToMutation&&t.domToMutation(m.textToDom$$module$build$src$core$utils$xml(e||"<mutation/>")),g(new hc(t,"mutation",null,i,e));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(e){return e.saveExtraState?(e=e.saveExtraState(!0))?JSON.stringify(e):"":e.mutationToDom&&(e=e.mutationToDom())?$n(e):""}},pc=(o(b.EVENT,_.BLOCK_CHANGE,hc),{}),gc=(pc.clamp=ai,pc.toDegrees=Wc,pc.toRadians=si,16),fc=1,mc=12,bc=16,_c=.25,yc=null,vc=null,Tc="",Ec="",kc=null,Cc=null,Ic=null,wc=null,Sc=null,xc={getBoundsInfo:function(){var e=Ee(kc),t=ye(kc);return{left:e.x,right:e.x+t.width,top:e.y,bottom:e.y+t.height,width:t.width,height:t.height}},getPositionMetrics:function(e,t,i,n){var o=xc.getBoundsInfo(),r=ye(ra);return t+r.height<o.bottom?bi(e,t,o,r):n-r.height>o.top?_i(i,n,o,r):t+r.height<document.documentElement.clientHeight?bi(e,t,o,r):n-r.height>document.documentElement.clientTop?_i(i,n,o,r):yi(e,o,r)}},tc={ANIMATION_TIME:_c,ARROW_HORIZONTAL_PADDING:mc,ARROW_SIZE:gc,BORDER_SIZE:fc,PADDING_Y:bc,TEST_ONLY:xc},lc=(tc.clearContent=ui,tc.createDom=li,tc.getContentDiv=Xc,tc.getOwner=qc,tc.getPositionX=vi,tc.hide=Ei,tc.hideIfOwner=Ti,tc.hideWithoutAnimation=ki,tc.isVisible=ru,tc.repositionForWindowResize=Ii,tc.setBoundsElement=ci,tc.setColour=di,tc.show=mi,tc.showPositionedByBlock=cu,tc.showPositionedByField=hi,{}),Rc=(lc.commonWordPrefix=Si,lc.commonWordSuffix=xi,lc.isNumber=m.isNumber$$module$build$src$core$utils$string,lc.shortestStringLength=wi,lc.wrap=m.wrap$$module$build$src$core$utils$string,void 0),Oc=!1,Ac=!1,Nc=50,Lc=0,Dc=0,Mc=0,$c=0,Pc=null,Bc=null,Fc=0,Uc=10,Hc=10,Gc=750,Vc=5,jc=null,Wc={HOVER_MS:Gc,LIMIT:Nc,MARGINS:Vc,OFFSET_X:Fc,OFFSET_Y:Uc,RADIUS_OK:Hc},zc=(Wc.bindMouseEvents=$i,Wc.block=Vi,Wc.createDom=Mi,Wc.dispose=Hi,Wc.getCustomTooltip=cp,Wc.getDiv=Jh,Wc.getTooltipOfObject=Li,Wc.hide=Gi,Wc.isVisible=du,Wc.setCustomTooltip=Cu,Wc.unbindMouseEvents=Pi,Wc.unblock=ji,.45),Yc=.65,Kc={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},Xc={},qc=(Xc.blend=Qi,Xc.getHsvSaturation=md,Xc.getHsvValue=Lu,Xc.hexToRgb=Ji,Xc.hsvToHex=Zi,Xc.hueToHex=en,Xc.names=Kc,Xc.parse=Xi,Xc.rgbToHex=qi,Xc.setHsvSaturation=Vu,Xc.setHsvValue=ju,{}),x=(qc.checkMessageReferences=D,qc.parseBlockColour=rn,qc.replaceMessageReferences=on,qc.tokenizeInterpolation=nn,class{get size_(){return this.size}set size_(e){this.size=e}constructor(e,t,i){this.DEFAULT_VALUE=null,this.name=void 0,this.tooltip=this.validator_=null,this.size=new I(0,0),this.constants_=this.mouseDownWrapper=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.id_=null,this.value_=("DEFAULT_VALUE"in new.target.prototype?new.target.prototype:this).DEFAULT_VALUE,this.size_=new I(0,0),e!==x.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),t)&&this.setValidator(t)}configure_(e){e.tooltip&&this.setTooltip(on(e.tooltip))}setSourceBlock(e){if(this.sourceBlock_)throw Error("Field already bound to a block");if((this.sourceBlock_=e).id.includes("_field"))throw Error("Field ID indicator is contained in block ID. This may cause "+`problems with focus: ${e.id}.`);this.id_=e.id+"_field_"+Ss()}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){if(!this.fieldGroup_){var e=this.id_;if(!e)throw Error("Expected ID to be defined prior to init.");this.fieldGroup_=l(k.G,{id:e}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip),this.bindEvents_(),this.initModel(),this.applyColour()}}initView(){this.createBorderRect_(),this.createTextElement_(),this.fieldGroup_&&c(this.fieldGroup_,"blocklyField")}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=l(k.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=l(k.TEXT,{class:"blocklyText blocklyFieldText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){var e=this.getClickTarget_();if(!e)throw Error("A click target has not been set.");$i(e),this.mouseDownWrapper=p(e,"pointerdown",this,this.onMouseDown_)}fromXml(e){this.setValue(e.textContent)}toXml(e){return e.textContent=this.getValue(),e}saveState(e){return null!==(e=this.saveLegacyState(x))?e:this.getValue()}loadState(e){this.loadLegacyState(x,e)||this.setValue(e)}saveLegacyState(e){return e.prototype.saveState===this.saveState&&e.prototype.toXml!==this.toXml?((e=m.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name",this.name||""),Le(this.toXml(e)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(e,t){return e.prototype.loadState===this.loadState&&e.prototype.fromXml!==this.fromXml&&(this.fromXml(m.textToDom$$module$build$src$core$utils$xml(t)),!0)}dispose(){var e;Ti(this),un(this),null!=(e=this.getSourceBlock())&&e.isDeadOrDying()||a(this.fieldGroup_),this.disposed=!0}updateEditable(){var e=this.fieldGroup_,t=this.getSourceBlock();this.EDITABLE&&e&&t&&(this.enabled_&&t.isEditable()?(c(e,"blocklyEditableField"),s(e,"blocklyNonEditableField")):(c(e,"blocklyNonEditableField"),s(e,"blocklyEditableField")))}setEnabled(e){this.enabled_=e,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==x.prototype.showEditor_}isClickableInFlyout(e){return!e}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let e=!1;return this.name&&(this.SERIALIZABLE?e=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),e=!0)),e}isVisible(){return this.visible_}setVisible(e){var t;this.visible_!==e&&(this.visible_=e,t=this.fieldGroup_)&&(t.style.display=e?"block":"none")}setValidator(e){this.validator_=e}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(this.borderRect_)return this.borderRect_;throw Error(`The border rectangle is ${this.borderRect_}.`)}getTextElement(){if(this.textElement_)return this.textElement_;throw Error(`The text element is ${this.textElement_}.`)}getTextContent(){if(this.textContent_)return this.textContent_;throw Error(`The text content is ${this.textContent_}.`)}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(e){this.isClickable()&&this.showEditor_(e)}showEditor_(e){}repositionForWindowResize(){return!1}updateSize_(e){var t=this.getConstants();let i=2*(e=void 0!==e?e:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING),n=t.FIELD_TEXT_HEIGHT,o=0;this.textElement_&&(o=q(this.textElement_),i+=o),this.isFullBlockField()||(n=Math.max(n,t.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=n,this.size_.width=i,this.positionTextElement_(e,o),this.positionBorderRect_()}positionTextElement_(e,t){var i,n,o;this.textElement_&&(i=this.getConstants(),n=this.size_.height/2,this.textElement_.setAttribute("x",String(null!=(o=this.getSourceBlock())&&o.RTL?this.size_.width-t-e:e)),this.textElement_.setAttribute("y",String(i.FIELD_TEXT_BASELINE_CENTER?n:n-i.FIELD_TEXT_HEIGHT/2+i.FIELD_TEXT_BASELINE)))}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_&&(this.render_(),this.isDirty_=!1),this.size_):new I(0,0)}getScaledBBox(){let e;var t,i,n=this.getSourceBlock();if(n)return this.isFullBlockField()?(t=this.sourceBlock_.getHeightWidth(),i=n.workspace.scale,e=this.getAbsoluteXY_(),n=(t.width+1)*i,t=(t.height+1)*i,ua?(e.x+=1.5*i,e.y+=1.5*i):(e.x-=.5*i,e.y-=.5*i)):(t=this.borderRect_.getBoundingClientRect(),e=Ee(this.borderRect_),n=t.width,t=t.height),new C(e.y,e.y+t,e.x,e.x+n);throw new Jc}onLocationChange(e){}getDisplayText_(){let e=this.getText();return e=(e=e.length>this.maxDisplayLength?e.substring(0,this.maxDisplayLength-2)+"â€¦":e).replace(/\s/g,x.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(e+="â€"),e}getText(){var e=this.getText_();return null!==e?String(e):String(this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&this.sourceBlock_.queueRender()}setValue(e,t=!0){if(null!==e){var i=m.getGroup$$module$build$src$core$events$utils();i||m.setGroup$$module$build$src$core$events$utils(!0);try{var n,o,r,s,a,l=this.doClassValidation_(e),c=this.processValidation(e,l,t);c instanceof Error||(o=null==(n=this.getValidator())?void 0:n.call(this,c),(r=this.processValidation(c,o,t))instanceof Error)||(s=this.sourceBlock_)&&s.disposed||((a=this.getValue())===r?this.doValueUpdate_(r):(this.doValueUpdate_(r),t&&s&&U()&&g(new(f(_.BLOCK_CHANGE))(s,"field",this.name||null,a,r)),this.isDirty_&&this.forceRerender()))}finally{m.setGroup$$module$build$src$core$events$utils(i)}}}processValidation(e,t,i){return null===t?(this.doValueInvalid_(e,i),this.isDirty_&&this.forceRerender(),Error()):void 0===t?e:t}getValue(){return this.value_}doClassValidation_(e){return null==e?null:e}doValueUpdate_(e){this.value_=e,this.isDirty_=!0}doValueInvalid_(e,t){}onMouseDown_(e){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(e=this.sourceBlock_.workspace.getGesture(e))&&e.setStartField(this)}setTooltip(e){e||""===e||(e=this.sourceBlock_);var t=this.getClickTarget_();t?t.tooltip=e:this.tooltip=e}getTooltip(){var e=this.getClickTarget_();return Li(e||{tooltip:this.tooltip})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return Ee(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let t=null;var i=this.getSourceBlock();if(!i)throw new Jc;var n=i.inputList;for(let e=0;e<i.inputList.length;e++){var o=n[e],r=o.fieldRow;for(let e=0;e<r.length;e++)if(r[e]===this){t=o;break}}return t}getFlipRtl(){return!1}onShortcut(e){return!1}getFocusableElement(){if(this.fieldGroup_)return this.fieldGroup_;throw Error("This field currently has no representative DOM element.")}getFocusableTree(){var e=this.getSourceBlock();if(e)return e.workspace;throw new Jc}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}static fromJson(e){throw Error("Attempted to instantiate a field from the registry that hasn't defined a 'fromJson' method.")}}),Jc=(x.NBSP="Â ",x.SKIP_SETUP=Symbol("SKIP_SETUP"),class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}}),Zc=null,Qc=null,eu=null,tu="blocklyWidgetDiv",iu="",nu="",ou=null,ru={},su=(ru.createDom=sn,ru.getDiv=Wu,ru.hide=ln,ru.hideIfOwner=un,ru.hideIfOwnerIsInWorkspace=dn,ru.isVisible=cn,ru.positionWithAnchor=pn,ru.repositionForWindowResize=bn,ru.show=an,ru.testOnly_setDiv=zu,null),au={},lu=null,cu={},R=(cu.callbackFactory=m.callbackFactory$$module$build$src$core$contextmenu,cu.dispose=In,cu.getCurrentBlock=Ku,cu.hide=Cn,cu.setCurrentBlock=_n,cu.show=yn,class{constructor(){this.registeredItems=new Map,this.reset()}reset(){this.registeredItems.clear()}register(e){if(this.registeredItems.has(e.id))throw Error('Menu item with ID "'+e.id+'" is already registered.');this.registeredItems.set(e.id,e)}unregister(e){if(!this.registeredItems.has(e))throw Error('Menu item with ID "'+e+'" not found.');this.registeredItems.delete(e)}getItem(e){return null!=(e=this.registeredItems.get(e))?e:null}getContextMenuOptions(t,i){var n,o=[];for(n of this.registeredItems.values()){if(n.scopeType){if(n.scopeType===uu.BLOCK&&!t.block)continue;if(n.scopeType===uu.COMMENT&&!t.comment)continue;if(n.scopeType===uu.WORKSPACE&&!t.workspace)continue}let e;if(e={scope:t,weight:n.weight},n.separator)e=Object.assign({},e,{separator:!0});else{var r=n.preconditionFn(t,i);if("hidden"===r)continue;var s="function"==typeof n.displayText?n.displayText(t):n.displayText;e=Object.assign({},e,{text:s,callback:n.callback,enabled:"enabled"===r})}o.push(e)}return o.sort(function(e,t){return e.weight-t.weight}),o}}),uu=(cp=R=R||{},(Jh=cp.ScopeType||(cp.ScopeType={})).BLOCK="block",Jh.WORKSPACE="workspace",Jh.COMMENT="comment",cp.registry=new cp,R.ScopeType),du={BLOCK:50,BUBBLE:100},hu=class{constructor(e){this.comment=e,this.startLoc=null,this.workspace=e.workspace}isMovable(){return this.comment.isOwnMovable()&&!this.comment.isDeadOrDying()&&!this.workspace.isReadOnly()}startDrag(){var e;this.fireDragStartEvent(),this.startLoc=this.comment.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null!=(e=this.workspace.getLayerManager())&&e.moveToDragLayer(this.comment),this.comment.setDragging(!0)}drag(e){this.comment.moveDuringDrag(e)}endDrag(){var e;this.fireDragEndEvent(),this.fireMoveEvent(),null!=(e=this.workspace.getLayerManager())&&e.moveOffDragLayer(this.comment,50),this.comment.setDragging(!1),this.comment.snapToGrid(),this.workspace.setResizesEnabled(!0)}fireDragStartEvent(){var e=new(f(_.COMMENT_DRAG))(this.comment,!0);g(e)}fireDragEndEvent(){var e=new(f(_.COMMENT_DRAG))(this.comment,!1);g(e)}fireMoveEvent(){var e;this.comment.isDeadOrDying()||((e=new(f(_.COMMENT_MOVE))(this.comment)).setReason(["drag"]),e.oldCoordinate_=this.startLoc,e.recordNew(),g(e))}revertDrag(){this.startLoc&&this.comment.moveDuringDrag(this.startLoc)}},pu=new WeakMap,gu=class{constructor(e,t,i){this.id=e,this.workspace=t,this.container=i}isVisible(){return this.icon.checkVisibility()}getParentComment(){var e=this.workspace.getCommentById(this.id);if(e)return e;throw Error(`Comment bar button ${this.id} has no corresponding comment`)}getSize(e=!1){var t=this.icon.getBBox(),t=C.from(t);return e&&(e=this.getMargin(),t.left-=e,t.top-=e,t.bottom+=e,t.right+=e),t}getMargin(){return(this.container.getBBox().height-this.icon.getBBox().height)/2}getFocusableElement(){return this.icon}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return this.isVisible()}},fu="_collapse_bar_button",mu=class extends gu{constructor(e,t,i){super(e,t,i),this.id=e,this.workspace=t,this.container=i,this.icon=l(k.IMAGE,{class:"blocklyFoldoutIcon",href:this.workspace.options.pathToMedia+"foldout-icon.svg",id:this.id+fu},this.container),this.bindId=p(this.icon,"pointerdown",this,this.performAction.bind(this))}dispose(){r(this.bindId)}reposition(){var e=this.getMargin();this.icon.setAttribute("y",""+e),this.icon.setAttribute("x",""+e)}performAction(e){_s();var t=this.getParentComment();t.view.bringToFront(),(e&&e instanceof PointerEvent&&Cs(e)||(t.setCollapsed(!t.isCollapsed()),this.workspace.hideChaff(),null!=e))&&e.stopPropagation()}},bu=({COMMENT_COLLAPSE_BAR_BUTTON_FOCUS_IDENTIFIER:fu}.CollapseCommentBarButton=mu,"_comment_textarea_"),_u=class{constructor(e,t,i){this.workspace=e,this.onFinishEditing=i,this.textChangeListeners=[],this.text="",this.foreignObject=l(k.FOREIGNOBJECT,{class:"blocklyCommentForeignObject"}),(e=document.createElementNS(Aa,"body")).setAttribute("xmlns",Aa),e.className="blocklyMinimalBody",this.textArea=document.createElementNS(Aa,"textarea"),this.textArea.setAttribute("tabindex","-1"),c(this.textArea,"blocklyCommentText"),c(this.textArea,"blocklyTextarea"),c(this.textArea,"blocklyText"),e.appendChild(this.textArea),this.foreignObject.appendChild(e),t&&(this.id=t+bu,this.textArea.setAttribute("id",this.id)),p(this.textArea,"change",this,this.onTextChange),p(this.textArea,"pointerdown",this,e=>{e.stopPropagation(),m.getFocusManager$$module$build$src$core$focus_manager().focusNode(this),_s()}),p(this.textArea,"keydown",this,this.handleKeyDown)}getDom(){return this.foreignObject}getText(){return this.text}setText(e){this.textArea.value=e,this.onTextChange()}onTextChange(){var t=this.text;this.text=this.textArea.value;for(let e=this.textChangeListeners.length-1;0<=e;e--)this.textChangeListeners[e](t,this.text)}handleKeyDown(e){("Escape"===e.key||"Enter"===e.key&&(e.ctrlKey||e.metaKey))&&(this.onFinishEditing&&this.onFinishEditing(),e.stopPropagation())}addTextChangeListener(e){this.textChangeListeners.push(e)}removeTextChangeListener(e){this.textChangeListeners.splice(this.textChangeListeners.indexOf(e),1)}setPlaceholderText(e){this.textArea.placeholder=e}setEditable(e){e?this.textArea.removeAttribute("readonly"):this.textArea.setAttribute("readonly","true")}updateSize(e,t){this.foreignObject.setAttribute("height",""+(e.height-t.height)),this.foreignObject.setAttribute("width",""+e.width),this.foreignObject.setAttribute("y",""+t.height),this.workspace.RTL&&this.foreignObject.setAttribute("x",""+-e.width)}getFocusableElement(){return this.textArea}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!!this.id}},yu=({COMMENT_EDITOR_FOCUS_IDENTIFIER:bu}.CommentEditor=_u,"_delete_bar_button"),vu=class extends gu{constructor(e,t,i){super(e,t,i),this.id=e,this.workspace=t,this.container=i,this.icon=l(k.IMAGE,{class:"blocklyDeleteIcon",href:this.workspace.options.pathToMedia+"delete-icon.svg",id:this.id+yu},i),this.bindId=p(this.icon,"pointerdown",this,this.performAction.bind(this))}dispose(){r(this.bindId)}reposition(){var e=this.getMargin(),t=(this.icon.setAttribute("x","0"),this.container.getBBox());this.icon.setAttribute("y",""+e),this.icon.setAttribute("x",""+(t.width-this.getSize(!0).getWidth()))}performAction(e){_s(),e&&e instanceof PointerEvent&&Cs(e)?e.stopPropagation():(this.getParentComment().dispose(),null!=e&&e.stopPropagation(),m.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.workspace))}},Tu=({COMMENT_DELETE_BAR_BUTTON_FOCUS_IDENTIFIER:yu}.DeleteCommentBarButton=vu,class{constructor(e,t){this.workspace=e,this.commentId=t,this.collapsed=!1,this.editable=!0,this.location=new E(0,0),this.sizeChangeListeners=[],this.disposeListeners=[],this.collapseChangeListeners=[],this.resizePointerMoveListener=this.resizePointerUpListener=null,this.disposed=this.disposing=!1,this.svgRoot=l(k.G,{class:"blocklyComment blocklyEditable blocklyDraggable"}),this.highlightRect=this.createHighlightRect(this.svgRoot),{topBarGroup:this.topBarGroup,topBarBackground:this.topBarBackground,deleteButton:this.deleteButton,foldoutButton:this.foldoutButton,textPreview:this.textPreview,textPreviewNode:this.textPreviewNode}=this.createTopBar(this.svgRoot),this.commentEditor=this.createTextArea(),this.resizeHandle=this.createResizeHandle(this.svgRoot,e),null!=(t=e.getLayerManager())&&t.append(this,50),this.size=Tu.defaultCommentSize,this.setSizeWithoutFiringEvents(this.size),this.moveTo(new E(0,0))}createHighlightRect(e){return l(k.RECT,{class:"blocklyCommentHighlight"},e)}createTopBar(e){e=l(k.G,{class:"blocklyCommentTopbar"},e);var t=l(k.RECT,{class:"blocklyCommentTopbarBackground"},e),i=new vu(this.commentId,this.workspace,e),n=new mu(this.commentId,this.workspace,e),o=l(k.TEXT,{class:"blocklyCommentPreview blocklyCommentText blocklyText"},e),r=document.createTextNode("");return o.appendChild(r),{topBarGroup:e,topBarBackground:t,deleteButton:i,foldoutButton:n,textPreview:o,textPreviewNode:r}}createTextArea(){var e=new _u(this.workspace,this.commentId,()=>this.svgRoot.focus());return this.svgRoot.appendChild(e.getDom()),e.addTextChangeListener((e,t)=>{this.updateTextPreview(t),this.setSize(this.size)}),e}getEditorFocusableNode(){return this.commentEditor}createResizeHandle(e,t){return e=l(k.IMAGE,{class:"blocklyResizeHandle",href:t.options.pathToMedia+"resize-handle.svg"},e),p(e,"pointerdown",this,this.onResizePointerDown),e}getSvgRoot(){return this.svgRoot}getSize(){return this.collapsed?this.topBarBackground.getBBox():this.size}setSizeWithoutFiringEvents(e){var t=this.topBarBackground.getBBox(),i=this.textPreview.getBBox(),n=this.resizeHandle.getBBox();this.size=e=I.max(e,this.calcMinSize(t)),this.svgRoot.setAttribute("height",""+e.height),this.svgRoot.setAttribute("width",""+e.width),this.updateHighlightRect(e),this.updateTopBarSize(e),this.commentEditor.updateSize(e,t),this.deleteButton.reposition(),this.foldoutButton.reposition(),this.updateTextPreviewSize(e,t,i),this.updateResizeHandlePosition(e,n)}setSize(e){var t=this.preResizeSize||this.size;this.setSizeWithoutFiringEvents(e),this.onSizeChange(t,this.size)}calcMinSize(e){var t;this.updateTextPreview(null!=(t=this.commentEditor.getText())?t:"");let i=t=q(this.textPreview);return this.foldoutButton.isVisible()?i+=this.foldoutButton.getSize(!0).getWidth():t&&(i+=4),this.deleteButton.isVisible()?i+=this.deleteButton.getSize(!0).getWidth():t&&(i+=4),new I(i,e.height+20)}updateHighlightRect(e){this.highlightRect.setAttribute("height",""+e.height),this.highlightRect.setAttribute("width",""+e.width),this.workspace.RTL&&this.highlightRect.setAttribute("x",""+-e.width)}updateTopBarSize(e){this.topBarBackground.setAttribute("width",""+e.width)}updateTextPreviewSize(e,t,i){t=(t.height-i.height)/2;var n=this.foldoutButton.getSize(!0),o=this.deleteButton.getSize(!0);e=e.width-n.getWidth()-o.getWidth(),this.textPreview.setAttribute("x",""+n.getWidth()),this.textPreview.setAttribute("y",""+(t+i.height/2)),this.textPreview.setAttribute("width",""+e)}updateResizeHandlePosition(e,t){this.resizeHandle.setAttribute("y",""+(e.height-t.height)),this.resizeHandle.setAttribute("x",""+(e.width-t.width))}onSizeChange(t,i){for(let e=this.sizeChangeListeners.length-1;0<=e;e--)this.sizeChangeListeners[e](t,i)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}removeSizeChangeListener(e){this.sizeChangeListeners.splice(this.sizeChangeListeners.indexOf(e),1)}onResizePointerDown(e){this.isEditable()&&(this.bringToFront(),Cs(e)||(this.preResizeSize=this.getSize(),Sn(this.workspace,e,new E(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=p(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=p(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation())}onResizePointerUp(e){_s(),this.resizePointerUpListener&&(r(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(r(this.resizePointerMoveListener),this.resizePointerMoveListener=null),this.setSize(this.size),this.preResizeSize=void 0}onResizePointerMove(e){e=xn(this.workspace,e),this.setSizeWithoutFiringEvents(new I(this.workspace.RTL?-e.x:e.x,e.y))}isCollapsed(){return this.collapsed}setCollapsed(e){((this.collapsed=e)?c:s)(this.svgRoot,"blocklyCollapsed"),this.setSizeWithoutFiringEvents(this.size),this.onCollapse()}onCollapse(){for(let e=this.collapseChangeListeners.length-1;0<=e;e--)this.collapseChangeListeners[e](this.collapsed)}addOnCollapseListener(e){this.collapseChangeListeners.push(e)}removeOnCollapseListener(e){this.collapseChangeListeners.splice(this.collapseChangeListeners.indexOf(e),1)}isEditable(){return this.editable}setEditable(e){((this.editable=e)?(c(this.svgRoot,"blocklyEditable"),s):(s(this.svgRoot,"blocklyEditable"),c))(this.svgRoot,"blocklyReadonly"),this.commentEditor.setEditable(e)}getRelativeToSurfaceXY(){return this.location}moveTo(e){this.location=e,this.svgRoot.setAttribute("transform",`translate(${e.x}, ${e.y})`)}getText(){return this.commentEditor.getText()}setText(e){this.commentEditor.setText(e)}setPlaceholderText(e){this.commentEditor.setPlaceholderText(e)}addTextChangeListener(e){this.commentEditor.addTextChangeListener(e)}removeTextChangeListener(e){this.commentEditor.removeTextChangeListener(e)}updateTextPreview(e){this.textPreviewNode.textContent=this.truncateText(e)}truncateText(e){return 12<=e.length?e.substring(0,9)+"...":e}bringToFront(){var e=this.svgRoot.parentNode,t=e.childNodes;t[t.length-1]!==this.svgRoot&&e.appendChild(this.svgRoot)}onDeleteDown(e){_s(),Cs(e)||this.dispose(),e.stopPropagation()}dispose(){this.disposing=!0,this.foldoutButton.dispose(),this.deleteButton.dispose(),a(this.svgRoot);for(let e=this.disposeListeners.length-1;0<=e;e--)this.disposeListeners[e]();this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}addDisposeListener(e){this.disposeListeners.push(e)}removeDisposeListener(e){this.disposeListeners.splice(this.disposeListeners.indexOf(e),1)}getCommentBarButtons(){return[this.foldoutButton,this.deleteButton]}}),Eu=(Tu.defaultCommentSize=new I(120,100),be("\n.injectionDiv {\n  --commentFillColour: #FFFCC7;\n  --commentBorderColour: #F2E49B;\n}\n\n.blocklyComment .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 1px solid var(--commentBorderColour);\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n\n.blocklyReadonly.blocklyComment .blocklyTextarea {\n  cursor: inherit;\n}\n\n.blocklyDeleteIcon {\n  width: 20px;\n  height: 20px;\n  display: none;\n  cursor: pointer;\n}\n\n.blocklyFoldoutIcon {\n  width: 20px;\n  height: 20px;\n  transform-origin: 12px 12px;\n  cursor: pointer;\n}\n.blocklyResizeHandle {\n  width: 12px;\n  height: 12px;\n  cursor: se-resize;\n}\n.blocklyReadonly.blocklyComment .blocklyResizeHandle {\n  cursor: inherit;\n}\n\n.blocklyCommentTopbarBackground {\n  fill: var(--commentBorderColour);\n  height: 24px;\n}\n\n.blocklyComment .blocklyCommentPreview.blocklyText {\n  fill: #000;\n  dominant-baseline: middle;\n  visibility: hidden;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentPreview {\n  visibility: visible;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyCommentForeignObject,\n.blocklyCollapsed.blocklyComment .blocklyResizeHandle {\n  display: none;\n}\n\n.blocklyCollapsed.blocklyComment .blocklyFoldoutIcon {\n  transform: rotate(-90deg);\n}\n\n.blocklyRTL .blocklyCommentTopbar {\n  transform: scale(-1, 1);\n}\n\n.blocklyRTL .blocklyCommentForeignObject {\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyCommentPreview {\n  /* Revert the scale and control RTL using direction instead. */\n  transform: scale(-1, 1);\n  direction: rtl;\n}\n\n.blocklyRTL .blocklyResizeHandle {\n  transform: scale(-1, 1);\n  cursor: sw-resize;\n}\n\n.blocklyCommentHighlight {\n  fill: none;\n}\n\n.blocklyCommentText.blocklyActiveFocus {\n  border-color: #fc3;\n  border-width: 2px;\n}\n\n.blocklySelected .blocklyCommentHighlight {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentHighlight {\n  stroke: none;\n}\n\n.blocklyCollapsed.blocklySelected .blocklyCommentTopbarBackground {\n  stroke: #fc3;\n  stroke-width: 3px;\n}\n"),class{constructor(e,t){this.workspace=e,this.text="",this.collapsed=!1,this.deletable=this.movable=this.editable=!0,this.location=new E(0,0),this.disposing=this.disposed=!1,this.id=t&&!e.getCommentById(t)?t:xs(),this.size=Tu.defaultCommentSize,e.addTopComment(this),this.fireCreateEvent()}fireCreateEvent(){U()&&g(new(f(_.COMMENT_CREATE))(this))}fireDeleteEvent(){U()&&g(new(f(_.COMMENT_DELETE))(this))}fireChangeEvent(e,t){U()&&g(new(f(_.COMMENT_CHANGE))(this,e,t))}fireCollapseEvent(e){U()&&g(new(f(_.COMMENT_COLLAPSE))(this,e))}setText(e){var t=this.text;this.text=e,this.fireChangeEvent(t,e)}getText(){return this.text}setSize(e){var t=new(f(_.COMMENT_RESIZE))(this);this.size=e,t.recordCurrentSizeAsNewSize(),g(t)}getSize(){return this.size}setCollapsed(e){this.collapsed=e,this.fireCollapseEvent(e)}isCollapsed(){return this.collapsed}setEditable(e){this.editable=e}isEditable(){return this.isOwnEditable()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setMovable(e){this.movable=e}isMovable(){return this.isOwnMovable()&&!this.workspace.isReadOnly()&&!this.workspace.isFlyout}isOwnMovable(){return this.movable}setDeletable(e){this.deletable=e}isDeletable(){return this.isOwnDeletable()&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()&&!this.workspace.isFlyout}isOwnDeletable(){return this.deletable}moveTo(e,t){var i=new(f(_.COMMENT_MOVE))(this);t&&i.setReason(t),this.location=e,i.recordNew(),g(i)}getRelativeToSurfaceXY(){return this.location}dispose(){this.disposing=!0,this.fireDeleteEvent(),this.workspace.removeTopComment(this),this.disposed=!0}isDisposed(){return this.disposed}isDeadOrDying(){return this.disposing||this.disposed}}),ku=class extends Eu{constructor(e,t){super(e,t),this.dragStrategy=new hu(this),this.workspace=e,this.view=new Tu(e,this.id),this.view.setSize(this.getSize()),this.view.setEditable(this.isEditable()),this.view.getSvgRoot().setAttribute("data-id",this.id),this.view.getSvgRoot().setAttribute("id",this.id),this.addModelUpdateBindings(),p(this.view.getSvgRoot(),"pointerdown",this,this.startGesture),p(this.view.getSvgRoot(),"wheel",this,e=>{e.stopPropagation()})}addModelUpdateBindings(){this.view.addTextChangeListener((e,t)=>{super.setText(t)}),this.view.addSizeChangeListener((e,t)=>{super.setSize(t)}),this.view.addOnCollapseListener(()=>{super.setCollapsed(this.view.isCollapsed())}),this.view.addDisposeListener(()=>{this.isDeadOrDying()||this.dispose()})}setText(e){this.view.setText(e)}setPlaceholderText(e){this.view.setPlaceholderText(e)}setSize(e){this.view.setSize(e)}setCollapsed(e){this.view.setCollapsed(e)}setEditable(e){super.setEditable(e),this.view.setEditable(this.isEditable())}getSvgRoot(){return this.view.getSvgRoot()}getSize(){return super.getSize()}getBoundingRectangle(){var e,t=this.getRelativeToSurfaceXY(),i=null!=(n=null==(e=this.view)?void 0:e.getSize())?n:this.getSize(),n=this.workspace.RTL?(e=t.x-i.width,t.x):(e=t.x,t.x+i.width);return new C(t.y,t.y+i.height,e,n)}moveBy(e,t,i){var n=this.getRelativeToSurfaceXY();e=new E(n.x+e,n.y+t),this.moveTo(e,i)}moveTo(e,t){super.moveTo(e,t),this.view.moveTo(e)}moveDuringDrag(e){this.location=e,this.view.moveTo(e)}setDragging(e){(e?c:s)(this.getSvgRoot(),"blocklyDragging")}dispose(){this.disposing=!0;let e=m.getFocusManager$$module$build$src$core$focus_manager();e.getFocusedNode()===this&&setTimeout(()=>e.focusTree(this.workspace),0),this.view.isDeadOrDying()||this.view.dispose(),super.dispose()}startGesture(e){var t=this.workspace.getGesture(e);t&&(t.handleCommentStart(e,this),m.getFocusManager$$module$build$src$core$focus_manager().focusNode(this))}setDeleteStyle(e){(e?c:s)(this.getSvgRoot(),"blocklyDraggingDelete")}isCopyable(){return this.isOwnMovable()&&this.isOwnDeletable()}isMovable(){return this.dragStrategy.isMovable()}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){c(this.getSvgRoot(),"blocklySelected"),ce(this)}unselect(){s(this.getSvgRoot(),"blocklySelected"),ce(null)}toCopyData(){return{paster:vl.TYPE,commentState:Ye(this,{addCoordinates:!0})}}showContextMenu(e){var t=R.registry.getContextMenuOptions({comment:this,focusedNode:this},e),i=e instanceof PointerEvent?new E(e.clientX,e.clientY):Ne(this.workspace,this.getRelativeToSurfaceXY()).translate(10,10);yn(e,t,this.workspace.RTL,this.workspace,i)}snapToGrid(){var e,t;this.isDeadOrDying()||null!=(t=this.workspace.getGrid())&&t.shouldSnap()&&(e=this.getRelativeToSurfaceXY(),(t=t.alignXY(e))!==e)&&this.moveTo(t,["snap"])}getEditorFocusableNode(){return this.view.getEditorFocusableNode()}getFocusableElement(){return this.getSvgRoot()}getFocusableTree(){return this.workspace}onNodeFocus(){var e;this.select(),null!=(e=this.workspace.getLayerManager())&&e.append(this,50)}onNodeBlur(){this.unselect()}canBeFocused(){return!0}},Cu={},Iu=(Cu.appendDomToWorkspace=ed,Cu.blockToDom=Dn,Cu.blockToDomWithXY=An,Cu.clearWorkspaceAndLoadFromXml=ad,Cu.deleteNext=cd,Cu.domToBlock=m.domToBlock$$module$build$src$core$xml,Cu.domToBlockInternal=Bn,Cu.domToPrettyText=pd,Cu.domToText=$n,Cu.domToVariables=Fn,Cu.domToWorkspace=m.domToWorkspace$$module$build$src$core$xml,Cu.loadWorkspaceComment=Pn,Cu.saveWorkspaceComment=Rn,Cu.variablesToDom=On,Cu.workspaceToDom=gd,class extends dc{constructor(e){super(e),this.type=_.BLOCK_CREATE,e&&(e.isShadow()&&(this.recordUndo=!1),this.xml=An(e),this.ids=H(e),this.json=$t(e,{addCoordinates:!0}))}toJson(){var e=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(this.json)return e.xml=$n(this.xml),e.ids=this.ids,e.json=this.json,this.recordUndo||(e.recordUndo=this.recordUndo),e;throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new Iu)).xml=m.textToDom$$module$build$src$core$utils$xml(e.xml),t.ids=e.ids,t.json=e.json,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){var t=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!wu(t,this.ids))if(e)Wt(this.json,t);else for(e=0;e<this.ids.length;e++){var i=this.ids[e],n=t.getBlockById(i);n?n.dispose(!1):i===this.blockId&&console.warn("Can't uncreate non-existent block: "+i)}}}),wu=function(t,e){return e.map(e=>t.getBlockById(e)).filter(e=>e&&e.isShadow()).length===e.length},Su=(o(b.EVENT,_.BLOCK_CREATE,Iu),class extends Wa{constructor(e,t){super(t),this.type=_.THEME_CHANGE,this.themeName=e}toJson(){var e=super.toJson();if(this.themeName)return e.themeName=this.themeName,e;throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new Su)).themeName=e.themeName,t}}),xu=(o(b.EVENT,_.THEME_CHANGE,Su),class extends Wa{constructor(e,t,i,n,o){super(n),this.type=_.VIEWPORT_CHANGE,this.viewTop=e,this.viewLeft=t,this.scale=i,this.oldScale=o}toJson(){var e=super.toJson();if(void 0===this.viewTop)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.viewLeft)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.scale)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(void 0===this.oldScale)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return e.viewTop=this.viewTop,e.viewLeft=this.viewLeft,e.scale=this.scale,e.oldScale=this.oldScale,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new xu)).viewTop=e.viewTop,t.viewLeft=e.viewLeft,t.scale=e.scale,t.oldScale=e.oldScale,t}}),Ru=(o(b.EVENT,_.VIEWPORT_CHANGE,xu),(md=v=v||{})[md.INPUT_VALUE=1]="INPUT_VALUE",md[md.OUTPUT_VALUE=2]="OUTPUT_VALUE",md[md.NEXT_STATEMENT=3]="NEXT_STATEMENT",md[md.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT",class{constructor(e){this.connectionChecker=e,this.connections=[]}addConnection(e,t){t=this.calculateIndexForYPos(t),this.connections.splice(t,0,e)}findIndexOfConnection(t,i){if(this.connections.length){var n=this.calculateIndexForYPos(i);if(!(n>=this.connections.length)){i=t.y;let e=n;for(;0<=e&&this.connections[e].y===i;){if(this.connections[e]===t)return e;e--}for(e=n;e<this.connections.length&&this.connections[e].y===i;){if(this.connections[e]===t)return e;e++}}}return-1}calculateIndexForYPos(e){if(!this.connections.length)return 0;let t=0,i=this.connections.length;for(;t<i;){var n=Math.floor((t+i)/2);if(this.connections[n].y<e)t=n+1;else{if(!(this.connections[n].y>e)){t=n;break}i=n}}return t}removeConnection(e,t){if(-1===(e=this.findIndexOfConnection(e,t)))throw Error("Unable to find connection in connectionDB.");this.connections.splice(e,1)}getNeighbours(e,n){function t(e){var t=r-o[e].x,i=s-o[e].y;return Math.sqrt(t*t+i*i)<=n&&l.push(o[e]),i<n}let o=this.connections,r=e.x,s=e.y,i=(e=0,o.length-2),a=i;for(;e<a;)o[a].y<s?e=a:i=a,a=Math.floor((e+i)/2);let l=[];if(i=e=a,o.length){for(;0<=e&&t(e);)e--;for(;++i<o.length&&t(i););}return l}isInYRange(e,t,i){return Math.abs(this.connections[e].y-t)<=i}searchForClosest(e,t,i){if(!this.connections.length)return{connection:null,radius:t};var n=e.y,o=e.x,r=(e.x=o+i.x,e.y=n+i.y,this.calculateIndexForYPos(e.y));i=null;let s=t,a,l=r-1;for(;0<=l&&this.isInYRange(l,e.y,t);)a=this.connections[l],this.connectionChecker.canConnect(e,a,!0,s)&&(i=a,s=a.distanceFrom(e)),l--;for(;r<this.connections.length&&this.isInYRange(r,e.y,t);)a=this.connections[r],this.connectionChecker.canConnect(e,a,!0,s)&&(i=a,s=a.distanceFrom(e)),r++;return e.x=o,e.y=n,{connection:i,radius:s}}static init(e){var t=[];return t[v.INPUT_VALUE]=new Ru(e),t[v.OUTPUT_VALUE]=new Ru(e),t[v.NEXT_STATEMENT]=new Ru(e),t[v.PREVIOUS_STATEMENT]=new Ru(e),t}}),Ou=class extends Wa{constructor(e,t,i){super(i),this.type=_.SELECTED,this.oldElementId=null!=e?e:void 0,this.newElementId=null!=t?t:void 0}toJson(){var e=super.toJson();return e.oldElementId=this.oldElementId,e.newElementId=this.newElementId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new Ou)).oldElementId=e.oldElementId,t.newElementId=e.newElementId,t}},Au=(o(b.EVENT,_.SELECTED,Ou),class extends dc{constructor(e){if(super(e),this.type=_.BLOCK_DELETE,e){if(e.getParent())throw Error("Connected blocks cannot be deleted.");e.isShadow()&&(this.recordUndo=!1),this.oldXml=An(e),this.ids=H(e),this.wasShadow=e.isShadow(),this.oldJson=$t(e,{addCoordinates:!0})}}toJson(){var e=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(void 0===this.wasShadow)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(this.oldJson)return e.oldXml=$n(this.oldXml),e.ids=this.ids,e.wasShadow=this.wasShadow,e.oldJson=this.oldJson,this.recordUndo||(e.recordUndo=this.recordUndo),e;throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new Au)).oldXml=m.textToDom$$module$build$src$core$utils$xml(e.oldXml),t.ids=e.ids,t.wasShadow=e.wasShadow||"shadow"===t.oldXml.tagName.toLowerCase(),t.oldJson=e.oldJson,void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}run(e){var t=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(e)for(e=0;e<this.ids.length;e++){var i=this.ids[e],n=t.getBlockById(i);n?n.dispose(!1):i===this.blockId&&console.warn("Can't delete non-existent block: "+i)}else Wt(this.oldJson,t)}}),Nu=(o(b.EVENT,_.BLOCK_DELETE,Au),{fromJsonInternal:Dd}),Lu={TEST_ONLY:Nu},Du=(Lu.fromJson=m.fromJson$$module$build$src$core$field_registry,Lu.register=Jd,Lu.unregister=$d,class extends x{constructor(e,t,i){super(x.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,e!==x.SKIP_SETUP&&(this.setOptions(e),i&&this.configure_(i),t)&&this.setValidator(t)}fromXml(e){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e.textContent)}loadState(e){this.loadLegacyState(Du,e)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(e))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=l(k.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&c(this.borderRect_,"blocklyDropdownRect"),this.fieldGroup_&&(c(this.fieldGroup_,"blocklyField"),c(this.fieldGroup_,"blocklyDropdownField"))}shouldAddBorderRect_(){var e;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!(null!=(e=this.getSourceBlock())&&e.isShadow())}createTextArrow_(){var e;this.arrow=l(k.TSPAN,{},this.textElement_),this.arrow.appendChild(document.createTextNode(null!=(e=this.getSourceBlock())&&e.RTL?Du.ARROW_CHAR+" ":" "+Du.ARROW_CHAR)),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.arrow.setAttribute("dominant-baseline","central"),null!=(e=this.getSourceBlock())&&e.RTL?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=l(k.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(Na,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(e){var t=this.getSourceBlock();if(!t)throw new Jc;this.dropdownCreate(),this.menu_&&(this.menu_.openingCoords=e&&"number"==typeof e.clientX?new E(e.clientX,e.clientY):null,ui(),e=this.menu_.render(sa),c(e,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(t=t.getColour(),e=this.sourceBlock_.getColourTertiary(),di(t,e)),hi(this,this.dropdownDispose_.bind(this)),sa.style.height=this.menu_.getSize().height+"px",this.menu_.focus(),this.selectedMenuItem&&this.menu_.setHighlighted(this.selectedMenuItem),this.applyColour())}dropdownCreate(){var t=this.getSourceBlock();if(!t)throw new Jc;var i=new Cl,n=(i.setRole(ia.LISTBOX),this.menu_=i,this.getOptions(!1));this.selectedMenuItem=null;for(let e=0;e<n.length;e++){var o,r,s=n[e];s===Du.SEPARATOR?i.addChild(new Il):([o,r]=s,Jn(o)?((s=new Image(o.width,o.height)).src=o.src,s.alt=o.alt):s=o,(s=new kl(s,r)).setRole(ia.OPTION),s.setRightToLeft(t.RTL),s.setCheckable(!0),i.addChild(s),s.setChecked(r===this.value_),r===this.value_&&(this.selectedMenuItem=s),s.onAction(this.handleMenuActionEvent,this))}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(e){Ti(this,!0),this.onItemSelected_(this.menu_,e)}onItemSelected_(e,t){this.setValue(t.getValue())}isOptionListDynamic(){return"function"==typeof this.menuGenerator_}getOptions(e){if(this.menuGenerator_)return Array.isArray(this.menuGenerator_)?this.menuGenerator_:(e&&this.generatedOptions||(this.generatedOptions=this.menuGenerator_(),this.validateOptions(this.generatedOptions)),this.generatedOptions);throw TypeError("A menu generator was never defined.")}setOptions(e){Array.isArray(e)?(this.validateOptions(e),e=this.trimOptions(e),this.menuGenerator_=e.options,this.prefixField=e.prefix||null,this.suffixField=e.suffix||null):this.menuGenerator_=e,this.selectedOption=this.getOptions(!1)[0],this.setValue(this.selectedOption[1])}doClassValidation_(t){return this.getOptions(!0).some(e=>e[1]===t)?t:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+t),null)}doValueUpdate_(i){super.doValueUpdate_(i),i=this.getOptions(!0);for(let e=0,t;t=i[e];e++)t[1]===this.value_&&(this.selectedOption=t)}applyColour(){var e=this.sourceBlock_;this.borderRect_&&(this.borderRect_.setAttribute("stroke",e.getColourTertiary()),this.menu_?this.borderRect_.setAttribute("fill",e.getColourTertiary()):this.borderRect_.setAttribute("fill","transparent")),e&&this.arrow&&(e.isShadow()?this.arrow.style.fill=e.getColourSecondary():this.arrow.style.fill=e.getColour())}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";var e=this.selectedOption&&this.selectedOption[0];Jn(e)?this.renderSelectedImage(e):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(e){var t=this.getSourceBlock();if(!t)throw new Jc;this.imageElement.style.display="",this.imageElement.setAttributeNS(Na,"xlink:href",e.src),this.imageElement.setAttribute("height",String(e.height)),this.imageElement.setAttribute("width",String(e.width));var i=Number(e.height),n=(e=Number(e.width),!!this.borderRect_),o=Math.max(n?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,i+Du.IMAGE_Y_PADDING),n=n?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,r=this.svgArrow?this.positionSVGArrow(e+n,o/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):q(this.arrow);this.size_.width=e+r+2*n,this.size_.height=o;let s=0;t.RTL?this.imageElement.setAttribute("x",""+(n+r)):(s=e+r,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x",""+n)),this.imageElement.setAttribute("y",String(o/2-i/2)),this.positionTextElement_(s+n,e+r)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var e=this.getTextElement(),t=(c(e,"blocklyDropdownText"),e.setAttribute("text-anchor","start"),!!this.borderRect_),e=Math.max(t?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT),i=q(this.getTextElement()),t=t?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let n=0;this.svgArrow&&(n=this.positionSVGArrow(i+t,e/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=i+n+2*t,this.size_.height=e,this.positionTextElement_(t,i)}positionSVGArrow(e,t){if(!this.svgArrow)return 0;var i,n,o,r=this.getSourceBlock();if(r)return i=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,n=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,o=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE,this.svgArrow.setAttribute("transform","translate("+(r.RTL?i:e+n)+","+t+")"),o+n;throw new Jc}getText_(){if(this.selectedOption){var e,t=this.selectedOption[0];if(Jn(t))return t.alt;if("undefined"!=typeof HTMLElement&&t instanceof HTMLElement)return null!=(e=null!=(e=t.title)?e:t.ariaLabel)?e:t.innerText;if("string"==typeof t)return t;console.warn("Can't get text for existing dropdown option. If you're using HTMLElement dropdown options in node, ensure you're using jsdom-global or similar.")}return null}static fromJson(e){if(e.options)return new this(e.options,void 0,e);throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.")}trimOptions(e){let i=!1;var t,n,o,r=e.map(e=>{var t;return e===Du.SEPARATOR?e:([e,t]=e,"string"==typeof e?[on(e),t]:(i=!0,[Jn(e)?Object.assign({},e,{alt:on(e.alt)}):Object.assign({},e),t]))});return i||e.length<2||(t=r.map(([e])=>e),n=wi(t),e=Si(t,n),o=xi(t,n),!e&&!o)||n<=e+o?{options:r}:(n=e?t[0].substring(0,e-1):void 0,t=o?t[0].substr(1-o):void 0,{options:this.applyTrim(r,e,o),prefix:n,suffix:t})}applyTrim(e,i,n){return e.map(([e,t])=>[e.substring(i,e.length-n),t])}validateOptions(t){if(!Array.isArray(t))throw TypeError("FieldDropdown options must be an array.");if(!t.length)throw TypeError("FieldDropdown options must not be an empty array.");let i=!1;for(let e=0;e<t.length;e++){var n=t[e];Array.isArray(n)||n===Du.SEPARATOR?"string"!=typeof n[1]?(i=!0,console.error(`Invalid option[${e}]: Each FieldDropdown option id must be a string. 
          Found ${n[1]} in: `+n)):!n[0]||"string"==typeof n[0]||Jn(n[0])||"undefined"!=typeof HTMLElement&&n[0]instanceof HTMLElement||(i=!0,console.error(`Invalid option[${e}]: Each FieldDropdown option must have a string 
          label, image description, or HTML element. Found ${n[0]} in: `+n)):(i=!0,console.error(`Invalid option[${e}]: Each FieldDropdown option must be an array or
          the string literal 'separator'. Found: `+n))}if(i)throw TypeError("Found invalid FieldDropdown options.")}}),Mu=(Du.SEPARATOR="separator",Du.ARROW_CHAR="â–¾",Du.IMAGE_Y_OFFSET=5,Du.IMAGE_Y_PADDING=2*Du.IMAGE_Y_OFFSET,Jd("field_dropdown",Du),class{constructor(e,t,i,n){this.name=e,this.startHats=!1,this.blockStyles=t||Object.create(null),this.categoryStyles=i||Object.create(null),this.componentStyles=n||Object.create(null),this.fontStyle=Object.create(null),o(b.THEME,e,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(e,t){this.blockStyles[e]=t}setCategoryStyle(e,t){this.categoryStyles[e]=t}getComponentStyle(e){if(!(e=this.componentStyles[e]))return null;if("string"==typeof e){var t=this.getComponentStyle(e);if(t)return t}return""+e}setComponentStyle(e,t){this.componentStyles[e]=t}setFontStyle(e){this.fontStyle=e}setStartHats(e){this.startHats=e}static defineTheme(e,t){e=e.toLowerCase();var i,n=new Mu(e);let o=t.base;return o&&(o="string"==typeof o?null!=(i=ps(b.THEME,o))?i:void 0:o)instanceof Mu&&(te(n,o),n.name=e),te(n.blockStyles,t.blockStyles),te(n.categoryStyles,t.categoryStyles),te(n.componentStyles,t.componentStyles),te(n.fontStyle,t.fontStyle),null!==t.startHats&&(n.startHats=t.startHats),n}}),$u=new Mu("classic",{colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},{colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}}),Pu=class{constructor(e){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let t=null,i=!1;var n,o=!1,r=!1,s=!1,a=!1,l=!1,c=!!e.readOnly,u=(c||(t=Me(null!=(n=e.toolbox)?n:null),i=Be(t),o=void 0===(o=e.trashcan)?i:o,r=void 0===(r=e.collapse)?i:r,s=void 0===(s=e.comments)?i:s,a=void 0===(a=e.disable)?i:a,l=void 0===(l=e.sounds)||l),n=e.maxTrashcanContents,o?void 0===n&&(n=32):n=0,!!e.rtl);let d=e.horizontalLayout;void 0===d&&(d=!1);var h="end"!==e.toolboxPosition,h=d?h?y.TOP:y.BOTTOM:h==u?y.RIGHT:y.LEFT;let p=e.css,g=(void 0===p&&(p=!0),"https://blockly-demo.appspot.com/static/media/");e.media&&(g=e.media.endsWith("/")?e.media:e.media+"/");var f=e.oneBasedIndex,m=e.renderer||"geras",b=e.plugins||{};let _=e.modalInputs;void 0===_&&(_=!0),this.RTL=u,this.oneBasedIndex=void 0===f||f,this.collapse=r,this.comments=s,this.disable=a,this.readOnly=c,this.maxBlocks=e.maxBlocks||1/0,this.maxInstances=null!=(u=e.maxInstances)?u:null,this.modalInputs=_,this.pathToMedia=g,this.hasCategories=i,this.moveOptions=Pu.parseMoveOptions(e,i),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=o,this.maxTrashcanContents=n,this.hasSounds=l,this.hasCss=p,this.horizontalLayout=d,this.languageTree=t,this.gridOptions=Pu.parseGridOptions(e),this.zoomOptions=Pu.parseZoomOptions(e),this.toolboxPosition=h,this.theme=Pu.parseThemeOptions(e),this.renderer=m,this.rendererOverrides=null!=(f=e.rendererOverrides)?f:null,this.parentWorkspace=null!=(r=e.parentWorkspace)?r:null,this.plugins=b}static parseMoveOptions(e,t){var i=e.move||{},n={};return void 0===i.scrollbars&&void 0===e.scrollbars?n.scrollbars=t:"object"==typeof i.scrollbars?(n.scrollbars={horizontal:!!i.scrollbars.horizontal,vertical:!!i.scrollbars.vertical},n.scrollbars.horizontal&&n.scrollbars.vertical?n.scrollbars=!0:n.scrollbars.horizontal||n.scrollbars.vertical||(n.scrollbars=!1)):n.scrollbars=!!i.scrollbars||!!e.scrollbars,n.wheel=n.scrollbars&&void 0!==i.wheel?!!i.wheel:"object"==typeof n.scrollbars,n.drag=!(!n.scrollbars||void 0!==i.drag&&!i.drag),n}static parseZoomOptions(e){e=e.zoom||{};var t={};return t.controls=void 0!==e.controls&&!!e.controls,t.wheel=void 0!==e.wheel&&!!e.wheel,t.startScale=void 0===e.startScale?1:Number(e.startScale),t.maxScale=void 0===e.maxScale?3:Number(e.maxScale),t.minScale=void 0===e.minScale?.3:Number(e.minScale),t.scaleSpeed=void 0===e.scaleSpeed?1.2:Number(e.scaleSpeed),t.pinch=void 0===e.pinch?t.wheel||t.controls:!!e.pinch,t}static parseGridOptions(e){e=e.grid||{};var t={};return t.spacing=Number(e.spacing)||0,t.colour=e.colour||"#888",t.length=void 0===e.length?1:Number(e.length),t.snap=0<t.spacing&&!!e.snap,t}static parseThemeOptions(e){return"string"==typeof(e=e.theme||$u)?ps(b.THEME,e):e instanceof Mu?e:Mu.defineTheme(e.name||"builtin"+Ss(),e)}},Bu=class{constructor(e,t){this.bubble=e,this.workspace=t,this.startLoc=null}isMovable(){return!0}startDrag(){var e;this.startLoc=this.bubble.getRelativeToSurfaceXY(),this.workspace.setResizesEnabled(!1),null!=(e=this.workspace.getLayerManager())&&e.moveToDragLayer(this.bubble),this.bubble.setDragging&&this.bubble.setDragging(!0)}drag(e){this.bubble.moveDuringDrag(e)}endDrag(){var e;this.workspace.setResizesEnabled(!0),null!=(e=this.workspace.getLayerManager())&&e.moveOffDragLayer(this.bubble,100),this.bubble.setDragging(!1)}revertDrag(){this.startLoc&&this.bubble.moveDuringDrag(this.startLoc)}},O=class{constructor(e,t,i,n){this.workspace=e,this.anchor=t,this.ownerRect=i,this.size=new I(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.dragStrategy=new Bu(this,this.workspace),this.id=Ss(),this.svgRoot=l(k.G,{class:"blocklyBubble"},e.getBubbleCanvas()),e=l(k.G,{class:"blocklyEmboss"},this.svgRoot),this.tail=l(k.PATH,{class:"blocklyBubbleTail"},e),this.background=l(k.RECT,{class:"blocklyDraggable",x:0,y:0,rx:Fu.BORDER_WIDTH,ry:Fu.BORDER_WIDTH},e),this.contentContainer=l(k.G,{},this.svgRoot),this.focusableElement=null!=n?n:this.svgRoot,this.focusableElement.setAttribute("id",this.id),p(this.background,"pointerdown",this,this.onMouseDown)}dispose(){a(this.svgRoot),this.disposed=!0}setAnchorLocation(e,t=!1){this.anchor=e,t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(e,t){this.relativeLeft=e,this.relativeTop=t,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(e,t=!1){e.width=Math.max(e.width,Fu.MIN_SIZE),e.height=Math.max(e.height,Fu.MIN_SIZE),this.size=e,this.background.setAttribute("width",""+e.width),this.background.setAttribute("height",""+e.height),t?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(e){this.colour=e,this.tail.setAttribute("fill",e),this.background.setAttribute("fill",e)}onMouseDown(e){var t;null!=(t=this.workspace.getGesture(e))&&t.handleBubbleStart(e,this),m.getFocusManager$$module$build$src$core$focus_manager().focusNode(this)}positionRelativeToAnchor(){var e=this.anchor.x,e=this.workspace.RTL?e-(this.relativeLeft+this.size.width):e+this.relativeLeft;this.moveTo(e,this.relativeTop+this.anchor.y)}moveTo(e,t){this.svgRoot.setAttribute("transform",`translate(${e}, ${t})`)}positionByRect(e=new C(0,0,0,0)){var t=this.workspace.getMetricsManager().getViewMetrics(!0),i=this.getOptimalRelativeLeft(t),n=this.getOptimalRelativeTop(t),o={x:i,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},r={x:-this.size.width-30,y:n},n={x:e.getWidth(),y:n},s={x:i,y:e.getHeight()},i=e.getWidth()<e.getHeight()?n:s,s=(e=e.getWidth()<e.getHeight()?s:n,n=this.getOverlap(o,t),this.getOverlap(r,t)),a=this.getOverlap(i,t),t=this.getOverlap(e,t);n===(t=Math.max(n,s,a,t))?(this.relativeLeft=o.x,this.relativeTop=o.y):s===t?(this.relativeLeft=r.x,this.relativeTop=r.y):a===t?(this.relativeLeft=i.x,this.relativeTop=i.y):(this.relativeLeft=e.x,this.relativeTop=e.y),this.positionRelativeToAnchor()}getOverlap(e,t){var i=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x+this.anchor.x;return e=e.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(i+this.size.width,t.left+t.width)-Math.max(i,t.left))*(Math.min(e+this.size.height,t.top+t.height)-Math.max(e,t.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(e){let t=-this.size.width/4;var i,n;return this.size.width>e.width||(e=this.getWorkspaceViewRect(e),this.workspace.RTL?(i=this.anchor.x-t)-this.size.width<e.left?t=-(e.left-this.anchor.x+this.size.width):i>e.right&&(t=-(e.right-this.anchor.x)):(n=(i=t+this.anchor.x)+this.size.width,i<e.left?t=e.left-this.anchor.x:n>e.right&&(t=e.right-this.anchor.x-this.size.width))),t}getOptimalRelativeTop(e){let t=-this.size.height/4;var i,n;return this.size.height>e.height||(n=(i=this.anchor.y+t)+this.size.height,i<(e=this.getWorkspaceViewRect(e)).top?t=e.top-this.anchor.y:n>e.bottom&&(t=e.bottom-this.anchor.y-this.size.height)),t}getWorkspaceViewRect(e){var t=e.top;let i=e.top+e.height,n=e.left;return e=e.left+e.width,i-=this.getScrollbarThickness(),this.workspace.RTL?n-=this.getScrollbarThickness():e-=this.getScrollbarThickness(),new C(t,i,n,e)}getScrollbarThickness(){return nl.scrollbarThickness/this.workspace.scale}renderTail(){var e,t,i,n,o,r,s,a=[],l=this.size.width/2,c=this.size.height/2,u=-this.relativeLeft,d=-this.relativeTop;l===u&&c==d?a.push("M "+l+","+c):(d-=c,u-=l,this.workspace.RTL&&(u*=-1),e=Math.sqrt(d*d+u*u),t=Math.acos(u/e),o=(t=d<0?2*Math.PI-t:t)+Math.PI/2,2*Math.PI<o&&(o-=2*Math.PI),i=Math.sin(o),s=Math.cos(o),n=(this.size.width+this.size.height)/Fu.TAIL_THICKNESS,n=Math.min(n,this.size.width,this.size.height)/4,u=l+(o=1-Fu.ANCHOR_RADIUS/e)*u,d=c+o*d,o=l+n*s,r=c+n*i,l-=n*s,c-=n*i,(i=t+(i=si(this.workspace.RTL?-Fu.TAIL_ANGLE:Fu.TAIL_ANGLE)))>2*Math.PI&&(i-=2*Math.PI),t=Math.sin(i)*e/Fu.TAIL_BEND,e=Math.cos(i)*e/Fu.TAIL_BEND,a.push("M"+o+","+r),a.push("C"+(o+e)+","+(r+t)+" "+u+","+d+" "+u+","+d),a.push("C"+u+","+d+" "+(l+e)+","+(c+t)+" "+l+","+c)),a.push("z"),null!=(s=this.tail)&&s.setAttribute("d",a.join(" "))}bringToFront(){var e=null==(e=this.svgRoot)?void 0:e.parentNode;return!(!this.svgRoot||(null==e?void 0:e.lastChild)===this.svgRoot||(null!=e&&e.appendChild(this.svgRoot),0))}getRelativeToSurfaceXY(){return new E(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(e){this.moveTo(e.x,e.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-e.x-this.size.width:e.x-this.anchor.x,this.relativeTop=e.y-this.anchor.y,this.renderTail()}setDragging(e){}setDeleteStyle(e){}isDeletable(){return!1}showContextMenu(e){}isMovable(){return!0}startDrag(){this.dragStrategy.startDrag()}drag(e){this.dragStrategy.drag(e)}endDrag(){this.dragStrategy.endDrag()}revertDrag(){this.dragStrategy.revertDrag()}select(){ce(this)}unselect(){ce(null)}getFocusableElement(){return this.focusableElement}getFocusableTree(){return this.workspace}onNodeFocus(){this.select(),this.bringToFront()}onNodeBlur(){this.unselect()}canBeFocused(){return!0}},Fu=O,Uu=(O.BORDER_WIDTH=6,O.DOUBLE_BORDER=2*Fu.BORDER_WIDTH,O.MIN_SIZE=Fu.DOUBLE_BORDER,O.TAIL_THICKNESS=1,O.TAIL_ANGLE=20,O.TAIL_BEND=4,O.ANCHOR_RADIUS=8,class extends O{constructor(e,t,i,n){super(t,i,n),this.workspace=t,this.anchor=i,this.ownerRect=n,this.autoLayout=!0,t=new Pu(e),this.validateWorkspaceOptions(t),this.svgDialog=l(k.SVG,{x:O.BORDER_WIDTH,y:O.BORDER_WIDTH},this.contentContainer),e.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new Pu(e)),this.miniWorkspace.internalIsMutator=!0,e=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(e),t.languageTree&&(e.insertBefore(this.miniWorkspace.addFlyout(k.G),this.miniWorkspace.getCanvas()),null!=(e=this.miniWorkspace.getFlyout())&&e.init(this.miniWorkspace),null!=e)&&e.show(t.languageTree),c(this.svgRoot,"blocklyMiniWorkspaceBubble"),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this));let o,r;null!=(o=this.miniWorkspace.getFlyout())&&null!=(r=o.getWorkspace())&&r.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(e){this.miniWorkspace.addChangeListener(e)}validateWorkspaceOptions(e){if(e.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(e.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(e.zoomOptions.controls||e.zoomOptions.wheel||e.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(e.moveOptions.scrollbars||e.moveOptions.wheel||e.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(e.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging()||this.miniWorkspace.keyboardMoveInProgress)for(var t of this.miniWorkspace.getTopBlocks(!1)){var i=t.getRelativeToSurfaceXY();if(i.y<20&&t.moveBy(0,20-i.y),t.RTL){let e=-20;var n=this.miniWorkspace.getFlyout();n&&(e-=n.getWidth()),i.x>e&&t.moveBy(e-i.x,0)}else i.x<20&&t.moveBy(20-i.x,0)}}updateBubbleSize(){var e,t;this.miniWorkspace.isDragging()&&!this.miniWorkspace.keyboardMoveInProgress||(this.autoLayout&&(this.autoLayout=!this.miniWorkspace.keyboardMoveInProgress),e=this.getSize(),t=this.calculateWorkspaceSize(),Math.abs(e.width-t.width)<Uu.MINIMUM_VIEW_CHANGE&&Math.abs(e.height-t.height)<Uu.MINIMUM_VIEW_CHANGE)||(this.svgDialog.setAttribute("width",t.width+"px"),this.svgDialog.setAttribute("height",t.height+"px"),this.miniWorkspace.setCachedParentSvgSize(t.width,t.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform",`translate(${t.width}, 0)`),this.setSize(new I(t.width+O.DOUBLE_BORDER,t.height+O.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}calculateWorkspaceSize(){var e=this.miniWorkspace.getCanvas().getBBox();let t=e.width+Uu.MARGIN;e=e.height+Uu.MARGIN;var i,n=this.miniWorkspace.getFlyout();return n&&(i=n.getWorkspace().getMetricsManager().getScrollMetrics(),e=Math.max(e,i.height+20),t+=n.getWidth()),new I(t,e)}updateBlockStyles(){for(var e of this.miniWorkspace.getAllBlocks(!1))e.setStyle(e.getStyleName());var t;if(e=null==(t=this.miniWorkspace.getFlyout())?void 0:t.getWorkspace())for(var i of e.getAllBlocks(!1))i.setStyle(i.getStyleName())}moveDuringDrag(e){super.moveDuringDrag(e),this.autoLayout=!1}moveTo(e,t){super.moveTo(e,t),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(e){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}}),Hu=(Uu.MINIMUM_VIEW_CHANGE=10,Uu.MARGIN=3*O.DOUBLE_BORDER,class{constructor(e){this.sourceBlock=e,this.offsetInBlock=new E(0,0),this.workspaceLocation=new E(0,0),this.svgRoot=null,this.tooltip=e,this.id=Ss()}getType(){throw Error("Icons must implement getType")}initView(e){var t;this.svgRoot||(t=this.sourceBlock,this.svgRoot=l(k.G,{class:"blocklyIconGroup",id:this.id}),t.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),p(this.svgRoot,"pointerdown",this,e),this.svgRoot.tooltip=this,$i(this.svgRoot))}dispose(){Pi(this.svgRoot),a(this.svgRoot)}getWeight(){return-1}getSize(){return new I(0,0)}setTooltip(e){this.tooltip=null!=e?e:this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.sourceBlock.isCollapsed()?this.svgRoot.style.display="none":this.svgRoot.style.display="block",ri(this))&&this.setBubbleVisible(!1)}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(e){this.offsetInBlock=e,this.updateSvgRootOffset()}updateSvgRootOffset(){var e;null!=(e=this.svgRoot)&&e.setAttribute("transform",`translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`)}onLocationChange(e){this.workspaceLocation=E.sum(e,this.offsetInBlock)}onClick(){}isClickableInFlyout(e){return!0}getFocusableElement(){var e=this.svgRoot;if(e)return e;throw Error("Attempting to focus uninitialized icon.")}getFocusableTree(){return this.sourceBlock.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getSourceBlock(){return this.sourceBlock}}),Gu=(m.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends Hu{constructor(e,t){super(t),this.flyoutBlockTypes=e,this.sourceBlock=t,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return m.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(e){this.svgRoot||(super.initView(e),l(k.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),l(k.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),l(k.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot),c(this.svgRoot,"blocklyMutatorIcon"))}dispose(){var e;super.dispose(),null!=(e=this.miniWorkspaceBubble)&&e.dispose()}getWeight(){return m.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new I(17,17)}applyColour(){var e;super.applyColour(),null!=(e=this.miniWorkspaceBubble)&&e.setColour(this.sourceBlock.getColour()),null!=(e=this.miniWorkspaceBubble)&&e.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(e){super.onLocationChange(e),null!=(e=this.miniWorkspaceBubble)&&e.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.sourceBlock.isEditable()&&this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(t){let i=this;return(0,h.asyncExecutePromiseGeneratorFunction)(function*(){var e;i.bubbleIsVisible()!==t&&(yield tt(),t?(i.miniWorkspaceBubble=new Uu(i.getMiniWorkspaceConfig(),i.sourceBlock.workspace,i.getAnchorLocation(),i.getBubbleOwnerRect()),i.applyColour(),i.createRootBlock(),i.addSaveConnectionsListener(),null!=(e=i.miniWorkspaceBubble)&&e.addWorkspaceChangeListener(i.createMiniWorkspaceChangeListener())):(null!=(e=i.miniWorkspaceBubble)&&e.dispose(),i.miniWorkspaceBubble=null,i.saveConnectionsListener&&i.sourceBlock.workspace.removeChangeListener(i.saveConnectionsListener),i.saveConnectionsListener=null),g(new(f(_.BUBBLE_OPEN))(i.sourceBlock,t,"mutator")))})}getBubble(){return this.miniWorkspaceBubble}getMiniWorkspaceConfig(){var e={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:null!=(e=this.sourceBlock.workspace.options.rendererOverrides)?e:void 0};return this.flyoutBlockTypes.length&&(e.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map(e=>({kind:"block",type:e}))}),e}getAnchorLocation(){return E.sum(this.workspaceLocation,new E(8.5,8.5))}getBubbleOwnerRect(){var e=this.sourceBlock.getSvgRoot().getBBox();return new C(e.y,e.y+e.height,e.x,e.x+e.width)}createRootBlock(){if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace());for(var e of this.rootBlock.getDescendants(!1))e.queueRender();var t;this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1),e=null!=(t=null==(t=this.miniWorkspaceBubble)||null==(t=t.getWorkspace())||null==(t=t.getFlyout())?void 0:t.getWidth())?t:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(e+16):16,16)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return e=>{m.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(e)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()},0))}}static isIgnorableMutatorEvent(e){return e.isUiEvent||Rs(e)||As(e)&&"disabled"===e.element}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var e=m.getGroup$$module$build$src$core$events$utils(),t=(e||m.setGroup$$module$build$src$core$events$utils(!0),hc.getExtraBlockState_(this.sourceBlock)),i=(this.sourceBlock.compose(this.rootBlock),hc.getExtraBlockState_(this.sourceBlock));t!==i&&g(new(f(_.BLOCK_CHANGE))(this.sourceBlock,"mutation",null,t,i)),m.setGroup$$module$build$src$core$events$utils(e)}}getWorkspace(){var e;return null==(e=this.miniWorkspaceBubble)?void 0:e.getWorkspace()}},m.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=uc.MUTATOR,m.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1,m.MutatorIcon$$module$build$src$core$icons$mutator_icon,Object.create(null)),Vu={allExtensions:Gu},ju=(m.register$$module$build$src$core$extensions("parent_tooltip_when_inline",Gd),{TEST_ONLY:Vu}),Wu=(ju.apply=Qn,ju.buildTooltipForDropdown=m.buildTooltipForDropdown$$module$build$src$core$extensions,ju.buildTooltipWithFieldText=m.buildTooltipWithFieldText$$module$build$src$core$extensions,ju.isRegistered=Zn,ju.register=m.register$$module$build$src$core$extensions,ju.registerMixin=m.registerMixin$$module$build$src$core$extensions,ju.registerMutator=m.registerMutator$$module$build$src$core$extensions,ju.runAfterPageLoad=Yd,ju.unregister=M,(D=n=n||{})[D.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",D[D.MAC_ENTER=3]="MAC_ENTER",D[D.BACKSPACE=8]="BACKSPACE",D[D.TAB=9]="TAB",D[D.NUM_CENTER=12]="NUM_CENTER",D[D.ENTER=13]="ENTER",D[D.SHIFT=16]="SHIFT",D[D.CTRL=17]="CTRL",D[D.ALT=18]="ALT",D[D.PAUSE=19]="PAUSE",D[D.CAPS_LOCK=20]="CAPS_LOCK",D[D.ESC=27]="ESC",D[D.SPACE=32]="SPACE",D[D.PAGE_UP=33]="PAGE_UP",D[D.PAGE_DOWN=34]="PAGE_DOWN",D[D.END=35]="END",D[D.HOME=36]="HOME",D[D.LEFT=37]="LEFT",D[D.UP=38]="UP",D[D.RIGHT=39]="RIGHT",D[D.DOWN=40]="DOWN",D[D.PLUS_SIGN=43]="PLUS_SIGN",D[D.PRINT_SCREEN=44]="PRINT_SCREEN",D[D.INSERT=45]="INSERT",D[D.DELETE=46]="DELETE",D[D.ZERO=48]="ZERO",D[D.ONE=49]="ONE",D[D.TWO=50]="TWO",D[D.THREE=51]="THREE",D[D.FOUR=52]="FOUR",D[D.FIVE=53]="FIVE",D[D.SIX=54]="SIX",D[D.SEVEN=55]="SEVEN",D[D.EIGHT=56]="EIGHT",D[D.NINE=57]="NINE",D[D.FF_SEMICOLON=59]="FF_SEMICOLON",D[D.FF_EQUALS=61]="FF_EQUALS",D[D.FF_DASH=173]="FF_DASH",D[D.FF_HASH=163]="FF_HASH",D[D.QUESTION_MARK=63]="QUESTION_MARK",D[D.AT_SIGN=64]="AT_SIGN",D[D.A=65]="A",D[D.B=66]="B",D[D.C=67]="C",D[D.D=68]="D",D[D.E=69]="E",D[D.F=70]="F",D[D.G=71]="G",D[D.H=72]="H",D[D.I=73]="I",D[D.J=74]="J",D[D.K=75]="K",D[D.L=76]="L",D[D.M=77]="M",D[D.N=78]="N",D[D.O=79]="O",D[D.P=80]="P",D[D.Q=81]="Q",D[D.R=82]="R",D[D.S=83]="S",D[D.T=84]="T",D[D.U=85]="U",D[D.V=86]="V",D[D.W=87]="W",D[D.X=88]="X",D[D.Y=89]="Y",D[D.Z=90]="Z",D[D.META=91]="META",D[D.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",D[D.CONTEXT_MENU=93]="CONTEXT_MENU",D[D.NUM_ZERO=96]="NUM_ZERO",D[D.NUM_ONE=97]="NUM_ONE",D[D.NUM_TWO=98]="NUM_TWO",D[D.NUM_THREE=99]="NUM_THREE",D[D.NUM_FOUR=100]="NUM_FOUR",D[D.NUM_FIVE=101]="NUM_FIVE",D[D.NUM_SIX=102]="NUM_SIX",D[D.NUM_SEVEN=103]="NUM_SEVEN",D[D.NUM_EIGHT=104]="NUM_EIGHT",D[D.NUM_NINE=105]="NUM_NINE",D[D.NUM_MULTIPLY=106]="NUM_MULTIPLY",D[D.NUM_PLUS=107]="NUM_PLUS",D[D.NUM_MINUS=109]="NUM_MINUS",D[D.NUM_PERIOD=110]="NUM_PERIOD",D[D.NUM_DIVISION=111]="NUM_DIVISION",D[D.F1=112]="F1",D[D.F2=113]="F2",D[D.F3=114]="F3",D[D.F4=115]="F4",D[D.F5=116]="F5",D[D.F6=117]="F6",D[D.F7=118]="F7",D[D.F8=119]="F8",D[D.F9=120]="F9",D[D.F10=121]="F10",D[D.F11=122]="F11",D[D.F12=123]="F12",D[D.NUMLOCK=144]="NUMLOCK",D[D.SCROLL_LOCK=145]="SCROLL_LOCK",D[D.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",D[D.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",D[D.SEMICOLON=186]="SEMICOLON",D[D.DASH=189]="DASH",D[D.EQUALS=187]="EQUALS",D[D.COMMA=188]="COMMA",D[D.PERIOD=190]="PERIOD",D[D.SLASH=191]="SLASH",D[D.APOSTROPHE=192]="APOSTROPHE",D[D.TILDE=192]="TILDE",D[D.SINGLE_QUOTE=222]="SINGLE_QUOTE",D[D.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",D[D.BACKSLASH=220]="BACKSLASH",D[D.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",D[D.WIN_KEY=224]="WIN_KEY",D[D.MAC_FF_META=224]="MAC_FF_META",D[D.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",D[D.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",D[D.WIN_IME=229]="WIN_IME",D[D.VK_NONAME=252]="VK_NONAME",D[D.PHANTOM=255]="PHANTOM",{}),zu=(Wu.arc=fo,Wu.curve=co,Wu.line=go,Wu.lineOnAxis=d,Wu.lineTo=po,Wu.moveBy=ho,Wu.moveTo=uo,Wu.point=u,{}),A=(zu.Coordinate=E,zu.KeyCodes=n,zu.Rect=C,zu.Size=I,zu.Svg=k,zu.aria=w,zu.array=Ya,zu.browserEvents=ya,zu.colour=Xc,zu.deprecation=S,zu.dom=$a,zu.extensions=ju,zu.idGenerator=Ks,zu.math=pc,zu.object=Ua,zu.parsing=qc,zu.string=lc,zu.style=el,zu.svgMath=i,zu.svgPaths=Wu,zu.toolbox=gl,zu.userAgent=ma,zu.xml=Ka,class{constructor(e,t){if(this.type=t,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,(this.sourceBlock_=e).id.includes("_connection"))throw Error("Connection ID indicator is contained in block ID. This will cause "+`problems with focus: ${e.id}.`);this.id=e.id+"_connection_"+Ss()}connect_(e){var t,i,n=v.INPUT_VALUE,o=this.getSourceBlock(),r=e.getSourceBlock();e.isConnected()&&e.disconnectInternal(!1);let s;this.isConnected()&&(t=this.stashShadowState(),(i=this.targetBlock()).isShadow()?i.dispose(!1):(this.disconnectInternal(),s=i),this.applyShadowState(t));let a;U()&&(a=new(f(_.BLOCK_MOVE))(r)).setReason(["connect"]),mo(this,e),r.setParent(o),a&&(a.recordNew(),g(a)),s&&(e=this.type===n?s.outputConnection:s.previousConnection)&&((r=A.getConnectionForOrphanedConnection(r,e))?e.connect(r):e.onFailedConnect(this))}dispose(){var e;this.isConnected()&&(this.isSuperior()&&this.setShadowStateInternal(),e=this.targetBlock())&&!e.isDeadOrDying()&&e.unplug(),this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===v.INPUT_VALUE||this.type===v.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(e){}connect(e){var t;return this.targetConnection===e||(this.getConnectionChecker().canConnect(this,e,!1)&&((t=m.getGroup$$module$build$src$core$events$utils())||m.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(e):e.connect_(this),m.setGroup$$module$build$src$core$events$utils(t)),this.isConnected())}disconnect(){this.disconnectInternal()}disconnectInternal(e=!0){var{parentConnection:t,childConnection:i}=this.getParentAndChildConnections();if(!t||!i)throw Error("Source connection not connected.");var n=m.getGroup$$module$build$src$core$events$utils();n||m.setGroup$$module$build$src$core$events$utils(!0);let o;U()&&(o=new(f(_.BLOCK_MOVE))(i.getSourceBlock())).setReason(["disconnect"]);var r=this.targetConnection;r&&(r.targetConnection=null),this.targetConnection=null,e&&i.getSourceBlock().setParent(null),o&&(o.recordNew(),g(o)),i.getSourceBlock().isShadow()||t.respawnShadow_(),m.setGroup$$module$build$src$core$events$utils(n)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(e,t){var i;return!(this.getSourceBlock().isDeadOrDying()||(t=null==(i=e.getInput(t))?void 0:i.connection,(i=this.targetBlock())&&i!==e)||!t||t.targetConnection===this||(t.isConnected()&&t.disconnect(),t.connect(this),0))}targetBlock(){var e;return this.isConnected()&&null!=(e=null==(e=this.targetConnection)?void 0:e.getSourceBlock())?e:null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return e?(Array.isArray(e)||(e=[e]),this.check=e,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(e){this.setShadowStateInternal({shadowDom:e})}getShadowDom(e){return e&&this.targetBlock().isShadow()?Dn(this.targetBlock()):this.shadowDom}setShadowState(e){this.setShadowStateInternal({shadowState:e})}getShadowState(e){return e&&this.targetBlock()&&this.targetBlock().isShadow()?$t(this.targetBlock()):this.shadowState}neighbours(e){return[]}getParentInput(){let t=null;var i=this.sourceBlock_.inputList;for(let e=0;e<i.length;e++)if(i[e].connection===this){t=i[e];break}return t}toString(){var i=this.sourceBlock_;if(!i)return"Orphan Connection";if(i.outputConnection===this)var n="Output Connection of ";else if(i.previousConnection===this)n="Previous Connection of ";else if(i.nextConnection===this)n="Next Connection of ";else{n=null;for(let e=0,t;t=i.inputList[e];e++)if(t.connection===this){n=t;break}if(!n)return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection";n='Input "'+n.name+'" connection on '}return n+i.toDevString()}stashShadowState(){var e=this.getShadowDom(!0),t=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:e,shadowState:t}}applyShadowState({shadowDom:e,shadowState:t}){this.shadowDom=e,this.shadowState=t}setShadowStateInternal({shadowDom:e=null,shadowState:t=null}={}){this.shadowDom=e,this.shadowState=t,this.getSourceBlock().isDeadOrDying()||((e=this.targetBlock())?e.isShadow()?(e.dispose(!1),this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())):(e=this.createShadowBlock(!1),this.serializeShadow(e),e&&e.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock())))}createShadowBlock(e){var t=this.getSourceBlock(),i=this.getShadowState(),n=this.getShadowDom();if(!t.isDeadOrDying()&&(i||n)){if(i)return zt(i,t.workspace,{parentConnection:e?this:void 0,isShadow:!0,recordUndo:!1});if(n){if(t=Bn(n,t.workspace),e)if(this.type===v.INPUT_VALUE){if(!t.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(t.outputConnection))throw Error("Could not connect shadow block to connection")}else{if(this.type!==v.NEXT_STATEMENT)throw Error("Cannot connect a shadow block to a previous/output connection");if(!t.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(t.previousConnection))throw Error("Could not connect shadow block to connection")}return t}}return null}serializeShadow(e){e&&(this.shadowDom=Dn(e),this.shadowState=$t(e))}static getConnectionForOrphanedConnection(e,t){if(t.type===v.OUTPUT_VALUE)return _o(e,t.getSourceBlock());e=e.lastConnectionInStack(!0);var i=t.getConnectionChecker();return e&&i.canConnect(t,e,!1)?e:null}}),Yu=(A.CAN_CONNECT=0,A.REASON_SELF_CONNECTION=1,A.REASON_WRONG_TYPE=2,A.REASON_TARGET_NULL=3,A.REASON_CHECKS_FAILED=4,A.REASON_DIFFERENT_WORKSPACES=5,A.REASON_SHADOW_PARENT=6,A.REASON_DRAG_CHECKS_FAILED=7,A.REASON_PREVIOUS_AND_OUTPUT=8,class extends Error{constructor(e){super(`Tried to append an icon of type ${e.getType()} when an icon of `+"that type already exists on the block. Use getIcon to access the existing icon."),this.icon=e}}),Ku={},Xu=(Ku.DuplicateIconType=Yu,(Jh=m.Align$$module$build$src$core$inputs$align||(m.Align$$module$build$src$core$inputs$align={}))[Jh.LEFT=-1]="LEFT",Jh[Jh.CENTRE=0]="CENTRE",Jh[Jh.RIGHT=1]="RIGHT",m.Align$$module$build$src$core$inputs$align,class extends x{constructor(e,t,i){super(x.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,e!==x.SKIP_SETUP&&(i?this.configure_(i):this.class=t||null,this.setValue(e))}configure_(e){super.configure_(e),e.class&&(this.class=e.class)}initView(){this.createTextElement_(),this.class&&c(this.getTextElement(),this.class),this.fieldGroup_&&c(this.fieldGroup_,"blocklyLabelField")}doClassValidation_(e){return null==e?null:""+e}setClass(e){this.textElement_&&(this.class&&s(this.textElement_,this.class),e)&&c(this.textElement_,e),this.class=e}static fromJson(e){return new this(on(e.text),void 0,e)}}),qu=(Jd("field_label",Xu),Xu.prototype.DEFAULT_VALUE="",[]),Ju=(qu[v.INPUT_VALUE]=v.OUTPUT_VALUE,qu[v.OUTPUT_VALUE]=v.INPUT_VALUE,qu[v.NEXT_STATEMENT]=v.PREVIOUS_STATEMENT,qu[v.PREVIOUS_STATEMENT]=v.NEXT_STATEMENT,"RENAME_VARIABLE_ID"),Zu="DELETE_VARIABLE_ID",Qu=class extends A{constructor(e,t){super(e,t),this.highlighted=!1,this.targetConnection=null,this.db=e.workspace.connectionDBList[t],this.dbOpposite=e.workspace.connectionDBList[qu[t]],this.offsetInBlock=new E(0,0),this.trackedState=Qu.TrackedState.WILL_TRACK}dispose(){var e,t;super.dispose(),this.trackedState===Qu.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),null!=(t=(e=this.sourceBlock_.pathObject).removeConnectionHighlight)&&t.call(e,this)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(e){var t=this.x-e.x;return e=this.y-e.y,Math.sqrt(t*t+e*e)}bumpAwayFrom(e,t=!1){if(!this.sourceBlock_.workspace.isDragging()){var i=m.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random()),n=m.config$$module$build$src$core$config.snapRadius+Math.floor(10*Math.random()),o=e.sourceBlock_.getRootBlock(),r=this.sourceBlock_.getRootBlock();if(!o.isInFlyout&&!r.isInFlyout){var s=!0;if(r.isMovable())o.isMovable()&&t&&(n=-n);else{if(!o.isMovable())return;s=!1,i=-i,n=-n}(o=s?r:o).RTL&&(i=-i),o.moveBy((t=s?e:this).x+i-(e=s?this:e).x,t.y+n-e.y,["bump"])}}}moveTo(e,t){let i=!1;return this.trackedState===Qu.TrackedState.WILL_TRACK?(this.db.addConnection(this,t),this.trackedState=Qu.TrackedState.TRACKED,i=!0):this.trackedState===Qu.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,t),i=!0),this.x=e,this.y=t,i}moveBy(e,t){return this.moveTo(this.x+e,this.y+t)}moveToOffset(e){return this.moveTo(e.x+this.offsetInBlock.x,e.y+this.offsetInBlock.y)}setOffsetInBlock(e,t){this.offsetInBlock.x=e,this.offsetInBlock.y=t}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var e=this.targetConnection,t=this.targetBlock();e&&t&&(e=E.difference(this.offsetInBlock,e.offsetInBlock),t.translate(e.x,e.y))}closest(e,t){return this.dbOpposite.searchForClosest(this,e,t)}highlight(){this.highlighted=!0;var e=this.findHighlightSvg();e&&(e.style.display="")}unhighlight(){this.highlighted=!1;var e=this.findHighlightSvg();e&&(e.style.display="none")}isHighlighted(){return this.highlighted}setTracking(e){e&&this.trackedState===Qu.TrackedState.TRACKED||!e&&this.trackedState===Qu.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(e?(this.db.addConnection(this,this.y),this.trackedState=Qu.TrackedState.TRACKED):(this.trackedState===Qu.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=Qu.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){var t=this.targetBlock().getDescendants(!1);for(let e=0;e<t.length;e++){var i,n=t[e],o=n.getConnections_(!0);for(let e=0;e<o.length;e++)o[e].setTracking(!1);for(i of n.getIcons())ri(i)&&i.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let i=[];if(this.type===v.INPUT_VALUE||this.type===v.NEXT_STATEMENT){var e=this.targetBlock();if(e){let t;e.isCollapsed()?(t=[],e.outputConnection&&t.push(e.outputConnection),e.nextConnection&&t.push(e.nextConnection),e.previousConnection&&t.push(e.previousConnection)):t=e.getConnections_(!0);for(let e=0;e<t.length;e++)i.push(...t[e].startTrackingAll());i.length||(i=[e])}}return i}onFailedConnect(t){let i=this.getSourceBlock();if(Ia){let e=m.getGroup$$module$build$src$core$events$utils();setTimeout(function(){i.isDisposed()||i.getParent()||(m.setGroup$$module$build$src$core$events$utils(e),this.bumpAwayFrom(t),m.setGroup$$module$build$src$core$events$utils(!1))}.bind(this),m.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(e=!0){var t,{parentConnection:i,childConnection:n}=this.getParentAndChildConnections();i&&n&&((t=m.getGroup$$module$build$src$core$events$utils())||m.setGroup$$module$build$src$core$events$utils(!0),i=i.getSourceBlock(),n=n.getSourceBlock(),super.disconnectInternal(e),i.queueRender(),n.updateDisabled(),n.queueRender(),n.getSvgRoot().style.display="block",m.setGroup$$module$build$src$core$events$utils(t))}respawnShadow_(){super.respawnShadow_();var e=this.targetBlock();e&&(e.initSvg(),e.queueRender())}neighbours(e){return this.dbOpposite.getNeighbours(this,e)}connect_(e){super.connect_(e);var t=this.getSourceBlock();e=e.getSourceBlock(),t.updateDisabled(),e.updateDisabled(),e.queueRender(),(t=t.getInputWithBlock(e))&&(t=t.isVisible(),e.getSvgRoot().style.display=t?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(e){return super.setCheck(e),this.sourceBlock_.queueRender(),this}showContextMenu(e){var t,i,n,o=R.registry.getContextMenuOptions({focusedNode:this},e);o.length&&(i=(t=this.getSourceBlock()).workspace,n=e instanceof PointerEvent?new E(e.clientX,e.clientY):(n=new E(this.x,this.y),Ne(i,n).translate(t.RTL?-5:5,5)),yn(e,o,t.RTL,i,n))}getFocusableElement(){var e=this.findHighlightSvg();if(e)return e;throw Error("No highlight SVG found corresponding to this connection.")}getFocusableTree(){return this.getSourceBlock().workspace}onNodeFocus(){this.highlight()}onNodeBlur(){this.unhighlight()}canBeFocused(){return!0}findHighlightSvg(){return document.getElementById(this.id)}},ed=((cp=(cp=Qu=Qu||{}).TrackedState||(cp.TrackedState={}))[cp.WILL_TRACK=-1]="WILL_TRACK",cp[cp.UNTRACKED=0]="UNTRACKED",cp[cp.TRACKED=1]="TRACKED",Qu.TrackedState,class{constructor(e,t){this.name=e,this.sourceBlock=t,this.fieldRow=[],this.align=m.Align$$module$build$src$core$inputs$align.LEFT,this.visible=!0,this.type=m.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(e,t){return this.insertFieldAt(this.fieldRow.length,e,t),this}insertFieldAt(e,t,i){if(e<0||e>this.fieldRow.length)throw Error("index "+e+" out of bounds.");return(t||""===t&&i)&&((t="string"==typeof t?m.fromJson$$module$build$src$core$field_registry({type:"field_label",text:t}):t).setSourceBlock(this.sourceBlock),this.sourceBlock.initialized&&this.initField(t),t.name=i,t.setVisible(this.isVisible()),t.prefixField&&(e=this.insertFieldAt(e,t.prefixField)),this.fieldRow.splice(e,0,t),e++,t.suffixField&&(e=this.insertFieldAt(e,t.suffixField)),this.sourceBlock.rendered)&&this.sourceBlock.queueRender(),e}removeField(i,e){for(let e=0,t;t=this.fieldRow[e];e++)if(t.name===i)return t.dispose(),this.fieldRow.splice(e,1),this.sourceBlock.rendered&&this.sourceBlock.queueRender(),!0;if(e)return!1;throw Error('Field "'+i+'" not found.')}isVisible(){return this.visible}setVisible(i){let e=[];if(this.visible!==i){this.visible=i;for(let e=0,t;t=this.fieldRow[e];e++)t.setVisible(i);var t;this.connection&&this.connection instanceof Qu&&(i?e=this.connection.startTrackingAll():this.connection.stopTrackingAll(),t=this.connection.targetBlock())&&(t.getSvgRoot().style.display=i?"block":"none")}return e}markDirty(){for(let e=0,t;t=this.fieldRow[e];e++)t.markDirty()}setCheck(e){if(this.connection)return this.connection.setCheck(e),this;throw Error("This input does not have a connection.")}setAlign(e){return this.align=e,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(e){if(this.connection)return this.connection.setShadowDom(e),this;throw Error("This input does not have a connection.")}getShadowDom(){if(this.connection)return this.connection.getShadowDom();throw Error("This input does not have a connection.")}init(){for(var e of this.fieldRow)e.init()}initModel(){for(var e of this.fieldRow)e.initModel()}initField(e){this.sourceBlock.rendered?e.init():e.initModel()}dispose(){for(let e=0,t;t=this.fieldRow[e];e++)t.dispose();this.connection&&this.connection.dispose()}makeConnection(e){return this.sourceBlock.makeConnection_(e)}}),td=class extends ed{constructor(e,t){super(e,t),this.name=e,this.type=m.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},id=class extends ed{constructor(e,t){super(e,t),this.name=e,this.type=m.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},nd=class extends ed{constructor(e,t){if(!e)throw Error("Statement inputs must have a non-empty name");super(e,t),this.name=e,this.type=m.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(v.NEXT_STATEMENT)}},od=(m.ValueInput$$module$build$src$core$inputs$value_input=class extends ed{constructor(e,t){if(!e)throw Error("Value inputs must have a non-empty name");super(e,t),this.name=e,this.type=m.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(v.INPUT_VALUE)}},m.ValueInput$$module$build$src$core$inputs$value_input,class{constructor(e,t,i){if(this.data=null,this.disposed=!1,this.hue=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabledReasons=new Set,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable=this.movable=this.deletable=!0,this.collapsed_=this.shadow=!1,this.outputShape_=null,this.rendered=this.isInsertionMarker_=this.initialized=this.disposing=!1,this.onchangeWrapper=this.helpUrl=null,this.statementInputCount=0,this.workspace=e,this.id=i&&!e.getBlockById(i)?i:xs(),e.setBlockById(this.id,this),this.xy=new E(0,0),this.isInFlyout=e.isFlyout,this.isInMutator=e.isMutator,this.RTL=e.RTL,t){if(this.type=t,!(i=Hs[t])||"object"!=typeof i)throw TypeError("Invalid block definition for type: "+t);Object.assign(this,i)}e.addTopBlock(this),e.addTypedBlock(this),new.target===od&&this.doInit_()}doInit_(){var e=m.getGroup$$module$build$src$core$events$utils(),t=(e||m.setGroup$$module$build$src$core$events$utils(!0),Ia);try{"function"==typeof this.init&&(m.setRecordUndo$$module$build$src$core$events$utils(!1),this.init(),m.setRecordUndo$$module$build$src$core$events$utils(t)),U()&&g(new(f(_.BLOCK_CREATE))(this))}finally{m.setGroup$$module$build$src$core$events$utils(e),m.setRecordUndo$$module$build$src$core$events$utils(t)}this.inputsInlineDefault=this.inputsInline,"function"==typeof this.onchange&&this.setOnChange(this.onchange)}dispose(e=!1){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.unplug(e),U()&&g(new(f(_.BLOCK_DELETE))(this)),this.workspace.removeTopBlock(this),this.disposeInternal()}disposeInternal(){this.disposing=!0,this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),"function"==typeof this.destroy&&this.destroy(),this.childBlocks_.forEach(e=>e.disposeInternal()),this.inputList.forEach(e=>e.dispose()),this.inputList.length=0,this.getConnections_(!0).forEach(e=>e.dispose()),this.disposed=!0}isDeadOrDying(){return this.disposing||this.disposed}initModel(){if(!this.initialized){for(var e of this.inputList)e.initModel();this.initialized=!0}}unplug(e){this.outputConnection&&this.unplugFromRow(e),this.previousConnection&&this.unplugFromStack(e)}unplugFromRow(e){let t=null,i;null!=(i=this.outputConnection)&&i.isConnected()&&(t=this.outputConnection.targetConnection,this.outputConnection.disconnect()),t&&(e=e&&this.getOnlyValueConnection())&&e.isConnected()&&!e.targetBlock().isShadow()&&(null!=(e=e.targetConnection)&&e.disconnect(),this.workspace.connectionChecker.canConnect(e,t,!1)?t.connect(e):null!=e&&e.onFailedConnect(t))}getOnlyValueConnection(){let t=null;for(let e=0;e<this.inputList.length;e++){var i=this.inputList[e].connection;if(i&&i.type===v.INPUT_VALUE&&i.targetConnection){if(t)return null;t=i}}return t}unplugFromStack(e){let t=null;var i;null!=(i=this.previousConnection)&&i.isConnected()&&(t=this.previousConnection.targetConnection,this.previousConnection.disconnect()),i=this.getNextBlock(),e&&i&&!i.isShadow()&&(null!=(e=null!=(i=null==(i=this.nextConnection)?void 0:i.targetConnection)?i:null)&&e.disconnect(),t)&&this.workspace.connectionChecker.canConnect(t,e,!1)&&t.connect(e)}getConnections_(i){i=[],this.outputConnection&&i.push(this.outputConnection),this.previousConnection&&i.push(this.previousConnection),this.nextConnection&&i.push(this.nextConnection);for(let e=0,t;t=this.inputList[e];e++)t.connection&&i.push(t.connection);return i}lastConnectionInStack(e){let t=this.nextConnection;for(;t;){var i=t.targetBlock();if(!i||e&&i.isShadow())return t;t=i.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(i){for(let e=0,t;t=this.inputList[e];e++)if(t.connection&&t.connection.targetBlock()===i)return t;return null}getSurroundParent(){let e=this,t;do{if(!(e=(t=e).getParent()))return null}while(e.getNextBlock()===t);return e}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let e,t=this;for(;t=(e=t).parentBlock_;);return e}getTopStackBlock(){let e=this,t;for(;(t=e.getPreviousBlock())&&t.getNextBlock()===e&&(e=t););return e}getChildren(i){if(!i)return this.childBlocks_;i=[];for(let e=0,t;t=this.inputList[e];e++){var n;t.connection&&(n=t.connection.targetBlock())&&i.push(n)}return(n=this.getNextBlock())&&i.push(n),i}setParent(e){if(e!==this.parentBlock_){var t=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),i=!!t;if(i&&e&&t!==e)throw Error("Block connected to superior one that is not new parent.");if(!i&&e)throw Error("Block not connected to new parent.");if(i&&!e)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?me(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=e)?e.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(i){var n=[this],o=this.getChildren(i);for(let e,t=0;e=o[t];t++)n.push(...e.getDescendants(i));return n}isDeletable(){return this.deletable&&!this.isInFlyout&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnDeletable(){return this.deletable}setDeletable(e){this.deletable=e}isMovable(){return this.movable&&!this.isInFlyout&&!this.shadow&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnMovable(){return this.movable}setMovable(e){this.movable=e}isDuplicatable(){return!this.workspace.hasBlockLimits()||this.workspace.isCapacityAvailable(he(this,!0))}isShadow(){return this.shadow}setShadow(e){this.shadow=e}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(e){this.isInsertionMarker_=e}isEditable(){return this.editable&&!this.isDeadOrDying()&&!this.workspace.isReadOnly()}isOwnEditable(){return this.editable}setEditable(e){this.editable=e;for(var t of this.getFields())t.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(var e of this.inputList)if(e.connection||1<e.fieldRow.length)return!1;return!0}getMatchingConnection(t,i){var n=this.getConnections_(!0);if(t=t.getConnections_(!0),n.length!==t.length)throw Error("Connection lists did not match in length.");for(let e=0;e<t.length;e++)if(t[e]===i)return n[e];return null}setHelpUrl(e){this.helpUrl=e}setTooltip(e){this.tooltip=e}getTooltip(){return Li(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue}setColour(e){e=rn(e),this.hue=e.hue,this.colour_=e.hex}setStyle(e){this.styleName_=e}setOnChange(e){if(e&&"function"!=typeof e)throw Error("onchange must be a function.");this.onchangeWrapper&&this.workspace.removeChangeListener(this.onchangeWrapper),this.onchange=e,this.onchangeWrapper=e.bind(this),this.workspace.addChangeListener(this.onchangeWrapper)}getField(e){if("string"!=typeof e)throw TypeError("Block.prototype.getField expects a string with the field name but received "+(void 0===e?"nothing":e+" of type "+typeof e)+" instead");for(var t of this.getFields())if(t.name===e)return t;return null}*getFields(){for(var e of this.inputList)for(var t of e.fieldRow)yield t}getVars(){var e,t=[];for(e of this.getFields())e.referencesVariables()&&t.push(e.getValue());return t}getVarModels(){var e,t,i=[];for(e of this.getFields())e.referencesVariables()&&(t=this.workspace.getVariableById(e.getValue()))&&i.push(t);return i}updateVarName(e){for(var t of this.getFields())t.referencesVariables()&&e.getId()===t.getValue()&&t.refreshVariableName()}renameVarById(e,t){for(var i of this.getFields())i.referencesVariables()&&e===i.getValue()&&i.setValue(t)}getFieldValue(e){return(e=this.getField(e))?e.getValue():null}setFieldValue(e,t){var i=this.getField(t);if(!i)throw Error('Field "'+t+'" not found.');i.setValue(e)}setPreviousStatement(e,t){if(e)void 0===t&&(t=null),this.previousConnection||(this.previousConnection=this.makeConnection_(v.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(t);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(e,t){if(e)void 0===t&&(t=null),this.nextConnection||(this.nextConnection=this.makeConnection_(v.NEXT_STATEMENT)),this.nextConnection.setCheck(t);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(e,t){if(e)void 0===t&&(t=null),this.outputConnection||(this.outputConnection=this.makeConnection_(v.OUTPUT_VALUE)),this.outputConnection.setCheck(t);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(e){this.inputsInline!==e&&(g(new(f(_.BLOCK_CHANGE))(this,"inline",null,this.inputsInline,e)),this.inputsInline=e)}getInputsInline(){if(void 0!==this.inputsInline)return this.inputsInline;for(var e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof td&&this.inputList[e]instanceof td)return!1;for(e=1;e<this.inputList.length;e++)if(this.inputList[e-1]instanceof m.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[e]instanceof td)return!0;for(e=0;e<this.inputList.length;e++)if(this.inputList[e]instanceof id)return!0;return!1}setOutputShape(e){this.outputShape_=e}getOutputShape(){return this.outputShape_}isEnabled(){return 0===this.disabledReasons.size}setDisabledReason(e,t){e||this.workspace.options.disable||!this.hasDisabledReason(xl)||t==xl||this.setDisabledReason(!1,xl),this.disabledReasons.has(t)!==e&&(e?this.disabledReasons.add(t):this.disabledReasons.delete(t),(e=new(f(_.BLOCK_CHANGE))(this,"disabled",null,!e,e)).setDisabledReason(t),g(e))}getInheritedDisabled(){let e=this.getSurroundParent();for(;e;){if(!e.isEnabled())return!0;e=e.getSurroundParent()}return!1}hasDisabledReason(e){return this.disabledReasons.has(e)}getDisabledReasons(){return this.disabledReasons}isCollapsed(){return this.collapsed_}setCollapsed(e){this.collapsed_!==e&&(g(new(f(_.BLOCK_CHANGE))(this,"collapsed",null,this.collapsed_,e)),this.collapsed_=e)}toString(e,t){t=this.toTokens(t);for(let e=2;e<t.length;e++)"("===t[e-2]&&")"===t[e]&&(t[e-2]=t[e-1],t.splice(e-1,2));let i="";return t=(t=t.reduce((e,t)=>(e=e+("("===i||")"===t?"":" ")+t,i=t[t.length-1],e),"")).trim()||"???",t=e&&t.length>e?t.substring(0,e-3)+"...":t}toTokens(t="?"){var i,n=[];for(i of this.inputList)if(i.name!=wl){for(var e of i.fieldRow)n.push(e.getText());if(i.connection){var o=i.connection.targetBlock();if(o){var r=i.connection;let e=r.getCheck();(r=!!(e=!e&&r.targetConnection?r.targetConnection.getCheck():e)&&(e.includes("Boolean")||e.includes("Number")))&&n.push("("),n.push(...o.toTokens(t)),r&&n.push(")")}else n.push(t)}}return n}appendValueInput(e){return this.appendInput(new m.ValueInput$$module$build$src$core$inputs$value_input(e,this))}appendStatementInput(e){return this.statementInputCount++,this.appendInput(new nd(e,this))}appendDummyInput(e=""){return this.appendInput(new td(e,this))}appendEndRowInput(e=""){return this.appendInput(new id(e,this))}appendInput(e){return this.inputList.push(e),e}appendInputFromRegistry(e,t){return(e=hs(b.INPUT,e,!1))?this.appendInput(new e(t,this)):null}jsonInit(e){var t=e.type?'Block "'+e.type+'": ':"";if(e.output&&e.previousStatement)throw Error(t+"Must not have both an output and a previousStatement.");for(var i=0;e["args"+i];){if(void 0===e["message"+i])throw Error(t+`args${i} must have a corresponding message (message${i}).`);i++}if(e.style&&e.style.hat&&(this.hat=e.style.hat,e.style=null),e.style&&e.colour)throw Error(t+"Must not have both a colour and a style.");for(e.style?this.jsonInitStyle(e,t):this.jsonInitColour(e,t),i=0;void 0!==e["message"+i];)this.interpolate(e["message"+i],e["args"+i]||[],e["implicitAlign"+i]||e["lastDummyAlign"+i],t),i++;if(void 0!==e.inputsInline&&(m.disable$$module$build$src$core$events$utils(),this.setInputsInline(e.inputsInline),m.enable$$module$build$src$core$events$utils()),void 0!==e.output&&this.setOutput(!0,e.output),void 0!==e.outputShape&&this.setOutputShape(e.outputShape),void 0!==e.previousStatement&&this.setPreviousStatement(!0,e.previousStatement),void 0!==e.nextStatement&&this.setNextStatement(!0,e.nextStatement),void 0!==e.tooltip&&(i=on(e.tooltip),this.setTooltip(i)),void 0!==e.enableContextMenu&&(this.contextMenu=!!e.enableContextMenu),void 0!==e.suppressPrefixSuffix&&(this.suppressPrefixSuffix=!!e.suppressPrefixSuffix),void 0!==e.helpUrl&&(i=on(e.helpUrl),this.setHelpUrl(i)),"string"==typeof e.extensions&&(console.warn(t+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+e.type+"' block."),e.extensions=[e.extensions]),void 0!==e.mutator&&Qn(e.mutator,this,!0),e=e.extensions,Array.isArray(e))for(t=0;t<e.length;t++)Qn(e[t],this,!1)}jsonInitColour(t,i){if("colour"in t)if(void 0===t.colour)console.warn(i+"Undefined colour value.");else{t=t.colour;try{this.setColour(t)}catch(e){console.warn(i+"Illegal colour value: ",t)}}}jsonInitStyle(t,i){t=t.style;try{this.setStyle(t)}catch(e){console.warn(i+"Style does not exist: ",t)}}mixin(e,t){if(void 0!==t&&"boolean"!=typeof t)throw Error("opt_disableCheck must be a boolean if provided");if(!t){for(var i in t=[],e)void 0!==this[i]&&t.push(i);if(t.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(t))}Object.assign(this,e)}interpolate(i,n,o,r){i=nn(i),this.validateTokens(i,n.length),n=this.interpolateArguments(i,n,o),o=[];for(let e=0,t;t=n[e];e++)if(this.isInputKeyword(t.type)){if(i=this.inputFromJson(t,r)){for(let e=0,t;t=o[e];e++)i.appendField(t[0],t[1]);o.length=0}}else(i=this.fieldFromJson(t))&&o.push([i,t.name])}validateTokens(t,i){var n=[];let o=0;for(let e=0;e<t.length;e++){var r=t[e];if("number"==typeof r){if(r<1||i<r)throw Error('Block "'+this.type+'": Message index %'+r+" out of range.");if(n[r])throw Error('Block "'+this.type+'": Message index %'+r+" duplicated.");n[r]=!0,o++}}if(o!==i)throw Error('Block "'+this.type+'": Message does not reference all '+i+" arg(s).")}interpolateArguments(t,i,n){var o=[];for(let e=0;e<t.length;e++){var r=t[e];if("string"==typeof(r="number"==typeof r?i[r-1]:r))if("\n"===r)r={type:"input_end_row"},n&&(r.align=n);else if(!(r=this.stringToFieldJson(r)))continue;o.push(r)}return(t=o.length)&&!this.isInputKeyword(o[t-1].type)&&(t={type:"input_dummy"},n&&(t.align=n),o.push(t)),o}fieldFromJson(e){var t=m.fromJson$$module$build$src$core$field_registry(e);return!t&&e.alt?"string"==typeof e.alt?(e=this.stringToFieldJson(e.alt))?this.fieldFromJson(e):null:this.fieldFromJson(e.alt):t}inputFromJson(e,t){let i={LEFT:m.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:m.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:m.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:m.Align$$module$build$src$core$inputs$align.CENTRE},n;switch(e.type){case"input_value":n=this.appendValueInput(e.name);break;case"input_statement":n=this.appendStatementInput(e.name);break;case"input_dummy":n=this.appendDummyInput(e.name);break;case"input_end_row":n=this.appendEndRowInput(e.name);break;default:n=this.appendInputFromRegistry(e.type,e.name)}return n?(e.check&&n.setCheck(e.check),e.align&&(void 0===(i=i[e.align.toUpperCase()])?console.warn(t+"Illegal align value: ",e.align):n.setAlign(i)),n):null}isInputKeyword(e){return"input_value"===e||"input_statement"===e||"input_dummy"===e||"input_end_row"===e||ds(b.INPUT,e)}stringToFieldJson(e){return(e=e.trim())?{type:"field_label",text:e}:null}moveInputBefore(i,n){if(i!==n){var o=-1,r=n?-1:this.inputList.length;for(let e=0,t;t=this.inputList[e];e++)if(t.name===i){if(o=e,-1!==r)break}else if(n&&t.name===n&&(r=e,-1!==o))break;if(-1===o)throw Error('Named input "'+i+'" not found.');if(-1===r)throw Error('Reference input "'+n+'" not found.');this.moveNumberedInputBefore(o,r)}}moveNumberedInputBefore(e,t){if(e===t)throw Error("Can't move input to itself.");if(e>=this.inputList.length)throw RangeError("Input index "+e+" out of bounds.");if(t>this.inputList.length)throw RangeError("Reference input "+t+" out of bounds.");var i=this.inputList[e];this.inputList.splice(e,1),e<t&&t--,this.inputList.splice(t,0,i)}removeInput(i,e){for(let e=0,t;t=this.inputList[e];e++)if(t.name===i)return t instanceof nd&&this.statementInputCount--,t.dispose(),this.inputList.splice(e,1),!0;if(e)return!1;throw Error("Input not found: "+i)}getInput(i){for(let e=0,t;t=this.inputList[e];e++)if(t.name===i)return t;return null}getInputTargetBlock(e){return(e=this.getInput(e))&&e.connection&&e.connection.targetBlock()}getCommentText(){var e;return null!=(e=null==(e=this.getIcon(uc.COMMENT))?void 0:e.getText())?e:null}setCommentText(e){var t,i=null!=(i=null==(t=this.getIcon(uc.COMMENT))?void 0:t.getText())?i:null;if(i!==e){if(null!==e){if(!(t=this.getIcon(uc.COMMENT))){if(!(t=hs(b.ICON,uc.COMMENT.toString(),!1)))throw Error("No comment icon class is registered, so a comment cannot be set");if(t=new t(this),!vo(t))throw Error("The class registered as a comment icon does not conform to the ICommentIcon interface");t=this.addIcon(t)}m.disable$$module$build$src$core$events$utils(),t.setText(e),m.enable$$module$build$src$core$events$utils()}else this.removeIcon(uc.COMMENT);g(new(f(_.BLOCK_CHANGE))(this,"comment",null,i,e))}}setWarningText(e,t){}setMutator(e){}addIcon(e){if(this.hasIcon(e.getType()))throw new Yu(e);return this.icons.push(e),this.icons.sort((e,t)=>e.getWeight()-t.getWeight()),e}removeIcon(t){var e;return!!this.hasIcon(t)&&(null!=(e=this.getIcon(t))&&e.dispose(),this.icons=this.icons.filter(e=>!e.getType().equals(t)),!0)}hasIcon(t){return this.icons.some(e=>e.getType().equals(t))}getIcon(t){return t instanceof uc?this.icons.find(e=>e.getType().equals(t)):this.icons.find(e=>e.getType().toString()===t)}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy}moveBy(e,t,i){if(this.parentBlock_)throw Error("Block has parent");var n=new(f(_.BLOCK_MOVE))(this);i&&n.setReason(i),this.xy.translate(e,t),n.recordNew(),g(n)}makeConnection_(e){return new A(this,e)}allInputsFilled(i){if(!(i=void 0===i?!0:i)&&this.isShadow())return!1;for(let e=0,t;t=this.inputList[e];e++)if(t.connection){var n=t.connection.targetBlock();if(!n||!n.allInputsFilled(i))return!1}return!(n=this.getNextBlock())||n.allInputsFilled(i)}toDevString(){let e=this.type?'"'+this.type+'" block':"Block";return this.id&&(e+=' (id="'+this.id+'")'),e}}),rd=(od.COLLAPSED_INPUT_NAME=wl,od.COLLAPSED_FIELD_NAME=Sl,null),sd=null,ad={},ld=(ad.connectionUiEffect=ko,ad.disconnectUiEffect=Co,ad.disconnectUiStop=wo,ad.disposeUiEffect=To,class{paste(e,t,i){if(!t.isCapacityAvailable(e.typeCounts))return null;i&&(e.blockState.x=i.x,e.blockState.y=i.y),i=i||new E(e.blockState.x||0,e.blockState.y||0),m.disable$$module$build$src$core$events$utils();let n;try{n=Wt(e.blockState,t),So(n,i)}finally{m.enable$$module$build$src$core$events$utils()}if(n){U()&&!n.isShadow()&&g(new(f(_.BLOCK_CREATE))(n));let e=n;tt().then(()=>m.getFocusManager$$module$build$src$core$focus_manager().focusNode(e))}return n}}),cd=(up(ld.TYPE="block",new ld),{}),ud=(cd.bumpIntoBounds=Oo,cd.bumpIntoBoundsHandler=Ao,cd.bumpTopObjectsIntoBounds=Lo,class{constructor(e){this.block=e,this.connectionPreviewer=this.connectionCandidate=this.startLoc=this.startChildConn=this.startParentConn=null,this.dragging=!1,this.dragOffset=new E(0,0),this.originalEventGroup="",this.workspace=e.workspace}isMovable(){var e;return this.block.isShadow()?null!=(e=null==(e=this.block.getParent())?void 0:e.isMovable())&&e:this.block.isOwnMovable()&&!this.block.isDeadOrDying()&&!this.workspace.isReadOnly()&&!this.block.isInFlyout}startDrag(e){this.block.isShadow()?this.startDraggingShadow(e):(this.dragging=!0,this.fireDragStartEvent(),this.startLoc=this.block.getRelativeToSurfaceXY(),this.connectionCandidate=null,this.connectionPreviewer=new(fs(b.CONNECTION_PREVIEWER,this.workspace.options))(this.block),K(),this.workspace.setResizesEnabled(!1),wo(),e=this.shouldHealStack(e),this.shouldDisconnect(e)&&this.disconnectBlock(e),this.block.setDragging(!0),null!=(e=this.workspace.getLayerManager())&&e.moveToDragLayer(this.block))}shouldHealStack(e){return!!e&&(e.altKey||e.ctrlKey||e.metaKey)}startDraggingShadow(e){var t=this.block.getParent();if(!t)throw Error("Tried to drag a shadow block with no parent. Shadow blocks should always have parents.");this.dragOffset=E.difference(t.getRelativeToSurfaceXY(),this.block.getRelativeToSurfaceXY()),t.startDrag(e)}shouldDisconnect(e){return!!(this.block.getParent()||e&&this.block.nextConnection&&this.block.nextConnection.targetBlock())}disconnectBlock(e){var t;this.startParentConn=null!=(t=null==(t=this.block.outputConnection)?void 0:t.targetConnection)?t:null==(t=this.block.previousConnection)?void 0:t.targetConnection,e&&(this.startChildConn=null==(t=this.block.nextConnection)?void 0:t.targetConnection),this.block.unplug(e),Co(this.block)}fireDragStartEvent(){var e=new(f(_.BLOCK_DRAG))(this.block,!0,this.block.getDescendants(!1));g(e)}fireDragEndEvent(){var e=new(f(_.BLOCK_DRAG))(this.block,!1,this.block.getDescendants(!1));g(e)}fireMoveEvent(){var e;this.block.isDeadOrDying()||((e=new(f(_.BLOCK_MOVE))(this.block)).setReason(["drag"]),e.oldCoordinate=this.startLoc,e.recordNew(),g(e))}drag(e){var t;this.block.isShadow()?null!=(t=this.block.getParent())&&t.drag(E.sum(e,this.dragOffset)):(this.block.moveDuringDrag(e),this.updateConnectionPreview(this.block,E.difference(e,this.startLoc)))}updateConnectionPreview(e,t){var i,n,o=this.connectionCandidate,r=this.getConnectionCandidate(e,t);r?(this.connectionCandidate=t=o&&this.currCandidateIsBetter(o,t,r)?o:r,{local:r,neighbour:i}=t,t=r.type===v.OUTPUT_VALUE||r.type===v.PREVIOUS_STATEMENT,o=i.isConnected()&&!(null!=(n=i.targetBlock())&&n.isInsertionMarker()),t&&o&&!this.orphanCanConnectAtEnd(e,i.targetBlock(),r.type)?null!=(n=this.connectionPreviewer)&&n.previewReplacement(r,i,i.targetBlock()):null!=(t=this.connectionPreviewer)&&t.previewConnection(r,i)):(null!=(o=this.connectionPreviewer)&&o.hidePreview(),this.connectionCandidate=null)}orphanCanConnectAtEnd(e,t,i){return!!A.getConnectionForOrphanedConnection(e,i===v.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}currCandidateIsBetter(e,t,i){var{local:n,neighbour:o}=e,n=(e=new E(n.x,n.y),new E(o.x,o.y));return t=E.distance(E.sum(e,t),n),i.distance>t-m.config$$module$build$src$core$config.currentConnectionPreference}getConnectionCandidate(e,t){e=this.getLocalConnections(e);let i=this.getSearchRadius(),n=null;for(var o of e){var{connection:r,radius:s}=o.closest(i,t);r&&(n={local:o,neighbour:r,distance:s},i=s)}return n}getSearchRadius(){return this.connectionCandidate?m.config$$module$build$src$core$config.connectingSnapRadius:m.config$$module$build$src$core$config.snapRadius}getLocalConnections(e){var t=e.getConnections_(!1),i=e.lastConnectionInStack(!0);return i&&i!==e.nextConnection&&t.push(i),t}endDrag(e){var t;this.block.isShadow()?null!=(t=this.block.getParent())&&t.endDrag(e):(this.originalEventGroup=m.getGroup$$module$build$src$core$events$utils(),this.fireDragEndEvent(),this.fireMoveEvent(),X(),wo(),null!=(t=this.connectionPreviewer)&&t.hidePreview(),!this.block.isDeadOrDying()&&this.dragging&&(null!=(e=this.workspace.getLayerManager())&&e.moveOffDragLayer(this.block,50),this.block.setDragging(!1)),this.connectionCandidate?(this.applyConnections(this.connectionCandidate),this.disposeStep()):this.block.queueRender().then(()=>this.disposeStep()))}disposeStep(){var e,t=m.getGroup$$module$build$src$core$events$utils();m.setGroup$$module$build$src$core$events$utils(this.originalEventGroup),this.block.snapToGrid(),null!=(e=this.connectionPreviewer)&&e.dispose(),this.workspace.setResizesEnabled(!0),m.setGroup$$module$build$src$core$events$utils(t)}applyConnections(e){var{local:e,neighbour:t}=e;e.connect(t);let i=e.isSuperior()?t:e,n=this.block.getRootBlock();tt().then(()=>{ko(i.getSourceBlock()),setTimeout(()=>{n.bringToFront()},0)})}revertDrag(){if(this.block.isShadow())null!=(e=this.block.getParent())&&e.revertDrag();else{var e;if(null!=(e=this.connectionPreviewer)&&e.hidePreview(),(this.connectionCandidate=null)!=(e=this.startChildConn)&&e.connect(this.block.nextConnection),this.startParentConn)switch(this.startParentConn.type){case v.INPUT_VALUE:this.startParentConn.connect(this.block.outputConnection);break;case v.NEXT_STATEMENT:this.startParentConn.connect(this.block.previousConnection)}else this.block.moveTo(this.startLoc,["drag"]),null!=(e=this.workspace.getLayerManager())&&e.moveOffDragLayer(this.block,50),Oo(this.workspace,this.workspace.getMetricsManager().getScrollMetrics(!0),this.block);this.startParentConn=this.startChildConn=null,this.block.setDragging(!1),this.dragging=!1}}}),dd=class extends O{constructor(e,t,i,n){super(t,i,n),this.text=e,this.workspace=t,this.anchor=i,this.ownerRect=n,this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize(),c(this.svgRoot,"blocklyTextBubble")}getText(){return this.text}setText(e){this.text=e,a(this.paragraph),this.paragraph=this.stringToSvg(e,this.contentContainer),this.updateBubbleSize()}stringToSvg(e,t){return t=this.createParagraph(t),e=this.createTextFragments(t,e),this.workspace.RTL&&this.rightAlignTextFragments(t.getBBox().width,e),t}createParagraph(e){return l(k.G,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",transform:`translate(0,${O.BORDER_WIDTH})`,style:"direction: "+(this.workspace.RTL?"rtl":"ltr")},e)}createTextFragments(i,e){let n=1;return e.split("\n").map(e=>{var t=l(k.TEXT,{y:n+"em",x:O.BORDER_WIDTH},i);return e=document.createTextNode(e),t.appendChild(e),n+=1,t})}rightAlignTextFragments(e,t){for(var i of t)i.setAttribute("text-anchor","start"),i.setAttribute("x",""+(e+O.BORDER_WIDTH))}updateBubbleSize(){var e=this.paragraph.getBBox();this.setSize(new I(e.width+2*O.BORDER_WIDTH,e.height+2*O.BORDER_WIDTH),!0)}},hd=class extends Hu{constructor(e){super(e),this.sourceBlock=e,this.textMap=new Map,this.textBubble=null}getType(){return hd.TYPE}initView(e){this.svgRoot||(super.initView(e),l(k.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),l(k.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),l(k.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot),c(this.svgRoot,"blocklyWarningIcon"))}dispose(){var e;super.dispose(),null!=(e=this.textBubble)&&e.dispose()}getWeight(){return hd.WEIGHT}getSize(){return new I(17,17)}applyColour(){var e;super.applyColour(),null!=(e=this.textBubble)&&e.setColour(this.sourceBlock.getColour())}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(e){super.onLocationChange(e),null!=(e=this.textBubble)&&e.setAnchorLocation(this.getAnchorLocation())}addMessage(e,t){return this.textMap.get(t)!==e&&(e?this.textMap.set(t,e):this.textMap.delete(t),null!=(e=this.textBubble))&&e.setText(this.getText()),this}getText(){return[...this.textMap.values()].join("\n")}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(t){let i=this;return(0,h.asyncExecutePromiseGeneratorFunction)(function*(){var e;i.bubbleIsVisible()!==t&&(yield tt(),t?(i.textBubble=new dd(i.getText(),i.sourceBlock.workspace,i.getAnchorLocation(),i.getBubbleOwnerRect()),i.applyColour()):(null!=(e=i.textBubble)&&e.dispose(),i.textBubble=null),g(new(f(_.BUBBLE_OPEN))(i.sourceBlock,t,"warning")))})}getBubble(){return this.textBubble}getAnchorLocation(){return E.sum(this.workspaceLocation,new E(8.5,8.5))}getBubbleOwnerRect(){var e=this.sourceBlock.getSvgRoot().getBBox();return new C(e.y,e.y+e.height,e.x,e.x+e.width)}},N=(hd.TYPE=uc.WARNING,hd.WEIGHT=2,class extends od{constructor(e,t,i){if(super(e,t,i),this.childlessWidth=this.width=this.height=0,this.warningTextDb=new Map,this.mutator=null,this.rendered=!0,this.visuallyDisabled=!1,this.translation="",this.dragging=!1,this.relativeCoords=new E(0,0),this.dragStrategy=new ud(this),!e.rendered)throw TypeError("Cannot create a rendered block in a headless workspace");this.workspace=e,this.svgGroup=l(k.G,{}),t&&c(this.svgGroup,t),this.style=e.getRenderer().getConstants().getBlockStyle(null),this.pathObject=e.getRenderer().makePathObject(this.svgGroup,this.style),(e=this.pathObject.svgPath).tooltip=this,$i(e),this.svgGroup.setAttribute("data-id",this.id),e.id=Ss(),this.doInit_()}initSvg(){if(!this.initialized){for(var e of this.inputList)e.init();for(var t of this.getIcons())t.initView(this.createIconPointerDownListener(t)),t.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()||this.isInFlyout),(e=this.getSvgRoot())&&p(e,"pointerdown",this,this.onMouseDown),e.parentNode||this.workspace.getCanvas().appendChild(e),this.initialized=!0}}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){this.addSelect(),ce(this)}unselect(){this.removeSelect(),ce(null)}setParent(e){var t,i,n,o,r,s=this.parentBlock_;e!==s&&(K(),super.setParent(e),X(),t=this.getSvgRoot(),!this.workspace.isClearing)&&t&&(i=this.getRelativeToSurfaceXY(),n=m.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode(),r=this.getSvgRoot().contains(null!=(o=null==n?void 0:n.getFocusableElement())?o:null),e?(e.getSvgRoot().appendChild(t),r&&n&&m.getFocusManager$$module$build$src$core$focus_manager().focusNode(n)):s&&((null==(e=this.workspace.getCanvas().querySelector(".blocklyDragging"))?void 0:e.parentElement)===(o=this.workspace.getCanvas())?o.insertBefore(t,e):(o.appendChild(t),r&&n&&m.getFocusManager$$module$build$src$core$focus_manager().focusNode(n)),this.translate(i.x,i.y)),this.applyColour())}getRelativeToSurfaceXY(){var e=this.workspace.getLayerManager();if(!e)throw Error("Cannot calculate position because the workspace has not been appended");let t=0,i=0,n=this.getSvgRoot();if(n)do{var o=Se(n);t+=o.x,i+=o.y,n=n.parentNode}while(n&&!e.hasLayer(n));return new E(t,i)}moveBy(e,t,i){if(this.parentBlock_)throw Error("Block has parent");var n=U();let o=null;n&&(o=new(f(_.BLOCK_MOVE))(this),i)&&o.setReason(i),e=new E(e,t),t=this.getRelativeToSurfaceXY(),e=E.sum(t,e),this.translate(e.x,e.y),this.updateComponentLocations(e),n&&o&&(o.recordNew(),g(o)),this.workspace.resizeContents()}translate(e,t){this.translation=`translate(${e}, ${t})`,this.relativeCoords=new E(e,t),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(e,t){var i=this.getRelativeToSurfaceXY();this.moveBy(e.x-i.x,e.y-i.y,t)}moveDuringDrag(e){this.translate(e.x,e.y),this.getSvgRoot().setAttribute("transform",this.getTranslation()),this.updateComponentLocations(e)}snapToGrid(){var e,t;this.isDeadOrDying()||this.getParent()||this.isInFlyout||null!=(t=this.workspace.getGrid())&&t.shouldSnap()&&(e=this.getRelativeToSurfaceXY(),(t=t.alignXY(e))!==e)&&this.moveTo(t,["snap"])}getBoundingRectangle(){return this.getBoundingRectangleWithDimensions(this.getHeightWidth())}getBoundingRectangleWithoutChildren(){return this.getBoundingRectangleWithDimensions({height:this.height,width:this.childlessWidth})}getBoundingRectangleWithDimensions(e){var t=this.getRelativeToSurfaceXY();let i,n;return n=this.RTL?(i=t.x-e.width,t.x):(i=t.x,t.x+e.width),new C(t.y,t.y+e.height,i,n)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let e=0,t;t=this.inputList[e];e++)t.markDirty()}setCollapsed(e){this.collapsed_!==e&&(super.setCollapsed(e),this.updateCollapsed())}childHasWarning(){var e;for(e of this.getChildren(!1))if(e.getIcon(hd.TYPE)||e.childHasWarning())return!0;return!1}updateCollapsed(){var e,i=this.isCollapsed(),n=wl,t=Sl;for(let e=0,t;t=this.inputList[e];e++)t.name!==n&&t.setVisible(!i);for(e of this.getIcons())e.updateCollapsed();i?(c(this.svgGroup,"blocklyCollapsed"),this.childHasWarning()&&this.setWarningText(m.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,N.COLLAPSED_WARNING_ID),i=this.toString(30),(e=this.getField(t))?e.setValue(i):(this.getInput(n)||this.appendDummyInput(n)).appendField(new Xu(i),t)):(this.updateDisabled(),this.removeInput(n),s(this.svgGroup,"blocklyCollapsed"),this.setWarningText(null,N.COLLAPSED_WARNING_ID))}onMouseDown(e){var t;this.workspace.isReadOnly()||(t=this.workspace.getGesture(e))&&t.handleBlockStart(e,this)}showHelp(){var e="function"==typeof this.helpUrl?this.helpUrl():this.helpUrl;e&&window.open(e)}generateContextMenu(e){return this.workspace.isReadOnly()||!this.contextMenu?null:(e=R.registry.getContextMenuOptions({block:this,focusedNode:this},e),this.customContextMenu&&this.customContextMenu(e),e)}calculateContextMenuLocation(e){var t;return e instanceof PointerEvent?new E(e.clientX,e.clientY):(e=Ne(this.workspace,this.getRelativeToSurfaceXY()),t=null==(t=this.inputList.filter(e=>e.isVisible()).flatMap(e=>e.fieldRow).find(e=>e.isVisible()))||null==(t=t.getSvgRoot())?void 0:t.getBoundingClientRect(),new E(this.RTL?e.x-5:e.x+5,(t&&t.height?t.y+t.height:e.y+this.height)+5))}showContextMenu(e){var t=this.generateContextMenu(e),i=this.calculateContextMenuLocation(e);t&&t.length&&(yn(e,t,this.RTL,this.workspace,i),_n(this))}updateComponentLocations(e){this.dragging||this.updateConnectionLocations(e),this.updateIconLocations(e),this.updateFieldLocations(e);for(var t of this.getChildren(!1))t.updateComponentLocations(E.sum(e,t.relativeCoords))}updateConnectionLocations(e){for(var t of this.getConnections_(!1))t.moveToOffset(e)}updateIconLocations(e){for(var t of this.getIcons())t.onLocationChange(e)}updateFieldLocations(e){for(var t of this.inputList)for(var i of t.fieldRow)i.onLocationChange(e)}addClass(e){c(this.svgGroup,e)}removeClass(e){s(this.svgGroup,e)}setDragging(t){(this.dragging=t)?(this.translation="",Ga.push(...this.getConnections_(!0)),this.addClass("blocklyDragging")):(Ga.length=0,this.removeClass("blocklyDragging"));for(let e=0;e<this.childBlocks_.length;e++)this.childBlocks_[e].setDragging(t)}setMovable(e){super.setMovable(e),this.pathObject.updateMovable(e)}setEditable(t){super.setEditable(t),(t?s:c)(this.svgGroup,"blocklyNotEditable"),t=this.getIcons();for(let e=0;e<t.length;e++)t[e].updateEditable()}setShadow(e){super.setShadow(e),this.applyColour()}setInsertionMarker(e){this.isInsertionMarker_!==e&&(this.isInsertionMarker_=e)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup}dispose(e,t){this.disposing=!0,Hi(),Cn();let i=m.getFocusManager$$module$build$src$core$focus_manager();var n,o,r;this.getSvgRoot().contains(null!=(n=null==(r=i.getFocusedNode())?void 0:r.getFocusableElement())?n:null)&&((r=this.getParent())||(n=null!=(o=this.outputConnection)?o:this.previousConnection)&&(r=null==(o=n.closest(0,new E(0,0)).connection)?void 0:o.getSourceBlock()),r?i.focusNode(r):setTimeout(()=>i.focusTree(this.workspace),0)),t&&(this.unplug(e),To(this)),super.dispose(!!e),a(this.svgGroup)}disposeInternal(){this.disposing=!0,super.disposeInternal(),m.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===this&&this.workspace.cancelCurrentGesture(),[...this.warningTextDb.values()].forEach(e=>clearTimeout(e)),this.warningTextDb.clear(),this.getIcons().forEach(e=>e.dispose())}checkAndDelete(){this.workspace.isFlyout||(m.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),m.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(){return this.isInsertionMarker_?null:{paster:ld.TYPE,blockState:$t(this,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:he(this,!0)}}applyColour(){var e,t,i;for(null!=(t=(e=this.pathObject).applyColour)&&t.call(e,this),e=this.getIcons(),t=0;t<e.length;t++)e[t].applyColour();for(i of this.getFields())i.applyColour()}updateDisabled(){var e,t=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===t)null!=(e=this.getNextBlock())&&e.updateDisabled();else{this.applyColour(),this.visuallyDisabled=t;for(var i of this.getChildren(!1))i.updateDisabled()}}setWarningText(i,n=""){if(n)this.warningTextDb.has(n)&&(clearTimeout(this.warningTextDb.get(n)),this.warningTextDb.delete(n));else{for(var o of this.warningTextDb.values())clearTimeout(o);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(n,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(n),this.setWarningText(i,n))},100));else if(this.isInFlyout&&(i=null),o=this.getIcon(hd.TYPE),i){let e=this.getSurroundParent(),t=null;for(;e;)e.isCollapsed()&&(t=e),e=e.getSurroundParent();t&&t.setWarningText(m.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,N.COLLAPSED_WARNING_ID),o?o.addMessage(i,n):this.addIcon(new hd(this).addMessage(i,n))}else!o||n&&(o.addMessage("",n),o.getText())||this.removeIcon(hd.TYPE)}setMutator(e){this.removeIcon(m.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),e&&this.addIcon(e)}addIcon(e){return super.addIcon(e),e instanceof m.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=e),e.initView(this.createIconPointerDownListener(e)),e.applyColour(),e.updateEditable(),this.queueRender(),e}createIconPointerDownListener(t){return e=>{this.isDeadOrDying()||(e=this.workspace.getGesture(e))&&e.setStartIcon(t)}}removeIcon(e){var t=super.removeIcon(e);return e.equals(m.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.queueRender(),t}setDisabledReason(e,t){var i=this.isEnabled();super.setDisabledReason(e,t),this.isEnabled()===i||this.getInheritedDisabled()||this.updateDisabled()}setDeletable(e){super.setDeletable(e),(e?s:c)(this.svgGroup,"blocklyNotDeletable")}setHighlighted(e){this.pathObject.updateHighlighted(e)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(e){this.pathObject.updateDraggingDelete(e)}getColour(){return this.style.colourPrimary}setColour(e){var t,i;super.setColour(e),e=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),null!=(i=(t=this.pathObject).setStyle)&&i.call(t,e.style),this.style=e.style,this.styleName_=e.name,this.applyColour()}setStyle(e){var t,i,n=this.workspace.getRenderer().getConstants().getBlockStyle(e);if(this.styleName_&&s(this.svgGroup,this.styleName_),!n)throw Error("Invalid style name: "+e);this.hat=n.hat,null!=(i=(t=this.pathObject).setStyle)&&i.call(t,n),this.colour_=n.colourPrimary,this.style=n,this.applyColour(),c(this.svgGroup,e),this.styleName_=e}getStyle(){return this.style}bringToFront(e=!1){var t=m.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode();let i=this;if(!i.isDeadOrDying()){do{var n=i.getSvgRoot(),o=n.parentNode,r=o.childNodes;if(r[r.length-1]!==n&&o.appendChild(n),e)break}while(i=i.getParent());t&&m.getFocusManager$$module$build$src$core$focus_manager().focusNode(t)}}setPreviousStatement(e,t){super.setPreviousStatement(e,t),this.queueRender()}setNextStatement(e,t){super.setNextStatement(e,t),this.queueRender()}setOutput(e,t){super.setOutput(e,t),this.queueRender()}setInputsInline(e){super.setInputsInline(e),this.queueRender()}removeInput(e,t){return e=super.removeInput(e,t),this.queueRender(),e}moveNumberedInputBefore(e,t){super.moveNumberedInputBefore(e,t),this.queueRender()}appendInput(e){return super.appendInput(e),this.queueRender(),e}setConnectionTracking(e){var t;if(this.previousConnection&&this.previousConnection.setTracking(e),this.outputConnection&&this.outputConnection.setTracking(e),this.nextConnection&&(this.nextConnection.setTracking(e),t=this.nextConnection.targetBlock())&&t.setConnectionTracking(e),!this.collapsed_)for(t=0;t<this.inputList.length;t++){var i=this.inputList[t].connection;i&&(i.setTracking(e),i=i.targetBlock())&&i.setConnectionTracking(e)}}getConnections_(e){var i=[];if(this.outputConnection&&i.push(this.outputConnection),this.previousConnection&&i.push(this.previousConnection),this.nextConnection&&i.push(this.nextConnection),e||!this.collapsed_)for(let e=0,t;t=this.inputList[e];e++)t.connection&&i.push(t.connection);return i}lastConnectionInStack(e){return super.lastConnectionInStack(e)}getMatchingConnection(e,t){return super.getMatchingConnection(e,t)}makeConnection_(e){return new Qu(this,e)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){var e,t,i=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||i.isInFlyout))for(var n of this.getConnections_(!1)){n.isSuperior()&&null!=(e=n.targetBlock())&&e.bumpNeighbours();for(t of n.neighbours(m.config$$module$build$src$core$config.snapRadius))t.getSourceBlock().getRootBlock()===i||n.isConnected()&&t.isConnected()||(n.isSuperior()?t.bumpAwayFrom(n,!1):n.bumpAwayFrom(t,!0))}}scheduleSnapAndBump(){this.snapToGrid(),this.bumpNeighbours()}positionNearConnection(e,t,i){var n;e.type!==v.NEXT_STATEMENT&&e.type!==v.INPUT_VALUE||(n=t.x,t=t.y,n+=i.x-e.getOffsetInBlock().x,t+=i.y-e.getOffsetInBlock().y,this.moveBy(n,t))}getChildren(e){return super.getChildren(e)}queueRender(){return et(this)}render(){this.queueRender(),it()}renderEfficiently(){K(),this.isCollapsed()&&this.updateCollapsed(),this.isEnabled()||this.updateDisabled(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),X()}tightenChildrenEfficiently(){for(var e of this.inputList){e=e.connection;e&&e.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}getHeightWidth(){let e=this.height,t=this.width;var i,n=this.getNextBlock();return n&&(n=n.getHeightWidth(),i=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT,e+=n.height-i,t=Math.max(t,n.width)),{height:e,width:t}}fadeForReplacement(e){this.pathObject.updateReplacementFade(e)}highlightShapeForInput(e,t){this.pathObject.updateShapeForInputHighlight(e,t)}getDragStrategy(){return this.dragStrategy}setDragStrategy(e){this.dragStrategy=e}isCopyable(){return this.isOwnDeletable()&&this.isOwnMovable()}isMovable(){return this.dragStrategy.isMovable()}startDrag(e){this.dragStrategy.startDrag(e)}drag(e,t){this.dragStrategy.drag(e,t)}endDrag(e){this.dragStrategy.endDrag(e)}revertDrag(){this.dragStrategy.revertDrag()}toFlyoutInfo(){let e=Object.assign({},{kind:"BLOCK"},$t(this)),i=new Set(["id","height","width","pinned","enabled"]),n=function(e){for(var t in e)i.has(t)?delete e[t]:"object"==typeof e[t]&&n(e[t])};return n(e),[e]}jsonInit(e){super.jsonInit(e),e.classes&&this.addClass(Array.isArray(e.classes)?e.classes.join(" "):e.classes)}getFocusableElement(){return this.pathObject.svgPath}getFocusableTree(){return this.workspace}onNodeFocus(){this.select()}onNodeBlur(){this.unselect()}canBeFocused(){return!0}}),pd=(N.INLINE=-1,N.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_",class{constructor(){}onDragEnter(e){}onDragOver(e){}onDragExit(e){}onDrop(e){}getClientRect(){return null}shouldPreventMove(e){return!1}}),gd=class extends pd{constructor(){super(),this.wouldDelete_=!1}wouldDelete(e){return e instanceof N?(e=!e.getParent()&&e.isDeletable(),this.updateWouldDelete_(e)):this.updateWouldDelete_(Do(e)&&e.isDeletable()),this.wouldDelete_}updateWouldDelete_(e){this.wouldDelete_=e}},fd=class{constructor(e,t){this.element=e,this.type=t}getElement(){return this.element}getType(){return this.type}},md=class{constructor(e){this.workspace_=e}getDimensionsPx_(e){let t=0,i=0;return e&&(t=e.getWidth(),i=e.getHeight()),new I(t,i)}getFlyoutMetrics(e){return{width:(e=this.getDimensionsPx_(this.workspace_.getFlyout(e))).width,height:e.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){var e=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:e.width,height:e.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let e=0,t=0;var i=this.getToolboxMetrics(),n=this.getFlyoutMetrics(),o=!!this.workspace_.getToolbox(),r=!(null!=(s=this.workspace_.getFlyout())&&s.autoClose),s=(o?i:n).position,a=s===y.TOP;return s===y.LEFT&&(o&&(e+=i.width),r)&&(e+=n.width),a&&(o&&(t+=i.height),r)&&(t+=n.height),{top:t,left:e}}getViewMetrics(e){e=e?this.workspace_.scale:1;var t=this.getSvgMetrics(),i=this.getToolboxMetrics(),n=this.getFlyoutMetrics(),o=!!this.workspace_.getToolbox(),r=!(null!=(s=this.workspace_.getFlyout())&&s.autoClose),s=(o?i:n).position,a=s===y.LEFT||s===y.RIGHT;return s!==y.TOP&&s!==y.BOTTOM||(o&&(t.height-=i.height),r&&(t.height-=n.height)),a&&(o&&(t.width-=i.width),r)&&(t.width-=n.width),{height:t.height/e,width:t.width/e,top:-this.workspace_.scrollY/e,left:-this.workspace_.scrollX/e}}getContentMetrics(e){e=e?1:this.workspace_.scale;var t=this.workspace_.getBlocksBoundingBox();return{height:(t.bottom-t.top)*e,width:(t.right-t.left)*e,top:t.top*e,left:t.left*e}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(e){var t,i,n;return this.hasFixedEdges()?(t=this.workspace_.isMovableHorizontally(),i=this.workspace_.isMovableVertically(),e=e||this.getViewMetrics(!1),n={},i||(n.top=e.top,n.bottom=e.top+e.height),t||(n.left=e.left,n.right=e.left+e.width),n):{}}getPaddedContent_(e,t){var i=t.top+t.height,n=t.left+t.width,o=e.width,r=o/2,s=(e=e.height)/2;return{top:Math.min(t.top-s,i-e),bottom:Math.max(i+s,t.top+e),left:Math.min(t.left-r,n-o),right:Math.max(n+r,t.left+o)}}getScrollMetrics(e,t,i){e=e?this.workspace_.scale:1,t=t||this.getViewMetrics(!1);var n=i||this.getContentMetrics(),o=(i=this.getComputedFixedEdges_(t),t=this.getPaddedContent_(t,n),n=(void 0!==i.top?i:t).top,(void 0!==i.left?i:t).left);return{top:n/e,left:o/e,width:((void 0!==i.right?i:t).right-o)/e,height:((void 0!==i.bottom?i:t).bottom-n)/e}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){var e=this.getToolboxMetrics(),t=this.getFlyoutMetrics(!0),i=this.getSvgMetrics(),n=this.getAbsoluteMetrics(),o=this.getViewMetrics(),r=this.getContentMetrics(),s=this.getScrollMetrics(!1,o,r);return{contentHeight:r.height,contentWidth:r.width,contentTop:r.top,contentLeft:r.left,scrollHeight:s.height,scrollWidth:s.width,scrollTop:s.top,scrollLeft:s.left,viewHeight:o.height,viewWidth:o.width,viewTop:o.top,viewLeft:o.left,absoluteTop:n.top,absoluteLeft:n.left,svgHeight:i.height,svgWidth:i.width,toolboxWidth:e.width,toolboxHeight:e.height,toolboxPosition:e.position,flyoutWidth:t.width,flyoutHeight:t.height}}},bd=(o(b.METRICS_MANAGER,Us,md),class extends md{constructor(e,t){super(e),this.flyout_=t}getBoundingBox(){let t;try{t=this.workspace_.getCanvas().getBBox()}catch(e){t={height:0,y:0,width:0,x:0}}return t}getContentMetrics(e){var t=this.getBoundingBox();return e=e?1:this.workspace_.scale,{height:t.height*e,width:t.width*e,top:t.y*e,left:t.x*e}}getScrollMetrics(e,t,i){return t=i||this.getContentMetrics(),i=this.flyout_.MARGIN*this.workspace_.scale,e=e?this.workspace_.scale:1,{height:(t.height+2*i)/e,width:(t.width+t.left+i)/e,top:0,left:0}}}),_d=class{constructor(e,t,i,n){this.workspace=e,this.targetWorkspace=t,this.isFlyoutLabel=n,this.height=this.width=0,this.cursorSvg=this.svgText=null,this.text=i.text,this.position=new E(0,0),this.callbackKey=i.callbackKey||i.callbackkey,this.cssClass=i["web-class"]||null,this.info=i,e=this.isFlyoutLabel?"blocklyFlyoutLabel":"blocklyFlyoutButton",this.cssClass&&(e+=" "+this.cssClass),this.id=Ss(),this.svgGroup=l(k.G,{id:this.id,class:e},this.workspace.getCanvas());let o;this.isFlyoutLabel||(o=l(k.RECT,{class:"blocklyFlyoutButtonShadow",rx:_d.BORDER_RADIUS,ry:_d.BORDER_RADIUS,x:1,y:1},this.svgGroup)),e=l(k.RECT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:_d.BORDER_RADIUS,ry:_d.BORDER_RADIUS},this.svgGroup),t=l(k.TEXT,{class:this.isFlyoutLabel?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup),i=on(this.text),this.workspace.RTL&&(i+="â€"),t.textContent=i,this.isFlyoutLabel&&(this.svgText=t,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill")),n=Te(t,"fontSize");var r=Te(t,"fontWeight"),s=Te(t,"fontFamily");this.width=J(t,n,r,s),i=Z(i,n,r,s),this.height=this.height||i.height,this.isFlyoutLabel||(this.width+=2*_d.TEXT_MARGIN_X,this.height+=2*_d.TEXT_MARGIN_Y,null!=(n=o)&&n.setAttribute("width",String(this.width)),null!=(r=o)&&r.setAttribute("height",String(this.height))),e.setAttribute("width",String(this.width)),e.setAttribute("height",String(this.height)),t.setAttribute("x",String(this.width/2)),t.setAttribute("y",String(this.height/2-i.height/2+i.baseline)),this.updateTransform(),this.onMouseDownWrapper=p(this.svgGroup,"pointerdown",this,this.onMouseDown),this.onMouseUpWrapper=p(this.svgGroup,"pointerup",this,this.onMouseUp)}createDom(){return this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(e,t){this.position.x=e,this.position.y=t,this.updateTransform()}moveBy(e,t,i){this.moveTo(this.position.x+e,this.position.y+t)}isLabel(){return this.isFlyoutLabel}getPosition(){return this.position}getBoundingRectangle(){return new C(this.position.y,this.position.y+this.height,this.position.x,this.position.x+this.width)}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}getWorkspace(){return this.workspace}dispose(){r(this.onMouseDownWrapper),r(this.onMouseUpWrapper),this.svgGroup&&a(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}setCursorSvg(e){e?this.svgGroup&&(this.svgGroup.appendChild(e),this.cursorSvg=e):this.cursorSvg=null}onMouseUp(e){(e=this.targetWorkspace.getGesture(e))&&e.cancel(),this.isFlyoutLabel&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isFlyoutLabel||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isFlyoutLabel||(e=this.targetWorkspace.getButtonCallback(this.callbackKey))&&e(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}onMouseDown(e){var t=this.targetWorkspace.getGesture(e),i=this.targetWorkspace.getFlyout();t&&i&&t.handleFlyoutStart(e,i)}getSvgRoot(){return this.svgGroup}getFocusableElement(){return this.svgGroup}getFocusableTree(){return this.workspace}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}},yd=(_d.TEXT_MARGIN_X=5,_d.TEXT_MARGIN_Y=2,_d.BORDER_RADIUS=4,be("\n.blocklyFlyoutButton {\n  fill: #888;\n  cursor: default;\n}\n\n.blocklyFlyoutButtonShadow {\n  fill: #666;\n}\n\n.blocklyFlyoutButton:hover {\n  fill: #aaa;\n}\n\n.blocklyFlyoutLabel {\n  cursor: default;\n}\n\n.blocklyFlyoutLabelBackground {\n  opacity: 0;\n}\n"),class{getFirstChild(e){return null}getParent(e){return e.getWorkspace()}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof _d}}),vd=class{constructor(e,t){this.policy=e,this.flyout=t}getFirstChild(e){return null}getParent(e){return this.policy.getParent(e)}getNextSibling(t){var e=this.flyout.getContents();if(!e)return null;let i=e.findIndex(e=>e.getElement()===t);return-1===i?null:e[i=++i>=e.length?0:i].getElement()}getPreviousSibling(t){var e=this.flyout.getContents();if(!e)return null;let i=e.findIndex(e=>e.getElement()===t);return-1===i?null:e[i=--i<0?e.length-1:i].getElement()}isNavigable(e){return this.policy.isNavigable(e)}isApplicable(e){return this.policy.isApplicable(e)}},Td=class{constructor(e,t){this.gap=e,this.axis=t,this.y=this.x=0}getBoundingRectangle(){switch(this.axis){case"x":return new C(this.y,this.y,this.x,this.x+this.gap);case"y":return new C(this.y,this.y+this.gap,this.x,this.x)}}moveBy(e,t,i){this.x+=e,this.y+=t}isNavigable(){return!1}getFocusableElement(){throw Error("Cannot be focused")}getFocusableTree(){throw Error("Cannot be focused")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}},Ed=class{getFirstChild(e){return null}getParent(e){return null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return!1}isApplicable(e){return e instanceof Td}},kd=class{getFirstChild(e){return Mo(e,!0)[0]}getParent(e){var t;if(null!=(t=e.previousConnection)&&t.targetBlock()){if(t=e.getSurroundParent())return t}else if(null!=(t=e.outputConnection)&&t.targetBlock())return e.outputConnection.targetBlock();return e.workspace}getNextSibling(e){var t;return null!=(t=e.nextConnection)&&t.targetBlock()?null==(t=e.nextConnection)?void 0:t.targetBlock():null!=(t=e.outputConnection)&&t.targetBlock()?Po(e,1):e.getSurroundParent()?Po(e.getTopStackBlock(),1):this.getParent(e)instanceof Sh?$o(e,1):null}getPreviousSibling(e){var t;return null!=(t=e.previousConnection)&&t.targetBlock()?null==(t=e.previousConnection)?void 0:t.targetBlock():null!=(t=e.outputConnection)&&t.targetBlock()?Po(e,-1):this.getParent(e)instanceof Sh?$o(e,-1):null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof N}},Cd=class{getFirstChild(e){return null}getParent(e){return e.getParentComment()}getNextSibling(e){var t=e.getParentComment().view.getCommentBarButtons();return 0<=(e=t.indexOf(e))&&e+1<t.length?t[e+1]:null}getPreviousSibling(e){var t=e.getParentComment().view.getCommentBarButtons();return 0<(e=t.indexOf(e))?t[e-1]:null}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof gu}},Id=class{getFirstChild(e){return e.getParentInput()?e.targetConnection:null}getParent(e){return e.getSourceBlock()}getNextSibling(e){var t,i;return e.getParentInput()?Po(e,1):e.type===v.NEXT_STATEMENT?(t=e.targetConnection,i=e.getSourceBlock(),t||i.getRootBlock().lastConnectionInStack(!1)!==e?t:(i=(e=i.workspace.getTopBlocks(!0)).indexOf(i.getRootBlock())+1,i=e[i=i>=e.length?0:i],null!=(t=this.getParentConnection(i))?t:i)):e.getSourceBlock()}getPreviousSibling(e){var t,i;return e.getParentInput()?Po(e,-1):e.type===v.PREVIOUS_STATEMENT||e.type===v.OUTPUT_VALUE?(t=e.targetConnection&&!e.targetConnection.getParentInput()?e.targetConnection:null,i=e.getSourceBlock(),t||this.getParentConnection(i.getRootBlock())!==e?t:(i=(e=i.workspace.getTopBlocks(!0)).indexOf(i.getRootBlock())-1,null!=(t=(i=e[i=i<0?e.length-1:i]).lastConnectionInStack(!1))?t:i)):e.type===v.NEXT_STATEMENT?e.getSourceBlock():null}getParentConnection(e){var t;return!e.outputConnection||null!=(t=e.previousConnection)&&t.isConnected()?e.previousConnection:e.outputConnection}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Qu}},wd=class{getFirstChild(e){return null}getParent(e){return e.getSourceBlock()}getNextSibling(e){return Po(e,1)}getPreviousSibling(e){return Po(e,-1)}isNavigable(e){var t;return e.canBeFocused()&&e.isVisible()&&(e.isClickable()||e.isCurrentlyEditable())&&!(null!=(t=e.getSourceBlock())&&t.isSimpleReporter()&&e.isFullBlockField())&&e.getParentInput().isVisible()}isApplicable(e){return e instanceof x}},Sd=class{getFirstChild(e){return e instanceof m.MutatorIcon$$module$build$src$core$icons$mutator_icon&&e.bubbleIsVisible()&&m.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()===e&&null!=(e=null==(e=e.getBubble())?void 0:e.getWorkspace())?e:null}getParent(e){return e.getSourceBlock()}getNextSibling(e){return Po(e,1)}getPreviousSibling(e){return Po(e,-1)}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof Hu}},xd=class{getFirstChild(e){return e.view.getCommentBarButtons()[0]}getParent(e){return e.workspace}getNextSibling(e){return $o(e,1)}getPreviousSibling(e){return $o(e,-1)}isNavigable(e){return e.canBeFocused()}isApplicable(e){return e instanceof ku}},Rd=class{getFirstChild(e){return(e=e.getTopBlocks(!0)).length?e[0]:null}getParent(e){return null}getNextSibling(e){return null}getPreviousSibling(e){return null}isNavigable(e){return e.canBeFocused()&&!e.isMutator}isApplicable(e){return e instanceof Sh}},Od=class{constructor(){this.rules=[new kd,new wd,new Id,new Rd,new Sd,new xd,new Cd]}addNavigationPolicy(e){this.rules.push(e)}get(t){return this.rules.find(e=>e.isApplicable(t))}getFirstChild(e){var t=null==(t=this.get(e))?void 0:t.getFirstChild(e);return t?null!=(e=this.get(t))&&e.isNavigable(t)?t:this.getFirstChild(t)||this.getNextSibling(t):null}getParent(e){var t=null==(t=this.get(e))?void 0:t.getParent(e);return t?null!=(e=this.get(t))&&e.isNavigable(t)?t:this.getParent(t):null}getNextSibling(e){var t=null==(t=this.get(e))?void 0:t.getNextSibling(e);return t?null!=(e=this.get(t))&&e.isNavigable(t)?t:this.getNextSibling(t):null}getPreviousSibling(e){var t=null==(t=this.get(e))?void 0:t.getPreviousSibling(e);return t?null!=(e=this.get(t))&&e.isNavigable(t)?t:this.getPreviousSibling(t):null}},Ad=class extends Od{constructor(t){super(),this.rules.push(new yd,new Ed),this.rules=this.rules.map(e=>new vd(e,t))}},Nd=class{constructor(e,t,i,n,o){this.workspace=e,this.oldHostMetrics=this.corner_=this.vScroll=this.hScroll=null,i=void 0===i||i;var r=(t=void 0===t||t)&&i;t&&(this.hScroll=new nl(e,!0,r,n,o)),i&&(this.vScroll=new nl(e,!1,r,n,o)),r&&(this.corner_=l(k.RECT,{height:nl.scrollbarThickness,width:nl.scrollbarThickness,class:"blocklyScrollbarBackground"}),z(this.corner_,e.getBubbleCanvas()))}dispose(){a(this.corner_),this.oldHostMetrics=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){var e=this.workspace.getMetrics();if(e){var t=!1,i=!1;if(this.oldHostMetrics&&this.oldHostMetrics.viewWidth===e.viewWidth&&this.oldHostMetrics.viewHeight===e.viewHeight&&this.oldHostMetrics.absoluteTop===e.absoluteTop&&this.oldHostMetrics.absoluteLeft===e.absoluteLeft?(this.oldHostMetrics&&this.oldHostMetrics.scrollWidth===e.scrollWidth&&this.oldHostMetrics.viewLeft===e.viewLeft&&this.oldHostMetrics.scrollLeft===e.scrollLeft||(t=!0),this.oldHostMetrics&&this.oldHostMetrics.scrollHeight===e.scrollHeight&&this.oldHostMetrics.viewTop===e.viewTop&&this.oldHostMetrics.scrollTop===e.scrollTop||(i=!0)):i=t=!0,t||i){try{m.disable$$module$build$src$core$events$utils(),this.hScroll&&t&&this.hScroll.resize(e),this.vScroll&&i&&this.vScroll.resize(e)}finally{m.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}this.hScroll&&this.vScroll&&(this.oldHostMetrics&&this.oldHostMetrics.viewWidth===e.viewWidth&&this.oldHostMetrics.absoluteLeft===e.absoluteLeft||null!=(t=this.corner_)&&t.setAttribute("x",String(this.vScroll.position.x)),this.oldHostMetrics&&this.oldHostMetrics.viewHeight===e.viewHeight&&this.oldHostMetrics.absoluteTop===e.absoluteTop||null!=(i=this.corner_)&&i.setAttribute("y",String(this.hScroll.position.y))),this.oldHostMetrics=e}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(e,t){this.hScroll&&this.hScroll.setOrigin(e,t),this.vScroll&&this.vScroll.setOrigin(e,t)}set(e,t,i){this.hScroll&&this.hScroll.set(e,!1),this.vScroll&&this.vScroll.set(t,!1),!i&&void 0!==i||(e={},this.hScroll&&(e.x=this.hScroll.getRatio_()),this.vScroll&&(e.y=this.vScroll.getRatio_()),this.workspace.setMetrics(e))}setX(e){this.hScroll&&this.hScroll.set(e,!0)}setY(e){this.vScroll&&this.vScroll.set(e,!0)}setContainerVisible(e){this.hScroll&&this.hScroll.setContainerVisible(e),this.vScroll&&this.vScroll.setContainerVisible(e)}isVisible(){let e=!1;return this.hScroll&&(e=this.hScroll.isVisible()),e=this.vScroll?e||this.vScroll.isVisible():e}setVisible(e){this.hScroll&&this.hScroll.setVisibleInternal(e),this.vScroll&&this.vScroll.setVisibleInternal(e)}resizeContent(e){this.hScroll&&this.hScroll.resizeContentHorizontal(e),this.vScroll&&this.vScroll.resizeContentVertical(e)}resizeView(e){this.hScroll&&this.hScroll.resizeViewHorizontal(e),this.vScroll&&this.vScroll.resizeViewVertical(e)}},Ld="sep",Dd=class{load(e,t){return e=new Td(0,t.horizontalLayout?"x":"y"),new fd(e,Ld)}gapForItem(e,t){return null!=(e=parseInt(String(e.gap)))?e:t}disposeItem(e){}getType(){return Ld}};o(b.FLYOUT_INFLATER,Ld,Dd);({SEPARATOR_TYPE:Ld}).SeparatorFlyoutInflater=Dd;var Md=class extends gd{constructor(e){super(),this.horizontalLayout=!1,this.boundEvents=[],this.reflowWrapper=null,this.contents=[],this.autoClose=!0,this.visible=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,this.inflaters=new Map,e.setMetrics=this.setMetrics_.bind(this),this.workspace_=new Sh(e),this.workspace_.setMetricsManager(new bd(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.visible),this.workspace_.setNavigator(new Ad(this)),this.id=xs(),this.RTL=!!e.RTL,this.toolboxPosition_=e.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(e){return this.svgGroup_=l(e,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=l(k.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(e){this.targetWorkspace=e,this.workspace_.targetWorkspace=e,this.workspace_.scrollbar=new Nd(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(p(this.svgGroup_,"wheel",this,this.wheel_)),this.boundEvents.push(p(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),e.getComponentManager().addComponent({component:this,weight:Xa.ComponentWeight.FLYOUT_WEIGHT,capabilities:[Xa.Capability.AUTOHIDEABLE,Xa.Capability.DELETE_AREA,Xa.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.targetWorkspace.getComponentManager().removeComponent(this.id);for(var e of this.boundEvents)r(e);this.boundEvents.length=0,this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&a(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(e){this.autoClose=e,this.targetWorkspace.recordDragTargets(),this.targetWorkspace.resizeContents()}autoHide(e){!e&&this.targetWorkspace.getFlyout(!0)===this&&this.autoClose&&this.hide()}getTargetWorkspace(){return this.targetWorkspace}isVisible(){return this.visible}setVisible(e){var t=e!==this.isVisible();this.visible=e,t&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(e){var t=e!==this.containerVisible;this.containerVisible=e,t&&this.updateDisplay()}getContents(){return this.contents}setContents(e){this.contents=e}updateDisplay(){var e,t=!!this.containerVisible&&this.isVisible();this.svgGroup_&&(this.svgGroup_.style.display=t?"block":"none"),null!=(e=this.workspace_.scrollbar)&&e.setContainerVisible(t)}positionAt_(e,t,i,n){var o;null!=(o=this.svgGroup_)&&o.setAttribute("width",""+e),null!=(o=this.svgGroup_)&&o.setAttribute("height",""+t),this.workspace_.setCachedParentSvgSize(e,t),this.svgGroup_&&Y(this.svgGroup_,"translate("+i+"px,"+n+"px)"),(e=this.workspace_.scrollbar)&&(e.setOrigin(i,n),e.resize(),e.hScroll&&e.hScroll.setPosition(e.hScroll.position.x,e.hScroll.position.y),e.vScroll)&&e.vScroll.setPosition(e.vScroll.position.x,e.vScroll.position.y)}hide(){this.isVisible()&&(this.setVisible(!1),this.reflowWrapper)&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null)}show(e){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),"string"==typeof e&&(e=this.getDynamicCategoryContents(e)),this.setVisible(!0),e=Pe(e),e=this.createFlyoutInfo(e),it(this.workspace_),this.setContents(e),this.layout_(e),this.horizontalLayout?this.height_=0:this.width_=0,this.reflow(),this.workspace_.setResizesEnabled(!0),this.reflowWrapper=e=>{e.type!==_.BLOCK_CHANGE&&e.type!==_.BLOCK_FIELD_INTERMEDIATE_CHANGE||this.reflow()},this.workspace_.addChangeListener(this.reflowWrapper)}createFlyoutInfo(e){var t,i=[],n=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(t of e)"custom"in t&&(e=this.getDynamicCategoryContents(t.custom),e=Pe(e),i.push(...this.createFlyoutInfo(e))),e=t.kind.toLowerCase(),(e=this.getInflaterForType(e))&&(i.push(e.load(t,this)),e=e.gapForItem(t,n))&&i.push(new fd(new Td(e,this.horizontalLayout?"x":"y"),Ld));return this.normalizeSeparators(i)}normalizeSeparators(t){for(let e=t.length-1;0<e;e--){var i=t[e].getType().toLowerCase(),n=t[e-1].getType().toLowerCase();i===Ld&&n===Ld&&t.splice(e-1,1)}return t}getDynamicCategoryContents(e){if("function"!=typeof(e=this.workspace_.targetWorkspace.getToolboxCategoryCallback(e)))throw TypeError("Couldn't find a callback function when opening a toolbox category.");return e(this.workspace_.targetWorkspace)}clearOldBlocks(){var e;this.getContents().forEach(e=>{var t;null!=(t=this.getInflaterForType(e.getType()))&&t.disposeItem(e)}),null!=(e=this.workspace_.getPotentialVariableMap())&&e.clear()}onMouseDown(e){var t=this.targetWorkspace.getGesture(e);t&&t.handleFlyoutStart(e,this)}isBlockCreatable(e){return e.isEnabled()&&!this.getTargetWorkspace().isReadOnly()}createBlock(e){let t=null;m.disable$$module$build$src$core$events$utils();var i=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{t=this.placeNewBlock(e)}finally{m.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),e=Lt(this.targetWorkspace,i),U()){for(m.setGroup$$module$build$src$core$events$utils(!0),i=0;i<e.length;i++){var n=e[i];g(new(f(_.VAR_CREATE))(n))}g(new(f(_.BLOCK_CREATE))(t))}return this.autoClose&&this.hide(),t}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return!!this.workspace_.scrollbar&&this.workspace_.scrollbar.isVisible()}placeNewBlock(e){var t,i=this.targetWorkspace;if(e.getSvgRoot())return t=this.serializeBlock(e),i.setResizesEnabled(!1),i=Wt(t,i),this.positionNewBlock(e,i),i;throw Error("oldBlock is not rendered")}serializeBlock(e){return $t(e)}positionNewBlock(e,t){var i=this.targetWorkspace,n=i.getOriginOffsetInPixels(),o=this.workspace_.getOriginOffsetInPixels();(e=e.getRelativeToSurfaceXY()).scale(this.workspace_.scale),o=E.sum(o,e),(n=E.difference(o,n)).scale(1/i.scale),t.moveTo(new E(n.x,n.y))}getInflaterForType(e){var t;return this.inflaters.has(e)?null!=(t=this.inflaters.get(e))?t:null:(t=hs(b.FLYOUT_INFLATER,e))?(t=new t,this.inflaters.set(e,t),t):null}getFocusableElement(){throw Error("Flyouts are not directly focusable.")}getFocusableTree(){throw Error("Flyouts are not directly focusable.")}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!1}getRootFocusableNode(){throw Error("Flyouts are not directly focusable.")}getRestoredFocusableNode(e){throw Error("Flyouts are not directly focusable.")}getNestedTrees(){throw Error("Flyouts are not directly focusable.")}lookUpFocusableNode(e){throw Error("Flyouts are not directly focusable.")}onTreeFocus(e,t){}onTreeBlur(e){throw Error("Flyouts are not directly focusable.")}},$d=class{constructor(){this.isActive=!1,this.activeClassName="blocklyKeyboardNavigation"}setIsActive(e=!0){this.isActive=e,this.updateActiveVisualization()}getIsActive(){return this.isActive}updateActiveVisualization(){this.isActive?document.body.classList.add(this.activeClassName):document.body.classList.remove(this.activeClassName)}},Pd=new $d,Bd=class{constructor(e){this.workspace=e,this.horizontalScrollEnabled=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled=this.workspace.isMovableVertically(),this.startScrollXY_=new E(e.scrollX,e.scrollY)}dispose(){this.workspace=null}startDrag(){}endDrag(e){this.drag(e)}drag(e){if(e=E.sum(this.startScrollXY_,e),this.horizontalScrollEnabled&&this.verticalScrollEnabled)this.workspace.scroll(e.x,e.y);else if(this.horizontalScrollEnabled)this.workspace.scroll(e.x,this.workspace.scrollY);else{if(!this.verticalScrollEnabled)throw new TypeError("Invalid state.");this.workspace.scroll(this.workspace.scrollX,e.y)}}},Fd=class{constructor(e,t){this.creatorWorkspace=t,this.mouseDownXY=new E(0,0),this.startWorkspace_=this.targetBlock=this.startComment=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.workspaceDragger=this.dragger=null,this.dragging=!1,this.flyout=null,this.multiTouch=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=e,this.currentDragDeltaXY=new E(0,0)}dispose(){_s(),ji(),this.creatorWorkspace.clearGesture();for(var e of this.boundEvents)r(e);this.boundEvents.length=0,this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(e){var t=new E(e.clientX,e.clientY);this.updateDragDelta(t)&&(this.updateIsDragging(e),bs()),this.mostRecentEvent=e}updateDragDelta(e){return this.currentDragDeltaXY=E.difference(e,this.mouseDownXY),!this.hasExceededDragRadius&&(this.hasExceededDragRadius=E.magnitude(this.currentDragDeltaXY)>(this.flyout?m.config$$module$build$src$core$config.flyoutDragRadius:m.config$$module$build$src$core$config.dragRadius))}updateIsDraggingFromFlyout(){let e;if(!this.targetBlock||null==(e=this.flyout)||!e.isBlockCreatable(this.targetBlock))return!1;if(this.flyout.targetWorkspace)return!(this.flyout.isScrollable()&&!this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)||(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),m.getGroup$$module$build$src$core$events$utils()||m.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),m.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),0));throw Error("Cannot update dragging from the flyout because the ' +\n          'flyout's target workspace is undefined")}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.dragging=!0,this.workspaceDragger=new Bd(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(e){if(!this.startWorkspace_)throw Error("Cannot update dragging because the start workspace is undefined");if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.flyout&&this.updateIsDraggingFromFlyout();var t=le();t&&Bo(t)&&t.isMovable()?(this.dragging=!0,this.dragger=this.createDragger(t,this.startWorkspace_),this.dragger.onDragStart(e),this.dragger.onDrag(e,this.currentDragDeltaXY)):this.updateIsDraggingWorkspace()}createDragger(e,t){return new(fs(b.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(e,t)}doStart(e){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,ks(e)?this.cancel():(this.gestureHasStarted=!0,wo(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=Cc,this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=e,Vi(),Cs(e)?this.handleRightClick(e):("pointerdown"===e.type.toLowerCase()&&"mouse"!==e.pointerType&&ms(e,this),this.mouseDownXY=new E(e.clientX,e.clientY),this.bindMouseEvents(e),this.isEnding_||this.handleTouchStart(e)))}bindMouseEvents(e){this.boundEvents.push(p(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(p(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(p(document,"pointerup",null,this.handleUp.bind(this),!0)),e.preventDefault(),e.stopPropagation()}handleStart(e){this.isDragging()||(this.handleTouchStart(e),this.isMultiTouch()&&bs())}handleMove(e){this.isDragging()&&ys(e)||!this.isMultiTouch()?(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(e),bs())}handleUp(e){if(this.isDragging()||this.handleTouchEnd(e),!this.isMultiTouch()||this.isDragging()){if(!ys(e))return;if(this.updateFromEvent(e),bs(),this.isEnding_)return void console.log("Trying to end a gesture recursively.");this.isEnding_=!0,this.dragger?(Pd.setIsActive(!1),this.dragger.onDragEnd(e,this.currentDragDeltaXY)):this.workspaceDragger?(Pd.setIsActive(!1),this.workspaceDragger.endDrag(this.currentDragDeltaXY)):this.isBubbleClick()||this.isCommentClick()||(this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(e))}e.preventDefault(),e.stopPropagation(),this.dispose()}handleTouchStart(e){var t=vs(e),i=(this.cachedPoints.set(t,this.getTouchPoint(e)),Array.from(this.cachedPoints.keys()));2===i.length&&(t=this.cachedPoints.get(i[0]),i=this.cachedPoints.get(i[1]),this.startDistance=E.distance(t,i),this.multiTouch=!0,e.preventDefault())}handleTouchMove(e){var t=vs(e);this.cachedPoints.set(t,this.getTouchPoint(e)),this.isPinchZoomEnabled&&2===this.cachedPoints.size?this.handlePinch(e):(this.updateFromEvent(e),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.dragger&&this.dragger.onDrag(this.mostRecentEvent,this.currentDragDeltaXY),e.preventDefault(),e.stopPropagation())}handlePinch(e){var t=Array.from(this.cachedPoints.keys()),i=this.cachedPoints.get(t[0]),t=this.cachedPoints.get(t[1]),i=E.distance(i,t)/this.startDistance;if(0<this.previousScale&&this.previousScale<1/0){if(t=0<(t=i-this.previousScale)?5*t:6*t,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");var n=this.startWorkspace_,o=Is(e,n.getParentSvg(),n.getInverseScreenCTM());n.zoom(o.x,o.y,t)}this.previousScale=i,e.preventDefault()}handleTouchEnd(e){e=vs(e),this.cachedPoints.has(e)&&this.cachedPoints.delete(e),this.cachedPoints.size<2&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(e){return this.startWorkspace_?new E(e.pageX,e.pageY):null}isMultiTouch(){return this.multiTouch}cancel(){this.isEnding_||(bs(),this.dragger?this.dragger.onDragEnd(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(e){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(e)):this.startBubble?this.startBubble.showContextMenu(e):this.startComment?(this.startComment.workspace.hideChaff(),this.startComment.showContextMenu(e)):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),m.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startWorkspace_),this.startWorkspace_.showContextMenu(e)),e.preventDefault(),e.stopPropagation(),Pd.setIsActive(!1),this.dispose()}handleWsStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(t),this.mostRecentEvent=e,this.startBlock||this.startBubble||this.startComment?this.startBlock&&m.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.startBlock):m.getFocusManager$$module$build$src$core$focus_manager().focusNode(t),this.doStart(e)}fireWorkspaceClick(e){g(new(f(_.CLICK))(null,e.id,"workspace"))}handleFlyoutStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(t),this.handleWsStart(e,t.getWorkspace())}handleBlockStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(t),this.mostRecentEvent=e}handleBubbleStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(t),this.mostRecentEvent=e}handleCommentStart(e,t){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleCommentStart, but the gesture had already been started.");this.setStartComment(t),this.mostRecentEvent=e}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.bringBlockToFront(),this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent)}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.bringBlockToFront(),this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");var e;this.flyout.isBlockCreatable(this.targetBlock)&&(m.getGroup$$module$build$src$core$events$utils()||m.setGroup$$module$build$src$core$events$utils(!0),(e=this.flyout.createBlock(this.targetBlock)).snapToGrid(),e.bumpNeighbours(),m.getFocusManager$$module$build$src$core$focus_manager().focusNode(e))}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");e=new(f(_.CLICK))(this.startBlock,this.startWorkspace_.id,"block"),g(e)}this.bringBlockToFront(),m.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(e){this.fireWorkspaceClick(this.startWorkspace_||this.creatorWorkspace)}bringBlockToFront(){this.targetBlock&&!this.flyout&&(m.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.targetBlock),this.targetBlock.bringToFront())}setStartField(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=e)}setStartIcon(e){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=e)}setStartBubble(e){this.startBubble||(this.startBubble=e)}setStartComment(e){this.startComment||(this.startComment=e)}setStartBlock(e){this.startBlock||this.startBubble||((this.startBlock=e).isInFlyout&&e!==e.getRootBlock()?this.setTargetBlock(e.getRootBlock()):this.setTargetBlock(e))}setTargetBlock(e){e.isShadow()?this.setTargetBlock(e.getParent()):(this.targetBlock=e,m.getFocusManager$$module$build$src$core$focus_manager().focusNode(e))}setStartWorkspace(e){this.startWorkspace_||(this.startWorkspace_=e)}setStartFlyout(e){this.flyout||(this.flyout=e)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isCommentClick(){return!!this.startComment&&!this.hasExceededDragRadius}isBlockClick(){return!(!this.startBlock||this.hasExceededDragRadius||this.isFieldClick()||this.isIconClick())}isFieldClick(){return!!this.startField&&this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose))}isIconClick(){var e;return!!this.startIcon&&(e=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose),!this.hasExceededDragRadius)&&e}isWorkspaceClick(){return!(this.startBlock||this.startBubble||this.startField||this.hasExceededDragRadius)}getCurrentDragger(){var e;return null!=(e=null!=(e=this.workspaceDragger)?e:this.dragger)?e:null}isDragging(){return this.dragging}hasStarted(){return this.gestureHasStarted}static inProgress(){var i=ne();for(let e=0,t;t=i[e];e++)if(t.currentGesture_)return!0;return!1}},Ud=class{constructor(e,t){var i;this.pattern=e,this.scale=1,this.spacing=null!=(i=t.spacing)?i:0,this.length=null!=(i=t.length)?i:1,this.line2=(this.line1=e.firstChild)&&this.line1.nextSibling,this.snapToGrid=null!=(i=t.snap)&&i}setSpacing(e){this.spacing=e,this.update(this.scale)}getSpacing(){return this.spacing}setLength(e){this.length=e,this.update(this.scale)}getLength(){return this.length}setSnapToGrid(e){this.snapToGrid=e}shouldSnap(){return this.snapToGrid}getPatternId(){return this.pattern.id}update(e){this.scale=e;var t=this.spacing*e,i=(this.pattern.setAttribute("width",""+t),this.pattern.setAttribute("height",""+t),(t=Math.floor(this.spacing/2)+.5)-this.length/2),n=t+this.length/2;this.setLineAttributes(this.line1,e,i*=e,n*=e,t*=e,t),this.setLineAttributes(this.line2,e,t,t,i,n)}setLineAttributes(e,t,i,n,o,r){e&&(e.setAttribute("stroke-width",""+t),e.setAttribute("x1",""+i),e.setAttribute("y1",""+o),e.setAttribute("x2",""+n),e.setAttribute("y2",""+r))}moveTo(e,t){this.pattern.setAttribute("x",""+e),this.pattern.setAttribute("y",""+t)}alignXY(e){var t=(n=this.getSpacing())/2,i=Math.round(Math.round((e.x-t)/n)*n+t),n=Math.round(Math.round((e.y-t)/n)*n+t);return i===e.x&&n===e.y?e:new E(i,n)}static createDom(e,t,i,n){return e=l(k.PATTERN,{id:"blocklyGridPattern"+e,patternUnits:"userSpaceOnUse"},i),0<(null!=(i=t.length)?i:1)&&0<(null!=(i=t.spacing)?i:0)?(l(k.LINE,{stroke:t.colour},e),null!=(i=t.length)&&i&&l(k.LINE,{stroke:t.colour},e)):l(k.LINE,{},e),n&&n.style.setProperty("--blocklyGridPattern",`url(#${e.id})`),e}},Hd=class{constructor(e){this.workspace=e,this.layers=new Map,(e=e.getInjectionDiv())&&(this.dragLayer=this.createDragLayer(e),this.animationLayer=this.createAnimationLayer(e)),e=this.createLayer(50),c(e,"blocklyBlockCanvas"),e=this.createLayer(100),c(e,"blocklyBubbleCanvas")}createDragLayer(e){var t=l(k.SVG,{class:"blocklyBlockDragSurface",xmlns:Oa,"xmlns:html":Aa,"xmlns:xlink":Na,version:"1.1"});return e.append(t),l(k.G,{},t)}createAnimationLayer(e){var t=l(k.SVG,{class:"blocklyAnimationLayer",xmlns:Oa,"xmlns:html":Aa,"xmlns:xlink":Na,version:"1.1"});return e.append(t),l(k.G,{},t)}appendToAnimationLayer(e){var t,i=null==(i=this.dragLayer)?void 0:i.getAttribute("transform");i&&null!=(t=this.animationLayer)&&t.setAttribute("transform",i),null!=(t=this.animationLayer)&&t.appendChild(e.getSvgRoot())}translateLayers(e,t){var i;e=`translate(${e.x}, ${e.y}) scale(${t})`,null!=(t=this.dragLayer)&&t.setAttribute("transform",e);for([,i]of this.layers)i.setAttribute("transform",e)}moveToDragLayer(e){var t;null!=(t=this.dragLayer)&&t.appendChild(e.getSvgRoot()),e.canBeFocused()&&m.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}moveOffDragLayer(e,t){this.append(e,t),e.canBeFocused()&&m.getFocusManager$$module$build$src$core$focus_manager().focusNode(e)}append(e,t){var i;this.layers.has(t)||this.createLayer(t),e=e.getSvgRoot(),(null==(i=this.layers.get(t))?void 0:i.lastChild)!==e&&null!=(i=this.layers.get(t))&&i.appendChild(e)}createLayer(e){var t,i,n=this.workspace.getSvgGroup(),o=l(k.G,{});let r=!1;for([t,i]of[...this.layers].sort((e,t)=>e[0]-t[0]))if(e<t){n.insertBefore(o,i),r=!0;break}return r||n.appendChild(o),this.layers.set(e,o),o}hasLayer(e){return e===this.dragLayer||new Set(this.layers.values()).has(e)}getBlockLayer(){return this.layers.get(50)}getBubbleLayer(){return this.layers.get(100)}},Gd=class{constructor(){this.curNode=this.colour=null,this.type="marker"}getCurNode(){return this.curNode}setCurNode(e){this.curNode=e}dispose(){this.curNode=null}getSourceBlockFromNode(e){return e instanceof N?e:e instanceof x||e instanceof Qu?e.getSourceBlock():null}getSourceBlock(){return this.getSourceBlockFromNode(this.getCurNode())}},Vd=class extends Gd{constructor(e){super(),this.workspace=e,this.type="cursor",this.potentialNodes=null}next(){var e=this.getCurNode();return e?((e=this.getNextNode(e,e=>{var t;return e instanceof N&&!(null!=(t=e.outputConnection)&&t.targetBlock())||e instanceof ku},!0))&&this.setCurNode(e),e):null}in(){var e=this.getCurNode();return e?((e=this.getNextNode(e,()=>!0,!0))&&this.setCurNode(e),e):null}prev(){var e=this.getCurNode();return e?((e=this.getPreviousNode(e,e=>{var t;return e instanceof N&&!(null!=(t=e.outputConnection)&&t.targetBlock())||e instanceof ku},!0))&&this.setCurNode(e),e):null}out(){var e=this.getCurNode();return e?((e=this.getPreviousNode(e,()=>!0,!0))&&this.setCurNode(e),e):null}atEndOfLine(){var e=this.getCurNode();return!!e&&this.getNextNode(e,()=>!0,!0)===this.getNextNode(e,e=>e instanceof N&&!(null!=(e=e.outputConnection)&&e.targetBlock()),!0)}getNextNodeImpl(e,t,i=new Set){if(!e||i.has(e))return null;let n=this.workspace.getNavigator().getFirstChild(e)||this.workspace.getNavigator().getNextSibling(e);for(var o=e;o&&!n&&(o=this.workspace.getNavigator().getParent(o));)n=this.workspace.getNavigator().getNextSibling(o);return t(n)?n:n?(i.add(e),this.getNextNodeImpl(n,t,i)):null}getNextNode(e,t,i){return!e||!i&&this.getLastNode()===e?null:this.getNextNodeImpl(e,t)}getPreviousNodeImpl(e,t,i=new Set){var n;return!e||i.has(e)?null:t(n=this.getRightMostChild(this.workspace.getNavigator().getPreviousSibling(e),e)||this.workspace.getNavigator().getParent(e))?n:n?(i.add(e),this.getPreviousNodeImpl(n,t,i)):null}getPreviousNode(e,t,i){return!e||!i&&this.getFirstNode()===e?null:this.getPreviousNodeImpl(e,t)}getRightMostChild(e,t){if(!e)return e;let i=this.workspace.getNavigator().getFirstChild(e);if(!i||i===t)return e;for(e=i;e&&e!==t;e=this.workspace.getNavigator().getNextSibling(i))i=e;return this.getRightMostChild(i,t)}preDelete(e){var t,i=(i=this.getCurNode())?[i]:[],n=null!=(n=null==(t=e.previousConnection)?void 0:t.targetConnection)?n:null==(n=e.outputConnection)?void 0:n.targetConnection;n&&i.push(n),(t=e.getNextBlock())&&i.push(t),(e=e.getParent())&&i.push(e),i.push(this.workspace),this.potentialNodes=i}postDelete(){var e,t,i=this.potentialNodes;if(this.potentialNodes=null,!i)throw Error("must call preDelete first");for(e of i)if(null==(t=this.getSourceBlockFromNode(e))||!t.disposed)return void this.setCurNode(e);throw Error("no valid nodes in this.potentialNodes")}getCurNode(){return m.getFocusManager$$module$build$src$core$focus_manager().getFocusedNode()}setCurNode(e){m.getFocusManager$$module$build$src$core$focus_manager().focusNode(e),e instanceof N?e.workspace.scrollBoundsIntoView(e.getBoundingRectangleWithoutChildren()):e instanceof x?(e=e.getSourceBlock()).workspace.scrollBoundsIntoView(e.getBoundingRectangleWithoutChildren()):e instanceof ku&&e.workspace.scrollBoundsIntoView(e.getBoundingRectangle())}getFirstNode(){return this.workspace.getNavigator().getFirstChild(this.workspace)}getLastNode(){var e=this.getFirstNode();return this.getPreviousNode(e,()=>!0,!0)}},jd=(o(b.CURSOR,Us,Vd),class{constructor(e){this.workspace=e,this.markers=new Map,this.cursor=new Vd(this.workspace)}registerMarker(e,t){this.markers.has(e)&&this.unregisterMarker(e),this.markers.set(e,t)}unregisterMarker(e){var t=this.markers.get(e);if(!t)throw Error("Marker with ID "+e+" does not exist. Can only unregister markers that exist.");t.dispose(),this.markers.delete(e)}getCursor(){return this.cursor}getMarker(e){return this.markers.get(e)||null}setCursor(e){this.cursor=e}dispose(){var i=Object.keys(this.markers);for(let e=0,t;t=i[e];e++)this.unregisterMarker(t);this.markers.clear(),this.cursor.dispose()}}),Wd=(jd.LOCAL_MARKER="local_marker_1",class extends O{constructor(e,t,i){super(e,t,i,Wd.createTextArea()),this.workspace=e,this.anchor=t,this.ownerRect=i,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.locationChangeListeners=[],this.text="",this.DEFAULT_SIZE=new I(160+O.DOUBLE_BORDER,80+O.DOUBLE_BORDER),this.MIN_SIZE=new I(45+O.DOUBLE_BORDER,20+O.DOUBLE_BORDER),this.editable=!0,c(this.svgRoot,"blocklyTextInputBubble"),this.textArea=this.getFocusableElement(),this.inputRoot=this.createEditor(this.contentContainer,this.textArea),this.resizeGroup=this.createResizeHandle(this.svgRoot,e),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.text}setText(e){this.text=e,this.textArea.value=e,this.onTextChange()}setEditable(e){(this.editable=e)?this.textArea.removeAttribute("readonly"):this.textArea.setAttribute("readonly","")}isEditable(){return this.editable}addTextChangeListener(e){this.textChangeListeners.push(e)}addSizeChangeListener(e){this.sizeChangeListeners.push(e)}addLocationChangeListener(e){this.locationChangeListeners.push(e)}static createTextArea(){var e=document.createElementNS(Aa,"textarea");return e.className="blocklyTextarea blocklyText",e}createEditor(e,t){e=l(k.FOREIGNOBJECT,{x:O.BORDER_WIDTH,y:O.BORDER_WIDTH},e);var i=document.createElementNS(Aa,"body");return i.setAttribute("xmlns",Aa),i.className="blocklyMinimalBody",t.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),i.appendChild(t),e.appendChild(i),this.bindTextAreaEvents(t),e}bindTextAreaEvents(e){p(e,"wheel",this,e=>{e.stopPropagation()}),p(e,"pointerdown",this,e=>{e.stopPropagation(),_s()}),p(e,"change",this,this.onTextChange)}createResizeHandle(e,t){return e=l(k.IMAGE,{class:"blocklyResizeHandle",href:t.options.pathToMedia+"resize-handle.svg"},e),p(e,"pointerdown",this,this.onResizePointerDown),e}setSize(e,t=!1){e.width=Math.max(e.width,this.MIN_SIZE.width),e.height=Math.max(e.height,this.MIN_SIZE.height);var i=e.width-O.DOUBLE_BORDER,n=e.height-O.DOUBLE_BORDER;this.inputRoot.setAttribute("width",""+i),this.inputRoot.setAttribute("height",""+n),this.resizeGroup.setAttribute("y",""+n),this.workspace.RTL?this.resizeGroup.setAttribute("x",""+-O.DOUBLE_BORDER):this.resizeGroup.setAttribute("x",""+i),super.setSize(e,t),this.onSizeChange()}getSize(){return super.getSize()}moveDuringDrag(e){super.moveDuringDrag(e),this.onLocationChange()}setPositionRelativeToAnchor(e,t){super.setPositionRelativeToAnchor(e,t),this.onLocationChange()}positionByRect(e=new C(0,0,0,0)){super.positionByRect(e),this.onLocationChange()}onResizePointerDown(e){this.bringToFront(),Cs(e)||(Sn(this.workspace,e,new E(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=p(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=p(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),e.stopPropagation()}onResizePointerUp(e){_s(),this.resizePointerUpListener&&(r(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(r(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(e){e=xn(this.workspace,e),this.setSize(new I(this.workspace.RTL?-e.x:e.x,e.y),!1),this.onSizeChange()}onTextChange(){this.text=this.textArea.value;for(var e of this.textChangeListeners)e()}onSizeChange(){for(var e of this.sizeChangeListeners)e()}onLocationChange(){for(var e of this.locationChangeListeners)e()}}),Vu=(be("\n.blocklyTextInputBubble .blocklyTextarea {\n  background-color: var(--commentFillColour);\n  border: 0;\n  box-sizing: border-box;\n  display: block;\n  outline: 0;\n  padding: 5px;\n  resize: none;\n  width: 100%;\n  height: 100%;\n}\n"),{}),zd=(Vu.register=pp,Vu.unregister=hp,class extends Hu{constructor(e){super(e),this.sourceBlock=e,this.textInputBubble=null,this.text="",this.bubbleSize=new I(160,80),this.bubbleVisiblity=!1}getType(){return zd.TYPE}initView(e){this.svgRoot||(super.initView(e),l(k.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),l(k.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),l(k.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot),c(this.svgRoot,"blocklyCommentIcon"))}dispose(){var e;super.dispose(),null!=(e=this.textInputBubble)&&e.dispose()}getWeight(){return zd.WEIGHT}getSize(){return new I(17,17)}applyColour(){super.applyColour();var e,t=this.sourceBlock.getColour();null!=(e=this.textInputBubble)&&e.setColour(t)}updateEditable(){let e=this,t=()=>super.updateEditable;return(0,h.asyncExecutePromiseGeneratorFunction)(function*(){t().call(e),e.bubbleIsVisible()&&(yield e.setBubbleVisible(!1),yield e.setBubbleVisible(!0))})}onLocationChange(e){var t=this.workspaceLocation;super.onLocationChange(e),this.bubbleLocation&&(e=E.difference(this.workspaceLocation,t),this.bubbleLocation=E.sum(this.bubbleLocation,e)),e=this.getAnchorLocation(),null!=(t=this.textInputBubble)&&t.setAnchorLocation(e)}setText(e){var t=this.text;g(new(f(_.BLOCK_CHANGE))(this.sourceBlock,"comment",null,t,e)),this.text=e,null!=(t=this.textInputBubble)&&t.setText(this.text)}getText(){return this.text}setBubbleSize(e){this.bubbleSize=e,null!=(e=this.textInputBubble)&&e.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}setBubbleLocation(e){var t;this.bubbleLocation=e,null!=(t=this.textInputBubble)&&t.moveDuringDrag(e)}getBubbleLocation(){return this.bubbleLocation}saveState(){var e,t;return this.text?(e={text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width},(t=this.getBubbleLocation())&&(e.x=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(t.x+this.bubbleSize.width):t.x,e.y=t.y),e):null}loadState(e){var t;this.text=null!=(t=e.text)?t:"",this.bubbleSize=new I(null!=(t=e.width)?t:160,null!=(t=e.height)?t:80),this.bubbleVisiblity=null!=(t=e.pinned)&&t,this.setBubbleVisible(this.bubbleVisiblity);let i=e.x,n=e.y;tt().then(()=>{i&&n&&(i=this.sourceBlock.workspace.RTL?this.sourceBlock.workspace.getWidth()-(i+this.bubbleSize.width):i,this.setBubbleLocation(new E(i,n)))})}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){var e;this.textInputBubble&&(e=this.textInputBubble.getText(),this.text!==e)&&(g(new(f(_.BLOCK_CHANGE))(this.sourceBlock,"comment",null,this.text,e)),this.text=e)}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}onBubbleLocationChange(){this.textInputBubble&&(this.bubbleLocation=this.textInputBubble.getRelativeToSurfaceXY())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(e){let t=this;return(0,h.asyncExecutePromiseGeneratorFunction)(function*(){t.bubbleVisiblity!==e&&(t.bubbleVisiblity=e,yield tt(),!t.sourceBlock.rendered||t.sourceBlock.isInFlyout||t.sourceBlock.isInsertionMarker()||(e?(t.sourceBlock.isEditable()?t.showEditableBubble():t.showNonEditableBubble(),t.applyColour()):t.hideBubble(),g(new(f(_.BUBBLE_OPEN))(t.sourceBlock,e,"comment"))))})}getBubble(){return this.textInputBubble}showEditableBubble(){var e;this.createBubble(),null!=(e=this.textInputBubble)&&e.addTextChangeListener(()=>this.onTextChange()),null!=(e=this.textInputBubble)&&e.addSizeChangeListener(()=>this.onSizeChange())}showNonEditableBubble(){var e;this.createBubble(),null!=(e=this.textInputBubble)&&e.setEditable(!1)}createBubble(){this.textInputBubble=new Wd(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.bubbleLocation&&this.textInputBubble.moveDuringDrag(this.bubbleLocation),this.textInputBubble.addTextChangeListener(()=>this.onTextChange()),this.textInputBubble.addSizeChangeListener(()=>this.onSizeChange()),this.textInputBubble.addLocationChangeListener(()=>this.onBubbleLocationChange())}hideBubble(){var e;null!=(e=this.textInputBubble)&&e.dispose(),this.textInputBubble=null}getAnchorLocation(){return E.sum(this.workspaceLocation,new E(8.5,8.5))}getBubbleOwnerRect(){return this.sourceBlock.getBoundingRectangleWithoutChildren()}}),Yd=(zd.TYPE=uc.COMMENT,zd.WEIGHT=3,pp(zd.TYPE,zd),{});Yd.CommentIcon=zd,Yd.Icon=Hu,Yd.IconType=uc,Yd.MutatorIcon=m.MutatorIcon$$module$build$src$core$icons$mutator_icon,Yd.WarningIcon=hd,Yd.exceptions=Ku,Yd.registry=Vu;m.Names$$module$build$src$core$names=class{constructor(e,t){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=t||"",this.reservedWords=new Set(e?e.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(e){this.variableMap=e}getNameForUserVariable(e){return this.variableMap?(e=this.variableMap.getVariableById(e))?e.getName():null:(console.warn("Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:\nBlockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());"),null)}populateVariables(t){t=m.allUsedVarModels$$module$build$src$core$variables(t);for(let e=0;e<t.length;e++)this.getName(t[e].getId(),m.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(e){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(e,t){let i=e;e=(i=t===m.NameType$$module$build$src$core$names.VARIABLE&&(e=this.getNameForUserVariable(e))?e:i).toLowerCase();var n=t===m.NameType$$module$build$src$core$names.VARIABLE||t===m.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"",o=(this.db.has(t)||this.db.set(t,new Map),this.db.get(t));return o.has(e)?n+o.get(e):(t=this.getDistinctName(i,t),o.set(e,t.substr(n.length)),t)}getUserNames(e){var t;return(e=null==(t=this.db.get(e))?void 0:t.keys())?Array.from(e):[]}getDistinctName(e,t){e=this.safeName(e);let i=null,n,o;for(;this.dbReverse.has(e+(null!=(n=i)?n:""))||this.reservedWords.has(e+(null!=(o=i)?o:""));)i=i?i+1:2;var r;return e+=null!=(r=i)?r:"",this.dbReverse.add(e),(t===m.NameType$$module$build$src$core$names.VARIABLE||t===m.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+e}safeName(e){return e?(e=encodeURI(e.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".includes(e[0])&&(e="my_"+e)):e=m.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",e}static equals(e,t){return e.toLowerCase()===t.toLowerCase()}},(M=(M=m.Names$$module$build$src$core$names||(m.Names$$module$build$src$core$names={})).NameType||(M.NameType={})).DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",M.VARIABLE="VARIABLE",M.PROCEDURE="PROCEDURE",m.NameType$$module$build$src$core$names=m.Names$$module$build$src$core$names.NameType,m.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=m.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE;({NameType:m.NameType$$module$build$src$core$names}).Names=m.Names$$module$build$src$core$names;var Kd,Xd,qd,Jd,Zd=class extends Map{constructor(){super()}set(e,t){return this.get(e)!==t&&(super.set(e,t),Ho(t))&&t.startPublishing(),this}delete(e){var t=this.get(e);return(e=super.delete(e))&&Ho(t)&&t.stopPublishing(),e}clear(){if(this.size)for(var e of this.keys())this.delete(e)}add(e){return this.set(e.getId(),e)}getProcedures(){return[...this.values()]}},Qd="PROCEDURE",L=(m.DEFAULT_ARG$$module$build$src$core$procedures="x",(Kd={CATEGORY_NAME:Qd,DEFAULT_ARG:m.DEFAULT_ARG$$module$build$src$core$procedures}).ObservableProcedureMap=Zd,Kd.allProcedures=Go,Kd.findLegalName=m.findLegalName$$module$build$src$core$procedures,Kd.flyoutCategory=Ko,Kd.getCallers=Zo,Kd.getDefinition=m.getDefinition$$module$build$src$core$procedures,Kd.internalFlyoutCategory=Yo,Kd.isNameUsed=Wo,Kd.isProcedureBlock=Uo,Kd.mutateCallers=m.mutateCallers$$module$build$src$core$procedures,Kd.mutatorOpenListener=qo,Kd.rename=m.rename$$module$build$src$core$procedures,new class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(e){return Object.prototype.hasOwnProperty.call(this,e)||(this[e]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[e]}isField(e){return 1<=(e.type&this.FIELD)}isHat(e){return 1<=(e.type&this.HAT)}isIcon(e){return 1<=(e.type&this.ICON)}isSpacer(e){return 1<=(e.type&this.SPACER)}isInRowSpacer(e){return 1<=(e.type&this.IN_ROW_SPACER)}isSpacerRow(e){return 1<=(e.type&this.BETWEEN_ROW_SPACER)}isInput(e){return 1<=(e.type&this.INPUT)}isExternalInput(e){return 1<=(e.type&this.EXTERNAL_VALUE_INPUT)}isInlineInput(e){return 1<=(e.type&this.INLINE_INPUT)}isStatementInput(e){return 1<=(e.type&this.STATEMENT_INPUT)}isPreviousConnection(e){return 1<=(e.type&this.PREVIOUS_CONNECTION)}isNextConnection(e){return 1<=(e.type&this.NEXT_CONNECTION)}isPreviousOrNextConnection(e){return this.isPreviousConnection(e)||this.isNextConnection(e)}isRoundCorner(e){return 1<=(e.type&this.LEFT_ROUND_CORNER)||1<=(e.type&this.RIGHT_ROUND_CORNER)}isLeftRoundedCorner(e){return this.isRoundCorner(e)&&1<=(e.type&this.LEFT_ROUND_CORNER)}isRightRoundedCorner(e){return this.isRoundCorner(e)&&1<=(e.type&this.RIGHT_ROUND_CORNER)}isLeftSquareCorner(e){return 1<=(e.type&this.LEFT_SQUARE_CORNER)}isRightSquareCorner(e){return 1<=(e.type&this.RIGHT_SQUARE_CORNER)}isCorner(e){return 1<=(e.type&this.CORNER)}isJaggedEdge(e){return 1<=(e.type&this.JAGGED_EDGE)}isRow(e){return 1<=(e.type&this.ROW)}isBetweenRowSpacer(e){return 1<=(e.type&this.BETWEEN_ROW_SPACER)}isTopRow(e){return 1<=(e.type&this.TOP_ROW)}isBottomRow(e){return 1<=(e.type&this.BOTTOM_ROW)}isTopOrBottomRow(e){return this.isTopRow(e)||this.isBottomRow(e)}isInputRow(e){return 1<=(e.type&this.INPUT_ROW)}}),D=class{constructor(e){this.centerline=this.xPos=this.height=this.width=0,this.constants_=e,this.type=L.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},w=class{constructor(e){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=e,this.type=L.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let e=this.elements.length-1;0<=e;e--){var t=this.elements[e];if(L.isInput(t))return t}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let e=0;e<this.elements.length;e++){var t=this.elements[e];if(L.isInRowSpacer(t))return t}return null}getLastSpacer(){for(let e=this.elements.length-1;0<=e;e--){var t=this.elements[e];if(L.isInRowSpacer(t))return t}return null}},eh=class extends w{constructor(e){super(e),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=L.BOTTOM_ROW}hasLeftSquareCorner(e){return!!e.outputConnection||!!e.getNextBlock()}hasRightSquareCorner(e){return!0}measure(){let t=0,i=0,n=0;for(let e=0;e<this.elements.length;e++){var o=this.elements[e];i+=o.width,L.isSpacer(o)||(L.isNextConnection(o)?n=Math.max(n,o.height):t=Math.max(t,o.height))}this.width=Math.max(this.minWidth,i),this.height=Math.max(this.minHeight,t)+n,this.descenderHeight=n,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},th=class extends D{constructor(e,t){super(e),this.connectionModel=t,this.type|=L.CONNECTION,this.shape=this.constants_.shapeFor(t),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.highlighted=t.isHighlighted()}},Ya=class extends th{constructor(e,t){super(e,t.connection),this.input=t,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=L.INPUT,this.align=t.align,(this.connectedBlock=t.connection&&t.connection.targetBlock()?t.connection.targetBlock():null)?(e=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=e.width,this.connectedBlockHeight=e.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},ih=class extends Ya{constructor(e,t){super(e,t),this.height=0,this.type|=L.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},nh=class extends D{constructor(e,t,i){super(e),this.field=t,this.parentInput=i,this.isEditable=t.EDITABLE,this.flipRtl=t.getFlipRtl(),this.type|=L.FIELD,e=this.field.getSize(),this.height=e.height,this.width=e.width}},oh=class extends D{constructor(e){super(e),this.type|=L.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},rh=class extends D{constructor(e,t){super(e),this.icon=t,this.flipRtl=!1,this.type|=L.ICON,e=t.getSize(),this.height=e.height,this.width=e.width}},sh=class extends D{constructor(e,t){super(e),this.type|=L.SPACER|L.IN_ROW_SPACER,this.width=t,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},ah=class extends Ya{constructor(e,t){super(e,t),this.type|=L.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},lh=class extends w{constructor(e){super(e),this.connectedBlockWidths=0,this.type|=L.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let t=0;for(let e=0;e<this.elements.length;e++){var i=this.elements[e];this.width+=i.width,L.isInput(i)&&(L.isStatementInput(i)?t+=i.connectedBlockWidth:L.isExternalInput(i)&&0!==i.connectedBlockWidth&&(t+=i.connectedBlockWidth-i.connectionWidth)),L.isSpacer(i)||(this.height=Math.max(this.height,i.height))}this.connectedBlockWidths=t,this.widthWithConnectedBlocks=this.width+t}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},ch=class extends D{constructor(e){super(e),this.type|=L.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},uh=class extends th{constructor(e,t){super(e,t),this.type|=L.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},dh=class extends th{constructor(e,t){super(e,t),this.connectionOffsetX=0,this.type|=L.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},hh=class extends th{constructor(e,t){super(e,t),this.type|=L.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},ph=class extends D{constructor(e,t){super(e),this.type=(t&&"left"!==t?L.RIGHT_ROUND_CORNER:L.LEFT_ROUND_CORNER)|L.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},gh=class extends w{constructor(e,t,i){super(e),this.height=t,this.width=i,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type|=L.SPACER|L.BETWEEN_ROW_SPACER,this.elements=[new sh(this.constants_,i)]}measure(){}},fh=class extends D{constructor(e,t){super(e),this.type=(t&&"left"!==t?L.RIGHT_SQUARE_CORNER:L.LEFT_SQUARE_CORNER)|L.CORNER,this.width=this.height=this.constants_.NO_PADDING}},mh=class extends Ya{constructor(e,t){super(e,t),this.type|=L.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},bh=class extends w{constructor(e){super(e),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=L.TOP_ROW}hasLeftSquareCorner(e){var t=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection,i=e.getPreviousBlock();return!!e.outputConnection||t||!!i&&i.getNextBlock()===e}hasRightSquareCorner(e){return!0}measure(){let t=0,i=0,n=0;for(let e=0;e<this.elements.length;e++){var o=this.elements[e];i+=o.width,L.isSpacer(o)||(L.isHat(o)?n=Math.max(n,o.ascenderHeight):t=Math.max(t,o.height))}this.width=Math.max(this.minWidth,i),this.height=Math.max(this.minHeight,t)+n,this.capline=this.ascenderHeight=n,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},_h=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=ho(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(e){this.blockStyles=Object.create(null);var t,i=e.blockStyles;for(t in i)this.blockStyles[t]=this.validatedBlockStyle_(i[t]);this.setDynamicProperties_(e)}setDynamicProperties_(e){this.setFontConstants_(e),this.setComponentConstants_(e),this.ADD_START_HATS=void 0!==e.startHats?e.startHats:this.ADD_START_HATS}setFontConstants_(e){e.fontStyle&&e.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=e.fontStyle.family),e.fontStyle&&e.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=e.fontStyle.weight),e.fontStyle&&e.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=e.fontStyle.size),e=Z("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=e.height,this.FIELD_TEXT_BASELINE=e.baseline}setComponentConstants_(e){this.CURSOR_COLOUR=e.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=e.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=e.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(e.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(e){var t="auto_"+e;return this.blockStyles[t]||(this.blockStyles[t]=this.createBlockStyle_(e)),{style:this.blockStyles[t],name:t}}getBlockStyle(e){return this.blockStyles[e||""]||(e&&e.startsWith("auto_")?this.getBlockStyleForColour(e.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(e){return this.validatedBlockStyle_({colourPrimary:e})}validatedBlockStyle_(e){var t={};return e&&Object.assign(t,e),e=rn(t.colourPrimary||"#000"),t.colourPrimary=e.hex,t.colourSecondary=t.colourSecondary?rn(t.colourSecondary).hex:this.generateSecondaryColour_(t.colourPrimary),t.colourTertiary=t.colourTertiary?rn(t.colourTertiary).hex:this.generateTertiaryColour_(t.colourPrimary),t.hat=t.hat||"",t}generateSecondaryColour_(e){return Qi("#fff",e,.6)||e}generateTertiaryColour_(e){return Qi("#fff",e,.3)||e}dispose(){this.embossFilter&&a(this.embossFilter),this.disabledPattern&&a(this.disabledPattern),this.debugFilter&&a(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){var e=this.JAGGED_TEETH_HEIGHT,t=this.JAGGED_TEETH_WIDTH;return{height:e,width:t,path:go([u(t,e/4),u(2*-t,e/2),u(t,e/4)])}}makeStartHat(){var e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH;return{height:.75*e,width:t,path:co("c",[u(30,-e),u(70,-e),u(t,0)])}}makePuzzleTab(){function e(e){var t=-(e=e?-1:1),i=2.5+(r=a/2),n=.5+r,o=u(-s,e*r),r=u(s,e*r);return co("c",[u(0,e*i),u(-s,t*n),o])+co("s",[u(s,2.5*t),r])}let s=this.TAB_WIDTH,a=this.TAB_HEIGHT,t=e(!0),i=e(!1);return{type:this.SHAPES.PUZZLE,width:s,height:a,pathDown:i,pathUp:t}}makeNotch(){function e(e){return go([u(e*n,i),u(3*e,0),u(e*n,-i)])}let t=this.NOTCH_WIDTH,i=this.NOTCH_HEIGHT,n=(t-3)/2,o=e(1),r=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:i,pathLeft:o,pathRight:r}}makeInsideCorners(){var e=this.CORNER_RADIUS;return{width:e,height:e,pathTop:fo("a","0 0,0",e,u(-e,e)),pathBottom:fo("a","0 0,0",e,u(e,e))}}makeOutsideCorners(){var e=this.CORNER_RADIUS,t=ho(0,e)+fo("a","0 0,1",e,u(e,-e)),i=fo("a","0 0,1",e,u(e,e)),n=fo("a","0 0,1",e,u(-e,-e));return{topLeft:t,topRight:i,bottomRight:fo("a","0 0,1",e,u(-e,e)),bottomLeft:n,rightHeight:e}}shapeFor(e){switch(e.type){case v.INPUT_VALUE:case v.OUTPUT_VALUE:return this.PUZZLE_TAB;case v.PREVIOUS_STATEMENT:case v.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(e,t,i,n){this.injectCSS_(t,i),this.defs=l(k.DEFS,{},e),e=l(k.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),l(k.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},e),t=l(k.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},e),l(k.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},t),l(k.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},e),l(k.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},e),this.embossFilterId=e.id,this.embossFilter=e,e=l(k.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),l(k.RECT,{width:10,height:10,fill:"#aaa"},e),l(k.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},e),this.disabledPatternId=e.id,this.disabledPattern=e,this.createDebugFilter(),n&&(n.style.setProperty("--blocklyEmbossFilter",`url(#${this.embossFilterId})`),n.style.setProperty("--blocklyDisabledPattern",`url(#${this.disabledPatternId})`),n.style.setProperty("--blocklyDebugFilter",`url(#${this.debugFilterId})`))}createDebugFilter(){var e,t;this.debugFilter||(e=l(k.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),t=l(k.FECOMPONENTTRANSFER,{result:"outBlur"},e),l(k.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),l(k.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},e),l(k.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),this.debugFilterId=e.id,this.debugFilter=e)}injectCSS_(e,t){t=this.getCSS_(t),e="blockly-renderer-style-"+e,this.cssNode=document.getElementById(e);var i=t.join("\n");this.cssNode?this.cssNode.firstChild.textContent=i:((t=document.createElement("style")).id=e,e=document.createTextNode(i),t.appendChild(e),document.head.insertBefore(t,document.head.firstChild),this.cssNode=t)}getCSS_(e){return[e+" .blocklyText, ",e+" .blocklyFlyoutLabelText {",`font: ${this.FIELD_TEXT_FONTWEIGHT} `+`${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",e+" .blocklyText {","fill: #fff;","}",e+" .blocklyNonEditableField>rect,",e+" .blocklyEditableField>rect {",`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",e+" .blocklyNonEditableField>text,",e+" .blocklyEditableField>text {","fill: #000;","}",e+" .blocklyFlyoutLabelText {","fill: #000;","}",e+" .blocklyText.blocklyBubbleText {","fill: #000;","}",e+" .blocklyEditableField:not(.blocklyEditing):hover>rect {","stroke: #fff;","stroke-width: 2;","}",e+" .blocklyHtmlInput {",`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",e+" .blocklySelected>.blocklyPath {","stroke: #fc3;","stroke-width: 3px;","}",e+" .blocklyHighlightedConnectionPath {","stroke: #fc3;","}",e+" .blocklyReplaceable .blocklyPath {","fill-opacity: .5;","}",e+" .blocklyReplaceable .blocklyPathLight,",e+" .blocklyReplaceable .blocklyPathDark {","display: none;","}",e+" .blocklyInsertionMarker>.blocklyPath {",`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},yh=class{constructor(e,t){this.inlinePath_=this.outlinePath_="",this.block_=e,this.info_=t,this.topLeft_=e.getRelativeToSurfaceXY(),this.constants_=t.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),this.block_.pathObject.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren,this.block_.childlessWidth=this.info_.width}drawOutline_(){this.drawTop_();for(let e=1;e<this.info_.rows.length-1;e++){var t=this.info_.rows[e];t.hasJaggedEdge?this.drawJaggedEdge_(t):t.hasStatement?this.drawStatementInput_(t):t.hasExternalInput?this.drawValueInput_(t):this.drawRightSideRow_(t)}this.drawBottom_(),this.drawLeft_()}drawTop_(){var e=this.info_.topRow,i=e.elements;this.positionPreviousConnection_(),this.outlinePath_+=ho(e.xPos,this.info_.startY);for(let e=0,t;t=i[e];e++)L.isLeftRoundedCorner(t)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:L.isRightRoundedCorner(t)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:L.isPreviousConnection(t)?this.outlinePath_+=t.shape.pathLeft:L.isHat(t)?this.outlinePath_+=this.constants_.START_HAT.path:L.isSpacer(t)&&(this.outlinePath_+=d("h",t.width));this.outlinePath_+=d("v",e.height)}drawJaggedEdge_(e){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+d("v",e.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(e){var t=e.getLastInput(),i=(this.positionExternalValueConnection_(e),er(t.shape)?t.shape.pathDown(t.height):t.shape.pathDown);this.outlinePath_+=d("H",t.xPos+t.width)+i+d("v",e.height-t.connectionHeight)}drawStatementInput_(e){var t,i,n=e.getLastInput();n&&(t=n.xPos+n.notchOffset+n.shape.width,n=n.shape.pathRight+d("h",-(n.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop,i=e.height-2*this.constants_.INSIDE_CORNERS.height,this.outlinePath_+=d("H",t)+n+d("v",i)+this.constants_.INSIDE_CORNERS.pathBottom+d("H",e.xPos+e.width),this.positionStatementInputConnection_(e))}drawRightSideRow_(e){this.outlinePath_+=d("V",e.yPos+e.height)}drawBottom_(){var i=this.info_.bottomRow,n=i.elements;this.positionNextConnection_();let o=0,r="";for(let e=n.length-1,t;t=n[e];e--)L.isNextConnection(t)?r+=t.shape.pathRight:L.isLeftSquareCorner(t)?r+=d("H",i.xPos):L.isLeftRoundedCorner(t)?r+=this.constants_.OUTSIDE_CORNERS.bottomLeft:L.isRightRoundedCorner(t)?(r+=this.constants_.OUTSIDE_CORNERS.bottomRight,o=this.constants_.OUTSIDE_CORNERS.rightHeight):L.isSpacer(t)&&(r+=d("h",-1*t.width));this.outlinePath_+=d("V",i.baseline-o),this.outlinePath_+=r}drawLeft_(){var e,t=this.info_.outputConnection;this.positionOutputConnection_(),t&&(e=t.connectionOffsetY+t.height,t=er(t.shape)?t.shape.pathUp(t.height):t.shape.pathUp,this.outlinePath_+=d("V",e)+t),this.outlinePath_+="z"}drawInternals_(){for(let e=0,i;i=this.info_.rows[e];e++)for(let e=0,t;t=i.elements[e];e++)L.isInlineInput(t)?this.drawInlineInput_(t):(L.isIcon(t)||L.isField(t))&&this.layoutField_(t)}layoutField_(e){var t=e.centerline-e.height/2;let i=e.xPos;var n="";this.info_.RTL&&(i=-(i+e.width),e.flipRtl)&&(i+=e.width,n="scale(-1 1)"),L.isIcon(e)?((n=e.icon).setOffsetInBlock(new E(i,t)),this.info_.isInsertionMarker&&n.hideForInsertionMarker()):((e=e.field.getSvgRoot()).setAttribute("transform","translate("+i+","+t+")"+n),this.info_.isInsertionMarker&&e.setAttribute("display","none"))}drawInlineInput_(e){var t=e.width,i=e.height,n=e.connectionOffsetY;this.inlinePath_+=uo(e.xPos+e.connectionWidth,e.centerline-i/2)+d("v",n)+e.shape.pathDown+d("v",i-(e.connectionHeight+n))+d("h",t-e.connectionWidth)+d("v",-i)+"z",this.positionInlineInputConnection_(e)}positionInlineInputConnection_(t){var i=t.centerline-t.height/2;if(t.connectionModel){let e=t.xPos+t.connectionWidth+t.connectionOffsetX;this.info_.RTL&&(e*=-1),t.connectionModel.setOffsetInBlock(e,i+t.connectionOffsetY)}}positionStatementInputConnection_(t){var i=t.getLastInput();if(null!=i&&i.connectionModel){let e=t.xPos+t.statementEdge+i.notchOffset;this.info_.RTL&&(e*=-1),i.connectionModel.setOffsetInBlock(e,t.yPos)}}positionExternalValueConnection_(t){var i=t.getLastInput();if(i&&i.connectionModel){let e=t.xPos+t.width;this.info_.RTL&&(e*=-1),i.connectionModel.setOffsetInBlock(e,t.yPos)}}positionPreviousConnection_(){var e,t=this.info_.topRow;t.connection&&(e=t.xPos+t.notchOffset,t.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-e:e,0))}positionNextConnection_(){var e,t,i=this.info_.bottomRow;i.connection&&(t=(e=i.connection).xPos,e.connectionModel.setOffsetInBlock(this.info_.RTL?-t:t,i.baseline))}positionOutputConnection_(){var e;this.info_.outputConnection&&(e=this.info_.startX+this.info_.outputConnection.connectionOffsetX,this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-e:e,this.info_.outputConnection.connectionOffsetY))}updateConnectionHighlights(){for(var e of this.info_.rows)for(var t of e.elements){var i;t instanceof th&&(i=this.drawConnectionHighlightPath(t))&&(i.style.display=t.highlighted?"":"none")}}drawConnectionHighlightPath(e){var t,i,n=e.connectionModel,o=(e=n.type===v.INPUT_VALUE||n.type===v.OUTPUT_VALUE?this.getExpressionConnectionHighlightPath(e):this.getStatementConnectionHighlightPath(e),n.getSourceBlock());return null==(i=(t=o.pathObject).addConnectionHighlight)?void 0:i.call(t,n,e,n.getOffsetInBlock(),o.RTL)}getExpressionConnectionHighlightPath(e){let t="";return er(e.shape)?t=e.shape.pathDown(e.height):tr(e.shape)&&(t=e.shape.pathDown),e=this.constants_.TAB_OFFSET_FROM_TOP,ho(0,-e)+d("v",e)+t+d("v",e)}getStatementConnectionHighlightPath(e){var t;if(ir(e.shape))return t=this.constants_.NOTCH_OFFSET_LEFT-this.constants_.CORNER_RADIUS,ho(-t,0)+d("h",t)+e.shape.pathLeft+d("h",t);throw Error("Statement connections should have notch shapes")}},vh=class{constructor(e,t){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=e,this.block_=t,this.constants_=this.renderer_.getConstants(),this.outputConnection=t.outputConnection?new dh(this.constants_,t.outputConnection):null,this.isInline=t.getInputsInline()&&!t.isCollapsed(),this.isCollapsed=t.isCollapsed(),this.isInsertionMarker=t.isInsertionMarker(),this.RTL=t.RTL,this.topRow=new bh(this.constants_),this.bottomRow=new eh(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let n=new lh(this.constants_);this.inputRows.push(n);var o=this.block_.getIcons();for(let e=0,t;t=o[e];e++){var i=new rh(this.constants_,t);this.isCollapsed&&!t.isShownWhenCollapsed()||n.elements.push(i)}o=void 0;for(let e=0,i;i=this.block_.inputList[e];e++)if(i.isVisible()){this.shouldStartNewRow_(i,o)&&(this.rows.push(n),n=new lh(this.constants_),this.inputRows.push(n));for(let e=0,t;t=i.fieldRow[e];e++)n.elements.push(new nh(this.constants_,t,i));this.addInput_(i,n),o=i}this.isCollapsed&&(n.hasJaggedEdge=!0,n.elements.push(new ch(this.constants_))),(n.elements.length||n.hasDummyInput)&&this.rows.push(n),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var e=!!this.block_.previousConnection,t=(this.block_.hat?"cap"===this.block_.hat:this.constants_.ADD_START_HATS)&&!this.outputConnection&&!e;let i=this.topRow.hasLeftSquareCorner(this.block_)?fh:ph;this.topRow.elements.push(new i(this.constants_)),t?(e=new oh(this.constants_),this.topRow.elements.push(e)):e&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new hh(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0]instanceof nd&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,i=this.topRow.hasRightSquareCorner(this.block_)?fh:ph,this.topRow.elements.push(new i(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof nd?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new fh(this.constants_)):this.bottomRow.elements.push(new ph(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new uh(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new fh(this.constants_,"right")):this.bottomRow.elements.push(new ph(this.constants_,"right"))}addInput_(e,t){this.isInline&&e instanceof m.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new ah(this.constants_,e)),t.hasInlineInput=!0):e instanceof nd?(t.elements.push(new mh(this.constants_,e)),t.hasStatement=!0):e instanceof m.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new ih(this.constants_,e)),t.hasExternalInput=!0):(e instanceof td||e instanceof id)&&(t.minHeight=Math.max(t.minHeight,e.getSourceBlock()&&e.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),null===t.align&&(t.align=e.align)}shouldStartNewRow_(e,t){return!!t&&(t instanceof id||e instanceof nd||t instanceof nd||(e instanceof m.ValueInput$$module$build$src$core$inputs$value_input||e instanceof td||t instanceof m.ValueInput$$module$build$src$core$inputs$value_input)&&!this.isInline)}addElemSpacing_(){for(let e=0,t;t=this.rows[e];e++){var i=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new sh(this.constants_,this.getInRowSpacing_(null,i[0]))),i.length){for(let e=0;e<i.length-1;e++){t.elements.push(i[e]);var n=this.getInRowSpacing_(i[e],i[e+1]);t.elements.push(new sh(this.constants_,n))}t.elements.push(i[i.length-1]),t.endsWithElemSpacer()&&t.elements.push(new sh(this.constants_,this.getInRowSpacing_(i[i.length-1],null)))}}}getInRowSpacing_(e,t){if(!e&&t&&L.isStatementInput(t))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(e&&L.isInput(e)&&!t){if(L.isExternalInput(e))return this.constants_.NO_PADDING;if(L.isInlineInput(e))return this.constants_.LARGE_PADDING;if(L.isStatementInput(e))return this.constants_.NO_PADDING}return e&&L.isLeftSquareCorner(e)&&t&&(L.isPreviousConnection(t)||L.isNextConnection(t))?t.notchOffset:e&&L.isLeftRoundedCorner(e)&&t&&(L.isPreviousConnection(t)||L.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&L.isField(e)&&0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING}computeBounds_(){let i=0,n=0,o=0;for(let e=0,t;t=this.rows[e];e++){var r,s;t.measure(),n=Math.max(n,t.width),t.hasStatement&&(s=t.getLastInput(),s=t.width-(null!=(r=null==s?void 0:s.width)?r:0),i=Math.max(i,s)),o=Math.max(o,t.widthWithConnectedBlocks)}this.statementEdge=i,this.width=n;for(let e=0,t;t=this.rows[e];e++)t.hasStatement&&(t.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(n,o),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let e=0,t;t=this.rows[e];e++){var i;t.hasStatement?this.alignStatementRow_(t):(i=t.width,0<(i=this.getDesiredRowWidth_(t)-i)&&this.addAlignmentPadding_(t,i),L.isTopOrBottomRow(t)&&(t.widthWithConnectedBlocks=t.width))}}getDesiredRowWidth_(e){return this.width-this.startX}addAlignmentPadding_(e,t){var i=e.getFirstSpacer(),n=e.getLastSpacer();if((e.hasExternalInput||e.hasStatement)&&(e.widthWithConnectedBlocks+=t),e.align===m.Align$$module$build$src$core$inputs$align.LEFT&&n)n.width+=t;else if(e.align===m.Align$$module$build$src$core$inputs$align.CENTRE&&i&&n)i.width+=t/2,n.width+=t/2;else if(e.align===m.Align$$module$build$src$core$inputs$align.RIGHT&&i)i.width+=t;else{if(!n)return;n.width+=t}e.width+=t}alignStatementRow_(e){var t,i,n=e.getLastInput();n&&(i=e.width-n.width,0<(i=this.statementEdge-i)&&this.addAlignmentPadding_(e,i),i=e.width,t=this.getDesiredRowWidth_(e),n.width+=t-i,n.height=Math.max(n.height,e.height),e.width+=t-i,e.widthWithConnectedBlocks=Math.max(e.width,this.statementEdge+e.connectedBlockWidths))}addRowSpacing_(){var t=this.rows;this.rows=[];for(let e=0;e<t.length;e++)this.rows.push(t[e]),e!==t.length-1&&this.rows.push(this.makeSpacerRow_(t[e],t[e+1]))}makeSpacerRow_(e,t){var i=this.getSpacerRowHeight_(e,t),n=this.getSpacerRowWidth_(e,t),i=new gh(this.constants_,i,n);return e.hasStatement&&(i.followsStatement=!0),t.hasStatement&&(i.precedesStatement=!0),i}getSpacerRowWidth_(e,t){return this.width-this.startX}getSpacerRowHeight_(e,t){return this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){return L.isSpacer(t)?e.yPos+t.height/2:L.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,L.isNextConnection(t)?e+t.height/2:e-t.height/2):L.isTopRow(e)?L.isHat(t)?e.capline-t.height/2:e.capline+t.height/2:e.yPos+e.height/2}recordElemPositions_(i){let n=i.xPos;for(let e=0,t;t=i.elements[e];e++)L.isSpacer(t)&&(t.height=i.height),t.xPos=n,t.centerline=this.getElemCenterline_(i,t),n+=t.width}finalize_(){let i=0,n=0;for(let e=0,t;t=this.rows[e];e++)t.yPos=n,t.xPos=this.startX,n+=t.height,i=Math.max(i,t.widthWithConnectedBlocks),this.recordElemPositions_(t);var e;this.outputConnection&&this.block_.nextConnection&&(e=this.block_.nextConnection.targetBlock())&&(i=Math.max(i,e.getHeightWidth().width)),this.widthWithChildren=i+this.startX,this.height=n,this.startY=this.topRow.capline,this.bottomRow.baseline=n-this.bottomRow.descenderHeight}getMeasureableForConnection(e){var t,i;if((null==(t=this.outputConnection)?void 0:t.connectionModel)===e)return this.outputConnection;for(i of this.rows)for(var n of i.elements)if(n instanceof th&&n.connectionModel===e)return n;return null}},Th=class{constructor(e,t,i){this.connectionHighlights=new WeakMap,this.highlightOffsets=new WeakMap,this.constants=i,this.style=t,this.svgRoot=e,this.svgPath=l(k.PATH,{class:"blocklyPath"},this.svgRoot),this.setClass_("blocklyBlock",!0)}setPath(e){this.svgPath.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}applyColour(e){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(e.isShadow()),this.updateDisabled_(!e.isEnabled()||e.getInheritedDisabled())}setStyle(e){this.style=e}setClass_(e,t){e&&(t?c:s)(this.svgRoot,e)}updateHighlighted(e){e?this.setClass_("blocklyHighlighted",!0):this.setClass_("blocklyHighlighted",!1)}updateShadow_(e){e?(this.setClass_("blocklyShadow",!0),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)):this.setClass_("blocklyShadow",!1)}updateDisabled_(e){this.setClass_("blocklyDisabled",e),this.setClass_("blocklyDisabledPattern",e)}updateSelected(e){this.setClass_("blocklySelected",e)}updateDraggingDelete(e){this.setClass_("blocklyDraggingDelete",e)}updateInsertionMarker(e){this.setClass_("blocklyInsertionMarker",e)}updateMovable(e){this.setClass_("blocklyDraggable",e)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){}addConnectionHighlight(e,t,i,n){return i=`translate(${i.x}, ${i.y})`+(n?" scale(-1 1)":""),(n=this.connectionHighlights.get(e))?(n.setAttribute("d",t),n.setAttribute("transform",i),n):(t=l(k.PATH,{id:e.id,class:"blocklyHighlightedConnectionPath",style:"display: none;",d:t,transform:i},this.svgRoot),this.connectionHighlights.set(e,t),t)}removeConnectionHighlight(e){var t=this.connectionHighlights.get(e);t&&(a(t),this.connectionHighlights.delete(e))}},Xc=class{constructor(e){this.overrides=null,this.name=e}getClassName(){return this.name+"-renderer"}init(e,t){this.constants_=this.makeConstants_(),t&&(this.overrides=t,Object.assign(this.constants_,t)),this.constants_.setTheme(e),this.constants_.init()}createDom(e,t,i){this.constants_.createDom(e,this.name+"-"+t.name,"."+this.getClassName()+"."+t.getClassName(),i)}refreshDom(e,t,i){var n=this.getConstants();n.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=n.randomIdentifier,this.constants_.setTheme(t),this.constants_.init(),this.createDom(e,t,i)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new _h}makeRenderInfo_(e){return new vh(this,e)}makeDrawer_(e,t){return new yh(e,t)}makePathObject(e,t){return new Th(e,t,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(e){return!0}orphanCanConnectAtEnd(e,t,i){return!!A.getConnectionForOrphanedConnection(e,i===v.OUTPUT_VALUE?t.outputConnection:t.previousConnection)}render(e){var t=this.makeRenderInfo_(e);t.measure(),this.makeDrawer_(e,t).draw()}},S={},Eh=(S.BottomRow=eh,S.Connection=th,S.ConstantProvider=_h,S.Drawer=yh,S.ExternalValueInput=ih,S.Field=nh,S.Hat=oh,S.Icon=rh,S.InRowSpacer=sh,S.InlineInput=ah,S.InputConnection=Ya,S.InputRow=lh,S.JaggedEdge=ch,S.Measurable=D,S.NextConnection=uh,S.OutputConnection=dh,S.PathObject=Th,S.PreviousConnection=hh,S.RenderInfo=vh,S.Renderer=Xc,S.RoundCorner=ph,S.Row=w,S.SpacerRow=gh,S.SquareCorner=fh,S.StatementInput=mh,S.TopRow=bh,S.Types=L,S.init=or,S.register=nr,S.unregister=Op,class{constructor(e,t){this.workspace=e,this.theme=t,this.subscribedWorkspaces=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(e){var t,i,n,o=this.theme;this.theme=e,(e=this.workspace.getInjectionDiv())&&((o=o&&o.getClassName())&&s(e,o),o=this.theme.getClassName())&&c(e,o);for(let e=0,t;t=this.subscribedWorkspaces[e];e++)t.refreshTheme();for([t,i]of this.componentDB)for(var r of i){e=r.element;o=r.propertyName,r=this.theme&&this.theme.getComponentStyle(t);e.style.setProperty(o,r||"")}for(n of this.subscribedWorkspaces)n.hideChaff()}subscribeWorkspace(e){this.subscribedWorkspaces.push(e)}unsubscribeWorkspace(e){if(!me(this.subscribedWorkspaces,e))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(e,t,i){this.componentDB.has(t)||this.componentDB.set(t,[]),this.componentDB.get(t).push({element:e,propertyName:i}),t=this.theme&&this.theme.getComponentStyle(t),e.style.setProperty(i,t||"")}unsubscribe(t){if(t)for(var[e,i]of this.componentDB){for(let e=i.length-1;0<=e;e--)i[e].element===t&&i.splice(e,1);i.length||this.componentDB.delete(e)}}dispose(){this.subscribedWorkspaces.length=0,this.componentDB.clear()}}),kh="VARIABLE_DYNAMIC",Ch={CATEGORY_NAME:kh},$a=(Ch.flyoutCategory=cr,Ch.flyoutCategoryBlocks=dr,Ch.internalFlyoutCategory=lr,Ch.onCreateVariableButtonClick_Colour=ar,Ch.onCreateVariableButtonClick_Number=sr,Ch.onCreateVariableButtonClick_String=rr,class{canConnect(e,t,i,n){return this.canConnectWithReason(e,t,i,n)===A.CAN_CONNECT}canConnectWithReason(e,t,i,n){var o=this.doSafetyChecks(e,t);return o!==A.CAN_CONNECT?o:this.doTypeChecks(e,t)?i&&!this.doDragChecks(e,t,n||0)?A.REASON_DRAG_CHECKS_FAILED:A.CAN_CONNECT:A.REASON_CHECKS_FAILED}getErrorMessage(e,t,i){switch(e){case A.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case A.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case A.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case A.REASON_TARGET_NULL:return"Target connection is null.";case A.REASON_CHECKS_FAILED:return"Connection checks failed. "+t+" expected "+t.getCheck()+", found "+i.getCheck();case A.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case A.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case A.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(e,t){if(!e||!t)return A.REASON_TARGET_NULL;let i,n,o;return e.isSuperior()?(i=e.getSourceBlock(),n=t.getSourceBlock(),o=t):(n=e.getSourceBlock(),i=t.getSourceBlock(),o=e,e=t),i===n?A.REASON_SELF_CONNECTION:o.type!==qu[e.type]?A.REASON_WRONG_TYPE:i.workspace!==n.workspace?A.REASON_DIFFERENT_WORKSPACES:i.isShadow()&&!n.isShadow()?A.REASON_SHADOW_PARENT:o.type===v.OUTPUT_VALUE&&n.previousConnection&&n.previousConnection.isConnected()||o.type===v.PREVIOUS_STATEMENT&&n.outputConnection&&n.outputConnection.isConnected()?A.REASON_PREVIOUS_AND_OUTPUT:A.CAN_CONNECT}doTypeChecks(t,i){if(t=t.getCheck(),i=i.getCheck(),!t||!i)return!0;for(let e=0;e<t.length;e++)if(i.includes(t[e]))return!0;return!1}doDragChecks(e,t,i){if(e.distanceFrom(t)>i||t.getSourceBlock().isInsertionMarker())return!1;switch(t.type){case v.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(e,t);case v.OUTPUT_VALUE:if(t.isConnected()&&!t.targetBlock().isInsertionMarker()||e.isConnected())return!1;break;case v.INPUT_VALUE:if(!t.isConnected()||t.targetBlock().isMovable()||t.targetBlock().isShadow())break;return!1;case v.NEXT_STATEMENT:if(t.isConnected()&&!e.getSourceBlock().nextConnection&&!t.targetBlock().isShadow()&&t.targetBlock().nextConnection||t.targetBlock()&&!t.targetBlock().isMovable()&&!t.targetBlock().isShadow())return!1;break;default:return!1}return!Ga.includes(t)}canConnectToPrevious_(e,t){return!(e.targetConnection||Ga.includes(t)||t.targetConnection&&(!(e=t.targetBlock()).isInsertionMarker()||e.getPreviousBlock()))}}),Ih=(o(b.CONNECTION_CHECKER,Us,$a),class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(e){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new Zd,this.readOnly=!1,this.potentialVariableMap=null,this.id=xs(),oe(this),this.options=e||new Pu({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(fs(b.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new(this.getVariableMapClass())(this),this.setIsReadOnly(this.options.readOnly)}dispose(){this.listeners.length=0,this.clear(),re(this)}sortObjects(e,t){var i=t=>({getBoundingRectangle:()=>{var e=t.getRelativeToSurfaceXY();return new C(e.y,e.y,e.x,e.x)},moveBy:()=>{}});return this.sortByOrigin(i(e),i(t))}sortByOrigin(e,t){var i=Math.sin(si(Ih.SCAN_ANGLE))*(this.RTL?-1:1);return e=e.getBoundingRectangle().getOrigin(),t=t.getBoundingRectangle().getOrigin(),e.y+i*e.x-(t.y+i*t.x)}addTopBlock(e){this.topBlocks.push(e)}removeTopBlock(e){if(!me(this.topBlocks,e))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(e=!1){var t=[].concat(this.topBlocks);return e&&1<t.length&&t.sort(this.sortObjects.bind(this)),t}addTypedBlock(e){this.typedBlocksDB.has(e.type)||this.typedBlocksDB.set(e.type,[]),this.typedBlocksDB.get(e.type).push(e)}removeTypedBlock(e){me(this.typedBlocksDB.get(e.type),e),this.typedBlocksDB.get(e.type).length||this.typedBlocksDB.delete(e.type)}getBlocksByType(e,t=!1){return this.typedBlocksDB.has(e)?(e=this.typedBlocksDB.get(e).slice(0),t&&e&&1<e.length&&e.sort(this.sortObjects.bind(this)),e.filter(e=>!e.isInsertionMarker())):[]}addTopComment(e){this.topComments.push(e),this.commentDB.has(e.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+e.id+'"'),this.commentDB.set(e.id,e)}removeTopComment(e){if(!me(this.topComments,e))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(e.id)}getTopComments(e=!1){var t=[].concat(this.topComments);return e&&1<t.length&&t.sort(this.sortObjects.bind(this)),t}getAllBlocks(t=!1){if(t){var i=this.getTopBlocks(!0);t=[];for(let e=0;e<i.length;e++)t.push(...i[e].getDescendants(!0))}else for(t=this.getTopBlocks(!1),i=0;i<t.length;i++)t.push(...t[i].getChildren(!1));return t.filter(e=>!e.isInsertionMarker())}clear(){this.isClearing=!0;try{var e=m.getGroup$$module$build$src$core$events$utils();for(e||m.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();m.setGroup$$module$build$src$core$events$utils(e),this.isFlyout||this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(e,t){ft("Blockly.Workspace.renameVariableById","v12","v13","Blockly.Workspace.getVariableMap().renameVariable"),(e=this.variableMap.getVariableById(e))&&this.variableMap.renameVariable(e,t)}createVariable(e,t,i){return ft("Blockly.Workspace.createVariable","v12","v13","Blockly.Workspace.getVariableMap().createVariable"),this.variableMap.createVariable(e,null!=t?t:void 0,null!=i?i:void 0)}getVariableUsesById(e){return ft("Blockly.Workspace.getVariableUsesById","v12","v13","Blockly.Workspace.getVariableMap().getVariableUsesById"),Mt(this,e)}deleteVariableById(e){ft("Blockly.Workspace.deleteVariableById","v12","v13","Blockly.Workspace.getVariableMap().deleteVariable");var t=this.variableMap.getVariableById(e);t?m.deleteVariable$$module$build$src$core$variables(this,t):console.warn("Can't delete non-existent variable: "+e)}getVariable(e,t){return ft("Blockly.Workspace.getVariable","v12","v13","Blockly.Workspace.getVariableMap().getVariable"),this.variableMap.getVariable(e,t)}getVariableById(e){return ft("Blockly.Workspace.getVariableById","v12","v13","Blockly.Workspace.getVariableMap().getVariableById"),this.variableMap.getVariableById(e)}getVariablesOfType(e){return ft("Blockly.Workspace.getVariablesOfType","v12","v13","Blockly.Workspace.getVariableMap().getVariablesOfType"),this.variableMap.getVariablesOfType(null!=e?e:"")}getAllVariables(){return ft("Blockly.Workspace.getAllVariables","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables()}getAllVariableNames(){return ft("Blockly.Workspace.getAllVariableNames","v12","v13","Blockly.Workspace.getVariableMap().getAllVariables"),this.variableMap.getAllVariables().map(e=>e.getName())}getWidth(){return 0}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(e){return this.options.maxInstances?(void 0!==this.options.maxInstances[e]?this.options.maxInstances[e]:1/0)-this.getBlocksByType(e,!1).length:1/0}isCapacityAvailable(e){if(!this.hasBlockLimits())return!0;let t=0;for(var i in e){if(e[i]>this.remainingCapacityOfType(i))return!1;t+=e[i]}return!(t>this.remainingCapacity())}hasBlockLimits(){return this.options.maxBlocks!==1/0||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(e){var t=e?this.redoStack_:this.undoStack_,i=e?this.undoStack_:this.redoStack_,n=t.pop();if(n){for(var o=[n];t.length&&n.group&&n.group===t[t.length-1].group;){var r=t.pop();r&&o.push(r)}for(t=0;t<o.length;t++)i.push(o[t]);m.setRecordUndo$$module$build$src$core$events$utils(!1);try{for(i=0;i<o.length;i++)o[i].run(e)}finally{m.setRecordUndo$$module$build$src$core$events$utils(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,F()}addChangeListener(e){return this.listeners.push(e),e}removeChangeListener(e){me(this.listeners,e)}fireChangeListener(t){if(t.recordUndo)for(this.undoStack_.push(t),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(let e=0;e<this.listeners.length;e++)(0,this.listeners[e])(t)}getBlockById(e){return this.blockDB.get(e)||null}setBlockById(e,t){this.blockDB.set(e,t)}removeBlockById(e){this.blockDB.delete(e)}getCommentById(e){return null!=(e=this.commentDB.get(e))?e:null}allInputsFilled(t){var i=this.getTopBlocks(!1);for(let e=0;e<i.length;e++)if(!i[e].allInputsFilled(t))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new(this.getVariableMapClass())(this,!0)}getVariableMap(){return this.variableMap}setVariableMap(e){this.variableMap=e}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let e=null;var t=this.options.parentWorkspace;return this.isFlyout?t&&t.options&&(e=t.options.parentWorkspace):t&&(e=t),e}static getById(e){return ie(e)}static getAll(){return ne()}getVariableMapClass(){var e=fs(b.VARIABLE_MAP,this.options,!0);if(e)return e;throw Error("No variable map is registered.")}isReadOnly(){return this.readOnly}setIsReadOnly(e){this.readOnly=e,this.options.readOnly=e}}),wh=(Ih.SCAN_ANGLE=3,class{constructor(e){this.parentWorkspace=e,this.sounds=new Map,this.lastSound=null,this.muted=!1}dispose(){this.sounds.clear()}load(t,e){if(t.length){try{var i=new globalThis.Audio}catch(e){return}for(let e=0;e<t.length;e++){var n=t[e],o=n.match(/\.(\w+)$/);if(o&&i.canPlayType("audio/"+o[1])){var r=new globalThis.Audio(n);break}}r&&this.sounds.set(e,r)}}preload(){for(var e of this.sounds.values()){e.volume=.01;var t=e.play();if(void 0!==t?t.then(e.pause).catch(function(){}):e.pause(),ha||pa)break}}play(e,t){var i;this.muted||((i=this.sounds.get(e))?(e=new Date,null!==this.lastSound&&e.getTime()-this.lastSound.getTime()<100||(this.lastSound=e,(i=ha||da?i:i.cloneNode()).volume=void 0===t?1:t,i.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(e,t))}setMuted(e){this.muted=e}getMuted(){return this.muted}}),Sh=class extends Ih{constructor(e){super(e),this.resizeHandlerWrapper=null,this.resizesEnabled=this.visible=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardMoveInProgress=this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=this.layerManager=null,this.navigator=new Od,this.metricsManager=new(fs(b.METRICS_MANAGER,e,!0))(this),this.getMetrics=e.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=e.setMetrics||Sh.setTopLevelWorkspaceMetrics,this.componentManager=new Xa,this.connectionDBList=Ru.init(this.connectionChecker),this.audioManager=new wh(e.parentWorkspace),this.grid=this.options.gridPattern?new Ud(this.options.gridPattern,e.gridOptions):null,this.markerManager=new jd(this),ec&&this.registerToolboxCategoryCallback(Jl,mt),Ch&&this.registerToolboxCategoryCallback(kh,lr),Kd&&(this.registerToolboxCategoryCallback(Qd,Yo),this.addChangeListener(qo)),this.addChangeListener(this.variableChangeCallback.bind(this)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new Eh(this,this.options.theme||$u),this.themeManager_.subscribeWorkspace(this),this.renderer=or(this.options.renderer||"geras",this.getTheme(),null!=(e=this.options.rendererOverrides)?e:void 0),this.cachedParentSvgSize=new I(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(e){this.metricsManager=e,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}getMarker(e){return this.markerManager.getMarker(e)}getCursor(){return this.markerManager.getCursor()}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(e){this.themeManager_.setTheme(e=e||$u)}refreshTheme(){var e;this.svgGroup_&&(e=null===this.options.parentWorkspace,this.renderer.refreshDom(this.svgGroup_,this.getTheme(),e?this.getInjectionDiv():void 0)),this.updateBlockStyles(this.getAllBlocks(!1).filter(e=>!!e.getStyleName())),this.refreshToolboxSelection(),this.toolbox&&this.toolbox.refreshTheme(),this.isVisible()&&this.setVisible(!0),e=new(f(_.THEME_CHANGE))(this.getTheme().name,this.id),g(e)}updateBlockStyles(i){for(let e=0,t;t=i[e];e++){var n=t.getStyleName();n&&t.setStyle(n)}}getInverseScreenCTM(){var e;return this.inverseScreenCTMDirty&&(e=this.getParentSvg().getScreenCTM())&&(this.inverseScreenCTM=e.inverse(),this.inverseScreenCTMDirty=!1),this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.visible}getSvgXY(e){let t=0,i=0,n=1;(this.getCanvas().contains(e)||this.getBubbleCanvas().contains(e))&&(n=this.scale);do{var o=Se(e);e!==this.getCanvas()&&e!==this.getBubbleCanvas()||(n=1),t+=o.x*n,i+=o.y*n,e=e.parentNode}while(e&&e!==this.getParentSvg()&&e!==this.getInjectionDiv());return new E(t,i)}getCachedParentSvgSize(){var e=this.cachedParentSvgSize;return new I(e.width,e.height)}getOriginOffsetInPixels(){return xe(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let e=this.svgGroup_;for(;e;){if((" "+(e.getAttribute("class")||"")+" ").includes(" injectionDiv ")){this.injectionDiv=e;break}e=e.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(e){this.resizeHandlerWrapper=e}createDom(e,t){return this.injectionDiv||(this.injectionDiv=null!=t?t:null),this.svgGroup_=l(k.G,{class:"blocklyWorkspace",id:this.id}),t&&Ze(this.svgGroup_,na.LABEL,m.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),e&&(this.svgBackground_=l(k.RECT,{height:"100%",width:"100%",class:e},this.svgGroup_),"blocklyMainBackground"===e&&this.grid?this.svgBackground_.style.fill="var(--blocklyGridPattern)":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.layerManager=new Hd(this),this.svgBlockCanvas_=this.layerManager.getBlockLayer(),this.svgBubbleCanvas_=this.layerManager.getBubbleLayer(),this.isFlyout||(p(this.svgGroup_,"pointerdown",this,this.onMouseDown,!1),this.dummyWheelListener=()=>{},document.body.addEventListener("wheel",this.dummyWheelListener),p(this.svgGroup_,"wheel",this,this.onMouseWheel)),this.options.hasCategories&&(this.toolbox=new(fs(b.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(e=fs(b.CURSOR,this.options))&&this.markerManager.setCursor(new e(this)),e=null===this.options.parentWorkspace,this.renderer.createDom(this.svgGroup_,this.getTheme(),e?this.getInjectionDiv():void 0),m.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!!this.injectionDiv||this.isFlyout),this.svgGroup_}dispose(){var e;this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&a(this.svgGroup_),this.toolbox&&(this.toolbox.dispose(),this.toolbox=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),this.options.parentWorkspace||(e=this.getParentSvg())&&e.parentNode&&a(e.parentNode),this.resizeHandlerWrapper&&(r(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null),this.dummyWheelListener&&(document.body.removeEventListener("wheel",this.dummyWheelListener),this.dummyWheelListener=null),m.getFocusManager$$module$build$src$core$focus_manager().isRegistered(this)&&m.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}addTrashcan(){this.trashcan=Sh.newTrashcan(this);var e=this.trashcan.createDom();this.svgGroup_.insertBefore(e,this.getCanvas())}static newTrashcan(e){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new bl(this);var e=this.zoomControls_.createDom();this.svgGroup_.appendChild(e)}copyOptionsForFlyout(){return new Pu({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,plugins:this.options.plugins,modalInputs:this.options.modalInputs,move:{scrollbars:!0}})}addFlyout(e){var t=this.copyOptionsForFlyout();return t.toolboxPosition=this.options.toolboxPosition,this.flyout=new(this.horizontalLayout?fs(b.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0):fs(b.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(t),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(e)}getFlyout(e){return this.flyout||e?this.flyout:this.toolbox?this.toolbox.getFlyout():null}getToolbox(){return this.toolbox}updateScreenCalculations(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox?this.toolbox.position():this.flyout&&this.flyout.position();var i=this.componentManager.getComponents(Xa.Capability.POSITIONABLE,!0),n=this.getMetricsManager().getUiMetrics(),o=[];for(let e=0,t;t=i[e];e++){t.position(n,o);var r=t.getBoundingRectangle();r&&o.push(r)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations()}updateScreenCalculationsIfScrolled(){var e=Oe();E.equals(this.lastRecordedPageScroll,e)||(this.lastRecordedPageScroll=e,this.updateScreenCalculations())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(e,t){var i=this.getParentSvg();null!=e&&(this.cachedParentSvgSize.width=e,i.setAttribute("data-cached-width",""+e)),null!=t&&(this.cachedParentSvgSize.height=t,i.setAttribute("data-cached-height",""+t))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let e=this.svgGroup_;for(;e;){if("svg"===e.tagName){this.cachedParentSvg=e;break}e=e.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){var e,t,i,n;U()&&(e=this.scale,t=-this.scrollY,i=-this.scrollX,e===this.oldScale&&Math.abs(t-this.oldTop)<1&&Math.abs(i-this.oldLeft)<1||(n=new(f(_.VIEWPORT_CHANGE))(t,i,e,this.id,this.oldScale),this.oldScale=e,this.oldTop=t,this.oldLeft=i,g(n)))}translate(e,t){var i;null!=(i=this.layerManager)&&i.translateLayers(new E(e,t),this.scale),null!=(i=this.grid)&&i.moveTo(e,t),this.maybeFireViewportChangeEvent()}getWidth(){var e=this.getMetrics();return e?e.viewWidth/this.scale:0}setVisible(e){this.visible=e,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(e),this.getFlyout()&&this.getFlyout().setContainerVisible(e),this.getParentSvg().style.display=e?"block":"none",this.toolbox&&this.toolbox.setVisible(e),e||this.hideChaff(!0))}render(){var t=this.getAllBlocks(!1);for(let e=t.length-1;0<=e;e--)t[e].queueRender();this.getTopBlocks().flatMap(e=>e.getDescendants(!1)).filter(e=>e.isInsertionMarker()).forEach(e=>e.queueRender())}highlightBlock(e,t){if(void 0===t){for(let e=0,t;t=this.highlightedBlocks[e];e++)t.setHighlighted(!1);this.highlightedBlocks.length=0}(e=e?this.getBlockById(e):null)&&((t=void 0===t||t)?this.highlightedBlocks.includes(e)||this.highlightedBlocks.push(e):me(this.highlightedBlocks,e),e.setHighlighted(t))}variableChangeCallback(e){switch(e.type){case _.VAR_CREATE:case _.VAR_DELETE:case _.VAR_RENAME:case _.VAR_TYPE_CHANGE:this.refreshToolboxSelection()}}refreshToolboxSelection(){var e=this.isFlyout?this.targetWorkspace:this;e&&!e.currentGesture_&&e.toolbox&&e.toolbox.getFlyout()&&e.toolbox.refreshSelection()}recordDragTargets(){var i=this.componentManager.getComponents(Xa.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let e=0,t;t=i[e];e++){var n=t.getClientRect();n&&this.dragTargetAreas.push({component:t,clientRect:n})}}newBlock(e,t){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}newComment(e){throw Error("The implementation of newComment should be monkey-patched in by blockly.ts")}getDragTarget(i){for(let e=0,t;t=this.dragTargetAreas[e];e++)if(t.clientRect.contains(i.clientX,i.clientY))return t.component;return null}onMouseDown(e){var t=this.getGesture(e);t&&t.handleWsStart(e,this)}startDrag(e,t){Sn(this,e,t)}moveDrag(e){return xn(this,e)}setKeyboardMoveInProgress(e){this.keyboardMoveInProgress=e}isDragging(){return this.keyboardMoveInProgress||null!==this.currentGesture_&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){var e=!!this.scrollbar;return this.isMovable()&&(!e||this.scrollbar.canScrollHorizontally())}isMovableVertically(){var e=!!this.scrollbar;return this.isMovable()&&(!e||this.scrollbar.canScrollVertically())}onMouseWheel(e){var t,i,n,o;Fd.inProgress()?(e.preventDefault(),e.stopPropagation()):(t=this.options.zoomOptions&&this.options.zoomOptions.wheel,i=this.options.moveOptions&&this.options.moveOptions.wheel,(t||i)&&(n=ws(e),ga&&(o=e.metaKey),t&&(e.ctrlKey||o||!i)?(n=-n.y/50,t=Is(e,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(t.x,t.y,n)):(t=this.scrollX-n.x,i=this.scrollY-n.y,e.shiftKey&&!n.x&&(t=this.scrollX-n.y,i=this.scrollY),this.scroll(t,i)),e.preventDefault()))}getBlocksBoundingBox(){var t=this.getTopBoundedElements();if(!t.length)return new C(0,0,0,0);var i=t[0].getBoundingRectangle();for(let e=1;e<t.length;e++){var n=t[e];n.isInsertionMarker&&n.isInsertionMarker()||((n=n.getBoundingRectangle()).top<i.top&&(i.top=n.top),n.bottom>i.bottom&&(i.bottom=n.bottom),n.left<i.left&&(i.left=n.left),n.right>i.right&&(i.right=n.right))}return i}cleanUp(){this.setResizesEnabled(!1),m.setGroup$$module$build$src$core$events$utils(!0);var e=(n=this.getTopBlocks(!0)).filter(e=>e.isMovable());let i=n.filter(e=>!e.isMovable()).map(e=>e.getBoundingRectangle());var t,n=function(e){for(var t of i)if(e.intersects(t))return t;return null},o=0,r=this.renderer.getConstants().MIN_BLOCK_HEIGHT;for(t of e){for(e=t.getBoundingRectangle(),t.moveBy(-e.left,o-e.top,["cleanup"]),t.snapToGrid(),o=n(e=t.getBoundingRectangle());null!=o;)o=o.top+o.getHeight()+r,t.moveBy(0,o-e.top,["cleanup"]),t.snapToGrid(),o=n(e=t.getBoundingRectangle());o=t.getRelativeToSurfaceXY().y+t.getHeightWidth().height+r}m.setGroup$$module$build$src$core$events$utils(!1),this.setResizesEnabled(!0)}showContextMenu(e){var t,i;this.isReadOnly()||this.isFlyout||(t=R.registry.getContextMenuOptions({workspace:this,focusedNode:this},e),this.configureContextMenu&&this.configureContextMenu(t,e),i=e instanceof PointerEvent?new E(e.clientX,e.clientY):Ne(this,new E(5,5)),yn(e,t,this.RTL,this,i))}updateToolbox(e){if(e=Me(e)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(Be(e)){if(!this.toolbox)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=e,this.toolbox.render(e)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=e,this.flyout.show(e)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(ae(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(e,t,i){i=Math.pow(this.options.zoomOptions.scaleSpeed,i);var n,o,r=this.scale*i;this.scale!==r&&(r>this.options.zoomOptions.maxScale?i=this.options.zoomOptions.maxScale/this.scale:r<this.options.zoomOptions.minScale&&(i=this.options.zoomOptions.minScale/this.scale),n=this.getCanvas().getCTM(),(o=this.getParentSvg().createSVGPoint()).x=e,o.y=t,e=(o=o.matrixTransform(n.inverse())).x,n=n.translate(e*(1-i),(t=o.y)*(1-i)).scale(i),this.scrollX=n.e,this.scrollY=n.f,this.setScale(r))}zoomCenter(e){var t=this.getMetrics();let i;t=this.flyout?(i=t.svgWidth?t.svgWidth/2:0,t.svgHeight?t.svgHeight/2:0):(i=t.viewWidth/2+t.absoluteLeft,t.viewHeight/2+t.absoluteTop),this.zoom(i,t,e)}zoomToFit(){if(this.isMovable()){var e=(t=this.getMetrics()).viewWidth,t=t.viewHeight,i=(n=this.getBlocksBoundingBox()).right-n.left+40,n=n.bottom-n.top+40;if(i){this.flyout&&(this.horizontalLayout?(t+=this.flyout.getHeight(),n+=this.flyout.getHeight()/this.scale):(e+=this.flyout.getWidth(),i+=this.flyout.getWidth()/this.scale)),e/=i,t/=n,m.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(e,t)),this.scrollCenter()}finally{m.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){c(this.getCanvas(),"blocklyCanvasTransitioning"),c(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}endCanvasTransition(){s(this.getCanvas(),"blocklyCanvasTransitioning"),s(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}scrollCenter(){var e,t;this.isMovable()?(t=((e=this.getMetrics()).scrollWidth-e.viewWidth)/2,this.scroll(t=-t-e.scrollLeft,-((e.scrollHeight-e.viewHeight)/2)-e.scrollTop)):console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(e,t){var i,n;this.isMovable()?(i=e?this.getBlockById(e):null)&&(e=i.getRelativeToSurfaceXY(),i=t?{height:i.height,width:i.width}:i.getHeightWidth(),n=this.scale,t=(e.x+(this.RTL?-1:1)*i.width/2)*n,e=(e.y+i.height/2)*n,i=this.getMetrics(),this.scroll(-(t-i.viewWidth/2),-(e-i.viewHeight/2))):console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(e){this.options.zoomOptions.maxScale&&e>this.options.zoomOptions.maxScale?e=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&e<this.options.zoomOptions.minScale&&(e=this.options.zoomOptions.minScale),this.scale=e,this.hideChaff(!1),(e=this.getFlyout(!1))&&e.isVisible()&&(e.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),e=this.getMetrics(),this.scrollX-=e.absoluteLeft,this.scrollY-=e.absoluteTop,e.viewLeft+=e.absoluteLeft,e.viewTop+=e.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(e):this.scrollbar.resizeContent(e))}getScale(){return this.scale}getAbsoluteScale(){let i=e=>{if(e.isFlyout){var t=null==(t=e.targetWorkspace)?void 0:t.getFlyout();if(t instanceof Md)return t.getFlyoutScale()}return e.getScale()},n=(e,t)=>e.options.parentWorkspace&&e.options.parentWorkspace.getSvgGroup().contains(e.getSvgGroup())?n(e.options.parentWorkspace,t*i(e)):t*i(e);return n(this,1)}scroll(e,t){this.hideChaff(!0);var i=this.getMetrics(),n=(e=Math.min(e,-i.scrollLeft),t=Math.min(t,-i.scrollTop),i.scrollTop+Math.max(0,i.scrollHeight-i.viewHeight));e=Math.max(e,-(i.scrollLeft+Math.max(0,i.scrollWidth-i.viewWidth))),t=Math.max(t,-n),this.scrollX=e,this.scrollY=t,this.scrollbar&&this.scrollbar.set(-(e+i.scrollLeft),-(t+i.scrollTop),!1),e+=i.absoluteLeft,t+=i.absoluteTop,this.translate(e,t)}getBlockById(e){return super.getBlockById(e)}getAllBlocks(e=!1){return super.getAllBlocks(e)}getTopBlocks(e=!1){return super.getTopBlocks(e)}addTopBlock(e){this.addTopBoundedElement(e),super.addTopBlock(e)}removeTopBlock(e){this.removeTopBoundedElement(e),super.removeTopBlock(e)}addTopComment(e){this.addTopBoundedElement(e),super.addTopComment(e)}removeTopComment(e){this.removeTopBoundedElement(e),super.removeTopComment(e)}getTopComments(e=!1){return super.getTopComments(e)}getCommentById(e){return super.getCommentById(e)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(e){this.topBoundedElements.push(e)}removeTopBoundedElement(e){me(this.topBoundedElements,e)}getTopBoundedElements(e=!1){var t=[].concat(this.topBoundedElements);return e&&t.sort(this.sortByOrigin.bind(this)),t}setResizesEnabled(e){var t=!this.resizesEnabled&&e;this.resizesEnabled=e,t&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(e,t){if("function"!=typeof t)throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(e,t)}getButtonCallback(e){return null!=(e=this.flyoutButtonCallbacks.get(e))?e:null}removeButtonCallback(e){this.flyoutButtonCallbacks.delete(e)}registerToolboxCategoryCallback(e,t){if("function"!=typeof t)throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(e,t)}getToolboxCategoryCallback(e){return this.toolboxCategoryCallbacks.get(e)||null}removeToolboxCategoryCallback(e){this.toolboxCategoryCallbacks.delete(e)}getGesture(e){var t,i;return this.keyboardMoveInProgress?(e.preventDefault(),e.stopPropagation(),null):((t="pointerdown"===e.type)&&null!=(i=this.currentGesture_)&&i.hasStarted()&&(console.warn("Tried to start the same gesture twice."),this.currentGesture_.cancel()),!this.currentGesture_&&t&&(this.currentGesture_=new Fd(e,this)),this.currentGesture_)}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(e=!1){Gi(),dn(this),ki(),this.hideComponents(e)}hideComponents(t=!1){this.getComponentManager().getComponents(Xa.Capability.AUTOHIDEABLE,!0).forEach(e=>e.autoHide(t))}static setTopLevelWorkspaceMetrics(e){var t=this.getMetrics();"number"==typeof e.x&&(this.scrollX=-(t.scrollLeft+(t.scrollWidth-t.viewWidth)*e.x)),"number"==typeof e.y&&(this.scrollY=-(t.scrollTop+(t.scrollHeight-t.viewHeight)*e.y)),this.translate(this.scrollX+t.absoluteLeft,this.scrollY+t.absoluteTop)}addClass(e){this.injectionDiv&&c(this.injectionDiv,e)}removeClass(e){this.injectionDiv&&s(this.injectionDiv,e)}setIsReadOnly(e){super.setIsReadOnly(e),e?this.addClass("blocklyReadOnly"):this.removeClass("blocklyReadOnly")}scrollBoundsIntoView(e,t=10){var i,n,o;Fd.inProgress()||(i=this.getScale(),o=this.getMetricsManager().getViewMetrics(!0),o=new C(o.top,o.top+o.height,o.left,o.left+o.width),e.left>=o.left&&e.top>=o.top&&e.right<=o.right&&e.bottom<=o.bottom)||((e=e.clone()).top-=t,e.bottom+=t,e.left-=t,e.right+=t,n=t=0,e.left<o.left?t=this.RTL?Math.min(o.left-e.left,o.right-e.right):o.left-e.left:e.right>o.right&&(t=this.RTL?o.right-e.right:Math.max(o.right-e.right,o.left-e.left)),e.top<o.top?n=o.top-e.top:e.bottom>o.bottom&&(n=Math.max(o.bottom-e.bottom,o.top-e.top)),this.scroll(this.scrollX+t*i,this.scrollY+n*i))}getFocusableElement(){return this.svgGroup_}getFocusableTree(){return this.isMutator&&this.options.parentWorkspace||this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(e){return!e&&null!=(e=this.getTopBlocks(!0)[0])?e:null}getNestedTrees(){var e=this.getAllBlocks().map(e=>e.getIcons()).flat().filter(e=>e instanceof m.MutatorIcon$$module$build$src$core$icons$mutator_icon&&e.bubbleIsVisible()).map(e=>null==(e=e.getBubble())?void 0:e.getWorkspace()).filter(e=>!!e),t=this.getFlyout(!0);return t&&e.push(t.getWorkspace()),e}searchForWorkspaceComment(e){for(var t of this.getTopComments())if(t instanceof ku&&t.canBeFocused()&&t.getFocusableElement().id===e)return t}lookUpFocusableNode(t){var e,i,n=null==(e=this.targetWorkspace)?void 0:e.getFlyout();if(this.isFlyout&&n)for(var o of n.getContents())if(e=o.getElement(),Q(e)&&e.canBeFocused()&&e.getFocusableElement().id===t)return e;if(o=t.indexOf("_field_"),e=t.indexOf("_connection_"),-1!==o){var r=t.substring(0,o);if(r=this.getBlockById(r))for(var s of r.getFields())if(s.canBeFocused()&&s.getFocusableElement().id===t)return s}else if(-1!==e){if(r=t.substring(0,e),r=this.getBlockById(r))for(var a of r.getConnections_(!0))if(a.id===t)return a}else{if(-1!==(s=Math.max(t.indexOf(bu),t.indexOf(fu),t.indexOf(yu)))&&(s=t.substring(0,s),s=this.searchForWorkspaceComment(s)))return-1<t.indexOf(bu)?s.getEditorFocusableNode():null!=(i=s.view.getCommentBarButtons().find(e=>e.getFocusableElement().id.includes(t)))?i:null;if(i=(i=this.getAllBlocks(!1).find(e=>e.getFocusableElement().id===t))||this.searchForWorkspaceComment(t))return i;for(r of i=this.getAllBlocks().map(e=>e.getIcons()).flat()){if(r.canBeFocused()&&r.getFocusableElement().id===t)return r;if(ri(r)&&(i=r.getBubble())&&i.canBeFocused()&&i.getFocusableElement().id===t)return i}}return null}onTreeFocus(e,t){}onTreeBlur(e){var t,i;this.isFlyout&&this.targetWorkspace&&!m.getFocusManager$$module$build$src$core$focus_manager().ephemeralFocusTaken()&&(t=this.targetWorkspace.getFlyout(),(i=this.targetWorkspace.getToolbox())&&e===i||(i&&i.clearSelection(),t&&Fo(t)&&t.autoHide(!1)))}getNavigator(){return this.navigator}setNavigator(e){this.navigator=e}},xh=class extends ja{constructor(e){super(),this.isBlank=void 0===e,e&&(this.varId=e.getId(),this.workspaceId=e.getWorkspace().id)}toJson(){var e=super.toJson();if(this.varId)return e.varId=this.varId,e;throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new xh)).varId=e.varId,t}},Rh=class extends xh{constructor(e){super(e),this.type=_.VAR_CREATE,e&&(this.varType=e.getType(),this.varName=e.getName())}toJson(){var e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(this.varName)return e.varType=this.varType,e.varName=this.varName,e;throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new Rh)).varType=e.varType,t.varName=e.varName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t=t.getVariableMap(),e?t.createVariable(this.varName,this.varType,this.varId):(e=t.getVariableById(this.varId))&&t.deleteVariable(e)}},Ks=(o(b.EVENT,_.VAR_CREATE,Rh),class{constructor(e,t,i,n){this.workspace=e,this.name=t,this.type=i||"",this.id=n||xs()}getId(){return this.id}getName(){return this.name}setName(e){return this.name=e,this}getType(){return this.type}setType(e){return this.type=e,this}getWorkspace(){return this.workspace}save(){var e={name:this.getName(),id:this.getId()},t=this.getType();return t&&(e.type=t),e}static load(e,t){e=new this(t,e.name,e.type,e.id),t.getVariableMap().addVariable(e),g(new(f(_.VAR_CREATE))(e))}}),Oh=(o(b.VARIABLE_MODEL,Us,Ks),class extends xh{constructor(e){super(e),this.type=_.VAR_DELETE,e&&(this.varType=e.getType(),this.varName=e.getName())}toJson(){var e=super.toJson();if(void 0===this.varType)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(this.varName)return e.varType=this.varType,e.varName=this.varName,e;throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new Oh)).varType=e.varType,t.varName=e.varName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t=t.getVariableMap(),e?(e=t.getVariableById(this.varId))&&t.deleteVariable(e):t.createVariable(this.varName,this.varType,this.varId)}}),Ah=(o(b.EVENT,_.VAR_DELETE,Oh),class extends xh{constructor(e,t){super(e),this.type=_.VAR_RENAME,e&&(this.oldName=e.getName(),this.newName=void 0===t?"":t)}toJson(){var e=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(this.newName)return e.oldName=this.oldName,e.newName=this.newName,e;throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new Ah)).oldName=e.oldName,t.newName=e.newName,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");var i=(t=t.getVariableMap()).getVariableById(this.varId);e?i&&t.renameVariable(i,this.newName):i&&t.renameVariable(i,this.oldName)}}),pc=(o(b.EVENT,_.VAR_RENAME,Ah),class{constructor(e,t=!1){this.workspace=e,this.potentialMap=t,this.variableMap=new Map}clear(){for(var e of this.variableMap.values())for(var t of e.values())this.deleteVariable(t);if(0!==this.variableMap.size)throw Error("Non-empty variable map")}renameVariable(t,i){if(t.getName()!==i){var n=t.getType(),n=this.getVariable(i,n),o=this.workspace.getAllBlocks(!1);let e="";this.potentialMap||(e=m.getGroup$$module$build$src$core$events$utils())||m.setGroup$$module$build$src$core$events$utils(!0);try{n&&n.getId()!==t.getId()?this.renameVariableWithConflict(t,i,n,o):this.renameVariableAndUses(t,i,o)}finally{this.potentialMap||m.setGroup$$module$build$src$core$events$utils(e)}}return t}changeVariableType(e,t){var i,n;return null!=(i=this.variableMap.get(e.getType()))&&i.delete(e.getId()),e.setType(t),(i=null!=(n=this.variableMap.get(t))?n:new Map).set(e.getId(),e),this.variableMap.has(t)||this.variableMap.set(t,i),e}renameVariableById(e,t){ft("VariableMap.renameVariableById","v12","v13","VariableMap.renameVariable");var i=this.getVariableById(e);if(!i)throw Error("Tried to rename a variable that didn't exist. ID: "+e);this.renameVariable(i,t)}renameVariableAndUses(e,t,i){for(this.potentialMap||g(new(f(_.VAR_RENAME))(e,t)),e.setName(t),t=0;t<i.length;t++)i[t].updateVarName(e)}renameVariableWithConflict(e,t,i,n){var o=e.getType();for(t!==i.getName()&&this.renameVariableAndUses(i,t,n),t=0;t<n.length;t++)n[t].renameVarById(e.getId(),i.getId());this.potentialMap||g(new(f(_.VAR_DELETE))(e)),null!=(o=this.variableMap.get(o))&&o.delete(e.getId())}createVariable(e,t,i){if(n=this.getVariable(e,t)){if(i&&n.getId()!==i)throw Error('Variable "'+e+'" is already in use and its id is "'+n.getId()+'" which conflicts with the passed in id, "'+i+'".')}else{if(i&&this.getVariableById(i))throw Error('Variable id, "'+i+'", is already in use.');if(n=i||xs(),t=t||"",!(i=ps(b.VARIABLE_MODEL,Us,!0)))throw Error("No variable model is registered.");var n=new i(this.workspace,e,t,n);(e=null!=(i=this.variableMap.get(t))?i:new Map).set(n.getId(),n),this.variableMap.has(t)||this.variableMap.set(t,e),this.potentialMap||g(new(f(_.VAR_CREATE))(n))}return n}addVariable(e){var t=e.getType();this.variableMap.has(t)||this.variableMap.set(t,new Map),null!=(t=this.variableMap.get(t))&&t.set(e.getId(),e)}deleteVariable(e){var t=Mt(this.workspace,e.getId());let i="";this.potentialMap||(i=m.getGroup$$module$build$src$core$events$utils())||m.setGroup$$module$build$src$core$events$utils(!0);try{for(let e=0;e<t.length;e++)t[e].dispose(!0);var n=this.variableMap.get(e.getType());n&&n.has(e.getId())&&(n.delete(e.getId()),this.potentialMap||g(new(f(_.VAR_DELETE))(e)),0===n.size)&&this.variableMap.delete(e.getType())}finally{this.potentialMap||m.setGroup$$module$build$src$core$events$utils(i)}}deleteVariableById(e){ft("VariableMap.deleteVariableById","v12","v13","Blockly.Variables.deleteVariable"),(e=this.getVariableById(e))&&m.deleteVariable$$module$build$src$core$variables(this.workspace,e)}getVariable(t,e){return(e=this.variableMap.get(e||""))&&null!=(e=[...e.values()].find(e=>m.Names$$module$build$src$core$names.equals(e.getName(),t)))?e:null}getVariableById(e){for(var t of this.variableMap.values())if(t.has(e))return null!=(t=t.get(e))?t:null;return null}getVariablesOfType(e){return(e=this.variableMap.get(e||""))?[...e.values()]:[]}getTypes(){return[...this.variableMap.keys()]}getAllVariables(){let e=[];for(var t of this.variableMap.values())e=e.concat(...t.values());return e}getAllVariableNames(){ft("VariableMap.getAllVariableNames","v12","v13","Blockly.Variables.getAllVariables");var e,t=[];for(e of this.variableMap.values())for(var i of e.values())t.push(i.getName());return t}getVariableUsesById(e){return ft("VariableMap.getVariableUsesById","v12","v13","Blockly.Variables.getVariableUsesById"),Mt(this.workspace,e)}}),Nh=(o(b.VARIABLE_MAP,Us,pc),class extends Wa{constructor(e,t){super(t),this.type=_.TRASHCAN_OPEN,this.isOpen=e}toJson(){var e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return e.isOpen=this.isOpen,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new Nh)).isOpen=e.isOpen,t}}),Lh=(o(b.EVENT,_.TRASHCAN_OPEN,Nh),class extends gd{constructor(e){super(),this.workspace=e,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,this.workspace.options.maxTrashcanContents<=0||(e=this.workspace.copyOptionsForFlyout(),this.workspace.horizontalLayout?(e.toolboxPosition=this.workspace.toolboxPosition===y.TOP?y.BOTTOM:y.TOP,this.flyout=new(fs(b.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(e)):(e.toolboxPosition=this.workspace.toolboxPosition===y.RIGHT?y.LEFT:y.RIGHT,this.flyout=new(fs(b.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(e)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){this.svgGroup=l(k.G,{class:"blocklyTrash"});var e=String(Math.random()).substring(2),t=l(k.CLIPPATH,{id:"blocklyTrashBodyClipPath"+e},this.svgGroup),i=(l(k.RECT,{width:Dh,height:Mh,y:$h},t),l(k.IMAGE,{width:ml.width,x:-Uh,height:ml.height,y:-Hh,"clip-path":"url(#blocklyTrashBodyClipPath"+e+")"},this.svgGroup));return i.setAttributeNS(Na,"xlink:href",this.workspace.options.pathToMedia+ml.url),t=l(k.CLIPPATH,{id:"blocklyTrashLidClipPath"+e},this.svgGroup),l(k.RECT,{width:Dh,height:$h},t),this.svgLid=l(k.IMAGE,{width:ml.width,x:-Uh,height:ml.height,y:-Hh,"clip-path":"url(#blocklyTrashLidClipPath"+e+")"},this.svgGroup),this.svgLid.setAttributeNS(Na,"xlink:href",this.workspace.options.pathToMedia+ml.url),Es(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),Es(this.svgGroup,"pointerup",this,this.click),Es(i,"pointerover",this,this.mouseOver),Es(i,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){var e;0<this.workspace.options.maxTrashcanContents&&(e=this.flyout.createDom(k.SVG),c(e,"blocklyTrashcanFlyout"),z(e,this.workspace.getParentSvg()),this.flyout.init(this.workspace)),this.workspace.getComponentManager().addComponent({component:this,weight:Xa.ComponentWeight.TRASHCAN_WEIGHT,capabilities:[Xa.Capability.AUTOHIDEABLE,Xa.Capability.DELETE_AREA,Xa.Capability.DRAG_TARGET,Xa.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&a(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){var t,i;this.contentsIsOpen()||(t=this.contents.map(function(e){return JSON.parse(e)}),(i=this.workspace.getParentSvg().style).cursor="wait",setTimeout(()=>{var e;null!=(e=this.flyout)&&e.show(t),i.cursor="",null!=(e=this.workspace.scrollbar)&&e.setVisible(!1)},10),this.fireUiEvent(!0))}closeFlyout(){var e;this.contentsIsOpen()&&(null!=(e=this.flyout)&&e.hide(),null!=(e=this.workspace.scrollbar)&&e.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(e,t){var i;this.initialized&&(i=We(this.workspace,e),e=je(i,new I(Dh,Mh+$h),Bh,Ph,e,this.workspace),t=ze(e,Ph,i.vertical===Qs.TOP?ta.DOWN:ta.UP,t),this.top=t.top,this.left=t.left,null!=(e=this.svgGroup)&&e.setAttribute("transform","translate("+this.left+","+this.top+")"),null!=(i=this.flyout))&&i.position()}getBoundingRectangle(){return new C(this.top,this.top+Mh+$h,this.left,this.left+Dh)}getClientRect(){var e,t;return this.svgGroup?(e=(t=this.svgGroup.getBoundingClientRect()).top+Hh-Fh,new C(e,e+$h+Mh+2*Fh,t=t.left+Uh-Fh,t+Dh+2*Fh)):null}onDragOver(e){this.setLidOpen(this.wouldDelete_)}onDragExit(e){this.setLidOpen(!1)}onDrop(e){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(e){this.isLidOpen!==e&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=e,this.animateLid())}animateLid(){var e=jh,t=1/(e+1);this.lidOpen+=this.isLidOpen?t:-t,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*Yh),t=Wh+this.lidOpen*(zh-Wh),this.svgGroup&&(this.svgGroup.style.opacity=""+t),this.lidOpen>this.minOpenness&&this.lidOpen<1&&(this.lidTask=setTimeout(this.animateLid.bind(this),Vh/e))}setLidAngle(e){var t,i=this.workspace.toolboxPosition===y.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;null!=(t=this.svgLid)&&t.setAttribute("transform","rotate("+(i?-e:e)+","+(i?4:Dh-4)+","+($h-2)+")")}setMinOpenness(e){this.minOpenness=e,this.isLidOpen||this.setLidAngle(e*Yh)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(e){e=new(f(_.TRASHCAN_OPEN))(e,this.workspace.id),g(e)}blockMouseDownWhenOpenable(e){!this.contentsIsOpen()&&this.hasContents()&&e.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(e){if(!(this.workspace.options.maxTrashcanContents<=0||!Os(e)||e.wasShadow)){if(!e.oldJson)throw Error("Encountered a delete event without proper oldJson");if(e=JSON.stringify(this.cleanBlockJson(e.oldJson)),!this.contents.includes(e)){for(this.contents.unshift(e);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(Gh)}}}cleanBlockJson(e){return function e(t){if(t){var i,n;for(n in delete t.id,delete t.x,delete t.y,delete t.enabled,delete t.disabledReasons,t.icons&&t.icons.comment&&(delete(i=t.icons.comment).height,delete i.width,delete i.pinned),i=t.inputs){var o=(r=i[n]).block,r=r.shadow;o&&e(o),r&&e(r)}t.next&&(t=(n=t.next).block,n=n.shadow,t&&e(t),n)&&e(n)}}(e=JSON.parse(JSON.stringify(e))),Object.assign({},{kind:"BLOCK"},e)}}),Dh=47,Mh=44,$h=16,Ph=20,Bh=20,Fh=10,Uh=0,Hh=32,Gh=.1,Vh=80,jh=4,Wh=.4,zh=.8,Yh=45,Kh=null,Xh=null,qh=void 0,Ua={},qc=(Ua.BlockPaster=ld,Ua.copy=hr,Ua.getLastCopiedData=Np,Ua.getLastCopiedLocation=Lp,Ua.getLastCopiedWorkspace=Dp,Ua.paste=pr,Ua.registry=t,Ua.setLastCopiedData=Wp,Ua.setLastCopiedLocation=zp,Ua.setLastCopiedWorkspace=Yp,{}),el=(qc.CollapseCommentBarButton=mu,qc.CommentBarButton=gu,qc.CommentEditor=_u,qc.CommentView=Tu,qc.DeleteCommentBarButton=vu,qc.RenderedWorkspaceComment=ku,qc.WorkspaceComment=Eu,(lc=Xd=Xd||{}).ESCAPE="escape",lc.DELETE="delete",lc.COPY="copy",lc.CUT="cut",lc.PASTE="paste",lc.UNDO="undo",lc.REDO="redo",Jp(),{}),i=(el.names=Xd,el.registerCopy=vr,el.registerCut=Tr,el.registerDefaultShortcuts=Jp,el.registerDelete=br,el.registerEscape=mr,el.registerPaste=Er,el.registerRedo=Cr,el.registerUndo=kr,{ProcedureSerializer:class{constructor(e,t){this.procedureModelClass=e,this.parameterModelClass=t,this.priority=75}save(e){return(e=e.getProcedureMap().getProcedures().map(e=>Ir(e))).length?e:null}load(e,t){var i,n=t.getProcedureMap();for(i of e)n.add(wr(this.procedureModelClass,this.parameterModelClass,i,t))}clear(e){e.getProcedureMap().clear()}}}),Wu=(i.loadProcedure=wr,i.saveProcedure=Ir,class{constructor(){this.priority=100}save(e){return(e=e.getAllVariables().map(e=>e.save())).length?e:null}load(e,t){let i=ps(b.VARIABLE_MODEL,Us);e.forEach(e=>{null!=i&&i.load(e,t)})}clear(e){e.getVariableMap().clear()}}),gl=(Zp("variables",new Wu),{}),ma=(gl.VariableSerializer=Wu,{}),Ka=(ma.load=Qp,ma.save=tg,{blocks:cc,exceptions:ac,priorities:Vs,procedures:i,registry:_l,variables:gl,workspaceComments:yl,workspaces:ma}),Jh=("Blockly"in globalThis||(globalThis.Blockly={Msg:qd}),class{load(e,t){return(e=new _d(t.getWorkspace(),t.targetWorkspace,e,!0)).show(),new fd(e,"label")}gapForItem(e,t){return t}disposeItem(e){(e=e.getElement())instanceof _d&&e.dispose()}getType(){return"label"}}),Zh=(o(b.FLYOUT_INFLATER,"label",Jh),class extends _h{constructor(e){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:+this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,e&&(this.GRID_UNIT=e),this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=+this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=+this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(e){super.setFontConstants_(e),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(e){super.setDynamicProperties_(e),this.SELECTED_GLOW_COLOUR=e.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;var t=Number(e.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=t&&!isNaN(t)?t:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=e.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(e=Number(e.getComponentStyle("replacementGlowSize")))&&!isNaN(e)?e:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&a(this.selectedGlowFilter),this.replacementGlowFilter&&a(this.replacementGlowFilter)}makeStartHat(){var e=this.START_HAT_HEIGHT,t=this.START_HAT_WIDTH;return{height:.75*e,width:t,path:co("c",[u(25,-e),u(71,-e),u(t,0)])}}makeHexagonal(){function t(e,t,i){var n=(n=e/2)>o?o:n;return po(-(i=i?-1:1)*n,e=(t?-1:1)*e/2)+po(i*n,e)}let o=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width(e){return(e/=2)>o?o:e},height(e){return e},connectionOffsetY(e){return e/2},connectionOffsetX(e){return-e},pathDown(e){return t(e,!1,!1)},pathUp(e){return t(e,!0,!1)},pathRightDown(e){return t(e,!1,!0)},pathRightUp(e){return t(e,!1,!0)}}}makeRounded(){function t(e,t,i){var n=e>r?e-r:0,o=(e=(e>r?r:e)/2,i===t?"0":"1");return fo("a","0 0,"+o,e,u((i?1:-1)*e,(t?-1:1)*e))+d("v",(t?-1:1)*n)+fo("a","0 0,"+o,e,u((i?-1:1)*e,(t?-1:1)*e))}let i=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,r=2*i;return{type:this.SHAPES.ROUND,isDynamic:!0,width(e){return(e/=2)>i?i:e},height(e){return e},connectionOffsetY(e){return e/2},connectionOffsetX(e){return-e},pathDown(e){return t(e,!1,!1)},pathUp(e){return t(e,!0,!1)},pathRightDown(e){return t(e,!1,!0)},pathRightUp(e){return t(e,!1,!0)}}}makeSquared(){function t(e,t,i){e-=2*o;var n=i===t?"0":"1";return fo("a","0 0,"+n,o,u((i?1:-1)*o,(t?-1:1)*o))+d("v",(t?-1:1)*e)+fo("a","0 0,"+n,o,u((i?-1:1)*o,(t?-1:1)*o))}let o=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width(e){return o},height(e){return e},connectionOffsetY(e){return e/2},connectionOffsetX(e){return-e},pathDown(e){return t(e,!1,!1)},pathUp(e){return t(e,!0,!1)},pathRightDown(e){return t(e,!1,!0)},pathRightUp(e){return t(e,!1,!0)}}}shapeFor(e){let t=e.getCheck();switch(!t&&e.targetConnection&&(t=e.targetConnection.getCheck()),e.type){case v.INPUT_VALUE:case v.OUTPUT_VALUE:if(null!==(e=e.getSourceBlock().getOutputShape()))switch(e){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return t&&t.includes("Boolean")?this.HEXAGONAL:(t&&t.includes("Number")||t&&t.includes("String"),this.ROUNDED);case v.PREVIOUS_STATEMENT:case v.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function e(e){return co("c",[u(e*o/2,0),u(e*o*3/4,s/2),u(e*o,s)])+go([u(e*o,r)])+co("c",[u(e*o/4,s/2),u(e*o/2,s),u(e*o,s)])+d("h",e*n)+co("c",[u(e*o/2,0),u(e*o*3/4,-s/2),u(e*o,-s)])+go([u(e*o,-r)])+co("c",[u(e*o/4,-s/2),u(e*o/2,-s),u(e*o,-s)])}let t=this.NOTCH_WIDTH,i=this.NOTCH_HEIGHT,n=t/3,o=n/3,r=i/2,s=r/2,a=e(1),l=e(-1);return{type:this.SHAPES.NOTCH,width:t,height:i,pathLeft:a,pathRight:l}}makeInsideCorners(){var e=this.CORNER_RADIUS,t=fo("a","0 0,0",e,u(-e,e)),i=fo("a","0 0,1",e,u(-e,e));return{width:e,height:e,pathTop:t,pathBottom:fo("a","0 0,0",e,u(e,e)),rightWidth:e,rightHeight:e,pathTopRight:i,pathBottomRight:fo("a","0 0,1",e,u(e,e))}}generateSecondaryColour_(e){return Qi("#000",e,.15)||e}generateTertiaryColour_(e){return Qi("#000",e,.25)||e}createDom(e,t,i,n){super.createDom(e,t,i,n),e=l(k.DEFS,{},e),t=l(k.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),l(k.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},t),i=l(k.FECOMPONENTTRANSFER,{result:"outBlur"},t),l(k.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},i),l(k.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),l(k.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.selectedGlowFilterId=t.id,this.selectedGlowFilter=t,e=l(k.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},e),l(k.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},e),t=l(k.FECOMPONENTTRANSFER,{result:"outBlur"},e),l(k.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},t),l(k.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},e),l(k.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},e),l(k.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},e),this.replacementGlowFilterId=e.id,this.replacementGlowFilter=e,n&&(n.style.setProperty("--blocklySelectedGlowFilter",`url(#${this.selectedGlowFilterId})`),n.style.setProperty("--blocklyReplacementGlowFilter",`url(#${this.replacementGlowFilterId})`))}getCSS_(e){return[e+" .blocklyText,",e+" .blocklyFlyoutLabelText {",`font: ${this.FIELD_TEXT_FONTWEIGHT} `+this.FIELD_TEXT_FONTSIZE+`pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",e+" .blocklyTextInputBubble textarea {","font-weight: normal;","}",e+" .blocklyText {","fill: #fff;","}",e+" .blocklyNonEditableField>rect:not(.blocklyDropdownRect),",e+" .blocklyEditableField>rect:not(.blocklyDropdownRect) {",`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",e+" .blocklyNonEditableField>text,",e+" .blocklyEditableField>text,",e+" .blocklyNonEditableField>g>text,",e+" .blocklyEditableField>g>text {","fill: #575E75;","}",e+" .blocklyFlyoutLabelText {","fill: #575E75;","}",e+" .blocklyText.blocklyBubbleText {","fill: #575E75;","}",e+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableField:not(.blocklyEditing):hover>rect,",e+" .blocklyDraggable:not(.blocklyDisabled)"," .blocklyEditableField:not(.blocklyEditing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",e+" .blocklyHtmlInput {",`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",e+" .blocklyDropdownText {","fill: #fff !important;","}",e+".blocklyWidgetDiv .blocklyMenuItem,",e+".blocklyDropDownDiv .blocklyMenuItem {",`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",e+".blocklyDropDownDiv .blocklyMenuItemContent {","color: #fff;","}",e+" .blocklyHighlightedConnectionPath {",`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",e+" .blocklyDisabledPattern > .blocklyOutlinePath {","fill: var(--blocklyDisabledPattern)","}",e+" .blocklyInsertionMarker>.blocklyPath {",`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}",e+" .blocklySelected>.blocklyPath.blocklyPathSelected {","fill: none;","filter: var(--blocklySelectedGlowFilter);","}",e+" .blocklyReplaceable>.blocklyPath {","filter: var(--blocklyReplacementGlowFilter);","}"]}}),Qh=class extends yh{constructor(e,t){super(e,t)}draw(){var e=this.block_.pathObject;e.beginDrawing(),this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights(),e.setPath(this.outlinePath_+"\n"+this.inlinePath_),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(e.outputShapeType=this.info_.outputConnection.shape.type),e.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(e){if(!(e.height<=0)){if(L.isSpacer(e)){var t,i,n=e.precedesStatement,o=e.followsStatement;if(n||o)return i=(t=this.constants_.INSIDE_CORNERS).rightHeight,i=e.height-(n?i:0),o=o?t.pathBottomRight:"",e=0<i?d("V",e.yPos+i):"",void(this.outlinePath_+=o+e+(n?t.pathTopRight:""))}this.outlinePath_+=d("V",e.yPos+e.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){var e=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=ho(e.xPos,this.info_.startY),this.outlinePath_+=d("h",e.width)}drawFlatBottom_(){var e=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=d("V",e.baseline),this.outlinePath_+=d("h",-e.width)}drawInlineInput_(e){this.positionInlineInputConnection_(e);var t=e.input.name;e.connectedBlock||this.info_.isInsertionMarker||(e=uo(e.xPos+e.connectionWidth,e.centerline-e.height/2)+this.getInlineInputPath(e),this.block_.pathObject.setOutlinePath(t,e))}getInlineInputPath(e){var t=e.width-2*e.connectionWidth,i=e.height;return d("h",t)+e.shape.pathRightDown(i)+d("h",-t)+e.shape.pathUp(i)+"z"}drawStatementInput_(e){var t=(r=e.getLastInput()).xPos+r.notchOffset+r.shape.width,i=this.constants_.INSIDE_CORNERS,n=r.shape.pathRight+d("h",-(r.notchOffset-i.width))+i.pathTop,o=e.height-2*i.height,r=i.pathBottom+d("h",r.notchOffset-i.width)+(r.connectedBottomNextConnection?"":r.shape.pathLeft);this.outlinePath_+=d("H",t)+n+d("v",o)+r+d("H",e.xPos+e.width),this.positionStatementInputConnection_(e)}drawConnectionHighlightPath(e){var t=e.connectionModel;if(t.type===v.NEXT_STATEMENT||t.type===v.PREVIOUS_STATEMENT||t.type===v.OUTPUT_VALUE&&!e.isDynamicShape)return super.drawConnectionHighlightPath(e);e=t.type===v.INPUT_VALUE?uo(e.connectionWidth,-e.height/2)+this.getInlineInputPath(e):uo(e.width,-e.height/2)+e.shape.pathDown(e.height);var i,n,o=t.getSourceBlock();return null==(n=(i=o.pathObject).addConnectionHighlight)?void 0:n.call(i,t,e,t.getOffsetInBlock(),o.RTL)}},ep=class extends x{constructor(e,t,i,n,o,r,s){if(super(x.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",i=Number(on(i)),t=Number(on(t)),isNaN(i)||isNaN(t))throw Error("Height and width values of an image field must cast to numbers.");if(i<=0||t<=0)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new I(t,i+ep.Y_PADDING),this.imageHeight=i,"function"==typeof o&&(this.clickHandler=o),e!==x.SKIP_SETUP&&(s?this.configure_(s):(this.flipRtl=!!r,this.altText=on(n)||""),this.setValue(on(e)))}configure_(e){super.configure_(e),e.flipRtl&&(this.flipRtl=e.flipRtl),e.alt&&(this.altText=on(e.alt))}initView(){this.imageElement=l(k.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS(Na,"xlink:href",this.value_),this.fieldGroup_&&c(this.fieldGroup_,"blocklyImageField"),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(e){return"string"!=typeof e?null:e}doValueUpdate_(e){this.value_=e,this.imageElement&&this.imageElement.setAttributeNS(Na,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(e){e!==this.altText&&(this.altText=e||"",this.imageElement)&&this.imageElement.setAttribute("alt",this.altText)}isClickable(){return super.isClickable()&&!!this.clickHandler}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(e){this.clickHandler=e}getText_(){return this.altText}static fromJson(e){if(e.src&&e.width&&e.height)return new this(e.src,e.width,e.height,void 0,void 0,void 0,e);throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.")}},tp=(ep.Y_PADDING=1,Jd("field_image",ep),ep.prototype.DEFAULT_VALUE="",class extends x{set size_(e){super.size_=e}get size_(){var e=super.size_;return e.width<14&&(e.width=14),e}constructor(e,t,i){super(x.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onInputWrapper=this.onKeyDownWrapper=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,e!==x.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),t)&&this.setValidator(t)}configure_(e){super.configure_(e),void 0!==e.spellcheck&&(this.spellcheck_=e.spellcheck)}initView(){if(!this.getSourceBlock())throw new Jc;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot()),this.fieldGroup_&&c(this.fieldGroup_,"blocklyInputField")}isFullBlockField(){var e,t=this.getSourceBlock();if(t)return this.fullBlockClickTarget_=!(null==(e=this.getConstants())||!e.FULL_BLOCK_FIELDS)&&t.isSimpleReporter();throw new Jc}doValueInvalid_(e,t=!0){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,e=this.value_,this.value_=this.valueWhenEditorWasOpened_,this.sourceBlock_)&&U()&&this.value_!==e&&t&&g(new(f(_.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,e,this.value_))}doValueUpdate_(e){this.isTextValid_=this.isDirty_=!0,this.value_=e}applyColour(){var e=this.getSourceBlock();if(!e)throw new Jc;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",e.getColourTertiary())):(this.borderRect_.style.display="none",e.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){var e;return null!=(e=this.getConstants())&&e.FULL_BLOCK_FIELDS&&(this.render_(),this.isDirty_=!1),super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){var e;if(super.render_(),this.isBeingEdited_&&(e=this.htmlInput_,this.isTextValid_?(s(e,"blocklyInvalidInput"),Ze(e,na.INVALID,!1)):(c(e,"blocklyInvalidInput"),Ze(e,na.INVALID,!0))),!(e=this.getSourceBlock()))throw new Jc;this.getConstants().FULL_BLOCK_FIELDS&&e.applyColour()}setSpellcheck(e){e!==this.spellcheck_&&(this.spellcheck_=e,this.htmlInput_)&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_)}showEditor_(e,t=!1,i=!0){this.workspace_=this.sourceBlock_.workspace,!t&&this.workspace_.options.modalInputs&&(fa||da||ha)?this.showPromptEditor():this.showInlineEditor(t,i)}showPromptEditor(){dt(m.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),e=>{null!==e&&this.setValue(this.getValueFromEditorText_(e)),this.onFinishEditing_(this.value_)})}showInlineEditor(e,t){var i=this.getSourceBlock();if(!i)throw new Jc;an(this,i.RTL,this.widgetDispose_.bind(this),this.workspace_,t),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,e||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var e=this.getSourceBlock();if(!e)throw new Jc;m.setGroup$$module$build$src$core$events$utils(!0);var t=la,i=this.getClickTarget_();if(!i)throw Error("A click target has not been set.");c(i,"blocklyEditing"),(i=document.createElement("input")).className="blocklyHtmlInput",i.setAttribute("spellcheck",this.spellcheck_);var n=this.workspace_.getAbsoluteScale(),o=this.getConstants().FIELD_TEXT_FONTSIZE*n+"pt";return t.style.fontSize=o,i.style.fontSize=o,o=tp.BORDERRADIUS*n+"px",this.isFullBlockField()&&(o=((o=this.getScaledBBox()).bottom-o.top)/2+"px",e=(e.getParent()?e.getParent():this.sourceBlock_).getColourTertiary(),i.style.border=+n+"px solid "+e,t.style.borderRadius=o,t.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW)&&(t.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*n+"px"),i.style.borderRadius=o,t.appendChild(i),i.value=i.defaultValue=this.getEditorText_(this.value_),i.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(i),i}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&U()&&null!==this.valueWhenEditorWasOpened_&&this.valueWhenEditorWasOpened_!==this.value_&&(g(new(f(_.BLOCK_CHANGE))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),m.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var e=la.style;if(e.width="auto",e.height="auto",e.fontSize="",e.transition="",e.boxShadow="",this.htmlInput_=null,!(e=this.getClickTarget_()))throw Error("A click target has not been set.");s(e,"blocklyEditing")}onFinishEditing_(e){}bindInputEvents_(e){this.onKeyDownWrapper=p(e,"keydown",this,this.onHtmlInputKeyDown_),this.onInputWrapper=p(e,"input",this,this.onHtmlInputChange)}unbindInputEvents_(){this.onKeyDownWrapper&&(r(this.onKeyDownWrapper),this.onKeyDownWrapper=null),this.onInputWrapper&&(r(this.onInputWrapper),this.onInputWrapper=null)}onHtmlInputKeyDown_(e){var t,i;"Enter"===e.key?(un(this),ki()):"Escape"===e.key?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value"),!1),un(this),ki()):"Tab"===e.key&&(e.preventDefault(),t=null==(i=this.workspace_)?void 0:i.getCursor(),i=e=>(e instanceof tp||e instanceof N&&e.isSimpleReporter())&&e!==this.getSourceBlock(),(e=(e=e.shiftKey?null==t?void 0:t.getPreviousNode(this,i,!1):null==t?void 0:t.getNextNode(this,i,!1))instanceof N&&e.isSimpleReporter()?e.getFields().next().value:e)instanceof tp)&&(un(this),ki(),t=e.getSourceBlock(),e.isFullBlockField()&&t&&t instanceof N?m.getFocusManager$$module$build$src$core$focus_manager().focusNode(t):m.getFocusManager$$module$build$src$core$focus_manager().focusNode(e),e.showEditor())}onHtmlInputChange(e){e=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&U()&&this.value_!==e&&g(new(f(_.BLOCK_FIELD_INTERMEDIATE_CHANGE))(this.sourceBlock_,this.name||null,e,this.value_))}setEditorValue_(e,t=!0){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(e)),this.setValue(e,t)}resizeEditor_(){tt().then(()=>{var e=this.getSourceBlock();if(!e)throw new Jc;var t=la,i=this.getScaledBBox(),n=(t.style.width=i.right-i.left+"px",t.style.height=i.bottom-i.top+"px",i.top);t.style.left=`${e.RTL?i.right-t.offsetWidth:i.left}px`,t.style.top=n+"px"})}repositionForWindowResize(){var e=null==(e=this.getSourceBlock())?void 0:e.getRootBlock();return e instanceof N&&(Oo(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),e)||this.resizeEditor_(),!0)}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(e){return""+e}getValueFromEditorText_(e){return e}}),ip=(tp.BORDERRADIUS=4,m.FieldTextInput$$module$build$src$core$field_textinput=class extends tp{constructor(e,t,i){super(e,t,i)}initView(){super.initView(),this.fieldGroup_&&c(this.fieldGroup_,"blocklyTextInputField")}doClassValidation_(e){return void 0===e?null:""+e}static fromJson(e){return new this(on(e.text),void 0,e)}},Jd("field_input",m.FieldTextInput$$module$build$src$core$field_textinput),m.FieldTextInput$$module$build$src$core$field_textinput.prototype.DEFAULT_VALUE="",m.FieldTextInput$$module$build$src$core$field_textinput,class extends eh{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){return!!e.outputConnection}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}}),np=class extends mh{constructor(e,t){if(super(e,t),this.connectedBottomNextConnection=!1,this.connectedBlock){for(e=this.connectedBlock;t=e.getNextBlock();)e=t;e.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},op=class extends D{constructor(e){super(e),this.width=this.height=0,this.type|=L.getType("RIGHT_CONNECTION")}},rp=class extends bh{constructor(e){super(e)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(e){var t=(e.hat?"cap"===e.hat:this.constants_.ADD_START_HATS)&&!e.outputConnection&&!e.previousConnection;return!!e.outputConnection||t}hasRightSquareCorner(e){return!!e.outputConnection&&!e.statementInputCount&&!e.nextConnection}},sp=class extends vh{constructor(e,t){super(e,t),this.isInline=!0,this.renderer_=e,this.constants_=this.renderer_.getConstants(),this.topRow=new rp(this.constants_),this.bottomRow=new ip(this.constants_),this.isMultiRow=!t.getInputsInline()||t.isCollapsed(),this.hasStatementInput=0<t.statementInputCount,this.rightSide=this.outputConnection?new op(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(e,t){return!!t&&(t instanceof id||e instanceof nd||t instanceof nd||(e instanceof m.ValueInput$$module$build$src$core$inputs$value_input||e instanceof td||e instanceof id)&&(!this.isInline||this.isMultiRow))}getDesiredRowWidth_(e){return e.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(e)}getInRowSpacing_(e,t){return e&&t||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!e&&t&&L.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:e&&L.isLeftRoundedCorner(e)&&t&&(L.isPreviousConnection(t)||L.isNextConnection(t))?t.notchOffset-this.constants_.CORNER_RADIUS:e&&L.isLeftSquareCorner(e)&&t&&L.isHat(t)||e&&L.isField(e)&&0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(e,t){var i,n;return L.isTopRow(e)&&L.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:(i=L.isInputRow(e)&&e.hasStatement,(n=L.isInputRow(t)&&t.hasStatement)||i?(e=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),n&&i?Math.max(e,this.constants_.DUMMY_INPUT_MIN_HEIGHT):e):L.isTopRow(e)?e.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):L.isBottomRow(t)?this.outputConnection?!t.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING)}getSpacerRowWidth_(e,t){var i=this.width-this.startX;return L.isInputRow(e)&&e.hasStatement||L.isInputRow(t)&&t.hasStatement?Math.max(i,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):i}getElemCenterline_(e,t){if(e.hasStatement&&!L.isSpacer(t)&&!L.isStatementInput(t))return e.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(L.isInlineInput(t)){var i=t.connectedBlock;if(i&&i.outputConnection&&i.nextConnection)return e.yPos+i.height/2}return super.getElemCenterline_(e,t)}addInput_(e,t){if((e instanceof td||e instanceof id)&&t.hasDummyInput&&t.align===m.Align$$module$build$src$core$inputs$align.LEFT&&e.align===m.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(t,e);else if(e instanceof nd)return t.elements.push(new np(this.constants_,e)),t.hasStatement=!0,void(null===t.align&&(t.align=e.align));super.addInput_(e,t)}addAlignmentPadding_(i,e){if(this.rightAlignedDummyInputs.get(i)){let t;for(let e=0;e<i.elements.length;e++){var n=i.elements[e];if(L.isSpacer(n)&&(t=n),L.isField(n)&&n.parentInput===this.rightAlignedDummyInputs.get(i))break}if(t)return t.width+=e,void(i.width+=e)}super.addAlignmentPadding_(i,e)}adjustXPosition_(){var t=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let i=t;for(let e=2;e<this.rows.length-1;e+=2){var n,o=this.rows[e-1],r=this.rows[e],s=this.rows[e+1],o=2===e?!!this.topRow.hasPreviousConnection:!!o.followsStatement,s=e+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!s.precedesStatement;if(L.isInputRow(r)&&r.hasStatement)r.measure(),i=r.width-(null!=(n=null==(n=r.getLastInput())?void 0:n.width)?n:0)+t;else if(o&&(2===e||s)&&L.isInputRow(r)&&!r.hasStatement){s=r.xPos,o=null;for(let e=0;e<r.elements.length;e++){var a=r.elements[e];!((o=L.isSpacer(a)?a:o)&&(L.isField(a)||L.isInput(a))&&s<i)||L.isField(a)&&(a.field instanceof Xu||a.field instanceof ep)||(o.width+=i-s),s+=a.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var e=this.outputConnection.shape;if("isDynamic"in e&&e.isDynamic){for(var t=0,i=0;i<this.rows.length;i++){var n=this.rows[i];n.yPos=t,t+=n.height}this.height=t,i=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,t=e.height(i),i=e.width(i),this.outputConnection.height=t,this.outputConnection.width=i,this.outputConnection.startX=i,this.outputConnection.connectionOffsetY=e.connectionOffsetY(t),this.outputConnection.connectionOffsetX=e.connectionOffsetX(i),e=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(e=i,this.rightSide.height=t,this.rightSide.width=e,this.rightSide.centerline=t/2,this.rightSide.xPos=this.width+e),this.startX=i,this.width+=i+e,this.widthWithChildren+=i+e}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var i=0,e=0;e<this.rows.length;e++){var n=this.rows[e];if(L.isInputRow(n)){i=n.elements[n.elements.length-2];let e=this.getNegativeSpacing_(n.elements[1]),t=this.getNegativeSpacing_(i);var i=e+t,o=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-i<o&&(i=this.width-o,e=i/2,t=i/2),n.elements.unshift(new sh(this.constants_,-e)),n.elements.push(new sh(this.constants_,-t))}}if(i)for(this.width-=i,this.widthWithChildren-=i,this.rightSide.xPos-=i,e=0;e<this.rows.length;e++)n=this.rows[e],L.isTopOrBottomRow(n)&&(n.elements[1].width-=i),n.width-=i,n.widthWithConnectedBlocks-=i}}getNegativeSpacing_(e){var t,i,n,o;return e&&this.outputConnection?(t=this.outputConnection.width,i=this.outputConnection.shape.type,n=this.constants_,1<this.inputRows.length?i!==n.SHAPES.ROUND?0:(i=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,t-(i=this.height/2>i?i:this.height/2)*(1-Math.sin(Math.acos((i-this.constants_.SMALL_PADDING)/i)))):L.isInlineInput(e)?null==(e=(o=e.connectedBlock)?o.pathObject.outputShapeType:e.shape.type)||o&&o.outputConnection&&(o.statementInputCount||o.nextConnection)||i===n.SHAPES.HEXAGONAL&&i!==e?0:t-this.constants_.SHAPE_IN_SHAPE_PADDING[i][e]:L.isField(e)?i===n.SHAPES.ROUND&&e.field instanceof m.FieldTextInput$$module$build$src$core$field_textinput?t-2.75*n.GRID_UNIT:t-this.constants_.SHAPE_IN_SHAPE_PADDING[i][0]:L.isIcon(e)?this.constants_.SMALL_PADDING:0):0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let e=2;e<this.rows.length-1;e+=2){var t=this.rows[e-1],i=this.rows[e],n=this.rows[e+1],o=2===e,r=e+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!n.precedesStatement;if(o?this.topRow.hasPreviousConnection:t.followsStatement){var s=i.elements[1],s=3===i.elements.length&&s instanceof nh&&(s.field instanceof Xu||s.field instanceof ep);if(!o&&s)t.height-=this.constants_.SMALL_PADDING,n.height-=this.constants_.SMALL_PADDING,i.height-=this.constants_.MEDIUM_PADDING;else if(o||r){if(r){for(o=!1,r=0;r<i.elements.length;r++)if(s=i.elements[r],L.isInlineInput(s)&&s.connectedBlock&&!s.connectedBlock.isShadow()&&40<=s.connectedBlock.getHeightWidth().height){o=!0;break}o&&(t.height-=this.constants_.SMALL_PADDING,n.height-=this.constants_.SMALL_PADDING)}}else t.height+=this.constants_.SMALL_PADDING}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},ap=class extends Th{constructor(e,t,i){super(e,t,i),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=i}setPath(e){super.setPath(e),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",e)}applyColour(e){super.applyColour(e);var t,i=e.getParent();e.isShadow()&&i&&this.svgPath.setAttribute("stroke",i.getColourTertiary());for(t of this.outlines.values())t.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(var e of this.outlines.values())e.setAttribute("transform","scale(-1 1)")}updateSelected(e){this.setClass_("blocklySelected",e),e?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.classList.add("blocklyPathSelected"),s(this.svgPathSelected,Fa.ACTIVE_FOCUS_NODE_CSS_CLASS_NAME),s(this.svgPathSelected,Fa.PASSIVE_FOCUS_NODE_CSS_CLASS_NAME),this.svgPathSelected.removeAttribute("tabindex"),this.svgPathSelected.removeAttribute("id"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(e){this.setClass_("blocklyReplaceable",e)}updateShapeForInputHighlight(e,t){e=e.getParentInput().name,(e=this.getOutlinePath(e))&&(t?e.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):e.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(var e of this.outlines.keys())this.remainingOutlines.add(e)}endDrawing(){if(this.remainingOutlines.size)for(var e of this.remainingOutlines)this.removeOutlinePath(e);this.remainingOutlines.clear()}setOutlinePath(e,t){(e=this.getOutlinePath(e)).setAttribute("d",t),e.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(e){return this.outlines.has(e)||this.outlines.set(e,l(k.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(e),this.outlines.get(e)}removeOutlinePath(e){let t,i;null!=(t=this.outlines.get(e))&&null!=(i=t.parentNode)&&i.removeChild(this.outlines.get(e)),this.outlines.delete(e)}},lp=class extends Xc{constructor(e){super(e)}makeConstants_(){return new Zh}makeRenderInfo_(e){return new sp(this,e)}makeDrawer_(e,t){return new Qh(e,t)}makePathObject(e,t){return new ap(e,t,this.getConstants())}getConstants(){return this.constants_}},cp=(nr("zelos",lp),class{constructor(e){this.staticConn=this.draggedConn=this.markerConn=this.fadedBlock=null,this.workspace=e.workspace}previewReplacement(e,t,i){m.disable$$module$build$src$core$events$utils();try{this.hidePreview(),(this.fadedBlock=i).fadeForReplacement(!0),this.workspace.getRenderer().shouldHighlightConnection(t)&&(t.highlight(),this.staticConn=t)}finally{m.enable$$module$build$src$core$events$utils()}}previewConnection(e,t){if(e!==this.draggedConn||t!==this.staticConn){m.disable$$module$build$src$core$events$utils();try{this.hidePreview(),this.shouldUseMarkerPreview(e,t)&&(this.markerConn=this.previewMarker(e,t)),this.workspace.getRenderer().shouldHighlightConnection(t)&&t.highlight(),this.draggedConn=e,this.staticConn=t}finally{m.enable$$module$build$src$core$events$utils()}}}shouldUseMarkerPreview(e,t){return t.type===v.PREVIOUS_STATEMENT||t.type===v.NEXT_STATEMENT||!(this.workspace.getRenderer()instanceof lp)}previewMarker(e,t){let i=e.getSourceBlock(),n=this.createInsertionMarker(i),o=this.getMatchingConnection(i,n,e);if(!o)return null;n.queueRender(),it(),o.connect(t);let r={x:t.x-o.x,y:t.y-o.y},s=o.getOffsetInBlock().clone();return tt().then(()=>{if(!n.isDeadOrDying()){m.disable$$module$build$src$core$events$utils();try{null!=n&&n.positionNearConnection(o,r,s),null!=n&&n.getSvgRoot().setAttribute("visibility","visible")}finally{m.enable$$module$build$src$core$events$utils()}}}),o}createInsertionMarker(e){var t,i=$t(e,{addCoordinates:!1,addInputBlocks:!1,addNextBlocks:!1,doFullSerialization:!1});if(!i)throw Error("Failed to serialize source block. "+e.toDevString());for(t of(e=Wt(i,this.workspace)).getDescendants(!1))t.setInsertionMarker(!0);return e.initSvg(),e.getSvgRoot().setAttribute("visibility","hidden"),e}getMatchingConnection(t,i,n){if(t=t.getConnections_(!0),i=i.getConnections_(!0),t.length===i.length)for(let e=0;e<t.length;e++)if(t[e]===n)return i[e];return null}hidePreview(){m.disable$$module$build$src$core$events$utils();try{this.staticConn&&(this.staticConn.unhighlight(),this.staticConn=null),this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null),this.markerConn&&(this.hideInsertionMarker(this.markerConn),this.draggedConn=this.markerConn=null)}finally{m.enable$$module$build$src$core$events$utils()}}hideInsertionMarker(e){var t,i=e.getSourceBlock(),n=i.outputConnection;null!=(t=i.previousConnection)&&t.targetConnection||null!=n&&n.targetConnection?i.unplug(!0):null!=(t=e.targetBlock())&&t.unplug(!1),i.dispose()}dispose(){this.hidePreview()}}),up=(o(b.CONNECTION_PREVIEWER,Us,cp),{}),dp=(up.Align=m.Align$$module$build$src$core$inputs$align,up.DummyInput=td,up.EndRowInput=id,up.Input=ed,up.StatementInput=nd,up.ValueInput=m.ValueInput$$module$build$src$core$inputs$value_input,up.inputTypes=m.inputTypes$$module$build$src$core$inputs$input_types,!1),hp=(m.CodeGenerator$$module$build$src$core$generator=class{constructor(e){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=e,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(i){i||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),i=Js);var n=[];this.init(i),i=i.getTopBlocks(!0);for(let e=0,t;t=i[e];e++){let e=this.blockToCode(t);(e=Array.isArray(e)?e[0]:e)&&(t.outputConnection&&(e=this.scrubNakedValue(e),this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(e=this.injectId(this.STATEMENT_PREFIX,t)+e),this.STATEMENT_SUFFIX)&&!t.suppressPrefixSuffix&&(e+=this.injectId(this.STATEMENT_SUFFIX,t)),n.push(e))}return n=n.join("\n"),(n=(n=(n=this.finish(n)).replace(/^\s+\n/,"")).replace(/\n\s+$/,"\n")).replace(/[ \t]+\n/g,"\n")}prefixLines(e,t){return t+e.replace(/(?!\n$)\n/g,"\n"+t)}allNestedComments(t){var i=[];t=t.getDescendants(!0);for(let e=0;e<t.length;e++){var n=t[e].getCommentText();n&&i.push(n)}return i.length&&i.push(""),i.join("\n")}blockToCode(e,t){if(!1===this.isInitialized&&console.warn("CodeGenerator init was not called before blockToCode was called."),!e)return"";if(!e.isEnabled())return t?"":this.blockToCode(e.getNextBlock());if(e.isInsertionMarker())return t?"":this.blockToCode(e.getChildren(!1)[0]);var i=this.forBlock[e.type];if("function"!=typeof i)throw Error(this.name_+" generator does not know how to generate code "+`for block type "${e.type}".`);if(i=i.call(e,e,this),Array.isArray(i)){if(e.outputConnection)return[this.scrub_(e,i[0],t),i[1]];throw TypeError("Expecting string from statement block: "+e.type)}if("string"==typeof i)return this.STATEMENT_PREFIX&&!e.suppressPrefixSuffix&&(i=this.injectId(this.STATEMENT_PREFIX,e)+i),this.STATEMENT_SUFFIX&&!e.suppressPrefixSuffix&&(i+=this.injectId(this.STATEMENT_SUFFIX,e)),this.scrub_(e,i,t);if(null===i)return"";throw SyntaxError("Invalid code generated: "+i)}valueToCode(e,t,i){if(isNaN(i))throw TypeError("Expecting valid order from block: "+e.type);if(!(n=e.getInputTargetBlock(t))&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if(!n)return"";if(""===(t=this.blockToCode(n)))return"";if(!Array.isArray(t))throw TypeError(`Expecting tuple from value block: ${n.type} See `+"developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information");if(e=t[0],t=t[1],isNaN(t))throw TypeError("Expecting valid order from value block: "+n.type);if(!e)return"";var n=!1,o=Math.floor(i),r=Math.floor(t);if(o<=r&&(o!==r||0!==o&&99!==o))for(n=!0,o=0;o<this.ORDER_OVERRIDES.length;o++)if(this.ORDER_OVERRIDES[o][0]===i&&this.ORDER_OVERRIDES[o][1]===t){n=!1;break}return e=n?"("+e+")":e}statementToCode(e,t){var i=e.getInputTargetBlock(t);if(!i&&!e.getInput(t))throw ReferenceError(`Input "${t}" doesn't exist on "${e.type}"`);if("string"!=typeof(e=this.blockToCode(i)))throw TypeError("Expecting code from statement block: "+(i&&i.type));return e=e&&this.prefixLines(e,this.INDENT)}addLoopTrap(e,t){return this.INFINITE_LOOP_TRAP&&(e=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,t),this.INDENT)+e),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(e=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,t),this.INDENT)+e),this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(e+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,t),this.INDENT)),e}injectId(e,t){return t=t.id.replace(/\$/g,"$$$$"),e.replace(/%1/g,"'"+t+"'")}addReservedWords(e){this.RESERVED_WORDS_+=e+","}provideFunction_(t,i){if(!this.definitions_[t]){var n=this.nameDB_.getDistinctName(t,m.NameType$$module$build$src$core$names.PROCEDURE);this.functionNames_[t]=n,i=(i=Array.isArray(i)?i.join("\n"):i).trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,n);let e;for(;e!==i;)i=(e=i).replace(/^(( {2})*) {2}/gm,"$1\0");i=i.replace(/\0/g,this.INDENT),this.definitions_[t]=i}return this.functionNames_[t]}getVariableName(e){return this.getName(e,m.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(e){return this.getName(e,m.NameType$$module$build$src$core$names.PROCEDURE)}getName(e,t){if(this.nameDB_)return this.nameDB_.getName(e,t);throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.")}init(e){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(e,t,i){return t}finish(e){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),e}scrubNakedValue(e){return e}},0,m.CodeGenerator$$module$build$src$core$generator,class extends Md{constructor(e){super(e)}setMetrics_(e){var t,i,n;this.isVisible()&&(t=(n=this.workspace_.getMetricsManager()).getScrollMetrics(),i=n.getViewMetrics(),n=n.getAbsoluteMetrics(),"number"==typeof e.y&&(this.workspace_.scrollY=-(t.top+(t.height-i.height)*e.y)),this.workspace_.translate(this.workspace_.scrollX+n.left,this.workspace_.scrollY+n.top))}getX(){var e,t,i;return this.isVisible()?(e=(i=this.targetWorkspace.getMetricsManager()).getAbsoluteMetrics(),t=i.getViewMetrics(),i=i.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===y.LEFT?i.width:t.width-this.getWidth():this.toolboxPosition_===y.LEFT?0:t.width:this.toolboxPosition_===y.LEFT?0:t.width+e.left-this.getWidth()):0}getY(){return 0}position(){var e,t;this.isVisible()&&this.targetWorkspace.isVisible()&&(e=this.targetWorkspace.getMetricsManager().getViewMetrics(),this.height_=e.height,t=this.getWidth()-this.CORNER_RADIUS,this.setBackgroundPath(t,e.height-2*this.CORNER_RADIUS),e=this.getX(),t=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),e,t))}setBackgroundPath(e,t){var i=this.toolboxPosition_===y.RIGHT,n=e+this.CORNER_RADIUS;(n=["M "+(i?n:0)+",0"]).push("h",i?-e:e),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,i?0:1,i?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),n.push("v",Math.max(0,t)),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,i?0:1,i?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),n.push("h",i?e:-e),n.push("z"),this.svgBackground_.setAttribute("d",n.join(" "))}scrollToStart(){var e;null!=(e=this.workspace_.scrollbar)&&e.setY(0)}wheel_(e){var t,i,n=ws(e);n.y&&(t=(i=this.workspace_.getMetricsManager()).getScrollMetrics(),n=i.getViewMetrics().top-t.top+n.y,null!=(i=this.workspace_.scrollbar)&&i.setY(n),dn(this.workspace_),ki()),e.preventDefault(),e.stopPropagation()}layout_(e){this.workspace_.scale=this.targetWorkspace.scale;var t,i=this.MARGIN,n=this.RTL?i:i+this.tabWidth_;for(t of e)t.getElement().moveBy(n,i),i+=t.getElement().getBoundingRectangle().getHeight()}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;var t=this.dragAngleRange_;return e<t&&-t<e||e<-180+t||180-t<e}getClientRect(){var e,t;return this.svgGroup_&&!this.autoClose&&this.isVisible()?(t=(e=this.svgGroup_.getBoundingClientRect()).left,this.toolboxPosition_===y.LEFT?new C(-1e9,1e9,-1e9,t+e.width):new C(-1e9,1e9,t,1e9)):null}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();var e=this.getContents().reduce((e,t)=>Math.max(e,t.getElement().getBoundingRectangle().getWidth()),0),e=(e=(e+=1.5*this.MARGIN+this.tabWidth_)*this.workspace_.scale)+nl.scrollbarThickness;if(this.getWidth()!==e){if(this.RTL)for(var t of this.getContents()){var i=t.getElement().getBoundingRectangle().left,n=e/this.workspace_.scale-t.getElement().getBoundingRectangle().getWidth()-this.MARGIN-this.tabWidth_;t.getElement().moveBy(n-i,0)}this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==y.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+e,this.targetWorkspace.scrollY),this.width_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}}),pp=(hp.registryName="verticalFlyout",o(b.FLYOUTS_VERTICAL_TOOLBOX,Us,hp),class extends Md{constructor(e){super(e),this.horizontalLayout=!0}setMetrics_(e){var t,i,n;this.isVisible()&&(t=(n=this.workspace_.getMetricsManager()).getScrollMetrics(),i=n.getViewMetrics(),n=n.getAbsoluteMetrics(),"number"==typeof e.x&&(this.workspace_.scrollX=-(t.left+(t.width-i.width)*e.x)),this.workspace_.translate(this.workspace_.scrollX+n.left,this.workspace_.scrollY+n.top))}getX(){return 0}getY(){var e,t,i,n;return this.isVisible()?(e=(i=this.targetWorkspace.getMetricsManager()).getAbsoluteMetrics(),t=i.getViewMetrics(),i=i.getToolboxMetrics(),n=this.toolboxPosition_===y.TOP,this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?n?i.height:t.height-this.getHeight():n?0:t.height:n?0:t.height+e.top-this.getHeight()):0}position(){var e,t;this.isVisible()&&this.targetWorkspace.isVisible()&&(e=this.targetWorkspace.getMetricsManager().getViewMetrics(),this.width_=e.width,e=e.width-2*this.CORNER_RADIUS,t=this.getHeight()-this.CORNER_RADIUS,this.setBackgroundPath(e,t),e=this.getX(),t=this.getY(),this.positionAt_(this.getWidth(),this.getHeight(),e,t))}setBackgroundPath(e,t){var i=this.toolboxPosition_===y.TOP,n=["M 0,"+(i?0:this.CORNER_RADIUS)];i?(n.push("h",e+2*this.CORNER_RADIUS),n.push("v",t),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),n.push("h",-e),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),n.push("h",e),n.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),n.push("v",t),n.push("h",-e-2*this.CORNER_RADIUS)),n.push("z"),this.svgBackground_.setAttribute("d",n.join(" "))}scrollToStart(){var e;null!=(e=this.workspace_.scrollbar)&&e.setX(this.RTL?1/0:0)}wheel_(e){var t,i,n=ws(e);(n=n.x||n.y)&&(t=(i=this.workspace_.getMetricsManager()).getScrollMetrics(),n=i.getViewMetrics().left-t.left+n,null!=(i=this.workspace_.scrollbar)&&i.setX(n),dn(this.workspace_),ki()),e.preventDefault(),e.stopPropagation()}layout_(e){this.workspace_.scale=this.targetWorkspace.scale;var t,i=this.MARGIN;let n=i+this.tabWidth_;for(t of e=this.RTL?e.reverse():e)e=t.getElement().getBoundingRectangle(),e=this.RTL?n+e.getWidth():n,t.getElement().moveBy(e,i),n+=t.getElement().getBoundingRectangle().getWidth()}isDragTowardWorkspace(e){e=Math.atan2(e.y,e.x)/Math.PI*180;var t=this.dragAngleRange_;return e<90+t&&90-t<e||-90-t<e&&e<-90+t}getClientRect(){var e,t;return this.svgGroup_&&!this.autoClose&&this.isVisible()?(t=(e=this.svgGroup_.getBoundingClientRect()).top,this.toolboxPosition_===y.TOP?new C(-1e9,t+e.height,-1e9,1e9):new C(t,1e9,-1e9,1e9)):null}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();var e=this.getContents().reduce((e,t)=>Math.max(e,t.getElement().getBoundingRectangle().getHeight()),0),e=(e=(e+=1.5*this.MARGIN)*this.workspace_.scale)+nl.scrollbarThickness;this.getHeight()!==e&&(this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==y.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+e),this.height_=e,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets())}}),gp=(o(b.FLYOUTS_HORIZONTAL_TOOLBOX,Us,pp),class extends Du{constructor(e,t,i,n,o){super(x.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=gp.dropdownCreate,this.defaultVariableName="string"==typeof e?e:"",this.size_=new I(0,0),e!==x.SKIP_SETUP&&(o?this.configure_(o):this.setTypes(i,n),t)&&this.setValidator(t)}configure_(e){super.configure_(e),this.setTypes(e.variableTypes,e.defaultType)}initModel(){var e=this.getSourceBlock();if(!e)throw new Jc;this.variable||(e=m.getOrCreateVariablePackage$$module$build$src$core$variables(e.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(e.getId()))}initView(){super.initView(),c(this.fieldGroup_,"blocklyVariableField")}shouldAddBorderRect_(){var e=this.getSourceBlock();if(e)return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||"variables_get"!==e.type);throw new Jc}fromXml(e){if(!(o=this.getSourceBlock()))throw new Jc;var t=e.getAttribute("id"),i=e.textContent,n=e.getAttribute("variabletype")||e.getAttribute("variableType")||"",o=m.getOrCreateVariablePackage$$module$build$src$core$variables(o.workspace,t,i,n);if(null!==n&&n!==o.getType())throw Error("Serialized variable type with id '"+o.getId()+"' had type "+o.getType()+", and does not match variable field that references it: "+$n(e)+".");this.setValue(o.getId())}toXml(e){return this.initModel(),e.id=this.variable.getId(),e.textContent=this.variable.getName(),this.variable.getType()&&e.setAttribute("variabletype",this.variable.getType()),e}saveState(e){var t=this.saveLegacyState(gp);return null===t&&(this.initModel(),t={id:this.variable.getId()},e)&&(t.name=this.variable.getName(),t.type=this.variable.getType()),t}loadState(e){var t=this.getSourceBlock();if(!t)throw new Jc;this.loadLegacyState(gp,e)||(e=m.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,e.id||null,e.name,e.type||""),this.setValue(e.getId()))}setSourceBlock(e){if(e.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(e)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.getName():""}getVariable(){return this.variable}getDefaultType(){return this.defaultType}getValidator(){return this.variable?this.validator_:null}doClassValidation_(e){if(null===e)return null;var t=this.getSourceBlock();if(t)return(t=m.getVariable$$module$build$src$core$variables(t.workspace,e))?(t=t.getType(),this.typeIsAllowed(t)?e:(console.warn("Variable type doesn't match this field!  Type was "+t),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+e),null);throw new Jc}doValueUpdate_(e){var t=this.getSourceBlock();if(!t)throw new Jc;this.variable=m.getVariable$$module$build$src$core$variables(t.workspace,e),super.doValueUpdate_(e)}typeIsAllowed(t){var i=this.getVariableTypes();if(!i)return!0;for(let e=0;e<i.length;e++)if(t===i[e])return!0;return!1}getVariableTypes(){if(this.variableTypes)return this.variableTypes;if(!this.sourceBlock_||this.sourceBlock_.isDeadOrDying())return[""];let e=this.sourceBlock_.workspace.getVariableMap().getTypes();if(this.sourceBlock_.isInFlyout){var t=this.sourceBlock_.workspace.getPotentialVariableMap();if(!t)return e;e=Array.from(new Set([...e,...t.getTypes()]))}return e}setTypes(t=null,i=""){var n=this.getText();if(Array.isArray(t)){if(0===t.length)throw Error(`'variableTypes' of field variable ${n} was an empty list. If you want to include all variable types, pass 'null' instead.`);n=!1;for(let e=0;e<t.length;e++)t[e]===i&&(n=!0);if(!n)throw Error("Invalid default type '"+i+"' in the definition of a FieldVariable")}else if(null!==t)throw Error("'variableTypes' was not an array or null in the definition of FieldVariable "+n);this.defaultType=i,this.variableTypes=t}refreshVariableName(){this.forceRerender()}onItemSelected_(e,t){if(e=t.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(e===Ju&&this.variable)return void m.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);if(e===Zu&&this.variable)return e=this.variable.getWorkspace(),void m.deleteVariable$$module$build$src$core$variables(e,this.variable,this.sourceBlock_)}this.setValue(e)}referencesVariables(){return!0}static fromJson(e){return new this(on(e.variable),void 0,void 0,void 0,e)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");var e=this.getText();let t=[];if((i=this.getSourceBlock())&&!i.isDeadOrDying()){var i=i.workspace,n=this.getVariableTypes();for(let e=0;e<n.length;e++){var o,r,s=n[e],a=i.getVariableMap().getVariablesOfType(s);t=t.concat(a),i.isFlyout&&(r=o=void 0,t=t.concat(null!=(r=null==(o=i.getPotentialVariableMap())?void 0:o.getVariablesOfType(s))?r:[]))}}for(t.sort(Dt),o=[],r=0;r<t.length;r++)o[r]=[t[r].getName(),t[r].getId()];return o.push([m.Msg$$module$build$src$core$msg.RENAME_VARIABLE,Ju]),m.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&o.push([m.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",e),Zu]),o}}),Ku=(Jd("field_variable",gp),class extends tp{constructor(e,t,i,n,o,r){super(x.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,e!==x.SKIP_SETUP&&(r?this.configure_(r):this.setConstraints(t,i,n),this.setValue(e),o)&&this.setValidator(o)}configure_(e){super.configure_(e),this.setMinInternal(e.min),this.setMaxInternal(e.max),this.setPrecisionInternal(e.precision)}setConstraints(e,t,i){this.setMinInternal(e),this.setMaxInternal(t),this.setPrecisionInternal(i),this.setValue(this.getValue())}setMin(e){this.setMinInternal(e),this.setValue(this.getValue())}setMinInternal(e){null==e?this.min_=-1/0:(e=Number(e),isNaN(e)||(this.min_=e))}getMin(){return this.min_}setMax(e){this.setMaxInternal(e),this.setValue(this.getValue())}setMaxInternal(e){null==e?this.max_=1/0:(e=Number(e),isNaN(e)||(this.max_=e))}getMax(){return this.max_}setPrecision(e){this.setPrecisionInternal(e),this.setValue(this.getValue())}setPrecisionInternal(e){this.precision_=Number(e)||0;let t=String(this.precision_);var i=(t=t.includes("e")?this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}):t).indexOf(".");this.decimalPlaces=-1===i?e?0:null:t.length-i-1}getPrecision(){return this.precision_}doClassValidation_(e){return null===e||(e=(e=(e=(""+e).replace(/O/gi,"0")).replace(/,/g,"")).replace(/infinity/i,"Infinity"),e=Number(e||0),isNaN(e))?null:(e=Math.min(Math.max(e,this.min_),this.max_),this.precision_&&isFinite(e)&&(e=Math.round(e/this.precision_)*this.precision_),null!==this.decimalPlaces?Number(e.toFixed(this.decimalPlaces)):e)}widgetCreate_(){var e=super.widgetCreate_();return this.min_>-1/0&&(e.min=""+this.min_,Ze(e,na.VALUEMIN,this.min_)),this.max_<1/0&&(e.max=""+this.max_,Ze(e,na.VALUEMAX,this.max_)),e}initView(){super.initView(),this.fieldGroup_&&c(this.fieldGroup_,"blocklyNumberField")}static fromJson(e){return new this(e.value,void 0,void 0,void 0,void 0,e)}}),Vu=(Jd("field_number",Ku),Ku.prototype.DEFAULT_VALUE=0,class extends Xu{constructor(e,t,i){super(String(null!=e?e:""),t,i),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(e){return new this(on(e.text),void 0,e)}}),fp=(Jd("field_label_serializable",Vu),class extends x{constructor(e,t,i){super(x.SKIP_SETUP),this.SERIALIZABLE=!0,this.value_=this.value_,this.checkChar=fp.CHECK_CHAR,e!==x.SKIP_SETUP&&(i&&this.configure_(i),this.setValue(e),t)&&this.setValidator(t)}configure_(e){super.configure_(e),e.checkCharacter&&(this.checkChar=e.checkCharacter)}saveState(){var e=this.saveLegacyState(fp);return null!==e?e:this.getValueBoolean()}initView(){super.initView();var e=this.getTextElement();c(this.fieldGroup_,"blocklyCheckboxField"),e.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(e){this.checkChar=e||fp.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(e){return!0===e||"TRUE"===e?"TRUE":!1===e||"FALSE"===e?"FALSE":null}doValueUpdate_(e){this.value_=this.convertValueToBool(e),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool(this.value_))}convertValueToBool(e){return"string"==typeof e?"TRUE"===e:!!e}static fromJson(e){return new this(e.checked,void 0,e)}}),M=(fp.CHECK_CHAR="âœ“",Jd("field_checkbox",fp),fp.prototype.DEFAULT_VALUE=!1,class{constructor(e,t){this.draggable=e,this.workspace=t,this.dragTarget=null,this.startLoc=e.getRelativeToSurfaceXY()}onDragStart(e){m.getGroup$$module$build$src$core$events$utils()||m.setGroup$$module$build$src$core$events$utils(!0),this.draggable.startDrag(e)}onDrag(e,t){this.moveDraggable(e,t),t=this.getRoot(this.draggable),Do(t)&&t.setDeleteStyle(this.wouldDeleteDraggable(e,t)),this.updateDragTarget(e)}updateDragTarget(e){e=this.workspace.getDragTarget(e);var t,i=this.getRoot(this.draggable);this.dragTarget!==e&&(null!=(t=this.dragTarget)&&t.onDragExit(i),null!=e)&&e.onDragEnter(i),null!=e&&e.onDragOver(i),this.dragTarget=e}moveDraggable(e,t){t=this.pixelsToWorkspaceUnits(t),t=E.sum(this.startLoc,t),this.draggable.drag(t,e)}wouldDeleteDraggable(e,t){return!(!(e=this.workspace.getDragTarget(e))||!this.workspace.getComponentManager().hasCapability(e.id,Xa.Capability.DELETE_AREA))&&e.wouldDelete(t)}onDragEnd(e){var t,i=m.getGroup$$module$build$src$core$events$utils(),n=this.workspace.getDragTarget(e),o=this.getRoot(this.draggable);n&&null!=(t=this.dragTarget)&&t.onDrop(o),this.shouldReturnToStart(e,o)&&this.draggable.revertDrag(),(n=Do(o)&&this.wouldDeleteDraggable(e,o))&&this.draggable instanceof N&&To(this.draggable.getRootBlock()),this.draggable.endDrag(e),n&&Do(o)&&(m.setGroup$$module$build$src$core$events$utils(i),o.dispose()),m.setGroup$$module$build$src$core$events$utils(!1),!n&&Q(this.draggable)&&m.getFocusManager$$module$build$src$core$focus_manager().focusNode(this.draggable)}getRoot(e){return e instanceof N?e.getRootBlock():e}shouldReturnToStart(e,t){return!!(e=this.workspace.getDragTarget(e))&&e.shouldPreventMove(t)}pixelsToWorkspaceUnits(e){return e=new E(e.x/this.workspace.scale,e.y/this.workspace.scale),this.workspace.isMutator&&e.scale(1/this.workspace.options.parentWorkspace.scale),e}}),Ya=(o(b.BLOCK_DRAGGER,Us,M),{}),mp=(Ya.BlockDragStrategy=ud,Ya.BubbleDragStrategy=Bu,Ya.CommentDragStrategy=hu,Ya.Dragger=M,class extends Wa{constructor(e,t,i){super(e?e.workspace.id:void 0),this.type=_.BLOCK_DRAG,e&&(this.blockId=e.id,this.isStart=t,this.blocks=i)}toJson(){var e=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return e.isStart=this.isStart,e.blockId=this.blockId,e.blocks=this.blocks,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new mp)).isStart=e.isStart,t.blockId=e.blockId,t.blocks=e.blocks,t}}),bp=(o(b.EVENT,_.BLOCK_DRAG,mp),class extends dc{constructor(e,t,i,n){super(e),this.type=_.BLOCK_FIELD_INTERMEDIATE_CHANGE,this.recordUndo=!1,e&&(this.name=t,this.oldValue=i,this.newValue=n)}toJson(){var e=super.toJson();if(this.name)return e.name=this.name,e.oldValue=this.oldValue,e.newValue=this.newValue,e;throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new bp)).name=e.name,t.oldValue=e.oldValue,t.newValue=e.newValue,t}isNull(){return this.oldValue===this.newValue}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(!(t=t.getBlockById(this.blockId)))throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");e=e?this.newValue:this.oldValue,(t=t.getField(this.name))?t.setValue(e):console.warn("Can't set non-existent field: "+this.name)}}),_p=(o(b.EVENT,_.BLOCK_FIELD_INTERMEDIATE_CHANGE,bp),class extends dc{constructor(e){super(e),this.type=_.BLOCK_MOVE,e&&(e.isShadow()&&(this.recordUndo=!1),e=this.currentLocation(),this.oldParentId=e.parentId,this.oldInputName=e.inputName,this.oldCoordinate=e.coordinate)}toJson(){var e=super.toJson();return e.oldParentId=this.oldParentId,e.oldInputName=this.oldInputName,this.oldCoordinate&&(e.oldCoordinate=Math.round(this.oldCoordinate.x)+", "+Math.round(this.oldCoordinate.y)),e.newParentId=this.newParentId,e.newInputName=this.newInputName,this.newCoordinate&&(e.newCoordinate=Math.round(this.newCoordinate.x)+", "+Math.round(this.newCoordinate.y)),this.reason&&(e.reason=this.reason),this.recordUndo||(e.recordUndo=this.recordUndo),e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new _p)).oldParentId=e.oldParentId,t.oldInputName=e.oldInputName,e.oldCoordinate&&(i=e.oldCoordinate.split(","),t.oldCoordinate=new E(Number(i[0]),Number(i[1]))),t.newParentId=e.newParentId,t.newInputName=e.newInputName,e.newCoordinate&&(i=e.newCoordinate.split(","),t.newCoordinate=new E(Number(i[0]),Number(i[1]))),void 0!==e.reason&&(t.reason=e.reason),void 0!==e.recordUndo&&(t.recordUndo=e.recordUndo),t}recordNew(){var e=this.currentLocation();this.newParentId=e.parentId,this.newInputName=e.inputName,this.newCoordinate=e.coordinate}setReason(e){this.reason=e}currentLocation(){var e=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var t,i=e.getBlockById(this.blockId);if(i)return e={},(t=i.getParent())?(e.parentId=t.id,(i=t.getInputWithBlock(i))&&(e.inputName=i.name)):e.coordinate=i.getRelativeToSurfaceXY(),e;throw Error("The block associated with the block move event could not be found")}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&E.equals(this.oldCoordinate,this.newCoordinate)}run(e){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var i=t.getBlockById(this.blockId);if(i){var n=e?this.newParentId:this.oldParentId,o=e?this.newInputName:this.oldInputName;if(e=e?this.newCoordinate:this.oldCoordinate,n){var r=t.getBlockById(n);if(!r)return void console.warn("Can't connect to non-existent block: "+n)}if(i.getParent()&&i.unplug(),e)o=i.getRelativeToSurfaceXY(),i.moveBy(e.x-o.x,e.y-o.y,this.reason);else{let e;i=null==(t=!(t=i.outputConnection)||i.previousConnection&&i.previousConnection.isConnected()?i.previousConnection:t)?void 0:t.type,o?(i=r.getInput(o))&&(e=i.connection):i===v.PREVIOUS_STATEMENT&&(e=r.nextConnection),e&&t?t.connect(e):console.warn("Can't connect to non-existent input: "+o)}}else console.warn("Can't move non-existent block: "+this.blockId)}}),yp=(o(b.EVENT,_.BLOCK_MOVE,_p),class extends Wa{constructor(e,t,i){super(e?e.workspace.id:void 0),this.type=_.BUBBLE_OPEN,e&&(this.blockId=e.id,this.isOpen=t,this.bubbleType=i)}toJson(){var e=super.toJson();if(void 0===this.isOpen)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(this.bubbleType)return e.isOpen=this.isOpen,e.bubbleType=this.bubbleType,e.blockId=this.blockId||"",e;throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new yp)).isOpen=e.isOpen,t.bubbleType=e.bubbleType,t.blockId=e.blockId,t}}),vp=((w=Vp=Vp||{}).MUTATOR="mutator",w.COMMENT="comment",w.WARNING="warning",o(b.EVENT,_.BUBBLE_OPEN,yp),class extends ja{constructor(e){super(),this.isBlank=!e,e&&(this.commentId=e.id,this.workspaceId=e.workspace.id,this.group=m.getGroup$$module$build$src$core$events$utils(),this.recordUndo=Ia)}toJson(){var e=super.toJson();if(this.commentId)return e.commentId=this.commentId,e;throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new vp)).commentId=e.commentId,t}static CommentCreateDeleteHelper(e,t){var i=e.getEventWorkspace_();if(t){if(!e.json)throw Error("Encountered a comment event without proper json");Ke(e.json,i)}else{if(!e.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=i.getCommentById(e.commentId))?t.dispose():console.warn("Can't delete non-existent comment: "+e.commentId)}}}),Tp=class extends vp{constructor(e,t,i){super(e),this.type=_.COMMENT_CHANGE,e&&(this.oldContents_=void 0===t?"":t,this.newContents_=void 0===i?"":i)}toJson(){var e=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(this.newContents_)return e.oldContents=this.oldContents_,e.newContents=this.newContents_,e;throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new Tp)).oldContents_=e.oldContents,t.newContents_=e.newContents,t}isNull(){return this.oldContents_===this.newContents_}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){var i=e?this.newContents_:this.oldContents_;if(void 0===i){if(e)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson")}t.setText(i)}else console.warn("Can't change non-existent comment: "+this.commentId)}},Ep=(o(b.EVENT,_.COMMENT_CHANGE,Tp),class extends vp{constructor(e,t){super(e),this.newCollapsed=t,this.type=_.COMMENT_COLLAPSE}toJson(){var e=super.toJson();if(void 0===this.newCollapsed)throw Error("The new collapse value undefined. Either call recordNew, or call fromJson");return e.newCollapsed=this.newCollapsed,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new Ep)).newCollapsed=e.newCollapsed,t}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(t=t.getCommentById(this.commentId))?t.setCollapsed(e?!!this.newCollapsed:!this.newCollapsed):console.warn("Can't collapse or uncollapse non-existent comment: "+this.commentId)}}),kp=(o(b.EVENT,_.COMMENT_COLLAPSE,Ep),class extends vp{constructor(e){super(e),this.type=_.COMMENT_CREATE,e&&(this.xml=Rn(e),this.json=Ye(e,{addCoordinates:!0}))}toJson(){var e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(this.json)return e.xml=$n(this.xml),e.json=this.json,e;throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new kp)).xml=m.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}run(e){vp.CommentCreateDeleteHelper(this,e)}}),Cp=(o(b.EVENT,_.COMMENT_CREATE,kp),class extends vp{constructor(e){super(e),this.type=_.COMMENT_DELETE,e&&(this.xml=Rn(e),this.json=Ye(e,{addCoordinates:!0}))}run(e){vp.CommentCreateDeleteHelper(this,!e)}toJson(){var e=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");if(this.json)return e.xml=$n(this.xml),e.json=this.json,e;throw Error("The comment JSON is undefined. Either pass a block to the constructor, or call fromJson")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new Cp)).xml=m.textToDom$$module$build$src$core$utils$xml(e.xml),t.json=e.json,t}}),Ip=(o(b.EVENT,_.COMMENT_DELETE,Cp),class extends Wa{constructor(e,t){super(e?e.workspace.id:void 0),this.type=_.COMMENT_DRAG,e&&(this.commentId=e.id,this.isStart=t)}toJson(){var e=super.toJson();if(void 0===this.isStart)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(void 0===this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return e.isStart=this.isStart,e.commentId=this.commentId,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new Ip)).isStart=e.isStart,t.commentId=e.commentId,t}}),wp=(o(b.EVENT,_.COMMENT_DRAG,Ip),class extends vp{constructor(e){super(e),this.type=_.COMMENT_MOVE,e&&(this.comment_=e,this.oldCoordinate_=e.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setReason(e){this.reason=e}setOldCoordinate(e){this.oldCoordinate_=e}toJson(){var e=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(this.newCoordinate_)return e.oldCoordinate=Math.round(this.oldCoordinate_.x)+", "+Math.round(this.oldCoordinate_.y),e.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),e;throw Error("The new comment position is undefined. Either call recordNew, or call fromJson")}static fromJson(e,t,i){return t=super.fromJson(e,t,null!=i?i:new wp),i=e.oldCoordinate.split(","),t.oldCoordinate_=new E(Number(i[0]),Number(i[1])),i=e.newCoordinate.split(","),t.newCoordinate_=new E(Number(i[0]),Number(i[1])),t}isNull(){return E.equals(this.oldCoordinate_,this.newCoordinate_)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(!(e=e?this.newCoordinate_:this.oldCoordinate_))throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");t.moveTo(e)}else console.warn("Can't move non-existent comment: "+this.commentId)}}),Sp=(o(b.EVENT,_.COMMENT_MOVE,wp),class extends vp{constructor(e){super(e),this.type=_.COMMENT_RESIZE,e&&(this.oldSize=e.getSize())}recordCurrentSizeAsNewSize(){if(this.newSize)throw Error("Tried to record the new size of a comment on the same event twice.");var e=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(!(e=e.getCommentById(this.commentId)))throw Error("The comment associated with the comment resize event could not be found");this.newSize=e.getSize()}toJson(){var e=super.toJson();if(!this.oldSize)throw Error("The old comment size is undefined. Either pass a comment to the constructor, or call fromJson");if(this.newSize)return e.oldWidth=Math.round(this.oldSize.width),e.oldHeight=Math.round(this.oldSize.height),e.newWidth=Math.round(this.newSize.width),e.newHeight=Math.round(this.newSize.height),e;throw Error("The new comment size is undefined. Either call recordCurrentSizeAsNewSize, or call fromJson")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new Sp)).oldSize=new I(e.oldWidth,e.oldHeight),t.newSize=new I(e.newWidth,e.newHeight),t}isNull(){return I.equals(this.oldSize,this.newSize)}run(e){var t=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(t=t.getCommentById(this.commentId)){if(!(e=e?this.newSize:this.oldSize))throw Error("Either oldSize or newSize is undefined. Either pass a comment to the constructor and call recordCurrentSizeAsNewSize, or call fromJson");t.setSize(e)}else console.warn("Can't resize non-existent comment: "+this.commentId)}}),xp=(o(b.EVENT,_.COMMENT_RESIZE,Sp),class extends Wa{constructor(e,t,i){super(i),this.type=_.TOOLBOX_ITEM_SELECT,this.oldItem=null!=e?e:void 0,this.newItem=null!=t?t:void 0}toJson(){var e=super.toJson();return e.oldItem=this.oldItem,e.newItem=this.newItem,e}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new xp)).oldItem=e.oldItem,t.newItem=e.newItem,t}}),Rp=(o(b.EVENT,_.TOOLBOX_ITEM_SELECT,xp),class extends xh{constructor(e,t,i){super(e),this.oldType=t,this.newType=i,this.type=_.VAR_TYPE_CHANGE}toJson(){var e=super.toJson();if(this.oldType&&this.newType)return e.oldType=this.oldType,e.newType=this.newType,e;throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson")}static fromJson(e,t,i){return(t=super.fromJson(e,t,null!=i?i:new Rp)).oldType=e.oldType,t.newType=e.newType,t}run(e){var t=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldType||!this.newType)throw Error("The variable's types are undefined. Either pass them to the constructor, or call fromJson");var i=t.getVariableMap().getVariableById(this.varId);i&&(e?t.getVariableMap().changeVariableType(i,this.newType):t.getVariableMap().changeVariableType(i,this.oldType))}}),Op=(o(b.EVENT,_.VAR_TYPE_CHANGE,Rp),class extends ja{constructor(e){super(),this.isBlank=!0,this.recordUndo=!1,this.type=_.FINISHED_LOADING,this.isBlank=!!e,e&&(this.workspaceId=e.id)}}),w=(o(b.EVENT,_.FINISHED_LOADING,Op),m.BLOCK_CHANGE$$module$build$src$core$events$events=_.BLOCK_CHANGE,m.BLOCK_CREATE$$module$build$src$core$events$events=_.BLOCK_CREATE,m.BLOCK_DELETE$$module$build$src$core$events$events=_.BLOCK_DELETE,Np=_.BLOCK_DRAG,m.BLOCK_MOVE$$module$build$src$core$events$events=_.BLOCK_MOVE,Lp=_.BLOCK_FIELD_INTERMEDIATE_CHANGE,Dp=_.BUBBLE_OPEN,t=_.BLOCK_CHANGE,Wp=_.CLICK,zp=_.COMMENT_CHANGE,Yp=_.COMMENT_CREATE,lc=_.COMMENT_DELETE,Jp=_.COMMENT_MOVE,Zp=_.COMMENT_RESIZE,Wu=_.COMMENT_DRAG,Qp=_.BLOCK_CREATE,tg=_.BLOCK_DELETE,cc=_.FINISHED_LOADING,ac=_.BLOCK_MOVE,Vs=_.SELECTED,i=_.THEME_CHANGE,_l=_.TOOLBOX_ITEM_SELECT,gl=_.TRASHCAN_OPEN,yl=_.UI,ma=_.VAR_CREATE,qd=_.VAR_DELETE,D=_.VAR_RENAME,Jd=_.VIEWPORT_CHANGE,(M={}).Abstract=ja,M.BLOCK_CHANGE=m.BLOCK_CHANGE$$module$build$src$core$events$events,M.BLOCK_CREATE=m.BLOCK_CREATE$$module$build$src$core$events$events,M.BLOCK_DELETE=m.BLOCK_DELETE$$module$build$src$core$events$events,M.BLOCK_DRAG=Np,M.BLOCK_FIELD_INTERMEDIATE_CHANGE=Lp,M.BLOCK_MOVE=m.BLOCK_MOVE$$module$build$src$core$events$events,M.BUBBLE_OPEN=Dp,M.BUMP_EVENTS=va,M.BlockBase=dc,M.BlockChange=hc,M.BlockCreate=Iu,M.BlockDelete=Au,M.BlockDrag=mp,M.BlockFieldIntermediateChange=bp,M.BlockMove=_p,M.BubbleOpen=yp,M.BubbleType=Vp,M.CHANGE=t,M.CLICK=Wp,M.COMMENT_CHANGE=zp,M.COMMENT_CREATE=Yp,M.COMMENT_DELETE=lc,M.COMMENT_DRAG=Wu,M.COMMENT_MOVE=Jp,M.COMMENT_RESIZE=Zp,M.CREATE=Qp,M.Click=za,M.ClickTarget=eg,M.CommentBase=vp,M.CommentChange=Tp,M.CommentCollapse=Ep,M.CommentCreate=kp,M.CommentDelete=Cp,M.CommentDrag=Ip,M.CommentMove=wp,M.CommentResize=Sp,M.DELETE=tg,M.FINISHED_LOADING=cc,M.FinishedLoading=Op,M.MOVE=ac,M.SELECTED=Vs,M.Selected=Ou,M.THEME_CHANGE=i,M.TOOLBOX_ITEM_SELECT=_l,M.TRASHCAN_OPEN=gl,M.ThemeChange=Su,M.ToolboxItemSelect=xp,M.TrashcanOpen=Nh,M.UI=yl,M.UiBase=Wa,M.VAR_CREATE=ma,M.VAR_DELETE=qd,M.VAR_RENAME=D,M.VIEWPORT_CHANGE=Jd,M.VarBase=xh,M.VarCreate=Rh,M.VarDelete=Oh,M.VarRename=Ah,M.VarTypeChange=Rp,M.ViewportChange=xu,M.clearPendingUndo=F,M.disable=m.disable$$module$build$src$core$events$utils,M.disableOrphans=V,M.enable=m.enable$$module$build$src$core$events$utils,M.filter=B,M.fire=g,M.fromJson=G,M.get=f,M.getDescendantIds=H,M.getGroup=m.getGroup$$module$build$src$core$events$utils,M.getRecordUndo=us,M.isEnabled=U,M.setGroup=m.setGroup$$module$build$src$core$events$utils,M.setRecordUndo=m.setRecordUndo$$module$build$src$core$events$utils,{}),ja=(w.BottomRow=ip,w.ConstantProvider=Zh,w.Drawer=Qh,w.PathObject=ap,w.RenderInfo=sp,w.Renderer=lp,w.RightConnectionShape=op,w.StatementInput=np,w.TopRow=rp,ns(),{}),Ap=(ja.registerCleanup=Mr,ja.registerCollapse=Pr,ja.registerCollapseExpandBlock=Yr,ja.registerComment=Wr,ja.registerCommentCreate=Qr,ja.registerCommentDelete=Jr,ja.registerCommentDuplicate=Zr,ja.registerCommentOptions=is,ja.registerDefaultOptions=ns,ja.registerDelete=Xr,ja.registerDeleteAll=Gr,ja.registerDisable=Kr,ja.registerDuplicate=jr,ja.registerExpand=Br,ja.registerHelp=qr,ja.registerInline=zr,ja.registerRedo=Dr,ja.registerUndo=Lr,"button"),Np=class{load(e,t){return(e=new _d(t.getWorkspace(),t.targetWorkspace,e,!1)).show(),new fd(e,Ap)}gapForItem(e,t){return t}disposeItem(e){(e=e.getElement())instanceof _d&&e.dispose()}getType(){return Ap}},Lp=(o(b.FLYOUT_INFLATER,Ap,Np),{}),Dp=(Lp.Bubble=O,Lp.MiniWorkspaceBubble=Uu,Lp.TextBubble=dd,Lp.TextInputBubble=Wd,class{constructor(){this.permanentlyDisabledBlocks=new Set,this.listeners=new Map,this.capacityWrapper=this.filterFlyoutBasedOnCapacity.bind(this)}load(e,t){return this.setFlyout(t),(e=this.createBlock(e,t.getWorkspace())).isEnabled()?this.updateStateBasedOnCapacity(e):this.permanentlyDisabledBlocks.add(e),e.getDescendants(!1).forEach(e=>e.isInFlyout=!0),this.addBlockListeners(e),new fd(e,"block")}createBlock(e,t){return t=(e.blockxml?(e="string"==typeof e.blockxml?m.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,Bn):(void 0===e.enabled&&(e.enabled="true"!==e.disabled&&!0!==e.disabled),void 0===e.disabledReasons&&!1===e.enabled&&(e.disabledReasons=[xl]),"x"in e&&delete e.x,"y"in e&&delete e.y,zt))(e,t)}gapForItem(e,t){let i;return e.gap?i=parseInt(String(e.gap)):e.blockxml&&(e="string"==typeof e.blockxml?m.textToDom$$module$build$src$core$utils$xml(e.blockxml):e.blockxml,i=parseInt(e.getAttribute("gap"))),!i||isNaN(i)?t:i}disposeItem(e){(e=e.getElement())instanceof N&&(this.removeListeners(e.id),e.dispose(!1,!1))}removeListeners(e){var t;(null!=(t=this.listeners.get(e))?t:[]).forEach(e=>r(e)),this.listeners.delete(e)}setFlyout(e){var t;this.flyout!==e&&(this.flyout&&null!=(t=this.flyout.targetWorkspace)&&t.removeChangeListener(this.capacityWrapper),this.flyout=e,null!=(t=this.flyout.targetWorkspace))&&t.addChangeListener(this.capacityWrapper)}updateStateBasedOnCapacity(e){for(var t,i=null==(t=this.flyout)||null==(t=t.targetWorkspace)?void 0:t.isCapacityAvailable(he(e));e;)e.setDisabledReason(!i,"WORKSPACE_AT_BLOCK_CAPACITY"),e=e.getNextBlock()}addBlockListeners(i){var e=[];e.push(p(i.getSvgRoot(),"pointerdown",i,e=>{var t=null==(t=this.flyout)||null==(t=t.targetWorkspace)?void 0:t.getGesture(e);t&&this.flyout&&(t.setStartBlock(i),t.handleFlyoutStart(e,this.flyout))})),e.push(Es(i.getSvgRoot(),"pointermove",null,()=>{var e;null!=(e=this.flyout)&&null!=(e=e.targetWorkspace)&&e.isDragging()||i.addSelect()})),e.push(Es(i.getSvgRoot(),"pointerleave",null,()=>{var e;null!=(e=this.flyout)&&null!=(e=e.targetWorkspace)&&e.isDragging()||i.removeSelect()})),this.listeners.set(i.id,e)}filterFlyoutBasedOnCapacity(e){!this.flyout||e&&e.type!==_.BLOCK_CREATE&&e.type!==_.BLOCK_DELETE||this.flyout.getWorkspace().getTopBlocks(!1).forEach(e=>{this.permanentlyDisabledBlocks.has(e)||this.updateStateBasedOnCapacity(e)})}getType(){return"block"}}),Mp=(o(b.FLYOUT_INFLATER,"block",Dp),class extends _h{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(e){return super.getCSS_(e).concat([e+" .blocklyInsertionMarker>.blocklyPathLight,",e+" .blocklyInsertionMarker>.blocklyPathDark {",`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}}),$p=class{constructor(e){this.inlineSteps_=this.steps_="",this.info_=e,this.RTL_=this.info_.RTL,e=e.getRenderer(),this.constants_=e.getConstants(),this.highlightConstants_=e.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+"\n"+this.inlineSteps_}drawTopCorner(i){this.steps_+=ho(i.xPos,this.info_.startY);for(let e=0,t;t=i.elements[e];e++)L.isLeftSquareCorner(t)?this.steps_+=this.highlightConstants_.START_POINT:L.isLeftRoundedCorner(t)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):L.isPreviousConnection(t)?this.steps_+=this.notchPaths_.pathLeft:L.isHat(t)?this.steps_+=this.startPaths_.path(this.RTL_):L.isSpacer(t)&&0!==t.width&&(this.steps_+=d("H",t.xPos+t.width-this.highlightOffset));this.steps_+=d("H",i.xPos+i.width-this.highlightOffset)}drawJaggedEdge_(e){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+d("v",e.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(e){var t,i=e.getLastInput();this.RTL_?(t=e.height-i.connectionHeight,this.steps_+=uo(i.xPos+i.width-this.highlightOffset,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+d("v",t)):this.steps_+=uo(i.xPos+i.width,e.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(e){var t,i=e.getLastInput();i&&(this.RTL_?(t=e.height-2*this.insideCornerPaths_.height,this.steps_+=uo(i.xPos,e.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+d("v",t)+this.insideCornerPaths_.pathBottom(this.RTL_)+po(e.width-i.xPos-this.insideCornerPaths_.width,0)):this.steps_+=uo(i.xPos,e.yPos+e.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+po(e.width-i.xPos-this.insideCornerPaths_.width,0))}drawRightSideRow(e){var t=e.xPos+e.width-this.highlightOffset;e instanceof gh&&e.followsStatement&&(this.steps_+=d("H",t)),this.RTL_&&(this.steps_+=d("H",t),e.height>this.highlightOffset)&&(this.steps_+=d("V",e.yPos+e.height-this.highlightOffset))}drawBottomRow(e){var t;this.RTL_?this.steps_+=d("V",e.baseline-this.highlightOffset):(t=this.info_.bottomRow.elements[0],L.isLeftSquareCorner(t)?this.steps_+=uo(e.xPos+this.highlightOffset,e.baseline-this.highlightOffset):L.isLeftRoundedCorner(t)&&(this.steps_+=uo(e.xPos,e.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft()))}drawLeft(){var e=this.info_.outputConnection;e&&(e=e.connectionOffsetY+e.height,this.RTL_?this.steps_+=uo(this.info_.startX,e):(this.steps_+=uo(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=d("V",e)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(e=this.info_.topRow,L.isLeftRoundedCorner(e.elements[0])?this.steps_+=d("V",this.outsideCornerPaths_.height):this.steps_+=d("V",e.capline+this.highlightOffset))}drawInlineInput(e){var t=this.highlightOffset,i=e.xPos+e.connectionWidth,n=e.centerline-e.height/2,o=e.width-e.connectionWidth,r=n+t;this.RTL_?(n=e.connectionOffsetY-t,e=e.height-(e.connectionOffsetY+e.connectionHeight)+t,this.inlineSteps_+=uo(i-t,r)+d("v",n)+this.puzzleTabPaths_.pathDown(this.RTL_)+d("v",e)+d("h",o)):this.inlineSteps_+=uo(e.xPos+e.width+t,r)+d("v",e.height)+d("h",-o)+uo(i,n+e.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},Pp=class extends yh{constructor(e,t){super(e,t),this.highlighter_=new $p(t)}draw(){this.drawOutline_(),this.drawInternals_(),this.updateConnectionHighlights();var e=this.block_.pathObject;e.setPath(this.outlinePath_+"\n"+this.inlinePath_),e.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&e.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(e){this.highlighter_.drawJaggedEdge_(e),super.drawJaggedEdge_(e)}drawValueInput_(e){this.highlighter_.drawValueInput(e),super.drawValueInput_(e)}drawStatementInput_(e){this.highlighter_.drawStatementInput(e),super.drawStatementInput_(e)}drawRightSideRow_(e){this.highlighter_.drawRightSideRow(e),this.outlinePath_+=d("H",e.xPos+e.width)+d("V",e.yPos+e.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(e){this.highlighter_.drawInlineInput(e),super.drawInlineInput_(e)}positionInlineInputConnection_(t){var i=t.centerline-t.height/2;if(t.connectionModel){let e=t.xPos+t.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(e*=-1),t.connectionModel.setOffsetInBlock(e,i+t.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(e){var t,i=e.getLastInput();null!=i&&i.connectionModel&&(t=e.xPos+e.statementEdge+i.notchOffset,t=this.info_.RTL?-1*t:t+this.constants_.DARK_PATH_OFFSET,i.connectionModel.setOffsetInBlock(t,e.yPos+this.constants_.DARK_PATH_OFFSET))}positionExternalValueConnection_(t){var i=t.getLastInput();if(i&&i.connectionModel){let e=t.xPos+t.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(e*=-1),i.connectionModel.setOffsetInBlock(e,t.yPos)}}positionNextConnection_(){var e,t,i=this.info_.bottomRow;i.connection&&(t=(e=i.connection).xPos,e.connectionModel.setOffsetInBlock((this.info_.RTL?-t:t)+this.constants_.DARK_PATH_OFFSET/2,i.baseline+this.constants_.DARK_PATH_OFFSET))}},Bp=class{constructor(e){this.OFFSET=.5,this.constantProvider=e,this.START_POINT=ho(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){let e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,i=(1-Math.SQRT1_2)*(e+t)-t,n=ho(i,i)+fo("a","0 0,0",e,u(-i-t,e-i)),o=fo("a","0 0,0",e+t,u(e+t,e+t)),r=ho(i,-i)+fo("a","0 0,0",e+t,u(e-i,i+t));return{width:e+t,height:e,pathTop(e){return e?n:""},pathBottom(e){return e?o:r}}}makeOutsideCorner(){let e=this.constantProvider.CORNER_RADIUS,t=this.OFFSET,i=(1-Math.SQRT1_2)*(e-t)+t,n=ho(i,i)+fo("a","0 0,1",e-t,u(e-i,-i+t)),o=ho(t,e)+fo("a","0 0,1",e-t,u(e,-e+t)),r=-i,s=ho(i,r)+fo("a","0 0,1",e-t,u(-i+t,-r-e));return{height:e,topLeft(e){return e?n:o},bottomLeft(){return s}}}makePuzzleTab(){let e=this.constantProvider.TAB_WIDTH,t=this.constantProvider.TAB_HEIGHT,i=ho(-2,2.5-t+.9)+po(-.45*e,-2.1),n=" v 2.5 "+ho(.97*-e,2.5)+co("q",[u(.05*-e,10),u(.3*e,9.5)])+ho(.67*e,-1.9)+" v 2.5 ",o=" v -1.5 "+ho(-.92*e,-.5)+co("q",[u(-.19*e,-5.5)," 0,-11 "])+ho(.92*e,1),r=ho(-5,t-.7)+po(.46*e,-2.1);return{width:e,height:t,pathUp(e){return e?i:o},pathDown(e){return e?n:r}}}makeNotch(){return{pathLeft:d("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:" l 5.1,2.6  m -10.2,6.8  l 5.1,2.6 ",height:12,width:10.2}}makeStartHat(){let e=this.constantProvider.START_HAT.height,t=ho(25,-8.7)+co("c",[" 29.7,-6.2 "," 57.2,-0.5 "," 75,8.7 "]),i=co("c",[" 17.8,-9.2 "," 45.3,-14.9 "," 75,-8.7 "])+uo(100.5,e+.5);return{path(e){return e?t:i}}}},Fp=class extends ah{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},Up=class extends mh{constructor(e,t){super(e,t),this.constants_=e,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},Hp=class extends vh{constructor(e,t){super(e,t),this.renderer_=e}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof nd||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(e,t){this.isInline&&e instanceof m.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new Fp(this.constants_,e)),t.hasInlineInput=!0):e instanceof nd?(t.elements.push(new Up(this.constants_,e)),t.hasStatement=!0):e instanceof m.ValueInput$$module$build$src$core$inputs$value_input?(t.elements.push(new ih(this.constants_,e)),t.hasExternalInput=!0):(e instanceof td||e instanceof id)&&(t.minHeight=Math.max(t.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),t.hasDummyInput=!0),this.isInline||null!==t.align||(t.align=e.align)}addElemSpacing_(){let i=!1;for(let e=0,t;t=this.rows[e];e++)t.hasExternalInput&&(i=!0);for(let e=0,t;t=this.rows[e];e++){var n=t.elements;if(t.elements=[],t.startsWithElemSpacer()&&t.elements.push(new sh(this.constants_,this.getInRowSpacing_(null,n[0]))),n.length){for(let e=0;e<n.length-1;e++){t.elements.push(n[e]);var o=this.getInRowSpacing_(n[e],n[e+1]);t.elements.push(new sh(this.constants_,o))}t.elements.push(n[n.length-1]),t.endsWithElemSpacer()&&(n=this.getInRowSpacing_(n[n.length-1],null),i&&t.hasDummyInput&&(n+=this.constants_.TAB_WIDTH),t.elements.push(new sh(this.constants_,n)))}}}getInRowSpacing_(e,t){if(!e)return t&&L.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&L.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&L.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!L.isInput(e)&&(!t||L.isStatementInput(t)))return L.isField(e)&&e.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:L.isIcon(e)?2*this.constants_.LARGE_PADDING+1:L.isHat(e)?this.constants_.NO_PADDING:L.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:L.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:L.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(L.isInput(e)&&!t){if(L.isExternalInput(e))return this.constants_.NO_PADDING;if(L.isInlineInput(e))return this.constants_.LARGE_PADDING;if(L.isStatementInput(e))return this.constants_.NO_PADDING}if(!L.isInput(e)&&t&&L.isInput(t)){if(L.isField(e)&&e.isEditable){if(L.isInlineInput(t)||L.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(L.isInlineInput(t)||L.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(L.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(L.isIcon(e)&&t&&!L.isInput(t))return this.constants_.LARGE_PADDING;if(L.isInlineInput(e)&&t&&L.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(L.isLeftSquareCorner(e)&&t){if(L.isHat(t))return this.constants_.NO_PADDING;if(L.isPreviousConnection(t))return t.notchOffset;if(L.isNextConnection(t))return t.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(L.isLeftRoundedCorner(e)&&t){if(L.isPreviousConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS;if(L.isNextConnection(t))return t.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return L.isField(e)&&t&&L.isField(t)&&e.isEditable===t.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:t&&L.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return L.isTopRow(e)&&L.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:L.isTopRow(e)||L.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||!e.hasStatement&&t.hasDummyInput||e.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){if(L.isSpacer(t))return e.yPos+t.height/2;if(L.isBottomRow(e))return e=e.yPos+e.height-e.descenderHeight,L.isNextConnection(t)?e+t.height/2:e-t.height/2;if(L.isTopRow(e))return L.isHat(t)?e.capline-t.height/2:e.capline+t.height/2;let i=e.yPos;return L.isField(t)||L.isIcon(t)?(i+=t.height/2,(e.hasInlineInput||e.hasStatement)&&t.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=e.height&&(i+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):i=L.isInlineInput(t)?i+t.height/2:i+e.height/2,i}alignRowElements_(){if(this.isInline){var i=0,n=new WeakMap,o=null;for(let e=this.rows.length-1,t;t=this.rows[e];e--)n.set(t,i),L.isInputRow(t)&&(t.hasStatement&&this.alignStatementRow_(t),o&&o.hasStatement&&t.width<o.width?n.set(t,o.width):i=t.hasStatement?t.width:Math.max(i,t.width),o=t);for(let e=i=0,t;t=this.rows[e];e++)t.hasStatement?i=this.getDesiredRowWidth_(t):L.isSpacer(t)?t.width=Math.max(i,n.get(t)):(o=t.width,0<(i=Math.max(i,n.get(t))-o)&&this.addAlignmentPadding_(t,i),i=t.width)}else super.alignRowElements_()}getDesiredRowWidth_(e){return this.isInline&&e.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(e)}finalize_(){let i=0,n=0;for(let e=0,t;t=this.rows[e];e++){t.yPos=n,t.xPos=this.startX,n+=t.height,i=Math.max(i,t.widthWithConnectedBlocks);var o=n-this.topRow.ascenderHeight;t===this.bottomRow&&o<this.constants_.MIN_BLOCK_HEIGHT&&(o=this.constants_.MIN_BLOCK_HEIGHT-o,this.bottomRow.height+=o,n+=o),this.recordElemPositions_(t)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(o=this.block_.nextConnection.targetBlock())&&(i=Math.max(i,o.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=n-this.bottomRow.descenderHeight,this.widthWithChildren=i+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=n+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},Gp=class extends Th{constructor(e,t,i){super(e,t,i),this.constants=i,this.colourDark="#000000",this.svgPathDark=l(k.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=l(k.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(e){this.svgPath.setAttribute("d",e),this.svgPathDark.setAttribute("d",e)}setHighlightPath(e){this.svgPathLight.setAttribute("d",e)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(e){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(e),this.svgPath.setAttribute("stroke","none")}setStyle(e){this.style=e,this.colourDark=Qi("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(e){super.updateHighlighted(e),this.svgPathLight.style.display=e?"none":"inline"}updateShadow_(e){if(e){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(e){super.updateDisabled_(e),e&&this.svgPath.setAttribute("stroke","none")}},Vp=class extends Xc{constructor(e){super(e),this.highlightConstants=null}init(e,t){super.init(e,t),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(e,t,i){super.refreshDom(e,t,i),this.getHighlightConstants().init()}makeConstants_(){return new Mp}makeRenderInfo_(e){return new Hp(this,e)}makeDrawer_(e,t){return new Pp(e,t)}makePathObject(e,t){return new Gp(e,t,this.getConstants())}makeHighlightConstants_(){return new Bp(this.getConstants())}getHighlightConstants(){if(this.highlightConstants)return this.highlightConstants;throw Error("Cannot access the highlight constants because init has not been called")}},t=(nr("geras",Vp),{}),jp=(t.ConstantProvider=Mp,t.Drawer=Pp,t.HighlightConstantProvider=Bp,t.Highlighter=$p,t.InlineInput=Fp,t.PathObject=Gp,t.RenderInfo=Hp,t.Renderer=Vp,t.StatementInput=Up,class extends vh{constructor(e,t){super(e,t)}getRenderer(){return this.renderer_}addElemSpacing_(){let e=!1;for(var t=0;t<this.rows.length;t++)if(this.rows[t].hasExternalInput){e=!0;break}for(t=0;t<this.rows.length;t++){var i=this.rows[t],n=i.elements;if(i.elements=[],i.startsWithElemSpacer()&&i.elements.push(new sh(this.constants_,this.getInRowSpacing_(null,n[0]))),n.length){for(let e=0;e<n.length-1;e++){i.elements.push(n[e]);var o=this.getInRowSpacing_(n[e],n[e+1]);i.elements.push(new sh(this.constants_,o))}i.elements.push(n[n.length-1]),i.endsWithElemSpacer()&&(n=this.getInRowSpacing_(n[n.length-1],null),e&&i.hasDummyInput&&(n+=this.constants_.TAB_WIDTH),i.elements.push(new sh(this.constants_,n)))}}}getInRowSpacing_(e,t){if(!e)return t&&L.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:t&&L.isInlineInput(t)?this.constants_.MEDIUM_LARGE_PADDING:t&&L.isStatementInput(t)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!L.isInput(e)&&!t)return L.isField(e)&&e.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:L.isIcon(e)?2*this.constants_.LARGE_PADDING+1:L.isHat(e)?this.constants_.NO_PADDING:L.isPreviousOrNextConnection(e)?this.constants_.LARGE_PADDING:L.isLeftRoundedCorner(e)?this.constants_.MIN_BLOCK_WIDTH:L.isJaggedEdge(e)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(L.isInput(e)&&!t){if(L.isExternalInput(e))return this.constants_.NO_PADDING;if(L.isInlineInput(e))return this.constants_.LARGE_PADDING;if(L.isStatementInput(e))return this.constants_.NO_PADDING}if(!L.isInput(e)&&t&&L.isInput(t)){if(L.isField(e)&&e.isEditable){if(L.isInlineInput(t)||L.isExternalInput(t))return this.constants_.SMALL_PADDING}else{if(L.isInlineInput(t)||L.isExternalInput(t))return this.constants_.MEDIUM_LARGE_PADDING;if(L.isStatementInput(t))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(L.isIcon(e)&&t&&!L.isInput(t))return this.constants_.LARGE_PADDING;if(L.isInlineInput(e)&&t&&L.isField(t))return t.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(L.isLeftSquareCorner(e)&&t){if(L.isHat(t))return this.constants_.NO_PADDING;if(L.isPreviousConnection(t)||L.isNextConnection(t))return t.notchOffset}return L.isLeftRoundedCorner(e)&&t?t.notchOffset-this.constants_.CORNER_RADIUS:L.isField(e)&&t&&L.isField(t)&&e.isEditable===t.isEditable?0===e.width?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING:t&&L.isJaggedEdge(t)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(e,t){return L.isTopRow(e)&&L.isBottomRow(t)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:L.isTopRow(e)||L.isBottomRow(t)?this.constants_.NO_PADDING:e.hasExternalInput&&t.hasExternalInput?this.constants_.LARGE_PADDING:!e.hasStatement&&t.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:e.hasStatement&&t.hasStatement||e.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(e,t){var i;return L.isSpacer(t)?e.yPos+t.height/2:L.isBottomRow(e)?(e=e.yPos+e.height-e.descenderHeight,L.isNextConnection(t)?e+t.height/2:e-t.height/2):L.isTopRow(e)?L.isHat(t)?e.capline-t.height/2:e.capline+t.height/2:(i=e.yPos,L.isField(t)&&e.hasStatement?i+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+t.height/2):i+e.height/2)}finalize_(){let e=0,t=0;for(var i=0;i<this.rows.length;i++){var n=this.rows[i],o=(n.yPos=t,n.xPos=this.startX,t+=n.height,e=Math.max(e,n.widthWithConnectedBlocks),t-this.topRow.ascenderHeight);n===this.bottomRow&&o<this.constants_.MIN_BLOCK_HEIGHT&&(o=this.constants_.MIN_BLOCK_HEIGHT-o,this.bottomRow.height+=o,t+=o),this.recordElemPositions_(n)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(i=this.block_.nextConnection.targetBlock())&&(e=Math.max(e,i.getHeightWidth().width)),this.bottomRow.baseline=t-this.bottomRow.descenderHeight,this.widthWithChildren=e+this.startX,this.height=t,this.startY=this.topRow.capline}}),Wp=class extends Xc{constructor(e){super(e)}makeRenderInfo_(e){return new jp(this,e)}},zp=(nr("thrasos",Wp),{}),Yp=(zp.RenderInfo=jp,zp.Renderer=Wp,new Mu("zelos",{colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},{colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}})),lc={Classic:$u,Zelos:Yp},Wu=class{constructor(e,t,i){this.id_=e.toolboxitemid||Ss(),this.level_=(this.parent_=i||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=e,this.parentToolbox_=t,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(e){}getFocusableElement(){var e=this.getDiv();if(!e)throw Error("Trying to access toolbox item before DOM is initialized.");if(e instanceof HTMLElement)return e;throw Error("Toolbox item div is unexpectedly not an HTML element.")}getFocusableTree(){return this.parentToolbox_}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}},Kp=class extends Wu{constructor(e,t,i){super(e,t,i),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),"true"===this.toolboxItemDef_.hidden&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategoryContainer",row:"blocklyToolboxCategory",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyToolboxCategoryIcon",label:"blocklyToolboxCategoryLabel",contents:"blocklyToolboxCategoryGroup",selected:"blocklyToolboxSelected",openicon:"blocklyToolboxCategoryIconOpen",closedicon:"blocklyToolboxCategoryIconClosed"}}parseContents_(t){if("custom"in t)this.flyoutItems_=t.custom;else if(t=t.contents)for(let e=0;e<t.length;e++){var i=t[e];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(i)}}parseCategoryDef_(e){this.name_="name"in e?on(e.name):"",this.colour_=this.getColour_(e),Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),Je(this.htmlDiv_,ia.TREEITEM),Ze(this.htmlDiv_,na.SELECTED,!1),Ze(this.htmlDiv_,na.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),Je(this.iconDom_,ia.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);var e=this.labelDom_.getAttribute("id");return e&&Ze(this.htmlDiv_,na.LABELLEDBY,e),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){var e=document.createElement("div"),t=(e.tabIndex=-1,e.id=this.getId(),this.cssConfig_.container);return t&&c(e,t),e}createRowContainer_(){var e=document.createElement("div"),t=this.cssConfig_.row;return t&&c(e,t),t=Kp.nestedPadding*this.getLevel()+"px",this.workspace_.RTL?e.style.paddingRight=t:e.style.paddingLeft=t,e}createRowContentsContainer_(){var e=document.createElement("div"),t=this.cssConfig_.rowcontentcontainer;return t&&c(e,t),e}createIconDom_(){var e,t=document.createElement("span");return this.parentToolbox_.isHorizontal()||(e=this.cssConfig_.icon)&&c(t,e),t.style.display="inline-block",t}createLabelDom_(e){var t=document.createElement("span");return t.setAttribute("id",this.getId()+".label"),t.textContent=e,(e=this.cssConfig_.label)&&c(t,e),t}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(e){e&&(e=Kp.borderWidth+"px solid "+(e||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=e:this.rowDiv_.style.borderLeft=e)}getColour_(e){var t=e.categorystyle||e.categoryStyle;if((e=e.colour)&&t)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(t)return this.getColourfromStyle(t);if(e)return this.parseColour(e)}return""}getColourfromStyle(e){var t=this.workspace_.getTheme();if(e&&t){if((t=t.categoryStyles[e])&&t.colour)return this.parseColour(t.colour);console.warn('Style "'+e+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour(e){var t;return null==(e=on(e))||""===e?"":(t=Number(e),isNaN(t)?(t=Xi(e))||(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+e),""):en(t))}openIcon_(e){var t;e&&((t=this.cssConfig_.closedicon)&&j(e,t),t=this.cssConfig_.openicon)&&c(e,t)}closeIcon_(e){var t;e&&((t=this.cssConfig_.openicon)&&j(e,t),t=this.cssConfig_.closedicon)&&c(e,t)}setVisible_(e){this.htmlDiv_.style.display=e?"block":"none",this.isHidden_=!e,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let e=this;for(;e.getParent();)if(!(e=e.getParent()).isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(e){}setSelected(e){var t,i;this.rowDiv_&&(t=this.cssConfig_.selected,e?(i=this.parseColour(Kp.defaultBackgroundColour),this.rowDiv_.style.backgroundColor=this.colour_||i,t&&c(this.rowDiv_,t)):(this.rowDiv_.style.backgroundColor="",t&&s(this.rowDiv_,t)),Ze(this.htmlDiv_,na.SELECTED,e))}setDisabled(e){this.isDisabled_=e,this.getDiv().setAttribute("disabled",""+e),e?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(e){this.flyoutItems_=[],this.toolboxItemDef_="string"==typeof e?{kind:this.toolboxItemDef_.kind,custom:e,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:Pe(e),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){a(this.htmlDiv_)}},Xp=(Kp.registrationName="category",Kp.nestedPadding=19,Kp.borderWidth=8,Kp.defaultBackgroundColour="#57e",be('\n.blocklyToolboxCategory:not(.blocklyToolboxSelected):hover {\n  background-color: rgba(255, 255, 255, .2);\n}\n\n.blocklyToolbox[layout="h"] .blocklyToolboxCategoryContainer {\n  margin: 1px 5px 1px 0;\n}\n\n.blocklyToolbox[dir="RTL"][layout="h"] .blocklyToolboxCategoryContainer {\n  margin: 1px 0 1px 5px;\n}\n\n.blocklyToolboxCategory {\n  height: 22px;\n  line-height: 22px;\n  margin-bottom: 3px;\n  padding-right: 8px;\n  white-space: nowrap;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxCategory {\n  margin-left: 8px;\n  padding-right: 0;\n}\n\n.blocklyToolboxCategoryIcon {\n  background-image: url(<<<PATH>>>/sprites.png);\n  height: 16px;\n  vertical-align: middle;\n  visibility: hidden;\n  width: 16px;\n}\n\n.blocklyToolboxCategoryIconClosed {\n  background-position: -32px -1px;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxCategoryIconClosed {\n  background-position: 0 -1px;\n}\n\n.blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {\n  background-position: -32px -17px;\n}\n\n.blocklyToolbox[dir="RTL"] .blocklyToolboxSelected>.blocklyToolboxCategoryIconClosed {\n  background-position: 0 -17px;\n}\n\n.blocklyToolboxCategoryIconOpen {\n  background-position: -16px -1px;\n}\n\n.blocklyToolboxSelected>.blocklyToolboxCategoryIconOpen {\n  background-position: -16px -17px;\n}\n\n.blocklyToolboxCategoryLabel {\n  cursor: default;\n  font: 16px sans-serif;\n  padding: 0 3px;\n  vertical-align: middle;\n}\n\n.blocklyToolboxDelete .blocklyToolboxCategoryLabel {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxSelected .blocklyToolboxCategoryLabel {\n  color: #fff;\n}\n'),o(b.TOOLBOX_ITEM,Kp.registrationName,Kp),class extends Wu{constructor(e,t){super(e,t),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv=null,Object.assign(this.cssConfig_,e.cssconfig||e.cssConfig)}init(){this.createDom_()}createDom_(){var e=document.createElement("div"),t=(e.tabIndex=-1,e.id=this.getId(),this.cssConfig_.container);return t&&c(e,t),this.htmlDiv=e}getDiv(){return this.htmlDiv}dispose(){a(this.htmlDiv)}}),qp=(Xp.registrationName="sep",be('\n.blocklyTreeSeparator {\n  border-bottom: solid #e5e5e5 1px;\n  height: 0;\n  margin: 5px 0;\n}\n\n.blocklyToolbox[layout="h"] .blocklyTreeSeparator {\n  border-right: solid #e5e5e5 1px;\n  border-bottom: none;\n  height: auto;\n  margin: 0 5px 0 5px;\n  padding: 5px 0;\n  width: 0;\n}\n'),o(b.TOOLBOX_ITEM,Xp.registrationName,Xp),class extends Kp{constructor(e,t,i){super(e,t,i),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){var e=super.makeDefaultCssConfig_();return e.contents="blocklyToolboxCategoryGroup",e}parseContents_(t){if("custom"in t)this.flyoutItems_=t.custom;else{var i=t.contents;if(i){this.flyoutItems_=[],t=!0;for(let e=0;e<i.length;e++){var n=i[e];t=!ds(b.TOOLBOX_ITEM,n.kind)||n.kind.toLowerCase()===Xp.registrationName&&t?(this.flyoutItems_.push(n),!0):(this.createToolboxItem(n),!1)}}}}createToolboxItem(e){let t=e.kind;"CATEGORY"===t.toUpperCase()&&Fe(e)&&(t=qp.registrationName),e=new(hs(b.TOOLBOX_ITEM,t))(e,this.parentToolbox_,this),this.toolboxItems_.push(e)}init(){super.init(),this.setExpanded("true"===this.toolboxItemDef_.expanded||!0===this.toolboxItemDef_.expanded)}createDom_(){super.createDom_();var e=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(e),Je(this.subcategoriesDiv_,ia.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),Ze(this.htmlDiv_,na.EXPANDED,!1),this.htmlDiv_}createIconDom_(){var e,t=document.createElement("span");return this.parentToolbox_.isHorizontal()||((e=this.cssConfig_.icon)&&c(t,e),t.style.visibility="visible"),t.style.display="inline-block",t}createSubCategoriesDom_(e){var t=document.createElement("div"),i=(t.style.display="none",this.cssConfig_.contents);for(i&&c(t,i),i=0;i<e.length;i++){var n=e[i],o=(n.init(),n.getDiv());t.appendChild(o),n.getClickTarget&&null!=(o=n.getClickTarget())&&o.setAttribute("id",n.getId())}return t}setExpanded(e){var t;this.expanded_!==e&&((this.expanded_=e)?(this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_)):(null!=(t=this.parentToolbox_.getFlyout())&&t.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)),Ze(this.htmlDiv_,na.EXPANDED,e),this.parentToolbox_.handleToolboxItemResize())}setVisible_(t){this.htmlDiv_.style.display=t?"block":"none";var i=this.getChildToolboxItems();for(let e=0;e<i.length;e++)i[e].setVisible_(t);this.isHidden_=!t,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(e){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}}),Jp=(qp.registrationName="collapsibleCategory",o(b.TOOLBOX_ITEM,qp.registrationName,qp),class extends gd{constructor(e){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.height_=this.width_=0,this.flyout=null,this.contents=new Map,this.previouslySelectedItem_=this.selectedItem_=null,this.boundEvents_=[],this.workspace_=e,this.toolboxDef_=e.options.languageTree||{contents:[]},this.horizontalLayout=e.options.horizontalLayout,this.RTL=e.options.RTL,this.toolboxPosition=e.options.toolboxPosition}onShortcut(e){return!1}init(){var e=this.workspace_,t=e.getParentSvg(),i=(this.flyout=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),this.flyout.createDom("svg"));c(i,"blocklyToolboxFlyout"),z(i,t),this.setVisible(!0),this.flyout.init(e),this.render(this.toolboxDef_),(e=e.getThemeManager()).subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),e.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:Xa.ComponentWeight.TOOLBOX_WEIGHT,capabilities:[Xa.Capability.AUTOHIDEABLE,Xa.Capability.DELETE_AREA,Xa.Capability.DRAG_TARGET]}),m.getFocusManager$$module$build$src$core$focus_manager().registerTree(this,!0)}createDom_(e){e=e.getParentSvg();var t=this.createContainer_();return t.id=Ss(),this.contentsDiv_=this.createContentsContainer_(),Je(this.contentsDiv_,ia.TREE),t.appendChild(this.contentsDiv_),e.parentNode.insertBefore(t,e),this.attachEvents_(t,this.contentsDiv_),t}createContainer_(){var e=document.createElement("div");return e.setAttribute("layout",this.isHorizontal()?"h":"v"),c(e,"blocklyToolbox"),e.setAttribute("dir",this.RTL?"RTL":"LTR"),e}createContentsContainer_(){var e=document.createElement("div");return c(e,"blocklyToolboxCategoryGroup"),this.isHorizontal()&&(e.style.flexDirection="row"),e}attachEvents_(e,t){e=p(e,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(e),t=p(t,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(t)}onClick_(e){var t;Cs(e)||e.target===this.HtmlDiv?Js.hideChaff(!1):((t=e.target.getAttribute("id"))&&(t=this.getToolboxItemById(t)).isSelectable()&&(this.setSelectedItem(t),t.onClick(e)),Js.hideChaff(!0)),_s()}onKeyDown_(e){let t=!1;switch(e.key){case"ArrowDown":t=this.selectNext();break;case"ArrowUp":t=this.selectPrevious();break;case"ArrowLeft":t=this.selectParent();break;case"ArrowRight":t=this.selectChild();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),t=!0);break;default:t=!1}(t=!t&&this.selectedItem_&&this.selectedItem_.onKeyDown?this.selectedItem_.onKeyDown(e):t)&&e.preventDefault()}createFlyout_(){var e=this.workspace_,t=e.copyOptionsForFlyout();return t.toolboxPosition=e.options.toolboxPosition,new(e.horizontalLayout?fs(b.FLYOUTS_HORIZONTAL_TOOLBOX,e.options,!0):fs(b.FLYOUTS_VERTICAL_TOOLBOX,e.options,!0))(t)}render(e){this.toolboxDef_=e,this.contents.forEach(e=>e.dispose()),this.contents.clear(),this.renderContents_(e.contents),this.position(),this.handleToolboxItemResize()}renderContents_(t){var i=document.createDocumentFragment();for(let e=0;e<t.length;e++)this.createToolboxItem(t[e],i);this.contentsDiv_.appendChild(i)}createToolboxItem(e,t){var i=e.kind;"CATEGORY"===i.toUpperCase()&&Fe(e)&&(i=qp.registrationName),(i=hs(b.TOOLBOX_ITEM,i.toLowerCase()))&&((e=new i(e,this)).init(),this.addToolboxItem_(e),(i=e.getDiv())&&t.appendChild(i),e.getClickTarget())&&e.getClickTarget().setAttribute("id",e.getId())}addToolboxItem_(t){if(this.contents.set(t.getId(),t),t.isCollapsible()){t=t.getChildToolboxItems();for(let e=0;e<t.length;e++)this.addToolboxItem_(t[e])}}getToolboxItems(){return[...this.contents.values()]}addStyle(e){e&&this.HtmlDiv&&c(this.HtmlDiv,e)}removeStyle(e){e&&this.HtmlDiv&&s(this.HtmlDiv,e)}getClientRect(){var e,t,i,n;return this.HtmlDiv&&this.isVisible_?(t=(e=(n=this.HtmlDiv.getBoundingClientRect()).top)+n.height,n=(i=n.left)+n.width,this.toolboxPosition===y.TOP?new C(-1e7,t,-1e7,1e7):this.toolboxPosition===y.BOTTOM?new C(e,1e7,-1e7,1e7):this.toolboxPosition===y.LEFT?new C(-1e7,1e7,-1e7,n):new C(-1e7,1e7,i,1e7)):null}wouldDelete(e){return e instanceof N?this.updateWouldDelete_(!e.getParent()&&e.isDeletable()):this.updateWouldDelete_(Do(e)&&e.isDeletable()),this.wouldDelete_}onDragEnter(e){this.updateCursorDeleteStyle_(!0)}onDragExit(e){this.updateCursorDeleteStyle_(!1)}onDrop(e){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(e){e!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=e,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(e){var t=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";e?this.addStyle(t):this.removeStyle(t)}getToolboxItemById(e){return this.contents.get(e)||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout}position(){var e=this.workspace_.getMetrics(),t=this.HtmlDiv;t&&(this.horizontalLayout?(t.style.left="0",t.style.height="auto",t.style.width="100%",this.height_=t.offsetHeight,this.width_=e.viewWidth,this.toolboxPosition===y.TOP?t.style.top="0":t.style.bottom="0"):(this.toolboxPosition===y.RIGHT?t.style.right="0":t.style.left="0",t.style.height="100%",this.width_=t.offsetWidth,this.height_=e.viewHeight),this.flyout.position())}handleToolboxItemResize(){var e=this.workspace_,t=this.HtmlDiv.getBoundingClientRect(),i=this.getFlyout(),n=this.toolboxPosition===y.LEFT?e.scrollX+t.width+(null!=i&&i.isVisible()?i.getWidth():0):e.scrollX,t=this.toolboxPosition===y.TOP?e.scrollY+t.height+(null!=i&&i.isVisible()?i.getHeight():0):e.scrollY;e.translate(n,t),de(e)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){this.contents.forEach(e=>{e.refreshTheme&&e.refreshTheme()})}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout.show(this.selectedItem_.getContents())}setVisible(e){this.isVisible_!==e&&(this.HtmlDiv.style.display=e?"block":"none",this.isVisible_=e,this.workspace_.recordDragTargets())}autoHide(e){!e&&this.flyout&&this.flyout.autoClose&&this.clearSelection()}setSelectedItem(e){var t=this.selectedItem_;!e&&!t||e&&!ss(e)||(this.shouldDeselectItem_(t,e)&&null!==t&&this.deselectItem_(t),this.shouldSelectItem_(t,e)&&null!==e&&this.selectItem_(t,e),this.updateFlyout_(t,e),this.fireSelectEvent(t,e))}shouldDeselectItem_(e,t){return null!==e&&(!e.isCollapsible()||e!==t)}shouldSelectItem_(e,t){return null!==t&&t!==e}deselectItem_(e){this.selectedItem_=null,(this.previouslySelectedItem_=e).setSelected(!1),Ze(this.contentsDiv_,na.ACTIVEDESCENDANT,"")}selectItem_(e,t){this.selectedItem_=t,this.previouslySelectedItem_=e,t.setSelected(!0),Ze(this.contentsDiv_,na.ACTIVEDESCENDANT,t.getId())}selectItemByPosition(e){(e=this.getToolboxItems()[e])&&this.setSelectedItem(e)}updateFlyout_(e,t){t&&(e!==t||t.isCollapsible())&&t.getContents().length?(this.flyout.show(t.getContents()),this.flyout.scrollToStart()):this.flyout.hide()}fireSelectEvent(e,t){var i=e&&e.getName();let n=t&&t.getName();e===t&&(n=null),e=new(f(_.TOOLBOX_ITEM_SELECT))(i,n,this.workspace_.id),g(e)}selectParent(){return!(!this.selectedItem_||(this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),0):!this.selectedItem_.getParent()||!this.selectedItem_.getParent().isSelectable()||(this.setSelectedItem(this.selectedItem_.getParent()),0)))}selectChild(){var e;return!(!this.selectedItem_||!this.selectedItem_.isCollapsible()||((e=this.selectedItem_).isExpanded()?this.selectNext():e.toggleExpanded(),0))}selectNext(){if(this.selectedItem_){var i=[...this.contents.values()];let t=i.indexOf(this.selectedItem_)+1;if(-1<t&&t<i.length){let e=i[t];for(;e&&!e.isSelectable();)e=i[++t];if(e&&e.isSelectable())return this.setSelectedItem(e),!0}}return!1}selectPrevious(){if(this.selectedItem_){var i=[...this.contents.values()];let t=i.indexOf(this.selectedItem_)-1;if(-1<t&&t<i.length){let e=i[t];for(;e&&!e.isSelectable();)e=i[--t];if(e&&e.isSelectable())return this.setSelectedItem(e),!0}}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout.dispose(),this.contents.forEach(e=>e.dispose());for(let e=0;e<this.boundEvents_.length;e++)r(this.boundEvents_[e]);this.boundEvents_=[],this.contents.clear(),this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),a(this.HtmlDiv)),m.getFocusManager$$module$build$src$core$focus_manager().unregisterTree(this)}getFocusableElement(){if(this.HtmlDiv)return this.HtmlDiv;throw Error("Toolbox DOM has not yet been created.")}getFocusableTree(){return this}onNodeFocus(){}onNodeBlur(){}canBeFocused(){return!0}getRootFocusableNode(){return this}getRestoredFocusableNode(e){return(!e||e===this)&&null!=(e=this.getToolboxItems().find(e=>e.isSelectable()))?e:null}getNestedTrees(){return[]}lookUpFocusableNode(e){return this.getToolboxItemById(e)}onTreeFocus(e,t){e!==this?this.getSelectedItem()!==e&&this.setSelectedItem(e):this.clearSelection()}onTreeBlur(e){e&&e===(null==(e=this.flyout)?void 0:e.getWorkspace())||(this.clearSelection(),this.flyout&&Fo(this.flyout)&&this.flyout.autoHide(!1))}}),Zp=(be('\n.blocklyToolboxDelete {\n  cursor: url("<<<PATH>>>/handdelete.cur"), auto;\n}\n\n.blocklyToolboxGrab {\n  cursor: url("<<<PATH>>>/handclosed.cur"), auto;\n  cursor: grabbing;\n  cursor: -webkit-grabbing;\n}\n\n/* Category tree in Toolbox. */\n.blocklyToolbox {\n  box-sizing: border-box;\n  user-select: none;\n  -ms-user-select: none;\n  -webkit-user-select: none;\n  background-color: #ddd;\n  overflow-x: visible;\n  overflow-y: auto;\n  padding: 4px 0 4px 0;\n  position: absolute;\n  z-index: 70;  /* so blocks go under toolbox when dragging */\n  -webkit-tap-highlight-color: transparent;  /* issue #1345 */\n}\n\n.blocklyToolboxCategoryGroup {\n  display: flex;\n  flex-wrap: wrap;\n  flex-direction: column;\n}\n\n.blocklyToolboxCategoryGroup:focus {\n  outline: none;\n}\n'),o(b.TOOLBOX,Us,Jp),v.INPUT_VALUE),Qp=v.OUTPUT_VALUE,eg=v.NEXT_STATEMENT,tg=v.PREVIOUS_STATEMENT,cc=y.TOP,Op=y.BOTTOM,ac=y.LEFT,Vs=y.RIGHT,i=(Ih.prototype.newBlock=function(e,t){return new od(this,e,t)},Sh.prototype.newBlock=function(e,t){return new N(this,e,t)},Ih.prototype.newComment=function(e){return new Eu(this,e)},Sh.prototype.newComment=function(e){return new ku(this,e)},Sh.newTrashcan=function(e){return new Lh(e)},Uu.prototype.newWorkspaceSvg=function(e){return new Sh(e)},m.Names$$module$build$src$core$names.prototype.populateProcedures=function(t){t=(t=Go(t))[0].concat(t[1]);for(let e=0;e<t.length;e++)this.getName(t[e][0],m.Names$$module$build$src$core$names.NameType.PROCEDURE)},{});i.Block=od,i.BlockFlyoutInflater=Dp,i.BlockNavigationPolicy=kd,i.BlockSvg=N,i.Blocks=Hs,i.ButtonFlyoutInflater=Np,i.COLLAPSED_FIELD_NAME=Sl,i.COLLAPSED_INPUT_NAME=wl,i.COLLAPSE_CHARS=30,i.CodeGenerator=m.CodeGenerator$$module$build$src$core$generator,i.CollapsibleToolboxCategory=qp,i.ComponentManager=Xa,i.Connection=A,i.ConnectionChecker=$a,i.ConnectionDB=Ru,i.ConnectionNavigationPolicy=Id,i.ConnectionType=v,i.ContextMenu=cu,i.ContextMenuItems=ja,i.ContextMenuRegistry=R,i.Css=Za,i.DELETE_VARIABLE_ID=Zu,i.DeleteArea=gd,i.DragTarget=pd,i.DropDownDiv=tc,i.Events=M,i.Extensions=ju,i.Field=x,i.FieldCheckbox=fp,i.FieldDropdown=Du,i.FieldImage=ep,i.FieldLabel=Xu,i.FieldLabelSerializable=Vu,i.FieldNavigationPolicy=wd,i.FieldNumber=Ku,i.FieldTextInput=m.FieldTextInput$$module$build$src$core$field_textinput,i.FieldVariable=gp,i.Flyout=Md,i.FlyoutButton=_d,i.FlyoutButtonNavigationPolicy=yd,i.FlyoutItem=fd,i.FlyoutMetricsManager=bd,i.FlyoutNavigationPolicy=vd,i.FlyoutNavigator=Ad,i.FlyoutSeparator=Td,i.FlyoutSeparatorNavigationPolicy=Ed,i.FocusManager=Fa,i.FocusableTreeTraverser=Pa,i.Generator=m.CodeGenerator$$module$build$src$core$generator,i.Gesture=Fd,i.Grid=Ud,i.HorizontalFlyout=pp,i.INPUT_VALUE=Zp,i.Input=ed,i.InsertionMarkerPreviewer=cp,i.KeyboardNavigationController=$d,i.LabelFlyoutInflater=Jh,i.LineCursor=Vd,i.Marker=Gd,i.MarkerManager=jd,i.Menu=Cl,i.MenuItem=kl,i.MetricsManager=md,i.Msg=m.Msg$$module$build$src$core$msg,i.NEXT_STATEMENT=eg,i.Names=m.Names$$module$build$src$core$names,i.Navigator=Od,i.OPPOSITE_TYPE=qu,i.OUTPUT_VALUE=Qp,i.Options=Pu,i.PREVIOUS_STATEMENT=tg,i.PROCEDURE_CATEGORY_NAME=Qd,i.Procedures=Kd,i.RENAME_VARIABLE_ID=Ju,i.RenderedConnection=Qu,i.Scrollbar=nl,i.ScrollbarPair=Nd,i.SeparatorFlyoutInflater=Dd,i.ShortcutItems=el,i.ShortcutRegistry=T,i.TOOLBOX_AT_BOTTOM=Op,i.TOOLBOX_AT_LEFT=ac,i.TOOLBOX_AT_RIGHT=Vs,i.TOOLBOX_AT_TOP=cc,i.Theme=Mu,i.ThemeManager=Eh,i.Themes=lc,i.Toast=Ul,i.Toolbox=Jp,i.ToolboxCategory=Kp,i.ToolboxItem=Wu,i.ToolboxSeparator=Xp,i.Tooltip=Wc,i.Touch=Ys,i.Trashcan=Lh,i.UnattachedFieldError=Jc,i.VARIABLE_CATEGORY_NAME=Jl,i.VARIABLE_DYNAMIC_CATEGORY_NAME=kh,i.VERSION="12.2.0",i.VariableMap=pc,i.VariableModel=Ks,i.Variables=ec,i.VariablesDynamic=Ch,i.VerticalFlyout=hp,i.WidgetDiv=ru,i.Workspace=Ih,i.WorkspaceAudio=wh,i.WorkspaceDragger=Bd,i.WorkspaceNavigationPolicy=Rd,i.WorkspaceSvg=Sh,i.Xml=Cu,i.ZoomControls=bl,i.blockAnimations=ad,i.blockRendering=S,i.browserEvents=ya,i.bubbles=Lp,i.bumpObjects=cd,i.clipboard=Ua,i.comments=qc,i.common=e,i.config=m.config$$module$build$src$core$config,i.constants=Rl,i.defineBlocksWithJsonArray=ge,i.dialog=Xl,i.dragging=Ya,i.fieldRegistry=Lu,i.geras=t,i.getFocusManager=m.getFocusManager$$module$build$src$core$focus_manager,i.getMainWorkspace=se,i.getSelected=le,i.hasBubble=ri,i.hideChaff=as,i.icons=Yd,i.inject=Sr,i.inputs=up,i.isCopyable=fr,i.isDeletable=Do,i.isDraggable=Bo,i.isIcon=yo,i.isObservable=Ho,i.isPaster=os,i.isRenderedElement=rs,i.isSelectable=ee,i.isSerializable=Qe,i.isVariableBackedParameterModel=gt,i.keyboardNavigationController=Pd,i.layers=du,i.navigateBlock=Po,i.navigateStacks=$o,i.procedures=Kd,i.registry=Bs,i.renderManagement=$l,i.serialization=Ka,i.setLocale=oa,i.setParentContainer=ue,i.svgResize=de,i.thrasos=zp,i.uiPosition=fl,i.utils=zu,i.zelos=w;return i.__namespace__=m,i},"function"==typeof define&&define.amd?define([],t):"object"==typeof n?i.exports=t():e.Blockly=t()}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],216:[function(e,t,i){t.exports=e("./blocks_compressed.js")},{"./blocks_compressed.js":217}],217:[function(e,t,i){var n,o;n=this,o=function(e){var s=e.__namespace__,e=s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),o=function(i){return function(){var e=i.workspace,t=i.getField("VAR").getVariable();s.renameVariable$$module$build$src$core$variables(e,t)}},r=function(t){return function(){var e=t.getField("VAR").getVariable();e&&s.deleteVariable$$module$build$src$core$variables(e.getWorkspace(),e,t)}},t=(s.registerMixin$$module$build$src$core$extensions("contextMenu_variableDynamicSetterGetter",{customContextMenu:function(e){var t,i,n;this.isInFlyout?"variables_get_dynamic"!==this.type&&"variables_get_reporter_dynamic"!==this.type||(t={text:s.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:o(this)},i=this.getField("VAR").getText(),i={text:s.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",i),enabled:!0,callback:r(this)},e.unshift(t),e.unshift(i)):(t="variables_get_dynamic"===this.type?(n="variables_set_dynamic",s.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET):(n="variables_get_dynamic",s.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET),n={type:n,fields:{VAR:(i=this.getField("VAR")).saveState(!0)}},e.push({enabled:0<this.workspace.remainingCapacity(),text:t.replace("%1",i.getText()),callback:s.callbackFactory$$module$build$src$core$contextmenu(this,n)}))},onchange:function(e){e=this.getFieldValue("VAR"),e=s.getVariable$$module$build$src$core$variables(this.workspace,e),("variables_get_dynamic"===this.type?this.outputConnection:this.getInput("VALUE").connection).setCheck(e.getType())}}),s.defineBlocks$$module$build$src$core$common(e),{blocks:e}),i=s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),a=function(i){return function(){var e=i.workspace,t=i.getField("VAR").getVariable();s.renameVariable$$module$build$src$core$variables(e,t)}},l=function(t){return function(){var e=t.getField("VAR").getVariable();e&&s.deleteVariable$$module$build$src$core$variables(e.getWorkspace(),e,t)}},n=(s.registerMixin$$module$build$src$core$extensions("contextMenu_variableSetterGetter",{customContextMenu:function(e){var t,i,n;this.isInFlyout?"variables_get"!==this.type&&"variables_get_reporter"!==this.type||(t={text:s.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:a(this)},i=this.getField("VAR").getText(),i={text:s.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",i),enabled:!0,callback:l(this)},e.unshift(t),e.unshift(i)):(t="variables_get"===this.type?(n="variables_set",s.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET):(n="variables_get",s.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET),n={type:n,fields:{VAR:(i=this.getField("VAR")).saveState(!0)}},e.push({enabled:0<this.workspace.remainingCapacity(),text:t.replace("%1",i.getText()),callback:s.callbackFactory$$module$build$src$core$contextmenu(this,n)}))}}),s.defineBlocks$$module$build$src$core$common(i),{blocks:i}),c=s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),u=(c.text_getSubstring={init:function(){this.WHERE_OPTIONS_1=[[s.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[s.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[s.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[s.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[s.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[s.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(s.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(s.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT);var e=i=>{var e=s.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+i]});return e.setValidator(function(e){var t=this.getValue();(e="FROM_START"===e||"FROM_END"===e)!==("FROM_START"===t||"FROM_END"===t)&&this.getSourceBlock().updateAt_(i,e)}),e};this.appendDummyInput("WHERE1_INPUT").appendField(e(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(e(2),"WHERE2"),this.appendDummyInput("AT2"),s.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(s.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(s.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){var e=s.createElement$$module$build$src$core$utils$xml("mutation"),t=this.getInput("AT1")instanceof s.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at1",""+t),t=this.getInput("AT2")instanceof s.ValueInput$$module$build$src$core$inputs$value_input,e.setAttribute("at2",""+t),e},domToMutation:function(e){var t="true"===e.getAttribute("at1");e="true"===e.getAttribute("at2"),this.updateAt_(1,t),this.updateAt_(2,e)},updateAt_:function(e,t){this.removeInput("AT"+e),this.removeInput("ORDINAL"+e,!0),t?(this.appendValueInput("AT"+e).setCheck("Number"),s.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+e).appendField(s.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+e),2===e&&s.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(s.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL)),1===e&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1"))&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT")}},c.text_changeCase={init:function(){var e=[[s.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[s.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[s.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(s.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(s.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),"CASE"),this.setOutput(!0,"String"),this.setTooltip(s.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_TOOLTIP)}},c.text_trim={init:function(){var e=[[s.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[s.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[s.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(s.Msg$$module$build$src$core$msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(s.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),"MODE"),this.setOutput(!0,"String"),this.setTooltip(s.Msg$$module$build$src$core$msg.TEXT_TRIM_TOOLTIP)}},c.text_print={init:function(){this.jsonInit({message0:s.Msg$$module$build$src$core$msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:s.Msg$$module$build$src$core$msg.TEXT_PRINT_TOOLTIP,helpUrl:s.Msg$$module$build$src$core$msg.TEXT_PRINT_HELPURL})}},{updateType_:function(e){this.outputConnection.setCheck("NUMBER"===e?"Number":"String")},mutationToDom:function(){var e=s.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("type",this.getFieldValue("TYPE")),e},domToMutation:function(e){this.updateType_(e.getAttribute("type"))}}),d=(c.text_prompt_ext=Object.assign({},u,{init:function(){var e=[[s.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[s.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(s.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(e=s.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator(e=>{this.updateType_(e)}),this.appendValueInput("TEXT").appendField(e,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(()=>"TEXT"===this.getFieldValue("TYPE")?s.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:s.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),c.text_prompt=Object.assign({},u,{init:function(){this.mixin(d);var e=[[s.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[s.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(s.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),(e=s.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator(e=>{this.updateType_(e)}),this.appendDummyInput().appendField(e,"TYPE").appendField(this.newQuote_(!0)).appendField(s.fromJson$$module$build$src$core$field_registry({type:"field_input",text:""}),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(()=>"TEXT"===this.getFieldValue("TYPE")?s.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:s.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}}),c.text_count={init:function(){this.jsonInit({message0:s.Msg$$module$build$src$core$msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:s.Msg$$module$build$src$core$msg.TEXT_COUNT_TOOLTIP,helpUrl:s.Msg$$module$build$src$core$msg.TEXT_COUNT_HELPURL})}},c.text_replace={init:function(){this.jsonInit({message0:s.Msg$$module$build$src$core$msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:s.Msg$$module$build$src$core$msg.TEXT_REPLACE_TOOLTIP,helpUrl:s.Msg$$module$build$src$core$msg.TEXT_REPLACE_HELPURL})}},c.text_reverse={init:function(){this.jsonInit({message0:s.Msg$$module$build$src$core$msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:s.Msg$$module$build$src$core$msg.TEXT_REVERSE_TOOLTIP,helpUrl:s.Msg$$module$build$src$core$msg.TEXT_REVERSE_HELPURL})}},{QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(n){for(let e=0,i;i=this.inputList[e];e++)for(let e=0,t;t=i.fieldRow[e];e++)if(n===t.name)return i.insertFieldAt(e,this.newQuote_(!0)),void i.insertFieldAt(e+2,this.newQuote_(!1));console.warn('field named "'+n+'" not found in '+this.toDevString())},newQuote_:function(e){return e=this.RTL?!e:e,s.fromJson$$module$build$src$core$field_registry({type:"field_image",src:e?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,width:this.QUOTE_IMAGE_WIDTH,height:this.QUOTE_IMAGE_HEIGHT,alt:e?"â€œ":"â€"})}}),u={itemCount_:0,mutationToDom:function(){var e=s.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("items",""+this.itemCount_),e},domToMutation:function(e){this.itemCount_=parseInt(e.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(e){this.itemCount_=e.itemCount,this.updateShape_()},decompose:function(t){var e=t.newBlock("text_create_join_container");e.initSvg();let i=e.getInput("STACK").connection;for(let e=0;e<this.itemCount_;e++){var n=t.newBlock("text_create_join_item");n.initSvg(),i.connect(n.previousConnection),i=n.nextConnection}return e},compose:function(e){var t,i=e.getInputTargetBlock("STACK");for(e=[];i;)i.isInsertionMarker()||e.push(i.valueConnection_),i=i.getNextBlock();for(i=0;i<this.itemCount_;i++){var n=this.getInput("ADD"+i).connection.targetConnection;n&&!e.includes(n)&&n.disconnect()}for(this.itemCount_=e.length,this.updateShape_(),i=0;i<this.itemCount_;i++)null!=(t=e[i])&&t.reconnect(this,"ADD"+i)},saveConnections:function(e){e=e.getInputTargetBlock("STACK");let t=0;for(;e;){var i;e.isInsertionMarker()?e=e.getNextBlock():(i=this.getInput("ADD"+t),e.valueConnection_=i&&i.connection.targetConnection,e=e.getNextBlock(),t++)}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var e,t=0;t<this.itemCount_;t++)this.getInput("ADD"+t)||(e=this.appendValueInput("ADD"+t).setAlign(s.Align$$module$build$src$core$inputs$align.RIGHT),0===t&&e.appendField(s.Msg$$module$build$src$core$msg.TEXT_JOIN_TITLE_CREATEWITH));for(t=this.itemCount_;this.getInput("ADD"+t);t++)this.removeInput("ADD"+t)}},h=(s.register$$module$build$src$core$extensions("text_append_tooltip",s.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_TEXT_APPEND_TOOLTIP}","VAR")),{isAt_:!1,mutationToDom:function(){var e=s.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("at",""+this.isAt_),e},domToMutation:function(e){e="false"!==e.getAttribute("at"),this.updateAt_(e)},updateAt_:function(e){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),e&&(this.appendValueInput("AT").setCheck("Number"),s.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)&&this.appendDummyInput("ORDINAL").appendField(s.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX),s.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(s.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL)),this.isAt_=e}}),u=(s.register$$module$build$src$core$extensions("text_indexOf_tooltip",function(){this.setTooltip(()=>s.Msg$$module$build$src$core$msg.TEXT_INDEXOF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}),s.register$$module$build$src$core$extensions("text_quotes",function(){this.mixin(d),this.quoteField_("TEXT")}),s.registerMixin$$module$build$src$core$extensions("quote_image_mixin",d),s.registerMutator$$module$build$src$core$extensions("text_join_mutator",u,function(){this.mixin(d),this.itemCount_=2,this.updateShape_(),this.setMutator(new s.MutatorIcon$$module$build$src$core$icons$mutator_icon(["text_create_join_item"],this))}),s.registerMutator$$module$build$src$core$extensions("text_charAt_mutator",h,function(){this.getField("WHERE").setValidator(function(e){e="FROM_START"===e||"FROM_END"===e;var t=this.getSourceBlock();e!==t.isAt_&&t.updateAt_(e)}),this.updateAt_(!0),this.setTooltip(()=>{var e=this.getFieldValue("WHERE");let t=s.Msg$$module$build$src$core$msg.TEXT_CHARAT_TOOLTIP;return"FROM_START"!==e&&"FROM_END"!==e||!(e="FROM_START"===e?s.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:s.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP)||(t+="  "+e.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),t})}),s.defineBlocks$$module$build$src$core$common(c),{blocks:c}),h={},p={setStatements_:function(e){this.hasStatements_!==e&&(e?(this.appendStatementInput("STACK").appendField(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=e)},updateParams_:function(){let e="";this.arguments_.length&&(e=s.Msg$$module$build$src$core$msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),s.disable$$module$build$src$core$events$utils();try{this.setFieldValue(e,"PARAMS")}finally{s.enable$$module$build$src$core$events$utils()}},mutationToDom:function(t){var i=s.createElement$$module$build$src$core$utils$xml("mutation");t&&i.setAttribute("name",this.getFieldValue("NAME"));for(let e=0;e<this.argumentVarModels_.length;e++){var n=s.createElement$$module$build$src$core$utils$xml("arg"),o=this.argumentVarModels_[e];n.setAttribute("name",o.getName()),n.setAttribute("varid",o.getId()),t&&this.paramIds_&&n.setAttribute("paramId",this.paramIds_[e]),i.appendChild(n)}return this.hasStatements_||i.setAttribute("statements","false"),i},domToMutation:function(i){this.arguments_=[],this.argumentVarModels_=[];for(let e=0,t;t=i.childNodes[e];e++){var n,o;"arg"===t.nodeName.toLowerCase()&&(n=(o=t).getAttribute("name"),o=o.getAttribute("varid")||o.getAttribute("varId"),this.arguments_.push(n),null!==(o=s.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,o,n,""))?this.argumentVarModels_.push(o):console.log(`Failed to create a variable named "${n}", ignoring.`))}this.updateParams_(),s.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_("false"!==i.getAttribute("statements"))},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;var t=Object.create(null);if(this.argumentVarModels_.length){t.params=[];for(let e=0;e<this.argumentVarModels_.length;e++)t.params.push({name:this.argumentVarModels_[e].getName(),id:this.argumentVarModels_[e].getId()})}return this.hasStatements_||(t.hasStatements=!1),t},loadExtraState:function(t){if(this.arguments_=[],this.argumentVarModels_=[],t.params)for(let e=0;e<t.params.length;e++){var i=t.params[e],i=s.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,i.id,i.name,"");this.arguments_.push(i.getName()),this.argumentVarModels_.push(i)}this.updateParams_(),s.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(!1!==t.hasStatements)},decompose:function(e){var t=s.createElement$$module$build$src$core$utils$xml("block"),i=(t.setAttribute("type","procedures_mutatorcontainer"),s.createElement$$module$build$src$core$utils$xml("statement"));i.setAttribute("name","STACK"),t.appendChild(i);for(let e=0;e<this.arguments_.length;e++){var n=s.createElement$$module$build$src$core$utils$xml("block"),o=(n.setAttribute("type","procedures_mutatorarg"),s.createElement$$module$build$src$core$utils$xml("field")),r=(o.setAttribute("name","NAME"),s.createTextNode$$module$build$src$core$utils$xml(this.arguments_[e]));o.appendChild(r),n.appendChild(o),o=s.createElement$$module$build$src$core$utils$xml("next"),n.appendChild(o),i.appendChild(n),i=o}return e=s.domToBlock$$module$build$src$core$xml(t,e),"procedures_defreturn"===this.type?e.setFieldValue(this.hasStatements_,"STATEMENTS"):e.removeInput("STATEMENT_INPUT"),s.mutateCallers$$module$build$src$core$procedures(this),e},compose:function(e){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let t=e.getInputTargetBlock("STACK");for(;t&&!t.isInsertionMarker();){var i=t.getFieldValue("NAME");this.arguments_.push(i),i=this.workspace.getVariable(i,""),this.argumentVarModels_.push(i),this.paramIds_.push(t.id),t=t.nextConnection&&t.nextConnection.targetBlock()}var n;this.updateParams_(),s.mutateCallers$$module$build$src$core$procedures(this),null!==(e=e.getFieldValue("STATEMENTS"))&&this.hasStatements_!==(e="TRUE"===e)&&(e?(this.setStatements_(!0),null!=(n=this.statementConnection_)&&n.reconnect(this,"STACK"),this.statementConnection_=null):(n=this.getInput("STACK").connection,(this.statementConnection_=n.targetConnection)&&((n=n.targetBlock()).unplug(),n.bumpNeighbours()),this.setStatements_(!1)))},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(t,i){var e=this.workspace.getVariableById(t);if(""===e.getType()){e=e.getName(),i=this.workspace.getVariableById(i);var n=!1;for(let e=0;e<this.argumentVarModels_.length;e++)this.argumentVarModels_[e].getId()===t&&(this.arguments_[e]=i.getName(),this.argumentVarModels_[e]=i,n=!0);n&&(this.displayRenamedVar_(e,i.getName()),s.mutateCallers$$module$build$src$core$procedures(this))}},updateVarName:function(t){var i=t.getName();let n=!1,o;for(let e=0;e<this.argumentVarModels_.length;e++)this.argumentVarModels_[e].getId()===t.getId()&&(o=this.arguments_[e],this.arguments_[e]=i,n=!0);n&&(this.displayRenamedVar_(o,i),s.mutateCallers$$module$build$src$core$procedures(this))},displayRenamedVar_:function(i,n){this.updateParams_();var o=this.getIcon(s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);if(o&&o.bubbleIsVisible()){o=o.getWorkspace().getAllBlocks(!1);for(let e=0,t;t=o[e];e++)"procedures_mutatorarg"===t.type&&s.Names$$module$build$src$core$names.equals(i,t.getFieldValue("NAME"))&&t.setFieldValue(n,"NAME")}},customContextMenu:function(e){if(!this.isInFlyout){var t=this.getFieldValue("NAME"),i={type:this.callType_,extraState:{name:t,params:this.arguments_}};if(e.push({enabled:!0,text:s.Msg$$module$build$src$core$msg.PROCEDURES_CREATE_DO.replace("%1",t),callback:s.callbackFactory$$module$build$src$core$contextmenu(this,i)}),!this.isCollapsed())for(t=0;t<this.argumentVarModels_.length;t++){var n={type:"variables_get",fields:{VAR:{name:(i=this.argumentVarModels_[t]).getName(),id:i.getId(),type:i.getType()}}};e.push({enabled:!0,text:s.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",i.getName()),callback:s.callbackFactory$$module$build$src$core$contextmenu(this,n)})}}}},p=(h.procedures_defnoreturn=Object.assign({},p,{init:function(){var e=s.findLegalName$$module$build$src$core$procedures("",this);(e=s.fromJson$$module$build$src$core$field_registry({type:"field_input",text:e})).setValidator(s.rename$$module$build$src$core$procedures),e.setSpellcheck(!1),this.appendDummyInput().appendField(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.setMutator(new s.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&s.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},callType_:"procedures_callnoreturn"}),h.procedures_defreturn=Object.assign({},p,{init:function(){var e=s.findLegalName$$module$build$src$core$procedures("",this);(e=s.fromJson$$module$build$src$core$field_registry({type:"field_input",text:e})).setValidator(s.rename$$module$build$src$core$procedures),e.setSpellcheck(!1),this.appendDummyInput().appendField(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TITLE).appendField(e,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(s.Align$$module$build$src$core$inputs$align.RIGHT).appendField(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new s.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&s.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},callType_:"procedures_callreturn"}),{init:function(){this.appendDummyInput().appendField(s.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(s.Msg$$module$build$src$core$msg.PROCEDURES_ALLOW_STATEMENTS).appendField(s.fromJson$$module$build$src$core$field_registry({type:"field_checkbox",checked:!0}),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(s.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}}),g=(h.procedures_mutatorcontainer=p,class extends s.FieldTextInput$$module$build$src$core$field_textinput{constructor(){super(...arguments),this.editingInteractively=!1}showEditor_(e){super.showEditor_(e),this.editingInteractively=!0,this.editingVariable=void 0}onFinishEditing_(e){super.onFinishEditing_(e),this.editingInteractively=!1}}),f=(h.procedures_mutatorarg={init:function(){var e=new g(s.DEFAULT_ARG$$module$build$src$core$procedures,this.validator_);this.appendDummyInput().appendField(s.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TITLE).appendField(e,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(s.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1},validator_:function(e){var t=this.getSourceBlock(),i=t.workspace.getRootWorkspace();if(!(e=e.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,"")))return null;var n=(t.workspace.targetWorkspace||t.workspace).getAllBlocks(!1),o=e.toLowerCase();for(let e=0;e<n.length;e++)if(n[e].id!==this.getSourceBlock().id){var r=n[e].getFieldValue("NAME");if(r&&r.toLowerCase()===o)return null}return t.isInFlyout||((t=i.getVariable(e,""))&&t.getName()!==e&&i.renameVariableById(t.getId(),e),t)||(this.editingInteractively?this.editingVariable?i.renameVariableById(this.editingVariable.getId(),e):this.editingVariable=i.createVariable(e,""):i.createVariable(e,"")),e}},"DISABLED_PROCEDURE_DEFINITION"),p={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(e,t){s.Names$$module$build$src$core$names.equals(e,this.getProcedureCall())&&(this.setFieldValue(t,"NAME"),this.setTooltip((this.outputConnection?s.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_TOOLTIP:s.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",t)))},setProcedureParameters_:function(e,t){var i,n=s.getDefinition$$module$build$src$core$procedures(this.getProcedureCall(),this.workspace);if((n=(n=n&&n.getIcon(s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE))&&n.bubbleIsVisible())?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null),e.join("\n")===this.arguments_.join("\n"))this.quarkIds_=t;else{if(t.length!==e.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]);for(let e=0;e<this.arguments_.length;e++){var o=this.getInput("ARG"+e);o&&(o=o.connection.targetConnection,this.quarkConnections_[this.quarkIds_[e]]=o,n)&&o&&!t.includes(this.quarkIds_[e])&&(o.disconnect(),o.getSourceBlock().bumpNeighbours())}for(this.arguments_=[].concat(e),this.argumentVarModels_=[],e=0;e<this.arguments_.length;e++)n=s.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,null,this.arguments_[e],""),this.argumentVarModels_.push(n);if(this.updateShape_(),this.quarkIds_=t)for(t=0;t<this.arguments_.length;t++)(e=this.quarkIds_[t])in this.quarkConnections_&&(null!=(i=this.quarkConnections_[e])&&i.reconnect(this,"ARG"+t)||delete this.quarkConnections_[e])}},updateShape_:function(){for(var e=0;e<this.arguments_.length;e++){var t=this.getField("ARGNAME"+e);if(t){s.disable$$module$build$src$core$events$utils();try{t.setValue(this.arguments_[e])}finally{s.enable$$module$build$src$core$events$utils()}}else t=s.fromJson$$module$build$src$core$field_registry({type:"field_label",text:this.arguments_[e]}),this.appendValueInput("ARG"+e).setAlign(s.Align$$module$build$src$core$inputs$align.RIGHT).appendField(t,"ARGNAME"+e)}for(e=this.arguments_.length;this.getInput("ARG"+e);e++)this.removeInput("ARG"+e);(e=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||e.appendField(s.Msg$$module$build$src$core$msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"):this.getField("WITH")&&e.removeField("WITH"))},mutationToDom:function(){var t=s.createElement$$module$build$src$core$utils$xml("mutation");t.setAttribute("name",this.getProcedureCall());for(let e=0;e<this.arguments_.length;e++){var i=s.createElement$$module$build$src$core$utils$xml("arg");i.setAttribute("name",this.arguments_[e]),t.appendChild(i)}return t},domToMutation:function(i){var n=i.getAttribute("name"),o=(this.renameProcedure(this.getProcedureCall(),n),n=[],[]);for(let e=0,t;t=i.childNodes[e];e++)"arg"===t.nodeName.toLowerCase()&&(n.push(t.getAttribute("name")),o.push(t.getAttribute("paramId")));this.setProcedureParameters_(n,o)},saveExtraState:function(){var e=Object.create(null);return e.name=this.getProcedureCall(),this.arguments_.length&&(e.params=this.arguments_),e},loadExtraState:function(e){var t;this.renameProcedure(this.getProcedureCall(),e.name),(e=e.params)&&((t=[]).length=e.length,t.fill(null),this.setProcedureParameters_(e,t))},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(e){var t,i,n,o;this.workspace&&!this.workspace.isFlyout&&e.recordUndo&&(e.type===s.BLOCK_CREATE$$module$build$src$core$events$events&&e.ids.includes(this.id)?(t=this.getProcedureCall(),(i=!(i=s.getDefinition$$module$build$src$core$procedures(t,this.workspace))||i.type===this.defType_&&JSON.stringify(i.getVars())===JSON.stringify(this.arguments_)?i:null)?i.isEnabled()||(this.setDisabledReason(!0,f),this.setWarningText(s.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",t))):(s.setGroup$$module$build$src$core$events$utils(e.group),e=s.createElement$$module$build$src$core$utils$xml("xml"),(t=s.createElement$$module$build$src$core$utils$xml("block")).setAttribute("type",this.defType_),n=(i=this.getRelativeToSurfaceXY()).y+2*s.config$$module$build$src$core$config.snapRadius,t.setAttribute("x",""+(i.x+s.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1))),t.setAttribute("y",""+n),i=this.mutationToDom(),t.appendChild(i),(i=s.createElement$$module$build$src$core$utils$xml("field")).setAttribute("name","NAME"),(n=this.getProcedureCall())!==(o=s.findLegalName$$module$build$src$core$procedures(n,this))&&this.renameProcedure(n,o),i.appendChild(s.createTextNode$$module$build$src$core$utils$xml(n)),t.appendChild(i),e.appendChild(t),s.domToWorkspace$$module$build$src$core$xml(e,this.workspace),s.setGroup$$module$build$src$core$events$utils(!1))):e.type===s.BLOCK_DELETE$$module$build$src$core$events$events?(t=this.getProcedureCall(),s.getDefinition$$module$build$src$core$procedures(t,this.workspace)||(s.setGroup$$module$build$src$core$events$utils(e.group),this.dispose(!0),s.setGroup$$module$build$src$core$events$utils(!1))):e.type===s.BLOCK_CHANGE$$module$build$src$core$events$events&&"disabled"===e.element&&(t=this.getProcedureCall(),n=s.getDefinition$$module$build$src$core$procedures(t,this.workspace))&&n.id===e.blockId&&((i=s.getGroup$$module$build$src$core$events$utils())&&console.log("Saw an existing group while responding to a definition change"),s.setGroup$$module$build$src$core$events$utils(e.group),e=n.isEnabled(),this.setDisabledReason(!e,f),this.setWarningText(e?null:s.Msg$$module$build$src$core$msg.PROCEDURES_CALL_DISABLED_DEF_WARNING.replace("%1",t)),s.setGroup$$module$build$src$core$events$utils(i)))},customContextMenu:function(e){var t,i;this.workspace.isMovable()&&(t=this.getProcedureCall(),i=this.workspace,e.push({enabled:!0,text:s.Msg$$module$build$src$core$msg.PROCEDURES_HIGHLIGHT_DEF,callback:function(){var e=s.getDefinition$$module$build$src$core$procedures(t,i);e&&(i.centerOnBlock(e.id),s.getFocusManager$$module$build$src$core$focus_manager().focusNode(e))}}))}},p=(h.procedures_callnoreturn=Object.assign({},p,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(s.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defnoreturn"}),h.procedures_callreturn=Object.assign({},p,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(s.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null},defType_:"procedures_defreturn"}),h.procedures_ifreturn={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(s.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(s.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(s.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){var e=s.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("value",String(Number(this.hasReturnValue_))),e},domToMutation:function(e){this.hasReturnValue_="1"===e.getAttribute("value"),this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(e){if(!(this.workspace.isDragging&&this.workspace.isDragging()||e.type!==s.BLOCK_MOVE$$module$build$src$core$events$events&&e.type!==s.BLOCK_CREATE$$module$build$src$core$events$events)){e=!1;var t=this;do{if(this.FUNCTION_TYPES.includes(t.type)){e=!0;break}}while(t=t.getSurroundParent());if(e?("procedures_defnoreturn"===t.type&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):"procedures_defreturn"!==t.type||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText(s.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_WARNING),!this.isInFlyout)try{s.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!e,"UNPARENTED_IFRETURN")}finally{s.setRecordUndo$$module$build$src$core$events$utils(!0)}}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]},s.defineBlocks$$module$build$src$core$common(h),{blocks:h}),m=s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["Ï€","PI"],["e","E"],["Ï†","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt(Â½)","SQRT1_2"],["âˆž","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]),b=(s.register$$module$build$src$core$extensions("math_op_tooltip",s.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"})),{mutationToDom:function(){var e=s.createElement$$module$build$src$core$utils$xml("mutation"),t="DIVISIBLE_BY"===this.getFieldValue("PROPERTY");return e.setAttribute("divisor_input",String(t)),e},domToMutation:function(e){e="true"===e.getAttribute("divisor_input"),this.updateShape_(e)},updateShape_:function(e){var t=this.getInput("DIVISOR");e?t||this.appendValueInput("DIVISOR").setCheck("Number"):t&&this.removeInput("DIVISOR")}}),b=(s.registerMutator$$module$build$src$core$extensions("math_is_divisibleby_mutator",b,function(){this.getField("PROPERTY").setValidator(function(e){e="DIVISIBLE_BY"===e,this.getSourceBlock().updateShape_(e)})}),s.register$$module$build$src$core$extensions("math_change_tooltip",s.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_MATH_CHANGE_TOOLTIP}","VAR")),{updateType_:function(e){"MODE"===e?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){var e=s.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("op",this.getFieldValue("OP")),e},domToMutation:function(e){if(null===(e=e.getAttribute("op")))throw new TypeError("xmlElement had no op attribute");this.updateType_(e)}}),b=(s.registerMutator$$module$build$src$core$extensions("math_modes_of_list_mutator",b,function(){this.getField("OP").setValidator(function(e){this.updateType_(e)}.bind(this))}),s.defineBlocks$$module$build$src$core$common(m),{blocks:m}),_=s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]),y=(s.register$$module$build$src$core$extensions("controls_whileUntil_tooltip",s.buildTooltipForDropdown$$module$build$src$core$extensions("MODE",{WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"})),s.register$$module$build$src$core$extensions("controls_flow_tooltip",s.buildTooltipForDropdown$$module$build$src$core$extensions("FLOW",{BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"})),{customContextMenu:function(e){var t,i;this.isInFlyout||(i=(t=this.getField("VAR")).getVariable().getName(),this.isCollapsed())||null===i||(t={type:"variables_get",fields:{VAR:t.saveState(!0)}},e.push({enabled:!0,text:s.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",i),callback:s.callbackFactory$$module$build$src$core$contextmenu(this,t)}))}}),v=(s.registerMixin$$module$build$src$core$extensions("contextMenu_newGetVariableBlock",y),s.register$$module$build$src$core$extensions("controls_for_tooltip",s.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),s.register$$module$build$src$core$extensions("controls_forEach_tooltip",s.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR")),new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"])),y=(s.registerMixin$$module$build$src$core$extensions("controls_flow_in_loop_check",{getSurroundLoop:function(){let e=this;do{if(v.has(e.type))return e}while(e=e.getSurroundParent());return null},onchange:function(e){var t=this.workspace;if(t.isDragging&&!t.isDragging()&&(e.type===s.BLOCK_MOVE$$module$build$src$core$events$events||e.type===s.BLOCK_CREATE$$module$build$src$core$events$events)&&(e=!!this.getSurroundLoop(),this.setWarningText(e?null:s.Msg$$module$build$src$core$msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout))try{s.setRecordUndo$$module$build$src$core$events$utils(!1),this.setDisabledReason(!e,"CONTROL_FLOW_NOT_IN_LOOP")}finally{s.setRecordUndo$$module$build$src$core$events$utils(!0)}}}),s.defineBlocks$$module$build$src$core$common(_),{blocks:_,loopTypes:v}),T=s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["â‰ ","NEQ"],["â€<","LT"],["â€â‰¤","LTE"],["â€>","GT"],["â€â‰¥","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]),E=(s.register$$module$build$src$core$extensions("logic_op_tooltip",s.buildTooltipForDropdown$$module$build$src$core$extensions("OP",{EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"})),{elseifCount_:0,elseCount_:0,mutationToDom:function(){var e;return this.elseifCount_||this.elseCount_?(e=s.createElement$$module$build$src$core$utils$xml("mutation"),this.elseifCount_&&e.setAttribute("elseif",String(this.elseifCount_)),this.elseCount_&&e.setAttribute("else","1"),e):null},domToMutation:function(e){this.elseifCount_=parseInt(e.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(e.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){var e;return this.elseifCount_||this.elseCount_?(e=Object.create(null),this.elseifCount_&&(e.elseIfCount=this.elseifCount_),this.elseCount_&&(e.hasElse=!0),e):null},loadExtraState:function(e){this.elseifCount_=e.elseIfCount||0,this.elseCount_=e.hasElse?1:0,this.updateShape_()},decompose:function(t){var e=t.newBlock("controls_if_if");e.initSvg();let i=e.nextConnection;for(let e=1;e<=this.elseifCount_;e++){var n=t.newBlock("controls_if_elseif");n.initSvg(),i.connect(n.previousConnection),i=n.nextConnection}return this.elseCount_&&((t=t.newBlock("controls_if_else")).initSvg(),i.connect(t.previousConnection)),e},compose:function(e){e=e.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;var t=[null],i=[null];let n=null;for(;e;){if(!e.isInsertionMarker())switch(e.type){case"controls_if_elseif":this.elseifCount_++,t.push(e.valueConnection_),i.push(e.statementConnection_);break;case"controls_if_else":this.elseCount_++,n=e.statementConnection_;break;default:throw TypeError("Unknown block type: "+e.type)}e=e.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(t,i,n)},saveConnections:function(e){e=e.nextConnection.targetBlock();let t=1;for(;e;){if(!e.isInsertionMarker())switch(e.type){case"controls_if_elseif":var i=this.getInput("IF"+t),n=this.getInput("DO"+t);e.valueConnection_=i&&i.connection.targetConnection,e.statementConnection_=n&&n.connection.targetConnection,t++;break;case"controls_if_else":i=this.getInput("ELSE"),e.statementConnection_=i&&i.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+e.type)}e=e.getNextBlock()}},rebuildShape_:function(){var t=[null],i=[null];let e=null;this.getInput("ELSE")&&(e=this.getInput("ELSE").connection.targetConnection);for(let e=1;this.getInput("IF"+e);e++){var n=this.getInput("IF"+e),o=this.getInput("DO"+e);t.push(n.connection.targetConnection),i.push(o.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(t,i,e)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var e=1;this.getInput("IF"+e);e++)this.removeInput("IF"+e),this.removeInput("DO"+e);for(e=1;e<=this.elseifCount_;e++)this.appendValueInput("IF"+e).setCheck("Boolean").appendField(s.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+e).appendField(s.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(s.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(t,i,e){for(let e=1;e<=this.elseifCount_;e++){var n;null!=(n=t[e])&&n.reconnect(this,"IF"+e),null!=(n=i[e])&&n.reconnect(this,"DO"+e)}null!=e&&e.reconnect(this,"ELSE")}}),k=(s.registerMutator$$module$build$src$core$extensions("controls_if_mutator",E,null,["controls_if_elseif","controls_if_else"]),s.register$$module$build$src$core$extensions("controls_if_tooltip",function(){this.setTooltip(function(){return this.elseifCount_||this.elseCount_?!this.elseifCount_&&this.elseCount_?s.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_2:this.elseifCount_&&!this.elseCount_?s.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_3:this.elseifCount_&&this.elseCount_?s.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_4:"":s.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_1}.bind(this))}),{onchange:function(e){this.prevBlocks_||(this.prevBlocks_=[null,null]);var t=this.getInputTargetBlock("A"),i=this.getInputTargetBlock("B");t&&i&&!this.workspace.connectionChecker.doTypeChecks(t.outputConnection,i.outputConnection)&&(s.setGroup$$module$build$src$core$events$utils(e.group),(e=this.prevBlocks_[0])!==t&&(t.unplug(),!e||e.isDisposed()||e.isShadow()||this.getInput("A").connection.connect(e.outputConnection)),(t=this.prevBlocks_[1])!==i&&(i.unplug(),!t||t.isDisposed()||t.isShadow()||this.getInput("B").connection.connect(t.outputConnection)),this.bumpNeighbours(),s.setGroup$$module$build$src$core$events$utils(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}}),E=(s.register$$module$build$src$core$extensions("logic_compare",function(){this.mixin(k)}),{prevParentConnection_:null,onchange:function(t){var i=this.getInputTargetBlock("THEN"),n=this.getInputTargetBlock("ELSE"),o=this.outputConnection.targetConnection;if((i||n)&&o)for(let e=0;e<2;e++){var r=1===e?i:n;r&&!r.workspace.connectionChecker.doTypeChecks(r.outputConnection,o)&&(s.setGroup$$module$build$src$core$events$utils(t.group),(o===this.prevParentConnection_?(this.unplug(),o.getSourceBlock()):(r.unplug(),r)).bumpNeighbours(),s.setGroup$$module$build$src$core$events$utils(!1))}this.prevParentConnection_=o}}),E=(s.registerMixin$$module$build$src$core$extensions("logic_ternary",E),s.defineBlocks$$module$build$src$core$common(T),{blocks:T}),C=s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),I=(C.lists_create_with={init:function(){this.setHelpUrl(s.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new s.MutatorIcon$$module$build$src$core$icons$mutator_icon(["lists_create_with_item"],this)),this.setTooltip(s.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){var e=s.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("items",String(this.itemCount_)),e},domToMutation:function(e){if(!(e=e.getAttribute("items")))throw new TypeError("element did not have items");this.itemCount_=parseInt(e,10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(e){this.itemCount_=e.itemCount,this.updateShape_()},decompose:function(t){var e=t.newBlock("lists_create_with_container");e.initSvg();let i=e.getInput("STACK").connection;for(let e=0;e<this.itemCount_;e++){var n=t.newBlock("lists_create_with_item");if(n.initSvg(),!n.previousConnection)throw Error("itemBlock has no previousConnection");i.connect(n.previousConnection),i=n.nextConnection}return e},compose:function(e){var t,i=e.getInputTargetBlock("STACK");for(e=[];i;)i.isInsertionMarker()||e.push(i.valueConnection_),i=i.getNextBlock();for(i=0;i<this.itemCount_;i++){var n=this.getInput("ADD"+i).connection.targetConnection;n&&!e.includes(n)&&n.disconnect()}for(this.itemCount_=e.length,this.updateShape_(),i=0;i<this.itemCount_;i++)null!=(t=e[i])&&t.reconnect(this,"ADD"+i)},saveConnections:function(e){e=e.getInputTargetBlock("STACK");let t=0;for(;e;){var i;e.isInsertionMarker()?e=e.getNextBlock():(i=this.getInput("ADD"+t),e.valueConnection_=null==i?void 0:i.connection.targetConnection,e=e.getNextBlock(),t++)}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(s.Msg$$module$build$src$core$msg.LISTS_CREATE_EMPTY_TITLE);for(var e,t=0;t<this.itemCount_;t++)this.getInput("ADD"+t)||(e=this.appendValueInput("ADD"+t).setAlign(s.Align$$module$build$src$core$inputs$align.RIGHT),0===t&&e.appendField(s.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_INPUT_WITH));for(t=this.itemCount_;this.getInput("ADD"+t);t++)this.removeInput("ADD"+t)}},{init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(s.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(s.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}}),I=(C.lists_create_with_container=I,{init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(s.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(s.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}}),I=(C.lists_create_with_item=I,{init:function(){var e=[[s.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_FIRST,"FIRST"],[s.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_LAST,"LAST"]];if(this.setHelpUrl(s.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(s.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_INPUT_IN_LIST),!(e=s.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})))throw Error("field_dropdown not found");this.appendValueInput("FIND").appendField(e,"END"),this.setInputsInline(!0),this.setTooltip(()=>s.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}}),I=(C.lists_indexOf=I,{init:function(){var e=[[s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET,"GET"],[s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),(e=s.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e})).setValidator(function(e){e="REMOVE"===e,this.getSourceBlock().updateStatement_(e)}),this.appendValueInput("VALUE").setCheck("Array").appendField(s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(e,"MODE").appendField("","SPACE"),(e=s.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS})).setValidator(function(e){var t=this.getValue();(e="FROM_START"===e||"FROM_END"===e)!==("FROM_START"===t||"FROM_END"===t)&&this.getSourceBlock().updateAt_(e)}),this.appendDummyInput().appendField(e,"WHERE"),this.appendDummyInput("AT"),s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0),this.setTooltip(()=>{var e=this.getFieldValue("MODE"),t=this.getFieldValue("WHERE");let i="";switch(e+" "+t){case"GET FROM_START":case"GET FROM_END":i=s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":i=s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":i=s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":i=s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":i=s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":i=s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":i=s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":i=s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":i=s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":i=s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":i=s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":i=s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return"FROM_START"!==t&&"FROM_END"!==t||(i+="  "+("FROM_START"===t?s.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:s.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),i})},mutationToDom:function(){var e=s.createElement$$module$build$src$core$utils$xml("mutation"),t=(e.setAttribute("statement",String(!this.outputConnection)),this.getInput("AT")instanceof s.ValueInput$$module$build$src$core$inputs$value_input);return e.setAttribute("at",String(t)),e},domToMutation:function(e){var t="true"===e.getAttribute("statement");this.updateStatement_(t),e="false"!==e.getAttribute("at"),this.updateAt_(e)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function(e){e.isStatement?this.updateStatement_(!0):"string"==typeof e&&this.domToMutation(s.textToDom$$module$build$src$core$utils$xml(e))},updateStatement_:function(e){e!==!this.outputConnection&&(this.unplug(!0,!0),e?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(e){this.removeInput("AT"),this.removeInput("ORDINAL",!0),e?(this.appendValueInput("AT").setCheck("Number"),s.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(s.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}}),I=(C.lists_getIndex=I,{init:function(){var e=[[s.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_SET,"SET"],[s.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[s.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(s.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(s.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_IN_LIST),e=s.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:e}),this.appendDummyInput().appendField(e,"MODE").appendField("","SPACE"),(e=s.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS})).setValidator(function(e){var t=this.getValue();(e="FROM_START"===e||"FROM_END"===e)!==("FROM_START"===t||"FROM_END"===t)&&this.getSourceBlock().updateAt_(e)}),this.appendDummyInput().appendField(e,"WHERE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(s.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(s.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0),this.setTooltip(()=>{var e=this.getFieldValue("MODE"),t=this.getFieldValue("WHERE");let i="";switch(e+" "+t){case"SET FROM_START":case"SET FROM_END":i=s.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":i=s.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":i=s.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":i=s.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":i=s.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":i=s.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":i=s.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":i=s.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return"FROM_START"!==t&&"FROM_END"!==t||(i+="  "+s.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),i})},mutationToDom:function(){var e=s.createElement$$module$build$src$core$utils$xml("mutation"),t=this.getInput("AT")instanceof s.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at",String(t)),e},domToMutation:function(e){e="false"!==e.getAttribute("at"),this.updateAt_(e)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(e){this.removeInput("AT"),this.removeInput("ORDINAL",!0),e?(this.appendValueInput("AT").setCheck("Number"),s.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(s.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"),this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO")}}),I=(C.lists_setIndex=I,{init:function(){this.WHERE_OPTIONS_1=[[s.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[s.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[s.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[s.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[s.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[s.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(s.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(s.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_INPUT_IN_LIST);var e=i=>{var e=s.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+i]});return e.setValidator(function(e){var t=this.getValue();(e="FROM_START"===e||"FROM_END"===e)!==("FROM_START"===t||"FROM_END"===t)&&this.getSourceBlock().updateAt_(i,e)}),e};this.appendDummyInput("WHERE1_INPUT").appendField(e(1),"WHERE1"),this.appendDummyInput("AT1"),this.appendDummyInput("WHERE2_INPUT").appendField(e(2),"WHERE2"),this.appendDummyInput("AT2"),s.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(s.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(s.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){var e=s.createElement$$module$build$src$core$utils$xml("mutation"),t=this.getInput("AT1")instanceof s.ValueInput$$module$build$src$core$inputs$value_input;return e.setAttribute("at1",String(t)),t=this.getInput("AT2")instanceof s.ValueInput$$module$build$src$core$inputs$value_input,e.setAttribute("at2",String(t)),e},domToMutation:function(e){var t="true"===e.getAttribute("at1");e="true"===e.getAttribute("at2"),this.updateAt_(1,t),this.updateAt_(2,e)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(e,t){this.removeInput("AT"+e),this.removeInput("ORDINAL"+e,!0),t?(this.appendValueInput("AT"+e).setCheck("Number"),s.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+e).appendField(s.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+e),1===e&&(this.moveInputBefore("AT1","WHERE2_INPUT"),this.getInput("ORDINAL1"))&&this.moveInputBefore("ORDINAL1","WHERE2_INPUT"),s.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}}),I=(C.lists_getSublist=I,C.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},C.lists_split={init:function(){var e=s.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:[[s.Msg$$module$build$src$core$msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[s.Msg$$module$build$src$core$msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]]});if(!e)throw Error("field_dropdown not found");e.setValidator(e=>{this.updateType_(e)}),this.setHelpUrl(s.Msg$$module$build$src$core$msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(e,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(s.Msg$$module$build$src$core$msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(()=>{var e=this.getFieldValue("MODE");if("SPLIT"===e)return s.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_SPLIT;if("JOIN"===e)return s.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+e)})},updateType_:function(e){var t,i;this.getFieldValue("MODE")!==e&&((t=this.getInput("INPUT").connection).setShadowDom(null),i=t.targetBlock())&&(t.disconnect(),i.isShadow()?i.dispose(!1):this.bumpNeighbours()),"SPLIT"===e?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){var e=s.createElement$$module$build$src$core$utils$xml("mutation");return e.setAttribute("mode",this.getFieldValue("MODE")),e},domToMutation:function(e){this.updateType_(e.getAttribute("mode"))},saveExtraState:function(){return{mode:this.getFieldValue("MODE")}},loadExtraState:function(e){this.updateType_(e.mode)}},s.defineBlocks$$module$build$src$core$common(C),{blocks:C}),C={blocks:Object.assign({},C,T,_,m,h,c,i,e),lists:I,logic:E,loops:y,math:b,procedures:p,texts:u,variables:n,variablesDynamic:t};return C.__namespace__=s,C},"function"==typeof define&&define.amd?define(["./blockly_compressed.js"],o):"object"==typeof i?t.exports=o(e("./blockly_compressed.js")):n.Blockly.libraryBlocks=o(n.Blockly)},{"./blockly_compressed.js":215}],218:[function(e,t,i){t.exports=e("./blockly_compressed.js")},{"./blockly_compressed.js":215}],219:[function(e,t,i){var n,o;n=this,o=function(e,t,i){return e.setLocale(t),e},"function"==typeof define&&define.amd?define(["blockly/core","blockly/msg/en","blockly/blocks"],o):"object"==typeof i?t.exports=o(e("blockly/core"),e("blockly/msg/en"),e("blockly/blocks")):n.Blockly=o(n.Blockly,n.Blockly.Msg,n.Blockly.Blocks)},{"blockly/blocks":216,"blockly/core":218,"blockly/msg/en":220}],220:[function(e,t,i){function n(){var e={Msg:Object.create(null)};return e.Msg.ADD_COMMENT="Add Comment",e.Msg.ALT_KEY="Alt",e.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",e.Msg.CHANGE_VALUE_TITLE="Change value:",e.Msg.CHROME_OS="ChromeOS",e.Msg.CLEAN_UP="Clean up Blocks",e.Msg.CLOSE="Close",e.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",e.Msg.COLLAPSE_ALL="Collapse Blocks",e.Msg.COLLAPSE_BLOCK="Collapse Block",e.Msg.COLOUR_BLEND_COLOUR1="colour 1",e.Msg.COLOUR_BLEND_COLOUR2="colour 2",e.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",e.Msg.COLOUR_BLEND_RATIO="ratio",e.Msg.COLOUR_BLEND_TITLE="blend",e.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",e.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",e.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",e.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",e.Msg.COLOUR_RANDOM_TITLE="random colour",e.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",e.Msg.COLOUR_RGB_BLUE="blue",e.Msg.COLOUR_RGB_GREEN="green",e.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",e.Msg.COLOUR_RGB_RED="red",e.Msg.COLOUR_RGB_TITLE="colour with",e.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",e.Msg.COMMAND_KEY="âŒ˜ Command",e.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",e.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",e.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",e.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",e.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",e.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",e.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",e.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",e.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",e.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",e.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",e.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",e.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",e.Msg.CONTROLS_IF_MSG_ELSE="else",e.Msg.CONTROLS_IF_MSG_ELSEIF="else if",e.Msg.CONTROLS_IF_MSG_IF="if",e.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",e.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",e.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",e.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",e.Msg.CONTROLS_REPEAT_INPUT_DO="do",e.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",e.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",e.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",e.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",e.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",e.Msg.CONTROL_KEY="Ctrl",e.Msg.COPY_SHORTCUT="Copy",e.Msg.CUT_SHORTCUT="Cut",e.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",e.Msg.DELETE_BLOCK="Delete Block",e.Msg.DELETE_VARIABLE="Delete the '%1' variable",e.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",e.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",e.Msg.DIALOG_CANCEL="Cancel",e.Msg.DIALOG_OK="OK",e.Msg.DISABLE_BLOCK="Disable Block",e.Msg.DUPLICATE_BLOCK="Duplicate",e.Msg.DUPLICATE_COMMENT="Duplicate Comment",e.Msg.EDIT_BLOCK_CONTENTS="Edit Block contents",e.Msg.ENABLE_BLOCK="Enable Block",e.Msg.EXPAND_ALL="Expand Blocks",e.Msg.EXPAND_BLOCK="Expand Block",e.Msg.EXTERNAL_INPUTS="External Inputs",e.Msg.HELP="Help",e.Msg.HELP_PROMPT="Press %1 for help on keyboard controls",e.Msg.INLINE_INPUTS="Inline Inputs",e.Msg.KEYBOARD_NAV_CONSTRAINED_MOVE_HINT="Use the arrow keys to move, then %1 to accept the position",e.Msg.KEYBOARD_NAV_COPIED_HINT="Copied. Press %1 to paste.",e.Msg.KEYBOARD_NAV_CUT_HINT="Cut. Press %1 to paste.",e.Msg.KEYBOARD_NAV_UNCONSTRAINED_MOVE_HINT="Hold %1 and use arrow keys to move freely, then %2 to accept the position",e.Msg.LINUX="Linux",e.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",e.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",e.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",e.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",e.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",e.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",e.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",e.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",e.Msg.LISTS_GET_INDEX_FIRST="first",e.Msg.LISTS_GET_INDEX_FROM_END="# from end",e.Msg.LISTS_GET_INDEX_FROM_START="#",e.Msg.LISTS_GET_INDEX_GET="get",e.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",e.Msg.LISTS_GET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",e.Msg.LISTS_GET_INDEX_LAST="last",e.Msg.LISTS_GET_INDEX_RANDOM="random",e.Msg.LISTS_GET_INDEX_REMOVE="remove",e.Msg.LISTS_GET_INDEX_TAIL="",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",e.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",e.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",e.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",e.Msg.LISTS_GET_SUBLIST_END_LAST="to last",e.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",e.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",e.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",e.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",e.Msg.LISTS_GET_SUBLIST_TAIL="",e.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",e.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",e.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",e.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",e.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#finding-items-in-a-list",e.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",e.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",e.Msg.LISTS_INLIST="in list",e.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",e.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",e.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",e.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",e.Msg.LISTS_LENGTH_TITLE="length of %1",e.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",e.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",e.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",e.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",e.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",e.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",e.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",e.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",e.Msg.LISTS_SET_INDEX_INPUT_TO="as",e.Msg.LISTS_SET_INDEX_INSERT="insert at",e.Msg.LISTS_SET_INDEX_SET="set",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",e.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",e.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",e.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",e.Msg.LISTS_SORT_ORDER_DESCENDING="descending",e.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",e.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",e.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",e.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",e.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",e.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",e.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",e.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",e.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",e.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",e.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",e.Msg.LOGIC_BOOLEAN_FALSE="false",e.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",e.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",e.Msg.LOGIC_BOOLEAN_TRUE="true",e.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",e.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",e.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",e.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",e.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",e.Msg.LOGIC_NEGATE_TITLE="not %1",e.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",e.Msg.LOGIC_NULL="null",e.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",e.Msg.LOGIC_NULL_TOOLTIP="Returns null.",e.Msg.LOGIC_OPERATION_AND="and",e.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",e.Msg.LOGIC_OPERATION_OR="or",e.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",e.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",e.Msg.LOGIC_TERNARY_CONDITION="test",e.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",e.Msg.LOGIC_TERNARY_IF_FALSE="if false",e.Msg.LOGIC_TERNARY_IF_TRUE="if true",e.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",e.Msg.MAC_OS="macOS",e.Msg.MATH_ADDITION_SYMBOL="+",e.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",e.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",e.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",e.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",e.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",e.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",e.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",e.Msg.MATH_CHANGE_TITLE="change %1 by %2",e.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",e.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",e.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants: Ï€ (3.141â€¦), e (2.718â€¦), Ï† (1.618â€¦), sqrt(2) (1.414â€¦), sqrt(Â½) (0.707â€¦), or âˆž (infinity).",e.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",e.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",e.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",e.Msg.MATH_DIVISION_SYMBOL="Ã·",e.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",e.Msg.MATH_IS_EVEN="is even",e.Msg.MATH_IS_NEGATIVE="is negative",e.Msg.MATH_IS_ODD="is odd",e.Msg.MATH_IS_POSITIVE="is positive",e.Msg.MATH_IS_PRIME="is prime",e.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",e.Msg.MATH_IS_WHOLE="is whole",e.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",e.Msg.MATH_MODULO_TITLE="remainder of %1 Ã· %2",e.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",e.Msg.MATH_MULTIPLICATION_SYMBOL="Ã—",e.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",e.Msg.MATH_NUMBER_TOOLTIP="A number.",e.Msg.MATH_ONLIST_HELPURL="",e.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",e.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",e.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",e.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",e.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",e.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",e.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",e.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",e.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",e.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",e.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",e.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",e.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",e.Msg.MATH_POWER_SYMBOL="^",e.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",e.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",e.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",e.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",e.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",e.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",e.Msg.MATH_ROUND_OPERATOR_ROUND="round",e.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",e.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",e.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",e.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",e.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",e.Msg.MATH_SINGLE_OP_ROOT="square root",e.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",e.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",e.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",e.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",e.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",e.Msg.MATH_SUBTRACTION_SYMBOL="-",e.Msg.MATH_TRIG_ACOS="acos",e.Msg.MATH_TRIG_ASIN="asin",e.Msg.MATH_TRIG_ATAN="atan",e.Msg.MATH_TRIG_COS="cos",e.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",e.Msg.MATH_TRIG_SIN="sin",e.Msg.MATH_TRIG_TAN="tan",e.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",e.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",e.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",e.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",e.Msg.MOVE_BLOCK="Move Block",e.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",e.Msg.NEW_NUMBER_VARIABLE="Create number variable...",e.Msg.NEW_STRING_VARIABLE="Create string variable...",e.Msg.NEW_VARIABLE="Create variable...",e.Msg.NEW_VARIABLE_TITLE="New variable name:",e.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",e.Msg.OPTION_KEY="âŒ¥ Option",e.Msg.ORDINAL_NUMBER_SUFFIX="",e.Msg.PASTE_SHORTCUT="Paste",e.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",e.Msg.PROCEDURES_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",e.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",e.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",e.Msg.PROCEDURES_CALL_DISABLED_DEF_WARNING="Can't run the user-defined function '%1' because the definition block is disabled.",e.Msg.PROCEDURES_CREATE_DO="Create '%1'",e.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",e.Msg.PROCEDURES_DEFNORETURN_DO="",e.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",e.Msg.PROCEDURES_DEFNORETURN_TITLE="to",e.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",e.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",e.Msg.PROCEDURES_DEFRETURN_RETURN="return",e.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",e.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",e.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",e.Msg.PROCEDURES_IFRETURN_HELPURL="https://c2.com/cgi/wiki?GuardClause",e.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",e.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",e.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",e.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",e.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",e.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",e.Msg.REDO="Redo",e.Msg.REMOVE_COMMENT="Remove Comment",e.Msg.RENAME_VARIABLE="Rename variable...",e.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",e.Msg.SHORTCUTS_CODE_NAVIGATION="Code navigation",e.Msg.SHORTCUTS_EDITING="Editing",e.Msg.SHORTCUTS_GENERAL="General",e.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_APPEND_TITLE="to %1 append text %2",e.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",e.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",e.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",e.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",e.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",e.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",e.Msg.TEXT_CHARAT_FIRST="get first letter",e.Msg.TEXT_CHARAT_FROM_END="get letter # from end",e.Msg.TEXT_CHARAT_FROM_START="get letter #",e.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",e.Msg.TEXT_CHARAT_LAST="get last letter",e.Msg.TEXT_CHARAT_RANDOM="get random letter",e.Msg.TEXT_CHARAT_TAIL="",e.Msg.TEXT_CHARAT_TITLE="in text %1 %2",e.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",e.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",e.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",e.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",e.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",e.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",e.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",e.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",e.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",e.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",e.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",e.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",e.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",e.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",e.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",e.Msg.TEXT_GET_SUBSTRING_TAIL="",e.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",e.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",e.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",e.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",e.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",e.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",e.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",e.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",e.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",e.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",e.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",e.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",e.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",e.Msg.TEXT_LENGTH_TITLE="length of %1",e.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",e.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",e.Msg.TEXT_PRINT_TITLE="print %1",e.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",e.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",e.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",e.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",e.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",e.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",e.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",e.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",e.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",e.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",e.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",e.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",e.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",e.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",e.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",e.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",e.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",e.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",e.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",e.Msg.TODAY="Today",e.Msg.UNDO="Undo",e.Msg.UNKNOWN="Unknown",e.Msg.UNNAMED_KEY="unnamed",e.Msg.VARIABLES_DEFAULT_NAME="item",e.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",e.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",e.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",e.Msg.VARIABLES_SET="set %1 to %2",e.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",e.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",e.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",e.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",e.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",e.Msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER="A variable named '%1' already exists as a parameter in the procedure '%2'.",e.Msg.WINDOWS="Windows",e.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",e.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",e.Msg.CONTROLS_FOREACH_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_FOR_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=e.Msg.CONTROLS_IF_MSG_ELSEIF,e.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=e.Msg.CONTROLS_IF_MSG_ELSE,e.Msg.CONTROLS_IF_IF_TITLE_IF=e.Msg.CONTROLS_IF_MSG_IF,e.Msg.CONTROLS_IF_MSG_THEN=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=e.Msg.CONTROLS_REPEAT_INPUT_DO,e.Msg.LISTS_CREATE_WITH_ITEM_TITLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.LISTS_GET_INDEX_HELPURL=e.Msg.LISTS_INDEX_OF_HELPURL,e.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=e.Msg.LISTS_INLIST,e.Msg.MATH_CHANGE_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.PROCEDURES_DEFRETURN_COMMENT=e.Msg.PROCEDURES_DEFNORETURN_COMMENT,e.Msg.PROCEDURES_DEFRETURN_DO=e.Msg.PROCEDURES_DEFNORETURN_DO,e.Msg.PROCEDURES_DEFRETURN_PROCEDURE=e.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,e.Msg.PROCEDURES_DEFRETURN_TITLE=e.Msg.PROCEDURES_DEFNORETURN_TITLE,e.Msg.TEXT_APPEND_VARIABLE=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=e.Msg.VARIABLES_DEFAULT_NAME,e.Msg.MATH_HUE="230",e.Msg.LOOPS_HUE="120",e.Msg.LISTS_HUE="260",e.Msg.LOGIC_HUE="210",e.Msg.VARIABLES_HUE="330",e.Msg.TEXTS_HUE="160",e.Msg.PROCEDURES_HUE="290",e.Msg.COLOUR_HUE="20",e.Msg.VARIABLES_DYNAMIC_HUE="310",e.Msg}var o=this;if("function"==typeof define&&define.amd)define([],n);else if("object"==typeof i)t.exports=n();else{var r,s=n();for(r in s)o.Blockly.Msg[r]=s[r]}},{}],221:[function(e,t,i){var n=e("react-is"),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},d={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function h(e){return n.isMemo(e)?r:s[e.$$typeof]||o}s[n.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[n.Memo]=r;var p=Object.defineProperty,g=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols,m=Object.getOwnPropertyDescriptor,b=Object.getPrototypeOf,_=Object.prototype;t.exports=function e(t,i,n){if("string"!=typeof i){_&&(o=b(i))&&o!==_&&e(t,o,n);for(var o,r=g(i),s=(f&&(r=r.concat(f(i))),h(t)),a=h(i),l=0;l<r.length;++l){var c=r[l];if(!(d[c]||n&&n[c]||a&&a[c]||s&&s[c])){var u=m(i,c);try{p(t,c,u)}catch(e){}}}}return t}},{"react-is":235}],222:[function(e,t,i){var l=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable;t.exports=(()=>{try{if(Object.assign){var e=new String("abc");if(e[5]="de","5"!==Object.getOwnPropertyNames(e)[0]){for(var t={},i=0;i<10;i++)t["_"+String.fromCharCode(i)]=i;var n,o=Object.getOwnPropertyNames(t).map(function(e){return t[e]});if("0123456789"===o.join(""))return n={},"abcdefghijklmnopqrst".split("").forEach(function(e){n[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")?1:void 0}}}catch(e){}})()?Object.assign:function(e,t){for(var i,n=(e=>{if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)})(e),o=1;o<arguments.length;o++){for(var r in i=Object(arguments[o]))c.call(i,r)&&(n[r]=i[r]);if(l)for(var s=l(i),a=0;a<s.length;a++)u.call(i,s[a])&&(n[s[a]]=i[s[a]])}return n}},{}],223:[function(e,t,i){var n,o,t=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{o="function"==typeof clearTimeout?clearTimeout:s}catch(e){o=s}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===r||!n)&&setTimeout)return(n=setTimeout)(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}var l,c=[],u=!1,d=-1;function h(){u&&l&&(u=!1,l.length?c=l.concat(c):d=-1,c.length)&&p()}function p(){if(!u){for(var e=a(h),t=(u=!0,c.length);t;){for(l=c,c=[];++d<t;)l&&l[d].run();d=-1,t=c.length}l=null,u=!1,!function(t){if(o===clearTimeout)return clearTimeout(t);if((o===s||!o)&&clearTimeout)return(o=clearTimeout)(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function f(){}t.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];c.push(new g(e,t)),1!==c.length||u||a(p)},g.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=f,t.addListener=f,t.once=f,t.off=f,t.removeListener=f,t.removeAllListeners=f,t.emit=f,t.prependListener=f,t.prependOnceListener=f,t.listeners=function(e){return[]},t.binding=function(e){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(e){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},{}],224:[function(t,i,e){!function(h){!function(){var l,c,u,d=function(){};function e(e,t,i,n,o){if("production"!==h.env.NODE_ENV)for(var r in e)if(u(e,r)){var s,a;try{if("function"!=typeof e[r])throw(a=Error((n||"React class")+": "+i+" type `"+r+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[r]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.")).name="Invariant Violation",a;s=e[r](t,r,n,i,null,l)}catch(e){s=e}!s||s instanceof Error||d((n||"React class")+": type specification of "+i+" `"+r+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof s+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),s instanceof Error&&!(s.message in c)&&(c[s.message]=!0,r=o?o():"",d("Failed "+i+" type: "+s.message+(null!=r?r:"")))}}"production"!==h.env.NODE_ENV&&(l=t("./lib/ReactPropTypesSecret"),c={},u=t("./lib/has"),d=function(e){e="Warning: "+e;"undefined"!=typeof console&&console.error(e);try{throw new Error(e)}catch(e){}}),e.resetWarningCache=function(){"production"!==h.env.NODE_ENV&&(c={})},i.exports=e}.call(this)}.call(this,t("_process"))},{"./lib/ReactPropTypesSecret":228,"./lib/has":229,_process:223}],225:[function(e,t,i){var s=e("./lib/ReactPropTypesSecret");function n(){}function o(){}o.resetWarningCache=n,t.exports=function(){function e(e,t,i,n,o,r){if(r!==s)throw(r=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")).name="Invariant Violation",r}function t(){return e}var i={array:e.isRequired=e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:n};return i.PropTypes=i}},{"./lib/ReactPropTypesSecret":228}],226:[function(e,t,i){!function(v){!function(){var c=e("react-is"),m=e("object-assign"),b=e("./lib/ReactPropTypesSecret"),_=e("./lib/has"),n=e("./checkPropTypes"),y=function(){};function o(){return null}"production"!==v.env.NODE_ENV&&(y=function(e){e="Warning: "+e;"undefined"!=typeof console&&console.error(e);try{throw new Error(e)}catch(e){}}),t.exports=function(r,u){var s="function"==typeof Symbol&&Symbol.iterator,a="@@iterator";var d="<<anonymous>>",e={array:t("array"),bigint:t("bigint"),bool:t("boolean"),func:t("function"),number:t("number"),object:t("object"),string:t("string"),symbol:t("symbol"),any:i(o),arrayOf:function(l){return i(function(e,t,i,n,o){if("function"!=typeof l)return new h("Property `"+o+"` of component `"+i+"` has invalid PropType notation inside arrayOf.");var r=e[t];if(!Array.isArray(r))return new h("Invalid "+n+" `"+o+"` of type `"+g(r)+"` supplied to `"+i+"`, expected an array.");for(var s=0;s<r.length;s++){var a=l(r,s,i,n,o+"["+s+"]",b);if(a instanceof Error)return a}return null})},element:i(function(e,t,i,n,o){return e=e[t],r(e)?null:new h("Invalid "+n+" `"+o+"` of type `"+g(e)+"` supplied to `"+i+"`, expected a single ReactElement.")}),elementType:i(function(e,t,i,n,o){return e=e[t],c.isValidElementType(e)?null:new h("Invalid "+n+" `"+o+"` of type `"+g(e)+"` supplied to `"+i+"`, expected a single ReactElement type.")}),instanceOf:function(s){return i(function(e,t,i,n,o){var r;return e[t]instanceof s?null:(r=s.name||d,new h("Invalid "+n+" `"+o+"` of type `"+((n=e[t]).constructor&&n.constructor.name?n.constructor.name:d)+"` supplied to `"+i+"`, expected instance of `"+r+"`."))})},node:i(function(e,t,i,n,o){return l(e[t])?null:new h("Invalid "+n+" `"+o+"` supplied to `"+i+"`, expected a ReactNode.")}),objectOf:function(l){return i(function(e,t,i,n,o){if("function"!=typeof l)return new h("Property `"+o+"` of component `"+i+"` has invalid PropType notation inside objectOf.");var r,s=e[t];if("object"!==(e=g(s)))return new h("Invalid "+n+" `"+o+"` of type `"+e+"` supplied to `"+i+"`, expected an object.");for(r in s)if(_(s,r)){var a=l(s,r,i,n,o+"."+r,b);if(a instanceof Error)return a}return null})},oneOf:function(a){if(Array.isArray(a))return i(function(e,t,i,n,o){for(var r=e[t],s=0;s<a.length;s++)if(((e,t)=>e===t?0!==e||1/e==1/t:e!=e&&t!=t)(r,a[s]))return null;e=JSON.stringify(a,function(e,t){return"symbol"===f(t)?String(t):t});return new h("Invalid "+n+" `"+o+"` of value `"+String(r)+"` supplied to `"+i+"`, expected one of "+e+".")});"production"!==v.env.NODE_ENV&&y(1<arguments.length?"Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z]).":"Invalid argument supplied to oneOf, expected an array.");return o},oneOfType:function(l){if(!Array.isArray(l))return"production"!==v.env.NODE_ENV&&y("Invalid argument supplied to oneOfType, expected an instance of array."),o;for(var e=0;e<l.length;e++){var t=l[e];if("function"!=typeof t)return y("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+(e=>{var t=f(e);switch(t){case"array":case"object":return"an "+t;case"boolean":case"date":case"regexp":return"a "+t;default:return t}})(t)+" at index "+e+"."),o}return i(function(e,t,i,n,o){for(var r=[],s=0;s<l.length;s++){var a=(0,l[s])(e,t,i,n,o,b);if(null==a)return null;a.data&&_(a.data,"expectedType")&&r.push(a.data.expectedType)}return new h("Invalid "+n+" `"+o+"` supplied to `"+i+"`"+(0<r.length?", expected one of type ["+r.join(", ")+"]":"")+".")})},shape:function(l){return i(function(e,t,i,n,o){var r,s=e[t];if("object"!==(e=g(s)))return new h("Invalid "+n+" `"+o+"` of type `"+e+"` supplied to `"+i+"`, expected `object`.");for(r in l){var a=l[r];if("function"!=typeof a)return p(i,n,o,r,f(a));a=a(s,r,i,n,o+"."+r,b);if(a)return a}return null})},exact:function(c){return i(function(e,t,i,n,o){var r,s=e[t],a=g(s);if("object"!==a)return new h("Invalid "+n+" `"+o+"` of type `"+a+"` supplied to `"+i+"`, expected `object`.");for(r in m({},e[t],c)){var l=c[r];if(_(c,r)&&"function"!=typeof l)return p(i,n,o,r,f(l));if(!l)return new h("Invalid "+n+" `"+o+"` key `"+r+"` supplied to `"+i+"`.\nBad object: "+JSON.stringify(e[t],null,"  ")+"\nValid keys: "+JSON.stringify(Object.keys(c),null,"  "));l=l(s,r,i,n,o+"."+r,b);if(l)return l}return null})}};function h(e,t){this.message=e,this.data=t&&"object"==typeof t?t:{},this.stack=""}function i(a){var l,c;function e(e,t,i,n,o,r,s){if(n=n||d,r=r||i,s!==b){if(u)throw(s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types")).name="Invariant Violation",s;"production"!==v.env.NODE_ENV&&"undefined"!=typeof console&&!l[s=n+":"+i]&&c<3&&(y("You are manually calling a React.PropTypes validation function for the `"+r+"` prop on `"+n+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),l[s]=!0,c++)}return null==t[i]?e?null===t[i]?new h("The "+o+" `"+r+"` is marked as required in `"+n+"`, but its value is `null`."):new h("The "+o+" `"+r+"` is marked as required in `"+n+"`, but its value is `undefined`."):null:a(t,i,n,o,r)}"production"!==v.env.NODE_ENV&&(l={},c=0);var t=e.bind(null,!1);return t.isRequired=e.bind(null,!0),t}function t(s){return i(function(e,t,i,n,o,r){return g(e=e[t])!==s?new h("Invalid "+n+" `"+o+"` of type `"+f(e)+"` supplied to `"+i+"`, expected `"+s+"`.",{expectedType:s}):null})}function p(e,t,i,n,o){return new h((e||"React class")+": "+t+" type `"+i+"."+n+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+o+"`.")}function l(e){switch(typeof e){case"number":case"string":case"undefined":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(l);if(null!==e&&!r(e)){var t=(e=>{if("function"==typeof(e=e&&(s&&e[s]||e[a])))return e})(e);if(!t)return!1;var i,n=t.call(e);if(t!==e.entries){for(;!(i=n.next()).done;)if(!l(i.value))return!1}else for(;!(i=n.next()).done;){var o=i.value;if(o&&!l(o[1]))return!1}}return!0;default:return!1}}function g(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":(e=e,"symbol"===t||e&&("Symbol"===e["@@toStringTag"]||"function"==typeof Symbol&&e instanceof Symbol)?"symbol":t)}function f(e){if(null==e)return""+e;var t=g(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}return h.prototype=Error.prototype,e.checkPropTypes=n,e.resetWarningCache=n.resetWarningCache,e.PropTypes=e}}.call(this)}.call(this,e("_process"))},{"./checkPropTypes":224,"./lib/ReactPropTypesSecret":228,"./lib/has":229,_process:223,"object-assign":222,"react-is":235}],227:[function(i,n,e){!function(t){!function(){var e;"production"!==t.env.NODE_ENV?(e=i("react-is"),n.exports=i("./factoryWithTypeCheckers")(e.isElement,!0)):n.exports=i("./factoryWithThrowingShims")()}.call(this)}.call(this,i("_process"))},{"./factoryWithThrowingShims":225,"./factoryWithTypeCheckers":226,_process:223,"react-is":235}],228:[function(e,t,i){t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},{}],229:[function(e,t,i){t.exports=Function.call.bind(Object.prototype.hasOwnProperty)},{}],230:[function(yy,e,vy){!function(_y){!function(){if("production"!==_y.env.NODE_ENV){var c=yy("react"),T=yy("object-assign"),a=yy("scheduler"),u=yy("scheduler/tracing"),d=c.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function p(e){for(var t=arguments.length,i=new Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];w("warn",e,i)}function ee(e){for(var t=arguments.length,i=new Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];w("error",e,i)}function w(e,t,i){var n=d.ReactDebugCurrentFrame.getStackAddendum(),n=(""!==n&&(t+="%s",i=i.concat([n])),i.map(function(e){return""+e}));n.unshift("Warning: "+t),Function.prototype.apply.call(console[e],console,n)}if(!c)throw Error("ReactDOM was loaded before React. Make sure you load the React package before loading ReactDOM.");var te=0,ie=1,K=2,F=3,ne=4,U=5,oe=6,le=7,X=8,q=9,J=10,re=11,Z=12,H=13,Q=14,ce=15,ue=16,de=17,S=18,he=19,pe=20,ge=21,fe=22,me=23,be=24,x=!0,R=!1,O=!1,A=new Set,N={},L={};function D(e,t){i(e,t),i(e+"Capture",t)}function i(e,t){N[e]&&ee("EventRegistry: More than one plugin attempted to publish the same registration name, `%s`.",e),N[e]=t;var i=e.toLowerCase();"onDoubleClick"===(L[i]=e)&&(L.ondblclick=e);for(var n=0;n<t.length;n++)A.add(t[n])}var t=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),M=0,$=3,P=4,B=5,_e=6,n=(e=":A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD")+"\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",ye="data-reactroot",ve=new RegExp("^["+e+"]["+n+"]*$"),Te=Object.prototype.hasOwnProperty,Ee={},ke={};function Ce(e){if(Te.call(ke,e))return 1;if(!Te.call(Ee,e)){if(ve.test(e))return ke[e]=!0;Ee[e]=!0,ee("Invalid attribute name: `%s`",e)}}function Ie(e,t,i){return null!==t?t.type===M:!i&&2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])}function we(e,t,i,n){if(null===i||i.type!==M)switch(typeof t){case"function":case"symbol":return 1;case"boolean":var o;return n?void 0:null!==i?!i.acceptsBooleans:"data-"!==(o=e.toLowerCase().slice(0,5))&&"aria-"!==o;default:return}}function Se(e,t,i,n){if(null==t)return 1;if(we(e,t,i,n))return 1;if(!n&&null!==i)switch(i.type){case $:return!t;case P:return!1===t;case B:return isNaN(t);case _e:return isNaN(t)||t<1}}function xe(e){return Ae.hasOwnProperty(e)?Ae[e]:null}function Re(e,t,i,n,o,r,s){this.acceptsBooleans=2===t||t===$||t===P,this.attributeName=n,this.attributeNamespace=o,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=r,this.removeEmptyString=s}function Oe(e){return e[1].toUpperCase()}var Ae={},Ne=(["children","dangerouslySetInnerHTML","defaultValue","defaultChecked","innerHTML","suppressContentEditableWarning","suppressHydrationWarning","style"].forEach(function(e){Ae[e]=new Re(e,M,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Ae[t]=new Re(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ae[e]=new Re(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ae[e]=new Re(e,2,!1,e,null,!1,!1)}),["allowFullScreen","async","autoFocus","autoPlay","controls","default","defer","disabled","disablePictureInPicture","disableRemotePlayback","formNoValidate","hidden","loop","noModule","noValidate","open","playsInline","readOnly","required","reversed","scoped","seamless","itemScope"].forEach(function(e){Ae[e]=new Re(e,$,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){Ae[e]=new Re(e,$,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){Ae[e]=new Re(e,P,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){Ae[e]=new Re(e,_e,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){Ae[e]=new Re(e,B,!1,e.toLowerCase(),null,!1,!1)}),/[\-\:]([a-z])/g),Le=(["accent-height","alignment-baseline","arabic-form","baseline-shift","cap-height","clip-path","clip-rule","color-interpolation","color-interpolation-filters","color-profile","color-rendering","dominant-baseline","enable-background","fill-opacity","fill-rule","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","glyph-name","glyph-orientation-horizontal","glyph-orientation-vertical","horiz-adv-x","horiz-origin-x","image-rendering","letter-spacing","lighting-color","marker-end","marker-mid","marker-start","overline-position","overline-thickness","paint-order","panose-1","pointer-events","rendering-intent","shape-rendering","stop-color","stop-opacity","strikethrough-position","strikethrough-thickness","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-anchor","text-decoration","text-rendering","underline-position","underline-thickness","unicode-bidi","unicode-range","units-per-em","v-alphabetic","v-hanging","v-ideographic","v-mathematical","vector-effect","vert-adv-y","vert-origin-x","vert-origin-y","word-spacing","writing-mode","xmlns:xlink","x-height"].forEach(function(e){var t=e.replace(Ne,Oe);Ae[t]=new Re(t,1,!1,e,null,!1,!1)}),["xlink:actuate","xlink:arcrole","xlink:role","xlink:show","xlink:title","xlink:type"].forEach(function(e){var t=e.replace(Ne,Oe);Ae[t]=new Re(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ne,Oe);Ae[t]=new Re(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){Ae[e]=new Re(e,1,!1,e.toLowerCase(),null,!1,!1)}),Ae.xlinkHref=new Re("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){Ae[e]=new Re(e,1,!1,e.toLowerCase(),null,!0,!0)}),/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*\:/i),De=!1;function Me(e){!De&&Le.test(e)&&(De=!0,ee("A future version of React will block javascript: URLs as a security precaution. Use event handlers instead if you can. If you need to generate unsafe HTML try using dangerouslySetInnerHTML instead. React was passed %s.",JSON.stringify(e)))}function $e(e,t,i){var n;if(Ce(t))return null!==(n=i)&&"object"==typeof n&&n.$$typeof===Je?i:e.hasAttribute(t)?(n=e.getAttribute(t))===""+i?i:n:void 0===i?void 0:null}function Pe(e,t,i,n){var o,r,s=xe(t);Ie(t,s,n)||(Se(t,i,s,n)&&(i=null),n||null===s?Ce(t)&&(n=t,null===i?e.removeAttribute(n):e.setAttribute(n,""+i)):s.mustUseProperty?(t=s.propertyName,null===i?(n=s.type,e[t]=n!==$&&""):e[t]=i):(n=s.attributeName,t=s.attributeNamespace,null===i?e.removeAttribute(n):((o=s.type)===$||o===P&&!0===i?r="":(r=""+i,s.sanitizeURL&&Me(r.toString())),t?e.setAttributeNS(t,n,r):e.setAttribute(n,r))))}var Be=60103,Fe=60106,Ue=60107,He=60108,Ge=60114,Ve=60109,je=60110,We=60112,ze=60113,Ye=60120,Ke=60115,Xe=60116,qe=60121,Je=60128,Ze=60129,Qe=60130,et=60131,tt=("function"==typeof Symbol&&Symbol.for&&(Be=(e=Symbol.for)("react.element"),Fe=e("react.portal"),Ue=e("react.fragment"),He=e("react.strict_mode"),Ge=e("react.profiler"),Ve=e("react.provider"),je=e("react.context"),We=e("react.forward_ref"),ze=e("react.suspense"),Ye=e("react.suspense_list"),Ke=e("react.memo"),Xe=e("react.lazy"),qe=e("react.block"),e("react.server.block"),e("react.fundamental"),e("react.scope"),Je=e("react.opaque.id"),Ze=e("react.debug_trace_mode"),Qe=e("react.offscreen"),et=e("react.legacy_hidden")),"function"==typeof Symbol&&Symbol.iterator),it="@@iterator";function nt(e){return null!==e&&"object"==typeof e&&"function"==typeof(e=tt&&e[tt]||e[it])?e:null}var ot,rt,st,at,lt,ct,ut,dt=0;function ht(){}function pt(){var e;0===dt&&(ot=console.log,rt=console.info,st=console.warn,at=console.error,lt=console.group,ct=console.groupCollapsed,ut=console.groupEnd,e={configurable:!0,enumerable:!0,value:ht,writable:!0},Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})),dt++}function gt(){var e;0===--dt&&(e={configurable:!0,enumerable:!0,writable:!0},Object.defineProperties(console,{log:T({},e,{value:ot}),info:T({},e,{value:rt}),warn:T({},e,{value:st}),error:T({},e,{value:at}),group:T({},e,{value:lt}),groupCollapsed:T({},e,{value:ct}),groupEnd:T({},e,{value:ut})})),dt<0&&ee("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}var ft,mt=d.ReactCurrentDispatcher;function bt(e){if(void 0===ft)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);ft=t&&t[1]||""}return"\n"+ft+e}var _t=!(ht.__reactDisabledLog=!0),yt=new("function"==typeof WeakMap?WeakMap:Map);function vt(t,e){if(!t||_t)return"";var i,n=yt.get(t);if(void 0!==n)return n;_t=!0;var o,n=Error.prepareStackTrace;Error.prepareStackTrace=void 0,o=mt.current,mt.current=null,pt();try{if(e){var r=function(){throw Error()};if(Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(r,[])}catch(e){i=e}Reflect.construct(t,[],r)}else{try{r.call()}catch(e){i=e}t.call(r.prototype)}}else{try{throw Error()}catch(e){i=e}t()}}catch(e){if(e&&i&&"string"==typeof e.stack){for(var s,a=e.stack.split("\n"),l=i.stack.split("\n"),c=a.length-1,u=l.length-1;1<=c&&0<=u&&a[c]!==l[u];)u--;for(;1<=c&&0<=u;c--,u--)if(a[c]!==l[u]){if(1!==c||1!==u)do{if(c--,--u<0||a[c]!==l[u])return s="\n"+a[c].replace(" at new "," at "),"function"==typeof t&&yt.set(t,s),s}while(1<=c&&0<=u);break}}}finally{_t=!1,mt.current=o,gt(),Error.prepareStackTrace=n}e=t?t.displayName||t.name:"",r=e?bt(e):"";return"function"==typeof t&&yt.set(t,r),r}function Tt(e){return vt(e,!1)}function Et(e){e._debugOwner&&e._debugOwner.type;switch(e.tag){case U:return bt(e.type);case ue:return bt("Lazy");case H:return bt("Suspense");case he:return bt("SuspenseList");case te:case K:case ce:return Tt(e.type);case re:return Tt(e.type.render);case fe:return Tt(e.type._render);case ie:return vt(e.type,!0);default:return""}}function kt(e){try{for(var t="",i=e;t+=Et(i),i=i.return;);return t}catch(e){return"\nError generating stack: "+e.message+"\n"+e.stack}}function Ct(e){return e.displayName||"Context"}function se(e){if(null!=e){if("number"==typeof e.tag&&ee("Received an unexpected object in getComponentName(). This is likely a bug in React. Please file an issue."),"function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case Ue:return"Fragment";case Fe:return"Portal";case Ge:return"Profiler";case He:return"StrictMode";case ze:return"Suspense";case Ye:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case je:return Ct(e)+".Consumer";case Ve:return Ct(e._context)+".Provider";case We:return t=e.render,i="ForwardRef",t=t.displayName||t.name||"",e.displayName||(""!==t?i+"("+t+")":i);case Ke:return se(e.type);case qe:return se(e._render);case Xe:t=e._payload,i=e._init;try{return se(i(t))}catch(e){return null}}var t,i}return null}var It=d.ReactDebugCurrentFrame,wt=null,St=!1;function xt(){var e;return null!==wt&&null!=(e=wt._debugOwner)?se(e.type):null}function Rt(){return null===wt?"":kt(wt)}function Ot(){It.getCurrentStack=null,wt=null,St=!1}function f(e){It.getCurrentStack=Rt,wt=e,St=!1}function At(e){St=e}function Nt(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}var Lt={button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0};function Dt(e,t){Lt[t.type]||t.onChange||t.onInput||t.readOnly||t.disabled||null==t.value||ee("You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`."),t.onChange||t.readOnly||t.disabled||null==t.checked||ee("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")}function Mt(e){var t=e.type,e=e.nodeName;return e&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function $t(e){return e._valueTracker}function Pt(e){$t(e)||(e._valueTracker=(e=>{var t,i,n=Mt(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),r=""+e[n];if(!e.hasOwnProperty(n)&&void 0!==o&&"function"==typeof o.get&&"function"==typeof o.set)return t=o.get,i=o.set,Object.defineProperty(e,n,{configurable:!0,get:function(){return t.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,n,{enumerable:o.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[n]}}})(e))}function Bt(e){var t,i,n;if(e)return(t=$t(e))?(i=t.getValue(),n="",(e=n=(e=e)?Mt(e)?e.checked?"true":"false":e.value:n)!==i&&(t.setValue(e),1)):1}function Ft(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}var Ut=!1,Ht=!1,Gt=!1,Vt=!1;function jt(e){return"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}function Wt(e,t){var i=t.checked;return T({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:e._wrapperState.initialChecked})}function zt(e,t){Dt(0,t),void 0===t.checked||void 0===t.defaultChecked||Ht||(ee("%s contains an input of type %s with both checked and defaultChecked props. Input elements must be either controlled or uncontrolled (specify either the checked prop, or the defaultChecked prop, but not both). Decide between using a controlled or uncontrolled input element and remove one of these props. More info: https://reactjs.org/link/controlled-components",xt()||"A component",t.type),Ht=!0),void 0===t.value||void 0===t.defaultValue||Ut||(ee("%s contains an input of type %s with both value and defaultValue props. Input elements must be either controlled or uncontrolled (specify either the value prop, or the defaultValue prop, but not both). Decide between using a controlled or uncontrolled input element and remove one of these props. More info: https://reactjs.org/link/controlled-components",xt()||"A component",t.type),Ut=!0);var i=null==t.defaultValue?"":t.defaultValue;e._wrapperState={initialChecked:null!=t.checked?t.checked:t.defaultChecked,initialValue:Nt(null!=t.value?t.value:i),controlled:jt(t)}}function Yt(e,t){t=t.checked;null!=t&&Pe(e,"checked",t,!1)}function Kt(e,t){var i=e,n=jt(t),n=(i._wrapperState.controlled||!n||Vt||(ee("A component is changing an uncontrolled input to be controlled. This is likely caused by the value changing from undefined to a defined value, which should not happen. Decide between using a controlled or uncontrolled input element for the lifetime of the component. More info: https://reactjs.org/link/controlled-components"),Vt=!0),!i._wrapperState.controlled||n||Gt||(ee("A component is changing a controlled input to be uncontrolled. This is likely caused by the value changing from a defined to undefined, which should not happen. Decide between using a controlled or uncontrolled input element for the lifetime of the component. More info: https://reactjs.org/link/controlled-components"),Gt=!0),Yt(e,t),Nt(t.value)),e=t.type;if(null!=n)"number"===e?(0===n&&""===i.value||i.value!=n)&&(i.value=""+n):i.value!==""+n&&(i.value=""+n);else if("submit"===e||"reset"===e)return void i.removeAttribute("value");t.hasOwnProperty("value")?Jt(i,t.type,n):t.hasOwnProperty("defaultValue")&&Jt(i,t.type,Nt(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(i.defaultChecked=!!t.defaultChecked)}function Xt(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(("submit"===n||"reset"===n)&&null==t.value)return;n=""+e._wrapperState.initialValue;i||n!==e.value&&(e.value=n),e.defaultValue=n}t=e.name;""!==t&&(e.name=""),e.defaultChecked=!e.defaultChecked,e.defaultChecked=!!e._wrapperState.initialChecked,""!==t&&(e.name=t)}function qt(e,t){Kt(e,t);var i=e,e=t,t=e.name;if("radio"===e.type&&null!=t){for(var n=i;n.parentNode;)n=n.parentNode;for(var o=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),r=0;r<o.length;r++){var s=o[r];if(s!==i&&s.form===i.form){var a=Mc(s);if(!a)throw Error("ReactDOMInput: Mixing React and non-React radio inputs with the same `name` is not supported.");Bt(s),Kt(s,a)}}}}function Jt(e,t,i){"number"===t&&Ft(e.ownerDocument)===e||(null==i?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}var Zt=!1,Qt=!1;function ei(e,t){"object"==typeof t.children&&null!==t.children&&c.Children.forEach(t.children,function(e){null==e||"string"==typeof e||"number"==typeof e||"string"!=typeof e.type||Qt||(Qt=!0,ee("Only strings and numbers are supported as <option> children."))}),null==t.selected||Zt||(ee("Use the `defaultValue` or `value` props on <select> instead of setting `selected` on <option>."),Zt=!0)}function ti(e,t){var i,n=T({children:void 0},t),t=(t=t.children,i="",c.Children.forEach(t,function(e){null!=e&&(i+=e)}),i);return t&&(n.children=t),n}function ii(){var e=xt();return e?"\n\nCheck the render method of `"+e+"`.":""}var ni=!1,oi=["value","defaultValue"];function ri(e,t,i,n){var o=e.options;if(t){for(var r=i,s={},a=0;a<r.length;a++)s["$"+r[a]]=!0;for(var l=0;l<o.length;l++){var c=s.hasOwnProperty("$"+o[l].value);o[l].selected!==c&&(o[l].selected=c),c&&n&&(o[l].defaultSelected=!0)}}else{for(var u=""+Nt(i),d=null,h=0;h<o.length;h++){if(o[h].value===u)return o[h].selected=!0,void(n&&(o[h].defaultSelected=!0));null!==d||o[h].disabled||(d=o[h])}null!==d&&(d.selected=!0)}}function si(e,t){return T({},t,{value:void 0})}function ai(e,t){var i=t;Dt(0,i);for(var n=0;n<oi.length;n++){var o,r=oi[n];null!=i[r]&&(o=Array.isArray(i[r]),i.multiple&&!o?ee("The `%s` prop supplied to <select> must be an array if `multiple` is true.%s",r,ii()):!i.multiple&&o&&ee("The `%s` prop supplied to <select> must be a scalar value if `multiple` is false.%s",r,ii()))}e._wrapperState={wasMultiple:!!t.multiple},void 0===t.value||void 0===t.defaultValue||ni||(ee("Select elements must be either controlled or uncontrolled (specify either the value prop, or the defaultValue prop, but not both). Decide between using a controlled or uncontrolled select element and remove one of these props. More info: https://reactjs.org/link/controlled-components"),ni=!0)}var li=!1;function ci(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error("`dangerouslySetInnerHTML` does not make sense on <textarea>.");return T({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ui(e,t){Dt(0,t),void 0===t.value||void 0===t.defaultValue||li||(ee("%s contains a textarea with both value and defaultValue props. Textarea elements must be either controlled or uncontrolled (specify either the value prop, or the defaultValue prop, but not both). Decide between using a controlled or uncontrolled textarea and remove one of these props. More info: https://reactjs.org/link/controlled-components",xt()||"A component"),li=!0);var i=t.value;if(null==i){var n=t.children,t=t.defaultValue;if(null!=n){if(ee("Use the `defaultValue` or `value` props instead of setting children on <textarea>."),null!=t)throw Error("If you supply `defaultValue` on a <textarea>, do not pass children.");if(Array.isArray(n)){if(!(n.length<=1))throw Error("<textarea> can only have at most one child.");n=n[0]}t=n}i=t=null==t?"":t}e._wrapperState={initialValue:Nt(i)}}function di(e,t){var i=Nt(t.value),n=Nt(t.defaultValue);null!=i&&((i=""+i)!==e.value&&(e.value=i),null==t.defaultValue)&&e.defaultValue!==i&&(e.defaultValue=i),null!=n&&(e.defaultValue=""+n)}function hi(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var pi="http://www.w3.org/1999/xhtml",gi="http://www.w3.org/1998/Math/MathML",fi="http://www.w3.org/2000/svg",e=pi,mi=fi;function bi(e){switch(e){case"svg":return fi;case"math":return gi;default:return pi}}function _i(e,t){return null==e||e===pi?bi(t):e===fi&&"foreignObject"===t?pi:e}vi=function(e,t){if(e.namespaceURI!==mi||"innerHTML"in e)e.innerHTML=t;else{(yi=yi||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>";for(var i=yi.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;i.firstChild;)e.appendChild(i.firstChild)}};var yi,vi,Ti="undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,i,n){MSApp.execUnsafeLocalFunction(function(){return vi(e,t,i,n)})}:vi,Ei=1,ki=3,Ci=8,Ii=9,wi=11,Si=function(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&i.nodeType===ki)return void(i.nodeValue=t)}e.textContent=t},xi={animation:["animationDelay","animationDirection","animationDuration","animationFillMode","animationIterationCount","animationName","animationPlayState","animationTimingFunction"],background:["backgroundAttachment","backgroundClip","backgroundColor","backgroundImage","backgroundOrigin","backgroundPositionX","backgroundPositionY","backgroundRepeat","backgroundSize"],backgroundPosition:["backgroundPositionX","backgroundPositionY"],border:["borderBottomColor","borderBottomStyle","borderBottomWidth","borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth","borderLeftColor","borderLeftStyle","borderLeftWidth","borderRightColor","borderRightStyle","borderRightWidth","borderTopColor","borderTopStyle","borderTopWidth"],borderBlockEnd:["borderBlockEndColor","borderBlockEndStyle","borderBlockEndWidth"],borderBlockStart:["borderBlockStartColor","borderBlockStartStyle","borderBlockStartWidth"],borderBottom:["borderBottomColor","borderBottomStyle","borderBottomWidth"],borderColor:["borderBottomColor","borderLeftColor","borderRightColor","borderTopColor"],borderImage:["borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth"],borderInlineEnd:["borderInlineEndColor","borderInlineEndStyle","borderInlineEndWidth"],borderInlineStart:["borderInlineStartColor","borderInlineStartStyle","borderInlineStartWidth"],borderLeft:["borderLeftColor","borderLeftStyle","borderLeftWidth"],borderRadius:["borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius"],borderRight:["borderRightColor","borderRightStyle","borderRightWidth"],borderStyle:["borderBottomStyle","borderLeftStyle","borderRightStyle","borderTopStyle"],borderTop:["borderTopColor","borderTopStyle","borderTopWidth"],borderWidth:["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth"],columnRule:["columnRuleColor","columnRuleStyle","columnRuleWidth"],columns:["columnCount","columnWidth"],flex:["flexBasis","flexGrow","flexShrink"],flexFlow:["flexDirection","flexWrap"],font:["fontFamily","fontFeatureSettings","fontKerning","fontLanguageOverride","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontVariantAlternates","fontVariantCaps","fontVariantEastAsian","fontVariantLigatures","fontVariantNumeric","fontVariantPosition","fontWeight","lineHeight"],fontVariant:["fontVariantAlternates","fontVariantCaps","fontVariantEastAsian","fontVariantLigatures","fontVariantNumeric","fontVariantPosition"],gap:["columnGap","rowGap"],grid:["gridAutoColumns","gridAutoFlow","gridAutoRows","gridTemplateAreas","gridTemplateColumns","gridTemplateRows"],gridArea:["gridColumnEnd","gridColumnStart","gridRowEnd","gridRowStart"],gridColumn:["gridColumnEnd","gridColumnStart"],gridColumnGap:["columnGap"],gridGap:["columnGap","rowGap"],gridRow:["gridRowEnd","gridRowStart"],gridRowGap:["rowGap"],gridTemplate:["gridTemplateAreas","gridTemplateColumns","gridTemplateRows"],listStyle:["listStyleImage","listStylePosition","listStyleType"],margin:["marginBottom","marginLeft","marginRight","marginTop"],marker:["markerEnd","markerMid","markerStart"],mask:["maskClip","maskComposite","maskImage","maskMode","maskOrigin","maskPositionX","maskPositionY","maskRepeat","maskSize"],maskPosition:["maskPositionX","maskPositionY"],outline:["outlineColor","outlineStyle","outlineWidth"],overflow:["overflowX","overflowY"],padding:["paddingBottom","paddingLeft","paddingRight","paddingTop"],placeContent:["alignContent","justifyContent"],placeItems:["alignItems","justifyItems"],placeSelf:["alignSelf","justifySelf"],textDecoration:["textDecorationColor","textDecorationLine","textDecorationStyle"],textEmphasis:["textEmphasisColor","textEmphasisStyle"],transition:["transitionDelay","transitionDuration","transitionProperty","transitionTimingFunction"],wordWrap:["overflowWrap"]},Ri={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Oi=["Webkit","ms","Moz","O"];function Ai(e,t,i){return null==t||"boolean"==typeof t||""===t?"":i||"number"!=typeof t||0===t||Ri.hasOwnProperty(e)&&Ri[e]?(""+t).trim():t+"px"}Object.keys(Ri).forEach(function(t){Oi.forEach(function(e){Ri[e+(e=t).charAt(0).toUpperCase()+e.substring(1)]=Ri[t]})});var Ni=/([A-Z])/g,Li=/^ms-/,Di=/^(?:webkit|moz|o)[A-Z]/,Mi=/^-ms-/,$i=/-(.)/g,Pi=/;\s*$/,Bi={},Fi={},Ui=!1,Hi=!1,Gi=function(e){return e.replace($i,function(e,t){return t.toUpperCase()})},Vi=function(e,t){var i,n,o;-1<e.indexOf("-")?(i=e,Bi.hasOwnProperty(i)&&Bi[i]||(Bi[i]=!0,ee("Unsupported style property %s. Did you mean %s?",i,Gi(i.replace(Mi,"ms-"))))):Di.test(e)?(i=e,Bi.hasOwnProperty(i)&&Bi[i]||(Bi[i]=!0,ee("Unsupported vendor-prefixed style property %s. Did you mean %s?",i,i.charAt(0).toUpperCase()+i.slice(1)))):Pi.test(t)&&(o=e,n=t,Fi.hasOwnProperty(n)&&Fi[n]||(Fi[n]=!0,ee('Style property values shouldn\'t contain a semicolon. Try "%s: %s" instead.',o,n.replace(Pi,"")))),"number"==typeof t&&(isNaN(t)?(o=e,Ui||(Ui=!0,ee("`NaN` is an invalid value for the `%s` css style property.",o))):isFinite(t)||(n=e,Hi)||(Hi=!0,ee("`Infinity` is an invalid value for the `%s` css style property.",n)))};function ji(e){var t,i,n,o="",r="";for(t in e)e.hasOwnProperty(t)&&null!=(i=e[t])&&(o=(o+=r+((n=0===t.indexOf("--"))?t:t.replace(Ni,"-$1").toLowerCase().replace(Li,"-ms-"))+":")+Ai(t,i,n),r=";");return o||null}function Wi(e,t){var i,n,o,r=e.style;for(i in t)t.hasOwnProperty(i)&&((n=0===i.indexOf("--"))||Vi(i,t[i]),o=Ai(i,t[i],n),"float"===i&&(i="cssFloat"),n?r.setProperty(i,o):r[i]=o)}function zi(e){var t,i={};for(t in e)for(var n=xi[t]||[t],o=0;o<n.length;o++)i[n[o]]=t;return i}var Yi=T({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),Ki="__html";function Xi(e,t){if(t){if(Yi[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(e+" is a void element tag and must neither have `children` nor use `dangerouslySetInnerHTML`.");if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error("Can only set one of `children` or `props.dangerouslySetInnerHTML`.");if(!("object"==typeof t.dangerouslySetInnerHTML&&Ki in t.dangerouslySetInnerHTML))throw Error("`props.dangerouslySetInnerHTML` must be in the form `{__html: ...}`. Please visit https://reactjs.org/link/dangerously-set-inner-html for more information.")}if(!t.suppressContentEditableWarning&&t.contentEditable&&null!=t.children&&ee("A component is `contentEditable` and contains `children` managed by React. It is now your responsibility to guarantee that none of those nodes are unexpectedly modified or duplicated. This is probably not intentional."),null!=t.style&&"object"!=typeof t.style)throw Error("The `style` prop expects a mapping from style properties to values, not a string. For example, style={{marginRight: spacing + 'em'}} when using JSX.")}}function qi(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ji={accept:"accept",acceptcharset:"acceptCharset","accept-charset":"acceptCharset",accesskey:"accessKey",action:"action",allowfullscreen:"allowFullScreen",alt:"alt",as:"as",async:"async",autocapitalize:"autoCapitalize",autocomplete:"autoComplete",autocorrect:"autoCorrect",autofocus:"autoFocus",autoplay:"autoPlay",autosave:"autoSave",capture:"capture",cellpadding:"cellPadding",cellspacing:"cellSpacing",challenge:"challenge",charset:"charSet",checked:"checked",children:"children",cite:"cite",class:"className",classid:"classID",classname:"className",cols:"cols",colspan:"colSpan",content:"content",contenteditable:"contentEditable",contextmenu:"contextMenu",controls:"controls",controlslist:"controlsList",coords:"coords",crossorigin:"crossOrigin",dangerouslysetinnerhtml:"dangerouslySetInnerHTML",data:"data",datetime:"dateTime",default:"default",defaultchecked:"defaultChecked",defaultvalue:"defaultValue",defer:"defer",dir:"dir",disabled:"disabled",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback",download:"download",draggable:"draggable",enctype:"encType",enterkeyhint:"enterKeyHint",for:"htmlFor",form:"form",formmethod:"formMethod",formaction:"formAction",formenctype:"formEncType",formnovalidate:"formNoValidate",formtarget:"formTarget",frameborder:"frameBorder",headers:"headers",height:"height",hidden:"hidden",high:"high",href:"href",hreflang:"hrefLang",htmlfor:"htmlFor",httpequiv:"httpEquiv","http-equiv":"httpEquiv",icon:"icon",id:"id",innerhtml:"innerHTML",inputmode:"inputMode",integrity:"integrity",is:"is",itemid:"itemID",itemprop:"itemProp",itemref:"itemRef",itemscope:"itemScope",itemtype:"itemType",keyparams:"keyParams",keytype:"keyType",kind:"kind",label:"label",lang:"lang",list:"list",loop:"loop",low:"low",manifest:"manifest",marginwidth:"marginWidth",marginheight:"marginHeight",max:"max",maxlength:"maxLength",media:"media",mediagroup:"mediaGroup",method:"method",min:"min",minlength:"minLength",multiple:"multiple",muted:"muted",name:"name",nomodule:"noModule",nonce:"nonce",novalidate:"noValidate",open:"open",optimum:"optimum",pattern:"pattern",placeholder:"placeholder",playsinline:"playsInline",poster:"poster",preload:"preload",profile:"profile",radiogroup:"radioGroup",readonly:"readOnly",referrerpolicy:"referrerPolicy",rel:"rel",required:"required",reversed:"reversed",role:"role",rows:"rows",rowspan:"rowSpan",sandbox:"sandbox",scope:"scope",scoped:"scoped",scrolling:"scrolling",seamless:"seamless",selected:"selected",shape:"shape",size:"size",sizes:"sizes",span:"span",spellcheck:"spellCheck",src:"src",srcdoc:"srcDoc",srclang:"srcLang",srcset:"srcSet",start:"start",step:"step",style:"style",summary:"summary",tabindex:"tabIndex",target:"target",title:"title",type:"type",usemap:"useMap",value:"value",width:"width",wmode:"wmode",wrap:"wrap",about:"about",accentheight:"accentHeight","accent-height":"accentHeight",accumulate:"accumulate",additive:"additive",alignmentbaseline:"alignmentBaseline","alignment-baseline":"alignmentBaseline",allowreorder:"allowReorder",alphabetic:"alphabetic",amplitude:"amplitude",arabicform:"arabicForm","arabic-form":"arabicForm",ascent:"ascent",attributename:"attributeName",attributetype:"attributeType",autoreverse:"autoReverse",azimuth:"azimuth",basefrequency:"baseFrequency",baselineshift:"baselineShift","baseline-shift":"baselineShift",baseprofile:"baseProfile",bbox:"bbox",begin:"begin",bias:"bias",by:"by",calcmode:"calcMode",capheight:"capHeight","cap-height":"capHeight",clip:"clip",clippath:"clipPath","clip-path":"clipPath",clippathunits:"clipPathUnits",cliprule:"clipRule","clip-rule":"clipRule",color:"color",colorinterpolation:"colorInterpolation","color-interpolation":"colorInterpolation",colorinterpolationfilters:"colorInterpolationFilters","color-interpolation-filters":"colorInterpolationFilters",colorprofile:"colorProfile","color-profile":"colorProfile",colorrendering:"colorRendering","color-rendering":"colorRendering",contentscripttype:"contentScriptType",contentstyletype:"contentStyleType",cursor:"cursor",cx:"cx",cy:"cy",d:"d",datatype:"datatype",decelerate:"decelerate",descent:"descent",diffuseconstant:"diffuseConstant",direction:"direction",display:"display",divisor:"divisor",dominantbaseline:"dominantBaseline","dominant-baseline":"dominantBaseline",dur:"dur",dx:"dx",dy:"dy",edgemode:"edgeMode",elevation:"elevation",enablebackground:"enableBackground","enable-background":"enableBackground",end:"end",exponent:"exponent",externalresourcesrequired:"externalResourcesRequired",fill:"fill",fillopacity:"fillOpacity","fill-opacity":"fillOpacity",fillrule:"fillRule","fill-rule":"fillRule",filter:"filter",filterres:"filterRes",filterunits:"filterUnits",floodopacity:"floodOpacity","flood-opacity":"floodOpacity",floodcolor:"floodColor","flood-color":"floodColor",focusable:"focusable",fontfamily:"fontFamily","font-family":"fontFamily",fontsize:"fontSize","font-size":"fontSize",fontsizeadjust:"fontSizeAdjust","font-size-adjust":"fontSizeAdjust",fontstretch:"fontStretch","font-stretch":"fontStretch",fontstyle:"fontStyle","font-style":"fontStyle",fontvariant:"fontVariant","font-variant":"fontVariant",fontweight:"fontWeight","font-weight":"fontWeight",format:"format",from:"from",fx:"fx",fy:"fy",g1:"g1",g2:"g2",glyphname:"glyphName","glyph-name":"glyphName",glyphorientationhorizontal:"glyphOrientationHorizontal","glyph-orientation-horizontal":"glyphOrientationHorizontal",glyphorientationvertical:"glyphOrientationVertical","glyph-orientation-vertical":"glyphOrientationVertical",glyphref:"glyphRef",gradienttransform:"gradientTransform",gradientunits:"gradientUnits",hanging:"hanging",horizadvx:"horizAdvX","horiz-adv-x":"horizAdvX",horizoriginx:"horizOriginX","horiz-origin-x":"horizOriginX",ideographic:"ideographic",imagerendering:"imageRendering","image-rendering":"imageRendering",in2:"in2",in:"in",inlist:"inlist",intercept:"intercept",k1:"k1",k2:"k2",k3:"k3",k4:"k4",k:"k",kernelmatrix:"kernelMatrix",kernelunitlength:"kernelUnitLength",kerning:"kerning",keypoints:"keyPoints",keysplines:"keySplines",keytimes:"keyTimes",lengthadjust:"lengthAdjust",letterspacing:"letterSpacing","letter-spacing":"letterSpacing",lightingcolor:"lightingColor","lighting-color":"lightingColor",limitingconeangle:"limitingConeAngle",local:"local",markerend:"markerEnd","marker-end":"markerEnd",markerheight:"markerHeight",markermid:"markerMid","marker-mid":"markerMid",markerstart:"markerStart","marker-start":"markerStart",markerunits:"markerUnits",markerwidth:"markerWidth",mask:"mask",maskcontentunits:"maskContentUnits",maskunits:"maskUnits",mathematical:"mathematical",mode:"mode",numoctaves:"numOctaves",offset:"offset",opacity:"opacity",operator:"operator",order:"order",orient:"orient",orientation:"orientation",origin:"origin",overflow:"overflow",overlineposition:"overlinePosition","overline-position":"overlinePosition",overlinethickness:"overlineThickness","overline-thickness":"overlineThickness",paintorder:"paintOrder","paint-order":"paintOrder",panose1:"panose1","panose-1":"panose1",pathlength:"pathLength",patterncontentunits:"patternContentUnits",patterntransform:"patternTransform",patternunits:"patternUnits",pointerevents:"pointerEvents","pointer-events":"pointerEvents",points:"points",pointsatx:"pointsAtX",pointsaty:"pointsAtY",pointsatz:"pointsAtZ",prefix:"prefix",preservealpha:"preserveAlpha",preserveaspectratio:"preserveAspectRatio",primitiveunits:"primitiveUnits",property:"property",r:"r",radius:"radius",refx:"refX",refy:"refY",renderingintent:"renderingIntent","rendering-intent":"renderingIntent",repeatcount:"repeatCount",repeatdur:"repeatDur",requiredextensions:"requiredExtensions",requiredfeatures:"requiredFeatures",resource:"resource",restart:"restart",result:"result",results:"results",rotate:"rotate",rx:"rx",ry:"ry",scale:"scale",security:"security",seed:"seed",shaperendering:"shapeRendering","shape-rendering":"shapeRendering",slope:"slope",spacing:"spacing",specularconstant:"specularConstant",specularexponent:"specularExponent",speed:"speed",spreadmethod:"spreadMethod",startoffset:"startOffset",stddeviation:"stdDeviation",stemh:"stemh",stemv:"stemv",stitchtiles:"stitchTiles",stopcolor:"stopColor","stop-color":"stopColor",stopopacity:"stopOpacity","stop-opacity":"stopOpacity",strikethroughposition:"strikethroughPosition","strikethrough-position":"strikethroughPosition",strikethroughthickness:"strikethroughThickness","strikethrough-thickness":"strikethroughThickness",string:"string",stroke:"stroke",strokedasharray:"strokeDasharray","stroke-dasharray":"strokeDasharray",strokedashoffset:"strokeDashoffset","stroke-dashoffset":"strokeDashoffset",strokelinecap:"strokeLinecap","stroke-linecap":"strokeLinecap",strokelinejoin:"strokeLinejoin","stroke-linejoin":"strokeLinejoin",strokemiterlimit:"strokeMiterlimit","stroke-miterlimit":"strokeMiterlimit",strokewidth:"strokeWidth","stroke-width":"strokeWidth",strokeopacity:"strokeOpacity","stroke-opacity":"strokeOpacity",suppresscontenteditablewarning:"suppressContentEditableWarning",suppresshydrationwarning:"suppressHydrationWarning",surfacescale:"surfaceScale",systemlanguage:"systemLanguage",tablevalues:"tableValues",targetx:"targetX",targety:"targetY",textanchor:"textAnchor","text-anchor":"textAnchor",textdecoration:"textDecoration","text-decoration":"textDecoration",textlength:"textLength",textrendering:"textRendering","text-rendering":"textRendering",to:"to",transform:"transform",typeof:"typeof",u1:"u1",u2:"u2",underlineposition:"underlinePosition","underline-position":"underlinePosition",underlinethickness:"underlineThickness","underline-thickness":"underlineThickness",unicode:"unicode",unicodebidi:"unicodeBidi","unicode-bidi":"unicodeBidi",unicoderange:"unicodeRange","unicode-range":"unicodeRange",unitsperem:"unitsPerEm","units-per-em":"unitsPerEm",unselectable:"unselectable",valphabetic:"vAlphabetic","v-alphabetic":"vAlphabetic",values:"values",vectoreffect:"vectorEffect","vector-effect":"vectorEffect",version:"version",vertadvy:"vertAdvY","vert-adv-y":"vertAdvY",vertoriginx:"vertOriginX","vert-origin-x":"vertOriginX",vertoriginy:"vertOriginY","vert-origin-y":"vertOriginY",vhanging:"vHanging","v-hanging":"vHanging",videographic:"vIdeographic","v-ideographic":"vIdeographic",viewbox:"viewBox",viewtarget:"viewTarget",visibility:"visibility",vmathematical:"vMathematical","v-mathematical":"vMathematical",vocab:"vocab",widths:"widths",wordspacing:"wordSpacing","word-spacing":"wordSpacing",writingmode:"writingMode","writing-mode":"writingMode",x1:"x1",x2:"x2",x:"x",xchannelselector:"xChannelSelector",xheight:"xHeight","x-height":"xHeight",xlinkactuate:"xlinkActuate","xlink:actuate":"xlinkActuate",xlinkarcrole:"xlinkArcrole","xlink:arcrole":"xlinkArcrole",xlinkhref:"xlinkHref","xlink:href":"xlinkHref",xlinkrole:"xlinkRole","xlink:role":"xlinkRole",xlinkshow:"xlinkShow","xlink:show":"xlinkShow",xlinktitle:"xlinkTitle","xlink:title":"xlinkTitle",xlinktype:"xlinkType","xlink:type":"xlinkType",xmlbase:"xmlBase","xml:base":"xmlBase",xmllang:"xmlLang","xml:lang":"xmlLang",xmlns:"xmlns","xml:space":"xmlSpace",xmlnsxlink:"xmlnsXlink","xmlns:xlink":"xmlnsXlink",xmlspace:"xmlSpace",y1:"y1",y2:"y2",y:"y",ychannelselector:"yChannelSelector",z:"z",zoomandpan:"zoomAndPan"},Zi={"aria-current":0,"aria-details":0,"aria-disabled":0,"aria-hidden":0,"aria-invalid":0,"aria-keyshortcuts":0,"aria-label":0,"aria-roledescription":0,"aria-autocomplete":0,"aria-checked":0,"aria-expanded":0,"aria-haspopup":0,"aria-level":0,"aria-modal":0,"aria-multiline":0,"aria-multiselectable":0,"aria-orientation":0,"aria-placeholder":0,"aria-pressed":0,"aria-readonly":0,"aria-required":0,"aria-selected":0,"aria-sort":0,"aria-valuemax":0,"aria-valuemin":0,"aria-valuenow":0,"aria-valuetext":0,"aria-atomic":0,"aria-busy":0,"aria-live":0,"aria-relevant":0,"aria-dropeffect":0,"aria-grabbed":0,"aria-activedescendant":0,"aria-colcount":0,"aria-colindex":0,"aria-colspan":0,"aria-controls":0,"aria-describedby":0,"aria-errormessage":0,"aria-flowto":0,"aria-labelledby":0,"aria-owns":0,"aria-posinset":0,"aria-rowcount":0,"aria-rowindex":0,"aria-rowspan":0,"aria-setsize":0},Qi={},en=new RegExp("^(aria)-["+n+"]*$"),tn=new RegExp("^(aria)[A-Z]["+n+"]*$"),nn=Object.prototype.hasOwnProperty;function on(e,t){var i,n=[];for(i in t)(e=>{if(!nn.call(Qi,e)||!Qi[e]){if(tn.test(e)){var t="aria-"+e.slice(4).toLowerCase(),t=Zi.hasOwnProperty(t)?t:null;if(null==t)return ee("Invalid ARIA attribute `%s`. ARIA attributes follow the pattern aria-* and must be lowercase.",e),Qi[e]=!0;if(e!==t)return ee("Invalid ARIA attribute `%s`. Did you mean `%s`?",e,t),Qi[e]=!0}if(en.test(e)){t=e.toLowerCase(),t=Zi.hasOwnProperty(t)?t:null;if(null==t)return!(Qi[e]=!0);if(e!==t)return ee("Unknown ARIA attribute `%s`. Did you mean `%s`?",e,t),Qi[e]=!0}}return!0})(i)||n.push(i);t=n.map(function(e){return"`"+e+"`"}).join(", ");1===n.length?ee("Invalid aria prop %s on <%s> tag. For details, see https://reactjs.org/link/invalid-aria-props",t,e):1<n.length&&ee("Invalid aria props %s on <%s> tag. For details, see https://reactjs.org/link/invalid-aria-props",t,e)}var rn=!1,sn=function(){},an={},ln=Object.prototype.hasOwnProperty,cn=/^on./,un=/^on[^A-Z]/,dn=new RegExp("^(aria)-["+n+"]*$"),hn=new RegExp("^(aria)[A-Z]["+n+"]*$"),sn=function(e,t,i,n){if(ln.call(an,t)&&an[t])return!0;var o=t.toLowerCase();if("onfocusin"===o||"onfocusout"===o)return ee("React uses onFocus and onBlur instead of onFocusIn and onFocusOut. All React events are normalized to bubble, so onFocusIn and onFocusOut are not needed/supported by React."),an[t]=!0;if(null!=n){var r=n.registrationNameDependencies,n=n.possibleRegistrationNames;if(r.hasOwnProperty(t))return!0;r=n.hasOwnProperty(o)?n[o]:null;if(null!=r)return ee("Invalid event handler property `%s`. Did you mean `%s`?",t,r),an[t]=!0;if(cn.test(t))return ee("Unknown event handler property `%s`. It will be ignored.",t),an[t]=!0}else if(cn.test(t))return un.test(t)&&ee("Invalid event handler property `%s`. React events use the camelCase naming convention, for example `onClick`.",t),an[t]=!0;if(dn.test(t)||hn.test(t))return!0;if("innerhtml"===o)return ee("Directly setting property `innerHTML` is not permitted. For more information, lookup documentation on `dangerouslySetInnerHTML`."),an[t]=!0;if("aria"===o)return ee("The `aria` attribute is reserved for future use in React. Pass individual `aria-` attributes instead."),an[t]=!0;if("is"===o&&null!=i&&"string"!=typeof i)return ee("Received a `%s` for a string attribute `is`. If this is expected, cast the value to a string.",typeof i),an[t]=!0;if("number"==typeof i&&isNaN(i))return ee("Received NaN for the `%s` attribute. If this is expected, cast the value to a string.",t),an[t]=!0;n=xe(t),r=null!==n&&n.type===M;if(Ji.hasOwnProperty(o)){var s=Ji[o];if(s!==t)return ee("Invalid DOM property `%s`. Did you mean `%s`?",t,s),an[t]=!0}else if(!r&&t!==o)return ee("React does not recognize the `%s` prop on a DOM element. If you intentionally want it to appear in the DOM as a custom attribute, spell it as lowercase `%s` instead. If you accidentally passed it from a parent component, remove it from the DOM element.",t,o),an[t]=!0;return"boolean"==typeof i&&we(t,i,n,!1)?(i?ee('Received `%s` for a non-boolean attribute `%s`.\n\nIf you want to write it to the DOM, pass a string instead: %s="%s" or %s={value.toString()}.',i,t,t,i,t):ee('Received `%s` for a non-boolean attribute `%s`.\n\nIf you want to write it to the DOM, pass a string instead: %s="%s" or %s={value.toString()}.\n\nIf you used to conditionally omit it with %s={condition && value}, pass %s={condition ? value : undefined} instead.',i,t,t,i,t,t,t),an[t]=!0):r||(we(t,i,n,!1)?!(an[t]=!0):"false"!==i&&"true"!==i||null===n||n.type!==$||(ee("Received the string `%s` for the boolean attribute `%s`. %s Did you mean %s={%s}?",i,t,"false"===i?"The browser will interpret it as a truthy value.":'Although this works, it will not work as expected if you pass the string "false".',t,i),an[t]=!0))},pn=function(e,t,i){var n,o=[];for(n in t)sn(e,n,t[n],i)||o.push(n);var r=o.map(function(e){return"`"+e+"`"}).join(", ");1===o.length?ee("Invalid value for prop %s on <%s> tag. Either remove it from the element, or pass a string or number value to keep it in the DOM. For details, see https://reactjs.org/link/attribute-behavior ",r,e):1<o.length&&ee("Invalid values for props %s on <%s> tag. Either remove them from the element, or pass a string or number value to keep them in the DOM. For details, see https://reactjs.org/link/attribute-behavior ",r,e)},gn=1,fn=2,mn=4,bn=16,_n=gn|fn|mn;function yn(e){e=e.target||e.srcElement||window;return(e=e.correspondingUseElement?e.correspondingUseElement:e).nodeType===ki?e.parentNode:e}var vn=null,Tn=null,En=null;function kn(e){e=Lc(e);if(e){if("function"!=typeof vn)throw Error("setRestoreImplementation() needs to be called to handle a target for controlled events. This error is likely caused by a bug in React. Please file an issue.");var t=e.stateNode;t&&(t=Mc(t),vn(e.stateNode,e.type,t))}}function Cn(e){Tn?En?En.push(e):En=[e]:Tn=e}function In(){if(Tn){var e=Tn,t=En;if(En=Tn=null,kn(e),t)for(var i=0;i<t.length;i++)kn(t[i])}}var wn=function(e,t){return e(t)},Sn=function(e,t,i,n,o){return e(t,i,n,o)},xn=function(){},Rn=wn,On=!1,An=!1;function Nn(){null===Tn&&null===En||(xn(),In())}function Ln(e,t){var i=e.stateNode;if(null===i)return null;i=Mc(i);if(null===i)return null;var n=i[t];if(((e,t,i)=>{switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":return i.disabled&&("button"===(n=t)||"input"===n||"select"===n||"textarea"===n);default:return}var n})(t,e.type,i))return null;if(n&&"function"!=typeof n)throw Error("Expected `"+t+"` listener to be a function, instead got a value of `"+typeof n+"` type.");return n}var Dn=!1;if(t)try{var Mn={};Object.defineProperty(Mn,"passive",{get:function(){Dn=!0}}),window.addEventListener("test",Mn,Mn),window.removeEventListener("test",Mn,Mn)}catch(e){Dn=!1}function $n(e,t,i,n,o,r,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(i,c)}catch(e){this.onError(e)}}var Pn,n=$n,Bn=("undefined"!=typeof window&&"function"==typeof window.dispatchEvent&&"undefined"!=typeof document&&"function"==typeof document.createEvent&&(Pn=document.createElement("react"),n=function(e,t,i,n,o,r,s,a,l){if("undefined"==typeof document)throw Error("The `document` global was defined when React was initialized, but is not defined anymore. This can happen in a test environment if a component schedules an update from an asynchronous callback, but the test has already finished running. To solve this, you can either unmount the component at the end of your test (and ensure that any asynchronous operations get canceled in `componentWillUnmount`), or you can change the test itself to be asynchronous.");var c=document.createEvent("Event"),u=!1,d=!0,h=window.event,p=Object.getOwnPropertyDescriptor(window,"event");function g(){Pn.removeEventListener(T,b,!1),void 0!==window.event&&window.hasOwnProperty("event")&&(window.event=h)}var f,m=Array.prototype.slice.call(arguments,3);function b(){u=!0,g(),t.apply(i,m),d=!1}var _=!1,y=!1;function v(e){if(f=e.error,_=!0,null===f&&0===e.colno&&0===e.lineno&&(y=!0),e.defaultPrevented&&null!=f&&"object"==typeof f)try{f._suppressLogging=!0}catch(e){}}var T="react-"+(e||"invokeguardedcallback");if(window.addEventListener("error",v),Pn.addEventListener(T,b,!1),c.initEvent(T,!1,!1),Pn.dispatchEvent(c),p&&Object.defineProperty(window,"event",p),u&&d&&(_?y&&(f=new Error("A cross-origin error was thrown. React doesn't have access to the actual error object in development. See https://reactjs.org/link/crossorigin-error for more information.")):f=new Error("An error was thrown inside one of your components, but React doesn't know what it was. This is likely due to browser flakiness. React does its best to preserve the \"Pause on exceptions\" behavior of the DevTools, which requires some DEV-mode only tricks. It's possible that these don't work in your browser. Try triggering the error in production mode, or switching to a modern browser. If you suspect that this is actually an issue with React, please file an issue."),this.onError(f)),window.removeEventListener("error",v),!u)return g(),$n.apply(this,arguments)}),n),Fn=!1,Un=null,Hn=!1,Gn=null,Vn={onError:function(e){Fn=!0,Un=e}};function jn(e,t,i,n,o,r,s,a,l){Fn=!1,Un=null,Bn.apply(Vn,arguments)}function Wn(){var e;if(Fn)return e=Un,Fn=!1,Un=null,e;throw Error("clearCaughtError was called but no error was captured. This error is likely caused by a bug in React. Please file an issue.")}function zn(e){return e._reactInternals}var G=0,Yn=1,ae=2,V=4,Kn=6,Xn=8,qn=16,Jn=32,j=64,Zn=128,Qn=256,eo=512,to=8192,io=1024,no=1028,oo=932,ro=2047,so=2048,ao=4096,lo=16384,co=d.ReactCurrentOwner;function uo(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else for(var n=t;((t=n).flags&(ae|io))!==G&&(i=t.return),n=t.return;);return t.tag===F?i:null}function ho(e){if(e.tag===H){var t=e.memoizedState;if(null!==(t=null===t&&null!==(e=e.alternate)?e.memoizedState:t))return t.dehydrated}return null}function po(e){return e.tag===F?e.stateNode.containerInfo:null}function go(e){if(uo(e)!==e)throw Error("Unable to find node on an unmounted component.")}function fo(e){var t=e.alternate;if(!t){var i=uo(e);if(null===i)throw Error("Unable to find node on an unmounted component.");return i!==e?null:e}for(var n=e,o=t;;){var r=n.return;if(null===r)break;var s=r.alternate;if(null===s){var a=r.return;if(null===a)break;n=o=a}else{if(r.child===s.child){for(var l=r.child;l;){if(l===n)return go(r),e;if(l===o)return go(r),t;l=l.sibling}throw Error("Unable to find node on an unmounted component.")}if(n.return!==o.return)n=r,o=s;else{for(var c=!1,u=r.child;u;){if(u===n){c=!0,n=r,o=s;break}if(u===o){c=!0,o=r,n=s;break}u=u.sibling}if(!c){for(u=s.child;u;){if(u===n){c=!0,n=s,o=r;break}if(u===o){c=!0,o=s,n=r;break}u=u.sibling}if(!c)throw Error("Child was not found in either parent set. This indicates a bug in React related to the return pointer. Please file an issue.")}}if(n.alternate!==o)throw Error("Return fibers should always be each others' alternates. This error is likely caused by a bug in React. Please file an issue.")}}if(n.tag!==F)throw Error("Unable to find node on an unmounted component.");return n.stateNode.current===n?e:t}function mo(e){var t=fo(e);if(t)for(var i=t;;){if(i.tag===U||i.tag===oe)return i;if(i.child)i=(i.child.return=i).child;else{if(i===t)return null;for(;!i.sibling;){if(!i.return||i.return===t)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}}return null}function bo(e,t){for(var i=t,n=e.alternate;null!==i;){if(i===e||i===n)return 1;i=i.return}}var _o=!1,yo=[],vo=null,To=null,Eo=null,ko=new Map,Co=new Map,Io=[],wo=["mousedown","mouseup","touchcancel","touchend","touchstart","auxclick","dblclick","pointercancel","pointerdown","pointerup","dragend","dragstart","drop","compositionend","compositionstart","keydown","keypress","keyup","input","textInput","copy","cut","paste","click","change","contextmenu","reset","submit"];function So(e){return-1<wo.indexOf(e)}function xo(e,t,i,n,o){return{blockedOn:e,domEventName:t,eventSystemFlags:i|bn,nativeEvent:o,targetContainers:[n]}}function Ro(e,t,i,n,o){yo.push(xo(e,t,i,n,o))}function Oo(e,t){switch(e){case"focusin":case"focusout":vo=null;break;case"dragenter":case"dragleave":To=null;break;case"mouseover":case"mouseout":Eo=null;break;case"pointerover":case"pointerout":var i=t.pointerId;ko.delete(i);break;case"gotpointercapture":case"lostpointercapture":i=t.pointerId;Co.delete(i)}}function Ao(e,t,i,n,o,r){if(null===e||e.nativeEvent!==r)return i=xo(t,i,n,o,r),null!==t&&null!==(r=Lc(t))&&py(r),i;e.eventSystemFlags|=n;t=e.targetContainers;return null!==o&&-1===t.indexOf(o)&&t.push(o),e}function No(e){if(null===e.blockedOn){for(var t=e.targetContainers;0<t.length;){var i,n=t[0],n=ps(e.domEventName,e.eventSystemFlags,n,e.nativeEvent);if(null!==n)return null!==(i=Lc(n))&&py(i),void(e.blockedOn=n);t.shift()}return 1}}function Lo(e,t,i){No(e)&&i.delete(t)}function Do(){for(_o=!1;0<yo.length;){var e=yo[0];if(null!==e.blockedOn){var t=Lc(e.blockedOn);null!==t&&hy(t);break}for(var i=e.targetContainers;0<i.length;){var n=i[0],n=ps(e.domEventName,e.eventSystemFlags,n,e.nativeEvent);if(null!==n){e.blockedOn=n;break}i.shift()}null===e.blockedOn&&yo.shift()}null!==vo&&No(vo)&&(vo=null),null!==To&&No(To)&&(To=null),null!==Eo&&No(Eo)&&(Eo=null),ko.forEach(Lo),Co.forEach(Lo)}function Mo(e,t){e.blockedOn===t&&(e.blockedOn=null,_o||(_o=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,Do)))}function $o(t){if(0<yo.length){Mo(yo[0],t);for(var e=1;e<yo.length;e++){var i=yo[e];i.blockedOn===t&&(i.blockedOn=null)}}null!==vo&&Mo(vo,t),null!==To&&Mo(To,t),null!==Eo&&Mo(Eo,t);function n(e){return Mo(e,t)}ko.forEach(n),Co.forEach(n);for(var o=0;o<Io.length;o++){var r=Io[o];r.blockedOn===t&&(r.blockedOn=null)}for(;0<Io.length;){var s=Io[0];if(null!==s.blockedOn)break;(e=>{var t=Nc(e.target);if(null!==t){var i=uo(t);if(null!==i){t=i.tag;if(t===H){var n=ho(i);if(null!==n)return e.blockedOn=n,fy(e.lanePriority,function(){a.unstable_runWithPriority(e.priority,function(){gy(i)})})}else if(t===F)if(i.stateNode.hydrate)return e.blockedOn=po(i)}}e.blockedOn=null})(s),null===s.blockedOn&&Io.shift()}}var Po=0,Bo=1,Fo=2;function Uo(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var Ho={animationend:Uo("Animation","AnimationEnd"),animationiteration:Uo("Animation","AnimationIteration"),animationstart:Uo("Animation","AnimationStart"),transitionend:Uo("Transition","TransitionEnd")},Go={},Vo={};function jo(e){if(Go[e])return Go[e];if(Ho[e]){var t,i=Ho[e];for(t in i)if(i.hasOwnProperty(t)&&t in Vo)return Go[e]=i[t]}return e}t&&(Vo=document.createElement("div").style,"AnimationEvent"in window||(delete Ho.animationend.animation,delete Ho.animationiteration.animation,delete Ho.animationstart.animation),"TransitionEvent"in window||delete Ho.transitionend.transition);var Wo=jo("animationend"),zo=jo("animationiteration"),Yo=jo("animationstart"),Ko=jo("transitionend"),Xo=new Map,qo=new Map,Mn=["cancel","cancel","click","click","close","close","contextmenu","contextMenu","copy","copy","cut","cut","auxclick","auxClick","dblclick","doubleClick","dragend","dragEnd","dragstart","dragStart","drop","drop","focusin","focus","focusout","blur","input","input","invalid","invalid","keydown","keyDown","keypress","keyPress","keyup","keyUp","mousedown","mouseDown","mouseup","mouseUp","paste","paste","pause","pause","play","play","pointercancel","pointerCancel","pointerdown","pointerDown","pointerup","pointerUp","ratechange","rateChange","reset","reset","seeked","seeked","submit","submit","touchcancel","touchCancel","touchend","touchEnd","touchstart","touchStart","volumechange","volumeChange"],n=["change","selectionchange","textInput","compositionstart","compositionend","compositionupdate"],Jo=["drag","drag","dragenter","dragEnter","dragexit","dragExit","dragleave","dragLeave","dragover","dragOver","mousemove","mouseMove","mouseout","mouseOut","mouseover","mouseOver","pointermove","pointerMove","pointerout","pointerOut","pointerover","pointerOver","scroll","scroll","toggle","toggle","touchmove","touchMove","wheel","wheel"],Zo=["abort","abort",Wo,"animationEnd",zo,"animationIteration",Yo,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Ko,"transitionEnd","waiting","waiting"];function Qo(e,t){for(var i=0;i<e.length;i+=2){var n=e[i],o=e[i+1],o="on"+(o[0].toUpperCase()+o.slice(1));qo.set(n,t),Xo.set(n,o),D(o,[n])}}var er=a.unstable_now;if(null==u.__interactionsRef||null==u.__interactionsRef.current)throw Error("It is not supported to run the profiling version of a renderer (for example, `react-dom/profiling`) without also replacing the `scheduler/tracing` module with `scheduler/tracing-profiling`. Your bundler might have a setting for aliasing both modules. Learn more at https://reactjs.org/link/profiling");var tr=99,ir=98,nr=97,or=96,rr=95,sr=90,ar=(er(),15),lr=14,cr=13,ur=12,dr=11,hr=10,pr=9,gr=8,fr=7,mr=6,br=5,_r=4,yr=3,vr=2,Tr=1,Er=0,kr=31,W=0,Cr=0,m=1,Ir=2,wr=4,Sr=24,xr=32,Rr=192,Or=256,Ar=3584,Nr=4096,Lr=4186112,Dr=62914560,Mr=33554432,$r=67108864,Pr=134217727,Br=134217728,Fr=805306368,Ur=1073741824,y=-1,h=gr;function Hr(e){var t;return(m&e)!==W?(h=ar,m):(Ir&e)!==W?(h=lr,Ir):(wr&e)!==W?(h=cr,wr):(t=Sr&e)!==W?(h=ur,t):(e&xr)!==W?(h=dr,xr):(t=Rr&e)!==W?(h=hr,t):(e&Or)!==W?(h=pr,Or):(t=Ar&e)!==W?(h=gr,t):(e&Nr)!==W?(h=fr,Nr):(t=Lr&e)!==W?(h=mr,t):(t=Dr&e)!==W?(h=br,t):e&$r?(h=_r,$r):(e&Br)!==W?(h=yr,Br):(t=Fr&e)!==W?(h=vr,t):(Ur&e)!==W?(h=Tr,Ur):(ee("Should have found matching lanes. This is a bug in React."),h=gr,e)}function Gr(e,t){var i=e.pendingLanes;if(i===W)return h=Er,W;var n=W,o=Er,r=e.expiredLanes,s=e.suspendedLanes,a=e.pingedLanes;if(r!==W?(n=r,o=h=ar):(r=i&Pr)!==W?(l=r&~s)!==W?(n=Hr(l),o=h):(l=r&a)!==W&&(n=Hr(l),o=h):(r=i&~s)!==W?(n=Hr(r),o=h):a!==W&&(n=Hr(a),o=h),n===W)return W;if(n=i&((e=>(e=31-is(e))<0?W:1<<e)(n)<<1)-1,t!==W&&t!==n&&(t&s)===W){if(Hr(t),o<=h)return t;h=o}var l=e.entangledLanes;if(l!==W)for(var c=e.entanglements,u=n&l;0<u;){var d=Xr(u);n|=c[d],u&=~(1<<d)}return n}function Vr(e,t){for(var i=e.pendingLanes,n=e.suspendedLanes,o=e.pingedLanes,r=e.expirationTimes,s=i;0<s;){var a=Xr(s),l=1<<a,c=r[a];c===y?(l&n)!==W&&(l&o)===W||(r[a]=(a=t,Hr(l),hr<=h?a+250:mr<=h?a+5e3:y)):c<=t&&(e.expiredLanes|=l),s&=~l}}function jr(e){e=e.pendingLanes&~Ur;return e!==W?e:e&Ur?Ur:W}function Wr(e){return(e&Pr)!==W}function zr(e){return(e&Dr)===e}function Yr(e,t){switch(e){case Er:break;case ar:return m;case lr:return Ir;case ur:var i=Kr(Sr&~t);return i===Cr?Yr(hr,t):i;case hr:i=Kr(Rr&~t);return i===Cr?Yr(gr,t):i;case gr:i=Kr(Ar&~t);return i=i===Cr&&(i=Kr(Lr&~t))===Cr?Kr(Ar):i;case mr:case br:break;case vr:i=Kr(Fr&~t);return i=i===Cr?Kr(Fr):i}throw Error("Invalid update priority: "+e+". This is a bug in React.")}function Kr(e){return e&-e}function Xr(e){return 31-is(e)}function qr(e,t){return(e&t)!==W}function Jr(e,t){return(e&t)===t}function Zr(e){for(var t=[],i=0;i<kr;i++)t.push(e);return t}function Qr(e,t,i){e.pendingLanes|=t;var n=t-1;e.suspendedLanes&=n,e.pingedLanes&=n,e.eventTimes[Xr(t)]=i}function es(e,t){e.pingedLanes|=e.suspendedLanes&t}function ts(e,t){e.mutableReadLanes|=t&e.pendingLanes}var is=Math.clz32||function(e){return 0!==e?31-(ns(e)/os|0)|0:32},ns=Math.log,os=Math.LN2,rs=a.unstable_UserBlockingPriority,ss=a.unstable_runWithPriority,as=!0;function ls(e){as=!!e}function cs(e,t,i){var n,o;switch(n=t,void 0===(n=qo.get(n))?Fo:n){case Po:o=us;break;case Bo:o=ds;break;default:o=hs}return o.bind(null,t,i,e)}function us(e,t,i,n){n.timeStamp,On||xn();var o=hs,r=On;On=!0;try{Sn(o,e,t,i,n)}finally{(On=r)||Nn()}}function ds(e,t,i,n){ss(rs,hs.bind(null,e,t,i,n))}function hs(e,t,i,n){if(as){var o;if((o=0==(t&mn))&&0<yo.length&&So(e))Ro(null,e,t,i,n);else{var r=ps(e,t,i,n);if(null===r)o&&Oo(e,n);else{if(o){if(So(e))return void Ro(r,e,t,i,n);if(((e,t,i,n,o)=>{switch(t){case"focusin":return vo=Ao(vo,e,t,i,n,o),1;case"dragenter":return To=Ao(To,e,t,i,n,o),1;case"mouseover":return Eo=Ao(Eo,e,t,i,n,o),1;case"pointerover":var r=o,s=r.pointerId;return ko.set(s,Ao(ko.get(s)||null,e,t,i,n,r)),1;case"gotpointercapture":s=o,r=s.pointerId;return Co.set(r,Ao(Co.get(r)||null,e,t,i,n,s)),1}})(r,e,t,i,n))return;Oo(e,n)}nl(e,t,n,null,i)}}}}function ps(e,t,i,n){var o=Nc(yn(n));if(null!==o){var r=uo(o);if(null===r)o=null;else{var s=r.tag;if(s===H){var a=ho(r);if(null!==a)return a;o=null}else if(s===F){if(r.stateNode.hydrate)return po(r);o=null}else r!==o&&(o=null)}}return nl(e,t,n,o,i),null}var gs=null,fs=null,ms=null;function bs(){if(!ms){for(var e=fs,t=e.length,i=_s(),n=i.length,o=0;o<t&&e[o]===i[o];o++);for(var r=t-o,s=1;s<=r&&e[t-s]===i[n-s];s++);ms=i.slice(o,1<s?1-s:void 0)}return ms}function _s(){return"value"in gs?gs.value:gs.textContent}function ys(e){var t,i=e.keyCode;return"charCode"in e?0===(t=e.charCode)&&13===i&&(t=13):t=i,32<=(t=10===t?13:t)||13===t?t:0}function vs(){return!0}function Ts(){return!1}function Es(a){function e(e,t,i,n,o){for(var r in this._reactName=e,this._targetInst=i,this.type=t,this.nativeEvent=n,this.target=o,this.currentTarget=null,a){var s;a.hasOwnProperty(r)&&(s=a[r],this[r]=s?s(n):n[r])}e=null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue;return this.isDefaultPrevented=e?vs:Ts,this.isPropagationStopped=Ts,this}return T(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=vs)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=vs)},persist:function(){},isPersistent:vs}),e}var ks,Cs,Is,ws=Es(er={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0}),Ss=Es(Ks=T({},er,{view:0,detail:0})),xs=Es(Tu=T({},Ks,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fs,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:((e=e)!==Is&&(Cs=Is&&"mousemove"===e.type?(ks=e.screenX-Is.screenX,e.screenY-Is.screenY):ks=0,Is=e),ks)},movementY:function(e){return"movementY"in e?e.movementY:Cs}})),Rs=Es(T({},Tu,{dataTransfer:0})),Os=Es(T({},Ks,{relatedTarget:0})),As=Es(T({},er,{animationName:0,elapsedTime:0,pseudoElement:0})),Ns=Es(T({},er,{clipboardData:function(e){return("clipboardData"in e?e:window).clipboardData}})),Ls=Es(T({},er,{data:0})),Ds=Ls,Ms={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},$s={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ps={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Bs(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Ps[e])&&!!t[e]}function Fs(e){return Bs}var Us=Es(T({},Ks,{key:function(e){if(e.key){var t=Ms[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(t=ys(e))?"Enter":String.fromCharCode(t):"keydown"===e.type||"keyup"===e.type?$s[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fs,charCode:function(e){return"keypress"===e.type?ys(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ys(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),Hs=Es(T({},Tu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Gs=Es(T({},Ks,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fs})),Vs=Es(T({},er,{propertyName:0,elapsedTime:0,pseudoElement:0})),js=Es(T({},Tu,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Ws=[9,13,27,32],zs=229,Ys=t&&"CompositionEvent"in window,Ks=null,Xs=(t&&"documentMode"in document&&(Ks=document.documentMode),t&&"TextEvent"in window&&!Ks),qs=t&&(!Ys||Ks&&8<Ks&&Ks<=11),Js=32,Zs=String.fromCharCode(Js),Qs=!1;function ea(e,t){switch(e){case"keyup":return-1!==Ws.indexOf(t.keyCode);case"keydown":return t.keyCode!==zs;case"keypress":case"mousedown":case"focusout":return 1;default:return}}function ta(e){e=e.detail;return"object"==typeof e&&"data"in e?e.data:null}function ia(e){return"ko"===e.locale}var na=!1;function oa(e,t,i,n,o){var r,s,a;Ys?a=(e=>{switch(e){case"compositionstart":return"onCompositionStart";case"compositionend":return"onCompositionEnd";case"compositionupdate":return"onCompositionUpdate"}})(t):na?ea(t,n)&&(a="onCompositionEnd"):(s=n,"keydown"===t&&s.keyCode===zs&&(a="onCompositionStart")),a&&(qs&&!ia(n)&&(na||"onCompositionStart"!==a?"onCompositionEnd"===a&&na&&(r=bs()):(gs=o,fs=_s(),na=!0)),0<(s=rl(i,a)).length)&&(i=new Ls(a,t,null,n,o),e.push({event:i,listeners:s}),r?i.data=r:null!==(a=ta(n))&&(i.data=a))}function ra(e,t){var i,n;if(na)return"compositionend"===e||!Ys&&ea(e,t)?(i=bs(),ms=fs=gs=null,na=!1,i):null;switch(e){case"paste":return null;case"keypress":if(!((n=t).ctrlKey||n.altKey||n.metaKey)||n.ctrlKey&&n.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return qs&&!ia(t)?null:t.data;default:return null}}function sa(e,t,i,n,o){t=(Xs?(e,t)=>{switch(e){case"compositionend":return ta(t);case"keypress":return t.which!==Js?null:(Qs=!0,Zs);case"textInput":var i=t.data;return i===Zs&&Qs?null:i;default:return null}}:ra)(t,n);t&&0<(i=rl(i,"onBeforeInput")).length&&(n=new Ds("onBeforeInput","beforeinput",null,n,o),e.push({event:n,listeners:i}),n.data=t)}var aa={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function la(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?aa[e.type]:"textarea"===t}function ca(e,t,i,n){Cn(n);t=rl(t,"onChange");0<t.length&&(i=new ws("onChange","change",null,i,n),e.push({event:i,listeners:t}))}var ua=null,da=null;function ha(e){var t=[],e=(ca(t,da,e,yn(e)),pa);if(On)e(t);else{On=!0;try{wn(e,t)}finally{On=!1,Nn()}}}function pa(e){Ja(e,0)}function ga(e){if(Bt(Dc(e)))return e}function fa(e,t){if("change"===e)return t}var ma=!1;function ba(){ua&&(ua.detachEvent("onpropertychange",_a),da=ua=null)}function _a(e){"value"===e.propertyName&&ga(da)&&ha(e)}function ya(e,t,i){"focusin"===e?(ba(),da=i,(ua=t).attachEvent("onpropertychange",_a)):"focusout"===e&&ba()}function va(e,t){if("selectionchange"===e||"keyup"===e||"keydown"===e)return ga(da)}function Ta(e,t){if("click"===e)return ga(t)}function Ea(e,t){if("input"===e||"change"===e)return ga(t)}function ka(e,t,i,n,o){var r,s,a,l=i?Dc(i):window;if("select"===(s=(c=l).nodeName&&c.nodeName.toLowerCase())||"input"===s&&"file"===c.type?a=fa:la(l)?ma?a=Ea:(a=va,r=ya):!(c=(s=l).nodeName)||"input"!==c.toLowerCase()||"checkbox"!==s.type&&"radio"!==s.type||(a=Ta),a){var c=a(t,i);if(c)return void ca(e,c,n,o)}r&&r(t,l,i),"focusout"===t&&(a=(s=l)._wrapperState)&&a.controlled&&"number"===s.type&&Jt(s,"number",s.value)}function Ca(e,t,i,n,o,r){var s,a,l,c,u,d="mouseover"===t||"pointerover"===t,h="mouseout"===t||"pointerout"===t;if(d&&0==(r&bn)){var r=n.relatedTarget||n.fromElement;if(r&&(Nc(r)||Ac(r)))return}(h||d)&&(d=o.window===o?o:(r=o.ownerDocument)?r.defaultView||r.parentWindow:window,h?(s=i,null!==(a=(r=n.relatedTarget||n.toElement)?Nc(r):null)&&(a!==uo(a)||a.tag!==U&&a.tag!==oe)&&(a=null)):(s=null,a=i),s!==a)&&(h=xs,r="onMouseLeave",c="onMouseEnter",u="mouse","pointerout"!==t&&"pointerover"!==t||(h=Hs,r="onPointerLeave",c="onPointerEnter",u="pointer"),t=null==s?d:Dc(s),d=null==a?d:Dc(a),(r=new h(r,u+"leave",s,n,o)).target=t,r.relatedTarget=d,l=null,Nc(o)===i&&((i=new h(c,u+"enter",a,n,o)).target=d,i.relatedTarget=t,l=i),h=e,c=r,u=l,n=a,d=(o=s)&&n?((e,t)=>{for(var i=e,n=t,o=0,r=i;r;r=sl(r))o++;for(var s=0,a=n;a;a=sl(a))s++;for(;0<o-s;)i=sl(i),o--;for(;0<s-o;)n=sl(n),s--;for(var l=o;l--;){if(i===n||null!==n&&i===n.alternate)return i;i=sl(i),n=sl(n)}return null})(o,n):null,null!==o&&al(h,c,o,d,!1),null!==n)&&null!==u&&al(h,u,n,d,!0)}t&&(er="input",ma=t&&((Tu=(er="on"+er)in document)||((Ks=document.createElement("div")).setAttribute(er,"return;"),Tu="function"==typeof Ks[er]),Tu)&&(!document.documentMode||9<document.documentMode));var Ia="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},wa=Object.prototype.hasOwnProperty;function Sa(e,t){if(!Ia(e,t)){if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(var o=0;o<i.length;o++)if(!wa.call(t,i[o])||!Ia(e[i[o]],t[i[o]]))return!1}return!0}function xa(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ra(e,t){for(var i,n=xa(e),o=0;n;){if(n.nodeType===ki){if(i=o+n.textContent.length,o<=t&&t<=i)return{node:n,offset:t-o};o=i}n=xa((e=>{for(;e;){if(e.nextSibling)return e.nextSibling;e=e.parentNode}})(n))}}function Oa(e){var t=e.ownerDocument,t=t&&t.defaultView||window,t=t.getSelection&&t.getSelection();if(!t||0===t.rangeCount)return null;var i=t.anchorNode,n=t.anchorOffset,o=t.focusNode,t=t.focusOffset;try{i.nodeType,o.nodeType}catch(e){return null}var r=e,s=i,a=n,l=o,c=t,u=0,d=-1,h=-1,p=0,g=0,f=r,m=null;e:for(;;){for(var b=null;;){if(f!==s||0!==a&&f.nodeType!==ki||(d=u+a),f!==l||0!==c&&f.nodeType!==ki||(h=u+c),f.nodeType===ki&&(u+=f.nodeValue.length),null===(b=f.firstChild))break;m=f,f=b}for(;;){if(f===r)break e;if(m===s&&++p===a&&(d=u),m===l&&++g===c&&(h=u),null!==(b=f.nextSibling))break;m=(f=m).parentNode}f=b}return-1!==d&&-1!==h?{start:d,end:h}:null}function Aa(e){return e&&e.nodeType===ki}function Na(e){return e&&e.ownerDocument&&function e(t,i){return!(!t||!i)&&(t===i||!Aa(t)&&(Aa(i)?e(t,i.parentNode):"contains"in t?t.contains(i):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(i))))}(e.ownerDocument.documentElement,e)}function La(){for(var e=window,t=Ft();t instanceof e.HTMLIFrameElement;){if(!(e=>{try{return"string"==typeof e.contentWindow.location.href}catch(e){}})(t))return t;t=Ft((e=t.contentWindow).document)}return t}function Da(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function Ma(){var e=La();return{focusedElem:e,selectionRange:Da(e)?(e=>(e="selectionStart"in e?{start:e.selectionStart,end:e.selectionEnd}:Oa(e))||{start:0,end:0})(e):null}}function $a(e){var t=La(),i=e.focusedElem,e=e.selectionRange;if(t!==i&&Na(i)){null!==e&&Da(i)&&(t=i,r=(e=e).start,void 0===(s=e.end)&&(s=r),"selectionStart"in t?(t.selectionStart=r,t.selectionEnd=Math.min(s,t.value.length)):(r=e,e=(s=t).ownerDocument||document,(t=e&&e.defaultView||window).getSelection&&(t=t.getSelection(),o=s.textContent.length,n=Math.min(r.start,o),r=void 0===r.end?n:Math.min(r.end,o),!t.extend&&r<n&&(o=r,r=n,n=o),o=Ra(s,n),s=Ra(s,r),o)&&s&&(1===t.rangeCount&&t.anchorNode===o.node&&t.anchorOffset===o.offset&&t.focusNode===s.node&&t.focusOffset===s.offset||((e=e.createRange()).setStart(o.node,o.offset),t.removeAllRanges(),r<n?(t.addRange(e),t.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),t.addRange(e))))));for(var n,o,r,s,a=[],l=i;l=l.parentNode;)l.nodeType===Ei&&a.push({element:l,left:l.scrollLeft,top:l.scrollTop});"function"==typeof i.focus&&i.focus();for(var c=0;c<a.length;c++){var u=a[c];u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}}var Pa=t&&"documentMode"in document&&document.documentMode<=11,Ba=null,Fa=null,Ua=null,Ha=!1;function Ga(e,t,i){var n=(n=i).window===n?n.document:n.nodeType===Ii?n:n.ownerDocument;Ha||null==Ba||Ba!==Ft(n)||(n="selectionStart"in(n=Ba)&&Da(n)?{start:n.selectionStart,end:n.selectionEnd}:{anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Ua&&Sa(Ua,n))||(Ua=n,0<(n=rl(Fa,"onSelect")).length&&(t=new ws("onSelect","select",null,t,i),e.push({event:t,listeners:n}),t.target=Ba))}function Va(e,t,i,n,o,r){var s=Xo.get(t);if(void 0!==s){var a=ws,l=t;switch(t){case"keypress":if(0===ys(n))return;case"keydown":case"keyup":a=Us;break;case"focusin":l="focus",a=Os;break;case"focusout":l="blur",a=Os;break;case"beforeblur":case"afterblur":a=Os;break;case"click":if(2===n.button)return;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":a=xs;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":a=Rs;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":a=Gs;break;case Wo:case zo:case Yo:a=As;break;case Ko:a=Vs;break;case"scroll":a=Ss;break;case"wheel":a=js;break;case"copy":case"cut":case"paste":a=Ns;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":a=Hs}var r=0!=(r&mn),i=((e,t,i,n)=>{for(var o=null!==t?t+"Capture":null,r=i?o:t,s=[],a=e,l=null;null!==a;){var c=a,u=c.stateNode;if(c.tag===U&&null!==u&&(l=u,null!==r)&&null!=(c=Ln(a,r))&&s.push(ol(a,c,l)),n)break;a=a.return}return s})(i,s,(n.type,r),!r&&"scroll"===t);0<i.length&&(r=new a(s,l,null,n,o),e.push({event:r,listeners:i}))}}Qo(Mn,Po),Qo(Jo,Bo),Qo(Zo,Fo);for(var ja=n,Wa=Po,za=0;za<ja.length;za++)qo.set(ja[za],Wa);function Ya(e,t,i,n,o,r){if(Va(e,t,i,n,o,r),0==(r&_n)){Ca(e,t,i,n,o,r),ka(e,t,i,n,o);var s=e,r=t,a=i,l=n,c=o,u=a?Dc(a):window;switch(r){case"focusin":!la(u)&&"true"!==u.contentEditable||(Ba=u,Fa=a,Ua=null);break;case"focusout":Ua=Fa=Ba=null;break;case"mousedown":Ha=!0;break;case"contextmenu":case"mouseup":case"dragend":Ha=!1,Ga(s,l,c);break;case"selectionchange":if(Pa)break;case"keydown":case"keyup":Ga(s,l,c)}oa(r=e,e=t,t=i,i=n,n=o),sa(r,e,t,i,n)}}i("onMouseEnter",["mouseout","mouseover"]),i("onMouseLeave",["mouseout","mouseover"]),i("onPointerEnter",["pointerout","pointerover"]),i("onPointerLeave",["pointerout","pointerover"]),D("onChange",["change","click","focusin","focusout","input","keydown","keyup","selectionchange"]),D("onSelect",["focusout","contextmenu","dragend","focusin","keydown","keyup","mousedown","mouseup","selectionchange"]),D("onBeforeInput",["compositionend","keypress","textInput","paste"]),D("onCompositionEnd",["compositionend","focusout","keydown","keypress","keyup","mousedown"]),D("onCompositionStart",["compositionstart","focusout","keydown","keypress","keyup","mousedown"]),D("onCompositionUpdate",["compositionupdate","focusout","keydown","keypress","keyup","mousedown"]);var Ka=["abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting"],Xa=new Set(["cancel","close","invalid","load","scroll","toggle"].concat(Ka));function qa(e,t,i){var n=e.type||"unknown-event";e.currentTarget=i,function(){var e;jn.apply(this,arguments),Fn&&(e=Wn(),Hn||(Hn=!0,Gn=e))}(n,t,void 0,e),e.currentTarget=null}function Ja(e,t){for(var i=0!=(t&mn),n=0;n<e.length;n++){var o=e[n];((e,t,i)=>{var n;if(i)for(var o=t.length-1;0<=o;o--){var r=t[o],s=r.instance,a=r.currentTarget,r=r.listener;if(s!==n&&e.isPropagationStopped())return;qa(e,r,a),n=s}else for(var l=0;l<t.length;l++){var c=t[l],u=c.instance,d=c.currentTarget,c=c.listener;if(u!==n&&e.isPropagationStopped())return;qa(e,c,d),n=u}})(o.event,o.listeners,i)}if(Hn)throw t=Gn,Hn=!1,Gn=null,t}function k(e,t){var i=Pc(t),n=ll(e,!1);i.has(n)||(tl(t,e,fn,!1),i.add(n))}var Za="_reactListening"+Math.random().toString(36).slice(2);function Qa(t){t[Za]||(t[Za]=!0,A.forEach(function(e){Xa.has(e)||el(e,!1,t,null),el(e,!0,t,null)}))}function el(e,t,i,n,o){var o=4<arguments.length&&void 0!==o?o:0,r=i;if("selectionchange"===e&&i.nodeType!==Ii&&(r=i.ownerDocument),null!==n&&!t&&Xa.has(e)){if("scroll"!==e)return;o|=fn,r=n}i=Pc(r),n=ll(e,t);i.has(n)||(t&&(o|=mn),tl(r,e,o,t),i.add(n))}function tl(e,t,i,n){var o,i=cs(e,t,i),r=!Dn||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t?void 0:!0;n?void 0!==r?(n=i,o=r,e.addEventListener(t,n,{capture:!0,passive:o})):(n=i,e.addEventListener(t,n,!0)):void 0!==r?(o=i,n=r,e.addEventListener(t,o,{passive:n})):(r=i,e.addEventListener(t,r,!1))}function il(e,t){return e===t||e.nodeType===Ci&&e.parentNode===t}function nl(i,n,o,e,t){var r=e;if(0==(n&gn)&&0==(n&fn)){var s=t;if(null!==e){var a=e;e:for(;;){if(null===a)return;var l=a.tag;if(l===F||l===ne){var c=a.stateNode.containerInfo;if(il(c,s))break;if(l===ne)for(var u=a.return;null!==u;){var d=u.tag;if(d===F||d===ne)if(il(u.stateNode.containerInfo,s))return;u=u.return}for(;null!==c;){var h=Nc(c);if(null===h)return;var p=h.tag;if(p===U||p===oe){a=r=h;continue e}c=c.parentNode}}a=a.return}}}var t=function(){return e=n,Ya(t=[],i,r,o,yn(o),e),void Ja(t,e);var e,t},e=void 0,g=void 0;if(An)t(e,g);else{An=!0;try{Rn(t,e,g)}finally{An=!1,Nn()}}}function ol(e,t,i){return{instance:e,listener:t,currentTarget:i}}function rl(e,t){for(var i=t+"Capture",n=[],o=e;null!==o;){var r=o,s=r.stateNode;r.tag===U&&null!==s&&(r=s,null!=(s=Ln(o,i))&&n.unshift(ol(o,s,r)),null!=(s=Ln(o,t)))&&n.push(ol(o,s,r)),o=o.return}return n}function sl(e){if(null===e)return null;for(;(e=e.return)&&e.tag!==U;);return e||null}function al(e,t,i,n,o){for(var r=t._reactName,s=[],a=i;null!==a&&a!==n;){var l=a,c=l.alternate,u=l.stateNode,l=l.tag;if(null!==c&&c===n)break;l===U&&null!==u&&(c=u,o?null!=(l=Ln(a,r))&&s.unshift(ol(a,l,c)):null!=(u=Ln(a,r))&&s.push(ol(a,u,c))),a=a.return}0!==s.length&&e.push({event:t,listeners:s})}function ll(e,t){return e+"__"+(t?"capture":"bubble")}var cl,ul=!1,dl="dangerouslySetInnerHTML",hl="suppressContentEditableWarning",pl="suppressHydrationWarning",gl="autoFocus",fl="children",ml="style",bl="__html",_l=e,yl={dialog:!0,webview:!0},vl=function(e,t){var i,n;qi(n=e,i=t)||on(n,i),n=t,"input"!==(i=e)&&"textarea"!==i&&"select"!==i||null==n||null!==n.value||rn||(rn=!0,"select"===i&&n.multiple?ee("`value` prop on `%s` should not be null. Consider using an empty array when `multiple` is set to `true` to clear the component or `undefined` for uncontrolled components.",i):ee("`value` prop on `%s` should not be null. Consider using an empty string to clear the component or `undefined` for uncontrolled components.",i)),n={registrationNameDependencies:N,possibleRegistrationNames:L},qi(i=e,e=t)||pn(i,e,n)},Tl=t&&!document.documentMode,El=/\r\n?/g,kl=/\u0000|\uFFFD/g,Cl=function(e){return("string"==typeof e?e:""+e).replace(El,"\n").replace(kl,"")},Il=function(e,t){ul||(t=Cl(t),(e=Cl(e))!==t&&(ul=!0,ee('Text content did not match. Server: "%s" Client: "%s"',e,t)))},wl=function(e,t,i){ul||(i=Cl(i),(t=Cl(t))!==i&&(ul=!0,ee("Prop `%s` did not match. Server: %s Client: %s",e,JSON.stringify(t),JSON.stringify(i))))},Sl=function(e){var t;ul||(ul=!0,t=[],e.forEach(function(e){t.push(e)}),ee("Extra attributes from the server: %s",t))},xl=function(e,t){!1===t?ee("Expected `%s` listener to be a function, instead got `false`.\n\nIf you used to conditionally omit it with %s={condition && value}, pass %s={condition ? value : undefined} instead.",e,e,e):ee("Expected `%s` listener to be a function, instead got a value of `%s` type.",e,typeof t)},Rl=function(e,t){e=e.namespaceURI===_l?e.ownerDocument.createElement(e.tagName):e.ownerDocument.createElementNS(e.namespaceURI,e.tagName);return e.innerHTML=t,e.innerHTML};function Ol(e){return e.nodeType===Ii?e:e.ownerDocument}function Al(){}function Nl(e){e.onclick=Al}function Ll(e,t,i){var n,o,r,s,a,l,c=qi(t,i);switch(vl(t,i),t){case"dialog":k("cancel",e),k("close",e),n=i;break;case"iframe":case"object":case"embed":k("load",e),n=i;break;case"video":case"audio":for(var u=0;u<Ka.length;u++)k(Ka[u],e);n=i;break;case"source":k("error",e),n=i;break;case"img":case"image":case"link":k("error",e),k("load",e),n=i;break;case"details":k("toggle",e),n=i;break;case"input":zt(e,i),n=Wt(e,i),k("invalid",e);break;case"option":ei(0,i),n=ti(0,i);break;case"select":ai(e,i),n=si(0,i),k("invalid",e);break;case"textarea":ui(e,i),n=ci(e,i),k("invalid",e);break;default:n=i}Xi(t,n);var d,h=t,p=e,g=n,f=c;for(d in g)g.hasOwnProperty(d)&&(o=g[d],d===ml?(o&&Object.freeze(o),Wi(p,o)):d===dl?null!=(r=o?o[bl]:void 0)&&Ti(p,r):d===fl?"string"==typeof o?"textarea"===h&&""===o||Si(p,o):"number"==typeof o&&Si(p,""+o):d!==hl&&d!==pl&&d!==gl&&(N.hasOwnProperty(d)?null!=o&&("function"!=typeof o&&xl(d,o),"onScroll"===d)&&k("scroll",p):null!=o&&Pe(p,d,o,f)));switch(t){case"input":Pt(e),Xt(e,i,!1);break;case"textarea":Pt(e),hi(e);break;case"option":a=e,null!=(l=i).value&&a.setAttribute("value",""+Nt(l.value));break;case"select":a=i,(l=e).multiple=!!a.multiple,null!=(s=a.value)?ri(l,!!a.multiple,s,!1):null!=a.defaultValue&&ri(l,!!a.multiple,a.defaultValue,!0);break;default:"function"==typeof n.onClick&&Nl(e)}}function Dl(e,t,i,n){vl(t,n);var o,r,s,a,l=null;switch(t){case"input":o=Wt(e,i),r=Wt(e,n),l=[];break;case"option":o=ti(0,i),r=ti(0,n),l=[];break;case"select":o=si(0,i),r=si(0,n),l=[];break;case"textarea":o=ci(e,i),r=ci(e,n),l=[];break;default:r=n,"function"!=typeof(o=i).onClick&&"function"==typeof r.onClick&&Nl(e)}Xi(t,r);var c=null;for(s in o)if(!r.hasOwnProperty(s)&&o.hasOwnProperty(s)&&null!=o[s])if(s===ml){var u=o[s];for(a in u)u.hasOwnProperty(a)&&((c=c||{})[a]="")}else s!==dl&&s!==fl&&s!==hl&&s!==pl&&s!==gl&&(N.hasOwnProperty(s)?l=l||[]:(l=l||[]).push(s,null));for(s in r){var d,h,p=r[s],g=null!=o?o[s]:void 0;if(r.hasOwnProperty(s)&&p!==g&&(null!=p||null!=g))if(s===ml)if(p&&Object.freeze(p),g){for(a in g)!g.hasOwnProperty(a)||p&&p.hasOwnProperty(a)||((c=c||{})[a]="");for(a in p)p.hasOwnProperty(a)&&g[a]!==p[a]&&((c=c||{})[a]=p[a])}else c||(l=l||[]).push(s,c),c=p;else s===dl?(d=p?p[bl]:void 0,h=g?g[bl]:void 0,null!=d&&h!==d&&(l=l||[]).push(s,d)):s===fl?"string"!=typeof p&&"number"!=typeof p||(l=l||[]).push(s,""+p):s!==hl&&s!==pl&&(N.hasOwnProperty(s)?(null!=p&&("function"!=typeof p&&xl(s,p),"onScroll"===s)&&k("scroll",e),l||g===p||(l=[])):"object"==typeof p&&null!==p&&p.$$typeof===Je?p.toString():(l=l||[]).push(s,p))}if(c){var f,m=c,t=r[ml];if(t){var b,_=zi(m),y=zi(t),v={};for(b in _){var T=_[b],E=y[b];!E||T===E||v[f=T+","+E]||(v[f]=!0,ee("%s a style property during rerender (%s) when a conflicting property is set (%s) can lead to styling bugs. To avoid this, don't mix shorthand and non-shorthand properties for the same value; instead, replace the shorthand with separate values.",null==(f=m[T])||"boolean"==typeof f||""===f?"Removing":"Updating",T,E))}}(l=l||[]).push(ml,c)}return l}function Ml(e,t,i,n,o){"input"===i&&"radio"===o.type&&null!=o.name&&Yt(e,o);qi(i,n);for(var r,s,a,l,n=qi(i,o),c=e,u=t,d=n,h=0;h<u.length;h+=2){var p=u[h],g=u[h+1];p===ml?Wi(c,g):p===dl?Ti(c,g):p===fl?Si(c,g):Pe(c,p,g,d)}switch(i){case"input":Kt(e,o);break;case"textarea":di(e,o);break;case"select":s=o,a=(r=e)._wrapperState.wasMultiple,r._wrapperState.wasMultiple=!!s.multiple,null!=(l=s.value)?ri(r,!!s.multiple,l,!1):a!==!!s.multiple&&(null!=s.defaultValue?ri(r,!!s.multiple,s.defaultValue,!0):ri(r,!!s.multiple,s.multiple?[]:"",!1))}}function $l(e,t,i,n){var o;switch(cl=!0===i[pl],o=qi(t,i),vl(t,i),t){case"dialog":k("cancel",e),k("close",e);break;case"iframe":case"object":case"embed":k("load",e);break;case"video":case"audio":for(var r=0;r<Ka.length;r++)k(Ka[r],e);break;case"source":k("error",e);break;case"img":case"image":case"link":k("error",e),k("load",e);break;case"details":k("toggle",e);break;case"input":zt(e,i),k("invalid",e);break;case"option":ei(0,i);break;case"select":ai(e,i),k("invalid",e);break;case"textarea":ui(e,i),k("invalid",e)}Xi(t,i);for(var s=new Set,a=e.attributes,l=0;l<a.length;l++)switch(a[l].name.toLowerCase()){case"data-reactroot":case"value":case"checked":case"selected":break;default:s.add(a[l].name)}var c,u,d,h,p,g,f=null;for(c in i)i.hasOwnProperty(c)&&(u=i[c],c===fl?"string"==typeof u?e.textContent!==u&&(cl||Il(e.textContent,u),f=[fl,u]):"number"==typeof u&&e.textContent!==""+u&&(cl||Il(e.textContent,u),f=[fl,""+u]):N.hasOwnProperty(c)?null!=u&&("function"!=typeof u&&xl(c,u),"onScroll"===c)&&k("scroll",e):"boolean"==typeof o&&(h=void 0,g=xe(c),cl||c!==hl&&c!==pl&&"value"!==c&&"checked"!==c&&"selected"!==c&&(c===dl?(d=e.innerHTML,null!=(p=u?u[bl]:void 0)&&(p=Rl(e,p))!==d&&wl(c,d,p)):c===ml?(s.delete(c),Tl&&(d=ji(u))!==(h=e.getAttribute("style"))&&wl(c,h,d)):o?(s.delete(c.toLowerCase()),u!==(h=$e(e,c,u))&&wl(c,h,u)):Ie(c,g,o)||Se(c,u,g,o)||(p=!1,u===(h=null!==g?(s.delete(g.attributeName),((e,t,i,n)=>{if(n.mustUseProperty)return e[n.propertyName];n.sanitizeURL&&Me(""+i);var o,r=n.attributeName,s=null;if(n.type===P){if(e.hasAttribute(r))return""===(o=e.getAttribute(r))||(!Se(t,i,n,!1)&&o===""+i?i:o)}else if(e.hasAttribute(r)){if(Se(t,i,n,!1))return e.getAttribute(r);if(n.type===$)return i;s=e.getAttribute(r)}return Se(t,i,n,!1)?null===s?i:s:s===""+i?i:s})(e,c,u,g)):((g=(g=n)===_l?bi(t):g)===_l?s.delete(c.toLowerCase()):(g=(g=c).toLowerCase(),null!==(g=Ji.hasOwnProperty(g)&&Ji[g]||null)&&g!==c&&(p=!0,s.delete(g)),s.delete(c)),$e(e,c,u))))||p||wl(c,h,u))));switch(0<s.size&&!cl&&Sl(s),t){case"input":Pt(e),Xt(e,i,!0);break;case"textarea":Pt(e),hi(e);break;case"select":case"option":break;default:"function"==typeof i.onClick&&Nl(e)}return f}function Pl(e,t){Il(e.nodeValue,t)}function Bl(e,t){ul||(ul=!0,ee("Did not expect server HTML to contain a <%s> in <%s>.",t.nodeName.toLowerCase(),e.nodeName.toLowerCase()))}function Fl(e,t){ul||(ul=!0,ee('Did not expect server HTML to contain the text node "%s" in <%s>.',t.nodeValue,e.nodeName.toLowerCase()))}function Ul(e,t){ul||(ul=!0,ee("Expected server HTML to contain a matching <%s> in <%s>.",t,e.nodeName.toLowerCase()))}function Hl(e,t){""===t||ul||(ul=!0,ee('Expected server HTML to contain a matching text node for "%s" in <%s>.',t,e.nodeName.toLowerCase()))}function Gl(e,t){switch(t){case"select":return"option"===e||"optgroup"===e||"#text"===e;case"optgroup":return"option"===e||"#text"===e;case"option":return"#text"===e;case"tr":return"th"===e||"td"===e||"style"===e||"script"===e||"template"===e;case"tbody":case"thead":case"tfoot":return"tr"===e||"style"===e||"script"===e||"template"===e;case"colgroup":return"col"===e||"template"===e;case"table":return"caption"===e||"colgroup"===e||"tbody"===e||"tfoot"===e||"thead"===e||"style"===e||"script"===e||"template"===e;case"head":return"base"===e||"basefont"===e||"bgsound"===e||"link"===e||"meta"===e||"title"===e||"noscript"===e||"noframes"===e||"style"===e||"script"===e||"template"===e;case"html":return"head"===e||"body"===e||"frameset"===e;case"frameset":return"frame"===e;case"#document":return"html"===e}switch(e){case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return"h1"!==t&&"h2"!==t&&"h3"!==t&&"h4"!==t&&"h5"!==t&&"h6"!==t;case"rp":case"rt":return-1===Xl.indexOf(t);case"body":case"caption":case"col":case"colgroup":case"frameset":case"frame":case"head":case"html":case"tbody":case"td":case"tfoot":case"th":case"thead":case"tr":return null==t}return 1}function Vl(e,t){switch(e){case"address":case"article":case"aside":case"blockquote":case"center":case"details":case"dialog":case"dir":case"div":case"dl":case"fieldset":case"figcaption":case"figure":case"footer":case"header":case"hgroup":case"main":case"menu":case"nav":case"ol":case"p":case"section":case"summary":case"ul":case"pre":case"listing":case"table":case"hr":case"xmp":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return t.pTagInButtonScope;case"form":return t.formTag||t.pTagInButtonScope;case"li":return t.listItemTagAutoclosing;case"dd":case"dt":return t.dlItemTagAutoclosing;case"button":return t.buttonTagInScope;case"a":return t.aTagInScope;case"nobr":return t.nobrTagInScope}return null}var jl=function(){},Wl=function(){},zl=["address","applet","area","article","aside","base","basefont","bgsound","blockquote","body","br","button","caption","center","col","colgroup","dd","details","dir","div","dl","dt","embed","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","iframe","img","input","isindex","li","link","listing","main","marquee","menu","menuitem","meta","nav","noembed","noframes","noscript","object","ol","p","param","plaintext","pre","script","section","select","source","style","summary","table","tbody","td","template","textarea","tfoot","th","thead","title","tr","track","ul","wbr","xmp"],Yl=["applet","caption","html","table","td","th","marquee","object","template","foreignObject","desc","title"],Kl=Yl.concat(["button"]),Xl=["dd","dt","li","option","optgroup","p","rp","rt"],ql={current:null,formTag:null,aTagInScope:null,buttonTagInScope:null,nobrTagInScope:null,pTagInButtonScope:null,listItemTagAutoclosing:null,dlItemTagAutoclosing:null},Wl=function(e,t){var e=T({},e||ql),i={tag:t};return-1!==Yl.indexOf(t)&&(e.aTagInScope=null,e.buttonTagInScope=null,e.nobrTagInScope=null),-1!==Kl.indexOf(t)&&(e.pTagInButtonScope=null),-1!==zl.indexOf(t)&&"address"!==t&&"div"!==t&&"p"!==t&&(e.listItemTagAutoclosing=null,e.dlItemTagAutoclosing=null),e.current=i,"form"===t&&(e.formTag=i),"a"===t&&(e.aTagInScope=i),"button"===t&&(e.buttonTagInScope=i),"nobr"===t&&(e.nobrTagInScope=i),"p"===t&&(e.pTagInButtonScope=i),"li"===t&&(e.listItemTagAutoclosing=i),"dd"!==t&&"dt"!==t||(e.dlItemTagAutoclosing=i),e},Jl={},jl=function(e,t,i){var n,o=(i=i||ql).current,r=o&&o.tag,r=(null!=t&&(null!=e&&ee("validateDOMNesting: when childText is passed, childTag should be null"),e="#text"),Gl(e,r)?null:o),o=r?null:Vl(e,i),i=r||o;i&&(o=i.tag,Jl[i=!!r+"|"+e+"|"+o]||(Jl[i]=!0,i="","#text"===(n=e)?/\S/.test(t)?n="Text nodes":(n="Whitespace text nodes",i=" Make sure you don't have any extra whitespace between tags on each line of your source code."):n="<"+e+">",r?(t="","table"===o&&"tr"===e&&(t+=" Add a <tbody>, <thead> or <tfoot> to your code to match the DOM tree generated by the browser."),ee("validateDOMNesting(...): %s cannot appear as a child of <%s>.%s%s",n,o,i,t)):ee("validateDOMNesting(...): %s cannot appear as a descendant of <%s>.",n,o)))},Zl="suppressHydrationWarning",Ql="$",ec="/$",tc="$?",ic="$!",nc="style",oc=null,rc=null;function sc(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function ac(){oc=as,rc=Ma();return ls(!1),null}function lc(e,t,i,n,o){jl(e,null,n.ancestorInfo),"string"!=typeof t.children&&"number"!=typeof t.children||(s=""+t.children,r=Wl(n.ancestorInfo,e),jl(null,s,r)),s=n.namespace,r=e,n=t,e=s,s=Ol(s=i),(e=e===_l?bi(r):e)===_l?((a=qi(r,n))||r===r.toLowerCase()||ee("<%s /> is using incorrect casing. Use PascalCase for React components, or lowercase for HTML elements.",r),"script"===r?((l=s.createElement("div")).innerHTML="<script><\/script>",l=l.removeChild(l.firstChild)):"string"==typeof n.is?l=s.createElement(r,{is:n.is}):(l=s.createElement(r),"select"===r&&(i=l,n.multiple?i.multiple=!0:n.size&&(i.size=n.size)))):l=s.createElementNS(e,r),e!==_l||a||"[object HTMLUnknownElement]"!==Object.prototype.toString.call(l)||Object.prototype.hasOwnProperty.call(yl,r)||(yl[r]=!0,ee("The tag <%s> is unrecognized in this browser. If you meant to render a React component, start its name with an uppercase letter.",r));var r,s,a,l,i=l;return Rc(o,i),$c(i,t),i}function cc(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}function uc(e,t,i,n){jl(null,e,i.ancestorInfo);i=Ol(t).createTextNode(e);return Rc(n,i),i}var dc="function"==typeof setTimeout?setTimeout:void 0,hc="function"==typeof clearTimeout?clearTimeout:void 0,pc=-1;function gc(e){Si(e,"")}function fc(e,t){e.appendChild(t)}function mc(e,t){e.nodeType===Ci?(i=e.parentNode).insertBefore(t,e):(i=e).appendChild(t);var i,t=e._reactRootContainer;null==t&&null===i.onclick&&Nl(i)}function bc(e,t,i){e.insertBefore(t,i)}function _c(e,t,i){(e.nodeType===Ci?e.parentNode:e).insertBefore(t,i)}function yc(e){e.nodeType===Ei?e.textContent="":e.nodeType===Ii&&null!=(e=e.body)&&(e.textContent="")}function vc(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(t===Ei||t===ki)break}return e}function Tc(e){return vc(e.nextSibling)}function Ec(e){return vc(e.firstChild)}function kc(e){for(var t=e.previousSibling,i=0;t;){if(t.nodeType===Ci){var n=t.data;if(n===Ql||n===ic||n===tc){if(0===i)return t;i--}else n===ec&&i++}t=t.previousSibling}return null}var Cc=0,Ic="__reactFiber$"+(Ks=Math.random().toString(36).slice(2)),wc="__reactProps$"+Ks,Sc="__reactContainer$"+Ks,xc="__reactEvents$"+Ks;function Rc(e,t){t[Ic]=e}function Oc(e){e[Sc]=null}function Ac(e){return!!e[Sc]}function Nc(e){var t=e[Ic];if(t)return t;for(var i=e.parentNode;i;){if(t=i[Sc]||i[Ic]){var n=t.alternate;if(null!==t.child||null!==n&&null!==n.child)for(var o=kc(e);null!==o;){var r=o[Ic];if(r)return r;o=kc(o)}return t}i=(e=i).parentNode}return null}function Lc(e){e=e[Ic]||e[Sc];return e&&(e.tag===U||e.tag===oe||e.tag===H||e.tag===F)?e:null}function Dc(e){if(e.tag===U||e.tag===oe)return e.stateNode;throw Error("getNodeFromInstance: Invalid argument.")}function Mc(e){return e[wc]||null}function $c(e,t){e[wc]=t}function Pc(e){var t=e[xc];return t=void 0===t?e[xc]=new Set:t}var Bc={},Fc=d.ReactDebugCurrentFrame;function Uc(e){var t;e?(t=e._owner,e=function e(t,i,n){if(null!=t){if("function"==typeof t)return vt(t,!(!(o=(o=t).prototype)||!o.isReactComponent));var o;if("string"==typeof t)return bt(t);switch(t){case ze:return bt("Suspense");case Ye:return bt("SuspenseList")}if("object"==typeof t)switch(t.$$typeof){case We:return Tt(t.render);case Ke:return e(t.type,i,n);case qe:return Tt(t._render);case Xe:var r=t._payload,s=t._init;try{return e(s(r),i,n)}catch(e){}}}return""}(e.type,e._source,t?t.type:null),Fc.setExtraStackFrame(e)):Fc.setExtraStackFrame(null)}function Hc(e,t,i,n,o){var r,s=Function.call.bind(Object.prototype.hasOwnProperty);for(r in e)if(s(e,r)){var a,l=void 0;try{if("function"!=typeof e[r])throw(a=Error((n||"React class")+": "+i+" type `"+r+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[r]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.")).name="Invariant Violation",a;l=e[r](t,r,n,i,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(e){l=e}!l||l instanceof Error||(Uc(o),ee("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",n||"React class",i,r,typeof l),Uc(null)),l instanceof Error&&!(l.message in Bc)&&(Bc[l.message]=!0,Uc(o),ee("Failed %s type: %s",i,l.message),Uc(null))}}var Gc=[],Vc=[],jc=-1;function Wc(e){return{current:e}}function zc(e,t){jc<0?ee("Unexpected pop."):(t!==Vc[jc]&&ee("Unexpected Fiber popped."),e.current=Gc[jc],Gc[jc]=null,Vc[jc]=null,jc--)}function Yc(e,t,i){Gc[++jc]=e.current,Vc[jc]=i,e.current=t}var Kc={},Xc={},qc=(Object.freeze(Xc),Wc(Xc)),Jc=Wc(!1),Zc=Xc;function Qc(e,t,i){return i&&nu(t)?Zc:qc.current}function eu(e,t,i){e=e.stateNode;e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i}function tu(e,t){var i=e.type,n=i.contextTypes;if(!n)return Xc;var o=e.stateNode;if(o&&o.__reactInternalMemoizedUnmaskedChildContext===t)return o.__reactInternalMemoizedMaskedChildContext;var r,s={};for(r in n)s[r]=t[r];return Hc(n,s,"context",se(i)||"Unknown"),o&&eu(e,t,s),s}function iu(){return Jc.current}function nu(e){e=e.childContextTypes;return null!=e}function ou(e){zc(Jc,e),zc(qc,e)}function ru(e){zc(Jc,e),zc(qc,e)}function su(e,t,i){if(qc.current!==Xc)throw Error("Unexpected context found on stack. This error is likely caused by a bug in React. Please file an issue.");Yc(qc,t,e),Yc(Jc,i,e)}function au(e,t,i){var e=e.stateNode,n=t.childContextTypes;if("function"!=typeof e.getChildContext)return r=se(t)||"Unknown",Kc[r]||(Kc[r]=!0,ee("%s.childContextTypes is specified but there is no getChildContext() method on the instance. You can either define getChildContext() on %s or remove childContextTypes from it.",r,r)),i;var o,r=e.getChildContext();for(o in r)if(!(o in n))throw Error((se(t)||"Unknown")+'.getChildContext(): key "'+o+'" is not defined in childContextTypes.');return Hc(n,r,"child context",se(t)||"Unknown"),T({},i,r)}function lu(e){var t=e.stateNode,t=t&&t.__reactInternalMemoizedMergedChildContext||Xc;Zc=qc.current,Yc(qc,t,e),Yc(Jc,Jc.current,e)}function cu(e,t,i){var n=e.stateNode;if(!n)throw Error("Expected to have an instance by this point. This error is likely caused by a bug in React. Please file an issue.");i?(t=au(e,t,Zc),n.__reactInternalMemoizedMergedChildContext=t,zc(Jc,e),zc(qc,e),Yc(qc,t,e)):zc(Jc,e),Yc(Jc,i,e)}function uu(e){if(uo(t=e)!==t||e.tag!==ie)throw Error("Expected subtree parent to be a mounted class component. This error is likely caused by a bug in React. Please file an issue.");var t,i=e;do{switch(i.tag){case F:return i.stateNode.context;case ie:if(nu(i.type))return i.stateNode.__reactInternalMemoizedMergedChildContext}}while(null!==(i=i.return));throw Error("Found unexpected detached subtree parent. This error is likely caused by a bug in React. Please file an issue.")}var du=0,hu=1,pu=2,gu=null,fu=null,mu=!1,bu="undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__,_u=a.unstable_runWithPriority,yu=a.unstable_scheduleCallback,vu=a.unstable_cancelCallback,er=a.unstable_shouldYield,Tu=a.unstable_requestPaint,Eu=a.unstable_now,ku=a.unstable_getCurrentPriorityLevel,Cu=a.unstable_ImmediatePriority,Iu=a.unstable_UserBlockingPriority,wu=a.unstable_NormalPriority,Su=a.unstable_LowPriority,xu=a.unstable_IdlePriority;if(null==u.__interactionsRef||null==u.__interactionsRef.current)throw Error("It is not supported to run the profiling version of a renderer (for example, `react-dom/profiling`) without also replacing the `scheduler/tracing` module with `scheduler/tracing-profiling`. Your bundler might have a setting for aliasing both modules. Learn more at https://reactjs.org/link/profiling");var Ru={},Ou=99,Au=98,Nu=97,Lu=96,Du=95,Mu=90,$u=er,Pu=void 0!==Tu?Tu:function(){},Bu=null,Fu=null,Uu=!1,Hu=Eu(),Gu=Hu<1e4?Eu:function(){return Eu()-Hu};function Vu(){switch(ku()){case Cu:return Ou;case Iu:return Au;case wu:return Nu;case Su:return Lu;case xu:return Du;default:throw Error("Unknown priority level.")}}function ju(e){switch(e){case Ou:return Cu;case Au:return Iu;case Nu:return wu;case Lu:return Su;case Du:return xu;default:throw Error("Unknown priority level.")}}function Wu(e,t){e=ju(e);return _u(e,t)}function zu(e,t,i){e=ju(e);return yu(e,t,i)}function Yu(e){e!==Ru&&vu(e)}function Ku(){var e;null!==Fu&&(e=Fu,Fu=null,vu(e)),Xu()}function Xu(){if(!Uu&&null!==Bu){Uu=!0;var t=0;try{var i=Bu;Wu(Ou,function(){for(;t<i.length;t++)for(var e=i[t];null!==(e=e(!0)););}),Bu=null}catch(e){throw null!==Bu&&(Bu=Bu.slice(t+1)),yu(Cu,Ku),e}finally{Uu=!1}}}var b=0,z=1,qu=2,Ju=4,Zu=8,Qu=16,ed=d.ReactCurrentBatchConfig,td=0;function id(e){var t=[];return e.forEach(function(e){t.push(e)}),t.sort().join(", ")}var nd={recordUnsafeLifecycleWarnings:function(e,t){},flushPendingUnsafeLifecycleWarnings:function(){},recordLegacyContextWarning:function(e,t){},flushLegacyContextWarning:function(){},discardPendingWarnings:function(){}},od=[],rd=[],sd=[],ad=[],ld=[],cd=[],ud=new Set,dd=(nd.recordUnsafeLifecycleWarnings=function(e,t){ud.has(e.type)||("function"==typeof t.componentWillMount&&!0!==t.componentWillMount.__suppressDeprecationWarning&&od.push(e),e.mode&z&&"function"==typeof t.UNSAFE_componentWillMount&&rd.push(e),"function"==typeof t.componentWillReceiveProps&&!0!==t.componentWillReceiveProps.__suppressDeprecationWarning&&sd.push(e),e.mode&z&&"function"==typeof t.UNSAFE_componentWillReceiveProps&&ad.push(e),"function"==typeof t.componentWillUpdate&&!0!==t.componentWillUpdate.__suppressDeprecationWarning&&ld.push(e),e.mode&z&&"function"==typeof t.UNSAFE_componentWillUpdate&&cd.push(e))},nd.flushPendingUnsafeLifecycleWarnings=function(){var t=new Set,i=(0<od.length&&(od.forEach(function(e){t.add(se(e.type)||"Component"),ud.add(e.type)}),od=[]),new Set),n=(0<rd.length&&(rd.forEach(function(e){i.add(se(e.type)||"Component"),ud.add(e.type)}),rd=[]),new Set),o=(0<sd.length&&(sd.forEach(function(e){n.add(se(e.type)||"Component"),ud.add(e.type)}),sd=[]),new Set),r=(0<ad.length&&(ad.forEach(function(e){o.add(se(e.type)||"Component"),ud.add(e.type)}),ad=[]),new Set),s=(0<ld.length&&(ld.forEach(function(e){r.add(se(e.type)||"Component"),ud.add(e.type)}),ld=[]),new Set);0<cd.length&&(cd.forEach(function(e){s.add(se(e.type)||"Component"),ud.add(e.type)}),cd=[]),0<i.size&&ee("Using UNSAFE_componentWillMount in strict mode is not recommended and may indicate bugs in your code. See https://reactjs.org/link/unsafe-component-lifecycles for details.\n\n* Move code with side effects to componentDidMount, and set initial state in the constructor.\n\nPlease update the following components: %s",id(i)),0<o.size&&ee("Using UNSAFE_componentWillReceiveProps in strict mode is not recommended and may indicate bugs in your code. See https://reactjs.org/link/unsafe-component-lifecycles for details.\n\n* Move data fetching code or side effects to componentDidUpdate.\n* If you're updating state whenever props change, refactor your code to use memoization techniques or move it to static getDerivedStateFromProps. Learn more at: https://reactjs.org/link/derived-state\n\nPlease update the following components: %s",id(o)),0<s.size&&ee("Using UNSAFE_componentWillUpdate in strict mode is not recommended and may indicate bugs in your code. See https://reactjs.org/link/unsafe-component-lifecycles for details.\n\n* Move data fetching code or side effects to componentDidUpdate.\n\nPlease update the following components: %s",id(s)),0<t.size&&p("componentWillMount has been renamed, and is not recommended for use. See https://reactjs.org/link/unsafe-component-lifecycles for details.\n\n* Move code with side effects to componentDidMount, and set initial state in the constructor.\n* Rename componentWillMount to UNSAFE_componentWillMount to suppress this warning in non-strict mode. In React 18.x, only the UNSAFE_ name will work. To rename all deprecated lifecycles to their new names, you can run `npx react-codemod rename-unsafe-lifecycles` in your project source folder.\n\nPlease update the following components: %s",id(t)),0<n.size&&p("componentWillReceiveProps has been renamed, and is not recommended for use. See https://reactjs.org/link/unsafe-component-lifecycles for details.\n\n* Move data fetching code or side effects to componentDidUpdate.\n* If you're updating state whenever props change, refactor your code to use memoization techniques or move it to static getDerivedStateFromProps. Learn more at: https://reactjs.org/link/derived-state\n* Rename componentWillReceiveProps to UNSAFE_componentWillReceiveProps to suppress this warning in non-strict mode. In React 18.x, only the UNSAFE_ name will work. To rename all deprecated lifecycles to their new names, you can run `npx react-codemod rename-unsafe-lifecycles` in your project source folder.\n\nPlease update the following components: %s",id(n)),0<r.size&&p("componentWillUpdate has been renamed, and is not recommended for use. See https://reactjs.org/link/unsafe-component-lifecycles for details.\n\n* Move data fetching code or side effects to componentDidUpdate.\n* Rename componentWillUpdate to UNSAFE_componentWillUpdate to suppress this warning in non-strict mode. In React 18.x, only the UNSAFE_ name will work. To rename all deprecated lifecycles to their new names, you can run `npx react-codemod rename-unsafe-lifecycles` in your project source folder.\n\nPlease update the following components: %s",id(r))},new Map),hd=new Set;function pd(e,t){if(e&&e.defaultProps){var i,n=T({},t),o=e.defaultProps;for(i in o)void 0===n[i]&&(n[i]=o[i]);return n}return t}nd.recordLegacyContextWarning=function(e,t){var i,n=(e=>{for(var t=null,i=e;null!==i;)i.mode&z&&(t=i),i=i.return;return t})(e);null===n?ee("Expected to find a StrictMode component in a strict mode tree. This error is likely caused by a bug in React. Please file an issue."):!hd.has(e.type)&&(i=dd.get(n),null!=e.type.contextTypes||null!=e.type.childContextTypes||null!==t&&"function"==typeof t.getChildContext)&&(void 0===i&&dd.set(n,i=[]),i.push(e))},nd.flushLegacyContextWarning=function(){dd.forEach(function(e,t){if(0!==e.length){var i=e[0],n=new Set,e=(e.forEach(function(e){n.add(se(e.type)||"Component"),hd.add(e.type)}),id(n));try{f(i),ee("Legacy context API has been detected within a strict-mode tree.\n\nThe old API will be supported in all 16.x releases, but applications using it should migrate to the new version.\n\nPlease update the following components: %s\n\nLearn more about this warning here: https://reactjs.org/link/legacy-context",e)}finally{Ot()}}})},nd.discardPendingWarnings=function(){od=[],rd=[],sd=[],ad=[],ld=[],cd=[],dd=new Map};var gd=1073741823,fd=Wc(null),md={},bd=null,_d=null,yd=null,vd=!1;function Td(){yd=_d=bd=null,vd=!1}function Ed(){vd=!0}function kd(){vd=!1}function Cd(e,t){var i=e.type._context;Yc(fd,i._currentValue,e),i._currentValue=t,null!=i._currentRenderer&&i._currentRenderer!==md&&ee("Detected multiple renderers concurrently rendering the same context provider. This is currently unsupported."),i._currentRenderer=md}function Id(e){var t=fd.current;zc(fd,e),e.type._context._currentValue=t}function wd(e,t){for(var i=e;null!==i;){var n=i.alternate;if(Jr(i.childLanes,t)){if(null===n||Jr(n.childLanes,t))break;n.childLanes=n.childLanes|t}else i.childLanes=i.childLanes|t,null!==n&&(n.childLanes=n.childLanes|t);i=i.return}}function Sd(e,t){yd=_d=null;e=(bd=e).dependencies;null!==e&&null!==e.firstContext&&(qr(e.lanes,t)&&Ef(),e.firstContext=null)}function Y(e,t){if(vd&&ee("Context can only be read while React is rendering. In classes, you can read it in the render method or getDerivedStateFromProps. In function components, you can read it directly in the function body, but not inside Hooks like useReducer() or useMemo()."),yd!==e&&!1!==t&&0!==t){t="number"!=typeof t||t===gd?(yd=e,gd):t,t={context:e,observedBits:t,next:null};if(null===_d){if(null===bd)throw Error("Context can only be read while React is rendering. In classes, you can read it in the render method or getDerivedStateFromProps. In function components, you can read it directly in the function body, but not inside Hooks like useReducer() or useMemo().");_d=t,bd.dependencies={lanes:W,firstContext:t,responders:null}}else _d=_d.next=t}return e._currentValue}var xd=0,Rd=1,Od=2,Ad=3,Nd=!1;function Ld(e){var t={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null};e.updateQueue=t}function Dd(e,t){var i=t.updateQueue,e=e.updateQueue;i===e&&(i={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects},t.updateQueue=i)}function Md(e,t){return{eventTime:e,lane:t,tag:xd,payload:null,callback:null,next:null}}function $d(e,t){var i,e=e.updateQueue;null===e||(null===(i=(e=e.shared).pending)?t.next=t:(t.next=i.next,i.next=t),e.pending=t,Gd!==e)||Hd||(ee("An update (setState, replaceState, or forceUpdate) was scheduled from inside an update function. Update functions should be pure, with zero side-effects. Consider using componentDidUpdate or a callback."),Hd=!0)}function Pd(e,t){var i=e.updateQueue,n=e.alternate;if(null!==n){n=n.updateQueue;if(i===n){var o=null,r=null,s=i.firstBaseUpdate;if(null!==s){var a=s;do{var l={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null}}while(null===r?o=r=l:(r.next=l,r=l),null!==(a=a.next));null===r?o=r=t:(r.next=t,r=t)}else o=r=t;return i={baseState:n.baseState,firstBaseUpdate:o,lastBaseUpdate:r,shared:n.shared,effects:n.effects},void(e.updateQueue=i)}}s=i.lastBaseUpdate;null===s?i.firstBaseUpdate=t:s.next=t,i.lastBaseUpdate=t}function Bd(e,t,i,n){var o,r,s,a,l=e.updateQueue,c=(Nd=!1,Gd=l.shared,l.firstBaseUpdate),u=l.lastBaseUpdate,d=l.shared.pending;if(null!==d&&(l.shared.pending=null,r=(o=d).next,(o.next=null)===u?c=r:u.next=r,u=o,null!==(s=e.alternate))&&(a=(s=s.updateQueue).lastBaseUpdate)!==u&&(null===a?s.firstBaseUpdate=r:a.next=r,s.lastBaseUpdate=o),null!==c){for(var h=l.baseState,p=W,g=null,f=null,m=null,b=c;;){var _,y=b.lane,v=b.eventTime;if(Jr(n,y)?(null!==m&&(_={eventTime:v,lane:Cr,tag:b.tag,payload:b.payload,callback:b.callback,next:null},m=m.next=_),h=((e,t,i,n,o)=>{switch(t.tag){case Rd:var r=t.payload;if("function"!=typeof r)return r;Ed();var s=r.call(o,i,n);if(e.mode&z){pt();try{r.call(o,i,n)}finally{gt()}}return kd(),s;case Ad:e.flags=e.flags&~ao|j;case xd:var a,r=t.payload;if("function"==typeof r){if(Ed(),a=r.call(o,i,n),e.mode&z){pt();try{r.call(o,i,n)}finally{gt()}}kd()}else a=r;return null==a?i:T({},i,a);case Od:return Nd=!0,i}return i})(e,b,h,t,i),null!==b.callback&&(e.flags|=Jn,null===(_=l.effects)?l.effects=[b]:_.push(b))):(v={eventTime:v,lane:y,tag:b.tag,payload:b.payload,callback:b.callback,next:null},null===m?(f=m=v,g=h):m=m.next=v,p|=y),null===(b=b.next)){if(null===(d=l.shared.pending))break;v=d,y=v.next;v.next=null,b=y,l.lastBaseUpdate=v,l.shared.pending=null}}null===m&&(g=h),l.baseState=g,l.firstBaseUpdate=f,l.lastBaseUpdate=m,Tb(p),e.lanes=p,e.memoizedState=h}Gd=null}function Fd(){Nd=!1}function Ud(e,t,i){var n=t.effects;if((t.effects=null)!==n)for(var o=0;o<n.length;o++){var r=n[o],s=r.callback;if(null!==s){r.callback=null,a=r=void 0;var r=s,a=i;if("function"!=typeof r)throw Error("Invalid argument passed as callback. Expected a function. Instead received: "+r);r.call(a)}}}var Hd=!1,Gd=null,Vd={},jd=Array.isArray,Wd=(new c.Component).refs,zd=new Set,Yd=new Set,Kd=new Set,Xd=new Set,qd=new Set,Jd=new Set,Zd=new Set,Qd=new Set,eh=new Set,th=function(e,t){var i;null===e||"function"==typeof e||eh.has(i=t+"_"+e)||(eh.add(i),ee("%s(...): Expected the last optional `callback` argument to be a function. Instead received: %s.",t,e))},ih=function(e,t){void 0===t&&(t=se(e)||"Component",Jd.has(t)||(Jd.add(t),ee("%s.getDerivedStateFromProps(): A valid state object (or null) must be returned. You have returned undefined.",t)))};function nh(e,t,i,n){var o=e.memoizedState;if(e.mode&z){pt();try{i(n,o)}finally{gt()}}i=i(n,o),ih(t,i),n=null==i?o:T({},o,i);e.memoizedState=n,e.lanes===W&&(e.updateQueue.baseState=n)}Object.defineProperty(Vd,"_processChildContext",{enumerable:!1,value:function(){throw Error("_processChildContext is not available in React 16+. This likely means you have multiple copies of React and are attempting to nest a React 15 tree inside a React 16 tree using unstable_renderSubtreeIntoContainer, which isn't supported. Try to make sure you have only one copy of React (and ideally, switch to ReactDOM.createPortal).")}}),Object.freeze(Vd);var oh,rh={isMounted:function(e){var t,i=co.current;return null!==i&&i.tag===ie&&((t=i.stateNode)._warnedAboutRefsInRender||ee("%s is accessing isMounted inside its render() function. render() should be a pure function of props and state. It should never access something that requires stale data from the previous render, such as refs. Move this logic to componentDidMount and componentDidUpdate instead.",se(i.type)||"A component"),t._warnedAboutRefsInRender=!0),!!(i=zn(e))&&uo(i)===i},enqueueSetState:function(e,t,i){var e=zn(e),n=ib(),o=nb(e),r=Md(n,o);r.payload=t,null!=i&&(th(i,"setState"),r.callback=i),$d(e,r),ob(e,o,n)},enqueueReplaceState:function(e,t,i){var e=zn(e),n=ib(),o=nb(e),r=Md(n,o);r.tag=Rd,r.payload=t,null!=i&&(th(i,"replaceState"),r.callback=i),$d(e,r),ob(e,o,n)},enqueueForceUpdate:function(e,t){var e=zn(e),i=ib(),n=nb(e),o=Md(i,n);o.tag=Od,null!=t&&(th(t,"forceUpdate"),o.callback=t),$d(e,o),ob(e,n,i)}};function sh(e,t,i,n,o,r,s){var a=e.stateNode;if("function"!=typeof a.shouldComponentUpdate)return!(t.prototype&&t.prototype.isPureReactComponent&&Sa(i,n)&&Sa(o,r));if(e.mode&z){pt();try{a.shouldComponentUpdate(n,r,s)}finally{gt()}}i=a.shouldComponentUpdate(n,r,s);return void 0===i&&ee("%s.shouldComponentUpdate(): Returned undefined instead of a boolean value. Make sure to return true or false.",se(t)||"Component"),i}function ah(e,t){t.updater=rh,(e.stateNode=t)._reactInternals=e,t._reactInternalInstance=Vd}function lh(e,t,i){var n=!1,o=Xc,r=Xc,s=t.contextType;if("contextType"in t&&(null===s||void 0!==s&&s.$$typeof===je&&void 0===s._context||Qd.has(t)||(Qd.add(t),l="",l=void 0===s?" However, it is set to undefined. This can be caused by a typo or by mixing up named and default imports. This can also happen due to a circular dependency, so try moving the createContext() call to a separate file.":"object"!=typeof s?" However, it is set to a "+typeof s+".":s.$$typeof===Ve?" Did you accidentally pass the Context.Provider instead?":void 0!==s._context?" Did you accidentally pass the Context.Consumer instead?":" However, it is set to an object with keys {"+Object.keys(s).join(", ")+"}.",ee("%s defines an invalid contextType. contextType should point to the Context object returned by React.createContext().%s",se(t)||"Component",l))),r="object"==typeof s&&null!==s?Y(s):(o=Qc(0,t,!0),(n=null!=t.contextTypes)?tu(e,o):Xc),e.mode&z){pt();try{new t(i,r)}finally{gt()}}var a,l=new t(i,r),s=e.memoizedState=null!=l.state?l.state:null;ah(e,l),"function"==typeof t.getDerivedStateFromProps&&null===s&&(i=se(t)||"Component",Yd.has(i)||(Yd.add(i),ee("`%s` uses `getDerivedStateFromProps` but its initial state is %s. This is not recommended. Instead, define the initial state by assigning an object to `this.state` in the constructor of `%s`. This ensures that `getDerivedStateFromProps` arguments have a consistent shape.",i,null===l.state?"null":"undefined",i))),"function"!=typeof t.getDerivedStateFromProps&&"function"!=typeof l.getSnapshotBeforeUpdate||(a=i=s=null,"function"==typeof l.componentWillMount&&!0!==l.componentWillMount.__suppressDeprecationWarning?s="componentWillMount":"function"==typeof l.UNSAFE_componentWillMount&&(s="UNSAFE_componentWillMount"),"function"==typeof l.componentWillReceiveProps&&!0!==l.componentWillReceiveProps.__suppressDeprecationWarning?i="componentWillReceiveProps":"function"==typeof l.UNSAFE_componentWillReceiveProps&&(i="UNSAFE_componentWillReceiveProps"),"function"==typeof l.componentWillUpdate&&!0!==l.componentWillUpdate.__suppressDeprecationWarning?a="componentWillUpdate":"function"==typeof l.UNSAFE_componentWillUpdate&&(a="UNSAFE_componentWillUpdate"),null===s&&null===i&&null===a)||(l=se(t)||"Component",t="function"==typeof t.getDerivedStateFromProps?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()",Xd.has(l))||(Xd.add(l),ee("Unsafe legacy lifecycles will not be called for components using new component APIs.\n\n%s uses %s but also contains the following legacy lifecycles:%s%s%s\n\nThe above lifecycles should be removed. Learn more about this warning here:\nhttps://reactjs.org/link/unsafe-component-lifecycles",l,t,null!==s?"\n  "+s:"",null!==i?"\n  "+i:"",null!==a?"\n  "+a:"")),n&&eu(e,o,r)}function ch(e,t,i,n){var o=t.state;"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,n),t.state!==o&&(i=se(e.type)||"Component",zd.has(i)||(zd.add(i),ee("%s.componentWillReceiveProps(): Assigning directly to this.state is deprecated (except inside a component's constructor). Use setState instead.",i)),rh.enqueueReplaceState(t,t.state,null))}function uh(e,t,i,n){o=t,s=i,a=(a=e).stateNode,r=se(o)||"Component",a.render||(o.prototype&&"function"==typeof o.prototype.render?ee("%s(...): No `render` method found on the returned component instance: did you accidentally return an object from the constructor?",r):ee("%s(...): No `render` method found on the returned component instance: you may have forgotten to define `render`.",r)),!a.getInitialState||a.getInitialState.isReactClassApproved||a.state||ee("getInitialState was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Did you mean to define a state property instead?",r),a.getDefaultProps&&!a.getDefaultProps.isReactClassApproved&&ee("getDefaultProps was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Use a static property to define defaultProps instead.",r),a.propTypes&&ee("propTypes was defined as an instance property on %s. Use a static property to define propTypes instead.",r),a.contextType&&ee("contextType was defined as an instance property on %s. Use a static property to define contextType instead.",r),a.contextTypes&&ee("contextTypes was defined as an instance property on %s. Use a static property to define contextTypes instead.",r),o.contextType&&o.contextTypes&&!Zd.has(o)&&(Zd.add(o),ee("%s declares both contextTypes and contextType static properties. The legacy contextTypes property will be ignored.",r)),"function"==typeof a.componentShouldUpdate&&ee("%s has a method called componentShouldUpdate(). Did you mean shouldComponentUpdate()? The name is phrased as a question because the function is expected to return a value.",r),o.prototype&&o.prototype.isPureReactComponent&&void 0!==a.shouldComponentUpdate&&ee("%s has a method called shouldComponentUpdate(). shouldComponentUpdate should not be used when extending React.PureComponent. Please extend React.Component if shouldComponentUpdate is used.",se(o)||"A pure component"),"function"==typeof a.componentDidUnmount&&ee("%s has a method called componentDidUnmount(). But there is no such lifecycle method. Did you mean componentWillUnmount()?",r),"function"==typeof a.componentDidReceiveProps&&ee("%s has a method called componentDidReceiveProps(). But there is no such lifecycle method. If you meant to update the state in response to changing props, use componentWillReceiveProps(). If you meant to fetch data or run side-effects or mutations after React has updated the UI, use componentDidUpdate().",r),"function"==typeof a.componentWillRecieveProps&&ee("%s has a method called componentWillRecieveProps(). Did you mean componentWillReceiveProps()?",r),"function"==typeof a.UNSAFE_componentWillRecieveProps&&ee("%s has a method called UNSAFE_componentWillRecieveProps(). Did you mean UNSAFE_componentWillReceiveProps()?",r),s=a.props!==s,void 0!==a.props&&s&&ee("%s(...): When calling super() in `%s`, make sure to pass up the same props that your component's constructor was passed.",r,r),a.defaultProps&&ee("Setting defaultProps as an instance property on %s is not supported and will be ignored. Instead, define defaultProps as a static property on %s.",r,r),"function"!=typeof a.getSnapshotBeforeUpdate||"function"==typeof a.componentDidUpdate||Kd.has(o)||(Kd.add(o),ee("%s: getSnapshotBeforeUpdate() should be used with componentDidUpdate(). This component defines getSnapshotBeforeUpdate() only.",se(o))),"function"==typeof a.getDerivedStateFromProps&&ee("%s: getDerivedStateFromProps() is defined as an instance method and will be ignored. Instead, declare it as a static method.",r),"function"==typeof a.getDerivedStateFromError&&ee("%s: getDerivedStateFromError() is defined as an instance method and will be ignored. Instead, declare it as a static method.",r),"function"==typeof o.getSnapshotBeforeUpdate&&ee("%s: getSnapshotBeforeUpdate() is defined as a static method and will be ignored. Instead, declare it as an instance method.",r),(s=a.state)&&("object"!=typeof s||jd(s))&&ee("%s.state: must be set to an object or null",r),"function"==typeof a.getChildContext&&"object"!=typeof o.childContextTypes&&ee("%s.getChildContext(): childContextTypes must be defined in order to use getChildContext().",r);var o,r,s=e.stateNode,a=(s.props=i,s.state=e.memoizedState,s.refs=Wd,Ld(e),t.contextType),a=("object"==typeof a&&null!==a?s.context=Y(a):(o=Qc(0,t,!0),s.context=tu(e,o)),s.state===i&&(r=se(t)||"Component",qd.has(r)||(qd.add(r),ee("%s: It is not recommended to assign props directly to state because updates to props won't be reflected in state. In most cases, it is better to use props directly.",r))),e.mode&z&&nd.recordLegacyContextWarning(e,s),nd.recordUnsafeLifecycleWarnings(e,s),Bd(e,i,s,n),s.state=e.memoizedState,t.getDerivedStateFromProps);"function"==typeof a&&(nh(e,t,a,i),s.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof s.getSnapshotBeforeUpdate||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||(o=e,a=(r=s).state,"function"==typeof r.componentWillMount&&r.componentWillMount(),"function"==typeof r.UNSAFE_componentWillMount&&r.UNSAFE_componentWillMount(),a!==r.state&&(ee("%s.componentWillMount(): Assigning directly to this.state is deprecated (except inside a component's constructor). Use setState instead.",se(o.type)||"Component"),rh.enqueueReplaceState(r,r.state,null)),Bd(e,i,s,n),s.state=e.memoizedState),"function"==typeof s.componentDidMount&&(e.flags|=V)}var dh=oh=!1,hh={},ph={},gh={},fh=function(e,t){if(null!==e&&"object"==typeof e&&e._store&&!e._store.validated&&null==e.key){if("object"!=typeof e._store)throw Error("React Component in warnForMissingKey should have a _store. This error is likely caused by a bug in React. Please file an issue.");e._store.validated=!0;e=se(t.type)||"Component";ph[e]||(ph[e]=!0,ee('Each child in a list should have a unique "key" prop. See https://reactjs.org/link/warning-keys for more information.'))}},mh=Array.isArray;function bh(e,t,i){var n=i.ref;if(null!==n&&"function"!=typeof n&&"object"!=typeof n){if(!(e.mode&z||O)||i._owner&&i._self&&i._owner.stateNode!==i._self||(e=se(e.type)||"Component",hh[e])||(ee('A string ref, "%s", has been found within a strict mode tree. String refs are a source of potential bugs and should be avoided. We recommend using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',n),hh[e]=!0),i._owner){var o,r,e=i._owner;if(e){if(e.tag!==ie)throw Error("Function components cannot have string refs. We recommend using useRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref");o=e.stateNode}if(o)return r=""+n,null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===r?t.ref:((e=function(e){var t=o.refs;t===Wd&&(t=o.refs={}),null===e?delete t[r]:t[r]=e})._stringRef=r,e);throw Error("Missing owner for string ref "+n+". This error is likely caused by a bug in React. Please file an issue.")}if("string"!=typeof n)throw Error("Expected ref to be a function, a string, an object returned by React.createRef(), or null.");if(!i._owner)throw Error("Element ref was specified as a string ("+n+") but no owner was set. This could happen for one of the following reasons:\n1. You may be adding a ref to a function component\n2. You may be adding a ref to a component that was not created inside a component's render method\n3. You have multiple copies of React loaded\nSee https://reactjs.org/link/refs-must-have-owner for more information.")}return n}function _h(e,t){if("textarea"!==e.type)throw Error("Objects are not valid as a React child (found: "+("[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}function yh(e){e=se(e.type)||"Component";gh[e]||(gh[e]=!0,ee("Functions are not valid as a React child. This may happen if you return a Component instead of <Component /> from render. Or maybe you meant to call this function rather than return it."))}function vh(V){function j(e,t){var i;V&&(null!==(i=e.lastEffect)?(i.nextEffect=t,e.lastEffect=t):e.firstEffect=e.lastEffect=t,t.nextEffect=null,t.flags=Xn)}function W(e,t){if(V)for(var i=t;null!==i;)j(e,i),i=i.sibling;return null}function z(e,t){for(var i=new Map,n=t;null!==n;)null!==n.key?i.set(n.key,n):i.set(n.index,n),n=n.sibling;return i}function Y(e,t){e=T_(e,t);return e.index=0,e.sibling=null,e}function K(e,t,i){return e.index=i,V?null===(i=e.alternate)||(i=i.index)<t?(e.flags=ae,t):i:t}function X(e){return V&&null===e.alternate&&(e.flags=ae),e}function s(e,t,i,n){return null===t||t.tag!==oe?((n=w_(i,e.mode,n)).return=e,n):((n=Y(t,i)).return=e,n)}function a(e,t,i,n){if(null!==t&&(t.elementType===i.type||u_(t,i)))return(o=Y(t,i.props)).ref=bh(e,t,i),o.return=e,o._debugSource=i._source,o._debugOwner=i._owner,o;var o=k_(i,e.mode,n);return o.ref=bh(e,t,i),o.return=e,o}function l(e,t,i,n){return null===t||t.tag!==ne||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?((n=S_(i,e.mode,n)).return=e,n):((n=Y(t,i.children||[])).return=e,n)}function c(e,t,i,n,o){return null===t||t.tag!==le?((n=C_(i,e.mode,n,o)).return=e,n):((o=Y(t,i)).return=e,o)}function q(e,t,i){var n;if("string"==typeof t||"number"==typeof t)return(n=w_(""+t,e.mode,i)).return=e,n;if("object"==typeof t&&null!==t){switch(t.$$typeof){case Be:var o=k_(t,e.mode,i);return o.ref=bh(e,null,t),o.return=e,o;case Fe:o=S_(t,e.mode,i);return o.return=e,o}if(mh(t)||nt(t))return(n=C_(t,e.mode,i,null)).return=e,n;_h(e,t)}return"function"==typeof t&&yh(e),null}function J(e,t,i,n){var o=null!==t?t.key:null;if("string"==typeof i||"number"==typeof i)return null!==o?null:s(e,t,""+i,n);if("object"==typeof i&&null!==i){switch(i.$$typeof){case Be:return i.key===o?i.type===Ue?c(e,t,i.props.children,n,o):a(e,t,i,n):null;case Fe:return i.key===o?l(e,t,i,n):null}if(mh(i)||nt(i))return null!==o?null:c(e,t,i,n,null);_h(e,i)}return"function"==typeof i&&yh(e),null}function Z(e,t,i,n,o){if("string"==typeof n||"number"==typeof n)return s(t,e.get(i)||null,""+n,o);if("object"==typeof n&&null!==n){switch(n.$$typeof){case Be:var r=e.get(null===n.key?i:n.key)||null;return n.type===Ue?c(t,r,n.props.children,o,n.key):a(t,r,n,o);case Fe:return l(t,e.get(null===n.key?i:n.key)||null,n,o)}if(mh(n)||nt(n))return c(t,e.get(i)||null,n,o,null);_h(t,n)}return"function"==typeof n&&yh(t),null}function Q(e,t,i){if("object"==typeof e&&null!==e)switch(e.$$typeof){case Be:case Fe:fh(e,i);var n=e.key;"string"==typeof n&&(null===t?(t=new Set).add(n):t.has(n)?ee("Encountered two children with the same key, `%s`. Keys should be unique so that components maintain their identity across updates. Non-unique keys may cause children to be duplicated and/or omitted â€” the behavior is unsupported and could change in a future version.",n):t.add(n))}return t}return function(e,t,i,n){var o,$="object"==typeof i&&null!==i&&i.type===Ue&&null===i.key,P="object"==typeof(i=$?i.props.children:i)&&null!==i;if(P)switch(i.$$typeof){case Be:return X(((e,t,i,n)=>{for(var o,r,s=i.key,a=t;null!==a;){if(a.key===s){if(a.tag===le){if(i.type===Ue)return W(e,a.sibling),(o=Y(a,i.props.children)).return=e,o._debugSource=i._source,o._debugOwner=i._owner,o}else if(a.elementType===i.type||u_(a,i))return W(e,a.sibling),(o=Y(a,i.props)).ref=bh(e,a,i),o.return=e,o._debugSource=i._source,o._debugOwner=i._owner,o;W(e,a);break}j(e,a),a=a.sibling}return i.type===Ue?((r=C_(i.props.children,e.mode,n,i.key)).return=e,r):((r=k_(i,e.mode,n)).ref=bh(e,t,i),r.return=e,r)})(e,t,i,n));case Fe:return X(((e,t,i,n)=>{for(var o,r=i.key,s=t;null!==s;){if(s.key===r){if(s.tag===ne&&s.stateNode.containerInfo===i.containerInfo&&s.stateNode.implementation===i.implementation)return W(e,s.sibling),(o=Y(s,i.children||[])).return=e,o;W(e,s);break}j(e,s),s=s.sibling}return(t=S_(i,e.mode,n)).return=e,t})(e,t,i,n))}if("string"==typeof i||"number"==typeof i)return X((C=e,T=""+i,E=n,null!==(s=t)&&s.tag===oe?(W(C,s.sibling),(o=Y(s,T)).return=C):(W(C,s),(o=w_(T,C.mode,E)).return=C),o));if(mh(i)){for(var r=e,s=t,a=i,l=n,B=null,c=0;c<a.length;c++)B=Q(a[c],B,r);for(var u=null,d=null,h=s,p=0,g=0,f=null;null!==h&&g<a.length;g++){h.index>g?(f=h,h=null):f=h.sibling;var m=J(r,h,a[g],l);if(null===m){null===h&&(h=f);break}V&&h&&null===m.alternate&&j(r,h),p=K(m,p,g),null===d?u=m:d.sibling=m,d=m,h=f}if(g===a.length)W(r,h);else if(null===h)for(;g<a.length;g++){var b=q(r,a[g],l);null!==b&&(p=K(b,p,g),null===d?u=b:d.sibling=b,d=b)}else{for(var _=z(0,h);g<a.length;g++){var y=Z(_,r,g,a[g],l);null!==y&&(V&&null!==y.alternate&&_.delete(null===y.key?g:y.key),p=K(y,p,g),null===d?u=y:d.sibling=y,d=y)}V&&_.forEach(function(e){return j(r,e)})}return u}if(nt(i)){var v=e,T=t,E=i,k=n,C=nt(E);if("function"!=typeof C)throw Error("An object is not an iterable. This error is likely caused by a bug in React. Please file an issue.");"function"==typeof Symbol&&"Generator"===E[Symbol.toStringTag]&&(dh||ee("Using Generators as children is unsupported and will likely yield unexpected results because enumerating a generator mutates it. You may convert it to an array with `Array.from()` or the `[...spread]` operator before rendering. Keep in mind you might need to polyfill these features for older browsers."),dh=!0),E.entries===C&&(oh||ee("Using Maps as children is not supported. Use an array of keyed ReactElements instead."),oh=!0);var F=C.call(E);if(F)for(var U=null,H=F.next();!H.done;H=F.next())U=Q(H.value,U,v);var I=C.call(E);if(null==I)throw Error("An iterable object provided no iterator.");for(var w=null,S=null,x=T,R=0,O=0,A=null,N=I.next();null!==x&&!N.done;O++,N=I.next()){x.index>O?(A=x,x=null):A=x.sibling;var L=J(v,x,N.value,k);if(null===L){null===x&&(x=A);break}V&&x&&null===L.alternate&&j(v,x),R=K(L,R,O),null===S?w=L:S.sibling=L,S=L,x=A}if(N.done)W(v,x);else if(null===x)for(;!N.done;O++,N=I.next()){var D=q(v,N.value,k);null!==D&&(R=K(D,R,O),null===S?w=D:S.sibling=D,S=D)}else{for(var G=z(0,x);!N.done;O++,N=I.next()){var M=Z(G,v,O,N.value,k);null!==M&&(V&&null!==M.alternate&&G.delete(null===M.key?O:M.key),R=K(M,R,O),null===S?w=M:S.sibling=M,S=M)}V&&G.forEach(function(e){return j(v,e)})}return w}if(P&&_h(e,i),"function"==typeof i&&yh(e),void 0===i&&!$)switch(e.tag){case ie:if(e.stateNode.render._isMockFunction)break;case fe:case te:case re:case ce:throw Error((se(e.type)||"Component")+"(...): Nothing was returned from render. This usually means a return statement is missing. Or, to render nothing, return null.")}return W(e,t)}}var Th=vh(!0),Eh=vh(!1);function kh(e,t){for(var i,n,o,r=e.child;null!==r;)n=t,o=void 0,(i=r).flags&=ae,i.nextEffect=null,i.firstEffect=null,(i.lastEffect=null)===(o=i.alternate)?(i.childLanes=W,i.lanes=n,i.child=null,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null,i.selfBaseDuration=0,i.treeBaseDuration=0):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=null===n?null:{lanes:n.lanes,firstContext:n.firstContext},i.selfBaseDuration=o.selfBaseDuration,i.treeBaseDuration=o.treeBaseDuration),r=r.sibling}var Ch={},Ih=Wc(Ch),wh=Wc(Ch),Sh=Wc(Ch);function xh(e){if(e===Ch)throw Error("Expected host context to exist. This error is likely caused by a bug in React. Please file an issue.");return e}function Rh(){return xh(Sh.current)}function Oh(e,t){Yc(Sh,t,e),Yc(wh,e,e),Yc(Ih,Ch,e);t=(e=>{var t=e.nodeType;switch(t){case Ii:case wi:var i=t===Ii?"#document":"#fragment",n=e.documentElement,o=n?n.namespaceURI:_i(null,"");break;default:n=t===Ci?e.parentNode:e;o=_i(n.namespaceURI||null,i=n.tagName)}var r=i.toLowerCase();return{namespace:o,ancestorInfo:Wl(null,r)}})(t);zc(Ih,e),Yc(Ih,t,e)}function Ah(e){zc(Ih,e),zc(wh,e),zc(Sh,e)}function Nh(){return xh(Ih.current)}function Lh(e){xh(Sh.current);var t,i=xh(Ih.current),n=(n=i,t=e.type,{namespace:_i(n.namespace,t),ancestorInfo:Wl(n.ancestorInfo,t)});i!==n&&(Yc(wh,e,e),Yc(Ih,n,e))}function Dh(e){wh.current===e&&(zc(Ih,e),zc(wh,e))}var Mh=1,$h=1,Ph=2,Bh=Wc(0);function Fh(e){return e&Mh}function Uh(e,t){return e&Mh|t}function Hh(e,t){Yc(Bh,t,e)}function Gh(e){zc(Bh,e)}function Vh(e){for(var t=e;null!==t;){if(t.tag===H){var i=t.memoizedState;if(null!==i){i=i.dehydrated;if(null===i||i.data===tc||i.data===ic)return t}}else if(t.tag===he&&void 0!==t.memoizedProps.revealOrder){if((t.flags&j)!==G)return t}else if(null!==t.child){t=(t.child.return=t).child;continue}if(t===e)return null;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var jh=0,Wh=1,zh=2,Yh=4,Kh=null,Xh=null,qh=!1;function Jh(e,t){switch(e.tag){case F:i=e.stateNode.containerInfo,(n=t).nodeType===Ei?Bl(i,n):n.nodeType!==Ci&&Fl(i,n);break;case U:e.type,i=e.stateNode,n=t,!0!==e.memoizedProps[Zl]&&(n.nodeType===Ei?Bl(i,n):n.nodeType!==Ci&&Fl(i,n))}(o=y_(U,null,null,b)).elementType="DELETED",o.type="DELETED";var i,n,o;o.stateNode=t,o.return=e,o.flags=Xn,null!==e.lastEffect?(e.lastEffect.nextEffect=o,e.lastEffect=o):e.firstEffect=e.lastEffect=o}function Zh(e,t){switch(t.flags=t.flags&~io|ae,e.tag){case F:var i=e.stateNode.containerInfo;switch(t.tag){case U:var n=t.type;Ul(i,n);break;case oe:n=t.pendingProps;Hl(i,n)}break;case U:e.type;var o=e.memoizedProps,r=e.stateNode;switch(t.tag){case U:var s=t.type;l=r,s=s,!0!==o[Zl]&&Ul(l,s);break;case oe:l=t.pendingProps;s=r,a=l,!0!==o[Zl]&&Hl(s,a);break;case H:o[Zl]}}var a,l}function Qh(e,t){switch(e.tag){case U:var i=e.type,i=(i=i,(n=t).nodeType!==Ei||i.toLowerCase()!==n.nodeName.toLowerCase()?null:n);return null!==i?(e.stateNode=i,1):void 0;case oe:var n=e.pendingProps,o=(i=t,""===n||i.nodeType!==ki?null:i);return null!==o?(e.stateNode=o,1):void 0;default:return}var n}function ep(e){if(qh){var t=Xh;if(t){var i=t;if(!Qh(e,t)){if(!(t=Tc(i))||!Qh(e,t))return Zh(Kh,e),qh=!1,void(Kh=e);Jh(Kh,i)}Kh=e,Xh=Ec(t)}else Zh(Kh,e),qh=!1,Kh=e}}function tp(e,t,i){var n,o,r=e.stateNode,r=(n=e.type,o=e.memoizedProps,i=i,Rc(e,r=r),$c(r,o),$l(r,n,o,i.namespace));return null!==(e.updateQueue=r)}function ip(e){var t,i,n,o=e.stateNode,r=e.memoizedProps,e=(t=r,Rc(e,e=o),e.nodeValue!==t);if(e){var s=Kh;if(null!==s)switch(s.tag){case F:s.stateNode.containerInfo;Pl(o,r);break;case U:s.type;var a=s.memoizedProps;s.stateNode;i=o,n=r,!0!==a[Zl]&&Pl(i,n)}}return e}function np(e){e=e.memoizedState,e=null!==e?e.dehydrated:null;if(e){for(var t=e.nextSibling,i=0;t;){if(t.nodeType===Ci){var n=t.data;if(n===ec){if(0===i)return Tc(t);i--}else n!==Ql&&n!==ic&&n!==tc||i++}t=t.nextSibling}return null}throw Error("Expected to have a hydrated suspense instance. This error is likely caused by a bug in React. Please file an issue.")}function op(e){for(var t=e.return;null!==t&&t.tag!==U&&t.tag!==F&&t.tag!==H;)t=t.return;Kh=t}function rp(e){if(e!==Kh)return!1;if(!qh)return op(e),!(qh=!0);var t=e.type;if(e.tag!==U||"head"!==t&&"body"!==t&&!cc(t,e.memoizedProps))for(var i=Xh;i;)Jh(e,i),i=Tc(i);return op(e),Xh=e.tag===H?np(e):Kh?Tc(e.stateNode):null,!0}function sp(){Xh=Kh=null,qh=!1}var ap=[];function lp(){for(var e=0;e<ap.length;e++)ap[e]._workInProgressVersionPrimary=null;ap.length=0}function cp(e,t){e._workInProgressVersionPrimary=t,ap.push(e)}var up={},_=d.ReactCurrentDispatcher,dp=d.ReactCurrentBatchConfig,hp={},pp=new Set,gp=W,v=null,fp=null,mp=null,bp=!1,_p=!1,yp=25,l=null,vp=null,Tp=-1,Ep=!1;function o(){var e=l;null===vp?vp=[e]:vp.push(e)}function r(){var e=l;if(null!==vp&&vp[++Tp]!==e){var t=e,e=se(v.type);if(!pp.has(e)&&(pp.add(e),null!==vp)){for(var i="",n=0;n<=Tp;n++){for(var o=vp[n],r=n===Tp?t:o,s=n+1+". "+o;s.length<30;)s+=" ";i+=s+=r+"\n"}ee("React has detected a change in the order of Hooks called by %s. This will lead to bugs and errors if not fixed. For more information, read the Rules of Hooks: https://reactjs.org/link/rules-of-hooks\n\n   Previous render            Next render\n   ------------------------------------------------------\n%s   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n",e,i)}}}function kp(e){null==e||Array.isArray(e)||ee("%s received a final argument that is not an array (instead, received `%s`). When specified, the final argument must be an array.",l,typeof e)}function Cp(){throw Error("Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for one of the following reasons:\n1. You might have mismatching versions of React and the renderer (such as React DOM)\n2. You might be breaking the Rules of Hooks\n3. You might have more than one copy of React in the same app\nSee https://reactjs.org/link/invalid-hook-call for tips about how to debug and fix this problem.")}function Ip(e,t){if(!Ep){if(null!==t){e.length!==t.length&&ee("The final argument passed to %s changed size between renders. The order and size of this array must remain constant.\n\nPrevious: %s\nIncoming: %s",l,"["+t.join(", ")+"]","["+e.join(", ")+"]");for(var i=0;i<t.length&&i<e.length;i++)if(!Ia(e[i],t[i]))return;return 1}ee("%s received a final argument during this render, but not during the previous render. Even though the final argument is optional, its type cannot change between renders.",l)}}function wp(e,t,i,n,o,r){gp=r,v=t,vp=null!==e?e._debugHookTypes:null,Tp=-1,Ep=null!==e&&e.type!==t.type,t.memoizedState=null,t.updateQueue=null,t.lanes=W,null!==e&&null!==e.memoizedState?_.current=Eg:_.current=null!==vp?Tg:vg;var s=i(n,o);if(_p){var a=0;do{if(_p=!1,!(a<yp))throw Error("Too many re-renders. React limits the number of renders to prevent an infinite loop.")}while(a+=1,Ep=!1,mp=fp=null,t.updateQueue=null,Tp=-1,_.current=kg,s=i(n,o),_p)}_.current=yg,t._debugHookTypes=vp;r=null!==fp&&null!==fp.next;if(gp=W,vp=l=mp=fp=v=null,bp=!(Tp=-1),r)throw Error("Rendered fewer hooks than expected. This may be caused by an accidental early return statement.");return s}function Sp(e,t,i){t.updateQueue=e.updateQueue,t.flags&=~(eo|V),e.lanes=e.lanes&~i}function xp(){if(_.current=yg,bp){for(var e=v.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}bp=!1}gp=W,l=vp=mp=fp=v=null,hg=!(Tp=-1),_p=!1}function Rp(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===mp?v.memoizedState=mp=e:mp=mp.next=e,mp}function Op(){var e;if(e=null===fp?null!==(e=v.alternate)?e.memoizedState:null:fp.next,null!==(t=null===mp?v.memoizedState:mp.next))t=(mp=t).next,fp=e;else{if(null===e)throw Error("Rendered more hooks than during the previous render.");var t={memoizedState:(fp=e).memoizedState,baseState:fp.baseState,baseQueue:fp.baseQueue,queue:fp.queue,next:null};null===mp?v.memoizedState=mp=t:mp=mp.next=t}return mp}function Ap(e,t){return"function"==typeof t?t(e):t}function Np(e,t,i){var n=Rp(),i=void 0!==i?i(t):t,t=(n.memoizedState=n.baseState=i,n.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:i}),e=t.dispatch=bg.bind(null,v,t);return[n.memoizedState,e]}function Lp(e){var t=Op(),i=t.queue;if(null===i)throw Error("Should have a queue. This is likely a bug in React. Please file an issue.");i.lastRenderedReducer=e;var n,o,r=fp,s=r.baseQueue,a=i.pending;if(null!==a&&(null!==s&&(n=s.next,o=a.next,s.next=o,a.next=n),r.baseQueue!==s&&ee("Internal error: Expected work-in-progress queue to be a clone. This is a bug in React."),r.baseQueue=s=a,i.pending=null),null!==s){var l=s.next,c=r.baseState,u=null,d=null,h=null,p=l;do{var g,f=p.lane}while(Jr(gp,f)?(null!==h&&(g={lane:Cr,action:p.action,eagerReducer:p.eagerReducer,eagerState:p.eagerState,next:null},h=h.next=g),c=p.eagerReducer===e?p.eagerState:e(c,p.action)):(g={lane:f,action:p.action,eagerReducer:p.eagerReducer,eagerState:p.eagerState,next:null},null===h?(d=h=g,u=c):h=h.next=g,v.lanes=v.lanes|f,Tb(f)),null!==(p=p.next)&&p!==l);null===h?u=c:h.next=d,Ia(c,t.memoizedState)||Ef(),t.memoizedState=c,t.baseState=u,t.baseQueue=h,i.lastRenderedState=c}return[t.memoizedState,i.dispatch]}function Dp(e){var t=Op(),i=t.queue;if(null===i)throw Error("Should have a queue. This is likely a bug in React. Please file an issue.");i.lastRenderedReducer=e;var n=i.dispatch,o=i.pending,r=t.memoizedState;if(null!==o){i.pending=null;var s=o.next,a=s;do{r=e(r,a.action),a=a.next}while(a!==s);Ia(r,t.memoizedState)||Ef(),t.memoizedState=r,null===t.baseQueue&&(t.baseState=r),i.lastRenderedState=r}return[r,n]}function Mp(e,t,i){null==(n=t)._currentPrimaryRenderer?n._currentPrimaryRenderer=up:n._currentPrimaryRenderer!==up&&ee("Detected multiple renderers concurrently rendering the same mutable source. This is currently unsupported.");var n=(0,t._getVersion)(t._source),o=!1,r=t._workInProgressVersionPrimary;if(null!==r?o=r===n:(o=Jr(gp,e.mutableReadLanes))&&cp(t,n),o)return"function"==typeof(r=i(t._source))&&ee("Mutable source should not return a function as the snapshot value. Functions may close over mutable values and cause tearing."),r;throw ap.push(t),Error("Cannot read from mutable source during the current render without tearing. This is a bug in React. Please file an issue.")}function $p(e,s,a,t){var l=_m;if(null===l)throw Error("Expected a work-in-progress root. This is a bug in React. Please file an issue.");var c=s._getVersion,u=c(s._source),i=_.current,n=i.useState(function(){return Mp(l,s,a)}),o=n[0],d=n[1],h=o,n=mp,o=e.memoizedState,p=o.refs,r=p.getSnapshot,g=o.source,o=o.subscribe,f=v;return e.memoizedState={refs:p,source:s,subscribe:t},i.useEffect(function(){p.getSnapshot=a,p.setSnapshot=d;var e=c(s._source);if(!Ia(u,e)){var e=a(s._source),e=("function"==typeof e&&ee("Mutable source should not return a function as the snapshot value. Functions may close over mutable values and cause tearing."),Ia(h,e)||(d(e),e=nb(f),ts(l,e)),l),t=l.mutableReadLanes;e.entangledLanes|=t;for(var i=e.entanglements,n=t;0<n;){var o=Xr(n),r=1<<o;i[o]|=t,n&=~r}}},[a,s,t]),i.useEffect(function(){var e=t(s._source,function(){var e=p.getSnapshot,t=p.setSnapshot;try{t(e(s._source));var i=nb(f);ts(l,i)}catch(e){t(function(){throw e})}});return"function"!=typeof e&&ee("Mutable source subscribe function must return an unsubscribe function."),e},[s,t]),Ia(r,a)&&Ia(g,s)&&Ia(o,t)||((e={pending:null,dispatch:null,lastRenderedReducer:Ap,lastRenderedState:h}).dispatch=d=bg.bind(null,v,e),n.queue=e,n.baseQueue=null,h=Mp(l,s,a),n.memoizedState=n.baseState=h),h}function Pp(e,t,i){var n=Rp();return n.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:i},$p(n,e,t,i)}function Bp(e,t,i){return $p(Op(),e,t,i)}function Fp(e){var t=Rp(),e=("function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,t.queue={pending:null,dispatch:null,lastRenderedReducer:Ap,lastRenderedState:e}),e=e.dispatch=bg.bind(null,v,e);return[t.memoizedState,e]}function Up(){return Lp(Ap)}function Hp(){return Dp(Ap)}function Gp(e,t,i,n){e={tag:e,create:t,destroy:i,deps:n,next:null},t=v.updateQueue;return null===t?(v.updateQueue=t={lastEffect:null}).lastEffect=e.next=e:null===(i=t.lastEffect)?t.lastEffect=e.next=e:(n=i.next,(i.next=e).next=n,t.lastEffect=e),e}function Vp(e){var t=Rp(),e={current:e};return Object.seal(e),t.memoizedState=e}function jp(){return Op().memoizedState}function Wp(e,t,i,n){var o=Rp(),n=void 0===n?null:n;v.flags|=e,o.memoizedState=Gp(Wh|t,i,void 0,n)}function zp(e,t,i,n){var o=Op(),n=void 0===n?null:n,r=void 0;if(null!==fp){var s=fp.memoizedState,r=s.destroy;if(null!==n)if(Ip(n,s.deps))return void Gp(t,i,r,n)}v.flags|=e,o.memoizedState=Gp(Wh|t,i,r,n)}function Yp(e,t){return"undefined"!=typeof jest&&zb(v),Wp(V|eo,Yh,e,t)}function Kp(e,t){return"undefined"!=typeof jest&&zb(v),zp(V|eo,Yh,e,t)}function Xp(e,t){return Wp(V,zh,e,t)}function qp(e,t){return zp(V,zh,e,t)}function Jp(e,t){var i,n,o;return"function"==typeof t?(i=t,o=e(),i(o),function(){i(null)}):null!=t?((n=t).hasOwnProperty("current")||ee("Expected useImperativeHandle() first argument to either be a ref callback or React.createRef() object. Instead received: %s.","an object with keys {"+Object.keys(n).join(", ")+"}"),o=e(),n.current=o,function(){n.current=null}):void 0}function Zp(e,t,i){"function"!=typeof t&&ee("Expected useImperativeHandle() second argument to be a function that creates a handle. Instead received: %s.",null!==t?typeof t:"null");i=null!=i?i.concat([e]):null;return Wp(V,zh,Jp.bind(null,t,e),i)}function Qp(e,t,i){"function"!=typeof t&&ee("Expected useImperativeHandle() second argument to be a function that creates a handle. Instead received: %s.",null!==t?typeof t:"null");i=null!=i?i.concat([e]):null;return zp(V,zh,Jp.bind(null,t,e),i)}function eg(e,t){}var tg=eg;function ig(e,t){return Rp().memoizedState=[e,void 0===t?null:t],e}function ng(e,t){var i=Op(),t=void 0===t?null:t,n=i.memoizedState;if(null!==n&&(null!==t&&Ip(t,n[1])))return n[0];return i.memoizedState=[e,t],e}function og(e,t){var i=Rp(),t=void 0===t?null:t,e=e();return i.memoizedState=[e,t],e}function rg(e,t){var i=Op(),t=void 0===t?null:t,n=i.memoizedState;if(null!==n&&(null!==t&&Ip(t,n[1])))return n[0];n=e();return i.memoizedState=[n,t],n}function sg(t){var e=Fp(t),i=e[0],n=e[1];return Yp(function(){var e=dp.transition;dp.transition=1;try{n(t)}finally{dp.transition=e}},[t]),i}function ag(t){var e=Up(),i=e[0],n=e[1];return Kp(function(){var e=dp.transition;dp.transition=1;try{n(t)}finally{dp.transition=e}},[t]),i}function lg(t){var e=Hp(),i=e[0],n=e[1];return Kp(function(){var e=dp.transition;dp.transition=1;try{n(t)}finally{dp.transition=e}},[t]),i}function cg(){var e=Fp(!1),t=e[0],e=function(t,i){var e=Vu();Wu(e<Au?Au:e,function(){t(!0)}),Wu(Nu<e?Nu:e,function(){var e=dp.transition;dp.transition=1;try{t(!1),i()}finally{dp.transition=e}})}.bind(null,e[1]);return Vp(e),[e,t]}function ug(){var e=Up()[0];return[jp().current,e]}function dg(){var e=Hp()[0];return[jp().current,e]}var hg=!1;function pg(e){e=se(e.type)||"Unknown";St&&!hp[e]&&(ee("The object passed back from useOpaqueIdentifier is meant to be passed through to attributes only. Do not read the value directly."),hp[e]=!0)}function gg(){var e,t,i,n,o=function(e){var t="r:"+(Cc++).toString(36);return{toString:function(){return e(),t},valueOf:function(){return e(),t}}}.bind(null,pg.bind(null,v));return qh?(e=!1,t=v,n={$$typeof:Je,toString:n=function(){throw e||(hg=e=!0,i(o()),hg=!1,pg(t)),Error("The object passed back from useOpaqueIdentifier is meant to be passed through to attributes only. Do not read the value directly.")},valueOf:n},i=Fp(n)[1],(v.mode&qu)===b&&(v.flags|=V|eo,Gp(Wh|Yh,function(){i(o())},void 0,null)),n):(Fp(n=o()),n)}function fg(){return Up()[0]}function mg(){return Hp()[0]}function bg(e,t,i){"function"==typeof arguments[3]&&ee("State updates from the useState() and useReducer() Hooks don't support the second callback argument. To execute a side effect after rendering, declare it in the component body with useEffect().");var n=ib(),o=nb(e),r={lane:o,action:i,eagerReducer:null,eagerState:null,next:null},s=t.pending,s=(null===s?r.next=r:(r.next=s.next,s.next=r),t.pending=r,e.alternate);if(e===v||null!==s&&s===v)_p=bp=!0;else{if(e.lanes===W&&(null===s||s.lanes===W)){s=t.lastRenderedReducer;if(null!==s){var a=_.current;_.current=Ig;try{var l=t.lastRenderedState,c=s(l,i);if(r.eagerReducer=s,Ia(r.eagerState=c,l))return}catch(e){}finally{_.current=a}}}"undefined"!=typeof jest&&(Wb(e),Yb(e)),ob(e,o,n)}}function _g(){ee("Context can only be read while React is rendering. In classes, you can read it in the render method or getDerivedStateFromProps. In function components, you can read it directly in the function body, but not inside Hooks like useReducer() or useMemo().")}function s(){ee("Do not call Hooks inside useEffect(...), useMemo(...), or other built-in Hooks. You can only call Hooks at the top level of your React function. For more information, see https://reactjs.org/link/rules-of-hooks")}var yg={readContext:Y,useCallback:Cp,useContext:Cp,useEffect:Cp,useImperativeHandle:Cp,useLayoutEffect:Cp,useMemo:Cp,useReducer:Cp,useRef:Cp,useState:Cp,useDebugValue:Cp,useDeferredValue:Cp,useTransition:Cp,useMutableSource:Cp,useOpaqueIdentifier:Cp,unstable_isNewReconciler:!1},vg=null,Tg=null,Eg=null,kg=null,Cg=null,Ig=null,wg=null,vg={readContext:Y,useCallback:function(e,t){return l="useCallback",o(),kp(t),ig(e,t)},useContext:function(e,t){return l="useContext",o(),Y(e,t)},useEffect:function(e,t){return l="useEffect",o(),kp(t),Yp(e,t)},useImperativeHandle:function(e,t,i){return l="useImperativeHandle",o(),kp(i),Zp(e,t,i)},useLayoutEffect:function(e,t){return l="useLayoutEffect",o(),kp(t),Xp(e,t)},useMemo:function(e,t){l="useMemo",o(),kp(t);var i=_.current;_.current=Cg;try{return og(e,t)}finally{_.current=i}},useReducer:function(e,t,i){l="useReducer",o();var n=_.current;_.current=Cg;try{return Np(e,t,i)}finally{_.current=n}},useRef:function(e){return l="useRef",o(),Vp(e)},useState:function(e){l="useState",o();var t=_.current;_.current=Cg;try{return Fp(e)}finally{_.current=t}},useDebugValue:function(e,t){l="useDebugValue",o()},useDeferredValue:function(e){return l="useDeferredValue",o(),sg(e)},useTransition:function(){return l="useTransition",o(),cg()},useMutableSource:function(e,t,i){return l="useMutableSource",o(),Pp(e,t,i)},useOpaqueIdentifier:function(){return l="useOpaqueIdentifier",o(),gg()},unstable_isNewReconciler:!1},Tg={readContext:Y,useCallback:function(e,t){return l="useCallback",r(),ig(e,t)},useContext:function(e,t){return l="useContext",r(),Y(e,t)},useEffect:function(e,t){return l="useEffect",r(),Yp(e,t)},useImperativeHandle:function(e,t,i){return l="useImperativeHandle",r(),Zp(e,t,i)},useLayoutEffect:function(e,t){return l="useLayoutEffect",r(),Xp(e,t)},useMemo:function(e,t){l="useMemo",r();var i=_.current;_.current=Cg;try{return og(e,t)}finally{_.current=i}},useReducer:function(e,t,i){l="useReducer",r();var n=_.current;_.current=Cg;try{return Np(e,t,i)}finally{_.current=n}},useRef:function(e){return l="useRef",r(),Vp(e)},useState:function(e){l="useState",r();var t=_.current;_.current=Cg;try{return Fp(e)}finally{_.current=t}},useDebugValue:function(e,t){l="useDebugValue",r()},useDeferredValue:function(e){return l="useDeferredValue",r(),sg(e)},useTransition:function(){return l="useTransition",r(),cg()},useMutableSource:function(e,t,i){return l="useMutableSource",r(),Pp(e,t,i)},useOpaqueIdentifier:function(){return l="useOpaqueIdentifier",r(),gg()},unstable_isNewReconciler:!1},Eg={readContext:Y,useCallback:function(e,t){return l="useCallback",r(),ng(e,t)},useContext:function(e,t){return l="useContext",r(),Y(e,t)},useEffect:function(e,t){return l="useEffect",r(),Kp(e,t)},useImperativeHandle:function(e,t,i){return l="useImperativeHandle",r(),Qp(e,t,i)},useLayoutEffect:function(e,t){return l="useLayoutEffect",r(),qp(e,t)},useMemo:function(e,t){l="useMemo",r();var i=_.current;_.current=Ig;try{return rg(e,t)}finally{_.current=i}},useReducer:function(e,t,i){l="useReducer",r();var n=_.current;_.current=Ig;try{return Lp(e)}finally{_.current=n}},useRef:function(e){return l="useRef",r(),jp()},useState:function(e){l="useState",r();var t=_.current;_.current=Ig;try{return Up()}finally{_.current=t}},useDebugValue:function(e,t){return l="useDebugValue",r(),tg()},useDeferredValue:function(e){return l="useDeferredValue",r(),ag(e)},useTransition:function(){return l="useTransition",r(),ug()},useMutableSource:function(e,t,i){return l="useMutableSource",r(),Bp(e,t,i)},useOpaqueIdentifier:function(){return l="useOpaqueIdentifier",r(),fg()},unstable_isNewReconciler:!1},kg={readContext:Y,useCallback:function(e,t){return l="useCallback",r(),ng(e,t)},useContext:function(e,t){return l="useContext",r(),Y(e,t)},useEffect:function(e,t){return l="useEffect",r(),Kp(e,t)},useImperativeHandle:function(e,t,i){return l="useImperativeHandle",r(),Qp(e,t,i)},useLayoutEffect:function(e,t){return l="useLayoutEffect",r(),qp(e,t)},useMemo:function(e,t){l="useMemo",r();var i=_.current;_.current=wg;try{return rg(e,t)}finally{_.current=i}},useReducer:function(e,t,i){l="useReducer",r();var n=_.current;_.current=wg;try{return Dp(e)}finally{_.current=n}},useRef:function(e){return l="useRef",r(),jp()},useState:function(e){l="useState",r();var t=_.current;_.current=wg;try{return Hp()}finally{_.current=t}},useDebugValue:function(e,t){return l="useDebugValue",r(),tg()},useDeferredValue:function(e){return l="useDeferredValue",r(),lg(e)},useTransition:function(){return l="useTransition",r(),dg()},useMutableSource:function(e,t,i){return l="useMutableSource",r(),Bp(e,t,i)},useOpaqueIdentifier:function(){return l="useOpaqueIdentifier",r(),mg()},unstable_isNewReconciler:!1},Cg={readContext:function(e,t){return _g(),Y(e,t)},useCallback:function(e,t){return l="useCallback",s(),o(),ig(e,t)},useContext:function(e,t){return l="useContext",s(),o(),Y(e,t)},useEffect:function(e,t){return l="useEffect",s(),o(),Yp(e,t)},useImperativeHandle:function(e,t,i){return l="useImperativeHandle",s(),o(),Zp(e,t,i)},useLayoutEffect:function(e,t){return l="useLayoutEffect",s(),o(),Xp(e,t)},useMemo:function(e,t){l="useMemo",s(),o();var i=_.current;_.current=Cg;try{return og(e,t)}finally{_.current=i}},useReducer:function(e,t,i){l="useReducer",s(),o();var n=_.current;_.current=Cg;try{return Np(e,t,i)}finally{_.current=n}},useRef:function(e){return l="useRef",s(),o(),Vp(e)},useState:function(e){l="useState",s(),o();var t=_.current;_.current=Cg;try{return Fp(e)}finally{_.current=t}},useDebugValue:function(e,t){l="useDebugValue",s(),o()},useDeferredValue:function(e){return l="useDeferredValue",s(),o(),sg(e)},useTransition:function(){return l="useTransition",s(),o(),cg()},useMutableSource:function(e,t,i){return l="useMutableSource",s(),o(),Pp(e,t,i)},useOpaqueIdentifier:function(){return l="useOpaqueIdentifier",s(),o(),gg()},unstable_isNewReconciler:!1},Ig={readContext:function(e,t){return _g(),Y(e,t)},useCallback:function(e,t){return l="useCallback",s(),r(),ng(e,t)},useContext:function(e,t){return l="useContext",s(),r(),Y(e,t)},useEffect:function(e,t){return l="useEffect",s(),r(),Kp(e,t)},useImperativeHandle:function(e,t,i){return l="useImperativeHandle",s(),r(),Qp(e,t,i)},useLayoutEffect:function(e,t){return l="useLayoutEffect",s(),r(),qp(e,t)},useMemo:function(e,t){l="useMemo",s(),r();var i=_.current;_.current=Ig;try{return rg(e,t)}finally{_.current=i}},useReducer:function(e,t,i){l="useReducer",s(),r();var n=_.current;_.current=Ig;try{return Lp(e)}finally{_.current=n}},useRef:function(e){return l="useRef",s(),r(),jp()},useState:function(e){l="useState",s(),r();var t=_.current;_.current=Ig;try{return Up()}finally{_.current=t}},useDebugValue:function(e,t){return l="useDebugValue",s(),r(),tg()},useDeferredValue:function(e){return l="useDeferredValue",s(),r(),ag(e)},useTransition:function(){return l="useTransition",s(),r(),ug()},useMutableSource:function(e,t,i){return l="useMutableSource",s(),r(),Bp(e,t,i)},useOpaqueIdentifier:function(){return l="useOpaqueIdentifier",s(),r(),fg()},unstable_isNewReconciler:!1},wg={readContext:function(e,t){return _g(),Y(e,t)},useCallback:function(e,t){return l="useCallback",s(),r(),ng(e,t)},useContext:function(e,t){return l="useContext",s(),r(),Y(e,t)},useEffect:function(e,t){return l="useEffect",s(),r(),Kp(e,t)},useImperativeHandle:function(e,t,i){return l="useImperativeHandle",s(),r(),Qp(e,t,i)},useLayoutEffect:function(e,t){return l="useLayoutEffect",s(),r(),qp(e,t)},useMemo:function(e,t){l="useMemo",s(),r();var i=_.current;_.current=Ig;try{return rg(e,t)}finally{_.current=i}},useReducer:function(e,t,i){l="useReducer",s(),r();var n=_.current;_.current=Ig;try{return Dp(e)}finally{_.current=n}},useRef:function(e){return l="useRef",s(),r(),jp()},useState:function(e){l="useState",s(),r();var t=_.current;_.current=Ig;try{return Hp()}finally{_.current=t}},useDebugValue:function(e,t){return l="useDebugValue",s(),r(),tg()},useDeferredValue:function(e){return l="useDeferredValue",s(),r(),lg(e)},useTransition:function(){return l="useTransition",s(),r(),dg()},useMutableSource:function(e,t,i){return l="useMutableSource",s(),r(),Bp(e,t,i)},useOpaqueIdentifier:function(){return l="useOpaqueIdentifier",s(),r(),mg()},unstable_isNewReconciler:!1},Sg=a.unstable_now,xg=0,Rg=-1;function Og(){xg=Sg()}function Ag(e){Rg=Sg(),e.actualStartTime<0&&(e.actualStartTime=Sg())}function Ng(){Rg=-1}function Lg(e,t){var i;0<=Rg&&(i=Sg()-Rg,e.actualDuration+=i,t&&(e.selfBaseDuration=i),Rg=-1)}function Dg(e){for(var t=e.child;t;)e.actualDuration+=t.actualDuration,t=t.sibling}var Mg,$g=d.ReactCurrentOwner,Pg=!1;function Bg(e,t,i,n){t.child=null===e?Eh(t,null,i,n):Th(t,e.child,i,n)}function Fg(e,t,i,n,o){t.type!==t.elementType&&(s=i.propTypes)&&Hc(s,n,"prop",se(i));var r,s=i.render,i=t.ref;if(Sd(t,o),$g.current=t,At(!0),r=wp(e,t,s,n,i,o),t.mode&z){pt();try{r=wp(e,t,s,n,i,o)}finally{gt()}}return At(!1),null===e||Pg?(t.flags|=Yn,Bg(e,t,r,o),t.child):(Sp(e,t,o),kf(e,t,o))}function Ug(e,t,i,n,o,r){if(null===e)return s=i.type,"function"!=typeof(a=s)||v_(a)||void 0!==a.defaultProps||null!==i.compare||void 0!==i.defaultProps?((a=s.propTypes)&&Hc(a,n,"prop",se(s)),(a=E_(i.type,null,n,t,t.mode,r)).ref=t.ref,(a.return=t).child=a):(a=a_(a=s),t.tag=ce,t.type=a,rf(t,s),Hg(e,t,a,n,o,r));var s=i.type,a=s.propTypes,l=(a&&Hc(a,n,"prop",se(s)),e.child);if(!qr(o,r)){o=l.memoizedProps,i=i.compare;if((i=null!==i?i:Sa)(o,n)&&e.ref===t.ref)return kf(e,t,r)}t.flags|=Yn;i=T_(l,n);return i.ref=t.ref,(i.return=t).child=i}function Hg(e,t,i,n,o,r){if(t.type!==t.elementType){var s=t.elementType;if(s.$$typeof===Xe){var a=s,l=a._payload,a=a._init;try{s=a(l)}catch(e){s=null}a=s&&s.propTypes;a&&Hc(a,n,"prop",se(s))}}if(null!==e&&(Sa(e.memoizedProps,n)&&e.ref===t.ref&&t.type===e.type)){if(Pg=!1,!qr(r,o))return t.lanes=e.lanes,kf(e,t,r);(e.flags&lo)!==G&&(Pg=!0)}return Zg(e,t,i,n,r)}function Gg(e,t,i){var n,o=t.pendingProps,r=o.children,s=null!==e?e.memoizedState:null;if("hidden"===o.mode||"unstable-defer-without-hiding"===o.mode)if((t.mode&Ju)===b)t.memoizedState={baseLanes:W},pb(t,i);else{if(!qr(i,Ur))return o=null!==s?s.baseLanes|i:i,qb(Ur),t.lanes=t.childLanes=Ur,t.memoizedState={baseLanes:o},pb(t,o),null;t.memoizedState={baseLanes:W},pb(t,null!==s?s.baseLanes:i)}else null!==s?(n=s.baseLanes|i,t.memoizedState=null):n=i,pb(t,n);return Bg(e,t,r,i),t.child}var Vg={},jg={},Wg={},zg={},Yg=!(Mg={}),Kg={},Xg={},qg=Gg;function Jg(e,t){var i=t.ref;(null===e&&null!==i||null!==e&&e.ref!==i)&&(t.flags|=Zn)}function Zg(e,t,i,n,o){t.type!==t.elementType&&(s=i.propTypes)&&Hc(s,n,"prop",se(i));var r,s=tu(t,Qc(0,i,!0));if(Sd(t,o),$g.current=t,At(!0),r=wp(e,t,i,n,s,o),t.mode&z){pt();try{r=wp(e,t,i,n,s,o)}finally{gt()}}return At(!1),null===e||Pg?(t.flags|=Yn,Bg(e,t,r,o),t.child):(Sp(e,t,o),kf(e,t,o))}function Qg(e,t,i,n,o){var r;t.type!==t.elementType&&(c=i.propTypes)&&Hc(c,n,"prop",se(i)),nu(i)?(r=!0,lu(t)):r=!1,Sd(t,o);var s,a,l,c,u,d,h,p,g,f,m,b,_,y=null===t.stateNode?(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=ae),lh(t,i,n),uh(t,i,n,o),!0):null===e?(c=i,u=n,d=o,h=(l=t).stateNode,p=l.memoizedProps,h.props=p,g=h.context,f=c.contextType,m=Xc,m="object"==typeof f&&null!==f?Y(f):tu(l,Qc(0,c,!0)),(b="function"==typeof(f=c.getDerivedStateFromProps)||"function"==typeof h.getSnapshotBeforeUpdate)||"function"!=typeof h.UNSAFE_componentWillReceiveProps&&"function"!=typeof h.componentWillReceiveProps||p===u&&g===m||ch(l,h,u,m),Fd(),_=h.state=g=l.memoizedState,Bd(l,u,h,d),_=l.memoizedState,p!==u||g!==_||iu()||Nd?("function"==typeof f&&(nh(l,c,f,u),_=l.memoizedState),(d=Nd||sh(l,c,p,u,g,_,m))?(b||"function"!=typeof h.UNSAFE_componentWillMount&&"function"!=typeof h.componentWillMount||("function"==typeof h.componentWillMount&&h.componentWillMount(),"function"==typeof h.UNSAFE_componentWillMount&&h.UNSAFE_componentWillMount()),"function"==typeof h.componentDidMount&&(l.flags|=V)):("function"==typeof h.componentDidMount&&(l.flags|=V),l.memoizedProps=u,l.memoizedState=_),h.props=u,h.state=_,h.context=m,d):("function"==typeof h.componentDidMount&&(l.flags|=V),!1)):(f=e,p=i,g=n,b=o,_=(u=t).stateNode,Dd(f,u),m=u.memoizedProps,d=u.type===u.elementType?m:pd(u.type,m),_.props=d,h=u.pendingProps,l=_.context,y=p.contextType,s=Xc,s="object"==typeof y&&null!==y?Y(y):tu(u,Qc(0,p,!0)),(v="function"==typeof(y=p.getDerivedStateFromProps)||"function"==typeof _.getSnapshotBeforeUpdate)||"function"!=typeof _.UNSAFE_componentWillReceiveProps&&"function"!=typeof _.componentWillReceiveProps||m===h&&l===s||ch(u,_,g,s),Fd(),a=_.state=l=u.memoizedState,Bd(u,g,_,b),a=u.memoizedState,m!==h||l!==a||iu()||Nd?("function"==typeof y&&(nh(u,p,y,g),a=u.memoizedState),(b=Nd||sh(u,p,d,g,l,a,s))?(v||"function"!=typeof _.UNSAFE_componentWillUpdate&&"function"!=typeof _.componentWillUpdate||("function"==typeof _.componentWillUpdate&&_.componentWillUpdate(g,a,s),"function"==typeof _.UNSAFE_componentWillUpdate&&_.UNSAFE_componentWillUpdate(g,a,s)),"function"==typeof _.componentDidUpdate&&(u.flags|=V),"function"==typeof _.getSnapshotBeforeUpdate&&(u.flags|=Qn)):("function"!=typeof _.componentDidUpdate||m===f.memoizedProps&&l===f.memoizedState||(u.flags|=V),"function"!=typeof _.getSnapshotBeforeUpdate||m===f.memoizedProps&&l===f.memoizedState||(u.flags|=Qn),u.memoizedProps=g,u.memoizedState=a),_.props=g,_.state=a,_.context=s,b):("function"!=typeof _.componentDidUpdate||m===f.memoizedProps&&l===f.memoizedState||(u.flags|=V),"function"!=typeof _.getSnapshotBeforeUpdate||m===f.memoizedProps&&l===f.memoizedState||(u.flags|=Qn),!1)),v=ef(e,t,i,y,r,o);return y&&t.stateNode.props!==n&&(Yg||ee("It looks like %s is reassigning its own `this.props` while rendering. This is not supported and can lead to confusing bugs.",se(t.type)||"a component"),Yg=!0),v}function ef(e,t,i,n,o,r){Jg(e,t);var s=(t.flags&j)!==G;if(!n&&!s)return o&&cu(t,i,!1),kf(e,t,r);var a,l,c,n=t.stateNode;if($g.current=t,s&&"function"!=typeof i.getDerivedStateFromError)a=null,Ng();else{if(At(!0),a=n.render(),t.mode&z){pt();try{n.render()}finally{gt()}}At(!1)}return t.flags|=Yn,null!==e&&s?(s=a,c=r,(l=t).child=Th(l,e.child,null,c),l.child=Th(l,null,s,c)):Bg(e,t,a,r),t.memoizedState=n.state,o&&cu(t,i,!0),t.child}function tf(e){var t=e.stateNode;t.pendingContext?su(e,t.pendingContext,t.pendingContext!==t.context):t.context&&su(e,t.context,!1),Oh(e,t.containerInfo)}function nf(e,t,i){tf(t);var n=t.updateQueue;if(null===e||null===n)throw Error("If the root does not have an updateQueue, we should have already bailed out. This error is likely caused by a bug in React. Please file an issue.");var n=t.pendingProps,o=t.memoizedState,o=null!==o?o.element:null;Dd(e,t),Bd(t,n,null,i);n=t.memoizedState.element;if(n===o)return sp(),kf(e,t,i);var r,o=t.stateNode;if(o.hydrate&&(l=(r=t).stateNode.containerInfo,Xh=Ec(l),Kh=r,qh=!0)){var s=o.mutableSourceEagerHydrationData;if(null!=s)for(var a=0;a<s.length;a+=2)cp(s[a],s[a+1]);for(var l=Eh(t,null,n,i),c=t.child=l;c;)c.flags=c.flags&~ae|io,c=c.sibling}else Bg(e,t,n,i),sp();return t.child}function of(e,t,i,n,o){null!==e&&(e.alternate=null,t.alternate=null,t.flags|=ae);var r,e=t.pendingProps,s=i._payload,a=(0,i._init)(s),i=(t.type=a,t.tag=(e=>{if("function"==typeof e)return v_(e)?ie:te;if(null!=e){e=e.$$typeof;if(e===We)return re;if(e===Ke)return Q}return K})(a)),l=pd(a,e);switch(i){case te:return rf(t,a),t.type=a=a_(a),Zg(null,t,a,l,o);case ie:return t.type=a=l_(a),Qg(null,t,a,l,o);case re:return t.type=a=c_(a),Fg(null,t,a,l,o);case Q:return t.type!==t.elementType&&(r=a.propTypes)&&Hc(r,l,"prop",se(a)),Ug(null,t,a,pd(a.type,l),n,o)}s="";throw null!==a&&"object"==typeof a&&a.$$typeof===Xe&&(s=" Did you wrap a component in React.lazy() more than once?"),Error("Element type is invalid. Received a promise that resolves to: "+a+". Lazy element type must resolve to a class or function."+s)}function rf(e,t){var i,n;t&&t.childContextTypes&&ee("%s(...): childContextTypes cannot be defined on a function component.",t.displayName||t.name||"Component"),null!==e.ref&&(i="",(n=xt())&&(i+="\n\nCheck the render method of `"+n+"`."),n=n||e._debugID||"",(e=e._debugSource)&&(n=e.fileName+":"+e.lineNumber),Mg[n]||(Mg[n]=!0,ee("Function components cannot be given refs. Attempts to access this ref will fail. Did you mean to use React.forwardRef()?%s",i))),"function"==typeof t.getDerivedStateFromProps&&(e=se(t)||"Unknown",zg[e]||(ee("%s: Function components do not support getDerivedStateFromProps.",e),zg[e]=!0)),"object"==typeof t.contextType&&null!==t.contextType&&(n=se(t)||"Unknown",Wg[n]||(ee("%s: Function components do not support contextType.",n),Wg[n]=!0))}var sf={dehydrated:null,retryLane:Cr};function af(e){return{baseLanes:e}}function lf(e,t){return{baseLanes:e.baseLanes|t}}function cf(e,t){return e.childLanes&~t}function uf(e,t,i){var n,o,r,s,a,l,c=t.pendingProps,u=(B_(t)&&(t.flags|=j),Bh.current),d=!1;return!((t.flags&j)!==G)&&(o=u,null!==(n=e)&&null===n.memoizedState||0==(o&Ph))?null!==e&&null===e.memoizedState||void 0!==c.fallback&&!0!==c.unstable_avoidThisFallback&&(u|=$h):(d=!0,t.flags&=~j),Hh(t,u&=Mh),null===e?(void 0!==c.fallback&&ep(t),n=c.children,o=c.fallback,d?(u=df(t,n,o,i),t.child.memoizedState=af(i),t.memoizedState=sf,u):"number"==typeof c.unstable_expectedLoadTime?(u=df(t,n,o,i),t.child.memoizedState=af(i),t.memoizedState=sf,qb(t.lanes=Mr),u):(u=n,l=(a=t).mode,((u=I_({mode:"visible",children:u},l,i,null)).return=a).child=u)):null!==e.memoizedState?d?(l=c.fallback,a=c.children,u=gf(e,t,a,l,i),r=t.child,s=e.child.memoizedState,r.memoizedState=null===s?af(i):lf(s,i),r.childLanes=cf(e,i),t.memoizedState=sf,u):(s=c.children,r=pf(e,t,s,i),t.memoizedState=null,r):d?(u=c.fallback,s=c.children,r=gf(e,t,s,u,i),d=t.child,s=e.child.memoizedState,d.memoizedState=null===s?af(i):lf(s,i),d.childLanes=cf(e,i),t.memoizedState=sf,r):(u=c.children,s=pf(e,t,u,i),t.memoizedState=null,s)}function df(e,t,i,n){var o,r=e.mode,s=e.child,t={mode:"hidden",children:t},s=((r&qu)===b&&null!==s?((o=s).childLanes=W,o.pendingProps=t,e.mode&Zu&&(o.actualDuration=0,o.actualStartTime=-1,o.selfBaseDuration=0,o.treeBaseDuration=0)):o=I_(t,r,W,null),C_(i,r,n,null));return o.return=e,s.return=e,o.sibling=s,e.child=o,s}function hf(e,t){return T_(e,t)}function pf(e,t,i,n){var e=e.child,o=e.sibling,e=hf(e,{mode:"visible",children:i});return(t.mode&qu)===b&&(e.lanes=n),e.return=t,(e.sibling=null)!==o&&(o.nextEffect=null,o.flags=Xn,t.firstEffect=t.lastEffect=o),t.child=e}function gf(e,t,i,n,o){var r,s,a,l=t.mode,e=e.child,c=e.sibling,i={mode:"hidden",children:i};return(l&qu)===b&&t.child!==e?((r=t.child).childLanes=W,r.pendingProps=i,t.mode&Zu&&(r.actualDuration=0,r.actualStartTime=-1,r.selfBaseDuration=e.selfBaseDuration,r.treeBaseDuration=e.treeBaseDuration),null!==(s=r.lastEffect)?(t.firstEffect=r.firstEffect,(t.lastEffect=s).nextEffect=null):t.firstEffect=t.lastEffect=null):r=hf(e,i),null!==c?a=T_(c,n):(a=C_(n,l,o,null)).flags|=ae,a.return=t,r.return=t,r.sibling=a,t.child=r,a}function ff(e,t){e.lanes=e.lanes|t;var i=e.alternate;null!==i&&(i.lanes=i.lanes|t),wd(e.return,t)}function mf(e,t){var i=Array.isArray(e),e=!i&&"function"==typeof nt(e);if(!i&&!e)return 1;ee("A nested %s was passed to row #%s in <SuspenseList />. Wrap it in an additional SuspenseList to configure its revealOrder: <SuspenseList revealOrder=...> ... <SuspenseList revealOrder=...>{%s}</SuspenseList> ... </SuspenseList>",e=i?"array":"iterable",t,e)}function bf(e,t,i,n,o,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:o,lastEffect:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=i,s.tailMode=o,s.lastEffect=r)}function _f(e,t,i){var n,o=t.pendingProps,r=o.revealOrder,s=o.tail,o=o.children,a=r;if(void 0!==a&&"forwards"!==a&&"backwards"!==a&&"together"!==a&&!Kg[a])if(Kg[a]=!0,"string"==typeof a)switch(a.toLowerCase()){case"together":case"forwards":case"backwards":ee('"%s" is not a valid value for revealOrder on <SuspenseList />. Use lowercase "%s" instead.',a,a.toLowerCase());break;case"forward":case"backward":ee('"%s" is not a valid value for revealOrder on <SuspenseList />. React uses the -s suffix in the spelling. Use "%ss" instead.',a,a.toLowerCase());break;default:ee('"%s" is not a supported revealOrder on <SuspenseList />. Did you mean "together", "forwards" or "backwards"?',a)}else ee('%s is not a supported value for revealOrder on <SuspenseList />. Did you mean "together", "forwards" or "backwards"?',a);l=r,void 0===(n=s)||Xg[n]||("collapsed"!==n&&"hidden"!==n?(Xg[n]=!0,ee('"%s" is not a supported value for tail on <SuspenseList />. Did you mean "collapsed" or "hidden"?',n)):"forwards"!==l&&"backwards"!==l&&(Xg[n]=!0,ee('<SuspenseList tail="%s" /> is only valid if revealOrder is "forwards" or "backwards". Did you mean to specify revealOrder="forwards"?',n))),((e,t)=>{if(("forwards"===t||"backwards"===t)&&null!=e&&!1!==e)if(Array.isArray(e)){for(var i=0;i<e.length;i++)if(!mf(e[i],i))return}else{var n=nt(e);if("function"==typeof n){var o=n.call(e);if(o)for(var r=o.next(),s=0;!r.done;r=o.next()){if(!mf(r.value,s))return;s++}}else ee('A single row was passed to a <SuspenseList revealOrder="%s" />. This is not useful since it needs multiple rows. Did you mean to pass multiple children or an array?',t)}})(o,r),Bg(e,t,o,i);var l=Bh.current;if(0!=(l&Ph)?(l=l&Mh|Ph,t.flags|=j):(null!==e&&(e.flags&j)!==G&&((e,t,i)=>{for(var n=t;null!==n;){if(n.tag===H)null!==n.memoizedState&&ff(n,i);else if(n.tag===he)ff(n,i);else if(null!==n.child){n=(n.child.return=n).child;continue}if(n===e)return;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}})(t,t.child,i),l&=Mh),Hh(t,l),(t.mode&qu)===b)t.memoizedState=null;else switch(r){case"forwards":var c,u=(e=>{for(var t=e,i=null;null!==t;){var n=t.alternate;null!==n&&null===Vh(n)&&(i=t),t=t.sibling}return i})(t.child);null===u?(c=t.child,t.child=null):(c=u.sibling,u.sibling=null),bf(t,!1,c,u,s,t.lastEffect);break;case"backwards":var d=null,h=t.child;for(t.child=null;null!==h;){var p=h.alternate;if(null!==p&&null===Vh(p)){t.child=h;break}p=h.sibling;h.sibling=d,d=h,h=p}bf(t,!0,d,null,s,t.lastEffect);break;case"together":bf(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}var yf=!1;function vf(e,t,i){var n,o=t.type._context,r=t.pendingProps,s=t.memoizedProps,a=r.value,l=("value"in r||yf||(yf=!0,ee("The `value` prop is required for the `<Context.Provider>`. Did you misspell it or forget to pass it?")),t.type.propTypes);if(l&&Hc(l,r,"prop","Context.Provider"),Cd(t,a),null!==s){var l=s.value,l=(n=o,Ia(l=l,a=a)?0:(((n="function"==typeof n._calculateChangedBits?n._calculateChangedBits(l,a):gd)&gd)!==n&&ee("calculateChangedBits: Expected the return value to be a 31-bit integer. Instead received: %s",n),0|n));if(0==l){if(s.children===r.children&&!iu())return kf(e,t,i)}else{var c=t,u=o,d=l,h=i,p=c.child;for(null!==p&&(p.return=c);null!==p;){var g=void 0,f=p.dependencies;if(null!==f)for(var g=p.child,m=f.firstContext;null!==m;){if(m.context===u&&0!=(m.observedBits&d)){p.tag===ie&&((b=Md(y,Kr(h))).tag=Od,$d(p,b)),p.lanes=p.lanes|h;var b=p.alternate;null!==b&&(b.lanes=b.lanes|h),wd(p.return,h),f.lanes=f.lanes|h;break}m=m.next}else g=p.tag===J&&p.type===c.type?null:p.child;if(null!==g)g.return=p;else for(g=p;null!==g;){if(g===c){g=null;break}var _=g.sibling;if(null!==_){_.return=g.return,g=_;break}g=g.return}p=g}}}return Bg(e,t,r.children,i),t.child}var Tf=!1;function Ef(){Pg=!0}function kf(e,t,i){if(null!==e&&(t.dependencies=e.dependencies),Ng(),Tb(t.lanes),qr(i,t.childLanes)){var i=e,n=t;if(null!==i&&n.child!==i.child)throw Error("Resuming work not yet implemented.");if(null!==n.child){var o=n.child,r=T_(o,o.pendingProps);for((n.child=r).return=n;null!==o.sibling;)o=o.sibling,(r=r.sibling=T_(o,o.pendingProps)).return=n;r.sibling=null}return t.child}return null}function Cf(e,t,i){var $,n,o,r,s,a,l,c,u,d,h,p=t.lanes;if(t._debugNeedsRemount&&null!==e){var g=e,f=t,m=E_(t.type,t.key,t.pendingProps,t._debugOwner||null,t.mode,t.lanes),b=f.return;if(null===b)throw new Error("Cannot swap the root fiber.");if(g.alternate=null,f.alternate=null,m.index=f.index,m.sibling=f.sibling,m.return=f.return,m.ref=f.ref,f===b.child)b.child=m;else{var _=b.child;if(null===_)throw new Error("Expected parent to have a child.");for(;_.sibling!==f;)if(null===(_=_.sibling))throw new Error("Expected to find the previous sibling.");_.sibling=m}var P=b.lastEffect;return null!==P?(P.nextEffect=g,b.lastEffect=g):b.firstEffect=b.lastEffect=g,g.nextEffect=null,g.flags=Xn,m.flags|=ae,m}if(null!==e)if(e.memoizedProps!==t.pendingProps||iu()||t.type!==e.type)Pg=!0;else{if(!qr(i,p)){switch(Pg=!1,t.tag){case F:tf(t),sp();break;case U:Lh(t);break;case ie:nu(t.type)&&lu(t);break;case ne:Oh(t,t.stateNode.containerInfo);break;case J:Cd(t,t.memoizedProps.value);break;case Z:qr(i,t.childLanes)&&(t.flags|=V);var y=t.stateNode;y.effectDuration=0,y.passiveEffectDuration=0;break;case H:if(null!==t.memoizedState)return qr(i,t.child.childLanes)?uf(e,t,i):(Hh(t,Fh(Bh.current)),null!==(y=kf(e,t,i))?y.sibling:null);Hh(t,Fh(Bh.current));break;case he:var y=(e.flags&j)!==G,B=qr(i,t.childLanes);if(y){if(B)return _f(e,t,i);t.flags|=j}y=t.memoizedState;if(null!==y&&(y.rendering=null,y.tail=null,y.lastEffect=null),Hh(t,Bh.current),B)break;return null;case me:case be:return t.lanes=W,Gg(e,t,i)}return kf(e,t,i)}Pg=(e.flags&lo)!==G}else Pg=!1;switch(t.lanes=W,t.tag){case K:var v=e,T=t,E=t.type,k=i;null!==v&&(v.alternate=null,T.alternate=null,T.flags|=ae);var C,v=T.pendingProps,I=tu(T,Qc(0,E,!1));if(Sd(T,k),E.prototype&&"function"==typeof E.prototype.render&&(C=se(E)||"Unknown",Vg[C]||(ee("The <%s /> component appears to have a render method, but doesn't extend React.Component. This is likely to cause errors. Change %s to extend React.Component instead.",C,C),Vg[C]=!0)),T.mode&z&&nd.recordLegacyContextWarning(T,null),At(!0),C=wp(null,$g.current=T,E,v,I,k),At(!1),T.flags|=Yn,"object"==typeof C&&null!==C&&"function"==typeof C.render&&void 0===C.$$typeof&&(S=se(E)||"Unknown",jg[S]||(ee("The <%s /> component appears to be a function component that returns a class instance. Change %s to a class that extends React.Component instead. If you can't use a class try assigning the prototype on the function as a workaround. `%s.prototype = React.Component.prototype`. Don't use an arrow function since it cannot be called with `new` by React.",S,S,S),jg[S]=!0)),"object"==typeof C&&null!==C&&"function"==typeof C.render&&void 0===C.$$typeof)return S=se(E)||"Unknown",jg[S]||(ee("The <%s /> component appears to be a function component that returns a class instance. Change %s to a class that extends React.Component instead. If you can't use a class try assigning the prototype on the function as a workaround. `%s.prototype = React.Component.prototype`. Don't use an arrow function since it cannot be called with `new` by React.",S,S,S),jg[S]=!0),T.tag=ie,T.memoizedState=null,T.updateQueue=null,S=!1,nu(E)?(S=!0,lu(T)):S=!1,T.memoizedState=null!=C.state?C.state:null,Ld(T),"function"==typeof(w=E.getDerivedStateFromProps)&&nh(T,E,w,v),ah(T,C),uh(T,E,v,k),ef(null,T,E,!0,S,k);if(T.tag=te,T.mode&z){pt();try{C=wp(null,T,E,v,I,k)}finally{gt()}}return Bg(null,T,C,k),rf(T,E),T.child;case ue:return of(e,t,t.elementType,p,i);case te:var w=t.type,S=t.pendingProps;return Zg(e,t,w,t.elementType===w?S:pd(w,S),i);case ie:v=t.type,I=t.pendingProps;return Qg(e,t,v,t.elementType===v?I:pd(v,I),i);case F:return nf(e,t,i);case U:return C=e,k=i,Lh(E=t),null===C&&ep(E),T=E.type,u=E.pendingProps,d=null!==C?C.memoizedProps:null,h=u.children,cc(T,u)?h=null:null!==d&&cc(T,d)&&(E.flags|=qn),Jg(C,E),Bg(C,E,h,k),E.child;case oe:return u=t,null===e&&ep(u),null;case H:return uf(e,t,i);case ne:return d=e,h=i,Oh(R=t,R.stateNode.containerInfo),x=R.pendingProps,null===d?R.child=Th(R,null,x,h):Bg(d,R,x,h),R.child;case re:var x=t.type,R=t.pendingProps,O=t.elementType===x?R:pd(x,R);return Fg(e,t,x,O,i);case le:return Bg(e,O=t,O.pendingProps,i),O.child;case X:return Bg(e,c=t,c.pendingProps.children,i),c.child;case Z:return c=e,a=i,(s=t).flags|=V,(l=s.stateNode).effectDuration=0,l.passiveEffectDuration=0,Bg(c,s,s.pendingProps.children,a),s.child;case J:return vf(e,t,i);case q:return l=e,a=i,void 0===(L=(s=t).type)._context?L===L.Consumer||Tf||(Tf=!0,ee("Rendering <Context> directly is not supported and will be removed in a future major release. Did you mean to render <Context.Consumer> instead?")):L=L._context,"function"!=typeof(N=(A=s.pendingProps).children)&&ee("A context consumer was rendered with multiple children, or a child that isn't a function. A context consumer expects a single child that is a function. If you did pass a function, make sure there is no trailing or leading whitespace around it."),Sd(s,a),L=Y(L,A.unstable_observedBits),$g.current=s,At(!0),A=N(L),At(!1),s.flags|=Yn,Bg(l,s,A,a),s.child;case Q:var A,N=t.type,L=pd(N,t.pendingProps);return t.type!==t.elementType&&(A=N.propTypes)&&Hc(A,L,"prop",se(N)),L=pd(N.type,L),Ug(e,t,N,L,p,i);case ce:return Hg(e,t,t.type,t.pendingProps,p,i);case de:var D=t.type,M=t.pendingProps,M=t.elementType===D?M:pd(D,M);return n=t,D=D,M=M,o=i,null!==($=e)&&($.alternate=null,n.alternate=null,n.flags|=ae),n.tag=ie,nu(D)?(r=!0,lu(n)):r=!1,Sd(n,o),lh(n,D,M),uh(n,D,M,o),ef(null,n,D,!0,r,o);case he:return _f(e,t,i);case pe:case ge:case fe:break;case me:return Gg(e,t,i);case be:return qg(e,t,i)}throw Error("Unknown unit of work tag ("+t.tag+"). This error is likely caused by a bug in React. Please file an issue.")}function If(e){e.flags|=V}function wf(e){e.flags|=Zn}function Sf(e,t){if(!qh)switch(e.tailMode){case"hidden":for(var i=e.tail,n=null;null!==i;)null!==i.alternate&&(n=i),i=i.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":for(var o=e.tail,r=null;null!==o;)null!==o.alternate&&(r=o),o=o.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function xf(e,t,i){var n=t.pendingProps;switch(t.tag){case K:case ue:case ce:case te:case re:case le:case X:case Z:case q:case Q:return null;case ie:return nu(t.type)&&ou(t),null;case F:Ah(t),ru(t),lp();var o=t.stateNode;return o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),null!==e&&null!==e.child||(rp(t)?If(t):o.hydrate||(t.flags|=Qn)),Lf(t),null;case U:Dh(t);var o=Rh(),r=t.type;if(null!==e&&null!=t.stateNode)Df(e,t,r,n,o),e.ref!==t.ref&&wf(t);else{if(!n){if(null===t.stateNode)throw Error("We must have new props for new mounts. This error is likely caused by a bug in React. Please file an issue.");return null}var s=Nh();rp(t)?tp(t,0,s)&&If(t):(o=lc(r,n,o,s,t),Nf(o,t,!1,!1),Ll(t.stateNode=o,s=r,r=n),sc(s,r)&&If(t)),null!==t.ref&&wf(t)}return null;case oe:s=n;if(e&&null!=t.stateNode){r=e.memoizedProps;Mf(e,t,r,s)}else{if("string"!=typeof s&&null===t.stateNode)throw Error("We must have new props for new mounts. This error is likely caused by a bug in React. Please file an issue.");var a=Rh(),l=Nh();rp(t)?ip(t)&&If(t):t.stateNode=uc(s,a,l,t)}return null;case H:Gh(t);var a=t.memoizedState;return(t.flags&j)!==G?(t.lanes=i,(t.mode&Zu)!==b&&Dg(t),t):(l=null!==a,a=!1,null===e?void 0!==t.memoizedProps.fallback&&rp(t):a=null!==e.memoizedState,l&&!a&&(t.mode&qu)!==b&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!=(Bh.current&$h)?Em===hm&&(Em=fm):(Em!==hm&&Em!==fm||(Em=mm),null!==_m&&(Wr(Im)||Wr(wm))&&lb(_m,ym))),(l||a)&&(t.flags|=V),null);case ne:return Ah(t),Lf(t),null===e&&Qa(t.stateNode.containerInfo),null;case J:return Id(t),null;case de:return nu(t.type)&&ou(t),null;case he:Gh(t);var c=t.memoizedState;if(null===c)return null;var u=(t.flags&j)!==G,l=c.rendering;if(null===l)if(u)Sf(c,!1);else{if(!(Em===hm&&(null===e||(e.flags&j)===G)))for(var d=t.child;null!==d;){var h=Vh(d);if(null!==h)return u=!0,t.flags|=j,Sf(c,!1),null!==(h=h.updateQueue)&&(t.updateQueue=h,t.flags|=V),null===c.lastEffect&&(t.firstEffect=null),t.lastEffect=c.lastEffect,kh(t,i),Hh(t,Uh(Bh.current,Ph)),t.child;d=d.sibling}null!==c.tail&&Gu()>Am&&(t.flags|=j,Sf(c,!(u=!0)),qb(t.lanes=Mr))}else{if(!u){var a=Vh(l);if(null!==a){t.flags|=j;var u=!0,a=a.updateQueue;if(null!==a&&(t.updateQueue=a,t.flags|=V),Sf(c,!0),null===c.tail&&"hidden"===c.tailMode&&!l.alternate&&!qh)return null!==(a=t.lastEffect=c.lastEffect)&&(a.nextEffect=null),null}else 2*Gu()-c.renderingStartTime>Am&&i!==Ur&&(t.flags|=j,Sf(c,!(u=!0)),qb(t.lanes=Mr))}c.isBackwards?(l.sibling=t.child,t.child=l):(null!==(a=c.last)?a.sibling=l:t.child=l,c.last=l)}return null!==c.tail?(a=c.tail,c.rendering=a,c.tail=a.sibling,c.lastEffect=t.lastEffect,c.renderingStartTime=Gu(),a.sibling=null,l=Bh.current,u?l=l&Mh|Ph:l&=Mh,Hh(t,l),a):null;case pe:case ge:case fe:break;case me:case be:return gb(t),null!==e&&(l=t.memoizedState,null!==e.memoizedState!=(null!==l))&&"unstable-defer-without-hiding"!==n.mode&&(t.flags|=V),null}throw Error("Unknown unit of work tag ("+t.tag+"). This error is likely caused by a bug in React. Please file an issue.")}function Rf(e){switch(e.tag){case ie:var t=e.type.childContextTypes;null!=t&&ou(e);break;case F:Ah(e),ru(e),lp();break;case U:Dh(e);break;case ne:Ah(e);break;case H:case he:Gh(e);break;case J:Id(e);break;case me:case be:gb(e)}}function Of(e,t){return{value:e,source:t,stack:kt(t)}}function Af(e,t){try{var i=t.value,n=t.source,o=t.stack,r=null!==o?o:"";if(null!=i&&i._suppressLogging){if(e.tag===ie)return;console.error(i)}var s=n?se(n.type):null,a=s?"The above error occurred in the <"+s+"> component:":"The above error occurred in one of your React components:",l=se(e.type),c=l?"React will try to recreate this component tree from scratch using the error boundary you provided, "+l+".":"Consider adding an error boundary to your tree to customize error handling behavior.\nVisit https://reactjs.org/link/error-boundaries to learn more about error boundaries.",u=a+"\n"+r+"\n\n"+c;console.error(u)}catch(e){setTimeout(function(){throw e})}}var Nf=function(e,t,i,n){for(var o,r=t.child;null!==r;){if(r.tag===U||r.tag===oe)o=r.stateNode,e.appendChild(o);else if(r.tag!==ne&&null!==r.child){r=(r.child.return=r).child;continue}if(r===t)return;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Lf=function(e){},Df=function(e,t,i,n,o){var r,s,a,e=e.memoizedProps;e!==n&&(r=t.stateNode,s=Nh(),r=r,i=i,e=e,s=s,typeof(n=n).children==typeof e.children||"string"!=typeof n.children&&"number"!=typeof n.children||(a=""+n.children,s=Wl(s.ancestorInfo,i),jl(null,a,s)),a=Dl(r,i,e,n),t.updateQueue=a)&&If(t)},Mf=function(e,t,i,n){i!==n&&If(t)},$f="function"==typeof WeakMap?WeakMap:Map;function Pf(e,t,i){var i=Md(y,i),n=(i.tag=Ad,i.payload={element:null},t.value);return i.callback=function(){Db(n),Af(e,t)},i}function Bf(i,n,e){var t,e=Md(y,e),o=(e.tag=Ad,i.type.getDerivedStateFromError),r=("function"==typeof o&&(t=n.value,e.payload=function(){return Af(i,n),o(t)}),i.stateNode);return null!==r&&"function"==typeof r.componentDidCatch?e.callback=function(){d_(i),"function"!=typeof o&&(e=this,null===$m?$m=new Set([e]):$m.add(e),Af(i,n));var e=n.value,t=n.stack;this.componentDidCatch(e,{componentStack:null!==t?t:""}),"function"==typeof o||qr(i.lanes,m)||ee("%s: Error boundaries should implement getDerivedStateFromError(). In that method, return a state update to display an error message or fallback UI.",se(i.type)||"Unknown")}:e.callback=function(){d_(i)},e}function Ff(e,t,i){var n,o=e.pingCache;null===o?(o=e.pingCache=new $f,n=new Set,o.set(t,n)):void 0===(n=o.get(t))&&(n=new Set,o.set(t,n)),n.has(i)||(n.add(i),o=function(e,t,i){var n=e.pingCache;null!==n&&n.delete(t);n=ib();es(e,i),_m===e&&Jr(ym,i)&&(Em===mm||Em===fm&&zr(ym)&&Gu()-Rm<Om?fb(e,W):Sm|=i);sb(e,n),Zb(e,i)}.bind(null,e,t,i),t.then(o,o))}function Uf(e,t,i,n,o){if(i.flags|=so,(i.firstEffect=i.lastEffect=null)!==n&&"object"==typeof n&&"function"==typeof n.then){var r,s=n,a=((i.mode&qu)===b&&((r=i.alternate)?(i.updateQueue=r.updateQueue,i.memoizedState=r.memoizedState,i.lanes=r.lanes):(i.updateQueue=null,i.memoizedState=null)),0!=(Bh.current&$h)),l=t;do{if(l.tag===H&&(u=a,d=void 0,null!==(d=(c=l).memoizedState)?null!==d.dehydrated:void 0!==(d=c.memoizedProps).fallback&&(!0!==d.unstable_avoidThisFallback||!u)))return null===(c=l.updateQueue)?((d=new Set).add(s),l.updateQueue=d):c.add(s),(l.mode&qu)===b?(l.flags|=j,i.flags|=lo,i.flags&=~(oo|so),i.tag===ie&&(null===i.alternate?i.tag=de:((u=Md(y,m)).tag=Od,$d(i,u))),void(i.lanes=i.lanes|m)):(Ff(e,s,o),l.flags|=ao,void(l.lanes=o))}while(null!==(l=l.return));n=new Error((se(i.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}Em!==bm&&(Em=gm),n=Of(n,i);var c,u,d,h=t;do{switch(h.tag){case F:var p=n,g=(h.flags|=ao,Kr(o)),p=(h.lanes=h.lanes|g,Pf(h,p,g));return void Pd(h,p);case ie:var g=n,p=h.type,f=h.stateNode;if((h.flags&j)!==G||"function"!=typeof p.getDerivedStateFromError&&(null===f||"function"!=typeof f.componentDidCatch||Lb(f)))break;return h.flags|=ao,f=Kr(o),h.lanes=h.lanes|f,void Pd(h,Bf(h,g,f))}}while(null!==(h=h.return))}var Hf=null,Hf=new Set,Gf="function"==typeof WeakSet?WeakSet:Set,Vf=function(e,t){t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()};function jf(e){var t=e.ref;null!==t&&("function"==typeof t?(jn(null,t,null,null),Fn&&$b(e,Wn())):t.current=null)}function Wf(e){var t=e.updateQueue,t=null!==t?t.lastEffect:null;if(null!==t){var i=t.next,n=i;do{var o=n,r=o.next,o=o.tag;(o&Yh)!==jh&&(o&Wh)!==jh&&(Ob(e,n),o=n,Hm.push(o,e),Pm||(Pm=!0,zu(Nu,function(){return Rb(),null}))),n=r}while(n!==i)}}function zf(e,t,i){switch(i.tag){case te:case re:case ce:case fe:var n=zh|Wh,o=i;if(null!==(o=null!==(o=o.updateQueue)?o.lastEffect:null)){var r,s=o.next,a=s;do{}while((a.tag&n)===n&&(r=a.create,a.destroy=r(),void 0!==(r=a.destroy))&&"function"!=typeof r&&ee("An effect function must not return anything besides a function, which is used for clean-up.%s",null===r?" You returned null. If your effect does not require clean up, return undefined (or nothing).":"function"==typeof r.then?"\n\nIt looks like you wrote useEffect(async () => ...) or returned a Promise. Instead, write the async function inside your effect and call it immediately:\n\nuseEffect(() => {\n  async function fetchData() {\n    // You can await here\n    const response = await MyAPI.getData(someId);\n    // ...\n  }\n  fetchData();\n}, [someId]); // Or [] if effect doesn't need props or state\n\nLearn more about data fetching with Hooks: https://reactjs.org/link/hooks-data-fetching":" You returned: "+r),(a=a.next)!==s)}return void Wf(i);case ie:var o=i.stateNode,l=(i.flags&V&&(null===t?(i.type!==i.elementType||Yg||(o.props!==i.memoizedProps&&ee("Expected %s props to match memoized props before componentDidMount. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",se(i.type)||"instance"),o.state!==i.memoizedState&&ee("Expected %s state to match memoized state before componentDidMount. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",se(i.type)||"instance")),o.componentDidMount()):(l=i.elementType===i.type?t.memoizedProps:pd(i.type,t.memoizedProps),c=t.memoizedState,i.type!==i.elementType||Yg||(o.props!==i.memoizedProps&&ee("Expected %s props to match memoized props before componentDidUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",se(i.type)||"instance"),o.state!==i.memoizedState&&ee("Expected %s state to match memoized state before componentDidUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",se(i.type)||"instance")),o.componentDidUpdate(l,c,o.__reactInternalSnapshotBeforeUpdate))),i.updateQueue);return void(null!==l&&(i.type!==i.elementType||Yg||(o.props!==i.memoizedProps&&ee("Expected %s props to match memoized props before processing the update queue. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",se(i.type)||"instance"),o.state!==i.memoizedState&&ee("Expected %s state to match memoized state before processing the update queue. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",se(i.type)||"instance")),Ud(0,l,o)));case F:var c=i.updateQueue;if(null!==c){var u=null;if(null!==i.child)switch(i.child.tag){case U:case ie:u=i.child.stateNode}Ud(0,c,u)}return;case U:l=i.stateNode;return void(null===t&&i.flags&V&&(c=i.type,l=l,sc(c,i.memoizedProps))&&l.focus());case oe:case ne:return;case Z:var d=i.memoizedProps,d=(d.onCommit,d.onRender),h=(i.stateNode.effectDuration,xg);return void("function"==typeof d&&d(i.memoizedProps.id,null===t?"mount":"update",i.actualDuration,i.treeBaseDuration,i.actualStartTime,h,e.memoizedInteractions));case H:if(null===(d=i).memoizedState&&null!==(d=d.alternate)&&null!==(d=d.memoizedState)&&null!==(d=d.dehydrated)){h=d;$o(h)}return;case he:case de:case pe:case ge:case me:case be:return}throw Error("This unit of work tag should not have side-effects. This error is likely caused by a bug in React. Please file an issue.")}function Yf(e,t){for(var i,n=e;;){if(n.tag===U){var o=n.stateNode;t?"function"==typeof(o=(o=o).style).setProperty?o.setProperty("display","none","important"):o.display="none":(o=n.stateNode,i=null!=(i=(i=n.memoizedProps)[nc])&&i.hasOwnProperty("display")?i.display:null,o.style.display=Ai("display",i))}else if(n.tag===oe){o=n.stateNode;o.nodeValue=t?"":n.memoizedProps}else if((n.tag!==me&&n.tag!==be||null===n.memoizedState||n===e)&&null!==n.child){n=(n.child.return=n).child;continue}if(n===e)return;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function Kf(e,t){var i,n=t;if(fu&&"function"==typeof fu.onCommitFiberUnmount)try{fu.onCommitFiberUnmount(gu,n)}catch(e){mu||(mu=!0,ee("React instrumentation encountered an error: %s",e))}switch(t.tag){case te:case re:case Q:case ce:case fe:var o=t.updateQueue;if(null!==o){o=o.lastEffect;if(null!==o){var r=o.next,s=r;do{var a=s,l=a.destroy;void 0!==l&&((a.tag&Yh)!==jh?Ob(t,s):(a=t,jn(null,l,null),Fn&&$b(a,Wn()))),s=s.next}while(s!==r)}}return;case ie:jf(t);o=t.stateNode;return void("function"==typeof o.componentWillUnmount&&(jn(null,Vf,null,i=t,o),Fn)&&$b(i,Wn()));case U:return void jf(t);case ne:return void Zf(e,t);case pe:case S:return}}function Xf(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null,e._debugOwner=null}function qf(e){return e.tag===U||e.tag===F||e.tag===ne}function Jf(e){var t,i,n=(e=>{for(var t=e.return;null!==t;){if(qf(t))return t;t=t.return}throw Error("Expected to find a host parent. This error is likely caused by a bug in React. Please file an issue.")})(e),o=n.stateNode;switch(n.tag){case U:t=o,i=!1;break;case F:case ne:t=o.containerInfo,i=!0;break;default:throw Error("Invalid host parent fiber. This error is likely caused by a bug in React. Please file an issue.")}n.flags&qn&&(gc(t),n.flags&=~qn);n=(e=>{var t=e;e:for(;;){for(;null===t.sibling;){if(null===t.return||qf(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==U&&t.tag!==oe&&t.tag!==S;){if(t.flags&ae)continue e;if(null===t.child||t.tag===ne)continue e;t=(t.child.return=t).child}if(!(t.flags&ae))return t.stateNode}})(e);(i?function e(t,i,n){var o=t.tag;var r=o===U||o===oe;if(r||R){r=r?t.stateNode:t.stateNode.instance;i?_c(n,r,i):mc(n,r)}else if(o!==ne){r=t.child;if(null!==r){e(r,i,n);for(var s=r.sibling;null!==s;)e(s,i,n),s=s.sibling}}}:function e(t,i,n){var o=t.tag;var r=o===U||o===oe;if(r||R){r=r?t.stateNode:t.stateNode.instance;i?bc(n,r,i):fc(n,r)}else if(o!==ne){r=t.child;if(null!==r){e(r,i,n);for(var s=r.sibling;null!==s;)e(s,i,n),s=s.sibling}}})(e,n,t)}function Zf(e,t){for(var i,n,o,r,s=t,a=!1;;){if(!a){var l=s.return;e:for(;;){if(null===l)throw Error("Expected to find a host parent. This error is likely caused by a bug in React. Please file an issue.");var c=l.stateNode;switch(l.tag){case U:i=c,n=!1;break e;case F:case ne:i=c.containerInfo,n=!0;break e}l=l.return}a=!0}if(s.tag===U||s.tag===oe)((e,t)=>{for(var i=t;;)if(Kf(e,i),null!==i.child&&i.tag!==ne)i=(i.child.return=i).child;else{if(i===t)return;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}})(e,s),n?(o=i,r=s.stateNode,(o.nodeType===Ci?o.parentNode:o).removeChild(r)):(o=i,r=s.stateNode,o.removeChild(r));else if(s.tag===ne){if(null!==s.child){i=s.stateNode.containerInfo,n=!0,s=(s.child.return=s).child;continue}}else if(Kf(e,s),null!==s.child){s=(s.child.return=s).child;continue}if(s===t)return;for(;null===s.sibling;){if(null===s.return||s.return===t)return;(s=s.return).tag===ne&&(a=!1)}s.sibling.return=s.return,s=s.sibling}}function Qf(e,t){switch(t.tag){case te:case re:case Q:case ce:case fe:var i=zh|Wh,n=t;if(null!==(n=null!==(n=n.updateQueue)?n.lastEffect:null)){var o,r=n.next,s=r;do{}while((s.tag&i)===i&&(o=s.destroy,(s.destroy=void 0)!==o)&&o(),(s=s.next)!==r)}return;case ie:return;case U:n=t.stateNode;return void(null!=n&&(d=t.memoizedProps,u=null!==e?e.memoizedProps:d,c=t.type,l=t.updateQueue,(t.updateQueue=null)!==l)&&(l=l,c=c,u=u,$c(a=n,d=d),Ml(a,l,c,u,d)));case oe:if(null===t.stateNode)throw Error("This should have a text node initialized. This error is likely caused by a bug in React. Please file an issue.");a=t.memoizedProps;null!==e&&e.memoizedProps;return void(t.stateNode.nodeValue=a);case F:l=t.stateNode;return void(l.hydrate&&(l.hydrate=!1,$o(l.containerInfo)));case Z:return;case H:return null!==(c=t).memoizedState&&(Rm=Gu(),Yf(c.child,!0)),void em(t);case he:return void em(t);case de:return;case pe:case ge:break;case me:case be:u=t.memoizedState;return void Yf(t,null!==u)}var a,l,c,u,d;throw Error("This unit of work tag should not have side-effects. This error is likely caused by a bug in React. Please file an issue.")}function em(i){var n,e=i.updateQueue;null!==e&&((i.updateQueue=null)===(n=i.stateNode)&&(n=i.stateNode=new Gf),e.forEach(function(e){var t=function(e,t){var i,n=Cr;null!==(i=e.stateNode)&&i.delete(t);((e,t)=>{t===Cr&&(t=(e=>((e=e.mode)&qu)===b?m:(e&Ju)===b?Vu()===Ou?m:Ir:(e=Jm=Jm===W?Cm:Jm,e=(e=Kr(Dr&~e))===Cr?Kr(Dr):e))(e));var i=ib();null!==(e=rb(e,t))&&(Qr(e,t,i),sb(e,i),Zb(e,t))})(e,n)}.bind(null,i,e);n.has(e)||(!0!==e.__reactDoNotTraceInteractions&&(t=u.unstable_wrap(t)),n.add(e),e.then(t,t))}))}"function"==typeof Symbol&&Symbol.for&&((Jo=Symbol.for)("selector.component"),Jo("selector.has_pseudo_class"),Jo("selector.role"),Jo("selector.test_id"),Jo("selector.text"));var tm=[],im=Math.ceil,nm=d.ReactCurrentDispatcher,om=d.ReactCurrentOwner,rm=d.IsSomeRendererActing,E=0,sm=1,am=4,lm=8,cm=16,um=32,dm=64,hm=0,pm=1,gm=2,fm=3,mm=4,bm=5,C=E,_m=null,g=null,ym=W,vm=W,Tm=Wc(W),Em=hm,km=null,Cm=W,Im=W,wm=W,Sm=W,xm=null,Rm=0,Om=500,Am=1/0,Nm=500;function Lm(){Am=Gu()+Nm}var I=null,Dm=!1,Mm=null,$m=null,Pm=!1,Bm=null,Fm=Mu,Um=W,Hm=[],Gm=[],Vm=null,jm=50,Wm=0,zm=null,Ym=50,Km=0,Xm=null,qm=y,Jm=W,Zm=W,Qm=!1,eb=null,tb=!1;function ib(){return(C&(cm|um))!==E?Gu():qm=qm===y?Gu():qm}function nb(e){var t,e=e.mode;return(e&qu)===b?m:(e&Ju)===b?Vu()===Ou?m:Ir:(Jm===W&&(Jm=Cm),ed.transition!==td?(Zm!==W&&(Zm=null!==xm?xm.pendingLanes:W),e=Jm,t=(t=Kr(Lr&~(t=Zm)))===Cr&&(t=Kr(Lr&~e))===Cr?Kr(Lr):t):(e=Vu(),Yr((C&am)!==E&&e===Au?ur:(e=>{switch(e){case tr:return ar;case ir:return hr;case nr:case or:return gr;case rr:return vr;default:return Er}})(e),Jm)))}function ob(e,t,i){if(jm<Wm)throw Wm=0,zm=null,Error("Maximum update depth exceeded. This can happen when a component repeatedly calls setState inside componentWillUpdate or componentDidUpdate. React limits the number of nested updates to prevent infinite loops.");Ym<Km&&(Km=0,ee("Maximum update depth exceeded. This can happen when a component calls setState inside useEffect, but useEffect either doesn't have a dependency array, or one of the dependencies changes on every render."));var n=e;if(St&&(C&cm)!==E&&!hg)switch(n.tag){case te:case re:case ce:var o=g&&se(g.type)||"Unknown",r=o;Vb.has(r)||(Vb.add(r),ee("Cannot update a component (`%s`) while rendering a different component (`%s`). To locate the bad setState() call inside `%s`, follow the stack trace as described in https://reactjs.org/link/setstate-in-render",se(n.type)||"Unknown",o,o));break;case ie:Gb||(ee("Cannot update during an existing state transition (such as within `render`). Render methods should be a pure function of props and state."),Gb=!0)}var s=rb(e,t);if(null===s){var a=e.tag;if((a===F||a===ie||a===te||a===re||a===Q||a===ce||a===fe)&&(e.flags&to)===G){var l=se(e.type)||"ReactComponent";if(null!==Fb){if(Fb.has(l))return;Fb.add(l)}else Fb=new Set([l]);if(!Qm){l=wt;try{f(e),ee("Can't perform a React state update on an unmounted component. This is a no-op, but it indicates a memory leak in your application. To fix, cancel all subscriptions and asynchronous tasks in %s.",a===ie?"the componentWillUnmount method":"a useEffect cleanup function")}finally{l?f(e):Ot()}}}}else{Qr(s,t,i),s===_m&&(wm|=t,Em===mm)&&lb(s,ym);a=Vu();t===m?(C&lm)!==E&&(C&(cm|um))===E?(Zb(s,t),cb(s)):(sb(s,i),Zb(s,t),C===E&&(Lm(),Ku())):((C&am)===E||a!==Au&&a!==Ou||(null===Vm?Vm=new Set([s]):Vm.add(s)),sb(s,i),Zb(s,t)),xm=s}}function rb(e,t){e.lanes=e.lanes|t;for(var i=e.alternate,n=(null!==i&&(i.lanes=i.lanes|t),null===i&&(e.flags&(ae|io))!==G&&Bb(e),e),o=e.return;null!==o;)o.childLanes=o.childLanes|t,null!==(i=o.alternate)?i.childLanes=i.childLanes|t:(o.flags&(ae|io))!==G&&Bb(e),o=(n=o).return;return n.tag===F?n.stateNode:null}function sb(e,t){var i=e.callbackNode,t=(Vr(e,t),Gr(e,e===_m?ym:W)),n=h;if(t===W)null!==i&&(Yu(i),e.callbackNode=null,e.callbackPriority=Er);else{if(null!==i){if(e.callbackPriority===n)return;Yu(i)}i=n===ar?(t=cb.bind(null,e),null===Bu?(Bu=[t],Fu=yu(Cu,Xu)):Bu.push(t),Ru):n===lr?zu(Ou,cb.bind(null,e)):zu((e=>{switch(e){case ar:case lr:return tr;case cr:case ur:case dr:case hr:return ir;case pr:case gr:case fr:case mr:case _r:case br:return nr;case yr:case vr:case Tr:return rr;case Er:return sr;default:throw Error("Invalid update priority: "+e+". This is a bug in React.")}})(n),ab.bind(null,e)),e.callbackPriority=n,e.callbackNode=i}}function ab(e){if(qm=y,Zm=Jm=W,(C&(cm|um))!==E)throw Error("Should not already be working.");var t=e.callbackNode,i=Rb();if(i&&e.callbackNode!==t)return null;i=Gr(e,e===_m?ym:W);if(i===W)return null;var n=((t,e)=>{var i=C,n=(C|=cm,bb());for(_m===t&&ym===e||(Lm(),fb(t,e),Qb(t,e)),e=yb(t);;)try{(()=>{for(;null!==g&&!$u();)kb(g)})();break}catch(e){mb(t,e)}return Td(),vb(e),_b(n),C=i,null!==g?hm:(_m=null,ym=W,Em)})(e,i);if(qr(Cm,wm))fb(e,W);else if(n!==hm){if((n=n===gm&&(C|=dm,e.hydrate&&(e.hydrate=!1,yc(e.containerInfo)),(i=jr(e))!==W)?Eb(e,i):n)===pm)throw o=km,fb(e,W),lb(e,i),sb(e,Gu()),o;var o=e.current.alternate,r=(e.finishedWork=o,e.finishedLanes=i,e),s=i;switch(n){case hm:case pm:throw Error("Root did not complete. This is a bug in React.");case gm:Ib(r);break;case fm:if(lb(r,s),zr(s)&&!(0<t_)){var a=Rm+Om-Gu();if(10<a){if(Gr(r,W)!==W)break;var l=r.suspendedLanes;if(!Jr(l,s)){ib();es(r,l);break}r.timeoutHandle=dc(Ib.bind(null,r),a);break}}Ib(r);break;case mm:if(lb(r,s),!(e=>(e&Lr)===e)(s)){if(!(0<t_)){l=((e,t)=>{for(var i=e.eventTimes,n=y;0<t;){var o=Xr(t),r=i[o];n<r&&(n=r),t&=~(1<<o)}return n})(r,s),a=Gu()-l,l=(e=>e<120?120:e<480?480:e<1080?1080:e<1920?1920:e<3e3?3e3:e<4320?4320:1960*im(e/1960))(a)-a;if(10<l){r.timeoutHandle=dc(Ib.bind(null,r),l);break}}Ib(r)}break;case bm:Ib(r);break;default:throw Error("Unknown root exit status.")}}return sb(e,Gu()),e.callbackNode===t?ab.bind(null,e):null}function lb(e,t){t=t&~Sm&~wm;e.suspendedLanes|=t,e.pingedLanes&=~t;for(var i=e.expirationTimes,n=t;0<n;){var o=Xr(n),r=1<<o;i[o]=y,n&=~r}}function cb(e){if((C&(cm|um))!==E)throw Error("Should not already be working.");var t;if(Rb(),e===_m&&qr(e.expiredLanes,ym)?(i=Eb(e,t=ym),qr(Cm,wm)&&(i=Eb(e,t=Gr(e,t)))):i=Eb(e,t=Gr(e,W)),(i=e.tag!==du&&i===gm&&(C|=dm,e.hydrate&&(e.hydrate=!1,yc(e.containerInfo)),(t=jr(e))!==W)?Eb(e,t):i)===pm)throw i=km,fb(e,W),lb(e,t),sb(e,Gu()),i;var i=e.current.alternate;return e.finishedWork=i,e.finishedLanes=t,Ib(e),sb(e,Gu()),null}function ub(e,t){var i=C;C|=sm;try{return e(t)}finally{(C=i)===E&&(Lm(),Ku())}}function db(e,t){var i=C;C=C&~sm|lm;try{e(t)}finally{(C=i)===E&&(Lm(),Ku())}}function hb(e,t){var i=C;if((i&(cm|um))!==E)return ee("flushSync was called from inside a lifecycle method. React cannot flush when React is already rendering. Consider moving this call to a scheduler task or micro task."),e(t);C|=sm;try{if(e)return Wu(Ou,e.bind(null,t))}finally{C=i,Ku()}}function pb(e,t){Yc(Tm,vm,e),vm|=t,Cm|=t}function gb(e){vm=Tm.current,zc(Tm,e)}function fb(e,t){e.finishedWork=null,e.finishedLanes=W;var i=e.timeoutHandle;if(i!==pc&&(e.timeoutHandle=pc,hc(i)),null!==g)for(var n=g.return;null!==n;)Rf(n),n=n.return;g=T_((_m=e).current,null),ym=vm=Cm=t,Em=hm,Sm=wm=Im=W,Xm=km=null,nd.discardPendingWarnings()}function mb(e,t){do{var i=g;try{if(Td(),xp(),Ot(),(om.current=null)===i||null===i.return)return Em=pm,km=t,void(g=null);x&&i.mode&Zu&&Lg(i,!0),Uf(e,i.return,i,t,ym),Cb(i)}catch(e){t=e,g===i&&null!==i?(i=i.return,g=i):i=g;continue}return}while(1)}function bb(){var e=nm.current;return nm.current=yg,null===e?yg:e}function _b(e){nm.current=e}function yb(e){var t=u.__interactionsRef.current;return u.__interactionsRef.current=e.memoizedInteractions,t}function vb(e){u.__interactionsRef.current=e}function Tb(e){Im|=e}function Eb(t,e){for(var i=C,n=(C|=cm,bb()),e=(_m===t&&ym===e||(fb(t,e),Qb(t,e)),yb(t));;)try{for(;null!==g;)kb(g);break}catch(e){mb(t,e)}if(Td(),vb(e),C=i,_b(n),null!==g)throw Error("Cannot commit an incomplete root. This error is likely caused by a bug in React. Please file an issue.");return _m=null,ym=W,Em}function kb(e){var t,i=e.alternate;f(e),(e.mode&Zu)!==b?(Ag(e),t=Hb(i,e,vm),Lg(e,!0)):t=Hb(i,e,vm),Ot(),e.memoizedProps=e.pendingProps,null===t?Cb(e):g=t,om.current=null}function Cb(e){var t=e;do{var i=t.alternate,n=t.return;if((t.flags&so)===G){f(t);var o=void 0;if((t.mode&Zu)===b?o=xf(i,t,vm):(Ag(t),o=xf(i,t,vm),Lg(t,!1)),Ot(),null!==o)return void(g=o);u=o=c=l=a=s=r=i=void 0;i=t;if(i.tag!==be&&i.tag!==me||null===i.memoizedState||qr(vm,Ur)||(i.mode&Ju)===W){var r=W;if((i.mode&Zu)!==b){for(var s=i.actualDuration,a=i.selfBaseDuration,l=null===i.alternate||i.child!==i.alternate.child,c=i.child;null!==c;)r|=c.lanes|c.childLanes,l&&(s+=c.actualDuration),a+=c.treeBaseDuration,c=c.sibling;i.tag===H&&null!==i.memoizedState&&null!==(o=i.child)&&(a-=o.treeBaseDuration),i.actualDuration=s,i.treeBaseDuration=a}else for(var u=i.child;null!==u;)r|=u.lanes|u.childLanes,u=u.sibling;i.childLanes=r}null!==n&&(n.flags&so)===G&&(null===n.firstEffect&&(n.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==n.lastEffect&&(n.lastEffect.nextEffect=t.firstEffect),n.lastEffect=t.lastEffect),o=t.flags,Yn<o)&&(null!==n.lastEffect?n.lastEffect.nextEffect=t:n.firstEffect=t,n.lastEffect=t)}else{i=(e=>{switch(e.tag){case ie:nu(e.type)&&ou(e);var t=e.flags;return t&ao?(e.flags=t&~ao|j,(e.mode&Zu)!==b&&Dg(e),e):null;case F:Ah(e),ru(e),lp();t=e.flags;if((t&j)!==G)throw Error("The root failed to unmount after an error. This is likely a bug in React. Please file an issue.");return e.flags=t&~ao|j,e;case U:return Dh(e),null;case H:Gh(e);t=e.flags;return t&ao?(e.flags=t&~ao|j,(e.mode&Zu)!==b&&Dg(e),e):null;case he:return Gh(e),null;case ne:return Ah(e),null;case J:return Id(e),null;case me:case be:return gb(e),null;default:return null}})(t);if(null!==i)return i.flags&=ro,void(g=i);if((t.mode&Zu)!==b){Lg(t,!1);for(var d=t.actualDuration,h=t.child;null!==h;)d+=h.actualDuration,h=h.sibling;t.actualDuration=d}null!==n&&(n.firstEffect=n.lastEffect=null,n.flags|=so)}o=t.sibling;if(null!==o)return void(g=o)}while(g=t=n,null!==t);Em===hm&&(Em=bm)}function Ib(e){var t=Vu();return Wu(Ou,function(e,t){for(;Rb(),null!==Bm;);if(nd.flushLegacyContextWarning(),nd.flushPendingUnsafeLifecycleWarnings(),(C&(cm|um))!==E)throw Error("Should not already be working.");var i=e.finishedWork,n=e.finishedLanes;if(null!==i){if(e.finishedWork=null,e.finishedLanes=W,i===e.current)throw Error("Cannot commit the same tree as before. This error is likely caused by a bug in React. Please file an issue.");e.callbackNode=null;var o,r=i.lanes|i.childLanes;if(((e,t)=>{for(var i=e.pendingLanes&~t,n=(e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,e.entanglements),o=e.eventTimes,r=e.expirationTimes,s=i;0<s;){var a=Xr(s),l=1<<a;n[a]=W,o[a]=y,r[a]=y,s&=~l}})(e,r),null!==Vm&&(r&Sr)===W&&Vm.has(e)&&Vm.delete(e),e===_m&&(g=_m=null,ym=W),null!==(o=Yn<i.flags?null!==i.lastEffect?(i.lastEffect.nextEffect=i).firstEffect:i:i.firstEffect)){var s=C,a=(C|=um,yb(e));om.current=null,eb=ac(e.containerInfo),tb=!1,I=o;do{if(jn(null,wb,null),Fn){if(null===I)throw Error("Should be working on an effect.");var l=Wn();$b(I,l),I=I.nextEffect}}while(null!==I);eb=null,Og(),I=o;do{if(jn(null,Sb,null,e,t),Fn){if(null===I)throw Error("Should be working on an effect.");var c=Wn();$b(I,c),I=I.nextEffect}}while(null!==I);$a(rc),ls(oc),rc=oc=null,e.current=i,I=o;do{if(jn(null,xb,null,e,n),Fn){if(null===I)throw Error("Should be working on an effect.");var u=Wn();$b(I,u),I=I.nextEffect}}while(null!==I);I=null,Pu(),vb(a),C=s}else e.current=i,Og();a=Pm;if(Pm)Pm=!1,Bm=e,Um=n,Fm=t;else for(I=o;null!==I;){var d=I.nextEffect;I.nextEffect=null,I.flags&Xn&&i_(I),I=d}if((r=e.pendingLanes)!==W){if(null!==Xm){var h=Xm;Xm=null;for(var p=0;p<h.length;p++)Jb(e,h[p],e.memoizedInteractions)}Zb(e,r)}else $m=null;if(a||e_(e,n),r===m?e===zm?Wm++:(Wm=0,zm=e):Wm=0,((e,t)=>{if(fu&&"function"==typeof fu.onCommitFiberRoot)try{var i=(e.current.flags&j)===j;x?fu.onCommitFiberRoot(gu,e,t,i):fu.onCommitFiberRoot(gu,e,void 0,i)}catch(e){mu||(mu=!0,ee("React instrumentation encountered an error: %s",e))}})(i.stateNode,t),tm.forEach(function(e){return e()}),sb(e,Gu()),Dm)throw Dm=!1,s=Mm,Mm=null,s;(C&lm)===E&&Ku()}return null}.bind(null,e,t)),null}function wb(){for(;null!==I;){var e=I.alternate,t=(tb||null===eb||((I.flags&Xn)!==G?bo(I,eb)&&(tb=!0):I.tag===H&&((e,t)=>{if(null!==e){var e=e.memoizedState;if(null===e||null!==e.dehydrated)return null!==(e=t.memoizedState)&&null===e.dehydrated}})(e,I)&&bo(I,eb)&&(tb=!0)),I.flags);(t&Qn)!==G&&(f(I),((e,t)=>{switch(t.tag){case te:case re:case ce:case fe:return;case ie:var i,n,o;return t.flags&Qn&&null!==e&&(n=e.memoizedProps,o=e.memoizedState,i=t.stateNode,t.type!==t.elementType||Yg||(i.props!==t.memoizedProps&&ee("Expected %s props to match memoized props before getSnapshotBeforeUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",se(t.type)||"instance"),i.state!==t.memoizedState&&ee("Expected %s state to match memoized state before getSnapshotBeforeUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",se(t.type)||"instance")),n=i.getSnapshotBeforeUpdate(t.elementType===t.type?n:pd(t.type,n),o),o=Hf,void 0!==n||o.has(t.type)||(o.add(t.type),ee("%s.getSnapshotBeforeUpdate(): A snapshot value (or null) must be returned. You have returned undefined.",se(t.type))),i.__reactInternalSnapshotBeforeUpdate=n);case F:return t.flags&Qn&&yc(t.stateNode.containerInfo);case U:case oe:case ne:case de:return}throw Error("This unit of work tag should not have side-effects. This error is likely caused by a bug in React. Please file an issue.")})(e,I),Ot()),(t&eo)===G||Pm||(Pm=!0,zu(Nu,function(){return Rb(),null})),I=I.nextEffect}}function Sb(e,t){for(;null!==I;){f(I);var i=I.flags;switch(i&qn&&gc(I.stateNode),i&Zn&&null!==(r=I.alternate)&&null!==(r=(r=r).ref)&&("function"==typeof r?r(null):r.current=null),i&(ae|V|Xn|io)){case ae:Jf(I),I.flags&=~ae;break;case Kn:Jf(I),I.flags&=~ae,Qf(I.alternate,I);break;case io:I.flags&=~io;break;case no:I.flags&=~io,Qf(I.alternate,I);break;case V:Qf(I.alternate,I);break;case Xn:Zf(n=e,o=I),n=o.alternate,Xf(o),null!==n&&Xf(n)}Ot(),I=I.nextEffect}var n,o,r}function xb(e,t){for(;null!==I;){f(I);var i=I.flags;i&(V|Jn)&&zf(e,I.alternate,I),i&Zn&&(o=i=void 0,null!==(o=(n=I).ref))&&(i=n.stateNode,"function"==typeof o?o(i):(o.hasOwnProperty("current")||ee("Unexpected ref object provided for %s. Use either a ref-setter function or React.createRef().",se(n.type)),o.current=i)),Ot(),I=I.nextEffect}var n,o}function Rb(){var e;return Fm!==Mu&&(e=Nu<Fm?Nu:Fm,Fm=Mu,Wu(e,Nb))}function Ob(e,t){Gm.push(t,e),e.flags|=to;t=e.alternate;null!==t&&(t.flags|=to),Pm||(Pm=!0,zu(Nu,function(){return Rb(),null}))}function Ab(e){var t=e.create;e.destroy=t()}function Nb(){if(null===Bm)return!1;var e=Bm,t=Um;if(Bm=null,Um=W,(C&(cm|um))!==E)throw Error("Cannot flush passive effects while already rendering.");Qm=!0;var i=C,n=(C|=um,yb(e)),o=Gm;Gm=[];for(var r=0;r<o.length;r+=2){var s=o[r],a=o[r+1],l=s.destroy,s=(s.destroy=void 0,a.flags&=~to,a.alternate);if(null!==s&&(s.flags&=~to),"function"==typeof l){if(f(a),jn(null,l,null),Fn){if(null===a)throw Error("Should be working on an effect.");$b(a,Wn())}Ot()}}var c=Hm;Hm=[];for(var u=0;u<c.length;u+=2){var d=c[u],h=c[u+1];if(f(h),jn(null,Ab,null,d),Fn){if(null===h)throw Error("Should be working on an effect.");$b(h,Wn())}Ot()}for(var p=e.current.firstEffect;null!==p;){var g=p.nextEffect;p.nextEffect=null,p.flags&Xn&&i_(p),p=g}return vb(n),e_(e,t),Qm=!1,C=i,Ku(),Km=null===Bm?0:Km+1,!0}function Lb(e){return null!==$m&&$m.has(e)}var Db=function(e){Dm||(Dm=!0,Mm=e)};function Mb(e,t,i){$d(e,Pf(e,Of(i,t),m));i=ib(),t=rb(e,m);null!==t&&(Qr(t,m,i),sb(t,i),Zb(t,m))}function $b(e,t){if(e.tag===F)Mb(e,e,t);else for(var i=e.return;null!==i;){if(i.tag===F)return void Mb(i,e,t);if(i.tag===ie){var n=i.type,o=i.stateNode;if("function"==typeof n.getDerivedStateFromError||"function"==typeof o.componentDidCatch&&!Lb(o)){var n=Of(t,e),r=($d(i,Bf(i,n,m)),ib()),s=rb(i,m);if(null!==s)Qr(s,m,r),sb(s,r),Zb(s,m);else if("function"==typeof o.componentDidCatch&&!Lb(o))try{o.componentDidCatch(t,n)}catch(e){}return}}i=i.return}}var Pb=null;function Bb(e){if((C&cm)===E&&e.mode&(qu|Ju)){var t=e.tag;if(t===K||t===F||t===ie||t===te||t===re||t===Q||t===ce||t===fe){t=se(e.type)||"ReactComponent";if(null!==Pb){if(Pb.has(t))return;Pb.add(t)}else Pb=new Set([t]);t=wt;try{f(e),ee("Can't perform a React state update on a component that hasn't mounted yet. This indicates that you have a side-effect in your render function that asynchronously later calls tries to update the component. Move this work to useEffect instead.")}finally{t?f(e):Ot()}}}}var Fb=null,Ub=null,Hb=function(t,i,n){var o=x_(Ub,i);try{return Cf(t,i,n)}catch(e){if(null!==e&&"object"==typeof e&&"function"==typeof e.then)throw e;throw Td(),xp(),Rf(i),x_(i,o),i.mode&Zu&&Ag(i),jn(null,Cf,null,t,i,n),Fn?Wn():e}},Gb=!1,Vb=new Set,jb={current:!1};function Wb(e){if(!0===rm.current&&!0!==jb.current){var t=wt;try{f(e),ee("It looks like you're using the wrong act() around your test interactions.\nBe sure to use the matching version of act() corresponding to your renderer:\n\n// for react-dom:\nimport {act} from 'react-dom/test-utils';\n// ...\nact(() => ...);\n\n// for react-test-renderer:\nimport TestRenderer from react-test-renderer';\nconst {act} = TestRenderer;\n// ...\nact(() => ...);")}finally{t?f(e):Ot()}}}function zb(e){(e.mode&z)!==b&&!1===rm.current&&!1===jb.current&&ee("An update to %s ran an effect, but was not wrapped in act(...).\n\nWhen testing, code that causes React state updates should be wrapped into act(...):\n\nact(() => {\n  /* fire events that update state */\n});\n/* assert on the output */\n\nThis ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act",se(e.type))}var Yb=function(e){if(C===E&&!1===rm.current&&!1===jb.current){var t=wt;try{f(e),ee("An update to %s inside a test was not wrapped in act(...).\n\nWhen testing, code that causes React state updates should be wrapped into act(...):\n\nact(() => {\n  /* fire events that update state */\n});\n/* assert on the output */\n\nThis ensures that you're testing the behavior the user would see in the browser. Learn more at https://reactjs.org/link/wrap-tests-with-act",se(e.type))}finally{t?f(e):Ot()}}},Kb=!1;function Xb(e,t){return 1e3*t+e.interactionThreadID}function qb(e){null===Xm?Xm=[e]:Xm.push(e)}function Jb(e,t,i){var n,o;0<i.size&&(o=e.pendingInteractionMap,null!=(n=o.get(t))?i.forEach(function(e){n.has(e)||e.__count++,n.add(e)}):(o.set(t,new Set(i)),i.forEach(function(e){e.__count++})),null!==(o=u.__subscriberRef.current))&&(e=Xb(e,t),o.onWorkScheduled(i,e))}function Zb(e,t){Jb(e,t,u.__interactionsRef.current)}function Qb(e,i){var n=new Set;if(e.pendingInteractionMap.forEach(function(e,t){qr(i,t)&&e.forEach(function(e){return n.add(e)})}),0<(e.memoizedInteractions=n).size){var t=u.__subscriberRef.current;if(null!==t){e=Xb(e,i);try{t.onWorkStarted(n,e)}catch(e){zu(Ou,function(){throw e})}}}}function e_(e,t){var i,n,o=e.pendingLanes;try{null!==(n=u.__subscriberRef.current)&&0<e.memoizedInteractions.size&&(i=Xb(e,t),n.onWorkStopped(e.memoizedInteractions,i))}catch(e){zu(Ou,function(){throw e})}finally{var r=e.pendingInteractionMap;r.forEach(function(e,t){qr(o,t)||(r.delete(t),e.forEach(function(e){if(e.__count--,null!==n&&0===e.__count)try{n.onInteractionScheduledWorkCompleted(e)}catch(e){zu(Ou,function(){throw e})}}))})}}var t_=0;function i_(e){e.sibling=null,e.stateNode=null}function n_(e){r_=e}var o_,r_=null,s_=null;function a_(e){var t;return null===r_||void 0===(t=r_(e))?e:t.current}function l_(e){return a_(e)}function c_(e){if(null!==r_){var t=r_(e);if(void 0!==t)return t.current;if(null!=e&&"function"==typeof e.render){var t=a_(e.render);if(e.render!==t)return t={$$typeof:We,render:t},void 0!==e.displayName&&(t.displayName=e.displayName),t}}return e}function u_(e,t){if(null!==r_){var i=e.elementType,n=t.type,o=!1,r="object"==typeof n&&null!==n?n.$$typeof:null;switch(e.tag){case ie:"function"==typeof n&&(o=!0);break;case te:("function"==typeof n||r===Xe)&&(o=!0);break;case re:(r===We||r===Xe)&&(o=!0);break;case Q:case ce:(r===Ke||r===Xe)&&(o=!0);break;default:return}if(o){t=r_(i);if(void 0!==t&&t===r_(n))return 1}}}function d_(e){null!==r_&&"function"==typeof WeakSet&&(s_=null===s_?new WeakSet:s_).add(e)}function h_(e,t){var i,n;null!==r_&&(i=t.staleFamilies,n=t.updatedFamilies,Rb(),hb(function(){!function e(t,i,n){{var o=t.alternate,r=t.child,s=t.sibling,a=t.tag,l=t.type,c=null;switch(a){case te:case ce:case ie:c=l;break;case re:c=l.render}if(null===r_)throw new Error("Expected resolveFamily to be set during hot reload.");var u,d=!1,h=!1;null!==c&&void 0!==(u=r_(c))&&(n.has(u)?h=!0:i.has(u)&&(a===ie?h=!0:d=!0)),(h=null!==s_&&(s_.has(t)||null!==o&&s_.has(o))?!0:h)&&(t._debugNeedsRemount=!0),(h||d)&&ob(t,m,y),null===r||h||e(r,i,n),null!==s&&e(s,i,n)}}(e.current,n,i)}))}function p_(e,t){e.context===Xc&&(Rb(),hb(function(){A_(t,e,null,null)}))}function g_(e,t){var i=new Set,t=new Set(t.map(function(e){return e.current}));return function e(t,i,n){{var o=t.child,r=t.sibling,s=t.tag,a=t.type,l=null;switch(s){case te:case ce:case ie:l=a;break;case re:l=a.render}s=!1;(s=null!==l&&i.has(l)?!0:s)?f_(t,n):null!==o&&e(o,i,n),null!==r&&e(r,i,n)}}(e.current,t,i),i}function f_(e,t){var i=((e,t)=>{for(var i=e,n=!1;;){if(i.tag===U)n=!0,t.add(i.stateNode);else if(null!==i.child){i=(i.child.return=i).child;continue}if(i===e)return n;for(;null===i.sibling;){if(null===i.return||i.return===e)return n;i=i.return}i.sibling.return=i.return,i=i.sibling}return!1})(e,t);if(!i)for(var n=e;;){switch(n.tag){case U:return void t.add(n.stateNode);case ne:case F:return void t.add(n.stateNode.containerInfo)}if(null===n.return)throw new Error("Expected to reach root first.");n=n.return}}o_=!1;try{var m_=Object.preventExtensions({});new Map([[m_,null]]),new Set([m_])}catch(e){o_=!0}var b_=1;function __(e,t,i,n){this.tag=e,this.key=i,this.elementType=null,this.type=null,this.stateNode=null,this.return=null,this.child=null,this.sibling=null,this.index=0,this.ref=null,this.pendingProps=t,this.memoizedProps=null,this.updateQueue=null,this.memoizedState=null,this.dependencies=null,this.mode=n,this.flags=G,this.nextEffect=null,this.firstEffect=null,this.lastEffect=null,this.lanes=W,this.childLanes=W,this.alternate=null,this.actualDuration=Number.NaN,this.actualStartTime=Number.NaN,this.selfBaseDuration=Number.NaN,this.treeBaseDuration=Number.NaN,this.actualDuration=0,this.actualStartTime=-1,this.selfBaseDuration=0,this.treeBaseDuration=0,this._debugID=b_++,this._debugSource=null,this._debugOwner=null,this._debugNeedsRemount=!1,this._debugHookTypes=null,o_||"function"!=typeof Object.preventExtensions||Object.preventExtensions(this)}var y_=function(e,t,i,n){return new __(e,t,i,n)};function v_(e){e=e.prototype;return e&&e.isReactComponent}function T_(e,t){var i=e.alternate,t=(null===i?((i=y_(e.tag,t,e.key,e.mode)).elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i._debugID=e._debugID,i._debugSource=e._debugSource,i._debugOwner=e._debugOwner,i._debugHookTypes=e._debugHookTypes,(i.alternate=e).alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=G,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null,i.actualDuration=0,i.actualStartTime=-1),i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,e.dependencies);switch(i.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i.selfBaseDuration=e.selfBaseDuration,i.treeBaseDuration=e.treeBaseDuration,i._debugNeedsRemount=e._debugNeedsRemount,i.tag){case K:case te:case ce:i.type=a_(e.type);break;case ie:i.type=l_(e.type);break;case re:i.type=c_(e.type)}return i}function E_(e,t,i,n,o,r){var s=K,a=e;if("function"==typeof e)a=(v_(e)?(s=ie,l_):a_)(a);else if("string"==typeof e)s=U;else e:switch(e){case Ue:return C_(i.children,o,r,t);case Ze:s=X,o|=Qu;break;case He:s=X,o|=z;break;case Ge:var l=i,c=o,u=r,d=t;return"string"!=typeof l.id&&ee('Profiler must specify an "id" as a prop'),(l=y_(Z,l,d,c|Zu)).elementType=Ge,l.type=Ge,l.lanes=u,l.stateNode={effectDuration:0,passiveEffectDuration:0},l;case ze:d=i,c=r;return(d=y_(H,d,t,o)).type=ze,d.elementType=ze,d.lanes=c,d;case Ye:u=i,l=r;return(u=y_(he,u,t,o)).type=Ye,u.elementType=Ye,u.lanes=l,u;case Qe:return I_(i,o,r,t);case et:var h=i,p=r;return(h=y_(be,h,t,o)).type=et,h.elementType=et,h.lanes=p,h;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case Ve:s=J;break e;case je:s=q;break e;case We:s=re,a=c_(a);break e;case Ke:s=Q;break e;case Xe:s=ue,a=null;break e;case qe:s=fe;break e}p="",h=((void 0===e||"object"==typeof e&&null!==e&&0===Object.keys(e).length)&&(p+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports."),n?se(n.type):null);throw h&&(p+="\n\nCheck the render method of `"+h+"`."),Error("Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: "+(null==e?e:typeof e)+"."+p)}var g=y_(s,i,t,o);return g.elementType=e,g.type=a,g.lanes=r,g._debugOwner=n,g}function k_(e,t,i){var n=e._owner,n=E_(e.type,e.key,e.props,n,t,i);return n._debugSource=e._source,n._debugOwner=e._owner,n}function C_(e,t,i,n){e=y_(le,e,n,t);return e.lanes=i,e}function I_(e,t,i,n){e=y_(me,e,n,t);return e.type=Qe,e.elementType=Qe,e.lanes=i,e}function w_(e,t,i){e=y_(oe,e,null,t);return e.lanes=i,e}function S_(e,t,i){var n=null!==e.children?e.children:[],n=y_(ne,n,e.key,t);return n.lanes=i,n.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},n}function x_(e,t){return(e=null===e?y_(K,null,null,b):e).tag=t.tag,e.key=t.key,e.elementType=t.elementType,e.type=t.type,e.stateNode=t.stateNode,e.return=t.return,e.child=t.child,e.sibling=t.sibling,e.index=t.index,e.ref=t.ref,e.pendingProps=t.pendingProps,e.memoizedProps=t.memoizedProps,e.updateQueue=t.updateQueue,e.memoizedState=t.memoizedState,e.dependencies=t.dependencies,e.mode=t.mode,e.flags=t.flags,e.nextEffect=t.nextEffect,e.firstEffect=t.firstEffect,e.lastEffect=t.lastEffect,e.lanes=t.lanes,e.childLanes=t.childLanes,e.alternate=t.alternate,e.actualDuration=t.actualDuration,e.actualStartTime=t.actualStartTime,e.selfBaseDuration=t.selfBaseDuration,e.treeBaseDuration=t.treeBaseDuration,e._debugID=t._debugID,e._debugSource=t._debugSource,e._debugOwner=t._debugOwner,e._debugNeedsRemount=t._debugNeedsRemount,e._debugHookTypes=t._debugHookTypes,e}function R_(e,t,i){switch(this.tag=t,this.containerInfo=e,this.pendingChildren=null,this.current=null,this.pingCache=null,this.finishedWork=null,this.timeoutHandle=pc,this.context=null,this.pendingContext=null,this.hydrate=i,this.callbackNode=null,this.callbackPriority=Er,this.eventTimes=Zr(W),this.expirationTimes=Zr(y),this.pendingLanes=W,this.suspendedLanes=W,this.pingedLanes=W,this.expiredLanes=W,this.mutableReadLanes=W,this.finishedLanes=W,this.entangledLanes=W,this.entanglements=Zr(W),this.mutableSourceEagerHydrationData=null,this.interactionThreadID=u.unstable_getThreadID(),this.memoizedInteractions=new Set,this.pendingInteractionMap=new Map,t){case hu:this._debugRootType="createBlockingRoot()";break;case pu:this._debugRootType="createRoot()";break;case du:this._debugRootType="createLegacyRoot()"}}function O_(e,t,i){e=new R_(e,t,i),i=(i=t)===pu?Ju|qu|z:i===hu?qu|z:b,bu&&(i|=Zu),t=y_(F,null,null,i);return(e.current=t).stateNode=e,Ld(t),e}function A_(e,t,i,n){var o=t,r=e;if(fu&&"function"==typeof fu.onScheduleFiberRoot)try{fu.onScheduleFiberRoot(gu,o,r)}catch(e){mu||(mu=!0,ee("React instrumentation encountered an error: %s",e))}var o=t.current,r=ib(),s=("undefined"!=typeof jest&&(s=o,!1===Kb&&void 0===a.unstable_flushAllWithoutAsserting&&(s.mode&qu||s.mode&Ju)&&(Kb=!0,ee("In Concurrent or Sync modes, the \"scheduler\" module needs to be mocked to guarantee consistent behaviour across tests and browsers. For example, with jest: \njest.mock('scheduler', () => require('scheduler/unstable_mock'));\n\nFor more info, visit https://reactjs.org/link/mock-scheduler")),Wb(o)),nb(o)),i=(e=>{if(!e)return Xc;var t=uu(e=zn(e));if(e.tag===ie){var i=e.type;if(nu(i))return au(e,i,t)}return t})(i),t=(null===t.context?t.context=i:t.pendingContext=i,St&&null!==wt&&!$_&&($_=!0,ee("Render methods should be a pure function of props and state; triggering nested component updates from render is not allowed. If necessary, trigger nested updates in componentDidUpdate.\n\nCheck the render method of %s.",se(wt.type)||"Unknown")),Md(r,s));t.payload={element:e},null!==(n=void 0===n?null:n)&&("function"!=typeof n&&ee("render(...): Expected the last optional `callback` argument to be a function. Instead received: %s.",n),t.callback=n),$d(o,t),ob(o,s,r)}function N_(e){e=e.current;return e.child?(e.child.tag,e.child.stateNode):null}function L_(e,t){var e=e.memoizedState;null!==e&&null!==e.dehydrated&&(e.retryLane=(e=e.retryLane,t=t,e!==Cr&&e<t?e:t))}function D_(e,t){L_(e,t);e=e.alternate;e&&L_(e,t)}function M_(e){e=(e=>{var t=fo(e);if(t)for(var i=t;;){if(i.tag===U||i.tag===oe||R)return i;if(i.child&&i.tag!==ne)i=(i.child.return=i).child;else{if(i===t)return null;for(;!i.sibling;){if(!i.return||i.return===t)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}}return null})(e);return null===e?null:e.tag===pe?e.stateNode.instance:e.stateNode}var $_=!1,P_={},B_=function(e){return!1};function F_(e,t){return V_(e,t,0)}function U_(e,t,i){if(t.length===i.length){for(var n=0;n<i.length-1;n++)if(t[n]!==i[n])return void p("copyWithRename() expects paths to be the same except for the deepest key");return j_(e,t,i,0)}p("copyWithRename() expects paths of the same length")}function H_(e,t,i){return W_(e,t,0,i)}function G_(e,t){for(var i=e.memoizedState;null!==i&&0<t;)i=i.next,t--;return i}var V_=function(e,t,i){var n=t[i],o=Array.isArray(e)?e.slice():T({},e);return i+1===t.length?Array.isArray(o)?o.splice(n,1):delete o[n]:o[n]=V_(e[n],t,i+1),o},j_=function(e,t,i,n){var o=t[n],r=Array.isArray(e)?e.slice():T({},e);return n+1===t.length?(r[i[n]]=r[o],Array.isArray(r)?r.splice(o,1):delete r[o]):r[o]=j_(e[o],t,i,n+1),r},W_=function(e,t,i,n){var o,r;return i>=t.length?n:(o=t[i],(r=Array.isArray(e)?e.slice():T({},e))[o]=W_(e[o],t,i+1,n),r)},z_=function(e,t,i,n){t=G_(e,t);null!==t&&(i=H_(t.memoizedState,i,n),t.memoizedState=i,t.baseState=i,e.memoizedProps=T({},e.memoizedProps),ob(e,m,y))},Y_=function(e,t,i){t=G_(e,t);null!==t&&(i=F_(t.memoizedState,i),t.memoizedState=i,t.baseState=i,e.memoizedProps=T({},e.memoizedProps),ob(e,m,y))},K_=function(e,t,i,n){t=G_(e,t);null!==t&&(i=U_(t.memoizedState,i,n),t.memoizedState=i,t.baseState=i,e.memoizedProps=T({},e.memoizedProps),ob(e,m,y))},X_=function(e,t,i){e.pendingProps=H_(e.memoizedProps,t,i),e.alternate&&(e.alternate.pendingProps=e.pendingProps),ob(e,m,y)},q_=function(e,t){e.pendingProps=F_(e.memoizedProps,t),e.alternate&&(e.alternate.pendingProps=e.pendingProps),ob(e,m,y)},J_=function(e,t,i){e.pendingProps=U_(e.memoizedProps,t,i),e.alternate&&(e.alternate.pendingProps=e.pendingProps),ob(e,m,y)},Z_=function(e){ob(e,m,y)},Q_=function(e){B_=e};function ey(e){e=mo(e);return null===e?null:e.stateNode}function ty(e){return null}function iy(){return wt}function ny(e,t,i){this._internalRoot=oy(e,t,i)}function oy(e,t,i){var n,o,r=null!=i&&!0===i.hydrate,s=(null!=i&&i.hydrationOptions,null!=i&&null!=i.hydrationOptions&&i.hydrationOptions.mutableSources||null),a=O_(e,t,r);i=a.current,e[Sc]=i,e.nodeType;if(Qa(e.nodeType===Ci?e.parentNode:e),s)for(var l=0;l<s.length;l++){var c=s[l];n=a,o=(o=void 0,(c=c)._getVersion)(c._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[c,o]:n.mutableSourceEagerHydrationData.push(c,o)}return a}function ry(e){return!(!e||e.nodeType!==Ei&&e.nodeType!==Ii&&e.nodeType!==wi&&(e.nodeType!==Ci||" react-mount-point-unstable "!==e.nodeValue))}ny.prototype.render=function(e){var t,i=this._internalRoot,n=("function"==typeof arguments[1]&&ee("render(...): does not support the second callback argument. To execute a side effect after rendering, declare it in a component body with useEffect()."),i.containerInfo);n.nodeType!==Ci&&(t=M_(i.current))&&t.parentNode!==n&&ee("render(...): It looks like the React-rendered content of the root container was removed without using React. This is not supported and will cause errors. Instead, call root.unmount() to empty a root's container."),A_(e,i,null,null)},ny.prototype.unmount=function(){"function"==typeof arguments[0]&&ee("unmount(...): does not support a callback argument. To execute a side effect after rendering, declare it in a component body with useEffect().");var e=this._internalRoot,t=e.containerInfo;A_(null,e,null,function(){Oc(t)})};var sy=d.ReactCurrentOwner,ay=!1;function ly(e){return e?e.nodeType===Ii?e.documentElement:e.firstChild:null}function cy(e,t){var i=t||!(!(i=ly(i=e))||i.nodeType!==Ei||!i.hasAttribute(ye));if(!i)for(var n,o=!1;n=e.lastChild;)!o&&n.nodeType===Ei&&n.hasAttribute(ye)&&(o=!0,ee("render(): Target node has markup rendered by React, but there are unrelated nodes as well. This is most commonly caused by white-space inserted around server-rendered markup.")),e.removeChild(n);return!i||t||ay||(ay=!0,p("render(): Calling ReactDOM.render() to hydrate server-rendered markup will stop working in React v18. Replace the ReactDOM.render() call with ReactDOM.hydrate() if you want React to attach to the server HTML.")),new ny(e,du,i?{hydrate:!0}:void 0)}function uy(e,t,i,n,o){dy(i),c="render",null!==(r=void 0===o?null:o)&&"function"!=typeof r&&ee("%s(...): Expected the last optional `callback` argument to be a function. Instead received: %s.",c,r);var r,s,a,l,c=i._reactRootContainer;return c?(l=c._internalRoot,"function"==typeof o&&(s=o,o=function(){var e=N_(l);s.call(e)}),A_(t,l,e,o)):(l=(c=i._reactRootContainer=cy(i,n))._internalRoot,"function"==typeof o&&(a=o,o=function(){var e=N_(l);a.call(e)}),db(function(){A_(t,l,e,o)})),N_(l)}var dy=function(e){e._reactRootContainer&&e.nodeType!==Ci&&(t=M_(e._reactRootContainer._internalRoot.current))&&t.parentNode!==e&&ee("render(...): It looks like the React-rendered content of this container was removed without using React. This is not supported and will cause errors. Instead, call ReactDOM.unmountComponentAtNode to empty a container.");var t=!!e._reactRootContainer,i=ly(e);i&&Lc(i)&&!t&&ee("render(...): Replacing React-rendered children with a new root component. If you intended to update the children of this node, you should instead have the existing children update their state and render the new components instead of calling ReactDOM.render."),e.nodeType===Ei&&e.tagName&&"BODY"===e.tagName.toUpperCase()&&ee("render(): Rendering components directly into document.body is discouraged, since its children are often manipulated by third-party scripts and browser extensions. This may lead to subtle reconciliation issues. Try rendering into a container element created for your app.")},hy=function(e){var t,i;e.tag===H&&(t=ib(),ob(e,i=wr,t),D_(e,i))},py=function(e){var t,i;e.tag===H&&(t=ib(),ob(e,i=$r,t),D_(e,i))},gy=function(e){var t,i;e.tag===H&&(t=ib(),ob(e,i=nb(e),t),D_(e,i))},fy=function(e,t){return t()},my=!1;function by(e,t){if(ry(t))return function(e,t,i,n){return{$$typeof:Fe,key:null==(n=3<arguments.length&&void 0!==n?n:null)?null:""+n,children:e,containerInfo:t,implementation:i}}(e,t,null,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null);throw Error("Target container is not a DOM element.")}"function"==typeof Map&&null!=Map.prototype&&"function"==typeof Map.prototype.forEach&&"function"==typeof Set&&null!=Set.prototype&&"function"==typeof Set.prototype.clear&&"function"==typeof Set.prototype.forEach||ee("React depends on Map and Set built-in types. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),vn=function(e,t,i){switch(t){case"input":return void qt(e,i);case"textarea":return void di(e,i);case"select":return n=e,void(null!=(r=(o=i).value)&&ri(n,!!o.multiple,r,!1))}var n,o,r},wn=ub,Sn=function(e,t,i,n,o){var r=C;C|=am;try{return Wu(Au,e.bind(null,t,i,n,o))}finally{(C=r)===E&&(Lm(),Ku())}},xn=function(){var e;(C&(sm|cm|um))!==E?(C&cm)!==E&&ee("unstable_flushDiscreteUpdates: Cannot flush updates when React is already rendering."):(null!==Vm&&(e=Vm,Vm=null,e.forEach(function(e){e.expiredLanes|=Sr&e.pendingLanes,sb(e,Gu())})),Ku(),Rb())},Rn=function(e,t){var i=C;C|=2;try{return e(t)}finally{(C=i)===E&&(Lm(),Ku())}},Zo={Events:[Lc,Dc,Mc,Cn,In,Rb,jb]},!(e=>{var t=e.findFiberByHostInstance,i=d.ReactCurrentDispatcher,e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:z_,overrideHookStateDeletePath:Y_,overrideHookStateRenamePath:K_,overrideProps:X_,overridePropsDeletePath:q_,overridePropsRenamePath:J_,setSuspenseHandler:Q_,scheduleUpdate:Z_,currentDispatcherRef:i,findHostInstanceByFiber:ey,findFiberByHostInstance:t||ty,findHostInstancesForRefresh:g_,scheduleRefresh:h_,scheduleRoot:p_,setRefreshHandler:n_,getCurrentFiber:iy};if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;if(!(i=__REACT_DEVTOOLS_GLOBAL_HOOK__).isDisabled)if(i.supportsFiber)try{gu=i.inject(e),fu=i}catch(e){ee("React instrumentation encountered an error: %s.",e)}else ee("The installed version of React DevTools is too old and will not work with the current version of React. Please update React DevTools. https://reactjs.org/link/react-devtools");return!0})({findFiberByHostInstance:Nc,bundleType:1,version:"17.0.2",rendererPackageName:"react-dom"})&&t&&window.top===window.self&&(-1<navigator.userAgent.indexOf("Chrome")&&-1===navigator.userAgent.indexOf("Edge")||-1<navigator.userAgent.indexOf("Firefox"))&&(n=window.location.protocol,/^(https?|file):$/.test(n))&&console.info("%cDownload the React DevTools for a better development experience: https://reactjs.org/link/react-devtools"+("file:"===n?"\nYou might need to use a local HTTP server (instead of file://): https://reactjs.org/link/react-devtools-faq":""),"font-weight:bold"),vy.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Zo,vy.createPortal=by,vy.findDOMNode=function(e){if(null!==(t=sy.current)&&null!==t.stateNode&&(t.stateNode._warnedAboutRefsInRender||ee("%s is accessing findDOMNode inside its render(). render() should be a pure function of props and state. It should never access something that requires stale data from the previous render, such as refs. Move this logic to componentDidMount and componentDidUpdate instead.",se(t.type)||"A component"),t.stateNode._warnedAboutRefsInRender=!0),null==e)return null;if(e.nodeType===Ei)return e;var t=e,e="findDOMNode",i=zn(t);if(void 0===i)throw"function"==typeof t.render?Error("Unable to find node on an unmounted component."):Error("Argument appears to not be a ReactComponent. Keys: "+Object.keys(t));if(null===(t=mo(i)))return null;if(t.mode&z){var n=se(i.type)||"Component";if(!P_[n]){P_[n]=!0;var o=wt;try{f(t),i.mode&z?ee("%s is deprecated in StrictMode. %s was passed an instance of %s which is inside StrictMode. Instead, add a ref directly to the element you want to reference. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-find-node",e,e,n):ee("%s is deprecated in StrictMode. %s was passed an instance of %s which renders StrictMode children. Instead, add a ref directly to the element you want to reference. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-find-node",e,e,n)}finally{o?f(o):Ot()}}}return t.stateNode},vy.flushSync=hb,vy.hydrate=function(e,t,i){if(ry(t))return Ac(t)&&void 0===t._reactRootContainer&&ee("You are calling ReactDOM.hydrate() on a container that was previously passed to ReactDOM.createRoot(). This is not supported. Did you mean to call createRoot(container, {hydrate: true}).render(element)?"),uy(null,e,t,!0,i);throw Error("Target container is not a DOM element.")},vy.render=function(e,t,i){if(ry(t))return Ac(t)&&void 0===t._reactRootContainer&&ee("You are calling ReactDOM.render() on a container that was previously passed to ReactDOM.createRoot(). This is not supported. Did you mean to call root.render(element)?"),uy(null,e,t,!1,i);throw Error("Target container is not a DOM element.")},vy.unmountComponentAtNode=function(e){var t,i;if(ry(e))return Ac(e)&&void 0===e._reactRootContainer&&ee("You are calling ReactDOM.unmountComponentAtNode() on a container that was previously passed to ReactDOM.createRoot(). This is not supported. Did you mean to call root.unmount()?"),e._reactRootContainer?((t=ly(e))&&!Lc(t)&&ee("unmountComponentAtNode(): The node you're attempting to unmount was rendered by another copy of React."),db(function(){uy(null,null,e,!1,function(){e._reactRootContainer=null,Oc(e)})}),!0):(t=!(!(t=ly(e))||!Lc(t)),i=e.nodeType===Ei&&ry(e.parentNode)&&!!e.parentNode._reactRootContainer,t&&ee("unmountComponentAtNode(): The node you're attempting to unmount was rendered by React and is not a top-level container. %s",i?"You may have accidentally passed in a React root node instead of its container.":"Instead, have the parent component update its state and rerender in order to remove this component."),!1);throw Error("unmountComponentAtNode(...): Target container is not a DOM element.")},vy.unstable_batchedUpdates=ub,vy.unstable_createPortal=function(e,t){var i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return my||(my=!0,p('The ReactDOM.unstable_createPortal() alias has been deprecated, and will be removed in React 18+. Update your code to use ReactDOM.createPortal() instead. It has the exact same API, but without the "unstable_" prefix.')),by(e,t,i)},vy.unstable_renderSubtreeIntoContainer=function(e,t,i,n){if(!ry(i))throw Error("Target container is not a DOM element.");if(null==e||void 0===e._reactInternals)throw Error("parentComponent must be a valid React Component");return uy(e,t,i,!1,n)},vy.version="17.0.2"}}.call(this)}.call(this,yy("_process"))},{_process:223,"object-assign":222,react:268,scheduler:275,"scheduler/tracing":276}],231:[function(e,M,$){var B=e("react"),f=e("object-assign"),o=e("scheduler");function P(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!B)throw Error(P(227));var F=new Set,U={};function H(e,t){G(e,t),G(e+"Capture",t)}function G(e,t){for(U[e]=t,e=0;e<t.length;e++)F.add(t[e])}var e=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),V=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,j=Object.prototype.hasOwnProperty,W={},z={};function Y(e,t,i,n){if(null==t||((e,t,i,n)=>{if(null===i||0!==i.type)switch(typeof t){case"function":case"symbol":return 1;case"boolean":return n?void 0:null!==i?!i.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e;default:return}})(e,t,i,n))return 1;if(!n&&null!==i)switch(i.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||t<1}}function i(e,t,i,n,o,r,s){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=o,this.mustUseProperty=i,this.propertyName=e,this.type=t,this.sanitizeURL=r,this.removeEmptyString=s}var s={},K=("children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){s[e]=new i(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];s[t]=new i(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){s[e]=new i(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){s[e]=new i(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){s[e]=new i(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){s[e]=new i(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){s[e]=new i(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){s[e]=new i(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){s[e]=new i(e,5,!1,e.toLowerCase(),null,!1,!1)}),/[\-:]([a-z])/g);function X(e){return e[1].toUpperCase()}function q(e,t,i,n){var o,r=s.hasOwnProperty(t)?s[t]:null;(null!==r?0!==r.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(Y(t,i,r,n)&&(i=null),n||null===r?(o=t,(j.call(z,o)||!j.call(W,o)&&(V.test(o)?z[o]=!0:void(W[o]=!0)))&&(null===i?e.removeAttribute(t):e.setAttribute(t,""+i))):r.mustUseProperty?e[r.propertyName]=null===i?3!==r.type&&"":i:(t=r.attributeName,n=r.attributeNamespace,null===i?e.removeAttribute(t):(i=3===(r=r.type)||4===r&&!0===i?"":""+i,n?e.setAttributeNS(n,t,i):e.setAttribute(t,i))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(K,X);s[t]=new i(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(K,X);s[t]=new i(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(K,X);s[t]=new i(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){s[e]=new i(e,1,!1,e.toLowerCase(),null,!1,!1)}),s.xlinkHref=new i("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){s[e]=new i(e,1,!1,e.toLowerCase(),null,!0,!0)});var J,Z=B.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Q=60103,ee=60106,te=60107,ie=60108,ne=60114,oe=60109,re=60110,se=60112,ae=60113,le=60120,ce=60115,ue=60116,de=60121,he=60128,pe=60129,ge=60130,fe=60131,me=("function"==typeof Symbol&&Symbol.for&&(Q=(n=Symbol.for)("react.element"),ee=n("react.portal"),te=n("react.fragment"),ie=n("react.strict_mode"),ne=n("react.profiler"),oe=n("react.provider"),re=n("react.context"),se=n("react.forward_ref"),ae=n("react.suspense"),le=n("react.suspense_list"),ce=n("react.memo"),ue=n("react.lazy"),de=n("react.block"),n("react.scope"),he=n("react.opaque.id"),pe=n("react.debug_trace_mode"),ge=n("react.offscreen"),fe=n("react.legacy_hidden")),"function"==typeof Symbol&&Symbol.iterator);function be(e){return null!==e&&"object"==typeof e&&"function"==typeof(e=me&&e[me]||e["@@iterator"])?e:null}function _e(e){if(void 0===J)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);J=t&&t[1]||""}return"\n"+J+e}var ye=!1;function ve(e,t){if(!e||ye)return"";ye=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var n=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){n=e}e.call(t.prototype)}else{try{throw Error()}catch(e){n=e}e()}}catch(e){if(e&&n&&"string"==typeof e.stack){for(var o=e.stack.split("\n"),r=n.stack.split("\n"),s=o.length-1,a=r.length-1;1<=s&&0<=a&&o[s]!==r[a];)a--;for(;1<=s&&0<=a;s--,a--)if(o[s]!==r[a]){if(1!==s||1!==a)do{if(s--,--a<0||o[s]!==r[a])return"\n"+o[s].replace(" at new "," at ")}while(1<=s&&0<=a);break}}}finally{ye=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?_e(e):""}function Te(e){if(null!=e){if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case te:return"Fragment";case ee:return"Portal";case ne:return"Profiler";case ie:return"StrictMode";case ae:return"Suspense";case le:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case re:return(e.displayName||"Context")+".Consumer";case oe:return(e._context.displayName||"Context")+".Provider";case se:var t=(t=e.render).displayName||t.name||"";return e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case ce:return Te(e.type);case de:return Te(e._render);case ue:t=e._payload,e=e._init;try{return Te(e(t))}catch(e){}}}return null}function Ee(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function ke(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function Ce(e){e._valueTracker||(e._valueTracker=(e=>{var t,i,n=ke(e)?"checked":"value",o=Object.getOwnPropertyDescriptor(e.constructor.prototype,n),r=""+e[n];if(!e.hasOwnProperty(n)&&void 0!==o&&"function"==typeof o.get&&"function"==typeof o.set)return t=o.get,i=o.set,Object.defineProperty(e,n,{configurable:!0,get:function(){return t.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,n,{enumerable:o.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[n]}}})(e))}function Ie(e){var t,i,n;if(e)return(t=e._valueTracker)?(i=t.getValue(),n="",(e=n=e?ke(e)?e.checked?"true":"false":e.value:n)!==i&&(t.setValue(e),1)):1}function we(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}function Se(e,t){var i=t.checked;return f({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=i?i:e._wrapperState.initialChecked})}function xe(e,t){var i=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked,i=Ee(null!=t.value?t.value:i);e._wrapperState={initialChecked:n,initialValue:i,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Re(e,t){null!=(t=t.checked)&&q(e,"checked",t,!1)}function Oe(e,t){Re(e,t);var i=Ee(t.value),n=t.type;if(null!=i)"number"===n?(0===i&&""===e.value||e.value!=i)&&(e.value=""+i):e.value!==""+i&&(e.value=""+i);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?Ne(e,t.type,i):t.hasOwnProperty("defaultValue")&&Ne(e,t.type,Ee(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Ae(e,t,i){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(("submit"===n||"reset"===n)&&null==t.value)return;t=""+e._wrapperState.initialValue,i||t===e.value||(e.value=t),e.defaultValue=t}""!==(i=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==i&&(e.name=i)}function Ne(e,t,i){"number"===t&&we(e.ownerDocument)===e||(null==i?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+i&&(e.defaultValue=""+i))}function Le(e,t){var i,n;return e=f({children:void 0},t),i=t.children,n="",B.Children.forEach(i,function(e){null!=e&&(n+=e)}),(t=n)&&(e.children=t),e}function De(e,t,i,n){if(e=e.options,t){t={};for(var o=0;o<i.length;o++)t["$"+i[o]]=!0;for(i=0;i<e.length;i++)o=t.hasOwnProperty("$"+e[i].value),e[i].selected!==o&&(e[i].selected=o),o&&n&&(e[i].defaultSelected=!0)}else{for(i=""+Ee(i),t=null,o=0;o<e.length;o++){if(e[o].value===i)return e[o].selected=!0,void(n&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function Me(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(P(91));return f({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function $e(e,t){var i=t.value;if(null==i){if(i=t.children,t=t.defaultValue,null!=i){if(null!=t)throw Error(P(92));if(Array.isArray(i)){if(!(i.length<=1))throw Error(P(93));i=i[0]}t=i}i=t=null==t?"":t}e._wrapperState={initialValue:Ee(i)}}function Pe(e,t){var i=Ee(t.value),n=Ee(t.defaultValue);null!=i&&((i=""+i)!==e.value&&(e.value=i),null==t.defaultValue)&&e.defaultValue!==i&&(e.defaultValue=i),null!=n&&(e.defaultValue=""+n)}function Be(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var Fe={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"};function Ue(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function He(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?Ue(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}Ve=function(e,t){if(e.namespaceURI!==Fe.svg||"innerHTML"in e)e.innerHTML=t;else{for((Ge=Ge||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ge.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}};var Ge,Ve,je="undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,i,n){MSApp.execUnsafeLocalFunction(function(){return Ve(e,t)})}:Ve;function We(e,t){if(t){var i=e.firstChild;if(i&&i===e.lastChild&&3===i.nodeType)return void(i.nodeValue=t)}e.textContent=t}var ze={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ye=["Webkit","ms","Moz","O"];function Ke(e,t,i){return null==t||"boolean"==typeof t||""===t?"":i||"number"!=typeof t||0===t||ze.hasOwnProperty(e)&&ze[e]?(""+t).trim():t+"px"}function Xe(e,t){for(var i in e=e.style,t){var n,o;t.hasOwnProperty(i)&&(n=0===i.indexOf("--"),o=Ke(i,t[i],n),"float"===i&&(i="cssFloat"),n?e.setProperty(i,o):e[i]=o)}}Object.keys(ze).forEach(function(t){Ye.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ze[e]=ze[t]})});var qe=f({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Je(e,t){if(t){if(qe[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(P(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(P(60));if(!("object"==typeof t.dangerouslySetInnerHTML&&"__html"in t.dangerouslySetInnerHTML))throw Error(P(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(P(62))}}function Ze(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Qe(e){return 3===(e=(e=e.target||e.srcElement||window).correspondingUseElement?e.correspondingUseElement:e).nodeType?e.parentNode:e}var et=null,tt=null,it=null;function nt(e){if(e=uo(e)){if("function"!=typeof et)throw Error(P(280));var t=e.stateNode;t&&(t=po(t),et(e.stateNode,e.type,t))}}function ot(e){tt?it?it.push(e):it=[e]:tt=e}function rt(){if(tt){var e=tt,t=it;if(it=tt=null,nt(e),t)for(e=0;e<t.length;e++)nt(t[e])}}function st(e,t){return e(t)}function at(e,t,i,n,o){return e(t,i,n,o)}function lt(){}var ct=st,ut=!1,dt=!1;function ht(){null===tt&&null===it||(lt(),rt())}function pt(e,t){var i=e.stateNode;if(null===i)return null;var n=po(i);if(null===n)return null;switch(i=n[t],t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":e=!(n=(n=!n.disabled)?n:!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e));break;default:e=!1}if(e)return null;if(i&&"function"!=typeof i)throw Error(P(231,t,typeof i));return i}var gt=!1;if(e)try{var t={};Object.defineProperty(t,"passive",{get:function(){gt=!0}}),window.addEventListener("test",t,t),window.removeEventListener("test",t,t)}catch(e){gt=!1}var ft=!1,mt=null,bt=!1,_t=null,yt={onError:function(e){ft=!0,mt=e}};function vt(e,t,i,n,o,r,s,a,l){ft=!1,mt=null,function(e,t,i,n,o,r,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(i,c)}catch(e){this.onError(e)}}.apply(yt,arguments)}function Tt(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else for(e=t;0!=(1026&(t=e).flags)&&(i=t.return),e=t.return;);return 3===t.tag?i:null}function Et(e){if(13===e.tag){var t=e.memoizedState;if(null!==(t=null===t&&null!==(e=e.alternate)?e.memoizedState:t))return t.dehydrated}return null}function kt(e){if(Tt(e)!==e)throw Error(P(188))}function Ct(e){if(e=(e=>{var t=e.alternate;if(!t){if(null===(t=Tt(e)))throw Error(P(188));return t!==e?null:e}for(var i=e,n=t;;){var o=i.return;if(null===o)break;var r=o.alternate;if(null===r){if(null===(n=o.return))break;i=n}else{if(o.child===r.child){for(r=o.child;r;){if(r===i)return kt(o),e;if(r===n)return kt(o),t;r=r.sibling}throw Error(P(188))}if(i.return!==n.return)i=o,n=r;else{for(var s=!1,a=o.child;a;){if(a===i){s=!0,i=o,n=r;break}if(a===n){s=!0,n=o,i=r;break}a=a.sibling}if(!s){for(a=r.child;a;){if(a===i){s=!0,i=r,n=o;break}if(a===n){s=!0,n=r,i=o;break}a=a.sibling}if(!s)throw Error(P(189))}}if(i.alternate!==n)throw Error(P(190))}}if(3!==i.tag)throw Error(P(188));return i.stateNode.current===i?e:t})(e))for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t=(t.child.return=t).child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function It(e,t){for(var i=e.alternate;null!==t;){if(t===e||t===i)return 1;t=t.return}}var wt,St,xt,Rt,Ot=!1,At=[],Nt=null,Lt=null,Dt=null,Mt=new Map,$t=new Map,Pt=[],Bt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ft(e,t,i,n,o){return{blockedOn:e,domEventName:t,eventSystemFlags:16|i,nativeEvent:o,targetContainers:[n]}}function Ut(e,t){switch(e){case"focusin":case"focusout":Nt=null;break;case"dragenter":case"dragleave":Lt=null;break;case"mouseover":case"mouseout":Dt=null;break;case"pointerover":case"pointerout":Mt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":$t.delete(t.pointerId)}}function Ht(e,t,i,n,o,r){return null===e||e.nativeEvent!==r?(e=Ft(t,i,n,o,r),null!==t&&null!==(t=uo(t))&&St(t)):(e.eventSystemFlags|=n,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o)),e}function Gt(e){if(null===e.blockedOn){for(var t=e.targetContainers;0<t.length;){var i=Ti(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==i)return null!==(t=uo(i))&&St(t),e.blockedOn=i,0;t.shift()}return 1}}function Vt(e,t,i){Gt(e)&&i.delete(t)}function jt(){for(Ot=!1;0<At.length;){var e=At[0];if(null!==e.blockedOn){null!==(e=uo(e.blockedOn))&&wt(e);break}for(var t=e.targetContainers;0<t.length;){var i=Ti(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==i){e.blockedOn=i;break}t.shift()}null===e.blockedOn&&At.shift()}null!==Nt&&Gt(Nt)&&(Nt=null),null!==Lt&&Gt(Lt)&&(Lt=null),null!==Dt&&Gt(Dt)&&(Dt=null),Mt.forEach(Vt),$t.forEach(Vt)}function Wt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ot||(Ot=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,jt)))}function zt(t){function e(e){return Wt(e,t)}if(0<At.length){Wt(At[0],t);for(var i=1;i<At.length;i++){var n=At[i];n.blockedOn===t&&(n.blockedOn=null)}}for(null!==Nt&&Wt(Nt,t),null!==Lt&&Wt(Lt,t),null!==Dt&&Wt(Dt,t),Mt.forEach(e),$t.forEach(e),i=0;i<Pt.length;i++)(n=Pt[i]).blockedOn===t&&(n.blockedOn=null);for(;0<Pt.length&&null===(i=Pt[0]).blockedOn;)(e=>{var t=co(e.target);if(null!==t){var i=Tt(t);if(null!==i)if(13===(t=i.tag)){if(null!==(t=Et(i)))return e.blockedOn=t,Rt(e.lanePriority,function(){o.unstable_runWithPriority(e.priority,function(){xt(i)})})}else if(3===t&&i.stateNode.hydrate)return e.blockedOn=3===i.tag?i.stateNode.containerInfo:null}e.blockedOn=null})(i),null===i.blockedOn&&Pt.shift()}function Yt(e,t){var i={};return i[e.toLowerCase()]=t.toLowerCase(),i["Webkit"+e]="webkit"+t,i["Moz"+e]="moz"+t,i}var Kt={animationend:Yt("Animation","AnimationEnd"),animationiteration:Yt("Animation","AnimationIteration"),animationstart:Yt("Animation","AnimationStart"),transitionend:Yt("Transition","TransitionEnd")},Xt={},qt={};function Jt(e){if(Xt[e])return Xt[e];if(Kt[e]){var t,i=Kt[e];for(t in i)if(i.hasOwnProperty(t)&&t in qt)return Xt[e]=i[t]}return e}e&&(qt=document.createElement("div").style,"AnimationEvent"in window||(delete Kt.animationend.animation,delete Kt.animationiteration.animation,delete Kt.animationstart.animation),"TransitionEvent"in window||delete Kt.transitionend.transition);var Zt=Jt("animationend"),Qt=Jt("animationiteration"),ei=Jt("animationstart"),ti=Jt("transitionend"),ii=new Map,ni=new Map,n=["abort","abort",Zt,"animationEnd",Qt,"animationIteration",ei,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",ti,"transitionEnd","waiting","waiting"];function oi(e,t){for(var i=0;i<e.length;i+=2){var n=e[i],o="on"+((o=e[i+1])[0].toUpperCase()+o.slice(1));ni.set(n,t),ii.set(n,o),H(o,[n])}}(0,o.unstable_now)();var d=8;function ri(e){var t;return 0!=(1&e)?(d=15,1):0!=(2&e)?(d=14,2):0!=(4&e)?(d=13,4):0!=(t=24&e)?(d=12,t):0!=(32&e)?(d=11,32):0!=(t=192&e)?(d=10,t):0!=(256&e)?(d=9,256):0!=(t=3584&e)?(d=8,t):0!=(4096&e)?(d=7,4096):0!=(t=4186112&e)?(d=6,t):0!=(t=62914560&e)?(d=5,t):67108864&e?(d=4,67108864):0!=(134217728&e)?(d=3,134217728):0!=(t=805306368&e)?(d=2,t):0!=(1073741824&e)?(d=1,1073741824):(d=8,e)}function si(e,t){var i=e.pendingLanes;if(0===i)return d=0;var n,o=0,r=0,s=e.expiredLanes,a=e.suspendedLanes,l=e.pingedLanes;if(0!==s?(o=s,r=d=15):0!=(s=134217727&i)?0!=(n=s&~a)?(o=ri(n),r=d):0!==(l&=s)&&(o=ri(l),r=d):0!=(s=i&~a)?(o=ri(s),r=d):0!==l&&(o=ri(l),r=d),0===o)return 0;if(o=i&(((o=31-hi(o))<0?0:1<<o)<<1)-1,0!==t&&t!==o&&0==(t&a)){if(ri(t),r<=d)return t;d=r}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=o;0<t;)o|=e[i=31-hi(t)],t&=~(r=1<<i);return o}function ai(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function li(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=ci(24&~t))?li(10,t):e;case 10:return 0===(e=ci(192&~t))?li(8,t):e;case 8:return e=0===(e=ci(3584&~t))&&0===(e=ci(4186112&~t))?512:e;case 2:return t=0===(t=ci(805306368&~t))?268435456:t}throw Error(P(358,e))}function ci(e){return e&-e}function ui(e){for(var t=[],i=0;i<31;i++)t.push(e);return t}function di(e,t,i){e.pendingLanes|=t;var n=t-1;e.suspendedLanes&=n,e.pingedLanes&=n,(e=e.eventTimes)[t=31-hi(t)]=i}var hi=Math.clz32||function(e){return 0===e?32:31-(pi(e)/gi|0)|0},pi=Math.log,gi=Math.LN2;var fi=o.unstable_UserBlockingPriority,mi=o.unstable_runWithPriority,bi=!0;function _i(e,t,i,n){ut||lt();var o=vi,r=ut;ut=!0;try{at(o,e,t,i,n)}finally{(ut=r)||ht()}}function yi(e,t,i,n){mi(fi,vi.bind(null,e,t,i,n))}function vi(e,t,i,n){var o;if(bi)if((o=0==(4&t))&&0<At.length&&-1<Bt.indexOf(e))e=Ft(null,e,t,i,n),At.push(e);else{var r=Ti(e,t,i,n);if(null===r)o&&Ut(e,n);else{if(o){if(-1<Bt.indexOf(e))return e=Ft(r,e,t,i,n),void At.push(e);if(((e,t,i,n,o)=>{switch(t){case"focusin":return Nt=Ht(Nt,e,t,i,n,o),1;case"dragenter":return Lt=Ht(Lt,e,t,i,n,o),1;case"mouseover":return Dt=Ht(Dt,e,t,i,n,o),1;case"pointerover":var r=o.pointerId;return Mt.set(r,Ht(Mt.get(r)||null,e,t,i,n,o)),1;case"gotpointercapture":return r=o.pointerId,$t.set(r,Ht($t.get(r)||null,e,t,i,n,o)),1}})(r,e,t,i,n))return;Ut(e,n)}Vn(e,t,n,null,i)}}}function Ti(e,t,i,n){var o=Qe(n);if(null!==(o=co(o))){var r=Tt(o);if(null===r)o=null;else{var s=r.tag;if(13===s){if(null!==(o=Et(r)))return o;o=null}else if(3===s){if(r.stateNode.hydrate)return 3===r.tag?r.stateNode.containerInfo:null;o=null}else r!==o&&(o=null)}}return Vn(e,t,n,o,i),null}var Ei=null,ki=null,Ci=null;function Ii(){if(Ci)return Ci;for(var e=ki,t=e.length,i=("value"in Ei?Ei.value:Ei.textContent),n=i.length,o=0;o<t&&e[o]===i[o];o++);for(var r=t-o,s=1;s<=r&&e[t-s]===i[n-s];s++);return Ci=i.slice(o,1<s?1-s:void 0)}function wi(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,32<=(e=10===e?13:e)||13===e?e:0}function Si(){return!0}function xi(){return!1}function r(s){function e(e,t,i,n,o){for(var r in this._reactName=e,this._targetInst=i,this.type=t,this.nativeEvent=n,this.target=o,this.currentTarget=null,s)s.hasOwnProperty(r)&&(e=s[r],this[r]=e?e(n):n[r]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?Si:xi,this.isPropagationStopped=xi,this}return f(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Si)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Si)},persist:function(){},isPersistent:Si}),e}var Ri,Oi,Ai,t={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ni=r(t),a=f({},t,{view:0,detail:0}),Li=r(a),l=f({},a,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ji,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Ai&&(Oi=Ai&&"mousemove"===e.type?(Ri=e.screenX-Ai.screenX,e.screenY-Ai.screenY):Ri=0,Ai=e),Ri)},movementY:function(e){return"movementY"in e?e.movementY:Oi}}),Di=r(l),Mi=r(f({},l,{dataTransfer:0})),$i=r(f({},a,{relatedTarget:0})),Pi=r(f({},t,{animationName:0,elapsedTime:0,pseudoElement:0})),Bi=r(f({},t,{clipboardData:function(e){return("clipboardData"in e?e:window).clipboardData}})),Fi=r(f({},t,{data:0})),Ui={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Hi={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vi(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Gi[e])&&!!t[e]}function ji(){return Vi}var Wi=r(f({},a,{key:function(e){if(e.key){var t=Ui[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=wi(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Hi[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ji,charCode:function(e){return"keypress"===e.type?wi(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?wi(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),zi=r(f({},l,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Yi=r(f({},a,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ji})),Ki=r(f({},t,{propertyName:0,elapsedTime:0,pseudoElement:0})),Xi=r(f({},l,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),qi=[9,13,27,32],Ji=e&&"CompositionEvent"in window,a=null,Zi=(e&&"documentMode"in document&&(a=document.documentMode),e&&"TextEvent"in window&&!a),Qi=e&&(!Ji||a&&8<a&&a<=11),en=String.fromCharCode(32),tn=!1;function nn(e,t){switch(e){case"keyup":return-1!==qi.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return 1;default:return}}function on(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var rn=!1;var sn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function an(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?sn[e.type]:"textarea"===t}function ln(e,t,i,n){ot(n),0<(t=Wn(t,"onChange")).length&&(i=new Ni("onChange","change",null,i,n),e.push({event:i,listeners:t}))}var cn=null,un=null;function dn(e){Bn(e,0)}function hn(e){if(Ie(ho(e)))return e}function pn(e,t){if("change"===e)return t}var gn=!1;function fn(){cn&&(cn.detachEvent("onpropertychange",mn),un=cn=null)}function mn(e){if("value"===e.propertyName&&hn(un)){var t=[];if(ln(t,un,e,Qe(e)),e=dn,ut)e(t);else{ut=!0;try{st(e,t)}finally{ut=!1,ht()}}}}function bn(e,t,i){"focusin"===e?(fn(),un=i,(cn=t).attachEvent("onpropertychange",mn)):"focusout"===e&&fn()}function _n(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return hn(un)}function yn(e,t){if("click"===e)return hn(t)}function vn(e,t){if("input"===e||"change"===e)return hn(t)}e&&(a=e&&((t="oninput"in document)||((l=document.createElement("div")).setAttribute("oninput","return;"),t="function"==typeof l.oninput),t),gn=a&&(!document.documentMode||9<document.documentMode));var m="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},Tn=Object.prototype.hasOwnProperty;function En(e,t){if(!m(e,t)){if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(n=0;n<i.length;n++)if(!Tn.call(t,i[n])||!m(e[i[n]],t[i[n]]))return!1}return!0}function kn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Cn(e,t){var i,n=kn(e);for(e=0;n;){if(3===n.nodeType){if(i=e+n.textContent.length,e<=t&&t<=i)return{node:n,offset:t-e};e=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=kn(n)}}function In(){for(var e=window,t=we();t instanceof e.HTMLIFrameElement;){try{var i="string"==typeof t.contentWindow.location.href}catch(e){i=!1}if(!i)break;t=we((e=t.contentWindow).document)}return t}function wn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var Sn=e&&"documentMode"in document&&document.documentMode<=11,xn=null,Rn=null,On=null,An=!1;function Nn(e,t,i){var n=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;An||null==xn||xn!==we(n)||(n="selectionStart"in(n=xn)&&wn(n)?{start:n.selectionStart,end:n.selectionEnd}:{anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},On&&En(On,n))||(On=n,0<(n=Wn(Rn,"onSelect")).length&&(t=new Ni("onSelect","select",null,t,i),e.push({event:t,listeners:n}),t.target=xn))}oi("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),oi("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),oi(n,2);for(var Ln="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Dn=0;Dn<Ln.length;Dn++)ni.set(Ln[Dn],0);G("onMouseEnter",["mouseout","mouseover"]),G("onMouseLeave",["mouseout","mouseover"]),G("onPointerEnter",["pointerout","pointerover"]),G("onPointerLeave",["pointerout","pointerover"]),H("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),H("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),H("onBeforeInput",["compositionend","keypress","textInput","paste"]),H("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),H("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),H("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Mn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$n=new Set("cancel close invalid load scroll toggle".split(" ").concat(Mn));function Pn(e,t,i){var n=e.type||"unknown-event";e.currentTarget=i,function(){var e;vt.apply(this,arguments),ft&&(e=mt,ft=!1,mt=null,bt||(bt=!0,_t=e))}(n,t,void 0,e),e.currentTarget=null}function Bn(e,t){t=0!=(4&t);for(var i=0;i<e.length;i++){var n=(o=e[i]).event,o=o.listeners;e:{var r=void 0;if(t)for(var s=o.length-1;0<=s;s--){var a=(c=o[s]).instance,l=c.currentTarget,c=c.listener;if(a!==r&&n.isPropagationStopped())break e;Pn(n,c,l),r=a}else for(s=0;s<o.length;s++){if(a=(c=o[s]).instance,l=c.currentTarget,c=c.listener,a!==r&&n.isPropagationStopped())break e;Pn(n,c,l),r=a}}}if(bt)throw e=_t,bt=!1,_t=null,e}function u(e,t){var i=go(t),n=e+"__bubble";i.has(n)||(Gn(t,e,2,!1),i.add(n))}var Fn="_reactListening"+Math.random().toString(36).slice(2);function Un(t){t[Fn]||(t[Fn]=!0,F.forEach(function(e){$n.has(e)||Hn(e,!1,t,null),Hn(e,!0,t,null)}))}function Hn(e,t,i,n,o){var o=4<arguments.length&&void 0!==o?o:0,r=i;if("selectionchange"===e&&9!==i.nodeType&&(r=i.ownerDocument),null!==n&&!t&&$n.has(e)){if("scroll"!==e)return;o|=2,r=n}i=go(r),n=e+"__"+(t?"capture":"bubble");i.has(n)||(t&&(o|=4),Gn(r,e,o,t),i.add(n))}function Gn(e,t,i,n){var o=ni.get(t);switch(void 0===o?2:o){case 0:o=_i;break;case 1:o=yi;break;default:o=vi}i=o.bind(null,t,i,e),o=!gt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t?void 0:!0,n?void 0!==o?e.addEventListener(t,i,{capture:!0,passive:o}):e.addEventListener(t,i,!0):void 0!==o?e.addEventListener(t,i,{passive:o}):e.addEventListener(t,i,!1)}function Vn(m,b,_,e,t){var y=e;if(0==(1&b)&&0==(2&b)&&null!==e)e:for(;;){if(null===e)return;var i=e.tag;if(3===i||4===i){var n=e.stateNode.containerInfo;if(n===t||8===n.nodeType&&n.parentNode===t)break;if(4===i)for(i=e.return;null!==i;){var o=i.tag;if((3===o||4===o)&&((o=i.stateNode.containerInfo)===t||8===o.nodeType&&o.parentNode===t))return;i=i.return}for(;null!==n;){if(null===(i=co(n)))return;if(5===(o=i.tag)||6===o){e=y=i;continue e}n=n.parentNode}}e=e.return}var r=function(){var e,t,i,n=y,o=Qe(_),r=[];e:{var s=ii.get(m);if(void 0!==s){var a=Ni,l=m;switch(m){case"keypress":if(0===wi(_))break e;case"keydown":case"keyup":a=Wi;break;case"focusin":l="focus",a=$i;break;case"focusout":l="blur",a=$i;break;case"beforeblur":case"afterblur":a=$i;break;case"click":if(2===_.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":a=Di;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":a=Mi;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":a=Yi;break;case Zt:case Qt:case ei:a=Pi;break;case ti:a=Ki;break;case"scroll":a=Li;break;case"wheel":a=Xi;break;case"copy":case"cut":case"paste":a=Bi;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":a=zi}for(var c=!(d=0!=(4&b))&&"scroll"===m,u=d?null!==s?s+"Capture":null:s,d=[],h=n;null!==h;){var p,g=(p=h).stateNode;if(5===p.tag&&null!==g&&(p=g,null!==u)&&null!=(g=pt(h,u))&&d.push(jn(h,g,p)),c)break;h=h.return}0<d.length&&(s=new a(s,l,null,_,o),r.push({event:s,listeners:d}))}}if(0==(7&b)){if(a="mouseout"===m||"pointerout"===m,(!(s="mouseover"===m||"pointerover"===m)||0!=(16&b)||!(l=_.relatedTarget||_.fromElement)||!co(l)&&!l[ao])&&(a||s)&&(s=o.window===o?o:(s=o.ownerDocument)?s.defaultView||s.parentWindow:window,a?(a=n,null!==(l=(l=_.relatedTarget||_.toElement)?co(l):null)&&(l!==(c=Tt(l))||5!==l.tag&&6!==l.tag)&&(l=null)):(a=null,l=n),a!==l)){if(d=Di,g="onMouseLeave",u="onMouseEnter",h="mouse","pointerout"!==m&&"pointerover"!==m||(d=zi,g="onPointerLeave",u="onPointerEnter",h="pointer"),c=null==a?s:ho(a),p=null==l?s:ho(l),(s=new d(g,h+"leave",a,_,o)).target=c,s.relatedTarget=p,g=null,co(o)===n&&((d=new d(u,h+"enter",l,_,o)).target=p,d.relatedTarget=c,g=d),c=g,a&&l)e:{for(u=l,h=0,p=d=a;p;p=zn(p))h++;for(p=0,g=u;g;g=zn(g))p++;for(;0<h-p;)d=zn(d),h--;for(;0<p-h;)u=zn(u),p--;for(;h--;){if(d===u||null!==u&&d===u.alternate)break e;d=zn(d),u=zn(u)}d=null}else d=null;null!==a&&Yn(r,s,a,d,!1),null!==l&&null!==c&&Yn(r,c,l,d,!0)}switch("select"===(a=(s=n?ho(n):window).nodeName&&s.nodeName.toLowerCase())||"input"===a&&"file"===s.type?e=pn:an(s)?gn?e=vn:(e=_n,t=bn):!(a=s.nodeName)||"input"!==a.toLowerCase()||"checkbox"!==s.type&&"radio"!==s.type||(e=yn),(e=e&&e(m,n))?ln(r,e,_,o):(t&&t(m,s,n),"focusout"===m&&(t=s._wrapperState)&&t.controlled&&"number"===s.type&&Ne(s,"number",s.value)),t=n?ho(n):window,m){case"focusin":!an(t)&&"true"!==t.contentEditable||(xn=t,Rn=n,On=null);break;case"focusout":On=Rn=xn=null;break;case"mousedown":An=!0;break;case"contextmenu":case"mouseup":case"dragend":An=!1,Nn(r,_,o);break;case"selectionchange":if(Sn)break;case"keydown":case"keyup":Nn(r,_,o)}if(Ji)e:{switch(m){case"compositionstart":var f="onCompositionStart";break e;case"compositionend":f="onCompositionEnd";break e;case"compositionupdate":f="onCompositionUpdate";break e}f=void 0}else rn?nn(m,_)&&(f="onCompositionEnd"):"keydown"===m&&229===_.keyCode&&(f="onCompositionStart");f&&(Qi&&"ko"!==_.locale&&(rn||"onCompositionStart"!==f?"onCompositionEnd"===f&&rn&&(i=Ii()):(ki="value"in(Ei=o)?Ei.value:Ei.textContent,rn=!0)),0<(t=Wn(n,f)).length)&&(f=new Fi(f,m,null,_,o),r.push({event:f,listeners:t}),i||null!==(i=on(_)))&&(f.data=i),(i=(Zi?(e,t)=>{switch(e){case"compositionend":return on(t);case"keypress":return 32!==t.which?null:(tn=!0,en);case"textInput":return(e=t.data)===en&&tn?null:e;default:return null}}:(e,t)=>{if(rn)return"compositionend"===e||!Ji&&nn(e,t)?(e=Ii(),Ci=ki=Ei=null,rn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Qi&&"ko"!==t.locale?null:t.data;default:return null}})(m,_))&&0<(n=Wn(n,"onBeforeInput")).length&&(o=new Fi("onBeforeInput","beforeinput",null,_,o),r.push({event:o,listeners:n}),o.data=i)}Bn(r,b)},s=void 0,a=void 0;if(dt)r(s,a);else{dt=!0;try{ct(r,s,a)}finally{dt=!1,ht()}}}function jn(e,t,i){return{instance:e,listener:t,currentTarget:i}}function Wn(e,t){for(var i=t+"Capture",n=[];null!==e;){var o=e,r=o.stateNode;5===o.tag&&null!==r&&(o=r,null!=(r=pt(e,i))&&n.unshift(jn(e,r,o)),null!=(r=pt(e,t)))&&n.push(jn(e,r,o)),e=e.return}return n}function zn(e){if(null===e)return null;for(;(e=e.return)&&5!==e.tag;);return e||null}function Yn(e,t,i,n,o){for(var r=t._reactName,s=[];null!==i&&i!==n;){var a=i,l=a.alternate,c=a.stateNode;if(null!==l&&l===n)break;5===a.tag&&null!==c&&(a=c,o?null!=(l=pt(i,r))&&s.unshift(jn(i,l,a)):null!=(l=pt(i,r))&&s.push(jn(i,l,a))),i=i.return}0!==s.length&&e.push({event:t,listeners:s})}function Kn(){}var Xn=null,qn=null;function Jn(e,t){switch(e){case"button":case"input":case"select":case"textarea":return t.autoFocus}}function Zn(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Qn="function"==typeof setTimeout?setTimeout:void 0,eo="function"==typeof clearTimeout?clearTimeout:void 0;function to(e){(1===e.nodeType||9===e.nodeType&&null!=(e=e.body))&&(e.textContent="")}function io(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function no(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var i=e.data;if("$"===i||"$!"===i||"$?"===i){if(0===t)return e;t--}else"/$"===i&&t++}e=e.previousSibling}return null}var oo=0;var l=Math.random().toString(36).slice(2),ro="__reactFiber$"+l,so="__reactProps$"+l,ao="__reactContainer$"+l,lo="__reactEvents$"+l;function co(e){var t=e[ro];if(t)return t;for(var i=e.parentNode;i;){if(t=i[ao]||i[ro]){if(i=t.alternate,null!==t.child||null!==i&&null!==i.child)for(e=no(e);null!==e;){if(i=e[ro])return i;e=no(e)}return t}i=(e=i).parentNode}return null}function uo(e){return!(e=e[ro]||e[ao])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ho(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(P(33))}function po(e){return e[so]||null}function go(e){var t=e[lo];return t=void 0===t?e[lo]=new Set:t}var fo=[],mo=-1;function bo(e){return{current:e}}function c(e){mo<0||(e.current=fo[mo],fo[mo]=null,mo--)}function h(e,t){fo[++mo]=e.current,e.current=t}var _o={},b=bo(_o),_=bo(!1),yo=_o;function vo(e,t){var i=e.type.contextTypes;if(!i)return _o;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var o,r={};for(o in i)r[o]=t[o];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function y(e){return null!=(e=e.childContextTypes)}function To(){c(_),c(b)}function Eo(e,t,i){if(b.current!==_o)throw Error(P(168));h(b,t),h(_,i)}function ko(e,t,i){var n,o=e.stateNode;if(e=t.childContextTypes,"function"!=typeof o.getChildContext)return i;for(n in o=o.getChildContext())if(!(n in e))throw Error(P(108,Te(t)||"Unknown",n));return f({},i,o)}function Co(e){e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_o,yo=b.current,h(b,e),h(_,_.current)}function Io(e,t,i){var n=e.stateNode;if(!n)throw Error(P(169));i?(e=ko(e,t,yo),n.__reactInternalMemoizedMergedChildContext=e,c(_),c(b),h(b,e)):c(_),h(_,i)}var wo=null,So=null,xo=o.unstable_runWithPriority,Ro=o.unstable_scheduleCallback,Oo=o.unstable_cancelCallback,Ao=o.unstable_shouldYield,t=o.unstable_requestPaint,No=o.unstable_now,Lo=o.unstable_getCurrentPriorityLevel,Do=o.unstable_ImmediatePriority,Mo=o.unstable_UserBlockingPriority,$o=o.unstable_NormalPriority,Po=o.unstable_LowPriority,Bo=o.unstable_IdlePriority,Fo={},Uo=void 0!==t?t:function(){},Ho=null,Go=null,Vo=!1,jo=No(),I=jo<1e4?No:function(){return No()-jo};function Wo(){switch(Lo()){case Do:return 99;case Mo:return 98;case $o:return 97;case Po:return 96;case Bo:return 95;default:throw Error(P(332))}}function zo(e){switch(e){case 99:return Do;case 98:return Mo;case 97:return $o;case 96:return Po;case 95:return Bo;default:throw Error(P(332))}}function Yo(e,t){return e=zo(e),xo(e,t)}function Ko(e,t,i){return e=zo(e),Ro(e,t,i)}function Xo(){var e;null!==Go&&(e=Go,Go=null,Oo(e)),qo()}function qo(){if(!Vo&&null!==Ho){Vo=!0;var t=0;try{var i=Ho;Yo(99,function(){for(;t<i.length;t++)for(var e=i[t];null!==(e=e(!0)););}),Ho=null}catch(e){throw null!==Ho&&(Ho=Ho.slice(t+1)),Ro(Do,Xo),e}finally{Vo=!1}}}var Jo=Z.ReactCurrentBatchConfig;function Zo(e,t){if(e&&e.defaultProps)for(var i in t=f({},t),e=e.defaultProps)void 0===t[i]&&(t[i]=e[i]);return t}var Qo=bo(null),er=null,tr=null,ir=null;function nr(){ir=tr=er=null}function or(e){var t=Qo.current;c(Qo),e.type._context._currentValue=t}function rr(e,t){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)===t){if(null===i||(i.childLanes&t)===t)break;i.childLanes|=t}else e.childLanes|=t,null!==i&&(i.childLanes|=t);e=e.return}}function sr(e,t){(ir=tr=null)!==(e=(er=e).dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(Rs=!0),e.firstContext=null)}function v(e,t){if(ir!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(ir=e,t=1073741823),t={context:e,observedBits:t,next:null},null===tr){if(null===er)throw Error(P(308));tr=t,er.dependencies={lanes:0,firstContext:t,responders:null}}else tr=tr.next=t;return e._currentValue}var ar=!1;function lr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function cr(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ur(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function dr(e,t){var i;null!==(e=e.updateQueue)&&(null===(i=(e=e.shared).pending)?t.next=t:(t.next=i.next,i.next=t),e.pending=t)}function hr(e,t){var i=e.updateQueue,n=e.alternate;if(null!==n&&i===(n=n.updateQueue)){var o=null,r=null;if(null!==(i=i.firstBaseUpdate)){do{var s={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null}}while(null===r?o=r=s:r=r.next=s,null!==(i=i.next));null===r?o=r=t:r=r.next=t}else o=r=t;i={baseState:n.baseState,firstBaseUpdate:o,lastBaseUpdate:r,shared:n.shared,effects:n.effects},e.updateQueue=i}else null===(e=i.lastBaseUpdate)?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function pr(e,t,i,n){var o,r,s,a,l=e.updateQueue,c=(ar=!1,l.firstBaseUpdate),u=l.lastBaseUpdate;if(null!==(g=l.shared.pending)&&(l.shared.pending=null,r=(o=g).next,(o.next=null)===u?c=r:u.next=r,u=o,null!==(s=e.alternate))&&(a=(s=s.updateQueue).lastBaseUpdate)!==u&&(null===a?s.firstBaseUpdate=r:a.next=r,s.lastBaseUpdate=o),null!==c){for(a=l.baseState,u=0,s=r=o=null;;){g=c.lane;var d=c.eventTime;if((n&g)===g){null!==s&&(s=s.next={eventTime:d,lane:0,tag:c.tag,payload:c.payload,callback:c.callback,next:null});e:{var h=e,p=c,g=t,d=i;switch(p.tag){case 1:if("function"==typeof(h=p.payload)){a=h.call(d,a,g);break e}a=h;break e;case 3:h.flags=-4097&h.flags|64;case 0:if(null==(g="function"==typeof(h=p.payload)?h.call(d,a,g):h))break e;a=f({},a,g);break e;case 2:ar=!0}}null!==c.callback&&(e.flags|=32,null===(g=l.effects)?l.effects=[c]:g.push(c))}else d={eventTime:d,lane:g,tag:c.tag,payload:c.payload,callback:c.callback,next:null},null===s?(r=s=d,o=a):s=s.next=d,u|=g;if(null===(c=c.next)){if(null===(g=l.shared.pending))break;c=g.next,g.next=null,l.lastBaseUpdate=g,l.shared.pending=null}}null===s&&(o=a),l.baseState=o,l.firstBaseUpdate=r,l.lastBaseUpdate=s,Ea|=u,e.lanes=u,e.memoizedState=a}}function gr(e,t,i){if(e=t.effects,(t.effects=null)!==e)for(t=0;t<e.length;t++){var n=e[t],o=n.callback;if(null!==o){if(n.callback=null,n=i,"function"!=typeof o)throw Error(P(191,o));o.call(n)}}}var fr=(new B.Component).refs;function mr(e,t,i,n){i=null==(i=i(n,t=e.memoizedState))?t:f({},t,i),e.memoizedState=i,0===e.lanes&&(e.updateQueue.baseState=i)}var br={isMounted:function(e){return!!(e=e._reactInternals)&&Tt(e)===e},enqueueSetState:function(e,t,i){e=e._reactInternals;var n=E(),o=za(e),r=ur(n,o);r.payload=t,null!=i&&(r.callback=i),dr(e,r),Ya(e,o,n)},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var n=E(),o=za(e),r=ur(n,o);r.tag=1,r.payload=t,null!=i&&(r.callback=i),dr(e,r),Ya(e,o,n)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=E(),n=za(e),o=ur(i,n);o.tag=2,null!=t&&(o.callback=t),dr(e,o),Ya(e,n,i)}};function _r(e,t,i,n,o,r,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,r,s):!(t.prototype&&t.prototype.isPureReactComponent&&En(i,n)&&En(o,r))}function yr(e,t,i){var n=!1,o=_o,r=t.contextType;t=new t(i,r="object"==typeof r&&null!==r?v(r):(o=y(t)?yo:b.current,(n=null!=(n=t.contextTypes))?vo(e,o):_o)),e.memoizedState=null!=t.state?t.state:null,t.updater=br,(e.stateNode=t)._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=r)}function vr(e,t,i,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,n),t.state!==e&&br.enqueueReplaceState(t,t.state,null)}function Tr(e,t,i,n){var o=e.stateNode,r=(o.props=i,o.state=e.memoizedState,o.refs=fr,lr(e),t.contextType);"object"==typeof r&&null!==r?o.context=v(r):(r=y(t)?yo:b.current,o.context=vo(e,r)),pr(e,i,o,n),o.state=e.memoizedState,"function"==typeof(r=t.getDerivedStateFromProps)&&(mr(e,0,r,i),o.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(t=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&br.enqueueReplaceState(o,o.state,null),pr(e,i,o,n),o.state=e.memoizedState),"function"==typeof o.componentDidMount&&(e.flags|=4)}var Er=Array.isArray;function kr(e,t,i){if(null!==(e=i.ref)&&"function"!=typeof e&&"object"!=typeof e){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(P(309));var n=i.stateNode}var o;if(n)return o=""+e,null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===o?t.ref:((t=function(e){var t=n.refs;t===fr&&(t=n.refs={}),null===e?delete t[o]:t[o]=e})._stringRef=o,t);throw Error(P(147,e))}if("string"!=typeof e)throw Error(P(284));if(!i._owner)throw Error(P(290,e))}return e}function Cr(e,t){if("textarea"!==e.type)throw Error(P(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function Ir(S){function x(e,t){var i;S&&(null!==(i=e.lastEffect)?(i.nextEffect=t,e.lastEffect=t):e.firstEffect=e.lastEffect=t,t.nextEffect=null,t.flags=8)}function R(e,t){if(S)for(;null!==t;)x(e,t),t=t.sibling;return null}function O(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function A(e,t){return(e=_l(e,t)).index=0,e.sibling=null,e}function N(e,t,i){if(e.index=i,S){if(null!==(i=e.alternate))return(i=i.index)<t?(e.flags=2,t):i;e.flags=2}return t}function L(e){return S&&null===e.alternate&&(e.flags=2),e}function r(e,t,i,n){return null===t||6!==t.tag?(t=El(i,e.mode,n)).return=e:(t=A(t,i)).return=e,t}function s(e,t,i,n){return null!==t&&t.elementType===i.type?((n=A(t,i.props)).ref=kr(0,t,i),n.return=e):((n=yl(i.type,i.key,i.props,null,e.mode,n)).ref=kr(0,t,i),n.return=e),n}function a(e,t,i,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?(t=kl(i,e.mode,n)).return=e:(t=A(t,i.children||[])).return=e,t}function l(e,t,i,n,o){return null===t||7!==t.tag?(t=vl(i,e.mode,n,o)).return=e:(t=A(t,i)).return=e,t}function D(e,t,i){if("string"==typeof t||"number"==typeof t)return(t=El(""+t,e.mode,i)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case Q:return(i=yl(t.type,t.key,t.props,null,e.mode,i)).ref=kr(0,null,t),i.return=e,i;case ee:return(t=kl(t,e.mode,i)).return=e,t}if(Er(t)||be(t))return(t=vl(t,e.mode,i,null)).return=e,t;Cr(e,t)}return null}function M(e,t,i,n){var o=null!==t?t.key:null;if("string"==typeof i||"number"==typeof i)return null!==o?null:r(e,t,""+i,n);if("object"==typeof i&&null!==i){switch(i.$$typeof){case Q:return i.key===o?i.type===te?l(e,t,i.props.children,n,o):s(e,t,i,n):null;case ee:return i.key===o?a(e,t,i,n):null}if(Er(i)||be(i))return null!==o?null:l(e,t,i,n,null);Cr(e,i)}return null}function $(e,t,i,n,o){if("string"==typeof n||"number"==typeof n)return r(t,e=e.get(i)||null,""+n,o);if("object"==typeof n&&null!==n){switch(n.$$typeof){case Q:return e=e.get(null===n.key?i:n.key)||null,n.type===te?l(t,e,n.props.children,o,n.key):s(t,e,n,o);case ee:return a(t,e=e.get(null===n.key?i:n.key)||null,n,o)}if(Er(n)||be(n))return l(t,e=e.get(i)||null,n,o,null);Cr(t,n)}return null}return function(e,t,i,n){var o="object"==typeof i&&null!==i&&i.type===te&&null===i.key,r="object"==typeof(i=o?i.props.children:i)&&null!==i;if(r)switch(i.$$typeof){case Q:e:{for(r=i.key,o=t;null!==o;){if(o.key===r){switch(o.tag){case 7:if(i.type!==te)break;R(e,o.sibling),(t=A(o,i.props.children)).return=e,e=t;break e;default:if(o.elementType===i.type){R(e,o.sibling),(t=A(o,i.props)).ref=kr(0,o,i),t.return=e,e=t;break e}}R(e,o);break}x(e,o),o=o.sibling}e=i.type===te?((t=vl(i.props.children,e.mode,n,i.key)).return=e,t):((n=yl(i.type,i.key,i.props,null,e.mode,n)).ref=kr(0,t,i),n.return=e,n)}return L(e);case ee:e:{for(o=i.key;null!==t;){if(t.key===o){if(4===t.tag&&t.stateNode.containerInfo===i.containerInfo&&t.stateNode.implementation===i.implementation){R(e,t.sibling),(t=A(t,i.children||[])).return=e,e=t;break e}R(e,t);break}x(e,t),t=t.sibling}(t=kl(i,e.mode,n)).return=e,e=t}return L(e)}if("string"==typeof i||"number"==typeof i)return i=""+i,(t=null!==t&&6===t.tag?(R(e,t.sibling),A(t,i)):(R(e,t),El(i,e.mode,n))).return=e,L(e=t);if(Er(i)){for(var s=e,a=t,l=i,c=n,u=null,d=null,h=a,p=a=0,g=null;null!==h&&p<l.length;p++){h.index>p?(g=h,h=null):g=h.sibling;var f=M(s,h,l[p],c);if(null===f){null===h&&(h=g);break}S&&h&&null===f.alternate&&x(s,h),a=N(f,a,p),null===d?u=f:d.sibling=f,d=f,h=g}if(p===l.length)R(s,h);else if(null===h)for(;p<l.length;p++)null!==(h=D(s,l[p],c))&&(a=N(h,a,p),null===d?u=h:d.sibling=h,d=h);else{for(h=O(s,h);p<l.length;p++)null!==(g=$(h,s,p,l[p],c))&&(S&&null!==g.alternate&&h.delete(null===g.key?p:g.key),a=N(g,a,p),null===d?u=g:d.sibling=g,d=g);S&&h.forEach(function(e){return x(s,e)})}return u}if(be(i)){var m=e,b=t,_=i,y=n,v=be(_);if("function"!=typeof v)throw Error(P(150));if(null==(_=v.call(_)))throw Error(P(151));for(var T=v=null,E=b,k=b=0,C=null,I=_.next();null!==E&&!I.done;k++,I=_.next()){E.index>k?(C=E,E=null):C=E.sibling;var w=M(m,E,I.value,y);if(null===w){null===E&&(E=C);break}S&&E&&null===w.alternate&&x(m,E),b=N(w,b,k),null===T?v=w:T.sibling=w,T=w,E=C}if(I.done)R(m,E);else if(null===E)for(;!I.done;k++,I=_.next())null!==(I=D(m,I.value,y))&&(b=N(I,b,k),null===T?v=I:T.sibling=I,T=I);else{for(E=O(m,E);!I.done;k++,I=_.next())null!==(I=$(E,m,k,I.value,y))&&(S&&null!==I.alternate&&E.delete(null===I.key?k:I.key),b=N(I,b,k),null===T?v=I:T.sibling=I,T=I);S&&E.forEach(function(e){return x(m,e)})}return v}if(r&&Cr(e,i),void 0===i&&!o)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(P(152,Te(e.type)||"Component"))}return R(e,t)}}var wr=Ir(!0),Sr=Ir(!1),xr={},Rr=bo(xr),Or=bo(xr),Ar=bo(xr);function Nr(e){if(e===xr)throw Error(P(174));return e}function Lr(e,t){switch(h(Ar,t),h(Or,e),h(Rr,xr),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:He(null,"");break;default:t=He(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}c(Rr),h(Rr,t)}function Dr(){c(Rr),c(Or),c(Ar)}function Mr(e){Nr(Ar.current);var t=Nr(Rr.current),i=He(t,e.type);t!==i&&(h(Or,e),h(Rr,i))}function $r(e){Or.current===e&&(c(Rr),c(Or))}var k=bo(0);function Pr(e){for(var t=e;null!==t;){if(13===t.tag){var i=t.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||"$?"===i.data||"$!"===i.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(64&t.flags))return t}else if(null!==t.child){t=(t.child.return=t).child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Br=null,Fr=null,Ur=!1;function Hr(e,t){var i=ml(5,null,null,0);i.elementType="DELETED",i.type="DELETED",i.stateNode=t,i.return=e,i.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=i,e.lastEffect=i):e.firstEffect=e.lastEffect=i}function Gr(e,t){switch(e.tag){case 5:var i=e.type;return null!==(t=1!==t.nodeType||i.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,1);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,1);default:return}}function Vr(e){if(Ur){var t=Fr;if(t){var i=t;if(!Gr(e,t)){if(!(t=io(i.nextSibling))||!Gr(e,t))return e.flags=-1025&e.flags|2,Ur=!1,void(Br=e);Hr(Br,i)}Br=e,Fr=io(t.firstChild)}else e.flags=-1025&e.flags|2,Ur=!1,Br=e}}function jr(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Br=e}function Wr(e){if(e===Br){if(!Ur)return jr(e),Ur=!0,0;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Zn(t,e.memoizedProps))for(t=Fr;t;)Hr(e,t),t=io(t.nextSibling);if(jr(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(P(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var i=e.data;if("/$"===i){if(0===t){Fr=io(e.nextSibling);break e}t--}else"$"!==i&&"$!"!==i&&"$?"!==i||t++}e=e.nextSibling}Fr=null}}else Fr=Br?io(e.stateNode.nextSibling):null;return 1}}function zr(){Fr=Br=null,Ur=!1}var Yr=[];function Kr(){for(var e=0;e<Yr.length;e++)Yr[e]._workInProgressVersionPrimary=null;Yr.length=0}var Xr=Z.ReactCurrentDispatcher,p=Z.ReactCurrentBatchConfig,qr=0,C=null,w=null,S=null,Jr=!1,Zr=!1;function g(){throw Error(P(321))}function Qr(e,t){if(null!==t){for(var i=0;i<t.length&&i<e.length;i++)if(!m(e[i],t[i]))return;return 1}}function es(e,t,i,n,o,r){if(qr=r,(C=t).memoizedState=null,t.updateQueue=null,t.lanes=0,Xr.current=null===e||null===e.memoizedState?Is:ws,e=i(n,o),Zr){r=0;do{if(Zr=!1,!(r<25))throw Error(P(301))}while(r+=1,S=w=null,t.updateQueue=null,Xr.current=Ss,e=i(n,o),Zr)}if(Xr.current=Cs,t=null!==w&&null!==w.next,qr=0,S=w=C=null,Jr=!1,t)throw Error(P(300));return e}function ts(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===S?C.memoizedState=S=e:S=S.next=e,S}function is(){e=null===w?null!==(e=C.alternate)?e.memoizedState:null:w.next;var e,t=null===S?C.memoizedState:S.next;if(null!==t)S=t,w=e;else{if(null===e)throw Error(P(310));e={memoizedState:(w=e).memoizedState,baseState:w.baseState,baseQueue:w.baseQueue,queue:w.queue,next:null},null===S?C.memoizedState=S=e:S=S.next=e}return S}function ns(e,t){return"function"==typeof t?t(e):t}function os(e){var t=is(),i=t.queue;if(null===i)throw Error(P(311));i.lastRenderedReducer=e;var n,o=(s=w).baseQueue,r=i.pending;if(null!==r&&(null!==o&&(n=o.next,o.next=r.next,r.next=n),s.baseQueue=o=r,i.pending=null),null!==o){var o=o.next,s=s.baseState,a=n=r=null,l=o;do{var c,u=l.lane}while((qr&u)===u?(null!==a&&(a=a.next={lane:0,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null}),s=l.eagerReducer===e?l.eagerState:e(s,l.action)):(c={lane:u,action:l.action,eagerReducer:l.eagerReducer,eagerState:l.eagerState,next:null},null===a?(n=a=c,r=s):a=a.next=c,C.lanes|=u,Ea|=u),null!==(l=l.next)&&l!==o);null===a?r=s:a.next=n,m(s,t.memoizedState)||(Rs=!0),t.memoizedState=s,t.baseState=r,t.baseQueue=a,i.lastRenderedState=s}return[t.memoizedState,i.dispatch]}function rs(e){var t=is(),i=t.queue;if(null===i)throw Error(P(311));i.lastRenderedReducer=e;var n=i.dispatch,o=i.pending,r=t.memoizedState;if(null!==o){i.pending=null;for(var s=o=o.next;r=e(r,s.action),(s=s.next)!==o;);m(r,t.memoizedState)||(Rs=!0),t.memoizedState=r,null===t.baseQueue&&(t.baseState=r),i.lastRenderedState=r}return[r,n]}function ss(e,t,i){var n=(n=t._getVersion)(t._source),o=t._workInProgressVersionPrimary;if(null!==o?e=o===n:(e=e.mutableReadLanes,(e=(qr&e)===e)&&(t._workInProgressVersionPrimary=n,Yr.push(t))),e)return i(t._source);throw Yr.push(t),Error(P(350))}function as(e,r,s,t){var a=R;if(null===a)throw Error(P(349));var l=r._getVersion,c=l(r._source),i=Xr.current,u=(n=i.useState(function(){return ss(a,r,s)}))[1],d=n[0],n=S,h=(g=e.memoizedState).refs,o=h.getSnapshot,p=g.source,g=g.subscribe,f=C;return e.memoizedState={refs:h,source:r,subscribe:t},i.useEffect(function(){h.getSnapshot=s,h.setSnapshot=u;var e=l(r._source);if(!m(c,e)){e=s(r._source),m(d,e)||(u(e),e=za(f),a.mutableReadLanes|=e&a.pendingLanes),e=a.mutableReadLanes,a.entangledLanes|=e;for(var t=a.entanglements,i=e;0<i;){var n=31-hi(i),o=1<<n;t[n]|=e,i&=~o}}},[s,r,t]),i.useEffect(function(){return t(r._source,function(){var e=h.getSnapshot,t=h.setSnapshot;try{t(e(r._source));var i=za(f);a.mutableReadLanes|=i&a.pendingLanes}catch(e){t(function(){throw e})}})},[r,t]),m(o,s)&&m(p,r)&&m(g,t)||((e={pending:null,dispatch:null,lastRenderedReducer:ns,lastRenderedState:d}).dispatch=u=ks.bind(null,C,e),n.queue=e,n.baseQueue=null,d=ss(a,r,s),n.memoizedState=n.baseState=d),d}function ls(e,t,i){return as(is(),e,t,i)}function cs(e){var t=ts();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:ns,lastRenderedState:e}).dispatch=ks.bind(null,C,e),[t.memoizedState,e]}function us(e,t,i,n){return e={tag:e,create:t,destroy:i,deps:n,next:null},null===(t=C.updateQueue)?(C.updateQueue=t={lastEffect:null}).lastEffect=e.next=e:null===(i=t.lastEffect)?t.lastEffect=e.next=e:(n=i.next,(i.next=e).next=n,t.lastEffect=e),e}function ds(e){return ts().memoizedState=e={current:e}}function hs(){return is().memoizedState}function ps(e,t,i,n){var o=ts();C.flags|=e,o.memoizedState=us(1|t,i,void 0,void 0===n?null:n)}function gs(e,t,i,n){var o=is(),r=(n=void 0===n?null:n,void 0);if(null!==w){var s=w.memoizedState,r=s.destroy;if(null!==n&&Qr(n,s.deps))return void us(t,i,r,n)}C.flags|=e,o.memoizedState=us(1|t,i,r,n)}function fs(e,t){return ps(516,4,e,t)}function ms(e,t){return gs(516,4,e,t)}function bs(e,t){return gs(4,2,e,t)}function _s(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function ys(e,t,i){return i=null!=i?i.concat([e]):null,gs(4,2,_s.bind(null,t,e),i)}function vs(){}function Ts(e,t){var i=is(),n=(t=void 0===t?null:t,i.memoizedState);return null!==n&&null!==t&&Qr(t,n[1])?n[0]:(i.memoizedState=[e,t],e)}function Es(e,t){var i=is(),n=(t=void 0===t?null:t,i.memoizedState);return null!==n&&null!==t&&Qr(t,n[1])?n[0]:(e=e(),i.memoizedState=[e,t],e)}function ks(e,t,i){var n=E(),o=za(e),r={lane:o,action:i,eagerReducer:null,eagerState:null,next:null},s=t.pending;if(null===s?r.next=r:(r.next=s.next,s.next=r),t.pending=r,s=e.alternate,e===C||null!==s&&s===C)Zr=Jr=!0;else{if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,l=s(a,i);if(r.eagerReducer=s,m(r.eagerState=l,a))return}catch(e){}Ya(e,o,n)}}var Cs={readContext:v,useCallback:g,useContext:g,useEffect:g,useImperativeHandle:g,useLayoutEffect:g,useMemo:g,useReducer:g,useRef:g,useState:g,useDebugValue:g,useDeferredValue:g,useTransition:g,useMutableSource:g,useOpaqueIdentifier:g,unstable_isNewReconciler:!1},Is={readContext:v,useCallback:function(e,t){return ts().memoizedState=[e,void 0===t?null:t],e},useContext:v,useEffect:fs,useImperativeHandle:function(e,t,i){return i=null!=i?i.concat([e]):null,ps(4,2,_s.bind(null,t,e),i)},useLayoutEffect:function(e,t){return ps(4,2,e,t)},useMemo:function(e,t){var i=ts();return t=void 0===t?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var n=ts();return t=void 0!==i?i(t):t,n.memoizedState=n.baseState=t,e=(e=n.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=ks.bind(null,C,e),[n.memoizedState,e]},useRef:ds,useState:cs,useDebugValue:vs,useDeferredValue:function(t){var e=cs(t),i=e[0],n=e[1];return fs(function(){var e=p.transition;p.transition=1;try{n(t)}finally{p.transition=e}},[t]),i},useTransition:function(){var e=cs(!1),t=e[0];return ds(e=function(t,i){var e=Wo();Yo(e<98?98:e,function(){t(!0)}),Yo(97<e?97:e,function(){var e=p.transition;p.transition=1;try{t(!1),i()}finally{p.transition=e}})}.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,i){var n=ts();return n.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:i},as(n,e,t,i)},useOpaqueIdentifier:function(){var e,t,i;return Ur?(e=!1,i={$$typeof:he,toString:i=function(){throw e||(e=!0,t("r:"+(oo++).toString(36))),Error(P(355))},valueOf:i},t=cs(i)[1],0==(2&C.mode)&&(C.flags|=516,us(5,function(){t("r:"+(oo++).toString(36))},void 0,null))):cs(i="r:"+(oo++).toString(36)),i},unstable_isNewReconciler:!1},ws={readContext:v,useCallback:Ts,useContext:v,useEffect:ms,useImperativeHandle:ys,useLayoutEffect:bs,useMemo:Es,useReducer:os,useRef:hs,useState:function(){return os(ns)},useDebugValue:vs,useDeferredValue:function(t){var e=os(ns),i=e[0],n=e[1];return ms(function(){var e=p.transition;p.transition=1;try{n(t)}finally{p.transition=e}},[t]),i},useTransition:function(){var e=os(ns)[0];return[hs().current,e]},useMutableSource:ls,useOpaqueIdentifier:function(){return os(ns)[0]},unstable_isNewReconciler:!1},Ss={readContext:v,useCallback:Ts,useContext:v,useEffect:ms,useImperativeHandle:ys,useLayoutEffect:bs,useMemo:Es,useReducer:rs,useRef:hs,useState:function(){return rs(ns)},useDebugValue:vs,useDeferredValue:function(t){var e=rs(ns),i=e[0],n=e[1];return ms(function(){var e=p.transition;p.transition=1;try{n(t)}finally{p.transition=e}},[t]),i},useTransition:function(){var e=rs(ns)[0];return[hs().current,e]},useMutableSource:ls,useOpaqueIdentifier:function(){return rs(ns)[0]},unstable_isNewReconciler:!1},xs=Z.ReactCurrentOwner,Rs=!1;function T(e,t,i,n){t.child=null===e?Sr(t,null,i,n):wr(t,e.child,i,n)}function Os(e,t,i,n,o){i=i.render;var r=t.ref;return sr(t,o),n=es(e,t,i,n,r,o),null===e||Rs?(t.flags|=1,T(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~o,Ys(e,t,o))}function As(e,t,i,n,o,r){var s;return null===e?"function"!=typeof(s=i.type)||bl(s)||void 0!==s.defaultProps||null!==i.compare||void 0!==i.defaultProps?((e=yl(i.type,null,n,t,t.mode,r)).ref=t.ref,(e.return=t).child=e):(t.tag=15,t.type=s,Ns(e,t,s,n,o,r)):(s=e.child,0==(o&r)&&(o=s.memoizedProps,(i=null!==(i=i.compare)?i:En)(o,n))&&e.ref===t.ref?Ys(e,t,r):(t.flags|=1,(e=_l(s,n)).ref=t.ref,(e.return=t).child=e))}function Ns(e,t,i,n,o,r){if(null!==e&&En(e.memoizedProps,n)&&e.ref===t.ref){if(Rs=!1,0==(r&o))return t.lanes=e.lanes,Ys(e,t,r);0!=(16384&e.flags)&&(Rs=!0)}return Ms(e,t,i,n,r)}function Ls(e,t,i){var n=t.pendingProps,o=n.children,r=null!==e?e.memoizedState:null;if("hidden"===n.mode||"unstable-defer-without-hiding"===n.mode)if(0==(4&t.mode))t.memoizedState={baseLanes:0},el(0,i);else{if(0==(1073741824&i))return e=null!==r?r.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},el(0,e),null;t.memoizedState={baseLanes:0},el(0,null!==r?r.baseLanes:i)}else null!==r?(n=r.baseLanes|i,t.memoizedState=null):n=i,el(0,n);return T(e,t,o,i),t.child}function Ds(e,t){var i=t.ref;(null===e&&null!==i||null!==e&&e.ref!==i)&&(t.flags|=128)}function Ms(e,t,i,n,o){var r=vo(t,y(i)?yo:b.current);return sr(t,o),i=es(e,t,i,n,r,o),null===e||Rs?(t.flags|=1,T(e,t,i,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~o,Ys(e,t,o))}function $s(e,t,i,n,o){var r,s,a,l,c,u,d,h,p,g;return y(i)?(r=!0,Co(t)):r=!1,sr(t,o),n=null===t.stateNode?(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),yr(t,i,n),Tr(t,i,n,o),!0):null===e?((s=t.stateNode).props=a=t.memoizedProps,h=s.context,l="object"==typeof(l=i.contextType)&&null!==l?v(l):vo(t,l=y(i)?yo:b.current),(u="function"==typeof(c=i.getDerivedStateFromProps)||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||a===n&&h===l||vr(0,s,n,l),ar=!1,s.state=d=t.memoizedState,pr(t,n,s,o),h=t.memoizedState,a!==n||d!==h||_.current||ar?("function"==typeof c&&(mr(t,0,c,n),h=t.memoizedState),(a=ar||_r(t,i,a,n,d,h,l))?(u||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4)):("function"==typeof s.componentDidMount&&(t.flags|=4),t.memoizedProps=n,t.memoizedState=h),s.props=n,s.state=h,s.context=l,a):("function"==typeof s.componentDidMount&&(t.flags|=4),!1)):(s=t.stateNode,cr(e,t),a=t.memoizedProps,l=t.type===t.elementType?a:Zo(t.type,a),s.props=l,u=t.pendingProps,d=s.context,h="object"==typeof(h=i.contextType)&&null!==h?v(h):vo(t,h=y(i)?yo:b.current),(c="function"==typeof(p=i.getDerivedStateFromProps)||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||a===u&&d===h||vr(0,s,n,h),ar=!1,s.state=d=t.memoizedState,pr(t,n,s,o),g=t.memoizedState,a!==u||d!==g||_.current||ar?("function"==typeof p&&(mr(t,0,p,n),g=t.memoizedState),(l=ar||_r(t,i,l,n,d,g,h))?(c||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(n,g,h),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(n,g,h)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),t.memoizedProps=n,t.memoizedState=g),s.props=n,s.state=g,s.context=h,l):("function"!=typeof s.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=256),!1)),Ps(e,t,i,n,r,o)}function Ps(e,t,i,n,o,r){Ds(e,t);var s=0!=(64&t.flags);if(!n&&!s)return o&&Io(t,i,!1),Ys(e,t,r);n=t.stateNode,xs.current=t;var a=s&&"function"!=typeof i.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&s?(t.child=wr(t,e.child,null,r),t.child=wr(t,null,a,r)):T(e,t,a,r),t.memoizedState=n.state,o&&Io(t,i,!0),t.child}function Bs(e){var t=e.stateNode;t.pendingContext?Eo(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Eo(0,t.context,!1),Lr(e,t.containerInfo)}var Fs={dehydrated:null,retryLane:0};function Us(e,t,i){var n=t.pendingProps,o=k.current,r=!1;return 0!=(64&t.flags)||(null===e||null!==e.memoizedState)&&0!=(2&o)?(r=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===n.fallback||!0===n.unstable_avoidThisFallback||(o|=1),h(k,1&o),null===e?(void 0!==n.fallback&&Vr(t),e=n.children,o=n.fallback,r?(e=Hs(t,e,o,i),t.child.memoizedState={baseLanes:i},t.memoizedState=Fs,e):"number"==typeof n.unstable_expectedLoadTime?(e=Hs(t,e,o,i),t.child.memoizedState={baseLanes:i},t.memoizedState=Fs,t.lanes=33554432,e):((i=Tl({mode:"visible",children:e},t.mode,i,null)).return=t).child=i):(e.memoizedState,r?(n=Vs(e,t,n.children,n.fallback,i),r=t.child,o=e.child.memoizedState,r.memoizedState=null===o?{baseLanes:i}:{baseLanes:o.baseLanes|i},r.childLanes=e.childLanes&~i,t.memoizedState=Fs,n):(i=Gs(e,t,n.children,i),t.memoizedState=null,i))}function Hs(e,t,i,n){var o=e.mode,r=e.child;return t={mode:"hidden",children:t},0==(2&o)&&null!==r?(r.childLanes=0,r.pendingProps=t):r=Tl(t,o,0,null),i=vl(i,o,n,null),r.return=e,i.return=e,r.sibling=i,e.child=r,i}function Gs(e,t,i,n){var o=e.child;return e=o.sibling,i=_l(o,{mode:"visible",children:i}),0==(2&t.mode)&&(i.lanes=n),i.return=t,(i.sibling=null)!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=i}function Vs(e,t,i,n,o){var r=t.mode,s=e.child,a=(e=s.sibling,{mode:"hidden",children:i});return 0==(2&r)&&t.child!==s?((i=t.child).childLanes=0,i.pendingProps=a,null!==(s=i.lastEffect)?(t.firstEffect=i.firstEffect,(t.lastEffect=s).nextEffect=null):t.firstEffect=t.lastEffect=null):i=_l(s,a),null!==e?n=_l(e,n):(n=vl(n,r,o,null)).flags|=2,n.return=t,i.return=t,i.sibling=n,t.child=i,n}function js(e,t){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),rr(e.return,t)}function Ws(e,t,i,n,o,r){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:i,tailMode:o,lastEffect:r}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=i,s.tailMode=o,s.lastEffect=r)}function zs(e,t,i){var n=t.pendingProps,o=n.revealOrder,r=n.tail;if(T(e,t,n.children,i),0!=(2&(n=k.current)))n=1&n|2,t.flags|=64;else{if(null!==e&&0!=(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&js(e,i);else if(19===e.tag)js(e,i);else if(null!==e.child){e=(e.child.return=e).child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(h(k,n),0==(2&t.mode))t.memoizedState=null;else switch(o){case"forwards":for(i=t.child,o=null;null!==i;)null!==(e=i.alternate)&&null===Pr(e)&&(o=i),i=i.sibling;null===(i=o)?(o=t.child,t.child=null):(o=i.sibling,i.sibling=null),Ws(t,!1,o,i,r,t.lastEffect);break;case"backwards":for(o=t.child,t.child=i=null;null!==o;){if(null!==(e=o.alternate)&&null===Pr(e)){t.child=o;break}e=o.sibling,o.sibling=i,i=o,o=e}Ws(t,!0,i,null,r,t.lastEffect);break;case"together":Ws(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function Ys(e,t,i){if(null!==e&&(t.dependencies=e.dependencies),Ea|=t.lanes,0==(i&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(P(153));if(null!==t.child){for(i=_l(e=t.child,e.pendingProps),(t.child=i).return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=_l(e,e.pendingProps)).return=t;i.sibling=null}return t.child}function Ks(e,t){if(!Ur)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;null!==t;)null!==t.alternate&&(i=t),t=t.sibling;null===i?e.tail=null:i.sibling=null;break;case"collapsed":for(var i=e.tail,n=null;null!==i;)null!==i.alternate&&(n=i),i=i.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Xs(e,t){try{for(var i="",n=t;i+=(e=>{switch(e.tag){case 5:return _e(e.type);case 16:return _e("Lazy");case 13:return _e("Suspense");case 19:return _e("SuspenseList");case 0:case 2:case 15:return e=ve(e.type,!1);case 11:return e=ve(e.type.render,!1);case 22:return e=ve(e.type._render,!1);case 1:return e=ve(e.type,!0);default:return""}})(n),n=n.return;);var o=i}catch(e){o="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:o}}function qs(e,t){try{console.error(t.value)}catch(e){setTimeout(function(){throw e})}}var Js=function(e,t){for(var i=t.child;null!==i;){if(5===i.tag||6===i.tag)e.appendChild(i.stateNode);else if(4!==i.tag&&null!==i.child){i=(i.child.return=i).child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},Zs=function(){},Qs=function(e,t,i,n){var o=e.memoizedProps;if(o!==n){e=t.stateNode,Nr(Rr.current);var r,s=null;switch(i){case"input":o=Se(e,o),n=Se(e,n),s=[];break;case"option":o=Le(e,o),n=Le(e,n),s=[];break;case"select":o=f({},o,{value:void 0}),n=f({},n,{value:void 0}),s=[];break;case"textarea":o=Me(e,o),n=Me(e,n),s=[];break;default:"function"!=typeof o.onClick&&"function"==typeof n.onClick&&(e.onclick=Kn)}for(c in Je(i,n),i=null,o)if(!n.hasOwnProperty(c)&&o.hasOwnProperty(c)&&null!=o[c])if("style"===c){var a=o[c];for(r in a)a.hasOwnProperty(r)&&(i=i||{},i[r]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(U.hasOwnProperty(c)?s=s||[]:(s=s||[]).push(c,null));for(c in n){var l=n[c],a=null!=o?o[c]:void 0;if(n.hasOwnProperty(c)&&l!==a&&(null!=l||null!=a))if("style"===c)if(a){for(r in a)!a.hasOwnProperty(r)||l&&l.hasOwnProperty(r)||(i=i||{},i[r]="");for(r in l)l.hasOwnProperty(r)&&a[r]!==l[r]&&(i=i||{},i[r]=l[r])}else i||(s=s||[]).push(c,i),i=l;else"dangerouslySetInnerHTML"===c?(l=l?l.__html:void 0,a=a?a.__html:void 0,null!=l&&a!==l&&(s=s||[]).push(c,l)):"children"===c?"string"!=typeof l&&"number"!=typeof l||(s=s||[]).push(c,""+l):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(U.hasOwnProperty(c)?(null!=l&&"onScroll"===c&&u("scroll",e),s||a===l||(s=[])):"object"==typeof l&&null!==l&&l.$$typeof===he?l.toString():(s=s||[]).push(c,l))}i&&(s=s||[]).push("style",i);var c=s;(t.updateQueue=c)&&(t.flags|=4)}},ea=function(e,t,i,n){i!==n&&(t.flags|=4)},ta="function"==typeof WeakMap?WeakMap:Map;function ia(e,t,i){(i=ur(-1,i)).tag=3,i.payload={element:null};var n=t.value;return i.callback=function(){Oa||(Oa=!0,Aa=n),qs(0,t)},i}function na(e,t,i){(i=ur(-1,i)).tag=3;var n,o=e.type.getDerivedStateFromError,e=("function"==typeof o&&(n=t.value,i.payload=function(){return qs(0,t),o(n)}),e.stateNode);return null!==e&&"function"==typeof e.componentDidCatch&&(i.callback=function(){"function"!=typeof o&&(null===Na?Na=new Set([this]):Na.add(this),qs(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),i}var oa="function"==typeof WeakSet?WeakSet:Set;function ra(t){var e=t.ref;if(null!==e)if("function"==typeof e)try{e(null)}catch(e){pl(t,e)}else e.current=null}function sa(e,t,i){switch(i.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=i.updateQueue)?t.lastEffect:null)){e=t=t.next;do{}while(3==(3&e.tag)&&(o=e.create,e.destroy=o()),(e=e.next)!==t)}if(null!==(t=null!==(t=i.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var n=e,o=n.next;0!=(4&(n=n.tag))&&0!=(1&n)&&(ul(i,e),n=i,r=e,$a.push(r,n),La||(La=!0,Ko(97,function(){return cl(),null}))),e=o}while(e!==t)}return;case 1:return e=i.stateNode,4&i.flags&&(null===t?e.componentDidMount():(o=i.elementType===i.type?t.memoizedProps:Zo(i.type,t.memoizedProps),e.componentDidUpdate(o,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=i.updateQueue)&&gr(0,t,e));case 3:if(null!==(t=i.updateQueue)){if((e=null)!==i.child)switch(i.child.tag){case 5:case 1:e=i.child.stateNode}gr(0,t,e)}return;case 5:return e=i.stateNode,void(null===t&&4&i.flags&&Jn(i.type,i.memoizedProps)&&e.focus());case 6:case 4:case 12:return;case 13:return void(null===i.memoizedState&&null!==(i=i.alternate)&&null!==(i=i.memoizedState)&&null!==(i=i.dehydrated)&&zt(i));case 19:case 17:case 20:case 21:case 23:case 24:return}var r;throw Error(P(163))}function aa(e,t){for(var i=e;;){if(5===i.tag){var n,o=i.stateNode;t?"function"==typeof(o=o.style).setProperty?o.setProperty("display","none","important"):o.display="none":(o=i.stateNode,n=null!=(n=i.memoizedProps.style)&&n.hasOwnProperty("display")?n.display:null,o.style.display=Ke("display",n))}else if(6===i.tag)i.stateNode.nodeValue=t?"":i.memoizedProps;else if((23!==i.tag&&24!==i.tag||null===i.memoizedState||i===e)&&null!==i.child){i=(i.child.return=i).child;continue}if(i===e)break;for(;null===i.sibling;){if(null===i.return||i.return===e)return;i=i.return}i.sibling.return=i.return,i=i.sibling}}function la(e,t){if(So&&"function"==typeof So.onCommitFiberUnmount)try{So.onCommitFiberUnmount(wo,t)}catch(e){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var i=e=e.next;do{var n=i.destroy,o=i.tag;if(void 0!==n)if(0!=(4&o))ul(t,i);else{o=t;try{n()}catch(e){pl(o,e)}}}while((i=i.next)!==e)}break;case 1:if(ra(t),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){pl(t,e)}break;case 5:ra(t);break;case 4:ha(e,t)}}function ca(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function ua(e){return 5===e.tag||3===e.tag||4===e.tag}function da(e){e:{for(var t=e.return;null!==t;){if(ua(t))break e;t=t.return}throw Error(P(160))}var i=t,t=i.stateNode;switch(i.tag){case 5:var n=!1;break;case 3:case 4:t=t.containerInfo,n=!0;break;default:throw Error(P(161))}16&i.flags&&(We(t,""),i.flags&=-17);e:t:for(i=e;;){for(;null===i.sibling;){if(null===i.return||ua(i.return)){i=null;break e}i=i.return}for(i.sibling.return=i.return,i=i.sibling;5!==i.tag&&6!==i.tag&&18!==i.tag;){if(2&i.flags)continue t;if(null===i.child||4===i.tag)continue t;i=(i.child.return=i).child}if(!(2&i.flags)){i=i.stateNode;break e}}(n?function e(t,i,n){var o=t.tag,r=5===o||6===o;if(r)t=r?t.stateNode:t.stateNode.instance,i?(8===n.nodeType?n.parentNode:n).insertBefore(t,i):(8===n.nodeType?(i=n.parentNode,i.insertBefore(t,n)):(i=n,i.appendChild(t)),n=n._reactRootContainer,null==n&&null===i.onclick&&(i.onclick=Kn));else if(4!==o&&(t=t.child,null!==t))for(e(t,i,n),t=t.sibling;null!==t;)e(t,i,n),t=t.sibling}:function e(t,i,n){var o=t.tag,r=5===o||6===o;if(r)t=r?t.stateNode:t.stateNode.instance,i?n.insertBefore(t,i):n.appendChild(t);else if(4!==o&&(t=t.child,null!==t))for(e(t,i,n),t=t.sibling;null!==t;)e(t,i,n),t=t.sibling})(e,i,t)}function ha(e,t){for(var i,n,o=t,r=!1;;){if(!r){r=o.return;e:for(;;){if(null===r)throw Error(P(160));switch(i=r.stateNode,r.tag){case 5:n=!1;break e;case 3:case 4:i=i.containerInfo,n=!0;break e}r=r.return}r=!0}if(5===o.tag||6===o.tag){e:for(var s=e,a=o,l=a;;)if(la(s,l),null!==l.child&&4!==l.tag)l.child.return=l,l=l.child;else{if(l===a)break;for(;null===l.sibling;){if(null===l.return||l.return===a)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}n?(s=i,a=o.stateNode,(8===s.nodeType?s.parentNode:s).removeChild(a)):i.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){i=o.stateNode.containerInfo,n=!0,o=(o.child.return=o).child;continue}}else if(la(e,o),null!==o.child){o=(o.child.return=o).child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;4===(o=o.return).tag&&(r=!1)}o.sibling.return=o.return,o=o.sibling}}function pa(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var i=t.updateQueue;if(null!==(i=null!==i?i.lastEffect:null))for(var n=i=i.next;3==(3&n.tag)&&(e=n.destroy,(n.destroy=void 0)!==e)&&e(),(n=n.next)!==i;);return;case 1:return;case 5:if(null!=(i=t.stateNode)){var n=t.memoizedProps,o=null!==e?e.memoizedProps:n,r=(e=t.type,t.updateQueue);if((t.updateQueue=null)!==r){for(i[so]=n,"input"===e&&"radio"===n.type&&null!=n.name&&Re(i,n),Ze(e,o),t=Ze(e,n),o=0;o<r.length;o+=2){var s=r[o],a=r[o+1];"style"===s?Xe(i,a):"dangerouslySetInnerHTML"===s?je(i,a):"children"===s?We(i,a):q(i,s,a,t)}switch(e){case"input":Oe(i,n);break;case"textarea":Pe(i,n);break;case"select":e=i._wrapperState.wasMultiple,i._wrapperState.wasMultiple=!!n.multiple,null!=(r=n.value)?De(i,!!n.multiple,r,!1):e!==!!n.multiple&&(null!=n.defaultValue?De(i,!!n.multiple,n.defaultValue,!0):De(i,!!n.multiple,n.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(P(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((i=t.stateNode).hydrate&&(i.hydrate=!1,zt(i.containerInfo)));case 12:return;case 13:return null!==t.memoizedState&&(wa=I(),aa(t.child,!0)),void ga(t);case 19:return void ga(t);case 17:return;case 23:case 24:return void aa(t,null!==t.memoizedState)}throw Error(P(163))}function ga(i){var n,e=i.updateQueue;null!==e&&((i.updateQueue=null)===(n=i.stateNode)&&(n=i.stateNode=new oa),e.forEach(function(e){var t=function(e,t){var i=e.stateNode;null!==i&&i.delete(t),(t=0)===t&&(0==(2&(t=e.mode))?t=1:0==(4&t)?t=99===Wo()?1:2:0===(t=ci(62914560&~(Ga=0===Ga?Ta:Ga)))&&(t=4194304)),i=E(),null!==(e=Ka(e,t))&&(di(e,t,i),D(e,i))}.bind(null,i,e);n.has(e)||(n.add(e),e.then(t,t))}))}var fa=Math.ceil,ma=Z.ReactCurrentDispatcher,ba=Z.ReactCurrentOwner,x=0,R=null,O=null,A=0,_a=0,ya=bo(0),N=0,va=null,Ta=0,Ea=0,ka=0,Ca=0,Ia=null,wa=0,Sa=1/0;function xa(){Sa=I()+500}var Ra,L=null,Oa=!1,Aa=null,Na=null,La=!1,Da=null,Ma=90,$a=[],Pa=[],Ba=null,Fa=0,Ua=null,Ha=-1,Ga=0,Va=0,ja=null,Wa=!1;function E(){return 0!=(48&x)?I():-1!==Ha?Ha:Ha=I()}function za(e){var t;return 0==(2&(e=e.mode))?1:0==(4&e)?99===Wo()?1:2:(0===Ga&&(Ga=Ta),0!==Jo.transition?(0!==Va&&(Va=null!==Ia?Ia.pendingLanes:0),e=Ga,t=4186112&~Va,0===(t&=-t)&&0===(t=(e=4186112&~e)&-e)?8192:t):(e=Wo(),0!=(4&x)&&98===e?li(12,Ga):li(e=(e=>{switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}})(e),Ga)))}function Ya(e,t,i){if(50<Fa)throw Fa=0,Ua=null,Error(P(185));var n;null!==(e=Ka(e,t))&&(di(e,t,i),e===R&&(ka|=t,4===N)&&qa(e,A),n=Wo(),1===t?0!=(8&x)&&0==(48&x)?Ja(e):(D(e,i),0===x&&(xa(),Xo())):(0==(4&x)||98!==n&&99!==n||(null===Ba?Ba=new Set([e]):Ba.add(e)),D(e,i)),Ia=e)}function Ka(e,t){e.lanes|=t;var i=e.alternate;for(null!==i&&(i.lanes|=t),e=(i=e).return;null!==e;)e.childLanes|=t,null!==(i=e.alternate)&&(i.childLanes|=t),e=(i=e).return;return 3===i.tag?i.stateNode:null}function D(e,t){for(var i=e.callbackNode,n=e.suspendedLanes,o=e.pingedLanes,r=e.expirationTimes,s=e.pendingLanes;0<s;){var a,l=31-hi(s),c=1<<l,u=r[l];-1===u?0!=(c&n)&&0==(c&o)||(u=t,ri(c),a=d,r[l]=10<=a?u+250:6<=a?u+5e3:-1):u<=t&&(e.expiredLanes|=c),s&=~c}if(n=si(e,e===R?A:0),t=d,0===n)null!==i&&(i!==Fo&&Oo(i),e.callbackNode=null,e.callbackPriority=0);else{if(null!==i){if(e.callbackPriority===t)return;i!==Fo&&Oo(i)}i=15===t?(i=Ja.bind(null,e),null===Ho?(Ho=[i],Go=Ro(Do,qo)):Ho.push(i),Fo):14===t?Ko(99,Ja.bind(null,e)):Ko(i=(e=>{switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(P(358,e))}})(t),Xa.bind(null,e)),e.callbackPriority=t,e.callbackNode=i}}function Xa(t){if(Ha=-1,(Va=Ga=0)!=(48&x))throw Error(P(327));var e=t.callbackNode;if(cl()&&t.callbackNode!==e)return null;var i=si(t,t===R?A:0);if(0===i)return null;var n=i,o=x,r=(x|=16,ol());for(R===t&&A===n||(xa(),il(t,n));;)try{for(;null!==O&&!Ao();)sl(O);break}catch(e){nl(t,e)}if(nr(),ma.current=r,x=o,n=null!==O?0:(R=null,A=0,N),0!=(Ta&ka))il(t,0);else if(0!==n){if(1===(n=2===n&&(x|=64,t.hydrate&&(t.hydrate=!1,to(t.containerInfo)),0!==(i=ai(t)))?rl(t,i):n))throw e=va,il(t,0),qa(t,i),D(t,I()),e;switch(t.finishedWork=t.current.alternate,t.finishedLanes=i,n){case 0:case 1:throw Error(P(345));case 2:ll(t);break;case 3:if(qa(t,i),(62914560&i)===i&&10<(n=wa+500-I())){if(0!==si(t,0))break;if(((o=t.suspendedLanes)&i)!==i){E(),t.pingedLanes|=t.suspendedLanes&o;break}t.timeoutHandle=Qn(ll.bind(null,t),n)}else ll(t);break;case 4:if(qa(t,i),(4186112&i)!==i){for(n=t.eventTimes,o=-1;0<i;){var s=31-hi(i),r=1<<s;o<(s=n[s])&&(o=s),i&=~r}i=o,10<(i=((i=I()-i)<120?120:i<480?480:i<1080?1080:i<1920?1920:i<3e3?3e3:i<4320?4320:1960*fa(i/1960))-i)?t.timeoutHandle=Qn(ll.bind(null,t),i):ll(t)}break;case 5:ll(t);break;default:throw Error(P(329))}}return D(t,I()),t.callbackNode===e?Xa.bind(null,t):null}function qa(e,t){for(t=t&~Ca&~ka,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-hi(t),n=1<<i;e[i]=-1,t&=~n}}function Ja(e){if(0!=(48&x))throw Error(P(327));var t,i;if(cl(),e===R&&0!=(e.expiredLanes&A)?(i=rl(e,t=A),0!=(Ta&ka)&&(i=rl(e,t=si(e,t)))):i=rl(e,t=si(e,0)),1===(i=0!==e.tag&&2===i&&(x|=64,e.hydrate&&(e.hydrate=!1,to(e.containerInfo)),0!==(t=ai(e)))?rl(e,t):i))throw i=va,il(e,0),qa(e,t),D(e,I()),i;return e.finishedWork=e.current.alternate,e.finishedLanes=t,ll(e),D(e,I()),null}function Za(e,t){var i=x;x|=1;try{return e(t)}finally{0===(x=i)&&(xa(),Xo())}}function Qa(e,t){var i=x;x=-2&x|8;try{e(t)}finally{0===(x=i)&&(xa(),Xo())}}function el(e,t){h(ya,_a),_a|=t,Ta|=t}function tl(){_a=ya.current,c(ya)}function il(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(-1!==i&&(e.timeoutHandle=-1,eo(i)),null!==O)for(i=O.return;null!==i;){var n=i;switch(n.tag){case 1:null!=(n=n.type.childContextTypes)&&To();break;case 3:Dr(),c(_),c(b),Kr();break;case 5:$r(n);break;case 4:Dr();break;case 13:case 19:c(k);break;case 10:or(n);break;case 23:case 24:tl()}i=i.return}O=_l((R=e).current,null),A=_a=Ta=t,va=null,Ca=ka=Ea=N=0}function nl(e,t){do{var i=O;try{if(nr(),Xr.current=Cs,Jr){for(var n=C.memoizedState;null!==n;){var o=n.queue;null!==o&&(o.pending=null),n=n.next}Jr=!1}if(qr=0,S=w=C=null,Zr=!1,(ba.current=null)===i||null===i.return){N=1,va=t,O=null;break}e:{var r=e,s=i.return,a=t;if(t=A,(y=i).flags|=2048,(y.firstEffect=y.lastEffect=null)!==a&&"object"==typeof a&&"function"==typeof a.then){var l,c,u,d,h=a,p=(0==(2&y.mode)&&((l=y.alternate)?(y.updateQueue=l.updateQueue,y.memoizedState=l.memoizedState,y.lanes=l.lanes):(y.updateQueue=null,y.memoizedState=null)),0!=(1&k.current)),g=s;do{if(d=(d=13===g.tag)?null!==(c=g.memoizedState)?null!==c.dehydrated:void 0!==(u=g.memoizedProps).fallback&&(!0!==u.unstable_avoidThisFallback||!p):d){var f,m,b=g.updateQueue;if(null===b?((f=new Set).add(h),g.updateQueue=f):b.add(h),0==(2&g.mode)){g.flags|=64,y.flags|=16384,y.flags&=-2981,1===y.tag&&(null===y.alternate?y.tag=17:((m=ur(-1,1)).tag=2,dr(y,m))),y.lanes|=1;break e}var _,a=void 0,y=t,v=r.pingCache;null===v?(v=r.pingCache=new ta,a=new Set,v.set(h,a)):void 0===(a=v.get(h))&&(a=new Set,v.set(h,a)),a.has(y)||(a.add(y),_=gl.bind(null,r,h,y),h.then(_,_)),g.flags|=4096,g.lanes=t;break e}}while(null!==(g=g.return));a=Error((Te(y.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==N&&(N=2),a=Xs(a,y),g=s;do{switch(g.tag){case 3:r=a;g.flags|=4096,t&=-t,g.lanes|=t,hr(g,ia(0,r,t));break e;case 1:r=a;var T=g.type,E=g.stateNode;if(0==(64&g.flags)&&("function"==typeof T.getDerivedStateFromError||null!==E&&"function"==typeof E.componentDidCatch&&(null===Na||!Na.has(E)))){g.flags|=4096,t&=-t,g.lanes|=t,hr(g,na(g,r,t));break e}}}while(null!==(g=g.return))}al(i)}catch(e){t=e,O===i&&null!==i&&(O=i.return);continue}break}while(1)}function ol(){var e=ma.current;return ma.current=Cs,null===e?Cs:e}function rl(t,e){var i=x,n=(x|=16,ol());for(R===t&&A===e||il(t,e);;)try{for(;null!==O;)sl(O);break}catch(e){nl(t,e)}if(nr(),x=i,ma.current=n,null!==O)throw Error(P(261));return R=null,A=0,N}function sl(e){var t=Ra(e.alternate,e,_a);e.memoizedProps=e.pendingProps,null===t?al(e):O=t,ba.current=null}function al(e){var t=e;do{var i=t.alternate;if(e=t.return,0==(2048&t.flags)){if(null!==(i=((e,t,i)=>{var n=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return y(t.type)&&To(),null;case 3:return Dr(),c(_),c(b),Kr(),(n=t.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(Wr(t)?t.flags|=4:n.hydrate||(t.flags|=256)),Zs(t),null;case 5:$r(t);var o=Nr(Ar.current);if(i=t.type,null!==e&&null!=t.stateNode)Qs(e,t,i,n,o),e.ref!==t.ref&&(t.flags|=128);else{if(!n){if(null===t.stateNode)throw Error(P(166));return null}if(e=Nr(Rr.current),Wr(t)){n=t.stateNode,i=t.type;var r,s=t.memoizedProps;switch(n[ro]=t,n[so]=s,i){case"dialog":u("cancel",n),u("close",n);break;case"iframe":case"object":case"embed":u("load",n);break;case"video":case"audio":for(e=0;e<Mn.length;e++)u(Mn[e],n);break;case"source":u("error",n);break;case"img":case"image":case"link":u("error",n),u("load",n);break;case"details":u("toggle",n);break;case"input":xe(n,s),u("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},u("invalid",n);break;case"textarea":$e(n,s),u("invalid",n)}for(r in Je(i,s),e=null,s)s.hasOwnProperty(r)&&(o=s[r],"children"===r?"string"==typeof o?n.textContent!==o&&(e=["children",o]):"number"==typeof o&&n.textContent!==""+o&&(e=["children",""+o]):U.hasOwnProperty(r)&&null!=o&&"onScroll"===r&&u("scroll",n));switch(i){case"input":Ce(n),Ae(n,s,!0);break;case"textarea":Ce(n),Be(n);break;case"select":case"option":break;default:"function"==typeof s.onClick&&(n.onclick=Kn)}n=e,null!==(t.updateQueue=n)&&(t.flags|=4)}else{switch(r=9===o.nodeType?o:o.ownerDocument,(e=e===Fe.html?Ue(i):e)===Fe.html?"script"===i?((e=r.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof n.is?e=r.createElement(i,{is:n.is}):(e=r.createElement(i),"select"===i&&(r=e,n.multiple?r.multiple=!0:n.size&&(r.size=n.size))):e=r.createElementNS(e,i),e[ro]=t,e[so]=n,Js(e,t,!1,!1),t.stateNode=e,r=Ze(i,n),i){case"dialog":u("cancel",e),u("close",e),o=n;break;case"iframe":case"object":case"embed":u("load",e),o=n;break;case"video":case"audio":for(o=0;o<Mn.length;o++)u(Mn[o],e);o=n;break;case"source":u("error",e),o=n;break;case"img":case"image":case"link":u("error",e),u("load",e),o=n;break;case"details":u("toggle",e),o=n;break;case"input":xe(e,n),o=Se(e,n),u("invalid",e);break;case"option":o=Le(e,n);break;case"select":e._wrapperState={wasMultiple:!!n.multiple},o=f({},n,{value:void 0}),u("invalid",e);break;case"textarea":$e(e,n),o=Me(e,n),u("invalid",e);break;default:o=n}Je(i,o);var a,l=o;for(s in l)l.hasOwnProperty(s)&&(a=l[s],"style"===s?Xe(e,a):"dangerouslySetInnerHTML"===s?null!=(a=a?a.__html:void 0)&&je(e,a):"children"===s?"string"==typeof a?"textarea"===i&&""===a||We(e,a):"number"==typeof a&&We(e,""+a):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(U.hasOwnProperty(s)?null!=a&&"onScroll"===s&&u("scroll",e):null!=a&&q(e,s,a,r)));switch(i){case"input":Ce(e),Ae(e,n,!1);break;case"textarea":Ce(e),Be(e);break;case"option":null!=n.value&&e.setAttribute("value",""+Ee(n.value));break;case"select":e.multiple=!!n.multiple,null!=(s=n.value)?De(e,!!n.multiple,s,!1):null!=n.defaultValue&&De(e,!!n.multiple,n.defaultValue,!0);break;default:"function"==typeof o.onClick&&(e.onclick=Kn)}Jn(i,n)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)ea(e,t,e.memoizedProps,n);else{if("string"!=typeof n&&null===t.stateNode)throw Error(P(166));i=Nr(Ar.current),Nr(Rr.current),Wr(t)?(n=t.stateNode,i=t.memoizedProps,n[ro]=t,n.nodeValue!==i&&(t.flags|=4)):((n=(9===i.nodeType?i:i.ownerDocument).createTextNode(n))[ro]=t).stateNode=n}return null;case 13:return(c(k),n=t.memoizedState,0!=(64&t.flags))?(t.lanes=i,t):(n=null!==n,i=!1,null===e?void 0!==t.memoizedProps.fallback&&Wr(t):i=null!==e.memoizedState,n&&!i&&0!=(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!=(1&k.current)?0===N&&(N=3):(0!==N&&3!==N||(N=4),null===R||0==(134217727&Ea)&&0==(134217727&ka)||qa(R,A))),(n||i)&&(t.flags|=4),null);case 4:return Dr(),Zs(t),null===e&&Un(t.stateNode.containerInfo),null;case 10:return or(t),null;case 17:return y(t.type)&&To(),null;case 19:if(c(k),null===(n=t.memoizedState))return null;if(s=0!=(64&t.flags),null===(r=n.rendering))if(s)Ks(n,!1);else{if(0!==N||null!==e&&0!=(64&e.flags))for(e=t.child;null!==e;){if(null!==(r=Pr(e))){for(t.flags|=64,Ks(n,!1),null!==(s=r.updateQueue)&&(t.updateQueue=s,t.flags|=4),null===n.lastEffect&&(t.firstEffect=null),t.lastEffect=n.lastEffect,n=i,i=t.child;null!==i;)e=n,(s=i).flags&=2,s.nextEffect=null,s.firstEffect=null,(s.lastEffect=null)===(r=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=r.childLanes,s.lanes=r.lanes,s.child=r.child,s.memoizedProps=r.memoizedProps,s.memoizedState=r.memoizedState,s.updateQueue=r.updateQueue,s.type=r.type,e=r.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),i=i.sibling;return h(k,1&k.current|2),t.child}e=e.sibling}null!==n.tail&&I()>Sa&&(t.flags|=64,Ks(n,!(s=!0)),t.lanes=33554432)}else{if(!s)if(null!==(e=Pr(r))){if(t.flags|=64,s=!0,null!==(i=e.updateQueue)&&(t.updateQueue=i,t.flags|=4),Ks(n,!0),null===n.tail&&"hidden"===n.tailMode&&!r.alternate&&!Ur)return null!==(t=t.lastEffect=n.lastEffect)&&(t.nextEffect=null),null}else 2*I()-n.renderingStartTime>Sa&&1073741824!==i&&(t.flags|=64,Ks(n,!(s=!0)),t.lanes=33554432);n.isBackwards?(r.sibling=t.child,t.child=r):(null!==(i=n.last)?i.sibling=r:t.child=r,n.last=r)}return null!==n.tail?(i=n.tail,n.rendering=i,n.tail=i.sibling,n.lastEffect=t.lastEffect,n.renderingStartTime=I(),i.sibling=null,t=k.current,h(k,s?1&t|2:1&t),i):null;case 23:case 24:return tl(),null!==e&&null!==e.memoizedState!=(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==n.mode&&(t.flags|=4),null}throw Error(P(156,t.tag))})(i,t,_a)))return void(O=i);if(24!==(i=t).tag&&23!==i.tag||null===i.memoizedState||0!=(1073741824&_a)||0==(4&i.mode)){for(var n=0,o=i.child;null!==o;)n|=o.lanes|o.childLanes,o=o.sibling;i.childLanes=n}null!==e&&0==(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags)&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t)}else{if(null!==(i=(e=>{switch(e.tag){case 1:y(e.type)&&To();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Dr(),c(_),c(b),Kr(),0!=(64&(t=e.flags)))throw Error(P(285));return e.flags=-4097&t|64,e;case 5:return $r(e),null;case 13:return c(k),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return c(k),null;case 4:return Dr(),null;case 10:return or(e),null;case 23:case 24:return tl(),null;default:return null}})(t)))return i.flags&=2047,void(O=i);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(O=t)}while(O=t=e,null!==t);0===N&&(N=5)}function ll(e){var t=Wo();return Yo(99,function(e,t){for(;cl(),null!==Da;);if(0!=(48&x))throw Error(P(327));var i=e.finishedWork;if(null!==i){if(e.finishedWork=null,e.finishedLanes=0,i===e.current)throw Error(P(177));e.callbackNode=null;var n=i.lanes|i.childLanes,o=n,r=e.pendingLanes&~o;e.pendingLanes=o,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=o,e.mutableReadLanes&=o,e.entangledLanes&=o,o=e.entanglements;for(var s=e.eventTimes,a=e.expirationTimes;0<r;){var l=31-hi(r),c=1<<l;o[l]=0,s[l]=-1,a[l]=-1,r&=~c}if(null!==Ba&&0==(24&n)&&Ba.has(e)&&Ba.delete(e),e===R&&(O=R=null,A=0),null!==(n=1<i.flags?null!==i.lastEffect?(i.lastEffect.nextEffect=i).firstEffect:i:i.firstEffect)){if(o=x,x|=32,ba.current=null,Xn=bi,wn(s=In())){if("selectionStart"in s)a={start:s.selectionStart,end:s.selectionEnd};else e:if(a=(a=s.ownerDocument)&&a.defaultView||window,(c=a.getSelection&&a.getSelection())&&0!==c.rangeCount){a=c.anchorNode,r=c.anchorOffset,l=c.focusNode,c=c.focusOffset;try{a.nodeType,l.nodeType}catch(e){a=null;break e}var u,d=0,h=-1,p=-1,g=0,f=0,m=s,b=null;t:for(;;){for(;m!==a||0!==r&&3!==m.nodeType||(h=d+r),m!==l||0!==c&&3!==m.nodeType||(p=d+c),3===m.nodeType&&(d+=m.nodeValue.length),null!==(u=m.firstChild);)b=m,m=u;for(;;){if(m===s)break t;if(b===a&&++g===r&&(h=d),b===l&&++f===c&&(p=d),null!==(u=m.nextSibling))break;b=(m=b).parentNode}m=u}a=-1===h||-1===p?null:{start:h,end:p}}else a=null;a=a||{start:0,end:0}}else a=null;ja=null,Wa=bi=!(qn={focusedElem:s,selectionRange:a}),L=n;do{try{(()=>{for(;null!==L;){var e=L.alternate,t=(Wa||null===ja||(0!=(8&L.flags)?It(L,ja)&&(Wa=!0):13===L.tag&&((e,t)=>null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated))(e,L)&&It(L,ja)&&(Wa=!0)),L.flags);0!=(256&t)&&((e,t)=>{switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:var i,n;return 256&t.flags&&null!==e&&(i=e.memoizedProps,n=e.memoizedState,t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?i:Zo(t.type,i),n),e.__reactInternalSnapshotBeforeUpdate=t);case 3:return 256&t.flags&&to(t.stateNode.containerInfo);case 5:case 6:case 4:case 17:return}throw Error(P(163))})(e,L),0==(512&t)||La||(La=!0,Ko(97,function(){return cl(),null})),L=L.nextEffect}})()}catch(e){if(null===L)throw Error(P(330));pl(L,e),L=L.nextEffect}}while(null!==L);ja=null,L=n;do{try{for(s=e;null!==L;){var _,y,v=L.flags;switch(16&v&&We(L.stateNode,""),128&v&&null!==(_=L.alternate)&&null!==(y=_.ref)&&("function"==typeof y?y(null):y.current=null),1038&v){case 2:da(L),L.flags&=-3;break;case 6:da(L),L.flags&=-3,pa(L.alternate,L);break;case 1024:L.flags&=-1025;break;case 1028:L.flags&=-1025,pa(L.alternate,L);break;case 4:pa(L.alternate,L);break;case 8:ha(s,a=L);var T=a.alternate;ca(a),null!==T&&ca(T)}L=L.nextEffect}}catch(e){if(null===L)throw Error(P(330));pl(L,e),L=L.nextEffect}}while(null!==L);if(y=qn,_=In(),v=y.focusedElem,s=y.selectionRange,_!==v&&v&&v.ownerDocument&&function e(t,i){return!(!t||!i)&&(t===i||(!t||3!==t.nodeType)&&(i&&3===i.nodeType?e(t,i.parentNode):"contains"in t?t.contains(i):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(i))))}(v.ownerDocument.documentElement,v)){null!==s&&wn(v)&&(_=s.start,void 0===(y=s.end)&&(y=_),"selectionStart"in v?(v.selectionStart=_,v.selectionEnd=Math.min(y,v.value.length)):(y=(_=v.ownerDocument||document)&&_.defaultView||window).getSelection&&(y=y.getSelection(),a=v.textContent.length,T=Math.min(s.start,a),s=void 0===s.end?T:Math.min(s.end,a),!y.extend&&s<T&&(a=s,s=T,T=a),a=Cn(v,T),r=Cn(v,s),a)&&r&&(1!==y.rangeCount||y.anchorNode!==a.node||y.anchorOffset!==a.offset||y.focusNode!==r.node||y.focusOffset!==r.offset)&&((_=_.createRange()).setStart(a.node,a.offset),y.removeAllRanges(),s<T?(y.addRange(_),y.extend(r.node,r.offset)):(_.setEnd(r.node,r.offset),y.addRange(_)))),_=[];for(y=v;y=y.parentNode;)1===y.nodeType&&_.push({element:y,left:y.scrollLeft,top:y.scrollTop});for("function"==typeof v.focus&&v.focus(),v=0;v<_.length;v++)(y=_[v]).element.scrollLeft=y.left,y.element.scrollTop=y.top}bi=!!Xn,qn=Xn=null,e.current=i,L=n;do{try{for(v=e;null!==L;){var E,k,C=L.flags;36&C&&sa(v,L.alternate,L),128&C&&(_=void 0,null!==(E=L.ref))&&(k=L.stateNode,L.tag,_=k,"function"==typeof E?E(_):E.current=_),L=L.nextEffect}}catch(e){if(null===L)throw Error(P(330));pl(L,e),L=L.nextEffect}}while(null!==L);L=null,Uo(),x=o}else e.current=i;if(La)La=!1,Da=e,Ma=t;else for(L=n;null!==L;)t=L.nextEffect,L.nextEffect=null,8&L.flags&&((C=L).sibling=null,C.stateNode=null),L=t;if(0===(n=e.pendingLanes)&&(Na=null),1===n?e===Ua?Fa++:(Fa=0,Ua=e):Fa=0,i=i.stateNode,So&&"function"==typeof So.onCommitFiberRoot)try{So.onCommitFiberRoot(wo,i,void 0,64==(64&i.current.flags))}catch(e){}if(D(e,I()),Oa)throw Oa=!1,e=Aa,Aa=null,e;0==(8&x)&&Xo()}return null}.bind(null,e,t)),null}function cl(){var e;return 90!==Ma&&(e=97<Ma?97:Ma,Ma=90,Yo(e,dl))}function ul(e,t){Pa.push(t,e),La||(La=!0,Ko(97,function(){return cl(),null}))}function dl(){if(null===Da)return!1;var e=Da;if(Da=null,0!=(48&x))throw Error(P(331));var t=x,i=(x|=32,Pa);Pa=[];for(var n=0;n<i.length;n+=2){var o=i[n],r=i[n+1],s=o.destroy;if(o.destroy=void 0,"function"==typeof s)try{s()}catch(e){if(null===r)throw Error(P(330));pl(r,e)}}for(i=$a,$a=[],n=0;n<i.length;n+=2){o=i[n],r=i[n+1];try{var a=o.create;o.destroy=a()}catch(e){if(null===r)throw Error(P(330));pl(r,e)}}for(a=e.current.firstEffect;null!==a;)e=a.nextEffect,a.nextEffect=null,8&a.flags&&(a.sibling=null,a.stateNode=null),a=e;return x=t,Xo(),!0}function hl(e,t,i){dr(e,t=ia(0,t=Xs(i,t),1)),t=E(),null!==(e=Ka(e,1))&&(di(e,1,t),D(e,t))}function pl(e,t){if(3===e.tag)hl(e,e,t);else for(var i=e.return;null!==i;){if(3===i.tag){hl(i,e,t);break}if(1===i.tag){var n,o=i.stateNode;if("function"==typeof i.type.getDerivedStateFromError||"function"==typeof o.componentDidCatch&&(null===Na||!Na.has(o))){if(dr(i,na(i,e=Xs(t,e),1)),n=E(),null!==(i=Ka(i,1)))di(i,1,n),D(i,n);else if("function"==typeof o.componentDidCatch&&(null===Na||!Na.has(o)))try{o.componentDidCatch(t,e)}catch(e){}break}}i=i.return}}function gl(e,t,i){var n=e.pingCache;null!==n&&n.delete(t),t=E(),e.pingedLanes|=e.suspendedLanes&i,R===e&&(A&i)===i&&(4===N||3===N&&(62914560&A)===A&&I()-wa<500?il(e,0):Ca|=i),D(e,t)}function fl(e,t,i,n){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function ml(e,t,i,n){return new fl(e,t,i,n)}function bl(e){return(e=e.prototype)&&e.isReactComponent}function _l(e,t){var i=e.alternate;return null===i?((i=ml(e.tag,t,e.key,e.mode)).elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,(i.alternate=e).alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null),i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,i.dependencies=null===(t=e.dependencies)?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function yl(e,t,i,n,o,r){var s=2;if("function"==typeof(n=e))bl(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case te:return vl(i.children,o,r,t);case pe:s=8,o|=16;break;case ie:s=8,o|=1;break;case ne:return(e=ml(12,i,t,8|o)).elementType=ne,e.type=ne,e.lanes=r,e;case ae:return(e=ml(13,i,t,o)).type=ae,e.elementType=ae,e.lanes=r,e;case le:return(e=ml(19,i,t,o)).elementType=le,e.lanes=r,e;case ge:return Tl(i,o,r,t);case fe:return(e=ml(24,i,t,o)).elementType=fe,e.lanes=r,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case oe:s=10;break e;case re:s=9;break e;case se:s=11;break e;case ce:s=14;break e;case ue:s=16,n=null;break e;case de:s=22;break e}throw Error(P(130,null==e?e:typeof e,""))}return(t=ml(s,i,t,o)).elementType=e,t.type=n,t.lanes=r,t}function vl(e,t,i,n){return(e=ml(7,e,n,t)).lanes=i,e}function Tl(e,t,i,n){return(e=ml(23,e,n,t)).elementType=ge,e.lanes=i,e}function El(e,t,i){return(e=ml(6,e,null,t)).lanes=i,e}function kl(e,t,i){return(t=ml(4,null!==e.children?e.children:[],e.key,t)).lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Cl(e,t,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=i,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=ui(0),this.expirationTimes=ui(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ui(0),this.mutableSourceEagerHydrationData=null}function Il(e,t,i,n){var o=t.current,r=E(),s=za(o);e:if(i){t:{if(Tt(i=i._reactInternals)!==i||1!==i.tag)throw Error(P(170));var a=i;do{switch(a.tag){case 3:a=a.stateNode.context;break t;case 1:if(y(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break t}}}while(null!==(a=a.return));throw Error(P(171))}if(1===i.tag){var l=i.type;if(y(l)){i=ko(i,l,a);break e}}i=a}else i=_o;null===t.context?t.context=i:t.pendingContext=i,(t=ur(r,s)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),dr(o,t),Ya(o,s,r)}function wl(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Sl(e,t){var i;null!==(e=e.memoizedState)&&null!==e.dehydrated&&(i=e.retryLane,e.retryLane=0!==i&&i<t?i:t)}function xl(e,t){Sl(e,t),(e=e.alternate)&&Sl(e,t)}function Rl(e,t,i){var n=null!=i&&null!=i.hydrationOptions&&i.hydrationOptions.mutableSources||null;if(i=new Cl(e,t,null!=i&&!0===i.hydrate),t=ml(3,null,null,2===t?7:1===t?3:0),(i.current=t).stateNode=i,lr(t),e[ao]=i.current,Un(8===e.nodeType?e.parentNode:e),n)for(e=0;e<n.length;e++){var o=(o=(t=n[e])._getVersion)(t._source);null==i.mutableSourceEagerHydrationData?i.mutableSourceEagerHydrationData=[t,o]:i.mutableSourceEagerHydrationData.push(t,o)}this._internalRoot=i}function Ol(e){return e&&(1===e.nodeType||9===e.nodeType||11===e.nodeType||8===e.nodeType&&" react-mount-point-unstable "===e.nodeValue)}function Al(e,t,i,n,o){var r,s,a,l=i._reactRootContainer;return l?(a=l._internalRoot,"function"==typeof o&&(r=o,o=function(){var e=wl(a);r.call(e)}),Il(t,a,e,o)):(a=(i._reactRootContainer=((e,t)=>{if(!(t=t?t:!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))))for(var i;i=e.lastChild;)e.removeChild(i);return new Rl(e,0,t?{hydrate:!0}:void 0)})(i,n))._internalRoot,"function"==typeof o&&(s=o,o=function(){var e=wl(a);s.call(e)}),Qa(function(){Il(t,a,e,o)})),wl(a)}function Nl(e,t){if(Ol(t))return function(e,t,i,n){return{$$typeof:ee,key:null==(n=3<arguments.length&&void 0!==n?n:null)?null:""+n,children:e,containerInfo:t,implementation:i}}(e,t,null,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null);throw Error(P(200))}Ra=function(e,t,i){var n=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||_.current)Rs=!0;else{if(0==(i&n)){switch(Rs=!1,t.tag){case 3:Bs(t),zr();break;case 5:Mr(t);break;case 1:y(t.type)&&Co(t);break;case 4:Lr(t,t.stateNode.containerInfo);break;case 10:var n=t.memoizedProps.value,o=t.type._context;h(Qo,o._currentValue),o._currentValue=n;break;case 13:if(null!==t.memoizedState)return 0!=(i&t.child.childLanes)?Us(e,t,i):(h(k,1&k.current),null!==(t=Ys(e,t,i))?t.sibling:null);h(k,1&k.current);break;case 19:if(n=0!=(i&t.childLanes),0!=(64&e.flags)){if(n)return zs(e,t,i);t.flags|=64}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),h(k,k.current),n)break;return null;case 23:case 24:return t.lanes=0,Ls(e,t,i)}return Ys(e,t,i)}Rs=0!=(16384&e.flags)}else Rs=!1;switch(t.lanes=0,t.tag){case 2:return n=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,o=vo(t,b.current),sr(t,i),o=es(null,t,n,e,o,i),t.flags|=1,t="object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,y(n)?(r=!0,Co(t)):r=!1,t.memoizedState=null!=o.state?o.state:null,lr(t),"function"==typeof(l=n.getDerivedStateFromProps)&&mr(t,0,l,e),o.updater=br,Tr((t.stateNode=o)._reactInternals=t,n,e,i),Ps(null,t,n,!0,r,i)):(t.tag=0,T(null,t,o,i),t.child);case 16:o=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,o=(r=o._init)(o._payload),t.type=o,r=t.tag=(e=>{if("function"==typeof e)return bl(e)?1:0;if(null!=e){if((e=e.$$typeof)===se)return 11;if(e===ce)return 14}return 2})(o),e=Zo(o,e),r){case 0:t=Ms(null,t,o,e,i);break e;case 1:t=$s(null,t,o,e,i);break e;case 11:t=Os(null,t,o,e,i);break e;case 14:t=As(null,t,o,Zo(o.type,e),n,i);break e}throw Error(P(306,o,""))}return t;case 0:return n=t.type,o=t.pendingProps,Ms(e,t,n,o=t.elementType===n?o:Zo(n,o),i);case 1:return n=t.type,o=t.pendingProps,$s(e,t,n,o=t.elementType===n?o:Zo(n,o),i);case 3:if(Bs(t),n=t.updateQueue,null===e||null===n)throw Error(P(282));if(n=t.pendingProps,o=null!==(o=t.memoizedState)?o.element:null,cr(e,t),pr(t,n,null,i),(n=t.memoizedState.element)===o)zr(),t=Ys(e,t,i);else{if((r=(o=t.stateNode).hydrate)&&(Fr=io(t.stateNode.containerInfo.firstChild),Br=t,r=Ur=!0),r){if(null!=(e=o.mutableSourceEagerHydrationData))for(o=0;o<e.length;o+=2)(r=e[o])._workInProgressVersionPrimary=e[o+1],Yr.push(r);for(i=Sr(t,null,n,i),t.child=i;i;)i.flags=-3&i.flags|1024,i=i.sibling}else T(e,t,n,i),zr();t=t.child}return t;case 5:return Mr(t),null===e&&Vr(t),n=t.type,o=t.pendingProps,r=null!==e?e.memoizedProps:null,l=o.children,Zn(n,o)?l=null:null!==r&&Zn(n,r)&&(t.flags|=16),Ds(e,t),T(e,t,l,i),t.child;case 6:return null===e&&Vr(t),null;case 13:return Us(e,t,i);case 4:return Lr(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=wr(t,null,n,i):T(e,t,n,i),t.child;case 11:return n=t.type,o=t.pendingProps,Os(e,t,n,o=t.elementType===n?o:Zo(n,o),i);case 7:return T(e,t,t.pendingProps,i),t.child;case 8:case 12:return T(e,t,t.pendingProps.children,i),t.child;case 10:e:{n=t.type._context,o=t.pendingProps,l=t.memoizedProps;var r=o.value,s=t.type._context;if(h(Qo,s._currentValue),s._currentValue=r,null!==l)if(s=l.value,0===(r=m(s,r)?0:0|("function"==typeof n._calculateChangedBits?n._calculateChangedBits(s,r):1073741823))){if(l.children===o.children&&!_.current){t=Ys(e,t,i);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var a=s.dependencies;if(null!==a)for(var l=s.child,c=a.firstContext;null!==c;){if(c.context===n&&0!=(c.observedBits&r)){1===s.tag&&((c=ur(-1,i&-i)).tag=2,dr(s,c)),s.lanes|=i,null!==(c=s.alternate)&&(c.lanes|=i),rr(s.return,i),a.lanes|=i;break}c=c.next}else l=10===s.tag&&s.type===t.type?null:s.child;if(null!==l)l.return=s;else for(l=s;null!==l;){if(l===t){l=null;break}if(null!==(s=l.sibling)){s.return=l.return,l=s;break}l=l.return}s=l}T(e,t,o.children,i),t=t.child}return t;case 9:return o=t.type,n=(r=t.pendingProps).children,sr(t,i),n=n(o=v(o,r.unstable_observedBits)),t.flags|=1,T(e,t,n,i),t.child;case 14:return r=Zo(o=t.type,t.pendingProps),As(e,t,o,r=Zo(o.type,r),n,i);case 15:return Ns(e,t,t.type,t.pendingProps,n,i);case 17:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:Zo(n,o),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,y(n)?(e=!0,Co(t)):e=!1,sr(t,i),yr(t,n,o),Tr(t,n,o,i),Ps(null,t,n,!0,e,i);case 19:return zs(e,t,i);case 23:case 24:return Ls(e,t,i)}throw Error(P(156,t.tag))},Rl.prototype.render=function(e){Il(e,this._internalRoot,null,null)},Rl.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Il(null,e,null,function(){t[ao]=null})},wt=function(e){13===e.tag&&(Ya(e,4,E()),xl(e,4))},St=function(e){13===e.tag&&(Ya(e,67108864,E()),xl(e,67108864))},xt=function(e){var t,i;13===e.tag&&(t=E(),Ya(e,i=za(e),t),xl(e,i))},Rt=function(e,t){return t()},et=function(e,t,i){switch(t){case"input":if(Oe(e,i),t=i.name,"radio"===i.type&&null!=t){for(i=e;i.parentNode;)i=i.parentNode;for(i=i.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<i.length;t++){var n=i[t];if(n!==e&&n.form===e.form){var o=po(n);if(!o)throw Error(P(90));Ie(n),Oe(n,o)}}}break;case"textarea":Pe(e,i);break;case"select":null!=(t=i.value)&&De(e,!!i.multiple,t,!1)}},st=Za,at=function(e,t,i,n,o){var r=x;x|=4;try{return Yo(98,e.bind(null,t,i,n,o))}finally{0===(x=r)&&(xa(),Xo())}};ct=function(e,t){var i=x;x|=2;try{return e(t)}finally{0===(x=i)&&(xa(),Xo())}},a={Events:[uo,ho,po,ot,rt,cl,{current:!(lt=function(){var e;0==(49&x)&&(null!==Ba&&(e=Ba,Ba=null,e.forEach(function(e){e.expiredLanes|=24&e.pendingLanes,D(e,I())})),Xo(),cl())})}]},e={findFiberByHostInstance:co,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},n={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Z.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ct(e))?null:e.stateNode},findFiberByHostInstance:e.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){l=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!l.isDisabled&&l.supportsFiber)try{wo=l.inject(n),So=l}catch(e){}}$.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=a,$.createPortal=Nl,$.findDOMNode=function(e){if(null==e)return null;if(1!==e.nodeType){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(P(188));throw Error(P(268,Object.keys(e)))}e=null===(e=Ct(t))?null:e.stateNode}return e},$.flushSync=function(e,t){var i=x;if(0!=(48&i))return e(t);x|=1;try{if(e)return Yo(99,e.bind(null,t))}finally{x=i,Xo()}},$.hydrate=function(e,t,i){if(Ol(t))return Al(null,e,t,!0,i);throw Error(P(200))},$.render=function(e,t,i){if(Ol(t))return Al(null,e,t,!1,i);throw Error(P(200))},$.unmountComponentAtNode=function(e){if(Ol(e))return!!e._reactRootContainer&&(Qa(function(){Al(null,null,e,!1,function(){e._reactRootContainer=null,e[ao]=null})}),!0);throw Error(P(40))},$.unstable_batchedUpdates=Za,$.unstable_createPortal=function(e,t){return Nl(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},$.unstable_renderSubtreeIntoContainer=function(e,t,i,n){if(!Ol(i))throw Error(P(200));if(null==e||void 0===e._reactInternals)throw Error(P(38));return Al(e,t,i,!1,n)},$.version="17.0.2"},{"object-assign":222,react:268,scheduler:275}],232:[function(e,i,t){!function(t){!function(){"production"===t.env.NODE_ENV?(function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE){if("production"!==t.env.NODE_ENV)throw new Error("^_^");try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(e){console.error(e)}}}(),i.exports=e("./cjs/react-dom.production.min.js")):i.exports=e("./cjs/react-dom.development.js")}.call(this)}.call(this,e("_process"))},{"./cjs/react-dom.development.js":230,"./cjs/react-dom.production.min.js":231,_process:223}],233:[function(e,t,D){!function(L){!function(){function t(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case o:var i=e.type;switch(i){case d:case h:case s:case l:case a:case g:return i;default:var n=i&&i.$$typeof;switch(n){case u:case p:case m:case f:case c:return n;default:return t}}case r:return t}}}function i(e){return t(e)===h}var e,o,r,s,a,l,c,u,d,h,p,g,n,f,m,b,_,y,v,T,E,k,C,I,w,S,x,R,O,A,N;"production"!==L.env.NODE_ENV&&(e="function"==typeof Symbol&&Symbol.for,o=e?Symbol.for("react.element"):60103,r=e?Symbol.for("react.portal"):60106,s=e?Symbol.for("react.fragment"):60107,a=e?Symbol.for("react.strict_mode"):60108,l=e?Symbol.for("react.profiler"):60114,c=e?Symbol.for("react.provider"):60109,u=e?Symbol.for("react.context"):60110,d=e?Symbol.for("react.async_mode"):60111,h=e?Symbol.for("react.concurrent_mode"):60111,p=e?Symbol.for("react.forward_ref"):60112,g=e?Symbol.for("react.suspense"):60113,n=e?Symbol.for("react.suspense_list"):60120,f=e?Symbol.for("react.memo"):60115,m=e?Symbol.for("react.lazy"):60116,b=e?Symbol.for("react.block"):60121,_=e?Symbol.for("react.fundamental"):60117,y=e?Symbol.for("react.responder"):60118,v=e?Symbol.for("react.scope"):60119,e=h,T=u,E=c,k=o,C=p,I=s,w=m,S=f,x=r,R=l,O=a,A=g,N=!1,D.AsyncMode=d,D.ConcurrentMode=e,D.ContextConsumer=T,D.ContextProvider=E,D.Element=k,D.ForwardRef=C,D.Fragment=I,D.Lazy=w,D.Memo=S,D.Portal=x,D.Profiler=R,D.StrictMode=O,D.Suspense=A,D.isAsyncMode=function(e){return N||(N=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),i(e)||t(e)===d},D.isConcurrentMode=i,D.isContextConsumer=function(e){return t(e)===u},D.isContextProvider=function(e){return t(e)===c},D.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===o},D.isForwardRef=function(e){return t(e)===p},D.isFragment=function(e){return t(e)===s},D.isLazy=function(e){return t(e)===m},D.isMemo=function(e){return t(e)===f},D.isPortal=function(e){return t(e)===r},D.isProfiler=function(e){return t(e)===l},D.isStrictMode=function(e){return t(e)===a},D.isSuspense=function(e){return t(e)===g},D.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===s||e===h||e===l||e===a||e===g||e===n||"object"==typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===f||e.$$typeof===c||e.$$typeof===u||e.$$typeof===p||e.$$typeof===_||e.$$typeof===y||e.$$typeof===v||e.$$typeof===b)},D.typeOf=t)}.call(this)}.call(this,e("_process"))},{_process:223}],234:[function(e,t,i){var n="function"==typeof Symbol&&Symbol.for,o=n?Symbol.for("react.element"):60103,r=n?Symbol.for("react.portal"):60106,s=n?Symbol.for("react.fragment"):60107,a=n?Symbol.for("react.strict_mode"):60108,l=n?Symbol.for("react.profiler"):60114,c=n?Symbol.for("react.provider"):60109,u=n?Symbol.for("react.context"):60110,d=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,p=n?Symbol.for("react.forward_ref"):60112,g=n?Symbol.for("react.suspense"):60113,f=n?Symbol.for("react.suspense_list"):60120,m=n?Symbol.for("react.memo"):60115,b=n?Symbol.for("react.lazy"):60116,_=n?Symbol.for("react.block"):60121,y=n?Symbol.for("react.fundamental"):60117,v=n?Symbol.for("react.responder"):60118,T=n?Symbol.for("react.scope"):60119;function E(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case o:switch(e=e.type){case d:case h:case s:case l:case a:case g:return e;default:switch(e=e&&e.$$typeof){case u:case p:case b:case m:case c:return e;default:return t}}case r:return t}}}function k(e){return E(e)===h}i.AsyncMode=d,i.ConcurrentMode=h,i.ContextConsumer=u,i.ContextProvider=c,i.Element=o,i.ForwardRef=p,i.Fragment=s,i.Lazy=b,i.Memo=m,i.Portal=r,i.Profiler=l,i.StrictMode=a,i.Suspense=g,i.isAsyncMode=function(e){return k(e)||E(e)===d},i.isConcurrentMode=k,i.isContextConsumer=function(e){return E(e)===u},i.isContextProvider=function(e){return E(e)===c},i.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===o},i.isForwardRef=function(e){return E(e)===p},i.isFragment=function(e){return E(e)===s},i.isLazy=function(e){return E(e)===b},i.isMemo=function(e){return E(e)===m},i.isPortal=function(e){return E(e)===r},i.isProfiler=function(e){return E(e)===l},i.isStrictMode=function(e){return E(e)===a},i.isSuspense=function(e){return E(e)===g},i.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===s||e===h||e===l||e===a||e===g||e===f||"object"==typeof e&&null!==e&&(e.$$typeof===b||e.$$typeof===m||e.$$typeof===c||e.$$typeof===u||e.$$typeof===p||e.$$typeof===y||e.$$typeof===v||e.$$typeof===T||e.$$typeof===_)},i.typeOf=E},{}],235:[function(t,i,e){!function(e){!function(){"production"===e.env.NODE_ENV?i.exports=t("./cjs/react-is.production.min.js"):i.exports=t("./cjs/react-is.development.js")}.call(this)}.call(this,t("_process"))},{"./cjs/react-is.development.js":233,"./cjs/react-is.production.min.js":234,_process:223}],236:[function(i,e,n){!function(t){!function(){var e=i("@babel/runtime/helpers/interopRequireDefault").default;n.__esModule=!0,n.default=n.ReactReduxContext=void 0;e=e(i("react")).default.createContext(null),n.ReactReduxContext=e,"production"!==t.env.NODE_ENV&&(e.displayName="ReactRedux");n.default=e}.call(this)}.call(this,i("_process"))},{"@babel/runtime/helpers/interopRequireDefault":206,_process:223,react:268}],237:[function(o,e,c){!function(n){!function(){var e=o("@babel/runtime/helpers/interopRequireDefault").default,t=o("@babel/runtime/helpers/interopRequireWildcard").default,r=(c.__esModule=!0,c.default=void 0,t(o("react"))),t=e(o("prop-types")),s=o("./Context"),a=o("../utils/Subscription"),l=o("../utils/useIsomorphicLayoutEffect");function i(e){var t=e.store,i=e.context,e=e.children,n=(0,r.useMemo)(function(){var e=(0,a.createSubscription)(t);return{store:t,subscription:e}},[t]),o=(0,r.useMemo)(function(){return t.getState()},[t]),i=((0,l.useIsomorphicLayoutEffect)(function(){var e=n.subscription;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),o!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}},[n,o]),i||s.ReactReduxContext);return r.default.createElement(i.Provider,{value:n},e)}"production"!==n.env.NODE_ENV&&(i.propTypes={store:t.default.shape({subscribe:t.default.func.isRequired,dispatch:t.default.func.isRequired,getState:t.default.func.isRequired}),context:t.default.object,children:t.default.any}),c.default=i}.call(this)}.call(this,o("_process"))},{"../utils/Subscription":252,"../utils/useIsomorphicLayoutEffect":258,"./Context":236,"@babel/runtime/helpers/interopRequireDefault":206,"@babel/runtime/helpers/interopRequireWildcard":207,_process:223,"prop-types":227,react:268}],238:[function(i,e,o){!function(U){!function(){var e=i("@babel/runtime/helpers/interopRequireDefault").default,t=i("@babel/runtime/helpers/interopRequireWildcard").default,S=(o.__esModule=!0,o.default=function(C,e){void 0===e&&(e={});var t=e.getDisplayName,n=void 0===t?function(e){return"ConnectAdvanced("+e+")"}:t,t=e.methodName,o=void 0===t?"connectAdvanced":t,t=e.renderCountProp,r=void 0===t?void 0:t,t=e.shouldHandleStateChanges,I=void 0===t||t,t=e.storeKey,s=void 0===t?"store":t,t=e.withRef,t=void 0!==t&&t,i=e.forwardRef,a=void 0!==i&&i,i=e.context,i=void 0===i?u.ReactReduxContext:i,l=(0,x.default)(e,d);if("production"!==U.env.NODE_ENV){if(void 0!==r)throw new Error("renderCountProp is removed. render counting is built into the latest React Dev Tools profiling extension");if(t)throw new Error("withRef is removed. To access the wrapped instance, use a ref on the connected component");if("store"!==s)throw new Error("storeKey has been removed and does not do anything. To use a custom Redux store for specific components, create a custom React context with React.createContext(), and pass the context object to React Redux's Provider and specific components like: <Provider context={MyContext}><ConnectedComponent context={MyContext} /></Provider>. You may also pass a {context : MyContext} option to connect")}var w=i;return function(v){var T,E,k,i,e;if("production"===U.env.NODE_ENV||(0,O.isValidElementType)(v))return e=v.displayName||v.name||"Component",T=n(e),E=(0,S.default)({},l,{getDisplayName:n,methodName:o,renderCountProp:r,shouldHandleStateChanges:I,storeKey:s,displayName:T,wrappedComponentName:e,WrappedComponent:v}),e=l.pure,k=e?R.useMemo:function(e){return e()},(i=e?R.default.memo(t):t).WrappedComponent=v,i.displayName=t.displayName=T,a?((e=R.default.forwardRef(function(e,t){return R.default.createElement(i,(0,S.default)({},e,{reactReduxForwardedRef:t}))})).displayName=T,e.WrappedComponent=v,(0,c.default)(e,v)):(0,c.default)(i,v);throw new Error("You must pass a component to the function returned by "+o+". Instead received "+h(v));function t(i){var e=(0,R.useMemo)(function(){var e=i.reactReduxForwardedRef,t=(0,x.default)(i,N);return[i.context,e,t]},[i]),t=e[0],n=e[1],o=e[2],r=(0,R.useMemo)(function(){return t&&t.Consumer&&(0,O.isContextConsumer)(R.default.createElement(t.Consumer,null))?t:w},[t,w]),s=(0,R.useContext)(r),a=Boolean(i.store)&&Boolean(i.store.getState)&&Boolean(i.store.dispatch),e=Boolean(s)&&Boolean(s.store);if("production"!==U.env.NODE_ENV&&!a&&!e)throw new Error('Could not find "store" in the context of "'+T+'". Either wrap the root component in a <Provider>, or pass a custom React context provider to <Provider> and the corresponding React context consumer to '+T+" in connect options.");var l=(a?i:s).store,c=(0,R.useMemo)(function(){return C(l.dispatch,E)},[l]),e=(0,R.useMemo)(function(){var e,t;return I?(t=(e=(0,A.createSubscription)(l,a?null:s.subscription)).notifyNestedSubs.bind(e),[e,t]):D},[l,a,s]),u=e[0],e=e[1],d=(0,R.useMemo)(function(){return a?s:(0,S.default)({},s,{subscription:u})},[a,s,u]),h=(0,R.useReducer)(M,L,F),p=h[0][0],h=h[1];if(p&&p.error)throw p.error;var g=(0,R.useRef)(),f=(0,R.useRef)(o),m=(0,R.useRef)(),b=(0,R.useRef)(!1),_=k(function(){return m.current&&o===f.current?m.current:c(l.getState(),o)},[l,p,o]),y=($(P,[f,g,b,o,_,m,e]),$(B,[I,l,u,c,f,g,b,m,e,h],[l,u,c]),(0,R.useMemo)(function(){return R.default.createElement(v,(0,S.default)({},_,{ref:n}))},[n,v,_]));return(0,R.useMemo)(function(){return I?R.default.createElement(r.Provider,{value:d},y):y},[r,y,d])}}},e(i("@babel/runtime/helpers/extends"))),x=e(i("@babel/runtime/helpers/objectWithoutPropertiesLoose")),c=e(i("hoist-non-react-statics")),R=t(i("react")),O=i("react-is"),A=i("../utils/Subscription"),n=i("../utils/useIsomorphicLayoutEffect"),u=i("./Context"),d=["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef","forwardRef","context"],N=["reactReduxForwardedRef"],L=[],D=[null,null],h=function(t){try{return JSON.stringify(t)}catch(e){return String(t)}};function M(e,t){e=e[1];return[t.payload,e+1]}function $(e,t,i){(0,n.useIsomorphicLayoutEffect)(function(){return e.apply(void 0,t)},i)}function P(e,t,i,n,o,r,s){e.current=n,t.current=o,i.current=!1,r.current&&(r.current=null,s())}function B(e,n,t,o,r,s,a,l,c,u){var d,h;if(e)return d=!1,h=null,t.onStateChange=e=function(){if(!d){var e,t,i=n.getState();try{e=o(i,r.current)}catch(e){h=t=e}t||(h=null),e===s.current?a.current||c():(s.current=e,l.current=e,a.current=!0,u({type:"STORE_UPDATED",payload:{error:t}}))}},t.trySubscribe(),e(),function(){if(d=!0,t.tryUnsubscribe(),t.onStateChange=null,h)throw h}}var F=function(){return[null,0]}}.call(this)}.call(this,i("_process"))},{"../utils/Subscription":252,"../utils/useIsomorphicLayoutEffect":258,"./Context":236,"@babel/runtime/helpers/extends":205,"@babel/runtime/helpers/interopRequireDefault":206,"@babel/runtime/helpers/interopRequireWildcard":207,"@babel/runtime/helpers/objectWithoutPropertiesLoose":209,_process:223,"hoist-non-react-statics":221,react:268,"react-is":263}],239:[function(e,t,i){var n=e("@babel/runtime/helpers/interopRequireDefault").default,f=(i.__esModule=!0,i.createConnect=c,i.default=void 0,n(e("@babel/runtime/helpers/extends"))),m=n(e("@babel/runtime/helpers/objectWithoutPropertiesLoose")),o=n(e("../components/connectAdvanced")),b=n(e("../utils/shallowEqual")),r=n(e("./mapDispatchToProps")),s=n(e("./mapStateToProps")),a=n(e("./mergeProps")),l=n(e("./selectorFactory")),_=["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"];function y(i,e,n){for(var t=e.length-1;0<=t;t--){var o=e[t](i);if(o)return o}return function(e,t){throw new Error("Invalid value of type "+typeof i+" for "+n+" argument when connecting component "+t.wrappedComponentName+".")}}function v(e,t){return e===t}function c(e){var e=void 0===e?{}:e,t=e.connectHOC,u=void 0===t?o.default:t,t=e.mapStateToPropsFactories,d=void 0===t?s.default:t,t=e.mapDispatchToPropsFactories,h=void 0===t?r.default:t,t=e.mergePropsFactories,p=void 0===t?a.default:t,t=e.selectorFactory,g=void 0===t?l.default:t;return function(e,t,i,n){var n=n=void 0===n?{}:n,o=n.pure,o=void 0===o||o,r=n.areStatesEqual,r=void 0===r?v:r,s=n.areOwnPropsEqual,s=void 0===s?b.default:s,a=n.areStatePropsEqual,a=void 0===a?b.default:a,l=n.areMergedPropsEqual,l=void 0===l?b.default:l,n=(0,m.default)(n,_),c=y(e,d,"mapStateToProps"),t=y(t,h,"mapDispatchToProps"),i=y(i,p,"mergeProps");return u(g,(0,f.default)({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:c,initMapDispatchToProps:t,initMergeProps:i,pure:o,areStatesEqual:r,areOwnPropsEqual:s,areStatePropsEqual:a,areMergedPropsEqual:l},n))}}i.default=c()},{"../components/connectAdvanced":238,"../utils/shallowEqual":257,"./mapDispatchToProps":240,"./mapStateToProps":241,"./mergeProps":242,"./selectorFactory":243,"@babel/runtime/helpers/extends":205,"@babel/runtime/helpers/interopRequireDefault":206,"@babel/runtime/helpers/objectWithoutPropertiesLoose":209}],240:[function(e,t,i){var n=e("@babel/runtime/helpers/interopRequireDefault").default,o=(i.__esModule=!0,i.default=void 0,i.whenMapDispatchToPropsIsFunction=s,i.whenMapDispatchToPropsIsMissing=a,i.whenMapDispatchToPropsIsObject=l,n(e("../utils/bindActionCreators"))),r=e("./wrapMapToProps");function s(e){return"function"==typeof e?(0,r.wrapMapToPropsFunc)(e,"mapDispatchToProps"):void 0}function a(e){return e?void 0:(0,r.wrapMapToPropsConstant)(function(e){return{dispatch:e}})}function l(t){return t&&"object"==typeof t?(0,r.wrapMapToPropsConstant)(function(e){return(0,o.default)(t,e)}):void 0}i.default=[s,a,l]},{"../utils/bindActionCreators":254,"./wrapMapToProps":245,"@babel/runtime/helpers/interopRequireDefault":206}],241:[function(e,t,i){i.__esModule=!0,i.default=void 0,i.whenMapStateToPropsIsFunction=o,i.whenMapStateToPropsIsMissing=r;var n=e("./wrapMapToProps");function o(e){return"function"==typeof e?(0,n.wrapMapToPropsFunc)(e,"mapStateToProps"):void 0}function r(e){return e?void 0:(0,n.wrapMapToPropsConstant)(function(){return{}})}i.default=[o,r]},{"./wrapMapToProps":245}],242:[function(s,e,a){!function(u){!function(){var e=s("@babel/runtime/helpers/interopRequireDefault").default,n=(a.__esModule=!0,a.default=void 0,a.defaultMergeProps=t,a.whenMergePropsIsFunction=o,a.whenMergePropsIsOmitted=r,a.wrapMergePropsFunc=i,e(s("@babel/runtime/helpers/extends"))),c=e(s("../utils/verifyPlainObject"));function t(e,t,i){return(0,n.default)({},i,e,t)}function i(l){return function(e,t){var n,o=t.displayName,r=t.pure,s=t.areMergedPropsEqual,a=!1;return function(e,t,i){e=l(e,t,i);return a?r&&s(e,n)||(n=e):(a=!0,n=e,"production"!==u.env.NODE_ENV&&(0,c.default)(n,o,"mergeProps")),n}}}function o(e){return"function"==typeof e?i(e):void 0}function r(e){return e?void 0:function(){return t}}a.default=[o,r]}.call(this)}.call(this,s("_process"))},{"../utils/verifyPlainObject":259,"@babel/runtime/helpers/extends":205,"@babel/runtime/helpers/interopRequireDefault":206,_process:223}],243:[function(t,e,i){!function(u){!function(){var e=t("@babel/runtime/helpers/interopRequireDefault").default,r=(i.__esModule=!0,i.default=function(e,t){var i=t.initMapStateToProps,n=t.initMapDispatchToProps,o=t.initMergeProps,t=(0,r.default)(t,a),i=i(e,t),n=n(e,t),o=o(e,t);"production"!==u.env.NODE_ENV&&(0,s.default)(i,n,o,t.displayName);return(t.pure?c:l)(i,n,o,e,t)},i.impureFinalPropsSelectorFactory=l,i.pureFinalPropsSelectorFactory=c,e(t("@babel/runtime/helpers/objectWithoutPropertiesLoose"))),s=e(t("./verifySubselectors")),a=["initMapStateToProps","initMapDispatchToProps","initMergeProps"];function l(i,n,o,r){return function(e,t){return o(i(e,t),n(r,t),t)}}function c(o,r,s,a,e){var l,c,u,d,h,p=e.areStatesEqual,g=e.areOwnPropsEqual,f=e.areStatePropsEqual,i=!1;function n(e,t){var i=!g(t,c),n=!p(e,l,t,c);return l=e,c=t,i&&n?(u=o(l,c),r.dependsOnOwnProps&&(d=r(a,c)),h=s(u,d,c)):i?(o.dependsOnOwnProps&&(u=o(l,c)),r.dependsOnOwnProps&&(d=r(a,c)),h=s(u,d,c)):n?(e=o(l,c),t=!f(e,u),u=e,h=t?s(u,d,c):h):h}return function(e,t){return i?n(e,t):(u=o(l=e,c=t),d=r(a,c),h=s(u,d,c),i=!0,h)}}}.call(this)}.call(this,t("_process"))},{"./verifySubselectors":244,"@babel/runtime/helpers/interopRequireDefault":206,"@babel/runtime/helpers/objectWithoutPropertiesLoose":209,_process:223}],244:[function(e,t,i){var n=e("@babel/runtime/helpers/interopRequireDefault").default,o=(i.__esModule=!0,i.default=function(e,t,i,n){r(e,"mapStateToProps",n),r(t,"mapDispatchToProps",n),r(i,"mergeProps",n)},n(e("../utils/warning")));function r(e,t,i){if(!e)throw new Error("Unexpected value for "+t+" in "+i+".");"mapStateToProps"!==t&&"mapDispatchToProps"!==t||Object.prototype.hasOwnProperty.call(e,"dependsOnOwnProps")||(0,o.default)("The selector for "+t+" of "+i+" did not specify a value for dependsOnOwnProps.")}},{"../utils/warning":260,"@babel/runtime/helpers/interopRequireDefault":206}],245:[function(t,e,i){!function(c){!function(){var e=t("@babel/runtime/helpers/interopRequireDefault").default,a=(i.__esModule=!0,i.getDependsOnOwnProps=l,i.wrapMapToPropsConstant=function(o){return function(e,t){var i=o(e,t);function n(){return i}return n.dependsOnOwnProps=!1,n}},i.wrapMapToPropsFunc=function(r,s){return function(e,t){var n=t.displayName,o=function(e,t){return o.dependsOnOwnProps?o.mapToProps(e,t):o.mapToProps(e)};return o.dependsOnOwnProps=!0,o.mapToProps=function(e,t){o.mapToProps=r,o.dependsOnOwnProps=l(r);var i=o(e,t);return"function"==typeof i&&(o.mapToProps=i,o.dependsOnOwnProps=l(i),i=o(e,t)),"production"!==c.env.NODE_ENV&&(0,a.default)(i,n,s),i},o}},e(t("../utils/verifyPlainObject")));function l(e){return null!=e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}}.call(this)}.call(this,t("_process"))},{"../utils/verifyPlainObject":259,"@babel/runtime/helpers/interopRequireDefault":206,_process:223}],246:[function(e,t,i){var n=e("@babel/runtime/helpers/interopRequireDefault").default,o=(i.__esModule=!0,n(e("./components/Provider"))),o=(i.Provider=o.default,n(e("./components/connectAdvanced"))),o=(i.connectAdvanced=o.default,e("./components/Context")),o=(i.ReactReduxContext=o.ReactReduxContext,n(e("./connect/connect"))),o=(i.connect=o.default,e("./hooks/useDispatch")),o=(i.useDispatch=o.useDispatch,i.createDispatchHook=o.createDispatchHook,e("./hooks/useSelector")),o=(i.useSelector=o.useSelector,i.createSelectorHook=o.createSelectorHook,e("./hooks/useStore")),o=(i.useStore=o.useStore,i.createStoreHook=o.createStoreHook,n(e("./utils/shallowEqual")));i.shallowEqual=o.default},{"./components/Context":236,"./components/Provider":237,"./components/connectAdvanced":238,"./connect/connect":239,"./hooks/useDispatch":247,"./hooks/useSelector":249,"./hooks/useStore":250,"./utils/shallowEqual":257,"@babel/runtime/helpers/interopRequireDefault":206}],247:[function(e,t,i){i.__esModule=!0,i.createDispatchHook=r,i.useDispatch=void 0;var n=e("../components/Context"),o=e("./useStore");function r(e){var t=(e=void 0===e?n.ReactReduxContext:e)===n.ReactReduxContext?o.useStore:(0,o.createStoreHook)(e);return function(){return t().dispatch}}i.useDispatch=r()},{"../components/Context":236,"./useStore":250}],248:[function(e,t,o){!function(n){!function(){o.__esModule=!0,o.useReduxContext=function(){var e=(0,t.useContext)(i.ReactReduxContext);if("production"===n.env.NODE_ENV||e)return e;throw new Error("could not find react-redux context value; please ensure the component is wrapped in a <Provider>")};var t=e("react"),i=e("../components/Context")}.call(this)}.call(this,e("_process"))},{"../components/Context":236,_process:223,react:268}],249:[function(n,e,s){!function(r){!function(){s.__esModule=!0,s.createSelectorHook=e,s.useSelector=void 0;var p=n("react"),t=n("./useReduxContext"),g=n("../utils/Subscription"),f=n("../utils/useIsomorphicLayoutEffect"),i=n("../components/Context"),o=function(e,t){return e===t};function e(e){var n=(e=void 0===e?i.ReactReduxContext:e)===i.ReactReduxContext?t.useReduxContext:function(){return(0,p.useContext)(e)};return function(e,t){if(void 0===t&&(t=o),"production"!==r.env.NODE_ENV){if(!e)throw new Error("You must pass a selector to useSelector");if("function"!=typeof e)throw new Error("You must pass a function as a selector to useSelector");if("function"!=typeof t)throw new Error("You must pass a function as an equality function to useSelector")}var i=n(),e=((e,i,n,t)=>{var o,r,s=(0,p.useReducer)(function(e){return e+1},0)[1],a=(0,p.useMemo)(function(){return(0,g.createSubscription)(n,t)},[n,t]),l=(0,p.useRef)(),c=(0,p.useRef)(),u=(0,p.useRef)(),d=(0,p.useRef)(),h=n.getState();try{r=e===c.current&&h===u.current&&!l.current||(o=e(h),void 0!==d.current&&i(o,d.current))?d.current:o}catch(e){throw l.current&&(e.message+="\nThe error may be correlated with this previous error:\n"+l.current.stack+"\n\n"),e}return(0,f.useIsomorphicLayoutEffect)(function(){c.current=e,u.current=h,d.current=r,l.current=void 0}),(0,f.useIsomorphicLayoutEffect)(function(){function e(){try{var e=n.getState();if(e===u.current)return;var t=c.current(e);if(i(t,d.current))return;d.current=t,u.current=e}catch(e){l.current=e}s()}return a.onStateChange=e,a.trySubscribe(),e(),function(){return a.tryUnsubscribe()}},[n,a]),r})(e,t,i.store,i.subscription);return(0,p.useDebugValue)(e),e}}s.useSelector=e()}.call(this)}.call(this,n("_process"))},{"../components/Context":236,"../utils/Subscription":252,"../utils/useIsomorphicLayoutEffect":258,"./useReduxContext":248,_process:223,react:268}],250:[function(e,t,i){i.__esModule=!0,i.createStoreHook=s,i.useStore=void 0;var n=e("react"),o=e("../components/Context"),r=e("./useReduxContext");function s(e){var t=(e=void 0===e?o.ReactReduxContext:e)===o.ReactReduxContext?r.useReduxContext:function(){return(0,n.useContext)(e)};return function(){return t().store}}i.useStore=s()},{"../components/Context":236,"./useReduxContext":248,react:268}],251:[function(e,t,i){var n={batch:i.__esModule=!0},o=e("./exports"),r=(Object.keys(o).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(n,e)||e in i&&i[e]===o[e]||(i[e]=o[e])}),e("./utils/reactBatchedUpdates"));i.batch=r.unstable_batchedUpdates,(0,e("./utils/batch").setBatch)(r.unstable_batchedUpdates)},{"./exports":246,"./utils/batch":253,"./utils/reactBatchedUpdates":256}],252:[function(e,t,i){i.__esModule=!0,i.createSubscription=function(t,i){var r,s=o;function a(){e.onStateChange&&e.onStateChange()}function n(){var e,n,o;r||(r=i?i.addNestedSub(a):t.subscribe(a),e=(0,l.getBatch)(),o=n=null,s={clear:function(){o=n=null},notify:function(){e(function(){for(var e=n;e;)e.callback(),e=e.next})},get:function(){for(var e=[],t=n;t;)e.push(t),t=t.next;return e},subscribe:function(e){var t=!0,i=o={callback:e,next:null,prev:o};return i.prev?i.prev.next=i:n=i,function(){t&&null!==n&&(t=!1,i.next?i.next.prev=i.prev:o=i.prev,i.prev?i.prev.next=i.next:n=i.next)}}})}var e={addNestedSub:function(e){return n(),s.subscribe(e)},notifyNestedSubs:function(){s.notify()},handleChangeWrapper:a,isSubscribed:function(){return Boolean(r)},trySubscribe:n,tryUnsubscribe:function(){r&&(r(),r=void 0,s.clear(),s=o)},getListeners:function(){return s}};return e};var l=e("./batch");var o={notify:function(){},get:function(){return[]}}},{"./batch":253}],253:[function(e,t,i){i.__esModule=!0,i.setBatch=i.getBatch=void 0;var n=function(e){e()};i.setBatch=function(e){return n=e};i.getBatch=function(){return n}},{}],254:[function(e,t,i){i.__esModule=!0,i.default=function(i,n){var e,o={};for(e in i)(e=>{var t=i[e];"function"==typeof t&&(o[e]=function(){return n(t.apply(void 0,arguments))})})(e);return o}},{}],255:[function(e,t,i){i.__esModule=!0,i.default=function(e){if("object"!=typeof e||null===e)return!1;e=Object.getPrototypeOf(e);if(null===e)return!0;var t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return e===t}},{}],256:[function(e,t,i){i.__esModule=!0,i.unstable_batchedUpdates=void 0;e=e("react-dom");i.unstable_batchedUpdates=e.unstable_batchedUpdates},{"react-dom":232}],257:[function(e,t,i){function r(e,t){return e===t?0!==e||0!==t||1/e==1/t:e!=e&&t!=t}i.__esModule=!0,i.default=function(e,t){if(!r(e,t)){if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(var o=0;o<i.length;o++)if(!Object.prototype.hasOwnProperty.call(t,i[o])||!r(e[i[o]],t[i[o]]))return!1}return!0}},{}],258:[function(e,t,i){i.__esModule=!0,i.useIsomorphicLayoutEffect=void 0;e=e("react"),e="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?e.useLayoutEffect:e.useEffect;i.useIsomorphicLayoutEffect=e},{react:268}],259:[function(e,t,i){var n=e("@babel/runtime/helpers/interopRequireDefault").default,o=(i.__esModule=!0,i.default=function(e,t,i){(0,o.default)(e)||(0,r.default)(i+"() in "+t+" must return a plain object. Instead received "+e+".")},n(e("./isPlainObject"))),r=n(e("./warning"))},{"./isPlainObject":255,"./warning":260,"@babel/runtime/helpers/interopRequireDefault":206}],260:[function(e,t,i){i.__esModule=!0,i.default=function(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e);try{throw new Error(e)}catch(e){}}},{}],261:[function(e,t,N){!function(A){!function(){function t(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case o:var i=e.type;switch(i){case s:case l:case a:case h:case p:return i;default:var n=i&&i.$$typeof;switch(n){case u:case d:case f:case g:case c:return n;default:return t}}case r:return t}}}var o,r,s,a,l,c,u,d,h,p,g,f,i,n,m,b,_,e,y,v,T,E,k,C,I,w,S,x,R,O;"production"!==A.env.NODE_ENV&&(o=60103,r=60106,s=60107,a=60108,l=60114,c=60109,u=60110,d=60112,h=60113,p=60120,g=60115,f=60116,i=60121,n=60122,m=60117,b=60129,_=60131,"function"==typeof Symbol&&Symbol.for&&(o=(e=Symbol.for)("react.element"),r=e("react.portal"),s=e("react.fragment"),a=e("react.strict_mode"),l=e("react.profiler"),c=e("react.provider"),u=e("react.context"),d=e("react.forward_ref"),h=e("react.suspense"),p=e("react.suspense_list"),g=e("react.memo"),f=e("react.lazy"),i=e("react.block"),n=e("react.server.block"),m=e("react.fundamental"),e("react.scope"),e("react.opaque.id"),b=e("react.debug_trace_mode"),e("react.offscreen"),_=e("react.legacy_hidden")),e=u,y=c,v=o,T=d,E=s,k=f,C=g,I=r,w=l,S=a,x=h,O=R=!1,N.ContextConsumer=e,N.ContextProvider=y,N.Element=v,N.ForwardRef=T,N.Fragment=E,N.Lazy=k,N.Memo=C,N.Portal=I,N.Profiler=w,N.StrictMode=S,N.Suspense=x,N.isAsyncMode=function(e){return R||(R=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 18+.")),!1},N.isConcurrentMode=function(e){return O||(O=!0,console.warn("The ReactIs.isConcurrentMode() alias has been deprecated, and will be removed in React 18+.")),!1},N.isContextConsumer=function(e){return t(e)===u},N.isContextProvider=function(e){return t(e)===c},N.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===o},N.isForwardRef=function(e){return t(e)===d},N.isFragment=function(e){return t(e)===s},N.isLazy=function(e){return t(e)===f},N.isMemo=function(e){return t(e)===g},N.isPortal=function(e){return t(e)===r},N.isProfiler=function(e){return t(e)===l},N.isStrictMode=function(e){return t(e)===a},N.isSuspense=function(e){return t(e)===h},N.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===s||e===l||e===b||e===a||e===h||e===p||e===_||"object"==typeof e&&null!==e&&(e.$$typeof===f||e.$$typeof===g||e.$$typeof===c||e.$$typeof===u||e.$$typeof===d||e.$$typeof===m||e.$$typeof===i||e[0]===n)},N.typeOf=t)}.call(this)}.call(this,e("_process"))},{_process:223}],262:[function(e,t,i){var n=60103,o=60106,r=60107,s=60108,a=60114,l=60109,c=60110,u=60112,d=60113,h=60120,p=60115,g=60116,f=60121,m=60122,b=60117,_=60129,y=60131;function v(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case n:switch(e=e.type){case r:case a:case s:case d:case h:return e;default:switch(e=e&&e.$$typeof){case c:case u:case g:case p:case l:return e;default:return t}}case o:return t}}}"function"==typeof Symbol&&Symbol.for&&(n=(T=Symbol.for)("react.element"),o=T("react.portal"),r=T("react.fragment"),s=T("react.strict_mode"),a=T("react.profiler"),l=T("react.provider"),c=T("react.context"),u=T("react.forward_ref"),d=T("react.suspense"),h=T("react.suspense_list"),p=T("react.memo"),g=T("react.lazy"),f=T("react.block"),m=T("react.server.block"),b=T("react.fundamental"),_=T("react.debug_trace_mode"),y=T("react.legacy_hidden"));var T=l,E=n,k=u,C=r,I=g,w=p,S=o,x=a,R=s,O=d;i.ContextConsumer=c,i.ContextProvider=T,i.Element=E,i.ForwardRef=k,i.Fragment=C,i.Lazy=I,i.Memo=w,i.Portal=S,i.Profiler=x,i.StrictMode=R,i.Suspense=O,i.isAsyncMode=function(){return!1},i.isConcurrentMode=function(){return!1},i.isContextConsumer=function(e){return v(e)===c},i.isContextProvider=function(e){return v(e)===l},i.isElement=function(e){return"object"==typeof e&&null!==e&&e.$$typeof===n},i.isForwardRef=function(e){return v(e)===u},i.isFragment=function(e){return v(e)===r},i.isLazy=function(e){return v(e)===g},i.isMemo=function(e){return v(e)===p},i.isPortal=function(e){return v(e)===o},i.isProfiler=function(e){return v(e)===a},i.isStrictMode=function(e){return v(e)===s},i.isSuspense=function(e){return v(e)===d},i.isValidElementType=function(e){return"string"==typeof e||"function"==typeof e||e===r||e===a||e===_||e===s||e===d||e===h||e===y||"object"==typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===p||e.$$typeof===l||e.$$typeof===c||e.$$typeof===u||e.$$typeof===b||e.$$typeof===f||e[0]===m)},i.typeOf=v},{}],263:[function(t,i,e){!function(e){!function(){"production"===e.env.NODE_ENV?i.exports=t("./cjs/react-is.production.min.js"):i.exports=t("./cjs/react-is.development.js")}.call(this)}.call(this,t("_process"))},{"./cjs/react-is.development.js":261,"./cjs/react-is.production.min.js":262,_process:223}],264:[function(pe,e,ge){!function(he){!function(){function m(e){for(var t=arguments.length,i=new Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var o="error",r=i,s=c.ReactDebugCurrentFrame.getStackAddendum();""!==s&&(e+="%s",r=r.concat([s])),(s=r.map(function(e){return""+e})).unshift("Warning: "+e),Function.prototype.apply.call(console[o],console,s)}function r(e){return e.displayName||"Context"}function b(e){if(null!=e){if("number"==typeof e.tag&&m("Received an unexpected object in getComponentName(). This is likely a bug in React. Please file an issue."),"function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case ge.Fragment:return"Fragment";case n:return"Portal";case T:return"Profiler";case v:return"StrictMode";case I:return"Suspense";case w:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case k:return r(e)+".Consumer";case E:return r(e._context)+".Provider";case C:return t=e.render,i="ForwardRef",t=t.displayName||t.name||"",e.displayName||(""!==t?i+"("+t+")":i);case S:return b(e.type);case R:return b(e._render);case x:t=e._payload,i=e._init;try{return b(i(t))}catch(e){return null}}var t,i}return null}function U(){}function h(e){if(void 0===i)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);i=t&&t[1]||""}return"\n"+i+e}function u(t,e){if(!t||M)return"";var i,n=$.get(t);if(void 0!==n)return n;M=!0;var o,r,n=Error.prepareStackTrace;Error.prepareStackTrace=void 0,o=D.current,D.current=null,0===f&&(q=console.log,J=console.info,Z=console.warn,Q=console.error,ee=console.group,te=console.groupCollapsed,ie=console.groupEnd,r={configurable:!0,enumerable:!0,value:U,writable:!0},Object.defineProperties(console,{info:r,log:r,warn:r,error:r,group:r,groupCollapsed:r,groupEnd:r})),f++;try{if(e){var s=function(){throw Error()};if(Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(s,[])}catch(e){i=e}Reflect.construct(t,[],s)}else{try{s.call()}catch(e){i=e}t.call(s.prototype)}}else{try{throw Error()}catch(e){i=e}t()}}catch(e){if(e&&i&&"string"==typeof e.stack){for(var a,l=e.stack.split("\n"),c=i.stack.split("\n"),u=l.length-1,d=c.length-1;1<=u&&0<=d&&l[u]!==c[d];)d--;for(;1<=u&&0<=d;u--,d--)if(l[u]!==c[d]){if(1!==u||1!==d)do{if(u--,--d<0||l[u]!==c[d])return a="\n"+l[u].replace(" at new "," at "),"function"==typeof t&&$.set(t,a),a}while(1<=u&&0<=d);break}}}finally{M=!1,D.current=o,0===--f&&(r={configurable:!0,enumerable:!0,writable:!0},Object.defineProperties(console,{log:g({},r,{value:q}),info:g({},r,{value:J}),warn:g({},r,{value:Z}),error:g({},r,{value:Q}),group:g({},r,{value:ee}),groupCollapsed:g({},r,{value:te}),groupEnd:g({},r,{value:ie})})),f<0&&m("disabledDepth fell below zero. This is a bug in React. Please file an issue."),Error.prepareStackTrace=n}e=t?t.displayName||t.name:"",s=e?h(e):"";return"function"==typeof t&&$.set(t,s),s}function d(e){return u(e,!1)}function s(e,t,i){if(null!=e){if("function"==typeof e)return u(e,!(!(n=(n=e).prototype)||!n.isReactComponent));var n;if("string"==typeof e)return h(e);switch(e){case I:return h("Suspense");case w:return h("SuspenseList")}if("object"==typeof e)switch(e.$$typeof){case C:return d(e.render);case S:return s(e.type,t,i);case R:return d(e._render);case x:var o=e._payload,r=e._init;try{return s(r(o),t,i)}catch(e){}}}return""}function p(e){var t;e?(t=e._owner,e=s(e.type,e._source,t?t.type:null),ne.setExtraStackFrame(e)):ne.setExtraStackFrame(null)}function H(e,t,i,n,o){var r,s,a,l,c={},u=null,d=null;for(r in void 0!==i&&(u=""+i),(e=>{if(F.call(e,"key")){var t=Object.getOwnPropertyDescriptor(e,"key").get;if(t&&t.isReactWarning)return}return void 0!==e.key})(t)&&(u=""+t.key),(e=>{if(F.call(e,"ref")){var t=Object.getOwnPropertyDescriptor(e,"ref").get;if(t&&t.isReactWarning)return}return void 0!==e.ref})(t)&&(d=t.ref,i=o,"string"==typeof(l=t).ref)&&B.current&&i&&B.current.stateNode!==i&&(i=b(B.current.type),ae[i]||(m('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',b(B.current.type),l.ref),ae[i]=!0)),t)F.call(t,r)&&!se.hasOwnProperty(r)&&(c[r]=t[r]);if(e&&e.defaultProps){var h=e.defaultProps;for(r in h)void 0===c[r]&&(c[r]=h[r])}return(u||d)&&(l="function"==typeof e?e.displayName||e.name||"Unknown":e,u&&(i=c,a=l,g.isReactWarning=!0,Object.defineProperty(i,"key",{get:g,configurable:!0})),d)&&(i=c,s=l,p.isReactWarning=!0,Object.defineProperty(i,"ref",{get:p,configurable:!0})),le(e,u,d,o,n,B.current,c);function p(){re||(re=!0,m("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",s))}function g(){oe||(oe=!0,m("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",a))}}function _(e){var t;e?(t=e._owner,e=s(e.type,e._source,t?t.type:null),ce.setExtraStackFrame(e)):ce.setExtraStackFrame(null)}function a(e){return"object"==typeof e&&null!==e&&e.$$typeof===y}function G(){if(o.current){var e=b(o.current.type);if(e)return"\n\nCheck the render method of `"+e+"`."}return""}function V(e,t){var i;!e._store||e._store.validated||null!=e.key||(e._store.validated=!0,t=t,(i=G())||(t="string"==typeof t?t:t.displayName||t.name)&&(i="\n\nCheck the top-level render call using <"+t+">."),de[t=i])||(de[t]=!0,i="",e&&e._owner&&e._owner!==o.current&&(i=" It was passed a child from "+b(e._owner.type)+"."),_(e),m('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',t,i),_(null))}function j(e,t){if("object"==typeof e)if(Array.isArray(e))for(var i=0;i<e.length;i++){var n=e[i];a(n)&&V(n,t)}else if(a(e))e._store&&(e._store.validated=!0);else if(e){s=null!==(s=e)&&"object"==typeof s&&"function"==typeof(s=l&&s[l]||s[K])?s:null;if("function"==typeof s&&s!==e.entries)for(var o,r=s.call(e);!(o=r.next()).done;)a(o.value)&&V(o.value,t)}var s}function W(e){var t,i=e.type;if(null!=i&&"string"!=typeof i&&("function"==typeof i||"object"==typeof i&&(i.$$typeof===C||i.$$typeof===S))){if(t=i.propTypes){var n,o=b(i),r=t,s=e.props,a="prop",l=o,c=e,u=Function.call.bind(Object.prototype.hasOwnProperty);for(n in r)if(u(r,n)){var d,h=void 0;try{if("function"!=typeof r[n])throw(d=Error((l||"React class")+": "+a+" type `"+n+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof r[n]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.")).name="Invariant Violation",d;h=r[n](s,n,l,a,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(e){h=e}!h||h instanceof Error||(p(c),m("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",l||"React class",a,n,typeof h),p(null)),h instanceof Error&&!(h.message in P)&&(P[h.message]=!0,p(c),m("Failed %s type: %s",a,h.message),p(null))}}else void 0===i.PropTypes||ue||(ue=!0,m("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",b(i)||"Unknown"));"function"!=typeof i.getDefaultProps||i.getDefaultProps.isReactClassApproved||m("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function z(e,t,i,n,o,r){var s,a,l="string"==typeof(l=e)||"function"==typeof l||!(l!==ge.Fragment&&l!==T&&l!==N&&l!==v&&l!==I&&l!==w&&l!==L&&!X)||"object"==typeof l&&null!==l&&(l.$$typeof===x||l.$$typeof===S||l.$$typeof===E||l.$$typeof===k||l.$$typeof===C||l.$$typeof===A||l.$$typeof===R||l[0]===O),c=(l||(s="",(void 0===e||"object"==typeof e&&null!==e&&0===Object.keys(e).length)&&(s+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports."),s+=(void 0!==(c=o)?"\n\nCheck your code at "+c.fileName.replace(/^.*[\\\/]/,"")+":"+c.lineNumber+".":"")||G(),null===e?a="null":Array.isArray(e)?a="array":void 0!==e&&e.$$typeof===y?(a="<"+(b(e.type)||"Unknown")+" />",s=" Did you accidentally export a JSX literal instead of a component?"):a=typeof e,m("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",a,s)),H(e,t,i,o,r));if(null!=c){if(l){var u=t.children;if(void 0!==u)if(n)if(Array.isArray(u)){for(var d=0;d<u.length;d++)j(u[d],e);Object.freeze&&Object.freeze(u)}else m("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else j(u,e)}if(e===ge.Fragment){for(var h=c,p=Object.keys(h.props),g=0;g<p.length;g++){var f=p[g];if("children"!==f&&"key"!==f){_(h),m("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",f),_(null);break}}null!==h.ref&&(_(h),m("Invalid attribute `ref` supplied to `React.Fragment`."),_(null))}else W(c)}return c}function t(e,t,i){return z(e,t,i,!0)}var e,Y,g,y,n,v,T,E,k,C,I,w,S,x,R,O,A,N,L,l,K,c,X,q,J,Z,Q,ee,te,ie,f,i,D,M,$,P,ne,oe,re,B,F,se,ae,le,o,ce,ue,de;"production"!==he.env.NODE_ENV&&(Y=pe("react"),g=pe("object-assign"),y=60103,n=60106,ge.Fragment=60107,v=60108,T=60114,E=60109,k=60110,C=60112,I=60113,w=60120,S=60115,x=60116,R=60121,O=60122,A=60117,N=60129,L=60131,"function"==typeof Symbol&&Symbol.for&&(y=(e=Symbol.for)("react.element"),n=e("react.portal"),ge.Fragment=e("react.fragment"),v=e("react.strict_mode"),T=e("react.profiler"),E=e("react.provider"),k=e("react.context"),C=e("react.forward_ref"),I=e("react.suspense"),w=e("react.suspense_list"),S=e("react.memo"),x=e("react.lazy"),R=e("react.block"),O=e("react.server.block"),A=e("react.fundamental"),e("react.scope"),e("react.opaque.id"),N=e("react.debug_trace_mode"),e("react.offscreen"),L=e("react.legacy_hidden")),l="function"==typeof Symbol&&Symbol.iterator,K="@@iterator",c=Y.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,X=!1,f=0,D=c.ReactCurrentDispatcher,M=!(U.__reactDisabledLog=!0),$=new("function"==typeof WeakMap?WeakMap:Map),P={},ne=c.ReactDebugCurrentFrame,B=c.ReactCurrentOwner,F=Object.prototype.hasOwnProperty,se={key:!0,ref:!0,__self:!0,__source:!0},ae={},le=function(e,t,i,n,o,r,s){e={$$typeof:y,type:e,key:t,ref:i,props:s,_owner:r,_store:{}};return Object.defineProperty(e._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(e,"_self",{configurable:!1,enumerable:!1,writable:!1,value:n}),Object.defineProperty(e,"_source",{configurable:!1,enumerable:!1,writable:!1,value:o}),Object.freeze&&(Object.freeze(e.props),Object.freeze(e)),e},o=c.ReactCurrentOwner,ce=c.ReactDebugCurrentFrame,ue=!1,de={},ge.jsx=function(e,t,i){return z(e,t,i,!1)},ge.jsxs=t)}.call(this)}.call(this,pe("_process"))},{_process:223,"object-assign":222,react:268}],265:[function(e,t,i){e("object-assign");var n,e=e("react"),a=60103,l=(i.Fragment=60107,"function"==typeof Symbol&&Symbol.for&&(a=(n=Symbol.for)("react.element"),i.Fragment=n("react.fragment")),e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner),c=Object.prototype.hasOwnProperty,u={key:!0,ref:!0,__self:!0,__source:!0};function o(e,t,i){var n,o={},r=null,s=null;for(n in void 0!==i&&(r=""+i),void 0!==t.key&&(r=""+t.key),void 0!==t.ref&&(s=t.ref),t)c.call(t,n)&&!u.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:a,type:e,key:r,ref:s,props:o,_owner:l.current}}i.jsx=o,i.jsxs=o},{"object-assign":222,react:268}],266:[function(Ve,e,je){!function(Ge){!function(){if("production"!==Ge.env.NODE_ENV){var g=Ve("object-assign"),_=60103,y=60106,s=(je.Fragment=60107,je.StrictMode=60108,je.Profiler=60114,60109),a=60110,p=60112,l=(je.Suspense=60113,60120),f=60115,c=60116,u=60121,$=60122,P=60117,B=60129,F=60131,U=("function"==typeof Symbol&&Symbol.for&&(_=(b=Symbol.for)("react.element"),y=b("react.portal"),je.Fragment=b("react.fragment"),je.StrictMode=b("react.strict_mode"),je.Profiler=b("react.profiler"),s=b("react.provider"),a=b("react.context"),p=b("react.forward_ref"),je.Suspense=b("react.suspense"),l=b("react.suspense_list"),f=b("react.memo"),c=b("react.lazy"),u=b("react.block"),$=b("react.server.block"),P=b("react.fundamental"),b("react.scope"),b("react.opaque.id"),B=b("react.debug_trace_mode"),b("react.offscreen"),F=b("react.legacy_hidden")),"function"==typeof Symbol&&Symbol.iterator),H="@@iterator";function G(e){return null!==e&&"object"==typeof e&&"function"==typeof(e=U&&e[U]||e[H])?e:null}var V={current:null},v={current:null},i={},n=null;function j(e){n=e}i.setExtraStackFrame=function(e){n=e},i.getCurrentStack=null;var o={ReactCurrentDispatcher:V,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:v,IsSomeRendererActing:{current:!(i.getStackAddendum=function(){var e="",t=(n&&(e+=n),i.getCurrentStack);return t&&(e+=t()||""),e})},assign:g};function T(e){for(var t=arguments.length,i=new Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];W("warn",e,i)}function E(e){for(var t=arguments.length,i=new Array(1<t?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];W("error",e,i)}function W(e,t,i){var n=o.ReactDebugCurrentFrame.getStackAddendum(),n=(""!==n&&(t+="%s",i=i.concat([n])),i.map(function(e){return""+e}));n.unshift("Warning: "+t),Function.prototype.apply.call(console[e],console,n)}o.ReactDebugCurrentFrame=i;var z={};function r(e,t){var e=e.constructor,e=e&&(e.displayName||e.name)||"ReactClass",i=e+"."+t;z[i]||(E("Can't call %s on a component that is not yet mounted. This is a no-op, but it might indicate a bug in your application. Instead, assign to `this.state` directly or define a `state = {};` class property with the desired state in the %s component.",t,e),z[i]=!0)}var Y={isMounted:function(e){return!1},enqueueForceUpdate:function(e,t,i){r(e,"forceUpdate")},enqueueReplaceState:function(e,t,i,n){r(e,"replaceState")},enqueueSetState:function(e,t,i,n){r(e,"setState")}},d={};function h(e,t,i){this.props=e,this.context=t,this.refs=d,this.updater=i||Y}Object.freeze(d),h.prototype.isReactComponent={},h.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},h.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};var e,t={isMounted:["isMounted","Instead, make sure to clean up subscriptions and pending requests in componentWillUnmount to prevent memory leaks."],replaceState:["replaceState","Refactor your code to use setState instead (see https://github.com/facebook/react/issues/3236)."]};for(e in t)t.hasOwnProperty(e)&&((e,t)=>{Object.defineProperty(h.prototype,e,{get:function(){T("%s(...) is deprecated in plain JavaScript React classes. %s",t[0],t[1])}})})(e,t[e]);function K(){}function m(e,t,i){this.props=e,this.context=t,this.refs=d,this.updater=i||Y}K.prototype=h.prototype;var b=m.prototype=new K;function X(e){return e.displayName||"Context"}function k(e){if(null!=e){if("number"==typeof e.tag&&E("Received an unexpected object in getComponentName(). This is likely a bug in React. Please file an issue."),"function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case je.Fragment:return"Fragment";case y:return"Portal";case je.Profiler:return"Profiler";case je.StrictMode:return"StrictMode";case je.Suspense:return"Suspense";case l:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case a:return X(e)+".Consumer";case s:return X(e._context)+".Provider";case p:return t=e.render,i="ForwardRef",t=t.displayName||t.name||"",e.displayName||(""!==t?i+"("+t+")":i);case f:return k(e.type);case u:return k(e._render);case c:t=e._payload,i=e._init;try{return k(i(t))}catch(e){return null}}var t,i}return null}b.constructor=m,g(b,h.prototype),b.isPureReactComponent=!0;var q,J,C=Object.prototype.hasOwnProperty,Z={key:!0,ref:!0,__self:!0,__source:!0};function Q(e){if(C.call(e,"ref")){var t=Object.getOwnPropertyDescriptor(e,"ref").get;if(t&&t.isReactWarning)return}return void 0!==e.ref}function ee(e){if(C.call(e,"key")){var t=Object.getOwnPropertyDescriptor(e,"key").get;if(t&&t.isReactWarning)return}return void 0!==e.key}var te={},I=function(e,t,i,n,o,r,s){e={$$typeof:_,type:e,key:t,ref:i,props:s,_owner:r,_store:{}};return Object.defineProperty(e._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(e,"_self",{configurable:!1,enumerable:!1,writable:!1,value:n}),Object.defineProperty(e,"_source",{configurable:!1,enumerable:!1,writable:!1,value:o}),Object.freeze&&(Object.freeze(e.props),Object.freeze(e)),e};function ie(e,t,i){var n,o={},r=null,s=null,a=null,l=null;if(null!=t)for(n in Q(t)&&(s=t.ref,"string"==typeof(c=t).ref)&&v.current&&c.__self&&v.current.stateNode!==c.__self&&(d=k(v.current.type),te[d]||(E('Component "%s" contains the string ref "%s". Support for string refs will be removed in a future major release. This case cannot be automatically converted to an arrow function. We ask you to manually fix this case by using useRef() or createRef() instead. Learn more about using refs safely here: https://reactjs.org/link/strict-mode-string-ref',d,c.ref),te[d]=!0)),ee(t)&&(r=""+t.key),a=void 0===t.__self?null:t.__self,l=void 0===t.__source?null:t.__source,t)C.call(t,n)&&!Z.hasOwnProperty(n)&&(o[n]=t[n]);var c,u,d,h,p=arguments.length-2;if(1==p)o.children=i;else if(1<p){for(var g=Array(p),f=0;f<p;f++)g[f]=arguments[f+2];Object.freeze&&Object.freeze(g),o.children=g}if(e&&e.defaultProps){var m=e.defaultProps;for(n in m)void 0===o[n]&&(o[n]=m[n])}function b(){J||(J=!0,E("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",u))}function _(){q||(q=!0,E("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",h))}return(r||s)&&(c="function"==typeof e?e.displayName||e.name||"Unknown":e,r&&(d=o,h=c,_.isReactWarning=!0,Object.defineProperty(d,"key",{get:_,configurable:!0})),s)&&(i=o,u=c,b.isReactWarning=!0,Object.defineProperty(i,"ref",{get:b,configurable:!0})),I(e,r,s,a,l,v.current,o)}function w(e){return"object"==typeof e&&null!==e&&e.$$typeof===_}var ne=".",oe=":",re=!1,se=/\/+/g;function ae(e){return e.replace(se,"$&/")}function S(e,t){var i;return"object"==typeof e&&null!==e&&null!=e.key?(e=""+e.key,i={"=":"=0",":":"=2"},"$"+e.replace(/[=:]/g,function(e){return i[e]})):t.toString(36)}function x(e,t,i,n,o){var r,s,a=typeof e,l=!1;if(null===(e="undefined"!=a&&"boolean"!=a?e:null))l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case _:case y:l=!0}}if(l)return h=o(f=e),p=""===n?ne+S(f,0):n,Array.isArray(h)?(r="",x(h,t,r=null!=p?ae(p)+"/":r,"",function(e){return e})):null!=h&&(w(h)&&(f=i+(!(r=h).key||f&&f.key===h.key?"":ae(""+h.key)+"/")+p,h=I(r.type,f,r.ref,r._self,r._source,r._owner,r.props)),t.push(h)),1;var c=0,u=""===n?ne:n+oe;if(Array.isArray(e))for(var d=0;d<e.length;d++)c+=x(s=e[d],t,i,u+S(s,d),o);else{var h,p=G(e);if("function"==typeof p)for(var g,f=e,m=(p===f.entries&&(re||T("Using Maps as children is not supported. Use an array of keyed ReactElements instead."),re=!0),p.call(f)),b=0;!(g=m.next()).done;)c+=x(s=g.value,t,i,u+S(s,b++),o);else if("object"==a)throw h=""+e,Error("Objects are not valid as a React child (found: "+("[object Object]"==h?"object with keys {"+Object.keys(e).join(", ")+"}":h)+"). If you meant to render a collection of children, use an array instead.")}return c}function R(e,t,i){var n;return null==e||(n=0,x(e,e=[],"","",function(e){return t.call(i,e,n++)})),e}var le=-1,ce=0,ue=1,de=2;function he(i){var e,t;if(i._status===le&&(e=(0,i._result)(),(t=i)._status=ce,(t._result=e).then(function(e){var t;i._status===ce&&(void 0===(t=e.default)&&E("lazy: Expected the result of a dynamic import() call. Instead received: %s\n\nYour code should look like: \n  const MyComponent = lazy(() => import('./MyComponent'))",e),(e=i)._status=ue,e._result=t)},function(e){var t;i._status===ce&&((t=i)._status=de,t._result=e)})),i._status===ue)return i._result;throw i._result}var pe=!1;function ge(e){return"string"==typeof e||"function"==typeof e||!(e!==je.Fragment&&e!==je.Profiler&&e!==B&&e!==je.StrictMode&&e!==je.Suspense&&e!==l&&e!==F&&!pe)||"object"==typeof e&&null!==e&&(e.$$typeof===c||e.$$typeof===f||e.$$typeof===s||e.$$typeof===a||e.$$typeof===p||e.$$typeof===P||e.$$typeof===u||e[0]===$)}function O(){var e=V.current;if(null===e)throw Error("Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for one of the following reasons:\n1. You might have mismatching versions of React and the renderer (such as React DOM)\n2. You might be breaking the Rules of Hooks\n3. You might have more than one copy of React in the same app\nSee https://reactjs.org/link/invalid-hook-call for tips about how to debug and fix this problem.");return e}var fe,me,be,_e,ye,ve,Te,A=0;function Ee(){}var ke,Ce=o.ReactCurrentDispatcher;function N(e){if(void 0===ke)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);ke=t&&t[1]||""}return"\n"+ke+e}var Ie=!(Ee.__reactDisabledLog=!0),we=new("function"==typeof WeakMap?WeakMap:Map);function Se(t,e){if(!t||Ie)return"";var i,n=we.get(t);if(void 0!==n)return n;Ie=!0;var o,r,n=Error.prepareStackTrace;Error.prepareStackTrace=void 0,o=Ce.current,Ce.current=null,0===A&&(fe=console.log,me=console.info,be=console.warn,_e=console.error,ye=console.group,ve=console.groupCollapsed,Te=console.groupEnd,r={configurable:!0,enumerable:!0,value:Ee,writable:!0},Object.defineProperties(console,{info:r,log:r,warn:r,error:r,group:r,groupCollapsed:r,groupEnd:r})),A++;try{if(e){var s=function(){throw Error()};if(Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(s,[])}catch(e){i=e}Reflect.construct(t,[],s)}else{try{s.call()}catch(e){i=e}t.call(s.prototype)}}else{try{throw Error()}catch(e){i=e}t()}}catch(e){if(e&&i&&"string"==typeof e.stack){for(var a,l=e.stack.split("\n"),c=i.stack.split("\n"),u=l.length-1,d=c.length-1;1<=u&&0<=d&&l[u]!==c[d];)d--;for(;1<=u&&0<=d;u--,d--)if(l[u]!==c[d]){if(1!==u||1!==d)do{if(u--,--d<0||l[u]!==c[d])return a="\n"+l[u].replace(" at new "," at "),"function"==typeof t&&we.set(t,a),a}while(1<=u&&0<=d);break}}}finally{Ie=!1,Ce.current=o,0===--A&&(r={configurable:!0,enumerable:!0,writable:!0},Object.defineProperties(console,{log:g({},r,{value:fe}),info:g({},r,{value:me}),warn:g({},r,{value:be}),error:g({},r,{value:_e}),group:g({},r,{value:ye}),groupCollapsed:g({},r,{value:ve}),groupEnd:g({},r,{value:Te})})),A<0&&E("disabledDepth fell below zero. This is a bug in React. Please file an issue."),Error.prepareStackTrace=n}e=t?t.displayName||t.name:"",s=e?N(e):"";return"function"==typeof t&&we.set(t,s),s}function xe(e){return Se(e,!1)}function L(e,t,i){if(null!=e){if("function"==typeof e)return Se(e,!(!(n=(n=e).prototype)||!n.isReactComponent));var n;if("string"==typeof e)return N(e);switch(e){case je.Suspense:return N("Suspense");case l:return N("SuspenseList")}if("object"==typeof e)switch(e.$$typeof){case p:return xe(e.render);case f:return L(e.type,t,i);case u:return xe(e._render);case c:var o=e._payload,r=e._init;try{return L(r(o),t,i)}catch(e){}}}return""}var Re={},Oe=o.ReactDebugCurrentFrame;function D(e){var t;e?(t=e._owner,e=L(e.type,e._source,t?t.type:null),Oe.setExtraStackFrame(e)):Oe.setExtraStackFrame(null)}function M(e){var t;e?(t=e._owner,j(L(e.type,e._source,t?t.type:null))):j(null)}function Ae(){if(v.current){var e=k(v.current.type);if(e)return"\n\nCheck the render method of `"+e+"`."}return""}var Ne=!1,Le={};function De(e,t){var i;!e._store||e._store.validated||null!=e.key||(e._store.validated=!0,t=t,(i=Ae())||(t="string"==typeof t?t:t.displayName||t.name)&&(i="\n\nCheck the top-level render call using <"+t+">."),Le[t=i])||(Le[t]=!0,i="",e&&e._owner&&e._owner!==v.current&&(i=" It was passed a child from "+k(e._owner.type)+"."),M(e),E('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',t,i),M(null))}function Me(e,t){if("object"==typeof e)if(Array.isArray(e))for(var i=0;i<e.length;i++){var n=e[i];w(n)&&De(n,t)}else if(w(e))e._store&&(e._store.validated=!0);else if(e){var o=G(e);if("function"==typeof o&&o!==e.entries)for(var r,s=o.call(e);!(r=s.next()).done;)w(r.value)&&De(r.value,t)}}function $e(e){var t,i=e.type;if(null!=i&&"string"!=typeof i&&("function"==typeof i||"object"==typeof i&&(i.$$typeof===p||i.$$typeof===f))){if(t=i.propTypes){var n,o=k(i),r=t,s=e.props,a="prop",l=o,c=e,u=Function.call.bind(Object.prototype.hasOwnProperty);for(n in r)if(u(r,n)){var d,h=void 0;try{if("function"!=typeof r[n])throw(d=Error((l||"React class")+": "+a+" type `"+n+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof r[n]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.")).name="Invariant Violation",d;h=r[n](s,n,l,a,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(e){h=e}!h||h instanceof Error||(D(c),E("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",l||"React class",a,n,typeof h),D(null)),h instanceof Error&&!(h.message in Re)&&(Re[h.message]=!0,D(c),E("Failed %s type: %s",a,h.message),D(null))}}else void 0===i.PropTypes||Ne||(Ne=!0,E("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",k(i)||"Unknown"));"function"!=typeof i.getDefaultProps||i.getDefaultProps.isReactClassApproved||E("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}function Pe(e,t,i){var n,o,r=ge(e),t=(r||(n="",(void 0===e||"object"==typeof e&&null!==e&&0===Object.keys(e).length)&&(n+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports."),n+=(null!=(t=t)&&void 0!==(t=t.__source)?"\n\nCheck your code at "+t.fileName.replace(/^.*[\\\/]/,"")+":"+t.lineNumber+".":"")||Ae(),null===e?o="null":Array.isArray(e)?o="array":void 0!==e&&e.$$typeof===_?(o="<"+(k(e.type)||"Unknown")+" />",n=" Did you accidentally export a JSX literal instead of a component?"):o=typeof e,E("React.createElement: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",o,n)),ie.apply(this,arguments));if(null!=t){if(r)for(var s=2;s<arguments.length;s++)Me(arguments[s],e);if(e===je.Fragment){for(var a=t,l=Object.keys(a.props),c=0;c<l.length;c++){var u=l[c];if("children"!==u&&"key"!==u){M(a),E("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",u),M(null);break}}null!==a.ref&&(M(a),E("Invalid attribute `ref` supplied to `React.Fragment`."),M(null))}else $e(t)}return t}var Be=!1;try{var Fe=Object.freeze({});new Map([[Fe,null]]),new Set([Fe])}catch(e){}function Ue(e,t,i){for(var n=function(e,t,i){if(null==e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n,o,r=g({},e.props),s=e.key,a=e.ref,l=e._self,c=e._source,u=e._owner;if(null!=t)for(n in Q(t)&&(a=t.ref,u=v.current),ee(t)&&(s=""+t.key),e.type&&e.type.defaultProps&&(o=e.type.defaultProps),t)C.call(t,n)&&!Z.hasOwnProperty(n)&&(void 0===t[n]&&void 0!==o?r[n]=o[n]:r[n]=t[n]);var d=arguments.length-2;if(1==d)r.children=i;else if(1<d){for(var h=Array(d),p=0;p<d;p++)h[p]=arguments[p+2];r.children=h}return I(e.type,s,a,l,c,u,r)}.apply(this,arguments),o=2;o<arguments.length;o++)Me(arguments[o],n.type);return $e(n),n}function He(e){var t=Pe.bind(null,e);return t.type=e,Be||(Be=!0,T("React.createFactory() is deprecated and will be removed in a future major release. Consider using JSX or use React.createElement() directly instead.")),Object.defineProperty(t,"type",{enumerable:!1,get:function(){return T("Factory.type is deprecated. Access the class directly before passing it to createFactory."),Object.defineProperty(this,"type",{value:e}),e}}),t}b=Pe,je.Children={map:R,forEach:function(e,t,i){R(e,function(){t.apply(this,arguments)},i)},count:function(e){var t=0;return R(e,function(){t++}),t},toArray:function(e){return R(e,function(e){return e})||[]},only:function(e){if(w(e))return e;throw Error("React.Children.only expected to receive a single React element child.")}},je.Component=h,je.PureComponent=m,je.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=o,je.cloneElement=Ue,je.createContext=function(e,t){void 0===t?t=null:null!==t&&"function"!=typeof t&&E("createContext: Expected the optional second argument to be a function. Instead received: %s",t);var i={$$typeof:a,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null},n=!(i.Provider={$$typeof:s,_context:i}),o=!1,r=!1,t={$$typeof:a,_context:i,_calculateChangedBits:i._calculateChangedBits};return Object.defineProperties(t,{Provider:{get:function(){return o||(o=!0,E("Rendering <Context.Consumer.Provider> is not supported and will be removed in a future major release. Did you mean to render <Context.Provider> instead?")),i.Provider},set:function(e){i.Provider=e}},_currentValue:{get:function(){return i._currentValue},set:function(e){i._currentValue=e}},_currentValue2:{get:function(){return i._currentValue2},set:function(e){i._currentValue2=e}},_threadCount:{get:function(){return i._threadCount},set:function(e){i._threadCount=e}},Consumer:{get:function(){return n||(n=!0,E("Rendering <Context.Consumer.Consumer> is not supported and will be removed in a future major release. Did you mean to render <Context.Consumer> instead?")),i.Consumer}},displayName:{get:function(){return i.displayName},set:function(e){r||(T("Setting `displayName` on Context.Consumer has no effect. You should set it directly on the context with Context.displayName = '%s'.",e),r=!0)}}}),i.Consumer=t,i._currentRenderer=null,i._currentRenderer2=null,i},je.createElement=b,je.createFactory=He,je.createRef=function(){var e={current:null};return Object.seal(e),e},je.forwardRef=function(t){null!=t&&t.$$typeof===f?E("forwardRef requires a render function but received a `memo` component. Instead of forwardRef(memo(...)), use memo(forwardRef(...))."):"function"!=typeof t?E("forwardRef requires a render function but was given %s.",null===t?"null":typeof t):0!==t.length&&2!==t.length&&E("forwardRef render functions accept exactly two parameters: props and ref. %s",1===t.length?"Did you forget to use the ref parameter?":"Any additional parameter will be undefined."),null==t||null==t.defaultProps&&null==t.propTypes||E("forwardRef render functions do not support propTypes or defaultProps. Did you accidentally pass a React component?");var i,e={$$typeof:p,render:t};return Object.defineProperty(e,"displayName",{enumerable:!1,configurable:!0,get:function(){return i},set:function(e){i=e,null==t.displayName&&(t.displayName=e)}}),e},je.isValidElement=w,je.lazy=function(e){var t,i,n={$$typeof:c,_payload:{_status:-1,_result:e},_init:he};return Object.defineProperties(n,{defaultProps:{configurable:!0,get:function(){return t},set:function(e){E("React.lazy(...): It is not supported to assign `defaultProps` to a lazy component import. Either specify them where the component is defined, or create a wrapping component around it."),t=e,Object.defineProperty(n,"defaultProps",{enumerable:!0})}},propTypes:{configurable:!0,get:function(){return i},set:function(e){E("React.lazy(...): It is not supported to assign `propTypes` to a lazy component import. Either specify them where the component is defined, or create a wrapping component around it."),i=e,Object.defineProperty(n,"propTypes",{enumerable:!0})}}}),n},je.memo=function(t,e){ge(t)||E("memo: The first argument must be a component. Instead received: %s",null===t?"null":typeof t);var i,e={$$typeof:f,type:t,compare:void 0===e?null:e};return Object.defineProperty(e,"displayName",{enumerable:!1,configurable:!0,get:function(){return i},set:function(e){i=e,null==t.displayName&&(t.displayName=e)}}),e},je.useCallback=function(e,t){return O().useCallback(e,t)},je.useContext=function(e,t){var i,n=O();return void 0!==t&&E("useContext() second argument is reserved for future use in React. Passing it is not supported. You passed: %s.%s",t,"number"==typeof t&&Array.isArray(arguments[2])?"\n\nDid you call array.map(useContext)? Calling Hooks inside a loop is not supported. Learn more at https://reactjs.org/link/rules-of-hooks":""),void 0!==e._context&&((i=e._context).Consumer===e?E("Calling useContext(Context.Consumer) is not supported, may cause bugs, and will be removed in a future major release. Did you mean to call useContext(Context) instead?"):i.Provider===e&&E("Calling useContext(Context.Provider) is not supported. Did you mean to call useContext(Context) instead?")),n.useContext(e,t)},je.useDebugValue=function(e,t){return O().useDebugValue(e,t)},je.useEffect=function(e,t){return O().useEffect(e,t)},je.useImperativeHandle=function(e,t,i){return O().useImperativeHandle(e,t,i)},je.useLayoutEffect=function(e,t){return O().useLayoutEffect(e,t)},je.useMemo=function(e,t){return O().useMemo(e,t)},je.useReducer=function(e,t,i){return O().useReducer(e,t,i)},je.useRef=function(e){return O().useRef(e)},je.useState=function(e){return O().useState(e)},je.version="17.0.2"}}.call(this)}.call(this,Ve("_process"))},{_process:223,"object-assign":222}],267:[function(e,t,i){var u=e("object-assign"),d=60103,h=60106,n=(i.Fragment=60107,i.StrictMode=60108,i.Profiler=60114,60109),o=60110,r=60112,s=(i.Suspense=60113,60115),a=60116,p=("function"==typeof Symbol&&Symbol.for&&(d=(e=Symbol.for)("react.element"),h=e("react.portal"),i.Fragment=e("react.fragment"),i.StrictMode=e("react.strict_mode"),i.Profiler=e("react.profiler"),n=e("react.provider"),o=e("react.context"),r=e("react.forward_ref"),i.Suspense=e("react.suspense"),s=e("react.memo"),a=e("react.lazy")),"function"==typeof Symbol&&Symbol.iterator);function g(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},c={};function f(e,t,i){this.props=e,this.context=t,this.refs=c,this.updater=i||l}function m(){}function b(e,t,i){this.props=e,this.context=t,this.refs=c,this.updater=i||l}f.prototype.isReactComponent={},f.prototype.setState=function(e,t){if("object"!=typeof e&&"function"!=typeof e&&null!=e)throw Error(g(85));this.updater.enqueueSetState(this,e,t,"setState")},f.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},m.prototype=f.prototype;var e=b.prototype=new m,_=(e.constructor=b,u(e,f.prototype),e.isPureReactComponent=!0,{current:null}),y=Object.prototype.hasOwnProperty,v={key:!0,ref:!0,__self:!0,__source:!0};function T(e,t,i){var n,o={},r=null,s=null;if(null!=t)for(n in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(r=""+t.key),t)y.call(t,n)&&!v.hasOwnProperty(n)&&(o[n]=t[n]);var a=arguments.length-2;if(1===a)o.children=i;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];o.children=l}if(e&&e.defaultProps)for(n in a=e.defaultProps)void 0===o[n]&&(o[n]=a[n]);return{$$typeof:d,type:e,key:r,ref:s,props:o,_owner:_.current}}function E(e){return"object"==typeof e&&null!==e&&e.$$typeof===d}var k=/\/+/g;function C(e,t){return"object"==typeof e&&null!==e&&null!=e.key?(e=""+e.key,i={"=":"=0",":":"=2"},"$"+e.replace(/[=:]/g,function(e){return i[e]})):t.toString(36);var i}function I(e,t,i,n,o){var r,s,a=!1;if(null===(e="undefined"!==(c=typeof e)&&"boolean"!==c?e:null))a=!0;else switch(c){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case d:case h:a=!0}}if(a)return o=o(a=e),e=""===n?"."+C(a,0):n,Array.isArray(o)?(i="",I(o,t,i=null!=e?e.replace(k,"$&/")+"/":i,"",function(e){return e})):null!=o&&(E(o)&&(s=i+(!(r=o).key||a&&a.key===o.key?"":(""+o.key).replace(k,"$&/")+"/")+e,o={$$typeof:d,type:r.type,key:s,ref:r.ref,props:r.props,_owner:r._owner}),t.push(o)),1;if(a=0,n=""===n?".":n+":",Array.isArray(e))for(var l=0;l<e.length;l++){var c,u=n+C(c=e[l],l);a+=I(c,t,i,u,o)}else if("function"==typeof(u=null!==(s=e)&&"object"==typeof s&&"function"==typeof(s=p&&s[p]||s["@@iterator"])?s:null))for(e=u.call(e),l=0;!(c=e.next()).done;)a+=I(c=c.value,t,i,u=n+C(c,l++),o);else if("object"===c)throw t=""+e,Error(g(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return a}function w(e,t,i){var n;return null==e||(n=0,I(e,e=[],"","",function(e){return t.call(i,e,n++)})),e}function S(t){var e;if(-1===t._status&&(e=(e=t._result)(),t._status=0,(t._result=e).then(function(e){0===t._status&&(e=e.default,t._status=1,t._result=e)},function(e){0===t._status&&(t._status=2,t._result=e)})),1===t._status)return t._result;throw t._result}var x={current:null};function R(){var e=x.current;if(null===e)throw Error(g(321));return e}e={ReactCurrentDispatcher:x,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:_,IsSomeRendererActing:{current:!1},assign:u};i.Children={map:w,forEach:function(e,t,i){w(e,function(){t.apply(this,arguments)},i)},count:function(e){var t=0;return w(e,function(){t++}),t},toArray:function(e){return w(e,function(e){return e})||[]},only:function(e){if(E(e))return e;throw Error(g(143))}},i.Component=f,i.PureComponent=b,i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=e,i.cloneElement=function(e,t,i){if(null==e)throw Error(g(267,e));var n=u({},e.props),o=e.key,r=e.ref,s=e._owner;if(null!=t)for(a in void 0!==t.ref&&(r=t.ref,s=_.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps&&(l=e.type.defaultProps),t)y.call(t,a)&&!v.hasOwnProperty(a)&&(n[a]=(void 0===t[a]&&void 0!==l?l:t)[a]);var a=arguments.length-2;if(1===a)n.children=i;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];n.children=l}return{$$typeof:d,type:e.type,key:o,ref:r,props:n,_owner:s}},i.createContext=function(e,t){return(e={$$typeof:o,_calculateChangedBits:t=void 0===t?null:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:n,_context:e},e.Consumer=e},i.createElement=T,i.createFactory=function(e){var t=T.bind(null,e);return t.type=e,t},i.createRef=function(){return{current:null}},i.forwardRef=function(e){return{$$typeof:r,render:e}},i.isValidElement=E,i.lazy=function(e){return{$$typeof:a,_payload:{_status:-1,_result:e},_init:S}},i.memo=function(e,t){return{$$typeof:s,type:e,compare:void 0===t?null:t}},i.useCallback=function(e,t){return R().useCallback(e,t)},i.useContext=function(e,t){return R().useContext(e,t)},i.useDebugValue=function(){},i.useEffect=function(e,t){return R().useEffect(e,t)},i.useImperativeHandle=function(e,t,i){return R().useImperativeHandle(e,t,i)},i.useLayoutEffect=function(e,t){return R().useLayoutEffect(e,t)},i.useMemo=function(e,t){return R().useMemo(e,t)},i.useReducer=function(e,t,i){return R().useReducer(e,t,i)},i.useRef=function(e){return R().useRef(e)},i.useState=function(e){return R().useState(e)},i.version="17.0.2"},{"object-assign":222}],268:[function(t,i,e){!function(e){!function(){"production"===e.env.NODE_ENV?i.exports=t("./cjs/react.production.min.js"):i.exports=t("./cjs/react.development.js")}.call(this)}.call(this,t("_process"))},{"./cjs/react.development.js":266,"./cjs/react.production.min.js":267,_process:223}],269:[function(t,i,e){!function(e){!function(){"production"===e.env.NODE_ENV?i.exports=t("./cjs/react-jsx-runtime.production.min.js"):i.exports=t("./cjs/react-jsx-runtime.development.js")}.call(this)}.call(this,t("_process"))},{"./cjs/react-jsx-runtime.development.js":264,"./cjs/react-jsx-runtime.production.min.js":265,_process:223}],270:[function(l,e,c){!function(I){!function(){function e(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}Object.defineProperty(c,"__esModule",{value:!0});var s=e(l("@babel/runtime/helpers/objectSpread2"));function v(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}function t(){return Math.random().toString(36).substring(7).split("").join(".")}var h="function"==typeof Symbol&&Symbol.observable||"@@observable",T={INIT:"@@redux/INIT"+t(),REPLACE:"@@redux/REPLACE"+t(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+t()}};function E(e){if("object"==typeof e&&null!==e){for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}}function i(e){if(void 0===e)return"undefined";if(null===e)return"null";var t=typeof e;switch(t){case"boolean":case"string":case"number":case"symbol":case"function":return t}if(Array.isArray(e))return"array";if((i=e)instanceof Date||"function"==typeof i.toDateString&&"function"==typeof i.getDate&&"function"==typeof i.setDate)return"date";if((i=e)instanceof Error||"string"==typeof i.message&&i.constructor&&"number"==typeof i.constructor.stackTraceLimit)return"error";var i,n="function"==typeof(i=e).constructor?i.constructor.name:null;switch(n){case"Symbol":case"Promise":case"WeakMap":case"WeakSet":case"Map":case"Set":return n}return t.slice(8,-1).toLowerCase().replace(/\s/g,"")}function k(e){var t=typeof e;return t="production"!==I.env.NODE_ENV?i(e):t}function p(e,t,i){if("function"==typeof t&&"function"==typeof i||"function"==typeof i&&"function"==typeof arguments[3])throw new Error("production"===I.env.NODE_ENV?v(0):"It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function. See https://redux.js.org/tutorials/fundamentals/part-4-store#creating-a-store-with-enhancers for an example.");if("function"==typeof t&&void 0===i&&(i=t,t=void 0),void 0!==i){if("function"!=typeof i)throw new Error("production"===I.env.NODE_ENV?v(1):"Expected the enhancer to be a function. Instead, received: '"+k(i)+"'");return i(p)(e,t)}if("function"!=typeof e)throw new Error("production"===I.env.NODE_ENV?v(2):"Expected the root reducer to be a function. Instead, received: '"+k(e)+"'");var n=e,o=t,r=[],s=r,a=!1;function l(){s===r&&(s=r.slice())}function c(){if(a)throw new Error("production"===I.env.NODE_ENV?v(3):"You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return o}function u(t){if("function"!=typeof t)throw new Error("production"===I.env.NODE_ENV?v(4):"Expected the listener to be a function. Instead, received: '"+k(t)+"'");if(a)throw new Error("production"===I.env.NODE_ENV?v(5):"You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api/store#subscribelistener for more details.");var i=!0;return l(),s.push(t),function(){if(i){if(a)throw new Error("production"===I.env.NODE_ENV?v(6):"You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api/store#subscribelistener for more details.");i=!1,l();var e=s.indexOf(t);s.splice(e,1),r=null}}}function d(e){if(!E(e))throw new Error("production"===I.env.NODE_ENV?v(7):"Actions must be plain objects. Instead, the actual type was: '"+k(e)+"'. You may need to add middleware to your store setup to handle dispatching other values, such as 'redux-thunk' to handle dispatching functions. See https://redux.js.org/tutorials/fundamentals/part-4-store#middleware and https://redux.js.org/tutorials/fundamentals/part-6-async-logic#using-the-redux-thunk-middleware for examples.");if(void 0===e.type)throw new Error("production"===I.env.NODE_ENV?v(8):'Actions may not have an undefined "type" property. You may have misspelled an action type string constant.');if(a)throw new Error("production"===I.env.NODE_ENV?v(9):"Reducers may not dispatch actions.");try{a=!0,o=n(o,e)}finally{a=!1}for(var t=r=s,i=0;i<t.length;i++)(0,t[i])();return e}return d({type:T.INIT}),(i={dispatch:d,subscribe:u,getState:c,replaceReducer:function(e){if("function"!=typeof e)throw new Error("production"===I.env.NODE_ENV?v(10):"Expected the nextReducer to be a function. Instead, received: '"+k(e));n=e,d({type:T.REPLACE})}})[h]=function(){var i=u,e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error("production"===I.env.NODE_ENV?v(11):"Expected the observer to be an object. Instead, received: '"+k(e)+"'");function t(){e.next&&e.next(c())}return t(),{unsubscribe:i(t)}}};return e[h]=function(){return this},e},i}var n=p;function C(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e);try{throw new Error(e)}catch(e){}}function r(e,t){return function(){return t(e.apply(this,arguments))}}function a(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function o(){}"production"!==I.env.NODE_ENV&&"string"==typeof o.name&&"isCrushed"!==o.name&&C('You are currently using minified code outside of NODE_ENV === "production". This means that you are running a slower development build of Redux. You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify or setting mode to production in webpack (https://webpack.js.org/concepts/mode/) to ensure you have the correct code for your production build.'),c.__DO_NOT_USE__ActionTypes=T,c.applyMiddleware=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return function(o){return function(){var e=o.apply(void 0,arguments),t=function(){throw new Error("production"===I.env.NODE_ENV?v(15):"Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},i={getState:e.getState,dispatch:function(){return t.apply(void 0,arguments)}},n=r.map(function(e){return e(i)}),t=a.apply(void 0,n)(e.dispatch);return s.default(s.default({},e),{},{dispatch:t})}}},c.bindActionCreators=function(e,t){if("function"==typeof e)return r(e,t);if("object"!=typeof e||null===e)throw new Error("production"===I.env.NODE_ENV?v(16):"bindActionCreators expected an object or a function, but instead received: '"+k(e)+'\'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var i,n={};for(i in e){var o=e[i];"function"==typeof o&&(n[i]=r(o,t))}return n},c.combineReducers=function(e){for(var t=Object.keys(e),m={},i=0;i<t.length;i++){var n=t[i];"production"!==I.env.NODE_ENV&&void 0===e[n]&&C('No reducer provided for key "'+n+'"'),"function"==typeof e[n]&&(m[n]=e[n])}var b,_,o,y=Object.keys(m);"production"!==I.env.NODE_ENV&&(b={});try{o=m,Object.keys(o).forEach(function(e){var t=o[e];if(void 0===t(void 0,{type:T.INIT}))throw new Error("production"===I.env.NODE_ENV?v(12):'The slice reducer for key "'+e+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===t(void 0,{type:T.PROBE_UNKNOWN_ACTION()}))throw new Error("production"===I.env.NODE_ENV?v(13):'The slice reducer for key "'+e+"\" returned undefined when probed with a random type. Don't try to handle '"+T.INIT+'\' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}catch(e){_=e}return function(e,t){if(void 0===e&&(e={}),_)throw _;"production"!==I.env.NODE_ENV&&(i=e,n=m,o=t,r=b,a=Object.keys(n),l=o&&o.type===T.INIT?"preloadedState argument passed to createStore":"previous state received by the reducer",o=0===a.length?"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.":E(i)?((s=Object.keys(i).filter(function(e){return!n.hasOwnProperty(e)&&!r[e]})).forEach(function(e){r[e]=!0}),(!o||o.type!==T.REPLACE)&&0<s.length?"Unexpected "+(1<s.length?"keys":"key")+' "'+s.join('", "')+'" found in '+l+'. Expected to find one of the known reducer keys instead: "'+a.join('", "')+'". Unexpected keys will be ignored.':void 0):"The "+l+' has unexpected type of "'+k(i)+'". Expected argument to be an object with the following keys: "'+a.join('", "')+'"')&&C(o);for(var i,n,o,r,s,a,l,c=!1,u={},d=0;d<y.length;d++){var h,p=y[d],g=m[p],f=e[p],g=g(f,t);if(void 0===g)throw h=t&&t.type,new Error("production"===I.env.NODE_ENV?v(14):"When called with an action of type "+(h?'"'+String(h)+'"':"(unknown type)")+', the slice reducer for key "'+p+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.');u[p]=g,c=c||g!==f}return(c=c||y.length!==Object.keys(e).length)?u:e}},c.compose=a,c.createStore=p,c.legacy_createStore=n}.call(this)}.call(this,l("_process"))},{"@babel/runtime/helpers/objectSpread2":208,_process:223}],271:[function(e,t,u){!function(c){!function(){function t(t){var i=!1,n=null;if(l.forEach(function(e){try{e.onInteractionTraced(t)}catch(e){i||(i=!0,n=e)}}),i)throw n}function i(t){var i=!1,n=null;if(l.forEach(function(e){try{e.onInteractionScheduledWorkCompleted(t)}catch(e){i||(i=!0,n=e)}}),i)throw n}function n(t,i){var n=!1,o=null;if(l.forEach(function(e){try{e.onWorkScheduled(t,i)}catch(e){n||(n=!0,o=e)}}),n)throw o}function o(t,i){var n=!1,o=null;if(l.forEach(function(e){try{e.onWorkStarted(t,i)}catch(e){n||(n=!0,o=e)}}),n)throw o}function r(t,i){var n=!1,o=null;if(l.forEach(function(e){try{e.onWorkStopped(t,i)}catch(e){n||(n=!0,o=e)}}),n)throw o}function s(t,i){var n=!1,o=null;if(l.forEach(function(e){try{e.onWorkCanceled(t,i)}catch(e){n||(n=!0,o=e)}}),n)throw o}var a,e,l;"production"!==c.env.NODE_ENV&&(e=a=0,u.__interactionsRef=null,u.__subscriberRef=null,u.__interactionsRef={current:new Set},u.__subscriberRef={current:null},l=null,l=new Set,u.unstable_clear=function(e){var t=u.__interactionsRef.current;u.__interactionsRef.current=new Set;try{return e()}finally{u.__interactionsRef.current=t}},u.unstable_getCurrent=function(){return u.__interactionsRef.current},u.unstable_getThreadID=function(){return++e},u.unstable_subscribe=function(e){l.add(e),1===l.size&&(u.__subscriberRef.current={onInteractionScheduledWorkCompleted:i,onInteractionTraced:t,onWorkCanceled:s,onWorkScheduled:n,onWorkStarted:o,onWorkStopped:r})},u.unstable_trace=function(e,t,i){var n,o=3<arguments.length&&void 0!==arguments[3]?arguments[3]:0,e={__count:1,id:a++,name:e,timestamp:t},t=u.__interactionsRef.current,r=new Set(t),s=(r.add(e),u.__interactionsRef.current=r,u.__subscriberRef.current);try{null!==s&&s.onInteractionTraced(e)}finally{try{null!==s&&s.onWorkStarted(r,o)}finally{try{n=i()}finally{u.__interactionsRef.current=t;try{null!==s&&s.onWorkStopped(r,o)}finally{e.__count--,null!==s&&0===e.__count&&s.onInteractionScheduledWorkCompleted(e)}}}}return n},u.unstable_unsubscribe=function(e){l.delete(e),0===l.size&&(u.__subscriberRef.current=null)},u.unstable_wrap=function(i){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,o=u.__interactionsRef.current,r=u.__subscriberRef.current,s=(null!==r&&r.onWorkScheduled(o,n),o.forEach(function(e){e.__count++}),!1);function e(){var e,t=u.__interactionsRef.current;u.__interactionsRef.current=o,r=u.__subscriberRef.current;try{try{null!==r&&r.onWorkStarted(o,n)}finally{try{e=i.apply(void 0,arguments)}finally{u.__interactionsRef.current=t,null!==r&&r.onWorkStopped(o,n)}}return e}finally{s||(s=!0,o.forEach(function(e){e.__count--,null!==r&&0===e.__count&&r.onInteractionScheduledWorkCompleted(e)}))}}return e.cancel=function(){r=u.__subscriberRef.current;try{null!==r&&r.onWorkCanceled(o,n)}finally{o.forEach(function(e){e.__count--,r&&0===e.__count&&r.onInteractionScheduledWorkCompleted(e)})}},e})}.call(this)}.call(this,e("_process"))},{_process:223}],272:[function(e,t,i){var n=0;i.__interactionsRef=null,i.__subscriberRef=null,i.unstable_clear=function(e){return e()},i.unstable_getCurrent=function(){return null},i.unstable_getThreadID=function(){return++n},i.unstable_subscribe=function(){},i.unstable_trace=function(e,t,i){return i()},i.unstable_unsubscribe=function(){},i.unstable_wrap=function(e){return e}},{}],273:[function(e,t,B){!function(P){!function(){function s(e,t){for(var i=e.length,n=(e.push(t),e),o=t,r=i;;){var s=r-1>>>1,a=n[s];if(!(void 0!==a&&0<d(a,o)))return;n[s]=o,n[r]=a,r=s}}function a(e){e=e[0];return void 0===e?null:e}function o(e){var t=e[0];if(void 0!==t){var i=e.pop();if(i!==t){e[0]=i;for(var n=e,o=i,r=0,s=n.length;r<s;){var a=2*(r+1)-1,l=n[a],c=1+a,u=n[c];if(void 0!==l&&d(l,o)<0)r=void 0!==u&&d(u,l)<0?(n[r]=u,n[c]=o,c):(n[r]=l,n[a]=o,a);else{if(!(void 0!==u&&d(u,o)<0))return;n[r]=u,n[c]=o,r=c}}}}}function d(e,t){var i=e.sortIndex-t.sortIndex;return 0!=i?i:e.id-t.id}function r(e){for(var t=a(R);null!==t;){if(null===t.callback)o(R);else{if(!(t.startTime<=e))return;o(R),t.sortIndex=t.expirationTime,s(x,t)}t=a(R)}}function l(e){var t;D=!1,r(e),L||(null!==a(x)?(L=!0,f(c)):null!==(t=a(R))&&m(l,t.startTime-e))}function c(e,t){L=!1,D&&(D=!1,b()),N=!0;var i=A;try{if(!S)return n(e,t);try{return n(e,t)}catch(e){throw null!==O&&(B.unstable_now(),O.isQueued=!1),e}}finally{O=null,A=i,N=!1}}function n(e,t){for(r(i=t),O=a(x);null!==O&&!w&&(!(O.expirationTime>i)||e&&!B.unstable_shouldYield());){var i,n=O.callback;"function"==typeof n?(O.callback=null,A=O.priorityLevel,n=n(O.expirationTime<=i),i=B.unstable_now(),"function"==typeof n?O.callback=n:O===a(x)&&o(x),r(i)):o(x),O=a(x)}return null!==O||(null!==(t=a(R))&&m(l,t.startTime-i),!1)}var e,t,i,u,h,p,g,f,m,b,_,y,v,T,E,k,C,I,w,S,x,R,$,O,A,N,L,D,M;"production"!==P.env.NODE_ENV&&(S=w=!1,"object"==typeof performance&&"function"==typeof performance.now?(t=performance,B.unstable_now=function(){return t.now()}):(i=Date,u=i.now(),B.unstable_now=function(){return i.now()-u}),"undefined"==typeof window||"function"!=typeof MessageChannel?(p=h=null,g=function(){if(null!==h)try{var e=B.unstable_now();h(!0,e),h=null}catch(e){throw setTimeout(g,0),e}},f=function(e){null!==h?setTimeout(f,0,e):(h=e,setTimeout(g,0))},m=function(e,t){p=setTimeout(e,t)},b=function(){clearTimeout(p)},B.unstable_shouldYield=function(){return!1},e=B.unstable_forceFrameRate=function(){}):(_=window.setTimeout,y=window.clearTimeout,"undefined"!=typeof console&&(M=window.cancelAnimationFrame,"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof M)&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),v=!1,T=null,E=-1,k=5,C=0,B.unstable_shouldYield=function(){return B.unstable_now()>=C},e=function(){},B.unstable_forceFrameRate=function(e){e<0||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<e?Math.floor(1e3/e):5},M=new MessageChannel,I=M.port2,M.port1.onmessage=function(){if(null!==T){var e=B.unstable_now();C=e+k;try{T(!0,e)?I.postMessage(null):(v=!1,T=null)}catch(e){throw I.postMessage(null),e}}else v=!1},f=function(e){T=e,v||(v=!0,I.postMessage(null))},m=function(e,t){E=_(function(){e(B.unstable_now())},t)},b=function(){y(E),E=-1}),x=[],R=[],$=1,O=null,D=L=N=!(A=3),M=e,B.unstable_IdlePriority=5,B.unstable_ImmediatePriority=1,B.unstable_LowPriority=4,B.unstable_NormalPriority=3,B.unstable_Profiling=null,B.unstable_UserBlockingPriority=2,B.unstable_cancelCallback=function(e){e.callback=null},B.unstable_continueExecution=function(){L||N||(L=!0,f(c))},B.unstable_getCurrentPriorityLevel=function(){return A},B.unstable_getFirstCallbackNode=function(){return a(x)},B.unstable_next=function(e){var t;switch(A){case 1:case 2:case 3:t=3;break;default:t=A}var i=A;A=t;try{return e()}finally{A=i}},B.unstable_pauseExecution=function(){},B.unstable_requestPaint=M,B.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=A;A=e;try{return t()}finally{A=i}},B.unstable_scheduleCallback=function(e,t,i){var n,o=B.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&0<i?o+i:o,e){case 1:n=-1;break;case 2:n=250;break;case 5:n=1073741823;break;case 4:n=1e4;break;default:n=5e3}var r=i+n,t={id:$++,callback:t,priorityLevel:e,startTime:i,expirationTime:r,sortIndex:-1};return o<i?(t.sortIndex=i,s(R,t),null===a(x)&&t===a(R)&&(D?b():D=!0,m(l,i-o))):(t.sortIndex=r,s(x,t),L||N||(L=!0,f(c))),t},B.unstable_wrapCallback=function(t){var i=A;return function(){var e=A;A=i;try{return t.apply(this,arguments)}finally{A=e}}})}.call(this)}.call(this,e("_process"))},{_process:223}],274:[function(M,$,a){var e,t,i,n,o,r,s,l,c,u,d,h,p,g,f,m,b,_;function y(e,t){var i=e.length;for(e.push(t);;){var n=i-1>>>1,o=e[n];if(!(void 0!==o&&0<E(o,t)))break;e[n]=t,e[i]=o,i=n}}function v(e){return void 0===(e=e[0])?null:e}function T(e){var t=e[0];if(void 0!==t){var i=e.pop();if(i!==t){e[0]=i;for(var n=0,o=e.length;n<o;){var r=2*(n+1)-1,s=e[r],a=1+r,l=e[a];if(void 0!==s&&E(s,i)<0)n=void 0!==l&&E(l,s)<0?(e[n]=l,e[a]=i,a):(e[n]=s,e[r]=i,r);else{if(!(void 0!==l&&E(l,i)<0))break;e[n]=l,e[a]=i,n=a}}}}}function E(e,t){var i=e.sortIndex-t.sortIndex;return 0!=i?i:e.id-t.id}"object"==typeof performance&&"function"==typeof performance.now?(t=performance,a.unstable_now=function(){return t.now()}):(i=Date,n=i.now(),a.unstable_now=function(){return i.now()-n}),"undefined"==typeof window||"function"!=typeof MessageChannel?(r=o=null,s=function(){if(null!==o)try{var e=a.unstable_now();o(!0,e),o=null}catch(e){throw setTimeout(s,0),e}},l=function(e){null!==o?setTimeout(l,0,e):(o=e,setTimeout(s,0))},c=function(e,t){r=setTimeout(e,t)},u=function(){clearTimeout(r)},a.unstable_shouldYield=function(){return!1},e=a.unstable_forceFrameRate=function(){}):(d=window.setTimeout,h=window.clearTimeout,"undefined"!=typeof console&&(D=window.cancelAnimationFrame,"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof D)&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),p=!1,g=null,f=-1,m=5,b=0,a.unstable_shouldYield=function(){return a.unstable_now()>=b},e=function(){},a.unstable_forceFrameRate=function(e){e<0||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):m=0<e?Math.floor(1e3/e):5},D=new MessageChannel,_=D.port2,D.port1.onmessage=function(){if(null!==g){var e=a.unstable_now();b=e+m;try{g(!0,e)?_.postMessage(null):(p=!1,g=null)}catch(e){throw _.postMessage(null),e}}else p=!1},l=function(e){g=e,p||(p=!0,_.postMessage(null))},c=function(e,t){f=d(function(){e(a.unstable_now())},t)},u=function(){h(f),f=-1});var k=[],C=[],I=1,w=null,S=3,x=!1,R=!1,O=!1;function A(e){for(var t=v(C);null!==t;){if(null===t.callback)T(C);else{if(!(t.startTime<=e))break;T(C),t.sortIndex=t.expirationTime,y(k,t)}t=v(C)}}function N(e){var t;O=!1,A(e),R||(null!==v(k)?(R=!0,l(L)):null!==(t=v(C))&&c(N,t.startTime-e))}function L(e,t){R=!1,O&&(O=!1,u()),x=!0;var i=S;try{for(A(t),w=v(k);null!==w&&(!(w.expirationTime>t)||e&&!a.unstable_shouldYield());){var n,o=w.callback;"function"==typeof o?(w.callback=null,S=w.priorityLevel,n=o(w.expirationTime<=t),t=a.unstable_now(),"function"==typeof n?w.callback=n:w===v(k)&&T(k),A(t)):T(k),w=v(k)}var r,s=null!==w||(null!==(r=v(C))&&c(N,r.startTime-t),!1);return s}finally{w=null,S=i,x=!1}}var D=e;a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(e){e.callback=null},a.unstable_continueExecution=function(){R||x||(R=!0,l(L))},a.unstable_getCurrentPriorityLevel=function(){return S},a.unstable_getFirstCallbackNode=function(){return v(k)},a.unstable_next=function(e){switch(S){case 1:case 2:case 3:var t=3;break;default:t=S}var i=S;S=t;try{return e()}finally{S=i}},a.unstable_pauseExecution=function(){},a.unstable_requestPaint=D,a.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=S;S=e;try{return t()}finally{S=i}},a.unstable_scheduleCallback=function(e,t,i){var n=a.unstable_now();switch(i="object"==typeof i&&null!==i&&"number"==typeof(i=i.delay)&&0<i?n+i:n,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:I++,callback:t,priorityLevel:e,startTime:i,expirationTime:o=i+o,sortIndex:-1},n<i?(e.sortIndex=i,y(C,e),null===v(k)&&e===v(C)&&(O?u():O=!0,c(N,i-n))):(e.sortIndex=o,y(k,e),R||x||(R=!0,l(L))),e},a.unstable_wrapCallback=function(t){var i=S;return function(){var e=S;S=i;try{return t.apply(this,arguments)}finally{S=e}}}},{}],275:[function(t,i,e){!function(e){!function(){"production"===e.env.NODE_ENV?i.exports=t("./cjs/scheduler.production.min.js"):i.exports=t("./cjs/scheduler.development.js")}.call(this)}.call(this,t("_process"))},{"./cjs/scheduler.development.js":273,"./cjs/scheduler.production.min.js":274,_process:223}],276:[function(t,i,e){!function(e){!function(){"production"===e.env.NODE_ENV?i.exports=t("./cjs/scheduler-tracing.production.min.js"):i.exports=t("./cjs/scheduler-tracing.development.js")}.call(this)}.call(this,t("_process"))},{"./cjs/scheduler-tracing.development.js":271,"./cjs/scheduler-tracing.production.min.js":272,_process:223}]},{},[156]);