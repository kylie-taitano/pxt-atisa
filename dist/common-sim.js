var pxsim;(o=>{var t;(t=o.input||(o.input={})).onGesture=function(t,e){var i=o.accelerometer();i.accelerometer.activate(),11!=t||i.useShake||(i.useShake=!0,o.runtime.queueDisplayUpdate()),o.pxtcore.registerWithDal(13,t,e)},t.rotation=function(t){(s=o.accelerometer().accelerometer).activate();var e=s.getX(o.MicroBitCoordinateSystem.NORTH_EAST_DOWN),i=s.getY(o.MicroBitCoordinateSystem.NORTH_EAST_DOWN),s=s.getZ(o.MicroBitCoordinateSystem.NORTH_EAST_DOWN),a=Math.atan2(i,s),r=Math.atan(-e/(i*Math.sin(a)+s*Math.cos(a)));let n=0;switch(t){case 0:n=r;break;case 1:n=a}return Math.floor(n/Math.PI*180)},t.setAccelerometerRange=function(t){o.accelerometer().accelerometer.setSampleRange(t)},t.acceleration=function(t){var e=o.accelerometer().accelerometer;switch(e.activate(),t){case 0:return e.getX();case 1:return e.getY();case 2:return e.getZ();default:return Math.floor(Math.sqrt(e.instantaneousAccelerationSquared()))}}})(pxsim=pxsim||{}),(a=>{let s;var t;(t=s=a.MicroBitCoordinateSystem||(a.MicroBitCoordinateSystem={}))[t.RAW=0]="RAW",t[t.SIMPLE_CARTESIAN=1]="SIMPLE_CARTESIAN",t[t.NORTH_EAST_DOWN=2]="NORTH_EAST_DOWN";class e{constructor(t){this.runtime=t,this.sigma=0,this.lastGesture=0,this.currentGesture=0,this.sample={x:0,y:0,z:-1023},this.shake={x:!1,y:!1,z:!1,count:0,shaken:0,timer:0},this.isActive=!1,this.sampleRange=2,this.id=5}setSampleRange(t){this.activate(),this.sampleRange=Math.max(1,Math.min(8,t))}activate(){this.isActive||(this.isActive=!0,this.runtime.queueDisplayUpdate())}update(t,e,i){this.sample.x=Math.floor(t),this.sample.y=Math.floor(e),this.sample.z=Math.floor(i),this.updateGesture(),a.board().bus.queue(this.id,1)}instantaneousAccelerationSquared(){return this.sample.x*this.sample.x+this.sample.y*this.sample.y+this.sample.z*this.sample.z}instantaneousPosture(){var t,e=this.instantaneousAccelerationSquared();let i=!1;return(this.getX()<-400&&this.shake.x||400<this.getX()&&!this.shake.x)&&(i=!0,this.shake.x=!this.shake.x),(this.getY()<-400&&this.shake.y||400<this.getY()&&!this.shake.y)&&(i=!0,this.shake.y=!this.shake.y),(this.getZ()<-400&&this.shake.z||400<this.getZ()&&!this.shake.z)&&(i=!0,this.shake.z=!this.shake.z),i&&this.shake.count<4&&4==++this.shake.count&&(this.shake.shaken=1),10<=++this.shake.timer&&(this.shake.timer=0)<this.shake.count&&0==--this.shake.count&&(this.shake.shaken=0),this.shake.shaken?11:(t=t=>t*t,e<16e4?7:9437184<e?8:e>t(6144)?9:e>t(8192)?10:this.getX()<-800?3:800<this.getX()?4:this.getY()<-800?1:800<this.getY()?2:this.getZ()<-800?5:800<this.getZ()?6:0)}updateGesture(){var t=this.instantaneousPosture();t==this.currentGesture?this.sigma<5&&this.sigma++:(this.currentGesture=t,this.sigma=0),this.currentGesture!=this.lastGesture&&5<=this.sigma&&(this.lastGesture=this.currentGesture,a.board().bus.queue(13,this.lastGesture))}getX(t=s.SIMPLE_CARTESIAN){this.activate();let e;switch(t){case s.SIMPLE_CARTESIAN:e=-this.sample.x;case s.NORTH_EAST_DOWN:e=this.sample.y;default:e=this.sample.x}return a.board().invertAccelerometerXAxis?-1*e:e}getY(t=s.SIMPLE_CARTESIAN){this.activate();let e;switch(t){case s.SIMPLE_CARTESIAN:e=-this.sample.y;case s.NORTH_EAST_DOWN:e=-this.sample.x;default:e=this.sample.y}return a.board().invertAccelerometerYAxis?-1*e:e}getZ(t=s.SIMPLE_CARTESIAN){this.activate();let e;return t===s.NORTH_EAST_DOWN&&(e=-this.sample.z),e=this.sample.z,a.board().invertAccelerometerZAxis?-1*e:e}getPitch(){return this.activate(),Math.floor(360*this.getPitchRadians()/(2*Math.PI))}getPitchRadians(){return this.recalculatePitchRoll(),this.pitch}getRoll(){return this.activate(),Math.floor(360*this.getRollRadians()/(2*Math.PI))}getRollRadians(){return this.recalculatePitchRoll(),this.roll}recalculatePitchRoll(){var t=this.getX(s.NORTH_EAST_DOWN),e=this.getY(s.NORTH_EAST_DOWN),i=this.getZ(s.NORTH_EAST_DOWN);this.roll=Math.atan2(e,i),this.pitch=Math.atan(-t/(e*Math.sin(this.roll)+i*Math.cos(this.roll)))}}a.Accelerometer=e,a.AccelerometerState=class{constructor(t){this.useShake=!1,this.tiltDecayer=0,this.accelerometer=new e(t)}attachEvents(s){this.element=s,this.tiltDecayer=0,this.element.addEventListener(a.pointerEvents.move,t=>{var e,i;this.accelerometer.isActive&&(this.tiltDecayer&&(clearInterval(this.tiltDecayer),this.tiltDecayer=0),e=s.getBoundingClientRect(),i=(t.clientX-e.width/2)/(e.width/3),t=(t.clientY-e.height/2)/(e.height/3),t=1046529-(e=-Math.max(-1023,Math.min(1023,Math.floor(1023*i))))*e-(i=Math.max(-1023,Math.min(1023,Math.floor(1023*t))))*i,t=Math.floor((0<t?-1:1)*Math.sqrt(Math.abs(t))),this.accelerometer.update(-e,i,t),this.updateTilt())},!1),this.element.addEventListener(a.pointerEvents.leave,t=>{!this.accelerometer.isActive||this.tiltDecayer||(this.tiltDecayer=setInterval(()=>{let t=this.accelerometer.getX(),e=(t=Math.floor(.85*Math.abs(t))*(0<t?1:-1),this.accelerometer.getY()),i=(e=Math.floor(.85*Math.abs(e))*(0<e?1:-1),-Math.sqrt(Math.max(0,1046529-t*t-e*e)));Math.abs(t)<=24&&Math.abs(e)<=24&&(clearInterval(this.tiltDecayer),this.tiltDecayer=0,t=0,e=0,i=-1023),this.accelerometer.update(t,e,i),this.updateTilt()},50))},!1)}updateTilt(){var t,e,i;this.accelerometer.isActive&&this.element&&(t=this.accelerometer.getX(),e=this.accelerometer.getY(),i=1-Math.min(.1,Math.pow(Math.max(Math.abs(t),Math.abs(e))/1023,2)/35),this.element.style.transform=`perspective(30em) rotateX(${e*(8/1023)}deg) rotateY(${t*(8/1023)}deg) scale(${i}, ${i})`,this.element.style.perspectiveOrigin="50% 50% 50%",this.element.style.perspective="30em")}}})(pxsim=pxsim||{}),(t=>{t.accelerometer=function(){return t.board().accelerometerState}})(pxsim=pxsim||{}),(i=>{var e;function s(t){var e=i.board();if(e&&e.edgeConnectorState)return e.edgeConnectorState.getPin(t)}function t(t){return s(e.getConfig(t,-1))}(e=i.pxtcore||(i.pxtcore={})).getPin=s,e.lookupPinCfg=t,e.getPinCfg=t})(pxsim=pxsim||{}),(a=>{var t;(t=a.pxtcore||(a.pxtcore={})).registerWithDal=function(t,e,i,s=0){a.board().bus.listen(t,e,i,s)},t.deepSleep=function(){console.log("deep sleep requested")}})(pxsim=pxsim||{}),(t=>{(t.BufferMethods||(t.BufferMethods={})).hash=function(t,e){return(e|=0)<1?0:(t=(e=>{let i=2166136261;for(let t=0;t<e.length;++t)i=Math.imul(i,16777619)^e[t];return i})(t.data),32<=e?t>>>0:((t^t>>>e)&(1<<e)-1)>>>0)}})(pxsim=pxsim||{}),(s=>{var e;function i(){var e=s.board();if(!e)return 42;let i=0;if(e.id&&(i=parseInt(e.id.slice(1)),isNaN(i))){for(let t=i=0;t<e.id.length;++t)i=(i<<5)-i+e.id.charCodeAt(t),i|=0;i=Math.abs(i)}return i=i||42}function a(e){if(e instanceof s.RefRecord)return e.vtable.name+"@"+e.id;if(e instanceof s.RefCollection){let t="[";for(var i of e.toArray()){if(200<t.length){t+="...";break}t+=a(i)+", "}return t+="]"}return"function"==typeof e?(e+"").slice(0,60)+"...":e+""}(e=s.control||(s.control={})).runInParallel=s.thread.runInBackground,e.delay=s.thread.pause,e.reset=function(){s.Runtime.postMessage({type:"simulator",command:"restart",controlReset:!0}),s.getResume()},e.singleSimulator=function(){s.Runtime.postMessage({type:"simulator",command:"single"})},e.waitMicros=function(t){s.thread.pause(t/1e3)},e.deviceName=function(){var t=s.board();return t&&t.id?t.id.slice(0,4):"abcd"},e._ramSize=function(){return 33554432},e.deviceSerialNumber=i,e.deviceLongSerialNumber=function(){var t=e.createBuffer(8);return s.BufferMethods.setNumber(t,s.BufferMethods.NumberFormat.UInt32LE,0,i()),t},e.deviceDalVersion=function(){return"sim"},e.internalOnEvent=function(t,e,i){s.pxtcore.registerWithDal(t,e,i)},e.waitForEvent=function(t,e){var i=s.getResume();s.board().bus.wait(t,e,i)},e.allocateNotifyEvent=function(){return s.board().bus.nextNotifyEvent++},e.raiseEvent=function(t,e,i){s.board().bus.queue(t,e)},e.millis=function(){return s.runtime.runningTime()},e.micros=function(){return 1073741823&s.runtime.runningTimeUs()},e.delayMicroseconds=function(t){e.delay(t/.001)},e.createBuffer=function(t){return s.BufferMethods.createBuffer(t)},e.dmesg=function(t){console.log("DMESG: "+t)},e.setDebugFlags=function(t){console.log("debug flags: "+t)},e.heapSnapshot=function(){console.log(s.runtime.traceObjects())},e.dmesgPtr=function(t,e){console.log(`DMESG: ${t} `+a(e))},e.dmesgValue=function(t){console.log("DMESG: "+a(t))},e.gc=function(){},e.profilingEnabled=function(){return!!s.runtime.perfCounters},e.__log=function(t,e){switch(t){case 0:console.debug("d>"+e);break;case 1:console.log("l>"+e);break;case 2:console.warn("w>"+e);break;case 3:console.error("e>"+e)}s.runtime.board.writeSerial(e)},e.heapDump=function(){},e.isUSBInitialized=function(){return!1}})(pxsim=pxsim||{}),(s=>{var t;(t=s.pxtcore||(s.pxtcore={})).sendMessage=function(t,e,i){t&&s.Runtime.postMessage({type:"messagepacket",broadcast:!i,channel:t,data:e&&e.data})},t.peekMessageChannel=function(){var t=s.getControlMessageState();return(t=t&&t.peek())&&t.channel},t.readMessageData=function(){var t=s.getControlMessageState();return(t=t&&t.read())&&new s.RefBuffer(t.data)}})(pxsim=pxsim||{}),(e=>{e.CONTROL_MESSAGE_EVT_ID=2999,e.CONTROL_MESSAGE_RECEIVED=1,e.ControlMessageState=class{constructor(t){this.board=t,this.messages=[],this.enabled=!1,this.board.addMessageListener(t=>this.messageHandler(t))}messageHandler(t){"messagepacket"==t.type&&this.enqueue(t)}enqueue(t){this.messages.push(t),this.board.bus.queue(e.CONTROL_MESSAGE_EVT_ID,e.CONTROL_MESSAGE_RECEIVED)}peek(){return this.messages[0]}read(){return this.messages.shift()}},e.getControlMessageState=function(){return e.board().controlMessageState}})(pxsim=pxsim||{}),(t=>{t.board=function(){return t.runtime&&t.runtime.board}})(pxsim=pxsim||{}),(t=>{var e;(e=t.loops||(t.loops={})).pause=t.thread.pause,e.forever=t.thread.forever})(pxsim=pxsim||{}),(t=>{var e;(e=t.browserEvents||(t.browserEvents={})).mouseX=function(){return t.board().mouseState.mouseX()},e.mouseY=function(){return t.board().mouseState.mouseY()},e.wheelDx=function(){return t.board().mouseState.wheelDx()},e.wheelDy=function(){return t.board().mouseState.wheelDy()},e.wheelDz=function(){return t.board().mouseState.wheelDz()}})(pxsim=pxsim||{}),(i=>{var t;{var a=i.browserEvents||(i.browserEvents={});let s;function r(t,e){e?i.board().bus.queue(a.INTERNAL_KEY_DOWN,t):i.board().bus.queue(a.INTERNAL_KEY_UP,t)}function n(t){switch(t.key){case"0":case")":return s.Zero;case"1":case"!":return s.One;case"2":case"@":return s.Two;case"3":case"#":return s.Three;case"4":case"$":return s.Four;case"5":case"%":return s.Five;case"6":case"^":return s.Six;case"7":case"&":return s.Seven;case"8":case"*":return s.Eight;case"9":case"(":return s.Nine;case"`":case"~":return s.BackTick;case"-":case"_":return s.Hyphen;case"=":case"+":return s.Equals;case"Q":case"q":return s.Q;case"W":case"w":return s.W;case"E":case"e":return s.E;case"R":case"r":return s.R;case"T":case"t":return s.T;case"Y":case"y":return s.Y;case"U":case"u":return s.U;case"I":case"i":return s.I;case"O":case"o":return s.O;case"P":case"p":return s.P;case"[":case"{":return s.OpenBracket;case"]":case"}":return s.CloseBracket;case"\\":case"|":return s.BackSlash;case"A":case"a":return s.A;case"S":case"s":return s.S;case"D":case"d":return s.D;case"F":case"f":return s.F;case"G":case"g":return s.G;case"H":case"h":return s.H;case" ":return s.Space;case"PageUp":return s.PageUp;case"J":case"j":return s.J;case"K":case"k":return s.K;case"L":case"l":return s.L;case";":case":":return s.SemiColon;case"'":case'"':return s.Apostrophe;case"Z":case"z":return s.Z;case"X":case"x":return s.X;case"C":case"c":return s.C;case"V":case"v":return s.V;case"B":case"b":return s.B;case"N":case"n":return s.N;case"M":case"m":return s.M;case",":case"<":return s.Comma;case".":case">":return s.Period;case"/":case"?":return s.ForwardSlash;case"Shift":return s.Shift;case"Enter":return s.Enter;case"CapsLock":return s.CapsLock;case"Tab":return s.Tab;case"Control":return s.Control;case"Meta":return s.Meta;case"Alt":return s.Alt;case"ArrowUp":return s.ArrowUp;case"ArrowDown":return s.ArrowDown;case"ArrowLeft":return s.ArrowLeft;case"ArrowRight":return s.ArrowRight;case"PageDown":return s.PageDown;case"End":return s.End;case"Home":return s.Home;case"Delete":return s.Delete;case"Backspace":return s.Backspace;default:return 0}}(t=s=a.Key||(a.Key={}))[t.Zero=48]="Zero",t[t.One=49]="One",t[t.Two=50]="Two",t[t.Three=51]="Three",t[t.Four=52]="Four",t[t.Five=53]="Five",t[t.Six=54]="Six",t[t.Seven=55]="Seven",t[t.Eight=56]="Eight",t[t.Nine=57]="Nine",t[t.BackTick=192]="BackTick",t[t.Hyphen=189]="Hyphen",t[t.Equals=187]="Equals",t[t.Q=81]="Q",t[t.W=87]="W",t[t.E=69]="E",t[t.R=82]="R",t[t.T=84]="T",t[t.Y=89]="Y",t[t.U=85]="U",t[t.I=73]="I",t[t.O=79]="O",t[t.P=80]="P",t[t.OpenBracket=219]="OpenBracket",t[t.CloseBracket=221]="CloseBracket",t[t.BackSlash=220]="BackSlash",t[t.A=65]="A",t[t.S=83]="S",t[t.D=68]="D",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.Space=32]="Space",t[t.PageUp=33]="PageUp",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.SemiColon=186]="SemiColon",t[t.Apostrophe=222]="Apostrophe",t[t.Z=90]="Z",t[t.X=88]="X",t[t.C=67]="C",t[t.V=86]="V",t[t.B=66]="B",t[t.N=78]="N",t[t.M=77]="M",t[t.Comma=188]="Comma",t[t.Period=190]="Period",t[t.ForwardSlash=191]="ForwardSlash",t[t.Shift=16]="Shift",t[t.Enter=13]="Enter",t[t.CapsLock=20]="CapsLock",t[t.Tab=9]="Tab",t[t.Control=17]="Control",t[t.Meta=91]="Meta",t[t.Alt=18]="Alt",t[t.ArrowUp=38]="ArrowUp",t[t.ArrowDown=40]="ArrowDown",t[t.ArrowLeft=37]="ArrowLeft",t[t.ArrowRight=39]="ArrowRight",t[t.PageDown=34]="PageDown",t[t.End=35]="End",t[t.Home=36]="Home",t[t.LeftShift=1016]="LeftShift",t[t.RightShift=1017]="RightShift",t[t.LeftControl=1018]="LeftControl",t[t.RightControl=1019]="RightControl",t[t.Backspace=8]="Backspace",t[t.Delete=46]="Delete",a.onKeyboardEvent=function(t,e){var i=n(t);r(i,e),i===s.Shift&&(t.location===t.DOM_KEY_LOCATION_LEFT?r(s.LeftShift,e):t.location===t.DOM_KEY_LOCATION_RIGHT&&r(s.RightShift,e)),i===s.Control&&(t.location===t.DOM_KEY_LOCATION_LEFT?r(s.LeftControl,e):t.location===t.DOM_KEY_LOCATION_RIGHT&&r(s.RightControl,e))},a.getValueForKey=n}})(pxsim=pxsim||{}),(a=>{var r=a.browserEvents||(a.browserEvents={});r.INTERNAL_KEY_DOWN=6870,r.INTERNAL_KEY_UP=6871,r.INTERNAL_POINTER_DOWN=6868,r.INTERNAL_POINTER_UP=6869,r.MouseState=class{constructor(){this.onMove=a.U.throttle(()=>{a.board().bus.queue(6859,0)},50,!0),this.onWheel=a.U.throttle(()=>{a.board().bus.queue(6865,0)},50,!0)}onEvent(t,e,i){this.x=e,this.y=i;let s=6857+["pointerdown","pointerup","pointermove","pointerleave","pointerenter","pointercancel","pointerover","pointerout"].indexOf(t.type);"pointerdown"===t.type?s=r.INTERNAL_POINTER_DOWN:"pointerup"===t.type&&(s=r.INTERNAL_POINTER_UP),a.board().bus.queue(s,(t.button||0)+1)}onWheelEvent(t,e,i){this.dx=t,this.dy=e,this.dz=i,this.onWheel()}mouseX(){return this.x||0}mouseY(){return this.y||0}wheelDx(){return this.dx||0}wheelDy(){return this.dy||0}wheelDz(){return this.dz||0}}})(pxsim=pxsim||{}),(t=>{(t=t.browserEvents||(t.browserEvents={})).currentTime=function(){return Date.now()},t.getYear=function(t){return new Date(t).getFullYear()},t.getMonth=function(t){return new Date(t).getMonth()},t.getDayOfMonth=function(t){return new Date(t).getDate()},t.getDayOfWeek=function(t){return new Date(t).getDay()},t.getHours=function(t){return new Date(t).getHours()},t.getMinutes=function(t){return new Date(t).getMinutes()},t.getSeconds=function(t){return new Date(t).getSeconds()}})(pxsim=pxsim||{}),(e=>{class i extends e.Button{constructor(){super(...arguments),this._pressedTime=-1,this._clickedTime=-1}setPressed(t){this.pressed!==t&&((this.pressed=t)?(this._wasPressed=!0,e.board().bus.queue(this.id,1),this._pressedTime=e.runtime.runningTime()):-1!==this._pressedTime&&(e.board().bus.queue(this.id,2),1e3<=(t=e.runtime.runningTime())-this._pressedTime?e.board().bus.queue(this.id,4):e.board().bus.queue(this.id,3),-1!==this._clickedTime&&t-this._clickedTime<=500&&e.board().bus.queue(this.id,6),this._clickedTime=t))}wasPressed(){var t=this._wasPressed;return this._wasPressed=!1,t}pressureLevel(){return this.isPressed()?512:0}isPressed(){return this.pressed}}e.CommonButton=i,e.CommonButtonState=class{constructor(t){this.usesButtonAB=!1,this.buttonsByPin={},this.buttons=t||[new i(1),new i(2),new i(3)],this.buttons.forEach(t=>this.buttonsByPin[t.id]=t)}}})(pxsim=pxsim||{}),(s=>{var e;function i(t){var e=s.board().buttonState.buttonsByPin;let i=e[t+""];return i=i||(e[t+""]=new s.CommonButton(t))}(e=s.pxtcore||(s.pxtcore={})).getButtonByPin=i,e.getButtonByPinCfg=function(t){return i(e.getConfig(t,-1))},e.getButton=function(t){var e=s.board().buttonState.buttons;if(2===t&&(s.board().buttonState.usesButtonAB=!0,s.runtime.queueDisplayUpdate()),t<e.length&&0<=t)return e[t]}})(pxsim=pxsim||{}),(s=>{var t;(t=s.ButtonMethods||(s.ButtonMethods={})).onEvent=function(t,e,i){s.pxtcore.registerWithDal(t.id,e,i)},t.isPressed=function(t){return t.pressed},t.pressureLevel=function(t){return t.pressureLevel()},t.wasPressed=function(t){return t.wasPressed()},t.id=function(t){return t.id}})(pxsim=pxsim||{}),(e=>{(e.DigitalInOutPinMethods||(e.DigitalInOutPinMethods={})).pushButton=function(t){return e.pxtcore.getButtonByPin(t.id)}})(pxsim=pxsim||{}),(e=>{var t;(t=e.network||(e.network={})).cableSendPacket=function(t){e.getCableState().send(t)},t.cablePacket=function(){return e.getCableState().packet},t.onCablePacket=function(t){e.getCableState().listen(t)},t.onCableError=function(t){e.getCableState().listenError(t)}})(pxsim=pxsim||{}),(e=>{e.CableState=class{constructor(){this.packetReceived=!1,this.PULSE_CABLE_COMPONENT_ID=8259,this.PULSE_PACKET_EVENT=2,this.PULSE_PACKET_ERROR_EVENT=3}send(t){e.Runtime.postMessage({type:"irpacket",packet:t.data})}listen(t){e.pxtcore.registerWithDal(this.PULSE_CABLE_COMPONENT_ID,this.PULSE_PACKET_EVENT,t)}listenError(t){e.pxtcore.registerWithDal(this.PULSE_CABLE_COMPONENT_ID,this.PULSE_PACKET_ERROR_EVENT,t)}receive(t){this.packet=t,this.packetReceived=!0,e.board().bus.queue(this.PULSE_CABLE_COMPONENT_ID,this.PULSE_PACKET_EVENT)}},e.getCableState=function(){return e.board().cableState}})(pxsim=pxsim||{}),(e=>{let r;var t;(t=r=r||{})[t.High=0]="High",t[t.Low=1]="Low",t[t.Normal=2]="Normal",e.AnalogSensorState=class{constructor(t,e=0,i=255,s=64,a=192){this.id=t,this.min=e,this.max=i,this.lowThreshold=s,this.highThreshold=a,this.sensorUsed=!1,this.state=r.Normal,this.level=Math.ceil((i-e)/2)}setUsed(){this.sensorUsed||(this.sensorUsed=!0,e.runtime.queueDisplayUpdate())}setLevel(t){this.level=this.clampValue(t),this.level>=this.highThreshold?this.setState(r.High):this.level<=this.lowThreshold?this.setState(r.Low):this.setState(r.Normal)}getLevel(){return this.level}setLowThreshold(t){this.lowThreshold=this.clampValue(t),this.highThreshold=Math.max(this.lowThreshold+1,this.highThreshold)}setHighThreshold(t){this.highThreshold=this.clampValue(t),this.lowThreshold=Math.min(this.highThreshold-1,this.lowThreshold)}clampValue(t){return t<this.min?this.min:t>this.max?this.max:t}setState(t){if(this.state!==t)switch(this.state=t){case r.High:e.board().bus.queue(this.id,2);break;case r.Low:e.board().bus.queue(this.id,1);break;case r.Normal:}}}})(pxsim=pxsim||{}),(x=>{var v=x.visuals||(x.visuals={});function c(t){var[e,i]=["sim-button","sim-button-outer"];let s=v.PIN_DIST/2.5,a=v.PIN_DIST/5;var r=.8*v.PIN_DIST,n=v.PIN_DIST/12,o=v.PIN_DIST/8+a,[t,h]=t,t=t-s/2,h=h-s/2,l=3*v.PIN_DIST-s,c=2*v.PIN_DIST+s,d=t,u=h+s,f=d+c/2,p=u+l/2;let g=x.svg.elt("g");var m=(t,e)=>{x.svg.child(g,"rect",{class:"sim-button-tab",x:t,y:e,width:s,height:s})},m=(m(t,h),m(t+2*v.PIN_DIST,h),m(t,h+3*v.PIN_DIST),m(t+2*v.PIN_DIST,h+3*v.PIN_DIST),x.svg.child(g,"rect",{class:i,x:d,y:u,rx:n,ry:n,width:c,height:l}),(t,e)=>{x.svg.child(g,"circle",{class:"sim-button-nut",cx:t,cy:e,r:a})});m(d+o,u+o),m(d+c-o,u+o),m(d+o,u+l-o),m(d+c-o,u+l-o),x.svg.child(g,"circle",{class:e,cx:f,cy:p,r:r});return{el:g,y:h,x:t,w:c,h:l+2*s}}v.mkBtnSvg=c,v.BUTTON_PAIR_STYLE=`
            .sim-button {
                pointer-events: none;
                fill: #000;
            }
            .sim-button-outer:active ~ .sim-button,
            .sim-button-virtual:active {
                fill: #FFA500;
            }
            .sim-button-outer {
                cursor: pointer;
                fill: #979797;
            }
            .sim-button-outer:hover {
                stroke:gray;
                stroke-width: ${v.PIN_DIST/5}px;
            }
            .sim-button-nut {
                fill:#000;
                pointer-events:none;
            }
            .sim-button-nut:hover {
                stroke:${v.PIN_DIST/15}px solid #704A4A;
            }
            .sim-button-tab {
                fill:#FFF;
                pointer-events:none;
            }
            .sim-button-virtual {
                cursor: pointer;
                fill: rgba(255, 255, 255, 0.6);
                stroke: rgba(255, 255, 255, 1);
                stroke-width: ${v.PIN_DIST/5}px;
            }
            .sim-button-virtual:hover {
                stroke: rgba(128, 128, 128, 1);
            }
            .sim-text-virtual {
                fill: #000;
                pointer-events:none;
            }
            `,v.ButtonPairView=class{constructor(){this.style=v.BUTTON_PAIR_STYLE}init(t,e){this.state=e,this.bus=t,this.defs=[],this.element=this.mkBtns(),this.updateState(),this.attachEvents()}moveToCoord(t){var e=3*v.PIN_DIST,[t,i]=t;v.translateEl(this.aBtn,[t,i]),v.translateEl(this.bBtn,[t+e,i]),v.translateEl(this.abBtn,[t+1.5*v.PIN_DIST,i+4*v.PIN_DIST])}updateState(){this.state.aBtn,this.state.bBtn,this.state.abBtn,this.aBtn,this.bBtn,this.abBtn;this.state.usesButtonAB&&"visible"!=this.abBtn.style.visibility&&(this.abBtn.style.visibility="visible")}updateTheme(){}mkBtns(){this.aBtn=c([0,0]).el,this.bBtn=c([0,0]).el;this.abBtn=(t=2.8*v.PIN_DIST,e=v.PIN_DIST/2,s=i=0-(l=(t-2*v.PIN_DIST)/2)+t/2,a=1.3*v.PIN_DIST,l=r=-l,n=v.PIN_DIST/7,o=v.PIN_DIST/10,h=x.svg.elt("g"),x.svg.child(h,"rect",{class:"sim-button-virtual",x:r,y:l,rx:e,ry:e,width:t,height:t}),r=v.mkTxt(i+n,s+o,a,0,"A+B"),x.U.addClass(r,"sim-text"),x.U.addClass(r,"sim-text-virtual"),h.appendChild(r),h),this.abBtn.style.visibility="hidden";var t,e,i,s,a,r,n,o,h,l=x.svg.elt("g");return x.U.addClass(l,"sim-buttonpair"),l.appendChild(this.aBtn),l.appendChild(this.bBtn),l.appendChild(this.abBtn),l}attachEvents(){let s=[this.state.aBtn,this.state.bBtn];[this.aBtn,this.bBtn].forEach((e,i)=>{x.pointerEvents.down.forEach(t=>e.addEventListener(t,t=>{s[i].pressed=!0})),e.addEventListener(x.pointerEvents.leave,t=>{s[i].pressed=!1}),e.addEventListener(x.pointerEvents.up,t=>{s[i].pressed=!1,this.bus.queue(s[i].id,this.state.props.BUTTON_EVT_UP),this.bus.queue(s[i].id,this.state.props.BUTTON_EVT_CLICK)})});let e=e=>{s.forEach(t=>t.pressed=e)};x.pointerEvents.down.forEach(t=>this.abBtn.addEventListener(t,t=>{e(!0)})),this.abBtn.addEventListener(x.pointerEvents.leave,t=>{e(!1)}),this.abBtn.addEventListener(x.pointerEvents.up,t=>{e(!1),this.bus.queue(this.state.abBtn.id,this.state.props.BUTTON_EVT_UP),this.bus.queue(this.state.abBtn.id,this.state.props.BUTTON_EVT_CLICK)})}}})(pxsim=pxsim||{}),(s=>{let e;var t;(t=e=s.PinFlags||(s.PinFlags={}))[t.Unused=0]="Unused",t[t.Digital=1]="Digital",t[t.Analog=2]="Analog",t[t.Input=4]="Input",t[t.Output=8]="Output",t[t.Touch=16]="Touch";class i{constructor(t){this.id=t,this.touched=!1,this.value=0,this.period=0,this.servoAngle=0,this.mode=e.Unused,this.pitch=!1,this.pull=0,this.eventMode=0,this.used=!1}setValue(t){var e=this.value,t=(this.value=t,s.board());t&&2==this.eventMode&&e!=this.value&&t.bus.queue(this.id,0<this.value?2:3)}digitalReadPin(){return this.mode=e.Digital|e.Input,100<this.value?1:0}digitalWritePin(t){s.board(),this.mode=e.Digital|e.Output,this.value;this.value=0<t?1023:0,s.runtime.queueDisplayUpdate()}setPull(t){switch(this.pull=t){case 2:this.value=0;break;case 1:this.value=1023;break;default:this.value=s.Math_.randomRange(0,1023)}}analogReadPin(){return this.mode=e.Analog|e.Input,this.value||0}analogWritePin(t){s.board(),this.mode=e.Analog|e.Output,this.value;this.value=Math.max(0,Math.min(1023,t)),s.runtime.queueDisplayUpdate()}analogSetPeriod(t){this.mode=e.Analog|e.Output,this.period=t,s.runtime.queueDisplayUpdate()}servoWritePin(t){this.analogSetPeriod(2e4),this.servoAngle=Math.max(0,Math.min(180,t)),s.runtime.queueDisplayUpdate()}servoSetContinuous(t){this.servoContinuous=t}servoSetPulse(t,e){}isTouched(){return this.mode=e.Touch|e.Analog|e.Input,this.touched}onEvent(t,e){var i=s.board();switch(t){case 4:case 5:this.eventMode=3;break;case 2:case 3:this.eventMode=2;break;default:return}i.bus.listen(this.id,t,e)}}s.Pin=i;class a{constructor(t,e,i){this.tx=t,this.rx=e,this.id=i,this.baudRate=115200,this.setRxBufferSize(64),this.setTxBufferSize(64)}setTxBufferSize(t){this.txBuffer=s.control.createBuffer(t)}setRxBufferSize(t){this.rxBuffer=s.control.createBuffer(t)}read(){return-1}readBuffer(){return s.control.createBuffer(0)}writeBuffer(t){}setBaudRate(t){this.baudRate=t}redirect(t,e,i){this.tx=t,this.rx=e,this.baudRate=i}onEvent(t,e){s.control.internalOnEvent(this.id,t,e)}onDelimiterReceived(t,e){}}s.SerialDevice=a;class r{constructor(t,e,i){this.mosi=t,this.miso=e,this.sck=i,this.frequency=25e4,this.mode=0}write(t){return 0}transfer(t,e){}setFrequency(t){this.frequency=t}setMode(t){this.mode=t}}s.SPI=r;class n{constructor(t,e){this.sda=t,this.scl=e}readBuffer(t,e,i){return s.control.createBuffer(0)}writeBuffer(t,e,i){return 0}}s.I2C=n,s.EdgeConnectorState=class{constructor(t){this.props=t,this._i2cs=[],this._spis=[],this._serials=[],this.pins=t.pins.map(t=>null!=t?new i(t):null)}getPin(e){return this.pins.filter(t=>t&&t.id==e)[0]||null}createI2C(e,i){let t=this._i2cs.filter(t=>t.sda==e&&t.scl==i)[0];return t||this._i2cs.push(t=new n(e,i)),t}createSPI(e,i,s){let t=this._spis.filter(t=>t.mosi==e&&t.miso==i&&t.sck==s)[0];return t||this._spis.push(t=new r(e,i,s)),t}createSerialDevice(e,i,t){let s=this._serials.filter(t=>t.tx==e&&t.rx==i)[0];return s||this._serials.push(s=new a(e,i,t)),s}}})(pxsim=pxsim||{}),(t=>{(t=t.configStorage||(t.configStorage={})).setBuffer=function(t,e){},t.getBuffer=function(t){},t.removeItem=function(t){},t.clear=function(){}})(pxsim=pxsim||{}),(a=>{{var e=a.visuals||(a.visuals={});let s=`
    <svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" viewBox="0 0 33.6 90" width="33.599998" height="90">
    <path class="st0" d="M1.3 65.000002v5.9C1.3 74.800002 4.5 78 8.4 78c3.9 0 7.1-3.199998 7.1-7.099998v-13.7c-1.9-1.9-4.4-2.9-7.1-2.8-4.6 0-8.4 2.6-8.4 5.9v1.5c0 1.2.5 2.3 1.3 3.2z" id="path5" opacity=".65" fill="#ececec"/>
    <g id="g7" transform="translate(0 10.900002)">
      <path class="st1" d="M12.7 49.6l1.2 1.4h-1l-2.4-1.4V15c0-.3.5-.5 1.1-.5.6 0 1.1.2 1.1.5z" id="path9" fill="#8c8c8c"/>
      <path class="st1" d="M2.6 42.9c0 .7 1.1 1.3 2.1 1.8.4.2 1.2.6 1.2.9V49l-2.5 2h.9L8 49v-3.5c0-.7-.9-1.2-1.9-1.7-.4-.2-1.3-.8-1.3-1.1v-52.9c0-.4-.5-.7-1.1-.7-.6 0-1.1.3-1.1.7z" id="path11" fill="#8c8c8c"/>
      <path class="sim-led-main" d="M1.3 54.1V60c0 3.9 3.2 7.1 7.1 7.1 3.9 0 7.1-3.2 7.1-7.1V46.3c-1.9-1.9-4.4-2.9-7.1-2.8-4.6 0-8.4 2.6-8.4 5.9v1.5c0 1.2.5 2.3 1.3 3.2z" id="LED" opacity=".3" fill="#ccc"/>
      <path class="st3" d="M1.3 54.1V51c0-2.7 3.2-5 7.1-5 3.9 0 7.1 2.2 7.1 5v-4.6c-1.9-1.9-4.4-2.9-7.1-2.8-4.6 0-8.4 2.6-8.4 5.9V51c0 1.1.5 2.2 1.3 3.1z" id="path15" opacity=".9" fill="#d1d1d1"/>
      <path class="st4" d="M1.3 54.1V51c0-2.7 3.2-5 7.1-5 3.9 0 7.1 2.2 7.1 5v-4.6c-1.9-1.9-4.4-2.9-7.1-2.8-4.6 0-8.4 2.6-8.4 5.9V51c0 1.1.5 2.2 1.3 3.1z" id="path17" opacity=".7" fill="#e6e6e6"/>
      <path class="st5" d="M1.3 54.1V51c0-2.7 3.2-5 7.1-5 3.9 0 7.1 2.2 7.1 5v-3.1c-1.9-1.9-4.4-2.9-7.1-2.8C3.8 45.1 0 47.7 0 51c0 1.1.5 2.2 1.3 3.1z" id="path19" opacity=".25" fill="#e6e6e6"/>
      <ellipse class="st5" cx="8.3" cy="51" rx="7.1" ry="5" id="ellipse21" opacity=".25" fill="#e6e6e6"/>
      <ellipse class="st5" cx="8.3" cy="51" rx="7.1" ry="5" id="ellipse23" opacity=".25" fill="#e6e6e6"/>
      <g class="st8" id="g29" transform="translate(0 -12)" opacity=".61">
        <path class="st9" d="M8.3 57.1c4.3 0 6.1 2 6.1 2l-.7.7s-1.6-1.7-5.4-1.7C5.9 58 3.6 59 2 60.8l-.8-.6c1.9-2.1 4.4-3.2 7.1-3.1z" id="path31" fill="#fff"/>
      </g>
      <g class="st8" id="g33" transform="translate(0 -12)" opacity=".61">
        <path class="st9" d="M12.9 75.9c1.1-1.1 1.7-2.6 1.7-4.2V61.4l-1.9-1.5v10.4c.9 2.8.3 4.2-.7 5.2.3.1.6.2.9.4z" id="path35" fill="#fff"/>
        <path class="st9" d="M5.6 77.5l.3-.9c-1.5-.7-2.6-2.1-2.8-3.7h-1c.3 2 1.6 3.7 3.5 4.6z" id="path37" fill="#fff"/>
      </g>
      <text style="line-height:1.25;-inkscape-font-specification:consolas" x="14.103056" y=".224915" id="text4514" font-weight="400" font-size="7.744442" font-family="consolas" letter-spacing="0" word-spacing="0" fill="#666" stroke-width=".968055">
        <tspan id="tspan4512" x="14.103056" y=".224915">330Ω</tspan>
      </text>
      <text style="line-height:1.25;-inkscape-font-specification:consolas" x="1.868053" y="77.579796" id="text4524" font-weight="400" font-size="32.793365" font-family="consolas" letter-spacing="0" word-spacing="0" stroke-width=".819834">
        <tspan id="tspan4522" x="1.868053" y="77.579796" font-size="10.931121"></tspan>
      </text>
    </g>
    <g id="g39" transform="translate(0 -1.099998)">
      <path class="st1" id="rect41" fill="#8c8c8c" d="M11.6 16.9h21.700001v1.9H11.6z"/>
      <g id="g43">
        <path class="st10" id="rect45" fill="none" d="M12 16.9h3.2v1.9H12z"/>
        <path class="st11" d="M19 15c-.3-.2-.6-.3-.9-.3h-1.4c-.3 0-.5.3-.5.7v4.9c0 .4.2.7.5.7h1.4c.3 0 .6-.1.9-.3.3-.2.6-.3.9-.3h5c.3 0 .6.1.9.3h.1c.3.2.6.3.9.3h1.4c.3 0 .5-.3.5-.7v-4.9c0-.4-.2-.7-.5-.7h-1.4c-.3 0-.6.1-.9.3h-.1c-.3.2-.6.3-.9.3h-5c-.2 0-.5-.1-.9-.3z" id="path47" fill="#d6bf90"/>
        <path class="st12" d="M28.4 18.5c-.1.1-.1.2-.2.3-.3.5-.7.8-1.2.8s-.9-.1-1.4-.3c-.6-.1-1.1-.1-1.7-.1-2 0-3.9 0-5.9.2-.4.1-.8 0-1.1-.1-.2-.1-.4-.2-.5-.5v1.5c0 .2.1.3.2.3H18c.3 0 .6-.1.9-.3.3-.2.7-.3 1.1-.3h5c.4 0 .8.1 1.1.3.3.1.6.2.8.2h1.4c.1 0 .2-.1.2-.3v-1.9c0 .1-.1.2-.1.2z" id="path49" fill="#aa936b"/>
        <g id="g51">
          <path class="st13" id="rect53" fill="#ad9f4e" d="M27.200001 14.7h.7v6.2h-.7z"/>
          <path class="st14" id="rect55" opacity=".4" d="M27.200001 17.799999h.7v2.5h-.7z"/>
          <path class="st15" id="rect57" opacity=".5" fill="#ff3" d="M27.200001 15h.7v1.3h-.7z"/>
          <path class="st16" id="rect59" opacity=".5" fill="#fff" d="M27.200001 15.3h.7v.7h-.7z"/>
        </g>
        <path class="st17" id="rect61" fill="#aa4518" d="M23.1 15.3h1.3v5.1h-1.3z"/>
        <path class="st18" id="rect63" fill="#ff9700" d="M20.6 15.3h1.3v5.1h-1.3z"/>
        <path class="st18" d="M19.3 15.1c-.1 0-.1-.1-.2-.1-.3-.2-.6-.3-.9-.3H18V21h.1c.3 0 .6-.1.9-.3.1 0 .1-.1.2-.1v-5.5z" id="path65" fill="#ff9700"/>
        <path class="st19" d="M18.7 15.7c.4.1.8.2 1.2.2H21c1.2-.1 2.4-.1 3.6 0 .4 0 .9 0 1.3-.1.3-.1.6-.2.8-.3.6-.2 1.2-.3 1.8-.2 0-.1-.1-.3-.2-.3h-1.4c-.3 0-.6.1-.9.3-.3.2-.7.3-1.1.3h-5c-.4 0-.8-.1-1.1-.3-.3-.1-.6-.2-.8-.2h-1.4c-.1 0-.2.1-.2.3v.2c.8-.1 1.5 0 2.3.1z" id="path67" opacity=".74" fill="#fffdfa"/>
      </g>
    </g>
  </svg>
      `;e.mkLedPart=function(t=[0,0]){var[t,e]=t,t=t+-8,e=e+-7,i=a.svg.elt("image");return a.svg.hydrate(i,{class:"sim-led",x:t,y:e,width:68,height:180,href:a.svg.toDataUri(s)}),{el:i,x:t,y:e,w:68,h:180}},e.LedView=class{constructor(t){this.color="rgb(0,255,0)",this.parsePinString=t}init(t,e,i,s){this.pin=this.parsePinString(s.name||s.pin),this.bus=t,this.initDom(),this.updateState()}initDom(){this.element=a.svg.elt("g");var t=(new DOMParser).parseFromString(s,"image/svg+xml").querySelector("svg");a.svg.hydrate(t,{class:"sim-led",width:68,height:180}),this.led=t.getElementById("LED"),this.text=t.getElementById("tspan4522"),this.element.appendChild(t)}moveToCoord(t){e.translateEl(this.element,[t[0]+-8,t[1]+-7])}updateTheme(){}updateState(){var t;this.currentValue===this.pin.value&&this.currentMode==this.pin.mode||(this.currentValue=this.pin.value,this.currentMode=this.pin.mode,t=this.led.style,this.currentMode&a.PinFlags.Digital?(t.fill=this.currentValue?"#00ff00":"#ffffff",t.opacity="0.9",this.text.textContent=this.currentValue?"1":"0"):(t.fill="#00ff00",t.opacity=(.1+Math.max(0,Math.min(1023,this.currentValue))/1023*.8).toString(),this.text.textContent="~"+this.currentValue))}}}})(pxsim=pxsim||{}),(a=>{var i=a.visuals||(a.visuals={});function e(){return a.svg.parseString(`
        <svg xmlns="http://www.w3.org/2000/svg" id="svg2" width="112.188" height="299.674">
          <g id="layer1" stroke-linecap="round" stroke-linejoin="round" transform="scale(0.8)">
            <path id="path8212" fill="#0061ff" stroke-width="6.6" d="M.378 44.61v255.064h112.188V44.61H.378z"/>
            <path id="crankbase" fill="#00f" stroke-width="6.6" d="M56.57 88.047C25.328 88.047 0 113.373 0 144.615c.02 22.352 11.807 42.596 32.238 51.66.03 3.318.095 5.24.088 7.938 0 13.947 11.307 25.254 25.254 25.254 13.947 0 25.254-11.307 25.254-25.254-.006-2.986-.415-5.442-.32-8.746 19.487-9.45 30.606-29.195 30.625-50.852 0-31.24-25.33-56.568-56.57-56.568z"/>
            <path id="lowertip" fill="#00a2ff" stroke-width="2" d="M.476 260.78v38.894h53.82v-10.486a6.82 6.566 0 0 1-4.545-6.182 6.82 6.566 0 0 1 6.82-6.566 6.82 6.566 0 0 1 6.82 6.566 6.82 6.566 0 0 1-4.545 6.182v10.486h53.82V260.78H.475z"/>
            <path id="uppertip" fill="#00a2ff" stroke-width="2" d="M112.566 83.503V44.61h-53.82v10.487a6.82 6.566 0 0 1 4.544 6.18 6.82 6.566 0 0 1-6.818 6.568 6.82 6.566 0 0 1-6.82-6.567 6.82 6.566 0 0 1 4.546-6.18V44.61H.378v38.893h112.188z"/>
            <path id="VCC" fill="red" stroke-width="2" d="M53.72 21.93h5.504v22.627H53.72z"/>
            <path id="LOGIC" fill="#fc0" stroke-width="2" d="M47.3 21.93h5.503v22.627H47.3z"/>
            <path id="GND" fill="#a02c2c" stroke-width="2" d="M60.14 21.93h5.505v22.627H60.14z"/>
            <path id="connector" stroke-width="2" d="M45.064 0a1.488 1.488 0 0 0-1.488 1.488v24.5a1.488 1.488 0 0 0 1.488 1.487h22.71a1.488 1.488 0 0 0 1.49-1.488v-24.5A1.488 1.488 0 0 0 67.774 0h-22.71z"/>
            <g id="crank" transform="translate(0 -752.688)">
              <path id="arm" fill="#ececec" stroke="#000" stroke-width="1.372" d="M47.767 880.88c-4.447 1.162-8.412 8.278-8.412 18.492s3.77 18.312 8.412 18.494c8.024.314 78.496 5.06 78.51-16.952.012-22.013-74.377-21.117-78.51-20.035z"/>
              <circle id="path8216" cx="56.661" cy="899.475" r="8.972" fill="gray" stroke-width="2"/>
            </g>
          </g>
        </svg>
                    `).firstElementChild}i.mkMicroServoPart=function(t=[0,0]){return{el:e(),x:t[0],y:t[1],w:112.188,h:299.674}},i.MicroServoView=class{constructor(){this.style="",this.overElement=void 0,this.defs=[],this.currentAngle=0,this.targetAngle=0,this.lastAngleTime=0}init(t,e,i,s){this.state=e,this.pin=this.state.props.servos[a.readPin(s.name||s.pin)],this.bus=t,this.defs=[],this.initDom(),this.updateState()}initDom(){this.element=e(),this.crankEl=this.element.querySelector("#crank"),this.crankTransform=this.crankEl.getAttribute("transform")}moveToCoord(t){var[t,e]=t;i.translateEl(this.element,[t,e])}updateState(){var t=this.state.getPin(this.pin),e=!!t.servoContinuous,t=t.servoAngle;e?(e=a.U.now(),e=Math.min(e-this.lastAngleTime,50)/1e3,this.currentAngle=this.targetAngle,this.targetAngle+=(t-90)/90*300*e):this.targetAngle=180-t,this.targetAngle!=this.currentAngle&&this.renderAngle()}renderAngle(){var t=a.U.now(),e=Math.min(t-this.lastAngleTime,50)/1e3,i=this.targetAngle-this.currentAngle;this.currentAngle+=Math.min(Math.abs(i),300*e)*(0<i?1:-1),this.crankEl.setAttribute("transform",this.crankTransform+` rotate(${this.currentAngle}, 56.661, 899.475)`),this.lastAngleTime=t,setTimeout(()=>a.runtime.updateDisplay(),20)}updateTheme(){}}})(pxsim=pxsim||{}),(s=>{let i;var t;function a(t){return s.board().neopixelState(t)}(t=i=s.NeoPixelMode||(s.NeoPixelMode={}))[t.RGB=1]="RGB",t[t.RGBW=2]="RGBW",t[t.RGB_RGB=3]="RGB_RGB",t[t.DotStar=4]="DotStar",s.CommonNeoPixelState=class{constructor(){this.mode=i.RGB,this.width=1}get length(){return this.buffer?this.buffer.length/this.stride|0:0}get stride(){return this.mode==i.RGBW||this.mode==i.DotStar?4:3}pixelColor(t){var e=t*this.stride;switch(this.mode){case i.RGBW:return[this.buffer[1+e],this.buffer[e],this.buffer[2+e],this.buffer[3+e]];case i.RGB_RGB:return[this.buffer[e],this.buffer[1+e],this.buffer[2+e]];case i.DotStar:return[this.buffer[3+e],this.buffer[2+e],this.buffer[1+e]];default:return[this.buffer[1+e],this.buffer[0+e],this.buffer[2+e]]}}},s.neopixelState=a,s.sendBufferAsm=function(t,e){var i=s.board();i&&(i=i.edgeConnectorState.getPin(e))&&(e=a(i.id))&&(e=e.mode,s.light.sendBuffer(i,void 0,e,t))}})(pxsim=pxsim||{}),(a=>{(a.light||(a.light={})).sendBuffer=function(t,e,i,s){(t=a.neopixelState(t.id))&&(t.mode=255&i,t.buffer=s.data,a.runtime.queueDisplayUpdate())}})(pxsim=pxsim||{}),(d=>{{var r=d.visuals||(d.visuals={});let h=2.5*r.PIN_DIST,n=r.PIN_DIST,i=1.2*r.PIN_DIST,l=12*r.PIN_DIST,c=4*r.PIN_DIST,s=1.4*r.PIN_DIST,a=r.PIN_DIST;function o(t=[0,0]){var[t,e]=t,t=t+-13.5,e=e+-11,i=d.svg.elt("image");return d.svg.hydrate(i,{class:"sim-neopixel-strip",x:t,y:e,width:87.5,height:190,href:d.svg.toDataUri(`<svg viewBox="-5 -1 53 112" xmlns="http://www.w3.org/2000/svg" xmlns:bx="https://boxy-svg.com">
  <rect x="2.5" width="38" height="100" style="fill: rgb(68, 68, 68);"/>
  <rect x="11.748" y="3.2" width="1.391" height="2.553" style="fill: none; stroke-linejoin: round; stroke-width: 3; stroke: rgb(165, 103, 52);"/>
  <rect x="20.75" y="3.2" width="1.391" height="2.553" style="fill: none; stroke-linejoin: round; stroke-width: 3; stroke: rgb(165, 103, 52);"/>
  <rect x="29.75" y="3.2" width="1.391" height="2.553" style="fill: none; stroke-linejoin: round; stroke-width: 3; stroke: rgb(165, 103, 52);"/>
  <g>
    <rect x="9" y="16.562" width="25" height="3.238" style="fill: rgb(216, 216, 216);"/>
    <rect x="9" y="22.562" width="25" height="3.238" style="fill: rgb(216, 216, 216);"/>
    <rect x="9" y="28.563" width="25" height="3.238" style="fill: rgb(216, 216, 216);"/>
    <rect x="11.607" y="14.833" width="19.787" height="18.697" style="fill: rgb(0, 0, 0);"/>
    <ellipse style="fill: rgb(216, 216, 216);" cx="21.5" cy="24.181" rx="7" ry="7"/>
  </g>
  <path d="M -7.25 -103.2 L -2.5 -100.003 L -12 -100.003 L -7.25 -103.2 Z" style="fill: rgb(68, 68, 68);" transform="matrix(-1, 0, 0, -1, 0, 0)" bx:shape="triangle -12 -103.2 9.5 3.197 0.5 0 1@ad6f5cac"/>
  <path d="M -16.75 -103.197 L -12 -100 L -21.5 -100 L -16.75 -103.197 Z" style="fill: rgb(68, 68, 68);" transform="matrix(-1, 0, 0, -1, 0, 0)" bx:shape="triangle -21.5 -103.197 9.5 3.197 0.5 0 1@07d73149"/>
  <path d="M -26.25 -103.2 L -21.5 -100.003 L -31 -100.003 L -26.25 -103.2 Z" style="fill: rgb(68, 68, 68);" transform="matrix(-1, 0, 0, -1, 0, 0)" bx:shape="triangle -31 -103.2 9.5 3.197 0.5 0 1@54403e2d"/>
  <path d="M -35.75 -103.197 L -31 -100 L -40.5 -100 L -35.75 -103.197 Z" style="fill: rgb(68, 68, 68);" transform="matrix(-1, 0, 0, -1, 0, 0)" bx:shape="triangle -40.5 -103.197 9.5 3.197 0.5 0 1@21c9b772"/>
  <g transform="matrix(1, 0, 0, 1, 0.000002, 29.999994)">
    <rect x="9" y="16.562" width="25" height="3.238" style="fill: rgb(216, 216, 216);"/>
    <rect x="9" y="22.562" width="25" height="3.238" style="fill: rgb(216, 216, 216);"/>
    <rect x="9" y="28.563" width="25" height="3.238" style="fill: rgb(216, 216, 216);"/>
    <rect x="11.607" y="14.833" width="19.787" height="18.697" style="fill: rgb(0, 0, 0);"/>
    <ellipse style="fill: rgb(216, 216, 216);" cx="21.5" cy="24.181" rx="7" ry="7"/>
  </g>
  <g transform="matrix(1, 0, 0, 1, 0.000005, 59.999992)">
    <rect x="9" y="16.562" width="25" height="3.238" style="fill: rgb(216, 216, 216);"/>
    <rect x="9" y="22.562" width="25" height="3.238" style="fill: rgb(216, 216, 216);"/>
    <rect x="9" y="28.563" width="25" height="3.238" style="fill: rgb(216, 216, 216);"/>
    <rect x="11.607" y="14.833" width="19.787" height="18.697" style="fill: rgb(0, 0, 0);"/>
    <ellipse style="fill: rgb(216, 216, 216);" cx="21.5" cy="24.181" rx="7" ry="7"/>
  </g>
</svg>`)}),{el:i,x:t,y:e,w:87.5,h:190}}r.mkNeoPixelPart=o;class u{constructor(t=[0,0],e=1){var i=d.svg.elt("rect"),s=n,[t,a]=t,r=a-s;e<=1?d.svg.hydrate(i,{x:"-50%",y:r,width:"100%",height:2*s,class:"sim-neopixel"}):d.svg.hydrate(i,{x:t-s,y:r,width:2*s,height:2*s,class:"sim-neopixel"}),this.el=i,this.cy=a}setRgb(t){var[t,e,i]=r.rgbToHsl(t),i=Math.max(i,60);this.el.setAttribute("fill",`hsl(${t}, ${e}%, ${i}%)`)}}r.NeoPixel=u;class f{constructor(t,e=1){this.cols=e,this.pixels=[];e=d.svg.elt("svg");d.svg.hydrate(e,{class:"sim-neopixel-canvas",x:"0px",y:"0px",width:i+"px",height:l+"px"}),this.canvas=e,this.background=d.svg.child(e,"rect",{class:"sim-neopixel-background hidden"}),this.updateViewBox(-i/2,0,i,l)}updateViewBox(t,e,i,s){this.viewBox=[t,e,i,s],d.svg.hydrate(this.canvas,{viewBox:t+` ${e} ${i} `+s}),d.svg.hydrate(this.background,{x:t,y:e,width:i,height:s})}update(s){if(s&&!(s.length<=0)){var a,r;0==this.pixels.length&&1<this.cols&&(i=Math.ceil(s.length/this.cols),i=l/i,i=this.cols*i,this.canvas.setAttributeNS(null,"width",i+"px"),this.updateViewBox(0,0,i,l));for(let i=0;i<s.length;i++){let e=this.pixels[i];if(!e){let t=[0,c+i*h];1<this.cols&&(a=Math.floor(i/this.cols),r=i-a*this.cols,t=[(1+r)*h,(a+1)*h]),e=this.pixels[i]=new u(t,this.cols),d.svg.hydrate(e.el,{title:"offset: "+i}),this.canvas.appendChild(e.el)}e.setRgb(s[i])}d.U.removeClass(this.background,"hidden");var[i,n]=[this.pixels[0],this.pixels[this.pixels.length-1]];let e=n.cy-i.cy+2*c;var[,n,i,o]=this.viewBox;if(e>o){let t=i*(e/o);1<this.cols?(i=Math.ceil(s.length/this.cols),e=h*(i+1),t=h*(this.cols+1),this.updateViewBox(0,n,t,e)):this.updateViewBox(-t/2,n,t,e)}}}setLoc(t){var[t,e]=t;d.svg.hydrate(this.canvas,{x:t,y:e})}}r.NeoPixelCanvas=f,r.NeoPixelView=class{constructor(t){this.parsePinString=t,this.style=`
            .sim-neopixel-canvas {
            }
            .sim-neopixel-canvas-parent:hover {
                transform-origin: center;
                transform: scale(4) translateY(-220px);
                -moz-transform: scale(4) translateY(-220px);
            }
            .sim-neopixel-canvas .hidden {
                visibility:hidden;
            }
            .sim-neopixel-background {
                fill: rgba(255,255,255,0.9);
            }
            .sim-neopixel-strip {
            }
        `}init(t,e,i,s){this.stripGroup=d.svg.elt("g"),this.element=this.stripGroup,this.pin=this.parsePinString(s.dataPin||s.pin)||this.parsePinString("pins.NEOPIXEL")||this.parsePinString("pins.MOSI"),this.lastLocation=[0,0],this.state=e(this.pin);s=o();this.part=s,this.stripGroup.appendChild(s.el),this.overElement=null,this.makeCanvas()}makeCanvas(){var t,e=new f(this.pin.id,this.state.width);this.overElement?(this.overElement.removeChild(this.canvas.canvas),this.overElement.appendChild(e.canvas)):((t=d.svg.elt("g",{class:"sim-neopixel-canvas-parent"})).appendChild(e.canvas),this.overElement=t),this.canvas=e,this.updateStripLoc()}moveToCoord(t){var[t,e]=t;this.lastLocation=[t,e],this.updateStripLoc()}updateStripLoc(){var[t,e]=this.lastLocation;d.U.assert("number"==typeof t&&"number"==typeof e,"invalid x,y for NeoPixel strip"),this.canvas.setLoc([t+s,e+a]),d.svg.hydrate(this.part.el,{transform:`translate(${t} ${e})`})}updateState(){this.state.width!=this.canvas.cols&&this.makeCanvas();var e=[];for(let t=0;t<this.state.length;t++)e.push(this.state.pixelColor(t));this.canvas.update(e)}updateTheme(){}}}})(pxsim=pxsim||{}),(a=>{{var e=a.visuals||(a.visuals={});let s=`
    <svg xmlns="http://www.w3.org/2000/svg" id="Layer_1" viewBox="0 0 33.6 90" width="33.599998" height="90">
    <path id="path9" d="M12.7 60.500002l1.2 1.4h-1l-2.4-1.4v-34.6c0-.3.5-.5 1.1-.5.6 0 1.1.2 1.1.5z" class="st1" fill="#8c8c8c"/>
    <path id="path11" d="M3.4 61.900002h1.905509L4.8.700002c-.003304-.399986-.5-.7-1.1-.7-.6 0-1.1.3-1.1.7z" class="st1" fill="#8c8c8c"/>
    <text id="text4514" y="11.124916" x="14.103056" style="line-height:1.25;-inkscape-font-specification:consolas" font-weight="400" font-size="7.744442" font-family="consolas" letter-spacing="0" word-spacing="0" fill="#666" stroke-width=".968055">
      <tspan y="11.124916" x="14.103056" id="tspan4512">10kΩ</tspan>
    </text>
    <text style="line-height:1.25;-inkscape-font-specification:consolas" x="1.868053" y="77.579796" id="text4524" font-weight="400" font-size="32.793365" font-family="consolas" letter-spacing="0" word-spacing="0" stroke-width=".819834">
    <tspan id="tspan4522" x="1.868053" y="77.579796" font-size="10.931121"></tspan>
    </text>
    <path id="rect41" class="st1" fill="#8c8c8c" d="M11.6 15.800001h21.700001v1.9H11.6z"/>
    <path class="st10" id="rect45" fill="none" d="M12 15.800001h3.2v1.9H12z"/>
    <path class="st11" d="M19 13.900002c-.3-.2-.6-.3-.9-.3h-1.4c-.3 0-.5.3-.5.7v4.9c0 .4.2.7.5.7h1.4c.3 0 .6-.1.9-.3.3-.2.6-.3.9-.3h5c.3 0 .6.1.9.3h.1c.3.2.6.3.9.3h1.4c.3 0 .5-.3.5-.7v-4.9c0-.4-.2-.7-.5-.7h-1.4c-.3 0-.6.1-.9.3h-.1c-.3.2-.6.3-.9.3h-5c-.2 0-.5-.1-.9-.3z" id="path47" fill="#d6bf90"/>
    <path class="st12" d="M28.4 17.400002c-.1.1-.1.2-.2.3-.3.5-.7.8-1.2.8s-.9-.1-1.4-.3c-.6-.1-1.1-.1-1.7-.1-2 0-3.9 0-5.9.2-.4.1-.8 0-1.1-.1-.2-.1-.4-.2-.5-.5v1.5c0 .2.1.3.2.3H18c.3 0 .6-.1.9-.3.3-.2.7-.3 1.1-.3h5c.4 0 .8.1 1.1.3.3.1.6.2.8.2h1.4c.1 0 .2-.1.2-.3v-1.9c0 .1-.1.2-.1.2z" id="path49" fill="#aa936b"/>
    <g id="g51" transform="translate(0 -1.099998)">
      <path class="st13" id="rect53" fill="#ad9f4e" d="M27.200001 14.7h.7v6.2h-.7z"/>
      <path class="st14" id="rect55" opacity=".4" d="M27.200001 17.799999h.7v2.5h-.7z"/>
      <path class="st15" id="rect57" opacity=".5" fill="#ff3" d="M27.200001 15h.7v1.3h-.7z"/>
      <path class="st16" id="rect59" opacity=".5" fill="#fff" d="M27.200001 15.3h.7v.7h-.7z"/>
    </g>
    <path class="st17" id="rect61" fill="#ff9700" d="M23.1 14.200002h1.3v5.1h-1.3z"/>
    <path class="st18" id="rect63" d="M20.6 14.200002h1.3v5.1h-1.3z"/>
    <path class="st18" d="M19.3 14.000002c-.1 0-.1-.1-.2-.1-.3-.2-.6-.3-.9-.3H18v6.3h.1c.3 0 .6-.1.9-.3.1 0 .1-.1.2-.1v-5.5z" id="path65" fill="#aa4518"/>
    <path class="st19" d="M18.7 14.600002c.4.1.8.2 1.2.2H21c1.2-.1 2.4-.1 3.6 0 .4 0 .9 0 1.3-.1.3-.1.6-.2.8-.3.6-.2 1.2-.3 1.8-.2 0-.1-.1-.3-.2-.3h-1.4c-.3 0-.6.1-.9.3-.3.2-.7.3-1.1.3h-5c-.4 0-.8-.1-1.1-.3-.3-.1-.6-.2-.8-.2h-1.4c-.1 0-.2.1-.2.3v.2c.8-.1 1.5 0 2.3.1z" id="path67" opacity=".74" fill="#fffdfa"/>
    <ellipse id="path4569" ry="5.949258" rx="6.745286" cy="64.610916" cx="8.085964" fill="#aa4518" stroke-width="3.558676" stroke-linecap="round" stroke-linejoin="round"/>
    <ellipse id="path4569-5" ry="5.488401" rx="6.222764" cy="64.652809" cx="8.024301" fill="#e7e1df" stroke-width="3.283004" stroke-linecap="round" stroke-linejoin="round"/>
    <ellipse id="path4607" cx="3.393591" cy="65" rx=".628443" ry="1.016842" fill="#4d4d4d" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
    <ellipse id="path4607-3" cx="12.568855" cy="65" rx=".628443" ry="1.016842" fill="#4d4d4d" stroke-width="4" stroke-linecap="round" stroke-linejoin="round"/>
    <path d="M5.865466 60.253708c2.521642.258451 5.042396.51681 4.411086.820414-.63131.303603-4.416986.652835-4.224443.970671.192542.317835 4.36002.604044 4.24887.991436-.111149.387393-4.504242.87629-4.482809 1.204577.021434.328287 4.454339.49583 4.535187.914613.08085.418783-4.193489 1.089267-4.318738 1.529318-.125249.44005 3.895722.649476 4.19647 1.008916.300747.359441-3.121579.869298-3.749962 1.183637-.628384.314339 1.535952.433028 3.699646.551682" id="path4630" fill="none" stroke="#9e4c34" stroke-width=".245669" stroke-linecap="round"/>
  </svg>
            `;e.mkPhotoCellPart=function(t=[0,0]){var[t,e]=t,t=t+-8,e=e+-7,i=a.svg.elt("image");return a.svg.hydrate(i,{class:"sim-led",x:t,y:e,width:68,height:180,href:a.svg.toDataUri(s)}),{el:i,x:t,y:e,w:68,h:180}},e.PhotoCellView=class{constructor(t){this.color="rgb(0,255,0)",this.parsePinString=t}init(t,e,i,s){this.pin=this.parsePinString(s.name||s.pin),this.bus=t,this.initDom(),this.updateState()}initDom(){this.element=a.svg.elt("g");var t=(new DOMParser).parseFromString(s,"image/svg+xml").querySelector("svg");a.svg.hydrate(t,{class:"sim-led",width:68,height:180}),this.text=t.getElementById("tspan4522"),this.element.appendChild(t),this.element.onclick=()=>{this.pin.value+=256,this.pin.value=this.pin.value%1024,a.runtime.queueDisplayUpdate()}}moveToCoord(t){e.translateEl(this.element,[t[0]+-8,t[1]+-7])}updateTheme(){}updateState(){this.currentValue===this.pin.value&&this.currentMode==this.pin.mode||(this.currentValue=this.pin.value,this.currentMode=this.pin.mode,this.text.textContent="~"+this.currentValue)}}}})(pxsim=pxsim||{}),(e=>{{var t=e.pins||(e.pins={});class i extends e.Pin{}t.CommonPin=i;class s extends i{}t.DigitalInOutPin=s;class a extends i{}t.AnalogInOutPin=a;class r extends i{}t.PwmOnlyPin=r;class n extends i{}t.PwmPin=n,t.markUsed=function(t){t&&!t.used&&(t.used=!0,e.runtime.queueDisplayUpdate())}}})(pxsim=pxsim||{}),(s=>{var t;function a(t,e,i){s.pins.markUsed(t),t.onEvent(e,i)}(t=s.DigitalInOutPinMethods||(s.DigitalInOutPinMethods={})).digitalRead=function(t){return s.pins.markUsed(t),t.digitalReadPin()},t.digitalWrite=function(t,e){s.pins.markUsed(t),t.digitalWritePin(e)},t.onPulsed=function(t,e,i){s.pins.markUsed(t),a(t,e?4:5,i)},t.onEvent=a,t.pulseIn=function(t,e,i=0){return s.pins.markUsed(t),500},t.setPull=function(t,e){s.pins.markUsed(t),t.setPull(e)},t.isPressed=function(t){return s.pins.markUsed(t),t.isTouched()}})(pxsim=pxsim||{}),(e=>{(e.AnalogInPinMethods||(e.AnalogInPinMethods={})).analogRead=function(t){return e.pins.markUsed(t),t.analogReadPin()}})(pxsim=pxsim||{}),(i=>{(i.AnalogOutPinMethods||(i.AnalogOutPinMethods={})).analogWrite=function(t,e){i.pins.markUsed(t),t.analogWritePin(e)}})(pxsim=pxsim||{}),(i=>{var t;(t=i.PwmOnlyPinMethods||(i.PwmOnlyPinMethods={})).analogSetPeriod=function(t,e){i.pins.markUsed(t),t.analogSetPeriod(e)},t.servoWrite=function(t,e){i.pins.markUsed(t),t.servoWritePin(e)},t.servoSetContinuous=function(t,e){i.pins.markUsed(t),t.servoSetContinuous(e)},t.servoSetPulse=function(t,e){i.pins.markUsed(t),t.servoSetPulse(t.id,e)}})(pxsim=pxsim||{}),(a=>{var r;(r=a.pins||(a.pins={})).pinByCfg=function(t){return t=a.pxtcore.getPinCfg(t),r.markUsed(t),t},r.pulseDuration=function(){return 500},r.createBuffer=function(t){return a.BufferMethods.createBuffer(t)},r.createI2C=function(t,e){var i=a.board();return r.markUsed(t),r.markUsed(e),i&&i.edgeConnectorState&&i.edgeConnectorState.createI2C(t,e)},r.createSPI=function(t,e,i){var s=a.board();return r.markUsed(t),r.markUsed(e),r.markUsed(i),s&&s.edgeConnectorState&&s.edgeConnectorState.createSPI(t,e,i)}})(pxsim=pxsim||{}),(a=>{var t;(t=a.I2CMethods||(a.I2CMethods={})).readBuffer=function(t,e,i,s){return a.control.createBuffer(0)},t.writeBuffer=function(t,e,i,s){return 0}})(pxsim=pxsim||{}),(t=>{(t=t.SPIMethods||(t.SPIMethods={})).write=function(t,e){return t.write(e)},t.transfer=function(t,e,i){t.transfer(e,i)},t.setFrequency=function(t,e){t.setFrequency(e)},t.setMode=function(t,e){t.setMode(e)}})(pxsim=pxsim||{}),(t=>{(t=t.SerialDeviceMethods||(t.SerialDeviceMethods={})).setTxBufferSize=function(t,e){t.setTxBufferSize(e)},t.setRxBufferSize=function(t,e){t.setRxBufferSize(e)},t.read=function(t){return t.read()},t.readBuffer=function(t){return t.readBuffer()},t.writeBuffer=function(t,e){t.writeBuffer(e)},t.setBaudRate=function(t,e){t.setBaudRate(e)},t.redirect=function(t,e,i,s){t.redirect(e,i,s)},t.onEvent=function(t,e,i){t.onEvent(e,i)},t.onDelimiterReceived=function(t,e,i){t.onDelimiterReceived(e,i)}})(pxsim=pxsim||{}),(a=>{(a.serial||(a.serial={})).internalCreateSerialDevice=function(t,e,i){var s=a.board();return s&&s.edgeConnectorState?s.edgeConnectorState.createSerialDevice(t,e,i):new a.SerialDevice(t,e,i)}})(pxsim=pxsim||{}),(a=>{{var e=a.visuals||(a.visuals={});let s=`<svg xmlns="http://www.w3.org/2000/svg" width="100mm" height="100mm" viewBox="0 0 100 100" id="svg8">
    <g id="layer1" transform="translate(0 -197)">
      <rect id="rect4508-3" width="6.054" height="32.94" x="43.381" y="210.817" rx="2.811" fill="#666" stroke="#000" stroke-width=".309"/>
      <rect id="rect4508-3-3" width="6.054" height="32.94" x="58.321" y="210.817" rx="2.811" fill="#666" stroke="#000" stroke-width=".309"/>
      <rect id="rect4508" width="6.054" height="32.94" x="28.44" y="210.817" rx="2.811" fill="#666" stroke="#000" stroke-width=".309"/>
      <rect id="rect4485" width="100.542" height="40.611" y="237.763" rx="3.432" stroke="#000" stroke-width=".309"/>
      <rect id="rect4487" width="60.587" height="18.323" x="7.977" y="248.907" rx="2.46" fill="#b3b3b3" stroke="#000" stroke-width=".262"/>
      <rect id="rect4487-7" width="53.273" height="10.029" x="11.2" y="253.384" rx="2.163" fill="#999" stroke="#000" stroke-width=".182"/>
      <rect id="handle" width="19.243" height="30.007" x="11.924" y="256.572" rx="3.432" fill="#4d4d4d" stroke="#000" stroke-width=".309"/>
      <text style="line-height:1.25" x="71.848" y="259.158" id="text" transform="scale(.97895 1.0215)" font-weight="400" font-size="17.409" font-family="sans-serif" letter-spacing="0" word-spacing="0" fill="#fff" stroke-width=".435">
        <tspan id="tspan4558" x="71.848" y="259.158" style="-inkscape-font-specification:Consolas" font-family="Consolas">OFF</tspan>
      </text>
    </g>
  </svg>
  `;e.mkSideSwitchPart=function(t=[0,0]){var[t,e]=t,t=t+-1,e=e+-30,i=a.svg.elt("image");return a.svg.hydrate(i,{class:"sim-led",x:t,y:e,width:100,height:100,href:a.svg.toDataUri(s)}),{el:i,x:t,y:e,w:100,h:100}},e.ToggleComponentVisual=class{constructor(t){this.currentlyOn=!1,this.element=a.svg.elt("g"),this.element.onclick=()=>{this.state&&(this.state.toggle(),a.runtime.queueDisplayUpdate())},this.onElement=this.initImage(`<svg xmlns="http://www.w3.org/2000/svg" width="100mm" height="100mm" viewBox="0 0 100 100" id="svg8">
  <g id="layer1" transform="translate(0 -197)">
    <g id="g4509" transform="matrix(1.14409 0 0 1.19383 -7.582 -50.118)">
      <rect rx="2.457" y="218.57" x="44.544" height="27.592" width="5.292" id="rect4508-3" fill="#666" stroke="#000" stroke-width=".265"/>
      <rect rx="2.457" y="218.57" x="57.604" height="27.592" width="5.292" id="rect4508-3-3" fill="#666" stroke="#000" stroke-width=".265"/>
      <rect rx="2.457" y="218.57" x="31.485" height="27.592" width="5.292" id="rect4508" fill="#666" stroke="#000" stroke-width=".265"/>
      <rect rx="3" y="241.141" x="6.627" height="34.018" width="87.879" id="rect4485" fill="#450" stroke="#000" stroke-width=".265"/>
      <rect rx="2.15" y="250.476" x="13.6" height="15.348" width="52.957" id="rect4487" fill="#b3b3b3" stroke="#000" stroke-width=".224"/>
      <rect rx="1.89" y="254.226" x="16.417" height="8.4" width="46.564" id="rect4487-7" fill="#999" stroke="#000" stroke-width=".156"/>
      <rect rx="3" y="256.897" x="46.189" height="25.135" width="16.82" id="handle" fill="#4d4d4d" stroke="#000" stroke-width=".265"/>
      <text id="text" y="263.731" x="68.105" style="line-height:1.25" font-weight="400" font-size="14.896" font-family="sans-serif" letter-spacing="0" word-spacing="0" fill="#fff" stroke-width=".372">
        <tspan style="-inkscape-font-specification:Consolas" y="263.731" x="68.105" id="tspan4558" font-family="Consolas">ON</tspan>
      </text>
    </g>
  </g>
</svg>
`),this.offElement=this.initImage(s),this.element.appendChild(this.offElement),this.parsePinString=t}moveToCoord(t){t=[t[0]+-1,t[1]+-30];e.translateEl(this.element,t)}init(t,e,i,s){this.state=e(this.parsePinString(s.pin)),this.updateState()}updateState(){this.state.on()!==this.currentlyOn&&(this.currentlyOn=this.state.on(),this.state.on()?(this.element.removeChild(this.offElement),this.element.appendChild(this.onElement)):(this.element.removeChild(this.onElement),this.element.appendChild(this.offElement)))}updateTheme(){}initImage(t){t="data:image/svg+xml,"+encodeURIComponent(t);return e.mkImageSVG({image:t,width:100,height:100,imageUnitDist:15,targetUnitDist:e.PIN_DIST}).el}}}})(pxsim=pxsim||{}),(pxsim||(pxsim={})).ToggleState=class{constructor(t){this.pin=t}toggle(){var t=!!this.pin.value;this.pin.setValue(t?0:1023)}on(){return 0<this.pin.value}},(o=>{var t,e;t=o.keymap||(o.keymap={}),(e=t.Key||(t.Key={}))[e.None=0]="None",e[e.Left=1]="Left",e[e.Up=2]="Up",e[e.Right=3]="Right",e[e.Down=4]="Down",e[e.A=5]="A",e[e.B=6]="B",e[e.Menu=7]="Menu",e[e.Screenshot=-1]="Screenshot",e[e.Gif=-2]="Gif",e[e.Reset=-3]="Reset",e[e.TogglePause=-4]="TogglePause",t._setPlayerKeys=function(t,e,i,s,a,r,n){o.getKeymapState().setPlayerKeys(t,e,i,s,a,r,n)},t._setSystemKeys=function(t,e,i,s){o.getKeymapState().setSystemKeys(t,e,i,s)}})(pxsim=pxsim||{}),(t=>{var l=t.keymap.Key;t.getKeymapState=function(){return t.board().keymapState};let c=[27,9];t.KeymapState=class{constructor(){this.keymap={},this.altmap={},this.mappings={},this.setPlayerKeys(1,87,83,65,68,32,13),this.setPlayerKeys(2,73,75,74,76,85,79),this.setSystemKeys(80,82,192,8),this.altmap[38]=l.Up,this.altmap[37]=l.Left,this.altmap[40]=l.Down,this.altmap[39]=l.Right,this.altmap[81]=l.A,this.altmap[90]=l.A,this.altmap[88]=l.B,this.altmap[69]=l.B}setPlayerKeys(t,e,i,s,a,r,n){var o,h;t<1||4<t||(o=[e,i,s,a,r,n]).filter(t=>c.includes(t)).length||(this.clearMap(h="player-"+t),this.altmap={},this.keymap[e]=l.Up+(e=7*(t-1)),this.keymap[i]=l.Down+e,this.keymap[s]=l.Left+e,this.keymap[a]=l.Right+e,this.keymap[r]=l.A+e,this.keymap[n]=l.B+e,this.saveMap(h,o))}setSystemKeys(t,e,i,s){this.clearMap("system"),this.keymap[t]=l.Screenshot,this.keymap[e]=l.Gif,this.keymap[i]=l.Menu,this.keymap[s]=l.Reset,this.saveMap("system",[t,e,i,s])}getKey(t){return t&&(this.keymap[t]||this.altmap[t])||l.None}saveMap(t,e){this.mappings[t]=e}clearMap(t){var e=this.mappings[t];e&&e.forEach(t=>delete this.keymap[t]),delete this.mappings[t]}}})(pxsim=pxsim||{}),(a=>{{var t=a.multiplayer||(a.multiplayer={});let i=a.U.throttle(t=>{a.getMultiplayerState().send(t)},50,!0);t.postImage=function(t){var e;"server"===a.getMultiplayerState().origin&&(t=a.image.toBuffer(t),e=(e=a.board())&&e.screenState,i({content:"Image",image:t,palette:e&&e.paletteToUint8Array()}))},t.postIcon=function(t,e,i){var s;i&&4096<i._width*i._height||(i=i&&i.data.some(t=>0!=t)?a.image.toBuffer(i):void 0,s=(s=a.board())&&s.screenState,a.getMultiplayerState().send({content:"Icon",slot:e,icon:i,iconType:t,palette:s.paletteToUint8Array()}))},t.getCurrentImage=function(){return a.getMultiplayerState().backgroundImage},t.setOrigin=function(t){a.getMultiplayerState().origin=t},t.getOrigin=function(){return a.getMultiplayerState().origin}}})(pxsim=pxsim||{}),(i=>{var t;i.getMultiplayerState=function(){return i.board().multiplayerState},(t=i.IconType||(i.IconType={}))[t.Player=0]="Player",t[t.Reaction=1]="Reaction",i.MultiplayerState=class{constructor(){this.lastMessageId=0}send(t){i.Runtime.postMessage(Object.assign(Object.assign({},t),{broadcast:!0,toParentIFrameOnly:!0,type:"multiplayer",origin:this.origin,id:this.lastMessageId++}))}init(t){this.origin=t,i.runtime.board.addMessageListener(t=>this.messageHandler(t)),"server"===this.origin?i.AudioContextManager.soundEventCallback=(t,e)=>{this.send({content:"Audio",instruction:t,soundbuf:e})}:i.AudioContextManager.soundEventCallback=void 0}setButton(t,e){"client"===this.origin&&this.send({content:"Button",button:t,state:e?"Pressed":"Released"})}registerConnectionState(t,e){e=e?3241:3242;i.board().bus.queue(e,t)}messageHandler(t){var e;(e=t)&&"multiplayer"===e.type&&((e=t)&&"Image"===e.content?"client"===this.origin&&(ArrayBuffer.isView(t.image.data)||(t.image.data=new Uint8Array(t.image.data)),this.backgroundImage=i.image.ofBuffer(t.image),t.palette)&&48===t.palette.length&&(e=new i.RefBuffer(t.palette),i.pxtcore.setPalette(e)):(e=t)&&"Button"===e.content?"server"===this.origin&&i.board().handleKeyEvent(t.button+7*(t.clientNumber||1),"Pressed"===t.state||"Held"===t.state):(e=t)&&"Audio"===e.content?"client"===this.origin&&("playinstructions"===t.instruction?i.AudioContextManager.playInstructionsAsync(t.soundbuf):"muteallchannels"===t.instruction&&i.AudioContextManager.muteAllChannels()):(e=t)&&"Connection"===e.content&&this.registerConnectionState(t.slot,t.connected))}}})(pxsim=pxsim||{}),(t=>{(t=t.gamepad||(t.gamepad={})).setButton=function(t,e){},t.move=function(t,e,i){},t.setThrottle=function(t,e){}})(pxsim=pxsim||{}),(e=>{var t;(t=e.network||(e.network={})).infraredSendPacket=function(t){e.getInfraredState().send(t)},t.infraredPacket=function(){return e.getInfraredState().packet},t.onInfraredPacket=function(t){e.getInfraredState().listen(t)},t.onInfraredError=function(t){e.getInfraredState().listenError(t)}})(pxsim=pxsim||{}),(e=>{e.InfraredState=class{constructor(t){this.board=t,this.packetReceived=!1,this.IR_COMPONENT_ID=8258,this.IR_PACKET_EVENT=2,this.IR_PACKET_ERROR_EVENT=3,this.board.addMessageListener(this.handleMessage.bind(this))}handleMessage(t){"irpacket"===t.type&&this.receive(t.packet)}send(t){e.Runtime.postMessage({type:"irpacket",packet:t.data,broadcast:!0})}listen(t){e.pxtcore.registerWithDal(this.IR_COMPONENT_ID,this.IR_PACKET_EVENT,t)}listenError(t){e.pxtcore.registerWithDal(this.IR_COMPONENT_ID,this.IR_PACKET_ERROR_EVENT,t)}receive(t){this.packet=new e.RefBuffer(t),this.packetReceived=!0,e.board().bus.queue(this.IR_COMPONENT_ID,this.IR_PACKET_EVENT)}},e.getInfraredState=function(){return e.board().irState}})(pxsim=pxsim||{}),(t=>{{t=t.keyboard||(t.keyboard={});let i=["press","up","down"];t.__flush=function(){console.log("kb: flush")},t.__type=function(t){console.log("kb: type "+t)},t.__key=function(t,e){console.log(`kb: key ${t} `+i[e])},t.__mediaKey=function(t,e){console.log(`kb: media ${t} `+i[e])},t.__functionKey=function(t,e){console.log(`kb: function ${t} `+i[e])},t.__modifierKey=function(t,e){console.log(`kb: modifier ${t} `+i[e])}}})(pxsim=pxsim||{}),(t=>{t.LCDState=class{constructor(t=2,e=16){this.lines=0,this.columns=0,this.backLightColor="#6e7d6e",this.cursor=!1,this.display=!1,this.blink=!1,this.sensorUsed=!1,this.lines=t,this.columns=e,this.clear()}clear(){let e="";for(let t=0;t<this.columns;++t)e+=" ";this.text=[];for(let t=0;t<this.lines;++t)this.text.push(e);this.cursorPos=[0,0]}setUsed(){this.sensorUsed||(this.sensorUsed=!0,t.runtime.queueDisplayUpdate())}},t.lcdState=function(){return t.board().lcdState}})(pxsim=pxsim||{}),(n=>{{var t=n.lcd||(n.lcd={});let r=[0,64,20,84];t.__write8=function(e,t){var i=n.lcdState();if(i){if(i.setUsed(),t){var t=i.cursorPos[0],s=i.cursorPos[1],a=i.text[s];void 0!==a&&0<=t&&t<a.length&&(i.text[s]=a.substring(0,t)+n.String_.fromCharCode(e)+a.substring(t+1),i.cursorPos[0]++)}else if(128&e){e=~(128|~e);for(let t=r.length-1;0<=t;t--)if((e&r[t])==r[t]||0==t){i.cursorPos[0]=e-r[t],i.cursorPos[1]=t;break}}else 1==e?i.clear():8==(8&e)?(i.display=4==(4&e),i.cursor=2==(2&e),i.blink=1==(1&e)):2==e&&(i.cursorPos=[0,0]);n.runtime.queueDisplayUpdate()}}}})(pxsim=pxsim||{}),(h=>{{var e=h.visuals||(h.visuals={});e.mkLCDPart=function(t=[0,0]){var[t,e]=t,i=r,s=n,a=h.svg.elt("image");return h.svg.hydrate(a,{class:"sim-lcd",x:t,y:e,width:i,height:s,href:h.svg.toDataUri(o)}),{el:a,x:t,y:e,w:i,h:s}},e.LCDView=class{constructor(){}init(t,e,i,s){this.state=e,this.bus=t,this.initDom(),this.updateState()}initDom(){this.element=h.svg.elt("g"),this.image=(new DOMParser).parseFromString(o,"image/svg+xml").querySelector("svg"),h.svg.hydrate(this.image,{class:"sim-lcd",width:r,height:n}),this.screen=this.image.getElementById("ecran"),this.backlight=this.image.getElementById("backlight"),this.backlight.style.fill="#6e7d6e",this.element.appendChild(this.image)}setChar(t,e,i){this.image.getElementById("case"+e+t+"_text").innerHTML=i.charAt(0)}moveToCoord(t){e.translateEl(this.element,[t[0],t[1]])}updateTheme(){}updateState(){for(let e=0;e<this.state.lines;e++)for(let t=0;t<this.state.columns;t++)this.state.text&&this.state.text[e]&&this.state.text[e][t]&&this.setChar(t,e,this.state.text[e][t]);this.backlight.style.fill=this.state.backLightColor}};let r=322.79001,n=129.27348,o=`
    <svg xmlns="http://www.w3.org/2000/svg" id="LCD" width="322.8" height="129.3" viewBox="0 0 322.8 129.3">
    <defs id="defs2284">
      <style id="style2282">
        .cls-textCase{fill:#000;fill-opacity:.8;font-family:monospace;font-weight:100;font-size:24px}.cls-case{fill:#fff;fill-opacity:.1}
      </style>
    </defs>
    <path id="rect4820" fill="#6767ff" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".7" d="M.3.3h322.1v128.6H.3z"/>
    <path id="path132" fill="#303030" stroke-width=".9" d="M308.6 93c-1 0-1.9-.8-1.9-1.8V57.7c0-1 .9-1.8 1.9-1.8V29h-.9l-2.9-2.6v-1H18v1L15.1 29h-1V56h.1c1 0 1.9.8 1.9 1.8v33.5c0 1-.8 1.8-1.9 1.8v26.9h1l2.8 2.6v1h286.8v-1l2.9-2.6h1V93z"/>
    <g id="g140" transform="matrix(.95829 0 0 .88143 -10.2 -3.4)">
      <path id="backlight" d="M319.6 118.3a6 6 0 0 1-6 6h-269a6 6 0 0 1-6-6v-60a6 6 0 0 1 6-6h269a6 6 0 0 1 6 6z" class="cls-backlight"/>
      <g id="g138" opacity=".2">
        <path id="path136" fill="#22420d" d="M319.6 58.3v60-60zm-275-6a6 6 0 0 0-6 6v60a6 6 0 0 0 6 6H48a6 6 0 0 1-6-6v-58a6 6 0 0 1 6-6h270c-1-1.1-2.6-2-4.4-2h-269z"/>
      </g>
    </g>
    <g id="g146" transform="matrix(.95829 0 0 .88143 -10.2 -3.4)">
      <path id="path142" fill="#1a1a1a" d="M322 40.5c0-1-.8-2-1.9-2h-282c-1.1 0-2 1-2 2v1.1c0 1.1.9 2 2 2h282c1 0 2-.9 2-2v-1z"/>
      <path id="path144" fill="#424242" d="M321 42.3c0-.7-.6-1.3-1.3-1.3h-281c-.9 0-1.5.6-1.5 1.3 0 .7.6 1.3 1.4 1.3h281c.8 0 1.5-.6 1.5-1.3z"/>
    </g>
    <g id="g152" transform="matrix(.95829 0 0 .88143 -10.2 -3.4)">
      <path id="path148" fill="#1a1a1a" d="M322 134c0-1-.8-1.9-1.9-1.9h-282c-1.1 0-2 .9-2 2v1c0 1.1.9 2 2 2h282c1 0 2-.9 2-2v-1z"/>
      <path id="path150" fill="#424242" d="M321 135.8c0-.7-.6-1.3-1.3-1.3h-281c-.9 0-1.5.6-1.5 1.3 0 .8.6 1.3 1.4 1.3h281c.8 0 1.5-.5 1.5-1.3z"/>
    </g>
    <g id="g158" fill-opacity="0" stroke="#f2f2f2" stroke-linecap="round" stroke-opacity=".2" stroke-width=".2" transform="matrix(.95829 0 0 .88143 -10.2 -3.4)">
      <path id="path154" d="M27 37.4l3.2-3"/>
      <path id="path156" d="M30.2 143.3l-3.1-3.1"/>
    </g>
    <g id="g164" fill-opacity="0" stroke="#f2f2f2" stroke-linecap="round" stroke-opacity=".2" stroke-width=".2" transform="matrix(.95829 0 0 .88143 -10.2 -3.4)">
      <path id="path160" d="M332.1 37.4l-3.1-3"/>
      <path id="path162" d="M329 143.3l3-3.1"/>
    </g>
    <path id="path166" fill-opacity="0" stroke="#1a1a1a" stroke-opacity=".4" stroke-width="1.3" d="M296.5 101.4c0 2.8-2.6 5.2-5.7 5.2H33c-3 0-5.6-2.4-5.6-5.2v-53c0-2.8 2.5-5.2 5.6-5.2h258c3 0 5.6 2.4 5.6 5.2z"/>
    <g id="ecran" transform="matrix(1.02697 0 0 1.04868 -20.3 -17.7)">
      <path id="case10" fill="#fff" fill-opacity=".1" d="M52.9 88.8h14.8v24.4H52.9z" class="cls-case"/>
      <path id="case11" fill="#fff" fill-opacity=".1" d="M68.7 88.8h14.8v24.4H68.7z" class="cls-case"/>
      <path id="case12" fill="#fff" fill-opacity=".1" d="M84.6 88.8h14.8v24.4H84.5z" class="cls-case"/>
      <path id="case13" fill="#fff" fill-opacity=".1" d="M100.4 88.8h14.8v24.4h-14.8z" class="cls-case"/>
      <path id="case14" fill="#fff" fill-opacity=".1" d="M116.3 88.8H131v24.4h-14.7z" class="cls-case"/>
      <path id="case15" fill="#fff" fill-opacity=".1" d="M132 88.8H147v24.4H132z" class="cls-case"/>
      <path id="case16" fill="#fff" fill-opacity=".1" d="M148 88.8h14.7v24.4H148z" class="cls-case"/>
      <path id="case17" fill="#fff" fill-opacity=".1" d="M163.8 88.8h14.8v24.4h-14.8z" class="cls-case"/>
      <path id="case18" fill="#fff" fill-opacity=".1" d="M179.6 88.8h14.8v24.4h-14.8z" class="cls-case"/>
      <path id="case19" fill="#fff" fill-opacity=".1" d="M195.5 88.8h14.7v24.4h-14.7z" class="cls-case"/>
      <path id="case110" fill="#fff" fill-opacity=".1" d="M211.3 88.8h14.8v24.4h-14.8z" class="cls-case"/>
      <path id="case111" fill="#fff" fill-opacity=".1" d="M227.1 88.8H242v24.4h-14.8z" class="cls-case"/>
      <path id="case112" fill="#fff" fill-opacity=".1" d="M243 88.8h14.8v24.4H243z" class="cls-case"/>
      <path id="case113" fill="#fff" fill-opacity=".1" d="M258.8 88.8h14.8v24.4h-14.8z" class="cls-case"/>
      <path id="case114" fill="#fff" fill-opacity=".1" d="M274.7 88.8h14.7v24.4h-14.7z" class="cls-case"/>
      <path id="case115" fill="#fff" fill-opacity=".1" d="M290.5 88.8h14.8v24.4h-14.8z" class="cls-case"/>
      <text id="case10_text" x="52.9" y="112.9" class="cls-textCase"/>
      <text id="case11_text" x="68.7" y="112.9" class="cls-textCase"/>
      <text id="case12_text" x="84.6" y="112.9" class="cls-textCase"/>
      <text id="case13_text" x="100.4" y="112.9" class="cls-textCase"/>
      <text id="case14_text" x="116.3" y="112.9" class="cls-textCase"/>
      <text id="case15_text" x="132.1" y="112.9" class="cls-textCase"/>
      <text id="case16_text" x="147.9" y="112.9" class="cls-textCase"/>
      <text id="case17_text" x="163.8" y="112.9" class="cls-textCase"/>
      <text id="case18_text" x="179.6" y="112.9" class="cls-textCase"/>
      <text id="case19_text" x="195.5" y="112.9" class="cls-textCase"/>
      <text id="case110_text" x="211.3" y="112.9" class="cls-textCase"/>
      <text id="case111_text" x="227.1" y="112.9" class="cls-textCase"/>
      <text id="case112_text" x="243" y="112.9" class="cls-textCase"/>
      <text id="case113_text" x="258.8" y="112.9" class="cls-textCase"/>
      <text id="case114_text" x="274.7" y="112.9" class="cls-textCase"/>
      <text id="case115_text" x="290.5" y="112.9" class="cls-textCase"/>
      <path id="case00" fill="#fff" fill-opacity=".1" d="M52.9 63.5h14.8v24.3H52.9z" class="cls-case"/>
      <path id="case01" fill="#fff" fill-opacity=".1" d="M68.7 63.5h14.8v24.3H68.7z" class="cls-case"/>
      <path id="case02" fill="#fff" fill-opacity=".1" d="M84.6 63.5h14.8v24.3H84.5z" class="cls-case"/>
      <path id="case03" fill="#fff" fill-opacity=".1" d="M100.4 63.5h14.8v24.3h-14.8z" class="cls-case"/>
      <path id="case04" fill="#fff" fill-opacity=".1" d="M116.3 63.5H131v24.3h-14.7z" class="cls-case"/>
      <path id="case05" fill="#fff" fill-opacity=".1" d="M132 63.5H147v24.3H132z" class="cls-case"/>
      <path id="case06" fill="#fff" fill-opacity=".1" d="M148 63.5h14.7v24.3H148z" class="cls-case"/>
      <path id="case07" fill="#fff" fill-opacity=".1" d="M163.8 63.5h14.8v24.3h-14.8z" class="cls-case"/>
      <path id="case08" fill="#fff" fill-opacity=".1" d="M179.6 63.5h14.8v24.3h-14.8z" class="cls-case"/>
      <path id="case09" fill="#fff" fill-opacity=".1" d="M195.5 63.5h14.7v24.3h-14.7z" class="cls-case"/>
      <path id="case010" fill="#fff" fill-opacity=".1" d="M211.3 63.5h14.8v24.3h-14.8z" class="cls-case"/>
      <path id="case011" fill="#fff" fill-opacity=".1" d="M227.1 63.5H242v24.3h-14.8z" class="cls-case"/>
      <path id="case012" fill="#fff" fill-opacity=".1" d="M243 63.5h14.8v24.3H243z" class="cls-case"/>
      <path id="case013" fill="#fff" fill-opacity=".1" d="M258.8 63.5h14.8v24.3h-14.8z" class="cls-case"/>
      <path id="case014" fill="#fff" fill-opacity=".1" d="M274.7 63.5h14.7v24.3h-14.7z" class="cls-case"/>
      <path id="case015" fill="#fff" fill-opacity=".1" d="M290.5 63.5h14.8v24.3h-14.8z" class="cls-case"/>
      <text id="case00_text" x="52.9" y="87.5" class="cls-textCase"/>
      <text id="case01_text" x="68.7" y="87.5" class="cls-textCase"/>
      <text id="case02_text" x="84.6" y="87.5" class="cls-textCase"/>
      <text id="case03_text" x="100.4" y="87.5" class="cls-textCase"/>
      <text id="case04_text" x="116.3" y="87.5" class="cls-textCase"/>
      <text id="case05_text" x="132.1" y="87.5" class="cls-textCase"/>
      <text id="case06_text" x="147.9" y="87.5" class="cls-textCase"/>
      <text id="case07_text" x="163.8" y="87.5" class="cls-textCase"/>
      <text id="case08_text" x="179.6" y="87.5" class="cls-textCase"/>
      <text id="case09_text" x="195.5" y="87.5" class="cls-textCase"/>
      <text id="case010_text" x="211.3" y="87.5" class="cls-textCase"/>
      <text id="case011_text" x="227.1" y="87.5" class="cls-textCase"/>
      <text id="case012_text" x="243" y="87.5" class="cls-textCase"/>
      <text id="case013_text" x="258.8" y="87.5" class="cls-textCase"/>
      <text id="case014_text" x="274.7" y="87.5" class="cls-textCase"/>
      <text id="case015_text" x="290.5" y="87.5" class="cls-textCase"/>
    </g>
    <g id="g238" fill="#606060" transform="matrix(.95829 0 0 .88143 -10.2 -3.4)">
      <path id="path234" d="M25.8 109.3v30.6h.4v-30.7h-.4z"/>
      <path id="path236" d="M26.2 67.5V36.7h-.4v30.7h.4z"/>
    </g>
    <g id="g248" fill="#212121" transform="matrix(.95829 0 0 .88143 -10.2 -3.4)">
      <path id="path244" d="M25.5 67.3h.4V36.8h-.5v30.6z"/>
      <path id="path246" d="M25.5 109.3h-.1V140h.5v-30.6h-.4z"/>
    </g>
    <path id="path250" fill="#212121" stroke-width=".9" d="M18 123.1h286.8v.5H18z"/>
    <path id="path252" fill="#606060" stroke-width=".9" d="M18 122.8h286.8v.3H18z"/>
    <g id="g258" fill="#212121" transform="matrix(.95829 0 0 .88143 -10.2 -3.4)">
      <path id="path254" d="M332.7 109.3h-.4v30.6h.5v-30.6z"/>
      <path id="path256" d="M332.7 67.3V36.7h-.4v30.7h.4z"/>
    </g>
    <g id="g264" fill="#606060" transform="matrix(.95829 0 0 .88143 -10.2 -3.4)">
      <path id="path260" d="M332 109.2v30.7h.3v-30.6l-.4-.1z"/>
      <path id="path262" d="M332.3 67.4V36.7h-.4v30.8l.4-.1z"/>
    </g>
    <path id="GND2" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6" d="M12 8h9.7v9.7H12z"/>
    <path id="LCD_DATALINE5" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6" d="M175 8h9.7v9.7H175z"/>
    <path id="rect4824-7" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6" d="M145.3 8h9.7v9.7h-9.7z"/>
    <path id="rect4824-1" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6" d="M130.5 8h9.7v9.7h-9.7z"/>
    <path id="rect4824-2" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6" d="M115.7 8h9.7v9.7h-9.7z"/>
    <path id="rect4824-24" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6" d="M100.9 8h9.7v9.7h-9.7z"/>
    <path id="LCD_ENABLE" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6" d="M86.1 8h9.7v9.7h-9.7z"/>
    <path id="rw" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6" d="M71.2 8h9.7v9.7h-9.7z"/>
    <path id="LCD_RESET" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6" d="M56.4 8h9.7v9.7h-9.7z"/>
    <path id="GND4" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6" d="M41.6 8h9.7v9.7h-9.7z"/>
    <path id="VCC2" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6" d="M26.8 8h9.7v9.7h-9.7z"/>
    <path id="LCD_DATALINE6" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6" d="M189.8 8h9.7v9.7h-9.7z"/>
    <path id="LCD_DATALINE4" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6" d="M160.1 8h9.7v9.7h-9.7z"/>
    <path id="VCC" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6" d="M219.4 8h9.7v9.7h-9.7z"/>
    <path id="LCD_DATALINE7" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6" d="M204.6 8h9.7v9.7h-9.7z"/>
    <path id="GND" stroke="#fff" stroke-linecap="round" stroke-linejoin="round" stroke-width=".6" d="M234.2 8h9.7v9.7h-9.7z"/>
  </svg>
        `}})(pxsim=pxsim||{}),(s=>{var t;(t=s.input||(s.input={})).lightLevel=function(){var t=s.lightSensorState();return t.setUsed(),t.getLevel()},t.onLightConditionChanged=function(t,e){var i=s.lightSensorState();i.setUsed(),s.pxtcore.registerWithDal(i.id,t,e)},t.setLightThreshold=function(t,e){var i=s.lightSensorState();switch(i.setUsed(),t){case 1:i.setLowThreshold(e);break;case 2:i.setHighThreshold(e)}}})(pxsim=pxsim||{}),(t=>{t.lightSensorState=function(){return t.board().lightSensorState}})(pxsim=pxsim||{}),(i=>{var t;(t=i.input||(i.input={})).soundLevel=function(){var t=i.microphoneState();return t?(t.setUsed(),t.getLevel()):0},t.onLoudSound=function(t){var e=i.microphoneState();e&&(e.setUsed(),i.pxtcore.registerWithDal(e.id,2,t))},t.setLoudSoundThreshold=function(t){var e=i.microphoneState();e&&(e.setUsed(),e.setHighThreshold(t))}})(pxsim=pxsim||{}),(t=>{class e extends t.AnalogSensorState{constructor(){super(...arguments),this.onSoundRegistered=!1,this.soundLevelRequested=!1,this.pingSoundLevel=()=>{this.onSoundRegistered||(this.soundLevelRequested=!0,t.runtime.queueDisplayUpdate(),clearTimeout(this.pingUsed),this.pingUsed=setTimeout(()=>{this.soundLevelRequested=!1,t.runtime.queueDisplayUpdate(),this.pingUsed=void 0},100))}}}t.MicrophoneState=e,t.microphoneState=function(){return t.board().microphoneState}})(pxsim=pxsim||{}),(s=>{{var a=s.music||(s.music={});a.playInstructions=function(t){return s.AudioContextManager.playInstructionsAsync(t.data)},a.queuePlayInstructions=function(t,e){s.AudioContextManager.queuePlayInstructions(t,e)},a.stopPlaying=function(){if(s.AudioContextManager.muteAllChannels(),i)for(var t of i)t.sequencer.stop(),t.sequencer.dispose()},a.forceOutput=function(t){},a.SEQUENCER_STOP_MESSAGE=3243,a.SEQUENCER_TICK_MESSAGE=3244,a.SEQUENCER_STATE_CHANGE_MESSAGE=3245,a.SEQUENCER_LOOPED_MESSAGE=3246;let i,e=0;function r(t){for(var e of i)if(e.id===t)return e.sequencer}a._createSequencer=async function(){i||(s.AudioContextManager.onStopAll(()=>{for(var t of i)t.sequencer.stop(),t.sequencer.dispose();i=[]}),i=[]);let t={id:e++,sequencer:new a.Sequencer};return i.push(t),await t.sequencer.initAsync(),t.sequencer.addEventListener("stop",()=>{s.board().bus.queue(a.SEQUENCER_STOP_MESSAGE,t.id)}),t.sequencer.addEventListener("state-change",()=>{s.board().bus.queue(a.SEQUENCER_STATE_CHANGE_MESSAGE,t.id)}),t.sequencer.addEventListener("looped",()=>{s.board().bus.queue(a.SEQUENCER_LOOPED_MESSAGE,t.id)}),t.sequencer.addEventListener("tick",()=>{s.board().bus.queue(a.SEQUENCER_TICK_MESSAGE,t.id)}),t.id},a._sequencerState=function(t){return null==(t=r(t))?void 0:t.state()},a._sequencerCurrentTick=function(t){return null==(t=r(t))?void 0:t.currentTick()},a._sequencerPlaySong=function(t,e,i){e=a.decodeSong(e.data),null!=(t=r(t))&&t.start(e,i)},a._sequencerStop=function(t){null!=(t=r(t))&&t.stop()},a._sequencerSetVolume=function(t,e){null!=(t=r(t))&&t.setVolume(e)},a._sequencerSetVolumeForAll=function(t){for(var e of i)e.sequencer.setVolume(t)},a._sequencerSetTrackVolume=function(t,e,i){null!=(t=r(t))&&t.setTrackVolume(e,i)},a._sequencerSetDrumTrackVolume=function(t,e,i,s){null!=(t=r(t))&&t.setDrumTrackVolume(e,i,s)},a._sequencerDispose=function(e){var t;null!=(t=r(e))&&t.dispose(),i=i.filter(t=>t.id!==e)}}})(pxsim=pxsim||{}),(t=>{(t=t.mouse||(t.mouse={})).setButton=function(t,e){},t.move=function(t,e){},t.turnWheel=function(t){}})(pxsim=pxsim||{}),(pxsim||(pxsim={})).AudioState=class{constructor(){this.outputDestination_=0,this.volume=100,this.playing=!1}startPlaying(){this.playing=!0}stopPlaying(){this.playing=!1}isPlaying(){return this.playing}},(a=>{var t;(t=a.music||(a.music={})).noteFrequency=function(t){return t},t.setOutput=function(t){a.getAudioState().outputDestination_=t},t.setVolume=function(t){a.getAudioState().volume=Math.max(0,1024,4*t)},t.setPitchPin=function(t){a.getAudioState().pitchPin_=t},t.setTone=function(t){},t.enableAmp=function(t){},t.playTone=function(i,s){if(a.board()){let t=a.getAudioState();t.outputDestination_;t.startPlaying(),a.runtime.queueDisplayUpdate(),a.AudioContextManager.tone(i,1);let e=a.getResume();s<=0?e():a.runtime.schedule(()=>{a.AudioContextManager.stop(),t.stopPlaying(),a.runtime.queueDisplayUpdate(),e()},s)}}})(pxsim=pxsim||{}),(t=>{t.getAudioState=function(){return t.board().audioState}})(pxsim=pxsim||{}),(a=>{var t;(t=a.radio||(a.radio={})).raiseEvent=function(t,e){a.getRadioState().raiseEvent(t,e)},t.setGroup=function(t){a.getRadioState().setGroup(t)},t.setTransmitPower=function(t){a.getRadioState().setTransmitPower(t)},t.setFrequencyBand=function(t){a.getRadioState().setFrequencyBand(t)},t.sendRawPacket=function(t){var e=a.getResume(),i=a.getRadioState();i.enable&&i.datagram.send({type:0,groupId:i.groupId,bufferData:t.data}),setTimeout(e,1)},t.readRawPacket=function(){var t=a.getRadioState().datagram.recv(),e=t.payload.bufferData,i=e.length;if(i){var s=a.BufferMethods.createBuffer(i+4);for(let t=0;t<e.length;++t)s.data[t]=e[t];return a.BufferMethods.setNumber(s,a.BufferMethods.NumberFormat.Int32LE,i,t.rssi),s}},t.onDataReceived=function(t){a.getRadioState().datagram.onReceived(t)},t.off=function(){a.getRadioState().off()},t.on=function(){a.getRadioState().on()}})(pxsim=pxsim||{}),(i=>{function s(){return i.board().radioState}i.getRadioState=s;class a{constructor(t,e){this.runtime=t,this.dal=e,this.datagram=[],this.lastReceived=a.defaultPacket(),this._rssi=void 0}get rssi(){return this._rssi}set rssi(t){this._rssi=0|t}queue(t){this.datagram.length<4&&this.datagram.push(t),i.runtime.board.bus.queue(this.dal.ID_RADIO,this.dal.RADIO_EVT_DATAGRAM)}send(t){var e=s();i.Runtime.postMessage({type:"radiopacket",broadcast:!0,rssi:this._rssi||-75,serial:e.transmitSerialNumber?i.control.deviceSerialNumber():0,time:(new Date).getTime(),payload:t})}recv(){let t=this.datagram.shift();return t=t||a.defaultPacket(),this.lastReceived=t}onReceived(t){i.pxtcore.registerWithDal(this.dal.ID_RADIO,this.dal.RADIO_EVT_DATAGRAM,t),this.recv()}static defaultPacket(){return{rssi:-1,serial:0,time:0,payload:{type:-1,groupId:0,bufferData:new Uint8Array(0)}}}}i.RadioDatagram=a,i.RadioState=class{constructor(t,e,i){this.runtime=t,this.board=e,this.power=0,this.transmitSerialNumber=!1,this.datagram=new a(t,i),this.power=6,this.groupId=0,this.band=7,this.enable=!0,this.board.addMessageListener(this.handleMessage.bind(this))}handleMessage(t){"radiopacket"==t.type&&this.receivePacket(t)}setGroup(t){this.enable&&(this.groupId=255&t)}setTransmitPower(t){this.enable&&(t|=0,this.power=Math.max(0,Math.min(7,t)))}setTransmitSerialNumber(t){this.transmitSerialNumber=!!t}setFrequencyBand(t){!this.enable||(t|=0)<0||83<t||(this.band=t)}off(){this.enable=!1}on(){this.enable=!0}raiseEvent(t,e){this.enable&&i.Runtime.postMessage({type:"eventbus",broadcast:!0,id:t,eventid:e,power:this.power,group:this.groupId})}receivePacket(t){this.enable&&this.groupId==t.payload.groupId&&this.datagram.queue(t)}}})(pxsim=pxsim||{}),(e=>{{var t=e.encoders||(e.encoders={});t.createRotaryEncoder=function(t,e){return new i(t,e,0)};class i{constructor(t,e,i){this.pinA=t,this.pinB=e,this.position=i}get id(){return this.pinA.id}onChanged(t){e.control.internalOnEvent(this.id,8755,t)}}t.RotaryEncoder=i}})(pxsim=pxsim||{}),(t=>{(t=t.RotaryEncoderMethods||(t.RotaryEncoderMethods={})).onChanged=function(t,e){t.onChanged(e)},t.position=function(t){return t.position}})(pxsim=pxsim||{}),(t=>{class e extends t.RefObject{constructor(t,e,i){super(),this.isStatic=!0,this.revision=0,this.data=new Uint8Array(t*e),this._width=t,this._height=e,this._bpp=i}scan(t){}gcKey(){return"Image"}gcSize(){return 4+(this.data.length+3>>3)}gcIsStatic(){return this.isStatic}pix(t,e){return(0|t)+(0|e)*this._width}inRange(t,e){return 0<=(0|t)&&(0|t)<this._width&&0<=(0|e)&&(0|e)<this._height}color(t){return 255&t}clamp(t,e){return(t|=0)<0?t=0:t>=this._width&&(t=this._width-1),(e|=0)<0?e=0:e>=this._height&&(e=this._height-1),[t,e]}makeWritable(){this.revision++,this.isStatic=!1}toDebugString(){return this._width+"x"+this._height}}t.RefImage=e})(pxsim=pxsim||{}),(x=>{{var t=x.ImageMethods||(x.ImageMethods={});function a(t){return t<<16>>16}function e(t){return t>>16}function y(t){return t._width}function w(t){return t._height}function M(t,e,i,s){t.makeWritable(),t.inRange(e,i)&&(t.data[t.pix(e,i)]=t.color(s))}function E(t,e,i){return t.inRange(e,i)?t.data[t.pix(e,i)]:0}function S(i,t,s,a,r,n){if(!(0==a||0==r||t>=i._width||s>=i._height||t+a-1<0||s+r-1<0)){i.makeWritable();var[o,h]=i.clamp(t+a-1,s+r-1);[t,s]=i.clamp(t,s);let e=i.pix(t,s);r=h-s+1;var l=i._width-(a=o-t+1);for(n=i.color(n);0<r--;){for(let t=0;t<a;++t)i.data[e++]=n;e+=l}}}function r(i,t,s,a,r,n){if(!(n.data.length<16)){i.makeWritable();var[o,h]=i.clamp(t+a-1,s+r-1);[t,s]=i.clamp(t,s);let e=i.pix(t,s);r=h-s+1;for(var l=i._width-(a=o-t+1);0<r--;){for(let t=0;t<a;++t)i.data[e]=n.data[i.data[e]],e++;e+=l}}}function n(t){var e=new x.RefImage(t._width,t._height,t._bpp);return e.data.set(t.data),e}function i(t){var e=t._width,i=t.data,e=new x.RefImage(2*e,t._height,t._bpp),s=e.data;let a=0;for(let t=0;t<i.length;++t){var r=i[t];s[a++]=r,s[a++]=r}return e}function s(t){var e=t._width,i=t._height,s=t.data,t=new x.RefImage(e,2*i,t._bpp),a=t.data;let r=0,n=0,o=e;for(let t=0;t<i;++t){for(let t=0;t<e;++t){var h=s[r++];a[n++]=h,a[o++]=h}n+=e,o+=e}return t}function o(t,e,s,a,i,r){s|=0,a|=0;var n=e._width;let o=e._height;var h=t._height,l=t._width;if(!(s+n<=0||l<=s||a+o<=0||h<=a)){i?S(t,s,a,e._width,e._height,0):r||t.makeWritable();var c=s<0?Math.min(l,n+s):Math.min(l-s,n),d=e.data,u=t.data;for(let t=0;o--;a++,t+=n)if(0<=a&&a<h){let e=a*l,i=t;s<0?i+=-s:e+=s;for(let t=0;t<c;++t){var f=d[i++];if(f)if(r){if(u[e])return!0}else u[e]=f;e++}}}return!1}function h(t,e,i,s){o(t,e,i,s,!1,!1)}function l(e,i,t,s,a,r){var n=s-i;let o=a-t,h=e._width,l=(o<0&&(h=-h,o=-o),2*o-n),c=(n<<=1,o<<=1,r=e.color(r),e.pix(i,t));for(let t=i;t<=s;++t)e.data[c]=r,0<l&&(c+=h,l-=n),l+=o,c++}function c(e,t,i,s,a,r){let n=s-t;var o=a-i;let h=1,l=(n<0&&(h=-1,n=-n),2*n-o),c=(n<<=1,o<<=1,r=e.color(r),e.pix(t,i));for(let t=i;t<=a;++t)e.data[c]=r,0<l&&(c+=h,l-=o),l+=n,c+=e._width}function d(e,i,s,a,r,n){if(s|=0,r|=0,(a|=0)<(i|=0))d(e,a,r,i,s,n);else{var o,h=a-i;let t=r-s;if(0==t)0==h?M(e,i,s,n):S(e,i,s,1+h,1,n);else if(0==h)0<t?S(e,i,s,1,t+1,n):S(e,i,r,1,1-t,n);else if(!(a<0||i>=e._width)){if(i<0&&(s-=t*i/h|0,i=0),a>=e._width&&(o=e._width-1-a,r+=t*o/h|0,a=e._width-1),s<r){if(s>=e._height||r<0)return;s<0&&(i-=h*s/t|0,s=0),e._height<=r&&(a+=h*(e._height-1-r)/t|0,r=e._height)}else{if(r>=e._height||s<0)return;r<0&&(a-=h*r/t|0,r=0),e._height<=s&&(i+=h*(e._height-1-s)/t|0,s=e._height)}e.makeWritable(),t<0?(t=-t)<h?l(e,i,s,a,r,n):c(e,a,r,i,s,n):(t<h?l:c)(e,i,s,a,r,n)}}}function u(t,e,i,n,o){var h=e.data;if(x.image.isValidImage(e)&&1==h[1]){var s=x.image.bufW(h),l=x.image.bufH(h),a=x.image.byteHeight(l,1),c=(i|=0,n|=0,t._height),d=t._width;if(!(i+s<=0||d<=i||n+l<=0||c<=n)){t.makeWritable();let r=8;o=t.color(o);var u=t.data;for(let t=0;t<s;++t){var f=i+t;if(0<=f&&f<d){let t=f+n*d,e=r,i=n;var p=Math.min(c,l+n);n<0&&(e+=-n>>3,i+=8*(-n>>3),t+=(i-n)*d);let s=1,a=h[e++];for(;i<p;)0<=i&&a&s&&(u[t]=o),256==(s<<=1)&&(s=1,a=h[e++]),t+=d,i++}r+=a}}}}function f(t,e,i,s,a){let r=s-1,n=0,o=1,h=1,l=o-(s<<1);for(;r>=n;)S(t,e+r,i-n,1,1+(n<<1),a),S(t,e+n,i-r,1,1+(r<<1),a),S(t,e-r,i-n,1,1+(n<<1),a),S(t,e-n,i-r,1,1+(r<<1),a),l<=0&&(n++,l+=h,h+=2),0<l&&(r--,o+=2,l+=o-(s<<1))}function b(t,e,i){for(;e.x===t&&e.x<=e.x1&&e.x<e.W;)0<=e.x&&(e.y<i.min&&(i.min=e.y),i.max<e.y)&&(i.max=e.y),0<e.D&&(e.y+=e.yi,e.D-=e.dx),e.D+=e.dy,++e.x}function k(t,e,i){for(;e.x==t&&e.y>=e.y1&&e.x<e.W;)0<=e.x&&(e.y<i.min&&(i.min=e.y),i.max<e.y)&&(i.max=e.y),0<e.D&&(e.x+=e.xi,e.D+=e.dy),e.D+=e.dx,--e.y}function _(t,e,i){for(;e.x==t&&e.y<=e.y1&&e.x<e.W;)0<=e.x&&(e.y<i.min&&(i.min=e.y),i.max<e.y)&&(i.max=e.y),0<e.D&&(e.x+=e.xi,e.D-=e.dy),e.D+=e.dx,++e.y}function C(t,e,i,s){i={x:t,y:e,x0:t,y0:e,x1:i,y1:s,W:0,H:0,dx:i-t,dy:s-e,yi:0,xi:0,D:0,nextFuncIndex:0};return(i.dy<0?-i.dy:i.dy)<i.dx?(i.yi=1,i.dy<0&&(i.yi=-1,i.dy=-i.dy),i.D=2*i.dy-i.dx,i.dx=i.dx<<1,i.dy=i.dy<<1,i.nextFuncIndex=0):(i.xi=1,i.dy<0?(i.D=2*i.dx+i.dy,i.dx=i.dx<<1,i.dy=i.dy<<1,i.nextFuncIndex=1):(i.D=2*i.dx-i.dy,i.dx=i.dx<<1,i.dy=i.dy<<1,i.nextFuncIndex=2)),i}function A(e,t,i,s,a,r,n,o){s<t&&([s,t]=[t,s],[a,i]=[i,a]),r<s&&([r,s]=[s,r],[n,a]=[a,n]),s<t&&([s,t]=[t,s],[a,i]=[i,a]);var h=[C(t,i,r,n),C(t,i,s,a),C(s,a,r,n)],t=(h[0].W=h[1].W=h[2].W=y(e),h[0].H=h[1].H=h[2].H=w(e),[b,k,_]),l=t[h[0].nextFuncIndex],c=t[h[1].nextFuncIndex],d=t[h[2].nextFuncIndex],u={min:h[0].H,max:-1};for(let t=h[1].x0;t<=h[1].x1;t++)u.min=h[0].H,u.max=-1,l(t,h[0],u),c(t,h[1],u),S(e,t,u.min,1,u.max-u.min+1,o);d(h[2].x0,h[2],u);for(let t=h[2].x0+1;t<=h[2].x1;t++)u.min=h[0].H,u.max=-1,l(t,h[0],u),d(t,h[2],u),S(e,t,u.min,1,u.max-u.min+1,o)}function I(e,t,i,s,a,r,n,o,h,l){var c=[t<s?C(t,i,s,a):C(s,a,t,i),s<r?C(s,a,r,n):C(r,n,s,a),r<o?C(r,n,o,h):C(o,h,r,n),t<o?C(t,i,o,h):C(o,h,t,i)],a=(c[0].W=c[1].W=c[2].W=c[3].W=y(e),c[0].H=c[1].H=c[2].H=c[3].H=w(e),Math.min(Math.min(t,s),Math.min(r,o))),d=Math.min(Math.max(Math.max(t,s),Math.max(r,o)),c[0].W-1),n=[b,k,_],u=n[c[0].nextFuncIndex],f=n[c[1].nextFuncIndex],p=n[c[2].nextFuncIndex],g=n[c[3].nextFuncIndex],m={min:c[0].H,max:-1};for(let t=a;t<=d;t++)m.min=c[0].H,m.max=-1,u(t,c[0],m),f(t,c[1],m),p(t,c[2],m),g(t,c[3],m),S(e,t,m.min,1,m.max-m.min+1,l)}function P(i,s,a,r,n,o){if(a|=0,n|=0,o|=0,i.inRange(s|=0,0)&&i.inRange(n,0)&&!(o<=0)){let t=0;var h=(r._width<<16)/o|0;let e=a+o;for(e>i._height&&(e=i._height),a<0&&(t+=-a*h,a=0);a<e;)i.data[i.pix(s,a)]=r.data[r.pix(n,t>>16)],a++,t+=h}}function T(s,a,t){var e=t.getAt(0),i=t.getAt(1),r=t.getAt(2),n=t.getAt(3),o=t.getAt(4),h=t.getAt(5),l=t.getAt(6),c=t.getAt(7),d=t.getAt(8),u=t.getAt(9),f=(l<<16)/r|0,p=(c<<16)/n|0,t=Math.abs(Math.min(0,e)),g=Math.abs(Math.min(0,i)),m=e+t,x=i+g,v=Math.min(s._width,e+r),y=Math.min(s._height,i+n),w=Math.max(0,(o<<16)+t*f),e=Math.max(0,(h<<16)+g*p),S=Math.min(a._width,o+l)<<16,b=Math.min(a._height,h+c)<<16;u||s.makeWritable();for(let i=x,t=e;i<y&&t<b;++i,t+=p){var k=t>>16;for(let t=m,e=w;t<v&&e<S;++t,e+=f){var _=E(a,e>>16,k);if(u&&_){if(E(s,t,i))return!0}else d&&!_||M(s,t,i,_)}}return!1}t.XX=a,t.YY=e,t.width=y,t.height=w,t.isMono=function(t){return 1==t._bpp},t.isStatic=function(t){return t.gcIsStatic()},t.revision=function(t){return t.revision},t.setPixel=M,t.getPixel=E,t.fill=function(t,e){t.makeWritable(),t.data.fill(t.color(e))},t.fillRect=S,t._fillRect=function(t,e,i,s){S(t,a(e),e>>16,a(i),i>>16,s)},t.mapRect=r,t._mapRect=function(t,e,i,s){r(t,a(e),e>>16,a(i),i>>16,s)},t.equals=function(t,e){if(!e||t._bpp!=e._bpp||t._width!=e._width||t._height!=e._height)return!1;var i=t.data,s=e.data,a=i.length;for(let t=0;t<a;t++)if(i[t]!=s[t])return!1;return!0},t.getRows=function(a,r,n){if(a.inRange(r|=0,0)){let t=0,e=Math.min(n.data.length,(a._width-r)*a._height),i=r,s=0;for(;e--;)s++>=a._height&&(s=1,i=++r),n.data[t++]=a.data[i],i+=a._width}},t.setRows=function(a,r,n){if(a.inRange(r|=0,0)){let t=0,e=Math.min(n.data.length,(a._width-r)*a._height),i=r,s=0;for(;e--;)s++>=a._height&&(s=1,i=++r),a.data[i]=n.data[t++],i+=a._width}},t.clone=n,t.flipX=function(e){e.makeWritable();var i=e._width,s=e._height;for(let t=0;t<s;++t)e.data.subarray(t*i,(t+1)*i).reverse()},t.flipY=function(t){t.makeWritable();var s=t._width,a=t._height,r=t.data;for(let i=0;i<s;++i){let t=i,e=i+(a-1)*s;for(;t<e;){var n=r[t];r[t]=r[e],r[e]=n,t+=s,e-=s}}},t.transposed=function(t){var i=t._width,e=t._height,s=t.data,a=(t=new x.RefImage(e,i,t._bpp)).data;let r=0;for(let t=0;t<e;++t){let e=t;for(let t=0;t<i;++t)a[e]=s[r++],e+=i}return t},t.copyFrom=function(t,e){t._width==e._width&&t._height==e._height&&t._bpp==e._bpp&&t.data.set(e.data)},t.scroll=function(t,e,i){var s;t.makeWritable(),i|=0,0!=(e|=0)?(s=n(t),t.data.fill(0),h(t,s,e,i)):i<0?((i=-i)<t._height?t.data.copyWithin(0,i*t._width):i=t._height,t.data.fill(0,(t._height-i)*t._width)):0<i&&(i<t._height?t.data.copyWithin(i*t._width,0):i=t._height,t.data.fill(0,0,i*t._width))},t.replace=function(t,e,i){i&=15;var s=t.data;for(let t=0;t<s.length;++t)s[t]==e&&(s[t]=i)},t.doubledX=i,t.doubledY=s,t.doubled=function(t){return i(s(t))},t.drawImage=function(t,e,i,s){o(t,e,i,s,!0,!1)},t.drawTransparentImage=h,t.overlapsWith=function(t,e,i,s){return o(t,e,i,s,!1,!0)},t._drawLine=function(t,e,i,s){d(t,a(e),e>>16,a(i),i>>16,s)},t.drawLine=d,t.drawIcon=u,t._drawIcon=function(t,e,i,s){u(t,e,a(i),i>>16,s)},t.fillCircle=f,t._fillCircle=function(t,e,i,s){f(t,a(e),e>>16,i,s)},t.fillTriangle=A,t._fillTriangle=function(t,e){A(t,0|e.getAt(0),0|e.getAt(1),0|e.getAt(2),0|e.getAt(3),0|e.getAt(4),0|e.getAt(5),0|e.getAt(6))},t.fillPolygon4=I,t._fillPolygon4=function(t,e){I(t,0|e.getAt(0),0|e.getAt(1),0|e.getAt(2),0|e.getAt(3),0|e.getAt(4),0|e.getAt(5),0|e.getAt(6),0|e.getAt(7),0|e.getAt(8))},t._blitRow=function(t,e,i,s){P(t,a(e),e>>16,i,a(s),s>>16)},t.blitRow=P,t._blit=T,t.blit=T;let p=2*Math.PI,g=Math.PI/2,m=3*Math.PI/2,v=1;function D(e,n,o){var h={sx:0,sy:0,scaledWidth:0,scaledHeight:0,minX:0,minY:0,maxX:0,maxY:0,xShear:0,yShear:0,flip:!1},l=n.getAt(o)*v,c=n.getAt(o+1)*v;let d=n.getAt(o+2);if(h.sx=l,h.sy=c,!(l<=0||c<=0)){(d%=p)<0&&(d+=p);let t=!1,i=(d>g&&d<=m&&(t=!0,d=(d+Math.PI)%p),-Math.tan(d/2)*v),s=Math.sin(d)*v;n=e._width*l,o=e._height*c;let a=0,r=0;var l=(t,e)=>{a=0|t+e*i,r=0|e+a*s,a=0|a+r*i},e=(l(0,0),a),c=r,u=a,f=r;l(n-v,0),e=Math.min(e,a),c=Math.min(c,r),u=Math.max(u,a),f=Math.max(f,r),l(n-v,o-v),e=Math.min(e,a),c=Math.min(c,r),u=Math.max(u,a),f=Math.max(f,r),l(0,o-v),e=Math.min(e,a),c=Math.min(c,r),u=Math.max(u,a),f=Math.max(f,r),h.minX=e,h.minY=c,h.maxX=u,h.maxY=f,h.scaledWidth=n,h.scaledHeight=o,h.xShear=i,h.yShear=s,h.flip=t}return h}function R(r,n,t){var o=t.getAt(0),h=t.getAt(1);if(!(o>=r._width||h>=r._height)){let a=D(n,t,2);if(!(a.sx<=0||a.sy<=0||o+(a.maxX-a.minX)<0||h+(a.maxY-a.minY)<0)){let i=0,s=0;var l=(t,e)=>{i=0|t+e*a.xShear,s=0|e+i*a.yShear,i=0|i+s*a.xShear};if(r.makeWritable(),a.flip)for(let e=0;e<a.scaledHeight;e+=v)for(let t=0;t<a.scaledWidth;t+=v){var c=E(n,(a.scaledWidth-t-v)/a.sx,(a.scaledHeight-e-v)/a.sy);c&&(l(t,e),M(r,o+(i-a.minX),h+(s-a.minY),c))}else for(let e=0;e<a.scaledHeight;e+=v)for(let t=0;t<a.scaledWidth;t+=v){var d=E(n,t/a.sx,e/a.sy);d&&(l(t,e),M(r,o+(i-a.minX),h+(s-a.minY),d))}}}}t._drawScaledRotatedImage=function(t,e,i){R(t,e,i)},t.drawScaledRotatedImage=R,t._checkOverlapsScaledRotatedImage=function(r,n,t){var o=t.getAt(0),h=t.getAt(1);if(!(o>=r._width||h>=r._height)){let a=D(n,t,2);if(!(a.sx<=0||a.sy<=0||o+(a.maxX-a.minX)<0||h+(a.maxY-a.minY)<0)){let i=0,s=0;var l=(t,e)=>{i=0|t+e*a.xShear,s=0|e+i*a.yShear,i=0|i+s*a.xShear};if(a.flip)for(let e=0;e<a.scaledHeight;e+=v)for(let t=0;t<a.scaledWidth;t+=v){var c=E(n,(a.scaledWidth-t-v)/a.sx,(a.scaledHeight-e-v)/a.sy);if(c&&(l(t,e),E(r,o+(i-a.minX),h+(s-a.minY))))return!0}else for(let e=0;e<a.scaledHeight;e+=v)for(let t=0;t<a.scaledWidth;t+=v){var d=E(n,t/a.sx,e/a.sy);if(d&&(l(t,e),E(r,o+(i-a.minX),h+(s-a.minY))))return!0}}}return!1},t._checkOverlapsTwoScaledRotatedImages=function(i,s,t){var h=t.getAt(0),l=t.getAt(1),c=D(i,t,2);if(!(c.sx<=0||c.sy<=0||h>=c.maxX-c.minX||l>=c.maxY-c.minY)){var d=D(s,t,5);if(!(d.sx<=0||d.sy<=0||h+d.maxX-d.minX<0||l+d.maxY-d.minY<0)){let a=0,r=0,n=0,o=0;var u=(t,e,i,s)=>{a=0|t+e*i,r=0|e+a*s,a=0|a+r*i},f=(t,e,i,s)=>{n=0|t-e*i,o=0|e-n*s,n=0|n-o*i};if(d.flip){for(let e=0;e<d.scaledHeight;e+=v)for(let t=0;t<d.scaledWidth;t+=v)if(E(s,(d.scaledWidth-t-v)/d.sx,(d.scaledHeight-e-v)/d.sy)){u(t,e,d.xShear,d.yShear);var p=h+a-d.minX,g=l+r-d.minY;if(!(p<0||g<0||p>=c.maxX-c.minX||g>=c.maxY-c.minY))if(f(p+c.minX,g+c.minY,c.xShear,c.yShear),c.flip){if(E(i,(c.scaledWidth-n-v)/c.sx,(c.scaledHeight-o-v)/c.sy))return!0}else if(E(i,n/c.sx,o/c.sy))return!0}}else for(let e=0;e<d.scaledHeight;e+=v)for(let t=0;t<d.scaledWidth;t+=v)if(E(s,t/d.sx,e/d.sy)){u(t,e,d.xShear,d.yShear);var m=h+a-d.minX,x=l+r-d.minY;if(!(m<0||x<0||m>=c.maxX-c.minX||x>=c.maxY-c.minY))if(f(m+c.minX,x+c.minY,c.xShear,c.yShear),c.flip){if(E(i,(c.scaledWidth-n-v)/c.sx,(c.scaledHeight-o-v)/c.sy))return!0}else if(E(i,n/c.sx,o/c.sy))return!0}}}return!1}}})(pxsim=pxsim||{}),(l=>{var t;function c(t,e){return 1==e?t*e+7>>3:t*e+31>>5<<2}function d(t){return t[2]|t[3]<<8}function u(t){return t[4]|t[5]<<8}function f(t){var e;return!(!t||t.data.length<5||135!=t.data[0]||1!=t.data[1]&&4!=t.data[1]||(e=t.data[1],8+d(t.data)*c(u(t.data),e)!=t.data.length))}function e(t){var a=t.data;let r=4,n=0,o=0,e=0;if((t=>{var e;return!(!t||t.data.length<5||225!=t.data[0]&&228!=t.data[0])&&(e=15&t.data[0],4+t.data[1]*c(t.data[2],e)==t.data.length)?1:void 0})(t)?(n=a[1],o=a[2],e=15&a[0]):f(t)&&(r=8,n=d(a),o=u(a),e=a[1]),0==n||0==o)return null;var i=new l.RefImage(n,o,e),h=i.data;if(i.isStatic=t.isStatic,1==e)for(let t=0;t<n;++t){let e=t,i=1,s=a[r++];for(let t=0;t<o;++t)256==i&&(i=1,s=a[r++]),s&i&&(h[e]=1),e+=n,i<<=1}else if(4==e)for(let t=0;t<n;++t){let e=t;for(let t=0;t<o>>1;++t){var s=a[r++];h[e]=15&s,h[e+=n]=s>>4,e+=n}1&o&&(h[e]=15&a[r++]),r=r+3&-4}return i}function i(e){var t=c(e._height,e._bpp),s=new Uint8Array(8+e._width*t);s[0]=135,s[1]=e._bpp,s[2]=255&e._width,s[3]=e._width>>8,s[4]=255&e._height,s[5]=e._height>>8;let a=8;var r=e._width,n=e._height,o=e.data;for(let t=0;t<r;++t)if(4==e._bpp){let e=t;for(let t=0;t<n;t+=2)s[a++]=(15&o[e+r])<<4|15&(o[e]||0),e+=2*r;a=a+3&-4}else if(1==e._bpp){let e=1,i=t;for(let t=0;t<n;t++)o[i]&&(s[a]|=e),e<<=1,i+=r,256==e&&(e=1,a++);1!=e&&a++}return new l.RefBuffer(s)}(t=l.image||(l.image={})).byteHeight=c,t.bufW=d,t.bufH=u,t.isValidImage=f,t.create=function(t,e){if(e|=0,!((t|=0)<0||e<0||2e3<t||2e3<e))return new l.RefImage(t,e,l.getScreenState().bpp())},t.ofBuffer=e,t.toBuffer=i,t.doubledIcon=function(t){return(t=e(t))?i(l.ImageMethods.doubled(t)):null}})(pxsim=pxsim||{}),(i=>{var t;(t=i.pxtcore||(i.pxtcore={})).updateScreen=function(t){var e=i.getScreenState();e&&e.showImage(t)},t.updateStats=function(t){var e=i.getScreenState();e&&e.updateStats(t)},t.setPalette=function(t){var e=i.getScreenState();e&&e.setPalette(t)},t.setupScreenStatusBar=function(t){var e=i.getScreenState();e&&e.setupScreenStatusBar(t)},t.updateScreenStatusBar=function(t){var e=i.getScreenState();e&&e.updateScreenStatusBar(t)},t.setScreenBrightness=function(t){var e=i.getScreenState();e&&e.setScreenBrightness(t)}})(pxsim=pxsim||{}),(o=>{class t{constructor(t,e=0,i=0){this.width=0,this.height=0,this.lastImageFlushTime=0,this.changed=!0,this.brightness=255,this.onChange=()=>{},t=t||["#000000","#ffffff"],this.palette=new Uint32Array(t.length),this.setPaletteFromHtmlColors(t),e&&(this.width=e,this.height=i,this.screen=new Uint32Array(this.width*this.height),this.screen.fill(this.palette[0]))}setScreenBrightness(t){this.brightness=0|t}paletteToUint8Array(){var e=new Uint8Array(3*this.palette.length);for(let t=0;t<this.palette.length;++t){s=this.palette[t],i=void 0,(i=new Uint32Array(1))[0]=s;var[i,s,a]=[(s=new Uint8ClampedArray(i.buffer))[0],s[1],s[2]],r=3*t;e[r]=i,e[1+r]=s,e[2+r]=a}return e}setPaletteFromHtmlColors(e){for(let t=0;t<this.palette.length;++t)this.palette[t]=(i=e[t],s=void 0,s=new Uint8ClampedArray(4),i=parseInt(i.replace(/#/,""),16),s[0]=i>>16&255,s[1]=i>>8&255,s[2]=i>>0&255,s[3]=255,new Uint32Array(s.buffer)[0]);var i,s}setPalette(t){var e=new Uint8ClampedArray(4),i=new Uint32Array(e.buffer),s=t.data;48!=s.length&&o.pxtrt.panic(911),this.palette=new Uint32Array(s.length/3|0);for(let t=0;t<this.palette.length;++t){var a=3*t;e[0]=s[0+a],e[1]=s[1+a],e[2]=s[2+a],e[3]=255,this.palette[t]=i[0]}}bpp(){return 2<this.palette.length?4:1}didChange(){var t=this.changed;return this.changed=!1,t}maybeForceUpdate(){200<Date.now()-this.lastImageFlushTime&&this.showImage(null)}showImage(t){if(o.runtime.startPerfCounter(0),t=t||this.lastImage){0==this.width&&(this.width=t._width,this.height=t._height,this.screen=new Uint32Array(this.width*this.height)),this.lastImageFlushTime=Date.now(),this.lastImage=t,this.changed=!0;var e=t.data,i=this.screen,s=(this.width==t._width&&this.height==t._height&&e.length==i.length||o.U.userError("wrong size"),this.palette),a=s.length-1;for(let t=0;t<e.length;++t)i[t]=s[e[t]&a];this.onChange(),o.runtime.stopPerfCounter(0)}}updateStats(t){this.stats=t;t=o.board();t&&t.updateStats&&t.updateStats()}bindToSvgImage(t){function e(){n=!1,s.putImageData(a,0,0),t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",i.toDataURL())}let i=document.createElement("canvas"),s=(i.width=this.width,i.height=this.height,i.getContext("2d")),a=(s.imageSmoothingEnabled=!1,s.getImageData(0,0,this.width,this.height)),r=new Uint32Array(a.data.buffer),n=!1;this.onChange=()=>{r.set(this.screen),o.runtime.queueDisplayUpdate(),n||(n=!0,window.requestAnimationFrame(e))}}setupScreenStatusBar(t){}updateScreenStatusBar(t){}}o.ScreenState=t,o.getScreenState=function(){return o.board().screenState}})(pxsim=pxsim||{}),(r=>{{var i=r.visuals||(r.visuals={});let a=`
  <svg xmlns="http://www.w3.org/2000/svg" id="svg8" width="158.439" height="146.803" viewBox="0 0 158.439 146.803">
  <g id="layer1" transform="translate(-18.95 -27.866)">
    <path id="rect4487" fill="#00f" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.306" d="M19.603 28.519h157.133v145.497H19.603z"/>
    <image id="thescreen" width="136.673" height="109.33" x="26.118" y="61.528" fill="#c8beb7" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width=".427"/>
    <path id="GND" fill="#d4d4d4" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="3.139" d="M23.177 31.031h11.864v11.864H23.177z"/>
    <path id="VCC" fill="#d4d4d4" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="3.139" d="M37.119 31.031h11.864v11.864H37.119z"/>
    <path id="DISPLAY_DC" fill="#d4d4d4" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="3.139" d="M65.004 31.031h11.864v11.864H65.004z"/>
    <path id="DISPLAY_CS" fill="#d4d4d4" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="3.139" d="M78.947 31.031h11.864v11.864H78.947z"/>
    <path id="DISPLAY_MOSI" fill="#d4d4d4" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="3.139" d="M92.889 31.031h11.864v11.864H92.889z"/>
    <path id="DISPLAY_SCK" fill="#d4d4d4" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="3.139" d="M106.831 31.031h11.864v11.864h-11.864z"/>
    <path id="DISPLAY_MISO" fill="#d4d4d4" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="3.139" d="M120.774 31.031h11.864v11.864h-11.864z"/>
    <text id="text4619" x="45.309" y="-27.057" fill="#fff" stroke-width=".226" font-family="consolas" font-size="6.63" font-weight="400" letter-spacing="0" style="line-height:1.25;-inkscape-font-specification:consolas" transform="rotate(90)" word-spacing="0">
      <tspan id="tspan4617" x="45.309" y="-27.057">Gnd</tspan>
    </text>
    <text id="text4619-4" x="45.51" y="-41.166" fill="#fff" stroke-width=".226" font-family="consolas" font-size="6.63" font-weight="400" letter-spacing="0" style="line-height:1.25;-inkscape-font-specification:consolas" transform="rotate(90)" word-spacing="0">
      <tspan id="tspan4617-3" x="45.51" y="-41.166">VCC</tspan>
    </text>
    <text id="text4619-4-9" x="45.17" y="-69.274" fill="#fff" stroke-width=".226" font-family="consolas" font-size="6.63" font-weight="400" letter-spacing="0" style="line-height:1.25;-inkscape-font-specification:consolas" transform="rotate(90)" word-spacing="0">
      <tspan id="tspan4617-3-1" x="45.17" y="-69.274">D/C</tspan>
    </text>
    <text id="text4619-4-9-2" x="45.225" y="-83.064" fill="#fff" stroke-width=".226" font-family="consolas" font-size="6.63" font-weight="400" letter-spacing="0" style="line-height:1.25;-inkscape-font-specification:consolas" transform="rotate(90)" word-spacing="0">
      <tspan id="tspan4617-3-1-5" x="45.225" y="-83.064">CS</tspan>
    </text>
    <text id="text4619-4-9-8" x="45.364" y="-97.03" fill="#fff" stroke-width=".226" font-family="consolas" font-size="6.63" font-weight="400" letter-spacing="0" style="line-height:1.25;-inkscape-font-specification:consolas" transform="rotate(90)" word-spacing="0">
      <tspan id="tspan4617-3-1-9" x="45.364" y="-97.03">MOSI</tspan>
    </text>
    <text id="text4619-4-9-3" x="45.163" y="-110.996" fill="#fff" stroke-width=".226" font-family="consolas" font-size="6.63" font-weight="400" letter-spacing="0" style="line-height:1.25;-inkscape-font-specification:consolas" transform="rotate(90)" word-spacing="0">
      <tspan id="tspan4617-3-1-7" x="45.163" y="-110.996">SCK</tspan>
    </text>
    <text id="text4619-4-9-0" x="46.078" y="-138.962" fill="#fff" stroke-width=".226" font-family="consolas" font-size="6.63" font-weight="400" letter-spacing="0" style="line-height:1.25;-inkscape-font-specification:consolas" transform="rotate(90)" word-spacing="0">
      <tspan id="tspan4617-3-1-72" x="46.078" y="-138.962">BL</tspan>
    </text>
    <path id="DISPLAY_RST" fill="#d4d4d4" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="3.139" d="M51.062 31.031h11.864v11.864H51.062z"/>
    <text id="text4619-4-94" x="44.972" y="-55.132" fill="#fff" stroke-width=".226" font-family="consolas" font-size="6.63" font-weight="400" letter-spacing="0" style="line-height:1.25;-inkscape-font-specification:consolas" transform="rotate(90)" word-spacing="0">
      <tspan id="tspan4617-3-6" x="44.972" y="-55.132">RST</tspan>
    </text>
    <path id="DISPLAY_BL" fill="#d4d4d4" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="3.139" d="M134.638 31.031h11.864v11.864h-11.864z"/>
    <text id="text4619-4-9-0-6" x="45.403" y="-124.163" fill="#fff" stroke-width=".226" font-family="consolas" font-size="6.63" font-weight="400" letter-spacing="0" style="line-height:1.25;-inkscape-font-specification:consolas" transform="rotate(90)" word-spacing="0">
      <tspan id="tspan4617-3-1-72-8" x="45.403" y="-124.163">MISO</tspan>
    </text>
  </g>
</svg>
  `;i.mkScreenPart=function(t=[0,0]){var[t,e]=t,i=r.svg.elt("image");return r.svg.hydrate(i,{class:"sim-screen",x:t,y:e,width:158.439,height:146.803,href:r.svg.toDataUri(a)}),{el:i,x:t,y:e,w:158.439,h:146.803}},i.ScreenView=class{constructor(){}init(t,e,i,s){this.bus=t,this.state=e,this.overElement=void 0,this.defs=[],this.lastLocation=[0,0];t=r.svg.parseString(a);this.canvas=t.getElementById("thescreen"),this.element=r.svg.elt("g"),this.element.appendChild(t.firstElementChild),this.state.bindToSvgImage(this.canvas)}moveToCoord(t){var[t,e]=t;this.lastLocation=[t,e],this.updateLoc()}updateLoc(){var[t,e]=this.lastLocation;i.translateEl(this.element,[t,e])}updateState(){}updateTheme(){}}}})(pxsim=pxsim||{}),(a=>{{var t=a.settings||(a.settings={});let s=0;function r(t){return"S/"+t}function n(){var t=a.board().storedState;return Object.keys(t).filter(t=>"S/"==t.slice(0,"S/".length))}function o(){return n().filter(t=>"#"!=t[2])}function i(){let t=0;var e,i=a.board().storedState;for(e of n())t+=e.length+i[e].length;s=t}function e(t){t=r(t);t=a.board().storedState[t];if(null!=t)return new a.RefBuffer(a.U.stringToUint8Array(atob(t)))}t._set=function(t,e){t=r(t);var i=a.board().storedState[t],e=btoa(a.U.uint8ArrayToString(e.data));return 16384<(i=null==i?s+t.length+e.length:s+e.length-i.length)?-1:(a.board().setStoredState(t,e),s=i,0)},t._remove=function(t){t=r(t);var e=a.board().storedState;return null==e[t]?-1:(s-=t.length+e[t].length,a.board().setStoredState(t,null),0)},t._exists=function(t){return null!=e(t)},t._get=e,t._userClean=function(){for(var t of o())a.board().setStoredState(t,null);if(i(),4096<s){for(var e of n())a.board().setStoredState(e,null);i()}},t._list=function(t){var e,i=new a.RefCollection;for(e of("#"==t[0]?n:o)()){var s=e.slice("S/".length);s.slice(0,t.length)==t&&i.push(s)}return i}}})(pxsim=pxsim||{}),(l=>{var t;(t=l.ShaderMethods||(l.ShaderMethods={}))._mergeImage=function(t,e,i){var s=t,a=e,r=l.ImageMethods.XX(i),n=l.ImageMethods.YY(i);for(let e=0;e<a._width;e++)for(let t=0;t<a._height;t++)l.ImageMethods.setPixel(s,r+e,n+t,Math.min(l.ImageMethods.getPixel(s,r+e,n+t),l.ImageMethods.getPixel(a,e,t)))},t._mapImage=function(t,e,i,s){var a=t,r=e,n=l.ImageMethods.XX(i),o=l.ImageMethods.YY(i),h=s;for(let e=0;e<r._width;e++)for(let t=0;t<r._height;t++)l.ImageMethods.setPixel(a,n+e,o+t,h.data[l.ImageMethods.getPixel(a,n+e,o+t)+(l.ImageMethods.getPixel(r,e,t)<<4)])}})(pxsim=pxsim||{}),(t=>{t.StorageState=class{constructor(){this.files={}}},t.storageState=function(){return t.board().storageState}})(pxsim=pxsim||{}),(a=>{var t;(t=a.storage||(a.storage={})).init=function(){},t.appendBuffer=function(t,e){var i=a.storageState();let s=i.files[t];s=s||(i.files[t]=[]);for(let t=0;t<e.data.length;++t)s.push(e.data[t])},t.overwriteWithBuffer=function(t,e){var i=a.storageState(),s=[];for(let t=0;t<e.data.length;++t)s.push(e.data[t]);i.files[t]=s},t.exists=function(t){return!!a.storageState().files[t]},t.remove=function(t){delete a.storageState().files[t]},t.size=function(t){return(t=a.storageState().files[t])?t.length:0},t.readAsBuffer=function(t){return(t=a.storageState().files[t])?new a.RefBuffer(Uint8Array.from(t)):void 0}})(pxsim=pxsim||{}),(e=>{class i{constructor(){this.left=!1}setState(t){this.left!==t&&(t?e.board().bus.queue(i.id,2):e.board().bus.queue(i.id,1),this.left=t)}isLeft(){return this.left}}i.id=3e3,e.SlideSwitchState=i})(pxsim=pxsim||{}),(i=>{var t;(t=i.input||(i.input={})).onSwitchMoved=function(t,e){i.pxtcore.registerWithDal(i.SlideSwitchState.id,t,e)},t.switchRight=function(){return!i.board().slideSwitchState.isLeft()}})(pxsim=pxsim||{}),(c=>{var t;function d(){return window.navigator.language}(t=c.tts||(c.tts={}))._getLanguageCode=d,t._speakAsync=function(s,a,r,n,o,h,l){return new Promise((t,e)=>{var i=new SpeechSynthesisUtterance(s);i.voice=function t(e){e=e.toLowerCase();let i=e.substring(0,2);let s;let a;for(var r of speechSynthesis.getVoices()){let t=r.lang.toLowerCase();if(t===e){if(r.localService)return r;a=r}else t.substring(0,2)===i&&(!s&&r.localService&&(s=r),a||r.localService||(a=r))}return s||a||("en-us"!==e?t("en-US"):void 0)}(o||d()),null!=a&&(i.pitch=a),null!=r&&(i.rate=r),null!=n&&(i.volume=n),i.onend=()=>t(),i.onerror=e,h&&(i.onstart=()=>c.runtime.runFiberAsync(h)),l&&(i.onboundary=t=>{var t=t.charIndex,e=s.substring(t).split(/\s/).shift();c.runtime.runFiberAsync(l,t,e,s)}),speechSynthesis.speak(i)})},t._pause=function(){speechSynthesis.pause()},t._isPaused=function(){return speechSynthesis.paused},t._resume=function(){speechSynthesis.resume()},t._cancel=function(){speechSynthesis.cancel()}})(pxsim=pxsim||{}),(e=>{e.thermometerState=function(){return e.board().thermometerState},e.setThermometerUnit=function(t){e.board().thermometerUnitState=t}})(pxsim=pxsim||{}),(t=>{(t=t.TemperatureUnit||(t.TemperatureUnit={}))[t.Celsius=0]="Celsius",t[t.Fahrenheit=1]="Fahrenheit"})(pxsim=pxsim||{}),(r=>{var t;(t=r.input||(r.input={})).temperature=function(t){(e=r.thermometerState()).setUsed(),r.setThermometerUnit(t);var e=e.getLevel();return t==r.TemperatureUnit.Celsius?e:18*e/10+32>>0},t.onTemperatureConditionChanged=function(t,e,i,s){var a=r.thermometerState(),i=(a.setUsed(),r.setThermometerUnit(i),i==r.TemperatureUnit.Celsius?e:10*(e-32)/18>>0);2===t?a.setHighThreshold(i):a.setLowThreshold(i),r.pxtcore.registerWithDal(a.id,t,s)}})(pxsim=pxsim||{}),(i=>{i.CapacitiveSensorState=class{constructor(t){this.capacity=[],this.reading=[],this.mapping=t}getCap(t){return this.mapping[t]}readCap(t,e){t=this.getCap(t);return this.capacitiveSensor(t,e)}isReadingPin(t,e){t=this.getCap(t);return this.reading[t]}isReading(t){return this.reading[t]}startReading(t,e){t=this.getCap(t);this.reading[t]=!0,e.mode=i.PinFlags.Analog|i.PinFlags.Input,e.mode|=i.PinFlags.Analog}capacitiveSensor(t,e){return this.capacity[t]||0}reset(t){this.capacity[t]=0,this.reading[t]=!1}};class e extends i.CommonButton{constructor(t){super(t),this._threshold=200}setThreshold(t){this._threshold=t}threshold(){return this._threshold}value(){return 0}calibrate(){}}i.TouchButton=e,i.TouchButtonState=class{constructor(t){this.buttons=t.map(t=>new e(t))}}})(pxsim=pxsim||{}),(s=>{(s.pxtcore||(s.pxtcore={})).getTouchButton=function(e){var t=s.board().touchButtonState.buttons.filter(t=>t.id==e)[0],i=s.board().edgeConnectorState;return i&&(i=i.pins.filter(t=>t.id==e)[0],s.pins.markUsed(i)),t}})(pxsim=pxsim||{}),(t=>{(t=t.TouchButtonMethods||(t.TouchButtonMethods={})).setThreshold=function(t,e){t.setThreshold(e)},t.threshold=function(t){return t.threshold()},t.value=function(t){return t.value()},t.calibrate=function(t){t.calibrate()}})(pxsim=pxsim||{}),(e=>{(e.AnalogInOutPinMethods||(e.AnalogInOutPinMethods={})).touchButton=function(t){return e.pxtcore.getTouchButton(t.id)}})(pxsim=pxsim||{}),(s=>{s.WifiSocket=class{constructor(t){this.fd=t,this.buffers=[],this.readers=[],this.bytesAvail=0,this.reqInit={headers:{},credentials:"omit",mode:"cors",cache:"no-cache",redirect:"manual",referrer:""},this.reqSent=!1}async openReq(t,e){if(/^[\w\-\.]+$/.test(t))return this.reqUrl="https://"+t+":"+e+"/",0;throw new Error("bad host")}_queue(t){let e;e=t instanceof ArrayBuffer?new Uint8Array(t):t instanceof Uint8Array?t:s.U.stringToUint8Array(s.U.toUTF8(t)),this.buffers.push(e),e.length&&0==this.bytesAvail&&s._wifi._raiseEvent(1e3+this.fd),this.bytesAvail+=e.length;var i,t=this.readers;this.readers=[];for(i of t)i()}openWS(t,e){return this.ws=new WebSocket(t,e),this.ws.binaryType="arraybuffer",new Promise(t=>{this.ws.onopen=()=>{this.ws.onerror=t=>{console.log("ws error",t),this._err=-2},t(0)},this.ws.onclose=()=>{console.log("ws close"),this._err=-20},this.ws.onmessage=t=>{this._queue(t.data)},this.ws.onerror=()=>t(-1)})}waitRead(){return new Promise(t=>{this.readers.push(t)})}read(t){if(this._err)return this._err;let e=this.buffers[0];return e?(e.length<=t?this.buffers.shift():(this.buffers[0]=e.slice(t),e=e.slice(0,t)),this.bytesAvail-=e.length,new s.RefBuffer(e)):null}async handleFetch(){this.reqSent=!0;var t=await fetch(this.reqUrl,this.reqInit),t=(this._queue(`HTTP/1.1 ${t.status} ${t.statusText}\r
`),t.headers.forEach((t,e)=>{"content-length"!=e.toLowerCase()&&this._queue(e+`: ${t}\r
`)}),await t.arrayBuffer());return this._queue(`Content-Length: ${t.byteLength}\r
`),this._queue(`\r
`),this._queue(t),0}async write(e){if(this._err)return this._err;if(this.ws)this.ws.send(e.data);else{if(this.reqSent)return-2;let t=s.U.fromUTF8(s.U.uint8ArrayToString(e.data));if("\r\n"==t)return this.handleFetch(),0;t=t.replace(/\r?\n$/,""),this.reqInit.method?(e=/^([^:]+):\s*(.*)/.exec(t))&&(this.reqInit.headers[e[1]]=e[2]):(e=/^\s*(\S+)\s+\/(\S+)/.exec(t))&&(this.reqInit.method=e[1],this.reqUrl+=e[2])}return 0}close(){this.ws&&this.ws.close()}},s.WifiSocketState=class{constructor(){this.sockets=[null]}}})(pxsim=pxsim||{}),(s=>{{var e=s._wifi||(s._wifi={});let i=16;function a(){var t=null==(t=null==(t=null==(t=s.board())?void 0:t.runOptions)?void 0:t.boardDefinition)?void 0:t.id;return/esp32|-s2/.test(t)}function r(){var t=s.board();if(!t.wifiSocketState){if(!a())throw new Error("_wifi not enabled");t.wifiSocketState=new s.WifiSocketState}return t.wifiSocketState}function n(t){return t<0||t>=i?null:r().sockets[t]}function o(t){s.control.raiseEvent(e.eventID(),t,void 0)}e._allowed=a,e.socketAlloc=function(){var e=r();for(let t=1;t<e.sockets.length;++t)if(!e.sockets[t])return e.sockets[t]=new s.WifiSocket(t),t;var t=e.sockets.length;return t>i?-1:(e.sockets.push(new s.WifiSocket(t)),t)},e.socketConnectTLS=function(t,e,i){return(t=n(t))?8883==i&&/\.azure-devices.net$/.test(e)?t.openWS("wss://"+e+"/$iothub/websocket?iothub-no-client-cert=true",["mqtt"]):443==i&&"microsoft.github.io"==e?t.openReq(e,i):(console.log("invalid host: "+e),Promise.resolve(-1)):Promise.resolve(-11)},e.socketWrite=async function(t,e){return(t=n(t))?t.write(e):-11},e.socketRead=async function(t,e){var i=n(t);if(!i)return-11;for(;;){var s=i.read(e);if(s)return s;await i.waitRead()}},e.socketBytesAvailable=function(t){return(t=n(t))?t.bytesAvail:-11},e.socketClose=function(t){return(t=n(t))?(t.close(),0):-11},e.eventID=function(){return 1234},e.scanStart=function(){o(1)},e.startLoginServer=function(){},e.scanResults=function(){var t=new Uint8Array(7);return t[0]=-20,t[1]=0,t.set(s.U.stringToUint8Array("WiFi"),2),new s.RefBuffer(t)},e.connect=function(t,e){return o(2),0},e.disconnect=function(){return 0},e.isConnected=function(){return!0},e.ipInfo=function(){return new s.RefBuffer(new Uint8Array(12))},e.rssi=function(){return-24},e._raiseEvent=o}})(pxsim=pxsim||{}),(n=>{(n.crypto||(n.crypto={}))._sha256=function(t){let e,i,s=0;var a,t=t.toArray().filter(t=>t instanceof n.RefBuffer).map(t=>(s+=t.data.length,t.data)),r=new Uint8Array(s);s=0;for(a of t)r.set(a,s),s+=a.length;return(t=null==(i=null==(e=null==window?void 0:window.crypto)?void 0:e.subtle)?void 0:i.digest("SHA-256",r))?t.then(t=>new n.RefBuffer(new Uint8Array(t))):Promise.resolve(void 0)}})(pxsim=pxsim||{});